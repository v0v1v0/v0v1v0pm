<div class="container">

<table style="width: 100%;"><tr>
<td>get.M3.var</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Read in variable values from Models3-formatted files
</h2>

<h3>Description</h3>

<p>Read in variable values from Models3-formatted files.
</p>


<h3>Usage</h3>

<pre><code class="language-R">get.M3.var(file, var, lcol, ucol, lrow, urow, llay, ulay,
                ldatetime, udatetime, hz.units)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>Name of Models3-formatted file to be read.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>Name (character string) or number (positive integer) of
variable whose values are to be read.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lcol</code></td>
<td>
<p>Lower column bound (positive integer) to be read.  The
default is to read all columns.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ucol</code></td>
<td>
<p>Upper column bound (positive integer) to be read.  The
default is to read all columns.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lrow</code></td>
<td>
<p>Lower row bound (positive integer) to be read.  The
default is to read all rows.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>urow</code></td>
<td>
<p>Upper row bound (positive integer) to be read.  The
default is to read all rows.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>llay</code></td>
<td>
<p>Lower layer bound (positive integer) to be read.  The
default is to read the first layer only.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ulay</code></td>
<td>
<p>Upper layer bound (positive integer) to be read.  The
default is to read the first layer only.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ldatetime</code></td>
<td>
<p>Starting date-time (Date or POSIX class) in GMT.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>udatetime</code></td>
<td>
<p>Starting date-time (Date or POSIX class) in GMT.
</p>
</td>
</tr>
</table>
<p>The default is to read all date-times.  If the file is
time-independent, the one available time step will be read and user
input for ldatetime and udatetime will be disregarded.
</p>
<table><tr style="vertical-align: top;">
<td><code>hz.units</code></td>
<td>
<p>Units associated with grid cell horizontal
dimensions.  Default is degrees ("deg") if the data is indexed
according to longitude/latitude and kilometers ("km") otherwise.
If the file is not indexed according to longitude/latitude, the
user could choose meters ("m").
</p>
</td>
</tr></table>
<h3>Details</h3>

<p>This function assumes that the projection is either Lambert
conic conformal or polar stereographic projection.  It also assumes
that the Models3-formatted file is either time-independent or
time-stepped; it cannot be of type circular-buffer.
</p>


<h3>Value</h3>

<p>List with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Array holding the specified variable values.  Array is
four-dimensional, unless the Models3-formatted file is
time-independent (which we assume if TSTEP attribute is 0), in which
case it is three-dimensional.  Dimensions are columns, rows, layers,
date-time steps.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.units</code></td>
<td>
<p>Contains the units associated with <code>data</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.cell.ctr</code></td>
<td>
<p>X-coordinates of grid cell centers, in units given
by <code>hz.units</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.cell.ctr</code></td>
<td>
<p>Y-coordinates of grid cell centers, in units given
by <code>hz.units</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hz.units</code></td>
<td>
<p>Contains the units associated with the horizontal
dimensions of the grid cells (km, m, or deg).  These are the units
in which <code>x.cell.ctr</code> and <code>y.cell.ctr</code> are given.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rows</code></td>
<td>
<p>Row numbers extracted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cols</code></td>
<td>
<p>Column numbers extracted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>layers</code></td>
<td>
<p>Layer numbers extracted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datetime</code></td>
<td>
<p>Date-time steps (in POSIX format) associated with the
variable, if the file is not time-independent.  For time-independent
files, element datetime is set to NULL.
</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>This function relies on the R package <span class="pkg">ncdf4</span> to read
information from Models3-formatted files, since the Models3 format
is built on netCDF <br>
(<a href="https://www.unidata.ucar.edu/software/netcdf/">https://www.unidata.ucar.edu/software/netcdf/</a>).
</p>


<h3>Author(s)</h3>

<p>Jenise Swall</p>


<h3>References</h3>

<p><a href="https://www.cmascenter.org/ioapi/documentation/all_versions/html/VBLE.html">https://www.cmascenter.org/ioapi/documentation/all_versions/html/VBLE.html</a>, <br><a href="https://www.cmascenter.org/ioapi/documentation/all_versions/html/DATETIME.html">https://www.cmascenter.org/ioapi/documentation/all_versions/html/DATETIME.html</a>
</p>


<h3>See Also</h3>

<p><code>ncvar_get</code>, <code>ncatt_get</code>, <code>get.coord.for.dimension</code>, <br><code>get.datetime.seq</code>, <code>combine.date.and.time</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Find the path to the first demo file (with polar
## stereographic projection).
polar.file &lt;- system.file("extdata/surfinfo_polar.ncf", package="M3")

## Read in the terrain elevation variable.
elev &lt;- get.M3.var(file=polar.file, var="HT")
## Make a plot.
image(elev$x.cell.ctr, elev$y.cell.ctr, elev$data[,,1],
      xlab="Projection x-coord (km)", ylab="Projection y-coord (km)",
      zlim=range(elev$data[,,1]), col=topo.colors(20))
## Find national boundaries on this projection, superimpose them on
## the plot.
world.bds &lt;- get.map.lines.M3.proj(file=polar.file, database="world")$coords
lines(world.bds)

## Subset to a smaller geographic area in southwestern U.S.
subset.elev &lt;- var.subset(elev, llx=-2100, urx=0, lly=-6500, ury=-4000)
## Make a plot of this subset.
image(subset.elev$x.cell.ctr, subset.elev$y.cell.ctr,
      subset.elev$data[,,1], xlab="Projection x-coord (km)",
      ylab="Projection y-coord (km)", zlim=range(subset.elev$data[,,1]),
      col=topo.colors(20))
## Find state boundaries on this projection, superimpose them on the plot.
state.bds &lt;- get.map.lines.M3.proj(file=polar.file)$coords
lines(state.bds)



## Find the path to second demo file (with Lambert conic
## conformal projection).
lcc.file &lt;- system.file("extdata/ozone_lcc.ncf", package="M3")

## Read in the ozone for July 4 for eastern U.S.
oz &lt;- get.M3.var(file=lcc.file, var="O3", lcol=80, urow=95,
                      ldatetime=as.Date("2001-07-04"),
                      udatetime=as.Date("2001-07-04"))
## Make a plot.
image(oz$x.cell.ctr, oz$y.cell.ctr, oz$data[,,1,1],
      xlab="Projection x-coord (km)", ylab="Projection y-coord (km)",
      zlim=range(oz$data), col=heat.colors(15))

## Find map lines on this projection, superimpose them on the plot.
state.bds &lt;- get.map.lines.M3.proj(file=lcc.file)$coords
lines(state.bds)
</code></pre>


</div>