<div class="container">

<table style="width: 100%;"><tr>
<td>align_to_ref</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Align and Trim MSA Against a Reference</h2>

<h3>Description</h3>

<p>Takes a FASTA file with target sequences and aligns them against a reference sequence submitted to the program.
The output is an aligned fasta file that is trimmed to the length of the reference sequence. Sequences without full coverage (records having sequences with leading or trailing gaps) are removed.
Records with characters other than IUPAC are also removed. Finally, internal gaps are removed from the sequence based on the submitted multiple sequence alignment percent
coverage of the character position as provided in the pigl argument supplied by the user.
</p>


<h3>Usage</h3>

<pre><code class="language-R">align_to_ref(
  data_folder = NULL,
  ref_seq_file = NULL,
  MAFFT_loc = NULL,
  output_file = NULL,
  pigl = 0.95,
  op = 1.53
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data_folder</code></td>
<td>
<p>This variable can be used to provide a location for the file containing all of the fasta files wanting to be aligned. The default value is set to NULL where the program will prompt the user to select the folder through point-and-click.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref_seq_file</code></td>
<td>
<p>This variable can be used to provide a location for the reference sequence file. The default value is set to NULL where the program will prompt the user to select the folder through point-and-click.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MAFFT_loc</code></td>
<td>
<p>This variable can be used to provide a location for the MAFFT program. The default value is set to NULL where the program will prompt the user to select the folder through point-and-click.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output_file</code></td>
<td>
<p>This variable can be used to set the location of the output files from the program. The default value is set to NULL where the program will place the output files in the same location as the target files.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pigl</code></td>
<td>
<p>This is the percent internal gap loop argument. This provides a percent that will remove records causing internal gaps if more than the percent value assigned
to this argument is reached. If this value is set to 0 then internal gaps are not removed. The default for this value is 0.95.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>op</code></td>
<td>
<p>This is the gap opening penalty for the use of MAFFT. The higher the value the larger penalty in the alignment. The default for this value is set to 1.53 which is the
default value in the MAFFT program. For alignment of highly conserved regions where no gaps are expected this should be set to a much higher number and 10 is recommended for coding regions like the COI-5P.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>User Input:
1. A file folder location with the fasta files that need to be aligned and trimmed using the supplied reference sequence. Please note that any and all fasta files (named *.fas) in this folder will be analyzed.
2. A reference sequence file with a sequence or MSA with all sequences having the same length.
3. The location of the MAFFT executable file &lt;https://mafft.cbrc.jp/alignment/software/&gt;
</p>


<h3>Value</h3>

<p>Output:
1. In the submitted file folder location there will be a log file titled MAFFT_log.
2. The sequence output files from this script are placed into two subfolders. These folders are in the submitted file location where the fasta files of interest are located.
The two folders created are MAFFT and MAFFT_trimmed. In the MAFFT folder there will be files with name of the files in the submitted file folder appended with "_MAFFT".
The MAFFT_trimmed file will contain files with the same naming convention as the files in the submitted folder and appended with "_MAFFT_trimmed".
</p>


<h3>Author(s)</h3>

<p>Robert G. Young
</p>


<h3>References</h3>

<p>&lt;https://github.com/rgyoung6/MACER&gt;
Young RG, Gill R, Gillis D, Hanner RH (2021) Molecular Acquisition, Cleaning and Evaluation in R (MACER) - A tool to assemble molecular marker datasets from BOLD and GenBank. Biodiversity Data Journal 9: e71378. &lt;https://doi.org/10.3897/BDJ.9.e71378&gt;
</p>


<h3>See Also</h3>

<p>auto_seq_download()
create_fastas()
barcode_clean()
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
align_to_ref(pigl=0.75)
align_to_ref(pigl=0.95, op=10)
align_to_ref(pigl=0)

## End(Not run)

</code></pre>


</div>