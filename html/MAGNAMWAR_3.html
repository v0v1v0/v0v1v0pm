<div class="container">

<table style="width: 100%;"><tr>
<td>AnalyzeOrthoMCL</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Main OrthoMCL Analysis</h2>

<h3>Description</h3>

<p>Main function for analyzing the statistical association of OG (orthologous group) presence with phenotype data
</p>


<h3>Usage</h3>

<pre><code class="language-R">AnalyzeOrthoMCL(mcl_data, pheno_data, model, species_name, resp = NULL,
  fix2 = NULL, rndm1 = NULL, rndm2 = NULL, multi = 1, time = NULL,
  event = NULL, time2 = NULL, startnum = 1, stopnum = "end",
  output_dir = NULL, sig_digits = NULL, princ_coord = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mcl_data</code></td>
<td>
<p>output of FormatAfterOrtho; a list of matrices; (1) a presence/absence matrix of taxa per OG, (2) a list of the specific protein ids within each OG</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pheno_data</code></td>
<td>
<p>a data frame of phenotypic data with specific column names used to specify response variable as well as other fixed and random effects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>linear model with gene presence as fixed effect (lm), linear mixed mffect models with gene presence as fixed effect and additional variables specified as: one random effect (lmeR1); two independent random effects (lmeR2ind); two random effects with rndm2 nested in rndm1 (lmeR2nest); or two independent random effects with one additional fixed effect (lmeF2), Wilcox Test with gene presence as fixed effect (wx), Survival Tests with support for multi core design: with two random effects (survmulti), and with two times as well as an additional fixed variable (survmulticensor)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>species_name</code></td>
<td>
<p>Column name in pheno_data containing 4-letter species designations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resp</code></td>
<td>
<p>Column name in pheno_data containing response variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix2</code></td>
<td>
<p>Column name in pheno_data containing second fixed effect</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rndm1</code></td>
<td>
<p>Column name in pheno_data containing first random variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rndm2</code></td>
<td>
<p>Column name in pheno_data containing second random variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>multi</code></td>
<td>
<p>(can only be used with survival tests) Number of cores</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>(can only be used with survival tests) Column name in pheno_data containing first time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>event</code></td>
<td>
<p>(can only be used with survival tests) Column name in pheno_data containing event</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time2</code></td>
<td>
<p>(can only be used with survival tests) Column name in pheno_data containing second time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startnum</code></td>
<td>
<p>number of test to start on</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stopnum</code></td>
<td>
<p>number of test to stop on</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output_dir</code></td>
<td>
<p>(if using survival tests) directory where small output files will be placed before using SurvAppendMatrix. Must specify a directory if choosing to output small files, else only written as a matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig_digits</code></td>
<td>
<p>amount of digits to display for p-values and means of data; default to NULL (no rounding)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>princ_coord</code></td>
<td>
<p>the number of principle coordinates to be included in model as fixed effects (1, 2, or 3), if a decimal is specified, as many principal coordinates as are needed to account for that percentage of the variance will be included in the analysis</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A matrix with the following columns: OG, p-values, Bonferroni corrected p-values, mean phenotype of OG-containing taxa, mean pheotype of OG-lacking taxa, taxa included in OG, taxa not included in OG
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Linear Model

## Not run: 
mcl_mtrx &lt;- AnalyzeOrthoMCL(after_ortho_format, pheno_data, 'lm',
 'Treatment', resp='RespVar')

## End(Not run)

# the rest of the examples are not run for time's sake
#Linear Mixed Effect with one random effect
## Not run: 
mcl_mtrx &lt;- AnalyzeOrthoMCL(after_ortho_format, pheno_data, 'lmeR1',
'Treatment', resp='RespVar', rndm1='Experiment')

## End(Not run)


#Linear Mixed Effect with two independent random effects
## Not run: 
mcl_mtrx &lt;- AnalyzeOrthoMCL(after_ortho_format, pheno_data, 'lmeR2ind',
 'Treatment', resp='RespVar', rndm1='Experiment', rndm2='Vial')

## End(Not run)


#Linear Mixed Effect with rndm2 nested in rndm1
## Not run: 
mcl_mtrx &lt;- AnalyzeOrthoMCL(after_ortho_format, pheno_data, 'lmeR2nest',
 'Treatment',  resp='RespVar', rndm1='Experiment', rndm2='Vial')

## End(Not run) 


#Linear Mixed Effect with two independent random effects and one additional fixed effect
## Not run: 
mcl_mtrx3 &lt;- AnalyzeOrthoMCL(after_ortho_format, pheno_data, 'lmeF2',
 'Treatment', resp='RespVar', fix2='Treatment', rndm1='Experiment', rndm2='Vial', princ_coord = 4)

## End(Not run)


#Wilcoxon Test
## Not run: 
mcl_mtrx &lt;- AnalyzeOrthoMCL(after_ortho_format, pheno_data, 'wx',
 'Treatment', resp='RespVar')

## End(Not run)

# ~ 5 minutes
#Survival with two independent random effects, run on multiple cores
## Not run: 
mcl_mtrx &lt;- AnalyzeOrthoMCL(after_ortho_format, starv_pheno_data, 'TRT', model='survmulti',
 time='t2', event='event', rndm1='EXP', rndm2='VIAL', multi=1)

## End(Not run)

# ~ 5 minutes
#Survival with two independent random effects and one additional fixed effect,
#including drops on multi cores
## Not run: 
mcl_mtrx &lt;- AnalyzeOrthoMCL(after_ortho_format, starv_pheno_data, 'TRT', model='survmulticensor',
 time='t1', time2='t2', event='event', rndm1='EXP', rndm2='VIAL', fix2='BACLO', multi=1)
 
## End(Not run)
#to be appended with SurvAppendMatrix
</code></pre>


</div>