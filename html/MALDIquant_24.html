<div class="container">

<table style="width: 100%;"><tr>
<td>estimateBaseline-methods</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimates the baseline of a MassSpectrum object.</h2>

<h3>Description</h3>

<p>This method estimates the baseline of mass spectrometry data
(represented by a <code>MassSpectrum</code> object).<br></p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'MassSpectrum'
estimateBaseline(object,
  method=c("SNIP", "TopHat", "ConvexHull", "median"),
  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p><code>MassSpectrum</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>used baseline estimation method, one of
<code>"SNIP"</code>, <code>"TopHat"</code>, <code>"ConvexHull"</code> or <code>"median"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments to be passed to <code>method</code></p>
</td>
</tr>
</table>
<h3>Details</h3>


<dl>
<dt>
<code>"SNIP"</code>:</dt>
<dd>
<p>This baseline estimation is based on the Statistics-sensitive Non-linear
Iterative Peak-clipping algorithm (SNIP) described in Ryan et al 1988.<br></p>
<p>The algorithm based on the following equation:
</p>
<p style="text-align: center;"><code class="reqn">y_i(k) = \min \{ y_i, \frac{(y_{i-k}+y_{i+k})}{2} \}</code>
</p>

<p>It has two additional arguments namely <code>iterations</code> and
<code>decreasing</code>. <code>iterations</code> controls the window size (<em>k</em>;
similar to <code>halfWindowSize</code> in <code>"TopHat"</code>, <code>"Median"</code>) of
the algorithm. The resulting window reaches from
<code>mass[cur_index-iterations]</code> to <code>mass[cur_index+iterations]</code>.
</p>
<p><code>decreasing</code>: In Morhac 2009 a decreasing clipping window is
suggested to get a smoother baseline.  For <code>decreasing = TRUE</code>
(<code>decreasing = FALSE</code>) <em>k</em>=<code>iterations</code> is decreased
(increased) by one until zero (<code>iterations</code>) is reached. The default
setting is <code>decreasing = TRUE</code>.
</p>
</dd>
<dt>
<code>"TopHat"</code>:</dt>
<dd>
<p>This algorithm applies a moving minimum (erosion filter) and subsequently
a moving maximum (dilation filter) filter on the intensity values. The
implementation is based on van Herk 1996.
It has an additional <code>halfWindowSize</code> argument determining the half
size of the moving window for the TopHat filter. The resulting window
reaches from <code>mass[cur_index-halfWindowSize]</code> to
<code>mass[cur_index+halfWindowSize]</code>.
</p>
</dd>
<dt>
<code>"ConvexHull"</code>:</dt>
<dd>
<p>The baseline estimation is based on a convex hull constructed below the
spectrum.
</p>
</dd>
<dt>
<code>"median"</code>:</dt>
<dd>
<p>This baseline estimation uses a moving median. It is based on
<code>runmed</code>. The additional argument <code>halfWindowSize</code>
corresponds to the <code>k</code> argument in <code>runmed</code>
(<code>k = 2 * halfWindowSize + 1</code>) and controls the half size of the
moving window. The resulting window reaches from
<code>mass[cur_index-halfWindowSize]</code> to
<code>mass[cur_index+halfWindowSize]</code>.
</p>
</dd>
</dl>
<h3>Value</h3>

<p>Returns a two column matrix (first column: mass, second column: intensity)
of the estimated baseline.
</p>


<h3>Author(s)</h3>

<p>Sebastian Gibb <a href="mailto:mail@sebastiangibb.de">mail@sebastiangibb.de</a>
</p>


<h3>References</h3>

<p><code>"SNIP"</code>:<br>
C.G. Ryan, E. Clayton, W.L. Griffin, S.H. Sie, and D.R. Cousens. 1988.
Snip, a statistics-sensitive background treatment for the quantitative analysis
of pixe spectra in geoscience applications.
Nuclear Instruments and Methods in Physics Research Section B:
Beam Interactions with Materials and Atoms, 34(3): 396-402.
</p>
<p>M. Morhac. 2009.
An algorithm for determination of peak regions and baseline elimination in
spectroscopic data.
Nuclear Instruments and Methods in Physics Research Section A:
Accelerators, Spectrometers, Detectors and Associated Equipment, 600(2),
478-487.
</p>
<p><code>"TopHat"</code>:<br>
M. van Herk. 1992.
A Fast Algorithm for Local Minimum and Maximum Filters on Rectangular and
Octagonal Kernels.
Pattern Recognition Letters 13.7: 517-521.
</p>
<p>J. Y. Gil and M. Werman. 1996.
Computing 2-Dimensional Min, Median and Max Filters.
IEEE Transactions: 504-507.
</p>
<p><code>"ConvexHull"</code>:<br>
Andrew, A. M. 1979.
Another efficient algorithm for convex hulls in two dimensions.
Information Processing Letters, 9(5), 216-219.
</p>


<h3>See Also</h3>

<p><code>MassSpectrum</code>,
<code>removeBaseline,MassSpectrum-method</code>
</p>
<p><code>demo("baseline")</code>
</p>
<p>Website: <a href="https://strimmerlab.github.io/software/maldiquant/">https://strimmerlab.github.io/software/maldiquant/</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## load package
library("MALDIquant")

## load example data
data("fiedler2009subset", package="MALDIquant")

## choose only the first mass spectrum
s &lt;- fiedler2009subset[[1]]


## SNIP
plot(s)

## estimate baseline
b &lt;- estimateBaseline(s, method="SNIP", iterations=100)

## draw baseline on the plot
lines(b, col="red")


## TopHat
plot(s)

## estimate baseline (try different parameters)
b1 &lt;- estimateBaseline(s, method="TopHat", halfWindowSize=75)
b2 &lt;- estimateBaseline(s, method="TopHat", halfWindowSize=150)

## draw baselines on the plot
lines(b1, col=2)
lines(b2, col=3)

## draw legend
legend(x="topright", lwd=1, legend=paste0("halfWindowSize=", c(75, 150)),
       col=c(2, 3))


## ConvexHull
plot(s)

## estimate baseline
b &lt;- estimateBaseline(s, method="ConvexHull")

## draw baseline on the plot
lines(b, col="red")


## Median
plot(s)

## estimate baseline
b &lt;- estimateBaseline(s, method="median")

## draw baseline on the plot
lines(b, col="red")
</code></pre>


</div>