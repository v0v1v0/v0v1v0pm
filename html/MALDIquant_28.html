<div class="container">

<table style="width: 100%;"><tr>
<td>filterPeaks</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Removes less frequent peaks.
</h2>

<h3>Description</h3>

<p>This function removes infrequently occuring peaks in a list of
<code>MassPeaks</code> objects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">filterPeaks(l, minFrequency, minNumber, labels, mergeWhitelists=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>l</code></td>
<td>

<p><code>list</code>, list of <code>MassPeaks</code> objects.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minFrequency</code></td>
<td>

<p><code>double</code>, remove all peaks which occur in less than
<code>minFrequency*length(l)</code> <code>MassPeaks</code>
objects. It is a relative threshold.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minNumber</code></td>
<td>

<p><code>double</code>, remove all peaks which occur in less than
<code>minNumber</code> <code>MassPeaks</code>
objects. It is an absolute threshold.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>

<p><code>factor</code>, (one for each <code>MassPeaks</code> object)
to do groupwise filtering. The <em>levels</em> of the factor
<code>label</code> define the groups. If not specified a single group is assumed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mergeWhitelists</code></td>
<td>

<p><code>logical</code>, if <code>FALSE</code> the filtering criteria are applied
groupwise. If <code>TRUE</code> peaks that survive the filtering in one group
(level of <code>labels</code>) these peaks are also kept in other groups even if
their frequencies are below <code>minFrequency</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For <code>mergeWhitelists=FALSE</code> the filtering uses a separate peak whitelist
for each group specified by <code>labels</code>, and is done independently in each
group. For <code>mergeWhitelists=TRUE</code> the peak whitelists are combined,
which means that peaks that occur frequently in at least one group are also
kept in all other groups.
</p>
<p>If both <code>minFrequency</code> and <code>minNumber</code> arguments are specified the
more stringent threshold is used.
</p>


<h3>Value</h3>

<p>Returns a <code>list</code> of filtered
<code>MassPeaks</code> objects.
</p>


<h3>Author(s)</h3>

<p>Sebastian Gibb <a href="mailto:mail@sebastiangibb.de">mail@sebastiangibb.de</a>
</p>


<h3>See Also</h3>

<p><code>intensityMatrix</code>,
<code>MassPeaks</code>
</p>
<p>Website: <a href="https://strimmerlab.github.io/software/maldiquant/">https://strimmerlab.github.io/software/maldiquant/</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## load package
library("MALDIquant")

## create four MassPeaks objects and add them to the list
p &lt;- list(createMassPeaks(mass=1:2, intensity=1:2),
          createMassPeaks(mass=1:3, intensity=1:3),
          createMassPeaks(mass=1:4, intensity=1:4),
          createMassPeaks(mass=1:5, intensity=1:5))

## only keep peaks which occur in all MassPeaks objects
filteredPeaks &lt;- filterPeaks(p, minFrequency=1)

## compare result
intensities &lt;- intensityMatrix(filteredPeaks)

## peaks at mass 3,4,5 are removed
all(dim(intensities) == c(4, 2)) # TRUE
all(intensities[,1] == 1)        # TRUE
all(intensities[,2] == 2)        # TRUE

## only keep peaks which occur in all MassPeaks objects in a group
## (e.g. useful for technical replicates)
groups &lt;- factor(c("a", "a", "b", "b"), levels=c("a", "b"))
filteredPeaks &lt;- filterPeaks(p, minFrequency=1, labels=groups)

## peaks at mass 3 were removed in group "a"
filteredPeaks[groups == "a"]

## peaks at mass 5 were removed in group "b"
filteredPeaks[groups == "b"]

## only keep peaks which occur at least twice in a group
groups &lt;- factor(c("a", "a", "b", "b", "b"), levels=c("a", "b"))
filteredPeaks &lt;- filterPeaks(c(p, p[[3]]), minNumber=2, labels=groups)

## peaks at mass 3 were removed in group "a"
filteredPeaks[groups == "a"]

## peaks at mass 5 were removed in group "b"
filteredPeaks[groups == "b"]

## apply different minFrequency arguments to each group
groups &lt;- factor(c("a", "a", "b", "b", "b"), levels=c("a", "b"))
filteredPeaks &lt;- filterPeaks(c(p, p[[3]]), minFrequency=c(1, 2/3), labels=groups)
intensityMatrix(filteredPeaks)
#     1 2  3  4
#[1,] 1 2 NA NA
#[2,] 1 2 NA NA
#[3,] 1 2  3  4
#[4,] 1 2  3  4
#[4,] 1 2  3  4


## demonstrate the use of mergeWhitelists
groups &lt;- factor(c("a", "a", "b", "b"), levels=c("a", "b"))

## default behaviour
filteredPeaks &lt;- filterPeaks(p, minNumber=2, labels=groups)
intensityMatrix(filteredPeaks)
#     1 2  3  4
#[1,] 1 2 NA NA
#[2,] 1 2 NA NA
#[3,] 1 2  3  4
#[4,] 1 2  3  4

## use mergeWhitelists=TRUE to keep peaks of group "a" that match all filtering
## criteria in group "b"
## (please note that mass == 3 is not removed in the second MassPeaks object)
filteredPeaks &lt;- filterPeaks(p, minNumber=2, labels=groups,
                             mergeWhitelists=TRUE)
intensityMatrix(filteredPeaks)
#     1 2  3  4
#[1,] 1 2 NA NA
#[2,] 1 2  3 NA
#[3,] 1 2  3  4
#[4,] 1 2  3  4
</code></pre>


</div>