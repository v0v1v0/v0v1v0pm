<div class="container">

<table style="width: 100%;"><tr>
<td>alignSpectra</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Align MassSpectrum objects.
</h2>

<h3>Description</h3>

<p>This function aligns a list of <code>MassSpectrum</code> objects
(spectra alignment is also known as <em>warping/phase correction</em>). <br></p>


<h3>Usage</h3>

<pre><code class="language-R">alignSpectra(spectra, halfWindowSize=20, noiseMethod="MAD", SNR=2,
  reference, tolerance=0.002, warpingMethod="lowess",
  allowNoMatches=FALSE, emptyNoMatches=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>spectra</code></td>
<td>

<p><code>list</code>, list of <code>MassSpectrum</code> objects.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>halfWindowSize</code></td>
<td>
<p><code>numeric</code>, half window size; see
<code>detectPeaks</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noiseMethod</code></td>
<td>
<p>a noise estimation method; see
<code>detectPeaks</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SNR</code></td>
<td>
<p>single numeric value. <code>SNR</code> is an abbreviation for
<em>s</em>ignal-to-<em>n</em>oise-<em>r</em>atio; see
<code>detectPeaks</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reference</code></td>
<td>

<p><code>MassPeaks</code>, reference object to which the samples
(<code>l</code>) should be aligned. If missing
<code>referencePeaks</code> is used; see
<code>determineWarpingFunctions</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolerance</code></td>
<td>

<p><code>double</code>, maximal relative deviation of a peak position (mass) to be
considered as identical. Must be multiplied by <code>10^-6</code> for ppm,
e.g. use <code>tolerance=5e-6</code> for 5 ppm; see
<code>determineWarpingFunctions</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warpingMethod</code></td>
<td>

<p>used basic warping function; see
<code>determineWarpingFunctions</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allowNoMatches</code></td>
<td>

<p><code>logical</code>, don't throw an error if an <code>MassPeaks</code>
object could not match to the <code>reference</code>; see
<code>determineWarpingFunctions</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>emptyNoMatches</code></td>
<td>

<p><code>logical</code>, if <code>TRUE</code> (default: <code>FALSE</code>)
the intensity values of
<code>MassSpectrum</code> or
<code>MassPeaks</code> objects with missing (<code>NA</code>)
warping functions are set to zero; see
<code>warpMassSpectra</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments to be passed to
<code>detectPeaks,MassSpectrum-method</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>alignSpectra</code> is a wrapper function around
<code>detectPeaks</code>,
<code>determineWarpingFunctions</code> and
<code>warpMassSpectra</code>. Please call these functions
manually if you need finer control (e.g. plotting of warping functions).
</p>


<h3>Value</h3>

<p>Returns a <code>list</code> of aligned <code>MassSpectrum</code> objects.
</p>


<h3>Author(s)</h3>

<p>Sebastian Gibb <a href="mailto:mail@sebastiangibb.de">mail@sebastiangibb.de</a>
</p>


<h3>See Also</h3>

<p><code>detectPeaks</code>,
<code>determineWarpingFunctions</code>,
<code>referencePeaks</code>,
<code>warpMassSpectra</code>,
<code>MassSpectrum</code>
</p>
<p><code>demo("warping")</code>
</p>
<p>Website: <a href="https://strimmerlab.github.io/software/maldiquant/">https://strimmerlab.github.io/software/maldiquant/</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## load package
library("MALDIquant")

## load example data
data("fiedler2009subset", package="MALDIquant")

## running typical workflow

## transform intensities
spectra &lt;- transformIntensity(fiedler2009subset, method="sqrt")

## smooth spectra
spectra &lt;- smoothIntensity(spectra, method="MovingAverage")

## baseline correction
spectra &lt;- removeBaseline(spectra)

## align spectra
spectra &lt;- alignSpectra(spectra)
</code></pre>


</div>