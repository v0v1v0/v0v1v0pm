<div class="container">

<table style="width: 100%;"><tr>
<td>labelPeaks-methods</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Draws peak labels to plot.</h2>

<h3>Description</h3>

<p><code>labelPeaks</code> draws the corresponding mass values on top
of the peaks stored in a <code>MassPeaks</code> object to a plot.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'MassPeaks'
labelPeaks(object,
  index,
  mass,
  labels,
  digits=3, underline=TRUE,
  verticalOffset=abs(diff(par("usr")[3:4]))*0.01,
  absoluteVerticalPos,
  adj=c(0.5, 0), cex=0.7, srt=0,
  avoidOverlap=FALSE,
  arrowLength=0, arrowLwd=0.5, arrowCol=1,
  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p><code>MassPeaks</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p><code>integer</code>/<code>logical</code>, indices of peaks to label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mass</code></td>
<td>
<p><code>numeric</code>, mass of peaks to label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p><code>character</code>, use <code>labels</code> instead of mass values as
peak label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p><code>integer</code>, number of decimal places.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>underline</code></td>
<td>
<p>logical, underline peak values?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verticalOffset</code></td>
<td>
<p><code>numeric</code>, move label vertically (relative to
peak height).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>absoluteVerticalPos</code></td>
<td>
<p><code>numeric</code>, absolute <code>y</code> value for the
label. If missing <code>verticalOffset</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj</code></td>
<td>
<p><code>numeric</code>, adjust text to the left, center, right and top,
center, bottom; see <code>text</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p><code>numeric</code>, font size, see <code>par</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>srt</code></td>
<td>
<p><code>numeric</code>, the label rotation in degrees.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>avoidOverlap</code></td>
<td>
<p><code>logical</code>, try to find label coordinates to avoid
overlap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arrowLength, arrowLwd, arrowCol</code></td>
<td>
<p>arrow parameters, possible vectors.
<code>NA</code> values in <code>arrowCol</code> cause the arrow to be omitted, see
<code>arrows</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments to be passed to <code>text</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Please note that <code>avoidOverlap = TRUE</code> is just supported for
<code>srt %% 90 == 0</code> (means <code>srt</code> has to be a multiple of 90 degree).
</p>


<h3>Author(s)</h3>

<p>Sebastian Gibb</p>


<h3>See Also</h3>

<p><code>MassPeaks</code>,
<code>plot,AbstractMassObject,missing-method</code>
</p>
<p>Website: <a href="https://strimmerlab.github.io/software/maldiquant/">https://strimmerlab.github.io/software/maldiquant/</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## load package
library("MALDIquant")

## create a MassPeaks object from scratch
p &lt;- createMassPeaks(mass=1:20, intensity=sample(x=100:10000, size=20),
                     metaData=list(name="example"))

## plot peaks
plot(p)

## label the first 5 peaks
labelPeaks(p, index=1:5)

## label all peaks in mass range 15 to 20
labelPeaks(p, mass=15:20, underline=FALSE)

## label highest peaks (top 5)
top5 &lt;- intensity(p) %in% sort(intensity(p), decreasing=TRUE)[1:5]
labelPeaks(p, index=top5, col="red")


## real example
data("fiedler2009subset")

## a simplified preprocessing
r &lt;- removeBaseline(fiedler2009subset[[1]])
p &lt;- detectPeaks(r)
plot(p)

## label highest peaks (top 10) and avoid label overlap
top10 &lt;- sort(intensity(p), decreasing=TRUE, index.return=TRUE)$ix[1:10]
labelPeaks(p, index=top10, avoidOverlap=TRUE, digits=1)

## use own labels and rotate by 90 degree
plot(p)
labelPeaks(p, index=top10, labels=paste("TOP", 1:10), underline=FALSE,
           srt=90, adj=c(0, 0.5), col=2)
</code></pre>


</div>