<div class="container">

<table style="width: 100%;"><tr>
<td>calibrateIntensity-methods</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calibrates intensities of a MassSpectrum object.</h2>

<h3>Description</h3>

<p>This function calibrates (normalize) intensities of
<code>MassSpectrum</code> objects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'MassSpectrum'
calibrateIntensity(object,
  method=c("TIC", "PQN", "median"), range, ...)
## S4 method for signature 'list'
calibrateIntensity(object,
  method=c("TIC", "PQN", "median"), range, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p><code>MassSpectrum</code> object or a <code>list</code> of
<code>MassSpectrum</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the calibration method to be used. This should be one of
<code>"TIC"</code>, <code>"PQN"</code> or <code>"median"</code>.
See ‘Details’ section.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range</code></td>
<td>
<p><code>numeric</code> of length 2, if given the scaling factor is
calculated on the mass range from <code>range[1L]</code> to <code>range[2L]</code> and
applied to the whole spectrum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments to be passed to other functions. Currently only
<code>mc.cores</code> is supported if <code>object</code> is a <code>list</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A number of different calibration methods are provided:
</p>

<dl>
<dt>
<code>"TIC"</code>:</dt>
<dd>
<p>The TIC (<em>T</em>otal <em>I</em>on <em>C</em>urrent) of a
<code>MassSpectrum</code> object is set to one. If <code>range</code> is
given the <em>TIC</em> is only calculated for the intensities in the
specified mass range.</p>
</dd>
<dt>
<code>"PQN"</code>:</dt>
<dd>
<p>The PQN (<em>P</em>robabilistic <em>Q</em>uotient
<em>N</em>ormalization) is described in <em>Dieterle et al 2006</em>.
<code>calibrateIntensity</code> uses the following algorithm:
</p>

<ol>
<li>
<p>Calibrate all spectra using the <code>"TIC"</code> calibration.
</p>
</li>
<li>
<p>Calculate a median reference spectrum.
</p>
</li>
<li>
<p>Calculate the quotients of all intensities of the spectra with
those of the reference spectrum.
</p>
</li>
<li>
<p>Calculate the median of these quotients for each spectrum.
</p>
</li>
<li>
<p>Divide all intensities of each spectrum by its median of
quotients.
</p>
</li>
</ol>
</dd>
<dt>
<code>"median"</code>:</dt>
<dd>
<p>The median of intensities of a
<code>MassSpectrum</code> object is set to one.</p>
</dd>
</dl>
<h3>Value</h3>

<p>Returns a modified <code>MassSpectrum</code> object with calibrated
intensities.
</p>


<h3>Author(s)</h3>

<p>Sebastian Gibb <a href="mailto:mail@sebastiangibb.de">mail@sebastiangibb.de</a>
</p>


<h3>References</h3>

<p>F. Dieterle, A. Ross, G. Schlotterbeck, and Hans Senn. 2006.
Probabilistic quotient normalization as robust method to account for
dilution of complex biological mixtures. Application in 1H NMR metabonomics.
Analytical Chemistry 78(13): 4281-4290.
</p>


<h3>See Also</h3>

<p><code>MassSpectrum</code>
</p>
<p>Website: <a href="https://strimmerlab.github.io/software/maldiquant/">https://strimmerlab.github.io/software/maldiquant/</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## load package
library("MALDIquant")

## load example data
data("fiedler2009subset", package="MALDIquant")

## baseline correction
b &lt;- removeBaseline(fiedler2009subset)

## calibrate intensity values
calibrateIntensity(b, method="TIC")

## calibrate intensity values using TIC for a specific mass range
calibrateIntensity(b, method="TIC", range=c(3000, 5000))
</code></pre>


</div>