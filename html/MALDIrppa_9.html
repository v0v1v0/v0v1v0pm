<div class="container">

<table style="width: 100%;"><tr>
<td>peakPatterns</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Display peak presence/absence patterns
</h2>

<h3>Description</h3>

<p>This function displays the patterns of peak presence and absence in an intensity matrix as generated from <code>intensityMatrix</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">peakPatterns(x, abs.lab = NA, barplot = TRUE,
             axis.lab = c("m/z", "Index"), bar.col = "red3",
             cell.col = c("white", "dodgerblue"), grid = FALSE,
             grid.col = "black", grid.lty = "dotted", cex.axis = 0.5,
             cex.lab = 0.5, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>A <code>matrix</code>, <code>data.frame</code> or a list of <code>MassPeaks</code> objects.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abs.lab</code></td>
<td>

<p>Unique label used to denote peak absence in <code>x</code> (<code>NA</code>, default).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>barplot</code></td>
<td>

<p>Logical value indicating whether a barplot of relative peak frequency across samples is displayed (<code>TRUE</code>, default).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis.lab</code></td>
<td>

<p>Vector of axis labels in the <code>c("x", "y")</code> format.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bar.col</code></td>
<td>

<p>Colour of the bars in the barplot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cell.col</code></td>
<td>

<p>Vector of colours for the table cells (format <code>c("col.absence","col.presence")</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>

<p>Logical value indicating whether gridlines are added (<code>FALSE</code>, default).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid.col</code></td>
<td>

<p>Colour of the gridlines (<code>"black"</code>, default).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid.lty</code></td>
<td>

<p>Style of the gridlines (<code>"dotted"</code>, default. See <code>lty</code> in <code>par</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.axis</code></td>
<td>

<p>Axis tick labels scaling factor relative to default.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.lab</code></td>
<td>

<p>Axis labels scaling factor relative to default.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Other arguments.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The peak presence/absence patterns are displayed by rows from the first (top) to the last (bottom) sample in the data set <code>x</code> over the range of common m/z points. Positive peaks are by default represented by coloured cells whereas zero or absent peaks are left blank. A barplot on the top margins shows the relative frequency of a peak at each m/z point across samples.
</p>


<h3>Value</h3>

<p>No return value, graphical output.</p>


<h3>See Also</h3>

<p>See <code>intensityMatrix</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load example data

data(spectra) # list of MassSpectra class objects
data(type) # metadata

# Some pre-processing

sc.results &lt;- screenSpectra(spectra,meta=type)
spectra &lt;- sc.results$fspectra # filtered mass spectra
type &lt;- sc.results$fmeta    # filtered metadata  
spectra &lt;- transformIntensity(spectra, method = "sqrt")
spectra &lt;- wavSmoothing(spectra)
spectra &lt;- removeBaseline(spectra)
peaks &lt;- detectPeaks(spectra)
peaks &lt;- alignPeaks(peaks, minFreq = 0.8)

# Display patterns across all data

peakPatterns(peaks)

# Check results within isolate 280

peakPatterns(peaks[type$Isolate=="280"])

</code></pre>


</div>