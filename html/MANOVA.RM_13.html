<div class="container">

<table style="width: 100%;"><tr>
<td>RM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Tests for Repeated Measures in Semi-Parametric Factorial Designs</h2>

<h3>Description</h3>

<p>The RM() function calculates the Wald-type statistic (WTS), the ANOVA-type 
statistic (ATS) as well as resampling versions of these test statistics for 
semi-parametric repeated measures designs.
</p>


<h3>Usage</h3>

<pre><code class="language-R">RM(
  formula,
  data,
  subject,
  within,
  no.subf,
  iter = 10000,
  alpha = 0.05,
  resampling = "Perm",
  para = FALSE,
  CPU,
  seed,
  CI.method = "t-quantile",
  dec = 3
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A model <code>formula</code> object. The left hand side
contains the response variable and the right hand side contains the factor
variables of interest. The within-subject factor(s)
must be the last factor(s) in the formula, e.g. 
<code>outcome ~ between1 * between2 * within1 * within2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data.frame, list or environment containing the variables in 
<code>formula</code>. Data must be in long format and must not contain missing values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subject</code></td>
<td>
<p>The column name of the subjects in the data. NOTE: Subjects within 
different groups of between-subject factors must have individual labels, see Details for 
more explanation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>within</code></td>
<td>
<p>Specifies the within-subject factor(s) in the formula. Either this
or <code>no.subf</code> must be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no.subf</code></td>
<td>
<p>The number of within-subject factors in the data. Must be specified if
<code>within</code> is omitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>The number of iterations used for calculating the resampled 
statistic. The default option is 10,000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>A number specifying the significance level; the default is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resampling</code></td>
<td>
<p>The resampling method to be used, one of "Perm" (randomly permute 
all observations), "paramBS" (parametric bootstrap approach) and "WildBS" 
(wild bootstrap approach with Rademacher weights). Except for the Wild Bootstrap,
all methods are applied to the WTS only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>para</code></td>
<td>
<p>If parallel computing should be used. Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CPU</code></td>
<td>
<p>The number of cores used for parallel computing. If not specified, cores
are detected via <code>detectCores</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>A random seed for the resampling procedure. If omitted, no 
reproducible seed is set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI.method</code></td>
<td>
<p>The method for calculating the quantiles used for the confidence intervals, 
either "t-quantile" (the default) or "resampling" (the quantile of the resampled WTS).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dec</code></td>
<td>
<p>Number of decimals the results should be rounded to. Default is 3.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The RM() function provides the Wald-type
statistic as well as the ANOVA-type statistic for repeated measures designs
with metric data as described in Friedrich et al. (2017).
These are even applicable for non-normal error terms and/or heteroscedastic
variances. It is implemented for designs with an arbitrary number of 
between-subject (whole-plot) and within-subject (sub-plot) factors and 
allows for different sample sizes. In addition to the
asymptotic p-values, it also provides p-values based on resampling
approaches.
NOTE: The number of within-subject factors or their labels need
to be specified in the function call. If only one factor is 
present, it is assumed that this is a within-subject factor
(e.g. time).
</p>
<p>If subjects in different groups of the between-subject factor have the same id, they will 
not be identified as different subjects and thus it is erroneously assumed that their 
measurements belong to one subject. Example: Consider a study with one between-subject factor 
"treatment" with levels verum and placebo and one within-subject factor "time" (4 measurements).
If subjects in the placebo group are labeled 1-20 and subjects in the verum group have 
the same labels, the program erroneously assumes 20 individuals with 8 measurements each instead of 
40 individuals with 4 measurements each.
</p>


<h3>Value</h3>

<p>An <code>RM</code> object containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Descriptive</code></td>
<td>
<p>Some descriptive statistics of the data for all factor
level combinations. Displayed are the number of individuals per factor
level combination, the mean and 100*(1-alpha)% confidence
intervals (based on t-quantiles).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Covariance</code></td>
<td>
<p>The estimated covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>WTS</code></td>
<td>
<p>The value of the WTS along with degrees of freedom of the central 
chi-square distribution and 
corresponding p-value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ATS</code></td>
<td>
<p>The value of the ATS, degrees of freedom of the central F distribution 
and the corresponding p-value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resampling</code></td>
<td>
<p>p-values for the test statistics based on the chosen resampling
approach.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Friedrich, S., Konietschke, F., and Pauly, M. (2019). Resampling-Based Analysis
of Multivariate Data and Repeated Measures Designs with the R Package MANOVA.RM.
The R Journal, 11(2), 380-400.
</p>
<p>Friedrich, S., Brunner, E. and Pauly, M. (2017). Permuting longitudinal
data in spite of the dependencies. Journal of Multivariate Analysis, 153, 255-265.
</p>
<p>Bathke, A., Friedrich, S., Konietschke, F., Pauly, M., Staffen, W., Strobl, N. and 
Hoeller, Y. (2018). Testing Mean Differences among Groups: Multivariate and Repeated 
Measures Analysis with Minimal Assumptions. Multivariate Behavioral Research, 53(3), 348-359,
Doi: 10.1080/00273171.2018.1446320.
</p>
<p>Friedrich, S., Konietschke, F., Pauly, M. (2017). GFD - An 
R-package for the Analysis of General Factorial Designs. 
Journal of Statistical Software, 79(1), 1-18.
</p>


<h3>See Also</h3>

<p><code>GFD</code>, <code>nparLD</code>, <code>MANOVA</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(o2cons)
## Not run: 
oxy &lt;- RM(O2 ~ Group * Staphylococci * Time, data = o2cons, 
            subject = "Subject", no.subf = 2, iter = 1000,
            resampling = "Perm")
summary(oxy)
plot(oxy, factor = "Group") 
 
# For more details including the output of the examples also refer to the 
# package vignette.

# using the EEG data, consider additional within-subjects factors 'brain region' 
# and 'feature'
data(EEG)
EEG_model &lt;- RM(resp ~ sex * diagnosis * feature * region, 
               data = EEG, subject = "id", within = c("feature", "region"),
               resampling = "WildBS",
               iter = 1000,  alpha = 0.01, seed = 987, dec = 2)
summary(EEG_model)

## End(Not run)

</code></pre>


</div>