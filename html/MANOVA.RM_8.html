<div class="container">

<table style="width: 100%;"><tr>
<td>multRM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Tests for Repeated Measures in Multivariate Semi-Parametric Factorial Designs</h2>

<h3>Description</h3>

<p>The multRM() function calculates the Wald-type statistic (WTS) and the modified ANOVA-type 
statistic (MATS) as well as resampling versions of these test statistics for multivariate
semi-parametric repeated measures designs.
</p>


<h3>Usage</h3>

<pre><code class="language-R">multRM(
  formula,
  data,
  subject,
  within,
  iter = 10000,
  alpha = 0.05,
  resampling = "paramBS",
  para = FALSE,
  CPU,
  seed,
  dec = 3
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A model <code>formula</code> object. The left hand side
contains the matrix of response variables (using cbind()) and the right hand side 
contains the factor variables of interest. The within-subject factors must be specified
last in the formula, e.g. <code>cbind(outcome1, outcome2) ~ between1 * between2 * within1 * within2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data.frame, list or environment containing the variables in 
<code>formula</code>. Data must be in long format and must not contain missing values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subject</code></td>
<td>
<p>The column name of the subjects in the data. NOTE: Subjects within 
different groups of between-subject factors must have individual labels, see Details for 
more explanation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>within</code></td>
<td>
<p>Specifies the within-subject factor(s) in the formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>The number of iterations used for calculating the resampled 
statistic. The default option is 10,000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>A number specifying the significance level; the default is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resampling</code></td>
<td>
<p>The resampling method to be used, one of "paramBS" (parametric bootstrap
approach) and "WildBS" (wild bootstrap approach with Rademacher weights).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>para</code></td>
<td>
<p>If parallel computing should be used. Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CPU</code></td>
<td>
<p>The number of cores used for parallel computing. If not specified, cores
are detected via <code>detectCores</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>A random seed for the resampling procedure. If omitted, no 
reproducible seed is set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dec</code></td>
<td>
<p>Number of decimals the results should be rounded to. Default is 3.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The multRM() function provides the Wald-type
statistic as well as the modified ANOVA-type statistic (Friedrich and Pauly, 2018) for repeated measures
designs with multivariate metric outcomes.
These methods are even applicable for non-normal error terms and/or heteroscedastic
variances. Implemented are designs with an arbitrary number of 
between-subject (whole-plot) and within-subject (sub-plot) factors and the methods
allow for different sample sizes. In addition to the
asymptotic p-values, p-values based on resampling
approaches are provided.
NOTE: The within-subject factors need to be specified in the
function call (<code>within =</code>).
</p>
<p>If subjects in different groups of the between-subject factor have the same id, they will 
not be identified as different subjects and thus it is erroneously assumed that their 
measurements belong to one subject. See <code>RM</code> for more explanations and an example.
</p>


<h3>Value</h3>

<p>A <code>MANOVA</code> object containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Descriptive</code></td>
<td>
<p>Some descriptive statistics of the data for all factor 
level combinations. Displayed are the number of individuals per factor 
level combination and the vector of means (one column per dimension).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Covariance</code></td>
<td>
<p>The estimated covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>WTS</code></td>
<td>
<p>The value of the WTS along with degrees of freedom of the
central chi-square distribution and p-value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MATS</code></td>
<td>
<p>The value of the MATS.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resampling</code></td>
<td>
<p>p-values for the test statistic based on the
chosen resampling approach.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Friedrich, S., Brunner, E. and Pauly, M. (2017). Permuting longitudinal
data in spite of the dependencies. Journal of Multivariate Analysis, 153, 255-265.
</p>
<p>Bathke, A., Friedrich, S., Konietschke, F., Pauly, M., Staffen, W., Strobl, N. and 
Hoeller, Y. (2018). Testing Mean Differences among Groups: Multivariate and Repeated 
Measures Analysis with Minimal Assumptions. Multivariate Behavioral Research, 53(3), 348-359,
Doi: 10.1080/00273171.2018.1446320.
</p>
<p>Friedrich, S., Konietschke, F., Pauly, M. (2017). GFD - An 
R-package for the Analysis of General Factorial Designs. 
Journal of Statistical Software, 79(1), 1-18.
</p>
<p>Friedrich, S., and Pauly, M. (2018). MATS: Inference for potentially singular and
heteroscedastic MANOVA. Journal of Multivariate Analysis, 165, 166-179.
</p>


<h3>See Also</h3>

<p><code>RM</code>, <code>MANOVA</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(EEG)
library(tidyr)
eeg &lt;- spread(EEG, feature, resp)
fit &lt;- multRM(cbind(brainrate, complexity) ~ sex * region, data = eeg, 
              subject = "id", within = "region")
summary(fit)

## End(Not run)

</code></pre>


</div>