<div class="container">

<table style="width: 100%;"><tr>
<td>MARSS-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Multivariate Autoregressive State-Space Model Estimation
</h2>

<h3>Description</h3>

<p>The MARSS package fits time-varying constrained and unconstrained multivariate autoregressive time-series models to multivariate time series data.  To get started quickly, go to the <a href="https://cran.r-project.org/package=MARSS/vignettes/Quick_Start.html">Quick Start Guide</a> (or at the command line, you can type <code>RShowDoc("Quick_Start", package="MARSS")</code>). To open the MARSS User Guide with many vignettes and examples, go to <a href="https://cran.r-project.org/package=MARSS/vignettes/UserGuide.pdf">User Guide</a> (or type <code>RShowDoc("UserGuide",package="MARSS")</code>).  
</p>
<p>The default MARSS model form is a MARXSS model: Multivariate Auto-Regressive(1) eXogenous inputs State-Space model. This model has the following form:
</p>
<p style="text-align: center;"><code class="reqn">\mathbf{x}_{t} = \mathbf{B} \mathbf{x}_{t-1} + \mathbf{u} + \mathbf{C} \mathbf{c}_{t} + \mathbf{G} \mathbf{w}_t, \textrm{ where } \mathbf{W}_t \sim \textrm{MVN}(0,\mathbf{Q})</code>
</p>

<p style="text-align: center;"><code class="reqn">\mathbf{y}_t = \mathbf{Z} \mathbf{x}(t) + \mathbf{a} + \mathbf{D} \mathbf{d}_t + \mathbf{H} \mathbf{v}_t, \textrm{ where } \mathbf{V}_t \sim \textrm{MVN}(0,\mathbf{R})</code>
</p>

<p style="text-align: center;"><code class="reqn">\mathbf{X}_1 \sim \textrm{MVN}(\mathbf{x0}, \mathbf{V0}) \textrm{ or } \mathbf{X}_0 \sim \textrm{MVN}(\mathbf{x0}, \mathbf{V0}) </code>
</p>

<p>All parameters can be time-varying; the <code class="reqn">t</code> subscript is left off the parameters to remove clutter. Note, by default <code class="reqn">\mathbf{V0}</code> is a matrix of all zeros and thus <code class="reqn">\mathbf{x}_1</code> or <code class="reqn">\mathbf{x}_0</code> is treated as an estimated parameter not a diffuse prior.
</p>
<p>The parameter matrices can have fixed values and linear constraints. This is an example of a 3x3 matrix with fixed values and linear constraints. In this example all the matrix elements can be written as a linear function of <code class="reqn">a</code>, <code class="reqn">b</code>, and <code class="reqn">c</code>:
</p>
<p style="text-align: center;"><code class="reqn">\left[\begin{array}{c c c} a+2b &amp; 1 &amp; a\\ 1+3a+b &amp; 0 &amp; b \\ 0 &amp; -2 &amp; c\end{array}\right]</code>
</p>

<p>Values such as <code class="reqn">a b</code> or <code class="reqn">a^2</code> or <code class="reqn">ln(a)</code> are not allowed as those would not be linear.
</p>
<p>The MARSS model parameters, hidden state processes (<code class="reqn">\mathbf{x}</code>), and observations (<code class="reqn">\mathbf{y}</code>) are matrices:
</p>

<ul>
<li> <p><code class="reqn">\mathbf{x}_t</code>, <code class="reqn">\mathbf{x0}</code>, and <code class="reqn">\mathbf{u}</code> are m x 1 
</p>
</li>
<li> <p><code class="reqn">\mathbf{y}_t</code> and <code class="reqn">\mathbf{a}</code> are n x 1 (m&lt;=n)
</p>
</li>
<li> <p><code class="reqn">\mathbf{B}</code> and <code class="reqn">\mathbf{V0}</code> are m x m 
</p>
</li>
<li> <p><code class="reqn">\mathbf{Z}</code> is n x m 
</p>
</li>
<li> <p><code class="reqn">\mathbf{Q}</code> is g x g (default m x m) 
</p>
</li>
<li> <p><code class="reqn">\mathbf{G}</code> is m x g (default m x m identity matrix)
</p>
</li>
<li> <p><code class="reqn">\mathbf{R}</code> is h x h (default n x n)
</p>
</li>
<li> <p><code class="reqn">\mathbf{H}</code> is n x h (default n x n identity matrix)
</p>
</li>
<li> <p><code class="reqn">\mathbf{C}</code> is m x q
</p>
</li>
<li> <p><code class="reqn">\mathbf{D}</code> is n x p
</p>
</li>
<li> <p><code class="reqn">\mathbf{c}_t</code> is q x 1
</p>
</li>
<li> <p><code class="reqn">\mathbf{d}_t</code> is p x 1
</p>
</li>
</ul>
<p>If a parameter is time-varying then the time dimension is the 3rd dimension. Thus a time-varying <code class="reqn">\mathbf{Z}</code> would be n x m x T where T is the length of the data time series.
</p>
<p>The main fitting function is <code>MARSS()</code> which is used to fit a specified model to data and estimate the model parameters.  <code>MARSS()</code> estimates the model parameters using an EM algorithm (primarily but see <code>MARSSoptim()</code>).  Functions are provided for parameter confidence intervals and the observed Fisher Information matrix, smoothed state estimates with confidence intervals, all the Kalman filter and smoother outputs, residuals and residual diagnostics, printing and plotting, and summaries.
</p>


<h3>Details</h3>

<p><strong>Main MARSS functions</strong>:
</p>

<dl>
<dt><code>MARSS()</code></dt>
<dd>
<p> Top-level function for specifying and fitting MARSS models. </p>
</dd> 
<dt><code>coef()</code></dt>
<dd>
<p> Returns the estimated parameters in a variety of formats. </p>
</dd>    
<dt><code>tidy()</code></dt>
<dd>
<p> Parameter estimates with confidence intervals </p>
</dd> 
<dt><code>tsSmooth()</code></dt>
<dd> <p><code class="reqn">\mathbf{x}</code> and <code class="reqn">\mathbf{y}</code> estimates output as a data frame. Output can be conditioned on all the data (<code class="reqn">T</code>), data up to <code class="reqn">t-1</code>, or data up to <code class="reqn">t</code>. From the Kalman filter and smoother output. </p>
</dd> 
<dt><code>fitted()</code></dt>
<dd>
<p> Model x<code class="reqn">\mathbf{x}</code> and <code class="reqn">\mathbf{y}</code> predictions as a data frame or matrices. Another user interface for model predictions is <code>predict.marssMLE</code>. </p>
</dd> 
<dt><code>residuals()</code></dt>
<dd>
<p> Model residuals as a data frame. </p>
</dd> 
<dt><code>MARSSresiduals()</code></dt>
<dd>
<p> Model residuals as a data frame or matrices. Normal user interface to residuals is <code>residuals.marssMLE</code>.</p>
</dd> 
<dt><code>predict()</code></dt>
<dd>
<p> Predictions and forecasts from a <code>marssMLE</code> object. </p>
</dd> 
<dt>
<code>plot for marssMLE</code> </dt>
<dd>
<p> A series of plots of fits and residuals diagnostics. </p>
</dd> 
<dt>
<code>autoplot()</code> </dt>
<dd>
<p> A series of plots using ggplot2 of fits and residuals diagnostics. </p>
</dd> 
<dt><code>glance()</code></dt>
<dd>
<p> Brief summary of fit. </p>
</dd> 
<dt><code>logLik()</code></dt>
<dd>
<p> Log-likelihood. </p>
</dd>
<dt><code>print()</code></dt>
<dd>
<p> Prints a wide variety of output from a <code>marssMLE</code> object. </p>
</dd>
<dt><code>print.marssMODEL()</code></dt>
<dd>
<p> Prints description of the MARSS model (<code>marssMODEL</code> object). </p>
</dd>
<dt><code>plot.marssPredict()</code></dt>
<dd>
<p> Plot a prediction or forecast. </p>
</dd> 
<dt><code>toLatex.marssMODEL()</code></dt>
<dd>
<p> Outputs a LaTeX version of the model. </p>
</dd>
</dl>
<p><strong>Other outputs for a fitted model</strong>:
</p>

<dl>
<dt><code>MARSSsimulate()</code></dt>
<dd>
<p> Produces simulated data from a MARSS model. </p>
</dd> 
<dt>
<code>MARSSkf()</code>, <code>MARSSkfas()</code>, <code>MARSSkfss()</code> </dt>
<dd>
<p> Kalman filters and smoothers with extensive output of all the intermediate filter and smoother variances and expectations. </p>
</dd> 
<dt><code>MARSSaic()</code></dt>
<dd>
<p> Calculates AICc, AICc, and various bootstrap AICs. </p>
</dd> 
<dt><code>MARSSparamCIs()</code></dt>
<dd>
<p> Adds confidence intervals to a <code>marssMLE</code> object. </p>
</dd>
<dt><code>MARSShessian()</code></dt>
<dd>
<p> Computes an estimate of the variance-covariance matrix for the MLE parameters. </p>
</dd>    
<dt><code>MARSSFisherI()</code></dt>
<dd>
<p> Returns the observed Fisher Information matrix. </p>
</dd>    
</dl>
<p><strong>Important internal MARSS functions (called by the above functions)</strong>:
</p>

<dl>
<dt><code>MARSSkem()</code></dt>
<dd>
<p> Estimates MARSS parameters using an EM algorithm. </p>
</dd> 
<dt><code>MARSSoptim()</code></dt>
<dd>
<p> Estimates MARSS parameters using a quasi-Newton algorithm via <code>optim</code>. </p>
</dd> 
<dt><code>MARSShatyt()</code></dt>
<dd>
<p> Calculates the expectations involving Y. </p>
</dd> 
<dt><code>MARSSinnovationsboot()</code></dt>
<dd>
<p> Creates innovations bootstrapped data. </p>
</dd>
<dt><code>MARSS.marss()</code></dt>
<dd>
<p> Discusses the form in which MARSS models are stored internally. </p>
</dd>
</dl>
<p>Use <code>help.search("internal", package="MARSS")</code> to see the documentation of all the internal functions in the MARSS R package.
</p>


<h3>Author(s)</h3>

<p>Eli Holmes, Eric Ward and Kellie Wills, NOAA, Seattle, USA.
</p>


<h3>References</h3>

<p>The MARSS User Guide:  Holmes, E. E., E. J. Ward, and M. D. Scheuerell (2012) Analysis of multivariate time-series using the MARSS package. NOAA Fisheries, Northwest Fisheries Science
Center, 2725 Montlake Blvd E., Seattle, WA 98112   <a href="https://cran.r-project.org/package=MARSS/vignettes/UserGuide.pdf">User Guide</a> or type <code>RShowDoc("UserGuide",package="MARSS")</code> to open a copy.
</p>
<p>The MARSS Quick Start Guide:  <a href="https://cran.r-project.org/package=MARSS/vignettes/Quick_Start.html">Quick Start Guide</a> or type <code>RShowDoc("Quick_Start",package="MARSS")</code> to open a copy.
</p>


</div>