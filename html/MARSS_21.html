<div class="container">

<table style="width: 100%;"><tr>
<td>forecast.marssMLE</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> forecast function for marssMLE objects </h2>

<h3>Description</h3>

<p><code>MARSS()</code> outputs <code>marssMLE</code> objects.  <code>forecast(object)</code>, where object is <code>marssMLE</code> object, will return the forecasts of <code class="reqn">\mathbf{y}_t</code> or <code class="reqn">\mathbf{x}_t</code> for <code>h</code> steps past the end of the model data. <code>forecast(object)</code> returns a <code>marssPredict</code> object which can be passed to <code>plot.marssPredict</code> for automatic plotting of the forecast. <code>forecast.marssMLE()</code> is used by <code>predict.marssMLE()</code> to generate forecasts.
</p>
<p>This is a method for the generic <code>forecast</code> function in the generics package. It is written to mimic the behavior and look of the forecast package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'marssMLE'
forecast(object, h = 10, level = c(0.8, 0.95), 
     type = c("ytT","xtT", "ytt", "ytt1", "xtt", "xtt1"), 
     newdata = list(y = NULL, c = NULL, d = NULL), 
     interval = c("prediction", "confidence", "none"), 
     fun.kf = c("MARSSkfas", "MARSSkfss"), ...)
   </code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p> A <code>marssMLE</code> object.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p> Number of steps ahead to forecast. <code>newdata</code> is for the forecast, i.e. for the <code class="reqn">h</code> time steps after the end of the model data. If there are covariates in the model, <code class="reqn">\mathbf{c}_t</code> or <code class="reqn">\mathbf{d}_t</code>, then <code>newdata</code> is required. See details. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p> Level for the intervals if <code>interval != "none"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p> The default for observations would be <code>type="ytT"</code> and for the states would be <code>type="xtT"</code>, i.e. using all the data. Other possible forecasts are provided for completeness but would in most cases be identical (see details). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p> An optional list with matrices for new covariates <code class="reqn">\mathbf{c}_t</code> or <code class="reqn">\mathbf{d}_t</code> to use for the forecasts. <code class="reqn">\mathbf{c}_t</code> or <code class="reqn">\mathbf{d}_t</code> must be in the original model and have the same matrix rows and columns as used in the <code>MARSS()</code> call but the number of time steps can be different (and should be equal to <code>h</code>). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval</code></td>
<td>
<p> If <code>interval="confidence"</code>, then the standard error and confidence interval of the expected value of <code class="reqn">\mathbf{y}_t</code> (<code>type="ytT"</code>) or <code class="reqn">\mathbf{x}_t</code> (<code>type="xtT"</code>) is returned. <code>interval="prediction"</code> (default) returns prediction intervals which include the uncertainty in the expected value and due to observation error (the <code class="reqn">\mathbf{R}</code> in the <code class="reqn">\mathbf{y}</code> equation). Note, in the context of a MARSS model, only confidence intervals are available for the states (the <code class="reqn">\mathbf{x}</code>). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fun.kf</code></td>
<td>
<p> Only if you want to change the default Kalman filter. Can be ignored. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> Other arguments. Not used. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>type="ytT"</code> forecast for <code class="reqn">T+i</code>  is 
</p>
<p style="text-align: center;"><code class="reqn">\mathbf{Z}\mathbf{x}_{T+i}^T + \mathbf{a} + \mathbf{D}\mathbf{d}_{T+i}</code>
</p>

<p>where <code class="reqn">\mathbf{Z}</code>, <code class="reqn">\mathbf{a}</code> and <code class="reqn">\mathbf{D}</code> are estimated from the data from <code class="reqn">t=1</code> to <code class="reqn">T</code>. If the model includes <code class="reqn">\mathbf{d}_t</code> then <code>newdata</code> with <code>d</code> must be passed in. Either confidence or prediction intervals can be shown. Prediction intervals would be the norm for forecasts and show the intervals for new data which based on the conditional variance of <code class="reqn">\mathbf{Z}\mathbf{X}_{T+i} + \mathbf{V}_{T+i}</code>. Confidence intervals would show the variance of the mean of the new data (such as if you ran a simulation multiple times and recorded only the mean observation time series). It is based on the conditional variance of <code class="reqn">\mathbf{Z}\mathbf{X}_{T+i}</code>. The intervals shown are computed with <code>fitted()</code>.
</p>
<p>The <code>type="xtT"</code> forecast for <code class="reqn">T+i</code>  is 
</p>
<p style="text-align: center;"><code class="reqn">\mathbf{B}\mathbf{x}_{T+i-1}^T + \mathbf{u} + \mathbf{C}\mathbf{c}_{T+i}</code>
</p>

<p>where <code class="reqn">\mathbf{B}</code> and <code class="reqn">\mathbf{u}</code> and <code class="reqn">\mathbf{C}</code> are estimated from the data from <code class="reqn">t=1</code> to <code class="reqn">T</code> (i.e. the estimates in the marssMLE object). If the model includes <code class="reqn">\mathbf{c}_t</code> then <code>newdata</code> with <code>c</code> must be passed in. The only intervals are confidence intervals which based on the conditional variance of <code class="reqn">\mathbf{B}\mathbf{X}_{T+i-1} + \mathbf{W}_{T+i}</code>. If you pass in data for your forecast time steps, then the forecast will be computed conditioned on the original data plus the data in the forecast period. The intervals shown are computed with the Kalman smoother (or filter if <code>type="xtt"</code> or <code>type="xtt1"</code> specified) via <code>tsSmooth()</code>.
</p>
<p>If the model has time-varying parameters, the parameter estimates at time <code class="reqn">T</code> will be used for the whole forecast. If new data <code>c</code> or <code>d</code> are passed in, it must have <code>h</code> time steps. 
</p>
<p>Note: <code>y</code> in <code>newdata</code>. Data along with covariates can be passed into <code>newdata</code>. In this case, the data in <code>newdata</code> (<code class="reqn">T+1</code> to <code class="reqn">T+h</code>) are conditioned on for the expected value of <code class="reqn">\mathbf{X}_t</code>
but parameters used are only estimated using the data in the marssMLE object (<code class="reqn">t=1</code> to <code class="reqn">T</code>). If you include data in <code>newdata</code>, you need to decide how to condition on that
new data for the forecast. <code>type="ytT"</code> would mean that the <code class="reqn">t=T+i</code> forecast is conditioned on all the data, <code class="reqn">t=1</code> to <code class="reqn">T+h</code>, <code>type="ytt"</code> would mean that the
<code class="reqn">t=T+i</code> forecast is conditioned on the data, <code class="reqn">t=1</code> to <code class="reqn">T+i</code>, and <code>type="ytt1"</code> would mean that the <code class="reqn">t=T+i</code> forecast is conditioned on the data, <code class="reqn">t=1</code> to <code class="reqn">T+i-1</code>. Because MARSS models can be used in all sorts of systems, the <code class="reqn">\mathbf{y}</code> part of the MARSS model might not be "data" in the traditional sense. In some cases, one of the <code class="reqn">\mathbf{y}</code> (in a multivariate model) might be a known deterministic process or it might be a simulated future <code class="reqn">\mathbf{y}</code> that you want to include. In this case the
<code class="reqn">\mathbf{y}</code> rows that are being forecasted are NAs and the <code class="reqn">\mathbf{y}</code> rows that are known are passed in with <code>newdata</code>.
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The method used for fitting, e.g. "kem". </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>The <code>marssMLE</code> object passed into <code>forecast.marssMLE()</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>The <code>newdata</code> list if passed into <code>forecast.marssMLE()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>The confidence <code>level</code> passed into <code>forecast.marssMLE()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred</code></td>
<td>
<p>A data frame the forecasts along with the intervals. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>The <code>type</code> ("ytT" or "xtT") passed into <code>forecast.marssMLE()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>The time steps used to fit the model (used for plotting).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>The number of forecast time steps (used for plotting).</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

 
<p>Eli Holmes, NOAA, Seattle, USA.  
</p>


<h3>See Also</h3>

<p><code>plot.marssPredict()</code>, <code>predict.marssMLE()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># More examples are in ?predict.marssMLE

dat &lt;- t(harborSealWA)
dat &lt;- dat[2:4,] #remove the year row
fit &lt;- MARSS(dat, model=list(R="diagonal and equal"))

# 2 steps ahead forecast
fr &lt;- forecast(fit, type="ytT", h=2)
plot(fr)

# forecast and only show last 10 steps of original data
fr &lt;- forecast(fit, h=10)
plot(fr, include=10)

</code></pre>


</div>