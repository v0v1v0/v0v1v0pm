<div class="container">

<table style="width: 100%;"><tr>
<td>MARSS.dfa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Multivariate Dynamic Factor Analysis </h2>

<h3>Description</h3>

<p>The Dynamic Factor Analysis model in MARSS is
The argument <code>form="marxss"</code> in a <code>MARSS()</code> function call specifies a MAR-1 model with eXogenous variables model.  This is a MARSS(1) model of the form:
</p>
<p style="text-align: center;"><code class="reqn">\mathbf{x}_{t} = \mathbf{x}_{t-1} + \mathbf{w}_t, \textrm{ where } \mathbf{W}_t \sim \textrm{MVN}(0,\mathbf{I})</code>
</p>

<p style="text-align: center;"><code class="reqn">\mathbf{y}_t = \mathbf{Z}_t \mathbf{x}_t + \mathbf{D}_t \mathbf{d}_t + \mathbf{v}_t, \textrm{ where } \mathbf{V}_t \sim \textrm{MVN}(0,\mathbf{R}_t)</code>
</p>

<p style="text-align: center;"><code class="reqn">\mathbf{X}_1 \sim \textrm{MVN}(\mathbf{x0}, 5\mathbf{I})</code>
</p>

<p>Note, by default <code class="reqn">\mathbf{x}_1</code> is treated as a diffuse prior.
</p>
<p>Passing in <code>form="dfa"</code> to <code>MARSS()</code> invokes a helper function to create that model and creates the <code class="reqn">\mathbf{Z}</code> matrix for the user.  <code class="reqn">\mathbf{Q}</code> is by definition identity, <code class="reqn">\mathbf{x}_0</code> is zero and <code class="reqn">\mathbf{V_0}</code> is diagonal with large variance (5). <code class="reqn">\mathbf{u}</code> is zero, <code class="reqn">\mathbf{a}</code> is zero, and covariates only enter the <code class="reqn">\mathbf{y}</code> equation.  Because <code class="reqn">\mathbf{u}</code> and <code class="reqn">\mathbf{a}</code> are 0, the data should have mean 0 (demeaned) otherwise one is likely to be creating a structurally inadequate model (i.e. the model implies that the data have mean = 0, yet data do not have mean = 0 ).
</p>


<h3>Arguments</h3>

<p>Some arguments are common to all forms: "y" (data), "inits", "control", "method", "form", "fit", "silent", "fun.kf". See <code>MARSS</code> for information on these arguments.
</p>
<p>In addition to these, form="dfa" has some special arguments that can be passed in:
</p>

<ul>
<li> <p><code>demean</code>  Logical.  Default is TRUE, which means the data will be demeaned.
</p>
</li>
<li> <p><code>z.score</code>  Logical.  Default is TRUE, which means the data will be z-scored (demeaned and variance standardized to 1).
</p>
</li>
<li> <p><code>covariates</code>  Covariates (<code class="reqn">d</code>) for the <code class="reqn">y</code> equation. No missing values allowed and must be a matrix with the same number of time steps as the data. An unconstrained <code class="reqn">D</code> matrix will estimated.
</p>
</li>
</ul>
<p>The <code>model</code> argument of the <code>MARSS()</code> call is constrained in terms of what parameters can be changed and how they can be changed.  See details below. An additional element, <code>m</code>, can be passed into the <code>model</code> argument that specifies the number of hidden state variables.  It is not necessarily for the user to specify <code>Z</code> as the helper function will create a <code>Z</code> appropriate for a DFA model.
</p>


<h3>Details</h3>

<p>The <code>model</code> argument is a list. The following details what list elements can be passed in:
</p>

<ul>
<li> <p><code>B</code>  "Identity". The standard (and default) DFA model has B="identity". However it can be "identity", "diagonal and equal", "diagonal and unequal"  or a time-varying fixed or estimated diagonal matrix.
</p>
</li>
<li> <p><code>U</code>  "Zero". Cannot be changed or passed in via model argument.
</p>
</li>
<li> <p><code>Q</code>  "Identity". The standard (and default) DFA model has Q="identity". However, it can be "identity", "diagonal and equal", "diagonal and unequal" or a time-varying fixed or estimated diagonal matrix.
</p>
</li>
<li> <p><code>Z</code>  Can be passed in as a (list) matrix if the user does not want a default DFA <code>Z</code> matrix.  There are many equivalent ways to construct a DFA <code>Z</code> matrix.  The default is Zuur et al.'s form (see User Guide).
</p>
</li>
<li> <p><code>A</code>  Default="zero". Can be "unequal", "zero" or a matrix.
</p>
</li>
<li> <p><code>R</code>  Default="diagonal and equal". Can be set to "identity", "zero", "unconstrained", "diagonal and unequal", "diagonal and equal", "equalvarcov", or a (list) matrix to specify general forms.
</p>
</li>
<li> <p><code>x0</code> Default="zero". Can be "unconstrained", "unequal", "zero", or a (list) matrix.
</p>
</li>
<li> <p><code>V0</code> Default=diagonal matrix with 5 on the diagonal. Can be "identity", "zero", or a matrix.
</p>
</li>
<li> <p><code>tinitx</code> Default=0. Can be 0 or 1.  Tells MARSS whether x0 is at t=0 or t=1.
</p>
</li>
<li> <p><code>m</code> Default=1. Can be 1 to n (the number of y time-series). Must be integer.
</p>
</li>
</ul>
<p>See the <a href="https://cran.r-project.org/package=MARSS/vignettes/UserGuide.pdf">User Guide</a> chapter on Dynamic Factor Analysis for examples of of using <code>form="dfa"</code>.
</p>


<h3>Value</h3>

<p>A object of class <code>marssMLE</code>.  See <code>print()</code> for a discussion of the various output available for <code>marssMLE</code> objects (coefficients, residuals, Kalman filter and smoother output, imputed values for missing data, etc.).  See <code>MARSSsimulate()</code> for simulating from <code>marssMLE</code> objects. <code>MARSSboot()</code> for bootstrapping, <code>MARSSaic()</code> for calculation of various AIC related model selection metrics, and <code>MARSSparamCIs()</code> for calculation of confidence intervals and bias. 
</p>


<h3>Usage</h3>

<p><code>MARSS(y, 
    inits = NULL, 
    model = NULL, 
    miss.value = as.numeric(NA), 
    method = "kem", 
    form = "dfa", 
    fit = TRUE, 
    silent = FALSE, 
    control = NULL, 
    fun.kf = "MARSSkfas", 
    demean = TRUE, 
    z.score = TRUE)</code>
</p>


<h3>Author(s)</h3>

 
<p>Eli Holmes, NOAA, Seattle, USA. 
</p>


<h3>References</h3>

 
<p>The MARSS User Guide:  Holmes, E. E., E. J. Ward, and M. D. Scheuerell (2012) Analysis of multivariate time-series using the MARSS package. NOAA Fisheries, Northwest Fisheries Science
Center, 2725 Montlake Blvd E., Seattle, WA 98112   Type <code>RShowDoc("UserGuide",package="MARSS")</code> to open a copy.          
</p>


<h3>See Also</h3>

 <p><code>MARSS()</code>, <code>MARSS.marxss()</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
dat &lt;- t(harborSealWA[,-1])
# DFA with 3 states; used BFGS because it fits much faster for this model
fit &lt;- MARSS(dat, model = list(m=3), form="dfa", method="BFGS")

# See the Dynamic Factor Analysis chapter in the User Guide
RShowDoc("UserGuide", package = "MARSS")

## End(Not run)
</code></pre>


</div>