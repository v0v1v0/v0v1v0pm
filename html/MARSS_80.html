<div class="container">

<table style="width: 100%;"><tr>
<td>MARSSinnovationsboot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Bootstrapped Data using Stoffer and Wall's Algorithm </h2>

<h3>Description</h3>

<p>Creates bootstrap data via sampling from the standardized innovations matrix.   This is an internal function in the <code>MARSS-package</code> and is not exported. Users should access this with <code>MARSSboot</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MARSSinnovationsboot(MLEobj, nboot = 1000, minIndx = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>MLEobj</code></td>
<td>
<p> An object of class <code>marssMLE</code>. This object must have a <code>$par</code> element containing MLE parameter estimates from e.g. <code>MARSSkem()</code> or <code>MARSS()</code>. This algorithm may not be used if there are missing datapoints in the data. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot</code></td>
<td>
<p> Number of bootstraps to perform. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minIndx</code></td>
<td>
<p> Number of innovations to skip. Stoffer &amp; Wall suggest not sampling from innovations 1-3. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Stoffer and Wall (1991) present an algorithm for generating CIs via a non-parametric bootstrap for state-space models.  The basic idea is that the Kalman filter can be used to generate estimates of the residuals of the model fit.  These residuals are then standardized and resampled and used to generate bootstrapped data using the MARSS model and its maximum-likelihood parameter estimates.  One of the limitations of the Stoffer and Wall algorithm is that it cannot be used when there are missing data, unless all data at time <code class="reqn">t</code> are missing.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>boot.states</code></td>
<td>
<p> Array (dim is m x tSteps x nboot) of simulated state processes. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot.data</code></td>
<td>
<p> Array (dim is n x tSteps x nboot) of simulated data. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marss</code></td>
<td>
 <p><code>marssMODEL</code> object element of the <code>marssMLE</code> object (<code>marssMLE$marss</code>) in "marss" form. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot</code></td>
<td>
<p> Number of bootstraps performed. </p>
</td>
</tr>
</table>
<p>m is the number state processes (x in the MARSS model) and n is the number of observation time series (y in the MARSS model).
</p>


<h3>Author(s)</h3>

 
<p>Eli Holmes and Eric Ward, NOAA, Seattle, USA.  
</p>


<h3>References</h3>

 
<p>Stoffer, D. S., and K. D. Wall. 1991. Bootstrapping state-space models: Gaussian maximum likelihood estimation and the Kalman filter. Journal of the American Statistical Association 86:1024-1033.
</p>


<h3>See Also</h3>

 <p><code>stdInnov()</code>, <code>MARSSparamCIs()</code>, <code>MARSSboot()</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">dat &lt;- t(kestrel)
dat &lt;- dat[2:3, ]
fit &lt;- MARSS(dat, model = list(U = "equal", Q = diag(.01, 2)))
boot.obj &lt;- MARSSinnovationsboot(fit)
</code></pre>


</div>