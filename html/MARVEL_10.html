<div class="container">

<table style="width: 100%;"><tr>
<td>AssignModality</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Assign modalities</h2>

<h3>Description</h3>

<p>Assigns modalities to each splicing event for a specified group of cells.
</p>


<h3>Usage</h3>

<pre><code class="language-R">AssignModality(
  MarvelObject,
  sample.ids,
  min.cells = 25,
  sigma.sq = 0.001,
  bimodal.adjust = TRUE,
  bimodal.adjust.fc = 3,
  bimodal.adjust.diff = 50,
  seed = 1,
  tran_ids = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>MarvelObject</code></td>
<td>
<p>Marvel object. S3 object generated from <code>TransformExpValues</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample.ids</code></td>
<td>
<p>Vector of character strings. Sample IDs that constitute the cell group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.cells</code></td>
<td>
<p>Numeric value. The minimum no. of cells expressing the splicing event for the event to be included for modality assignment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.sq</code></td>
<td>
<p>Numeric value. The variance threshold below which the included/excluded modality will be defined as primary sub-modality, and above which it will be defined as dispersed sub-modality.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bimodal.adjust</code></td>
<td>
<p>Logical. When set to <code>TRUE</code>, MARVEL will identify false bimodal modalities and reassign them as included/excluded modality.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bimodal.adjust.fc</code></td>
<td>
<p>Numeric value. The ratio between the proportion of cells with &gt;0.75 PSI vs &lt;0.25 PSI (and vice versa) below which the splicing event will be classified as bimodal. Only applicable when <code>bimodal.adjust</code> set to <code>TRUE</code>. To be used in conjunction with <code>bimodal.adjust.diff</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bimodal.adjust.diff</code></td>
<td>
<p>Numeric value. The difference between the percentage of cells with &gt;0.75 PSI vs &lt;0.25 PSI (and vice versa) below which the splicing event will be classified as bimodal. Only applicable when <code>bimodal.adjust</code> set to <code>TRUE</code>. To be used in conjunction with <code>bimodal.adjust.fc</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Numeric value. Ensure the <code>fitdist</code> function returns the same values for alpha and beta paramters each time this function is executed using the same random number generator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tran_ids</code></td>
<td>
<p>Character strings. Specific vector of transcript IDs for modality assignment. This will be a subset of all transcripts expressed in sufficient number of cells as defined in <code>min.cells</code> option.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class S3 containing with new slot <code>MarvelObject$Modality$Results</code>.
</p>


<h3>Author(s)</h3>

<p>Sean Wen &lt;sean.wenwx@gmail.com&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">marvel.demo &lt;- readRDS(system.file("extdata/data", "marvel.demo.rds", package="MARVEL"))

df.pheno &lt;- marvel.demo$SplicePheno
sample.ids &lt;- df.pheno[which(df.pheno$cell.type=="iPSC"), "sample.id"]

# Assign modality
marvel.demo &lt;- AssignModality(MarvelObject=marvel.demo,
                              sample.ids=sample.ids,
                              min.cells=5
                              )

# Check output
head(marvel.demo$Modality$Results)
</code></pre>


</div>