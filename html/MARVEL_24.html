<div class="container">

<table style="width: 100%;"><tr>
<td>CompareValues.Exp.Spliced</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Differential gene expression analysis for differentially spliced genes</h2>

<h3>Description</h3>

<p>Performs differential gene expression analysis between 2 groups of cells only on differentially spliced genes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CompareValues.Exp.Spliced(
  MarvelObject,
  cell.group.g1 = NULL,
  cell.group.g2 = NULL,
  psi.method,
  psi.pval,
  psi.delta,
  method.de.gene = "wilcox",
  method.adjust.de.gene = "fdr",
  downsample = FALSE,
  seed = 1,
  show.progress = TRUE,
  mast.method = "bayesglm",
  mast.ebayes = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>MarvelObject</code></td>
<td>
<p>Marvel object. S3 object generated from <code>TransformExpValues</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cell.group.g1</code></td>
<td>
<p>Vector of character strings. Cell IDs corresponding to Group 1 (reference group).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cell.group.g2</code></td>
<td>
<p>Vector of character strings. Cell IDs corresponding to Group 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi.method</code></td>
<td>
<p>Vector of character string(s). To include significant events from these method(s) for differential gene expression analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi.pval</code></td>
<td>
<p>Vector of numeric value(s). The adjusted p-value, below which, the splicing event is considered differentially spliced, and the corresponding genes will be included for differential gene expression analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi.delta</code></td>
<td>
<p>Numeric value. The absolute difference in mean PSI values between <code>cell.group.g1</code> and <code>cell.group.g1</code>, above which, the splicing event is considered differentially spliced, and the corresponding genes will be included for differential gene expression analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method.de.gene</code></td>
<td>
<p>Character string. Same as <code>method</code> in <code>CompareValues</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method.adjust.de.gene</code></td>
<td>
<p>Character string. Same as <code>method</code> in <code>CompareValues</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>downsample</code></td>
<td>
<p>Logical value. If set to <code>TRUE</code>, the number of cells in each cell group will be downsampled to the sample size of the smaller cell group so that both cell groups will have the sample size prior to differential expression analysis. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Numeric value. The seed number for the random number generator to ensure reproducibility during during down-sampling of cells when <code>downsample</code> set to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.progress</code></td>
<td>
<p>Logical value. If set to <code>TRUE</code>, progress bar will be displayed so that users can estimate the time needed for differential analysis. Default value is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mast.method</code></td>
<td>
<p>Character string. As per the <code>method</code> option of the <code>zlm</code> function from the <code>MAST</code> package. Default is <code>"bayesglm"</code>, other options are <code>"glm"</code> and <code>"glmer"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mast.ebayes</code></td>
<td>
<p>Logical value. As per the <code>ebayes</code> option of the <code>zlm</code> function from the <code>MAST</code> package. Default is <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class S3 new slot <code>MarvelObject$DE$Exp$Table</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">marvel.demo &lt;- readRDS(system.file("extdata/data", "marvel.demo.rds", package="MARVEL"))

# Define cell groups for analysis
df.pheno &lt;- marvel.demo$SplicePheno
cell.group.g1 &lt;- df.pheno[which(df.pheno$cell.type=="iPSC"), "sample.id"]
cell.group.g2 &lt;- df.pheno[which(df.pheno$cell.type=="Endoderm"), "sample.id"]

# DE
marvel.demo &lt;- CompareValues.Exp.Spliced(MarvelObject=marvel.demo,
                                         cell.group.g1=cell.group.g1,
                                         cell.group.g2=cell.group.g2,
                                         psi.method="ad",
                                         psi.pval=0.10,
                                         psi.delta=0,
                                         method.de.gene="t.test",
                                         method.adjust.de.gene="fdr",
                                         show.progress=FALSE
                                         )

# Check output
head(marvel.demo$DE$Exp.Spliced$Table)
</code></pre>


</div>