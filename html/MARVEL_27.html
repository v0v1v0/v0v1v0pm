<div class="container">

<table style="width: 100%;"><tr>
<td>CompareValues.SJ.10x</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Differential splice junction analysis</h2>

<h3>Description</h3>

<p>Performs differential splice junction analysis between two groups of cells.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CompareValues.SJ.10x(
  MarvelObject,
  coord.introns = NULL,
  cell.group.g1,
  cell.group.g2,
  min.pct.cells.genes = 10,
  min.pct.cells.sj = 10,
  min.gene.norm = 1,
  seed = 1,
  n.iterations = 100,
  downsample = FALSE,
  show.progress = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>MarvelObject</code></td>
<td>
<p>Marvel object. S3 object generated from <code>CheckAlignment.10x</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coord.introns</code></td>
<td>
<p>Character strings. Specific splice junctions to be included for analysis. Default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cell.group.g1</code></td>
<td>
<p>Vector of Character strings. Cell IDs corresponding to Group 1 (reference group).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cell.group.g2</code></td>
<td>
<p>Vector of Character strings. Cell IDs corresponding to Group 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.pct.cells.genes</code></td>
<td>
<p>Numeric value. Minimum percentage of cells in which the gene is expressed for that gene to be included for splice junction expression distribution analysis. Expressed genes defined as genes with non-zero normalised UMI counts. This threshold may be determined from <code>PlotPctExprCells.SJ.10x</code> function. Default is <code>10</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.pct.cells.sj</code></td>
<td>
<p>Numeric value. Minimum percentage of cells in which the splice junction is expressed for that splice junction to be included for splice junction expression distribution analysis. Expressed splice junctions defined as splice junctions with raw UMI counts &gt;= 1. This threshold may be determined from <code>PlotPctExprCells.SJ.10x</code> function. Default is <code>10</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.gene.norm</code></td>
<td>
<p>Numeric value. The average normalised gene expression across the two cell groups above which the splice junction will be included for analysis. Default is <code>1.0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Numeric value. Random number generator to be fixed for permutations test and down-sampling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.iterations</code></td>
<td>
<p>Numeric value. Number of times to shuffle the cell group labels when building the null distribution. Default is <code>100</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>downsample</code></td>
<td>
<p>Logical value. If set to <code>TRUE</code>, both cell groups will be down-sampled so that both cell groups will have the same number of cells. The number of cells to downsample will be based on the smallest cell group. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.progress</code></td>
<td>
<p>Logical value. If set to <code>TRUE</code> (default), the progress bar will appear.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class S3 with a new slots <code>MarvelObject$DE$SJ$Table</code>, <code>MarvelObject$DE$SJ$cell.group.g1</code>, and <code>MarvelObject$DE$SJ$cell.group.g2</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
marvel.demo.10x &lt;- readRDS(system.file("extdata/data",
                               "marvel.demo.10x.rds",
                               package="MARVEL")
                               )

# Define cell groups
    # Retrieve sample metadata
    sample.metadata &lt;- marvel.demo.10x$sample.metadata

    # Group 1 (reference)
    index &lt;- which(sample.metadata$cell.type=="iPSC")
    cell.ids.1 &lt;- sample.metadata[index, "cell.id"]
    length(cell.ids.1)

    # Group 2
    index &lt;- which(sample.metadata$cell.type=="Cardio day 10")
    cell.ids.2 &lt;- sample.metadata[index, "cell.id"]
    length(cell.ids.2)

# DE
marvel.demo.10x &lt;- CompareValues.SJ.10x(
                        MarvelObject=marvel.demo.10x,
                        cell.group.g1=cell.ids.1,
                        cell.group.g2=cell.ids.2,
                        min.pct.cells.genes=10,
                        min.pct.cells.sj=10,
                        min.gene.norm=1.0,
                        seed=1,
                        n.iterations=100,
                        downsample=TRUE,
                        show.progress=FALSE
                        )

# Check output
head(marvel.demo.10x$DE$SJ$Table)
</code></pre>


</div>