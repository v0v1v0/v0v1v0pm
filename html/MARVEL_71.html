<div class="container">

<table style="width: 100%;"><tr>
<td>PlotPctExprCells.SJ.10x</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot splice junction expression distribution</h2>

<h3>Description</h3>

<p>Generates a plot of splice junction expression distribution (percentage of cells expressing a particular splice junction) to determine splice junction expression threshold for downstream differential splice junction analysis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PlotPctExprCells.SJ.10x(
  MarvelObject,
  cell.group.g1,
  cell.group.g2,
  min.pct.cells.genes = 10,
  min.pct.cells.sj = 10,
  downsample = FALSE,
  downsample.pct.sj = 10,
  seed = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>MarvelObject</code></td>
<td>
<p>Marvel object. S3 object generated from <code>CheckAlignment.10x</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cell.group.g1</code></td>
<td>
<p>Vector of character strings. Cell IDs corresponding to Group 1 (reference group) of downstream differential splice junction analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cell.group.g2</code></td>
<td>
<p>Vector of character strings. Cell IDs corresponding to Group 2 of downstream differential splice junction analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.pct.cells.genes</code></td>
<td>
<p>Numeric value. Minimum percentage of cells in which the gene is expressed for that gene to be included for splice junction expression distribution analysis. Expressed genes defined as genes with non-zero normalised UMI counts. This threshold may be determined from <code>PlotPctExprCells.SJ.10x</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.pct.cells.sj</code></td>
<td>
<p>Numeric value. Minimum percentage of cells in which the splice junction is expressed for that splice junction to be included for splice junction expression distribution analysis. Expressed splice junctions defined as splice junctions with raw UMI counts &gt;= 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>downsample</code></td>
<td>
<p>Logical value. If set to <code>TRUE</code>, the splice junctions will be downsampled so that only a smaller number of splice junctions will be included for expression exploration analysis here. Default value is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>downsample.pct.sj</code></td>
<td>
<p>Numeric value. If <code>downsample</code> set to <code>TRUE</code>, the minimum percentage of splice junctions to include for expression exploration analysis here.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Numeric value. To ensure the splice junctions downsampled will always be reproducible.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class S3 with a new slots <code>MarvelObject$pct.cells.expr$SJ$Plot</code> and <code>MarvelObject$pct.cells.expr$SJ$Data</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
marvel.demo.10x &lt;- readRDS(system.file("extdata/data",
                               "marvel.demo.10x.rds",
                               package="MARVEL")
                               )

# Define cell groups
    # Retrieve sample metadata
    sample.metadata &lt;- marvel.demo.10x$sample.metadata

    # Group 1 (reference)
    index &lt;- which(sample.metadata$cell.type=="iPSC")
    cell.ids.1 &lt;- sample.metadata[index, "cell.id"]
    length(cell.ids.1)

    # Group 2
    index &lt;- which(sample.metadata$cell.type=="Cardio day 10")
    cell.ids.2 &lt;- sample.metadata[index, "cell.id"]
    length(cell.ids.2)

# Explore % of cells expressing SJ
marvel.demo.10x &lt;- PlotPctExprCells.SJ.10x(
                    MarvelObject=marvel.demo.10x,
                    cell.group.g1=cell.ids.1,
                    cell.group.g2=cell.ids.2,
                    min.pct.cells.genes=5,
                    min.pct.cells.sj=5,
                    downsample=TRUE,
                    downsample.pct.sj=100
                    )

marvel.demo.10x$pct.cells.expr$SJ$Plot
head(marvel.demo.10x$pct.cells.expr$SJ$Data)
</code></pre>


</div>