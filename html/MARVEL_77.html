<div class="container">

<table style="width: 100%;"><tr>
<td>PlotValues.PSI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot percent spliced-in (PSI) values</h2>

<h3>Description</h3>

<p>Violin plot of percent spliced-in (PSI) values across different groups of cells.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PlotValues.PSI(
  MarvelObject,
  cell.group.list,
  feature,
  maintitle = "gene_short_name",
  xlabels.size = 8,
  max.cells.jitter = 10000,
  max.cells.jitter.seed = 1,
  min.cells = 25,
  sigma.sq = 0.001,
  bimodal.adjust = TRUE,
  seed = 1,
  modality.column = "modality.bimodal.adj",
  scale.y.log = FALSE,
  cell.group.colors = NULL,
  point.alpha = 0.2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>MarvelObject</code></td>
<td>
<p>Marvel object. S3 object generated from <code>TransformExpValues</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cell.group.list</code></td>
<td>
<p>List of character strings. Each element of the list is a vector of cell IDs corresponding to a cell group. The name of the element will be the cell group label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>feature</code></td>
<td>
<p>Character string. Coordinates of splicing event to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maintitle</code></td>
<td>
<p>Character string. Column to use as plot main title as per <code>MarvelObject$ValidatedSpliceFeature</code>. Default is <code>"gene_short_name"</code> column.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlabels.size</code></td>
<td>
<p>Numeric value. Size of x-axis labels as per <code>ggplot2</code> function. Default is 8.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.cells.jitter</code></td>
<td>
<p>Numeric value. Maximum number of cells for jitter points. Cells are randomly downsampled to show on jitter plot. Useful when there are large number of cells so that individual jitter points do not overcrowd the violin plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.cells.jitter.seed</code></td>
<td>
<p>Numeric value. Cells downsampled are reproducible.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.cells</code></td>
<td>
<p>Numeric value. The minimum no. of cells expressing the splicing event to be included for analysis. Please refer to <code>AssignModality</code> function help page for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.sq</code></td>
<td>
<p>Numeric value. The variance threshold below which the included/excluded modality will be defined as primary sub-modality, and above which it will be defined as dispersed sub-modality. Please refer to <code>AssignModality</code> function help page for more details. Default is 0.001.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bimodal.adjust</code></td>
<td>
<p>Logical. When set to <code>TRUE</code>, MARVEL will identify false bimodal modalities and reassign them as included/excluded modality. Please refer to <code>AssignModality</code> function help page for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Numeric value. Ensure the <code>fitdist</code> function returns the same values for alpha and beta paramters each time this function is executed using the same random number generator. Please refer to <code>AssignModality</code> function help page for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modality.column</code></td>
<td>
<p>Character string. Can take the value <code>"modality"</code>, <code>"modality.var"</code> or <code>"modality.bimodal.adj"</code>. Please refer to <code>AssignModality</code> function help page for more details. Default is <code>"modality.bimodal.adj"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.y.log</code></td>
<td>
<p>Logical value. Only applicable when <code>level</code> set to <code>"splicing"</code>. If set to <code>TRUE</code>, the y-axis of will log10-scaled. Useful when most PSI values are extremely small (&lt; 0.02) or big (&gt; 0.98). Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cell.group.colors</code></td>
<td>
<p>Character string. Vector of colors for the cell groups specified for PCA analysis using <code>cell.type.columns</code>, <code>cell.type.variable</code>, and <code>cell.type.labels</code>. If not specified, default <code>ggplot2</code> colors will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>point.alpha</code></td>
<td>
<p>Numeric value. Transparency of the data points. Takes any values between 0-1. Default value is <code>0.2</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class S3 with new slot <code>MarvelObject$adhocPlot$PSI</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">marvel.demo &lt;- readRDS(system.file("extdata/data", "marvel.demo.rds", package="MARVEL"))

# Define cell groups to plot
df.pheno &lt;- marvel.demo$SplicePheno
cell.group.g1 &lt;- df.pheno[which(df.pheno$cell.type=="iPSC"), "sample.id"]
cell.group.g2 &lt;- df.pheno[which(df.pheno$cell.type=="Endoderm"), "sample.id"]
cell.group.list &lt;- list(cell.group.g1, cell.group.g2)
names(cell.group.list) &lt;- c("iPSC", "Endoderm")

# Plot
marvel.demo &lt;- PlotValues.PSI(MarvelObject=marvel.demo,
                              cell.group.list=cell.group.list,
                              feature="chr17:8383254:8382781|8383157:-@chr17:8382143:8382315",
                              min.cells=5,
                              xlabels.size=5
                              )

# Check output
marvel.demo$adhocPlot$PSI
</code></pre>


</div>