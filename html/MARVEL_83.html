<div class="container">

<table style="width: 100%;"><tr>
<td>RunPCA.Exp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Principle component analysis for gene Data</h2>

<h3>Description</h3>

<p>Performs principle component analysis using gene expression values.
</p>


<h3>Usage</h3>

<pre><code class="language-R">RunPCA.Exp(
  MarvelObject,
  sample.ids = NULL,
  cell.group.column,
  cell.group.order = NULL,
  cell.group.colors = NULL,
  features,
  min.cells = 25,
  point.size = 0.5,
  point.alpha = 0.75,
  point.stroke = 0.1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>MarvelObject</code></td>
<td>
<p>Marvel object. S3 object generated from <code>TransformExpValues</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample.ids</code></td>
<td>
<p>Character strings. Specific cells to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cell.group.column</code></td>
<td>
<p>Character string. The name of the sample metadata column in which the variables will be used to label the cell groups on the PCA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cell.group.order</code></td>
<td>
<p>Character string. The order of the variables under the sample metadata column specified in <code>cell.group.column</code> to appear in the PCA cell group legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cell.group.colors</code></td>
<td>
<p>Character string. Vector of colors for the cell groups specified for PCA analysis using <code>cell.type.columns</code> and <code>cell.group.order</code>. If not specified, default <code>ggplot2</code> colors will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>features</code></td>
<td>
<p>Character string. Vector of <code>gene_id</code> for analysis. Should match <code>gene_id</code> column of <code>MarvelObject$GeneFeature</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.cells</code></td>
<td>
<p>Numeric value. The minimum no. of cells expressing the gene to be included for analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>point.size</code></td>
<td>
<p>Numeric value. Size of data points on reduced dimension space.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>point.alpha</code></td>
<td>
<p>Numeric value. Transparency of the data points on reduced dimension space. Take any values between 0 to 1. The smaller the value, the more transparent the data points will be.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>point.stroke</code></td>
<td>
<p>Numeric value. The thickness of the outline of the data points. The larger the value, the thicker the outline of the data points.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class S3 containing with new slots <code>MarvelObject$PCA$Exp$Results</code>, <code>MarvelObject$PCA$Exp$Plot</code>, and <code>MarvelObject$PCA$Exp$Plot.Elbow</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">marvel.demo &lt;- readRDS(system.file("extdata/data", "marvel.demo.rds", package="MARVEL"))

# Define genes for analysis
gene_ids &lt;- marvel.demo$Exp$gene_id

# PCA
marvel.demo &lt;- RunPCA.Exp(MarvelObject=marvel.demo,
                          sample.ids=marvel.demo$SplicePheno$sample.id,
                          cell.group.column="cell.type",
                          cell.group.order=c("iPSC", "Endoderm"),
                          min.cells=5,
                          features=gene_ids,
                          point.size=2
                          )

# Check outputs
head(marvel.demo$PCA$Exp$Results$ind$coord)
marvel.demo$PCA$Exp$Plot
</code></pre>


</div>