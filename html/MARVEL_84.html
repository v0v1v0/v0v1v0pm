<div class="container">

<table style="width: 100%;"><tr>
<td>RunPCA.PSI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Principle component analysis for splicing data</h2>

<h3>Description</h3>

<p>Performs principle component analysis using PSI values.
</p>


<h3>Usage</h3>

<pre><code class="language-R">RunPCA.PSI(
  MarvelObject,
  sample.ids = NULL,
  cell.group.column,
  cell.group.order,
  cell.group.colors = NULL,
  features,
  min.cells = 25,
  point.size = 0.5,
  point.alpha = 0.75,
  point.stroke = 0.1,
  seed = 1,
  method.impute = "random",
  cell.group.column.impute = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>MarvelObject</code></td>
<td>
<p>Marvel object. S3 object generated from <code>TransformExpValues</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample.ids</code></td>
<td>
<p>Character strings. Specific cells to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cell.group.column</code></td>
<td>
<p>Character string. The name of the sample metadata column in which the variables will be used to label the cell groups on the PCA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cell.group.order</code></td>
<td>
<p>Character string. The order of the variables under the sample metadata column specified in <code>cell.group.column</code> to appear in the PCA cell group legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cell.group.colors</code></td>
<td>
<p>Character string. Vector of colors for the cell groups specified for PCA analysis using <code>cell.type.columns</code> and <code>cell.group.order</code>. If not specified, default <code>ggplot2</code> colors will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>features</code></td>
<td>
<p>Character string. Vector of <code>tran_id</code> for analysis. Should match <code>tran_id</code> column of <code>MarvelObject$ValidatedSpliceFeature</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.cells</code></td>
<td>
<p>Numeric value. The minimum no. of cells expressing the splicing event to be included for analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>point.size</code></td>
<td>
<p>Numeric value. Size of data points on reduced dimension space.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>point.alpha</code></td>
<td>
<p>Numeric value. Transparency of the data points on reduced dimension space. Take any values between 0 to 1. The smaller the value, the more transparent the data points will be.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>point.stroke</code></td>
<td>
<p>Numeric value. The thickness of the outline of the data points. The larger the value, the thicker the outline of the data points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Numeric value. Ensures imputed values for NA PSIs are reproducible.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method.impute</code></td>
<td>
<p>Character string. Indicate the method for imputing missing PSI values (low coverage). <code>"random"</code> method randomly assigns any values between 0-1. <code>"population.mean"</code> method uses the mean PSI value for each cell population. Default option is <code>"population.mean"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cell.group.column.impute</code></td>
<td>
<p>Character string. Only applicable when <code>method.impute</code> set to <code>"population.mean"</code>. The name of the sample metadata column in which the variables will be used to impute missing values.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class S3 containing with new slots <code>MarvelObject$PCA$PSI$Results</code> and  <code>MarvelObject$PCA$PSI$Plot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">marvel.demo &lt;- readRDS(system.file("extdata/data", "marvel.demo.rds", package="MARVEL"))

# Define splicing events for analysis
df &lt;- do.call(rbind.data.frame, marvel.demo$PSI)
tran_ids &lt;- df$tran_id

# PCA
marvel.demo &lt;- RunPCA.PSI(MarvelObject=marvel.demo,
                          sample.ids=marvel.demo$SplicePheno$sample.id,
                          cell.group.column="cell.type",
                          cell.group.order=c("iPSC", "Endoderm"),
                          cell.group.colors=NULL,
                          min.cells=5,
                          features=tran_ids,
                          point.size=2
                          )

# Check outputs
head(marvel.demo$PCA$PSI$Results$ind$coord)
marvel.demo$PCA$PSI$Plot
</code></pre>


</div>