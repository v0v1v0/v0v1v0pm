<div class="container">

<table style="width: 100%;"><tr>
<td>kde_2d</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>A Two-dimensional Kernel Density Estimate</h2>

<h3>Description</h3>

<p>A pure R implementation of an approximate two-dimensional kde computation, where
the approximation depends on the x- and y-resolution being fine, i.e. the number
of both x- and y-points should be reasonably large, at least 256.  The coding
follows the same idea as used in <code>kde2d</code>, but scales much better
for large data sets.
</p>


<h3>Usage</h3>

<pre><code class="language-R">kde_2d(
  x,
  y = NULL,
  bw = list(x = bw.nrd0, y = bw.nrd0),
  kernel = c("gaussian", "biweight", "cosine", "epanechnikov", "logistic", "optCosine",
    "rectangular", "squaredCosine", "triangular", "tricube", "triweight", "uniform"),
  n = 128,
  x_limits = c(rx[1] - cut * bw["x"], rx[2] + cut * bw["x"]),
  y_limits = c(ry[1] - cut * bw["y"], ry[2] + cut * bw["y"]),
  cut = 1,
  na.rm = FALSE,
  adjust = 53/45,
  ...
)

## S3 method for class 'kde_2d'
print(x, ...)

## S3 method for class 'kde_2d'
plot(
  x,
  ...,
  las = 1,
  xlab = bquote(italic(.(x$data_name[["x"]]))),
  ylab = bquote(italic(.(x$data_name[["y"]]))),
  col = hcl.colors(50, "YlOrRd", rev = TRUE)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>Numeric vectors of the same length specified in any way acceptable
to <code>xy.coords</code>.  In methods, <code>x</code> will be
an object of class <code>"kde_2d"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p>bandwidths. May be a numeric vector of length 1 or 2, or a function,
or list of two bandwidth computation functions.  Short entities will
be repeated to length 1.  The first relates to the x-coordinate and
the second to the y.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>
<p>As for <code>kde_1d</code> though 1 or 2 values may be specified
relating to x- and y-coordinates respectively.  Short entities will
be repeated to length 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>positive integer vector of length 1 or 2 specifying the resolution required
in the x- and y-coordinates respectively.  Short values will be repeated to
length 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_limits, y_limits</code></td>
<td>
<p>Numeric vectors specifying the limits required for the result</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cut</code></td>
<td>
<p>The number of bandwidths beyond the x- and y-range limits for the resuls.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>Should missing values be silently removed?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjust</code></td>
<td>
<p>A factor to adjust both bandwidths to regulate smoothness</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>currently ignored, except in method functions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>las, col, xlab, ylab</code></td>
<td>
<p>base graphics parameters</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of results of class <code>"kde_2d"</code>.  The result may be used directly
in <code>image</code> or <code>contour</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">krc &lt;- with(Boston, {
  criminality &lt;- log(crim)
  spaciousness &lt;- sqrt(rm)
  kde_2d(criminality, spaciousness, n = 128, kernel = "biweight")
})
plot(krc, xlab = expression(italic(Criminality)), ylab = expression(italic(Spaciousness)))
levs &lt;- hr_levels(krc)
contour(krc, add = TRUE, levels = levs, labels = names(levs))

with(krc, persp(x, 10*y, 3*z, border="transparent", col = "powder blue",
                theta = 30, phi = 15, r = 20, scale = FALSE, shade = TRUE,
                xlab = "Criminality", ylab = "Spaciousness", zlab = "density"))
</code></pre>


</div>