<div class="container">

<table style="width: 100%;"><tr>
<td>mave</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Dimension reduction</h2>

<h3>Description</h3>

<p>This function provides several methods to estimate the central space or central mean space of y on x.
It returns the matrix of central space or central mean space for different dimensions and contains
other information used for dimension selection by <code>mave.dim</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mave(
  formula,
  data,
  method = "CSOPG",
  max.dim = 10,
  screen = NULL,
  subset,
  na.action = na.fail
)

mave.compute(
  x,
  y,
  method = "CSOPG",
  max.dim = 10,
  screen = nrow(x)/log(nrow(x))
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>the model used in regression</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>the data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>This parameter specify which method will be used in dimension reduction. It provides
five methods, including "csMAVE","csOPG","meanOPG","meanMAVE","KSIR"
by default, method = 'csOPG'
</p>

<ul>
<li>
<p> 'meanOPG' and 'meanMAVE' estimate dimension reduction space
for conditional mean
</p>
</li>
<li>
<p> 'csMAVE' and 'csOPG' estimate the central dimension reduction
space
</p>
</li>
<li>
<p> 'KSIR' is a kernel version of sliced inverse regression (Li, 1991). It is fast, but
with poor accuracy.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.dim</code></td>
<td>
<p>the maximum dimension of dimension reduction space. The default is 10. In practice, max.dim
will be equal to min(max.dim,ncol(x),screen).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>screen</code></td>
<td>
<p>specify the number of variables retained after screening method. The default is n/log(n).
When this number is smaller than max.dim, then max.dim will change to the value of screen</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be used in the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen when the data contain NAs. The default
is na.action, which wil stop calculations. If na.action is set to be na.omit, the incomplete cases
will be removed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The n by p design matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The n by q respond matrix.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>dr is a list which contains:
</p>

<ul>
<li>
<p> dir: dir[[d]] is the central space with d-dimension
d = 1, 2, ..., p reduced direction of different dimensions
</p>
</li>
<li>
<p> y: the value of response
</p>
</li>
<li>
<p> idx: the index of variables which survives after screening
</p>
</li>
<li>
<p> max.dim: the largest dimensions of CS or CMS which have been calculated in mave function
</p>
</li>
<li>
<p> ky: parameter used for DIM for selection
</p>
</li>
<li>
<p> x: the original training data
</p>
</li>
</ul>
<h3>References</h3>

<p>Li K C. Sliced inverse regression for dimension reduction[J]. Journal of the American Statistical Association, 1991, 86(414): 316-327.
</p>
<p>Xia Y, Tong H, Li W K, et al. An adaptive estimation of dimension reduction space[J]. Journal of the Royal Statistical Society: Series B (Statistical Methodology), 2002, 64(3): 363-410.
</p>
<p>Xia Y. A constructive approach to the estimation of dimension reduction directions[J]. The Annals of Statistics, 2007: 2654-2690.
</p>
<p>Wang H, Xia Y. Sliced regression for dimension reduction[J]. Journal of the American Statistical Association, 2008, 103(482): 811-821.
</p>


<h3>See Also</h3>

<p><code>mave.dim</code> for dimension selection, <code>predict.mave</code> for prediction
using the dimension reduction space, <code>coef.mave</code> for accessing the basis vectors of
dimension reduction space of given dimension, <code>plot.mave</code> for plot method for mave class
</p>


<h3>Examples</h3>

<pre><code class="language-R"> x &lt;- matrix(rnorm(400*5),400,5)
 b1 &lt;- matrix(c(1,1,0,0,0),5,1)
 b2 &lt;- matrix(c(0,0,1,1,0),5,1)
 eps &lt;- matrix(rnorm(400),400,1)
 y &lt;- x%*%b1 + (x%*%b2)*eps

 #finding central space based on OPG method
 #dr.csopg &lt;- mave.compute(x,y, method = 'csopg')
 #or
 dr.csopg &lt;- mave(y ~ x, method = 'csopg')

 #dr.meanopg &lt;- mave.compute(x,y, method = 'meanopg')
 #or
 dr.meanopg &lt;- mave(y ~ x, method = 'meanopg')

 #find central mean space based on ksir method
 dr.ksir &lt;- mave(y~x,method='ksir')
 #or
 #dr.ksir &lt;- mave.compute(x,y,method='ksir')

 #See more examples about screening and mutiple responses in the vignette
 #Using screening for high dimensional data
 #x &lt;- matrix(rnorm(100*50),100,50)
 #y1 = as.matrix(x[,1])+rnorm(100)*.2
 #y2 = as.matrix(x[,2]+x[,3])*as.matrix(x[,1]+x[,5])+rnorm(100)*.2
 #y = cbind(y1,y2)
 #dr.sc = mave(y~x,method='CSOPG',max.dim=5,screen=20)
 #dr.sc.dim = mave.dim(dr.sc)
 #print the directions of central space with the selected variables
 #dr.sc.dim$dir[[3]][dr.sc$idx,]

</code></pre>


</div>