<div class="container">

<table style="width: 100%;"><tr>
<td>estimateVarRatio</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate Relative Variance Ratio Factors of <code>bioCond</code> Objects</h2>

<h3>Description</h3>

<p>Given a set of <code>bioCond</code> objects assumed to be associated with
the same mean-variance curve, <code>estimateVarRatio</code>
robustly estimates their relative variance ratio factors, by selecting one
of the <code>bioCond</code>s as the base condition and comparing the others to it.
</p>


<h3>Usage</h3>

<pre><code class="language-R">estimateVarRatio(
  conds,
  base.cond = NULL,
  subset = NULL,
  invariant = NULL,
  no.rep.rv = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>conds</code></td>
<td>
<p>A list of <code>bioCond</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base.cond</code></td>
<td>
<p>An optional positive integer or character name indexing the
base <code>bioCond</code> in <code>conds</code>. Note that the base condition must
contain replicate samples. By default, the base <code>bioCond</code> is
automatically selected by measuring the variation levels of the
<code>bioCond</code>s (see "Details").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>An optional vector specifying the subset of intervals to be
used for measuring the variation levels. Defaults to the intervals
occupied by all the <code>bioCond</code>s.
Ignored if <code>base.cond</code> is specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>invariant</code></td>
<td>
<p>An optional non-negative real specifying the upper bound
of difference in mean signal intensity
for a genomic interval to be treated
as invariant between two <code>bioCond</code> objects. By default, intervals
occupied by both <code>bioCond</code>s are treated as invariant between them.
Note that <code>estimateVarRatio</code> uses exactly the invariant intervals
to compare the variance ratio factors of two <code>bioCond</code>s.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no.rep.rv</code></td>
<td>
<p>A positive real specifying the (relative) variance ratio
factor of those <code>bioCond</code>s without replicate samples, if any. By
default, it's set to be the geometric mean of variance ratio factors of
the other <code>bioCond</code>s.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Technically, <code>estimateVarRatio</code> uses 1 as the (relative) variance ratio
factor of the base <code>bioCond</code>, and estimates the variance ratio
factors of the other <code>bioCond</code>s by separately comparing each of them to
the base. Refer to <code>varRatio</code> for details about comparing the
variance ratio factors of two <code>bioCond</code>s by using their invariant
genomic intervals.
</p>
<p>If the base <code>bioCond</code> is not explicitly specified by users,
<code>estimateVarRatio</code> will measure the variation level of each
<code>bioCond</code> containing replicate samples. Technically, the variation
levels are calculated by applying the median ratio strategy to the observed
variances of the <code>bioCond</code>s. This process is rather similar to the one
for estimating size factors of ChIP-seq samples (see also
<code>estimateSizeFactors</code>). After that, the <code>bioCond</code> whose
variation level is closest to 1 is selected as the base (with the exception
that, if there are only two <code>bioCond</code>s that contain replicate samples,
the function will always use the <code>bioCond</code> with the lower variation
level as the base, for avoiding potential uncertainty in selection results
due to limited numerical precision).
</p>


<h3>Value</h3>

<p>A named vector of the estimated relative variance ratio factors,
with the names being those of the corresponding <code>bioCond</code>
objects. Besides, the following attributes are associated with the
vector:
</p>

<dl>
<dt><code>var.level</code></dt>
<dd>
<p>Variation levels of the <code>bioCond</code>
objects. Present only when the base <code>bioCond</code> is automatically
selected by the function.</p>
</dd>
<dt><code>base.cond</code></dt>
<dd>
<p>Name of the base <code>bioCond</code>.</p>
</dd>
<dt><code>no.rep.rv</code></dt>
<dd>
<p>Variance ratio factor of the <code>bioCond</code>s
with no replicate samples. Present only when it's ever been used.</p>
</dd>
</dl>
<h3>References</h3>

<p>Tu, S., et al., <em>MAnorm2 for quantitatively comparing
groups of ChIP-seq samples.</em> Genome Res, 2021.
<strong>31</strong>(1): p. 131-145.
</p>


<h3>See Also</h3>

<p><code>bioCond</code> for creating a <code>bioCond</code> object;
<code>fitMeanVarCurve</code> for fitting a mean-variance curve for
a set of <code>bioCond</code> objects; <code>varRatio</code> for a formal
description of variance ratio factor.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(H3K27Ac, package = "MAnorm2")
attr(H3K27Ac, "metaInfo")

## Estimate the relative variance ratio factors of cell lines.

# Perform the MA normalization and construct bioConds to represent cell
# lines.
norm &lt;- normalize(H3K27Ac, 4, 9)
norm &lt;- normalize(norm, 5:6, 10:11)
norm &lt;- normalize(norm, 7:8, 12:13)
conds &lt;- list(GM12890 = bioCond(norm[4], norm[9], name = "GM12890"),
              GM12891 = bioCond(norm[5:6], norm[10:11], name = "GM12891"),
              GM12892 = bioCond(norm[7:8], norm[12:13], name = "GM12892"))
autosome &lt;- !(H3K27Ac$chrom %in% c("chrX", "chrY"))
conds &lt;- normBioCond(conds, common.peak.regions = autosome)

# Automatically select the base bioCond.
estimateVarRatio(conds)

# Explicitly specify the base bioCond.
estimateVarRatio(conds, base.cond = "GM12891")

</code></pre>


</div>