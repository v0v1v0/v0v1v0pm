<div class="container">

<table style="width: 100%;"><tr>
<td>MAplot.bioCond</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create an MA Plot on Two <code>bioCond</code> Objects</h2>

<h3>Description</h3>

<p>Given two <code>bioCond</code> objects, the function draws an MA plot,
which is a scatter plot with signal intensity differences between the two
conditions against the average signal intensities across conditions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'bioCond'
MAplot(
  x,
  y,
  col = NULL,
  pch = NULL,
  ylim = c(-6, 6),
  xlab = "A value",
  ylab = "M value",
  plot.legend = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>Two <code>bioCond</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col, pch</code></td>
<td>
<p>Optional length-4 vectors specifying the colors and point
characters of 4 types of genomic intervals: common peak regions, peak
regions specific to the 2nd condition, peak regions specific to the 1st
condition, and the others. Elements are
recycled if necessary.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>A length-two vector specifying the plotting range of Y-axis
(i.e., the M value). Each M value falling outside the range will be
shrunk to the corresponding limit. Setting the option to <code>NULL</code>
to suppress this behavior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab</code></td>
<td>
<p>Labels for the X and Y axes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.legend</code></td>
<td>
<p>A logical value indicating whether to add a legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to <code>plot</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Genomic intervals are classified based on
the <code>occupancy</code> field in each of
the two <code>bioCond</code> objects. See <code>bioCond</code> for a full
description of the structure of a <code>bioCond</code> object.
</p>


<h3>Value</h3>

<p>The function returns <code>NULL</code>.
</p>


<h3>Note</h3>

<p>While it's not strictly required, ChIP-seq samples contained in the
two <code>bioCond</code> objects are expected to have been normalized
prior to calling this function. These samples could be normalized all
together before being classified into biological conditions (via
<code>normalize</code>). Alternatively, normalization can also be
performed at the level of <code>bioCond</code> objects (via
<code>normBioCond</code>).
</p>
<p>Given the typically large number of points to draw, you may want to
use <code>alpha</code> to adjust color transparency if you
intend to specify <code>col</code> explicitly.
</p>


<h3>See Also</h3>

<p><code>bioCond</code> for creating a <code>bioCond</code> object;
<code>MAplot.default</code> for producing an MA plot on normalized
signal intensities of two ChIP-seq samples; <code>normalize</code> for
performing an MA normalization on ChIP-seq samples;
<code>normBioCond</code> for normalizing a set of <code>bioCond</code>
objects.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(H3K27Ac, package = "MAnorm2")
attr(H3K27Ac, "metaInfo")

## Create MA scatter plots for the comparisons between individuals.

# Perform the MA normalization and construct bioConds to represent
# individuals.
norm &lt;- normalize(H3K27Ac, 4, 9)
norm &lt;- normalize(norm, 5:6, 10:11)
norm &lt;- normalize(norm, 7:8, 12:13)
conds &lt;- list(GM12890 = bioCond(norm[4], norm[9], name = "GM12890"),
              GM12891 = bioCond(norm[5:6], norm[10:11], name = "GM12891"),
              GM12892 = bioCond(norm[7:8], norm[12:13], name = "GM12892"))
autosome &lt;- !(H3K27Ac$chrom %in% c("chrX", "chrY"))
conds &lt;- normBioCond(conds, common.peak.regions = autosome)

# MA plots on pairs of individuals.
MAplot(conds[[1]], conds[[2]], main = "GM12890 vs. GM12891")
abline(h = 0, lwd = 2, lty = 5)
MAplot(conds[[1]], conds[[3]], main = "GM12890 vs. GM12892")
abline(h = 0, lwd = 2, lty = 5)
MAplot(conds[[2]], conds[[3]], main = "GM12891 vs. GM12892")
abline(h = 0, lwd = 2, lty = 5)

</code></pre>


</div>