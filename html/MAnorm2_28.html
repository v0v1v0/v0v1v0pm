<div class="container">

<table style="width: 100%;"><tr>
<td>MAplot.diffBioCond</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create an MA Plot on Results of Comparing Two <code>bioCond</code> Objects</h2>

<h3>Description</h3>

<p>This method produces an MA plot demonstrating the results of comparing two
<code>bioCond</code> objects. More specifically, it draws a scatter plot
consisting of the genomic intervals having been compared,
and those intervals with
differential ChIP-seq signals between the two conditions are explicitly
indicated.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'diffBioCond'
MAplot(
  x,
  padj = NULL,
  pval = NULL,
  col = alpha(c("black", "red"), 0.1),
  pch = 20,
  ylim = c(-6, 6),
  xlab = "A value",
  ylab = "M value",
  args.legend = list(x = "topright"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class <code>"diffBioCond"</code>, typically obtained by
passing two <code>bioCond</code> objects to
<code>diffTest</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>padj, pval</code></td>
<td>
<p>Cutoff of adjusted/raw <em>p</em>-value for selecting
differential intervals.
Only one of the two arguments is effectively used;
<code>pval</code> is ignored if <code>padj</code> is specified. The default is
equivalent to setting <code>padj</code> to <code>0.1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col, pch</code></td>
<td>
<p>Optional length-2 vectors specifying the colors and point
characters of non-differential and differential intervals, respectively.
Elements are recycled if necessary.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>A length-two vector specifying the plotting range of Y-axis
(i.e., the M value). Each M value falling outside the range will be
shrunk to the corresponding limit. Setting the option to <code>NULL</code>
to suppress this behavior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab</code></td>
<td>
<p>Labels for the X and Y axes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args.legend</code></td>
<td>
<p>Further arguments to be passed to
<code>legend</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to <code>plot</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function returns <code>NULL</code>.
</p>


<h3>See Also</h3>

<p><code>bioCond</code> for creating a <code>bioCond</code> object;
<code>fitMeanVarCurve</code> for fitting a mean-variance curve given a
list of <code>bioCond</code> objects;
<code>diffTest</code> for making a comparison
between two <code>bioCond</code> objects; <code>alpha</code> for
adjusting color transparency.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(H3K27Ac, package = "MAnorm2")
attr(H3K27Ac, "metaInfo")

## Make a comparison between GM12891 and GM12892 cell lines and create an MA
## plot on the comparison results.

# Perform MA normalization and construct bioConds to represent the two cell
# lines.
norm &lt;- normalize(H3K27Ac, 5:6, 10:11)
norm &lt;- normalize(norm, 7:8, 12:13)
conds &lt;- list(GM12891 = bioCond(norm[5:6], norm[10:11], name = "GM12891"),
              GM12892 = bioCond(norm[7:8], norm[12:13], name = "GM12892"))
autosome &lt;- !(H3K27Ac$chrom %in% c("chrX", "chrY"))
conds &lt;- normBioCond(conds, common.peak.regions = autosome)

# Variations in ChIP-seq signals across biological replicates of a cell line
# are generally of a low level, and their relationship with the mean signal
# intensities is expected to be well modeled by the presumed parametric
# form.
conds &lt;- fitMeanVarCurve(conds, method = "parametric", occupy.only = TRUE)
summary(conds[[1]])
plotMeanVarCurve(conds, subset = "occupied")

# Perform differential tests between the two cell lines.
res &lt;- diffTest(conds[[1]], conds[[2]])
head(res)

# Visualize the overall test results.
MAplot(res, padj = 0.001)
abline(h = 0, lwd = 2, lty = 5, col = "green3")

</code></pre>


</div>