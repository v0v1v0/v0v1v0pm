<div class="container">

<table style="width: 100%;"><tr>
<td>plot.varTestBioCond</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot a <code>varTestBioCond</code> Object</h2>

<h3>Description</h3>

<p>Given a <code>varTestBioCond</code> object, which records the results of
calling hypervariable and invariant genomic intervals
across ChIP-seq samples of
a <code>bioCond</code> object, this method creates a scatter plot of
observed <code>(mean, log10(variance))</code> pairs
from all genomic intervals, marking
specifically the ones that have a significantly large or small variance.
Besides, the mean-variance curve associated with the <code>bioCond</code> is also
added to the plot, serving as a baseline to which each observed variance
could be compared.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'varTestBioCond'
plot(
  x,
  padj = NULL,
  pval = NULL,
  col = alpha(c("black", "red"), 0.04),
  pch = 20,
  xlab = "Mean",
  ylab = "log10(Var)",
  args.legend = list(x = "bottomleft"),
  args.lines = list(col = "green3", lwd = 2),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class <code>"varTestBioCond"</code>, typically a returned
value from <code>varTestBioCond</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>padj, pval</code></td>
<td>
<p>Cutoff of adjusted/raw <em>p</em>-value for selecting
significant intervals. Only one of the two arguments is effectively
used; <code>pval</code> is ignored if <code>padj</code> is specified. The default is
equivalent to setting <code>padj</code> to <code>0.1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col, pch</code></td>
<td>
<p>Optional length-2 vectors specifying the colors and point
characters of non-significant and significant intervals, respectively.
Elements are recycled if necessary.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab</code></td>
<td>
<p>Labels for the X and Y axes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args.legend</code></td>
<td>
<p>Further arguments to be passed to
<code>legend</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args.lines</code></td>
<td>
<p>Further arguments to be passed to
<code>lines</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to
<code>plot</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Those genomic intervals considered to be significant are actually the ones
that significantly deviate from the mean-variance curve in the plot. See
<code>varTestBioCond</code> for technical details of the associated
hypothesis testing.
</p>


<h3>Value</h3>

<p>The function returns <code>NULL</code>.
</p>


<h3>See Also</h3>

<p><code>bioCond</code> for creating a <code>bioCond</code> object from a
set of ChIP-seq samples; <code>fitMeanVarCurve</code> for fitting a
mean-variance curve; <code>varTestBioCond</code> for calling
hypervariable and invariant intervals across ChIP-seq samples
contained in a <code>bioCond</code> object.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(H3K27Ac, package = "MAnorm2")
attr(H3K27Ac, "metaInfo")

## Call hypervariable and invariant genomic intervals across biological
## replicates of the GM12891 cell line.

# Perform MA normalization and construct a bioCond to represent GM12891.
norm &lt;- normalize(H3K27Ac, 5:6, 10:11)
GM12891 &lt;- bioCond(norm[5:6], norm[10:11], name = "GM12891")

# Fit a mean-variance curve for GM12891 using the parametric method.
GM12891 &lt;- fitMeanVarCurve(list(GM12891), method = "parametric",
                           occupy.only = TRUE)[[1]]
summary(GM12891)
plotMeanVarCurve(list(GM12891), subset = "occupied")

# Assess the observed variances of ChIP-seq signal intensities in GM12891.
res &lt;- varTestBioCond(GM12891)
head(res)

# Inspect only the test results of occupied genomic intervals.
res &lt;- res[GM12891$occupancy, ]
res$padj &lt;- p.adjust(res$pval, method = "BH")
plot(res, col = scales::alpha(c("black", "red"), c(0.04, 0.5)))

</code></pre>


</div>