<div class="container">

<table style="width: 100%;"><tr>
<td>plotMeanVarCurve</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot a Mean-Variance Curve</h2>

<h3>Description</h3>

<p>Given a list of <code>bioCond</code> objects associated with a common
mean-variance curve, <code>plotMeanVarCurve</code> draws a scatter plot of
observed <code>(mean, log10(variance))</code> pairs from the genomic intervals
contained in them. It also adds the mean-variance curve to the plot.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotMeanVarCurve(
  conds,
  subset = c("all", "occupied", "non-occupied"),
  col = alpha("blue", 0.02),
  pch = 20,
  xlab = "Mean",
  ylab = "log10(Var)",
  args.legend = list(x = "bottomleft"),
  args.lines = list(col = "red", lwd = 2),
  only.add.line = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>conds</code></td>
<td>
<p>A list of <code>bioCond</code> objects with which a
mean-variance curve has been associated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>A character string indicating the subset of genomic intervals
used for the scatter plot (see "Details"). Must be one of <code>"all"</code>
(default), <code>"occupied"</code>, or <code>"non-occupied"</code>.
Can be abbreviated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col, pch</code></td>
<td>
<p>Optional vectors specifying the color and point character for
genomic intervals in each <code>bioCond</code>. Elements are recycled if
necessary.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab</code></td>
<td>
<p>Labels for the X and Y axes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args.legend</code></td>
<td>
<p>Further arguments to be passed to
<code>legend</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args.lines</code></td>
<td>
<p>Further arguments to be passed to
<code>lines</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>only.add.line</code></td>
<td>
<p>A logical value. If set to <code>TRUE</code>, only the
mean-variance curve is added to the current plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to <code>plot</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>All <code>bioCond</code> objects supplied in <code>conds</code> should be
associated with the same mean-variance curve. Thus, they must have the same
<code>"mvcID"</code> (see <code>fitMeanVarCurve</code> for the data structure
stored in a <code>bioCond</code> object describing its fit of mean-variance
trend). Typically, <code>conds</code> is a returned value from
<code>fitMeanVarCurve</code>, <code>setMeanVarCurve</code> or
<code>extendMeanVarCurve</code>.
</p>
<p>Notably, to make the observed variance of each genomic interval in each
<code>bioCond</code> object comparable to the mean-variance curve, all variance
values used for the scatter plot have been adjusted for the variance ratio
factor specific to each <code>bioCond</code>. See <code>fitMeanVarCurve</code>
and <code>estimatePriorDf</code> for a description of variance ratio
factor. Note also that there is a function named <code>plotMVC</code>
that is specifically designed for plotting a mean-variance curve on a
single <code>bioCond</code>. This function scales mean-variance curve by the
associated variance ratio factor and leaves observed variances unadjusted.
</p>
<p>By default, each genomic interval in each <code>bioCond</code> object that
contains replicate samples provides one point for the scatter plot. Setting
<code>subset</code> to <code>"occupied"</code> (<code>"non-occupied"</code>) makes the
function use only those intervals occupied (not occupied) by their
<code>bioCond</code>s to draw the plot (see <code>normalize</code> and
<code>bioCond</code> for more information about occupancy states of
genomic intervals).
</p>


<h3>Value</h3>

<p>The function returns <code>NULL</code>.
</p>


<h3>References</h3>

<p>Tu, S., et al., <em>MAnorm2 for quantitatively comparing
groups of ChIP-seq samples.</em> Genome Res, 2021.
<strong>31</strong>(1): p. 131-145.
</p>


<h3>See Also</h3>

<p><code>bioCond</code> for creating a <code>bioCond</code> object;
<code>fitMeanVarCurve</code> for fitting a mean-variance curve given a
list of <code>bioCond</code> objects; <code>extendMeanVarCurve</code> for
extending the application scope of a fitted mean-variance curve to
additional <code>bioCond</code> objects; <code>varRatio</code> for a formal
description of variance ratio factor; <code>plotMVC</code> for plotting
a mean-variance curve on a single <code>bioCond</code> object;
<code>normalize</code> for using
occupancy states of genomic intervals to normalize ChIP-seq samples;
<code>alpha</code> for adjusting color transparency.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(H3K27Ac, package = "MAnorm2")
attr(H3K27Ac, "metaInfo")

## Fit and plot a mean-variance curve for GM12891 and GM12892 cell lines.

# Perform the MA normalization and construct bioConds to represent
# individuals.
norm &lt;- normalize(H3K27Ac, 5:6, 10:11)
norm &lt;- normalize(norm, 7:8, 12:13)
conds &lt;- list(GM12891 = bioCond(norm[5:6], norm[10:11], name = "GM12891"),
              GM12892 = bioCond(norm[7:8], norm[12:13], name = "GM12892"))
autosome &lt;- !(H3K27Ac$chrom %in% c("chrX", "chrY"))
conds &lt;- normBioCond(conds, common.peak.regions = autosome)

# Fit mean-variance trend based on the presumed parametric form.
conds &lt;- fitMeanVarCurve(conds, method = "parametric", occupy.only = TRUE)
summary(conds[[1]])

# Plot the fitted mean-variance curve.
plotMeanVarCurve(conds, subset = "occupied")

# Use different colors for the two bioConds, to see if the mean-variance
# points from the two cell lines mix uniformly with each other.
plotMeanVarCurve(conds, subset = "occupied",
                 col = scales::alpha(c("blue", "green3"), 0.02))

</code></pre>


</div>