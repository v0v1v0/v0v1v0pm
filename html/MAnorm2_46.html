<div class="container">

<table style="width: 100%;"><tr>
<td>scaleMeanVarCurveRobust</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Scale a Mean-Variance Curve in a Robust Manner</h2>

<h3>Description</h3>

<p><code>scaleMeanVarCurveRobust</code> underlies other interface functions for
estimating the variance ratio factor of an unadjusted mean-variance curve
(or a set of unadjusted mean-variance curves)
<em>in a robust manner</em>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">scaleMeanVarCurveRobust(
  z,
  m,
  d0,
  p_low = 0.01,
  p_up = 0.1,
  nw = gauss.quad(128, kind = "legendre")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>A list of which each element is a vector of FZ statistics
corresponding to a <code>bioCond</code> object (see also "Details").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>A vector of numbers of replicates in <code>bioCond</code>
objects. Must correspond to <code>z</code> one by one in the same
order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d0</code></td>
<td>
<p>A positive real specifying the number of prior degrees of freedom
of the mean-variance curve(s). <code>Inf</code> is allowed. Note that
<code>d0</code> could be robustly estimated by <code>estimateD0Robust</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_low, p_up</code></td>
<td>
<p>Lower- and upper-tail probabilities for Winsorizing the
FZ statistics associated with each <code>bioCond</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nw</code></td>
<td>
<p>A list containing <code>nodes</code> and <code>weights</code> variables for
calculating the definite integral of a function <code>f</code> over the
interval <code>[-1, 1]</code>, which is approximated by
<code>sum(nw$weights * f(nw$nodes))</code>. By default,
a set of Gauss-Legendre nodes along with the corresponding weights
calculated by <code>gauss.quad</code> is used.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For each <code>bioCond</code> object with replicate samples, a vector of
FZ statistics can be deduced from the unadjusted mean-variance curve
associated with it. More specifically, for each genomic interval in a
<code>bioCond</code> with replicate samples, its FZ statistic is defined to be
<code class="reqn">log(t_hat / v0)</code>, where <code class="reqn">t_hat</code> is the observed variance of signal
intensities of the interval, and <code class="reqn">v0</code> is the interval's prior variance
read from the corresponding mean-variance curve.
</p>
<p>Theoretically, each FZ statistic follows a scaled Fisher's Z distribution
plus a constant (since the mean-variance curve is not adjusted yet),
and we derive a robust estimation of log variance ratio factor by
Winsorizing the FZ statistics of each <code>bioCond</code> and matching the
resulting sample mean with the theoretical expectation of the Winsorized
distribution, which is calculated by using numerical integration (see
also "References").
</p>
<p>The final estimate of log variance ratio factor is a weighted mean of
estimates across <code>bioCond</code> objects, with the weights being their
respective numbers of genomic intervals that are used to calculate
FZ statistics.
</p>
<p>Finally, we get an estimate of variance ratio factor by taking an
exponential.
</p>


<h3>Value</h3>

<p>The estimated variance ratio factor for adjusting the mean-variance
curve(s). Note that the function returns <code>NA</code> if there are not
sufficient genomic intervals for estimating it.
</p>


<h3>References</h3>

<p>Phipson, B., et al., <em>Robust Hyperparameter Estimation
Protects against Hypervariable Genes and Improves Power to Detect
Differential Expression.</em> Annals of Applied Statistics, 2016.
<strong>10</strong>(2): p. 946-963.
</p>


<h3>See Also</h3>

<p><code>bioCond</code> for creating a <code>bioCond</code> object;
<code>fitMeanVarCurve</code> for fitting a mean-variance curve;
<code>varRatio</code> for a formal description of variance ratio
factor; <code>estimateD0Robust</code>
for estimating the number of prior degrees of freedom associated with
a mean-variance curve (or a set of curves) <em>in a robust manner</em>;
<code>estimatePriorDfRobust</code> for an interface to <em>robustly</em>
estimating the number of prior degrees of freedom on <code>bioCond</code>
objects as well as <em>robustly</em> adjusting their mean-variance
curve(s) accordingly.
</p>
<p><code>estimateD0</code> and <code>scaleMeanVarCurve</code>
for the ordinary (non-robust) routines for estimating number of prior
degrees of freedom and variance ratio factor, respectively.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Refer to "Examples" given in the help page for the function
# estimateD0Robust.

</code></pre>


</div>