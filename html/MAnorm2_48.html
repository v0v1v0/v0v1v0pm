<div class="container">

<table style="width: 100%;"><tr>
<td>setPriorDf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Set the Number of Prior Degrees of Freedom of Mean-Variance Curves</h2>

<h3>Description</h3>

<p>Given a set of <code>bioCond</code> objects of which each has been
associated with a mean-variance curve, <code>setPriorDf</code> assigns a
common number of prior degrees of freedom to all the <code>bioCond</code>s
and accordingly adjusts their variance ratio factors.
</p>


<h3>Usage</h3>

<pre><code class="language-R">setPriorDf(conds, d0, occupy.only = TRUE, no.rep.rv = NULL, .call = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>conds</code></td>
<td>
<p>A list of <code>bioCond</code> objects, of which each has a
<code>fit.info</code> field describing its mean-variance curve (see also
<code>fitMeanVarCurve</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d0</code></td>
<td>
<p>A non-negative real specifying the number of prior degrees of
freedom. <code>Inf</code> is allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>occupy.only</code></td>
<td>
<p>A logical scalar. If it is <code>TRUE</code> (default), only
occupied intervals are used to adjust the variance ratio factors.
Otherwise, all intervals are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no.rep.rv</code></td>
<td>
<p>A positive real specifying the variance ratio factor of
those <code>bioCond</code>s without replicate samples, if any. By default,
it's set to the geometric mean of variance ratio factors of the other
<code>bioCond</code>s.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.call</code></td>
<td>
<p>Never care about this argument.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The specific behavior of this function is pretty much the same as
<code>estimatePriorDf</code>, except that
the number of prior degrees of freedom is
directly specified by users rather than estimated based on the observed
data. Refer to <code>estimatePriorDf</code> for more information.
</p>
<p>Note also that there is a <em>robust</em> version of this function that uses
Winsorized statistics to derive variance ratio factors (see
<code>setPriorDfRobust</code> for details).
</p>


<h3>Value</h3>

<p><code>setPriorDf</code> returns the argument list of
<code>bioCond</code> objects, with the specified
number of prior degrees of
freedom substituted for the <code>"df.prior"</code> component of each of them.
Besides, their <code>"ratio.var"</code> components have been adjusted
accordingly, and an attribute named <code>"no.rep.rv"</code> is added to the
list if it's ever been used as the variance ratio factor of the
<code>bioCond</code>s without replicate samples.
</p>
<p>To be noted, if the specified number of prior degrees of freedom is 0,
<code>setPriorDf</code> won't adjust existing variance ratio factors.
In this case, you may want to use <code>setPriorDfVarRatio</code> to
explicitly specify variance ratio factors.
</p>


<h3>See Also</h3>

<p><code>bioCond</code> for creating a <code>bioCond</code> object;
<code>fitMeanVarCurve</code> for fitting a mean-variance curve and
using a <code>fit.info</code> field to characterize it;
<code>estimatePriorDf</code> for estimating the number of prior
degrees of freedom and adjusting the variance ratio factors of a set of
<code>bioCond</code>s;
<code>setPriorDfRobust</code> for a <em>robust</em> version of
<code>setPriorDf</code>;
<code>diffTest</code> for calling
differential intervals between two <code>bioCond</code> objects.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(H3K27Ac, package = "MAnorm2")
attr(H3K27Ac, "metaInfo")

## Fit a mean-variance curve for the GM12892 cell line (i.e., individual)
## and set the number of prior degrees of freedom of the curve to Inf.

# Perform the MA normalization and construct a bioCond to represent GM12892.
norm &lt;- normalize(H3K27Ac, 7:8, 12:13)
GM12892 &lt;- bioCond(norm[7:8], norm[12:13], name = "GM12892")

# Variations in ChIP-seq signals across biological replicates of a cell line
# are generally of a low level, and typically their relationship with the
# mean signal intensities could be well modeled by the presumed parametric
# form.
GM12892 &lt;- fitMeanVarCurve(list(GM12892), method = "parametric",
                           occupy.only = TRUE, init.coef = c(0.1, 10))[[1]]

# In the vast majority of cases for modeling biological replicates of cell
# lines, the associated variance structure is so regular that variances of
# individual genomic intervals could be reliably estimated by fully
# depending on the mean-variance curve.
GM12892_2 &lt;- setPriorDf(list(GM12892), Inf, occupy.only = TRUE)[[1]]

# The resulting model makes few differences from the original one, though.
# This is because MAnorm2 will adaptively deduce a large number of prior
# degrees of freedom for the mean-variance curve if the underlying variance
# structure is of high regularity. In practice, we recommend leaving the
# specification of prior df to the estimation method implemented in MAnorm2
# all the time.
summary(GM12892)
summary(GM12892_2)

</code></pre>


</div>