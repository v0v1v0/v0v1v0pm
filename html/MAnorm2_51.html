<div class="container">

<table style="width: 100%;"><tr>
<td>setWeight</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Set the Weights of Signal Intensities Contained in a <code>bioCond</code>
</h2>

<h3>Description</h3>

<p><code>setWeight</code> modifies the relative precisions of signal intensities
stored in a <code>bioCond</code> object. One typically uses this function
in the form of <code>x &lt;- setWeight(x, weight)</code>, where <code>x</code> is a
<code>bioCond</code> object and <code>weight</code> is a matrix of positive weights.
</p>


<h3>Usage</h3>

<pre><code class="language-R">setWeight(x, weight = NULL, strMatrix = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A <code>bioCond</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>A matrix or data frame specifying the relative precisions of
signal intensities contained in <code>x</code>. Must have the same number of
columns as <code>x$norm.signal</code>. A vector is interpreted as a matrix
having a single row. Note that rows of <code>weight</code> are recycled if
necessary. By default, the same weight is assigned to each measurement
in <code>x$norm.signal</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strMatrix</code></td>
<td>
<p>An optional list of symmetric matrices specifying directly
the structure matrix of each genomic interval. Elements of it are
recycled if necessary.
This argument, if set, overrides the <code>weight</code>
argument. See "Details" for more information about structure matrix.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For each genomic interval in a <code>bioCond</code> object, MAnorm2 models
the signal intensities of it as having a common mean and a covariance
matrix proportional to the interval's structure matrix. Put it formally,
<code class="reqn">cov(Xi | ti) = ti * Si</code>, where <code class="reqn">Xi</code> is
the vector of signal intensities of the <code class="reqn">i</code>th interval, <code class="reqn">ti</code> is a
positive scalar quantifying the variation level of this interval and
<code class="reqn">Si</code> is a symmetric matrix denoting the interval's structure matrix.
</p>
<p>Naturally, assuming there are no correlations between ChIP-seq samples,
each <code class="reqn">Si</code> is a diagonal matrix, with its diagonal elements being the
reciprocal of the corresponding weights.
</p>
<p>The structure matrices will be used to derive the sample mean and sample
variance (i.e., estimate of <code class="reqn">ti</code>) of signal intensities of each
interval, using the GLS (generalized least squares) estimation. See also
<code>fitMeanVarCurve</code> for modeling their relationship across
intervals.
</p>


<h3>Value</h3>

<p>A <code>bioCond</code> object with an updated <code>strMatrix</code>
field. To be noted, information about the mean-variance dependence of
the original <code>bioCond</code> object, if any, will be removed in the
returned <code>bioCond</code>. You can re-fit it by, for example, calling
<code>fitMeanVarCurve</code>.
</p>


<h3>Warning</h3>

<p>Do not directly modify the <code>strMatrix</code> field in a
<code>bioCond</code> object. Instead, use this function.
</p>


<h3>References</h3>

<p>Tu, S., et al., <em>MAnorm2 for quantitatively comparing
groups of ChIP-seq samples.</em> Genome Res, 2021.
<strong>31</strong>(1): p. 131-145.
</p>


<h3>See Also</h3>

<p><code>bioCond</code> for creating a <code>bioCond</code> object based on
normalized signal intensities; <code>fitMeanVarCurve</code> for fitting
the mean-variance trend across genomic intervals.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(H3K27Ac, package = "MAnorm2")
attr(H3K27Ac, "metaInfo")

## Set the weights of replicate ChIP-seq samples in a bioCond.

# Construct a bioCond object for the GM12891 cell line. By default, all the
# ChIP-seq samples belonging to the bioCond have the same weight for
# estimating the mean signal intensities of genomic intervals in the cell
# line.
norm &lt;- normalize(H3K27Ac, 5:6, 10:11)
GM12891 &lt;- bioCond(norm[5:6], norm[10:11], name = "GM12891")

# Now we set the weight of the 2nd sample to half of the 1st one.
GM12891_2 &lt;- setWeight(GM12891, weight = c(1, 0.5))

# Equivalently, you can achieve the same effect by setting the strMatrix
# parameter.
GM12891_3 &lt;- setWeight(GM12891, strMatrix = list(diag(c(1, 2))))

</code></pre>


</div>