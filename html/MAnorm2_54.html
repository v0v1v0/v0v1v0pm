<div class="container">

<table style="width: 100%;"><tr>
<td>varRatio</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compare Variance Ratio Factors of Two <code>bioCond</code> Objects</h2>

<h3>Description</h3>

<p>Given two <code>bioCond</code> objects, <code>varRatio</code> robustly estimates
the ratio between their variance ratio factors, assuming they are
associated with the same mean-variance curve and using the genomic intervals
expected to have invariant signal intensities across the two biological
conditions (see "Details").
</p>


<h3>Usage</h3>

<pre><code class="language-R">varRatio(cond1, cond2, invariant = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cond1, cond2</code></td>
<td>
<p>Two <code>bioCond</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>invariant</code></td>
<td>
<p>An optional non-negative real specifying the upper bound
of difference in mean signal intensity for a genomic interval to be
treated as invariant between <code>cond1</code> and <code>cond2</code>. By default,
intervals occupied by both conditions are treated as invariant.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>MAnorm2 models ChIP-seq samples as grouped by biological conditions. It
constructs a <code>bioCond</code> object to represent each biological
condition, which contains a set of ChIP-seq samples belonging to the
condition.
</p>
<p>Given multiple <code>bioCond</code> objects, MAnorm2 could fit a single curve to
model the mean-variance dependence across genomic intervals.
Each genomic interval in
each <code>bioCond</code> object that contains replicate samples serves as an
observation for the fitting process.
</p>
<p>To account for the global difference in variation level of signal
intensities between two conditions, MAnorm2 involves a "variance ratio
factor" for each condition. Specifically, given two <code>bioCond</code>
objects associated with the same mean-variance curve
(say condition 1 and 2), we have
</p>
<p style="text-align: center;"><code class="reqn">cov(Xi,1 | vi) = (r1 * vi) * Si,1</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">cov(Xi,2 | vi) = (r2 * vi) * Si,2</code>
</p>

<p>for any genomic interval <code class="reqn">i</code> that is <em>not</em>
differentially represented between the two conditions. Here, <code class="reqn">Xi,j</code>
is the vector of signal intensities of interval <code class="reqn">i</code>
in condition <code class="reqn">j</code>,
<code class="reqn">rj</code> is the variance ratio factor (a scalar) of condition <code class="reqn">j</code>,
<code class="reqn">vi</code> is the unscaled variance (a scalar) of signal intensities in
interval <code class="reqn">i</code>, and <code class="reqn">Si,j</code> is the structure matrix of interval <code class="reqn">i</code>
in condition <code class="reqn">j</code> (see <code>bioCond</code> and <code>setWeight</code>
for a detailed description of structure matrix).
</p>
<p>Under this formulation, <code>varRatio</code> estimates the ratio of the
variance ratio factor of <code>cond2</code> to that of <code>cond1</code>, using the
intervals with invariant signal intensities across the two conditions. The
argument <code>invariant</code> controls the set of such intervals.
By default, intervals
occupied by both conditions constitute the set. Alternatively, giving
<code>invariant</code> a non-negative value
specifies these intervals to be invariant
that have a difference in average signal intensity between the two
conditions less than or equal to the value.
</p>
<p>In most cases, you don't need to call this function directly. It's typically
used by <code>fitMeanVarCurve</code> for fitting a mean-variance trend on a
set of <code>bioCond</code> objects.
</p>


<h3>Value</h3>

<p>The estimated ratio of the variance ratio factor of <code>cond2</code> to
that of <code>cond1</code>. Note that the function returns <code>NA</code> if there
are not sufficient invariant intervals for estimating it.
</p>


<h3>References</h3>

<p>Tu, S., et al., <em>MAnorm2 for quantitatively comparing
groups of ChIP-seq samples.</em> Genome Res, 2021.
<strong>31</strong>(1): p. 131-145.
</p>


<h3>See Also</h3>

<p><code>bioCond</code> for creating a <code>bioCond</code> object;
<code>setWeight</code> for a detailed description of structure matrix;
<code>fitMeanVarCurve</code> for fitting a mean-variance curve given a
set of <code>bioCond</code> objects.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(H3K27Ac, package = "MAnorm2")
attr(H3K27Ac, "metaInfo")

## Compare variance ratio factor between cell lines.

# Perform the MA normalization and construct bioConds to represent cell
# lines.
norm &lt;- normalize(H3K27Ac, 4, 9)
norm &lt;- normalize(norm, 5:6, 10:11)
norm &lt;- normalize(norm, 7:8, 12:13)
conds &lt;- list(GM12890 = bioCond(norm[4], norm[9], name = "GM12890"),
              GM12891 = bioCond(norm[5:6], norm[10:11], name = "GM12891"),
              GM12892 = bioCond(norm[7:8], norm[12:13], name = "GM12892"))
autosome &lt;- !(H3K27Ac$chrom %in% c("chrX", "chrY"))
conds &lt;- normBioCond(conds, common.peak.regions = autosome)

# Compare the variance ratio factor of GM12892 to that of GM12891.
varRatio(conds$GM12891, conds$GM12892)

# Such a comparison is only possible when both bioConds have replicate
# samples.
varRatio(conds$GM12891, conds$GM12890)

</code></pre>


</div>