<div class="container">

<table style="width: 100%;"><tr>
<td>MBCn</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Multivariate bias correction (N-pdft)
</h2>

<h3>Description</h3>

<p>Multivariate bias correction that matches the multivariate
distribution using <code>QDM</code> and the N-dimensional
probability density function transform (N-pdft) following
Cannon (2018).
</p>


<h3>Usage</h3>

<pre><code class="language-R">MBCn(o.c, m.c, m.p, iter=30, ratio.seq=rep(FALSE, ncol(o.c)),
     trace=0.05, trace.calc=0.5*trace, jitter.factor=0,
     n.tau=NULL, ratio.max=2, ratio.max.trace=10*trace,
     ties='first', qmap.precalc=FALSE, rot.seq=NULL,
     silent=FALSE, n.escore=0, return.all=FALSE, subsample=NULL,
     pp.type=7)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>o.c</code></td>
<td>

<p>matrix of observed samples during the calibration period.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m.c</code></td>
<td>

<p>matrix of model outputs during the calibration period.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m.p</code></td>
<td>

<p>matrix of model outputs during the projected period.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>

<p>maximum number of algorithm iterations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratio.seq</code></td>
<td>

<p>vector of logical values indicating if samples are of a ratio quantity (e.g., precipitation).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>

<p>numeric values indicating thresholds below which values of a ratio quantity (e.g., <code>ratio=TRUE</code>) should be considered exact zeros.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace.calc</code></td>
<td>

<p>numeric values of thresholds used internally when handling of exact zeros; defaults to one half of <code>trace</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jitter.factor</code></td>
<td>

<p>optional strength of jittering to be applied when quantities are quantized.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.tau</code></td>
<td>

<p>number of quantiles used in the quantile mapping; <code>NULL</code> equals the length of the <code>m.p</code> series.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratio.max</code></td>
<td>

<p>numeric values indicating the maximum proportional changes allowed for ratio quantities below the <code>ratio.max.trace</code> threshold.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratio.max.trace</code></td>
<td>

<p>numeric values of trace thresholds used to constrain the proportional change in ratio quantities to <code>ratio.max</code>; defaults to ten times <code>trace</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ties</code></td>
<td>

<p>method used to handle ties when calculating ordinal ranks.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qmap.precalc</code></td>
<td>

<p>logical value indicating if <code>m.c</code> and <code>m.p</code> are outputs from <code>QDM</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rot.seq</code></td>
<td>

<p>use a supplied list of random rotation matrices. <code>NULL</code> generates on
the fly.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>

<p>logical value indicating if algorithm progress should be reported.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.escore</code></td>
<td>

<p>number of cases used to calculate the energy distance when monitoring 
convergence.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.all</code></td>
<td>

<p>logical value indicating whether results from all iterations are returned.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subsample</code></td>
<td>

<p>use <code>subsample</code> draws of size <code>n.tau</code> to calculate initial
empirical quantiles; if <code>NULL</code>, calculate normally.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pp.type</code></td>
<td>

<p>type of plotting position used in <code>quantile</code>.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list of with elements consisting of:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mhat.c</code></td>
<td>
<p>matrix of bias corrected <code>m.c</code> values for the calibration period.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mhat.p</code></td>
<td>
<p>matrix of bias corrected <code>m.p</code> values for the projection period.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Cannon, A.J., 2018. Multivariate quantile mapping bias correction: An 
N-dimensional probability density function transform for climate model
simulations of multiple variables. Climate Dynamics, 50(1-2):31-49.
doi:10.1007/s00382-017-3580-6
</p>
<p>Cannon, A.J., S.R. Sobie, and T.Q. Murdock, 2015. Bias correction
of simulated precipitation by quantile mapping: How well do methods
preserve relative changes in quantiles and extremes? Journal of
Climate, 28:6938-6959. doi:10.1175/JCLI-D-14-00754.1
</p>
<p>Pitié, F., A.C. Kokaram, and R. Dahyot, 2005. N-dimensional probability
density function transfer and its application to color transfer.
In Tenth IEEE International Conference on Computer Vision, 2005.
ICCV 2005. (Vol. 2, pp. 1434-1439). IEEE.
</p>
<p>Pitié, F., A.C. Kokaram, and R. Dahyot, 2007. Automated colour grading
using colour distribution transfer. Computer Vision and Image
Understanding, 107(1):123-137.
</p>


<h3>See Also</h3>

<p><code>QDM, MBCp, MBCr, MRS, escore, rot.random</code>
</p>


</div>