<div class="container">

<table style="width: 100%;"><tr>
<td>ci.sc.ancova</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Confidence interval for a standardized contrast in ANCOVA with one covariate</h2>

<h3>Description</h3>

<p>Calculate the confidence interval for a standardized contrast in ANCOVA with one covariate. The standardizer
(i.e., the divisor) can be either the error standard deviation of the ANOVA model (i.e., the model excluding the covariate)
or of the ANCOVA model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ci.sc.ancova(Psi=NULL, adj.means=NULL, s.anova = NULL, s.ancova, 
standardizer = "s.ancova", c.weights, n, cov.means, SSwithin.x, 
conf.level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Psi</code></td>
<td>
<p>unstandardized contrast of adjusted means </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj.means</code></td>
<td>
<p>the vector that contains the adjusted mean of each group on the dependent variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s.anova</code></td>
<td>
<p>the standard deviation of the errors from the ANOVA model (i.e., the square root of the mean square error from ANOVA)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s.ancova</code></td>
<td>
<p>the standard deviation of the errors from the ANCOVA model (i.e., the square root of the mean square error from ANCOVA)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standardizer</code></td>
<td>
<p>which error standard deviation the user wants to use, the value of which can be
either <code>"s.ancova"</code> or <code>"s.anova"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c.weights</code></td>
<td>
<p>the contrast weights (chose weights so that the positive <em>c</em>-weights sum to 1 and the negative <em>c</em>-weights sum to -1; i.e., use fractional values not integers).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>either a single number that indicates the sample size per group, or a vector that contains the
sample size of each group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.means</code></td>
<td>
<p> a vector that contains the group means of the covariate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SSwithin.x</code></td>
<td>
<p>the sum of squares within groups obtained from the summary table for ANOVA on the covariate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>the desired confidence interval coverage, (i.e., 1 - Type I error rate)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>standardizer</code></td>
<td>
<p>the divisor used in the standardization</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi.limit.lower</code></td>
<td>
<p>the lower confidence limit of the standardized contrast</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi</code></td>
<td>
<p>the estimated contrast</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi.limit.upper</code></td>
<td>
<p>the upper confidence limit of the standardized contrast</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Be sure to use the standard deviations and not the error variances for <code>s.anova</code> and <code>s.ancova</code>, not the squares of these values which would come from the source tables (i.e., do not use the variance of the errors but rather use its square root, the standard deviation).
</p>
<p>If <code>n</code> receives a single number, that number is considered as the sample size per group. If <code>n</code>
is assigned to a vector, the vector is considered as the sample size of each group.
</p>
<p>Be sure to use fractional <em>c</em>-weights when doing complex contrasts (not integers) to specify <code>c.weights</code>. For example, in an ANCOVA of four groups, if the user wants to compare the mean of group 1 and 2 with the mean of group 3 and 4, <code>c.weights</code> should be specified as c(0.5, 0.5, -0.5, -0.5) rather than c(1, 1, -1, -1). Make sure the sum of the contrast weights are zero.
</p>
<p>The argument to be assigned to <code>standardizer</code> must be either <code>"s.ancova"</code> or <code>"s.anova"</code>. 
</p>


<h3>Author(s)</h3>

<p>Keke Lai (University of California–Merced) and Ken Kelley <a href="mailto:kkelley@nd.edu">kkelley@nd.edu</a></p>


<h3>References</h3>

 
<p>Kelley, K. (2007). Constructing confidence intervals for standardized effect sizes: Theory, application, 
and implementation. <em>Journal of Statistical Software, 20</em> (8), 1–24.
</p>
<p>Kelley, K., &amp; Rausch, J. R. (2006). Sample size planning for the standardized mean difference: 
Accuracy in Parameter Estimation via narrow confidence intervals. <em>Psychological Methods, 11</em>, 363–385.
</p>
<p>Lai, K., &amp; Kelley, K. (2012). Accuracy in parameter estimation for ANCOVA and ANOVA contrasts: Sample size planning via narrow confidence intervals. <em>British Journal of Mathematical and Statistical Psychology, 65</em>, 350–370.
</p>
<p>Steiger, J. H., &amp; Fouladi, R. T. (1997). Noncentrality interval estimation and the evaluation of
statistical methods. In L. L. Harlow, S. A. Mulaik, &amp; J.H. Steiger (Eds.), <em>What if there were
no significance tests?</em> (pp. 221–257). Mahwah, NJ: Lawrence Erlbaum. </p>


<h3>See Also</h3>

<p><code>ci.c.ancova</code>, <code>ci.sc</code> </p>


<h3>Examples</h3>

<pre><code class="language-R"># Maxwell &amp; Delaney (2004, pp. 428--468) offer an example that 30 depressive 
# individuals are randomly assigned to three groups, 10 in each, and ANCOVA 
# is performed on the posttest scores using the participants' pretest 
# scores as the covariate. The means of pretest scores of group 1, 2, and 3 are 
# 17, 17.7, and 17.4, respectively, whereas the adjusted means of groups 1, 2, and 3 
# are 7.5, 12, and 14, respectively. The error variance in ANCOVA is 29 and thus 
# 5.385165 is the error standard deviation, with the sum of squares within groups 
# from an ANOVA on the covariate is 752.5. 

# To obtained the confidence interval for the standardized adjusted
# mean difference between group 1 and 2, using the ANCOVA error standard
# deviation:
ci.sc.ancova(adj.means=c(7.5, 12, 14), s.ancova=5.385165, c.weights=c(1,-1,0), 
n=10, cov.means=c(17, 17.7, 17.4), SSwithin.x=752.5)

# Or, with less error in rounding:
ci.sc.ancova(adj.means=c(7.54, 11.98, 13.98), s.ancova=5.393, c.weights=c(-1,0,1), 
n=10, cov.means=c(17, 17.7, 17.4), SSwithin.x=752.5)

# Now, using the standard deviation from ANOVA (and not ANCOVA as above), we have:
ci.sc.ancova(adj.means=c(7.54, 11.98, 13.98), s.anova=6.294, s.ancova=5.393, c.weights=c(-1,0,1),
n=10, cov.means=c(17, 17.7, 17.4), SSwithin.x=752.5, standardizer= "s.anova", conf.level=.95)
</code></pre>


</div>