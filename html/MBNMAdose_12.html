<div class="container">

<table style="width: 100%;"><tr>
<td>devplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot deviance contributions from an MBNMA model</h2>

<h3>Description</h3>

<p>Plot deviance contributions from an MBNMA model
</p>


<h3>Usage</h3>

<pre><code class="language-R">devplot(
  mbnma,
  plot.type = "box",
  facet = TRUE,
  dev.type = "resdev",
  n.iter = mbnma$BUGSoutput$n.iter/2,
  n.thin = mbnma$BUGSoutput$n.thin,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mbnma</code></td>
<td>
<p>An S3 object of class <code>"mbnma"</code> generated by running
a dose-response MBNMA model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.type</code></td>
<td>
<p>Deviances can be plotted either as scatter points (<code>"scatter"</code>)
or as boxplots (<code>"box"</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>facet</code></td>
<td>
<p>A boolean object that indicates whether or not to facet (by agent for <code>MBNMAdose</code>
and by treatment for <code>MBNMAtime</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dev.type</code></td>
<td>
<p><em>STILL IN DEVELOPMENT FOR MBNMAdose!</em> Deviances to plot - can be either residual
deviances (<code>"resdev"</code>, the default) or deviances (<code>"dev"</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.iter</code></td>
<td>
<p>number of total iterations per chain (including burn in;
default: 2000)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.thin</code></td>
<td>
<p>thinning rate. Must be a positive integer.  Set
<code>n.thin</code> &gt; 1 to save memory and computation time if
<code>n.iter</code> is large.  Default is <code>max(1, floor(n.chains *
    (n.iter-n.burnin) / 1000))</code> which will only thin if there are at
least 2000 simulations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments to be sent to <code>ggplot2::geom_point()</code> or <code>ggplot2::geom_boxplot</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Deviances should only be plotted for models that have converged successfully. If deviance
contributions have not been monitored in <code>mbnma$parameters.to.save</code> then additional
iterations will have to be run to get results for these.
</p>
<p>For <code>MBNMAtime</code>, deviance contributions cannot be calculated for models with a multivariate likelihood (i.e.
those that account for correlation between observations) because the covariance matrix in these
models is treated as unknown (if <code>rho = "estimate"</code>) and deviance contributions will be correlated.
</p>


<h3>Value</h3>

<p>Generates a plot of deviance contributions and returns a list containing the
plot (as an object of <code>class(c("gg", "ggplot"))</code>), and a data.frame of posterior mean
deviance/residual deviance contributions for each observation.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Using the triptans data
network &lt;- mbnma.network(triptans)

# Run an Emax dose-response MBNMA and predict responses
emax &lt;- mbnma.run(network, fun=demax(), method="random")

# Plot deviances
devplot(emax)

# Plot deviances using boxplots
devplot(emax, plot.type="box")

# Plot deviances on a single scatter plot (not facetted by agent)
devplot(emax, facet=FALSE, plot.type="scatter")

# A data frame of deviance contributions can be obtained from the object
#returned by `devplot`
devs &lt;- devplot(emax)
head(devs$dev.data)

# Other deviance contributions not currently implemented but in future
#it will be possible to plot them like so
#devplot(emax, dev.type="dev")


</code></pre>


</div>