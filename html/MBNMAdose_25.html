<div class="container">

<table style="width: 100%;"><tr>
<td>fitplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot fitted values from MBNMA model</h2>

<h3>Description</h3>

<p>Plot fitted values from MBNMA model
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitplot(
  mbnma,
  disp.obs = TRUE,
  n.iter = mbnma$BUGSoutput$n.iter,
  n.thin = mbnma$BUGSoutput$n.thin,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mbnma</code></td>
<td>
<p>An S3 object of class <code>"mbnma"</code> generated by running
a dose-response MBNMA model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>disp.obs</code></td>
<td>
<p>A boolean object to indicate whether raw data responses should be
plotted as points on the graph</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.iter</code></td>
<td>
<p>number of total iterations per chain (including burn in;
default: 2000)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.thin</code></td>
<td>
<p>thinning rate. Must be a positive integer.  Set
<code>n.thin</code> &gt; 1 to save memory and computation time if
<code>n.iter</code> is large.  Default is <code>max(1, floor(n.chains *
    (n.iter-n.burnin) / 1000))</code> which will only thin if there are at
least 2000 simulations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments to be sent to <code>ggplot2::geom_point()</code> or <code>ggplot2::geom_line()</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Fitted values should only be plotted for models that have converged successfully.
If fitted values (<code>theta</code>) have not been monitored in <code>mbnma$parameters.to.save</code>
then additional iterations will have to be run to get results for these.
</p>


<h3>Value</h3>

<p>Generates a plot of fitted values from the MBNMA model and returns a list containing
the plot (as an object of <code>class(c("gg", "ggplot"))</code>), and a data.frame of posterior mean
fitted values for each observation.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Using the triptans data
network &lt;- mbnma.network(triptans)

# Run an Emax dose-response MBNMA and predict responses
emax &lt;- mbnma.run(network, fun=demax(), method="random")

# Plot fitted values and observed values
fitplot(emax)

# Plot fitted values only
fitplot(emax, disp.obs=FALSE)

# A data frame of fitted values can be obtained from the object
#returned by `fitplot`
fits &lt;- fitplot(emax)
head(fits$fv)


</code></pre>


</div>