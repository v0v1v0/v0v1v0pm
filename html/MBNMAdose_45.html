<div class="container">

<table style="width: 100%;"><tr>
<td>pDcalc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate plugin pD from a JAGS model with univariate likelihood for studies
with repeated measurements</h2>

<h3>Description</h3>

<p>Uses results from MBNMA JAGS models to calculate pD via the
plugin method (Spiegelhalter et al. 2002). Can only be used for models with known
standard errors or covariance matrices. Currently only functions with univariate likelihoods. Function
is identical in MBNMAdose and MBNMAtime packages.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pDcalc(
  obs1,
  obs2,
  fups = NULL,
  narm,
  NS,
  theta.result,
  resdev.result,
  likelihood = "normal",
  type = "time"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obs1</code></td>
<td>
<p>A matrix (study x arm) or array (study x arm x time point) containing
observed data for <code>y</code> (normal likelihood) or <code>r</code> (binomial or poisson likelihood)
in each arm of each study. This will be the same array
used as data for the JAGS model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs2</code></td>
<td>
<p>A matrix (study x arm) or array (study x arm x time point) containing
observed data for <code>se</code> (normal likelihood), <code>n</code> (binomial likelihood) or <code>E</code> (poisson likelihood)
in each arm of each study. This will be the same array
used as data for the JAGS model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fups</code></td>
<td>
<p>A numeric vector of length equal to the number of studies,
containing the number of follow-up mean responses reported in each study. Required for
time-course MBNMA models (if <code>type="time"</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>narm</code></td>
<td>
<p>A numeric vector of length equal to the number of studies,
containing the number of arms in each study.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NS</code></td>
<td>
<p>A single number equal to the number of studies in the dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta.result</code></td>
<td>
<p>A matrix (study x arm) or array (study x arm x time point)
containing the posterior mean predicted means/probabilities/rate in each arm of each
study. This will be estimated by the JAGS model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resdev.result</code></td>
<td>
<p>A matrix (study x arm) or array (study x arm x time point)
containing the posterior mean residual deviance contributions in each arm of each
study. This will be estimated by the JAGS model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>likelihood</code></td>
<td>
<p>A character object of any of the following likelihoods:
</p>

<ul>
<li> <p><code>normal</code>
</p>
</li>
<li> <p><code>binomial</code> (does not work with time-course MBNMA models)
</p>
</li>
<li> <p><code>poisson</code> (does not work with time-course MBNMA models)
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>The type of MBNMA model fitted. Can be either <code>"time"</code> or <code>"dose"</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Method for calculating pD via the plugin method proposed by
Spiegelhalter (Spiegelhalter et al. 2002). Standard errors / covariance matrices must be assumed
to be known. To obtain values for <code>theta.result</code> and <code>resdev.result</code> these
parameters must be monitored when running the MBNMA model (using <code>parameters.to.save</code>).
</p>
<p>For non-linear time-course MBNMA models residual deviance contributions may be skewed, which
can lead to non-sensical results when calculating pD via the plugin method.
Alternative approaches are to use pV as an approximation or
pD calculated by Kullback-Leibler divergence (Plummer 2008).
</p>


<h3>Value</h3>

<p>A single numeric value for pD calculated via the plugin method.
</p>


<h3>References</h3>

<p>Plummer M (2008).
“Penalized loss functions for Bayesian model comparison.”
<em>Biostatistics</em>, <b>9</b>(3), 523-39.
ISSN 1468-4357 (Electronic) 1465-4644 (Linking), <a href="https://pubmed.ncbi.nlm.nih.gov/18209015/">https://pubmed.ncbi.nlm.nih.gov/18209015/</a>.<br><br> Spiegelhalter DJ, Best NG, Carlin BP, van der Linde A (2002).
“Bayesian measures of model complexity and fit.”
<em>J R Statistic Soc B</em>, <b>64</b>(4), 583-639.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Using the triptans data
network &lt;- mbnma.network(triptans)

# Fit a dose-response MBNMA, monitoring "psi" and "resdev"
result &lt;- mbnma.run(network, fun=dloglin(), method="random",
              parameters.to.save=c("psi", "resdev"))


#### Calculate pD for binomial data ####

# Prepare data for pD calculation
r &lt;- result$model$data()$r
n &lt;- result$model$data()$n
narm &lt;- result$model$data()$narm
NS &lt;- result$model$data()$NS

psi &lt;- result$BUGSoutput$median$psi
resdevs &lt;- result$BUGSoutput$median$resdev

# Calculate pD via plugin method
pD &lt;- pDcalc(obs1=r, obs2=n, narm=narm, NS=NS,
          theta.result=psi, resdev.result=resdevs,
          likelihood="binomial", type="dose")


</code></pre>


</div>