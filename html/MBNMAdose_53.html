<div class="container">

<table style="width: 100%;"><tr>
<td>predict.mbnma</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Predict responses for different doses of agents in a given population based on MBNMA
dose-response models</h2>

<h3>Description</h3>

<p>Used to predict responses for different doses of agents or to predict
the results of a new study. This is calculated by combining
relative treatment effects with a given reference treatment response
(specific to the population of interest).
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'mbnma'
predict(
  object,
  n.doses = 30,
  exact.doses = NULL,
  E0 = 0.2,
  synth = "fixed",
  lim = "cred",
  regress.vals = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An S3 object of class <code>"mbnma"</code> generated by running
a dose-response MBNMA model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.doses</code></td>
<td>
<p>A number indicating the number of doses at which to make predictions
within each agent. The default is <code>30</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exact.doses</code></td>
<td>
<p>A list of numeric vectors. Each named element in the list corresponds to an
agent (either named similarly to agent names given in the data, or named
correspondingly to the codes for agents given in <code>mbnma</code>) and each number within the vector
for that element corresponds to a dose of the agent for which to predict responses.
Doses can only take positive values. For models fitted using <code>dspline()</code> making predictions at only a very small
number of doses for each agent may throw an error since it can make the spline difficult to identify.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E0</code></td>
<td>
<p>An object to indicate the value(s) to use for the response at dose = 0 (i.e.
placebo) in the prediction. This can take a number of different formats depending
on how it will be used/calculated. The default is <code>0.2</code> since a default of <code>0</code> will typically lead
to non-sensical predictions unless an identify link function has been used for the MBNMA model in <code>object</code>.
</p>

<ul>
<li> <p><code>numeric()</code> A single numeric value representing the deterministic response at dose = 0,
given on the natural scale - so for binomial data, proportions should be given and
for Poisson data, a rate should be given.
</p>
</li>
<li> <p><code>character()</code> A single string representing a stochastic distribution for the response
at dose = 0, given on the natural scale - so for binomial data, proportions should be given and
for Poisson data, a rate should be given. This is specified as a random number generator
(RNG) given as a string, and can take any RNG distribution for which a function exists
in R. For example: <code>"rnorm(n, 7, 0.5)"</code>.
</p>
</li>
<li> <p><code>data.frame()</code> A data frame containing data in the long format (one row per study arm) to be meta-analysed
to estimate the dose = 0 (placebo) response. This could be a set of observational
studies that are specific to the population on which to make
predictions, or it can be a subset of the study arms within the MBNMA dataset
that investigate placebo. See <code>ref.synth()</code>
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>synth</code></td>
<td>
<p>A character object that can take the value <code>"fixed"</code> or <code>"random"</code> to
specify the the type of pooling to use for synthesis of <code>E0</code> if a data frame
has been provided for it. Using <code>"random"</code> rather
than <code>"fixed"</code> for <code>synth</code> will result in wider 95\% CrI for predictions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lim</code></td>
<td>
<p>Specifies calculation of either 95% credible intervals (<code>lim="cred"</code>) or 95% prediction intervals (<code>lim="pred"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regress.vals</code></td>
<td>
<p>A named numeric vector of effect modifier values at which results should
be predicted. Named elements must match variable names specified in <code>regress.vars</code> within
the MBNMA model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments to be sent to <code>R2jags::jags()</code> for synthesis of the network
reference treatment effect (using <code>ref.synth()</code>)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The range of doses on which to make predictions can be specified in one of two ways:
</p>

<ol>
<li>
<p> Use <code>max.dose</code> and <code>n.doses</code> to specify the maximum dose for each agent and the
number of doses within that agent for which to predict responses. Doses will be chosen
that are equally spaced from zero to the maximum dose for each agent. This is useful
for generating plots of predicted responses (using <code style="white-space: pre;">⁠[plot-mbnma.predict]⁠</code>) as it will
lead to fitting a smooth dose-response curve (provided <code>n.doses</code> is sufficiently high).
</p>
</li>
<li>
<p> Use <code>exact.doses</code> to specify the exact doses for which to predict responses for each
agent. This may be more useful when ranking different predicted responses using
<code style="white-space: pre;">⁠[rank-mbnma.predict]⁠</code>
</p>
</li>
</ol>
<h3>Value</h3>

<p>An S3 object of class <code>mbnma.predict</code> that contains the following
elements:
</p>

<ul>
<li> <p><code>predicts</code> A named list of
matrices. Each matrix contains the MCMC results of predicted responses at
follow-up times specified in <code>times</code> for each treatment specified in
<code>treats</code>
</p>
</li>
<li> <p><code>likelihood</code> The likelihood used in the MBNMA model <code>object</code>
</p>
</li>
<li> <p><code>link</code> The link function used in the MBNMA model <code>object</code>
</p>
</li>
<li> <p><code>network</code> The dataset in <code>mbnma.network</code> format
</p>
</li>
<li> <p><code>E0</code> A numeric vector of value(s) used for E0 in the prediction, on the
link scale.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">
# Using the triptans data
network &lt;- mbnma.network(triptans)

# Run an Emax dose-response MBNMA
emax &lt;- mbnma.run(network, fun=demax(), method="random")


###########################
###### Specifying E0 ######
###########################

#### Predict responses using deterministic value for E0 ####
# Data is binomial so we specify E0 on the natural scale as a probability
pred &lt;- predict(emax, E0 = 0.2)

# Specifying non-sensical values will return an error
#pred &lt;- predict(emax, E0 = -10)
### ERROR ###

#### Predict responses using stochastic value for E0 ####
# Data is binomial so we might want to draw from a beta distribution
pred &lt;- predict(emax, E0 = "rbeta(n, shape1=1, shape2=5)")

# Misspecifying the RNG string will return an error
#pred &lt;- predict(emax, E0 = "rbeta(shape1=1, shape2=5)")
### ERROR ###


#### Predict responses using meta-analysis of dose = 0 studies ####

# E0 is assigned a data frame of studies to synthesis
# Can be taken from placebo arms in triptans dataset
ref.df &lt;- network$data.ab[network$data.ab$agent==1,]

# Synthesis can be fixed/random effects
pred &lt;- predict(emax, E0 = ref.df, synth="random")



######################################################################
#### Specifying which doses/agents for which to predict responses ####
######################################################################

# Change the number of predictions for each agent
pred &lt;- predict(emax, E0 = 0.2, n.doses=20)
pred &lt;- predict(emax, E0 = 0.2, n.doses=3)

# Specify several exact combinations of doses and agents to predict
pred &lt;- predict(emax, E0 = 0.2,
            exact.doses=list("eletriptan"=c(0:5), "sumatriptan"=c(1,3,5)))
plot(pred) # Plot predictions

# Print and summarise `mbnma.predict` object
print(pred)
summary(pred)

# Plot `mbnma.predict` object
plot(pred)


</code></pre>


</div>