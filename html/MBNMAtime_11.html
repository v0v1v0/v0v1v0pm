<div class="container">

<table style="width: 100%;"><tr>
<td>fitplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot fitted values from MBNMA model</h2>

<h3>Description</h3>

<p>Plot fitted values from MBNMA model
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitplot(
  mbnma,
  treat.labs = NULL,
  disp.obs = TRUE,
  n.iter = round(mbnma$BUGSoutput$n.iter/4),
  n.thin = mbnma$BUGSoutput$n.thin,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mbnma</code></td>
<td>
<p>An S3 object of class <code>"mbnma"</code> generated by running
a time-course MBNMA model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treat.labs</code></td>
<td>
<p>A character vector of treatment labels with which to name graph panels.
Can use <code>mb.network()[["treatments"]]</code> with original dataset if in doubt.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>disp.obs</code></td>
<td>
<p>A boolean object to indicate whether raw data responses should be
plotted as points on the graph</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.iter</code></td>
<td>
<p>number of total iterations per chain (including burn in;
default: 2000)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.thin</code></td>
<td>
<p>thinning rate. Must be a positive integer.  Set
<code>n.thin</code> &gt; 1 to save memory and computation time if
<code>n.iter</code> is large.  Default is <code>max(1, floor(n.chains *
    (n.iter-n.burnin) / 1000))</code> which will only thin if there are at
least 2000 simulations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments to be sent to <code>ggplot2::ggplot()</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Fitted values should only be plotted for models that have converged successfully.
If fitted values (<code>theta</code>) have not been monitored in <code>mbnma$parameters.to.save</code>
then additional iterations will have to be run to get results for these.
</p>


<h3>Value</h3>

<p>Generates a plot of fitted values from the MBNMA model and returns a list containing
the plot (as an object of class <code>c("gg", "ggplot")</code>), and a data.frame of posterior mean
fitted values for each observation.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Make network
painnet &lt;- mb.network(osteopain)

# Run MBNMA
mbnma &lt;- mb.run(painnet,
  fun=temax(pool.emax="rel", method.emax="common",
    pool.et50="abs", method.et50="random"))

# Plot fitted values from the model
# Monitor fitted values for 500 additional iterations
fitplot(mbnma, n.iter=500)


</code></pre>


</div>