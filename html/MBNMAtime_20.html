<div class="container">

<table style="width: 100%;"><tr>
<td>get.relative</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculates relative effects/mean differences at a particular time-point</h2>

<h3>Description</h3>

<p>Uses mbnma time-course parameter estimates to calculate treatment
differences between treatments or classes at a particular time-point.
Can be used to compare treatments evaluated in studies at different follow-up times, or even
to compare treatments in different MBNMA models via a common comparator.
</p>


<h3>Usage</h3>

<pre><code class="language-R">get.relative(
  mbnma,
  mbnma.add = NULL,
  time = max(mbnma$model.arg$jagsdata$time, na.rm = TRUE),
  treats = unique(c(mbnma$network$treatments, mbnma.add$network$treatments)),
  classes = NULL,
  lim = "cred"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mbnma</code></td>
<td>
<p>An S3 object of class <code>"mbnma"</code> generated by running
a time-course MBNMA model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mbnma.add</code></td>
<td>
<p>An S3 object of <code>class("mbnma")</code> generated by running
a time-course MBNMA model. This should only be specified if results from two different MBNMA models
are to be combined to perform a 2-stage MBNMA (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>A numeric value for the time at which to estimate relative effects/mean differences.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treats</code></td>
<td>
<p>A character vector of treatment names for which to calculate relative effects/mean
differences. Must be a subset of <code>mbnma$network$treatments</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>classes</code></td>
<td>
<p>A character vector of class names for which to calculate relative effects/mean
differences. Must be a subset of <code>mbnma$network$classes</code>. Only works for class effect models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lim</code></td>
<td>
<p>Specifies calculation of either 95% credible intervals (<code>lim="cred"</code>) or 95% prediction intervals (<code>lim="pred"</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>get.relative()</code> can also be used to perform a 2-stage MBNMA that allows synthesis of results
from two different MBNMA models via a single common comparator.
In an MBNMA model, all treatments must share the same time-course function. However, a 2-stage
approach can enable fitting of different time-course functions to different sets ("subnetworks") of
treatments. For example, some treatments may have rich time-course information,
allowing for a more complex time-course function to be used, whereas others may be sparse,
requiring a simpler time-course function.
</p>
<p>Relative comparisons between treatments in the two datasets at specific follow-up times
can then be estimated from MBNMA predicted effects versus a common comparator
using the Bucher method and assuming consistency. See the MBNMAtime vignette for further details.
</p>


<h3>Value</h3>

<p>An object of class <code>"relative.array"</code> list containing:
</p>

<ul>
<li>
<p> The time-point for which results are estimated
</p>
</li>
<li>
<p> Matrices of posterior means, medians, SDs and upper and lower 95% credible intervals for the
differences between each treatment
</p>
</li>
<li>
<p> An array containing MCMC results for the differences between all treatments specified in <code>treats</code>
or all classes specified in <code>classes</code>.
</p>
</li>
</ul>
<p>Results are reported in tables as the row-defined treatment minus the column-defined treatment.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Create an mb.network object from a dataset
alognet &lt;- mb.network(alog_pcfb)

# Run a quadratic time-course MBNMA using the alogliptin dataset
mbnma &lt;- mb.run(alognet,
  fun=tpoly(degree=2,
  pool.1="rel", method.1="random",
  pool.2="rel", method.2="common"
  )
)

# Calculate differences between all treatments at 20 weeks follow-up
allres &lt;- get.relative(mbnma, time=20)

# Calculate difference between a subset of treatments at 10 weeks follow-up
subres &lt;- get.relative(mbnma, time=10,
  treats=c("alog_50", "alog_25", "placebo"))



###########################
##### 2-stage MBNMA #####
###########################

# Using the osteoarthritis dataset
# With placebo (Pl_0) as common comparator between subnetworks

#### Sparse model ####

# Treatments on which time-course data is limited
sparse.trt &lt;- c("Ce_100", "Ce_400", "Du_90", "Lu_200", "Lu_400",
  "Lu_NA", "Et_5", "Ox_44")

# Create a subnetwork of studies comparing these treatments
sparse.df &lt;- osteopain %&gt;% dplyr::group_by(studyID) %&gt;%
  dplyr::filter(any(treatment %in% sparse.trt)) %&gt;%
  dplyr::ungroup() %&gt;%
  subset(treatment %in% c("Pl_0", sparse.trt))

sparse.net &lt;- mb.network(sparse.df)

# Run a ITP MBNMA with a known rate
sparse.mbnma &lt;- mb.run(sparse.net, fun=titp(method.rate=0.8, pool.rate="abs"))


#### Complex model ####

# Treatments on which time-course data is rich
rich.trt &lt;- levels(osteopain$treatment)[!levels(osteopain$treatment) %in%
  c("Pl_0", "Ce_100", "Ce_400", "Du_90", "Lu_200",
    "Lu_400", "Lu_NA", "Et_5", "Ox_44")]

# Create a subnetwork of studies comparing these treatments
rich.df &lt;- osteopain %&gt;% dplyr::group_by(studyID) %&gt;%
  dplyr::filter(any(treatment %in% rich.trt)) %&gt;%
  dplyr::ungroup() %&gt;%
  subset(treatment %in% c("Pl_0", rich.trt))

rich.net &lt;- mb.network(rich.df)

# Run a Emax MBNMA
rich.mbnma &lt;- mb.run(rich.net, temax(p.expon = FALSE))


#### Calculate relative effects between models ####

# At 10 weeks follow-up
rels.sparse &lt;- get.relative(sparse.mbnma, time=10)
rels.rich &lt;- get.relative(rich.mbnma, time=10)

rels.all &lt;- get.relative(mbnma=rich.mbnma,
  mbnma.add=sparse.mbnma, time=10)

print(rels.all$median)



</code></pre>


</div>