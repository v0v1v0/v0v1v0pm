<div class="container">

<table style="width: 100%;"><tr>
<td>plot.mb.predict</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plots predicted responses from a time-course MBNMA model</h2>

<h3>Description</h3>

<p>Plots predicted responses from a time-course MBNMA model
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'mb.predict'
plot(
  x,
  disp.obs = FALSE,
  overlay.ref = TRUE,
  overlay.nma = NULL,
  method = "random",
  col = "blue",
  max.col.scale = NULL,
  treat.labs = NULL,
  plot.bins = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class <code>"mb.predict"</code> generated by
<code>predict("mbnma")</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>disp.obs</code></td>
<td>
<p>A boolean object to indicate whether to show shaded sections
of the plot for where there is observed data (<code>TRUE</code>) or not (<code>FALSE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overlay.ref</code></td>
<td>
<p>A boolean object indicating whether to overlay a line
showing the median network reference treatment response over time on the
plot (<code>TRUE</code>) or not (<code>FALSE</code>). The network reference treatment (treatment
</p>

<ol><li>
<p> must be included in <code>predict</code> for this to display the network reference
treatment properly.
</p>
</li></ol>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overlay.nma</code></td>
<td>
<p>Numeric vector used to overlay the results from a standard NMA model that
"lumps" time-points together within the time bin ranges specified in <code>overlay.nma</code>.
The numbers in <code>overlay.nma</code> define the boundaries of the time bins within which to perform
a standard NMA. Length must be &gt;=2, or can be left as <code>NULL</code> (the default) to indicate that no NMA
should be perfomed. <code>overlay.nma</code> can only be specified if <code>overlay.ref==TRUE</code>.
See Details for further information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Can take <code>"common"</code> or <code>"random"</code> to indicate the type of NMA model used to synthesise data points
given in <code>overlay.nma</code>. The default is <code>"random"</code> since this assumes different
time-points in <code>overlay.nma</code> have been lumped together to estimate the NMA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>A character indicating the colour to use for shading if <code>disp.obs</code>
is set to <code>TRUE</code>. Can be either <code>"blue"</code>, <code>"green"</code>, or <code>"red"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.col.scale</code></td>
<td>
<p>Rarely requires adjustment. The maximum count of
observations (therefore the darkest shaded color) only used if <code>disp.obs</code> is
used. This allows consistency of shading between multiple plotted graphs.
It should always be at least as high as the maximum count of observations
plotted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treat.labs</code></td>
<td>
<p>A vector of treatment labels in the same order as treatment codes.
Easiest to use treatment labels stored by <code>mb.network()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.bins</code></td>
<td>
<p>Plot time bin boundaries as vertical dashed lines. Setting <code>plot.bins=TRUE</code> if <code>overlay.nma</code>
is specified also sets x-axis ticks to time bin boundaries automatically.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments for <code>ggplot()</code> or <code>R2jags()</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For the S3 method <code>plot()</code>, if <code>disp.obs</code> is set to <code>TRUE</code> it is
advisable to ensure predictions in <code>predict</code> are estimated using an even
sequence of time points to avoid misrepresentation of shaded densities.
Shaded counts of observations will be relative to the treatment plotted in
each panel rather than to the network reference treatment if <code>disp.obs</code> is
set to <code>TRUE</code>.
</p>


<h3>Overlaying NMA results</h3>

<p><code>overlay.nma</code> indicates regions of the data (defined as "time bins") over which it may be reasonable to "lump" different
follow-up times from different studies together and assume a standard NMA model. For example:
</p>

<ul>
<li> <p><code>overlay.nma=c(5,10)</code> indicates a single NMA of studies with follow-up times <code style="white-space: pre;">⁠&gt;5⁠</code> and <code style="white-space: pre;">⁠&lt;=10⁠</code>
</p>
</li>
<li> <p><code>overlay.nma=c(5,10,15)</code> indicates two NMAs should be performed of studies with follow-up times <code style="white-space: pre;">⁠&gt;5⁠</code> and <code style="white-space: pre;">⁠&lt;=10⁠</code>
of studies with follow-up times <code style="white-space: pre;">⁠&gt;10⁠</code> and <code style="white-space: pre;">⁠&lt;=15⁠</code>
</p>
</li>
</ul>
<p>When used with MBNMA (via <code>predict.mbnma()</code>) this allows comparison to MBNMA results over a specific range of time within each time bin.
It can be useful to assess which time-course function might be suitable when using <code>binplot()</code>, or to
to assess if the MBNMA predictions are in agreement with predictions from an NMA model when using <code>plot.mb.predict()</code>
for a specific range of time-points. This can be a general indicator of the fit of the time-course model.
</p>
<p>However, it is important to note that the wider the range specified in <code>overlay.nma</code>, the more likely it is that different time-points
are included, and therefore that there is greater heterogeneity/inconsistency in the NMA model. If <code>overlay.nma</code> includes
several follow-up times for any study then only a single time-point will be taken (the one closest to <code>mean(overlay.nma)</code>).
The NMA predictions are plotted over the range specified in <code>overlay.nma</code> as a horizontal line, with the 95%CrI shown by a grey
rectangle. The NMA predictions represent those for <em>any time-points within this range</em> since they lump together data at
all these time-points. Predictions for treatments that are disconnected from
the network reference treatment at data points specified within <code>overlay.nma</code> cannot be estimated so are not included.
</p>
<p>It is important to note that the NMA model is not necessarily the "correct" model, since it "lumps" different time-points
together and ignores potential differences in treatment effects that may arise from this. The wider the range specified in
<code>overlay.nma</code>, the greater the effect of "lumping" and the stronger the assumption of similarity between studies.
</p>
<p>For an NMA model to be estimated and a corresponding prediction to be made from it, <strong>each</strong> time bin
must include the network reference treatment (treatment=1) evaluated in at least 1 connected study in the time bin.
If a given time bin does not meet this criteria then an NMA will not be calculated for it.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Create an mb.network object from a dataset
copdnet &lt;- mb.network(copd)

# Run an MBNMA model with a log-linear time-course
loglin &lt;- mb.run(copdnet,
  fun=tloglin(pool.rate="rel", method.rate="common"),
  rho="dunif(0,1)", covar="varadj")

# Predict responses using the original dataset to estimate the network reference
#treatment response
df.ref &lt;- copd[copd$treatment=="Placebo",]
predict &lt;- predict(loglin, times=c(0:20), E0=0, ref.resp=df.ref)

# Plot the predicted responses with observations displayed on plot as green shading
plot(predict, disp.obs=TRUE, overlay.ref=FALSE, col="green")

# Plot the predicted responses with the median network reference treatment response overlayed
#on the plot
plot(predict, disp.obs=FALSE, overlay.ref=TRUE)

# Plot predictions from NMAs calculated between different time-points
plot(predict, overlay.nma=c(5,10), n.iter=20000)
plot(predict, overlay.nma=c(5,10,15,20), n.iter=20000)
# Time-course fit may be less well at 15-20 weeks follow-up


</code></pre>


</div>