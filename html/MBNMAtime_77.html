<div class="container">

<table style="width: 100%;"><tr>
<td>write.likelihood</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Adds sections of JAGS code for an MBNMA model that correspond to the
likelihood</h2>

<h3>Description</h3>

<p>Adds sections of JAGS code for an MBNMA model that correspond to the
likelihood
</p>


<h3>Usage</h3>

<pre><code class="language-R">write.likelihood(
  model,
  timecourse,
  rho = 0,
  covar = "varadj",
  link = "identity",
  sdscale = FALSE,
  fun
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>A character object of JAGS MBNMA model code</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timecourse</code></td>
<td>
<p>A character object representing the time-course used in the MBNMA model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>The correlation coefficient when modelling within-study correlation between time points. The default is a string representing a
prior distribution in JAGS, indicating that it be estimated from the data (e.g. <code>rho="dunif(0,1)"</code>). <code>rho</code> also be assigned a
numeric value (e.g. <code>rho=0.7</code>), which fixes <code>rho</code> in the model to this value (e.g. for use in a deterministic sensitivity analysis).
If set to <code>rho=0</code> (the default) then this implies modelling no correlation between time points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covar</code></td>
<td>
<p>A character specifying the covariance structure to use for modelling within-study correlation between time-points. This can
be done by specifying one of the following:
</p>

<ul>
<li> <p><code>"varadj"</code> - a univariate likelihood with a variance adjustment to assume a constant correlation between subsequent
time points (Jansen et al. 2015). This is the default.
</p>
</li>
<li> <p><code>"CS"</code> - a multivariate normal likelihood with a
<a href="https://support.sas.com/resources/papers/proceedings/proceedings/sugi30/198-30.pdf">compound symmetry</a> structure
</p>
</li>
<li> <p><code>"AR1"</code> - a multivariate normal likelihood with an
<a href="https://support.sas.com/resources/papers/proceedings/proceedings/sugi30/198-30.pdf">autoregressive AR1</a> structure
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>Can take either <code>"identity"</code> (the default),
<code>"log"</code> (for modelling Ratios of Means (Friedrich et al. 2011)) or
<code>"smd"</code> (for modelling Standardised Mean Differences - although this also corresponds to an identity link function).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdscale</code></td>
<td>
<p>Logical object to indicate whether to write a model that specifies a reference SD
for standardising when modelling using Standardised Mean Differences. Specifying <code>sdscale=TRUE</code>
will therefore only modify the model if link function is set to SMD (<code>link="smd"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fun</code></td>
<td>
<p>An object of class <code>"timefun"</code> generated (see Details) using any of
<code>tloglin()</code>, <code>tpoly()</code>, <code>titp()</code>, <code>temax()</code>, <code>tfpoly()</code>, <code>tspline()</code> or <code>tuser()</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A character vector of JAGS MBNMA model code that includes likelihood
components of the model
</p>


</div>