<div class="container">

<table style="width: 100%;"><tr>
<td>devplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot deviance contributions from an MBNMA model</h2>

<h3>Description</h3>

<p>Plot deviance contributions from an MBNMA model
</p>


<h3>Usage</h3>

<pre><code class="language-R">devplot(
  mbnma,
  dev.type = "dev",
  plot.type = "box",
  xaxis = "time",
  facet = TRUE,
  n.iter = round(mbnma$BUGSoutput$n.iter/4),
  n.thin = mbnma$BUGSoutput$n.thin,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mbnma</code></td>
<td>
<p>An S3 object of class <code>"mbnma"</code> generated by running
a time-course MBNMA model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dev.type</code></td>
<td>
<p>Deviances to plot - can be either residual deviances (<code>"resdev"</code>) or deviances (<code>"dev"</code>, the default)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.type</code></td>
<td>
<p>Deviances can be plotted either as scatter points (<code>"scatter"</code> - using
<code>geom_point()</code>) or as boxplots (<code>"box"</code>, the default)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xaxis</code></td>
<td>
<p>A character object that indicates whether deviance contributions should be plotted
by time (<code>"time"</code>) or by follow-up count (<code>"fup"</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>facet</code></td>
<td>
<p>A boolean object that indicates whether or not to facet by treatment</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.iter</code></td>
<td>
<p>The number of iterations to update the model whilst monitoring additional parameters (if necessary).
Must be a positive integer. Default is the value used in <code>mbnma</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.thin</code></td>
<td>
<p>The thinning rate. Must be a positive integer. Default is the value used in <code>mbnma</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments to be sent to <code>ggplot2::ggplot()</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Deviances should only be plotted for models that have converged successfully. If deviance
contributions have not been monitored in <code>mbnma$parameters.to.save</code> then additional
iterations will have to be run to get results for these.
</p>
<p>Deviance contributions cannot be calculated for models with a multivariate likelihood (i.e.
those that account for correlation between observations) because the covariance matrix in these
models is treated as unknown (if <code>rho="estimate"</code>) and deviance contributions will be correlated.
</p>


<h3>Value</h3>

<p>Generates a plot of deviance contributions and returns a list containing the
plot (as an object of class <code>c("gg", "ggplot")</code>), and a data.frame of posterior mean
deviance/residual deviance contributions for each observation.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Make network
alognet &lt;- mb.network(alog_pcfb)

# Run MBNMA
mbnma &lt;- mb.run(alognet, fun=tpoly(degree=2), intercept=FALSE)

# Plot residual deviance contributions in a scatterplot
devplot(mbnma)

# Plot deviance contributions in boxplots at each follow-up measurement
# Monitor for 500 additional iterations
devplot(mbnma, dev.type="dev", plot.type="box", xaxis="fup", n.iter=500)

</code></pre>


</div>