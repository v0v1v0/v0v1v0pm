<div class="container">

<table style="width: 100%;"><tr>
<td>mcaPeaks</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function to estimate the approximate local minima and maxima of melting
curve data.</h2>

<h3>Description</h3>

<p>The <code>mcaPeaks()</code> is used to estimate the approximate local minima and
maxima of melting curve data. This can be useful to define a temperature
range for melting curve analysis, quality control of the melting curve or to
define a threshold of peak heights. Melting curves may consist of multiple
significant and insignificant melting peaks. <code>mcaPeaks()</code> uses
estimated the temperatures and fluorescence values of the local minima and
maxima. The original data remain unchanged and only the approximate local
minima and maxima are returned. <code>mcaPeaks()</code> takes modified code
proposed earlier by Brian Ripley
(https://stat.ethz.ch/pipermail/r-help/2002-May/021934.html).
</p>


<h3>Usage</h3>

<pre><code class="language-R">mcaPeaks(x, y, span = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p><code>x</code> is the column of a data frame for the temperature.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p><code>y</code> is the column of a data frame for the fluorescence values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>span</code></td>
<td>
<p><code>span</code> is used to adjust the window span.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p.min </code></td>
<td>
<p>returns a <code>data.frame</code> with the temperatures ("T
(minima)") and the fluorescence ("F (minima)") for the local minima of the
processed data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.max </code></td>
<td>
<p>returns a <code>data.frame</code> with the temperatures ("T
(minima)") and the fluorescence ("F (minima)") for the local maxima of the
processed data. </p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Stefan Roediger
</p>


<h3>See Also</h3>

<p><code>mcaSmoother</code>, <code>smooth.spline</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# First Example
data(DMP)
# Smooth and Min-Max normalize melting curve data with mcaSmoother()
tmp &lt;- mcaSmoother(DMP[, 1], DMP[,6], minmax = TRUE, n = 2)

# Extract the first derivative melting curve data
tmp.d &lt;- diffQ(tmp, verbose = TRUE)$xy

# Determine the approximate local minima and maxima of a curve
peak.val &lt;-mcaPeaks(tmp.d[, 1], tmp.d[, 2])
peak.val

# Plot the first derivative melting curve
# Add a horizontal line and points for the approximate local minima 
# and maxima to the plot
plot(tmp.d, type = "l", 
     main = "Show the approximate local minima and maxima of a curve")
  abline(h = 0)
  points(peak.val$p.min, col = 1, pch = 19)
  points(peak.val$p.max, col = 2, pch = 19)
  legend(25, 0.08, c("Minima", "Maxima"), col = c(1,2), pch = c(19,19))

# Second example
# Signifcant peaks can be distinguished by peak hight
plot(tmp.d, type = "l", 
      main = "Show the approximate local minima and maxima of a curve")
  abline(h = 0)
  points(peak.val$p.min, col = 1, pch = 19)
  points(peak.val$p.max, col = 2, pch = 19)
  legend(25, 0.08, c("Minima", "Maxima"), col = c(1,2), pch = c(19,19))

# Test which local maxima peak is above the median + 3 * Median Absolute 
# Add a threshold (th) line to the plot
th.max &lt;- median(peak.val$p.max[, 2]) + 3 * mad(peak.val$p.max[, 2])
abline(h = th.max, col = 3)

# add the approximate temperatures of the local minima and 
# maxima to the plot
T.val &lt;- c(peak.val$p.min[, 1], peak.val$p.max[, 1])
text(T.val, rep(-0.05, length(T.val)), round(T.val,0))

# Use a temperature range from the plot to calculate the Tm of 
# the maximum Trange is used between 37 and 74 degree Celsius

tmp &lt;- mcaSmoother(DMP[, 1], DMP[, 6], minmax = TRUE, Trange = c(37,74), 
		    n = 2)
# Tm 48.23, fluoTm 0.137
diffQ(tmp, fct = max, plot = TRUE)


</code></pre>


</div>