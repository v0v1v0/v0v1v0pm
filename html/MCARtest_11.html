<div class="container">

<table style="width: 100%;"><tr>
<td>EMiteration</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Perform one step of the EM algorithm for finding the MLE under MCAR in a contingency table.</h2>

<h3>Description</h3>

<p>Perform one step of the EM algorithm for finding the MLE under MCAR in a contingency table.
</p>


<h3>Usage</h3>

<pre><code class="language-R">EMiteration(pt, p0h, n0, pSh, nS, bS, M)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pt</code></td>
<td>
<p>An input probability mass function on the joint space, to be updated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p0h</code></td>
<td>
<p>An empirical mass function calculated using complete observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n0</code></td>
<td>
<p>An integer giving the number of complete observations used to calculate <code>p0h</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pSh</code></td>
<td>
<p>A sequence of empirical mass functions calculated using incomplete observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nS</code></td>
<td>
<p>A sequence of integers giving the numbers of incomplete observations used to calculate <code>pSh</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bS</code></td>
<td>
<p>A binary matrix specifying the set of observation patterns. Each row encodes a single pattern.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>A vector of positive integers giving the alphabet sizes of the discrete variables.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The updated probability mass function on the joint space.
</p>


<h3>Examples</h3>

<pre><code class="language-R">bS=matrix(c(1,1,0, 1,0,1, 0,1,1),byrow=TRUE,ncol=3) # Our canonical 3d example
M=c(2,2,2)
n0=200
nS=c(200,200,200)

pS=c(0.125,0.375,0.375,0.125,0.250,0.250,0.250,0.250,0.100,0.400,0.400,0.100)
P12=pS[1:4]; P13=pS[5:8]; P23=pS[9:12]
X12=t(rmultinom(1,size=nS[1],prob=P12)/nS[1])
X13=t(rmultinom(1,size=nS[2],prob=P13)/nS[2])
X23=t(rmultinom(1,size=nS[3],prob=P23)/nS[3])
pSh=cbind(X12,X13,X23)

p0=array(0.125,dim=c(2,2,2))
p0h=array(rmultinom(1,n0,p0),dim=M)/n0

EMiteration(p0,p0h,n0,pSh,nS,bS,M)

</code></pre>


</div>