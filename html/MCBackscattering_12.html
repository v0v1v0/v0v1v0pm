<div class="container">

<table style="width: 100%;"><tr>
<td>Move</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Moves Single Photon in Media</h2>

<h3>Description</h3>

<p>This function calculates the move of single photon in media.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Move(myObject)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>myObject</code></td>
<td>
<p>The mandatory parameter of this function is the MCBS class created by <code>MCBS</code> constructor function.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>The <code>Move</code> function, alias <code>Move.MCBS</code>, calculates updated position coordinates <code>c(x,y,z)</code> according to the motion vector <code>c(u,v,w)</code> and the travel length until next interaction event.
The movement of single photon is calculated in 3 dimensional space. The length of the straight section a photon can travel until the next interaction event is estimated as <code>-log( rnd )</code> where <code>rnd</code> is a uniformly distributed random variable from range 0-1.
</p>


<h3>Value</h3>

<p>The <code>Move</code> function returns an MCBS object as <code>class</code>. Typically the same object is used in argument and result.
As a result, the 3D position of the photon is updated:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>position along x-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>position along y-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>position along z-axis, the depth</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Please note that this function is designed to be used in <code>Simulation</code> function. You may use it separately in case you design your own procedure. In such a case, please note that function <code>Randomize</code> prepares trajectory data for each photon and steps are done using move index <code>myObject$midx</code>.
</p>


<h3>See Also</h3>

<p><code>MCBS</code> for construction of object with initial input parameters.
<code>Simulation</code> for running the simulation with adjusted parameters.
<code>Chart</code> for plot of calculated photon flux profile.
<code>Export</code> for export of photon flux with corresponding radii.
<code>Setup</code> for initial computation of specular reflection and transport albedo.
<code>Launch</code> for start position of single photon and initial direction in media.
<code>Bounce</code> for interaction with surface and computation of photon flux leaving media.
<code>Absorb</code> for absorption of single photon energy in interaction with media.
<code>Scatter</code> for single photon scattering interaction with media.
<code>Randomize</code> for adjustment of random trajectory vectors.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Apple simulation data according to Qin and Lu (2006).
## DOI: 10.13031/2013.20862

# create object
cfgMedia &lt;- c(0.63,30,0,1.4)
cfgSimulation &lt;- c(1e6,0.05,1e-9,3,0.012)
apple &lt;- MCBS(cfgMedia,cfgSimulation)
apple &lt;- Setup(apple)
apple &lt;- Randomize(apple)

# launch with 10Â° incident angle and move first photon
apple$idx &lt;- 1
apple &lt;- Launch(apple,10)
# first move
apple$midx &lt;- 1
cat("Position",apple$x,":",apple$y,":",apple$z,"\n")
apple &lt;- Move(apple)
cat("Position",apple$x,":",apple$y,":",apple$z,"\n")
# second move
apple$midx &lt;- 2
apple &lt;- Move(apple)
cat("Position",apple$x,":",apple$y,":",apple$z,"\n")

</code></pre>


</div>