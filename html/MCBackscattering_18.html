<div class="container">

<table style="width: 100%;"><tr>
<td>Scatter</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Scattering of Single Photon in Media</h2>

<h3>Description</h3>

<p>Scattering is the interaction event in the media when photon hits structural elements and changes direction as a result of collision.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Scatter(myObject)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>myObject</code></td>
<td>
<p>The mandatory parameter of this function is the MCBS class created by <code>MCBS</code> constructor function.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>The <code>Scatter</code> function, alias <code>Scatter.MCBS</code>, calculates the new direction of photon travel. In isotropic media, any new 3D direction can occur with equal probability. In anisotropic media, the new direction is decided according to the Heyney-Greenstein phase function. The isotropic and anisotropic behavior of media is shown by anisotropy factor (g). The anisotropy factor is zero (g = 0) for isotropic media, g = -1 means backward reflection (backscattering) is the most likely, while g = +1 means the most likely result is that photon continues forward (forward scattering). Biological tissues were reported to have high positive anisotropy factor g &gt; 0.8.
</p>


<h3>Value</h3>

<p>The <code>Scatter</code> function returns an MCBS object as <code>class</code>. Typically the same object is used in argument and result.
As a result of <code>Scatter</code> function, new direction is given by <code>c(u,v,w)</code>. These values are used in function <code>Move</code> to calculate next position.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>3D vector coordinate along x-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>3D vector coordinate along y-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>3D vector coordinate along z-axis</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Please note that this function is designed to be used in <code>Simulation</code> function. You may use it separately in case you design your own procedure. In such a case, please note that function <code>Randomize</code> prepares trajectory data for each photon and iterations are done using move index <code>myObject$midx</code>. Results of <code>Scatter</code> function are used in <code>Move</code> function.
</p>


<h3>References</h3>

<p>Henyey, L.G., Greenstein, J.L. (1941)
Diffuse Radiation in the Galaxy.
<em>Astrophysical Journal</em>, <b>93</b>, 70–83.
doi: <a href="https://doi.org/10.1086/144246">10.1086/144246</a>.
</p>
<p>Jacques, S.L. (1998)
Light Distributions from Point, Line and Plane Sources for Photochemical Reactions and Fluorescence in Turbid Biological Tissues.
<em>Photochemistry and Photobiology</em>, <b>67(1)</b>: 23-–32.
doi: <a href="https://doi.org/10.1111/j.1751-1097.1998.tb05161.x">10.1111/j.1751-1097.1998.tb05161.x</a>.
</p>


<h3>See Also</h3>

<p><code>MCBS</code> for construction of object with initial input parameters.
<code>Simulation</code> for running the simulation with adjusted parameters.
<code>Chart</code> for plot of calculated photon flux profile.
<code>Export</code> for export of photon flux with corresponding radii.
<code>Setup</code> for initial computation of specular reflection and transport albedo.
<code>Randomize</code> for adjustment of random trajectory vectors.
<code>Launch</code> for start position of single photon and initial direction in media.
<code>Bounce</code> for interaction with surface and computation of photon flux leaving media.
<code>Move</code> for moving single photon forward.
<code>Absorb</code> for absorption of single photon energy in interaction with media.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Apple simulation data according to Qin and Lu (2006).
## DOI: 10.13031/2013.20862

# create object
cfgMedia &lt;- c(0.63,30,0,1.4)
cfgSimulation &lt;- c(1e6,0.05,1e-9,3,0.012)
apple &lt;- MCBS(cfgMedia,cfgSimulation)
apple &lt;- Setup(apple)
apple &lt;- Randomize(apple)

# launch with 10° incident angle and move first photon
apple$idx &lt;- 1
apple &lt;- Launch(apple)

# first interaction event
cat("Direction",apple$u,":",apple$v,":",apple$w,"\n")
apple$midx &lt;- 1
apple &lt;- Scatter(apple)
cat("Direction",apple$u,":",apple$v,":",apple$w,"\n")
</code></pre>


</div>