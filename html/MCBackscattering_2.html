<div class="container">

<table style="width: 100%;"><tr>
<td>Absorb</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Absorbtion of Single Photon Energy in Media</h2>

<h3>Description</h3>

<p>This function calculates how photon energy decreases during interaction with media.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Absorb(myObject)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>myObject</code></td>
<td>
<p>The mandatory parameter of this function is the MCBS class created by <code>MCBS</code> constructor function.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>The <code>Absorb</code> function, alias <code>Absorb.MCBS</code>, calculates the new energy level after interaction event in the media. If photon energy falls below 0.001, a roulette algorithm makes decision when photon has 10% chance to survive with higher energy and 90% chance to loose all energy. Please keep in mind, that photons start with <code>weight = 1</code> but the first interaction happens at boundary, where photons enter the media.
</p>


<h3>Value</h3>

<p>The <code>Absorb</code> function returns an MCBS object as <code>class</code>. Typically the same object is used in argument and result.
One parameter of a single photon is updated in this procedure:
</p>
<table><tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>photon energy. Its initial value is 1 and decrease according to the albedo.</p>
</td>
</tr></table>
<h3>Note</h3>

<p>Please note that this function is designed to be used in <code>Simulation</code> function. You may use it separately in case you design your own procedure. In such a case, please note that function <code>Randomize</code> prepares trajectory data for each photon and iterations are done using move index <code>myObject$midx</code>. Function <code>Absorb</code> uses random data in roulette algorithm to make decision about photon survival at low energy level.
</p>


<h3>See Also</h3>

<p><code>MCBS</code> for construction of object with initial input parameters.
<code>Simulation</code> for running the simulation with adjusted parameters.
<code>Chart</code> for plot of calculated photon flux profile.
<code>Export</code> for export of photon flux with corresponding radii.
<code>Setup</code> for initial computation of specular reflection and transport albedo.
<code>Launch</code> for start position of single photon and initial direction in media.
<code>Bounce</code> for interaction with surface and computation of photon flux leaving media.
<code>Move</code> for moving single photon forward.
<code>Scatter</code> for single photon scattering interaction with media.
<code>Randomize</code> for adjustment of random trajectory vectors.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Apple simulation data according to Qin and Lu (2006).
## DOI: 10.13031/2013.20862

# create object
cfgMedia &lt;- c(0.63,30,0,1.4)
cfgSimulation &lt;- c(1e6,0.05,1e-9,3,0.012)
apple &lt;- MCBS(cfgMedia,cfgSimulation)
apple &lt;- Setup(apple)
apple &lt;- Randomize(apple)

# launch with 10Â° incident angle and move first photon
apple$idx &lt;- 1
apple &lt;- Launch(apple,10)
# initial weight in media
cat("Photon energy level",apple$weight,"\n")
# first interaction event
apple$midx &lt;- 1
apple &lt;- Absorb(apple)
cat("Photon energy level",apple$weight,"\n")

</code></pre>


</div>