<div class="container">

<table style="width: 100%;"><tr>
<td>MCCM_est</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>General Function to Estimate Mixed Correlation Coefficient Matrix</h2>

<h3>Description</h3>

<p>Estimate the correlation matrix for dataframes containing continuous and ordinal variable, in pairs or simultaneously, using MLE, IRLS, or IGMM.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MCCM_est(
  dataYX,
  order_indx,
  pair_est = FALSE,
  MLE = FALSE,
  R0 = NULL,
  app = TRUE,
  korder = 2,
  max_iter = 1000,
  max_tol = 1e-08,
  show_log = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dataYX</code></td>
<td>
<p>a dataframe or matrix containing both continuous and ordinal variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order_indx</code></td>
<td>
<p>a vector to indicate the ordinal variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pair_est</code></td>
<td>
<p>bool value, TRUE for pairwise estimation, FALSE for simultaneous estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MLE</code></td>
<td>
<p>bool value, TRUE for maximum likelihood estimation, FALSE for IRLS (pairwise) or IGMM (simultaneous) estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R0</code></td>
<td>
<p>the initial value for correlation vector, default Pearson correlation matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>app</code></td>
<td>
<p>bool value for approximation, TRUE for Legendre approximation, FALSE for common integral.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>korder</code></td>
<td>
<p>the order of Legendre approximation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_iter</code></td>
<td>
<p>max iteration number for IGMM.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_tol</code></td>
<td>
<p>max tolerance for iteration algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_log</code></td>
<td>
<p>bool value, TRUE for showing calculation log.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Rmatrix</code></td>
<td>
<p>Estimated mixed correlation coefficient matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>std_matrix</code></td>
<td>
<p>Estimated standard deviation for each mixed correlation coefficient.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>COV</code></td>
<td>
<p>The covariance matrix for MCCM (simultaneous estimation only).</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p>esti_polyserial,
esti_polychoric,
est_mixedGMM,
summary_MCCM_est,
draw_correlation_matrix
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(mvtnorm)
library(MASS)
library(polycor)
library(lavaan)
set.seed(1997)
n = 10000
rho12=0.3
rho13=0.4
rho14=0.5
rho23=0.6
rho24=0.7
rho34=0.8

R = matrix(c(1,rho12,rho13,rho14,rho12,1,rho23,rho24,rho13,rho23,1,rho34,
rho14,rho24,rho34,1),4,4)
indc = c(3,4)
thresholds = list(c(),c(),0,0)
data1 = gen_mixed(n=n,R=R,indc=indc,thresholds=thresholds)
data2 = data.frame(data1$observed)

# pairwise MLE estimation
out_pair_MLE = MCCM_est(dataYX=data2,order_indx=indc,pair_est=TRUE,MLE=TRUE)
# pairwise IRLS estimation
out_pair_IRLS = MCCM_est(dataYX=data2,order_indx=indc,pair_est=TRUE,MLE=FALSE)
# simultaneous MLE estimation
out_sim_MLE = MCCM_est(dataYX=data2,order_indx=indc,pair_est=FALSE,MLE=TRUE)
# simultaneous IGMM estimation
out_sim_IGMM = MCCM_est(dataYX=data2,order_indx=indc,pair_est=FALSE,MLE=FALSE)

summary_MCCM_est(out_pair_MLE)
summary_MCCM_est(out_pair_IRLS)
summary_MCCM_est(out_sim_MLE)
summary_MCCM_est(out_sim_IGMM)
</code></pre>


</div>