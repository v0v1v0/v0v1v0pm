<div class="container">

<table style="width: 100%;"><tr>
<td>draw_correlation_matrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Draw the Correlation Matrix</h2>

<h3>Description</h3>

<p>Estimate the MCCM from dataframe and draw it with scatter plot of matrices (SPLOM). With bivariate scatter plots below the diagonal, histograms on the diagonal, and the polychoric correlation coefficients with standard errors above the diagonal. Correlation ellipses are drawn in the same graph. The red lines below the diagonal are the LOESS smoothed lines, fitting a smooth curve between two variables.
</p>


<h3>Usage</h3>

<pre><code class="language-R">draw_correlation_matrix(
  data1,
  order_indx,
  pair_est = FALSE,
  MLE = FALSE,
  R0 = NULL,
  app = TRUE,
  korder = 2,
  max_iter = 1000,
  max_tol = 1e-08,
  show_log = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data1</code></td>
<td>
<p>a dataframe containing continuous or ordinal variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order_indx</code></td>
<td>
<p>a vector to indicate the ordinal variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pair_est</code></td>
<td>
<p>bool value, TRUE for pairwise estimation, FALSE for simultaneous estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MLE</code></td>
<td>
<p>bool value, TRUE for maximum likelihood estimation, FALSE for IRLS (pairwise) or IGMM (simultaneous) estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R0</code></td>
<td>
<p>the initial value for correlation vector, default Pearson correlation matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>app</code></td>
<td>
<p>bool value for approximation, TRUE for Legendre approximation, FALSE for common integral.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>korder</code></td>
<td>
<p>the order of Legendre approximation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_iter</code></td>
<td>
<p>max iteration number for IGMM.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_tol</code></td>
<td>
<p>max tolerance for iteration algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_log</code></td>
<td>
<p>bool value, TRUE for showing calculation log.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>the SPLOM plot.
</p>


<h3>See Also</h3>

<p>MCCM_est,
summary_MCCM_est
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(mvtnorm)
library(MASS)
library(polycor)
library(lavaan)
set.seed(1997)
n = 10000
rho12=0.3
rho13=0.4
rho14=0.5
rho23=0.6
rho24=0.7
rho34=0.8

R = matrix(c(1,rho12,rho13,rho14,rho12,1,rho23,rho24,rho13,rho23,1,rho34,
rho14,rho24,rho34,1),4,4)
indc = c(3,4)
thresholds = list(c(),c(),0,0)
data1 = gen_mixed(n=n,R=R,indc=indc,thresholds=thresholds)
data2 = data.frame(data1$observed)

# pairwise MLE estimation
draw_correlation_matrix(data2,indc,TRUE,TRUE)
# pairwise IRLS estimation
draw_correlation_matrix(data2,indc,TRUE,FALSE)
# simultaneous MLE estimation
draw_correlation_matrix(data2,indc,FALSE,TRUE)
# simultaneous IGMM estimation
draw_correlation_matrix(data2,indc,FALSE,FALSE)
</code></pre>


</div>