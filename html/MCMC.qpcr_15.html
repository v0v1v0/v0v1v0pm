<div class="container">

<table style="width: 100%;"><tr>
<td>HPDsummary</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Summarizes and plots results of mcmc.qpcr function series.
</h2>

<h3>Description</h3>

<p>Calculates abundances of each gene across factor combinations;
calculates pairwise differences between all factor combinations
and their significances for each gene;
plots results as bar or line graphs with credible intervals (ggplot2)
NOTE: only works for experiments involving a single multi-level fixed factor
or two fully crossed multi-level fixed factors.
</p>


<h3>Usage</h3>

<pre><code class="language-R">HPDsummary(model, data, xgroup=NULL,genes = NA, relative = FALSE, 
log.base = 2, summ.plot = TRUE, ptype="z", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>Model generated by mcmc.qpcr(),mcmc.qpcr.lognormal() or mcmc.qpcr.classic()
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>Dataset used to build the model (returned by cq2counts() or cq2log())
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xgroup</code></td>
<td>

<p>The factor to form the x-axis of the plot. By default the first factor in the model will be used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genes</code></td>
<td>

<p>A vector of gene names to summarize and plot. If left unspecified, all 
genes will be summarized.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>relative</code></td>
<td>

<p>Whether to plot absolute transcript abundances (relative = FALSE) or fold-
changes relative to the sample that is considered to be "global control" 
(relative = TRUE). The "global control" is the combination of factors 
that served as a reference during model fitting, either because it is 
alphanumerically first (that happens by default) or because it has been 
explicitly designated as such using relevel() function (see tutorial). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.base</code></td>
<td>

<p>Base of the logarithm to use.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summ.plot</code></td>
<td>

<p>By default, the function generates a summary plot, which is a line-points-95% 
credible intervals plot of log(absolute abundances) with 'relative=FALSE' 
and a more typical bar graph of log(fold change relative to the control), 
again with 95%  credible intervals, with 'relative=TRUE'. Specify 
'summ.plot=FALSE' if you don't want the summary plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ptype</code></td>
<td>

<p>Which type of p-values to use. By default p-values based on the Bayesian 
z-score are used. Specify 'ptype="mcmc"' to output more conventional p-values 
based on MCMC sampling (these will be limited on the lower end by the size of 
MCMC sample).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Additional options for summaryPlot() function. Among those, 'x.order' can be a 
vector specifying the order of factor levels on the x-axis.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of three items:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>summary</code></td>
<td>
<p> Summary table containing calculated abundances, their SD 
and 95% credible limits</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geneWise </code></td>
<td>
<p>A series of matrices listing pairwise differences between 
factor combinations (upper triangle) and corresponding p-values (lower triangle)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ggPlot </code></td>
<td>
<p>the ggplot2 object for plotting. See http://docs.ggplot2.org/0.9.2.1/theme.html for ways 
to modify it, such as add text, rotate labels, change fonts, etc. </p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Mikhail V. Matz, University of Texas at Austin
&lt;matz@utexas.edu&gt;
</p>


<h3>References</h3>

<p>Matz MV, Wright RM, Scott JG (2013) No Control Genes Required: Bayesian Analysis 
of qRT-PCR Data. PLoS ONE 8(8): e71448. doi:10.1371/journal.pone.0071448
</p>


<h3>See Also</h3>

<p>See function summaryPlot() for plotting the summary table in other ways.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(beckham.data)
data(beckham.eff)

# analysing the first 5 genes 
# (to try it with all 10 genes, change the line below to gcol=4:13)
gcol=4:8 
ccol=1:3 # columns containing experimental conditions

# recalculating into molecule counts, reformatting
qs=cq2counts(data=beckham.data,genecols=gcol,
condcols=ccol,effic=beckham.eff,Cq1=37)

# creating a single factor, 'treatment.time', out of 'tr' and 'time'
qs$treatment.time=as.factor(paste(qs$tr,qs$time,sep="."))

# fitting a naive model
naive=mcmc.qpcr(
	fixed="treatment.time",
	data=qs,
	nitt=3000,burnin=2000 # remove this line in actual analysis!
)

#summary plot of inferred abundances
# s1=HPDsummary(model=naive,data=qs)

#summary plot of fold-changes relative to the global control
s0=HPDsummary(model=naive,data=qs,relative=TRUE)

# pairwise differences and their significances for each gene:
s0$geneWise

</code></pre>


</div>