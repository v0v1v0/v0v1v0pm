<div class="container">

<table style="width: 100%;"><tr>
<td>trellisByGene</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
For two-way designs, plots mcmc.qpcr model predictions gene by gene
</h2>

<h3>Description</h3>

<p>For each gene, plots model-predicted values and 95% credible intervals.
</p>


<h3>Usage</h3>

<pre><code class="language-R">trellisByGene(modelSummary,xFactor,groupFactor,
nrow=2,lineWidth=0.4,whiskerWidth=0.2,pointSize=2.5,
facetScales="free_y",ylab="log(abundance)",
legendPos="bottom",posDodge=0.3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>modelSummary</code></td>
<td>

<p>two-way design model summary produced by HPDsummary()
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xFactor</code></td>
<td>

<p>factor to form the x-axis
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groupFactor</code></td>
<td>

<p>factor to form separate lines on the plot
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrow</code></td>
<td>

<p>number of rows in the resulting trellis plot
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lineWidth</code></td>
<td>

<p>line width, passed as 'lwd' to geom_errorbar function (ggplot2)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>whiskerWidth</code></td>
<td>

<p>width of the line denoting 95% CI margin, passed as 'width' to geom_errorbar function (ggplot2)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pointSize</code></td>
<td>

<p>passed as 'size' to geom_point function of ggplot2
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>facetScales</code></td>
<td>

<p>passed as 'scales' to facet_wrap function of ggplot2
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>

<p>y-axis label
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legendPos</code></td>
<td>

<p>passed as 'legend.position' to theme function of ggplot2
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posDodge</code></td>
<td>

<p>position dodge, increase for more jitter
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A ggplot2 type object
</p>


<h3>Author(s)</h3>

<p>Mikhal V. Matz, UT Austin, matz@utexas.edu
</p>


<h3>References</h3>

<p>Matz MV, Wright RM, Scott JG (2013) No Control Genes Required: Bayesian Analysis of qRT-PCR Data. PLoS ONE 8(8): e71448. doi:10.1371/journal.pone.0071448
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# loading Cq data and amplification efficiencies
data(coral.stress) 
data(amp.eff) 

genecolumns=c(5,6,16,17) # specifying columns corresponding to genes of interest
conditions=c(1:4) # specifying columns containing factors  

# calculating molecule counts and reformatting:
dd=cq2counts(data=coral.stress,genecols=genecolumns,
condcols=conditions,effic=amp.eff,Cq1=37) 

# fitting the 2-way model
mm=mcmc.qpcr(
	fixed="condition+timepoint+condition:timepoint",
	data=dd,
	nitt=4000 # remark this line to analyze real data!
)

# summarizing results
ss=HPDsummary(mm,data=dd,summ.plot=FALSE)

# plotting predicted means and 95% CIs gene by gene
trellisByGene(ss,xFactor="condition",groupFactor="timepoint")
</code></pre>


</div>