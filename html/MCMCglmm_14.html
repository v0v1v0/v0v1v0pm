<div class="container">

<table style="width: 100%;"><tr>
<td>inverseA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Inverse Relatedness Matrix and Phylogenetic Covariance Matrix</h2>

<h3>Description</h3>

<p>Henderson (1976) and Meuwissen and Luo (1992) algorithm for inverting 
relatedness matrices, and Hadfield and Nakagawa (2010) algorithm for inverting 
phylogenetic covariance matrices. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">  inverseA(pedigree=NULL, nodes="ALL", scale=TRUE, reduced=FALSE,
     tol = .Machine$double.eps^0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pedigree</code></td>
<td>
<p>ordered pedigree with 3 columns: id, dam and sire, or a 
<code>phylo</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nodes</code></td>
<td>
<p><code>"ALL"</code> calculates the inverse for all individuals/nodes. 
For phylogenies <code>"TIPS"</code> calculates the inverse for the species tips only, 
and for pedigrees a vector of id's can be passed which inverts the relatedness 
matrix for that subset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>logical: should a phylogeny (needs to be ultrametric) be scaled 
to unit length (distance from root to tip)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reduced</code></td>
<td>
<p>logical: should childless nodes be dropped from the inverse and the pedigree/phylogeny representation be reduced?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>numeric: differences in branch length smaller than this are ignored when assessing whether a tree is ultrametric.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Ainv</code></td>
<td>
<p>inverse as <code>sparseMatrix</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inbreeding</code></td>
<td>
<p>inbreeding coefficients/branch lengths</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pedigree</code></td>
<td>
<p>pedigree/pedigree representation of phylogeny</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jarrod Hadfield <a href="mailto:j.hadfield@ed.ac.uk">j.hadfield@ed.ac.uk</a></p>


<h3>References</h3>

<p>Henderson, C.R. (1976) Biometrics 32 (1) 69:83
</p>
<p>Quaas, R. L. and Pollak, E. J. (1980) Journal of Animal Science 51:1277-1287.
</p>
<p>Meuwissen, T.H.E and Luo, Z. (1992) Genetic Selection Evolution 24 (4) 305:313
</p>
<p>Hadfield, J.D. and Nakagawa, S. (2010)  Journal of Evolutionary Biology 23 494-508
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(bird.families)
Ainv&lt;-inverseA(bird.families)
</code></pre>


</div>