<div class="container">

<table style="width: 100%;"><tr>
<td>rIW</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Random Generation from the Conditional Inverse Wishart Distribution</h2>

<h3>Description</h3>

<p>Samples from the inverse Wishart distribution, with the possibility 
of conditioning on a diagonal submatrix</p>


<h3>Usage</h3>

<pre><code class="language-R">rIW(V, nu, fix=NULL, n=1, CM=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>Expected (co)varaince matrix as <code>nu</code> tends to infinity</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>degrees of freedom</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix</code></td>
<td>
<p>optional integer indexing the partition to be conditioned on</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>integer: number of samples to be drawn</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CM</code></td>
<td>
<p>matrix: optional matrix to condition on. If not given, and <code>fix!=NULL</code>,  V_22 is conditioned on</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code class="reqn">{\bf W^{-1}}</code> is a draw from the inverse Wishart,  <code>fix</code> indexes the diagonal element of <code class="reqn">{\bf W^{-1}}</code>  which partitions <code class="reqn">{\bf W^{-1}}</code> into 4 submatrices. <code>fix</code> indexes the upper left corner of the lower 
diagonal matrix and it is this matrix that is conditioned on.
</p>
<p>For example partioning <code class="reqn">{\bf W^{-1}}</code> such that 
</p>
<p style="text-align: center;"><code class="reqn">
{\bf W^{-1}} = \left[
             \begin{array}{cc}
		      {\bf W^{-1}}_{11}&amp;{\bf W^{-1}}_{12}\\
			   {\bf W^{-1}}_{21}&amp;{\bf W^{-1}}_{22}\\
             \end{array}
		   \right]
  </code>
</p>


<p>fix indexes the upper left corner of <code class="reqn">{\bf W^{-1}}_{22}</code>. If <code>CM!=NULL</code> then <code class="reqn">{\bf W^{-1}}_{22}</code> is fixed at <code>CM</code>, otherwise <code class="reqn">{\bf W^{-1}}_{22}</code> is fixed at  <code class="reqn">\texttt{V}_{22}</code>. For example, if <code>dim(V)</code>=4 and <code>fix=2</code> then <code class="reqn">{\bf W^{-1}}_{11}</code> is a 1X1 matrix and <code class="reqn">{\bf W^{-1}}_{22}</code>  is a 3X3 matrix.
</p>


<h3>Value</h3>

<p>if <code>n</code> = 1 a matrix equal in dimension to <code>V</code>, if <code>n</code>&gt;1 a 
matrix of dimension <code>n</code> x <code>length(V)</code>
</p>


<h3>Note</h3>

<p>In versions of MCMCglmm &gt;1.10 the arguments to <code>rIW</code> have changed so that they are more intuitive in the context of <code>MCMCglmm</code>.  Following the notation of Wikipedia (<a href="https://en.wikipedia.org/wiki/Inverse-Wishart_distribution">https://en.wikipedia.org/wiki/Inverse-Wishart_distribution</a>) the inverse scale matrix <code class="reqn">{\bm \Psi}=(\texttt{V*nu})</code>. In earlier versions of MCMCglmm (&lt;1.11) <code class="reqn">{\bm \Psi} = \texttt{V}^{-1}</code>. Although the old parameterisation is consistent with the <code>riwish</code> function in MCMCpack and the <code>rwishart</code> function in bayesm it is inconsistent with the prior definition for <code>MCMCglmm</code>.  The following pieces of code are sampling from the same distributions: 
</p>

<table>
<tr>
<td style="text-align: left;">
<code>riwish(nu, nu*V)</code> </td>
<td style="text-align: left;"> from MCMCpack</td>
</tr>
<tr>
<td style="text-align: left;">
<code>rwishart(nu, solve(nu*V))$IW</code> </td>
<td style="text-align: left;"> from bayesm</td>
</tr>
<tr>
<td style="text-align: left;">
<code>rIW(nu, solve(nu*V))</code> </td>
<td style="text-align: left;"> from MCMCglmm &lt;1.11</td>
</tr>
<tr>
<td style="text-align: left;">
<code>rIW(V, nu)</code> </td>
<td style="text-align: left;"> from MCMCglmm &gt;=1.11</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jarrod Hadfield <a href="mailto:j.hadfield@ed.ac.uk">j.hadfield@ed.ac.uk</a></p>


<h3>References</h3>

<p>Korsgaard, I.R. et. al. 1999 Genetics Selection Evolution 31 (2) 
177:181</p>


<h3>See Also</h3>

<p><code>rwishart</code>, <code>rwish</code></p>


<h3>Examples</h3>

<pre><code class="language-R">nu&lt;-10
V&lt;-diag(4)
rIW(V, nu, fix=2)
</code></pre>


</div>