<div class="container">

<table style="width: 100%;"><tr>
<td>spl</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Orthogonal Spline Design Matrix</h2>

<h3>Description</h3>

<p>Orthogonal Spline Design Matrix</p>


<h3>Usage</h3>

<pre><code class="language-R">spl(x,  k=10, knots=NULL, type="LRTP")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric covariate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>integer, defines knot points at the 1:k/(k+1) quantiles of x</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p>vector of knot points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of spline - currently only low-rank thin-plate ("LRTP") are implemented</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Design matrix post-multiplied by the inverse square root of the penalty matrix 
</p>


<h3>Author(s)</h3>

<p>Jarrod Hadfield <a href="mailto:j.hadfield@ed.ac.uk">j.hadfield@ed.ac.uk</a></p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
x&lt;-rnorm(100)
y&lt;-x^2+cos(x)-x+0.2*x^3+rnorm(100)
plot(y~x)
lines((x^2+cos(x)-x+0.2*x^3)[order(x)]~sort(x))

dat&lt;-data.frame(y=y, x=x)

m1&lt;-MCMCglmm(y~x, random=~idv(spl(x)), data=dat, pr=TRUE, verbose=FALSE) # penalised smoother
m2&lt;-MCMCglmm(y~x+spl(x),data=dat,  verbose=FALSE)                        # non-penalised

pred1&lt;-(cbind(m1$X,m1$Z)%*%colMeans(m1$Sol))@x
pred2&lt;-(cbind(m2$X)%*%colMeans(m2$Sol))@x

lines(pred1[order(x)]~sort(x), col="red")
lines(pred2[order(x)]~sort(x), col="green")

m1$DIC-mean(m1$Deviance)  # effective number of parameters &lt; 13
m2$DIC-mean(m2$Deviance)  # effective number of parameters ~ 13

## End(Not run)
</code></pre>


</div>