<div class="container">

<table style="width: 100%;"><tr>
<td>buildV</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Forms expected (co)variances for GLMMs fitted with MCMCglmm</h2>

<h3>Description</h3>

<p>Forms the expected covariance structure of link-scale observations for GLMMs fitted with MCMCglmm</p>


<h3>Usage</h3>

<pre><code class="language-R">buildV(object, marginal=object$Random$formula, diag=TRUE, it=NULL, posterior="mean", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of class <code>"MCMCglmm"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marginal</code></td>
<td>
<p>formula defining random effects to be maginalised</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diag</code></td>
<td>
<p>logical; if <code>TRUE</code> the covariances betwween observations are not calculated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>it</code></td>
<td>
<p>integer; optional, MCMC iteration on which covariance structure should be based</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posterior</code></td>
<td>
<p>character; if <code>it</code> is  <code>NULL</code> should the covariance structure be based on the marginal posterior means (<code>'mean'</code>) of the VCV parameters, or the  posterior modes (<code>'mode'</code>), or a random draw from the posterior with replacement (<code>'distribution'</code>).  If <code>posterior=="all"</code> the posterior distribution of observation variances is returned</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If <code>diag=TRUE</code> an n by n covariance matrix. If <code>diag=FALSE</code> and  <code>posterior!="all"</code> an 1 by n matrix of variances. If <code>posterior=="all"</code> an nit by n matrix of variances (where nit is the number of saved MCMC iterations).</p>


<h3>Author(s)</h3>

<p>Jarrod Hadfield <a href="mailto:j.hadfield@ed.ac.uk">j.hadfield@ed.ac.uk</a></p>


<h3>See Also</h3>

<p><code>MCMCglmm</code></p>


</div>