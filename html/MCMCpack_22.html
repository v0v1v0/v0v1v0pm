<div class="container">

<table style="width: 100%;"><tr>
<td>MCMCdynamicEI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Markov Chain Monte Carlo for Quinn's Dynamic Ecological Inference Model</h2>

<h3>Description</h3>

<p>MCMCdynamicEI is used to fit Quinn's dynamic ecological inference
model for partially observed 2 x 2 contingency tables.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MCMCdynamicEI(
  r0,
  r1,
  c0,
  c1,
  burnin = 5000,
  mcmc = 50000,
  thin = 1,
  verbose = 0,
  seed = NA,
  W = 0,
  a0 = 0.825,
  b0 = 0.0105,
  a1 = 0.825,
  b1 = 0.0105,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>r0</code></td>
<td>
<p><code class="reqn">(ntables \times 1)</code> vector of row sums from row 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r1</code></td>
<td>
<p><code class="reqn">(ntables \times 1)</code> vector of row sums from row 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c0</code></td>
<td>
<p><code class="reqn">(ntables \times 1)</code> vector of column sums from
column 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c1</code></td>
<td>
<p><code class="reqn">(ntables \times 1)</code> vector of column sums from
column 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>The number of burn-in scans for the sampler.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcmc</code></td>
<td>
<p>The number of mcmc scans to be saved.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>The thinning interval used in the simulation.  The
number of mcmc iterations must be divisible by this value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A switch which determines whether or not the
progress of the sampler is printed to the screen.  If
<code>verbose</code> is greater than 0 then every <code>verbose</code>th
iteration will be printed to the screen.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>The seed for the random number generator.  If NA, the
Mersenne Twister generator is used with default seed 12345; if an
integer is passed it is used to seed the Mersenne twister.  The
user can also pass a list of length two to use the L'Ecuyer
random number generator, which is suitable for parallel
computation.  The first element of the list is the L'Ecuyer seed,
which is a vector of length six or NA (if NA a default seed of
<code>rep(12345,6)</code> is used).  The second element of list is a
positive substream number. See the MCMCpack specification for
more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>Weight (<em>not precision</em>) matrix structuring the
temporal dependence among elements of <code class="reqn">\theta_{0}</code> and
<code class="reqn">\theta_{1}</code>. The default value of 0 will construct a weight
matrix that corresponds to random walk priors for
<code class="reqn">\theta_{0}</code> and <code class="reqn">\theta_{1}</code>. The default assumes that
the tables are equally spaced throughout time and that the
elements of <code class="reqn">r0</code>, <code class="reqn">r1</code>, <code class="reqn">c0</code>, and <code class="reqn">c1</code> are
temporally ordered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a0</code></td>
<td>
<p><code>a0/2</code> is the shape parameter for the inverse-gamma
prior on the <code class="reqn">\sigma^2_0</code> parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b0</code></td>
<td>
<p><code>b0/2</code> is the scale parameter for the inverse-gamma
prior on the <code class="reqn">\sigma^2_0</code> parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a1</code></td>
<td>
<p><code>a1/2</code> is the shape parameter for the inverse-gamma
prior on the <code class="reqn">\sigma^2_1</code> parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b1</code></td>
<td>
<p><code>b1/2</code> is the scale parameter for the inverse-gamma
prior on the <code class="reqn">\sigma^2_1</code> parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Consider the following partially observed 2 by 2 contingency table
for unit <code class="reqn">t</code> where <code class="reqn">t=1,\ldots,ntables</code>:
</p>

<table>
<tr>
<td style="text-align: left;">
            </td>
<td style="text-align: left;"> | <code class="reqn">Y=0</code>    </td>
<td style="text-align: left;"> | <code class="reqn">Y=1</code>    </td>
<td style="text-align: left;"> |              </td>
</tr>
<tr>
<td style="text-align: left;">
  --------- </td>
<td style="text-align: left;"> ------------   </td>
<td style="text-align: left;"> ------------   </td>
<td style="text-align: left;"> ------------   </td>
</tr>
<tr>
<td style="text-align: left;">
  <code class="reqn">X=0</code> </td>
<td style="text-align: left;"> | <code class="reqn">Y_{0t}</code> </td>
<td style="text-align: left;"> |              </td>
<td style="text-align: left;"> | <code class="reqn">r_{0t}</code> </td>
</tr>
<tr>
<td style="text-align: left;">
  --------- </td>
<td style="text-align: left;"> ------------   </td>
<td style="text-align: left;"> ------------   </td>
<td style="text-align: left;"> ------------   </td>
</tr>
<tr>
<td style="text-align: left;">
  <code class="reqn">X=1</code> </td>
<td style="text-align: left;"> | <code class="reqn">Y_{1t}</code> </td>
<td style="text-align: left;"> |              </td>
<td style="text-align: left;"> | <code class="reqn">r_{1t}</code> </td>
</tr>
<tr>
<td style="text-align: left;">
  --------- </td>
<td style="text-align: left;"> ------------   </td>
<td style="text-align: left;"> ------------   </td>
<td style="text-align: left;"> ------------   </td>
</tr>
<tr>
<td style="text-align: left;">
            </td>
<td style="text-align: left;"> | <code class="reqn">c_{0t}</code> </td>
<td style="text-align: left;"> | <code class="reqn">c_{1t}</code> </td>
<td style="text-align: left;"> | <code class="reqn">N_t</code>
</td>
</tr>
</table>
<p>Where <code class="reqn">r_{0t}</code>, <code class="reqn">r_{1t}</code>, <code class="reqn">c_{0t}</code>, <code class="reqn">c_{1t}</code>, and
<code class="reqn">N_t</code> are non-negative integers that are observed. The interior
cell entries are not observed. It is assumed that
<code class="reqn">Y_{0t}|r_{0t} \sim \mathcal{B}inomial(r_{0t}, p_{0t})</code> and
<code class="reqn">Y_{1t}|r_{1t} \sim \mathcal{B}inomial(r_{1t}, p_{1t})</code>.  Let
<code class="reqn">\theta_{0t} = log(p_{0t}/(1-p_{0t}))</code>, and <code class="reqn">\theta_{1t} =
log(p_{1t}/(1-p_{1t}))</code>.
</p>
<p>The following prior distributions are assumed:
</p>
<p style="text-align: center;"><code class="reqn">p(\theta_0|\sigma^2_0) \propto \sigma_0^{-ntables} \exp \left(-\frac{1}{2\sigma^2_0} \theta'_{0} P \theta_{0}\right)</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">p(\theta_1|\sigma^2_1) \propto \sigma_1^{-ntables} \exp \left(-\frac{1}{2\sigma^2_1} \theta'_{1} P \theta_{1}\right)</code>
</p>

<p>where <code class="reqn">P_{ts}</code> = <code class="reqn">-W_{ts}</code> for <code class="reqn">t</code> not equal to <code class="reqn">s</code>
and <code class="reqn">P_{tt}</code> = <code class="reqn">\sum_{s \ne t}W_{ts}</code>.  The
<code class="reqn">\theta_{0t}</code> is assumed to be a priori independent of
<code class="reqn">\theta_{1t}</code> for all t.  In addition, the following
hyperpriors are assumed: <code class="reqn">\sigma^2_0 \sim \mathcal{IG}(a_0/2,
b_0/2)</code>, and <code class="reqn">\sigma^2_1 \sim \mathcal{IG}(a_1/2, b_1/2)</code>.
</p>
<p>Inference centers on <code class="reqn">p_0</code>, <code class="reqn">p_1</code>, <code class="reqn">\sigma^2_0</code>, and
<code class="reqn">\sigma^2_1</code>.  Univariate slice sampling (Neal, 2003) together
with Gibbs sampling is used to sample from the posterior
distribution.
</p>


<h3>Value</h3>

<p>An mcmc object that contains the sample from the posterior
distribution.  This object can be summarized by functions
provided by the coda package.
</p>


<h3>References</h3>

<p>Kevin Quinn. 2004. “Ecological Inference in the Presence of Temporal
Dependence." In <em>Ecological Inference: New Methodological Strategies</em>.
Gary King, Ori Rosen, and Martin A. Tanner (eds.). New York: Cambridge
University Press.
</p>
<p>Andrew D. Martin, Kevin M. Quinn, and Jong Hee Park. 2011.  “MCMCpack:
Markov Chain Monte Carlo in R”, <em>Journal of Statistical Software</em>.
42(9): 1-21.  <a href="https://doi.org/10.18637/jss.v042.i09">doi:10.18637/jss.v042.i09</a>.
</p>
<p>Radford Neal. 2003. “Slice Sampling" (with discussion). <em>Annals of
Statistics</em>, 31: 705-767.
</p>
<p>Daniel Pemstein, Kevin M. Quinn, and Andrew D. Martin.  2007.  <em>Scythe
Statistical Library 1.0.</em> <a href="http://scythe.wustl.edu.s3-website-us-east-1.amazonaws.com/">http://scythe.wustl.edu.s3-website-us-east-1.amazonaws.com/</a>.
</p>
<p>Martyn Plummer, Nicky Best, Kate Cowles, and Karen Vines. 2006.  “Output
Analysis and Diagnostics for MCMC (CODA)”, <em>R News</em>. 6(1): 7-11.
<a href="https://CRAN.R-project.org/doc/Rnews/Rnews_2006-1.pdf">https://CRAN.R-project.org/doc/Rnews/Rnews_2006-1.pdf</a>.
</p>
<p>Jonathan C. Wakefield. 2004. “Ecological Inference for 2 x 2 Tables.”
<em>Journal of the Royal Statistical Society, Series A</em>. 167(3): 385445.
</p>


<h3>See Also</h3>

<p><code>MCMChierEI</code>,
<code>plot.mcmc</code>,<code>summary.mcmc</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
   ## Not run: 
## simulated data example 1
set.seed(3920)
n &lt;- 100
r0 &lt;- rpois(n, 2000)
r1 &lt;- round(runif(n, 100, 4000))
p0.true &lt;- pnorm(-1.5 + 1:n/(n/2))
p1.true &lt;- pnorm(1.0 - 1:n/(n/4))
y0 &lt;- rbinom(n, r0, p0.true)
y1 &lt;- rbinom(n, r1, p1.true)
c0 &lt;- y0 + y1
c1 &lt;- (r0+r1) - c0

## plot data
dtomogplot(r0, r1, c0, c1, delay=0.1)

## fit dynamic model
post1 &lt;- MCMCdynamicEI(r0,r1,c0,c1, mcmc=40000, thin=5, verbose=100,
                    seed=list(NA, 1))

## fit exchangeable hierarchical model
post2 &lt;- MCMChierEI(r0,r1,c0,c1, mcmc=40000, thin=5, verbose=100,
                    seed=list(NA, 2))

p0meanDyn &lt;- colMeans(post1)[1:n]
p1meanDyn &lt;- colMeans(post1)[(n+1):(2*n)]
p0meanHier &lt;- colMeans(post2)[1:n]
p1meanHier &lt;- colMeans(post2)[(n+1):(2*n)]

## plot truth and posterior means
pairs(cbind(p0.true, p0meanDyn, p0meanHier, p1.true, p1meanDyn, p1meanHier))


## simulated data example 2
set.seed(8722)
n &lt;- 100
r0 &lt;- rpois(n, 2000)
r1 &lt;- round(runif(n, 100, 4000))
p0.true &lt;- pnorm(-1.0 + sin(1:n/(n/4)))
p1.true &lt;- pnorm(0.0 - 2*cos(1:n/(n/9)))
y0 &lt;- rbinom(n, r0, p0.true)
y1 &lt;- rbinom(n, r1, p1.true)
c0 &lt;- y0 + y1
c1 &lt;- (r0+r1) - c0

## plot data
dtomogplot(r0, r1, c0, c1, delay=0.1)

## fit dynamic model
post1 &lt;- MCMCdynamicEI(r0,r1,c0,c1, mcmc=40000, thin=5, verbose=100,
                    seed=list(NA, 1))

## fit exchangeable hierarchical model
post2 &lt;- MCMChierEI(r0,r1,c0,c1, mcmc=40000, thin=5, verbose=100,
                    seed=list(NA, 2))

p0meanDyn &lt;- colMeans(post1)[1:n]
p1meanDyn &lt;- colMeans(post1)[(n+1):(2*n)]
p0meanHier &lt;- colMeans(post2)[1:n]
p1meanHier &lt;- colMeans(post2)[(n+1):(2*n)]

## plot truth and posterior means
pairs(cbind(p0.true, p0meanDyn, p0meanHier, p1.true, p1meanDyn, p1meanHier))
   
## End(Not run)

</code></pre>


</div>