<div class="container">

<table style="width: 100%;"><tr>
<td>MCMChierEI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Markov Chain Monte Carlo for Wakefield's Hierarchial Ecological Inference
Model</h2>

<h3>Description</h3>

<p>‘MCMChierEI’ is used to fit Wakefield's hierarchical ecological
inference model for partially observed 2 x 2 contingency tables.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MCMChierEI(
  r0,
  r1,
  c0,
  c1,
  burnin = 5000,
  mcmc = 50000,
  thin = 1,
  verbose = 0,
  seed = NA,
  m0 = 0,
  M0 = 2.287656,
  m1 = 0,
  M1 = 2.287656,
  a0 = 0.825,
  b0 = 0.0105,
  a1 = 0.825,
  b1 = 0.0105,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>r0</code></td>
<td>
<p><code class="reqn">(ntables \times 1)</code> vector of row sums from row 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r1</code></td>
<td>
<p><code class="reqn">(ntables \times 1)</code> vector of row sums from row 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c0</code></td>
<td>
<p><code class="reqn">(ntables \times 1)</code> vector of column sums from
column 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c1</code></td>
<td>
<p><code class="reqn">(ntables \times 1)</code> vector of column sums from
column 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>The number of burn-in scans for the sampler.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcmc</code></td>
<td>
<p>The number of mcmc scans to be saved.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>The thinning interval used in the simulation.  The number of
mcmc iterations must be divisible by this value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A switch which determines whether or not the progress of the
sampler is printed to the screen. If <code>verbose</code> is greater than 0 then
every <code>verbose</code>th iteration will be printed to the screen.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>The seed for the random number generator.  If NA, the Mersenne
Twister generator is used with default seed 12345; if an integer is passed
it is used to seed the Mersenne twister.  The user can also pass a list of
length two to use the L'Ecuyer random number generator, which is suitable
for parallel computation.  The first element of the list is the L'Ecuyer
seed, which is a vector of length six or NA (if NA a default seed of
<code>rep(12345,6)</code> is used).  The second element of list is a positive
substream number. See the MCMCpack specification for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m0</code></td>
<td>
<p>Prior mean of the <code class="reqn">\mu_0</code> parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M0</code></td>
<td>
<p>Prior variance of the <code class="reqn">\mu_0</code> parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m1</code></td>
<td>
<p>Prior mean of the <code class="reqn">\mu_1</code> parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M1</code></td>
<td>
<p>Prior variance of the <code class="reqn">\mu_1</code> parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a0</code></td>
<td>
<p><code>a0/2</code> is the shape parameter for the inverse-gamma
prior on the <code class="reqn">\sigma^2_0</code> parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b0</code></td>
<td>
<p><code>b0/2</code> is the scale parameter for the inverse-gamma
prior on the <code class="reqn">\sigma^2_0</code> parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a1</code></td>
<td>
<p><code>a1/2</code> is the shape parameter for the inverse-gamma
prior on the <code class="reqn">\sigma^2_1</code> parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b1</code></td>
<td>
<p><code>b1/2</code> is the scale parameter for the inverse-gamma
prior on the <code class="reqn">\sigma^2_1</code> parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Consider the following partially observed 2 by 2 contingency table
for unit <code class="reqn">t</code> where <code class="reqn">t=1,\ldots,ntables</code>:
</p>

<table>
<tr>
<td style="text-align: left;">
            </td>
<td style="text-align: left;"> | <code class="reqn">Y=0</code>    </td>
<td style="text-align: left;"> | <code class="reqn">Y=1</code>    </td>
<td style="text-align: left;"> |              </td>
</tr>
<tr>
<td style="text-align: left;">
  --------- </td>
<td style="text-align: left;"> ------------   </td>
<td style="text-align: left;"> ------------   </td>
<td style="text-align: left;"> ------------   </td>
</tr>
<tr>
<td style="text-align: left;">
  <code class="reqn">X=0</code> </td>
<td style="text-align: left;"> | <code class="reqn">Y_{0t}</code> </td>
<td style="text-align: left;"> |              </td>
<td style="text-align: left;"> | <code class="reqn">r_{0t}</code> </td>
</tr>
<tr>
<td style="text-align: left;">
  --------- </td>
<td style="text-align: left;"> ------------   </td>
<td style="text-align: left;"> ------------   </td>
<td style="text-align: left;"> ------------   </td>
</tr>
<tr>
<td style="text-align: left;">
  <code class="reqn">X=1</code> </td>
<td style="text-align: left;"> | <code class="reqn">Y_{1t}</code> </td>
<td style="text-align: left;"> |              </td>
<td style="text-align: left;"> | <code class="reqn">r_{1t}</code> </td>
</tr>
<tr>
<td style="text-align: left;">
  --------- </td>
<td style="text-align: left;"> ------------   </td>
<td style="text-align: left;"> ------------   </td>
<td style="text-align: left;"> ------------   </td>
</tr>
<tr>
<td style="text-align: left;">
            </td>
<td style="text-align: left;"> | <code class="reqn">c_{0t}</code> </td>
<td style="text-align: left;"> | <code class="reqn">c_{1t}</code> </td>
<td style="text-align: left;"> | <code class="reqn">N_t</code>
</td>
</tr>
</table>
<p>Where <code class="reqn">r_{0t}</code>, <code class="reqn">r_{1t}</code>, <code class="reqn">c_{0t}</code>, <code class="reqn">c_{1t}</code>, and
<code class="reqn">N_t</code> are non-negative integers that are observed. The interior
cell entries are not observed. It is assumed that
<code class="reqn">Y_{0t}|r_{0t} \sim \mathcal{B}inomial(r_{0t}, p_{0t})</code> and
<code class="reqn">Y_{1t}|r_{1t} \sim \mathcal{B}inomial(r_{1t}, p_{1t})</code>.  Let
<code class="reqn">\theta_{0t} = log(p_{0t}/(1-p_{0t}))</code>, and <code class="reqn">\theta_{1t} =
log(p_{1t}/(1-p_{1t}))</code>.
</p>
<p>The following prior distributions are assumed: <code class="reqn">\theta_{0t}
\sim \mathcal{N}(\mu_0, \sigma^2_0)</code>, <code class="reqn">\theta_{1t} \sim
\mathcal{N}(\mu_1, \sigma^2_1)</code>.  <code class="reqn">\theta_{0t}</code> is assumed to
be a priori independent of <code class="reqn">\theta_{1t}</code> for all t.  In
addition, we assume the following hyperpriors: <code class="reqn">\mu_0 \sim
\mathcal{N}(m_0, M_0)</code>, <code class="reqn">\mu_1 \sim \mathcal{N}(m_1, M_1)</code>,
<code class="reqn">\sigma^2_0 \sim \mathcal{IG}(a_0/2, b_0/2)</code>, and
<code class="reqn">\sigma^2_1 \sim \mathcal{IG}(a_1/2, b_1/2)</code>.
</p>
<p>The default priors have been chosen to make the implied prior
distribution for <code class="reqn">p_{0}</code> and <code class="reqn">p_{1}</code> <em>approximately</em>
uniform on (0,1).
</p>
<p>Inference centers on <code class="reqn">p_0</code>, <code class="reqn">p_1</code>, <code class="reqn">\mu_0</code>,
<code class="reqn">\mu_1</code>, <code class="reqn">\sigma^2_0</code>, and <code class="reqn">\sigma^2_1</code>.  Univariate
slice sampling (Neal, 2003) along with Gibbs sampling is used to
sample from the posterior distribution.
</p>
<p>See Section 5.4 of Wakefield (2003) for discussion of the priors
used here.  <code>MCMChierEI</code> departs from the Wakefield model in
that the <code>mu0</code> and <code>mu1</code> are here assumed to be drawn
from independent normal distributions whereas Wakefield assumes
they are drawn from logistic distributions.
</p>


<h3>Value</h3>

<p>An mcmc object that contains the sample from the posterior
distribution.  This object can be summarized by functions
provided by the coda package.
</p>


<h3>References</h3>

<p>Jonathan C. Wakefield. 2004. “Ecological Inference for 2 x 2
Tables.” <em>Journal of the Royal Statistical Society, Series A</em>. 167(3):
385445.
</p>
<p>Radford Neal. 2003. “Slice Sampling" (with discussion). <em>Annals of
Statistics</em>, 31: 705-767.
</p>
<p>Andrew D. Martin, Kevin M. Quinn, and Jong Hee Park. 2011.  “MCMCpack:
Markov Chain Monte Carlo in R.”, <em>Journal of Statistical Software</em>.
42(9): 1-21.  <a href="https://doi.org/10.18637/jss.v042.i09">doi:10.18637/jss.v042.i09</a>.
</p>
<p>Daniel Pemstein, Kevin M. Quinn, and Andrew D. Martin.  2007.  <em>Scythe
Statistical Library 1.0.</em> <a href="http://scythe.wustl.edu.s3-website-us-east-1.amazonaws.com/">http://scythe.wustl.edu.s3-website-us-east-1.amazonaws.com/</a>.
</p>
<p>Martyn Plummer, Nicky Best, Kate Cowles, and Karen Vines. 2006.  “Output
Analysis and Diagnostics for MCMC (CODA)”, <em>R News</em>. 6(1): 7-11.
<a href="https://CRAN.R-project.org/doc/Rnews/Rnews_2006-1.pdf">https://CRAN.R-project.org/doc/Rnews/Rnews_2006-1.pdf</a>.
</p>


<h3>See Also</h3>

<p><code>MCMCdynamicEI</code>,
<code>plot.mcmc</code>,<code>summary.mcmc</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
   ## Not run: 
## simulated data example
set.seed(3920)
n &lt;- 100
r0 &lt;- round(runif(n, 400, 1500))
r1 &lt;- round(runif(n, 100, 4000))
p0.true &lt;- pnorm(rnorm(n, m=0.5, s=0.25))
p1.true &lt;- pnorm(rnorm(n, m=0.0, s=0.10))
y0 &lt;- rbinom(n, r0, p0.true)
y1 &lt;- rbinom(n, r1, p1.true)
c0 &lt;- y0 + y1
c1 &lt;- (r0+r1) - c0

## plot data
tomogplot(r0, r1, c0, c1)

## fit exchangeable hierarchical model
post &lt;- MCMChierEI(r0,r1,c0,c1, mcmc=40000, thin=5, verbose=100,
                    seed=list(NA, 1))

p0meanHier &lt;- colMeans(post)[1:n]
p1meanHier &lt;- colMeans(post)[(n+1):(2*n)]

## plot truth and posterior means
pairs(cbind(p0.true, p0meanHier, p1.true, p1meanHier))
   
## End(Not run)

</code></pre>


</div>