<div class="container">

<table style="width: 100%;"><tr>
<td>MCMCpoisson</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Markov Chain Monte Carlo for Poisson Regression</h2>

<h3>Description</h3>

<p>This function generates a sample from the posterior distribution of a
Poisson regression model using a random walk Metropolis algorithm. The user
supplies data and priors, and a sample from the posterior distribution is
returned as an mcmc object, which can be subsequently analyzed with
functions provided in the coda package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MCMCpoisson(
  formula,
  data = NULL,
  burnin = 1000,
  mcmc = 10000,
  thin = 1,
  tune = 1.1,
  verbose = 0,
  seed = NA,
  beta.start = NA,
  b0 = 0,
  B0 = 0,
  marginal.likelihood = c("none", "Laplace"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>Model formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>The number of burn-in iterations for the sampler.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcmc</code></td>
<td>
<p>The number of Metropolis iterations for the sampler.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>The thinning interval used in the simulation.  The number of
mcmc iterations must be divisible by this value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tune</code></td>
<td>
<p>Metropolis tuning parameter. Can be either a positive scalar or
a <code class="reqn">k</code>-vector, where <code class="reqn">k</code> is the length of
<code class="reqn">\beta</code>.Make sure that the acceptance rate is satisfactory
(typically between 0.20 and 0.5) before using the posterior sample for
inference.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A switch which determines whether or not the progress of the
sampler is printed to the screen.  If <code>verbose</code> is greater than 0 the
iteration number, the current beta vector, and the Metropolis acceptance
rate are printed to the screen every <code>verbose</code>th iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>The seed for the random number generator.  If NA, the Mersenne
Twister generator is used with default seed 12345; if an integer is passed
it is used to seed the Mersenne twister.  The user can also pass a list of
length two to use the L'Ecuyer random number generator, which is suitable
for parallel computation.  The first element of the list is the L'Ecuyer
seed, which is a vector of length six or NA (if NA a default seed of
<code>rep(12345,6)</code> is used).  The second element of list is a positive
substream number. See the MCMCpack specification for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.start</code></td>
<td>
<p>The starting value for the <code class="reqn">\beta</code> vector.  This
can either be a scalar or a column vector with dimension equal to the number
of betas. If this takes a scalar value, then that value will serve as the
starting value for all of the betas.  The default value of NA will use the
maximum likelihood estimate of <code class="reqn">\beta</code> as the starting value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b0</code></td>
<td>
<p>The prior mean of <code class="reqn">\beta</code>.  This can either be a scalar
or a column vector with dimension equal to the number of betas. If this
takes a scalar value, then that value will serve as the prior mean for all
of the betas.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B0</code></td>
<td>
<p>The prior precision of <code class="reqn">\beta</code>.  This can either be a
scalar or a square matrix with dimensions equal to the number of betas.  If
this takes a scalar value, then that value times an identity matrix serves
as the prior precision of <code class="reqn">\beta</code>. Default value of 0 is
equivalent to an improper uniform prior for beta.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marginal.likelihood</code></td>
<td>
<p>How should the marginal likelihood be calculated?
Options are: <code>none</code> in which case the marginal likelihood will not be
calculated or <code>Laplace</code> in which case the Laplace approximation (see
Kass and Raftery, 1995) is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>MCMCpoisson</code> simulates from the posterior distribution of a Poisson
regression model using a random walk Metropolis algorithm. The simulation
proper is done in compiled C++ code to maximize efficiency.  Please consult
the coda documentation for a comprehensive list of functions that can be
used to analyze the posterior sample.
</p>
<p>The model takes the following form:
</p>
<p style="text-align: center;"><code class="reqn">y_i \sim \mathcal{P}oisson(\mu_i)</code>
</p>

<p>Where the inverse link
function:
</p>
<p style="text-align: center;"><code class="reqn">\mu_i = \exp(x_i'\beta)</code>
</p>

<p>We assume a multivariate Normal prior on <code class="reqn">\beta</code>:
</p>
<p style="text-align: center;"><code class="reqn">\beta \sim \mathcal{N}(b_0,B_0^{-1})</code>
</p>

<p>The Metropois proposal distribution is centered at the current value of
<code class="reqn">\theta</code> and has variance-covariance <code class="reqn">V = T (B_0 + C^{-1})^{-1} T </code>
where <code class="reqn">T</code> is a the diagonal positive definite matrix formed from the
<code>tune</code>, <code class="reqn">B_0</code> is the prior precision, and <code class="reqn">C</code> is the
large sample variance-covariance matrix of the MLEs. This last calculation
is done via an initial call to <code>glm</code>.
</p>


<h3>Value</h3>

<p>An mcmc object that contains the posterior sample.  This object can
be summarized by functions provided by the coda package.
</p>


<h3>References</h3>

<p>Andrew D. Martin, Kevin M. Quinn, and Jong Hee Park. 2011.
“MCMCpack: Markov Chain Monte Carlo in R.”, <em>Journal of Statistical
Software</em>. 42(9): 1-21.  <a href="https://doi.org/10.18637/jss.v042.i09">doi:10.18637/jss.v042.i09</a>.
</p>
<p>Daniel Pemstein, Kevin M. Quinn, and Andrew D. Martin.  2007.  <em>Scythe
Statistical Library 1.0.</em> <a href="http://scythe.wustl.edu.s3-website-us-east-1.amazonaws.com/">http://scythe.wustl.edu.s3-website-us-east-1.amazonaws.com/</a>.
</p>
<p>Martyn Plummer, Nicky Best, Kate Cowles, and Karen Vines. 2006.  “Output
Analysis and Diagnostics for MCMC (CODA)”, <em>R News</em>. 6(1): 7-11.
<a href="https://CRAN.R-project.org/doc/Rnews/Rnews_2006-1.pdf">https://CRAN.R-project.org/doc/Rnews/Rnews_2006-1.pdf</a>.
</p>


<h3>See Also</h3>

<p><code>plot.mcmc</code>,<code>summary.mcmc</code>,
<code>glm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
   ## Not run: 
   counts &lt;- c(18,17,15,20,10,20,25,13,12)
   outcome &lt;- gl(3,1,9)
   treatment &lt;- gl(3,3)
   posterior &lt;- MCMCpoisson(counts ~ outcome + treatment)
   plot(posterior)
   summary(posterior)
   
## End(Not run)

</code></pre>


</div>