<div class="container">

<table style="width: 100%;"><tr>
<td>stationary</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Precision of stationary distribution for discrete MCMC variables</h2>

<h3>Description</h3>

<p>Transdimensional MCMC methods include a discrete model-indicator variable <code class="reqn">z</code>
with a fixed but unknown stationary distribution with probabilities <code class="reqn">\pi</code>
(i.e., the model posterior probabiltiies). The function <code>stationary</code>
draws posterior samples to assess the estimation uncertainty of <code class="reqn">\pi</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">stationary(
  z,
  N,
  labels,
  sample = 1000,
  epsilon = "1/M",
  cpu = 1,
  method = "arma",
  digits = 6,
  progress = TRUE,
  summary = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>MCMC output for the discrete indicator variable with numerical,
character, or factor labels (can also be a <code>mcmc.list</code>
or a matrix with one MCMC chain per column).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>the observed <code>transitions</code> matrix (if supplied, <code>z</code> is ignored).
A quadratic matrix with sampled transition frequencies
(<code>N[i,j]</code> = number of switches from <code>z[t]=i</code> to <code>z[t+1]=j</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>optional: vector of labels for complete set of models
(e.g., models not sampled in the chain <code>z</code>). If <code>epsilon=0</code>,
this does not affect inferences due to the improper Dirichlet(0,..,0) prior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample</code></td>
<td>
<p>number of posterior samples to be drawn for the stationary distribution <code class="reqn">\pi</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>prior parameter for the rows of the estimated transition matrix <code class="reqn">P</code>:
<code class="reqn">P[i,]</code> ~ Dirichlet<code class="reqn">(\epsilon, ..., \epsilon)</code>.
The default <code>epsilon="1/M"</code> (with M = number of sampled models) provides
estimates close to the i.i.d. estimates and is numerically stable.
The alternative <code>epsilon=0</code> minimizes the impact of the prior and
renders non-sampled models irrelevant.
If <code>method="iid"</code> (ignores dependencies), a Dirichlet prior is assumed on the stationary
distribution <code class="reqn">\pi</code> instead of the rows of the transition matrix <code class="reqn">P</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cpu</code></td>
<td>
<p>number of CPUs used for parallel sampling.
Will only speed up computations for large numbers of models
(i.e., for large transition matrices).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>how to compute eigenvectors:
</p>

<ul>
<li> <p><code>"arma"</code> (default): Uses <code>RcppArmadillo::eig_gen</code>.
</p>
</li>
<li> <p><code>"base"</code>: Uses <code>base::eigen</code>, which might be more stable,
but also much slower than <code>"arma"</code> for small transition matrices.
</p>
</li>
<li> <p><code>"eigen"</code>: Uses package <code>RcppEigen::EigenSolver</code>
</p>
</li>
<li> <p><code>"armas"</code>: Uses sparse matrices with <code>RcppArmadillo::eigs_gen</code>,
which can be faster for very large number of models
if <code>epsilon=0</code> (might be numerically unstable).
</p>
</li>
<li> <p><code>"iid"</code>: Assumes i.i.d. sampling of the model indicator variable <code>z</code>.
This is only implemented as a benchmark, because results cannot
be trusted if the samples <code>z</code> are correlated (which is usually
the case for transdimensional MCMC output)
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>number of digits that are used for checking whether the first
eigenvalue is equal to 1 (any difference must be due to low numerical precision)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>
<p>whether to show a progress bar (not functional for <code>cpu&gt;1</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summary</code></td>
<td>
<p>whether the output should be summarized.
If <code>FALSE</code>, posterior samples of the stationary probabilities are returned.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The method draws independent posterior samples of the transition matrix <code class="reqn">P</code>
for the discrete-valued indicator variable <code>z</code> (usually, a sequence of sampled models).
For each row of the transition matrix, a Dirichlet<code class="reqn">(\epsilon,...,\epsilon)</code>
prior is assumed, resulting in a conjugate Dirichlet posterior.
For each sample, the eigenvector with eigenvalue 1 is computed and normalized.
These (independent) posterior samples can be used to assess the estimation
uncertainty in the stationary distribution <code class="reqn">pi</code> of interest
(e.g., the model posterior probabilities) and to estimate the effective sample size
(see <code>summary.stationary</code>).
</p>


<h3>Value</h3>

<p>default: a summary for the posterior distribution of the model
posterior probabilities (i.e., the fixed but unknown stationary distribution of <code>z</code>).
If <code>summary=FALSE</code>, posterior samples for <code class="reqn">pi</code> are returned.
</p>


<h3>See Also</h3>

<p><code>best_models</code>, <code>summary.stationary</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># data-generating transition matrix
P &lt;- matrix(c(.1,.5,.4,
              0, .5,.5,
              .9,.1,0), ncol = 3, byrow=TRUE)

# input: sequence of sampled models
z &lt;- rmarkov(500, P)
stationary(z)

# input: transition frequencies
N &lt;- transitions(z)
samples &lt;- stationary(N = N, summary = FALSE)

# summaries:
best_models(samples, k = 3)
summary(samples)
</code></pre>


</div>