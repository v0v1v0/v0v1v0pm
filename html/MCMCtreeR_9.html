<div class="container">

<table style="width: 100%;"><tr>
<td>MCMC.tree.plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot time-scaled phylogenies</h2>

<h3>Description</h3>

<p>Plot time-scaled phylogenies with node uncertainty and timescale
</p>


<h3>Usage</h3>

<pre><code class="language-R">MCMC.tree.plot(phy = NULL, analysis.type = "MCMCtree",
  MCMC.chain = NULL, node.ages = NULL, directory.files = NULL,
  plot.type = "phylogram", build.tree = FALSE, node.method = "bar",
  all.nodes = NULL, add.time.scale = TRUE, add.abs.time = TRUE,
  scale.res = "Epoch", label.timescale.names = FALSE,
  time.correction = 1, col.age = "blue", tip.lengths = FALSE,
  density.col = "#00000050", density.border.col = "#00000080",
  cex.tips = 1, show.tip.label = TRUE, col.tree = "black",
  tip.color = "black", lwd.bar = 1, grey.bars = TRUE, cex.age = 1,
  cex.labels = 1, cex.names = 1, relative.height = 0.08,
  tip.bar.col = "#ff000050", burn.in = 0.25,
  distribution.height = 0.8, abs.age.mgp = c(3, 0.35, 0),
  abs.age.lwd.ticks = 0.7, abs.age.lwd = 0, tck.abs.age = -0.01,
  abs.age.line = -0.4, pos.age = NULL, n.runs = 2,
  ladderize.tree = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>A timescaled phylogeny, unless analysis.type="MCMCtree" and build.tree=TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>analysis.type</code></td>
<td>
<p>The method used to generate the time-scale tree, one of MCMCtree, MrBayes, RevBayes, or User.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MCMC.chain</code></td>
<td>
<p>The full posterior of age estimates for all nodes (default NULL)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>node.ages</code></td>
<td>
<p>List of user-supplied node ages applicable for analysis.type user. Either all nodes or a selection of nodes. Each list element must be named with its corresponding node label from the APE format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>directory.files</code></td>
<td>
<p>The directory for files to summarise for MrBayes and RevBayes analyses</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.type</code></td>
<td>
<p>The plotting method for the phylogram corresponding to the APE definition. Phylogram is available for all analysis types, but cladogram is only avilable for MCMCtree analyses at present. Type distributions plots a phylogram with stats::density distributions on each of the nodes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>build.tree</code></td>
<td>
<p>Logical. Only applicable to MCMCtree analyses, whether to timescale the phylogeny based on the full MCMC chain</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>node.method</code></td>
<td>
<p>For plot.type phylogram the method to dispay age uncertainty on each node, either bar, node.length, or full.length. If 'none' is supplied plotting node uncertainty is suppressed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>all.nodes</code></td>
<td>
<p>If NULL (default) node uncertainty is plotted on all nodes. If node numbers are supplied, only these nodes will be labelled with uncertainty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.time.scale</code></td>
<td>
<p>Logical. Adds a timescale to the plotted phylogeny.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.abs.time</code></td>
<td>
<p>Logical. Adds an absolute timescale alongside the geological timescale. Only applicable if add.time.scale is TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.res</code></td>
<td>
<p>The geological age designation to add to the plot can be one or a combination of Eon, Period, Epoch, Age. The order of plot (from bottom to top) is the same as the supplied order. Subsequent arguments add.abs.time and grey.bars are based on the last supplied age designation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label.timescale.names</code></td>
<td>
<p>Logical. Add names (Eon, Period, Epoch, Age, Ma) to axis if timescale used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.correction</code></td>
<td>
<p>Number to place branch lengths and age estimates in absolute time, deafult to one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.age</code></td>
<td>
<p>The colouring of the node.method bars to summarise node age uncertainty</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tip.lengths</code></td>
<td>
<p>Logical. If the tree contains non-present tip ages, the age uncertainty associated with them will be added to the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density.col</code></td>
<td>
<p>Colour of the node distributions (if analysis.type=distributions)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density.border.col</code></td>
<td>
<p>Colour of the node distributions (if analysis.type=distributions) borders</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.tips</code></td>
<td>
<p>Size of the phylogeny tip labels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.tip.label</code></td>
<td>
<p>Logical. Should the tree tip labels be displayed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.tree</code></td>
<td>
<p>Colour of the phylogeny edges</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tip.color</code></td>
<td>
<p>Colour of the phylogeny tip labels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd.bar</code></td>
<td>
<p>Width of the bar to summarise age uncertainty, applicable only if plot.type is phylogram and node.method is bar</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grey.bars</code></td>
<td>
<p>Logical. Should grey bars be used to signify time bins, applicable only if add.time.scale is TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.age</code></td>
<td>
<p>Size of the labels for the absolute timescale</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.labels</code></td>
<td>
<p>Size of the labels for the geological timescale</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.names</code></td>
<td>
<p>Logical. Add label.timescale.names, if applicable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>relative.height</code></td>
<td>
<p>the relative height of the timescale labels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tip.bar.col</code></td>
<td>
<p>The colour of uncertainty around non-contemporary tips</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn.in</code></td>
<td>
<p>The number of points in the chain to discard for MrBayes and RevBayes analyses</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distribution.height</code></td>
<td>
<p>The relative height of node distributions when plot.type is distributions measured as the relative height of the descendent node</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abs.age.mgp</code></td>
<td>
<p>mgp values for the absolute age axis, only applicable if add.abs.time is TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abs.age.lwd.ticks</code></td>
<td>
<p>lwd values for the absolute age axis ticks, only applicable if add.abs.time is TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abs.age.lwd</code></td>
<td>
<p>lwd values for the absolute age axis horizontal line, only applicable if add.abs.time is TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tck.abs.age</code></td>
<td>
<p>tck values for the absolute age axis tick height, only applicable if add.abs.time is TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abs.age.line</code></td>
<td>
<p>line correction for the absolute age axis tick, only applicable if add.abs.time is TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos.age</code></td>
<td>
<p>position position of absolute age axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.runs</code></td>
<td>
<p>For analysis.type mrbayes, the number of independent chains to summarise</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ladderize.tree</code></td>
<td>
<p>Logical. Plot a ladderized tree (TRUE) or not (FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be used in <code>plot.phylo</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The primary inputs for the 'method' options are outputs from analysis conducting using MCMCtree, MrBayes, RevBayes, or User.
</p>
<p>For analyses under the 'MCMCtree' option (the default) the function only requires a 'FigTree' output from MCMCtree analysis or the full MCMCtree posterior. For option "MrBayes" and "RevBayes", the method argument takes the user-supplied directory address in which all the output files are stored.
</p>
<p>For the option 'User' the function requires a full posterior distribution and time-scaled phylogeny. This function can take any posterior distribution, but it may require some manipulation. The argument node.ages in MCMC.tree.plot takes a named list containing the posterior ages for each node, with the name of each element corresponding to the node in the phylogeny.
</p>


<h3>Value</h3>

<p>If plot=TRUE plot of distributions in file 'pdfOutput' written to current working directory
</p>


<h3>Author(s)</h3>

<p>Mark Puttick
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(MCMCtree.output)
attach(MCMCtree.output)
## if it is necessary to read in file manually
## MCMCtree.posterior &lt;- read.csv("mcmc.posterior.file.directory", sep="\t")
MCMCtree.file &lt;- readMCMCtree(MCMCtree.phy, from.file=FALSE)$apePhy
MCMC.tree.plot(phy=MCMCtree.file,  analysis.type="MCMCtree",
MCMC.chain=MCMCtree.posterior, plot.type="distributions", cex.tips=0.5)
</code></pre>


</div>