<div class="container">

<table style="width: 100%;"><tr>
<td>MCMCplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Caterpillar plots of posterior distributions from MCMC output</h2>

<h3>Description</h3>

<p>Visualize posterior distributions from MCMC output for specific parameters of interest using caterpillar plots. Color of median dot represents the overlap of the posterior distribution with 0 (or other specified value).
</p>


<h3>Usage</h3>

<pre><code class="language-R">MCMCplot(
  object,
  object2 = NULL,
  params = "all",
  HPD = FALSE,
  ci = c(50, 95),
  excl = NULL,
  ISB = TRUE,
  exact = TRUE,
  ref = 0,
  ref_ovl = FALSE,
  col = "black",
  col2 = "red",
  offset = 0.1,
  rank = FALSE,
  horiz = TRUE,
  xlim,
  ylim,
  xlab,
  ylab,
  main,
  labels,
  guide_lines = FALSE,
  guide_axis = TRUE,
  sz_labels = 1.2,
  sz_med = 1.5,
  sz_thick = 5,
  sz_thin = 2,
  sz_ax = 3,
  sz_ax_txt = 1.3,
  sz_tick_txt = 1.2,
  sz_main_txt = 1.2,
  pos_tick,
  mar = c(5.1, 4.1, 4.1, 2.1)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>Object containing MCMC output. See DETAILS below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object2</code></td>
<td>
<p>Optional second object containing MCMC output. If specified, parameter estimates from each model will be displayed in a paired manner. Parameter names for <code>'object'</code> and <code>'object2'</code> must be identical. See DETAILS below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>Character string (or vector of character strings) denoting parameters to be plotted.
</p>
<p>Default <code>'all'</code> plots posteriors for all parameters. See VALUE below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HPD</code></td>
<td>
<p>Logical specifying whether to calculate equal-tailed credible intervals (<code>HPD = FALSE</code>) or highest posterior density intervals (<code>HPD = TRUE</code>) for the selected parameters. Default is <code>HPD = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>Numeric vector of length 2, where each element is (0,100] and represents the width of an equal-tailed (<code>HPD = FALSE</code>) or highest posterior density (<code>HPD = TRUE</code>) credible interval. The first element of this vector corresponds to the thicker (narrower) credible interval displayed on the plot (default is 0.5) and the second element of this vector corresponds to the thinner (wider) credible interval (default is 0.95). The first credible interval width (<code>ci[1]</code>) must be less than or equal to the width of the second credible interval (<code>ci[2]</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>excl</code></td>
<td>
<p>Character string (or vector of character strings) denoting parameters to exclude. Used in conjunction with <code>params</code> argument to select parameters of interest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ISB</code></td>
<td>
<p>Ignore Square Brackets (ISB). Logical specifying whether square brackets should be ignored in the <code>params</code> and <code>excl</code> arguments. If <code>TRUE</code>, square brackets are ignored. If <code>FALSE</code>, square brackets are not ignored.  This allows partial names to be used when specifying parameters of interest. Use <code>exact</code> argument to specify whether input from <code>params</code> and <code>excl</code> arguments should be matched exactly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exact</code></td>
<td>
<p>Logical specifying whether input from <code>params</code> and <code>excl</code> arguments should be matched exactly (after ignoring square brackets if <code>ISB = FALSE</code>). If <code>TRUE</code>, input from <code>params</code> and <code>excl</code> are matched exactly (after taking <code>ISB</code> argument into account). If <code>FALSE</code>, input from <code>params</code> and <code>excl</code> are matched using regular expression format (after taking <code>ISB</code> argument into account).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref</code></td>
<td>
<p>Value indicating where vertical reference line should be created and what value to use a reference for caterpillar median coloration.
</p>
<p>Default is <code>ref = 0</code>.
</p>
<p>Argument <code>NULL</code> will plot no reference line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref_ovl</code></td>
<td>
<p>Logical specifying whether the style/color of plotted median dots and CI should be changed based on whether the specified credible intervals (50 % and 95 % by default) overlap the reference line. See DETAILS for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>Character string (or vector of character strings) specifying which color to render estimates on plot. When <code>ref_ovl = TRUE</code>, this argument has no effect and colors plotted will be based on the credible intervals and reference line. Number of specified colors must equal the number of specified parameters or one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col2</code></td>
<td>
<p>Character string (or vector of character strings) specifying which color to render estimates on plot for <code>object2</code> (if specified). Number of specified colors must equal the number of specified parameters or one. Red by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>Value indicating how much to offset plotted posteriors when <code>object2</code> is specified (i.e., control the amount of space between the two  plotted posteriors for each parameter). The distance from one set of parameters to another corresponds to a value of 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank</code></td>
<td>
<p>Logical specifying whether output should be ranked. If <code>TRUE</code> posteriors will be ranked in decreasing order (based on specified measure of centrality) from top down.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>horiz</code></td>
<td>
<p>Logical specifying orientation of plot. If <code>TRUE</code> posteriors will be plotted running horizontally (parallel to the x-axis). If <code>FALSE</code> posteriors will be plotted running vertically (perpendicular to the x-axis).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>Numerical vector of length 2, indicating range of x-axis. Only applicable if <code>horiz = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>Numerical vector of length 2, indicating range of y-axis. Only applicable if <code>horiz = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>Character string labeling x-axis. Only applicable if <code>horiz = TRUE</code>.
</p>
<p>Default label is 'Parameter Estimate'. Option <code>NULL</code> will return plot with no label on x-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>Character string labeling y-axis. Only applicable if <code>horiz = FALSE</code>.
</p>
<p>Default label is 'Parameter Estimate'. Option <code>NULL</code> will return plot with no label on y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>Character string indicating title of plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>Character string (or vector of character strings if plotting &gt; 1 parameter) labeling parameter estimates along y-axis (if <code>horiz = FALSE</code>) or x-axis (if <code>horiz = TRUE</code>).
</p>
<p>Default option will use parameter names from <code>object</code>.
</p>
<p>Option <code>NULL</code> will return plot with no labels on axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>guide_lines</code></td>
<td>
<p>Logical specifying whether to plot reference lines for each parameter in order to better visualize which parameter names correspond to each posterior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>guide_axis</code></td>
<td>
<p>Logical specifying whether a second axis should be plotted (x-axis if <code>HORIZ = TRUE</code>, y-axis if <code>HORIZ = FALSE</code>) to help interpret values on plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sz_labels</code></td>
<td>
<p>Number specifying size of text for parameter labels on axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sz_med</code></td>
<td>
<p>Number specifying size of points represents posterior medians.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sz_thick</code></td>
<td>
<p>Number specifying thickness of 50 percent CI line (thicker line).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sz_thin</code></td>
<td>
<p>Number specifying thickness of 95 percent CI line (thinner line).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sz_ax</code></td>
<td>
<p>Number specifying thickness of axis and ticks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sz_ax_txt</code></td>
<td>
<p>Number specifying size of text for axis label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sz_tick_txt</code></td>
<td>
<p>Number specifying size of text for tick labels on axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sz_main_txt</code></td>
<td>
<p>Number specifying size of text for main title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos_tick</code></td>
<td>
<p>Numeric vector specifying where ticks on axis should be placed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mar</code></td>
<td>
<p>Numerical vector of length 4 specifying plot margins - (BOTTOM, LEFT, TOP, RIGHT). Changes to the margin should be made within the function rather than using the <code>par</code> call.
</p>
<p>Default is c(5.1, 4.1, 4.1, 2.1) - the R plot default.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Points represent posterior medians. Parameters where the smaller specified credible intervals (first value in vector provided to <code>ci</code> argument; 50% by default) overlap 0 (or other value specified by the <code>ref</code> argument) are indicated by 'open' circles and a lighter color than that specified (e.g., gray will be displayed with the default black is specified for <code>col</code>). Parameters where the specific smaller credible intervals DO NOT overlap 0 (or other specified value) AND the larger specified credible intervals (second value in vector provided to <code>ci</code> argument; 95% by default) DO overlap 0 (or other specified value) are indicated by 'closed' circles and a lighter color that that specified. Parameters where the larger specified credible intervals DO NOT overlap 0 (or other specified value) are indicated by 'closed' circles and the color specified (black by default). Thick lines represent the smaller specified credible intervals percent credible intervals (50% by default) while thin lines represent the larger specified credible intervals (95 % by default). <code>ref_ovl = TRUE</code> can be used to enable this feature. When two model objects are supplied to the function (with <code>object</code> and <code>object2</code>) and no argument is supplied to <code>col</code> or <code>col2</code>, light red lines can be interpreted as analogous to gray lines. When <code>ref_ovl = TRUE</code> and a color (or colors) other than the default are specified (with the <code>col</code> and <code>col2</code> arguments) lighter versions of the color specified are used in black of the light gray and/or light red lines.
</p>
<p>When <code>object2</code> is specified, paired caterpillar plots of each parameter are produced. For this reason, parameter names of <code>object</code> and <code>object2</code> specified with the <code>params</code> argument must be identical (to be used for comparing posterior estimates of similar models). <code>col</code> and <code>col2</code> arguments can be specified to change the color of output from <code>object</code> and <code>object2</code>, respectively. By default, output from <code>object</code> is plotted in black and <code>object2</code> is plotted in red. The <code>ref_ovl</code> argument can also be specified.
</p>
<p><code>object</code> argument can be a <code>stanfit</code> object (<code>rstan</code> package), a <code>CmdStanMCMC</code> object (<code>cmdstanr</code> package), a <code>stanreg</code> object (<code>rstanarm</code> package), a <code>brmsfit</code> object (<code>brms</code> package), an <code>mcmc.list</code> object (<code>coda</code> and <code>rjags</code> packages), <code>mcmc</code> object (<code>coda</code> and <code>nimble</code> packages), <code>list</code> object (<code>nimble</code> package), an <code>R2jags</code> model object (<code>R2jags</code> package), a <code>jagsUI</code> model object (<code>jagsUI</code> package), or a matrix containing MCMC chains (each column representing MCMC output for a single parameter, rows representing iterations in the chain). The function automatically detects the object type and proceeds accordingly.
</p>


<h3>Notes</h3>

<p>When specifying <code>rank = TRUE</code> and specifying labels for <code>labels</code>, labels will be applied to parameters before they are ranked.
</p>
<p>Thanks to Cinner et al. 2016, whose Fig. 1 inspired this plot.
</p>


<h3>References</h3>

<p>Cinner, J. E., C. Huchery, M. A. MacNeil, N. A. J. Graham, T. R. McClanahan, J. Maina, E. Maire, J. N. Kittinger, C. C. Hicks, C. Mora, E. H. Allison, S. D'Agata, A. Hoey, D. A. Feary, L. Crowder, I. D. Williams, M. Kulbicki, L. Vigliola, L. Wantiez, G. Edgar, R. D. Stuart-Smith, S. A. Sandin, A. L. Green, M. J. Hardt, M. Beger, A. Friedlander, S. J. Campbell, K. E. Holmes, S. K. Wilson, E. Brokovich, A. J. Brooks, J. J. Cruz-Motta, D. J. Booth, P. Chabanet, C. Gough, M. Tupper, S. C. A. Ferse, U. R. Sumaila, and D. Mouillot. 2016. Bright spots among the world's coral reefs. Nature 535:416-419.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Load data
data(MCMC_data)

#Plot MCMC output
MCMCplot(MCMC_data, labels = NULL)

#Just 'beta' parameters
MCMCplot(MCMC_data, params = 'beta')

#Just 'beta' parameters using highest posterior density intervals
MCMCplot(MCMC_data, params = 'beta', HPD = TRUE)
#Just 'beta[1]', 'beta[4]', and 'alpha[3]'
MCMCplot(MCMC_data, params = c('beta[1]', 'beta[4]', 'alpha[3]'), ISB = FALSE, exact = TRUE)

#Just 'beta[1]', 'beta[4]', and 'alpha[3]' and change the credible interval widths
MCMCplot(MCMC_data, ci = c(50, 89), params = c('beta[1]', 'beta[4]', 'alpha[3]'), 
  ISB = FALSE, exact = TRUE)

#Rank parameters by posterior mean
MCMCplot(MCMC_data, params = 'beta', rank = TRUE)

#Create vertical plot
MCMCplot(MCMC_data, params = 'beta', horiz = FALSE)

</code></pre>


</div>