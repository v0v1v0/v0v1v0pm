<div class="container">

<table style="width: 100%;"><tr>
<td>MCMCtrace</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Trace and density plots from MCMC output</h2>

<h3>Description</h3>

<p>Trace and density plots of MCMC chains for specific parameters of interest. Print plots to pdf by default.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MCMCtrace(
  object,
  params = "all",
  excl = NULL,
  ISB = TRUE,
  exact = TRUE,
  iter = 5000,
  gvals = NULL,
  priors = NULL,
  post_zm = TRUE,
  PPO_out = FALSE,
  Rhat = FALSE,
  n.eff = FALSE,
  ind = FALSE,
  pdf = TRUE,
  plot = TRUE,
  open_pdf = TRUE,
  filename,
  wd = getwd(),
  type = "both",
  ylim = NULL,
  xlim = NULL,
  xlab_tr,
  ylab_tr,
  xlab_den,
  ylab_den,
  main_den = NULL,
  main_tr = NULL,
  lwd_den = 1,
  lwd_pr = 1,
  lty_den = 1,
  lty_pr = 1,
  col_den,
  col_pr,
  col_txt,
  sz_txt = 1.2,
  sz_ax = 1,
  sz_ax_txt = 1,
  sz_tick_txt = 1,
  sz_main_txt = 1.2,
  pos_tick_x_tr = NULL,
  pos_tick_y_tr = NULL,
  pos_tick_x_den = NULL,
  pos_tick_y_den = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>Object containing MCMC output. See DETAILS below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>Character string (or vector of character strings) denoting parameters of interest.
</p>
<p>Default <code>'all'</code> returns chains for all parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>excl</code></td>
<td>
<p>Character string (or vector of character strings) denoting parameters to exclude. Used in conjunction with <code>params</code> argument to select parameters of interest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ISB</code></td>
<td>
<p>Ignore Square Brackets (ISB). Logical specifying whether square brackets should be ignored in the <code>params</code> and <code>excl</code> arguments. If <code>TRUE</code>, square brackets are ignored. If <code>FALSE</code>, square brackets are not ignored.  This allows partial names to be used when specifying parameters of interest. Use <code>exact</code> argument to specify whether input from <code>params</code> and <code>excl</code> arguments should be matched exactly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exact</code></td>
<td>
<p>Logical specifying whether input from <code>params</code> and <code>excl</code> arguments should be matched exactly (after ignoring square brackets if <code>ISB = FALSE</code>). If <code>TRUE</code>, input from <code>params</code> and <code>excl</code> are matched exactly (after taking <code>ISB</code> argument into account). If <code>FALSE</code>, input from <code>params</code> and <code>excl</code> are matched using regular expression format (after taking <code>ISB</code> argument into account).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>Number of iterations to plot for trace and density plots. The default value is 5000, meaning the last 5000 iterations of the chain will be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gvals</code></td>
<td>
<p>Vector containing generating values if simulated data was used to fit model. These values will be plotted as vertical lines on the density plots to compare posterior distributions with the true parameter values used to generate the data. No line will be apparent if the generating value is outside the plotted range of the posterior distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priors</code></td>
<td>
<p>Matrix containing random draws from prior distributions corresponding to parameters of interest. If specified, priors are plotted along with posterior density plots. Percent overlap between prior and posterior (PPO) is also calculated and displayed on each plot. Each column of the matrix represents a prior for a different parameter. Parameters are plotted alphabetically - priors should be sorted accordingly. If <code>priors</code> contains only one prior and more than one parameter is specified for the <code>params</code> argument, this prior will be used for all parameters. The number of draws for each prior should equal the number of iterations specified by <code>iter</code> (or total draws if less than <code>iter</code>) times the number of chains, though the function will automatically adjust if more or fewer iterations are specified. See DETAILS below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>post_zm</code></td>
<td>
<p>Logical - if <code>post_zm = FALSE</code> x- and y-limits of density plots are scaled so that both the prior and posterior can be visualized on a single density plot (rather than zoomed on the posterior).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PPO_out</code></td>
<td>
<p>Logical - if <code>PPO_out = TRUE</code> percent overlap between prior and posterior (PPO) will be output to a dataframe.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rhat</code></td>
<td>
<p>Logical - if <code>Rhat = TRUE</code> potential scale reduction factor (Rhat) for each parameter is plotted on the trace plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.eff</code></td>
<td>
<p>Logical - if <code>n.eff = TRUE</code> number of effective samples for each parameter is plotted on the trace plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ind</code></td>
<td>
<p>Logical - if <code>ind = TRUE</code>, separate density lines will be plotted for each chain. If <code>ind= FALSE</code>, one density line will be plotted for all chains.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdf</code></td>
<td>
<p>Logical - if <code>pdf = TRUE</code> plots will be exported to a pdf.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Logical - if <code>plot = FALSE</code> no plot will be output. Designed to be used in conjunction with <code>PPO_out = TRUE</code>, to calculate PPO without displaying plot output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>open_pdf</code></td>
<td>
<p>Logical - if <code>open_pdf = TRUE</code> pdf will open in viewer after being generated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filename</code></td>
<td>
<p>Name of pdf file to be printed. Default is 'MCMCtrace'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wd</code></td>
<td>
<p>Working directory for pdf output. Default is current directory.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type of plot to be output. <code>'both'</code> outputs both trace and density plots, <code>'trace'</code>
outputs only trace plots, and <code>'density'</code> outputs only density plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>Vector of length two specifying limits for y-axis on density plots only. If specified, overrides argument <code>post_zm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>Vector of length two specifying limits for x-axis on density plots only. If specified, overrides argument <code>post_zm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab_tr</code></td>
<td>
<p>Character string specifying label for x-axis on trace plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab_tr</code></td>
<td>
<p>Character string specifying label for x-axis on trace plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab_den</code></td>
<td>
<p>Character string specifying label for x-axis on density plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab_den</code></td>
<td>
<p>Character string specifying label for x-axis on density plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main_den</code></td>
<td>
<p>Character string (or vector of character strings if plotting &gt; 1 parameter) specifying title(s) of density plot(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main_tr</code></td>
<td>
<p>Character string (or vector of character strings if plotting &gt; 1 parameter) specifying title(s) of trace plot(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd_den</code></td>
<td>
<p>Number specifying thickness of density line on density plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd_pr</code></td>
<td>
<p>Number specifying thickness of prior line on density plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty_den</code></td>
<td>
<p>Number specifying the line type for the density line on density plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty_pr</code></td>
<td>
<p>Number specifying the line type for the prior line on density plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_den</code></td>
<td>
<p>Character string specifying color of density line on density plots. Does not specify color if <code>ind = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_pr</code></td>
<td>
<p>Character string specifying color of prior line on density plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_txt</code></td>
<td>
<p>Character string specifying color of text (denoting PPO) on plot when value specified for <code>priors</code>. If <code>NULL</code> is specified, no text will be plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sz_txt</code></td>
<td>
<p>Number specifying size of text (denoting PPO) when value specified for <code>priors</code>. If <code>NULL</code> is specified, no text will be plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sz_ax</code></td>
<td>
<p>Number specifying thickness of axes and ticks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sz_ax_txt</code></td>
<td>
<p>Number specifying size of text for axes labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sz_tick_txt</code></td>
<td>
<p>Number specifying size of text for tick labels on axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sz_main_txt</code></td>
<td>
<p>Number specifying size of text for main title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos_tick_x_tr</code></td>
<td>
<p>Numeric vector specifying where ticks on x-axis should be placed for trace plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos_tick_y_tr</code></td>
<td>
<p>Numeric vector specifying where ticks on y-axis should be placed for trace plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos_tick_x_den</code></td>
<td>
<p>Numeric vector specifying where ticks on x-axis should be placed for density plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos_tick_y_den</code></td>
<td>
<p>Numeric vector specifying where ticks on y-axis should be placed for density plots.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>object</code> argument can be a <code>stanfit</code> object (<code>rstan</code> package), a <code>stanreg</code> object (<code>rstanarm</code> package), a <code>brmsfit</code> object (<code>brms</code> package), an <code>mcmc.list</code> object (<code>coda</code> and <code>rjags</code> packages), <code>mcmc</code> object (<code>coda</code> and <code>nimble</code> packages), <code>list</code> object (<code>nimble</code> package), an <code>R2jags</code> model object (<code>R2jags</code> package), a <code>jagsUI</code> model object (<code>jagsUI</code> package), or a matrix containing MCMC chains (each column representing MCMC output for a single parameter, rows representing iterations in the chain). The function automatically detects the object type and proceeds accordingly.
</p>
<p>Matrices for the <code>priors</code> argument can be generated using commands such as rnorm, rgamma, runif, etc. Distributions not supported by base R can be generated by using the appropriate packages. It is important to note that some discrepancies between MCMC samplers and R may exist regarding the parameterization of distributions - one example of this is the use of precision in JAGS but standard deviation in R for the 'second parameter' of the normal distribution. If the number of draws for each prior distribution is greater than the total number used for the density plot (<code>iter</code> times the number of chains), the function will use a subset of the prior draws. If the number of draws for each prior distribution is less than the total number used for the density plot, the function will resample (with replacement) from the prior to obtain the appropriate number of draws.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Load data
data(MCMC_data)

#Traceplots for all 'beta' parameters - pdf is generated by default
MCMCtrace(MCMC_data, params = 'beta', pdf = FALSE)

#Traceplots (individual density lines for each chain) just for 'beta[1]'
MCMCtrace(MCMC_data, params = 'beta[1]', 
          ISB = FALSE, exact = TRUE, ind = TRUE, pdf = FALSE)

#Plot prior on top of posterior, calculate prior/posterior overlap (PPO) 
#just for 'beta[1]'
#Add Rhat and n.eff values to density plots
PR &lt;- rnorm(15000, 0, 32)
MCMCtrace(MCMC_data, params = 'beta[1]', ISB = FALSE, exact = TRUE, 
          priors = PR, pdf = FALSE, Rhat = TRUE, n.eff = TRUE)

#Output PPO to R object without plotting trace plots
PR &lt;- rnorm(15000, 0, 32)
PPO &lt;- MCMCtrace(MCMC_data, params = 'beta[1]', ISB = FALSE, exact = TRUE,
                 priors = PR, plot = FALSE, PPO_out = TRUE)
</code></pre>


</div>