<div class="container">

<table style="width: 100%;"><tr>
<td>estSimpsonf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Estimate the Simpson index from several samples </h2>

<h3>Description</h3>

<p>Calculate estimates of the Simpson index after pooling over several samples, grouped by a factor variable.
</p>


<h3>Usage</h3>

<pre><code class="language-R">estSimpsonf(X, f)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p> a data.frame of dimension n times p with integer entries, where n is the number of samples and p is the number of species </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p> a factor variable of length n, grouping the observations in <kbd>X</kbd> </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function splits <kbd>X</kbd> according to the levels of the grouping variable <kbd>f</kbd>, builds the sum over each column and calculates the Shannon index ove the resulting counts.
</p>


<h3>Value</h3>

<p>A list containing the items:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>estimate </code></td>
<td>
<p> the groupwise point estimates of the Simpson index</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varest </code></td>
<td>
<p>the groupwise variance estimates of the Simpson index</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>table </code></td>
<td>
<p>a matrix of counts,containing the summed observations for each level of <kbd>f</kbd> in its rows</p>
</td>
</tr>
</table>
<h3>References</h3>

<p> Rogers, JA and Hsu, JC (2001): Multiple Comparisons of Biodiversity. Biometrical Journal 43, 617-625. </p>


<h3>See Also</h3>

 <p>estShannonf </p>


<h3>Examples</h3>

<pre><code class="language-R">
# Here, the estimates for the Hell Creek Dinosaur 
# example are compared to the estimates in 
# Tables 2 and 3 of Rogers and Hsu (2001).

data(HCD)
HCD

# Groupwise point estimates:

est&lt;-estSimpsonf(X=HCD[,-1], f=HCD[,1])

est

# Table 2:


cmat&lt;-rbind(
"lower-middle"=c(1,-1,0),
"lower-upper"=c(1, 0,-1),
"middle-upper"=c(0,1,-1))


# the point estimates:

# cmat %*% est$estimate
crossprod(t(cmat), est$estimate)


# the standard errors:
# sqrt(diag(cmat %*% diag(est$varest) %*% t(cmat)))

sqrt(diag(crossprod(t(cmat), crossprod(diag(est$varest), t(cmat)) ) ))


# Table 3:

cmat&lt;-rbind(
"middle-lower"=c(-1,1,0),
"upper-lower"=c(-1,0,1))

# cmat %*% est$estimate
crossprod(t(cmat), est$estimate)


# sqrt(diag(cmat %*% diag(est$varest) %*% t(cmat)))

sqrt(diag(crossprod(t(cmat), crossprod(diag(est$varest), t(cmat)) ) ))

# Note, that the point estimates are exactly
# the same as in Rogers and Hsu (2001),
# but the variance estimates are not, whenever
# the Upper group is involved.


</code></pre>


</div>