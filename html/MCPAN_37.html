<div class="container">

<table style="width: 100%;"><tr>
<td>lnrci</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simultaneous confidence intervals for expected values assuming lognormal distribution.
</h2>

<h3>Description</h3>

<p>Simultaneous confidence intervals for multiple contrasts of expected values of several (K) groups in a one-way layout, assuming lognormal distribution of the response. Multiple ratios of (weighted geometric means of) expected values can be estimated as well as multiple differences of (weighted arithmetic means of) the expected values in the K groups can be estimated. For both, ratios and differences, a method based on asymptotic normality (not recommended) and a method based on generalized pivotal quantities are available.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lnrci(x, f, type = "Dunnett", cmat = NULL,
 alternative = c("two.sided", "less", "greater"),
 conf.level = 0.95, method = c("GPQ", "AN"), ...)
lndci(x, f, type = "Dunnett", cmat = NULL,
 alternative = c("two.sided", "less", "greater"),
 conf.level = 0.95, method = c("GPQ", "AN"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>a numeric vector, the response variable, assumed to be lognormally distributed, should contain only positive values
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>

<p>a factor variable, of the same length as <code>x</code>, groupingt the observations in <code>x</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>a single character string, naming a contrast type, see contrMat for the options; this argument is ignored if a contrast matrix is specified in <code>cmat</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cmat</code></td>
<td>

<p>a matrix with numeric entries, containing contrast coefficients; if there are K levels in <code>f</code>, the matrix should have k columns
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>

<p>a single character string, with options <code>"two.sided"</code> for two-sided confidence intervals, <code>"less"</code> for upper bounds only and <code>"greater"</code> for lower bounds only
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>

<p>a single numeric value between 0 and 1
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>a single character string, naming the method by which to compute the confidence intervals; options are <code>"GPQ"</code> for a method based on generalized pivotal quantities and <code>"AN"</code> for the asymptotic normal method (not recommended).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>further arguments to be passed to the internal methods, in particular: Argument <code>B</code> specifies the number of samples to be drawn if method <code>"GPQ"</code> (defaults to 10000), it is ignored if <code>method="AN"</code>. Second, <code>dist</code> must be a single character string as in <code>Waldci</code>, invoking the use of multivariate normal quantiles <code>dist="MVN"</code> or standard normal quantiles <code>dist="N"</code> when <code>method="AN"</code>; it is ignored if <code>method="GPQ"</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In a setting with K treatment groups, assuming a completely randomized design and lognormal distribution of the response variable, multiple (M) ratios or differences among expected values of the K treatment groups may be of interest. The ratios or differences of interest can be specified via a character string (in argument <code>type</code>) or via an M x K matrix in argument <code>cmat</code>. Intervals for ratios can be computed (via linear contrasts on the log scale) in function <code>lnrci</code>, differences can be computed in fucntion <code>lndci</code>. A simulation study of the methods implemented here can be found in Schaarschmidt (2013).
</p>
<p>By default, the confidence intervals are adjusted for multiple comparisons. The asymptotic normal methods, rely on maximum likelihood estimates for the expected values and the corresponding variance estimates (as given in Chen and Zhou, 2006) and adjut for multiplicity via critical value from the multivariate normal distribution (correlation structure with plug-in of variance estimates).
The generalized pivotal quantity methods rely on simulating the distribution of the parameters (number of samples B=10000 by default, Krishnamoorthy and Mathew, 2003; Chen and Zhou, 2006) and compute simultaneous intervals from this sample using the function <code>SCSrank</code>.
</p>


<h3>Value</h3>

<p>A list with elements
</p>
<table>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>a column vector, containing the point estimates of the contrasts</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.int</code></td>
<td>
<p>a Mx2 matrix of confidence bounds, if M comparisons among the K samples are invoked</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>a character string, as input</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>a numeric value, as input</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Frank Schaarschmidt</p>


<h3>References</h3>

<p><em>Schaarschmidt, F. (2013).</em> Simultaneous confidence intervals for multiple comparisons among expected values of log-normal variables. Computational Statistics and Data Analysis 58, 265-275
</p>
<p><em>Chen, Y-H, Zhou, X-H (2006).</em> Interval estimates for the ratio and the difference of two log-normal means.
Statistics in Medicine 25, 4099-4113.
</p>
<p><em>Krishnamoorthy K, Mathew T (2003).</em> Inferences on the means of lognormal distributions using generalized p-values and generalized confidence intervals. Journal of Statistical Planning and Inference 115, 103-121.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
x &lt;- rlnorm(n=100, meanlog=rep(c(0,0.1,1,1), each=25), sdlog=0.5)
f &lt;- as.factor(rep(LETTERS[1:4], each=25))
boxplot(x~f)

lndci(x=x, f=f, type="Dunnett", method="GPQ", B=20000)
lndci(x=x, f=f, type="Dunnett", method="AN")

lnrci(x=x, f=f, type="Tukey", method="GPQ", B=20000)
lnrci(x=x, f=f, type="Tukey", method="AN")
</code></pre>


</div>