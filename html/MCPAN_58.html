<div class="container">

<table style="width: 100%;"><tr>
<td>poly3ci</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Simultaneous confidence intervals for contrasts of poly-3-adjusted tumour rates</h2>

<h3>Description</h3>

<p>Function to calculate simultaneous confidence intervals for several contrasts
of poly-3-adjusted tumour rates in a oneway layout.
Assuming a data situation as in Peddada(2005) or Bailer and Portier (1988).
Simultaneous asymptotic CI for contrasts of tumour rates, assuming that
standard normal approximation holds.
</p>


<h3>Usage</h3>

<pre><code class="language-R">poly3ci(time, status, f, type = "Dunnett",
 cmat = NULL, method = "BP", alternative = "two.sided",
 conf.level = 0.95, dist="MVN", k=3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p> a numeric vector of times of death of the individuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>status</code></td>
<td>
<p> a logical (or numeric, consisting of 0,1 only) vector giving the tumour status at time of death of each individual,
where TRUE (1) = tumour present, FALSE (0) = no tumour present  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p> a factor, giving the classification variable </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p> a character string, giving the name of a contrast method, as defined in <kbd>contrMat(multcomp)</kbd> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cmat</code></td>
<td>
<p> a optional contrast matrix </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p> a single charcter string, specifying the method for adjustment,
with options: "BP" (Bailer Portier: assuming poly-3-adjusted rates are binomial variables),
"BW" (Bieler, Williams: delta method as in Bieler and Williams (1993))
"ADD1" (as Bailer Portier, including an add1-adjustment on the raw tumour rates)
"ADD2" (as Bailer Portier, including an add2-adjustment on the raw tumour rates following Agresti and Caffo (2000) for binomials)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p> a single character string </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p> a single numeric value, simultaneous confidence level </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>a character string, <kbd>"MVN"</kbd> invokes multiplicity adjustment via the multivariate normal distribution,
<kbd>"N"</kbd> invokes use of quantiles of the univariate normal distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>the exponent to calculate survival adjusted proportions, default is k=3</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed; currently only base, to be passed to <kbd>contrMat</kbd> to choose the control group with <kbd>type="Dunnett"</kbd></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A object of class "poly3ci", a list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>conf.int </code></td>
<td>
<p>a matrix with 2 columns: lower and upper confidence bounds, and M rows</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative </code></td>
<td>
<p>character string, as input</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>single numeric value, as input</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantile</code></td>
<td>
<p>the quantile used to construct the CIs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p> a numeric vector with the point estimates of the contrasts</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p> as input</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>status</code></td>
<td>
<p>as input</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>as input</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>as input</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cmat</code></td>
<td>
<p>as input, with colnames= factor levels of f</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample.est</code></td>
<td>
<p>a list containing sample estimates</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p> Please note that all methods here described are only approximative, and might violate the nominal level in certain situations.
Please note further that appropriateness of the point estimates, and consequently of tests and confidence intervals is based on the assumptions in Bailer and Portier (1988),
which might be a matter of controversies. </p>


<h3>Author(s)</h3>

<p> Frank Schaarschmidt </p>


<h3>References</h3>

 
<p>The implemented methodology is described in:
</p>
<p>Schaarschmidt, F., Sill, M., and Hothorn, L.A. (2008):
Approximate Simultaneous confidence intervals for multiple contrasts of binomial proportions.
Biometrical Journal 50, 782-792.
</p>
<p>Background references are:
</p>
<p>Assumption for poly-3-adjustment:
Bailer, J.A. and Portier, C.J. (1988):
Effects of treatment-induced mortality and tumor-induced mortality on tests for carcinogenicity in small samples.
Biometrics 44, 417-431.
</p>
<p>Peddada, S.D., Dinse, G.E., and Haseman, J.K. (2005):
A survival-adjusted quantal response test for comparing tumor incidence rates.
Applied Statistics 54, 51-61.
</p>
<p>Bieler, G.S. and Williams, R.L. (1993):
Ratio estimates, the Delta Method, and quantal response tests for increased carcinogenicity.
Biometrics 49, 793-801.
</p>
<p>Statistical procedures and characterization of the coverage probabilities are described in:
Sill, M. (2007):
Approximate simultaneous confidence intervals for multiple comparisons of binomial proportions.
Master thesis, Institute of Biostatistics, Leibniz University Hannover.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#############################################################

### Methyleugenol example in Schaarschmidt et al. (2008) ####

#############################################################

# load the data:

data(methyl)

# The results in Table 5 (Schaarschmidt et al. 2008) can be
# reproduced by calling:


methylW&lt;-poly3ci(time=methyl$death, status=methyl$tumour,
 f=methyl$group, type = "Williams", method = "ADD1", alternative="greater" )

methylW


methylWT&lt;-poly3test(time=methyl$death, status=methyl$tumour,
 f=methyl$group, type = "Williams", method = "ADD1", alternative="greater" )

methylWT


plot(methylW, main="Simultaneous CI for \n Poly-3-adjusted tumour rates")

# The results in Table 6 can be reproduced by calling:

methylD&lt;-poly3ci(time=methyl$death, status=methyl$tumour,
 f=methyl$group, type = "Dunnett", method = "ADD1", alternative="greater" )

methylD

methylDT&lt;-poly3test(time=methyl$death, status=methyl$tumour,
 f=methyl$group, type = "Dunnett", method = "ADD1", alternative="greater" )

methylDT


plot(methylD, main="Simultaneous CI for Poly-3-adjusted tumour rates", cex.main=0.7)


############################################################


# unadjusted CI

methylD1&lt;-poly3ci(time=methyl$death, status=methyl$tumour,
 f=methyl$group, type = "Dunnett", method = "ADD1", dist="N" )

methylD1

plot(methylD1, main="Local CI for Poly-3-adjusted tumour rates")

</code></pre>


</div>