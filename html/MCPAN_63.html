<div class="container">

<table style="width: 100%;"><tr>
<td>powerbinom</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Approximate power for multiple contrast tests of binomial proportions.
</h2>

<h3>Description</h3>

<p>Approximative power calculation for multiple contrast tests of binomial proportions (based on risk differences, or odds ratios), based on probabilities of the multivariate standard normal distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">powerbinom(p, n, alpha = 0.05, type = "Dunnett", cmat = NULL,
 rhs = 0, alternative = c("two.sided", "less", "greater"),
 ptype = c("global", "anypair", "allpair"), method = "Wald", crit = NULL, ...)

powerbinomOR(p, n, alpha = 0.05, type = "Dunnett", cmat = NULL, 
    rhs = 1, alternative = c("two.sided", "less", "greater"), 
    ptype = c("global", "anypair", "allpair"), 
    crit = NULL, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p> a numeric vector of assumed true proportions under the alternative hypothesis where <code>length(p)</code> is the number of (treatment) groups in the multiple comparison problem
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>a vector (of integer values), the number of observations per (treatment) group, must have the same length as <code>p</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>a single numeric value, the alpha-level of the test, default is 0.05
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>a single charcater string naming the type of multiple contrast test to be applied on the proportions <kbd>p</kbd>; will be ignored if argument <code>cmat</code> is specified; for possible choices, see <code>contrMat</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cmat</code></td>
<td>

<p>optional, a matrix fo contrast coefficients (with number of columns = number of treatmenmt groups and number of rows = number of comparisons); if <code>cmat</code> is not specified, the type of multiple contrast test to be applied on the proportions <code>p</code> is chosen according to argument <code>type</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rhs</code></td>
<td>

<p>a (vector of) numeric value(s), specifying the right hand sides of the alternative hypotheses, default is 0 for the risk difference (<kbd>powerbinom</kbd>), and 1 for the odds ratio (<kbd>powerbinomOR</kbd>), if values greater or less than the default are specified, power for shifted tests (non-inferiority, superiority) is computed; Note that the latter primarily makes sense for one-sided hypotheses. A warning is given when <code>alternative ="two.sided"</code> with <code>rhs!=0</code> or <code>rhs!=1</code> for difference or oddsratios, respectively.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>

<p>a character string, specifying the direction of the alternative hypotheses, options are "two.sided", "less", "greater"; <code>alternative</code> primarily controls for which directional decisions power is calculated, in case that argument <code>crit</code> is not specified, <code>alternative</code> also controls the choice of the critical value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ptype</code></td>
<td>
<p> a single character string, naming the type of rejection probability to be computed; options are <code>"global"</code> for the overall rejection probability (irrespective which contrasts are under the null or the alternative), <code>"anypair"</code> for the rejection probability considering only those contrasts under the alternative, <code>"global"</code> for the probability that all elementary alternatives are rejected. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>a character string, the method for variance estimation in test / confidence interval construction: one of "Wald", "ADD1", "ADD2".
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crit</code></td>
<td>

<p>a single numeric value to serve as equicoordinate critical point in the multiple test; if it is not specified, it is computed as a quantile of the multivariate normal distribution based on the specifications in arguments <code>n</code>, <code>cmat</code> (or <code>type</code>); note that for alternatives <code>'two.sided'</code> and <code>'greater'</code>, <code>crit</code> should be a single positive value, while for alternative <code>'less'</code>, <code>crit</code> should be a single negative value. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>further arguments, which are passed to the functions <code>qmvnorm</code> and <code>pmvnorm</code>, mainly to control the computation errors, see <code>GenzBretz</code> in package <code>mvtnorm</code> for details
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For (standard type and user-defined) multiple contrast tests of proportions in 2xk contigency tables assuming the binomial distribution and k treatment groups, different types of rejection probabilities in the multiple testing problem can be computed.
Based on a central multivariate normal distribution, equicoordinate critical points for the test are computed, different critical points for the test can be specified in <code>crit</code>.
</p>
<p>Via computing probabilities of non-central multivariate normal distributions <code>pmvt(mvtnorm)</code> one can calculate:
</p>
<p>The global rejection probability (<code>power="global"</code>), i.e. the probability that at least one of the elementary null hypotheses is rejected, irrespective, whether this (or any contrast!) is under the corresponding elementary alternative). As a consequence this probability involves elementary type-II-errors for those contrasts which are under their elementary null hypothesis.
</p>
<p>The probability to reject at least one of those elementary null hypotheses which are indeed under their corresponding elementary alternatives (<code>ptype="anypair"</code>). Technically, this is achieved by omitting those contrasts under the elementary null and, for a given critical value, compute the rejection probability from a multivariate normal distribution with reduced dimension. Note that for <code>'two-sided'</code> alternatives, type III-errors (rejection of the two-sided null in favor of the wrong direction) are included in the power.
</p>
<p>The probability to reject all elementary null hypotheses which are indeed under their corresponding elementary alternatives (<code>power="allpair"</code>). Also here, for 'two-sided' alternatives, the type III-error contributes to the computed 'allpair power'. Note further that two-sided allpair power is simulated based on multivariate normal random numbers.
</p>
<p>Whether a given hypothesis is under the alternative hypothesis is currently checked via <code>abs(L-rhs) &gt; 10*.Machine$double.eps</code>, where L is the constrasts true value depending on <code>p</code> and the contrast matrix and rhs the right hand side of the null hypothesis. For alternatives <code>"less"</code> or <code>"greater"</code>, the corresponding checks are: <code>(L-rhs) &lt; -10*.Machine$double.eps</code> and <code> (L-rhs) &gt; 10*.Machine$double.eps</code>, respectively.
</p>
<p>For the case of differences or proportion (powerbinom) the underlying methods are closely related to those described in Bretz and Hothorn (2002). The methods here differ from that of Bretz and Hothorn (2002) by using a variance estimator in the teststatistic based of unpooled sample rpoportions, not a pooled variances estimator under H0. A description is also given in Schaarschmidt, Biesheuvel and Hothorn, 2009. The method implemented for the odds ratio corresponds to the asymptotic intervals given in Holford et al. 1989, the power computation is a straightforward generalization of the methods above, assuming asymptotic normality at the scale of log odds.
</p>


<h3>Value</h3>

<p>A list consisting of the following items:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>a numeric value the computed power, with estimated computational error as an attribute</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>the input vector of expected groupwise proportions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>the input vector of group sample sizes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conexp</code></td>
<td>
<p>a data frame containing the contrast matrix, the expected values of the contrasts given p (expContrast), the right hand sides of the hypotheses (rhs, as input), the expected values of the test statistics corresponding to the contrasts and rhs, and a column of logical values indicating whether the corresponding contrasts was under the alternative (under HA)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crit</code></td>
<td>
<p>a single numeric value, the critical value used for power computation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>a single character string, as input</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ptype</code></td>
<td>
<p>a single character string, as input</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>a single numeric value, as input</p>
</td>
</tr>
</table>
<h3>Warning </h3>

<p>Note that the the tests for which power is computed as well as the power computation itself relies on simple approximations of binomial distribution by normal distributions. It is known that the test procedures do not control FWER for small <code>n</code> and extreme proportions <code>p</code>. Hence, computed power may substantially deviate from the true power of the methods a) due to the fact that the tests have sizes deviating from the nominal level, b) due to insufficient approximation in the power calculation. Simulations show that absolute deviations of approximate power from simulated power are large if low values of n*p or n*(1-p) are involved and if power is low (i.e. power&lt;0.3). </p>


<h3>Author(s)</h3>

<p>Frank Schaarschmidt
</p>


<h3>References</h3>

<p><em>Genz A, Bretz F (1999):</em> Numerical computation of multivariate t-probabilities with application to power calculation of multiple contrasts. Journal of Statistical Computation and Simulation, 63, 4, 361-378.
</p>
<p><em>Bretz F, Hothorn LA (2002):</em> Detecting dose-response using contrasts: asymptotic power and sample size determination for binomial data. Statistics in Medicine, 21, 22, 3325-3335.
</p>
<p><em>Holford, TR, Walter, SD and Dunnett, CW (1989):</em> Simultaneous interval estimates of the odds ratio in studies with two or more comparisons. Journal of Clinical Epidemiology 42, 427-434.
</p>
<p><em>Schaarschmidt F, Biesheuvel E, Hothorn LA (2009):</em> Asymptotic simultaneous confidence intervals for many-to-one comparisons of binray proportions in randomized clinical trials. Journal of Biopharmaceutical Statistics 19, 292-310.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Assume, one wants to perform a test for increasing trend
#  using Williams type of contrasts among I=5 groups
#  (e.g. 4 doses and one control).
#  Proportions are assumed to have values
#  pi=(0.1,0.12,0.14,0.14,0.2) under the alternative.

powerbinom(p=c(0.1, 0.12, 0.14, 0.14, 0.2),
 n=c(100,100,100,100,100), type = "Williams",
 alternative = "greater")

powerbinom(p=c(0.1, 0.12, 0.14, 0.14, 0.2),
 n=c(150,150,150,150,150), type = "Williams",
 alternative = "greater")

powerbinom(p=c(0.1, 0.12, 0.14, 0.14, 0.2),
 n=c(190,140,140,140,140), type = "Williams",
 alternative = "greater")


# probability to show for at least one group (2,3,4)
# a significant reduction versus control (1)

powerbinom(p=c(0.3, 0.15, 0.15, 0.15),
 n=c(140,140,140,140), type = "Dunnett",
 alternative = "less")

# probability to show for at least one group (2,3,4)
# a significant reduction versus control (1) of more 
# than 0.05 percent

powerbinom(p=c(0.3, 0.15, 0.15, 0.15),
 n=c(140,140,140,140), type = "Dunnett",
 alternative = "less", rhs=-0.05)

# probability to show for all groups (2,3,4)
# a significant reduction versus control (1) of more 
# than 0.05 percent

powerbinom(p=c(0.3, 0.15, 0.15, 0.15),
 n=c(140,140,140,140), type = "Dunnett",
 alternative = "less", rhs=-0.05, ptype="allpair")


# probability to show for at least one group (2,3,4)
# a significant reduction versus control (1)

powerbinom(p=c(0.3, 0.15, 0.15, 0.15),
 n=c(140,140,140,140), type = "Dunnett",
 alternative = "less")


powerbinomOR(p=c(0.3, 0.15, 0.15, 0.15),
 n=c(140,140,140,140), type = "Dunnett",
 alternative = "less")
</code></pre>


</div>