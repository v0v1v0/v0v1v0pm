<div class="container">

<table style="width: 100%;"><tr>
<td>powermcpn</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Approximative power calculation for multiple contrast tests 
</h2>

<h3>Description</h3>

<p>Approximative power calculation for multiple contrast tests which are based on normal approximation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">powermcpn(ExpTeststat, corrH1, crit, alternative = c("two.sided", "less", "greater"),
 alpha = 0.05, ptype = c("global", "anypair", "allpair"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ExpTeststat</code></td>
<td>

<p>numeric vector: the expectation of the test statistics under the alternative
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corrH1</code></td>
<td>

<p>a numeric matrix, the correlation matrix of the teststatistics under the alternative, must have same number of columns and rows as length of <code>ExpTeststat</code> 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crit</code></td>
<td>

<p>a single numeric value, the critical value of the test; if not specified a critical value is computed as an equicoordinate (1-<code>alpha</code>) quantile of a central multivariate normal distribution with correlation <code>corrH1</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>

<p>a character string, specifying the direction of the alternative hypotheses, options are "two.sided", "less", "greater"; <code>alternative</code> primarily controls for which directional decisions power is calculated, in case that argument <code>crit</code> is not specified, <code>alternative</code> also controls the choice of the critical value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>a single numeric value: the FWER for the multiple test, defaults to 0.05
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ptype</code></td>
<td>
<p> a single character string, naming the type of rejection probability to be computed; options are <code>"global"</code> for the overall rejection probability (irrespective which contrasts are under the null or the alternative), <code>"anypair"</code> for the rejection probability considering only those contrasts under the alternative, <code>"global"</code> for the probability that all elementary alternatives are rejected. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>further arguments, which are passed to the functions <code>qmvnorm</code> and <code>pmvnorm</code>, mainly to control the computation errors, see help <code>GenzBretz(mvtnorm)</code> for details
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For (standard type and user-defined) multiple contrast tests based on approximation with the multivariate normal distribution, three types of rejection probabilities in the multiple testing problem can be computed.
</p>
<p>The global rejection probability (<code>power="global"</code>), i.e. the probability that at least one of the elementary null hypotheses is rejected, irrespective, whether this (or any contrast!) is under the corresponding elementary alternative). As a consequence this probability involves elementary type-II-errors for those contrasts which are under their elementary null hypothesis.
</p>
<p>The probability to reject at least one of those elementary null hypotheses which are indeed under their corresponding elementary alternatives (<code>power="anypair"</code>). Technically, this is achieved by omitting those contrasts under the elementary null and, for a given critical value, compute the rejection probability from a multivariate normal distribution with reduced dimension. Note that for <code>'two-sided'</code> alternatives, type III-errors (rejection of the two-sided null in favor of the wrong direction) are included in the power.
</p>
<p>The probability to reject all elementary null hypotheses which are indeed under their corresponding elementary alternatives (<code>power="allpair"</code>). Also here, for 'two-sided' alternatives type III-error contribute to the computed 'allpair power'. Note further that two-sided allpair power is simulated based on multivariate normal random numbers.
</p>
<p>Whether a given hypothesis is under the alternative hypothesis is currently checked via <code>abs(ExpTeststat) &gt; 10*.Machine$double.eps</code>,  <code>ExpTeststat &lt; -10*.Machine$double.eps</code> and <code>ExpTeststat &gt; 10*.Machine$double.eps</code>, for alternatives <code>c("two.sided", "less", "greater")</code>, respectively.
</p>


<h3>Value</h3>

<p>A list consisting of the following items:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>a numeric value the computed power, with estimated computational error as an attribute</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conexp</code></td>
<td>
<p> the expected values of the test statistics corresponding to the contrasts and rhs, and a column with [0,1] values, indicating whether the corresponding contrasts was under the alternative (1) or under the null (0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crit</code></td>
<td>
<p>a single numeric value, the critical value used for power computation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>a single character string, as input</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ptype</code></td>
<td>
<p>a single character string, as input</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>a single numeric value, as input</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Frank Schaarschmidt
</p>


</div>