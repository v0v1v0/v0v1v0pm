<div class="container">

<table style="width: 100%;"><tr>
<td>mcpmod_simulation</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulation to obtain operating characteristics for MCP-Mod design</h2>

<h3>Description</h3>

<p>It simulates dose-finding trials using MCP-Mod design with Maximum Likelihood Estimator and Fisher Information (MLE), 
Maximum Likelihood Estimator and second-order Fisher Information (MLE2), Cox and Snell's Bias-Corrected Estimator and 
Fisher Information (BCE), Cox and Snell's Bias-Corrected Estimator and second-order Fisher Information (BCE2), and 
Firth Bias-Corrected estimators (Firth) as discussed in Diniz, Magalhães and Gallardo.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mcpmod_simulation(doses, parm, sample.size, model.true,
  models.candidate, selModel = "AIC",significance.level = 0.025,
  Delta, distr = "weibull", censoring.rate = NULL,
  sigma.estimator = NULL, n.cores, seed,n.sim)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>doses</code></td>
<td>
<p>a numeric vector indicating the doses that will be considered in the clinical trial.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parm</code></td>
<td>
<p>a named list of true values for the simulation. See more details in <code>data_generator</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample.size</code></td>
<td>
<p>a numeric vector indicating the sample sizes per dose in the clinical trial to be evaluated in the simulation study.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.true</code></td>
<td>
<p>a character value indicating the true functional form of dose-response curve. See more details in <code>model_response</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>models.candidate</code></td>
<td>
<p>an object of class 'Mods'. See more details in <code>Mods</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selModel</code></td>
<td>
<p>a character value indicating the model selection criterion for dose estimation. See more details in <code>MCPMod</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>significance.level</code></td>
<td>
<p>a numeric value indicating the significance level when evaluating proof-of-concept based on an one-sided Wald test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Delta</code></td>
<td>
<p>a numerical value indicating the target effect size used for the target dose. See <code>TD</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distr</code></td>
<td>
<p>a character value indicating the distribution of the response variable. Currently, the only option available is 'weibull'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>censoring.rate</code></td>
<td>
<p>a numeric value between 0 and 1 indicating the censoring rate when generated data. It is required when <code>distr = "weibull"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.estimator</code></td>
<td>
<p>a character value indicating whether the estimator for sigma should be a maximum likelihood or 
jackknife estimator. It is required when <code>distr = "weibull"</code>. Options are "mle" and "jackknife".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.cores</code></td>
<td>
<p>a numeric value indicating the number of cores to be used in the 'simulation performed in parallel. 
Use parallel::detectCores() to check the number of cores available.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>an integer value, containing the random number generator (RNG) state for random number generation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.sim</code></td>
<td>
<p>a numerical value indicating the number of simulated trials.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class mcpmod_simulation with the following components:
</p>
<p><code>mle</code>: a matrix of dimension n.sim <code class="reqn">\times</code> 4 with results when using the MCP-Mod approach with MLE;
</p>
<p><code>mle2</code>: a matrix of dimension n.sim <code class="reqn">\times</code> 4 with results when using the MCP-Mod approach with MLE2;
</p>
<p><code>bce</code>: a matrix of dimension n.sim <code class="reqn">\times</code> 4 with results when using the MCP-Mod approach with BCE;
</p>
<p><code>bce2</code>: a matrix of dimension n.sim <code class="reqn">\times</code> 4 with results when using the MCP-Mod approach with BCE2;
</p>
<p><code>firth</code>: a matrix of dimension n.sim <code class="reqn">\times</code> 4 with results when using the MCP-Mod approach with Firth's estimator;
</p>
<p>All matrices contain the following columns:
(1) the first column indicates whether proof-of-concept (1 = "yes", 0 = "no"), in other words, the p-value of Wald test was statistically significant;
(2) the second column indicates whether the true model was selected to estimate the dose-response curve (1 = "yes", 0 = "no") when proof-of-concept is demonstrated;
(3) the third column contains the estimated target dose;
(4) the fourth column contains the sample size considered in the trial.
</p>
<p><code>conditions</code>: a list containing the conditions of the simulation.
</p>


<h3>Author(s)</h3>

<p>Diniz, M.A., Gallardo D.I., Magalhaes, T.M.
</p>


<h3>References</h3>

<p>Bretz F, Pinheiro JC, Branson M. Combining multiple comparisons and modeling techniques in dose‐response studies. Biometrics. 2005 Sep;61(3):738-48.
</p>
<p>Bornkamp B, Pinheiro J, Bretz F. MCPMod: An R package for the design and analysis of dose-finding studies. Journal of Statistical Software. 2009 Feb 20;29:1-23.
</p>
<p>Diniz, Márcio A. and Gallardo, Diego I. and Magalhães, Tiago M. (2023). Improved inference  for MCP-Mod approach for time-to-event endpoints with small sample sizes. arXiv 
&lt;doi.org/10.48550/arXiv.2301.00325&gt;
</p>
<p>Pinheiro J, Bornkamp B, Glimm E, Bretz F. Model‐based dose finding under model uncertainty using general parametric models. Statistics in medicine. 2014 May 10;33(10):1646-61.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(DoseFinding)
library(MCPModBC)

## doses scenarios 
doses &lt;- c(0, 5, 25, 50, 100)
nd &lt;- length(doses)
sample.size &lt;- 25

# shape parameter
sigma.true &lt;- 0.5

# median survival time for placebo dose
mst.control &lt;- 4 

# maximum hazard ratio between active dose and placebo dose 
hr.ratio &lt;- 4  
# minimum hazard ratio between active dose and placebo dose
hr.Delta &lt;- 2 

# hazard rate for placebo dose
placEff &lt;- log(mst.control/(log(2)^sigma.true)) 

# maximum hazard rate for active dose
maxEff &lt;- log((mst.control*(hr.ratio^sigma.true))/(log(2)^sigma.true))

# minimum hazard rate for active dose
minEff.Delta &lt;- log((mst.control*(hr.Delta^sigma.true))/(log(2)^sigma.true))
Delta &lt;- (minEff.Delta - placEff)
	
## MCP Parameters 
significance.level &lt;- 0.05
selModel &lt;- "AIC"

emax &lt;- guesst(d = doses[4], p = 0.5, model="emax")
exp &lt;- guesst(d = doses[4], p = 0.1, model="exponential", Maxd = doses[nd])
logit &lt;- guesst(d = c(doses[3], doses[4]), p = c(0.1,0.8), "logistic",  
	Maxd= doses[nd])
betam &lt;- guesst(d = doses[2], p = 0.3, "betaMod", scal=120, dMax=50, 
	Maxd= doses[nd])

models.candidate &lt;- Mods(emax = emax, linear = NULL,
                         exponential = exp, logistic = logit,
                         betaMod = betam, doses = doses,
                         placEff = placEff, maxEff = (maxEff- placEff))
plot(models.candidate)

## Simulation Parameters
n.sim &lt;- 10
seed &lt;- 1234 
n.cores &lt;- 1

## True Model
model.true &lt;- "emax"
response &lt;- model_response(doses = doses,
                           distr = "weibull", 
                           model.true = model.true, 
                           models.candidate = models.candidate) 
lambda.true &lt;- response$lambda
parm &lt;- list(lambda = lambda.true, sigma = sigma.true)

## Scenario: Censoring 10%
censoring.rate &lt;- 0.1

test &lt;- mcpmod_simulation(doses = doses,
           parm = parm, sample.size = sample.size,
           model.true = model.true,
           models.candidate = models.candidate,
           selModel = selModel,
           significance.level = significance.level,
           Delta = Delta, distr = "weibull",
           censoring.rate = censoring.rate,
           sigma.estimator = "jackknife",
           n.cores = n.cores, seed = seed, n.sim = n.sim)

test
summary(test)


</code></pre>


</div>