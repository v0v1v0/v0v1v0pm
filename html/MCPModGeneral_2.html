<div class="container">

<table style="width: 100%;"><tr>
<td>MCPModGen</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MCPModGen - Multiple Comparison and Modeling (General Case)</h2>

<h3>Description</h3>

<p>This function allows the user to implement the MCPMod function on negative
binomial, Poisson, and binary data, without having to write any additional
code. If analyzing survival data, see the
<code>MCPModSurv</code> function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MCPModGen(
  family = c("negative binomial", "binomial"),
  link = c("log", "logit", "probit", "cauchit", "cloglog", "identity", "log risk ratio",
    "risk ratio"),
  returnS = FALSE,
  w = NULL,
  dose,
  resp,
  data = NULL,
  models,
  addCovars = ~1,
  placAdj = FALSE,
  selModel = c("AIC", "maxT", "aveAIC"),
  alpha = 0.025,
  df = NULL,
  critV = NULL,
  doseType = c("TD", "ED"),
  Delta,
  p,
  pVal = TRUE,
  alternative = c("one.sided", "two.sided"),
  na.action = na.fail,
  mvtcontrol = mvtnorm.control(),
  bnds,
  control = NULL,
  offset = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>A character string containing the error distribution to be used
in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>A character string for the model link function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnS</code></td>
<td>
<p>Logical determining whether muHat and SHat should be returned,
in additional to the MCPMod output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>Either a numeric vector of the same length as dose and resp, or a
character vector denoting the column name in the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dose, resp</code></td>
<td>
<p>Either vectors of equal length specifying dose and response
values, or character vectors specifying the names of variables in the data
frame specified in <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data frame with names specified in 'dose', 'resp', and optionally
'w'. If data is not specified, it is assumed that 'dose' and 'resp' are
numerical vectors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>models</code></td>
<td>

<p>An object of class ‘<span class="samp">⁠"Mods"⁠</span>’, see <code>Mods</code> for
details
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>addCovars</code></td>
<td>
<p>Formula specifying additive linear covariates (e.g. '~
factor(gender)').</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>placAdj</code></td>
<td>
<p>Logical specifying whether the provided by 'resp' are to be
treated as placebo-adjusted estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selModel</code></td>
<td>

<p>Optional character vector specifying the model selection criterion for
dose estimation.  Possible values are 
</p>

<ul>
<li> <p><code>AIC</code>: Selects model with smallest AIC (this is the default)
</p>
</li>
<li> <p><code>maxT</code>: Selects the model corresponding to the largest t-statistic.
</p>
</li>
<li> <p><code>aveAIC</code>: Uses a weighted average of the models corresponding to the
significant contrasts.  The model weights are chosen by the formula:
<code class="reqn">w_i = \exp(-0.5AIC_i)/\sum_i(\exp(-0.5AIC_i))</code>
See Buckland et al. (1997) for details.
</p>
</li>
</ul>
<p>For ‘<span class="samp">⁠type = "general"⁠</span>’ the "gAIC" is used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>Significance level for the multiple contrast test
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>An optional numeric value specifying the degrees of freedom.
Infinite degrees of freedom ('df=Inf', the default), correspond to the
multivariate normal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>critV</code></td>
<td>

<p>Supply a pre-calculated critical value. If this argument is NULL, no
critical value will be calculated and the test decision is based on
the p-values. If ‘<span class="samp">⁠critV = TRUE⁠</span>’ the critical value will be calculated. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>doseType, Delta, p</code></td>
<td>

<p>‘<span class="samp">⁠doseType⁠</span>’ determines the dose to estimate, ED or TD (see also
<code>Mods</code>), and ‘<span class="samp">⁠Delta⁠</span>’ and ‘<span class="samp">⁠p⁠</span>’ need to be
specified depending on whether TD or ED is to be estimated.
See <code>TD</code> and <code>ED</code> for details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pVal</code></td>
<td>

<p>Logical determining, whether p-values should be calculated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>

<p>Character determining the alternative for the multiple contrast
trend test. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>

<p>A function which indicates what should happen when
the data contain NAs.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mvtcontrol</code></td>
<td>

<p>A list specifying additional control parameters for the ‘<span class="samp">⁠qmvt⁠</span>’
and ‘<span class="samp">⁠pmvt⁠</span>’ calls in the code, see also <code>mvtnorm.control</code>
for details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bnds</code></td>
<td>

<p>Bounds for non-linear parameters. This needs to be a list with list
entries corresponding to the selected bounds. The names of the list
entries need to correspond to the model names. The
<code>defBnds</code> function provides the default selection.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>

<p>Control list for the optimization.<br>
A list with entries: "nlminbcontrol", "optimizetol" and "gridSize".
</p>
<p>The entry nlminbcontrol needs to be a list and is passed directly to
control argument in the nlminb function, that is used internally for
models with 2 nonlinear parameters (e.g. sigmoid Emax or beta model).
</p>
<p>The entry optimizetol is passed directly to the tol argument of the
optimize function, which is used for models with 1 nonlinear
parameters (e.g. Emax or exponential model).
</p>
<p>The entry gridSize needs to be a list with entries dim1 and dim2
giving the size of the grid for the gridsearch in 1d or 2d models.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>Either a numeric vector of the same length as dose and resp, or
a character vector denoting the column name in the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to be passed to <code>glm</code> or <code>glm.nb</code>.
This is especially useful when a fitting error is returned. In these cases,
it may be useful to supply a <code>start</code> vector for the parameters.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function works by first fitting a glm with the chosen family and link.
The <code class="reqn">\mu</code> vector and <code class="reqn">S</code> matrix are extracted from the glm, and these
values are supplied to the MCPMod function, along with all user-defined
arguments. <br> Currently, the function can take the negative binomial and
Poisson family with a log, sqrt, identity, risk ratio, and log risk ratio
links, or a bernoulli family with a log, logit, probit, cauchit,
cloglog-link, identity, risk ratio, and log risk ratio links.
</p>


<h3>Value</h3>

<p>An object of class MCPMod if 'returnS = FALSE'. Otherwise, a list
containing an object of class MCPMod, the numeric vector <code class="reqn">\mu</code>, and the
numeric matrix <code class="reqn">S</code>.
</p>


<h3>References</h3>

<p>Buckland, S. T., Burnham, K. P. and Augustin, N. H. (1997). Model
selection an integral part of inference, <em>Biometrics</em>, <b>53</b>,
603–618
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Analyze the binary migraine data from the DoseFinding package.
data(migraine)
models = Mods(linear = NULL, emax = 1, quadratic = c(-0.004), doses = migraine$dose)

# Now analyze using binomial weights
PFrate &lt;- migraine$painfree/migraine$ntrt
migraine$pfrat = migraine$painfree / migraine$ntrt
MCPModGen("binomial","logit",returnS = TRUE, w = "ntrt", dose = "dose",
   resp = "pfrat", data = migraine, models = models, selModel = "aveAIC",
   Delta = 0.2)
</code></pre>


</div>