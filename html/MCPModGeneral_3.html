<div class="container">

<table style="width: 100%;"><tr>
<td>MCPModGeneral-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
A Supplement to the <code>DoseFinding</code> Package for the General Case
</h2>

<h3>Description</h3>

<p>Analyzes non-normal data via the Multiple Comparison Procedures and Modeling approach ('MCP-Mod'). Many functions rely on the 'DoseFinding' package. This package makes it so the user does not need to prespecify or calculate the <code class="reqn">\mu</code> vector and <code class="reqn">S</code> matrix. Instead, the user typically supplies the data in its raw form, and this package will calculate the needed objects and pass them into the ‘DoseFinding' functions. If the user wishes to primarily use the functions provided in the 'DoseFinding' package, a singular function ('prepareGen') will provide mu and S. The package currently handles power analysis and the ’MCP-Mod' procedure for negative binomial, Poisson, and binomial data. The 'MCP-Mod' procedure can also be applied to survival data, but power analysis is not available.
</p>


<h3>Details</h3>


<table>
<tr>
<td style="text-align: left;">
    Package: </td>
<td style="text-align: left;"> MCPModGeneral</td>
</tr>
<tr>
<td style="text-align: left;">
    Type: </td>
<td style="text-align: left;"> Package</td>
</tr>
<tr>
<td style="text-align: left;">
    Version: </td>
<td style="text-align: left;"> 0.1-1 </td>
</tr>
<tr>
<td style="text-align: left;">
    Date: </td>
<td style="text-align: left;"> 2020-2-9</td>
</tr>
<tr>
<td style="text-align: left;">
    License: </td>
<td style="text-align: left;"> GPL-3
  </td>
</tr>
</table>
<p>The main functions are:<br><b><code>prepareGen</code></b>: Calculates the <code class="reqn">\mu</code> vector and <code class="reqn">S</code> matrix to be supplied to regular <code>MCPMod</code> functions (e.g. <code>MCPMod</code>, <code>MCTtest</code>, <code>planMod</code>)<br><b><code>MCPModGen</code></b>: Implements the full <code>MCPMod</code> procedure for raw negative binomial and binary data.<br><b><code>planModPrepare</code></b>: Calculate the theoretical covariance matrix <code class="reqn">S</code>.<br><b><code>powMCTGen</code></b>: Calculates the power of the multiple contrast test.<br><b><code>sampSizeMCTGen</code></b>: Calculates the sample size needed to reach the target power.<br></p>
<p>The secondary functions are:<br><b><code>MCPModSurv</code></b>: Implements the full <code>MCPMod</code> procedure for basic survival data. This includes a Cox-PH model and parametric survival regression models. Power analysis is not available for the survival data.<br><b><code>simS</code></b>: A simulation based method for estimating the theoretical covariance matrices.
</p>


<h3>Author(s)</h3>

<p>Ian Laga
</p>
<p>Maintainer: Ian Laga &lt;ilaga25@gmail.com&gt;
</p>


<h3>References</h3>

<p>Pinheiro, J. C., Bornkamp, B., Glimm, E. and Bretz, F. (2014)
Model-based dose finding under model uncertainty using general
parametric models, <em>Statistics in Medicine</em>, <b>33</b>,
1646–1661
</p>
<p>Buckland, S. T., Burnham, K. P. and Augustin, N. H. (1997). Model selection an integral part
of inference, <em>Biometrics</em>, <b>53</b>, 603–618
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Analyze the binary migraine data from the DoseFinding package.
  data(migraine)
  models = Mods(linear = NULL, emax = 1, quadratic = c(-0.004),
                doses = migraine$dose)

  powMCTGen(migraine$ntrt, "binomial", "logit",
            Ntype = "actual", altModels = models)
  sampSizeMCTGen("binomial", "logit", altModels = models, power = 0.8,
                 Ntype = "arm", upperN = 30, verbose = TRUE)

  # Now analyze using binomial weights
  PFrate &lt;- migraine$painfree/migraine$ntrt
  migraine$pfrat = migraine$painfree / migraine$ntrt
  MCPModGen("binomial","logit",returnS = TRUE, w = "ntrt", dose = "dose",
     resp = "pfrat", data = migraine, models = models, selModel = "aveAIC",
     Delta = 0.2)
</code></pre>


</div>