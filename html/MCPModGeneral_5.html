<div class="container">

<table style="width: 100%;"><tr>
<td>planModPrepare</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Return the S Matrix for a Theoretical DR-Curve</h2>

<h3>Description</h3>

<p>This function is useful for several <code>DoseFinding</code> functions, but
particular for <code>planMod</code>. Given the true dose-response curve at
specified doses, this function will calculate and return the S matrix
associated with the specified distribution. If an object of class <code>Mods</code>
is provided in the <code>models</code> argument, then a list of S matrices will be
returned.
</p>


<h3>Usage</h3>

<pre><code class="language-R">planModPrepare(
  nSample,
  family = c("negative binomial", "binomial", "poisson"),
  link = c("log", "logit", "sqrt", "probit", "cauchit", "cloglog", "identity",
    "risk ratio", "log risk ratio"),
  modelPar = NULL,
  theoResp = NULL,
  doses = NULL,
  Ntype = c("arm", "total", "actual"),
  alRatio = NULL,
  placEff = NULL,
  models = NULL,
  verbose = FALSE,
  offset = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nSample</code></td>
<td>
<p>An integer if <code>Ntype</code> is 'arm' or 'total', or a numerical
vector of patient allocations for each arm if <code>Ntype</code> is 'actual'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>A character string containing the error distribution to be used
in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>A character string for the model link function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelPar</code></td>
<td>
<p>A numeric vector containing the additional parameters for the
family argument. If the family is negative binomial, the dispersion
parameter should be supplied. If the family is binomial, no model parameter
should be supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theoResp</code></td>
<td>
<p>A numerical vector of theoretical response values, on the
transformed scale (e.g. on the log-scale for the negative binomial family).
This should be the same length as the doses argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>doses</code></td>
<td>
<p>A numerical vector of doses, corresponding to the theoretical
response values provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ntype</code></td>
<td>
<p>One of 'arm', 'total', or 'actual'. See documentation for
<code>Ntype</code> in <code>powMCT</code> for descriptions
of 'arm' and 'total'. For 'actual', the nSample should be a numerical
vector containing the actual patient allocation for each dose provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alRatio</code></td>
<td>
<p>A numeric vector specifying the ratios between the patient
allocation for the specified doses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>placEff</code></td>
<td>
<p>A numeric value of the placebo effect. This is needed only
when the link is risk ratio.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>models</code></td>
<td>
<p>Instead of supplying a theoretical dose-response curve and
doses, an object of class <code>Mods</code> may be provided. The doses will be
pulled from this object, along with the responses at the doses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A logical specifying whether the patient allocation should be
printed, in addition to the results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>A positive numeric value specifying the offset term for the
negative binomial distribution. If offset = NULL (the default), then the
offset has no effect. Theoretically, the offset should be a numeric vector
the same length as the number of observations, but for planning purposes,
it is unlikely to know the individual offsets in advance.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A numeric S matrix, or a list S matrices, for each model is
<code>models</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">dose.vec = c(0, 5, 10, 20, 30, 40)
models.full = Mods(doses = dose.vec, linear = NULL,
      sigEmax = rbind(c(9, 2), c(6, 3)),
      emax = 0.8,
      quadratic = -0.02,
      placEff = 0, maxEff = 2)
planModPrepare(30, 'negative binomial', 'log', 0.3, getResp(models.full)[,3],
      dose.vec, 'arm')
</code></pre>


</div>