<div class="container">

<table style="width: 100%;"><tr>
<td>simS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Covariance Matrix Simulation</h2>

<h3>Description</h3>

<p>For non-canonical links, simulating the covariance matrix is sometimes the
easiest way to get an estimate of the covariance matrix. Even for the
canonical links, simulating the covariance matrix may be desirable, as
theoretical covariance matrices are based off of asymptotic properties which
may not hold for small sample sizes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simS(
  doses,
  resp,
  nSample,
  Ntype = c("arm", "total", "actual"),
  nSim = 1000,
  alRatio = NULL,
  family,
  link,
  modelPar = NULL,
  placEff = NULL,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>doses</code></td>
<td>
<p>A numerical vector of doses, corresponding to the theoretical
response values provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resp</code></td>
<td>
<p>A numeric vector of response values corresponding to the doses.
This should be on the link scale (e.g. <code>resp</code> should be on the
log-scale if using the log-link).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nSample</code></td>
<td>
<p>An integer if <code>Ntype</code> is "arm" or "total", or a numerical
vector of patient allocations for each arm if <code>Ntype</code> is "actual".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ntype</code></td>
<td>
<p>One of "arm", "total", or 'actual". See documentation for
<code>Ntype</code> in <code>powMCT</code> for descriptions
of "arm" and 'total". For "actual", the nSample should be a numerical
vector containing the actual patient allocation for each dose provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nSim</code></td>
<td>
<p>An integer specifying the number of simulations used to estimate
the covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alRatio</code></td>
<td>
<p>Vector describing the relative patient allocations to the dose
groups up to proportionality, e.g. <code>rep(1, length(doses))</code> corresponds
to balanced allocations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>A character string containing the error distribution to be used
in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>A character string specifying the link to be using when modeling
the glm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelPar</code></td>
<td>
<p>A numeric vector containing the additional parameters for the
family argument. If the family is negative binomial, the dispersion
parameter should be supplied. If the family is binomial, no model parameter
should be supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>placEff</code></td>
<td>
<p>A numeric value specifying the mean response at the placebo
This is required if <code>link</code> = "risk ratio" or "log risk ratio" and
ignored otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A logical specifying whether the patient allocation should be
printed, in addition to the results.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Numeric containing the estimated covariance matrix.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(migraine)
models = Mods(linear = NULL, emax = 1, quadratic = c(-0.004), doses = migraine$dose)
simS(migraine$dose, getResp(models)[,1], 30, "arm", 10, family = "binomial",
     link = "logit", verbose = TRUE)
</code></pre>


</div>