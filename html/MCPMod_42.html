<div class="container">

<table style="width: 100%;"><tr>
<td>powCalc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Calculate the power for the multiple contrast test </h2>

<h3>Description</h3>

<p>Given the optimal contrasts, the sample size and a certain ‘alternative’ (i.e. a mean vector and sigma), the
function calculates the power to detect this alternative. See Pinheiro et al. (2006) for details.
The function is the building block for the functions <code>powerMM</code>, <code>sampSize</code> and <code>LP</code>.
Numerical integration routines from the <code>mvtnorm</code> package are used to calculate the underlying
multivariate integrals.
</p>


<h3>Usage</h3>

<pre><code class="language-R">powCalc(cMat, n, alpha = 0.025, delta = NULL, mu = NULL,
        sigma = NULL, cVal = NULL, corMat = NULL,
        twoSide = FALSE, control = mvtnorm.control())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cMat</code></td>
<td>
<p> Matrix with the contrasts in the columns </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p> Numeric vector of sample sizes per group. In case just one number
is specified, it is assumed that all group sample sizes are equal to 
this number</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p> Level of significance (defaults to 0.025)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p> Non-centrality vector of the distribution of the test statistic
under the alternative. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p> Mean vector under the alternative. The function then calculates the
non-centrality vector itself. Ignored if <code>delta</code> is specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p> Expected standard deviation of the response. Only necessary if
the non-centrality vector is to be calculated by the function (i.e.
if <code>delta</code> is NULL). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cVal</code></td>
<td>
<p> Optional numeric vector giving the critical value, if specified
the argument <code>alpha</code> is ignored. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corMat</code></td>
<td>
<p> An optional matrix giving the correlations of the contrasts
specified in <code>cMat</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>twoSide</code></td>
<td>
<p> Logical indicating whether a two sided or a one sided
test should be performed (defaults to one-sided) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p> A list of options for the <code>pmvt</code> and <code>qmvt</code> functions
as produced by <code>mvtnorm.control</code>. </p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function returns the power value.
</p>


<h3>References</h3>

 
<p>Pinheiro, J. C., Bornkamp, B. and Bretz, F. (2006). Design and analysis of dose finding studies
combining multiple comparisons and modeling procedures, <em>Journal of Biopharmaceutical
Statistics</em>, <b>16</b>, 639–656
</p>


<h3>See Also</h3>

 <p><code>planMM</code>, <code>LP</code>,  <code>sampSize</code>,  <code>powerMM</code></p>


<h3>Examples</h3>

<pre><code class="language-R">doses &lt;- c(0,10,25,50,100,150)
models &lt;- list(linear = NULL, emax = c(25),
               logistic = c(50, 10.88111), exponential=c(85),
               betaMod=matrix(c(0.33,2.31,1.39,1.39), byrow=TRUE, nrow=2))

# calculate optimal contrasts and critical value 
plMM &lt;- planMM(models, doses, 50, scal = 200, alpha = 0.05)

# calculate mean vectors
compMod &lt;- fullMod(models, doses, base = 0, maxEff = 0.4, scal = 200)
muMat &lt;- modelMeans(compMod, doses, FALSE, scal = 200)

# calculate power to detect mean vectors
# Power for linear model 
powCalc(plMM$contMat, 50, mu = muMat[,1], sigma = 1, cVal = plMM$critVal)
# Power for emax model  
powCalc(plMM$contMat, 50, mu = muMat[,2], sigma = 1, cVal = plMM$critVal)
# Power for logistic model
powCalc(plMM$contMat, 50, mu = muMat[,3], sigma = 1, cVal = plMM$critVal)
# compare with JBS 16, p. 650
</code></pre>


</div>