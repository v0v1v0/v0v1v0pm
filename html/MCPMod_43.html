<div class="container">

<table style="width: 100%;"><tr>
<td>powerMM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Calculate power for different sample sizes </h2>

<h3>Description</h3>

<p>Calculates the power under the assumed candidate set for
different sample sizes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">powerMM(models, doses, base, maxEff, sigma, lower, upper, step,
        sumFct = c("min", "mean", "max"), off = 0.1 * max(doses),
        scal = 1.2 * max(doses), alpha = 0.025, twoSide = FALSE,
        control = mvtnorm.control(), muMat = NULL, alRatio = NULL,
        typeN = c("arm", "total"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>models</code></td>
<td>
<p> A list specifying the candidate models. This
can also be a fullMod object, then the arguments <code>base</code>, 
<code>maxEff</code>, <code>off</code> and <code>scal</code> are ignored. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>doses</code></td>
<td>
<p> Dose levels to be administered </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base</code></td>
<td>
<p> Expected baseline effect </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxEff</code></td>
<td>
<p> Expected maximum change from baseline </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p> Expected standard deviation </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower, upper</code></td>
<td>
<p>  Maximum and minimum group sample size for
which the power is calculated. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step</code></td>
<td>
<p> Stepsize for the sample size at which the power is calculated.
It is calculated at <code>seq(lower,upper,by=step)</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sumFct</code></td>
<td>
<p> A character vector giving the names of the summary functions used to combine the power values 
into one value. By default the minimum, the mean and the maximum are used. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>off</code></td>
<td>
<p> Offset parameter for the linear in log model (default 10 perc. of maximum dose). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scal</code></td>
<td>
<p> Scale parameter for the beta model (default 20 perc. larger than maximum dose).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p> Level of significance (default: 0.025)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>twoSide</code></td>
<td>
<p> Logical indicating whether a two sided or a one-sided
test should be performed. By default FALSE, so one-sided testing. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p> A list of options for the <code>pmvt</code> and <code>qmvt</code> functions
as produced by <code>mvtnorm.control</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>muMat</code></td>
<td>
<p> An optional matrix with means in the columns, dimnames should
be given (dose levels and names of contrasts), if specified the
the <code>models</code> argument should not be specified, see examples
below. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alRatio</code></td>
<td>
<p> Vector describing the relative patient allocations to the dose
groups. See examples below, e.g. c(1,2,2) corresponds to allocating
twice as many patients in dose groups two and three. Per default
balanced allocations are assumed. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>typeN</code></td>
<td>
<p> One of "arm" or "total". Determines, whether the sample size in the
smallest arm or the total sample size is iterated in bisection
search algorithm. See examples below. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> Possible additional arguments for sumFct. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given the candidate set of models and associated guesstimates the 
function calculates the power to detect every model in the candidate set
for different group sample sizes. 
Additionally summary functions can be specified to calculate the
combined power (by default the minimum, mean and maximum).
The location and scale parameters are determined by forcing 
the model function to go through (0,base) and (dmax,maxEff), see 
Pinheiro et al. (2006) for details. 
There exists a plot method for the output of the powerMM function. See the examples below.
</p>


<h3>Value</h3>

<p>A <code>powerMM</code> object, i.e. a matrix containing the power values for different sample sizes and models
</p>


<h3>References</h3>

 
<p>Bornkamp B., Pinheiro J. C., and Bretz, F. (2009). MCPMod: An            
R Package for the Design and Analysis of Dose-Finding        
Studies, <em>Journal of Statistical Software</em>, <b>29</b>(7), 1–23
</p>
<p>Pinheiro, J. C., Bornkamp, B. and Bretz, F. (2006). Design and analysis of dose finding studies
combining multiple comparisons and modeling procedures, <em>Journal of Biopharmaceutical
Statistics</em>, <b>16</b>, 639–656
</p>


<h3>See Also</h3>

 <p><code>plot.powerMM</code>,  <code>powCalc</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
doses &lt;- c(0,10,25,50,100,150)                                         
models &lt;- list(linear = NULL, emax = 25,                               
               logistic = c(50, 10.88111), exponential= 85,            
               betaMod=matrix(c(0.33,2.31,1.39,1.39), byrow=TRUE, nrow=2))
pM &lt;- powerMM(models, doses, base = 0, maxEff = 0.4, sigma = 1,
            alpha = 0.05, lower = 10, upper = 100, step = 20, scal = 200)         
pM
# a graphical display provides plot method
plot(pM)                                
# reproduces plot in JBS 16, p.651      
plot(pM, line.at = 0.8, models = "none")


# the same with fullMod object and default alpha
fMod &lt;- fullMod(models, doses, base = 0, maxEff = 0.4, scal=200) 
pM &lt;- powerMM(fMod, sigma = 1, lower = 10, upper = 100, 
              step = 20, scal = 200)         
pM

# using unbalanced (but fixed) allocations
pM &lt;- powerMM(models, doses, base = 0, maxEff = 0.4, sigma = 1,       
               lower = 10, upper = 100, step = 20, scal = 200,
               alRatio = c(3, 2, 2, 1, 1, 1), typeN = "arm") 
plot(pM, summ = "mean")

# example, where means are directly specified
# doses   
dvec &lt;- c(0, 10, 50, 100)
# mean vectors
mu1 &lt;- c(1, 2, 2, 2)
mu2 &lt;- c(1, 1, 2, 2)
mu3 &lt;- c(1, 1, 1, 2)
mMat &lt;- cbind(mu1, mu2, mu3)
dimnames(mMat)[[1]] &lt;- dvec
pM &lt;- powerMM(muMat = mMat, doses = dvec, sigma = 2, lower = 10,
              upper = 100, step = 20)         
pM

## End(Not run)
</code></pre>


</div>