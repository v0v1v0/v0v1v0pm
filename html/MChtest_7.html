<div class="container">

<table style="width: 100%;"><tr>
<td>MCbound</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create Monte Carlo stopping boundary</h2>

<h3>Description</h3>

<p>Creates one of several different types of Monte Carlo stopping boundaries
</p>


<h3>Usage</h3>

<pre><code class="language-R">MCbound(type, parms, conf.level = 0.99)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>a character vector of type of boundary, possible values: "fixed", "tsprt","Bvalue", and "BC"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parms</code></td>
<td>
<p>a numeric vector of parameter values, different for each type (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>confidence level for intervals about Monte Carlo p-values</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Create Monte Carlo stopping boundaries for use with <code>MCtest</code>, where we keep resampling until hitting 
the stopping boundary. There are several possible types, each with a different length parameter vector. 
</p>

<table>
<tr>
<td style="text-align: left;">
type="fixed"  </td>
<td style="text-align: left;"> then names(parms)=c("Nmax") </td>
</tr>
<tr>
<td style="text-align: left;">
type="tsprt"  </td>
<td style="text-align: left;"> then names(parms)=c("p0","p1","A","B","Nmax") </td>
</tr>
<tr>
<td style="text-align: left;">
              </td>
<td style="text-align: left;">  or  names(parms)=c("p0","p1","alpha0","beta0","Nmax") </td>
</tr>
<tr>
<td style="text-align: left;">
type="Bvalue"  </td>
<td style="text-align: left;"> then names(parms)=c("Nmax","alpha","e0","e1") </td>
</tr>
<tr>
<td style="text-align: left;"> 
type="BC"      </td>
<td style="text-align: left;"> then names(parms)=c("Nmax","Smax") </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>The object parms should be a named vector, although unnamed vectors will work if the parameters are in the above order 
(for the tsprt it assumes the first parameterization). For type="fixed" we keep reampling until N=Nmax resamples. 
For type="tsprt" we keep resampling until stopping for a truncated sequential probability ratio test for  a 
binary parmaeter. The parameterizations are the usual Wald notation, except alpha0=alpha and beta0=beta, where 
A=(1-beta0)/alpha0 and B=beta0/(1-alpha0). The Bvalue is a test that p=alpha or not and we stop if the B-value
at information time t, B(t), is B(t)<code class="reqn">&lt;=</code> qnorm(e0) or B <code class="reqn">&gt;=</code>qnorm(1-e1). Note that the B-value stopping boundary is 
just a reparameterization of the truncated sequential probability ratio test. For type="BC" we keep resampling 
until N=Nmax or S=Smax following a design recommended by Besag and Clifford (1991). For each stopping boundary 
we calculate valid p-values at each stopping point ordering by S/N. For details see Fay, Kim and Hachey, 2006. 
</p>


<h3>Value</h3>

<p> An object of class MCbound.
A list with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>number of sucesses at points on the boundary</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>number of resamples at points on the boundary</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>valid p-value at each point on boundary, calculated using ordering by S/N</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.lower</code></td>
<td>
<p>lower confidence limit of p-value at each boundary point</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.upper</code></td>
<td>
<p>upper confidence limit of p-value at each boundary point</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Kstar</code></td>
<td>
<p>number of ways to reach each point, (S,N), on boundary times beta(S+1,N-S+1) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>confidence level for intervals on p-values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of boundary: either "fixed", "tsprt", "Bvalue" or "BC"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parms</code></td>
<td>
<p>parameter vector that defines boundary (see details) </p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Michael P. Fay</p>


<h3>References</h3>

<p>Besag, J. and Clifford, P. (1991). Sequential Monte Carlo p-values. Biometrika. 78: 301-304.
</p>
<p>Fay, M.P., Kim, H-J. and Hachey, M. (2007). Using truncated sequential probability ratio test boundaries 
for Monte Carlo implementation of hypothesis tests. Journal of Computational and Graphical 
Statistics. 16(4):946-967. 
</p>


<h3>Examples</h3>

<pre><code class="language-R">MCbound("tsprt",c(alpha0=.001,beta0=.01,Nmax=99,p0=.06,p1=.04))
</code></pre>


</div>