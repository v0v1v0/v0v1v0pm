<div class="container">

<table style="width: 100%;"><tr>
<td>mddc_boxplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Modified Detecting Deviating Cells (MDDC) algorithm for adverse event signal
identification with boxplot method for cutoff selection.</h2>

<h3>Description</h3>

<p>Modified Detecting Deviating Cells (MDDC) algorithm for adverse
event signal identification. Boxplot method is used for cutoff selection in
step 2 of the algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mddc_boxplot(
  contin_table,
  col_specific_cutoff = TRUE,
  separate = TRUE,
  if_col_cor = FALSE,
  cor_lim = 0.8,
  coef = 1.5,
  num_cores = 2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>contin_table</code></td>
<td>
<p>A data matrix of an <code class="reqn">I</code> x <code class="reqn">J</code> contingency table
with row (adverse event) and column (drug or vaccine) names. Please first
check the input contingency table using the function
<code>check_and_fix_contin_table()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_specific_cutoff</code></td>
<td>
<p>Logical. In the second step of the algorithm,
whether to apply boxplot method to the standardized Pearson residuals of
the entire table, or within each drug or vaccine column.
Default is <code>TRUE</code>, that is within each drug or vaccine column
(column specific cutoff). <code>FALSE</code> indicates
applying boxplot method on residuals of the entire table.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>separate</code></td>
<td>
<p>Logical. In the second step of the algorithm, whether to
separate the standardized Pearson residuals for the zero cells and non zero
cells and apply boxplot method separately or together.
Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>if_col_cor</code></td>
<td>
<p>Logical. In the third step of the algorithm, whether to use
column (drug or vaccine) correlation or row (adverse event) correlation.
Default is <code>FALSE</code>, that is using the adverse event correlation.
<code>TRUE</code> indicates using drug or vaccine correlation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor_lim</code></td>
<td>
<p>A numeric value between (0, 1). In the third step,
what correlation threshold should be used to select “connected”
adverse events. Default is 0.8.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>
<p>A numeric value or a list of numeric values. If a single numeric
value is provided, it will be applied uniformly across all columns of the
contingency table. If a list is provided, its length must match the number
of columns in the contingency table, and each value will be used as the
coefficient for the corresponding column.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_cores</code></td>
<td>
<p>Number of cores used to parallelize the MDDC
Boxplot algorithm. Default is 2.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li> <p><code>boxplot_signal</code> returns the signals identified in the
second step.
1 indicates signals, 0 for non signal.
</p>
</li>
<li> <p><code>corr_signal_pval</code> returns the p values for each cell in the
contingency table in the fifth step, when the <code class="reqn">r_{ij}</code> values are mapped
back to the standard normal distribution.
</p>
</li>
<li> <p><code>corr_signal_adj_pval</code> returns the Benjamini-Hochberg adjusted
p values for each cell in the fifth step. We leave here an option for the
user to decide whether to use <code>corr_signal_pval</code> or
<code>corr_signal_adj_pval</code>, and what threshold for p values should be
used (for example, 0.05). Please see the example below.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>find_optimal_coef</code> for finding an optimal value of
<code>coef</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># using statin49 data set as an example
data(statin49)

# apply the mddc_boxplot
boxplot_res &lt;- mddc_boxplot(statin49)

# signals identified in step 2 using boxplot method
signal_step2 &lt;- boxplot_res$boxplot_signal

# signals identified in step 5 by considering AE correlations
# In this example, cells with p values less than 0.05 are
# identified as signals
signal_step5 &lt;- (boxplot_res$corr_signal_pval &lt; 0.05) * 1

</code></pre>


</div>