<div class="container">

<table style="width: 100%;"><tr>
<td>mddc_mc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Modified Detecting Deviating Cells (MDDC) algorithm for adverse event signal
identification with Monte Carlo (MC) method for cutoff selection.</h2>

<h3>Description</h3>

<p>Modified Detecting Deviating Cells (MDDC) algorithm for adverse
event signal identification. Monte Carlo (MC) method is used for cutoff
selection in the second step of the algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mddc_mc(
  contin_table,
  quantile = 0.95,
  rep = 10000,
  exclude_same_drug_class = TRUE,
  col_specific_cutoff = TRUE,
  separate = TRUE,
  if_col_cor = FALSE,
  cor_lim = 0.8,
  num_cores = 2,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>contin_table</code></td>
<td>
<p>A data matrix of an <code class="reqn">I</code> x <code class="reqn">J</code> contingency table
with row (adverse event) and column (drug or vaccine) names.
Please first check the input contingency table using the function
<code>check_and_fix_contin_table()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantile</code></td>
<td>
<p>In the second step of the algorithm, the quantile of the null
distribution obtained via MC method to use as a threshold for identifying
cells with high value of the standardized Pearson residuals. Default is 0.95.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rep</code></td>
<td>
<p>In the second step, the number of Monte Carlo replications in the
MC method. Default is 10000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude_same_drug_class</code></td>
<td>
<p>In the second step, when applying Fisher's
exact test to cells with a count less than six, a 2 by 2 contingency table
needs to be constructed. Does the construction need to exclude other drugs
or vaccines in the same class as the drug or vaccine of interest?
Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_specific_cutoff</code></td>
<td>
<p>Logical. In the second step of the algorithm,
whether to apply MC method to the standardized Pearson residuals
of the entire table, or within each drug or vaccine column.
Default is <code>TRUE</code>, that is within each drug or vaccine
column (column specific cutoff). <code>FALSE</code> indicates applying MC method
on residuals of the entire table.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>separate</code></td>
<td>
<p>Logical. In the second step of the algorithm, whether to
separate the standardized Pearson residuals for the zero cells and non zero
cells and apply MC method separately or together. Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>if_col_cor</code></td>
<td>
<p>Logical. In the third step of the algorithm, whether to use
column (drug or vaccine) correlation or row (adverse event) correlation.
Default is <code>FALSE</code>, that is using the adverse event correlation.
<code>TRUE</code> indicates using drug or vaccine correlation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor_lim</code></td>
<td>
<p>A numeric value between (0, 1).
In the third step, what correlation threshold should be used to
select “connected” adverse events. Default is 0.8.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_cores</code></td>
<td>
<p>Number of cores used to parallelize the
MDDC MC algorithm. Default is 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>An optional integer to set the seed for reproducibility.
If NULL, no seed is set.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li> <p><code>mc_pval</code> returns the p values for each cell in the second step.
For cells with a count greater than five, the p values are obtained
via MC method. For cells with a count less than or equal to five,
the p values are obtained via Fisher's exact tests.
</p>
</li>
<li> <p><code>mc_signal</code> returns the signals with a count greater than five and
identified in the second step by MC method. 1 indicates signals, 0 for non
signal.
</p>
</li>
<li> <p><code>fisher_signal</code> returns the signals with a count
less than or equal to five and identified in the second step by
Fisher's exact tests. 1 indicates signals, 0 for non signal.
</p>
</li>
<li> <p><code>corr_signal_pval</code> returns the p values for each cell in the
contingency table in the fifth step, when the <code class="reqn">r_{ij}</code> values are mapped
back to the standard normal distribution.
</p>
</li>
<li> <p><code>corr_signal_adj_pval</code> returns the Benjamini-Hochberg adjusted p
values for each cell in the fifth step. We leave here an option for the user
to decide whether to use <code>corr_signal_pval</code> or
<code>corr_signal_adj_pval</code>, and what threshold for p values should be used
(for example, 0.05). Please see the example below.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R"># using statin49 data set as an example
data(statin49)

# apply the mddc_mc
mc_res &lt;- mddc_boxplot(statin49)

# signals identified in step 2 using MC method
signal_step2 &lt;- mc_res$mc_signal

# signals identified in step 5 by considering AE correlations
# In this example, cells with p values less than 0.05 are
# identified as signals
signal_step5 &lt;- (mc_res$corr_signal_pval &lt; 0.05) * 1
</code></pre>


</div>