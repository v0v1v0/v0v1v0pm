<div class="container">

<table style="width: 100%;"><tr>
<td>mdp_finite_horizon</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Solves finite-horizon MDP using backwards induction algorithm
</h2>

<h3>Description</h3>

<p>Solves finite-horizon MDP with backwards induction algorithm
</p>


<h3>Usage</h3>

<pre><code class="language-R">mdp_finite_horizon(P, R, discount, N, h)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>

<p>transition probability array. P can be a 3 dimensions array [S,S,A] or a list [[A]], each element containing a sparse matrix [S,S].
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>

<p>reward array. R can be a 3 dimensions array [S,S,A] or a list [[A]], each element containing a sparse matrix [S,S] or a 2 dimensional matrix [S,A] possibly sparse.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>discount</code></td>
<td>

<p>discount factor. discount is a real number which belongs to [0; 1[.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>

<p>number of stages. N is an integer greater than 0.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>(optional) terminal reward. h is a S length vector. By default, h = numeric(S).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>mdp_finite_horizon applies backwards induction algorithm for finite-horizon MDP. The optimality equations allow to recursively evaluate function values starting from the terminal stage. This function uses verbose and silent modes. In verbose mode, the function displays the current stage and the corresponding optimal policy.
</p>


<h3>Value</h3>



<table>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>value fonction. V is a [S,(N+1)] matrix. Each column n is the optimal value fonction at stage n, with n = 1, ... N. V[,N+1] is the terminal reward.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>policy</code></td>
<td>
<p>optimal policy. policy is a [S,N] matrix. Each element is an integer correspond- ing to an action and each column n is the optimal policy at stage n.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cpu_time</code></td>
<td>
<p>CPU time used to run the program</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">
# With a non-sparse matrix
P &lt;- array(0, c(2,2,2))
P[,,1] &lt;- matrix(c(0.5, 0.5, 0.8, 0.2), 2, 2, byrow=TRUE)
P[,,2] &lt;- matrix(c(0, 1, 0.1, 0.9), 2, 2, byrow=TRUE)
R &lt;- matrix(c(5, 10, -1, 2), 2, 2, byrow=TRUE)
mdp_finite_horizon(P, R, 0.9, 3)

# With a sparse matrix
P &lt;- list()
P[[1]] &lt;- Matrix(c(0.5, 0.5, 0.8, 0.2), 2, 2, byrow=TRUE, sparse=TRUE)
P[[2]] &lt;- Matrix(c(0, 1, 0.1, 0.9), 2, 2, byrow=TRUE, sparse=TRUE)
mdp_finite_horizon(P, R, 0.9, 3)
</code></pre>


</div>