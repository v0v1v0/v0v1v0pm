<div class="container">

<table style="width: 100%;"><tr>
<td>mdp_Q_learning</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Solves discounted MDP using the Q-learning algorithm (Reinforcement Learning)
</h2>

<h3>Description</h3>

<p>Solves discounted MDP with the Q-learning algorithm (Reinforcement learning)
</p>


<h3>Usage</h3>

<pre><code class="language-R">mdp_Q_learning(P, R, discount, N)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>

<p>transition probability array. P can be a 3 dimensions array [S,S,A] or a list [[A]], each element containing a sparse matrix [S,S].
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>

<p>reward array. R can be a 3 dimensions array [S,S,A] or a list [[A]], each element containing a sparse matrix [S,S] or a 2 dimensional matrix [S,A] possibly sparse.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>discount</code></td>
<td>

<p>discount factor.
discount is a real which belongs to ]0; 1[
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>

<p>(optional) : number of iterations to perform.
N is an integer that must be greater than the default value.
By default, N is set to 10000.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>mdp_Q_learning computes the Q matrix, the mean discrepancy and gives the optimal value function and the optimal policy when allocated enough iterations. It uses an iterative method.
</p>


<h3>Value</h3>



<table>
<tr style="vertical-align: top;">
<td><code>Q </code></td>
<td>
<p>an action-value function that gives the expected utility of taking a given action in a given state and following an optimal policy thereafter. Q is a [S,A] matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean_discrepancy </code></td>
<td>
<p>discrepancy means over 100 iterations. mean_discrepancy is a vector of V discrepancy mean over 100 iterations. Then the length of the vector for the default value of N is 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V </code></td>
<td>
<p>value function. V is a S length vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>policy </code></td>
<td>
<p>policy. policy is a S length vector. Each element is an integer corresponding to an action which maximizes the value function</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">
# With a non-sparse matrix
P &lt;- array(0, c(2,2,2))
P[,,1] &lt;- matrix(c(0.5, 0.5, 0.8, 0.2), 2, 2, byrow=TRUE)
P[,,2] &lt;- matrix(c(0, 1, 0.1, 0.9), 2, 2, byrow=TRUE)
R &lt;- matrix(c(5, 10, -1, 2), 2, 2, byrow=TRUE)
# Not run
# mdp_Q_learning(P, R, 0.9)

# With a sparse matrix
P &lt;- list()
P[[1]] &lt;- Matrix(c(0.5, 0.5, 0.8, 0.2), 2, 2, byrow=TRUE, sparse=TRUE)
P[[2]] &lt;- Matrix(c(0, 1, 0.1, 0.9), 2, 2, byrow=TRUE, sparse=TRUE)
# Not run
# mdp_Q_learning(P, R, 0.9)

</code></pre>


</div>