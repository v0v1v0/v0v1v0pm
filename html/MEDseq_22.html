<div class="container">

<table style="width: 100%;"><tr>
<td>MEDseq_compare</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Choose the best MEDseq model</h2>

<h3>Description</h3>

<p>Takes one or more sets of <code>"MEDseq"</code> models fitted by <code>MEDseq_fit</code> and ranks them according to a specified model selection criterion. It's possible to respect the internal ranking within each set of models, or to discard models within each set which were already deemed sub-optimal. This function can help with model selection via exhaustive or stepwise searches.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MEDseq_compare(...,
               criterion = c("bic", "icl", "aic", 
                             "dbs", "asw", "cv", "nec"),
               pick = 10L,
               optimal.only = FALSE)

## S3 method for class 'MEDseqCompare'
print(x,
      index = seq_len(x$pick),
      rerank = FALSE,
      digits = 3L,
      maxi = length(index),
      ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>One or more objects of class <code>"MEDseq"</code> outputted by <code>MEDseq_fit</code>. All models must have been fit to the same data set. A single <em>named</em> list of such objects can also be supplied. Additionally, objects of class <code>"MEDseqCompare"</code> outputted by this very function can also be supplied here.
</p>
<p>This argument is only relevant for the <code>MEDseq_compare</code> function and will be ignored for the associated <code>print</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>The criterion used to determine the ranking. Defaults to <code>"bic"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pick</code></td>
<td>
<p>The (integer) number of models to be ranked and compared. Defaults to <code>10L</code>. Will be constrained by the number of models within the <code>"MEDseq"</code> objects supplied via <code>...</code> if <code>optimal.only</code> is <code>FALSE</code>, otherwise constrained simply by the number of <code>"MEDseq"</code> objects supplied. Setting <code>pick=Inf</code> is a valid way to select all models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimal.only</code></td>
<td>
<p>Logical indicating whether to only rank models already deemed optimal within each <code>"MEDeq"</code> object (<code>TRUE</code>), or to allow models which were deemed suboptimal enter the final ranking (<code>FALSE</code>, the default). See <code>Details</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x, index, rerank, digits, maxi</code></td>
<td>
<p>Arguments required for the associated <code>print</code> function:
</p>

<dl>
<dt><code>x</code></dt>
<dd>
<p>An object of class <code>"MEDseqCompare"</code> resulting from a call to <code>MEDseq_compare</code>.</p>
</dd>
<dt><code>index</code></dt>
<dd>
<p>A logical or numeric vector giving the indices of the rows of the table of ranked models to print. This defaults to the full set of ranked models. It can be useful when the table of ranked models is large to examine a subset via this <code>index</code> argument, for display purposes. See <code>rerank</code>.</p>
</dd>
<dt><code>rerank</code></dt>
<dd>
<p>A logical indicating whether the ranks should be recomputed when subsetting using <code>index</code>. Defaults to <code>FALSE</code>.</p>
</dd>
<dt><code>digits</code></dt>
<dd>
<p>The number of decimal places to round model selection criteria to (defaults to <code>3</code>).</p>
</dd>
<dt><code>maxi</code></dt>
<dd>
<p>A number specifying the maximum number of rows/models to print. Defaults to <code>length(index)</code>.</p>
</dd>
</dl>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The purpose of this function is to conduct model selection on <code>"MEDseq"</code> objects, fit to the same data set, with different combinations of gating network covariates or different initialisation settings.
</p>
<p>Model selection will have already been performed in terms of choosing the optimal number of components and MEDseq model type within each supplied set of results, but <code>MEDseq_compare</code> will respect the internal ranking of models when producing the final ranking if <code>optimal.only</code> is <code>FALSE</code>: otherwise only those models already deemed optimal within each <code>"MEDseq"</code> object will be ranked.
</p>
<p>As such if two sets of results are supplied when <code>optimal.only</code> is <code>FALSE</code>, the 1st, 2nd, and 3rd best models could all belong to the first set of results, meaning a model deemed suboptimal according to one set of covariates could be superior to one deemed optimal under another set of covariates.
</p>


<h3>Value</h3>

<p>A list of class <code>"MEDseqCompare"</code>, for which a dedicated print function exists, containing the following elements (each of length <code>pick</code>, and ranked according to <code>criterion</code>, where appropriate):
</p>
<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The name of the data set to which the models were fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimal</code></td>
<td>
<p>The single optimal model (an object of class <code>"MEDseq"</code>) among those supplied, according to the chosen <code>criterion</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pick</code></td>
<td>
<p>The final number of ranked models. May be different (i.e. less than) the supplied <code>pick</code> value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MEDNames</code></td>
<td>
<p>The names of the supplied <code>"MEDseq"</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelNames</code></td>
<td>
<p>The MEDseq model names (denoting the constraints or lack thereof on the precision parameters).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>The optimal numbers of components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>The numbers of estimated parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iters</code></td>
<td>
<p>The numbers of EM/CEM iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bic</code></td>
<td>
<p>BIC values, ranked according to <code>criterion</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>icl</code></td>
<td>
<p>ICL values, ranked according to <code>criterion</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aic</code></td>
<td>
<p>AIC values, ranked according to <code>criterion</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dbs</code></td>
<td>
<p>(Weighted) mean/median DBS values, ranked according to <code>criterion</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asw</code></td>
<td>
<p>(Weighted) mean/median ASW values, ranked according to <code>criterion</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv</code></td>
<td>
<p>Cross-validated log-likelihood values, ranked according to <code>criterion</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nec</code></td>
<td>
<p>NEC values, ranked according to <code>criterion</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>Maximal log-likelihood values, ranked according to <code>criterion</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gating</code></td>
<td>
<p>The gating formulas.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>algo</code></td>
<td>
<p>The algorithm used for fitting the model - either <code>"EM"</code>, <code>"CEM"</code>, <code>"cemEM"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>equalPro</code></td>
<td>
<p>Logical indicating whether mixing proportions were constrained to be equal across components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opti</code></td>
<td>
<p>The method used for estimating the central sequence(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Logical indicating whether the given model was fitted with sampling weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noise</code></td>
<td>
<p>Logical indicating the presence/absence of a noise component. Only displayed if at least one of the compared models has a noise component.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noise.gate</code></td>
<td>
<p>Logical indicating whether gating covariates were allowed to influence the noise component's mixing proportion. Only printed for models with a noise component, when at least one of the compared models has gating covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>equalNoise</code></td>
<td>
<p>Logical indicating whether the mixing proportion of the noise component for <code>equalPro</code> models is also equal (<code>TRUE</code>) or estimated (<code>FALSE</code>).</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The <code>criterion</code> argument here need not comply with the criterion used for model selection within each <code>"MEDseq"</code> object, but be aware that a mismatch in terms of <code>criterion</code> <em>may</em> require the optimal model to be re-fit in order to be extracted, thereby slowing down <code>MEDseq_compare</code>.
</p>
<p>If random starts had been used via <code>init.z="random"</code> the <code>optimal</code> model may not necessarily correspond to the highest-ranking model in the presence of a criterion mismatch, due to the randomness of the initialisation. 
</p>
<p>A dedicated <code>print</code> function exists for objects of class <code>"MEDseqCompare"</code> and <code>plot.MEDseq</code> can also be called on objects of class <code>"MEDseqCompare"</code>.
</p>


<h3>Author(s)</h3>

<p>Keefe Murphy - &lt;<a href="mailto:keefe.murphy@mu.ie">keefe.murphy@mu.ie</a>&gt;
</p>


<h3>References</h3>

<p>Murphy, K., Murphy, T. B., Piccarreta, R., and Gormley, I. C. (2021). Clustering longitudinal life-course sequences using mixtures of exponential-distance models. <em>Journal of the Royal Statistical Society: Series A (Statistics in Society)</em>, 184(4): 1414-1451. &lt;<a href="https://doi.org/10.1111/rssa.12712">doi:10.1111/rssa.12712</a>&gt;.
</p>


<h3>See Also</h3>

<p><code>MEDseq_fit</code>, <code>plot.MEDseq</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(biofam)
seqs &lt;- seqdef(biofam[10:25] + 1L,
               states = c("P", "L", "M", "L+M", "C", 
                          "L+C", "L+M+C", "D"))
covs &lt;- cbind(biofam[2:3], age=2002 - biofam$birthyr)
 
# Fit a range of models
# m1 &lt;- MEDseq_fit(seqs, G=9:10)
# m2 &lt;- MEDseq_fit(seqs, G=9:10, gating=~sex,       covars=covs, noise.gate=FALSE)
# m3 &lt;- MEDseq_fit(seqs, G=9:10, gating=~age,       covars=covs, noise.gate=FALSE)
# m4 &lt;- MEDseq_fit(seqs, G=9:10, gating=~sex + age, covars=covs, noise.gate=FALSE)

# Rank only the optimal models (according to the dbs criterion)
# Examine the best model in more detail
# (comp &lt;- MEDseq_compare(m1, m2, m3, m4, criterion="dbs", optimal.only=TRUE))
# (best &lt;- comp$optimal)
# (summ &lt;- summary(best, parameters=TRUE))

# Examine all models visited, including those already deemed suboptimal
# Only print models with gating covariates &amp; 10 components
# comp2 &lt;- MEDseq_compare(comp, m1, m2, m3, m4, criterion="dbs", pick=Inf)
# print(comp2, index=comp2$gating != "None" &amp; comp2$G == 10)
</code></pre>


</div>