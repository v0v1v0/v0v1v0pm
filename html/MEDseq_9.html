<div class="container">

<table style="width: 100%;"><tr>
<td>MEDseq_clustnames</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Automatic labelling of clusters using central sequences</h2>

<h3>Description</h3>

<p>These functions extract names for clusters according to the SPS representation of their central sequences.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MEDseq_clustnames(x,
                  cluster = TRUE,
                  size = FALSE,
                  weighted = FALSE,
                  ...)

MEDseq_nameclusts(names)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class <code>"MEDseq"</code> generated by <code>MEDseq_fit</code> or an object of class <code>"MEDseqCompare"</code> generated by <code>MEDseq_compare</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>A logical indicating whether names should be prepended with the text "<code>Cluster g: </code>", where <code>g</code> is the cluster number. Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>A logical indicating whether the (typically 'soft') size of each cluster is appended to the label of each group, expressed as a percentage of the total number of observations. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weighted</code></td>
<td>
<p>A logical indicating whether the sampling weights (if any) are used when appending the <code>size</code> of each cluster to the labels. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Catches unused arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names</code></td>
<td>
<p>The output of <code>MEDseq_clustnames</code> to be passed to the convenience function <code>MEDseq_nameclusts</code> (see <code>Details</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Unlike the <code>seqclustname</code> function from the <span class="pkg">WeightedCluster</span> package which inspired these functions, <code>MEDseq_clustnames</code> only returns the names themselves, not the <code>factor</code> variable indicating cluster membership with labels given by those names. Thus, <code>MEDseq_nameclusts</code> is provided as a convenience function for precisely this purpose (see <code>Examples</code>).
</p>


<h3>Value</h3>

<p>For <code>MEDseq_clustnames</code>, a character vector containing the names for each component defined by their central sequence, and optionally the cluster name (see <code>cluster</code> above) and cluster size (see <code>size</code> above). The name for the noise component, if any, will always be simply <code>"Noise"</code> (or <code>"Cluster 0: Noise"</code>).
</p>
<p>For <code>MEDseq_nameclusts</code>, a factor version of <code>x$MAP</code> with levels given by the output of <code>MEDseq_clustnames</code>.
</p>


<h3>Note</h3>

<p>The main <code>MEDseq_clustnames</code> function is used internally by <code>plot.MEDseq</code>, <code>MEDseq_meantime</code>, <code>MEDseq_stderr</code>, and also other <code>print</code> and <code>summary</code> methods, where its invocation can typically controlled via a <code>SPS</code> logical argument. However, the optional arguments <code>cluster</code>, <code>size</code>, and <code>weighted</code> can only be passed through <code>plot.MEDseq</code>; elsewhere <code>cluster=TRUE</code>, <code>size=FALSE</code>, and <code>weighted=FALSE</code> are always assumed.
</p>


<h3>Author(s)</h3>

<p>Keefe Murphy - &lt;<a href="mailto:keefe.murphy@mu.ie">keefe.murphy@mu.ie</a>&gt;
</p>


<h3>References</h3>

<p>Murphy, K., Murphy, T. B., Piccarreta, R., and Gormley, I. C. (2021). Clustering longitudinal life-course sequences using mixtures of exponential-distance models. <em>Journal of the Royal Statistical Society: Series A (Statistics in Society)</em>, 184(4): 1414-1451. &lt;<a href="https://doi.org/10.1111/rssa.12712">doi:10.1111/rssa.12712</a>&gt;.
</p>


<h3>See Also</h3>

<p><code>seqformat</code>, <code>seqclustname</code>, <code>plot.MEDseq</code>, <code>MEDseq_meantime</code>, <code>MEDseq_stderr</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Load the MVAD data
data(mvad)
mvad$Location &lt;- factor(apply(mvad[,5:9], 1L, function(x) 
                 which(x == "yes")), labels = colnames(mvad[,5:9]))
mvad          &lt;- list(covariates = mvad[c(3:4,10:14,87)],
                      sequences = mvad[,15:86], 
                      weights = mvad[,2])
mvad.cov      &lt;- mvad$covariates

# Create a state sequence object with the first two (summer) time points removed
states        &lt;- c("EM", "FE", "HE", "JL", "SC", "TR")
labels        &lt;- c("Employment", "Further Education", "Higher Education", 
                   "Joblessness", "School", "Training")
mvad.seq      &lt;- seqdef(mvad$sequences[-c(1,2)], states=states, labels=labels)

# Fit a model with weights and a gating covariate
# Have the probability of noise-component membership depend on the covariate
mod    &lt;- MEDseq_fit(mvad.seq, G=5, modtype="UUN", weights=mvad$weights, 
                     gating=~ gcse5eq, covars=mvad.cov, noise.gate=TRUE)
                     
# Extract the names
names  &lt;- MEDseq_clustnames(mod, cluster=FALSE, size=TRUE)

# Get the renamed MAP cluster membership indicator vector
group  &lt;- MEDseq_nameclusts(names)

# Use the output in plots
plot(mod, type="d", soft=FALSE, weighted=FALSE, cluster=FALSE, size=TRUE, border=TRUE)
# same as:
# seqplot(mvad.seq, type="d", group=group)

# Indeed, this function is invoked by default for certain plot types
plot(mod, type="d", soft=TRUE, weighted=TRUE)
plot(mod, type="d", soft=TRUE, weighted=TRUE, SPS=FALSE)

# Invoke this function when printing the gating network coefficients
print(mod$gating, SPS=FALSE)
print(mod$gating, SPS=TRUE)

# Invoke this function in a call to MEDseq_meantime
MEDseq_meantime(mod, SPS=TRUE)
 
# Invoke this function in other plots
plot(mod, type="clusters", SPS=TRUE)
plot(mod, type="precision", SPS=TRUE)

</code></pre>


</div>