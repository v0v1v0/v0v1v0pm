<div class="container">

<table style="width: 100%;"><tr>
<td>gen_MEFM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Data generation of matrix time series with MEFM structure</h2>

<h3>Description</h3>

<p>Generate a matrix time series with MEFM at each time t, with the first mode as the time mode, the second as the row mode and the third as the column mode
</p>


<h3>Usage</h3>

<pre><code class="language-R">gen_MEFM(
  TT,
  d,
  r,
  re,
  eta,
  coef_f,
  coef_fe,
  coef_e,
  param_mu,
  param_alpha,
  param_beta,
  heavy_tailed = FALSE,
  t_df = 3,
  rademacher = FALSE,
  seed = 2024
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>TT</code></td>
<td>
<p>Length of time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>Dimensions of the matrix at time t, written in a vector of length 2 where the first number denotes the number of rows p and the second denoted the number of columns q.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>Rank of the core factors, written in a vector of length 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>re</code></td>
<td>
<p>re: Rank of the cross-sectional common error core factors, written in a vector of length 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>
<p>Quantities controlling factor strengths in each factor loading matrix, written in a list of 2 vectors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef_f</code></td>
<td>
<p>AR(5) coefficients for the factor series, written in a vector of length 5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef_fe</code></td>
<td>
<p>AR(5) coefficients for the common component in error series, written in a vector of length 5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef_e</code></td>
<td>
<p>AR(5) coefficients for the idiosyncratic component in error series, written in a vector of length 5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param_mu</code></td>
<td>
<p>If rademacher = TRUE, represent parameters of normal distribution to generate grand mean series mu_t, written in a vector of length 2 representing the mean and standard deviation. Otherwise written in a scalar multiplied by the generated Rademacher random variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param_alpha</code></td>
<td>
<p>If rademacher = TRUE, represent parameters of normal distribution to generate row effect series alpha_t, written in a vector of length 2 representing the mean and standard deviation. Otherwise written in a scalar multiplied by the generated Rademacher random variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param_beta</code></td>
<td>
<p>If rademacher = TRUE, represent parameters of normal distribution to generate column effect series beta_t, written in a vector of length 2 representing the mean and standard deviation. Otherwise written in a scalar multiplied by the generated Rademacher random variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>heavy_tailed</code></td>
<td>
<p>Whether to generate data from heavy-tailed distribution. If FALSE, generate from N(0,1); if TRUE, generate from t-distribution. Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t_df</code></td>
<td>
<p>The degree of freedom for t-distribution if heavy_tailed = TRUE. Default is 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rademacher</code></td>
<td>
<p>Mechanism to generate mu, alpha and beta. If FALSE, generate from normal with param_mu, param_alpha and param_beta; if TRUE, generate from Rademacher distribution and scaled by param_mu, param_alpha and param_beta. Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Random seed required for reproducibility. Default is 2024.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the following:
mu: the generated time-varying grand mean series, as a vector of length TT;
alpha: the generated time-varying row effect series, as a matrix of dimension (TT,p);
beta: the generated time-varying column effect series, as a matrix of dimension (TT,q);
A: a list of 2 factor loading matrices;
C: the generated common component time series, as multi-dimensional array with dimension 3, where mode-1 is the time mode, mode-2 is for rows and mode-3 is for columns;
Ft: the generated core factor series, as multi-dimensional array with dimension 3, where mode-1 is the time mode, mode-2 is for rows and mode-3 is for columns;
MEFM: the generated matrix time series with MEFM structure, as multi-dimensional array with dimension 3, where mode-1 is the time mode, mode-2 is for rows and mode-3 is for columns;
FM: the generated matrix time series with only traditional factor structure, as multi-dimensional array with dimension 3, where mode-1 is the time mode, mode-2 is for rows and mode-3 is for columns;
E: the generated error time series with factor structure, as multi-dimensional array with dimension 3, where mode-1 is the time mode, mode-2 is for rows and mode-3 is for columns;
</p>


<h3>Examples</h3>

<pre><code class="language-R">TT = 40;
d = c(40,40);
r = c(2,2);
re = c(2,2);
eta = list(c(0,0), c(0,0));
coef_f = c(0.7, 0.3, -0.4, 0.2, -0.1);
coef_fe = c(-0.7, -0.3, -0.4, 0.2, 0.1);
coef_e = c(0.8, 0.4, -0.4, 0.2, -0.1);
param_mu = c(0,1);
param_alpha = c(0,1);
param_beta = c(0,1);
gen_MEFM(TT,d,r,re,eta, coef_f, coef_fe, coef_e, param_mu, param_alpha, param_beta);



</code></pre>


</div>