<div class="container">

<table style="width: 100%;"><tr>
<td>plot_module</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Module plotting function.
</h2>

<h3>Description</h3>

<p>Extract subnetworks for modules and plot. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_module(output.summary,PFN,subset.module = NULL,col.names,
gene.set = NULL,color.code = "logFC",show.legend = TRUE,
label.hubs.only = TRUE,hubLabel.col = "red",hubLabel.sizeProp = 0.5,show.topn.hubs = 10,
node.sizeProp = 13,label.sizeProp = 13,label.scaleFactor = 10,label.alpha = 0.5,
layout = "kamada.kawai",output.plot = TRUE,out.dir = "modulePlot")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>output.summary</code></td>
<td>
<p>output from summary function, "MEGENA.ModuleSummary".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PFN</code></td>
<td>
<p>igraph object retaining PFN topology.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset.module</code></td>
<td>
<p>A character vector for list of module names to plot. Default = NULL plots all modules in output.summary.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.names</code></td>
<td>
<p>a character vector for list of colors to be used for coloring children modules.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gene.set</code></td>
<td>
<p>A list object containing signatures for customized coloring of nodes in resulting network plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color.code</code></td>
<td>
<p>A character vector with matched length to "gene.set", to specify colors for each signature.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label.hubs.only</code></td>
<td>
<p>TRUE/FALSE to show labels for significant hub genes only, or all genes. Defauly is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hubLabel.col</code></td>
<td>
<p>Label color for hubs. Default is "red"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.legend</code></td>
<td>
<p>TRUE/FALSE for showing node legend on the bottom of the figure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hubLabel.sizeProp</code></td>
<td>
<p>A multiplicative factor to adjust hub label sizes with respect to node size values. Default is 0.5</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.topn.hubs</code></td>
<td>
<p>Maximal number of hubs to label on module subnetwork. Default is 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>node.sizeProp</code></td>
<td>
<p>A multiplicative factor to adjust node sizes with respect to 90th percentile degree node size. Default is 13</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label.sizeProp</code></td>
<td>
<p>A multiplicative factor to adjust node label sizes with respect to 90th percentile degree node size. Default is 13</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label.scaleFactor</code></td>
<td>
<p>Overall scale factor to control the final size of node labels appearing in figure. Default is 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label.alpha</code></td>
<td>
<p>Transparency value ranging from 0 (transparent) to 1 (solid). Default is 0.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>layout</code></td>
<td>
<p>Network layout algorithm to apply. Options are: "kamada.kawai", "fruchterman.reingold".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output.plot</code></td>
<td>
<p>logical value. output.plot = TRUE generates figure files under folder, "modulePlot".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out.dir</code></td>
<td>
<p>if output.plot = TRUE, then out.dir is created and resulting figures are exported to .png files to the folder.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Subnetwork plot functionality with application of "ggrepel" package for node labeling. The most effective way to control overall node label size is through label.scaleFactor. 
</p>


<h3>Value</h3>

<p>A list object holding ggplot objects for plotted modules. 
</p>


<h3>Author(s)</h3>

<p>Won-Min Song
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
rm(list = ls())
library(MEGENA)

data(Sample_Expression)
ijw &lt;- calculate.correlation(datExpr[1:100,],doPerm = 2)
el &lt;- calculate.PFN(ijw[,1:3])
g &lt;- graph.data.frame(el,directed = FALSE)
MEGENA.output &lt;- do.MEGENA(g = g,remove.unsig = FALSE,doPar = FALSE,n.perm = 10)
output.summary &lt;- MEGENA.ModuleSummary(MEGENA.output,
mod.pvalue = 0.05,hub.pvalue = 0.05,
min.size = 10,max.size = 5000,
annot.table = NULL,id.col = NULL,symbol.col = NULL,
output.sig = TRUE)

pnet.obj &lt;- plot_module(output = output.summary,PFN = g,subset.module = "comp1_2",
	layout = "kamada.kawai",label.hubs.only = FALSE,
	gene.set = list("hub.set" = c("CD3E","CD2")),color.code =  c("red"),
	output.plot = FALSE,out.dir = "modulePlot",col.names = c("grey","grey","grey"),
	hubLabel.col = "black",hubLabel.sizeProp = 1,show.topn.hubs = Inf,show.legend = TRUE)
	
pnet.obj

## End(Not run)
</code></pre>


</div>