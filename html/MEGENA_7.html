<div class="container">

<table style="width: 100%;"><tr>
<td>draw_sunburst_wt_fill</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Draw sunburst plot showing MEGENA module hierarchy.
</h2>

<h3>Description</h3>

<p>Sunburst plot and colored heatmaps 
</p>


<h3>Usage</h3>

<pre><code class="language-R">  draw_sunburst_wt_fill(module.df,
                        parent.col = "module.parent",id.col = "id",
                        min.angle = 5,
                        feat.col,
                        fill.type = "continuous",log.transform = TRUE,
                        fill.scale = NULL,
                        theme.adjust = NULL
                        )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>module.df</code></td>
<td>
<p>A data.frame table summarizing module information. Must contain module parent and child relation for hierarchy visualization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parent.col</code></td>
<td>
<p>Character object, name for the parent module column in module.df.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id.col</code></td>
<td>
<p>Character object for the module id column in module df.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.angle</code></td>
<td>
<p>Minimum angle that rectangles in the sunburst are labeled with respective module id.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>feat.col</code></td>
<td>
<p>Chracter object, for the feature column in module.df to color the heatmaps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill.type</code></td>
<td>
<p>continuous/discrete, is the variable numeric (continuous) or factor (discrete)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.transform</code></td>
<td>
<p>TRUE/FALSE. do log10 transform for p-values?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill.scale</code></td>
<td>
<p>A ggplot object to specify heatmap coloring scheme. Permissible functions are: scale_fill_gradient,scale_fill_gradient2,scale_fill_gradientn,scale_fill_manual.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theme.adjust</code></td>
<td>
<p>A ggplot object to specify theme for plotting.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>makes use of ggraph scheme to manipulate and draw sunburst plot in ggplot2 framework. fill.scale and theme.adjust provide flexibility to designate heatmap coloring schemes and figure aesthetics. 
</p>


<h3>Value</h3>

<p>ggplot object for the figure
</p>


<h3>Author(s)</h3>

<p>Won-Min Song
</p>


<h3>Examples</h3>

<pre><code class="language-R">  ## Not run: 
    rm(list = ls())
    data(Sample_Expression)
    ijw &lt;- calculate.correlation(datExpr[1:100,],doPerm = 2)
    el &lt;- calculate.PFN(ijw[,1:3])
    g &lt;- graph.data.frame(el,directed = FALSE)
    MEGENA.output &lt;- do.MEGENA(g = g,remove.unsig = FALSE,doPar = FALSE,n.perm = 10)
    output.summary &lt;- MEGENA.ModuleSummary(MEGENA.output,
    mod.pvalue = 0.05,hub.pvalue = 0.05,
    min.size = 10,max.size = 5000,
    annot.table = NULL,id.col = NULL,symbol.col = NULL,
    output.sig = TRUE)
    
    # no coloring 
    sbobj = draw_sunburst_wt_fill(module.df = output.summary$module.table,
    feat.col = NULL,id.col = "module.id",parent.col = "module.parent")
    sbobj
    
    # get some coloring (with log transform option)
    mdf= output.summary$module.table
    mdf$heat.pvalue = runif(nrow(mdf),0,0.1)
    
    sbobj = draw_sunburst_wt_fill(module.df = mdf,feat.col = "heat.pvalue",log.transform = TRUE,
    fill.type = "continuous",
    fill.scale = scale_fill_gradient2(low = "white",mid = "white",high = "red",
    midpoint = -log10(0.05),na.value = "white"), 
    id.col = "module.id",parent.col = "module.parent")
    sbobj
    
    # get discrete coloring done
    mdf$category = factor(sample(x = c("A","B"),size = nrow(mdf),replace = TRUE))
    sbobj = draw_sunburst_wt_fill(module.df = mdf,feat.col = "category",
    fill.type = "discrete",
    fill.scale = scale_fill_manual(values = c("A" = "red","B" = "blue")), 
    id.col = "module.id",parent.col = "module.parent")
    sbobj
  
## End(Not run)
</code></pre>


</div>