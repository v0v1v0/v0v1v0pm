<div class="container">

<table style="width: 100%;"><tr>
<td>feature.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Inference for features identified by the Lasso</h2>

<h3>Description</h3>

<p>Performs randomization tests of features identified by the Lasso
</p>


<h3>Usage</h3>

<pre><code class="language-R">feature.test(
  x,
  y,
  B = 100,
  type.measure = "deviance",
  s = "lambda.min",
  keeplambda = FALSE,
  olsestimates = TRUE,
  penalty.factor = rep(1, nvars),
  alpha = 1,
  control = list(trace = FALSE, maxcores = 24),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>input matrix, of dimension nobs x nvars; each row is an observation
vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>quantitative response variable of length nobs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>The number of randomizations used in the computations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type.measure</code></td>
<td>
<p>loss to use for cross-validation. See <code>cv.glmnet</code>
for more information</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>Value of the penalty parameter 'lambda' at which predictions are
required. Default is the entire sequence used to create the model. See
<code>coef.glmnet</code> for more information</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keeplambda</code></td>
<td>
<p>If set to <code>TRUE</code> then the estimated lambda from cross
validation from the original dataset is kept and used for evaluation in the
subsequent randomization datasets. This reduces computation time
substantially as it is not necessary to perform cross validation for each
randomization. If set to a value then that value is used for the value of
lambda. Defaults to <code>FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>olsestimates</code></td>
<td>
<p>Logical. Should the test statistic be based on OLS
estimates from the model based on the variables selected by the lasso.
Defaults to <code>TRUE</code>. If set to <code>FALSE</code> then the coefficients from
the lasso is used as test statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty.factor</code></td>
<td>
<p>a vector of weights used for adaptive lasso. See
<code>glmnet</code> for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The elasticnet mixing parameter. See <code>glmnet</code> for more
information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>A list of options that control the algorithm. Currently
<code>trace</code> is a logical and if set to <code>TRUE</code> then the function
produces more output. <code>maxcores</code> sets the maximum number of cores to
use with the <code>parallel</code> package</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments passed to <code>glmnet</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list of 7 variables: </p>
<table>
<tr style="vertical-align: top;">
<td><code>p.full </code></td>
<td>
<p>The p-value for the
test of the full set of variables selected by the lasso (based on the OLS
estimates)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ols.selected </code></td>
<td>
<p>A vector of the indices of the non-zero
variables selected by <code>glmnet</code> sorted from (numerically) highest to
lowest based on their ols test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.maxols </code></td>
<td>
<p>The p-value for
the maximum of the OLS test statistics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lasso.selected </code></td>
<td>
<p>A vector of
the indices of the non-zero variables selected by <code>glmnet</code> sorted from
(numerically) highest to lowest based on their absolute lasso coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.maxlasso </code></td>
<td>
<p>The p-value for the maximum of the lasso test statistics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.orig </code></td>
<td>
<p>The value of lambda used in the computations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B
</code></td>
<td>
<p>The number of permutations used</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Claus Ekstrom <a href="mailto:ekstrom@sund.ku.dk">ekstrom@sund.ku.dk</a> and Kasper Brink-Jensen
<a href="mailto:kbrink@life.ku.dk">kbrink@life.ku.dk</a>
</p>


<h3>References</h3>

<p>Brink-Jensen, K and Ekstrom, CT 2014. <em>Inference for
feature selection using the Lasso with high-dimensional data</em>.
<a href="https://arxiv.org/abs/1403.4296">https://arxiv.org/abs/1403.4296</a>
</p>


<h3>See Also</h3>

<p><code>glmnet</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

# Simulate some data
x &lt;- matrix(rnorm(30*100), nrow=30)
y &lt;- rnorm(30, mean=1*x[,1])

# Make inference for features
## Not run: 
feature.test(x, y)

## End(Not run)


</code></pre>


</div>