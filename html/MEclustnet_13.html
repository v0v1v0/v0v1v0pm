<div class="container">

<table style="width: 100%;"><tr>
<td>MEclustnet</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MEclustnet: A package for model-based clustering of nodes in a network,
accounting for covariates.</h2>

<h3>Description</h3>

<p>The main function of interest is MEclustnet which will fit a mixture
of experts latent position cluster model to a binary network.
</p>
<p>MEclustnet will fit a mixture of experts latent position cluster model to a binary network.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MEclustnet(Y, covars, link.vars = c(1:ncol(covars)),
  mix.vars = c(1:ncol(covars)), G = 2, d = 2, itermax = 10000,
  uphill = 100, burnin = 1000, thin = 10, rho.input = 1,
  verbose = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>An n x n binary matrix of links between n nodes, with 0 on the diagonal and 1 indicating a link.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covars</code></td>
<td>
<p>An n x p data frame of node specific covariates. Categorical variables should be factors. First column should be a column of 1s, and should always be passed in.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link.vars</code></td>
<td>
<p>A vector of the column numbers of the data frame <code>covars</code> to be included in link probability model. If none are to be included, this argument should be 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mix.vars</code></td>
<td>
<p>A vector of the column numbers of the data frame <code>covars</code> to be included in mixing proportions model. If none are to be included, argument should be 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>The number of clusters in the model to be fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>The dimension of the latent space.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>itermax</code></td>
<td>
<p>Maximum number of iterations in the MCMC chain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uphill</code></td>
<td>
<p>Number of iterations for which uphill only steps in the MCMC chain should be run to find <em>maximum a posteriori</em> estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>Number of burnin iterations in the MCMC chain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>The degree of thinning to be applied to the MCMC chain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho.input</code></td>
<td>
<p>Scaling factor to achieve desirable acceptance rates in Metropolis-Hastings steps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Print progress updates to screen? Recommended as the models are slow to run.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function fits the mixture of experts latent position cluster model to a binary network via a Metropolis-within-Gibbs sampler. Covariates can influence either the link probabilities between nodes and/or the cluster memberships of nodes.
</p>


<h3>Value</h3>

<p>An object of class <code>MEclustnet</code>, which is a list containing:
</p>

<dl>
<dt>zstore</dt>
<dd>
<p>An n x d x store.dim array of sampled latent location matrices, where store.dim is the number of post burnin thinned iterations.</p>
</dd>
<dt>betastore</dt>
<dd>
<p>A store.dim x p matrix of sampled beta vectors, the logistic regression parameters of the link probabilities model.</p>
</dd>
<dt>Kstore</dt>
<dd>
<p>A store.dim x n matrix of sampled cluster membership vectors.</p>
</dd>
<dt>mustore</dt>
<dd>
<p>A G x d x store.dim array of sampled cluster mean latent location matrices.</p>
</dd>
<dt>sigma2store</dt>
<dd>
<p>A store.dim x G matrix of sampled cluster variances.</p>
</dd>
<dt>lambdastore</dt>
<dd>
<p>An n x G x store.dim array of sampled mixing proportion matrices.</p>
</dd>
<dt>taustore</dt>
<dd>
<p>A G x s x store.dim array of sampled tau vectors, the logistic regression parameters of the mixing proportions model, where s is the length of tau.</p>
</dd>
<dt>LLstore</dt>
<dd>
<p>A vector of length store.dim storing the loglikelihood from each stored iteration.</p>
</dd>
<dt>G</dt>
<dd>
<p>The number of clusters fitted</p>
</dd>
<dt>d</dt>
<dd>
<p>The dimension of the latent space</p>
</dd>
<dt>countbeta</dt>
<dd>
<p>Count of accepted beta values</p>
</dd>
<dt>counttau</dt>
<dd>
<p>Count of accepted tau values</p>
</dd>
</dl>
<h3>MEclustnet functions</h3>

<p>MEclustnet
</p>


<h3>References</h3>

<p>Isobel Claire Gormley and Thomas Brendan Murphy. (2010) A Mixture of Experts Latent Position Cluster Model for Social Network Data. Statistical Methodology, 7 (3), pp.385-405.
</p>


<h3>See Also</h3>

<p><code>MEclustnet</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#################################################################
# An example from the Gormley and Murphy (2010) paper, using the Lazega lawyers friendship network.
#################################################################
# Number of iterations etc. are set to low values for illustrative purposes.
# Longer run times are likely to be required to achieve sufficient mixing.

library(latentnet)
data(lawyers.adjacency.friends)
data(lawyers.covariates)

link.vars = c(1)
mix.vars = c(1,4,5)

fit = MEclustnet(lawyers.adjacency.friends, lawyers.covariates,
link.vars, mix.vars, G=2, d=2, itermax = 500, burnin = 50, uphill = 1, thin=10)

# Plot the trace plot of the mean of dimension 1 for each cluster.
matplot(t(fit$mustore[,1,]), type="l", xlab="Iteration", ylab="Parameter")

# Compute posterior summaries
summ = summaryMEclustnet(fit, lawyers.adjacency.friends)
plot(summ$zmean, col=summ$Kmode, xlab="Dimension 1", ylab="Dimension 2", pch=summ$Kmode,
     main = "Posterior mean latent location for each node.")

# Plot the resulting latent space, with uncertainties
plotMEclustnet(fit, lawyers.adjacency.friends, link.vars, mix.vars)

#################################################################
# An example analysing a 2016 Twitter network of US politicians.
#################################################################
# Number of iterations etc. are set to low values for illustrative purposes.
# Longer run times are likely to be required to achieve sufficient mixing.

library(latentnet)
data(us.twitter.adjacency)
data(us.twitter.covariates)

link.vars = c(1)
mix.vars = c(1,5,7,8)

fit = MEclustnet(us.twitter.adjacency, us.twitter.covariates,
link.vars, mix.vars, G=4, d=2, itermax = 500, burnin = 50, uphill = 1, thin=10)

# Plot the trace plot of the mean of dimension 1 for each cluster.
matplot(t(fit$mustore[,1,]), type="l", xlab="Iteration", ylab="Parameter")

# Compute posterior summaries
summ = summaryMEclustnet(fit, us.twitter.adjacency)

plot(summ$zmean, col=summ$Kmode, xlab="Dimension 1", ylab="Dimension 2", pch=summ$Kmode,
     main = "Posterior mean latent location for each node.")

# Plot the resulting latent space, with uncertainties
plotMEclustnet(fit, us.twitter.adjacency, link.vars, mix.vars)

# Examine which politicians are in which clusters...
clusters = list()
for(g in 1:fit$G)
{
  clusters[[g]] = us.twitter.covariates[summ$Kmode==g,c("name", "party")]
}
clusters

</code></pre>


</div>