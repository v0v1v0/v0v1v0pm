<div class="container">

<table style="width: 100%;"><tr>
<td>.PACE</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate univariate functional PCA</h2>

<h3>Description</h3>

<p>This function is a slightly adapted version of the 
<code>fpca.sc</code> function in the <strong>refund</strong> package for 
calculating univariate functional principal components based on a smoothed 
covariance function. The smoothing basis functions are penalized splines.
</p>


<h3>Usage</h3>

<pre><code class="language-R">.PACE(
  X,
  Y,
  Y.pred = NULL,
  nbasis = 10,
  pve = 0.99,
  npc = NULL,
  makePD = FALSE,
  cov.weight.type = "none"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A vector of xValues.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>A matrix of observed functions (by row).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y.pred</code></td>
<td>
<p>A matrix of functions (by row) to be approximated using the 
functional principal components. Defaults to <code>NULL</code>, i.e. the 
prediction is made for the functions in <code>Y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbasis</code></td>
<td>
<p>An integer, giving the number of B-spline basis to use. 
Defaults to <code>10</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pve</code></td>
<td>
<p>A value between 0 and 1, giving the percentage of variance 
explained in the data by the functional principal components. This value is
used to choose the number of principal components. Defaults to <code>0.99</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npc</code></td>
<td>
<p>The number of principal components to be estimated. Defaults to 
<code>NULL</code>. If given, this overrides <code>pve</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>makePD</code></td>
<td>
<p>Logical, should positive definiteness be enforced for the 
covariance estimate? Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.weight.type</code></td>
<td>
<p>The type of weighting used for the smooth covariance
estimate. Defaults to <code>"none"</code>, i.e. no weighting. Alternatively, 
<code>"counts"</code> (corresponds to <code>fpca.sc</code> in <strong>refund</strong>) weights the pointwise estimates of the covariance function
by the number of observation points.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>The approximation of <code>Y.pred</code> (if <code>NULL</code>, the 
approximation of <code>Y</code>) based on the functional principal components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p>A matrix containing the estimated scores (observations by 
row).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>The estimated mean function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>efunctions</code></td>
<td>
<p>A matrix 
containing the estimated eigenfunctions (by row).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>evalues</code></td>
<td>
<p>The 
estimated eigenvalues.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npc</code></td>
<td>
<p>The number of principal comopnents that 
were calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2</code></td>
<td>
<p>The estimated variance of the measurement 
error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estVar</code></td>
<td>
<p>The estimated smooth variance function of the data.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Di, C., Crainiceanu, C., Caffo, B., and Punjabi, N. (2009). 
Multilevel functional principal component analysis. Annals of Applied 
Statistics, 3, 458–488. Yao, F., Mueller, H.-G., and Wang, J.-L. (2005). 
Functional data analysis for sparse longitudinal data. Journal of the 
American Statistical Association, 100, 577–590.
</p>


<h3>See Also</h3>

<p><code>PACE</code>
</p>


</div>