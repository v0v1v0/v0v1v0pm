<div class="container">

<table style="width: 100%;"><tr>
<td>fcptpaBasis</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate a smooth PCA representation for functional data on two-dimensional 
domains</h2>

<h3>Description</h3>

<p>This function calculates a smooth PCA representation based on the FCP_TPA 
algorithm (see References) for functional data on two-dimensional domains. In 
this case, the data can be interpreted as images with <code>S1 x S2</code> pixels 
(assuming <code>nObsPoints(funDataObject) = (S1, S2)</code>), i.e. the total data 
for <code>N</code> observations can be represented as third order tensor of 
dimension <code>N x S1 x S2</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fcptpaBasis(
  funDataObject,
  npc,
  smoothingDegree = rep(2, 2),
  alphaRange,
  orderValues = TRUE,
  normalize = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>funDataObject</code></td>
<td>
<p>An object of class <code>funData</code> 
containing the observed functional data samples (here: images) for which the
smooth PCA is to be calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npc</code></td>
<td>
<p>An integer, giving the number of principal components to be 
calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smoothingDegree</code></td>
<td>
<p>A numeric vector of length 2, specifying the degree of 
the difference penalties inducing smoothness in both directions of the 
image. Defaults to <code>2</code> for each direction (2nd differences).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alphaRange</code></td>
<td>
<p>A list of length 2 with entries <code>v</code> and <code>w</code> 
containing the range of smoothness parameters to test for each direction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>orderValues</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the eigenvalues are ordered
decreasingly, together with their associated eigenimages and scores.
Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalize</code></td>
<td>
<p>Logical. If <code>TRUE</code> the eigenfunctions are normalized to 
have norm 1. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The smooth PCA of the tensor data is calculated via the <code>FCP_TPA</code> 
function. Smoothness is induced by difference penalty matrices for both 
directions of the images, weighted by smoothing parameters <code class="reqn">\alpha_v, 
\alpha_w</code>. The resulting eigenvectors can be interpreted in terms of 
eigenfunctions and individual scores for each observation. See 
<code>FCP_TPA</code> for details.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p>A matrix of scores (coefficients) with dimension <code>N
 x npc</code>, reflecting the weights for principal component in each observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>A matrix containing the scalar product of all pairs of basis 
functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ortho</code></td>
<td>
<p>Logical, indicating whether the eigenfunctions are 
orthonormal. Set to <code>normalize</code>, as this influences whether a 
normalization is done or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>functions</code></td>
<td>
<p>A functional data object, 
representing the functional principal component basis functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>values</code></td>
<td>
<p>A vector of length <code>npc</code>, containing the eigenvalues in 
decreasing order.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>G. I. Allen, "Multi-way Functional Principal Components Analysis",
In IEEE International Workshop on Computational Advances in Multi-Sensor 
Adaptive Processing, 2013.
</p>


<h3>See Also</h3>

<p><code>univDecomp</code>, <code>FCP_TPA</code>
</p>


</div>