<div class="container">

<table style="width: 100%;"><tr>
<td>fpcaBasis</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate a functional principal component basis representation for 
functional data on one-dimensional domains</h2>

<h3>Description</h3>

<p>This function calculates a functional principal component basis
representation for functional data on one-dimensional domains. The FPCA is
calculated via the <code>PACE</code> function, which is built on
<code>fpca.sc</code> in the <strong>refund</strong> package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fpcaBasis(
  funDataObject,
  nbasis = 10,
  pve = 0.99,
  npc = NULL,
  makePD = FALSE,
  cov.weight.type = "none"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>funDataObject</code></td>
<td>
<p>An object of class <code>funData</code> 
containing the observed functional data samples and for which the FPCA is 
to be calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbasis</code></td>
<td>
<p>An integer, representing the number of  B-spline basis 
functions used for estimation of the mean function and bivariate smoothing 
of the covariance surface. Defaults to <code>10</code> (cf. 
<code>fpca.sc</code> in <strong>refund</strong>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pve</code></td>
<td>
<p>A numeric value between 0 and 1, the proportion of variance 
explained: used to choose the number of principal components. Defaults to 
<code>0.99</code> (cf. <code>fpca.sc</code> in <strong>refund</strong>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npc</code></td>
<td>
<p>An integer, giving a prespecified value for the number of 
principal components. Defaults to <code>NULL</code>. If given, this overrides 
<code>pve</code> (cf. <code>fpca.sc</code> in <strong>refund</strong>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>makePD</code></td>
<td>
<p>Logical: should positive definiteness be enforced for the 
covariance surface estimate? Defaults to <code>FALSE</code> (cf. 
<code>fpca.sc</code> in <strong>refund</strong>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.weight.type</code></td>
<td>
<p>The type of weighting used for the smooth covariance
estimate in <code>PACE</code>. Defaults to <code>"none"</code>, i.e. no weighting. Alternatively, 
<code>"counts"</code> (corresponds to <code>fpca.sc</code> in <strong>refund</strong>) weights the pointwise estimates of the covariance function
by the number of observation points.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p>A matrix of scores (coefficients) with dimension 
<code>N x K</code>, reflecting the weights for each principal component in each 
observation, where <code>N</code> is the number of observations in
<code>funDataObject</code> and <code>K</code> is the number of functional principal
components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ortho</code></td>
<td>
<p>Logical, set to <code>TRUE</code>, as basis functions
are orthonormal.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>functions</code></td>
<td>
<p>A functional data object, representing
the functional principal component basis functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meanFunction</code></td>
<td>
<p>The smoothed mean function.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>univDecomp</code>, <code>PACE</code>
</p>


</div>