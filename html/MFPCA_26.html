<div class="container">

<table style="width: 100%;"><tr>
<td>PACE</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Univariate functional principal component analysis by smoothed covariance</h2>

<h3>Description</h3>

<p>This function calculates a univariate functional principal components 
analysis by smoothed covariance based on code from 
<code>fpca.sc</code> in package <strong>refund</strong>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PACE(
  funDataObject,
  predData = NULL,
  nbasis = 10,
  pve = 0.99,
  npc = NULL,
  makePD = FALSE,
  cov.weight.type = "none"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>funDataObject</code></td>
<td>
<p>An object of class <code>funData</code> or 
<code>irregFunData</code> containing the functional data 
observed, for which the functional principal component analysis is 
calculated. If the data is sampled irregularly (i.e. of class 
<code>irregFunData</code>), <code>funDataObject</code> is transformed 
to a <code>funData</code> object first.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predData</code></td>
<td>
<p>An object of class <code>funData</code>, for which
estimated trajectories based on a truncated Karhunen-Loeve representation 
should be estimated. Defaults to <code>NULL</code>, which implies prediction for 
the given data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbasis</code></td>
<td>
<p>An integer, representing the number of  B-spline basis 
functions used for estimation of the mean function and bivariate smoothing 
of the covariance surface. Defaults to <code>10</code> (cf. 
<code>fpca.sc</code> in <strong>refund</strong>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pve</code></td>
<td>
<p>A numeric value between 0 and 1, the proportion of variance 
explained: used to choose the number of principal components. Defaults to 
<code>0.99</code> (cf. <code>fpca.sc</code> in <strong>refund</strong>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npc</code></td>
<td>
<p>An integer, giving a prespecified value for the number of 
principal components. Defaults to <code>NULL</code>. If given, this overrides 
<code>pve</code> (cf. <code>fpca.sc</code> in <strong>refund</strong>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>makePD</code></td>
<td>
<p>Logical: should positive definiteness be enforced for the 
covariance surface estimate? Defaults to <code>FALSE</code> (cf. 
<code>fpca.sc</code> in <strong>refund</strong>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.weight.type</code></td>
<td>
<p>The type of weighting used for the smooth covariance 
estimate. Defaults to <code>"none"</code>, i.e. no weighting. Alternatively, 
<code>"counts"</code> (corresponds to <code>fpca.sc</code> in <strong>refund</strong>) weights the
pointwise estimates of the covariance function by the number of observation
points.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>A <code>funData</code> object with one 
observation, corresponding to the mean function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>values</code></td>
<td>
<p>A vector 
containing the estimated eigenvalues.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>functions</code></td>
<td>
<p>A 
<code>funData</code> object containing the estimated functional 
principal components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p>An matrix of estimated scores for the 
observations in <code>funDataObject</code>. Each row corresponds to the scores of
one observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>A <code>funData</code> object 
containing the estimated trajectories based on the truncated Karhunen-Loeve
representation and the estimated scores and functional principal components
for <code>predData</code> (if this is not <code>NULL</code>) or <code>funDataObject</code> 
(if <code>predData</code> is <code>NULL</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npc</code></td>
<td>
<p>The number of functional 
principal components: either the supplied <code>npc</code>, or the minimum number
of basis functions needed to explain proportion <code>pve</code> of the variance 
in the observed curves (cf. <code>fpca.sc</code> in <strong>refund</strong>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2</code></td>
<td>
<p>The estimated measurement error variance (cf. 
<code>fpca.sc</code> in <strong>refund</strong>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estVar</code></td>
<td>
<p>The estimated smooth
variance function of the data.</p>
</td>
</tr>
</table>
<h3>Warning</h3>

<p>This function works only for univariate functional data 
observed on one-dimensional domains.
</p>


<h3>See Also</h3>

<p><code>funData</code>, 
<code>fpcaBasis</code>, <code>univDecomp</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
  oldPar &lt;- par(no.readonly = TRUE)

  # simulate data
  sim &lt;- simFunData(argvals = seq(-1,1,0.01), M = 5, eFunType = "Poly",
                    eValType = "exponential", N = 100)

  # calculate univariate FPCA
  pca &lt;- PACE(sim$simData, npc = 5)

  # Plot the results
  par(mfrow = c(1,2))
  plot(sim$trueFuns, lwd = 2, main = "Eigenfunctions")
  # flip estimated functions for correct signs
  plot(flipFuns(sim$trueFuns,pca$functions), lty = 2, add = TRUE)
  legend("bottomright", c("True", "Estimate"), lwd = c(2,1), lty = c(1,2))

  plot(sim$simData, lwd = 2, main = "Some Observations", obs = 1:7)
  plot(pca$fit, lty = 2, obs = 1:7, add = TRUE) # estimates are almost equal to true values
  legend("bottomright", c("True", "Estimate"), lwd = c(2,1), lty = c(1,2))

  par(oldPar)

</code></pre>


</div>