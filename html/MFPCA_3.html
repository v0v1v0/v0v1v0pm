<div class="container">

<table style="width: 100%;"><tr>
<td>calcMFPCA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Internal function that implements the MFPCA algorithm for given univariate decompositions</h2>

<h3>Description</h3>

<p>Internal function that implements the MFPCA algorithm for given univariate decompositions
</p>


<h3>Usage</h3>

<pre><code class="language-R">calcMFPCA(
  N,
  p,
  Bchol,
  M,
  type,
  weights,
  npc,
  argvals,
  uniBasis,
  fit = FALSE,
  approx.eigen = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Number of elements in multivariate functional data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Bchol</code></td>
<td>
<p>Cholesky decomposition of B = block diagonal of Cholesky decompositions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>The number of multivariate functional principal components to
calculate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Vector of univariate decompositions to use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Vector of weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npc</code></td>
<td>
<p>Vector giving the number of univariate basis functions used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>argvals</code></td>
<td>
<p>List of argument values for each of the univariate basis functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uniBasis</code></td>
<td>
<p>List of univariate basis functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>Logical. If <code>TRUE</code>, a truncated multivariate Karhunen-Loeve
representation for the data is calculated based on the estimated scores and
eigenfunctions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>approx.eigen</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the eigenanalysis problem for
the estimated covariance matrix is solved approximately using the
<span class="pkg">irlba</span> package, which is much faster. If the number <code>M</code> of
eigenvalues to calculate is high with respect to the number of observations
in <code>mFData</code> or the number of estimated univariate eigenfunctions, the
approximation may be inappropriate. In this case, approx.eigen is set to
<code>FALSE</code> and the function throws a warning. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the following
components: </p>
<table>
<tr style="vertical-align: top;">
<td><code>values</code></td>
<td>
<p>A vector of estimated eigenvalues <code class="reqn">\hat \nu_1
  , \ldots , \hat \nu_M</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>functions</code></td>
<td>
<p>A
<code>multiFunData</code> object containing the estimated
multivariate functional principal components <code class="reqn">\hat \psi_1, \ldots, \hat
  \psi_M</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p> A matrix of dimension <code>N x M</code> containing the
estimated scores <code class="reqn">\hat \rho_{im}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vectors</code></td>
<td>
<p>A matrix
representing the eigenvectors associated with the combined univariate score
vectors. This might be helpful for calculating predictions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normFactors</code></td>
<td>
<p>The normalizing factors used for calculating the
multivariate eigenfunctions and scores. This might be helpful when
calculation predictions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meanFunction</code></td>
<td>
<p>A multivariate functional
data object, corresponding to the mean function. The MFPCA is applied to
the de-meaned functions in <code>mFData</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>A
<code>multiFunData</code> object containing estimated
trajectories for each observation based on the truncated Karhunen-Loeve
representation and the estimated scores and eigenfunctions.</p>
</td>
</tr>
</table>
</div>