<div class="container">

<table style="width: 100%;"><tr>
<td>MFT.peaks</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MFT.peaks</h2>

<h3>Description</h3>

<p>The multiple filter test for peak detection in time series or sequences of random variables
</p>


<h3>Usage</h3>

<pre><code class="language-R">MFT.peaks(x, autoset.H = TRUE, S = NULL, E = NULL, H = NULL,
  alpha = 0.05, method = "asymptotic", sim = 10000, Q = NA,
  blocksize = NA, two.sided = FALSE, perform.CPD = TRUE,
  print.output = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numeric vector, input sequence of random variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>autoset.H</code></td>
<td>
<p>logical, automatic choice of window size H</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>numeric, start of time interval, default: NULL, if NULL then 1 is chosen</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E</code></td>
<td>
<p>numeric, end of time interval, default: NULL, if NULL then length(X) is chosen, needs E &gt; S</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>vector, window set H, the smallest element must &gt;= 3 be and the largest =&lt; (T/2). H is automatically set if autoset.H = TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>numeric, in (0,1), significance level</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>either "asymptotic", "bootstrap" or "fixed", defines how threshold Q is derived, default: "asymptotic", If "asymptotic": Q is derived by simulation of limit process L (Gaussian process); possible set number of simulations (sim), If "bootstrap": Q is derived by (Block)-Bootstrapping; possibly set number of simulations (sim) and blocksize (blocksize), If "fixed": Q may be set manually (Q)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sim</code></td>
<td>
<p>integer, &gt; 0, No of simulations of limit process (for approximation of Q), default = 10000</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q</code></td>
<td>
<p>numeric, rejection threshold, default: Q is simulated according to sim and alpha</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blocksize</code></td>
<td>
<p>NA or integer &gt;= 1, if method == 'bootstrap', blocksize determines the size of blocks (number of life times) for bootstrapping</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>two.sided</code></td>
<td>
<p>logical, if TRUE a two sided test is performed and also negative peaks are considered in peak detection</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perform.CPD</code></td>
<td>
<p>logical, if TRUE change point detection algorithm is performed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.output</code></td>
<td>
<p>logical, if TRUE results are printed to the console</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>invisible
</p>
<table>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>test statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q</code></td>
<td>
<p>rejection threshold</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>how threshold Q was derived, see 'Arguments' for detailed description</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sim</code></td>
<td>
<p>number of simulations of the limit process (approximation of Q)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blocksize</code></td>
<td>
<p>size of blocks (number of life times) for bootstrapping (approximation of Q)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CP</code></td>
<td>
<p>set of change points estmated by the multiple filter algorithm, increasingly ordered in time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>start of time interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E</code></td>
<td>
<p>end of time interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tt</code></td>
<td>
<p>length of time interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>window set</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>significance level</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>two.sided</code></td>
<td>
<p>logigal, if TRUE also negative peaks are considered</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perform.CPD</code></td>
<td>
<p>logical, if TRUE change point detection algorithm was performed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tech.var</code></td>
<td>
<p>list of technical variables with processes x and D_ht</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of MFT which was performed: "peaks"</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Michael Messer, Stefan Albert, Solveig Plomer and Gaby Schneider
</p>


<h3>References</h3>

<p>Michael Messer, Hendrik Backhaus, Albrecht Stroh and Gaby Schneider (2019+). Peak detection in times series
</p>


<h3>See Also</h3>

<p><code>MFT.filterdata, plot.MFT, summary.MFT, MFT.mean, MFT.rate, MFT.variance</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Normal distributed sequence with 2 peaks
set.seed(12)
m &lt;- c(rep(0,30),seq(0,3,length.out = 100),seq(3,0,length.out = 80),rep(0,10),
       seq(0,6,length.out = 50),seq(6,0,length.out = 50),rep(0,30))
x &lt;- rnorm(length(m),m)
mft &lt;- MFT.peaks(x)
plot(mft)
# Set additional parameters (window set)
mft &lt;- MFT.peaks(x,autoset.H = FALSE, H =c(30,60,90))
plot(mft)

</code></pre>


</div>