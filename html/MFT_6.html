<div class="container">

<table style="width: 100%;"><tr>
<td>MFT.variance</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MFT.variance</h2>

<h3>Description</h3>

<p>The multiple filter test for variance change detection in point processes on the line.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MFT.variance(Phi, rcp = NULL, autoset.d_H = TRUE, S = NULL,
  E = NULL, d = NULL, H = NULL, alpha = 0.05,
  method = "asymptotic", sim = 10000, Q = NA, perform.CPD = TRUE,
  print.output = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Phi</code></td>
<td>
<p>numeric vector of increasing events, input point process</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rcp</code></td>
<td>
<p>vector, rate CPs of Phi (if MFT for the rates is used: as CP[,1]), default: constant rate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>autoset.d_H</code></td>
<td>
<p>logical, automatic choice of window size H and step size d</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>numeric, start of time interval, default: Smallest multiple of d that lies beyond min(Phi)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E</code></td>
<td>
<p>numeric, end of time interval, default: Smallest multiple of d that lies beyond max(Phi), needs E &gt; S</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>numeric, &gt; 0, step size delta at which processes are evaluated. d is automatically set if autoset.d_H = TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>vector, window set H, all elements must be increasing ordered multiples of d, the smallest element must be &gt;= d and the largest =&lt; (T/2). H is automatically set if autoset.d_H = TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>numeric, in (0,1), significance level</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>either "asymptotic", or "fixed", defines how threshold Q is derived, default: "asymptotic". If "asymptotic": Q is derived by simulation of limit process L (Brownian motion); possible set number of simulations (sim). If "fixed": Q may be set manually (Q)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sim</code></td>
<td>
<p>integer, &gt; 0, No of simulations of limit process (for approximation of Q), default = 10000</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q</code></td>
<td>
<p>numeric, rejection threshold, default: Q is simulated according to sim and alpha</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perform.CPD</code></td>
<td>
<p>logical, if TRUE change point detection algorithm is performed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.output</code></td>
<td>
<p>logical, if TRUE results are printed to the console</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>invisible
</p>
<table>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>test statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varQ</code></td>
<td>
<p>rejection threshold</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>how threshold Q was derived, see 'Arguments' for detailed description</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sim</code></td>
<td>
<p>number of simulations of the limit process (approximation of Q)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CP</code></td>
<td>
<p>set of change points estmated by the multiple filter algorithm, increasingly ordered in time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>estimated variances between adjacent change points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>start of time interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E</code></td>
<td>
<p>end of time interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tt</code></td>
<td>
<p>length of time interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>window set</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>step size delta at which processes were evaluated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>significance level</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perform.CPD</code></td>
<td>
<p>logical, if TRUE change point detection algorithm was performed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tech.var</code></td>
<td>
<p>list of technical variables with processes Phi and G_ht</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of MFT which was performed: "variance"</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Michael Messer, Stefan Albert, Solveig Plomer and Gaby Schneider
</p>


<h3>References</h3>

<p>Stefan Albert, Michael Messer, Julia Schiemann, Jochen Roeper and Gaby Schneider (2017) 
Multi-scale detection of variance changes in renewal processes in the presence of rate change points.
Journal of Time Series Analysis, &lt;doi:10.1111/jtsa.12254&gt;
</p>


<h3>See Also</h3>

<p><code>MFT.rate, plot.MFT, summary.MFT, MFT.mean, MFT.peaks</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Rate and variance change detection in Gamma process 
# (rate CPs at t=30 and 37.5, variance CPs at t=37.5 and 52.5) 
set.seed(51)
mu &lt;- 0.03; sigma &lt;- 0.01
p1 &lt;- mu^2/sigma^2; lambda1 &lt;- mu/sigma^2
p2 &lt;- (mu*0.5)^2/sigma^2; lambda2 &lt;- (mu*0.5)/sigma^2
p3 &lt;- mu^2/(sigma*1.5)^2; lambda3 &lt;- mu/(sigma*1.5)^2
p4 &lt;- mu^2/(sigma*0.5)^2; lambda4 &lt;- mu/(sigma*0.5)^2
Phi &lt;- cumsum(c(rgamma(1000,p1,lambda1),rgamma(500,p2,lambda2),
rgamma(500,p3,lambda3),rgamma(300,p4,lambda4)))
# rcp  &lt;- MFT.rate(Phi)$CP[,1] # MFT for the rates
rcp &lt;- c(30,37.5) # but here we assume known rate CPs
mft &lt;- MFT.variance(Phi,rcp=rcp) # MFT for the variances
plot(mft)

</code></pre>


</div>