<div class="container">

<table style="width: 100%;"><tr>
<td>gtmoms</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Moments of Observations Above the Threshold </h2>

<h3>Description</h3>

<p>Moments of observations above the threshold (<code>xsi</code>, <code class="reqn">x_{si}</code>), which has been standardized to a zero mean and unit standard deviation. Define the standard normal hazard function as
</p>
<p style="text-align: center;"><code class="reqn">H(x) = \phi(x) / (1 - \Phi(x))\mbox{,}</code>
</p>

<p>where <code class="reqn">\phi(x)</code> is the standard normal density function and <code class="reqn">\Phi(x)</code> is the standard normal distribution (cumulative) function. For a truncation index, <code class="reqn">r</code>, define the recursion formula, <code class="reqn">\Psi</code> for <code>gtmoms</code> as
</p>
<p style="text-align: center;"><code class="reqn">\Psi(x_{si}, r) = (r-1)\Psi(x_{si}, r-2) + x_{si}^{r-1}H(x_{si})\mbox{,}</code>
</p>

<p>for which <code class="reqn">\Psi(x_{si}, 0) = 1</code> and <code class="reqn">\Psi(x_{si}, 1) = H(x_{si})</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gtmoms(xsi, r)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xsi</code></td>
<td>
<p>The lower threshold; and</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>The number of truncated observations.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The moments.
</p>


<h3>Note</h3>

<p><b>AUTHOR TODO—</b>Note that is it not clear in TAC documentation that <code class="reqn">X_{si}</code> is a scalar or vector quantity, and <code>gtmoms</code> is automatically vectoral in the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> idioms if <code class="reqn">X_{si}</code> is. Also it is not immediately clear <code class="reqn">X_{si}</code> is or is not one of the order statistics. Based on MGBT operation in USGS-PeakFQ output (USGS, 2014), the threshold is “known” no better in accuracy than one of the sample order statistics, so <code class="reqn">X_{si}</code> might be written <code class="reqn">x_{[r:n]}</code>. But this answer could be only restricted to a implementation in software and perhaps not theory. Finally, although the computations involve the standard normal distribution, the standardization form of <code class="reqn">X_{si}</code> is not yet confirmed during the WHA porting process.
</p>


<h3>Author(s)</h3>

<p> W.H. Asquith consulting T.A. Cohn sources </p>


<h3>Source</h3>

<p><code>LowOutliers_jfe(R).txt</code>, <code>LowOutliers_wha(R).txt</code>, <code>P3_089(R).txt</code>—Named <code>gtmoms</code>
</p>


<h3>References</h3>

<p>Cohn, T.A., 2013–2016, Personal communication of original R source code: U.S. Geological Survey, Reston, Va.
</p>
<p>U.S. Geological Survey (USGS), 2018, PeakFQ—Flood frequency analysis based on Bulletin 17B and recommendations of the Advisory Committee on Water Information (ACWI) Subcommittee on Hydrology (SOH) Hydrologic Frequency Analysis Work Group (HFAWG), version 7.2: Accessed November 29, 2018, at <a href="https://water.usgs.gov/software/PeakFQ/">https://water.usgs.gov/software/PeakFQ/</a>.
</p>


<h3>See Also</h3>

<p><code>CondMomsChi2</code>, <code>gtmoms</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">gtmoms(-3.561143, 2)  # Is this a meaningful example?
#[1] 0.9974952
</code></pre>


</div>