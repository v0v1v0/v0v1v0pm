<div class="container">

<table style="width: 100%;"><tr>
<td>peta</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Probability of Eta </h2>

<h3>Description</h3>

<p>Compute <code>peta</code>, which is the survival probability of the t-distribution for <code>eta =</code> <code class="reqn">\eta</code>.
</p>
<p>Define <code class="reqn">b_r</code> as the inverse (quantile) of the Beta distribution for nonexceedance probability <code class="reqn">F \in (0,1)</code> having two shape parameters (<code class="reqn">\alpha</code> and <code class="reqn">\beta</code>) as
</p>
<p style="text-align: center;"><code class="reqn">b_r = \mathrm{Beta}^{(-1)}(F; \alpha, \beta) = \mathrm{Beta}^{(-1)}(F; r, n+1-r)\mbox{,}</code>
</p>

<p>for sample size <code class="reqn">n</code> and number of truncated observations <code class="reqn">r</code> and note that <code class="reqn">b_r \in (0,1)</code>. Next, define <code class="reqn">z_r</code> as the <code class="reqn">Z</code>-score for <code class="reqn">b_r</code>
</p>
<p style="text-align: center;"><code class="reqn">z_r = \Phi^{(-1)}(b_r)\mbox{,}</code>
</p>

<p>where <code class="reqn">\Phi^{(-1)}(\cdots)</code> is the inverse of the standard normal distribution.
</p>
<p>Compute the covariance matrix <code class="reqn">COV</code> of <code class="reqn">M</code> and <code class="reqn">S</code> from <code>VMS</code> as in <code>COV = VMS(n, r, qmin=br)</code>, and from which define
</p>
<p style="text-align: center;"><code class="reqn">\lambda = COV_{1,2} / COV_{2,2}\mbox{,}</code>
</p>

<p>which is a covariance divided by a variance, and then define
</p>
<p style="text-align: center;"><code class="reqn">\eta_p = \lambda + \eta\mbox{.}</code>
</p>

<p>Compute the expected values of <code class="reqn">M</code> and <code class="reqn">S</code> from <code>EMS</code> as in <code class="reqn">EMp = </code> <code>EMp = EMS(n, r, qmin=br)</code>, and from which define
</p>
<p style="text-align: center;"><code class="reqn">\mu_{Mp} = EMp_1 - \lambda\times EMp_2\mbox{,}</code>
</p>

<p style="text-align: center;"><code class="reqn">\sigma_{Mp} = \sqrt{COV_{1,1} - COV_{1,2}^2/COV_{2,2}}\mbox{.}</code>
</p>

<p>Compute the conditional moments from <code>CondMomsChi2</code> as in <code class="reqn">momS2 =</code> <code>CondMomsChi2(n,r,zr)</code>, and from which define
</p>
<p style="text-align: center;"><code class="reqn">df = 2 momS2_1^2 / momS2_2\mbox{,}</code>
</p>

<p style="text-align: center;"><code class="reqn">\alpha = momS2_2 / momS2_1\mbox{,}</code>
</p>



<h3>Usage</h3>

<pre><code class="language-R">peta(pzr, n, r, eta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pzr</code></td>
<td>
<p>The probability level of a Beta distribution having shape1 <code class="reqn">\alpha = r</code> and shape2 <code class="reqn">\beta = n+1-r</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The number of observations;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>The number of truncated observations; and</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>
<p>The Grubbs–Beck statistic (<code class="reqn">GB_r</code>, see <code>MGBT</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Currently (2019), context is lost on the preformatted note of code note below. It seems possible that the intent by WHA was to leave a trail for future revisitation of the Beta distribution and its access, which exists in native <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> code.
</p>
<pre>
      zr       &lt;- qnorm(qbeta(the.pzr, shape1=r, shape2=n+1-r))
      CV       &lt;- VMS(n, r, qmin=pnorm(zr))
</pre>


<h3>Value</h3>

<p>The probability of the <code>eta</code> value.
</p>


<h3>Note</h3>

<p>Testing a very large streamgage dataset in Texas with GRH, shows at least one failure of the following computation was encountered for a short record streamgage numbered 08102900.
</p>
<pre>
  # USGS 08102900 (data sorted, 1967--1974)
  #https://nwis.waterdata.usgs.gov/nwis/peak?site_no=08102900&amp;format=hn2
  Peaks &lt;- c(40, 45, 53, 55, 88) # in cubic feet per second (cfs)
  MGBT(Peaks)
  # Here is the line in peta(): SigmaMp &lt;- sqrt(CV[1,1] - CV[1,2]^2/CV[2,2])
  # *** In sqrt(CV[1, 1] - CV[1, 2]^2/CV[2, 2]) : NaNs produced
</pre>
<p>In implementation, a <code>suppressWarnings()</code> is wrapped on the <code>SigmaMp</code>. If the authors make no action in response to <code>NaN</code>, then the low-outlier threshold is 53 cubic feet per second (cfs) with a p-value for 40 cfs as 0.81 and 45 cfs as 0.0. This does not seem logical. The <code>is.finite</code> catch in the next line (see sources) is provisional under a naïve assumption that the negative in the square root has barely undershot. The function is immediately exited with the returned p-value set to unity. Testing indicates that this is a favorable innate trap here within the <span class="pkg">MGBT</span> package and will avoid higher up error trapping in larger application development.
</p>


<h3>Author(s)</h3>

<p> W.H. Asquith consulting T.A. Cohn source</p>


<h3>Source</h3>

<p><code>LowOutliers_jfe(R).txt</code>, <code>LowOutliers_wha(R).txt</code>, <code>P3_089(R).txt</code>—Named <code>peta</code>
</p>


<h3>References</h3>

<p>Cohn, T.A., 2013–2016, Personal communication of original R source code: U.S. Geological Survey, Reston, Va.
</p>


<h3>See Also</h3>

<p><code>EMS</code>, <code>VMS</code>, <code>CondMomsChi2</code>, <code>gtmoms</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">peta(0.4, 58, 2, -2.3006)
#[1] 0.298834
</code></pre>


</div>