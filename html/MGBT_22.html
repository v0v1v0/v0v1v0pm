<div class="container">

<table style="width: 100%;"><tr>
<td>plotPeaks_batch</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Plot for More than One Streamgage that Peak Streamflows with Emphasis on Peak Discharge Qualification Codes </h2>

<h3>Description</h3>

<p>Plot U.S. Geological Survey peak streamflows for multiple streamgages. This function is a wrapper on calls to <code>plotPeaks</code> with data retrieval occurring just ahead.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotPeaks_batch(sites, file=NA, do_plot=TRUE,
                       silent=FALSE, envir=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sites</code></td>
<td>
<p>A list of USGS site identification numbers for which one-by-one, the peaks will be pulled from <code>dataRetrieval::</code><code>readNWISpeak</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>A portable document format output path and file name, setting to <code>NA</code> will plot into the running application unless <code>do_plot=FALSE</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do_plot</code></td>
<td>
<p>A logical triggering the plotting operations. This is a useful feature for test or for a iterative use as seen in the second <b>Example</b>. A setting of false will set <code>file=NA</code> internally regardless of argument given;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>A logical to control status messaging;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>envir</code></td>
<td>
<p>An optional and previously populated enviroment by site number storing a table of peaks from the <code>splitPeakCodes</code> function (see <b>Examples</b>); and</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass to <code>plotPeaks</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list is returned by streamgage of the retrieved data with an attribute <code>empty_sites</code> storing those site numbers given for which no peaks were retrieved/processed. The data structure herein recognizes a <code>NA</code> for a site.
</p>


<h3>Author(s)</h3>

<p> W.H. Asquith</p>


<h3>References</h3>

<p>U.S. Geological Survey, 2019, USGS water data for the Nation: U.S. Geological Survey National Water Information System database, accessed October 11, 2019, at doi: <a href="https://doi.org/10.5066/F7P55KJN">10.5066/F7P55KJN</a>.
</p>


<h3>See Also</h3>

<p><code>plotPeaks</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
  # The dataRetrieval package is not required by MGBT algorithms, but needed
  # for the the plotPeaks_batch() function.
  sites &lt;- c("07358570", "07358280", "07058980", "07258000")
  PK &lt;- plotPeaks_batch(sites, xlab="WATER YEAR",         lot=0,
                               ylab="STREAMFLOW, IN CFS", file=NA) # 


  # In this example, two calls to plotPeaks_batch() are made. The first is to use
  # the function as a means to cache the retrieval of the peaks without the
  # plotting overhead etc. The second is to actually perform the plotting.
  pdffile &lt;- tempfile(pattern = "peaks", tmpdir = tempdir(), fileext = ".pdf")
  sites &lt;- c("08106300", "08106310", "08106350", "08106500") # 08106350 no peaks

  PK &lt;- plotPeaks_batch(sites, do_plot=FALSE)    # a hack to use its wrapper on
  # dataRetrieval::readNWISpeak() to get the peaks retrieved and code parsed by
  # splitPeakCodes() and then we can save the PK for later purposes as needed.

  empty_sites &lt;- attr(PK, "empty_sites") # we harvest 08106350 as empty
  message("EMPTY SITES: ", paste(empty_sites, collapse=", "))

  PK &lt;- as.environment(PK) # now flipping to environment for the actually plotting
                           # plotting pass to follow next and retrieval is not made
  # save(empty_sites, PK, file="PEAKS.RData") # a way to save the work for later
  PK &lt;- plotPeaks_batch(sites, xlab="WATER YEAR",        lot=0, envir=PK,
                               ylab="STREAMFLOW, IN CFS", file=pdffile)
  message("Peaks plotted in file=", pdffile) # 
</code></pre>


</div>