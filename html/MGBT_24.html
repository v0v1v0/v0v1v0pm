<div class="container">

<table style="width: 100%;"><tr>
<td>RSlo</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Rosner RST Test Adjusted for Low Outliers </h2>

<h3>Description</h3>

<p>The Rosner (1975) method or the essence of the method, given the order statistics <code class="reqn">x_{[1:n]} \le x_{[2:n]} \le \cdots \le x_{[(n-1):n]} \le x_{[n:n]}</code>, is the statistic:
</p>
<p style="text-align: center;"><code class="reqn">RS_r =
\frac{ x_{[r:n]} - \mathrm{mean}\{x_{[(r+1)\rightarrow(n-r):n]}\} }
     {\sqrt{\mathrm{var}\{x_{[(r+1)\rightarrow(n-r):n]}\}}}\mbox{,}
</code>
</p>



<h3>Usage</h3>

<pre><code class="language-R">RSlo(x, r, n=length(x))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The data values and note that base-10 logarithms of these are not computed internally;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>The number of truncated observations; and</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The number of observations.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The value for <code class="reqn">RS_r</code>.
</p>


<h3>Note</h3>

<p>Regarding <code>n=length(x)</code>, it is not clear that TAC intended <code>n</code> to be not equal to the sample size. TAC chose to not determine the length of <code>x</code> internally to the function but to have it available as an argument. Also <code>MGBTcohn2011</code> and <code>BLlo</code> were similarly designed.
</p>


<h3>Author(s)</h3>

<p> W.H. Asquith consulting T.A. Cohn sources </p>


<h3>Source</h3>

<p><code>LowOutliers_jfe(R).txt</code> and <code>LowOutliers_wha(R).txt</code>—Named <code>RST</code>
</p>


<h3>References</h3>

<p>Cohn, T.A., 2013–2016, Personal communication of original R source code: U.S. Geological Survey, Reston, Va.
</p>
<p>Rosner, Bernard, 1975, On the detection of many outliers: Technometrics, v. 17, no. 2, pp. 221–227.
</p>


<h3>See Also</h3>

<p><code>MGBTcohn2011</code>, <code>BLlo</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Long CPU time, arguments slightly modified to run faster and TAC had.
# TAC has maxr=n/2 (the lower tail) but WHA has changed to maxr=3 for
# speed to get the function usable during automated tests.
testMGBvsN3 &lt;- function(n=100, maxr=3, nrep=10000) { # TAC named function
   for(r in 1:maxr) {
      set.seed(123457)
      res1 &lt;- replicate(nrep, { x &lt;- sort(rnorm(n))
                 c(MGBTcohn2011(x,r),BLlo(x,r),RSlo(x,r)) })
      r1 &lt;- rank(res1[1,]); r2 &lt;- rank(res1[2,]); r3 &lt;- rank(res1[3,])
      v &lt;- quantile(r1,.1); h &lt;- quantile(r2,.1)
      plot(r1,r2)
      abline(v=v, col=2); abline(h=h, col=2)
      message(' BLlo ',r, " ", cor(r1,r2), " ", mean((r1 &lt;= v) &amp; (r2 &lt;= h)))
      v &lt;- quantile(r1,.1); h &lt;- quantile(r2,.1)
      plot(r1,r3)
      abline(v=v, col=2); abline(h=h, col=2)
      mtext(paste0("Order statistic iteration =",r," of ",maxr))
      message('RSTlo ',r, " ", cor(r1,r3), " ", mean((r1 &lt;= v) &amp; (r3 &lt;= h)))
   }
}
testMGBvsN3() #
</code></pre>


</div>