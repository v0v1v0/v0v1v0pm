<div class="container">

<table style="width: 100%;"><tr>
<td>V</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>  Covariance matrix of M and S-squared </h2>

<h3>Description</h3>

<p>Compute the covariance matrix of <code class="reqn">M</code> and <code class="reqn">S^2</code> (S-squared) given <code class="reqn">q_\mathrm{min}</code>. Define the vector of four moment expectations
</p>
<p style="text-align: center;"><code class="reqn">E_{i\in 1,2,3,4} = \Psi\bigl(\Phi^{(-1)}(q_\mathrm{min}), i\bigr)\mbox{,}</code>
</p>

<p>where <code class="reqn">\Psi(a,b)</code> is the <code>gtmoms</code> function and <code class="reqn">\Phi^{(-1)}</code> is the inverse of the standard normal distribution. Using these <code class="reqn">E</code>, define a vector <code class="reqn">C_{i\in 1,2,3,4}</code> as a system of nonlinear combinations:
</p>
<p style="text-align: center;"><code class="reqn">C_1 = E_1\mbox{,}</code>
</p>

<p style="text-align: center;"><code class="reqn">C_2 = E_2 -     E_1^2\mbox{,}</code>
</p>

<p style="text-align: center;"><code class="reqn">C_3 = E_3 - 3E_2E_1 + 2E_1^3\mbox{, and}</code>
</p>

<p style="text-align: center;"><code class="reqn">C_4 = E_4 - 4E_3E_1 + 6E_2E_1^2 - 3E_1^4\mbox{.}</code>
</p>

<p>Given <code class="reqn">k = n - r</code> from the arguments of this function, compute the symmetrical covariance matrix <code class="reqn">COV</code> with variance of <code class="reqn">M</code> as
</p>
<p style="text-align: center;"><code class="reqn">COV_{1,1} = C_2/k\mbox{,}</code>
</p>

<p>the covariance between <code class="reqn">M</code> and <code class="reqn">S^2</code> as
</p>
<p style="text-align: center;"><code class="reqn">COV_{1,2} = COV_{2,1} = \frac{C_3}{\sqrt{k(k-1)}}\mbox{, and}</code>
</p>

<p>the variance of <code class="reqn">S^2</code> as
</p>
<p style="text-align: center;"><code class="reqn">COV_{2,2} = \frac{C_4 -  C_2^2}{k} + \frac{2C_2^2}{k(k-1)}\mbox{.}</code>
</p>



<h3>Usage</h3>

<pre><code class="language-R">V(n, r, qmin)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The number of observations;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>The number of truncated observations; and</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qmin</code></td>
<td>
<p>A nonexceedance probability threshold for <code class="reqn">X &gt; q_\mathrm{min}</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A 2-by-2 covariance <code>matrix</code>.
</p>


<h3>Note</h3>

<p>Because the <code>gtmoms</code> function is naturally vectorized and TAC sources provide no protection if <code>qmin</code> is a vector (see <b>Note</b> under <code>EMS</code>). For the implementation here, only the first value in <code>qmin</code> is used and a warning issued if it is a vector.
</p>


<h3>Author(s)</h3>

<p> W.H. Asquith consulting T.A. Cohn sources </p>


<h3>Source</h3>

<p><code>LowOutliers_jfe(R).txt</code>, <code>LowOutliers_wha(R).txt</code>, <code>P3_089(R).txt</code>—Named <code>V</code>
</p>


<h3>References</h3>

<p>Cohn, T.A., 2013–2016, Personal communication of original R source code: U.S. Geological Survey, Reston, Va.
</p>


<h3>See Also</h3>

<p><code>EMS</code>, <code>VMS</code>, <code>gtmoms</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">V(58,2,.5)
#            [,1]        [,2]
#[1,] 0.006488933 0.003928333
#[2,] 0.003928333 0.006851120
</code></pre>


</div>