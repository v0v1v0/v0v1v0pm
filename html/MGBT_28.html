<div class="container">

<table style="width: 100%;"><tr>
<td>VMS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>  Covariance matrix of M and S </h2>

<h3>Description</h3>

<p>Compute the covariance matrix of <code class="reqn">M</code> and <code class="reqn">S</code> given <code class="reqn">q_\mathrm{min}</code>.  Define the vector of four moment expectations
</p>
<p style="text-align: center;"><code class="reqn">E_{i\in 1,2} = \Psi\bigl(\Phi^{(-1)}(q_\mathrm{min}), i\bigr)\mbox{,}</code>
</p>

<p>where <code class="reqn">\Psi(a,b)</code> is the <code>gtmoms</code> function and <code class="reqn">\Phi^{(-1)}</code> is the inverse of the standard normal distribution. Define the scalar quantity <code class="reqn">Es = </code> <code>EMS(n,r,qmin)[2]</code> as the expectation of <code class="reqn">S</code> using the <code>EMS</code> function, and define the scalar quantity <code class="reqn">E_s^2 = E_2 - E_1^2</code> as the expectation of <code class="reqn">S^2</code>. Finally, compute the covariance matrix <code class="reqn">COV</code> of <code class="reqn">M</code> and <code class="reqn">S</code> using the <code>V</code> function:
</p>
<p style="text-align: center;"><code class="reqn">COV_{1,1} = V_{1,1}\mbox{,}</code>
</p>

<p style="text-align: center;"><code class="reqn">COV_{1,2} = COV_{2,1} = V_{1,2}/2Es\mbox{,}</code>
</p>

<p style="text-align: center;"><code class="reqn">COV_{2,2} = E_s^2 - (E_s)^2\mbox{.}</code>
</p>



<h3>Usage</h3>

<pre><code class="language-R">VMS(n, r, qmin)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The number of observations;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>The number of truncated observations; and</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qmin</code></td>
<td>
<p>A nonexceedance probability threshold for <code class="reqn">X &gt; q_\mathrm{min}</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A 2-by-2 covariance <code>matrix</code>.
</p>


<h3>Note</h3>

<p>Because the <code>gtmoms</code> function is naturally vectorized and TAC sources provide no protection if <code>qmin</code> is a vector (see <b>Note</b> under <code>EMS</code>). For the implementation here, only the first value in <code>qmin</code> is used and a warning issued if it is a vector.
</p>


<h3>Author(s)</h3>

<p> W.H. Asquith consulting T.A. Cohn sources </p>


<h3>Source</h3>

<p><code>LowOutliers_jfe(R).txt</code>, <code>LowOutliers_wha(R).txt</code>, <code>P3_089(R).txt</code>—Named <code>VMS</code>
</p>


<h3>References</h3>

<p>Cohn, T.A., 2013–2016, Personal communication of original R source code: U.S. Geological Survey, Reston, Va.
</p>


<h3>See Also</h3>

<p><code>EMS</code>, <code>V</code>, <code>gtmoms</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">VMS(58,2,.5) # Note that [1,1] is the same as [1,1] for Examples under V().
#            [,1]        [,2]
#[1,] 0.006488933 0.003279548
#[2,] 0.003279548 0.004682506
</code></pre>


</div>