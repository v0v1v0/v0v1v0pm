<div class="container">

<table style="width: 100%;"><tr>
<td>split_aggregate_CSV</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Split CSV output by Patch and Aggregate by Mate or Dwell-Stage</h2>

<h3>Description</h3>

<p>This function reads in the output files from <code>sim_trajectory_CSV</code>
and splits them into smaller files. The files are output by patch, with the
appropriate patch numbers for mosquitoes or humans, and specific stages are
aggregated by a given metric. <br></p>


<h3>Usage</h3>

<pre><code class="language-R">split_aggregate_CSV(
  read_dir,
  write_dir = read_dir,
  stage = c("E", "L", "P", "M", "U", "FS", "FE", "FI", "H"),
  spn_P,
  tmax,
  dt,
  erlang = FALSE,
  sum_fem = FALSE,
  rem_file = FALSE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>read_dir</code></td>
<td>
<p>Directory where output was written to</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>write_dir</code></td>
<td>
<p>Directory to write output to. Default is read_dir</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stage</code></td>
<td>
<p>Life stage to print, see details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spn_P</code></td>
<td>
<p>Places object, see details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tmax</code></td>
<td>
<p>The final time to end simulation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dt</code></td>
<td>
<p>The time-step at which to return output (<strong>not</strong> the time-step of the sampling algorithm)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>erlang</code></td>
<td>
<p>Boolean, default is FALSE, to return summaries by genotype</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sum_fem</code></td>
<td>
<p>if <code>TRUE</code>, in addition to FS, FE, FI output by node and repetition, output an
additional file F which sums over infection states (S,E,I). Does nothing if the
simulation did not include epi dynamics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rem_file</code></td>
<td>
<p>Remove original output? Default is FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Chatty? Default is TRUE</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given the <code>read_dir</code>, this function assumes the follow file structure: <br></p>

<ul><li>
<p> read_dir
</p>

<ul>
<li>
<p> repetition 1
</p>

<ul>
<li>
<p> M.csv
</p>
</li>
<li>
<p> FS.csv
</p>
</li>
<li>
<p> ... <br></p>
</li>
</ul>
</li>
<li>
<p> repetition 2
</p>

<ul>
<li>
<p> M.csv
</p>
</li>
<li>
<p> FS.csv
</p>
</li>
<li>
<p> ... <br></p>
</li>
</ul>
</li>
<li>
<p> repetition 3
</p>
</li>
<li>
<p> ... <br></p>
</li>
</ul>
</li></ul>
<p>This function expects the <code>write_dir</code> to be empty, and it sets up the
same file structure as the <code>read_dir</code>. For a 2-node simulation, the output
will be organized similar to: <br></p>

<ul><li>
<p> write_dir
</p>

<ul>
<li>
<p> repetition 1
</p>

<ul>
<li>
<p> M_0001.csv
</p>
</li>
<li>
<p> M_0002.csv
</p>
</li>
<li>
<p> FS_0001.csv
</p>
</li>
<li>
<p> FS_0001.csv
</p>
</li>
<li>
<p> ... <br></p>
</li>
</ul>
</li>
<li>
<p> repetition 2
</p>

<ul>
<li>
<p> M_0001.csv
</p>
</li>
<li>
<p> M_0002.csv
</p>
</li>
<li>
<p> FS_0001.csv
</p>
</li>
<li>
<p> FS_0001.csv
</p>
</li>
<li>
<p> ... <br></p>
</li>
</ul>
</li>
<li>
<p> repetition 3
</p>
</li>
<li>
<p> ... <br></p>
</li>
</ul>
</li></ul>
<p><code>stage</code> defines which life-stages the function will analyze. These stages
must be any combination of: "E", "L", "P", "M", "U", "FS", "FE", "FI", "H".
These must come from the set of stages provided to <code>sim_trajectory_CSV</code>
via the <code>stage</code> argument. It can be less than what was printed by the simulation,
but any extra stages provided, but not printed, will throw a warning and then
be ignored.
</p>
<p><code>erlang</code> defines how aquatic (eggs, larvae, and pupae) stages and adult females
(only mated females) are aggregated. By default, <code>erlang</code> is FALSE, and
all of these stages are summarized by genotype only, combining any Erlang-distributed
dwell stages (for eggs, larvae, and pupae) or latent infection (for adult females)
stages. If <code>erlang</code> is TRUE, summaries are returned by dwell stage or infection
status, combining any genotype information. <br>
Female summaries always combine over mate-genotype, so only female genotypes
are returned.
</p>
<p>The places (<code>spn_P</code>) object is generated from one of the following:
<code>spn_P_lifecycle_node</code>, <code>spn_P_lifecycle_network</code>,
<code>spn_P_epiSIS_node</code>, <code>spn_P_epiSIS_network</code>,
<code>spn_P_epiSEIR_node</code>, or <code>spn_P_epiSEIR_network</code>.
</p>
<p><code>tmax</code>, <code>dt</code> define the last sampling
time, and each sampling time in-between.
</p>
<p>For more details about using this function to process CSV output see:
<code>vignette("data-analysis", package = "MGDrivE2")</code>
</p>


<h3>Value</h3>

<p>Writes output to files in write_dir
</p>


</div>