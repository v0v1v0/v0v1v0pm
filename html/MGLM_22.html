<div class="container">

<table style="width: 100%;"><tr>
<td>dist</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Details of the distributions
</h2>

<h3>Description</h3>

<p>An object that specifies the distribution to be fitted by the <code>MGLMfit</code> function, or the regression model to be fitted by the <code>MGLMreg</code> or <code>MGLMsparsereg</code> functions.
Can be chosen from <code>"MN"</code>, <code>"DM"</code>, <code>"NegMN"</code>, or <code>"GDM"</code>.
</p>


<h3>Details</h3>



<h4>"MN": Multinomial distribution</h4>

<p>A multinomial distribution models the counts of <code class="reqn">d</code> possible outcomes.
The counts of categories are negatively correlated. 
The density of a <code class="reqn">d</code> category count vector <code class="reqn">y</code> with parameter 
<code class="reqn">p=(p_1, \ldots, p_d)</code> is
</p>
<p style="text-align: center;"><code class="reqn">
P(y|p) = C_{y_1, \ldots, y_d}^{m} \prod_{j=1}^{d} p_j^{y_j},
</code>
</p>

<p>where <code class="reqn">m = \sum_{j=1}^d y_j</code>, <code class="reqn">0 &lt; p_j &lt; 1</code>, and <code class="reqn">\sum_{j=1}^d p_j = 1</code>. 
Here, <code class="reqn">C_k^n</code>, often read as "<code class="reqn">n</code> choose <code class="reqn">k</code>", refers the number of <code class="reqn">k</code> combinations from a set of <code class="reqn">n</code> elements.
</p>
<p>The <code>MGLMreg</code> function with <code>dist="MN"</code> calculates the MLE of regression coefficients <code class="reqn">\beta_j</code> of the multinomial logit model, which has link function <code class="reqn">p_j = exp(X\beta_j)/(1 + \sum_{j=1}^{d-1} exp(X\beta_j))</code>, <code class="reqn">j=1,\ldots,d-1</code>. The <code>MGLMsparsereg</code> function with <code>dist="MN"</code> fits regularized multinomial logit model.
</p>



<h4>"DM": Dirichlet multinomial distribution</h4>

<p>When the multivariate count data exhibits over-dispersion, the traditional 
multinomial model is insufficient.  Dirichlet multinomial distribution models the
probabilities of the categories by a Dirichlet distribution.  
The density of a <code class="reqn">d</code> category count vector <code class="reqn">y</code>, with 
parameter <code class="reqn">\alpha = (\alpha_1, \ldots, \alpha_d)</code>,
<code class="reqn">\alpha_j &gt; 0</code>, is
</p>
<p style="text-align: center;"><code class="reqn"> 
  P(y|\alpha) = C_{y_1, \ldots, y_d}^{m} \prod_{j=1}^{d} 
  \frac{\Gamma(\alpha_j+y_j)}{\Gamma(\alpha_j)}
  \frac{\Gamma(\sum_{j'=1}^d \alpha_{j'})}{\Gamma(\sum_{j'=1}^d \alpha_{j'} + \sum_{j'=1}^d y_{j'})},
  </code>
</p>

<p>where <code class="reqn">m=\sum_{j=1}^d y_j</code>. Here, <code class="reqn">C_k^n</code>, often read as "<code class="reqn">n</code> choose <code class="reqn">k</code>", 
refers the number of <code class="reqn">k</code> combinations from a set of <code class="reqn">n</code> elements.
</p>
<p>The <code>MGLMfit</code> function with <code>dist="DM"</code> calculates the maximum likelihood estimate (MLE) of <code class="reqn">(\alpha_1, \ldots, \alpha_d)</code>. The <code>MGLMreg</code> function with <code>dist="DM"</code> calculates the MLE of regression coefficients <code class="reqn">\beta_j</code> of the Dirichlet multinomial regression model, which has link function <code class="reqn">\alpha_j = exp(X\beta_j)</code>, <code class="reqn">j=1,\ldots,d</code>. The <code>MGLMsparsereg</code> function with <code>dist="DM"</code> fits regularized Dirichlet multinomial regression model.
</p>



<h4>"GDM": Generalized Dirichlet multinomial distribution</h4>

<p>The more flexible Generalized Dirichlet multinomial model can be used when the counts of categories have both positive and negative correlations. 
The probability mass of a count vector <code class="reqn">y</code> over <code class="reqn">m</code> trials with parameter
<code class="reqn">(\alpha, \beta)=(\alpha_1, \ldots, \alpha_{d-1}, \beta_1, \ldots, \beta_{d-1})</code>,
<code class="reqn">\alpha_j, \beta_j &gt; 0</code>, is
</p>
<p style="text-align: center;"><code class="reqn">
P(y|\alpha,\beta)
=C_{y_1, \ldots, y_d}^{m} \prod_{j=1}^{d-1} 
\frac{\Gamma(\alpha_j+y_j)}{\Gamma(\alpha_j)}
\frac{\Gamma(\beta_j+z_{j+1})}{\Gamma(\beta_j)}
\frac{\Gamma(\alpha_j+\beta_j)}{\Gamma(\alpha_j+\beta_j+z_j)}  ,
</code>
</p>

<p>where <code class="reqn">z_j = \sum_{k=j}^d y_k</code> and <code class="reqn">m=\sum_{j=1}^d y_j</code>. Here, <code class="reqn">C_k^n</code>, often read as "<code class="reqn">n</code> choose <code class="reqn">k</code>", 
#' refers the number of <code class="reqn">k</code> combinations from a set of <code class="reqn">n</code> elements.
</p>
<p>The <code>MGLMfit</code> with <code>dist="GDM"</code> calculates the MLE of <code class="reqn">(\alpha, \beta)=(\alpha_1, \ldots, \alpha_{d-1}, \beta_1, \ldots, \beta_{d-1})</code>. The <code>MGLMreg</code> function with <code>dist="GDM"</code> calculates the MLE of regression coefficients <code class="reqn">\alpha_j, \beta_j</code> of the generalized Dirichlet multinomial regression model, which has link functions <code class="reqn">\alpha_j=exp(X\alpha_j)</code> and <code class="reqn">\beta_j=exp(X\beta_j)</code>, <code class="reqn">j=1, \ldots, d-1</code>. The <code>MGLMsparsereg</code> function with <code>dist="GDM"</code> fits regularized generalized Dirichlet multinomial regression model.
</p>



<h4>"NegMN": Negative multinomial distribution</h4>

<p>Both the multinomial distribution and Dirichlet multinomial distribution are good for 
negatively correlated counts.  When the counts of categories are positively 
correlated, the negative multinomial distribution is preferred.  
The probability mass function of a <code class="reqn">d</code> category count vector <code class="reqn">y</code> with parameter
<code class="reqn">(p_1, \ldots, p_{d+1}, \beta)</code>, <code class="reqn">\sum_{j=1}^{d+1} p_j=1</code>, <code class="reqn">p_j &gt; 0</code>, <code class="reqn">\beta &gt; 0</code>, is
</p>
<p style="text-align: center;"><code class="reqn">
P(y|p,\beta) =  C_{m}^{\beta+m-1}  C_{y_1, \ldots, y_d}^{m} 
\prod_{j=1}^d p_j^{y_j} p_{d+1}^\beta \\
= \frac{\beta_m}{m!}  C_{y_1, \ldots, y_d}^{m}  
\prod_{j=1}^d p_j^{y_j} p_{d+1}^\beta,
</code>
</p>

<p>where <code class="reqn">m = \sum_{j=1}^d y_j</code>. Here, <code class="reqn">C_k^n</code>, often read as "<code class="reqn">n</code> choose <code class="reqn">k</code>", refers the number of <code class="reqn">k</code> combinations from a set of <code class="reqn">n</code> elements.
</p>
<p>The <code>MGLMfit</code> function with <code>dist="NegMN"</code> calculates the MLE of <code class="reqn">(p_1, \ldots, p_{d+1}, \beta)</code>. The <code>MGLMreg</code> function with <code>dist="NegMN"</code> and <code>regBeta=FALSE</code> calculates the MLE of regression coefficients <code class="reqn">(\alpha_1,\ldots,\alpha_d, \beta)</code> of the negative multinomial regression model, which has link function <code class="reqn">p_{d+1} = 1/(1 + \sum_{j=1}^d exp(X\alpha_j))</code>, <code class="reqn">p_j = exp(X\alpha_j) p_{d+1}</code>, <code class="reqn">j=1, \ldots, d</code>. When <code>dist="NegMN"</code> and <code>regBeta=TRUE</code>, the overdispersion parameter is linked to covariates via <code class="reqn">\beta=exp(X\alpha_{d+1})</code>, and the 
function <code>MGLMreg</code> outputs an estimated matrix of 
<code class="reqn">(\alpha_1, \ldots, \alpha_{d+1})</code>. The <code>MGLMsparsereg</code> function with <code>dist="NegMN"</code> fits regularized negative multinomial regression model.
</p>



<h3>Author(s)</h3>

<p>Yiwen Zhang and Hua Zhou
</p>


<h3>See Also</h3>

<p><code>MGLMfit</code>, <code>MGLMreg</code>, <code>MGLMsparsereg</code>,
<code>dmn</code>, <code>ddirmn</code>, <code>dgdirmn</code>, <code>dnegmn</code>
</p>


</div>