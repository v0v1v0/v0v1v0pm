<div class="container">

<table style="width: 100%;"><tr>
<td>rmn</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The Multinomial Distribution</h2>

<h3>Description</h3>

<p><code>rmn</code> generates random number vectors given <code>alpha</code>. 
The function <code>rmn(n, size, alpha)</code> calls <code>rmultinom(n, size, prob)</code> after converting <code>alpha</code> to probability. 
<code>dmn</code> computes the log of multinomial probability mass function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rmn(n, size, alpha)

dmn(Y, prob)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of random vectors to generate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>a scalar or a vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>a vector or a matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>the multivariate count matrix with dimension <code class="reqn">n \times d</code>, where 
<code class="reqn">n = 1,2,\ldots</code> is number of observations and <code class="reqn">d=2,\ldots</code> is number of categories.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>the probability parameter of the multinomial distribution.  <code>prob</code>
can be either a vector of length <code class="reqn">d</code> or a matrix with matching 
size of <code>Y</code>.  If <code>prob</code> is a vector, it will be replicated <code class="reqn">n</code> 
times to match the dimension of <code>Y</code>. If the sum(s) of <code>prob</code> is not 1, it will be automatically scaled to have sum 1.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A multinomial distribution models the counts of <code class="reqn">d</code> possible outcomes.
The counts of categories are negatively correlated. 
<code class="reqn">y=(y_1, \ldots, y_d)</code> is a <code class="reqn">d</code> category count vector. 
Given the parameter vector <code class="reqn">p = (p_1, \ldots, p_d)</code>, <code class="reqn">0 &lt; p_j &lt; 1</code>, 
<code class="reqn">\sum_{j=1}^d p_j = 1</code>, the function calculates the log of the multinomial pmf
</p>
<p style="text-align: center;"><code class="reqn">
  P(y|p) = C_{y_1, \ldots, y_d}^{m} \prod_{j=1}^{d} p_j^{y_j},
</code>
</p>

<p>where <code class="reqn">m=\sum_{j=1}^d y_j</code>. Here, <code class="reqn">C_k^n</code>, often read as "<code class="reqn">n</code> choose <code class="reqn">k</code>", 
refers the number of <code class="reqn">k</code> combinations from a set of <code class="reqn">n</code> elements.
</p>
<p>The parameter <code class="reqn">p</code> can be one vector, like the result from the distribution
fitting function; or, <code class="reqn">p</code> can be a matrix with <code class="reqn">n</code> rows, like the estimate
from the regression function, 
</p>
<p style="text-align: center;"><code class="reqn">p_j = \frac{exp(X \beta_j)}{1 + sum_{j'=1}^{d-1} exp(X\beta_{j'})},</code>
</p>
<p> where <code class="reqn">j=1,\ldots,d-1</code>
and <code class="reqn">p_d = \frac{1}{1 + \sum_{j'=1}^{d-1} exp(X\beta_{j'})}</code>.
The <code class="reqn">d</code>-th column of the coefficient matrix <code class="reqn">\beta</code> is set to <code class="reqn">0</code> to avoid the identifiability issue.
</p>


<h3>Value</h3>

<p>The function <code>dmn</code> returns the value of <code class="reqn">\log(P(y|p))</code>. 
When <code>Y</code> is a matrix of <code class="reqn">n</code> rows, the function returns a 
vector of length <code class="reqn">n</code>. 
</p>
<p>The function <code>rmn</code> returns multinomially distributed random number vectors
</p>


<h3>Author(s)</h3>

<p>Yiwen Zhang and Hua Zhou
</p>


<h3>Examples</h3>

<pre><code class="language-R">m &lt;- 20
prob &lt;- c(0.1, 0.2)
dm.Y &lt;- rdirmn(n=10, m, prob)	
pdfln &lt;- dmn(dm.Y, prob)
</code></pre>


</div>