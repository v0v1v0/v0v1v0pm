<div class="container">

<table style="width: 100%;"><tr>
<td>rnegmn</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The Negative Multinomial Distribution</h2>

<h3>Description</h3>

<p><code>dnegmn</code> calculates the log of the negative multinomial probability mass function. 
<code>rnegmn</code> generates random observations from the negative multinomial distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rnegmn(n, beta, prob)

dnegmn(Y, beta, prob = alpha/(rowSums(alpha) + 1), alpha = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of random vectors to generate.  When <code>beta</code> is a scalar and <code>prob</code> is a vector, 
must specify <code>n</code>.  When <code>beta</code> is a vector and <code>prob</code> is a matrix, <code>n</code> is optional.
The default value of <code>n</code> is the length of <code>beta</code>. If given, <code>n</code> should be equal to 
the length of <code>beta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>the over dispersion parameter of the negative multinomial distribution. <code>beta</code> can be either a scalar or a vector of length <code class="reqn">n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>the probability parameter of the negative multinomial distribution. Should be a numerical non-negative vector or matrix.
</p>
<p>For <code>dnegmn</code>, <code>prob</code> can be either
a vector of length <code class="reqn">d</code> <code class="reqn">(d \ge 2)</code> or a matrix with matching size of <code>Y</code>.  
If <code>prob</code> is a vector, it will 
be replicated <code class="reqn">n</code> times to match the dimension of <code>Y</code>.  The sum
of each row of <code>prob</code> should be smaller than 1. 
</p>
<p>For <code>rnegmn</code>, If <code>prob</code> is a vector, <code>beta</code>
must be a scalar.  All the <code>n</code> random vectors will be drawn from the
same <code>prob</code> and <code>beta</code>.  If <code>prob</code> is a matrix, the number of rows should 
match the length of <code>beta</code>.  Each random vector will be drawn from
the corresponding row of <code>prob</code> and the corresponding element of <code>beta</code>. Each row of <code>prob</code> should have sum less than 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>the multivariate response matrix of dimension <code class="reqn">n \times d</code>, 
where <code class="reqn">n = 1, 2, \ldots</code> is number of observations and <code class="reqn">d=2,3,\ldots</code> is number of categories.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>an alternative way to specify the probability. Default value is <code>NULL</code>. See details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code class="reqn">y=(y_1, \ldots, y_d)</code> is a <code class="reqn">d</code> category vector. Given the parameter vector <code class="reqn">p= (p_1, \ldots, p_d)</code>,
<code class="reqn">p_{d+1} = 1/(1 + \sum_{j'=1}^d p_{j'})</code>, 
and <code class="reqn">\beta</code>, <code class="reqn">\beta&gt;0</code>, the negative multinomial probability mass function is 
</p>
<p style="text-align: center;"><code class="reqn">
  P(y|p,\beta) =  C_{m}^{\beta+m-1}  C_{y_1, \ldots, y_d}^{m} 
  \prod_{j=1}^d p_j^{y_j} p_{d+1}^\beta = \frac{\beta_m}{m!}  {m \choose y_1, \ldots, y_d} \prod_{j=1}^d p_j^{y_j} p_{d+1}^\beta,
</code>
</p>

<p>where <code class="reqn">m = \sum_{j=1}^d y_j</code>. Here, <code class="reqn">C_k^n</code>, often read as "<code class="reqn">n</code> choose <code class="reqn">k</code>", 
refers the number of <code class="reqn">k</code> combinations from a set of <code class="reqn">n</code> elements.
</p>
<p><code>alpha</code> is an alternative way to specify the probability: 
</p>
<p style="text-align: center;"><code class="reqn">p_j = \frac{\alpha_j}{(1+\sum_{k=1}^{d} \alpha_k)}</code>
</p>
<p> for <code class="reqn">j=1,\ldots,d</code> and 
<code class="reqn">p_{d+1} = \frac{1}{(1+\sum_{k=1}^{d} \alpha_k)}</code>. 
</p>
<p>The parameter <code>prob</code> can be a vector and <code>beta</code> is a scalar; <code>prob</code> can also
be a matrix with <code class="reqn">n</code> rows, and <code>beta</code> is a vector of length <code class="reqn">n</code>
like the estimate from the regression function
multiplied by the covariate matrix.
</p>


<h3>Value</h3>

<p><code>dnegmn</code> returns the value of 
<code class="reqn">\log(P(y|p, \beta) )</code>.  When <code>Y</code> is a matrix of <code class="reqn">n</code> rows, the function
returns a vector of length <code class="reqn">n</code>.
</p>
<p><code>rnegmn</code> returns a <code class="reqn">n\times d</code> matrix of the generated random observations.
</p>


<h3>Author(s)</h3>

<p>Yiwen Zhang and Hua Zhou
</p>


<h3>Examples</h3>

<pre><code class="language-R">###-----------------------###
set.seed(128)
n &lt;- 100
d &lt;- 4
p &lt;- 5
a &lt;- -matrix(1,p,d)
X &lt;- matrix(runif(n*p), n, p )
alpha &lt;- exp(X%*%a)
prob &lt;- alpha/(rowSums(alpha)+1)
beta &lt;- exp(X%*%matrix(1,p)) 
Y &lt;- rnegmn(n, beta, prob)

###-----------------------###
m &lt;- 20
n &lt;- 10
p &lt;- 5
d &lt;- 6
a &lt;- -matrix(1,p,d)
X &lt;- matrix(runif(n*p), n, p )
alpha &lt;- exp(X%*%a)
prob &lt;- alpha/(rowSums(alpha)+1)
b &lt;- exp(X%*%rep(0.3,p)) 
Y &lt;- rnegmn(prob=prob, beta=rep(10, n))
dnegmn(Y, b, prob)

</code></pre>


</div>