<div class="container">

<table style="width: 100%;"><tr>
<td>MGLMreg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit multivariate response GLM regression</h2>

<h3>Description</h3>

<p><code>MGLMreg</code> fits multivariate response generalized linear models, specified by a symbolic description of the linear predictor and a description of the error distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MGLMreg(
  formula,
  data,
  dist,
  init = NULL,
  weight = NULL,
  epsilon = 1e-08,
  maxiters = 150,
  display = FALSE,
  LRT = FALSE,
  parallel = FALSE,
  cores = NULL,
  cl = NULL,
  sys = NULL,
  regBeta = FALSE
)

MGLMreg.fit(
  Y,
  init = NULL,
  X,
  dist,
  weight = NULL,
  epsilon = 1e-08,
  maxiters = 150,
  display = FALSE,
  LRT = FALSE,
  parallel = FALSE,
  cores = NULL,
  cl = NULL,
  sys = NULL,
  regBeta = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class <code>formula</code> (or one that can be coerced to that class): a symbolic description of the model to be fitted. The response has to be on the left hand side of ~.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame, list or environment (or object coercible by as.data.frame to a data frame) containing the variables in the model. If not found in <code>data</code> when using function <code>MGLMreg</code>, the variables are taken from <code>environment(formula)</code>, typically the environment from which <code>MGLMreg</code> is called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>a description of the error distribution to fit. See <code>dist</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>an optional matrix of initial value of the parameter estimates. Should have the compatible dimension with <code>data</code>. See <code>dist</code> for details of the dimensions in each distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>an optional vector of weights assigned to each row of the data. Should be <code>NULL</code> or a numeric vector. Could be a variable from <code>data</code>, or a variable from <code>environment(formula)</code> with the length equal to the number of rows of the data. If <code>weight=NULL</code>, equal weights of ones will be assigned. Default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>an optional numeric controlling the stopping criterion. The algorithm terminates when the relative change in the loglikelihoods of two successive iterates is less than <code>epsilon</code>.  The default value is <code>epsilon=1e-8</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiters</code></td>
<td>
<p>an optional numeric controlling the maximum number of iterations. The default value is <code>maxiters=150</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>display</code></td>
<td>
<p>an optional logical variable controlling the display of iterations. The default value is <code>display=FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LRT</code></td>
<td>
<p>an optional logical variable controlling whether to perform likelihood ratio test on each predictor. The default value is <code>LRT=FALSE</code>, in which case only the Wald test is performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>an optional logical variable controlling whether to perform parallel computing. On a multi-core Windows machine, a cluster is created based on socket; on a multi-core Linux/Mac machine, a cluster is created based on forking. The default value is <code>parallel=FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cores</code></td>
<td>
<p>an optional value specifying the number of cores to use. Default value is half of the logical cores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>
<p>a cluster object, created by the package <span class="pkg">parallel</span> or by package <span class="pkg">snow</span>. If <code>parallel=TRUE</code>, use the registered default cluster; if <code>parallel=FALSE</code>, any given value to <code>cl</code> will be ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sys</code></td>
<td>
<p>the operating system.  Will be used when choosing parallel type.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regBeta</code></td>
<td>
<p>an optional logical variable.  When <code>dist="NegMN"</code>, the user can decide whether to run regression on the overdispersion parameter <code class="reqn">\beta</code>.  The default is <code>regBeta=FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y, X</code></td>
<td>
<p>for <code>MGLMreg.fit</code>, <code>X</code> is a design matrix of dimension <code>n*(p+1)</code> and <code>Y</code> is the response matrix of dimension <code>n*d</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The formula should be in the form responses ~ covariates where the responses are the multivariate count matrix or a few columns from a data frame which is specified by <code>data</code>. The covariates are either matrices or from the data frame.  The covariates can be numeric or character or factor. 
See <code>dist</code> for details about distributions. 
</p>
<p>Instead of using the formula, the user can directly input the design matrix and the response vector using <code>MGLMreg.fit</code> function.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>"MGLMreg"</code>. An object of class <code>"MGLMreg"</code> is a list containing the following components: </p>

<ul>
<li>
<p><code>coefficients</code> the estimated regression coefficients.
</p>
</li>
<li>
<p><code>SE</code> the standard errors of the estimates.
</p>
</li>
<li>
<p><code>Hessian</code> the Hessian at the estimated parameter values.
</p>
</li>
<li>
<p><code>gradient</code> the gradient at the estimated parameter values.
</p>
</li>
<li>
<p><code>wald.value</code> the Wald statistics.
</p>
</li>
<li>
<p><code>wald.p</code> the p values of Wald test.
</p>
</li>
<li>
<p><code>test</code> test statistic and the corresponding p-value. If <code>LRT=FALSE</code>, only returns test resultsfrom Wald test; if <code>LRT=TRUE</code>, returns the test results from both Wald test and likelihood ratio test.
</p>
</li>
<li>
<p><code>logL</code> the final loglikelihood.
</p>
</li>
<li>
<p><code>BIC</code> Bayesian information criterion. 
</p>
</li>
<li>
<p><code>AIC</code> Akaike information criterion.
</p>
</li>
<li>
<p><code>fitted</code> the fitted values from the regression model
</p>
</li>
<li>
<p><code>iter</code> the number of iterations used.
</p>
</li>
<li>
<p><code>call</code> the matched call.
</p>
</li>
<li>
<p><code>distribution</code> the distribution fitted.
</p>
</li>
<li>
<p><code>data</code> the data used to fit the model.
</p>
</li>
<li>
<p><code>Dof</code> degrees of freedom.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Yiwen Zhang and Hua Zhou
</p>


<h3>See Also</h3>

<p>See also <code>MGLMfit</code> for distribution fitting.
</p>


<h3>Examples</h3>

<pre><code class="language-R">##----------------------------------------##
## Generate data
n &lt;- 2000
p &lt;- 5
d &lt;- 4
m &lt;- rep(20, n)
set.seed(1234)
X &lt;- 0.1* matrix(rnorm(n*p),n, p)
alpha &lt;- matrix(1, p, d-1)
beta &lt;- matrix(1, p, d-1)
Alpha &lt;- exp(X %*% alpha)
Beta &lt;- exp(X %*% beta)
gdm.Y &lt;- rgdirmn(n, m, Alpha, Beta)

##----------------------------------------##
## Regression
gdm.reg &lt;- MGLMreg(gdm.Y~X, dist="GDM", LRT=FALSE)


</code></pre>


</div>