<div class="container">

<table style="width: 100%;"><tr>
<td>MGLMtune</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Choose the tuning parameter value in sparse regression</h2>

<h3>Description</h3>

<p>Finds the tuning parameter value that yields the smallest BIC.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MGLMtune(
  formula,
  data,
  dist,
  penalty,
  lambdas,
  ngridpt,
  warm.start = TRUE,
  keep.path = FALSE,
  display = FALSE,
  init,
  weight,
  penidx,
  ridgedelta,
  maxiters = 150,
  epsilon = 1e-05,
  regBeta = FALSE,
  overdisp
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class <code>formula</code> (or one that can be coerced to that class): a symbolic description of the model to be fitted. The response has to be on the left hand side of ~.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame, list or environment (or object coercible by <code>as.data.frame</code> to a data frame) containing the variables in the model. If not found in <code>data</code> when using function <code>MGLMtune</code>, the variables are taken from <code>environment(formula)</code>, typically the environment from which <code>MGLMtune</code> is called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>a description of the distribution to fit. See <code>dist</code> for the details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>
<p>penalty type for the regularization term. Can be chosen from <code>"sweep"</code>, <code>"group"</code>, or <code>"nuclear"</code>. See MGLMsparsereg for the description of each penalty type.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambdas</code></td>
<td>
<p>an optional vector of the penalty values to tune.  If missing, the vector of penalty values will be set inside the function.  <code>ngridpt</code> must be provided if <code>lambdas</code> is missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ngridpt</code></td>
<td>
<p>an optional numeric variable specifying the number of grid points to tune.  If <code>lambdas</code> is given, <code>ngridpt</code> will be ignored.  Otherwise, the maximum <code class="reqn">\lambda</code> is determined from the data.  The smallest <code class="reqn">\lambda</code>is set to <code class="reqn">1/n</code>, where <code class="reqn">n</code> is the sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warm.start</code></td>
<td>
<p>an optional logical variable to specify whether to give warm start at each tuning grid point.  If <code>warm.start=TRUE</code>, the fitted sparse regression coefficients will be used as the initial value when fitting the sparseregression with the next tuning grid.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep.path</code></td>
<td>
<p>an optional logical variable controling whether to output the whole solution path. The default is <code>keep.path=FALSE</code>. If <code>keep.path=TRUE</code>, the sparse regression result at each grid point will be kept, and saved in the output object <code>select.list</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>display</code></td>
<td>
<p>an optional logical variable to specify whether to show each tuning step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>an optional matrix of initial value of the parameter estimates. Should have the compatible dimension with the data. See <code>dist</code> for details of dimensions in each distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>an optional vector of weights assigned to each row of the data. Should be <code>NULL</code> or a numeric vector. Could be a variable from the <code>data</code>, or a variable from <code>environment(formula)</code> with the length equal to the number of rows of the data. If <code>weight=NULL</code>, equal weights of ones will be assigned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penidx</code></td>
<td>
<p>a logical vector indicating the variables to be penalized. The default value is <code>rep(TRUE, p)</code>, which means all predictors are subject to regularization. If <code>X</code> contains intercept, use <code>penidx=c(FALSE,rep(TRUE,p-1))</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ridgedelta</code></td>
<td>
<p>an optional numeric controlling the behavior of the Nesterov's accelerated proximal gradient method. The default value is <code class="reqn">\frac{1}{pd}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiters</code></td>
<td>
<p>an optional numeric controlling the maximum number of iterations. The default value is <code>maxiters=150</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>an optional numeric controlling the stopping criterion. The algorithm terminates when the relative change in the objective values of two successive iterates is less then <code>epsilon</code>. The default value is <code>epsilon=1e-5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regBeta</code></td>
<td>
<p>an optional logical variable used when running negative multinomial regression (<code>dist="NegMN"</code>). <code>regBeta</code> controls whether to run regression on the over-dispersion parameter. The default is <code>regBeta=FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overdisp</code></td>
<td>
<p>an optional numerical variable used only when fitting sparse negative multinomial model and <code>regBeta=FALSE</code>.  <code>overdisp</code> gives the over-dispersion value for all the observations.  The default value is estimated using negative-multinomial regression.  When <code>dist="MN", "DM", "GDM"</code> or <code>regBeta=TRUE</code>, the value of <code>overdisp</code> is ignored.</p>
</td>
</tr>
</table>
<h3>Value</h3>


<ul>
<li>
<p><code>select</code> the final sparse regression result, using the optimal tuning parameter.
</p>
</li>
<li>
<p><code>path</code> a data frame with degrees of freedom and BICs at each lambda.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Yiwen Zhang and Hua Zhou
</p>


<h3>See Also</h3>

<p><code>MGLMsparsereg</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(118)
n &lt;- 50
p &lt;- 10
d &lt;- 5
m &lt;- rbinom(n, 100, 0.8)
X &lt;- matrix(rnorm(n * p), n, p)
alpha &lt;- matrix(0, p, d)
alpha[c(1, 3, 5), ] &lt;- 1
Alpha &lt;- exp(X %*% alpha)
Y &lt;- rdirmn(size=m, alpha=Alpha)
sweep &lt;- MGLMtune(Y ~ 0 + X, dist="DM", penalty="sweep", ngridpt=10)
show(sweep)


</code></pre>


</div>