<div class="container">

<table style="width: 100%;"><tr>
<td>rdirmn</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The Dirichlet Multinomial Distribution</h2>

<h3>Description</h3>

<p><code>ddirmn</code> computes the log of the Dirichlet multinomial probability mass function.
<code>rdirmn</code> generates Dirichlet multinomially distributed random number vectors.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rdirmn(n, size, alpha)

ddirmn(Y, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of random vectors to generate.  When <code>size</code> is a scalar and <code>alpha</code> is a vector, 
must specify <code>n</code>.  When <code>size</code> is a vector and <code>alpha</code> is a matrix, <code>n</code> is optional.
The default value of <code>n</code> is the length of <code>size</code>. If given, <code>n</code> should be equal to 
the length of <code>size</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>a number or vector specifying the total number of objects that are put
into d categories in the Dirichlet multinomial distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>the parameter of the Dirichlet multinomial distribution. Can be a numerical positive vector or matrix.
For <code>ddirmn</code>, <code>alpha</code> has to match the size of <code>Y</code>. If <code>alpha</code> 
is a vector, it will be replicated <code class="reqn">n</code> times to match the dimension of <code>Y</code>.
</p>
<p>For <code>rdirmn</code>, if <code>alpha</code> is a vector, <code>size</code> must be a scalar, and all the random vectors will
be drawn from the same <code>alpha</code> and <code>size</code>.  
If <code>alpha</code> is a matrix, the number of rows should match the length of 
<code>size</code>, and each random vector 
will be drawn from the corresponding row of <code>alpha</code> and the corresponding
element in the <code>size</code> vector. See Details below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>The multivariate count matrix with dimensions <code class="reqn">n \times d</code>, where 
<code class="reqn">n = 1,2, \ldots</code> is the number of observations and <code class="reqn">d=2,3, \ldots</code> is the number of categories.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When the multivariate count data exhibits over-dispersion, the traditional 
multinomial model is insufficient. Dirichlet multinomial distribution models the
probabilities of the categories by a Dirichlet distribution. 
Given the parameter vector <code class="reqn">\alpha = (\alpha_1, \ldots, \alpha_d), \alpha_j&gt;0  </code>, 
the probability mass of <code class="reqn">d</code>-category count vector <code class="reqn">Y=(y_1, \ldots, y_d)</code>, <code class="reqn">d \ge 2</code> 
under Dirichlet multinomial distribution is
</p>
<p style="text-align: center;"><code class="reqn">
 P(y|\alpha) = C_{y_1, \ldots, y_d}^{m} \prod_{j=1}^{d} 
 \frac{\Gamma(\alpha_j+y_j)}{\Gamma(\alpha_j)}
 \frac{\Gamma(\sum_{j'=1}^d \alpha_{j'})}{\Gamma(\sum_{j'=1}^d \alpha_{j'} + \sum_{j'=1}^d y_{j'})},
 </code>
</p>

<p>where <code class="reqn">m=\sum_{j=1}^d y_j</code>. Here, <code class="reqn">C_k^n</code>, often read as "<code class="reqn">n</code> choose <code class="reqn">k</code>", 
refers the number of <code class="reqn">k</code> combinations from a set of <code class="reqn">n</code> elements.
</p>
<p>The parameter <code class="reqn">\alpha</code> can be a vector of length <code class="reqn">d</code>, 
such as the results from the distribution fitting.
<code class="reqn">\alpha</code> can also be a matrix with <code class="reqn">n</code> rows, such as the inverse link  
calculated from the regression parameter estimate <code class="reqn">exp(X\beta)</code>.
</p>


<h3>Value</h3>

<p>For each count vector and each corresponding parameter vector
<code class="reqn">\alpha</code>, the function <code>ddirmn</code> returns the value <code class="reqn">\log(P(y|\alpha))</code>. 
When <code>Y</code> is a matrix of <code class="reqn">n</code> rows, <code>ddirmn</code> returns a vector of length <code class="reqn">n</code>.
</p>
<p><code>rdirmn</code> returns a <code class="reqn">n\times d</code> matrix of the generated random observations.
</p>


<h3>Examples</h3>

<pre><code class="language-R">m &lt;- 20
alpha &lt;- c(0.1, 0.2)
dm.Y &lt;- rdirmn(n=10, m, alpha)	
pdfln &lt;- ddirmn(dm.Y, alpha)
</code></pre>


</div>