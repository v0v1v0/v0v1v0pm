<div class="container">

<table style="width: 100%;"><tr>
<td>rgdirmn</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The Generalized Dirichlet Multinomial Distribution</h2>

<h3>Description</h3>

<p><code>rgdirmn</code> generates random observations from the generalized Dirichlet multinomial distribution. 
<code>dgdirmn</code> computes the log of the generalized Dirichlet multinomial probability mass function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rgdirmn(n, size, alpha, beta)

dgdirmn(Y, alpha, beta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>the number of random vectors to generate.  When <code>size</code> is a scalar and <code>alpha</code> is a vector, 
must specify <code>n</code>.  When <code>size</code> is a vector and <code>alpha</code> is a matrix, <code>n</code> is optional.
The default value of <code>n</code> is the length of <code>size</code>. If given, <code>n</code> should be equal to 
the length of <code>size</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>a number or vector specifying the total number of objects that are put
into d categories in the generalized Dirichlet multinomial distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>the parameter of the generalized Dirichlet multinomial distribution. 
<code>alpha</code> is a numerical positive vector or matrix. 
</p>
<p>For <code>gdirmn</code>, <code>alpha</code> should match the size of <code>Y</code>. If <code>alpha</code> 
is a vector, it will be replicated <code class="reqn">n</code> times to match the dimension of <code>Y</code>. 
</p>
<p>For <code>rdirmn</code>, if <code>alpha</code> is a vector, <code>size</code> must be a scalar.  All the random vectors will
be drawn from the same <code>alpha</code> and <code>size</code>.  If <code>alpha</code> is a matrix, the 
number of rows should match the length of <code>size</code>.  Each random vector 
will be drawn from the corresponding row of <code>alpha</code> and the corresponding element of <code>size</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>the parameter of the generalized Dirichlet multinomial distribution. <code>beta</code> should
have the same dimension as <code>alpha</code>.
</p>
<p>For <code>rdirm</code>, if <code>beta</code> is a vector, <code>size</code> must be a scalar.  All the random samples will
be drawn from the same <code>beta</code> and <code>size</code>.  If <code>beta</code> is a matrix, the 
number of rows should match the length of <code>size</code>.  Each random vector 
will be drawn from the corresponding row of <code>beta</code> and the corresponding element of <code>size</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>the multivariate count matrix with dimensions <code class="reqn">n \times d</code>, where 
<code class="reqn">n = 1,2, \ldots</code> is the number of observations and <code class="reqn">d=3,4,\ldots</code> is the number of categories.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code class="reqn">Y=(y_1, \ldots, y_d)</code> are the <code class="reqn">d</code> category count vectors. Given the parameter vector <code class="reqn">\alpha = (\alpha_1, \ldots, \alpha_{d-1}),
\alpha_j&gt;0</code>, and <code class="reqn">\beta=(\beta_1, \ldots, \beta_{d-1}), \beta_j&gt;0</code>,
the generalized Dirichlet multinomial probability mass function is 
</p>
<p style="text-align: center;"><code class="reqn">
  P(y|\alpha,\beta)
  =C_{y_1, \ldots, y_d}^{m} \prod_{j=1}^{d-1} 
  \frac{\Gamma(\alpha_j+y_j)}{\Gamma(\alpha_j)}
  \frac{\Gamma(\beta_j+z_{j+1})}{\Gamma(\beta_j)}
  \frac{\Gamma(\alpha_j+\beta_j)}{\Gamma(\alpha_j+\beta_j+z_j)}  ,
</code>
</p>

<p>where <code class="reqn">z_j = \sum_{k=j}^d y_k</code> and <code class="reqn">m = \sum_{j=1}^d y_j</code>.
Here, <code class="reqn">C_k^n</code>, often read as "<code class="reqn">n</code> choose <code class="reqn">k</code>", 
refers the number of <code class="reqn">k</code> combinations from a set of <code class="reqn">n</code> elements.
</p>
<p>The <code class="reqn">\alpha</code> and <code class="reqn">\beta</code> parameters can be vectors, like the results from the 
distribution
fitting function, or they can be matrices with <code class="reqn">n</code> rows, 
like the estimate
from the regression function multiplied by the covariate matrix
<code class="reqn">exp(X\alpha)</code> and <code class="reqn">exp(X\beta)</code>
</p>


<h3>Value</h3>

<p><code>dgdirmn</code> returns the value of 
<code class="reqn">\log(P(y|\alpha, \beta))</code>. 
When <code>Y</code> is a matrix of <code class="reqn">n</code> rows, the function <code>dgdirmn</code> returns a vector of length <code class="reqn">n</code>. 
</p>
<p><code>rgdirmn</code> returns a <code class="reqn">n\times d</code> matrix of the generated random observations.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># example 1
m &lt;- 20
alpha &lt;- c(0.2, 0.5)
beta &lt;- c(0.7, 0.4)
Y &lt;- rgdirmn(10, m, alpha, beta)
dgdirmn(Y, alpha, beta)

# example 2 
set.seed(100)
alpha &lt;- matrix(abs(rnorm(40)), 10, 4)
beta &lt;- matrix(abs(rnorm(40)), 10, 4)
size &lt;- rbinom(10, 10, 0.5)
GDM.rdm &lt;- rgdirmn(size=size, alpha=alpha, beta=beta)
GDM.rdm1 &lt;- rgdirmn(n=20, size=10, alpha=abs(rnorm(4)), beta=abs(rnorm(4)))
</code></pre>


</div>