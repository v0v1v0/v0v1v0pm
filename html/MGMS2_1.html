<div class="container">

<table style="width: 100%;"><tr>
<td>characterize_peak</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>characterize_peak</h2>

<h3>Description</h3>

<p>This function characterizes peaks by species/strain in a simulated spectrum after taking the highest peak or merging peaks in each bin.
</p>


<h3>Usage</h3>

<pre><code class="language-R">characterize_peak(spec, option = 1, bin.size = 1, min.mz = 1000, max.mz = 2200)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>spec</code></td>
<td>
<p>A data frame that contains m/z values of peaks, normalized intensities of peaks, species names, and strain names. Either an output of <code>simulate_poly_spectra</code> or one elements of a list output from <code>simulate_many_poly_spectra</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>option</code></td>
<td>
<p>An option on how to merge peaks. There are two options: 1) no merge, thus take the highest intensity peak in each bin after binning a spectrum by bin.size, or 2) take a sum of intensity within each bin after binning a spectrum by bin.size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bin.size</code></td>
<td>
<p>An integer. A bin size. (1 by default)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.mz</code></td>
<td>
<p>A real number. Minimum mass-to-charge ratio. (1000 by default)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.mz</code></td>
<td>
<p>A real number. Maximum mass-to-charge ratio. (2200 by default)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data frame that contains m/z values of peaks (mz), intensities of peaks (int), species names (species), and strain names (strain). Species and strain columns may contain more than one species/strain if an option 2 is chosen.
</p>


<h3>Examples</h3>

<pre><code class="language-R">spectra.processed.A &lt;- process_monospectra(
   file=system.file("extdata", "listA.txt", package="MGMS2"),
   mass.range=c(1000,2200))
spectra.processed.B &lt;- process_monospectra(
   file=system.file("extdata", "listB.txt", package="MGMS2"),
   mass.range=c(1000,2200))
spectra.processed.C &lt;- process_monospectra(
   file=system.file("extdata", "listC.txt", package="MGMS2"),
   mass.range=c(1000,2200))
spectra.mono.summary.A &lt;- summarize_monospectra(
   processed.obj=spectra.processed.A,
   species='A', directory=tempdir())
spectra.mono.summary.B &lt;- summarize_monospectra(
   processed.obj=spectra.processed.B,
   species='B', directory=tempdir())
spectra.mono.summary.C &lt;- summarize_monospectra(
   processed.obj=spectra.processed.C,
   species='C', directory=tempdir())
mono.info=gather_summary(c(spectra.mono.summary.A, spectra.mono.summary.B, spectra.mono.summary.C))
mixture.ratio &lt;- list()
mixture.ratio['A']=1
mixture.ratio['B']=0.5
mixture.ratio['C']=0
sim.template &lt;- create_insilico_mixture_template(mono.info)
insilico.spectrum &lt;- simulate_poly_spectra(sim.template, mixture.ratio)
merged.spectrum &lt;- characterize_peak(insilico.spectrum, option=2) 
</code></pre>


</div>