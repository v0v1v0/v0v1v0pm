<div class="container">

<table style="width: 100%;"><tr>
<td>simulate_poly_spectra</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>simulate_poly_spectra</h2>

<h3>Description</h3>

<p>This function takes simulated m/z and intensities of peaks from <code>create_insilico_mixture_template</code> and modifies them based on given parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simulate_poly_spectra(
  sim.template,
  mixture.ratio,
  spectrum.name = "Spectrum",
  mixture.missing.prob.peak = 0.05,
  noise.peak.ratio = 0.05,
  snr.basepeak = 500,
  noise.cv = 0.25,
  mz.range = c(1000, 2200)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sim.template</code></td>
<td>
<p>A data frame which contains m/z, log intensitiy, normalized intensity values and missing rates of peaks. There are also species and strain information. An object of <code>create_insilico_mixture_template</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mixture.ratio</code></td>
<td>
<p>A list of bacterial mixture ratios for given bacterial species in sim.template.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spectrum.name</code></td>
<td>
<p>A character. An user can define the spectrum name. (Default: 'Spectrum').</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mixture.missing.prob.peak</code></td>
<td>
<p>A real value. The missing probability caused by mixing multiple bacteria species. (Default: 0.05)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noise.peak.ratio</code></td>
<td>
<p>A ratio between the numbers of noise and signal peaks. (Default: 0.05)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>snr.basepeak</code></td>
<td>
<p>A (base peak) signal to noise ratio. (Default: 500)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noise.cv</code></td>
<td>
<p>A coefficient of variation of noise peaks. (Default: 0.25)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mz.range</code></td>
<td>
<p>A range of m/z values. (Default: c(1000,2200))</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data frame that contains m/z values of peaks, normalized intensities of peaks, species names, and strain names. A modified version of <code>sim.template</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">spectra.processed.A &lt;- process_monospectra(
   file=system.file("extdata", "listA.txt", package="MGMS2"),
   mass.range=c(1000,2200))
spectra.processed.B &lt;- process_monospectra(
   file=system.file("extdata", "listB.txt", package="MGMS2"),
   mass.range=c(1000,2200))
spectra.processed.C &lt;- process_monospectra(
   file=system.file("extdata", "listC.txt", package="MGMS2"),
   mass.range=c(1000,2200))
spectra.mono.summary.A &lt;- summarize_monospectra(
   processed.obj=spectra.processed.A,
   species='A', directory=tempdir())
spectra.mono.summary.B &lt;- summarize_monospectra(
   processed.obj=spectra.processed.B,
   species='B', directory=tempdir())
spectra.mono.summary.C &lt;- summarize_monospectra(
   processed.obj=spectra.processed.C,
   species='C', directory=tempdir())
mono.info=gather_summary(c(spectra.mono.summary.A, spectra.mono.summary.B, spectra.mono.summary.C))
mixture.ratio &lt;- list()
mixture.ratio['A']=1
mixture.ratio['B']=0.5
mixture.ratio['C']=0
sim.template &lt;- create_insilico_mixture_template(mono.info)
insilico.spectrum &lt;- simulate_poly_spectra(sim.template, mixture.ratio)
</code></pre>


</div>