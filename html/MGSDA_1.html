<div class="container">

<table style="width: 100%;"><tr>
<td>classifyV</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Classification for MGSDA
</h2>

<h3>Description</h3>

<p>Classify observations in the test set using the supplied matrix of canonical vectors V and the training set.
</p>


<h3>Usage</h3>

<pre><code class="language-R">classifyV(Xtrain, Ytrain, Xtest, V, prior = TRUE, tol1 = 1e-10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Xtrain</code></td>
<td>

<p>A Nxp data matrix; N observations on the rows and p features on the columns.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ytrain</code></td>
<td>

<p>A N vector containing the group labels. Should be coded as 1,2,...,G, where G is the number of groups.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xtest</code></td>
<td>

<p>A Mxp data matrix; M test observations on the rows and p features on the columns.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>

<p>A pxr matrix of canonical vectors that is used to classify observations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>

<p>A logical indicating whether to put larger weights to the groups of larger size; the default value is TRUE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol1</code></td>
<td>

<p>Tolerance level for the eigenvalues of <code class="reqn">V^tWV</code>. If some eigenvalues are less than <code>tol</code>, the low-rank version of <code>V</code> is used for classification.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For a new observation with the value x, the classification is performed based on the smallest Mahalanobis distance in the projected space:
</p>
<p style="text-align: center;"><code class="reqn">\min_{1\le g \le G}(V^tx-Z_g)(V^tWV)^{-1}(V^tx-Z_g)</code>
</p>

<p>where <code class="reqn">Z_g</code> are the group-specific means of the training dataset in the projected space and <code class="reqn">W</code> is the sample within-group covariance matrix.   
</p>
<p>If <code>prior=T</code>, then the above distance is adjusted by <code class="reqn">-2\log\frac{n_g}{N}</code>, where <code class="reqn">n_g</code> is the size of group g.
</p>


<h3>Value</h3>

<p>Returns a vector of length M with predicted group labels for the test set.





</p>


<h3>Author(s)</h3>

<p>Irina Gaynanova
</p>


<h3>References</h3>

<p>I.Gaynanova, J.Booth and M.Wells (2016) "Simultaneous Sparse Estimation of Canonical Vectors in the p&gt;&gt;N setting.", JASA, 111(514), 696-706.
</p>


<h3>Examples</h3>

<pre><code class="language-R">### Example 1
# generate training data
n=10
p=100
G=3
ytrain=rep(1:G,each=n)
set.seed(1)
xtrain=matrix(rnorm(p*n*G),n*G,p)
# find V
V=dLDA(xtrain,ytrain,lambda=0.1)
sum(rowSums(V)!=0)
# generate test data
m=20
set.seed(3)
xtest=matrix(rnorm(p*m),m,p)
# perform classification
ytest=classifyV(xtrain,ytrain,xtest,V)
</code></pre>


</div>