<div class="container">

<table style="width: 100%;"><tr>
<td>NestTablesXL</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>NestTablesXL() function</h2>

<h3>Description</h3>

<p><code>NestTablesXL</code> reads the R lists output by the HpltFind() function
and translates them to an Excel workbook for more convenient evaluation of the
inferred haplotypes and curation of unresolved and incongruent sequences. The
workbook contains separate tabs for each nest in the data set and provides an
overview of the genotypes of the samples in each nest and the inferred
haplotypes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">NestTablesXL(nest_table, seq_table, filepath, path_out)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nest_table</code></td>
<td>
<p>is a table containing the sample names of parents and
offspring in each nest. This table should be organized so that the
individual names are in the first column (Sample_ID), and the nest number
is in the second column (Nest). For each nest, the first two rows should be
the parents, followed immediately by the offspring in the subsequent rows,
and then followed by the next nest, and so on. It is assumed that nests are
numbered consecutively beginning at 1. Please use the same table as was used
to generate the haplotypes using HpltFind().</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seq_table</code></td>
<td>
<p>seq_table is a sequence table as output by the 'dada2'
pipeline, which has samples in rows and nucleotide sequence variants in
columns. Please use the same table as was used to generate the haplotypes
using HpltFind().</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filepath</code></td>
<td>
<p>is a user defined path to the folder where the output files
from the HpltFind() function have been saved.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path_out</code></td>
<td>
<p>is a user defined path to the folder where the output file
will be saved.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If you publish data or results produced with MHCtools, please cite both of
the following references:
Roved, J. 2022. MHCtools: Analysis of MHC data in non-model species. Cran.
Roved, J., Hansson, B., Stervander, M., Hasselquist, D., &amp; Westerdahl, H. 2022.
MHCtools - an R package for MHC high-throughput sequencing data: genotyping,
haplotype and supertype inference, and downstream genetic analyses in non-model
organisms. Molecular Ecology Resources. https://doi.org/10.1111/1755-0998.13645
</p>


<h3>Value</h3>

<p>An Excel workbook with individual tabs for each nest in nest_table.
Each tab contains a binary (logical) occurrence matrix with the samples from
each nest in columns and sequences (inherited from seq_table) in rows. The
order of the samples is derived from nest_table, with parents in the two
leftmost columns. Each tab also lists the putative haplotypes inferred by the
HpltFind() function and provides lists of unresolved sequences in haplotypes,
sequences with unidentified decent (i.e., present in parents but not in
offspring), sequences not assigned to haplotypes, and sequences with
unidentified origin (i.e., present in offspring but not in parents).
Note: NestTablesXL() will overwrite any existing file with the output file
name in path_out.
</p>


<h3>See Also</h3>

<p><code>HpltFind</code>; for more information about 'dada2' visit
&lt;https://benjjneb.github.io/dada2/&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">nest_table &lt;- nest_table
seq_table &lt;- sequence_table_hplt
filepath &lt;- system.file("extdata/HpltFindOut/", package="MHCtools")
path_out &lt;- tempdir()
NestTablesXL(nest_table, seq_table, filepath, path_out)
</code></pre>


</div>