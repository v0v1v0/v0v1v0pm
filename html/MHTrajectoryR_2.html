<div class="container">

<table style="width: 100%;"><tr>
<td>Analyze_oneAE</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Signal detection using via variable selection in logistic regression. 
The Bayesian Information Criterion maximization is assessed using Metropolis-Hastings
algorithm.
</h2>

<h3>Description</h3>

<p>Spontaneous adverse event reports have a high potential for detecting adverse drug reactions.
However, due to their dimension, the analysis of such databases requires statistical methods.
The MHTrajectoryR package propose to use a logistic regression whose sparsity is viewed as a model selection
challenge. Since the model space is huge, a Metropolis-Hastings algorithm carries out the model selection
by maximizing the BIC criterion.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Analyze_oneAE(ae, drug, maxit, alpha, nbinit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ae</code></td>
<td>

<p>The response binary vector which indicates if the adverse event is observed (value 1)
and (value 0) otherwise. It must have the sime length with the number of rows of matrix of drugs
consumption.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drug</code></td>
<td>

<p>The matrix of drugs consumption or the matrix of binary covariates. 
Each row corresponds to one individual drugs consumption. Each column corresponds
to one drug.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>

<p>Number of iteration of the Metropolis-Hastings algorithm. 
In other words, the length of one trajectory of the Metropolis-Hastings
Markov Chain.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>The parameter that define the neighbordhood. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbinit</code></td>
<td>

<p>The number of random initialisations.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p> list of  (best) the best model that maximize the BIC.  (all) all explored models through the trajectory.
(signals) the detected signals (positive, negative or unknown) in OMOP reference set. 
</p>


<h3>Author(s)</h3>

<p>Mohammed Sedki and Matthieu Marbac
</p>


<h3>References</h3>

<p>Matthieu Marbac, Pascale Tubert-Bitter, Mohammed Sedki: 
Bayesian model selection in logistic regression for the detection
of adverse drug reactions. <a href="http://arxiv.org/abs/1505.03366">http://arxiv.org/abs/1505.03366</a> (accepted for publication
in Biometrical Journal).
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
  data(exampleAE)
  data(exampleDrugs)
  res &lt;- Analyze_oneAE(exampleAE[,1], exampleDrugs, 10, 1, 10)
  # print signals (drugs relied to the adverse event)
  print(res$signal)

## End(Not run)
</code></pre>


</div>