<div class="container">

<table style="width: 100%;"><tr>
<td>AIPW</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit a geeglm model using AIPW</h2>

<h3>Description</h3>

<p>provides augmented inverse probability weighted estimates of parameters for GEE model
of response variable using different covariance structure
</p>


<h3>Usage</h3>

<pre><code class="language-R">AIPW(
  data,
  formula,
  id,
  visit,
  family,
  init.beta = NULL,
  init.alpha = NULL,
  init.phi = NULL,
  tol = 0.001,
  weights = NULL,
  corstr = "independent",
  maxit = 50,
  m = 2,
  pMat,
  method = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>longitudinal data set where each subject's outcome has been measured at same time points and number
of visits for each patient is similar.
Covariance structure of the outcome variable like "unstructured","independent","AR-1"
,"exchangeable"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>formula for the response model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>column name of id of subjects in the dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>visit</code></td>
<td>
<p>column name of timepoints of visit in the dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>name of the distribution for the response variable, For more information on how to use <code>family</code> objects, see <code>family</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init.beta</code></td>
<td>
<p>initial values for the regression coefficient of GEE model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init.alpha</code></td>
<td>
<p>initial values for the correlation structure</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init.phi</code></td>
<td>
<p>initial values for the csale parameter for</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>tolerance in calculation of coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>A vector of weights for each observation.
If an observation has weight 0, it is excluded from the calculations of any parameters. Observations with a NA anywhere (even in variables not included in the model) will be assigned a weight of 0. Weights are updated as the mentioned the details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corstr</code></td>
<td>
<p>a character string specifying the correlation structure. It could "independence", "exchangeable", "AR-1", "unstructured"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>maximum number iteration for newton-raphson</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>number of imputation used to update the missing score function value due incomplete data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pMat</code></td>
<td>
<p>predictor matrix as obtained in <code>mice</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>method option for mice model,for information see mice</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>AIPW
</p>
<p>It uses the inverse probability weighted method to reduce the bias
due to missing values in GEE model for longitudinal data. The response variable <code class="reqn">\mathbf{Y}</code> is related to the coariates as <code class="reqn">g(\mu)=\mathbf{X}\beta</code>, where <code>g</code> is the link function for the glm. The estimating equation is
</p>
<p style="text-align: center;"><code class="reqn">\sum_{i=1}^{k}\sum_{j=1}^{n}(\frac{\delta_{ij}}{\pi_{ij}}S(Y_{ij},\mathbf{X}_{ij},\mathbf{X}'_{ij})+(1-\frac{\delta_{ij}}{\pi_{ij}})\phi(\mathbf{V}=\mathbf{v}))=0</code>
</p>

<p>where <code class="reqn">\delta_{ij}=1</code> if there is missing value in covariates and 0 otherwise,
<code class="reqn">\mathbf{X}</code> is fully observed all subjects and <code class="reqn">\mathbf{X}'</code> is partially missing,
where <code class="reqn">\mathbf{V}=(Y,\mathbf{X})</code>. The missing score function values due to incomplete data are estimated
using an imputation model through mice which we have considered as <code class="reqn">\phi(\mathbf{V}=\mathbf{v}))</code>.
</p>


<h3>Value</h3>

<p>A list of objects containing the following objects
</p>

<dl>
<dt>call</dt>
<dd>
<p>details about arguments passed in the function</p>
</dd>
<dt>beta</dt>
<dd>
<p>estimated regression coeffictient value for the response model</p>
</dd>
<dt>niter</dt>
<dd>
<p>number of iteration required</p>
</dd>
<dt>betalist</dt>
<dd>
<p>list of beta values at different iteration</p>
</dd>
<dt>weight</dt>
<dd>
<p>estimated weights for the observations</p>
</dd>
<dt>mu</dt>
<dd>
<p>mu values according glm</p>
</dd>
<dt>phi</dt>
<dd>
<p>etsimated phi value for the <code>glm</code> model</p>
</dd>
<dt>hessian</dt>
<dd>
<p>estimated hessian matrix obtained from the last iteration</p>
</dd>
<dt>betaSand</dt>
<dd>
<p>sandwich estimator value for the variance covariance matrix of the beta</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Atanu Bhattacharjee, Bhrigu Kumar Rajbongshi and Gajendra Kumar Vishwakarma
</p>


<h3>References</h3>

<p>Wang, C. Y., Shen-Ming Lee, and Edward C. Chao. "Numerical equivalence of imputing scores and weighted estimators in regression analysis with missing covariates." Biostatistics 8.2 (2007): 468-473.
</p>
<p>Seaman, Shaun R., and Stijn Vansteelandt. "Introduction to double robust methods for incomplete data." Statistical science: a review journal of the Institute of Mathematical Statistics 33.2 (2018): 184.
</p>
<p>Vansteelandt, Stijn, James Carpenter, and Michael G. Kenward. "Analysis of incomplete data using inverse probability weighting and doubly robust estimators." Methodology: European Journal of Research Methods for the Behavioral and Social Sciences 6.1 (2010): 37.
</p>


<h3>See Also</h3>

<p>SIPW,miSIPW,miAIPW
</p>


<h3>Examples</h3>

<pre><code class="language-R"> ## Not run: 
##
formula&lt;-C6kine~ActivinRIB+ActivinRIIA+ActivinRIIAB+Adiponectin+AgRP+ALCAM
pMat&lt;-mice::make.predictorMatrix(srdata1[names(srdata1)%in%all.vars(formula)])
m1&lt;-AIPW(data=srdata1,
formula&lt;-formula,id='ID',
visit='Visit',family='gaussian',init.beta = NULL,
init.alpha=NULL,init.phi=1,tol=.00001,weights = NULL,
corstr = 'exchangeable',maxit=50,m=3,pMat=pMat)
##

## End(Not run)
</code></pre>


</div>