<div class="container">

<table style="width: 100%;"><tr>
<td>fisher_evaluation</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Evaluation of the Fisher Information Matrix in Nonlinear Mixed Effect Models using Markov Chains Monte Carlo</h2>

<h3>Description</h3>

<p><code>fisher_evaluation</code> is used to evaluate the Fisher information matrix for both continuous and discrete data in nonlinear mixed effect models using Markov Chains Monte Carlo.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fisher_evaluation(t, y_ini=1, model, model2, model3, params, dim_b, 
set_seed=TRUE, seed=42, n_samp, n_rep=1, n_iter, n_burn, CV=FALSE, 
plot_graph=0, L_boot=1000, nb_patients=1)
</code></pre>


<h3>Arguments</h3>

                
<table>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>Vector of sampling times (or doses).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_ini</code></td>
<td>
<p>A possible value for the response y to initialize the MCMC process. The default value is set at 1 (which works for many types of outcomes: continuous, binary, ...).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Compiled STAN model describing the response model to sample in the conditionnal distribution of b given y.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model2</code></td>
<td>
<p>Compiled STAN model describing the response model for calculating the derivative of the log-likelihood with respoect to each parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model3</code></td>
<td>
<p>Compiled STAN model describing the response model to sample in the marginal distribution of the response y.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>Vector of parameters given as follows: fixed effetcs, variances of the random effets, standard deviations of the residual errors (if continuous data). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dim_b</code></td>
<td>
<p>Number of random effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>set_seed</code></td>
<td>
<p>Boolean indicating if the seed shoud be fixed. The default value is set at TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Integer for the fixed seed. Used only if <code>set_seed</code> is TRUE. The default value is set at 42.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_samp</code></td>
<td>
<p>Integer representing the number of Monte Carlo (MC) samples, (i.e. number of samples for the outcome y).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_rep</code></td>
<td>
<p>Integer representing the number of repeated measures at the same time (or dose) for each patient. The default value is set at 1 (for continuous data).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_iter</code></td>
<td>
<p>Integer representing the number of Markov Chains Monte Carlo (MCMC) samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_burn</code></td>
<td>
<p>Integer representing the number of burn-in samples for MCMC. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CV</code></td>
<td>
<p>Boolean indicating if some convergence information (variance of the determinant, mean of b, mean log-likelihood, ...) should be returned. The default value is set at FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_graph</code></td>
<td>
<p>An integer with value 0 (no graph should be plotted), 1 (graph of the determinant of the FIM), 2 (graph of the determinant of the FIM with confidence intervals assuming normal distribution), 3 (graph of the determinant of the FIM with bootstrap confidence intervals) or 4 (graph of the determinant of the FIM with both bootstrap confidence intervals and confidence intervals assuming normal distribution). The default value is set at 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L_boot</code></td>
<td>
<p>Number of samples for bootstrap estimation of the confidence intervals of the normalized determinant of the FIM. This argument is used/required only if plot_graph = 3 or 4. The default value is set at 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb_patients</code></td>
<td>
<p>Number of patients with the same elementary design for which the FIM is evaluated. The default value is set at 1.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An list is returned, composed of the following variables: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>FIM</code></td>
<td>
<p>Expected Fisher information matrix (FIM). Of note, the FIM is an individual FIM and is calculated for <code>nb_patients</code> patients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FIM_covar</code></td>
<td>
<p>Variance-covariance matrix of the FIM. (Of note, its dimension is of size 4 as the FIM is in dimension 2.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inv_FIM</code></td>
<td>
<p>Inverse of the FIM.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RSE</code></td>
<td>
<p>Relative standard errors (square root of the diagonal elements of the inverse of the FIM).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RSE_inf_boot</code></td>
<td>
<p>Vector containing the lower bound of the bootstrap confidence interval of the RSEs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RSE_sup_boot</code></td>
<td>
<p>Vector containing the upper bound of the bootstrap confidence interval of the RSEs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>det_norm_FIM</code></td>
<td>
<p>Normalized determinant of the FIM.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>det_IC_normal</code></td>
<td>
<p>Vector containing the lower and upper bound of the confidence interval of the normalized determinant of the FIM assuming normal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>det_IC_boot</code></td>
<td>
<p>Vector containing the lower and upper bound of the bootstrap confidence interval of the normalized determinant of the FIM.</p>
</td>
</tr>
</table>
<p>If CV=TRUE: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mean_dloglik1</code></td>
<td>
<p>Mean of the partial derivatives of the log-likelihood according to the first MCMC sample and MC sample. Should be equal approximately to 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean_dloglik2</code></td>
<td>
<p>Mean of the partial derivatives of the log-likelihood according to the second MCMC sample and MC sample. Should be equal approximately to 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_dloglik1</code></td>
<td>
<p>Variance of the partial derivatives of the log-likelihood according to the first MCMC sample and MC sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_dloglik2</code></td>
<td>
<p>Variance of the partial derivatives of the log-likelihood according to the second MCMC sample and MC sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean_b</code></td>
<td>
<p>Mean of the samples in the conditionnal distribution of b given y. Should be equal approximately to 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mat_A_k1</code></td>
<td>
<p>Vector containing for each value sampled of the response y, the estimation of the integral of the partial derivatives of the log-likelihood over the random effects according to the first MCMC sample of the random effects b given y.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mat_A_k2</code></td>
<td>
<p>Vector containing for each value sampled of the response y, the estimation of the integral of the partial derivatives of the log-likelihood over the random effects according to the second MCMC sample of the random effects b given y.</p>
</td>
</tr>
</table>
<p>In addition, <code>plot_graph</code> enables to plot a graph of the normalized determinant of the FIM with normal and bootstrap confidence intervals in function of the number of MC samples.
</p>


<h3>Author(s)</h3>

<p>Marie-Karelle Riviere-Jourdan <a href="mailto:eldamjh@gmail.com">eldamjh@gmail.com</a></p>


<h3>References</h3>

<p>Riviere, M-K., Ueckert, S. and Mentre, F,. Evaluation of the Fisher information matrix in nonlinear mixed effect models using Markov Chains Monte Carlo.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
############################
# PLEASE UNCOMMENT EXAMPLE #
############################
#times = c(0.5,1,2,6,24,36,72,120)
#params = c(1,8,0.15,0.6,0.02,0.07,0.1)

# Files cen be found in external data
#model = stan_model("model_b_given_y.stan")
#model2 = stan_model("model_derivatives.stan")
#model3 = stan_model("model_y.stan")

#model_Warfarin = fisher_evaluation(t=times, y_ini=0.5, model=model, 
#model2=model2, model3=model3, params=params, dim_b=3, set_seed=TRUE, seed=42, 
#n_samp=1000, n_rep=1, n_iter=200, n_burn=500, CV=TRUE, plot_graph=4, 
#nb_patients=32)
#model_Warfarin
</code></pre>


</div>