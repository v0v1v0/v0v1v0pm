<div class="container">

<table style="width: 100%;"><tr>
<td>MFPCA_cov</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function to calculate the multivariate FPCA for a given covariance matrix and
univariate basis functions</h2>

<h3>Description</h3>

<p>Function to calculate the multivariate FPCA for a given covariance matrix and
univariate basis functions
</p>


<h3>Usage</h3>

<pre><code class="language-R">MFPCA_cov(cov, basis_funs, scores = NULL, weights = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cov</code></td>
<td>
<p>Covariance matrix of the basis functions coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basis_funs</code></td>
<td>
<p>List with basis functions on each dimension. The basis
functions are funData objects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p>Matrix (n rows, B columns) containing the basis functions
coefficients. Defaults to NULL which does not calculate the multivariate
scores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Vector of weights, defaults to 1 for each element</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>List mimicking an <code>MFPCAfit</code> object containing the following
components:
</p>

<dl>
<dt>values</dt>
<dd>
<p>A vector of eigenvalues.</p>
</dd>
<dt>functions</dt>
<dd>
<p>A <code>multiFunData</code> object containing the multivariate
functional principal components.</p>
</dd>
<dt>scores</dt>
<dd>
<p>A matrix containing the scores (if applicable).</p>
</dd>
<dt>vectors</dt>
<dd>
<p>A matrix representing the eigenvectors associated with the
combined univaraite score vectors.</p>
</dd>
<dt>normFactors</dt>
<dd>
<p>The normalizing factors used for calculating the
multivariate eigenfunctions and scores.</p>
</dd>
</dl>
<h3>Examples</h3>

<pre><code class="language-R">library(funData)
# Covariance matrix for the data generation in simulation scenario I
auto &lt;- matrix(c(0.08, -0.07, -0.07, 0.9), ncol = 2)
cross &lt;- matrix(rep(0.03, 4), ncol = 2)
cor &lt;- matrix(c(0, 1, 0.75, 0.5, 0, 0,
                1, 0, 1, 0.75, 0.5, 0,
                0.75, 1, 0, 1, 0.75, 0.5,
                0.5, 0.75, 1, 0, 1, 0.75,
                0, 0.5, 0.75, 1, 0, 1,
                0, 0, 0.5, 0.75, 1, 0),
               ncol = 6)
cov &lt;- kronecker(cor, cross) + kronecker(diag(c(1, 1.2, 1.4, 1.6, 1.8, 2)),
                                         auto)
# Basis functions on each dimension
seq1 &lt;- seq(0, 1, by = 0.01)
b_funs &lt;- rep(list(funData(argvals = seq1,
              X = matrix(c(rep(1, length(seq1)), seq1),
              byrow = TRUE, ncol = length(seq1)))), 6)
# Prepare objects for the model on different data sets
mfpca_tru &lt;- MFPCA_cov(cov = cov, basis_funs = b_funs)
</code></pre>


</div>