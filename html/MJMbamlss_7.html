<div class="container">

<table style="width: 100%;"><tr>
<td>Predict.matrix.unc_pcre.random.effect</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>mgcv-style constructor for prediction of PC-basis functional random effects</h2>

<h3>Description</h3>

<p>This predictor function uses time-information saved in the object. This is
handled within the bamlss-transform function, so this function is not
exported.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'unc_pcre.random.effect'
Predict.matrix(object, data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a smooth specification object, see
<code>smooth.construct</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>see <code>smooth.construct</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>design matrix for PC-based functional random effects
</p>


<h3>Author(s)</h3>

<p>Alexander Volkmann, adapted from 'Predict.matrix.pcre.random.effect
by F. Scheipl (adapted from 'Predict.matrix.random.effect' by S.N. Wood).
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(pbc_subset)
mfpca &lt;- preproc_MFPCA(pbc_subset, uni_mean = paste0(
  "logy ~ 1 + sex + drug + s(obstime, k = 5, bs = 'ps') + ",
  "s(age, k = 5, bs = 'ps')"),
  pve_uni = 0.99, nbasis = 5, weights = TRUE, save_uniFPCA = TRUE)
pbc_subset &lt;- attach_wfpc(mfpca, pbc_subset, n = 2)
mfpca_list &lt;- list(
  list(functions = funData::extractObs(mfpca$functions, 1),
       values = mfpca$values[1]),
  list(functions = funData::extractObs(mfpca$functions, 2),
       values = mfpca$values[2]))
sm &lt;- smoothCon(s(id, fpc.1, bs = "unc_pcre",
      xt = list("mfpc" = mfpca_list[[1]], scale = "FALSE")), pbc_subset)[[1]]
sm$timevar &lt;- "obstime"
sm$term &lt;- c(sm$term, "obstime")
pm &lt;- PredictMat(sm, pbc_subset, n = 4*nrow(pbc_subset))
</code></pre>


</div>