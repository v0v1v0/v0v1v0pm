<div class="container">

<table style="width: 100%;"><tr>
<td>simMultiJM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>New Simulation Function For Multivariate JMs Based On FPCs</h2>

<h3>Description</h3>

<p>Adapt the structure given by simJM function in bamlss.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simMultiJM(
  nsub = 300,
  times = seq(0, 120, 1),
  probmiss = 0.75,
  max_obs = length(times),
  maxfac = 1.5,
  nmark = 2,
  long_assoc = c("FPC", "splines", "param"),
  M = 6,
  FPC_bases = NULL,
  FPC_evals = NULL,
  mfpc_args = list(type = "split", eFunType = "Poly", ignoreDeg = NULL, eValType =
    "linear", eValScale = 1),
  re_cov_mat = NULL,
  ncovar = 2,
  lambda = function(t, x) {
     1.4 * log((t + 10)/1000)
 },
  gamma = function(x) {
     -1.5 + 0.3 * x[, 1]
 },
  alpha = rep(list(function(t, x) {
     0.3 + 0 * t
 }), nmark),
  mu = rep(list(function(t, x) {
     1.25 + 0.6 * sin(x[, 2]) + (-0.01) * t
 }), nmark),
  sigma = function(t, x) {
     0.3 + 0 * t + I(x$marker == "m2") * 0.2
 },
  tmax = NULL,
  seed = NULL,
  full = FALSE,
  file = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nsub</code></td>
<td>
<p>Number of subjects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>Vector of time points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probmiss</code></td>
<td>
<p>Probability of missingness.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_obs</code></td>
<td>
<p>Maximal number of observations per individual and marker.
Defaults to no upper limit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxfac</code></td>
<td>
<p>Factor changing the uniform censoring interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmark</code></td>
<td>
<p>Number of markers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>long_assoc</code></td>
<td>
<p>Longitudinal association between the markers (Defaults to
"FPC"). If "splines" or "param", then specify the normal covariance matrix
with argument 're_cov_mat' and include the random effects in argument mu.
If "FPC", then principal components are used to model the association
structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>Number of principal components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FPC_bases</code></td>
<td>
<p>FunData object. If supplied, use the contained FPC as basis
for the association structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FPC_evals</code></td>
<td>
<p>Vector of eigenvalues. If supplied, use the provided
eigenvalues for the association structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mfpc_args</code></td>
<td>
<p>List containing the named arguments "type", "eFunType",
"ignoreDeg", "eValType" of function simMultiFunData and "eValScale" for
scaling the eigenvalues.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>re_cov_mat</code></td>
<td>
<p>If supplied, a covariance matrix to use for drawing the
random effects needed for the association structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncovar</code></td>
<td>
<p>Number of covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Additive predictor of time-varying survival covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>Additive predictor of time-constant survival covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>List of length nmark containing the additive predictors of the
association.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>List of length nmark containing the additive predictors of the
longitudinal part.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>Additive predictor of the variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tmax</code></td>
<td>
<p>Maximal time point of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Seed for reproducibility.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>full</code></td>
<td>
<p>Create a wide-format data.frame and a short one containing only
survival info.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>Name of the data file the generated data set should be stored
into (e.g., "simdata.RData") or NULL if the dataset should directly be
returned in R.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>For <code>full = TRUE</code> a list of four <code>data.frames</code> is returned:
</p>

<dl>
<dt>data</dt>
<dd>
<p>Simulated dataset in long format including all longitudinal
and survival covariates.</p>
</dd>
<dt>data_full</dt>
<dd>
<p>Simulated dataset on a grid of fixed time points.</p>
</dd>
<dt>data_hypo</dt>
<dd>
<p>Simulated dataset on a grid of fixed time points with
hypothetical longitudinal outcomes after the event.</p>
</dd>
<dt>fpc_base</dt>
<dd>
<p>If applicable, include the FPC basis used for simulation.</p>
</dd>
<dt>data_short</dt>
<dd>
<p>Convenience output containing only one observation per
subject for easy access to event-times.</p>
</dd>
</dl>
<p>For <code>full = FALSE</code> only the first dataset is returned.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Number of individuals
n &lt;- 15
# Covariance matrix for the data generation
auto &lt;- matrix(c(0.08, -0.07, -0.07, 0.9), ncol = 2)
cross &lt;- matrix(rep(0.03, 4), ncol = 2)
cor &lt;- matrix(c(0, 1, 0.75, 0.5, 0, 0,
                1, 0, 1, 0.75, 0.5, 0,
                0.75, 1, 0, 1, 0.75, 0.5,
                0.5, 0.75, 1, 0, 1, 0.75,
                0, 0.5, 0.75, 1, 0, 1,
                0, 0, 0.5, 0.75, 1, 0),
              ncol = 6)
cov &lt;- kronecker(cor, cross) +
    kronecker(diag(c(1, 1.2, 1.4, 1.6, 1.8, 2)), auto)

# Simulate the data
d_rirs &lt;- simMultiJM(
  nsub = n, times = seq(0, 1, by = 0.01), max_obs = 15, probmiss = 0.75,
  maxfac = 1.75, nmark = 6, long_assoc = "param", M = NULL, FPC_bases = NULL,
  FPC_evals = NULL, mfpc_args = NULL, re_cov_mat = cov, ncovar = 2,
  lambda = function(t, x) {1.37 * t^(0.37)},
  gamma = function(x) {-1.5 + 0.48*x[, 3]},
  alpha = list(function(t, x) {1.5 + 0*t}, function(t, x) {0.6 + 0*t},
               function(t, x) {0.3 + 0*t}, function(t, x) {-0.3 + 0*t},
               function(t, x) {-0.6 + 0*t}, function(t, x) {-1.5 + 0*t}),
  mu = list(function(t, x, r){
    0 + 0.2*t - 0.25*x[, 3] - 0.05*t*x[, 3] + r[, 1] + r[, 2]*t
  }, function(t, x, r){
    0 + 0.2*t - 0.25*x[, 3] - 0.05*t*x[, 3] + r[, 3] + r[, 4]*t
  }, function(t, x, r){
    0 + 0.2*t - 0.25*x[, 3] - 0.05*t*x[, 3] + r[, 5] + r[, 6]*t
  }, function(t, x, r){
    0 + 0.2*t - 0.25*x[, 3] - 0.05*t*x[, 3] + r[, 7] + r[, 8]*t
  }, function(t, x, r){
    0 + 0.2*t - 0.25*x[, 3] - 0.05*t*x[, 3] + r[, 9] + r[, 10]*t
  }, function(t, x, r){
    0 + 0.2*t - 0.25*x[, 3] - 0.05*t*x[, 3] + r[, 11] + r[, 12]*t
  }),
  sigma = function(t, x) {log(0.06) + 0*t}, tmax = NULL, seed = NULL,
  full = TRUE, file = NULL)
</code></pre>


</div>