<div class="container">

<table style="width: 100%;"><tr>
<td>baplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Bland-Altman Plots </h2>

<h3>Description</h3>

<p>Produce classical parametric as well as nonparametric Bland-Altman plots 
including confidence intervals for the mean of the differences and 
the lower and upper limit of agreement.
</p>


<h3>Usage</h3>

<pre><code class="language-R">baplot(x, y, loa.level = 0.95, conf.level = 0.95, 
       xlab = "Mean", ylab = "Difference", 
       title = "Bland-Altman Plot", xlim = NULL, ylim = NULL,
       type = c("parametric", "nonparametric"), 
       loa.type = c("unbiased", "biased"), ci.diff = TRUE, ci.loa = TRUE, 
       ci.type = c("exact", "approximate", "boot"), 
       bootci.type = NULL, R = 9999, print.res = TRUE,
       color.low = "#4575B4", color.upp = "#D73027", 
       alpha = 1, shape = 19, na.rm = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> numeric, measurements of method 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p> numeric, measurements of method 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loa.level</code></td>
<td>
<p> single numeric, level of the level of agreement.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p> single numeric, significance level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p> label of x-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p> label of y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p> title of plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p> optional numeric vector of length 2, limits of x-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p> optional numeric vector of length 2, limits of y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p> single character, either <code>"parametric"</code> (default) or <code>"nonparametric"</code>; see also Details below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loa.type</code></td>
<td>
<p> single character, either <code>"unbiased"</code> (default) or <code>"biased"</code>; see also Details below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.diff</code></td>
<td>
<p> single logical, plot confidence interval for the mean of the differences.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.loa</code></td>
<td>
<p> single logical, plot confidence intervals for the lower and upper limit of agreement.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.type</code></td>
<td>
<p> single character, either <code>"exact"</code> (default) or <code>"approximate"</code> or <code>"boot"</code>; see also Details below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootci.type</code></td>
<td>
<p> single character, type of bootstrap interval; see <code>boot.ci</code> and also Details below. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p> single numeric, number of bootstrap replicates. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.res</code></td>
<td>
<p> single logical, print results of computations in addition to plotting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color.low</code></td>
<td>
<p> single color (character), color for lower limit of agreement.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color.upp</code></td>
<td>
<p> single color (character), color for upper limit of agreement.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p> blending factor (default: no blending.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape</code></td>
<td>
<p> point shape used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p> single logical, remove <code>NA</code> values before plotting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> further arguments passed to function <code>boot</code>,
e.g. for parallel computing. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The plot generates a <code>ggplot2</code> object that is shown.
</p>
<p>Setting <code>type = "parametric"</code> (default), a classical Bland-Altman plot 
with mean of the differences and standard lower and upper limit of agreement 
(mean +/- 1.96 SD) will be generated (<code>loa.level = 0.95</code>); 
see Altman and Bland (1983,1986).
</p>
<p>Setting <code>type = "nonparametric"</code>, a nonparametric Bland-Altman plot with 
median of the differences and empirical 2.5% and 97.5% quantiles 
(<code>loa.level = 0.95</code>) as lower and upper limit of agreement will be generated.
</p>
<p>By changing <code>loa.level</code> the lower and upper limit of agreement will 
correspond to the <code>(1-loa.level)/2</code> and the <code>1 - (1-low.level)/2</code>
quantile.
</p>
<p>Setting <code>loa.type = "unbiased"</code>, the unbiased estimator of the standard
deviation will be used; see Shieh (2018).
</p>
<p>Setting <code>loa.type = "biased"</code>, the standard deviation will be estimated
by function <code>sd</code>.
</p>
<p>Setting <code>ci.type = "exact"</code>, the exact confidence intervals of Shieh (2018) 
will be used for the lower and upper limit of agreement.
</p>
<p>Setting <code>ci.type = "approximate"</code>, the approximate confidence intervals
of Bland and Altman (1986, 1999) will be used.
</p>
<p>Setting <code>ci.type = "boot"</code>, bootstrap confidence intervals will be used.
In the case of parametric Bland-Altman plots, the studentized bootstrap method will
be used by default. In the case of nonparametric Bland-Altman plots, the 
bootstrap percentile method will be used by default.
</p>
<p>The argument <code>bootci.type</code> can be set to <code>"stud"</code> (studentized bootstrap),
<code>"perc"</code> (bootstrap percentile) or <code>"bca"</code> (adjusted bootstrap percentile).
</p>


<h3>Value</h3>

<p>Object of class <code>gg</code> and <code>ggplot</code>.
</p>


<h3>Author(s)</h3>

<p> Matthias Kohl <a href="mailto:Matthias.Kohl@stamats.de">Matthias.Kohl@stamats.de</a></p>


<h3>References</h3>

<p>Altman DG, Bland JM (1983). Measurement in Medicine: the Analysis of Method Comparison Studies. 
<em>The Statistician</em> 32:307-317.
</p>
<p>Bland JM, Altman DG (1986). Statistical methods for assessing agreement between two methods 
of clinical measurement. <em>Lancet</em> 327(8476):307-10
</p>
<p>Bland JM, Altman DG (1999). Measuring agreement in method comparison studies. 
<em>Stat Methods Med Res</em> 8:135-160.
</p>
<p>Shieh G (2018). The appropriateness of Bland-Altman's approximate confidence intervals 
for limits of agreement. <em>BMC Med Res Methodol</em> 18:45.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(fingsys)
## classical parametric Bland-Altman plot with exact confidence intervals
baplot(x = fingsys$armsys, y = fingsys$fingsys, 
       xlab = "Mean of arm and finger [mm Hg]",
       ylab = "Difference (arm - finger) [mm Hg]")

## nonparametric Bland-Altman plot with exact confidence intervals
baplot(x = fingsys$armsys, y = fingsys$fingsys, type = "nonparametric",
       xlab = "Mean of arm and finger [mm Hg]",
       ylab = "Difference (arm - finger) [mm Hg]",
       title = "Nonparametric Bland-Altman Plot")
</code></pre>


</div>