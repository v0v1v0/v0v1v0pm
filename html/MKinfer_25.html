<div class="container">

<table style="width: 100%;"><tr>
<td>mi.wilcox.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multiple Imputation Wilcoxon Rank Sum and Signed Rank Tests</h2>

<h3>Description</h3>

<p>Performs one and two sample Wilcoxon tests on multiple imputed datasets.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mi.wilcox.test(miData, ...)

## Default S3 method:
mi.wilcox.test(miData, x, y = NULL,
        alternative = c("two.sided", "less", "greater"), mu = 0,
        paired = FALSE, exact = NULL, conf.int = TRUE,
        conf.level = 0.95, subset = NULL, ...)

## S3 method for class 'amelia'
mi.wilcox.test(miData, x, y = NULL,
        alternative = c("two.sided", "less", "greater"), mu = 0,
        paired = FALSE, exact = NULL, conf.int = TRUE,
        conf.level = 0.95, subset = NULL, ...)

## S3 method for class 'mids'
mi.wilcox.test(miData, x, y = NULL,
        alternative = c("two.sided", "less", "greater"), mu = 0,
        paired = FALSE, exact = NULL, conf.int = TRUE,
        conf.level = 0.95, subset = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>miData</code></td>
<td>
<p>list of multiple imputed datasets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>name of a variable that shall be tested.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>an optional name of a variable that shall be tested (paired test)
or a variable that shall be used to split into groups (unpaired test).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>a character string specifying the alternative
hypothesis, must be one of <code>"two.sided"</code> (default),
<code>"greater"</code> or <code>"less"</code>.  You can specify just the initial
letter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>a number indicating the true value of the mean (or
difference in means if you are performing a two sample test).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>paired</code></td>
<td>
<p>a logical indicating whether you want a paired
t-test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exact</code></td>
<td>
<p>a logical indicating whether an exact p-value should be computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.int</code></td>
<td>
<p>a logical indicating whether a confidence interval should be computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>confidence level of the interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a subset of observations
to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For details about the tests see <code>wilcox.exact</code>
</p>
<p>We use the median p rule (MPR) for the computation of the p value of the test; see 
Section 5.3.2 of van Buuren (2018) or Section 13.3 in Heymans and Eekhout (2019).
The approach seems to work well in many situations such as logistic regression
(Eekhout et al. (2017)) or GAM (Bolt et al. (2022)). However, we are not aware 
of any work that has investigated the MPR approach for Wilcoxon tests. Hence,
this function should be regarded as experimental.
</p>
<p>We recommend to use an odd number of imputations.
</p>


<h3>Value</h3>

<p>A list with class <code>"htest"</code> containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>he value of the test statistic with a name describing it.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>the p-value for the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pointprob</code></td>
<td>
<p>this gives the probability of observing the test statistic itself 
(called point-prob).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null.value</code></td>
<td>
<p>the location parameter mu.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>a character string describing the alternative
hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string indicating what type of test was
performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>a character string giving the name(s) of the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.int</code></td>
<td>
<p>a confidence interval for the location parameter. 
(Only present if argument conf.int = TRUE.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>Hodges-Lehmann estimate of the location parameter. 
(Only present if argument conf.int = TRUE.)</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Matthias Kohl <a href="mailto:Matthias.Kohl@stamats.de">Matthias.Kohl@stamats.de</a></p>


<h3>References</h3>

<p>van Buuren, S. (2018). <em>Flexible Imputation of Missing Data</em>.
Chapman &amp; Hall/CRC. <a href="https://stefvanbuuren.name/fimd/">https://stefvanbuuren.name/fimd/</a>.
</p>
<p>Heymans, M.W. and Eekhout, I. (2019). <em>Applied Missing Data Analysis With SPSS 
and (R)Studio</em>. Self-publishing. <a href="https://bookdown.org/mwheymans/bookmi/">https://bookdown.org/mwheymans/bookmi/</a>.
</p>
<p>Eekhout, I, van de Wiel, MA, Heymans, MW (2017). Methods for significance testing 
of categorical covariates in logistic regression models after multiple imputation: 
power and applicability analysis. <em>BMC Med Res Methodol</em>, <b>17</b>, 1:129.
<a href="https://doi.org/10.1186/s12874-017-0404-7">doi:10.1186/s12874-017-0404-7</a>
</p>
<p>Bolt, MA, MaWhinney, S, Pattee, JW, Erlandson, KM, Badesch, DB, Peterson, RA (2022). 
Inference following multiple imputation for generalized additive models: an 
investigation of the median p-value rule with applications to the Pulmonary 
Hypertension Association Registry and Colorado COVID-19 hospitalization data. 
<em>BMC Med Res Methodol</em>, <b>22</b>, 1:148. <a href="https://doi.org/10.1186/s12874-022-01613-w">doi:10.1186/s12874-022-01613-w</a>.
</p>


<h3>See Also</h3>

<p><code>wilcox.exact</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Generate some data
set.seed(123)
x &lt;- rnorm(25, mean = 1)
x[sample(1:25, 5)] &lt;- NA
y &lt;- rnorm(20, mean = -1)
y[sample(1:20, 4)] &lt;- NA
pair &lt;- c(rnorm(25, mean = 1), rnorm(20, mean = -1))
g &lt;- factor(c(rep("yes", 25), rep("no", 20)))
D &lt;- data.frame(ID = 1:45, response = c(x, y), pair = pair, group = g)

## Use Amelia to impute missing values
library(Amelia)
res &lt;- amelia(D, m = 9, p2s = 0, idvars = "ID", noms = "group")

## Per protocol analysis (Exact Wilcoxon rank sum test)
library(exactRankTests)
wilcox.exact(response ~ group, data = D, conf.int = TRUE)
## Intention to treat analysis (Multiple Imputation Exact Wilcoxon rank sum test)
mi.wilcox.test(res, x = "response", y = "group")

## Specifying alternatives
mi.wilcox.test(res, x = "response", y = "group", alternative = "less")
mi.wilcox.test(res, x = "response", y = "group", alternative = "greater")

## One sample test
wilcox.exact(D$response[D$group == "yes"], conf.int = TRUE)
mi.wilcox.test(res, x = "response", subset = D$group == "yes")
mi.wilcox.test(res, x = "response", mu = -1, subset = D$group == "yes",
               alternative = "less")
mi.wilcox.test(res, x = "response", mu = -1, subset = D$group == "yes",
               alternative = "greater")

## paired test
wilcox.exact(D$response, D$pair, paired = TRUE, conf.int = TRUE)
mi.wilcox.test(res, x = "response", y = "pair", paired = TRUE)

## Use mice to impute missing values
library(mice)
res.mice &lt;- mice(D, m = 9, print = FALSE)
mi.wilcox.test(res.mice, x = "response", y = "group")
</code></pre>


</div>