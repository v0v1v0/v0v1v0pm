<div class="container">

<table style="width: 100%;"><tr>
<td>binomCI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Confidence Intervals for Binomial Proportions </h2>

<h3>Description</h3>

<p>This function can be used to compute confidence intervals for binomial proportions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">binomCI(x, n, conf.level = 0.95, method = "wilson", rand = 123, 
        R = 9999, bootci.type = "all", 
        alternative = c("two.sided", "less", "greater"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> number of successes </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p> number of trials </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p> confidence level </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p> character string specifing which method to use; see details. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rand</code></td>
<td>
<p> seed for random number generator; see details. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p> number of bootstrap replicates. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootci.type</code></td>
<td>
<p> type of bootstrap interval; see <code>boot.ci</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p> a character string specifying one- or two-sided confidence intervals. 
Must be one of "two.sided" (default), "greater" or "less" (one-sided intervals). 
You can specify just the initial letter. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> further arguments passed to function <code>boot</code>,
e.g. for parallel computing. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Wald interval is obtained by inverting the acceptance region of the Wald
large-sample normal test. There is also a Wald interval with continuity 
correction (<code>"wald-cc"</code>).
</p>
<p>The Wilson interval, which is the default, was introduced by Wilson (1927) and is
the inversion of the CLT approximation to the family of equal tail tests of p = p0.
The Wilson interval is recommended by Agresti and Coull (1998) as well as by
Brown et al (2001).
</p>
<p>The Agresti-Coull interval was proposed by Agresti and Coull (1998) and is a slight
modification of the Wilson interval. The Agresti-Coull intervals are never shorter
than the Wilson intervals; cf. Brown et al (2001).
</p>
<p>The Jeffreys interval is an implementation of the equal-tailed Jeffreys prior interval
as given in Brown et al (2001).
</p>
<p>The modified Wilson interval is a modification of the Wilson interval for x close to 0
or n as proposed by Brown et al (2001).
</p>
<p>The modified Jeffreys interval is a modification of the Jeffreys interval for
<code>x == 0 | x == 1</code> and <code>x == n-1 | x == n</code> as proposed by
Brown et al (2001).
</p>
<p>The Clopper-Pearson interval is based on quantiles of corresponding beta
distributions. This is sometimes also called exact interval.
</p>
<p>The arcsine interval is based on the variance stabilizing distribution for the binomial
distribution.
</p>
<p>The logit interval is obtained by inverting the Wald type interval for the log odds.
</p>
<p>The Witting interval (cf. Beispiel 2.106 in Witting (1985)) uses randomization to
obtain uniformly optimal lower and upper confidence bounds (cf. Satz 2.105 in
Witting (1985)) for binomial proportions.
</p>
<p>The bootstrap interval is calculated by using function <code>boot.ci</code>.
</p>
<p>For more details we refer to Brown et al (2001) as well as Witting (1985).
</p>


<h3>Value</h3>

<p>A list with class <code>"confint"</code> containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p> the estimated probability of success. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.int</code></td>
<td>
<p> a confidence interval for the probability of success. </p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>A first version of this function appeared in R package SLmisc.
</p>


<h3>Author(s)</h3>

<p> Matthias Kohl <a href="mailto:Matthias.Kohl@stamats.de">Matthias.Kohl@stamats.de</a></p>


<h3>References</h3>

<p>A. Agresti and B.A. Coull (1998). Approximate is better than "exact" for interval
estimation of binomial proportions.
<em>American Statistician</em>, <b>52</b>, 119-126.
</p>
<p>L.D. Brown, T.T. Cai and A. Dasgupta (2001). Interval estimation for a binomial
proportion. <em>Statistical Science</em>, <b>16</b>(2), 101-133.
</p>
<p>H. Witting (1985). <em>Mathematische Statistik I</em>. Stuttgart: Teubner.
</p>


<h3>See Also</h3>

<p><code>binom.test</code></p>


<h3>Examples</h3>

<pre><code class="language-R">binomCI(x = 42, n = 43, method = "wald")
binomCI(x = 42, n = 43, method = "wald-cc")
binomCI(x = 42, n = 43, method = "wilson")
binomCI(x = 42, n = 43, method = "agresti-coull")
binomCI(x = 42, n = 43, method = "jeffreys")
binomCI(x = 42, n = 43, method = "modified wilson")
binomCI(x = 42, n = 43, method = "modified jeffreys")
binomCI(x = 42, n = 43, method = "clopper-pearson")
binomCI(x = 42, n = 43, method = "arcsine")
binomCI(x = 42, n = 43, method = "logit")
binomCI(x = 42, n = 43, method = "witting")
## bootstrap intervals (R = 999 to reduce computation time for R checks)
binomCI(x = 42, n = 43, method = "boot", R = 999) # may generate values &gt; 1!

## the confidence interval computed by binom.test
## corresponds to the Clopper-Pearson interval
binomCI(x = 42, n = 43, method = "clopper-pearson")$conf.int
binom.test(x = 42, n = 43)$conf.int

## one-sided intervals
binomCI(x = 10, n = 43, alternative = "less")
binomCI(x = 10, n = 43, alternative = "less", method = "boot", 
        bootci.type = "bca", R = 999)
binomCI(x = 10, n = 43, alternative = "greater", method = "boot", 
        bootci.type = "perc", R = 999)
        

## parallel computing for bootstrap
binomCI(x = 10, n = 43, method = "boot", R = 9999, 
        parallel = "multicore", ncpus = 2)

</code></pre>


</div>