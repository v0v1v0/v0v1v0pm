<div class="container">

<table style="width: 100%;"><tr>
<td>normDiffCI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Confidence Intervals for Difference of Means </h2>

<h3>Description</h3>

<p>This function can be used to compute confidence intervals for difference
of means assuming normal distributions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">normDiffCI(x, y, conf.level = 0.95, paired = FALSE, method = "welch", 
           boot = FALSE, R = 9999, bootci.type = "all", na.rm = TRUE, 
           alternative = c("two.sided", "less", "greater"), ...)
meanDiffCI(x, y, conf.level = 0.95, paired = FALSE, method = "welch", 
           boot = FALSE, R = 9999, bootci.type = "all", na.rm = TRUE, 
           alternative = c("two.sided", "less", "greater"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> numeric vector of data values of group 1. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p> numeric vector of data values of group 2. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p> confidence level. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>paired</code></td>
<td>
<p> a logical value indicating whether the two groups are paired. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p> a character string specifing which method to use in the unpaired case; see details. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot</code></td>
<td>
<p> a logical value indicating whether bootstrapped confidence intervals shall be computed. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p> number of bootstrap replicates. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootci.type</code></td>
<td>
<p> type of bootstrap interval; see <code>boot.ci</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p> a logical value indicating whether <code>NA</code> values should be stripped before the computation proceeds. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p> a character string specifying one- or two-sided confidence intervals. 
Must be one of "two.sided" (default), "greater" or "less" (one-sided intervals). 
You can specify just the initial letter. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> further arguments passed to function <code>boot</code>,
e.g. for parallel computing. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The standard confidence intervals for the difference of means are
computed that can be found in many textbooks, e.g. Chapter 4 in Altman et al. (2000).
</p>
<p>The method <code>"classical"</code> assumes equal variances whereas methods
<code>"welch"</code> and <code>"hsu"</code> allow for unequal variances. The latter two
methods use different formulas for computing the degrees of freedom of the
respective t-distribution providing the quantiles in the confidence interval.
Instead of the Welch-Satterhwaite equation the method of Hsu uses the minimum
of the group sample sizes minus 1; see Section 6.8.3 of Hedderich and Sachs (2018).
</p>


<h3>Value</h3>

<p>A list with class <code>"confint"</code> containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p> point estimate (mean of differences or difference in means). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.int</code></td>
<td>
<p> confidence interval. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Infos</code></td>
<td>
<p> additional information. </p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Matthias Kohl <a href="mailto:Matthias.Kohl@stamats.de">Matthias.Kohl@stamats.de</a></p>


<h3>References</h3>

<p>D. Altman, D. Machin, T. Bryant, M. Gardner (eds). <em>Statistics with Confidence:
Confidence Intervals and Statistical Guidelines</em>, 2nd edition.
John Wiley and Sons 2000.
</p>
<p>J. Hedderich, L. Sachs. <em>Angewandte Statistik: Methodensammlung mit R</em>.
Springer 2018.
</p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- rnorm(100)
y &lt;- rnorm(100, sd = 2)
## paired
normDiffCI(x, y, paired = TRUE)
## (R = 999 to reduce computation time for R checks)
normDiffCI(x, y, paired = TRUE, boot = TRUE, R = 999)
## compare
normCI(x-y)
## (R = 999 to reduce computation time for R checks)
normCI(x-y, boot = TRUE, R = 999)

## unpaired
y &lt;- rnorm(90, mean = 1, sd = 2)
## classical
normDiffCI(x, y, method = "classical")
## (R = 999 to reduce computation time for R checks)
normDiffCI(x, y, method = "classical", boot = TRUE, R = 999)
## Welch (default as in case of function t.test)
normDiffCI(x, y, method = "welch")
## (R = 999 to reduce computation time for R checks)
normDiffCI(x, y, method = "welch", boot = TRUE, R = 999)
## Hsu
normDiffCI(x, y, method = "hsu")
## In case of bootstrap there is no difference between welch and hsu
## (R = 999 to reduce computation time for R checks)
normDiffCI(x, y, method = "hsu", boot = TRUE, R = 999)

## one-sided
normDiffCI(x, y, alternative = "less")
normDiffCI(x, y, boot = TRUE, R = 999, alternative = "greater")


## parallel computing for bootstrap
normDiffCI(x, y, method = "welch", boot = TRUE, R = 9999, 
           parallel = "multicore", ncpus = 2)



## Monte-Carlo simulation: coverage probability
M &lt;- 100 # increase for more stable/realistic results!
CIhsu &lt;- CIwelch &lt;- CIclass &lt;- matrix(NA, nrow = M, ncol = 2)
for(i in 1:M){
  x &lt;- rnorm(10)
  y &lt;- rnorm(30, sd = 0.1)
  CIclass[i,] &lt;- normDiffCI(x, y, method = "classical")$conf.int
  CIwelch[i,] &lt;- normDiffCI(x, y, method = "welch")$conf.int
  CIhsu[i,] &lt;- normDiffCI(x, y, method = "hsu")$conf.int
}
## coverage probabilies
## classical
sum(CIclass[,1] &lt; 0 &amp; 0 &lt; CIclass[,2])/M
## Welch
sum(CIwelch[,1] &lt; 0 &amp; 0 &lt; CIwelch[,2])/M
## Hsu
sum(CIhsu[,1] &lt; 0 &amp; 0 &lt; CIhsu[,2])/M

</code></pre>


</div>