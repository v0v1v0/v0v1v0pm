<div class="container">

<table style="width: 100%;"><tr>
<td>quantileCI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Confidence Intervals for Quantiles </h2>

<h3>Description</h3>

<p>These functions can be used to compute confidence intervals for quantiles
(including median and MAD).
</p>


<h3>Usage</h3>

<pre><code class="language-R">quantileCI(x, prob = 0.5, conf.level = 0.95, method = "exact",
           R = 9999, bootci.type = c("norm", "basic", "perc", "bca"), 
           na.rm = FALSE, alternative = c("two.sided", "less", "greater"), ...)
medianCI(x, conf.level = 0.95, method = "exact",
         R = 9999, bootci.type = c("norm", "basic", "perc", "bca"), 
         na.rm = FALSE, alternative = c("two.sided", "less", "greater"), ...)
madCI(x, conf.level = 0.95, method = "exact", 
      R = 9999, bootci.type = c("norm", "basic", "perc", "bca"), 
      na.rm = FALSE, constant = 1.4826, 
      alternative = c("two.sided", "less", "greater"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> numeric data vector </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p> quantile </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p> confidence level </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p> character string specifing which method to use; see details. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p> number of bootstrap replicates. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootci.type</code></td>
<td>
<p> type of bootstrap interval; see <code>boot.ci</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p> logical, remove <code>NA</code> values. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constant</code></td>
<td>
<p> scale factor (see <code>mad</code>). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p> a character string specifying one- or two-sided confidence intervals. 
Must be one of "two.sided" (default), "greater" or "less" (one-sided intervals). 
You can specify just the initial letter. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> further arguments passed to function <code>boot</code>,
e.g. for parallel computing. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The exact confidence interval (<code>method = "exact"</code>) is computed using binomial
probabilities; see Section 6.8.1 in Sachs and Hedderich (2009). If the result is not
unique, i.e. there is more than one interval with coverage proability closest to
<code>conf.level</code>, the shortest confidence interval is returned.
</p>
<p>The asymptotic confidence interval (<code>method = "asymptotic"</code>) is based on the
normal approximation of the binomial distribution; see Section 6.8.1 in Sachs and Hedderich (2009).
</p>
<p>In case of discrete data, there are alternative bootstrap approaches that might 
give better results; see Jentsch and Leucht (2016).
</p>
<p>Since <code>madCI</code> is computed as the median confidence interval of the 
absolut deviations from the sample median and ignores the variablity of the 
sample median, the exact and asymptotic confidence intervals might be too short.
We recommend to use bootstrap confidence intervals.
</p>


<h3>Value</h3>

<p>A list with components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p> the sample quantile. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI</code></td>
<td>
<p> a confidence interval for the sample quantile. </p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Matthias Kohl <a href="mailto:Matthias.Kohl@stamats.de">Matthias.Kohl@stamats.de</a></p>


<h3>References</h3>

<p>L. Sachs and J. Hedderich (2009). <em>Angewandte Statistik</em>. Springer.
</p>
<p>C. Jentsch and A. Leucht (2016). Bootstrapping sample quantiles of discrete data.
<em>Ann Inst Stat Math</em>, <b>68</b>: 491-539.
</p>


<h3>See Also</h3>

<p><code>quantile</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## To get a non-trivial exact confidence interval for the median
## one needs at least 6 observations
x &lt;- rnorm(5)
medianCI(x)

## asymptotic confidence interval
medianCI(x, method = "asymptotic")
madCI(x, method = "asymptotic")

## bootstrap confidence interval
x &lt;- rnorm(50)
medianCI(x)
medianCI(x, method = "asymptotic")
## (R = 999 to reduce computation time for R checks)
medianCI(x, method = "boot", R = 999)

madCI(x)
madCI(x, method = "asymptotic")
## (R = 999 to reduce computation time for R checks)
madCI(x, method = "boot", R = 999)

## confidence interval for quantiles
quantileCI(x, prob = 0.25)
quantileCI(x, prob = 0.25, method = "asymptotic")

quantileCI(x, prob = 0.75)
## (R = 999 to reduce computation time for R checks)
quantileCI(x, prob = 0.75, method = "boot", R = 999)

## one-sided
quantileCI(x, prob = 0.75, alternative = "greater")
medianCI(x, alternative = "less", method = "asymptotic")
madCI(x, alternative = "greater", method = "boot", R = 999)


## parallel computing for bootstrap
medianCI(x, method = "boot", R = 9999, parallel = "multicore", 
         ncpus = 2)

</code></pre>


</div>