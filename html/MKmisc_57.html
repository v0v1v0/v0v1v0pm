<div class="container">

<table style="width: 100%;"><tr>
<td>power.diagnostic.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Power calculations for a diagnostic test</h2>

<h3>Description</h3>

<p>Compute sample size, power, delta, or significance level of a diagnostic test
for an expected sensititivy or specificity.
</p>


<h3>Usage</h3>

<pre><code class="language-R">power.diagnostic.test(sens = NULL, spec = NULL,
                      n = NULL, delta = NULL, sig.level = 0.05,
                      power = NULL, prev = NULL, 
                      method = c("exact", "asymptotic"),
                      NMAX = 1e4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sens</code></td>
<td>
<p>Expected sensitivity; either <code>sens</code> or <code>spec</code> has to be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spec</code></td>
<td>
<p>Expected specificity; either <code>sens</code> or <code>spec</code> has to be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of cases if <code>sens</code> and number of controls if <code>spec</code> is given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p><code>sens</code>-<code>delta</code> resp. <code>spec</code>-<code>delta</code> is used as lower
confidence limit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig.level</code></td>
<td>
<p>Significance level (Type I error probability)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>Power of test (1 minus Type II error probability)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prev</code></td>
<td>
<p>Expected prevalence, if <code>NULL</code> prevalence is ignored which means <code>prev = 0.5</code>
is assumed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>exact or asymptotic formula; default <code>"exact"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NMAX</code></td>
<td>
<p>Maximum sample size considered in case <code>method = "exact"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Either <code>sens</code> or <code>spec</code> has to be specified which leads to 
computations for either cases or controls.
</p>
<p>Exactly one of the parameters <code>n</code>, <code>delta</code>, <code>sig.level</code>, 
and <code>power</code> must be passed as <code>NULL</code>, and that parameter is determined 
from the others. Notice that <code>sig.level</code> has a non-<code>NULL</code> default 
so <code>NULL</code> must be explicitly passed if you want to compute it.
</p>
<p>The computations are based on the formulas given in the Appendix of 
Flahault et al. (2005). Please be careful, in Equation (A1) the numerator
should be squared, in equation (A2) and (A3) the second exponent should be
n-i and not i.
</p>
<p>As noted in Chu and Cole (2007) power is not a monotonically increasing
function in n but rather saw toothed (see also Chernick and Liu (2002)).
Hence, in our calculations we use the more conservative approach II); 
i.e., the minimum sample size <code>n</code> such that the actual power is 
larger or equal <code>power</code> andsuch that for any sample size larger 
than <code>n</code> it also holds that the actual power is larger or equal 
<code>power</code>.
</p>


<h3>Value</h3>

<p>Object of class <code>"power.htest"</code>, a list of the arguments
(including the computed one) augmented with <code>method</code> and
<code>note</code> elements.
</p>


<h3>Note</h3>

<p><code>uniroot</code> is used to solve power equation for unknowns, so
you may see errors from it, notably about inability to bracket the
root when invalid arguments are given.
</p>


<h3>Author(s)</h3>

<p>Matthias Kohl <a href="mailto:Matthias.Kohl@stamats.de">Matthias.Kohl@stamats.de</a></p>


<h3>References</h3>

 
<p>A. Flahault, M. Cadilhac, and G. Thomas (2005). Sample size calculation 
should be performed for design accuracy in diagnostic test studies. 
<em>Journal of Clinical Epidemiology</em>, <b>58</b>(8):859-862.
</p>
<p>H. Chu and S.R. Cole (2007). Sample size calculation using exact methods 
in diagnostic test studies. 
<em>Journal of Clinical Epidemiology</em>, <b>60</b>(11):1201-1202.
</p>
<p>M.R. Chernick amd C.Y. Liu (2002). The saw-toothed behavior of power versus 
sample size and software solutions: single binomial proportion using 
exact methods. <em>Am Stat</em>, <b>56</b>:149-155.
</p>


<h3>See Also</h3>

<p><code>uniroot</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## see n2 on page 1202 of Chu and Cole (2007)
power.diagnostic.test(sens = 0.99, delta = 0.14, power = 0.95) # 40
power.diagnostic.test(sens = 0.99, delta = 0.13, power = 0.95) # 43
power.diagnostic.test(sens = 0.99, delta = 0.12, power = 0.95) # 47

power.diagnostic.test(sens = 0.98, delta = 0.13, power = 0.95) # 50
power.diagnostic.test(sens = 0.98, delta = 0.11, power = 0.95) # 58

## see page 1201 of Chu and Cole (2007)
power.diagnostic.test(sens = 0.95, delta = 0.1, n = 93) ## 0.957
power.diagnostic.test(sens = 0.95, delta = 0.1, n = 93, power = 0.95, 
                      sig.level = NULL) ## 0.0496
power.diagnostic.test(sens = 0.95, delta = 0.1, n = 102) ## 0.968
power.diagnostic.test(sens = 0.95, delta = 0.1, n = 102, power = 0.95, 
                      sig.level = NULL) ## 0.0471
## yields 102 not 93!
power.diagnostic.test(sens = 0.95, delta = 0.1, power = 0.95)
</code></pre>


</div>