<div class="container">

<table style="width: 100%;"><tr>
<td>power.mpe.unknown.var</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multiple Co-Primary Endpoints with Unknown Covariance</h2>

<h3>Description</h3>

<p>The function calculates either sample size or power for continuous multiple
co-primary endpoints with unknown covariance.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  power.mpe.unknown.var(K, n = NULL, delta = NULL, Sigma, SD, rho, sig.level = 0.05,
                        power = NULL, M = 10000, n.min = NULL, n.max = NULL,
                        tol = .Machine$double.eps^0.25, use.uniroot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>number of co-primary endpoints</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>optional: sample size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>expected effect size (length <code>K</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>unknown covariance matrix (dimension <code>K</code> x <code>K</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SD</code></td>
<td>
<p>unknown standard deviations (length <code>K</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>unknown correlations (length <code>0.5*K*(K-1)</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig.level</code></td>
<td>
<p>significance level (Type I error probability)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>optional: power of test (1 minus Type II error probability)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>Number of replications for the required simulations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.min</code></td>
<td>
<p>Starting point of search interval for sample size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.max</code></td>
<td>
<p>End point of search interval for sample size, must be larger than <code>n.min</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>the desired accuracy for <code>uniroot</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.uniroot</code></td>
<td>
<p>Finds one root of one equation</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function can be used to either compute sample size or power for continuous
multiple co-primary endpoints with unknown covariance. The implementation is
based on the formulas given in the references below.
</p>
<p>The null hypothesis reads <code class="reqn">\mu_{Tk}-\mu_{Ck}\le 0</code> for
at least one <code class="reqn">k\in\{1,\ldots,K\}</code> where Tk is treatment k,
Ck is control k and K is the number of co-primary endpoints.
</p>
<p>One has to specify either <code>n</code> or <code>power</code>, the other parameter is
determined. An approach to calculate sample size <code>n</code>, is to first call
<code>power.mpe.known.var</code> and use the result as <code>n.min</code>. The input for
<code>n.max</code> must be larger then <code>n.min</code>. Moreover, either covariance
matrix <code>Sigma</code> or standard deviations <code>SD</code> and correlations <code>rho</code>
must be given.
</p>
<p>The sample size is calculated by simulating Wishart distributed random matrices,
hence the results include a certain random variation.
</p>


<h3>Value</h3>

<p>Object of class <code>power.mpe.test</code>, a list of arguments (including the
computed one) augmented with method and note elements.
</p>


<h3>Note</h3>

<p>The function first appeared in package <span class="pkg">mpe</span>, which is now archived on CRAN.</p>


<h3>Author(s)</h3>

<p>Srinath Kolampally, Matthias Kohl <a href="mailto:Matthias.Kohl@stamats.de">Matthias.Kohl@stamats.de</a></p>


<h3>References</h3>

<p>Sugimoto, T. and Sozu, T. and Hamasaki, T. (2012). A convenient formula for sample
size calculations in clinical trials with multiple co-primary continuous endpoints.
<em>Pharmaceut. Statist.</em>, <b>11</b>: 118-128. doi:10.1002/pst.505
</p>
<p>Sozu, T. and Sugimoto, T. and Hamasaki, T. and Evans, S.R. (2015). <em>Sample
Size Determination in Clinical Trials with Multiple Endpoints</em>. Springer Briefs in
Statistics, ISBN 978-3-319-22005-5.
</p>


<h3>See Also</h3>

 <p><code>power.mpe.known.var</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">## compute power
## Not run: 
power.mpe.unknown.var(K = 2, n = 20, delta = c(1,1), Sigma = diag(c(1,1)))

## To compute sample size, first assume covariance as known
power.mpe.known.var(K = 2, delta = c(1,1), Sigma = diag(c(2,2)), power = 0.9,
                  sig.level = 0.025)

## The value of n, which is 51, is used as n.min and n.max must be larger
## then n.min so we try 60.
power.mpe.unknown.var(K = 2, delta = c(1,1), Sigma = diag(c(2,2)), power = 0.9,
                  sig.level = 0.025, n.min = 51, n.max = 60)

## More complex example with unknown covariance matrix assumed to be
Sigma &lt;- matrix(c(1.440, 0.840, 1.296, 0.840,
                  0.840, 1.960, 0.168, 1.568,
                  1.296, 0.168, 1.440, 0.420,
                  0.840, 1.568, 0.420, 1.960), ncol = 4)
## compute power
power.mpe.unknown.var(K = 4, n = 90, delta = c(0.5, 0.75, 0.5, 0.75), Sigma = Sigma)
## equivalent: unknown SDs and correlation rho
power.mpe.unknown.var(K = 4, n = 90, delta = c(0.5, 0.75, 0.5, 0.75),
                      SD = c(1.2, 1.4, 1.2, 1.4),
                      rho = c(0.5, 0.9, 0.5, 0.1, 0.8, 0.25))

## End(Not run)</code></pre>


</div>