<div class="container">

<table style="width: 100%;"><tr>
<td>sim.power.t.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Monte Carlo Simulations for Empirical Power of Two-sample t-Tests</h2>

<h3>Description</h3>

<p>Simulate the empirical power and type-I-error of two-sample t-tests; i.e.,
classical (equal variances), Welch and Hsu t-tests.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim.power.t.test(nx, rx, rx.H0 = NULL, ny, ry, ry.H0 = NULL, 
                 sig.level = 0.05, conf.int = FALSE, mu = 0, 
                 alternative = c("two.sided", "less", "greater"), 
                 iter = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nx</code></td>
<td>
<p> single numeric, sample size of first group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rx</code></td>
<td>
<p> function to simulate the values of first group (assuming H1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rx.H0</code></td>
<td>
 <p><code>NULL</code> or function to simulate the values of first group (assuming H0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ny</code></td>
<td>
<p> single numeric, sample size of second group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ry</code></td>
<td>
<p> function to simulate the values of second group (assuming H1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ry.H0</code></td>
<td>
 <p><code>NULL</code> or function to simulate the values of second group (assuming H0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig.level</code></td>
<td>
<p> significance level (type I error probability)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.int</code></td>
<td>
<p> logical, shall confidence intervals be computed. 
Increases computation time!</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p> true value of the location shift for the null hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>one- or two-sided test.  Can be abbreviated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p> single integer, number of interations of the simulations.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Functions <code>rx</code> and <code>ry</code> are used to simulate the data under the
alternative hypothesis H1. If specified, functions <code>rx.H0</code> and <code>ry.H0</code>
simulte the data unter the null hypothesis H0.
</p>
<p>For fast computations functions from package <code>matrixTests</code> are used.
</p>


<h3>Value</h3>

<p>Object of class <code>"sim.power.ttest"</code> with the results of the three t-tests
in the list elements <code>Classical</code>, <code>Welch</code> and <code>Hsu</code>. In addition,
the simulation setup is saved in element <code>SetUp</code>.
</p>


<h3>Author(s)</h3>

<p>Matthias Kohl <a href="mailto:Matthias.Kohl@stamats.de">Matthias.Kohl@stamats.de</a></p>


<h3>References</h3>

<p>J. Hedderich, L. Sachs. <em>Angewandte Statistik: Methodensammlung mit R</em>.
Springer 2018.
</p>
<p>Hsu, P. (1938). Contribution to the theory of “student's” t-test as 
applied to the problem of two samples. <em>Statistical Research Memoirs</em> <b>2</b>: 
1-24.
</p>
<p>Student (1908). The Probable Error of a Mean. <em>Biometrika</em>, <b>6</b>(1): 1-25.
</p>
<p>Welch, B. L. (1947). The generalization of “Student's” problem when several 
different population variances are involved. <em>Biometrika</em>, <b>34</b> 
(1-2): 28-35.
</p>


<h3>See Also</h3>

<p><code>t.test</code>, <code>hsu.t.test</code>, 
<code>ttest</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Equal variance, small sample size
power.t.test(n = 5, delta = 2)
power.welch.t.test(n = 5, delta = 2)
power.hsu.t.test(n = 5, delta = 2)
sim.power.t.test(nx = 5, rx = rnorm, rx.H0 = rnorm,
                 ny = 5, ry = function(x) rnorm(x, mean = 2), ry.H0 = rnorm)

## Equal variance, moderate sample size
power.t.test(n = 25, delta = 0.8)
power.welch.t.test(n = 25, delta = 0.8)
power.hsu.t.test(n = 25, delta = 0.8)
sim.power.t.test(nx = 25, rx = rnorm, rx.H0 = rnorm,
                 ny = 25, ry = function(x) rnorm(x, mean = 0.8), ry.H0 = rnorm)

## Equal variance, high sample size
power.t.test(n = 100, delta = 0.4)
power.welch.t.test(n = 100, delta = 0.4)
power.hsu.t.test(n = 100, delta = 0.4)
sim.power.t.test(nx = 100, rx = rnorm, rx.H0 = rnorm,
                 ny = 100, ry = function(x) rnorm(x, mean = 0.4), ry.H0 = rnorm)

## Unequal variance, small sample size
power.welch.t.test(n = 5, delta = 5, sd1 = 1, sd2 = 3)
power.hsu.t.test(n = 5, delta = 5, sd1 = 1, sd2 = 3)
sim.power.t.test(nx = 5, rx = rnorm, rx.H0 = rnorm, 
                 ny = 5, ry = function(x) rnorm(x, mean = 5, sd = 3), 
                 ry.H0 = function(x) rnorm(x, sd = 3))
                 
## Unequal variance, moderate sample size
power.welch.t.test(n = 25, delta = 1.8, sd1 = 1, sd2 = 3)
power.hsu.t.test(n = 25, delta = 1.8, sd1 = 1, sd2 = 3)
sim.power.t.test(nx = 25, rx = rnorm, rx.H0 = rnorm, 
                 ny = 25, ry = function(x) rnorm(x, mean = 1.8, sd = 3), 
                 ry.H0 = function(x) rnorm(x, sd = 3))
                 
## Unequal variance, high sample size
power.welch.t.test(n = 100, delta = 0.9, sd1 = 1, sd2 = 3)
power.hsu.t.test(n = 100, delta = 0.9, sd1 = 1, sd2 = 3)
sim.power.t.test(nx = 100, rx = rnorm, rx.H0 = rnorm, 
                 ny = 100, ry = function(x) rnorm(x, mean = 0.9, sd = 3), 
                 ry.H0 = function(x) rnorm(x, sd = 3))
                 
## Unequal variance, unequal sample sizes
## small sample sizes
sim.power.t.test(nx = 10, rx = rnorm, rx.H0 = rnorm, 
                 ny = 5, ry = function(x) rnorm(x, mean = 5, sd = 3), 
                 ry.H0 = function(x) rnorm(x, sd = 3))
sim.power.t.test(nx = 5, rx = rnorm, rx.H0 = rnorm, 
                 ny = 10, ry = function(x) rnorm(x, mean = 3, sd = 3), 
                 ry.H0 = function(x) rnorm(x, sd = 3))

## Unequal variance, unequal sample sizes
## moderate sample sizes
sim.power.t.test(nx = 25, rx = rnorm, rx.H0 = rnorm, 
                 ny = 50, ry = function(x) rnorm(x, mean = 1.5, sd = 3), 
                 ry.H0 = function(x) rnorm(x, sd = 3))

## Unequal variance, unequal sample sizes
## high sample sizes
sim.power.t.test(nx = 100, rx = rnorm, rx.H0 = rnorm, 
                 ny = 200, ry = function(x) rnorm(x, mean = 0.6, sd = 3), 
                 ry.H0 = function(x) rnorm(x, sd = 3))
</code></pre>


</div>