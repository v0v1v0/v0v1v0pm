<div class="container">

<table style="width: 100%;"><tr>
<td>sim.ssize.wilcox.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sample Size for Wilcoxon Rank Sum and Signed Rank Tests</h2>

<h3>Description</h3>

<p>Simulate the empirical power of Wilcoxon rank sum and signed rank tests for
computing the required sample size.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim.ssize.wilcox.test(rx, ry = NULL, mu = 0, sig.level = 0.05, power = 0.8, 
                      type = c("two.sample", "one.sample", "paired"), 
                      alternative = c("two.sided", "less", "greater"),
                      n.min = 10, n.max = 200, step.size = 10, 
                      iter = 10000, BREAK = TRUE, exact = NA, correct = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>rx</code></td>
<td>
<p> function to simulate the values of x, respectively x-y in the paired case.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ry</code></td>
<td>
<p> function to simulate the values of y in the two-sample case</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p> true values of the location shift for the null hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig.level</code></td>
<td>
<p> significance level (Type I error probability)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p> two-sample, one-sample or paired test </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p> one- or two-sided test.  Can be abbreviated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>one- or two-sided test.  Can be abbreviated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.min</code></td>
<td>
<p> integer, start value of grid search.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.max</code></td>
<td>
<p> integer, stop value of grid search.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step.size</code></td>
<td>
<p> integer, step size used in the grid search.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p> integer, number of interations of the simulations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BREAK</code></td>
<td>
<p> logical, grid search stops when the emperical power is larger
than the requested power.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exact</code></td>
<td>
<p> logical or NA (default) indicator whether an exact p-value should 
be computed (see Details at <code>wilcoxon</code>). A single 
value or a logical vector with values for each observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correct</code></td>
<td>
<p>ogical indicator whether continuity correction should be applied 
in the cases where p-values are obtained using normal approximation. A single 
value or logical vector with values for each observation; see 
<code>wilcoxon</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Functions <code>rx</code> and <code>ry</code> are used to simulate the data and 
functions <code>row_wilcoxon_twosample</code> and <code>row_wilcoxon_onesample</code> of 
package <span class="pkg">matrixTests</span> are used to efficiently compute the p values of the 
respective test.
</p>
<p>We recommend a two steps procedure: In the first step, start with a wide grid 
and find out in which range of sample size values the intended power will
be achieved. In the second step, the interval identified in the first step 
is used to find the sample size that leads to the required power setting
<code>step.size = 1</code> and <code>BREAK = FALSE</code>. This approach is applied 
in the examples below.
</p>


<h3>Value</h3>

<p>Object of class <code>"power.htest"</code>, a list of the arguments
(including the computed one) augmented with <code>method</code> and
<code>note</code> elements.
</p>


<h3>Author(s)</h3>

<p>Matthias Kohl <a href="mailto:Matthias.Kohl@stamats.de">Matthias.Kohl@stamats.de</a></p>


<h3>References</h3>

<p>Wilcoxon, F (1945). Individual Comparisons by Ranking Methods. 
<em>Biometrics Bulletin</em>, <b>1</b>, 80-83.
</p>


<h3>See Also</h3>

<p><code>wilcox.test</code>, <code>wilcoxon</code></p>


<h3>Examples</h3>

<pre><code class="language-R"> 
  ###############################################################################
  ## two-sample
  ## iter = 1000 to reduce check time
  ###############################################################################
  rx &lt;- function(n) rnorm(n, mean = 0, sd = 1) 
  ry &lt;- function(n) rnorm(n, mean = 0.5, sd = 1) 
  sim.ssize.wilcox.test(rx = rx, ry = ry, n.max = 100, iter = 1000)
  sim.ssize.wilcox.test(rx = rx, ry = ry, n.min = 65, n.max = 70, step.size = 1, 
                        iter = 1000, BREAK = FALSE)
  ## compared to
  power.t.test(delta = 0.5, power = 0.8)
  
  rx &lt;- function(n) rnorm(n, mean = 0, sd = 1) 
  ry &lt;- function(n) rnorm(n, mean = 0.5, sd = 1.5) 
  sim.ssize.wilcox.test(rx = rx, ry = ry, n.max = 100, iter = 1000, alternative = "less")
  sim.ssize.wilcox.test(rx = rx, ry = ry, n.min = 85, n.max = 90, step.size = 1, 
                        iter = 1000, BREAK = FALSE, alternative = "less")
  ## compared to
  power.welch.t.test(delta = 0.5, sd = 1, sd2 = 1.5, power = 0.8, alternative = "one.sided")
  
  rx &lt;- function(n) rnorm(n, mean = 0.5, sd = 1)
  ry &lt;- function(n) rnorm(n, mean = 0, sd = 1)
  sim.ssize.wilcox.test(rx = rx, ry = ry, n.max = 100, iter = 1000, alternative = "greater")
  sim.ssize.wilcox.test(rx = rx, ry = ry, n.min = 50, n.max = 55, step.size = 1, 
                        iter = 1000, BREAK = FALSE, alternative = "greater")
  ## compared to
  power.t.test(delta = 0.5, power = 0.8, alternative = "one.sided")
  
  rx &lt;- function(n) rgamma(n, scale = 10, shape = 1)
  ry &lt;- function(n) rgamma(n, scale = 15, shape = 1)
  sim.ssize.wilcox.test(rx = rx, ry = ry, n.max = 200, iter = 1000)
  sim.ssize.wilcox.test(rx = rx, ry = ry, n.min = 125, n.max = 135, step.size = 1, 
                        iter = 1000, BREAK = FALSE)
  
  ###############################################################################
  ## one-sample
  ## iter = 1000 to reduce check time
  ###############################################################################
  rx &lt;- function(n) rnorm(n, mean = 0.5, sd = 1)
  sim.ssize.wilcox.test(rx = rx, mu = 0, type = "one.sample", n.max = 100, iter = 1000)
  sim.ssize.wilcox.test(rx = rx, mu = 0, type = "one.sample", n.min = 33, n.max = 38, 
                        step.size = 1, iter = 1000, BREAK = FALSE)
  ## compared to
  power.t.test(delta = 0.5, power = 0.8, type = "one.sample")
  
  sim.ssize.wilcox.test(rx = rx, mu = 0, type = "one.sample", n.max = 100, iter = 1000,
                        alternative = "greater")
  sim.ssize.wilcox.test(rx = rx, mu = 0, type = "one.sample", n.min = 25, n.max = 30, 
                        step.size = 1, iter = 1000, BREAK = FALSE, alternative = "greater")
  ## compared to
  power.t.test(delta = 0.5, power = 0.8, type = "one.sample", alternative = "one.sided")
  
  sim.ssize.wilcox.test(rx = rx, mu = 1, type = "one.sample", n.max = 100, iter = 1000,
                        alternative = "less")
  sim.ssize.wilcox.test(rx = rx, mu = 1, type = "one.sample", n.min = 20, n.max = 30, 
                        step.size = 1, iter = 1000, BREAK = FALSE, alternative = "less")
  ## compared to
  power.t.test(delta = 0.5, power = 0.8, type = "one.sample", alternative = "one.sided")
  
  rx &lt;- function(n) rgamma(n, scale = 10, shape = 1)
  sim.ssize.wilcox.test(rx = rx, mu = 5, type = "one.sample", n.max = 200, iter = 1000)
  sim.ssize.wilcox.test(rx = rx, mu = 5, type = "one.sample", n.min = 40, n.max = 50, 
                        step.size = 1, iter = 1000, BREAK = FALSE)
  
  ###############################################################################
  ## paired
  ## identical to one-sample, requires random number generating function 
  ## that simulates the difference x-y
  ## iter = 1000 to reduce check time
  ###############################################################################
  rxy &lt;- function(n) rnorm(n, mean = 0.5, sd = 1)
  sim.ssize.wilcox.test(rx = rxy, mu = 0, type = "paired", n.max = 100, 
                        iter = 1000)
  sim.ssize.wilcox.test(rx = rxy, mu = 0, type = "paired", n.min = 33, 
                        n.max = 38, step.size = 1, iter = 1000, BREAK = FALSE)
  ## compared to
  power.t.test(delta = 0.5, power = 0.8, type = "paired")

</code></pre>


</div>