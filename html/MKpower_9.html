<div class="container">

<table style="width: 100%;"><tr>
<td>power.mpe.atleast.one</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Power for at least One Endpoint with Known Covariance</h2>

<h3>Description</h3>

<p>The function calculates either sample size or power for continuous multiple
primary endpoints for at least one endpoint with known covariance.
</p>


<h3>Usage</h3>

<pre><code class="language-R">power.mpe.atleast.one(K, n = NULL, delta = NULL, Sigma, SD, rho, sig.level = 0.05/K,
                             power = NULL, n.max = 1e5, tol = .Machine$double.eps^0.25)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>number of endpoints</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>optional: sample size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>expected effect size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>A covariance of known matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SD</code></td>
<td>
<p>known standard deviations (length <code>K</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>known correlations (length <code>0.5*K*(K-1)</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig.level</code></td>
<td>
<p>Significance level (Type I error probability)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>optional: Power of test (1 minus Type II error probability)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.max</code></td>
<td>
<p>upper end of the interval to be search for <code>n</code> via <code>uniroot</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>The desired accuracy</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function can be used to either compute sample size or power for continuous
multiple primary endpoints with known covariance where a significant difference 
for at least one endpoint is expected.
The implementation is based on the formulas given in the references below.
</p>
<p>The null hypothesis reads <code class="reqn">\mu_{Tk}-\mu_{Ck}\le 0</code> for
all <code class="reqn">k\in\{1,\ldots,K\}</code> where Tk is treatment k,
Ck is control k and K is the number of co-primary endpoints.
</p>
<p>One has to specify either <code>n</code> or <code>power</code>, the other parameter is
determined. Moreover, either covariance matrix <code>Sigma</code> or standard
deviations <code>SD</code> and correlations <code>rho</code> must be given.
</p>


<h3>Value</h3>

<p>Object of class <code>power.mpe.test</code>, a list of arguments (including the
computed one) augmented with method and note elements.
</p>


<h3>Note</h3>

<p>The function first appeared in package <span class="pkg">mpe</span>, which is now archived on CRAN.</p>


<h3>Author(s)</h3>

<p>Srinath Kolampally, Matthias Kohl <a href="mailto:Matthias.Kohl@stamats.de">Matthias.Kohl@stamats.de</a></p>


<h3>References</h3>

<p>Sugimoto, T. and Sozu, T. and Hamasaki, T. (2012). A convenient formula for sample
size calculations in clinical trials with multiple co-primary continuous endpoints.
<em>Pharmaceut. Statist.</em>, <b>11</b>: 118-128. doi:10.1002/pst.505
</p>
<p>Sozu, T. and Sugimoto, T. and Hamasaki, T. and Evans, S.R. (2015). <em>Sample
Size Determination in Clinical Trials with Multiple Endpoints</em>. Springer Briefs in
Statistics, ISBN 978-3-319-22005-5.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## compute power
power.mpe.atleast.one(K = 2, delta = c(0.2,0.2), Sigma = diag(c(1,1)), power = 0.8)

## compute sample size
power.mpe.atleast.one(K = 2, delta = c(0.2,0.2), Sigma = diag(c(2,2)), power = 0.9)

## known covariance matrix
Sigma &lt;- matrix(c(1.440, 0.840, 1.296, 0.840,
                  0.840, 1.960, 0.168, 1.568,
                  1.296, 0.168, 1.440, 0.420,
                  0.840, 1.568, 0.420, 1.960), ncol = 4)
## compute power
power.mpe.atleast.one(K = 4, n = 60, delta = c(0.5, 0.75, 0.5, 0.75), Sigma = Sigma)
## equivalent: known SDs and correlation rho
power.mpe.atleast.one(K = 4, n = 60, delta = c(0.5, 0.75, 0.5, 0.75),
                      SD = c(1.2, 1.4, 1.2, 1.4), 
                      rho = c(0.5, 0.9, 0.5, 0.1, 0.8, 0.25))
</code></pre>


</div>