<div class="container">

<table style="width: 100%;"><tr>
<td>search.model_within</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Search for the global maximum of the log-likelihood of within-item muldimensional models</h2>

<h3>Description</h3>

<p>It searches for the global maximum of the log-likelihood of within-item muldimensional models given a vector of possible number of classes to try for.</p>


<h3>Usage</h3>

<pre><code class="language-R">search.model_within(S, yv = rep(1, ns), kv1, kv2, X = NULL, 
                    link = c("global","local"), disc = FALSE, difl = FALSE, 
                    multi1, multi2, fort = FALSE, tol1 = 10^-6, tol2 = 10^-10,
                    glob = FALSE, disp = FALSE, output = FALSE, out_se = FALSE, 
                    nrep = 2, Zth1 = NULL, zth1 = NULL, Zth2=NULL, zth2=NULL, 
                    Zbe=NULL, zbe=NULL, Zga1=NULL, zga1=NULL, Zga2=NULL, 
                    zga2=NULL)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>matrix of all response sequences observed at least once in the sample and listed row-by-row
(use NA for missing responses)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yv</code></td>
<td>
<p>vector of the frequencies of every response configuration in <code>S</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kv1</code></td>
<td>
<p>vector of the possible numbers of ability levels (or latent classes) for the 1st latent variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kv2</code></td>
<td>
<p>vector of the possible numbers of ability levels (or latent classes) for the 2nd latent variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>matrix of covariates affecting the weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>type of link function ("global" for global logits, "local" for local logits);
with global logits a graded response model results; with local logits a  partial credit model results
(with dichotomous responses, global logits is the same as using local logits resulting in the Rasch or
the 2PL model depending on the value assigned to disc)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>disc</code></td>
<td>
<p>indicator of constraints on the discriminating indices (FALSE = all equal to one, TRUE = free)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>difl</code></td>
<td>
<p>indicator of constraints on the difficulty levels (FALSE = free, TRUE = rating scale parametrization)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>multi1</code></td>
<td>
<p>matrix with a number of rows equal to the number of dimensions and elements in each row equal to
the indices of the items measuring the dimension corresponding to that row for the 1st latent variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>multi2</code></td>
<td>
<p>matrix with a number of rows equal to the number of dimensions and elements in each row equal to
the indices of the items measuring the dimension corresponding to that row for the 2nd latent variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fort</code></td>
<td>
<p>to use Fortran routines when possible</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol1</code></td>
<td>
<p>tolerance level for checking convergence of the algorithm as relative difference between 
consecutive log-likelihoods (initial check based on random starting values)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol2</code></td>
<td>
<p>tolerance level for checking convergence of the algorithm as relative difference between 
consecutive log-likelihoods (final convergence)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>glob</code></td>
<td>
<p>to use global logits in the covariates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>disp</code></td>
<td>
<p>to display the likelihood evolution step by step</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>to return additional outputs (Piv,Pp,lkv)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out_se</code></td>
<td>
<p>to return standard errors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrep</code></td>
<td>
<p>number of repetitions of each random initialization</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Zth1</code></td>
<td>
<p>matrix for the specification of constraints on the support points for the 1st latent variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zth1</code></td>
<td>
<p>vector for the specification of constraints on the support points for the 1st latent variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Zth2</code></td>
<td>
<p>matrix for the specification of constraints on the support points for the 2nd latent variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zth2</code></td>
<td>
<p>vector for the specification of constraints on the support points for the 2nd latent variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Zbe</code></td>
<td>
<p>matrix for the specification of constraints on the item difficulty parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zbe</code></td>
<td>
<p>vector for the specification of constraints on the item difficulty parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Zga1</code></td>
<td>
<p>matrix for the specification of constraints on the item discriminating indices for the 1st latent variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zga1</code></td>
<td>
<p>vector for the specification of constraints on the item discriminating indices for the 1st latent variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Zga2</code></td>
<td>
<p>matrix for the specification of constraints on the item discriminating indices for the 2nd latent variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zga2</code></td>
<td>
<p>vector for the specification of constraints on the item discriminating indices for the 2nd latent variable</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>out.single</code></td>
<td>
<p>output of each single model for each <code>k</code> in <code>kv1</code> and <code>kv2</code>; it is similar to output from est_multi_poly_within, with the addition of values of number of latent classes for the 1st latent variable (<code>k1</code>) and the 2nd latent variable (<code>k2</code>) and the sequence of log-likelihoods (<code>lktrace</code>) for the deterministic start, for each random start, and for the final estimation obtained with  a tolerance level equal to <code>tol2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aicv</code></td>
<td>
<p>Akaike Information Criterion index  for each  <code>k</code> in <code>kv1</code> and <code>kv2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bicv</code></td>
<td>
<p>Bayesian Information Criterion index  for each <code>k</code>  in <code>kv1</code> and <code>kv2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>entv</code></td>
<td>
<p>Entropy index for each <code>k</code> in <code>kv1</code> and <code>kv2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>necv</code></td>
<td>
<p>NEC index for each <code>k</code> in <code>kv1</code> and <code>kv2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lkv</code></td>
<td>
<p>log-likelihood at convergence of the EM algorithm  for each  <code>k</code>  in <code>kv1</code> and <code>kv2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>errv</code></td>
<td>
<p>trace of any errors occurred during the estimation process for each  <code>k</code>  in <code>kv1</code> and <code>kv2</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Francesco Bartolucci, Silvia Bacci - University of Perugia (IT)</p>


<h3>References</h3>

<p>Bartolucci, F., Bacci, S. and Gnaldi, M. (2014), MultiLCIRT: An R package for multidimensional latent class item response models,
<em>Computational Statistics &amp; Data Analysis</em>, <b>71</b>, 971-985.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
# Fit the model under different within-item multidimensional structures
# for SF12_nomiss data
data(SF12_nomiss)
S = SF12_nomiss[,1:12]
X = SF12_nomiss[,13]

# Partial credit model with two latent variables sharing six items 
# (free difficulty parameters and constrained discriminating parameters; 
# 1 to 3 latent classes for the 1st latent variable and 1 to 2 classes for the 2nd latent variable; 
# one covariate):
multi1 = c(1:5, 8:12)
multi2 = c(6:12, 1)
out1 = search.model_within(S=S,kv1=1:3,kv2=1:2,X=X,link="global",disc=FALSE,
                             multi1=multi1,multi2=multi2,disp=TRUE,
                             out_se=TRUE,tol1=10^-4, tol2=10^-7, nrep=1)
                             
# Main output
out1$lkv 
out1$aicv
out1$bicv 
# Model with 2 latent classes for each latent variable
out1$out.single[[4]]$k1 
out1$out.single[[4]]$k2 
out1$out.single[[4]]$Th1          
out1$out.single[[4]]$Th2 
out1$out.single[[4]]$piv1 
out1$out.single[[4]]$piv2   
out1$out.single[[4]]$ga1c
out1$out.single[[4]]$ga2c   
out1$out.single[[4]]$Bec            

## End(Not run)

</code></pre>


</div>