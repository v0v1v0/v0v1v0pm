<div class="container">

<table style="width: 100%;"><tr>
<td>mlds</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit Difference Scale by Maximum Likelihood </h2>

<h3>Description</h3>

<p> Generic function  <code>mlds</code> uses different methods to fit the results of a difference scaling experiment either using <code>glm</code> (Generalized Linear Model), by direct maximization of the likelihood using <code>optim</code> or by maximizing the likelihood with respect to a function of the stimulus dimension specified by a one sided formula.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mlds(x, ...)

## S3 method for class 'mlds.df'
mlds(x, stimulus = NULL, method = "glm", 
	lnk = "probit", opt.meth = "BFGS", glm.meth = "glm.fit",
	opt.init = NULL, control = glm.control(maxit = 50000, epsilon = 1e-14), 
	... )
	
## S3 method for class 'mlbs.df'
mlds(x, stimulus = NULL, method = "glm", 
	lnk = "probit",
	control = glm.control(maxit = 50000, epsilon = 1e-14), 
	glm.meth = "glm.fit", 
	... )

## S3 method for class 'data.frame'
mlds(x, ... )

## S3 method for class 'formula'
mlds(x, p, data, stimulus = NULL, 
	lnk = "probit", opt.meth = "BFGS", 
	control = list(maxit = 50000, reltol = 1e-14), ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>For comparisons of two pairs of stimuli, when the <code>method</code> is specified as ‘glm’ or ‘optim’ a data frame with 5 columns giving the response and the ranks of the stimulus levels for each trial, or an object of class ‘mlds.df’ which also contains additional information as attributes. For comparisons of triples of stimuli, only the method ‘glm’ is currently defined.  The object can be a data frame of 4 columns with the first specifying the response and the other 3 the stimulus level ranks, or an object of class ‘mlbs.df’, which contains additional attributes.  It can also be a one-side formula with parameters <code>p</code> and stimulus variable <code>sx</code> that gives a parametric formula to fit to the data for the <code>formula</code> method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> A data frame with 4 or 5 columns giving the response and the ranks of the stimulus levels for each trial, or an object of class ‘mlbs.df’ or ‘mlds.df’, respectively, which also contains additional information as attributes, required when the ‘formula’ method is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>numeric vector of parameters of length one greater than the number of parameters in the <code>formula</code> argument that specifies initial values for the parameters.  The extra parameter, specified last, is the initial estimate of <code>sigma</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stimulus</code></td>
<td>
<p>A numeric vector that contains the physical stimulus levels used in the experiment.  If <code>data</code> is of class ‘mlds.df’, this information is included as an attribute.  If <code>NULL</code>, a sequence of <code class="reqn">1:n</code> is used, where n is the number of stimulus levels, deduced from the highest rank in <code>data</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p> character, taking the value of “glm” or “optim”.  Default is “glm”. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lnk</code></td>
<td>
<p>character indicating either one of the built-in links for the binomial family or a user defined link of class ‘link-glm’.  See <code>family</code> and <code>make.link</code>. Default is “probit”.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt.meth</code></td>
<td>
<p>If <code>method</code> = “optim”, the method used by <code>optim</code> can be specified.  Defaults to “BFGS”.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt.init</code></td>
<td>
<p>Vector of numeric giving initial values which must be provided if you specify the “optim” method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p> A list of control values for either <code>glm</code> or <code>optim</code>.  Since the <code>method</code> defaults to “glm”, the default is a glm list but should be changed if the “optim” method is chosen.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>glm.meth</code></td>
<td>
<p>the method to be used in fitting the model, only when <code>method = glm</code>. The default value is “glm.fit”.  See<code>glm</code> for further details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed along to <code>glm</code> or <code>optim.</code>
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Observers are presented with either triples or pairs of pairs of stimuli, distributed along a physical stimulus axis.  For example, for stimuli <code class="reqn">a, b, c</code> with <code class="reqn">a &lt; b &lt; c</code>, they see the triple <code class="reqn">a, b, c</code>, or for stimuli <code class="reqn">a, b, c, d</code> with <code class="reqn">a &lt; b &lt; c &lt; d</code>, they see the pairs <code class="reqn">(a, b)</code> and <code class="reqn">(c, d)</code>. For each trial, they make a judgement respectivily as to whether the difference between stimuli 1 and 2 is greater or not that between stimuli 2 and 3 or the elements of pair 1 is greater or not than the difference between the elements of pair 2.  From a large number of trials on different quadruples, <code>mlds</code> estimates numbers, <code class="reqn">Psi_1,..., Psi_n</code>, by maximum likelihood such that <code class="reqn">(Psi_d - Psi_c) &gt; (Psi_b - Psi_a)</code> when the observer chooses pair 2, and pair 1, otherwise.
</p>
<p>If there are <code class="reqn">p</code> stimulus levels tested, then <code class="reqn">p - 1</code> coefficients are estimated.  The “glm” method constrains the lowest estimated value, <code class="reqn">Psi_1 = 0</code>, while the “optim” method constrains the lowest and highest values to be 0 and 1, respectively.  The “optim” method estimates an additional scale parameter, <code>sigma</code>, whereas this value is fixed at 1.0 for the “glm” method.  In principle, the scales from the two methods are related by
</p>
<p style="text-align: center;"><code class="reqn">1/\sigma_o = max(Psi_g)</code>
</p>

<p>where <code class="reqn">\sigma_o</code> is <code>sigma</code> estimated with the “optim” method and <code class="reqn">Psi_g</code> corresponds to the perceptual scale values estimated with the “glm” method.  The equality may not be exact as the “optim” method prevents the selection of values outside of the interval [0, 1] whereas the “glm” method does not.
</p>


<h3>Value</h3>

<p>A list of class ‘mlds’ whose components depend on whether the method was specified as ‘glm’, ‘optim’ with the default method, or the formula method was used,
</p>
<table>
<tr style="vertical-align: top;">
<td><code>pscale </code></td>
<td>
<p>A numeric vector of the estimated difference scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stimulus </code></td>
<td>
<p>The physical stimulus levels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma </code></td>
<td>
<p>The scale estimate, always 1.0 for ‘glm’</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method </code></td>
<td>
<p>The fitting method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link </code></td>
<td>
<p>The binomial link specified, default ‘probit’</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obj </code></td>
<td>
<p>For method ‘glm’, an object of class ‘glm’ resulting from the fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLik </code></td>
<td>
<p>for method ‘optim’, the logarithm of likelihood at convergence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hess </code></td>
<td>
<p>for method ‘optim’, the Hessian matrix at convergence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data </code></td>
<td>
<p>For method‘optim’, the data.frame or ‘mlds.df’ entered as an argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conv </code></td>
<td>
<p>For method ‘optim’, a code indicating whether <code>optim</code> converged or not.  See <code>optim</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>For ‘formula’ method, the parameters estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>The one-sided formula specified with the ‘method’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>func</code></td>
<td>
<p>For ‘formula’ method, a function obtained from the one-sided <code>formula</code>.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p> The glm method often generates warnings that fitted probabilities are 0 or 1. This does not usually affect the values of the estimated scale.  However, it may be wise to check the results with the optim method and obtain standard errors from a bootstrap method (see <code>boot.mlds</code>). The warnings will often disappear if the link is modified or more data are obtained. 
</p>


<h3>Author(s)</h3>

<p>Kenneth Knoblauch and Laurence T. Maloney</p>


<h3>References</h3>

<p> Maloney, L. T. and Yang, J. N. (2003). Maximum likelihood difference scaling. <em>Journal of Vision</em>, <b>3(8):5</b>, 573–585, <a href="https://doi.org/10.1167/3.8.5">doi:10.1167/3.8.5</a>. 
</p>
<p>Knoblauch, K. and Maloney, L. T. (2008) MLDS:  Maximum likelihood difference scaling in R. 
<em>Journal of Statistical Software</em>, <b>25:2</b>, 1–26, <a href="https://doi.org/10.18637/jss.v025.i02">doi:10.18637/jss.v025.i02</a>.
</p>


<h3>See Also</h3>

<p><code>glm</code>, <code>optim</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">data(AutumnLab)
#Note the warnings generated by glm method
x.mlds &lt;- mlds(AutumnLab)
summary(x.mlds)
y.mlds &lt;- mlds(AutumnLab, method = "optim", opt.init = c(seq(0, 1, len = 10), 0.16))
summary(y.mlds)
plot(x.mlds)
#How sigma relates the scales obtained by the 2 different methods.
lines(y.mlds$stimulus,  y.mlds$pscale/y.mlds$sigma)

#Example with triads
data(kktriad)
kkt.mlds &lt;- mlds(kktriad)
plot(kkt.mlds, type = "b")

#An example using the formula method
data(kk1)
# with one parameter
kk.frm1 &lt;- mlds(~ sx^p, p = c(3, 0.02), data = kk1)
# with two parameters
kk.frm2 &lt;- mlds(~p[1] * (sx + abs(sx - p[2])) - p[1] * p[2], 
	p = c(0.9, 0.3, 0.2), data = kk1)
</code></pre>


</div>