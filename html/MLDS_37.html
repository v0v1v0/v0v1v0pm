<div class="container">

<table style="width: 100%;"><tr>
<td>binom.diagnostics</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Diagnostics for Binary GLM</h2>

<h3>Description</h3>

<p>Two techniques for evaluating the adequacy of the binary glm model used in <code>mlds</code>, based on code in Wood (2006).
</p>


<h3>Usage</h3>

<pre><code class="language-R">binom.diagnostics(obj, nsim = 200, type = "deviance", no.warn = TRUE)

## S3 method for class 'mlds.diag'
plot(x, alpha = 0.025, breaks = "Sturges", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>list of class ‘mlds’ typically generated by a call to the <code>mlds</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p> integer giving the number of sets of data to simulate </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>character indicating type of residuals.  Default is deviance residuals.  See <code>residuals.glm</code> for other choices </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no.warn</code></td>
<td>
<p>logical indicating when TRUE (default) to suppress warnings from <code>glm</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>list of class ‘mlds.diag’ typically generated by a call to <code>binom.diagnostics</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>numeric between 0 and 1, the envelope limits for the cdf of the deviance residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>
<p>character or numeric indicating either the method for calculating the number of breaks or the suggested number of breaks to employ.  See <code>hist</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters specifications for the empirical cdf plot</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Wood (2006) describes two diagnostics of the adequacy of a binary glm model based on analyses of residuals (see, p. 115, Exercise 2 and his solution on pp 346-347).  The first one compares the empirical cdf of the deviance residuals to a bootstrapped confidence envelope of the curve.  The second examines the number of runs in the sorted residuals with those expected on the basis of independence in the residuals, again using a resampling based on the models fitted values. The plot method generates two graphs, the first being the empirical cdf and the envelope.  The second is a histogram of the number of runs from the bootstrap procedure with the observed number indicated by a vertical line.  Currently, this only works if the ‘glm’ method is used to perform the fit and <em>not</em> the ‘optim’ method
</p>


<h3>Value</h3>

<p><code>binom.diagnostics</code> returns a list of class ‘mlds.diag’ with components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>NumRuns </code></td>
<td>
<p>integer vector giving the number of runs obtained for each simulation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resid </code></td>
<td>
<p>numeric matrix giving the sorted deviance residuals in each column from each simulation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Obs.resid </code></td>
<td>
<p>numeric vector of the sorted observed deviance residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ObsRuns </code></td>
<td>
<p>integer giving the observed number of runs in the sorted deviance residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p </code></td>
<td>
<p>numeric giving the proportion of runs in the simulation less than the observed value.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Ken Knoblauch </p>


<h3>References</h3>

<p>Wood, SN <em>Generalized Additive Models: An Introduction with R</em>, Chapman &amp; Hall/CRC, 2006 
</p>
<p>Knoblauch, K. and Maloney, L. T. (2008) MLDS:  Maximum likelihood difference scaling in R. 
<em>Journal of Statistical Software</em>, <b>25:2</b>, 1–26, <a href="https://doi.org/10.18637/jss.v025.i02">doi:10.18637/jss.v025.i02</a>.
</p>


<h3>See Also</h3>

<p><code>mlds</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(kk1)
kk1.mlds &lt;- mlds(kk1)
kk1.diag &lt;- binom.diagnostics(kk1.mlds)
plot(kk1.diag)

## End(Not run)
</code></pre>


</div>