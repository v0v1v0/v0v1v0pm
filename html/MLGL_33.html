<div class="container">

<table style="width: 100%;"><tr>
<td>stability.MLGL</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Stability Selection for Multi-Layer Group-lasso</h2>

<h3>Description</h3>

<p>Stability selection for <code>MLGL</code>
</p>


<h3>Usage</h3>

<pre><code class="language-R">stability.MLGL(
  X,
  y,
  B = 50,
  fraction = 0.5,
  hc = NULL,
  lambda = NULL,
  weightLevel = NULL,
  weightSizeGroup = NULL,
  loss = c("ls", "logit"),
  intercept = TRUE,
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>matrix of size n*p</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>vector of size n. If loss = "logit", elements of y must be in -1,1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>number of bootstrap sample</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fraction</code></td>
<td>
<p>Fraction of data used at each of the <code>B</code> sub-samples</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hc</code></td>
<td>
<p>output of <code>hclust</code> function. If not provided, <code>hclust</code> is run with ward.D2 method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>lambda values for group lasso. If not provided, the function generates its own values of lambda</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weightLevel</code></td>
<td>
<p>a vector of size p for each level of the hierarchy. A zero indicates that the level will be ignored. 
If not provided, use 1/(height between 2 successive levels)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weightSizeGroup</code></td>
<td>
<p>a vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loss</code></td>
<td>
<p>a character string specifying the loss function to use, valid options are: "ls" least squares loss 
(regression) and "logit" logistic loss (classification)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>should an intercept be included in the model ?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>print some informations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Others parameters for <code>gglasso</code> function</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Hierarchical clustering is performed with all the variables. Then, the partitions from the different
levels of the hierarchy are used in the different runs of MLGL for estimating the probability of selection of each group.
</p>


<h3>Value</h3>

<p>a stability.MLGL object containing:
</p>

<dl>
<dt>lambda</dt>
<dd>
<p>sequence of <code>lambda</code>.</p>
</dd>
<dt>B</dt>
<dd>
<p>Number of bootstrap samples.</p>
</dd>
<dt>stability</dt>
<dd>
<p>A matrix of size length(lambda)*number of groups containing the probability of selection of each group</p>
</dd>
<dt>var</dt>
<dd>
<p>vector containing the index of covariates</p>
</dd>
<dt>group</dt>
<dd>
<p>vector containing the index of associated groups of covariates</p>
</dd>
<dt>time</dt>
<dd>
<p>computation time</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Quentin Grimonprez
</p>


<h3>References</h3>

<p>Meinshausen and Buhlmann (2010). Stability selection. 
Journal of the Royal Statistical Society: Series B (Statistical Methodology) 72.4, p. 417-473.
</p>


<h3>See Also</h3>

<p>cv.MLGL, MLGL
</p>


<h3>Examples</h3>

<pre><code class="language-R">
set.seed(42)
# Simulate gaussian data with block-diagonal variance matrix containing 12 blocks of size 5
X &lt;- simuBlockGaussian(50, 12, 5, 0.7)

# Generate a response variable
y &lt;- X[, c(2, 7, 12)] %*% c(2, 2, -2) + rnorm(50, 0, 0.5)

# Apply stability.MLGL method
res &lt;- stability.MLGL(X, y)


</code></pre>


</div>