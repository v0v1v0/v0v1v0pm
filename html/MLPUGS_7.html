<div class="container">

<table style="width: 100%;"><tr>
<td>predict.ECC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Classify new samples using an Ensemble of Classifier Chains</h2>

<h3>Description</h3>

<p>Uses a trained ECC and Gibbs sampling to predict labels for new
samples. <code>.f</code> must return a matrix of probabilities, one row for each
observation in <code>newdata</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'ECC'
predict(object, newdata, n.iters = 300, burn.in = 100,
  thin = 2, run_parallel = FALSE, silent = TRUE, .f = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of type <code>ECC</code> returned by <code>ecc()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>A data frame or matrix of features. Must be the same form as
the one used with <code>ecc()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.iters</code></td>
<td>
<p>Number of iterations of the Gibbs sampler.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn.in</code></td>
<td>
<p>Number of iterations for adaptation (burn-in).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>Thinning interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>run_parallel</code></td>
<td>
<p>Logical flag for utilizing multicore capabilities of the
system.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>Logical flag indicating whether to have a progress bar (if
the 'progress' package is installed) or print progress messages to console.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.f</code></td>
<td>
<p>User-supplied prediction function that corresponds to the type of
classifier that was trained in the <code>ecc()</code> step. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to pass to <code>.f</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Getting the prediction function correct is very important here.
Since this package is a wrapper that can use any classification algorithm
as its base classifier, certain assumptions have been made. We assume that
the prediction function can return a data.frame or matrix of probabilities
with two columns: "0" and "1" because <code>ecc()</code> trains on a
factor of "0"s and "1"s for more universal consistency.
</p>


<h3>Value</h3>

<p>An object of class <code>PUGS</code> containing: </p>

<ul>
<li> <p><code>y_labels</code> : inherited from <code>object</code>
</p>
</li>
<li> <p><code>preds</code> : A burnt-in, thinned multi-dimensional array of predictions.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">x &lt;- movies_train[, -(1:3)]
y &lt;- movies_train[, 1:3]

model_glm &lt;- ecc(x, y, m = 1, .f = glm.fit, family = binomial(link = "logit"))

predictions_glm &lt;- predict(model_glm, movies_test[, -(1:3)],
.f = function(glm_fit, newdata) {

  # Credit for writing the prediction function that works
  # with objects created through glm.fit goes to Thomas Lumley
  
  eta &lt;- as.matrix(newdata) %*% glm_fit$coef
  output &lt;- glm_fit$family$linkinv(eta)
  colnames(output) &lt;- "1"
  return(output)
  
}, n.iters = 10, burn.in = 0, thin = 1)

## Not run: 

model_c50 &lt;- ecc(x, y, .f = C50::C5.0)
predictions_c50 &lt;- predict(model_c50, movies_test[, -(1:3)],
                           n.iters = 10, burn.in = 0, thin = 1,
                           .f = C50::predict.C5.0, type = "prob")
  
model_rf &lt;- ecc(x, y, .f = randomForest::randomForest)
predictions_rf &lt;- predict(model_rf, movies_test[, -(1:3)],
                          n.iters = 1000, burn.in = 100, thin = 10,
                          .f = function(rF, newdata) {
                            randomForest:::predict.randomForest(rF, newdata, type = "prob")
                          })

## End(Not run)
</code></pre>


</div>