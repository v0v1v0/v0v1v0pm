<div class="container">

<table style="width: 100%;"><tr>
<td>mlvsbm_estimate_network</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Infer a multilevel network (MLVSBM object), the original object is modified</h2>

<h3>Description</h3>

<p>The inference use a greedy algorithm to navigate between model
size. For a given model size, the inference is done via a variational EM
algorithm. The returned model is the one with the highest ICL criterion among
all visited models.
</p>
<p>By default the algorithm fits a single level SBM for each level, before
inferring the multilevel network. This step can be skipped by specifying an
initial clustering with the <code>init_clustering</code>. Also, a given model size
can be force by setting the parameters <code>nb_clusters</code> to a given value.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mlvsbm_estimate_network(
  mlv,
  nb_clusters = NULL,
  init_clustering = NULL,
  nb_cores = NULL,
  init_method = "hierarchical"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mlv</code></td>
<td>
<p>A MLVSBM object, the network to be inferred.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb_clusters</code></td>
<td>
<p>A list of 2 integers, the model size.
If left to <code>NULL</code>, the algorithm
will navigate freely. Otherwise it will navigate between the specified model
size and its neighbors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init_clustering</code></td>
<td>
<p>A list of 2 vectors of integers of the same length as
the number of node of each level. If specified, the algorithm will start from
this clustering, then navigate freely.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb_cores</code></td>
<td>
<p>An integer, the number of cores to use. Default to <code>1</code>
for Windows and <code>detectCores()/2</code> for Linux and MacOS</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init_method</code></td>
<td>
<p>One of "hierarchical" (the default) or "spectral",
"spectral" might be more efficient but can lead to some numeric errors.
Not used when int_clustering is given.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A FitMLVSBM object, the best inference of the network
</p>


<h3>Examples</h3>

<pre><code class="language-R">my_mlvsbm &lt;- MLVSBM::mlvsbm_simulate_network(
  n = list(I = 10, O = 20), # Number of nodes for the lower level and the upper level
  Q = list(I = 2, O = 2), # Number of blocks for the lower level and the upper level
  pi = c(.3, .7), # Block proportion for the upper level, must sum to one
  gamma = matrix(c(.9, .2,   # Block proportion for the lower level,
                   .1, .8), # each column must sum to one
                 nrow = 2, ncol = 2, byrow = TRUE),
  alpha = list(I = matrix(c(.8, .2,
                            .2, .1),
                          nrow = 2, ncol = 2, byrow = TRUE), # Connection matrix
               O = matrix(c(.99, .3,
                            .3, .1),
                          nrow = 2, ncol = 2, byrow = TRUE)),# between blocks
  directed = list(I = FALSE, O = FALSE), # Are the upper and lower level directed or not ?
  affiliation = "preferential") # How the affiliation matrix is generated
fit &lt;- MLVSBM::mlvsbm_estimate_network(mlv = my_mlvsbm, nb_cores = 1)
</code></pre>


</div>