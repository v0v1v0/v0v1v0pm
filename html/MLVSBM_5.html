<div class="container">

<table style="width: 100%;"><tr>
<td>FitMLVSBM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>An R6 Class object, a fitted multilevel network once $dovem() is done</h2>

<h3>Description</h3>

<p>An R6 Class object, a fitted multilevel network once $dovem() is done
</p>
<p>An R6 Class object, a fitted multilevel network once $dovem() is done
</p>


<h3>Public fields</h3>

<div class="r6-fields">

<dl>
<dt><code>vbound</code></dt>
<dd>
<p>The vector of variational bound for monitoring convergence</p>
</dd>
</dl>
</div>


<h3>Active bindings</h3>

<div class="r6-active-bindings">

<dl>
<dt><code>affiliation_matrix</code></dt>
<dd>
<p>Get the affiliation matrix</p>
</dd>
<dt><code>adjacency_matrix</code></dt>
<dd>
<p>Get the list of adjacency matrices</p>
</dd>
<dt><code>nb_nodes</code></dt>
<dd>
<p>Get the list of the number of nodes</p>
</dd>
<dt><code>nb_clusters</code></dt>
<dd>
<p>Get the list of the number of blocks</p>
</dd>
<dt><code>parameters</code></dt>
<dd>
<p>Get the list of the model parameters</p>
</dd>
<dt><code>membership</code></dt>
<dd>
<p>Get the list of the variational parameters</p>
</dd>
<dt><code>independent</code></dt>
<dd>
<p>Are the levels independent?</p>
</dd>
<dt><code>distribution</code></dt>
<dd>
<p>Emission distribution of each level</p>
</dd>
<dt><code>directed</code></dt>
<dd>
<p>Are the levels directed?</p>
</dd>
<dt><code>entropy</code></dt>
<dd>
<p>Get the entropy of the model</p>
</dd>
<dt><code>bound</code></dt>
<dd>
<p>Get the variational bound of the model</p>
</dd>
<dt><code>df_mixture</code></dt>
<dd>
<p>Get the degrees of freedom of the
mixture parameters</p>
</dd>
<dt><code>df_connect</code></dt>
<dd>
<p>Get the degrees of freedom of the
connection parameters</p>
</dd>
<dt><code>connect</code></dt>
<dd>
<p>Get the number of possible observed connections</p>
</dd>
<dt><code>ICL</code></dt>
<dd>
<p>Get the ICL model selection criterion of the model</p>
</dd>
<dt><code>full_penalty</code></dt>
<dd>
<p>Get the penalty used to compute the ICL</p>
</dd>
<dt><code>Z</code></dt>
<dd>
<p>Get the list of block memberships (vector form)</p>
</dd>
<dt><code>X_hat</code></dt>
<dd>
<p>Get the list of the matrices of probability connection
predictions</p>
</dd>
<dt><code>map</code></dt>
<dd>
<p>Get the list of block memberships (matrix form)</p>
</dd>
<dt><code>penalty</code></dt>
<dd>
<p>Get the ICL penalty</p>
</dd>
<dt><code>likelihood</code></dt>
<dd>
<p>Compute the likelihood of both levels</p>
</dd>
<dt><code>complete_likelihood</code></dt>
<dd>
<p>Get the complete likelihood of the model</p>
</dd>
</dl>
</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-new"><code>FitMLVSBM$new()</code></a>
</p>
</li>
<li> <p><a href="#method-update_alpha"><code>FitMLVSBM$update_alpha()</code></a>
</p>
</li>
<li> <p><a href="#method-update_pi"><code>FitMLVSBM$update_pi()</code></a>
</p>
</li>
<li> <p><a href="#method-update_gamma"><code>FitMLVSBM$update_gamma()</code></a>
</p>
</li>
<li> <p><a href="#method-init_clustering"><code>FitMLVSBM$init_clustering()</code></a>
</p>
</li>
<li> <p><a href="#method-clear"><code>FitMLVSBM$clear()</code></a>
</p>
</li>
<li> <p><a href="#method-m_step"><code>FitMLVSBM$m_step()</code></a>
</p>
</li>
<li> <p><a href="#method-ve_step"><code>FitMLVSBM$ve_step()</code></a>
</p>
</li>
<li> <p><a href="#method-do_vem"><code>FitMLVSBM$do_vem()</code></a>
</p>
</li>
<li> <p><a href="#method-permute_empty_class"><code>FitMLVSBM$permute_empty_class()</code></a>
</p>
</li>
<li> <p><a href="#method-plot"><code>FitMLVSBM$plot()</code></a>
</p>
</li>
<li> <p><a href="#method-show"><code>FitMLVSBM$show()</code></a>
</p>
</li>
<li> <p><a href="#method-print"><code>FitMLVSBM$print()</code></a>
</p>
</li>
<li> <p><a href="#method-clone"><code>FitMLVSBM$clone()</code></a>
</p>
</li>
</ul>
<hr>
<a id="method-new"></a>



<h4>Method <code>new()</code>
</h4>

<p>Constructor for the FitMLVSBM class
</p>


<h5>Usage</h5>

<div class="r"><pre>FitMLVSBM$new(
  Q = list(I = 1, O = 1),
  A = NA,
  X = NA,
  M = list(I = NA, O = NA),
  directed = NA,
  distribution = list("bernoulli", "bernoulli"),
  independent = FALSE
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>Q</code></dt>
<dd>
<p>List of number of blocks</p>
</dd>
<dt><code>A</code></dt>
<dd>
<p>Affiliation matrix</p>
</dd>
<dt><code>X</code></dt>
<dd>
<p>List of adjacency matrices</p>
</dd>
<dt><code>M</code></dt>
<dd>
<p>List of Mask matrices</p>
</dd>
<dt><code>directed</code></dt>
<dd>
<p>List of boolean</p>
</dd>
<dt><code>distribution</code></dt>
<dd>
<p>List of string</p>
</dd>
<dt><code>independent</code></dt>
<dd>
<p>Boolean</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A FitMLVSBM object
</p>


<hr>
<a id="method-update_alpha"></a>



<h4>Method <code>update_alpha()</code>
</h4>

<p>Update the connection parameters for the M step
</p>


<h5>Usage</h5>

<div class="r"><pre>FitMLVSBM$update_alpha(safeguard = 2 * .Machine$double.eps)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>safeguard</code></dt>
<dd>
<p>Parameter live in a compact [safeguard, 1-safeguard]</p>
</dd>
</dl>
</div>


<hr>
<a id="method-update_pi"></a>



<h4>Method <code>update_pi()</code>
</h4>

<p>Update the upper level mixture parameter for the M step
</p>


<h5>Usage</h5>

<div class="r"><pre>FitMLVSBM$update_pi(safeguard = 0.001)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>safeguard</code></dt>
<dd>
<p>Parameter live in a compact [safeguard, 1-safeguard]</p>
</dd>
</dl>
</div>


<hr>
<a id="method-update_gamma"></a>



<h4>Method <code>update_gamma()</code>
</h4>

<p>Update the lower level mixture parameter for the M step
</p>


<h5>Usage</h5>

<div class="r"><pre>FitMLVSBM$update_gamma(safeguard = 1e-06)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>safeguard</code></dt>
<dd>
<p>Parameter live in a compact [safeguard, 1-safeguard]</p>
</dd>
</dl>
</div>


<hr>
<a id="method-init_clustering"></a>



<h4>Method <code>init_clustering()</code>
</h4>

<p>init_clustering Initial clustering for VEM algorithm
</p>


<h5>Usage</h5>

<div class="r"><pre>FitMLVSBM$init_clustering(
  safeguard = 2 * .Machine$double.eps,
  method = "hierarchical",
  Z = NULL
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>safeguard</code></dt>
<dd>
<p>Parameter live in a compact [safeguard, 1-safeguard]</p>
</dd>
<dt><code>method</code></dt>
<dd>
<p>Algorithm used to initiate the clustering, either
"spectral", "hierarchical" or "merge_split" (if <code>Z</code> is provided)</p>
</dd>
<dt><code>Z</code></dt>
<dd>
<p>Initial clustering if provided</p>
</dd>
</dl>
</div>


<hr>
<a id="method-clear"></a>



<h4>Method <code>clear()</code>
</h4>

<p>Reset all parameters
</p>


<h5>Usage</h5>

<div class="r"><pre>FitMLVSBM$clear()</pre></div>


<hr>
<a id="method-m_step"></a>



<h4>Method <code>m_step()</code>
</h4>

<p>m_step Compute the M step of the VEM algorithm
</p>


<h5>Usage</h5>

<div class="r"><pre>FitMLVSBM$m_step(safeguard = 1e-06)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>safeguard</code></dt>
<dd>
<p>Parameter live in a compact [safeguard, 1-safeguard]</p>
</dd>
</dl>
</div>


<hr>
<a id="method-ve_step"></a>



<h4>Method <code>ve_step()</code>
</h4>

<p>Compute the VE step of the VEM algorithm
</p>


<h5>Usage</h5>

<div class="r"><pre>FitMLVSBM$ve_step(threshold = 1e-06, fixPointIter = 10, safeguard = 1e-06)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>threshold</code></dt>
<dd>
<p>The convergence threshold</p>
</dd>
<dt><code>fixPointIter</code></dt>
<dd>
<p>The maximum number of fixed point iterations</p>
</dd>
<dt><code>safeguard</code></dt>
<dd>
<p>Parameter live in a compact [safeguard, 1-safeguard]</p>
</dd>
</dl>
</div>


<hr>
<a id="method-do_vem"></a>



<h4>Method <code>do_vem()</code>
</h4>

<p>Launch a Variational EM algorithm
</p>


<h5>Usage</h5>

<div class="r"><pre>FitMLVSBM$do_vem(
  init = "hierarchical",
  threshold = 1e-06,
  maxIter = 1000,
  fixPointIter = 100,
  safeguard = 1e-06,
  Z = NULL
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>init</code></dt>
<dd>
<p>The method for <code>self$init_clustering</code></p>
</dd>
<dt><code>threshold</code></dt>
<dd>
<p>The convergence threshold</p>
</dd>
<dt><code>maxIter</code></dt>
<dd>
<p>The max number of VEM iterations</p>
</dd>
<dt><code>fixPointIter</code></dt>
<dd>
<p>The max number of fixed point iterations for VE step</p>
</dd>
<dt><code>safeguard</code></dt>
<dd>
<p>Parameter live in a compact [safeguard, 1-safeguard]</p>
</dd>
<dt><code>Z</code></dt>
<dd>
<p>Initial clustering if provided</p>
</dd>
</dl>
</div>


<hr>
<a id="method-permute_empty_class"></a>



<h4>Method <code>permute_empty_class()</code>
</h4>

<p>permute_empty_class Put empty blocks numbers at the end
</p>


<h5>Usage</h5>

<div class="r"><pre>FitMLVSBM$permute_empty_class()</pre></div>


<hr>
<a id="method-plot"></a>



<h4>Method <code>plot()</code>
</h4>

<p>Plot of FitMLVSBM objects
</p>


<h5>Usage</h5>

<div class="r"><pre>FitMLVSBM$plot(type = c("matrix"), ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>type</code></dt>
<dd>
<p>A string for the type of plot, just "matrix" for now</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>a ggplot2 object
</p>


<hr>
<a id="method-show"></a>



<h4>Method <code>show()</code>
</h4>

<p>print method
</p>


<h5>Usage</h5>

<div class="r"><pre>FitMLVSBM$show(type = "Multilevel Stochastic Block Model")</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>type</code></dt>
<dd>
<p>character to tune the displayed name</p>
</dd>
</dl>
</div>


<hr>
<a id="method-print"></a>



<h4>Method <code>print()</code>
</h4>

<p>print method
</p>


<h5>Usage</h5>

<div class="r"><pre>FitMLVSBM$print()</pre></div>


<hr>
<a id="method-clone"></a>



<h4>Method <code>clone()</code>
</h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>FitMLVSBM$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt>
<dd>
<p>Whether to make a deep clone.</p>
</dd>
</dl>
</div>




</div>