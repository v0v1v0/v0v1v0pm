<div class="container">

<table style="width: 100%;"><tr>
<td>FitSBM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>An R6 Class object for unilevel network</h2>

<h3>Description</h3>

<p>a fitted level of a unilevel network once
$do_vem() is done
</p>


<h3>Public fields</h3>

<div class="r6-fields">

<dl>
<dt><code>vbound</code></dt>
<dd>
<p>vector of variational bound for convergence monitoring</p>
</dd>
</dl>
</div>


<h3>Active bindings</h3>

<div class="r6-active-bindings">

<dl>
<dt><code>adjacency</code></dt>
<dd>
<p>Get the adjacency matrix</p>
</dd>
<dt><code>mask</code></dt>
<dd>
<p>Get the mask matrix for dealing with NA</p>
</dd>
<dt><code>nb_nodes</code></dt>
<dd>
<p>Get the number of nodes of the level</p>
</dd>
<dt><code>nb_clusters</code></dt>
<dd>
<p>Get the number of blocks</p>
</dd>
<dt><code>distribution</code></dt>
<dd>
<p>Get the distribution used for the connections</p>
</dd>
<dt><code>directed</code></dt>
<dd>
<p>Get if the level is directed or not</p>
</dd>
<dt><code>mixture_parameter</code></dt>
<dd>
<p>Access the block proportions</p>
</dd>
<dt><code>connectivity_parameter</code></dt>
<dd>
<p>Access the connectivity matrix</p>
</dd>
<dt><code>membership</code></dt>
<dd>
<p>Access the variational parameters</p>
</dd>
<dt><code>entropy</code></dt>
<dd>
<p>Get the entropy of the model</p>
</dd>
<dt><code>bound</code></dt>
<dd>
<p>Get the variational bound of the model</p>
</dd>
<dt><code>df_mixture</code></dt>
<dd>
<p>Get the degree of freedom of the block proportion</p>
</dd>
<dt><code>df_connect</code></dt>
<dd>
<p>Get the degree of freedom of the connection parameters</p>
</dd>
<dt><code>connect</code></dt>
<dd>
<p>Get the number of observed dyads</p>
</dd>
<dt><code>ICL</code></dt>
<dd>
<p>Get the ICL model selection criterion</p>
</dd>
<dt><code>penalty</code></dt>
<dd>
<p>Get the penalty used for computing the ICL</p>
</dd>
<dt><code>Z</code></dt>
<dd>
<p>Access the vector of block membership (clustering)</p>
</dd>
<dt><code>X_hat</code></dt>
<dd>
<p>Get the connection probability matrix</p>
</dd>
<dt><code>X_likelihood</code></dt>
<dd>
<p>adjacency part of the log likelihood</p>
</dd>
<dt><code>Z_likelihood</code></dt>
<dd>
<p>block part of the log likelihood</p>
</dd>
<dt><code>likelihood</code></dt>
<dd>
<p>complete log likelihood</p>
</dd>
</dl>
</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-new"><code>FitSBM$new()</code></a>
</p>
</li>
<li> <p><a href="#method-update_alpha"><code>FitSBM$update_alpha()</code></a>
</p>
</li>
<li> <p><a href="#method-update_pi"><code>FitSBM$update_pi()</code></a>
</p>
</li>
<li> <p><a href="#method-init_clustering"><code>FitSBM$init_clustering()</code></a>
</p>
</li>
<li> <p><a href="#method-m_step"><code>FitSBM$m_step()</code></a>
</p>
</li>
<li> <p><a href="#method-ve_step"><code>FitSBM$ve_step()</code></a>
</p>
</li>
<li> <p><a href="#method-do_vem"><code>FitSBM$do_vem()</code></a>
</p>
</li>
<li> <p><a href="#method-permute_empty_class"><code>FitSBM$permute_empty_class()</code></a>
</p>
</li>
<li> <p><a href="#method-clear"><code>FitSBM$clear()</code></a>
</p>
</li>
<li> <p><a href="#method-clone"><code>FitSBM$clone()</code></a>
</p>
</li>
</ul>
<hr>
<a id="method-new"></a>



<h4>Method <code>new()</code>
</h4>

<p>Constructor for FitSBM  R6 class
</p>


<h5>Usage</h5>

<div class="r"><pre>FitSBM$new(
  Q = 1,
  X = NULL,
  M = NULL,
  directed = FALSE,
  distribution = "bernoulli"
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>Q</code></dt>
<dd>
<p>Number of blocks</p>
</dd>
<dt><code>X</code></dt>
<dd>
<p>Adjacency matrix</p>
</dd>
<dt><code>M</code></dt>
<dd>
<p>Mask matrix</p>
</dd>
<dt><code>directed</code></dt>
<dd>
<p>boolean</p>
</dd>
<dt><code>distribution</code></dt>
<dd>
<p>string (only "bernoulli")</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A new FitSBM object
</p>


<hr>
<a id="method-update_alpha"></a>



<h4>Method <code>update_alpha()</code>
</h4>

<p>Update the connection parameter for the M step
</p>


<h5>Usage</h5>

<div class="r"><pre>FitSBM$update_alpha(safeguard = 1e-06)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>safeguard</code></dt>
<dd>
<p>Parameter live in a compact [safeguard, 1-safeguard]</p>
</dd>
</dl>
</div>


<hr>
<a id="method-update_pi"></a>



<h4>Method <code>update_pi()</code>
</h4>

<p>Update the upper level mixture parameter for the M step
</p>


<h5>Usage</h5>

<div class="r"><pre>FitSBM$update_pi(safeguard = 1e-06)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>safeguard</code></dt>
<dd>
<p>Parameter live in a compact [safeguard, 1-safeguard]</p>
</dd>
</dl>
</div>


<hr>
<a id="method-init_clustering"></a>



<h4>Method <code>init_clustering()</code>
</h4>

<p>init_clustering Initial clustering for VEM algorithm
</p>


<h5>Usage</h5>

<div class="r"><pre>FitSBM$init_clustering(safeguard = 1e-06, method = "hierarchical", Z = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>safeguard</code></dt>
<dd>
<p>Parameter live in a compact [safeguard, 1-safeguard]</p>
</dd>
<dt><code>method</code></dt>
<dd>
<p>Algorithm used to initiate the clustering, either
"spectral", "hierarchical" or "merge_split" (if <code>Z</code> is provided)</p>
</dd>
<dt><code>Z</code></dt>
<dd>
<p>Initial clustering if provided</p>
</dd>
</dl>
</div>


<hr>
<a id="method-m_step"></a>



<h4>Method <code>m_step()</code>
</h4>

<p>m_step Compute the M step of the VEM algorithm
</p>


<h5>Usage</h5>

<div class="r"><pre>FitSBM$m_step(safeguard = 1e-06)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>safeguard</code></dt>
<dd>
<p>Parameter live in a compact [safeguard, 1-safeguard]</p>
</dd>
</dl>
</div>


<hr>
<a id="method-ve_step"></a>



<h4>Method <code>ve_step()</code>
</h4>

<p>Compute the VE step of the VEM algorithm
</p>


<h5>Usage</h5>

<div class="r"><pre>FitSBM$ve_step(threshold = 1e-06, fixPointIter = 100, safeguard = 1e-06)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>threshold</code></dt>
<dd>
<p>The convergence threshold</p>
</dd>
<dt><code>fixPointIter</code></dt>
<dd>
<p>The maximum number of fixed point iterations</p>
</dd>
<dt><code>safeguard</code></dt>
<dd>
<p>Parameter live in a compact [safeguard, 1-safeguard]</p>
</dd>
</dl>
</div>


<hr>
<a id="method-do_vem"></a>



<h4>Method <code>do_vem()</code>
</h4>

<p>Launch a Variational EM algorithm
</p>


<h5>Usage</h5>

<div class="r"><pre>FitSBM$do_vem(
  init = "hierarchical",
  threshold = 1e-06,
  maxIter = 1000,
  fixPointIter = 100,
  safeguard = 1e-06,
  Z = NULL
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>init</code></dt>
<dd>
<p>The method for <code>self$init_clustering</code></p>
</dd>
<dt><code>threshold</code></dt>
<dd>
<p>The convergence threshold</p>
</dd>
<dt><code>maxIter</code></dt>
<dd>
<p>The max number of VEM iterations</p>
</dd>
<dt><code>fixPointIter</code></dt>
<dd>
<p>The max number of fixed point iterations for VE step</p>
</dd>
<dt><code>safeguard</code></dt>
<dd>
<p>Parameter live in a compact [safeguard, 1-safeguard]</p>
</dd>
<dt><code>Z</code></dt>
<dd>
<p>Initial clustering if provided</p>
</dd>
</dl>
</div>


<hr>
<a id="method-permute_empty_class"></a>



<h4>Method <code>permute_empty_class()</code>
</h4>

<p>permute_empty_class Put empty blocks numbers at the end
</p>


<h5>Usage</h5>

<div class="r"><pre>FitSBM$permute_empty_class()</pre></div>


<hr>
<a id="method-clear"></a>



<h4>Method <code>clear()</code>
</h4>

<p>Reset all parameters
</p>


<h5>Usage</h5>

<div class="r"><pre>FitSBM$clear()</pre></div>


<hr>
<a id="method-clone"></a>



<h4>Method <code>clone()</code>
</h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>FitSBM$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt>
<dd>
<p>Whether to make a deep clone.</p>
</dd>
</dl>
</div>




</div>