<div class="container">

<table style="width: 100%;"><tr>
<td>MLmulti</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multispecies mean length mortality estimator</h2>

<h3>Description</h3>

<p>Estimator of instantaneous total mortality (Z) from a time series of mean length data for a suite of
stocks that are fished together.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MLmulti(MLZ.list, ncp, model = c("SSM", "MSM1", "MSM2", "MSM3"),
  start = NULL, grid.search = TRUE, parallel = ifelse(ncp &gt; 2, TRUE,
  FALSE), min.time = 3, Z.max = 5, figure = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>MLZ.list</code></td>
<td>
<p>A list containing objects of class <code>MLZ_data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncp</code></td>
<td>
<p>The number of change points in total mortality in the time series. <code>ncp + 1</code> total
mortality rates will be estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>The multispecies model to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>An optional list of starting values. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid.search</code></td>
<td>
<p>If <code>TRUE</code>, a grid search will be performed using the <code>profile_MLmulti</code>
function to find the best starting values for the change points (the years when mortality changes).
Ignored if <code>start</code> is provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>Whether grid search is performed in parallel. Ignored if <code>grid.search = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.time</code></td>
<td>
<p>The minimum number of years between each change point for the grid search, passed
to <code>profile_MLmulti</code>. Not used if <code>grid.search = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z.max</code></td>
<td>
<p>The upper boundary for Z estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>figure</code></td>
<td>
<p>If <code>TRUE</code>, a call to <code>plot</code> of observed and predicted mean lengths will be produced.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For a model with <code>I</code> change points and <code>N</code> species, the starting values in
<code>start</code> is a list with the following entries:
</p>
<p>Single Species Model (SSM, independent trends in mortality among species):
</p>

<table>
<tr>
<td style="text-align: left;">
<code>Z</code> </td>
<td style="text-align: left;"> a matrix with <code>nrow = I+1</code> and <code>ncol = N</code>.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>yearZ</code> </td>
<td style="text-align: left;"> a matrix with <code>nrow = I</code> and <code>ncol = N</code>.</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>Multispecies Model 1 (MSM1, common mortality change points but changes in Z are independent):
</p>

<table>
<tr>
<td style="text-align: left;">
<code>Z</code> </td>
<td style="text-align: left;"> a matrix with <code>nrow = I+1</code> and <code>ncol = N</code>.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>yearZ</code> </td>
<td style="text-align: left;"> a vector with <code>length = I</code>.</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>Multispecies Model 2 (MSM2, common mortality change points. Changes in F vary by estimated relative catchabilities among species):
</p>

<table>
<tr>
<td style="text-align: left;">
<code>Z1</code> </td>
<td style="text-align: left;"> a vector with <code>length = N</code>.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>yearZ</code> </td>
<td style="text-align: left;"> a vector with <code>length = I</code>.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>delta</code> </td>
<td style="text-align: left;"> a vector with <code>length = I</code>.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>epsilon</code> </td>
<td style="text-align: left;"> a vector with <code>length = N-1</code>.</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>Multispecies Model 3 (MSM3, common mortality change points and common proportional changes in F):
</p>

<table>
<tr>
<td style="text-align: left;">
<code>Z1</code> </td>
<td style="text-align: left;"> a vector with <code>length = N</code>.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>yearZ</code> </td>
<td style="text-align: left;"> a vector with <code>length = I</code>.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>delta</code> </td>
<td style="text-align: left;"> a vector with <code>length = I</code>.</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>If <code>ncp = 0</code> change points is specified, then the method simplifies to the Single Species Model.
The <code>start</code> list should contain a single entry:
</p>

<table>
<tr>
<td style="text-align: left;">
<code>Z</code> </td>
<td style="text-align: left;"> a vector with <code>length = N</code>.</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p><code>start</code> can be <code>NULL</code>, in which case, the supplied starting values depend on
the value of <code>grid.search</code>. If <code>grid.search = TRUE</code>, starting values will use the
values for <code>yearZ</code> which minimize the negative log-likelihood from the grid search.
Otherwise, the starting values for <code>yearZ</code> evenly divide the time series.
</p>


<h3>Value</h3>

<p>An object of class <code>MLZ_model</code>.
</p>


<h3>References</h3>

<p>Huynh, Q.C, Gedamke, T., Hoenig, J.M, and Porch C. 2017. Multispecies Extensions
to a Nonequilibrium Length-Based Mortality Estimator. Marine and Coastal Fisheries 9:68-78.
</p>


<h3>See Also</h3>

<p><code>profile_MLmulti</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(PRSnapper)
res_eq &lt;- MLmulti(PRSnapper, ncp = 0, start = list(Z = matrix(0.5, nrow = 1, ncol = 3)))
res_SSM &lt;- MLmulti(PRSnapper, ncp = 1, model = "SSM")

MSM1.start.Z &lt;- matrix(0.5, nrow = 2, ncol = 3)
MSM1.start.yearZ &lt;- 1990
start.list &lt;- list(Z = MSM1.start.Z, yearZ = MSM1.start.yearZ)
res_MSM1 &lt;- MLmulti(PRSnapper, ncp = 1, model = "MSM1", start = start.list, grid.search = FALSE)

res_MSM2 &lt;- MLmulti(PRSnapper, ncp = 1, model = "MSM2")

st.Z1 &lt;- rep(0.5, 3)
st.yearZ &lt;- 1990
st.delta &lt;- 1
start.list &lt;- list(Z1 = st.Z1, yearZ = st.yearZ, delta = st.delta)
resMSM3 &lt;- MLmulti(PRSnapper, ncp = 1, model = "MSM3", start = start.list)

## End(Not run)
</code></pre>


</div>