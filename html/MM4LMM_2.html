<div class="container">

<table style="width: 100%;"><tr>
<td>AnovaTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Type I and Type III Tests for mixed models.

</h2>

<h3>Description</h3>

<p>This function computes Type I and Type III tests for each fixed effect of a model, as displayed by the <code>MMEst</code> function. Alternatively, a specific linear combination of the fixed parameters may be tested (at 0). 

</p>


<h3>Usage</h3>

<pre><code class="language-R">AnovaTest(ResMMEst , TestedCombination=NULL , Type = "TypeIII" ,
    Cofactor = NULL , X = NULL , formula = NULL , VarList = NULL ,
    NbCores=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ResMMEst</code></td>
<td>

<p>A list as displayed by the <code>MMEst</code> function.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TestedCombination</code></td>
<td>

<p>A contrast matrix or a list of contrast matrices <code class="reqn">C_m</code>. Each matrix corresponds to a (set of) linear combination to be (jointly) tested at 0.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Type</code></td>
<td>

<p>"TypeI", "TypeIII" or "KR" (default is "TypeIII"). AnovaTest will compute tests of the given type for each fixed effect in the model. The option is ignored if a <code>TestedCombination</code> is provided. If <code>Type</code> is "KR" then AnovaTest will compute Type III test using Kenward Roger approximation, see Kenward and Roger (1997) for details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Cofactor</code></td>
<td>

<p>The incidence matrix corresponding to fixed effects common to all models used in <code>MMEst</code>. If <code>NULL</code>, a single intercept is used as cofactor. This entry is needed when <code>Type</code> is "KR".

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>The incidence matrix or a list of incidence matrices corresponding to fixed effects specific to each model used in <code>MMEst</code> (default is <code>NULL</code>). This entry is needed when <code>Type</code> is "KR".

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>

<p>The formula object specifying the fixed effect part of all models separated by + operators used in <code>MMEst</code> (default is <code>NULL</code>). This entry is needed when <code>Type</code> is "KR".

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VarList</code></td>
<td>

<p>The list of correlation matrices associated with random and residual effects used in <code>MMEst</code> (default is <code>NULL</code>). This entry is needed when <code>Type</code> is "KR".

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NbCores</code></td>
<td>

<p>The number of cores to be used. 

</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If no <code>TestedCombination</code> is provided, the function performs either Type I or Type III tests for each fixed effect in the model (default is Type III). If <code>TestedCombination</code> is provided, each linear combination in <code>TestedCombination</code> is tested at 0 using a Wald test. No check is performed regarding the estimability of the linear combination to be tested.  If the dimension of the combination does not match with the dimension of <code>ResMMEst</code>, a <code>NA</code> is returned. 
</p>



<h3>Value</h3>

<p>The output of the function is a list with as many items as in the original input list <code>ResMMEst</code>. For each item of <code>ResMMEst</code>, a table is provided that contains the Wald test statistics, p-values and degrees of freedom for all tested hypotheses. 





</p>


<h3>Author(s)</h3>

<p>F. Laporte and T. Mary-Huard

</p>


<h3>References</h3>

<p>Kenward, M. G., &amp; Roger, J. H. (1997). Small sample inference for fixed effects from restricted maximum likelihood. Biometrics, 983-997.

</p>


<h3>Examples</h3>

<pre><code class="language-R">  require('MM4LMM')
  data(QTLDetectionExample)
  Pheno &lt;- QTLDetectionExample$Phenotype
  Geno &lt;- QTLDetectionExample$Genotype
  Kinship &lt;- QTLDetectionExample$Kinship

  ##Build the VarList object
  VL &lt;- list(Additive = Kinship , Error = diag(1,length(Pheno)))
  
  ##Perform inference
  Result &lt;- MMEst(Y=Pheno , X = Geno , VarList = VL)

  ##Compute tests
  AOV &lt;- AnovaTest(Result,Type="TypeI")
  
  ##Test specific contrast matrix
  TC = matrix(c(0,1),nrow=1)
  AOV2 &lt;- AnovaTest(Result, TestedCombination = TC)
  
  AOV3 &lt;- AnovaTest(Result, TestedCombination = TC , Type="KR" , X = Geno , VarList = VL)

</code></pre>


</div>