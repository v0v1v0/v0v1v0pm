<div class="container">

<table style="width: 100%;"><tr>
<td>MMBlup</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
BLUP from MM4LMM results

</h2>

<h3>Description</h3>

<p>This function computes the BLUP for each random vector included in the <code>MMEst</code> output. Note that this function can be called only if the argument <code>X</code> of <code>MMEst</code> was set to <code>NULL</code>



</p>


<h3>Usage</h3>

<pre><code class="language-R">  MMBlup(Y,Cofactor = NULL, X = NULL, fmla = NULL,ZList=NULL,VarList,ResMM)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>

<p>The vector of response values used in the function <code>MMEst</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Cofactor</code></td>
<td>

<p>The incidence matrix corresponding to fixed effects common to all models to be adjusted used in the function <code>MMEst</code>. If <code>NULL</code>, a vector full of 1 is used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>Must be <code>NULL</code>. 

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fmla</code></td>
<td>

<p>The formula object specifying the fixed effect part of all models separated by + operators used in the function <code>MMEst</code> (default is <code>NULL</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ZList</code></td>
<td>

<p>The list of incidence matrices associated with random and residual effects used in the function <code>MMEst</code> (default is <code>NULL</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VarList</code></td>
<td>

<p>The list of covariance matrices associated with random and residual effects used in the function <code>MMEst</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ResMM</code></td>
<td>

<p>A list as displayed by the <code>MMEst</code> function for a Variance Component Analysis.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function returns a list where each element corresponds to the Best Linear Unbiased Prediction of a random component of the model.
</p>








<h3>Author(s)</h3>

<p>GQMS CoreFunctions Team

</p>


<h3>Examples</h3>

<pre><code class="language-R">  require('MM4LMM')
  data(VarianceComponentExample)
  DataHybrid &lt;- VarianceComponentExample$Data
  KinF &lt;- VarianceComponentExample$KinshipF
  KinD &lt;- VarianceComponentExample$KinshipD
  
  ##Build incidence matrix for each random effect
  Zf &lt;- t(sapply(as.character(DataHybrid$CodeFlint), function(x)
    as.numeric(rownames(KinF)==x)))
  Zd &lt;- t(sapply(as.character(DataHybrid$CodeDent), function(x)
    as.numeric(rownames(KinD)==x)))
  
  ##Build the VarList and ZList objects
  VL = list(Flint=KinF , Dent=KinD , Error = diag(1,nrow(DataHybrid)))
  ZL &lt;- list(Flint=Zf , Dent=Zd , Error = diag(1,nrow(DataHybrid)))
  
  ##Perform inference
  #A first way to call MMEst
  ResultVA &lt;- MMEst(Y=DataHybrid$Trait  , Cofactor = matrix(DataHybrid$Trial)
                    , ZList = ZL  ,  VarList = VL)
  BlupVA &lt;- MMBlup(Y=DataHybrid$Trait  , Cofactor = matrix(DataHybrid$Trial)
                    , ZList = ZL  ,  VarList = VL , ResMM=ResultVA)
</code></pre>


</div>