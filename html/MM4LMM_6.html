<div class="container">

<table style="width: 100%;"><tr>
<td>MMVcov</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Covariance Matrix for variance estimators.

</h2>

<h3>Description</h3>

<p>This function computes the covariance matrix of variance estimators using either the inverse of the Expected Hessian Matrix or the inverse of the Average Information Matrix.



</p>


<h3>Usage</h3>

<pre><code class="language-R">MMVcov(ResMM , Y , Cofactor = NULL , formula = NULL,
    ZList = NULL , VarList , information="Expected")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ResMM</code></td>
<td>

<p>A list as displayed by the <code>MMEst</code> function for a Variance Component Analysis (only the first element of the list will be analyzed).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>

<p>The vector of response values used in the function <code>MMEst</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Cofactor</code></td>
<td>

<p>The incidence matrix corresponding to fixed effects common to all models to be adjusted used in the function <code>MMEst</code>. If <code>NULL</code>, a vector full of 1 is used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>

<p>The formula object specifying the fixed effect part of all models separated by + operators used in the function <code>MMEst</code> (default is <code>NULL</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ZList</code></td>
<td>

<p>The list of incidence matrices associated with random and residual effects used in the function <code>MMEst</code> (default is <code>NULL</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VarList</code></td>
<td>

<p>The list of covariance matrices associated with random and residual effects used in the function <code>MMEst</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>information</code></td>
<td>

<p>A string specifying the method used to approximate the covariance matrix. It can be either "Expected" (default) to use the Expected Hessian Matrix or "AI" to use the Average Information Matrix. The AI matrix is always computed using Reml estimates whereas the expected hessian matrix could also be used for ML estimates.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>information</code> is not specified then the algorithm computes the covariance matrix using the Expected matrix based on the inference method (Reml or ML) used in the first item of <code>ResMM</code>. If <code>information</code> is equal to "AI" then it computes the AI matrix to calculate the covariance matrix. Only the first item of <code>ResMM</code> is analyzed.
</p>



<h3>Value</h3>

<p>The output of the function is a list:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>vcov </code></td>
<td>
<p>The covariance matrix of the variance estimators</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SE </code></td>
<td>
<p>The standard errors of the variance estimators (the square root of the covariance matrix diagonal)</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>F. Laporte and T. Mary-Huard

</p>


<h3>Examples</h3>

<pre><code class="language-R">  require('MM4LMM')
  data(VarianceComponentExample)
  DataHybrid &lt;- VarianceComponentExample$Data
  KinF &lt;- VarianceComponentExample$KinshipF
  KinD &lt;- VarianceComponentExample$KinshipD

  ##Build incidence matrix for each random effect
  Zf &lt;- t(sapply(as.character(DataHybrid$CodeFlint), function(x)
  as.numeric(rownames(KinF)==x)))
  Zd &lt;- t(sapply(as.character(DataHybrid$CodeDent), function(x)
  as.numeric(rownames(KinD)==x)))

  ##Build the VarList and ZList objects
  VL = list(Flint=KinF , Dent=KinD , Error = diag(1,nrow(DataHybrid)))
  ZL &lt;- list(Flint=Zf , Dent=Zd , Error = diag(1,nrow(DataHybrid)))

  ##Perform inference
  #A first way to call MMEst
  ResultVA &lt;- MMEst(Y=DataHybrid$Trait  , Cofactor = matrix(DataHybrid$Trial)
                  , ZList = ZL  ,  VarList = VL)
  Expected_vcov &lt;- MMVcov(ResMM=ResultVA,Y=DataHybrid$Trait,
                  Cofactor = matrix(DataHybrid$Trial),
                  , ZList = ZL  ,  VarList = VL)
  AI_vcov &lt;- MMVcov(ResMM=ResultVA,Y=DataHybrid$Trait,
                  Cofactor = matrix(DataHybrid$Trial),
                  , ZList = ZL  ,  VarList = VL , information = "AI")
</code></pre>


</div>