<div class="container">

<table style="width: 100%;"><tr>
<td>CoxMM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MM algorithm based on AD technology for Cox model</h2>

<h3>Description</h3>

<p>Let <code class="reqn">T_i, C_i</code> and <code class="reqn">X_i = (x_{i1},\cdots, x_{iq})^T</code> denote the,
survival time, the censoring time and a <code class="reqn">q</code> dimension vector of coefficients for the <code class="reqn">i</code>-th individual, respectively. And assume the censoring time
<code class="reqn">C_i</code> is independent of the survival time <code class="reqn">T_i</code> are mutually independent, and <code class="reqn">I_i = I(T_{i} \leqslant C_{i})</code> is the censoring indicator.
Then the instantaneous hazard rate function of <code class="reqn">T_i</code> is
</p>
<p style="text-align: center;"><code class="reqn">\lambda(t|X_i)=\lambda_{0}(t) \exp(X_{i}^{T} \beta)</code>
</p>

<p>where <code class="reqn">\lambda_{0}(.)</code> is a baseline hazard rate and <code class="reqn">\beta = (\beta_1, \cdots, \beta_q)^{T}</code> is a vector of regression parameters.
We denote <code class="reqn">\Lambda</code> as the accumulative hazard rate. Then the observed data likelihood function is
</p>
<p style="text-align: center;"><code class="reqn"> L(\alpha | Y_{obs}) = \prod_{i=1}^n (\lambda_{0}(t_i) \exp(X_{i}^{T} \beta))^{I_i} \exp(-\Lambda(t_i) \exp(X_{i}^{T} \beta)) </code>
</p>

<p>where <code class="reqn">\alpha = (\beta, \Lambda)</code>. The <code>CoxMM</code> function is used to calculate the Cox model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CoxMM(formula, data, beta = NULL, Maxiter = 2000, convergence = 1e-06, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula object, which contains on the left hand side an object of the type <code>Surv</code>
and on the right hand side is the terms, e.g. <code>formula=Surv(time, status) ~ x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A <code>data.frame</code> in which to interpret the variables named in the formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>A vector of unknown regression parameters, default is <code>NULL</code>.
If is <code>NULL</code>, then make all <code>beta=0</code> during calculation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Maxiter</code></td>
<td>
<p>The maximum number of iterations is specified by default as 2000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>Specify the convergence criterion, the default is 1e-6.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>CoxMM</code> function is used to calculate the Cox model using MM algorithms
based on AD technology. EM algorithms rely on the fact that, after profiling out the nonparametric component <code class="reqn">\Lambda</code>,
the resulting function is concave. However, when this assumption does not hold, maximizing the resulting function using Newtonâ€™s method becomes difficult,
especially when there are a large number of covariates. MM algorithms can avoid the
concavity requirement and bypass the need for Newton method and matrix inversion.
</p>


<h3>Value</h3>

<p>An object of class <code>CoxMM</code> that contains the following fields: the Time, total amount of observations,
total number of failure events, the variable name, the <code class="reqn">\beta</code>, the <code class="reqn">\lambda</code>, the <code class="reqn">\Lambda</code>, convergence result,
the log likelihood value, the standard deviation of the estimated <code class="reqn">\beta</code>, the likelihood-based 95% confidence interval for the <code class="reqn">\beta</code>.
</p>


<h3>References</h3>

<p>D.R. Cox.(1972). 'Regression models and life tables.' <em>Journal of the Royal Statistical Society(Series B)</em> <strong>34</strong>(2), 187-220.
</p>
<p>Zhang L.L. and Huang X.F.(2022). 'On MM algorithms for Cox model with right-censored data.' <em>In International Conference on Cloud Computing, Internet of Things, and Computer Applications (CICA 2022)</em> <strong>12303</strong>, 29-38.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(survival)
CoxMM(Surv(time, status) ~ age + sex, lung)

</code></pre>


</div>