<div class="container">

<table style="width: 100%;"><tr>
<td>GaFrailtyMM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MM algorithm based on AD technology for gamma frailty model</h2>

<h3>Description</h3>

<p>Let <code class="reqn">T_{ij}, C_{ij}</code> and <code class="reqn">X_{ij} = (X_{ij1},\cdots, X_{ijq})^T</code> denote the
survival time, the censoring time and a vector of covariates, respectively. For the <code class="reqn">j</code>-th individual in the <code class="reqn">i</code>-th cluster, for <code class="reqn">j=1, \cdots, M_i </code> and  <code class="reqn">i=1, \cdots, B</code>. And assume the censoring time
<code class="reqn">C_{ij}</code> is independent of the survival time <code class="reqn">T_{ij}</code> given <code class="reqn">X_{ij}</code>, and <code class="reqn">I_{ij} = I(T_{ij} \leqslant C_{ij})</code> is the censoring indicator.
Conditional on a cluster-specific frailty  <code class="reqn">\omega_i</code>,  then the frailty model postulates that the instantaneous hazard rate function of <code class="reqn">T_{ij}</code> is
</p>
<p style="text-align: center;"><code class="reqn">\lambda(t|X_{ij} , \omega_i )=\lambda_{0}(t) \exp(X_{ij}^{T} \beta) \omega_i</code>
</p>

<p>where <code class="reqn">\lambda_{0}(t)</code> is a baseline hazard rate and <code class="reqn">\beta</code> is a vector of regression parameters. We assume that the frailty <code class="reqn">\omega</code> has a gamma distribution
with mean 1, variance <code class="reqn">\theta</code> and density
</p>
<p style="text-align: center;"><code class="reqn"> g(\omega) = \frac{\omega^{\frac{1}{1-\theta}} \exp(-\frac{\omega}{\theta})}{\Gamma( \frac{1}{\theta}) \theta^{\frac{1}{\theta}}} </code>
</p>

<p>and we denote <code class="reqn">\Lambda</code> as the accumulative hazard rate. The <code>GaFrailtyMM</code> function is used to calculate the gamma frailty model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">GaFrailtyMM(
  formula,
  data,
  beta = NULL,
  theta = NULL,
  lambda = NULL,
  Maxiter = 2000,
  convergence = 1e-06,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula object, which contains on the left hand side an object of the type <code>Surv</code>
and on the right hand side a <code>+cluster(id)</code> statement.
e.g. <code>formula=Surv(time, status) ~ x + cluster(id)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A <code>data.frame</code> in which to interpret the variables named in the formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>A vector of unknown regression parameters, default is <code>NULL</code>.
If is <code>NULL</code>, then make all <code>beta=1</code> during calculation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>The variance of frailty factors subject to gamma distribution, default is <code>NULL</code>.
If is <code>NULL</code>, then let <code>theta=1</code> during calculation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Baseline hazard rate, default set to <code>NULL</code>. If is <code>NULL</code>,
then let each <code>lambda</code> equals to <code>1/N</code> during calculation, which <code>N</code> is the number of observed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Maxiter</code></td>
<td>
<p>The maximum number of iterations is specified by default as 2000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>Specify the convergence criterion, the default is 1e-6.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>GaFrailtyMM</code> function is used to calculate gamma frailty survival model using MM algorithms
based on AD technology. EM algorithms relies on the fact that, after profiling out the nonparametric component <code class="reqn">\Lambda_0</code>,
the resulting function is concave. When it does not hold, using Newton method to maximize the resulting function is
difficult especially when there exist a large number of covariates. MM algorithms that can avoid the
concavity requirement and bypass Newton method and matrix inversion.
</p>


<h3>Value</h3>

<p>An object of class <code>GaFrailtyMM</code> that contains the following fields: total amount of observations,
the Time, the <code class="reqn">\Lambda</code>, the <code class="reqn">\lambda</code>, total number of failure events, total number of iterations, convergence result, the log likelihood value,
the <code class="reqn">\theta</code>, the standard deviation of the estimated <code class="reqn">\theta</code>,
the likelihood-based 95% confidence interval for the <code class="reqn">\theta</code>, <code class="reqn">\beta</code>,
the standard deviation of the estimated <code class="reqn">\beta</code>, the likelihood-based 95% confidence interval for the <code class="reqn">\beta</code>,
the variable name.
</p>


<h3>References</h3>

<p>Huang X.F., Xu J.F. and Tian G.L.(2019). 'On profile MM algorithms for gamma frailty survival models.' <em>Statistica Sinica</em> <strong>29</strong>(2), 895-916.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(survival)
GaFrailtyMM(Surv(time, status) ~ age + sex + cluster(id), data=kidney)

</code></pre>


</div>