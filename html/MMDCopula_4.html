<div class="container">

<table style="width: 100%;"><tr>
<td>BiCopGradMMD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Computation of the gradient of the MMD criterion
for parametric bivariate copulas models</h2>

<h3>Description</h3>

<p>This function computes a stochastic estimate of the gradient of the MMD criterion
for parametric estimation of bidimensional copula family.
The main arguments are the two vectors of observations, and the copula family.
The family is parametrized as in <code>VineCopula::BiCop()</code>,
using the Kendall's tau instead of the first parameter.
This function is used by <code>BiCopEstMMD()</code> to perform parameter estimation
via MMD minimization.
</p>


<h3>Usage</h3>

<pre><code class="language-R">BiCopGradMMD(
  u1,
  u2,
  family,
  tau,
  par = NULL,
  par2 = 0,
  kernel = "gaussian.Phi",
  gamma = 0.95,
  alpha = 1,
  epsilon = 1e-04,
  method = "QMCV",
  quasiRNG = "sobol",
  ndrawings = 10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>u1</code></td>
<td>
<p>vector of observations of the first coordinate, in <code class="reqn">[0,1]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u2</code></td>
<td>
<p>vector of observations of the second coordinate, in <code class="reqn">[0,1]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>the chosen family of copulas
(see the documentation of the class <code>VineCopula::BiCop()</code>
for the available families).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>the copula family can be parametrized by the parameter <code>par</code>
or by Kendall's tau. This function assumes a Kendall tau parametrization.
Thus, the user can choose the value of Kendall tau at
which the stochastic gradient should be computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>if different from <code>NULL</code>,
the user must instead of <code>tau</code> specify the corresponding parameter <code>par</code>.
The value of <code>tau</code> is then ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par2</code></td>
<td>
<p>value for the second parameter, if any. (Works only for Student copula).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>
<p>the kernel used in the MMD distance:
it can be a function taking in parameter <code>(u1, u2, v1, v2, gamma, alpha)</code>
or a name giving the kernel to use in the list:
</p>

<ul>
<li> <p><code>"gaussian"</code>: Gaussian kernel <code class="reqn">k(x,y) = \exp(-\|\frac{x-y}{\gamma}\|_2^2)
   </code>
</p>
</li>
<li> <p><code>"exp-l2"</code>: <code class="reqn">k(x,y) = \exp(-\|\frac{x-y}{\gamma}\|_2)
   </code>
</p>
</li>
<li> <p><code>"exp-l1"</code>: <code class="reqn">k(x,y) = \exp(-\|\frac{x-y}{\gamma}\|_1)
   </code>
</p>
</li>
<li> <p><code>"inv-l2"</code>: <code class="reqn">k(x,y) = 1/(1+\|\frac{x-y}{\gamma}\|_2)^\alpha
   </code>
</p>
</li>
<li> <p><code>"inv-l1"</code>: <code class="reqn">k(x,y) = 1/(1+\|\frac{x-y}{\gamma}\|_1)^\alpha
   </code>
</p>
</li>
</ul>
<p>Each of these names can receive the suffix <code>".Phi"</code>, such as <code>"gaussian.Phi"</code>
to indicates that the kernel <code class="reqn">k(x,y)</code> is replaced by
<code class="reqn">k(\Phi^{-1}(x) , \Phi^{-1}(y))</code> where <code class="reqn">\Phi^{-1}</code> denotes the quantile
function of the standard Normal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>parameter <code class="reqn">\gamma</code> to be used in the kernel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>parameter <code class="reqn">\alpha</code> to be used in the kernel, if any.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>the differential of <code>VineCopula::BiCopTau2Par()</code>
is computed thanks to a finite difference with increment <code>epsilon</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the method of computing the stochastic gradient:
</p>

<ul>
<li> <p><code>MC</code>: classical Monte-Carlo with <code>ndrawings</code> replications.
</p>
</li>
<li> <p><code>QMCV</code>: usual Monte-Carlo on U with <code>ndrawings</code> replications,
quasi Monte-Carlo on V.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quasiRNG</code></td>
<td>
<p>a function giving the quasi-random points in <code class="reqn">[0,1]^2</code> or a name giving
the method to use in the list: </p>

<ul>
<li> <p><code>sobol</code>: use of the Sobol sequence
implemented in <code>randtoolbox::sobol</code>
</p>
</li>
<li> <p><code>halton</code>: use of the Halton sequence
implemented in <code>randtoolbox::halton</code>
</p>
</li>
<li> <p><code>torus</code>: use of the Torus sequence
implemented in <code>randtoolbox::torus</code>
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndrawings</code></td>
<td>
<p>number of replicas of the stochastic estimate of the gradient drawn
at each step. The gradient is computed using the average of these replicas.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>the value of the gradient.
</p>


<h3>References</h3>

<p>Alquier, P., Ch√©rief-Abdellatif, B.-E., Derumigny, A., and Fermanian, J.D. (2022).
Estimation of copulas via Maximum Mean Discrepancy.
Journal of the American Statistical Association, <a href="https://doi.org/10.1080/01621459.2021.2024836">doi:10.1080/01621459.2021.2024836</a>.
</p>


<h3>See Also</h3>

<p><code>BiCopEstMMD()</code> for the estimation of parametric bivariate copulas by
stochastic gradient descent on the MMD criteria.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Simulation from a bivariate Gaussian copula with correlation 0.5.
dataSampled = VineCopula::BiCopSim(N = 500, family = 1, par = 0.5)

# computation of the gradient of the MMD criteria at different points
# Gradient is small at the true parameter
BiCopGradMMD(dataSampled[,1], dataSampled[,2], family = 1, par = 0.5)
# Gradient is negative when below the parameter
BiCopGradMMD(dataSampled[,1], dataSampled[,2], family = 1, par = 0.1)
# and positive when above
BiCopGradMMD(dataSampled[,1], dataSampled[,2], family = 1, par = 0.8)

</code></pre>


</div>