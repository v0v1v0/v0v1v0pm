<div class="container">

<table style="width: 100%;"><tr>
<td>MMD_attr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Attribution of individuals to sources using the MMD method</h2>

<h3>Description</h3>

<p>Attribution of individuals to sources using the MMD method
</p>


<h3>Usage</h3>

<pre><code class="language-R">MMD_attr(
  datafile,
  popfile,
  NL,
  sourcenames,
  ToAttribute,
  SelfA = "no",
  fSelfA = 0.5,
  randomSelfA = "yes",
  quantile = 0.01,
  optq = "no",
  pqmin = 0,
  pqmax = 0.5,
  np = 20,
  Nbootstrap = 10000,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>datafile</code></td>
<td>
<p>character; Name of the file *.csv (with full path in the file system) containing the genotypes (features) of individuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>popfile</code></td>
<td>
<p>character; Name of the file *.pop (with full path in the file system) containing the genotypes (features) of individuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NL</code></td>
<td>
<p>integer; number of loci. If larger than the number of available loci in the data set, NL is reduced to the maximum available number of loci.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sourcenames</code></td>
<td>
<p>a character vector listing the names of the sources.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ToAttribute</code></td>
<td>
<p>character giving the name of the individuals of aknown origin (i.e. those that will be attributed to source).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SelfA</code></td>
<td>
<p>character; if "no" attribution of individuals to sources is made; if "yes", self-attribution of selected individuals from sources is made. (Default "no")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fSelfA</code></td>
<td>
<p>real number in the interval (0,1). When SelfA="yes", fSelfA specifies the fraction of individuals from the source specified by ToAttribute that will be assumed to be of unknown origin. (Default 0.1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>randomSelfA</code></td>
<td>
<p>character only relevant if SelfA="yes". If "yes", individuals to be considered as unknown are randomly selected from the source specified by ToAttribute; if "no" a list of names for individuals is read from filepoplist. (Default "yes")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantile</code></td>
<td>
<p>real number with values in (0,1) giving the q-quantile for the MMD method. Only used if the quantile is not obatined through optimisation of the probability of correct self-attribution. (Default 0.01)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optq</code></td>
<td>
<p>character; if "no", the specified quantile value is used; if "yes", the q-quantile is optimised (only meaningful for self-attribution so optq="no" automatically if SelfA="no"). (Default "no")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pqmin</code></td>
<td>
<p>real number with values in (0,1); minimum value of q-quantile when optq="yes". (Default 0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pqmax</code></td>
<td>
<p>real number with values in (0,1); maximum value of q-quantile when optq="yes". (Default 0.5)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>np</code></td>
<td>
<p>integer giving the number of values of q-quantile in the interval (pqmin,pqmax) when optq="yes". (Default 20)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nbootstrap</code></td>
<td>
<p>integer giving the number of samples used for bootstrapping to estimate the uncertainty of the attribution probability $p_s$ bootstrap. (Default 10000)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>boolean (TRUE/FALSE) for the display of a progress bar  (Default FALSE)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If optq="yes", the output is a list with seven elements:
</p>

<ol>
<li>
<p> Number of individuals from unknown origin.
</p>
</li>
<li>
<p> Number of sources.
</p>
</li>
<li>
<p> Statistics of the attribution probability to sources, $p_s$.
</p>
</li>
<li>
<p> Probability of attribution of each unknown individual to each source $p_u,s$
</p>
</li>
<li>
<p> Runtime of the calculation.
</p>
</li>
<li>
<p> Number of loci.
</p>
</li>
<li>
<p> Parameter q used to calculate the q-quantile of the Hamming distance in the MMD method.
</p>
</li>
<li>
<p> Data frame giving the probability of correct attribution vs. q-quantile.
</p>
</li>
</ol>
<p>If optq="no", the output list contains all the items in the list above except the last one.
</p>


<h3>Author(s)</h3>

<p>Francisco J. Perez-Reche (Univeristy of Aberdeen)
</p>


<h3>Examples</h3>

<pre><code class="language-R">## This example uses a small dataset stored in the MMD package
datafile &lt;- system.file("extdata", "Campylobacter_10SNP_HlW.csv", package = "MMD")
popfile &lt;- system.file("extdata", "Campylobacter_10SNP_HlW.pop", package = "MMD")

NL &lt;- 100
sourcenames &lt;- c("Cattle","Chicken","Pig","Sheep","WB")

##----- Source attribution
ToAttribute &lt;- "Human"
SelfA="no"
attribution &lt;- MMD_attr(datafile,popfile,NL,sourcenames,ToAttribute)

## See more detailed examples in the vignette.

</code></pre>


</div>