<div class="container">

<table style="width: 100%;"><tr>
<td>plotHistDensity.v</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Plot of histogram and density estimate of the pooled gene expression levels. </h2>

<h3>Description</h3>

<p>Plot of histogram of pooled gene expression levels, composited with density estimate based on the mixture of marginal distributions. The density estimate is based on the assumption that the marginal correlations between subjects are zero.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotHistDensity.v(obj.gsMMD,
                plotFlag="case",
                plotComponent=FALSE,
                myxlab="expression level",
                myylab="density",
                mytitle="Histogram (case)",
                x.legend=NULL,
                y.legend=NULL,
                numPoints=500,
                mycol=1:4, 
                mylty=1:4, 
                mylwd=rep(3,4), 
                cex.main=2, 
                cex.lab=1.5, 
                cex.axis=1.5, 
                cex=2,
                bty="n")

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj.gsMMD</code></td>
<td>
<p>an object returned by <code>gsMMD.v</code>,
<code>gsMMD.default.v</code>, <code>gsMMD2.v</code>,
or <code>gsMMD2.default.v</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotFlag</code></td>
<td>
<p>logical. Indicate the plot will based on which type of subjects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotComponent</code></td>
<td>
<p>logical. Indicate if components of the mixture of marginal distribution will be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>myxlab</code></td>
<td>
<p>label for x-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>myylab</code></td>
<td>
<p>label for y-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mytitle</code></td>
<td>
<p>title of the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.legend</code></td>
<td>
<p>the x-corrdiates of the legend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.legend</code></td>
<td>
<p>the y-corrdiates of the legend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numPoints</code></td>
<td>
<p>logical. Indicate how many genes will be plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mycol</code></td>
<td>
<p>color for the density estimates (overall and components)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mylty</code></td>
<td>
<p>line styles for the density estimates (overall and components)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mylwd</code></td>
<td>
<p>line width for the density estimates (overall and components)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.main</code></td>
<td>
<p>font for main title</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.lab</code></td>
<td>
<p>font for x- and y-axis labels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.axis</code></td>
<td>
<p>font for x- and y-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>font for texts</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bty</code></td>
<td>
<p>the type of box to be drawn around the legend.  The allowed
values are '"o"' and '"n"' (the default).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For a given type of subjects, we pool their expression levels together if
the marginal correlations among subjects are zero. We then draw a histogram
of the pooled expression levels. Next, we composite density estimates of gene
expression levels for the overal distribution and the 3 component distributions.
</p>


<h3>Value</h3>

<p>A list containing coordinates of the density estimates:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x </code></td>
<td>
<p>sorted pooled gene expression levels for cases or controls.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x2 </code></td>
<td>
<p>a subset of <code>x</code> specified by the sequence:
<code>seq(from=1,to=len.x, by=delta)</code>, where <code>len.x</code> is the
length of the vector <code>x</code>, and <code>delta=floor(len.x/numpoints).</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y </code></td>
<td>
<p>density estimate corresponding to <code>x2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y1 </code></td>
<td>
<p>weighted density estimate for gene cluster 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y2 </code></td>
<td>
<p>weighted density estimate for gene cluster 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y3 </code></td>
<td>
<p>weighted density estimate for gene cluster 3</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p> The density estimate is obtained based on the
assumption that the marginal correlation among
subjects is zero. If the estimated marginal correlation obtained by <code>gsMMD.v</code> is far from zero, then do not use this plot function. 
</p>


<h3>Author(s)</h3>

 
<p>Xuan Li <a href="mailto:lixuan0759@gmail.com">lixuan0759@gmail.com</a>,
Yuejiao Fu <a href="mailto:yuejiao@mathstat.yorku.ca">yuejiao@mathstat.yorku.ca</a>,
Xiaogang Wang <a href="mailto:stevenw@mathstat.yorku.ca">stevenw@mathstat.yorku.ca</a>,
Dawn L. DeMeo <a href="mailto:redld@channing.harvard.edu">redld@channing.harvard.edu</a>,
Kelan Tantisira <a href="mailto:rekgt@channing.harvard.edu">rekgt@channing.harvard.edu</a>,
Scott T. Weiss <a href="mailto:restw@channing.harvard.edu">restw@channing.harvard.edu</a>,
Weiliang Qiu <a href="mailto:weiliang.qiu@gmail.com">weiliang.qiu@gmail.com</a>
</p>


<h3>References</h3>

<p>Li X, Fu Y, Wang X, DeMeo DL, Tantisira K, Weiss ST, Qiu W.
Detecting Differentially Variable MicroRNAs via Model-Based Clustering.
<em>International Journal of Genomics</em>. Article ID 6591634, Volumne 2018 (2018).
</p>


<h3>Examples</h3>

<pre><code class="language-R">  
      t1 = proc.time()
      library(ALL)
      data(ALL)
      eSet1 &lt;- ALL[1:50, ALL$BT == "B3" | ALL$BT == "T2"]
      
      mem.str &lt;- as.character(eSet1$BT)
      nSubjects &lt;- length(mem.str)
      memSubjects &lt;- rep(0,nSubjects)
      # B3 coded as 0, T2 coded as 1
      memSubjects[mem.str == "T2"] &lt;- 1
      
      obj.gsMMD.v &lt;- gsMMD.v(eSet1, memSubjects, transformFlag = FALSE, 
        transformMethod = "boxcox", scaleFlag = FALSE, 
        eps = 1.0e-1, ITMAX = 5, quiet = TRUE)
      print(round(obj.gsMMD.v$para, 3))
     
  
    plotHistDensity.v(obj.gsMMD.v, plotFlag = "case", 
        mytitle = "Histogram (case)", 
        plotComponent = TRUE, 
        x.legend = c(0.8, 3), 
        y.legend = c(0.3, 0.4), 
        numPoints = 50)
    t2=proc.time()-t1
    print(t2)
  

</code></pre>


</div>