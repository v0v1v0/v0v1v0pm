<div class="container">

<table style="width: 100%;"><tr>
<td>gendata_mmgfm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate simulated data</h2>

<h3>Description</h3>

<p>Generate simulated data from MMGFM models
</p>


<h3>Usage</h3>

<pre><code class="language-R">gendata_mmgfm(
  seed = 1,
  nvec = c(300, 200),
  pveclist = list(gaussian = c(50, 150), poisson = c(50), binomial = c(100, 60)),
  q = 6,
  d = 3,
  qs = rep(2, length(nvec)),
  rho = rep(1, length(pveclist)),
  rho_z = 1,
  sigmavec = rep(0.5, length(pveclist)),
  n_bin = 1,
  sigma_eps = 1,
  heter_error = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>a postive integer, the random seed for reproducibility of data generation process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nvec</code></td>
<td>
<p>a  vector with postive integers, specify the sample size in each study/source.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pveclist</code></td>
<td>
<p>a named list, specify the number of modalities for each type and variable dimension in each type of modatlity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>a postive integer,  specify the number of study-shared factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>a postive integer,  specify the dimension of covariate matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qs</code></td>
<td>
<p>a  vector with postive integers, specify the number of study-specified factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>a numeric vector with <code>length(pveclist)</code> and positive elements, specify the signal strength of loading matrices for each modality type.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho_z</code></td>
<td>
<p>a positive real, specify the signal strength of covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmavec</code></td>
<td>
<p>a positive real vector with <code>length(pveclist)</code>, specify the variance of study-specified and modality variable-shared factors; default as 0.5 for each element.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_bin</code></td>
<td>
<p>a positive integer, specify the number of trails when generate Binomial modality matrix; default as 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma_eps</code></td>
<td>
<p>a positive real, the variance of overdispersion error; default as 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>heter_error</code></td>
<td>
<p>a logical value, whether to generate the heterogeneous error; default as FALSE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>return a list including the following components:
</p>

<ul>
<li> <p><code>hbeta</code> - a M-length list composed by the estimated regression coefficient matrix for each modality;
</p>
</li>
<li> <p><code>hA</code> - a M-length list composed by the loading matrix corresponding to study-shared factors for each modality;
</p>
</li>
<li> <p><code>hB</code> - a S-length list composed by a M-length loading matrix list corresponding to study-specified factors for each study;
</p>
</li>
<li> <p><code>hF</code> - a S-length list composed by the posterior estimation of study-shared factor matrix for each study;
</p>
</li>
<li> <p><code>hH</code> - a S-length list composed by the posterior estimation of study-specified factor matrix for each study;
</p>
</li>
<li> <p><code>hSigma</code> - a S-length list composed by the estimated posterior variance of the study-shared factor;
</p>
</li>
<li> <p><code>hPhi</code> - a S-length list composed by the estimated posterior variance of study-specified factor;
</p>
</li>
<li> <p><code>hv</code> - a S-length list composed by a M-length vector list corresponding to the posterior estimation of study-specified and modality variable-shared factor for each study and modality;
</p>
</li>
<li> <p><code>hzeta</code> - the estimated posterior variance for study-specified and modality variable-shared factor;
</p>
</li>
<li> <p><code>hsigma2</code> - the estimated variance for study-specified and modality variable-shared factor;
</p>
</li>
<li> <p><code>hinvLambda</code> - a S-length list composed by a M-length vector list corresponding to the inverse of the estimated variances of error;
</p>
</li>
<li> <p><code>S</code> - the approximated posterior covariance for each row of F;
</p>
</li>
<li> <p><code>ELBO</code> -  the ELBO value when algorithm stops;
</p>
</li>
<li> <p><code>ELBO_seq</code> - the sequence of ELBO values.
</p>
</li>
<li> <p><code>time_use</code> - the running time in model fitting of SpaCOAP;
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">q &lt;- 3; qsvec&lt;-rep(2,3)
nvec &lt;- c(100, 120, 100)
pveclist &lt;-  list('gaussian'=rep(150, 1),'poisson'=rep(50, 2),'binomial'=rep(60, 2))
datlist &lt;- gendata_mmgfm(seed = 1,  nvec = nvec, pveclist =pveclist,
                         q = q,  d= 3,qs = qsvec,  rho = rep(3,length(pveclist)), rho_z=0.5,
                         sigmavec=rep(0.5, length(pveclist)),  sigma_eps=1)
</code></pre>


</div>