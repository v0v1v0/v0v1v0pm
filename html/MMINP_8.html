<div class="container">

<table style="width: 100%;"><tr>
<td>MMINP.train</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Train MMINP model using paired microbial features and metabolites data</h2>

<h3>Description</h3>

<p>This function contains three steps.
Step1, Build an O2-PLS model and use it to predict metabolites profile;
Step2, Compare predicted and measured metabolites abundances, then filter
those metabolites which predicted poorly (i.e. metabolites of which
correlation coefficient less than <code>rsignif</code> or adjusted pvalue greater
than <code>psignif</code>.);
Step3, (iteration) Re-build O2-PLS model until all reserved metabolites are
well-fitted.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MMINP.train(
  metag,
  metab,
  n = 1:3,
  nx = 0:3,
  ny = 0:3,
  seed = 1234,
  compmethod = NULL,
  nr_folds = 3,
  nr_cores = 1,
  rsignif = 0.4,
  psignif = 0.05,
  recomponent = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>metag</code></td>
<td>
<p>Training data of sequence features' relative abundances.
Must have the exact same rows (subjects/samples) as <code>metab</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metab</code></td>
<td>
<p>Training data of metabolite relative abundances.
Must have the exact same rows (subjects/samples) as <code>metag</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Integer. Number of joint PLS components. Must be positive.
More details in <code>crossval_o2m</code> and
<code>crossval_o2m_adjR2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nx</code></td>
<td>
<p>Integer. Number of orthogonal components in <code>metag</code>. Negative
values are interpreted as 0.
More details in <code>crossval_o2m</code> and
<code>crossval_o2m_adjR2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ny</code></td>
<td>
<p>Integer. Number of orthogonal components in <code>metab</code>. Negative
values are interpreted as 0.
More details in <code>crossval_o2m</code> and
<code>crossval_o2m_adjR2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>a random seed to make the analysis reproducible, default is 1234.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compmethod</code></td>
<td>
<p>A character string indicating which Cross-validate
procedure of O2PLS is to be used for estimating components, must be one of
"NULL", "cvo2m" or "cvo2m.adj". If set to "NULL", depends on the features
number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nr_folds</code></td>
<td>
<p>Positive integer. Number of folds to consider.
Note: <code>kcv=N</code> gives leave-one-out CV. Note that CV with less than two
folds does not make sense.
More details in <code>crossval_o2m</code> and
<code>crossval_o2m_adjR2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nr_cores</code></td>
<td>
<p>Positive integer. Number of cores to use for CV. You might
want to use <code>detectCores()</code>. Defaults to 1.
More details in <code>crossval_o2m</code> and
<code>crossval_o2m_adjR2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rsignif</code></td>
<td>
<p>A numeric ranging from 0 to 1, the minimum correlation
coefficient of features which considered as well-predicted features.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psignif</code></td>
<td>
<p>A numeric ranging from 0 to 1, the maximum adjusted p value of
features which considered as well-predicted features.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>recomponent</code></td>
<td>
<p>Logical, whether re-estimate components or not during each
iteration.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing
</p>
<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>O2PLS model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trainres</code></td>
<td>
<p>Final correlation results between predicted and measured
metabolites of training samples</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>components</code></td>
<td>
<p>Components number. If <code>recomponent = TRUE</code>, the
components number is the result of last estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>re_estimate</code></td>
<td>
<p>Re-estimate information, i.e. whether re-estimate
components or not during each iteration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trainnumb</code></td>
<td>
<p>Iteration number</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">data(test_metab)
data(test_metag)
a &lt;- MMINP.preprocess(test_metag[, 1:20], normalized = FALSE)
b &lt;- MMINP.preprocess(test_metab[, 1:20], normalized = FALSE)
mminp_model &lt;- MMINP.train(metag = a,
                           metab = b,
                           n = 3:5, nx = 0:3, ny = 0:3,
                           nr_folds = 2, nr_cores = 1)
length(mminp_model$trainres$wellPredicted)
</code></pre>


</div>