<div class="container">

<table style="width: 100%;"><tr>
<td>B_est</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimantion of unknown Markov-modulated linear regression model parameters using GLSM</h2>

<h3>Description</h3>

<p>This function is used to fit Markov-modulated linear regression models with two states of external environment.
This function estimates Markov-modulated linear regression model parameters, using GLSM.
Function uses the algorithm based on eigenvalues and eigenvectors decompositions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">B_est(tGiven, initState, X, Y, lambda, W = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tGiven</code></td>
<td>
<p>Vector of the observed times (n x 1), n – number of observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initState</code></td>
<td>
<p>Vector of the initial states (n x 1), n – number of observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Matrix of predictors (n x k), n - number of observations, k - number of columns (k - 1 - number of regressors).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Vector of the responses Y, n – number of observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Matrix with the known transition rates <code class="reqn">\lambda_{i,j}</code>, (m x m), m – number of states</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>an optional logical variable indicating should vector of weights be used in the fitting process or not.
If TRUE, matrix with weights is used (that is, inverse values to tGiven – observed times).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Function calculates the following expression:
![](vecB.png "Fig.2"),
where vector of average sojourn times in each state $t_i$ is calculated using function Aver_soj_time, $t_i$ is an element of tGiven, $x_i$ is a vector of matrix X.
</p>


<h3>Value</h3>

<p>Vector of estimated parameters <code class="reqn">\beta</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
lambda &lt;- matrix(c(0, 0.33, 0.45, 0), nrow = 2, ncol = 2, byrow = TRUE)
Xtest &lt;- cbind(rep_len(1,10),c(2,5,7,3,1,1,2,2,3,6), c(5,9,1,2,3,2,3,5,2,2))
tGiven &lt;- matrix (c(6,4.8,1,2.6,6.4,1.7,2.9,4.4,1.5,3.4), nrow = 10, ncol = 1)
Y &lt;- matrix(c (5.7, 9.9, 7.8, 14.5, 8.2, 14.5, 32.2, 3.8, 16.5, 7.7),nrow = 10, ncol = 1)
initState &lt;- matrix (c(2,1,1,2,2,2,1,1,2,1),nrow = 10, ncol = 1)
B_est(tGiven,initState,Xtest,Y,lambda,W = 1)
</code></pre>


</div>