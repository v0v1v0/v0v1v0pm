<div class="container">

<table style="width: 100%;"><tr>
<td>Xreg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Preparing data for parameter estimation procedure</h2>

<h3>Description</h3>

<p>Regressors matrix formation taking into account observation times and initial states.
Kronecker product is used.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Xreg(tGiven, initState, X, lambda)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tGiven</code></td>
<td>
<p>Vector of the observed times (n x 1), n – number of observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initState</code></td>
<td>
<p>Vector of the initial states (n x 1), n – number of observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Matrix of predictors (n x k), n - number of observations, k - number of columns (k - 1 - number of regressors).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Matrix with the known transition rates <code class="reqn">\lambda_{i,j}</code>, (m x m), m – number of states</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Function calculates the following expression
![](matrix.png "Fig.1"),
where vector of average sojourn times in each state is calculated using function Aver_soj_time.
</p>


<h3>Value</h3>

<p>Matrix (n x 2k)
</p>


<h3>Examples</h3>

<pre><code class="language-R">Xtest &lt;- cbind(rep_len(1,10),c(2,5,7,3,1,1,2,2,3,6), c(5,9,1,2,3,2,3,5,2,2))
tGiven &lt;- matrix (c(6,4.8,1,2.6,6.4,1.7,2.9,4.4,1.5,3.4), nrow = 10, ncol = 1)
initState &lt;- matrix (c(2,1,1,2,2,2,1,1,2,1),nrow = 10, ncol = 1)
lambda &lt;- matrix(c(0, 0.33, 0.45, 0), nrow = 2, ncol = 2, byrow = TRUE)
Xreg(tGiven, initState, Xtest, lambda)
</code></pre>


</div>