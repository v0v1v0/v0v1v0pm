<div class="container">

<table style="width: 100%;"><tr>
<td>kernelLaplacian</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate the graph Laplacian of a given data set</h2>

<h3>Description</h3>

<p>Calculate the graph laplacian from a given data set with subjects as rows and features as columns.
</p>


<h3>Usage</h3>

<pre><code class="language-R">kernelLaplacian(
  dat,
  kernel = c("Gaussian", "ZM", "Spectrum", "Linear"),
  laplacian = c("shift", "Ng", "sym", "rw"),
  grf.type = c("full", "knn", "e-graph"),
  k = 5,
  p = 5,
  rho = NULL,
  epsilon = 0,
  mutual = FALSE,
  binary.grf = FALSE,
  plots = TRUE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>A matrix like object with subjects as rows and features as columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>
<p>The type of kernel used to calculate the graph's adjacency matrix: <code>"Gaussian"</code> for the standard Gaussian kernel, <code>"ZM"</code> for the Zelnik-Manor kernel, <code>"Spectrum"</code> for the spectrum kernel, <code>"Linear"</code> for the linear kernel (dot product), and <code>"Cor"</code> for a kernel of pairwise correlations. See references for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>laplacian</code></td>
<td>
<p>One of <code>"shift"</code>, <code>"Ng"</code>, <code>"rw"</code> or <code>"sym"</code>. See details for description</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grf.type</code></td>
<td>
<p>Type of graph to calculate: <code>"full"</code> for adjacency matrix equal to the kernel, <code>"knn"</code> for a k-nearest neighbors graph, <code>"e-graph"</code> for an "epsilon graph"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>An integer value for <code>k</code> in the k-nearest neighbors graph. Only the <code>k</code> largest edges (most similar neighbors) will be kept</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>An integer value for the p-nearest neighbor in the <code>ZM</code> kernel</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>A value for the dispersion parameter in the Gaussian kernel. It is in the denominator of the exponent, so higher values correspond to lower similarity. By default it is the median pairwise Gaussian distance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>The cutoff value for the <code>e-graph</code>. Edges lower than this value will be removed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mutual</code></td>
<td>
<p>Make a "mutual" knn graph. Only keeps edges when two nodes are both in each others k-nearest set</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binary.grf</code></td>
<td>
<p>Set all edges &gt;0 to 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plots</code></td>
<td>
<p>Whether or not to plot the final graph, a heatmap of calculated kernel, and the eigen values of the Laplacian</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Whether or not to give some summary statistics of the pairwise distances</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The four Lapalacians are defined as <code class="reqn">L_{shift}=I+D^{-1/2}AD^{-1/2}</code>, <code class="reqn">L_{Ng}=D^{-1/2}AD^{-1/2}</code>, <code class="reqn">L_{sym}=I-D^{-1/2}AD^{-1/2}</code>, and <code class="reqn">L_{rw}=I-D^{-1}A</code>. The shifted Laplacian, <code class="reqn">L_{shift}=I+D^{-1/2}AD^{-1/2}</code>, is recommended for multi-view spectral clustering.
</p>


<h3>Value</h3>

<p>An n<code class="reqn">\times</code>n matrix where <code>n</code> is the number of rows in <code>dat</code>.
</p>


<h3>References</h3>

<p><a href="https://academic.oup.com/bioinformatics/article/36/4/1159/5566508#199177546">https://academic.oup.com/bioinformatics/article/36/4/1159/5566508#199177546</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Generating data with 3 distinct clusters
## Note that 'clustStruct' returns a list
dd &lt;- clustStruct(n=120, p=30, k=3, noiseDat='random')[[1]]

kernelLaplacian(dd, kernel="Spectrum")
</code></pre>


</div>