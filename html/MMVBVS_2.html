<div class="container">

<table style="width: 100%;"><tr>
<td>mmvbvs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Main function for variable selection</h2>

<h3>Description</h3>

<p>Main function for variable selection
</p>


<h3>Usage</h3>

<pre><code class="language-R">mmvbvs(X, Y, initial_chain, Phi, marcor, niter = 1000L, bgiter = 500L,
  hiter = 50L, burnin = 100000L, Vbeta = 1L, smallchange = 1e-04,
  verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>covariate with length N, sample size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>multivariate normal response variable N by P</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial_chain</code></td>
<td>
<p>list of starting points for beta, gamma, sigma, and sigmabeta. beta is length P for the coefficients, gamma is length P inclusion vector where each element is 0 or 1. sigma should be P x P covariance matrix, and sigmabeta should be the expected variance of the betas.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Phi</code></td>
<td>
<p>prior for the covariance matrix. We suggest identity matrix if there is no appropriate prior information</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marcor</code></td>
<td>
<p>length P vector of correlation between X and each variable of Y</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter</code></td>
<td>
<p>total number of iteration for MCMC</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bgiter</code></td>
<td>
<p>number of MH iterations within one iteration of MCMC to fit Beta and Gamma</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hiter</code></td>
<td>
<p>number of first iterations to ignore</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>number of MH iterations for h, proportion of variance explained</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Vbeta</code></td>
<td>
<p>variance of beta</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smallchange</code></td>
<td>
<p>perturbation size for MH algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>if set TRUE, print gamma for each iteration</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>list of posterior beta, gamma, and covariance matrix sigma
</p>


<h3>Examples</h3>

<pre><code class="language-R">beta = c(rep(0.5, 3), rep(0,3))
n = 200; T = length(beta); nu = T+5
Sigma = matrix(0.8, T, T); diag(Sigma) = 1
X = as.numeric(scale(rnorm(n)))
 error = MASS::mvrnorm(n, rep(0,T), Sigma)
 gamma = c(rep(1,3), rep(0,3))
 Y = X %*% t(beta) + error; Y = scale(Y)
 Phi = matrix(0.5, T, T); diag(Phi) = 1
 initial_chain = list(beta = rep(0,T),
                        gamma = rep(0,T),
                        Sigma = Phi,
                        sigmabeta = 1)
     result = mmvbvs(X = X,
                     Y = Y,
                     initial_chain = initial_chain,
                     Phi = Phi,
                     marcor = colMeans(X*Y, na.rm=TRUE),
                     niter=10,
                     verbose = FALSE)
</code></pre>


</div>