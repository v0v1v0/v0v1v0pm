<div class="container">

<table style="width: 100%;"><tr>
<td>MM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Various multiplicative multinomial probability utilities</h2>

<h3>Description</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script><p>Various multiplicative multinomial probability utilities for different
types of observation
</p>


<h3>Usage</h3>

<pre><code class="language-R">MM(y,n=NULL,paras)
MM_allsamesum(y, n=NULL, paras)
MM_differsums(y, n=NULL, paras)
MM_allsamesum_A(y, paras)
MM_differsums_A(y, paras)
MM_single(yrow, paras, givelog=FALSE)
MM_support(paras, ss)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Observations: a matrix, each row is a single observation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yrow</code></td>
<td>
<p>A single observation corresponding to one row of
matrix <code>y</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Integer vector with one element for each row of <code>y</code>.
Default value of <code>NULL</code> means to interpret each row of <code>y</code>
as being observed once</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ss</code></td>
<td>
<p>Sufficient statistics, as returned by <code>suffstats()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>givelog</code></td>
<td>
<p>Boolean in <code>MM_single()</code> with <code>TRUE</code> meaning
to return the log likelihood and default <code>FALSE</code> meaning to
return the likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>paras</code></td>
<td>
<p>Object of class <code>paras</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Consider non-negative integers \(y_1,\ldots,y_k\) with
\(\sum y_i=y\).  Then suppose the frequency function
of the distribution \(Y_1,\ldots,Y_k\) is
</p>
\[C\cdot{y\choose y_1,\ldots,y_k}
    \prod_{i=1}^k p_i^{y_i}
    \prod_{1\leq i &lt; j\leq k}{\theta_{ij}}^{y_iy_j}
    \]
<p>where \(p_i,\ldots,p_k\geq 0\), \(\sum
      p_i=1\) correspond to probabilities; and
\(\theta_{ij} &gt; 0\) for \(1\leq i &lt; j\leq k\) are additional parameters.
</p>
<p>Here \(C\) stands for a normalization constant:
</p>
\[C=C(p,\theta,Y)=
      \sum_{y_1 + \cdots + y_k=y}
    \prod_{i=1}^k p_i^{y_i}
    \prod_{1\leq i &lt; j\leq k}{\theta_{ij}}^{y_iy_j}
    \]
<p>which is evaluated numerically.  This is computationally expensive.
</p>
<p>The usual case is to use function <code>MM()</code>.
</p>

<ul>
<li>
<p> Function <code>MM()</code> returns the log of the probability of a
matrix of rows of independent multinomial observations.  It is a
wrapper for <code>MM_allsamesum()</code> and
<code>MM_differsums()</code>.  Recall that optional argument <code>n</code>
specifies the number of times that each row is observed.  Calls
<code>NormC()</code>. 
</p>
</li>
<li>
<p> Function <code>MM_allsamesum()</code> gives the log of the
probability of observing a matrix where the rowsums are identical.
Calls <code>NormC()</code>. 
</p>
</li>
<li>
<p> Function <code>MM_differsums()</code> gives the log of the
probability of observing a matrix where the rowsums are not
necessarily identical.  <strong>Warning:</strong> This function takes a long
time to run.  Calls <code>NormC()</code>, possibly many times.
</p>
</li>
<li>
<p> Functions <code>MM_allsamesum_A()</code> and
<code>MM_differsums_A()</code> are analogous to functions
<code>MM_allsamesum()</code> and <code>MM_differsums()</code> but interpret the
matrix <code>y</code> as having rows corresponding to observations; each row
is observed once, as in <code>data(pollen)</code>. Both call <code>NormC()</code>. 
</p>
</li>
<li>
<p> Function <code>MM_single()</code> gives a likelihood function for a
<code>paras</code> object with a single multinomial observation (that is,
a single line of matrix <code>y</code>).  Does not call <code>NormC()</code>. 
</p>
</li>
<li>
<p> Function <code>MM_support()</code> gives the support (that is, the
log-likelihood) of a <code>paras</code> object; argument <code>ss</code> is the
sufficient statistic, as returned by <code>suffstats()</code>.  Does not
call <code>NormC()</code>. 
</p>
</li>
<li>
<p> Function <code>dMM()</code> [documented more fully at <code>rMM.Rd</code>]
gives the probability of a single multivariate observation (ie a
single row of the matrix argument <code>y</code>).  Calls <code>NormC()</code>.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Robin K. S. Hankin</p>


<h3>Examples</h3>

<pre><code class="language-R">data(voting)

data(voting)
p &lt;- Lindsey(voting, voting_tally)

MM(voting,voting_tally,p)   #No other value of 'p' gives a bigger value


</code></pre>


</div>