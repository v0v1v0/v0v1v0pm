<div class="container">

<table style="width: 100%;"><tr>
<td>spatial.sign2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Spatial Signs
</h2>

<h3>Description</h3>

<p>The function computes the spatial signs for a data set. This function differs from the function <code>spatial.sign</code> in the way
how observations with small norms are treated. For details see below.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spatial.sign2(X, center = TRUE, shape = TRUE, eps.S = 1e-05, 
              na.action = na.fail, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>a numeric data frame or matrix.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>

<p>either a logical value or a numeric vector of length equal to
the number of columns of 'X'. See below for more information. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape</code></td>
<td>

<p>either a logical value or a square numeric matrix with number of columns equal to
the number of columns of 'X'. See below for more information.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps.S</code></td>
<td>

<p>treshold value which defines which obersvations are considered to have a small norm.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>

<p>a function which indicates what should happen when the data
contain 'NA's.  Default is to fail.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>arguments that can be passed on to functions used for the estimation of location
and shape.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The spatial signs U of X with location <code class="reqn">\mu</code> and shape V are given by transforming the data points
<code class="reqn">z_i = (x_{i}-\mu)V^{-\frac{1}{2}}</code> and then computing
</p>
<p style="text-align: center;"><code class="reqn">u_{i}=\frac{z_i}{\| z_i \|}.</code>
</p>
 
<p>If a numeric value is given as 'center' and/or 'shape' these are used as <code class="reqn">\mu</code> and/or V in the above formula. 
If 'center' and/or 'shape' are 'TRUE' the values for <code class="reqn">\mu</code> and/or V are estimated, if 'FALSE' the origin is used as the 
value of <code class="reqn">\mu</code> and/or the identity matrix as the value of V.
</p>
<p>When the norm <code class="reqn">\| z_i \|</code> is 0 then the spatial sign is set usually to 0 as for example in the function 
<code>spatial.sign</code>. Here however if  the spatial designs are defined as 
</p>
<p style="text-align: center;"><code class="reqn">u_{i}=\frac{z_i}{\| z_i \|} I(\| z_i \| &gt; eps.S) + \frac{z_i}{eps.S} I(\| z_i \| \leq eps.S).</code>
</p>



<h3>Value</h3>

<p>a matrix with the spatial signs of the data as rows or the univariate signs as a px1 matrix. The
centering vector and scaling matrix used are returned as attributes
'center' and 'shape'.
</p>


<h3>Author(s)</h3>

<p>Klaus Nordhausen</p>


<h3>See Also</h3>

<p><code>spatial.sign</code>, <code>HR.Mest</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># comparing spatial.sign and spatial.sign2
data(pulmonary)
head(spatial.sign2(pulmonary, c(-0.1099999,-0.12,-4.3),FALSE))
head(spatial.sign(pulmonary, c(-0.1099999,-0.12,-4.3),FALSE))
</code></pre>


</div>