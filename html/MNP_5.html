<div class="container">

<table style="width: 100%;"><tr>
<td>mnp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting the Multinomial Probit Model via Markov chain Monte Carlo</h2>

<h3>Description</h3>

<p><code>mnp</code> is used to fit (Bayesian) multinomial probit model via Markov
chain Monte Carlo.  <code>mnp</code> can also fit the model with different choice
sets for each observation, and complete or partial ordering of all the
available alternatives. The computation uses the efficient marginal data
augmentation algorithm that is developed by Imai and van Dyk (2005a).
</p>


<h3>Usage</h3>

<pre><code class="language-R">mnp(
  formula,
  data = parent.frame(),
  choiceX = NULL,
  cXnames = NULL,
  base = NULL,
  latent = FALSE,
  invcdf = FALSE,
  trace = TRUE,
  n.draws = 5000,
  p.var = "Inf",
  p.df = n.dim + 1,
  p.scale = 1,
  coef.start = 0,
  cov.start = 1,
  burnin = 0,
  thin = 0,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A symbolic description of the model to be fit specifying the
response variable and covariates. The formula should not include the
choice-specific covariates. Details and specific examples are given below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>An optional data frame in which to interpret the variables in
<code>formula</code> and <code>choiceX</code>. The default is the environment in which
<code>mnp</code> is called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>choiceX</code></td>
<td>
<p>An optional list containing a matrix of choice-specific
covariates for each category. Details and examples are provided below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cXnames</code></td>
<td>
<p>A vector of the names for the choice-specific covariates
specified in <code>choiceX</code>. The details and examples are provided below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base</code></td>
<td>
<p>The name of the base category. For the standard multinomial
probit model, the default is the lowest level of the response variable. For
the multinomial probit model with ordered preferences, the default base
category is the last column in the matrix of response variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>latent</code></td>
<td>
<p>logical. If <code>TRUE</code>, then the latent variable W will be
returned. See Imai and van Dyk (2005) for the notation. The default is
<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>invcdf</code></td>
<td>
<p>logical. If <code>TRUE</code>, then the inverse cdf method is used
for truncated normal sampling. If <code>FALSE</code>, then the rejection sampling
method is used. The default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>logical. If <code>TRUE</code>, then the trace of the variance
covariance matrix is set to a constant (here, it is equal to <code>n.dim</code>)
instead of setting its first diagonal element to 1.  The former avoids the
arbitrariness of fixing one particular diagonal element in order to achieve
identification (see Burgette and Nordheim, 2009).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.draws</code></td>
<td>
<p>A positive integer. The number of MCMC draws. The default is
<code>5000</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.var</code></td>
<td>
<p>A positive definite matrix. The prior variance of the
coefficients.  A scalar input can set the prior variance to the diagonal
matrix whose diagonal element is equal to that value. The default is
<code>"Inf"</code>, which represents an improper noninformative prior distribution
on the coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.df</code></td>
<td>
<p>A positive integer greater than <code>n.dim-1</code>. The prior
degrees of freedom parameter for the covariance matrix. The default is
<code>n.dim+1</code>, which is equal to the total number of alternatives.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.scale</code></td>
<td>
<p>A positive definite matrix.  When <code>trace = FALSE</code>, its
first diagonal element is set to <code>1</code> if it is not equal to 1 already.
The prior scale matrix for the covariance matrix. A scalar input can be used
to set the scale matrix to a diagonal matrix with diagonal elements equal to
the scalar input value. The default is <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef.start</code></td>
<td>
<p>A vector. The starting values for the coefficients.  A
scalar input sets the starting values for all the coefficients equal to that
value.  The default is <code>0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.start</code></td>
<td>
<p>A positive definite matrix. When <code>trace = FALSE</code>, its
first diagonal element is set to <code>1</code> if it is not equal to 1 already.
The starting values for the covariance matrix. A scalar input can be used to
set the starting value to a diagonal matrix with diagonal elements equal to
the scalar input value. The default is <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>A positive integer. The burnin interval for the Markov chain;
i.e., the number of initial Gibbs draws that should not be stored. The
default is <code>0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>A positive integer. The thinning interval for the Markov chain;
i.e., the number of Gibbs draws between the recorded values that are
skipped. The default is <code>0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical. If <code>TRUE</code>, helpful messages along with a
progress report of the Gibbs sampling are printed on the screen. The default
is <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>To fit the multinomial probit model when only the most preferred choice is
observed, use the syntax for the formula, <code>y ~ x1 + x2</code>, where <code>y</code>
is a factor variable indicating the most preferred choice and <code>x1</code> and
<code>x2</code> are individual-specific covariates. The interactions of
individual-specific variables with each of the choice indicator variables
will be fit.
</p>
<p>To specify choice-specific covariates, use the syntax,
<code>choiceX=list(A=cbind(z1, z2), B=cbind(z3, z4), C=cbind(z5, z6))</code>,
where <code>A</code>, <code>B</code>, and <code>C</code> represent the choice names of the
response variable, and <code>z1</code> and <code>z2</code> are each vectors of length
<code class="reqn">n</code> that record the values of the two choice-specific covariates for
each individual for choice A, likewise for <code>z3</code>, <code class="reqn">\ldots</code>,
<code>z6</code>. The corresponding variable names via <code>cXnames=c("price",
"quantity")</code> need to be specified, where <code>price</code> refers to the
coefficient name for <code>z1</code>, <code>z3</code>, and <code>z5</code>, and
<code>quantity</code> refers to that for <code>z2</code>, <code>z4</code>, and <code>z6</code>.
</p>
<p>If the choice set varies from one observation to another, use the syntax,
<code>cbind(y1, y2, y3) ~ x1 + x2</code>, in the case of a three choice problem,
and indicate unavailable alternatives by <code>NA</code>. If only the most
preferred choice is observed, <code>y1</code>, <code>y2</code>, and <code>y3</code> are
indicator variables that take on the value one for individuals who prefer
that choice and zero otherwise. The last column of the response matrix,
<code>y3</code> in this particular example syntax, is used as the base category.
</p>
<p>To fit the multinomial probit model when the complete or partial ordering of
the available alternatives is recorded, use the same syntax as when the
choice set varies (i.e., <code>cbind(y1, y2, y3, y4) ~ x1 + x2</code>). For each
observation, all the available alternatives in the response variables should
be numerically ordered in terms of preferences such as <code>1 2 2 3</code>. Ties
are allowed. The missing values in the response variable should be denoted
by <code>NA</code>. The software will impute these missing values using the
specified covariates. The resulting uncertainty estimates of the parameters
will properly reflect the amount of missing data. For example, we expect the
standard errors to be larger when there is more missing data.
</p>


<h3>Value</h3>

<p>An object of class <code>mnp</code> containing the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>A matrix of the Gibbs draws for each parameter; i.e., the
coefficients and covariance matrix. For the covariance matrix, the elements
on or above the diagonal are returned.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The matrix of covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The vector or matrix of the
response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>The three dimensional array of the latent
variable, W. The first dimension represents the alternatives, and the second
dimension indexes the observations. The third dimension represents the Gibbs
draws. Note that the latent variable for the base category is set to 0, and
therefore omitted from the output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alt</code></td>
<td>
<p>The names of alternatives.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.alt</code></td>
<td>
<p>The total number of alternatives.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base</code></td>
<td>
<p>The base
category used for fitting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>invcdf</code></td>
<td>
<p>The value of
<code>invcdf</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.var</code></td>
<td>
<p>The prior variance for the coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.df</code></td>
<td>
<p>The prior
degrees of freedom parameter for the covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.scale</code></td>
<td>
<p>The
prior scale matrix for the covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>The number of
initial burnin draws.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>The thinning interval.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Kosuke Imai, Department of Government and Department of Statistics, Harvard University
<a href="mailto:imai@Harvard.Edu">imai@Harvard.Edu</a>, <a href="https://imai.fas.harvard.edu">https://imai.fas.harvard.edu</a>; David A. van
Dyk, Statistics Section, Department of Mathematics, Imperial College London.
</p>


<h3>References</h3>

<p>Imai, Kosuke and David A. van Dyk. (2005a) “A Bayesian
Analysis of the Multinomial Probit Model Using the Marginal Data
Augmentation,” <em>Journal of Econometrics</em>, Vol. 124, No. 2 (February),
pp.311-334.
</p>
<p>Imai, Kosuke and David A. van Dyk. (2005b) “MNP: R Package for
Fitting the Multinomial Probit Models,” <em>Journal of Statistical
Software</em>, Vol. 14, No. 3 (May), pp.1-32.
</p>
<p>Burgette, L.F. and E.V. Nordheim. (2009).  “An alternate identifying
restriction for the Bayesian multinomial probit model,” <em>Technical
report</em>, Department of Statistics, University of Wisconsin, Madison.
</p>


<h3>See Also</h3>

<p><code>coef.mnp</code>, <code>vcov.mnp</code>, <code>predict.mnp</code>,
<code>summary.mnp</code>;
</p>


<h3>Examples</h3>

<pre><code class="language-R">
###
### NOTE: this example is not fully analyzed. In particular, the
### convergence has not been assessed. A full analysis of these data
### sets appear in Imai and van Dyk (2005b).
###

## load the detergent data
data(detergent)
## run the standard multinomial probit model with intercepts and the price
res1 &lt;- mnp(choice ~ 1, choiceX = list(Surf=SurfPrice, Tide=TidePrice,
                                       Wisk=WiskPrice, EraPlus=EraPlusPrice,
                                       Solo=SoloPrice, All=AllPrice),
            cXnames = "price", data = detergent, n.draws = 100, burnin = 10,
            thin = 3, verbose = TRUE)
## summarize the results
summary(res1)
## calculate the quantities of interest for the first 3 observations
pre1 &lt;- predict(res1, newdata = detergent[1:3,])

## load the Japanese election data
data(japan)
## run the multinomial probit model with ordered preferences
res2 &lt;- mnp(cbind(LDP, NFP, SKG, JCP) ~ gender + education + age, data = japan,
            verbose = TRUE)
## summarize the results
summary(res2)
## calculate the predicted probabilities for the 10th observation
## averaging over 100 additional Monte Carlo draws given each of MCMC draw.
pre2 &lt;- predict(res2, newdata = japan[10,], type = "prob", n.draws = 100,
                verbose = TRUE)

</code></pre>


</div>