<div class="container">

<table style="width: 100%;"><tr>
<td>runZIGLMM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Run Zero-inflated Generalized Linear Mixed Modeling on pseudobulked
scATAC data</h2>

<h3>Description</h3>

<p>'r lifecycle::badge("deprecated")'
This function is deprecated - improved modeling functions can be found in 
the package "ChAI" at https://github.com/aifimmunology/ChAI
<code>runZIGLMM</code> Runs linear mixed-effects modeling for
zero-inflated data using <code>glmmTMB</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">runZIGLMM(
  TSAM_Object,
  cellPopulation = "all",
  continuousFormula = NULL,
  ziformula = NULL,
  zi_threshold = 0,
  initialSampling = 5,
  verbose = FALSE,
  numCores = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>TSAM_Object</code></td>
<td>
<p>A SummarizedExperiment object generated from
getSampleTileMatrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cellPopulation</code></td>
<td>
<p>Name of a cell type(s), or 'all'. The function will
combine the cell types mentioned into one matrix before running the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>continuousFormula</code></td>
<td>
<p>The formula for the continuous data that should be
used within glmmTMB. It should be in the format (exp ~ factors). All
factors must be found in column names of the TSAM_Object metadata, except
for CellType, FragNumber and CellCount, which will be extracted from the
TSAM_Object. modelFormula must start with 'exp' as the response. See
glmmTMB.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ziformula</code></td>
<td>
<p>The formula for the zero-inflated data that should be used
within glmmTMB. It should be in the format ( ~ factors). All factors must
be found in column names of the TSAM_Object colData metadata, except for
CellType, FragNumber and CellCount, which will be extracted from the
TSAM_Object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zi_threshold</code></td>
<td>
<p>Zero-inflated threshold ( range = 0-1), representing the
fraction of samples with zeros. When the percentage of zeros in the tile is
between 0 and zi_threshold, samples with zeroes are dropped and only the
continous formula is used. Use this parameter at your own risk. Default is
0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initialSampling</code></td>
<td>
<p>Size of data to use for pilot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Set TRUE to display additional messages. Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numCores</code></td>
<td>
<p>integer. Number of cores to parallelize across.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>results a SummarizedExperiment containing LMEM results
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
modelList &lt;- runZIGLMM(STM[c(1:1000), ],
  cellPopulation = "CD16 Mono",
  continuousFormula = exp ~ Age + Sex + days_since_symptoms + (1 | PTID),
  ziformula = ~ FragNumber + Age,
  verbose = TRUE,
  numCores = 35
)

## End(Not run)

</code></pre>


</div>