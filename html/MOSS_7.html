<div class="container">

<table style="width: 100%;"><tr>
<td>moss_signatures</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Returns signatures of features by groups of subjects</h2>

<h3>Description</h3>

<p>This function is meant to used after moss_select.
Its main purpose is to visualize how each selected feature (
non-zero loading feature) contributes to each group of subjects by 
latent dimension.
</p>


<h3>Usage</h3>

<pre><code class="language-R">moss_signatures(
  data.blocks,
  moss_select.out,
  clus_lab = NULL,
  plot = FALSE,
  feature.labels = NULL,
  th = 1,
  only.candidates = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data.blocks</code></td>
<td>
<p>A list of omic blocks as provided to moss.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>moss_select.out</code></td>
<td>
<p>The output of moss_select.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clus_lab</code></td>
<td>
<p>A vector of same length than number of subjects 
with labels used to visualize clusters. Defaults to NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Should the results be plotted? Logical. 
Defaults to FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>feature.labels</code></td>
<td>
<p>List with with features names for each omic.
Defaults to NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>th</code></td>
<td>
<p>Show the th
Default to th=1 (all the features). Numeric.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>only.candidates</code></td>
<td>
<p>Should we plot only candidate features? Logical.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list with 'signatures', and if plot=TRUE,
a ggplot object named 'sig_plot'. The element 'signatures'
is a data frame with columns corresponding to 'Cluster' (groups
of subjects), 'Omic', 'Dim' (PC index or latent dimension),
'Feature_name', 'Feature_pos' (column index of the selected
feature within the corresponding omic), 'Loadings' (non-zero 
loadings from moss), 'Means', 'L1' and 'L2' (mean +/- standard
error of the selected feature values within an omic).
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library("MOSS")
# Extracting simulated omic blocks.
sim_data &lt;- simulate_data()
sim_blocks &lt;- sim_data$sim_blocks

# Extracting subjects and features labels.
lab.sub &lt;- sim_data$labels$lab.sub

out &lt;- moss(sim_blocks[-4],
  method = "pca",
  nu.v = 10,
  exact.dg = TRUE,
  plot = TRUE,
  alpha.v = 0.5
)
out2 &lt;- moss_select(data.blocks = sim_blocks[-4],
                    SVD = out$sparse,
                    plot = TRUE)

# Display signature plots.
out3 &lt;- moss_signatures(data.blocks = sim_blocks[-4],
                        clus_lab=lab.sub,
                        moss_select.out = out2,
                        plot = TRUE)
out3$sig_plot 
                               
</code></pre>


</div>