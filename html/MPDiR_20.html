<div class="container">

<table style="width: 100%;"><tr>
<td>binom.diagnostics</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Diagnostics for Binary GLM
</h2>

<h3>Description</h3>

<p>Two techniques for evaluating the adequacy of the binary glm model used in <code>mlds</code>, based on code in Wood (2006).
</p>


<h3>Usage</h3>

<pre><code class="language-R">binom.diagnostics(obj, nsim = 200, type = "deviance", no.warn = TRUE)

## S3 method for class 'binom.diag'
plot(x, alpha = 0.025, breaks = "Sturges", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>

<p>Object of class ‘glm’ from a fit to data with a binary response.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>

<p>number of bootstrap simulations to run.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>character indicating type of residuals (defaults to “deviance”) to use in the simulations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no.warn</code></td>
<td>

<p>logical indicating whether to suppress warnings from <code>glm</code>.  Defaults to TRUE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>object of class ‘binom.diag’, typically obtained from running <code>binom.diagnostics</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>confidence level for envelope of the distribution of residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>
<p>character indicating algorithm for choosing the breaks in the histogram of runs of residuals.  Defaults to “Sturges”.  See <code>hist</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters specifications for the empirical cdf plot</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Wood (2006) describes two diagnostics of the adequacy of a binary glm model based on analyses of residuals (see, p. 115, Exercise 2 and his solution on pp 346-347).  The first one compares the empirical cdf of the deviance residuals to a bootstrapped confidence envelope of the curve.  The second examines the number of runs in the sorted residuals with those expected on the basis of independence in the residuals, again using a resampling based on the models fitted values. The plot method generates two graphs, the first being the empirical cdf and the envelope.  The second is a histogram of the number of runs from the bootstrap procedure with the observed number indicated by a vertical line.  Currently, this only works if the ‘glm’ method is used to perform the fit and <em>not</em> the ‘optim’ method
</p>


<h3>Value</h3>

<p><code>binom.diagnostics</code> returns a list of class
‘binom.diag’ with components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>NumRuns </code></td>
<td>
<p>integer vector giving the number of runs obtained for each simulation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resid </code></td>
<td>
<p>numeric matrix giving the sorted deviance residuals in each column from each simulation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Obs.resid </code></td>
<td>
<p>numeric vector of the sorted observed deviance residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ObsRuns </code></td>
<td>
<p>integer giving the observed number of runs in the sorted deviance residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p </code></td>
<td>
<p>numeric giving the proportion of runs in the simulation less than the observed value.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Ken Knoblauch</p>


<h3>References</h3>

<p>Wood, SN <em>Generalized Additive Models: An Introduction with R</em>, Chapman &amp; Hall/CRC, 2006.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# generate psychometric function and binary data
levs &lt;-  10^seq(-2, 0, len = 5)
psyF &lt;-  pnorm(levs, mean = 0.2, sd = 0.2)
Ntrials &lt;- 100
Resp &lt;- rbinom(Ntrials * length(psyF), 1, psyF)
d.df &lt;- data.frame(resp = Resp, levs = levs)
fit.glm &lt;-  glm(resp ~ levs, binomial, d.df)
fit.diag &lt;- binom.diagnostics(fit.glm)
plot(fit.diag)

## End(Not run)
</code></pre>


</div>