<div class="container">

<table style="width: 100%;"><tr>
<td>mpn</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate most probable number (MPN)</h2>

<h3>Description</h3>

<p><code>mpn</code> calculates the Most Probable Number (<em>MPN</em>) point estimate
and confidence interval for microbial concentrations. Also calculates
Blodgett's (2002, 2005, 2010) Rarity Index (<em>RI</em>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">mpn(positive, tubes, amount, conf_level = 0.95, CI_method = c("Jarvis",
  "LR"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>positive</code></td>
<td>
<p>A vector of number of positive tubes at each dilution level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tubes</code></td>
<td>
<p>A vector of total number of tubes at each dilution level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>amount</code></td>
<td>
<p>A vector of the amount of inoculum per tube at each dilution
level. See <em>Details</em> section.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf_level</code></td>
<td>
<p>A scalar value between zero and one for the confidence
level. Typically 0.95 (i.e., a 95 percent confidence interval).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI_method</code></td>
<td>
<p>The method used for calculating the confidence interval.
Choices are <code>"Jarvis"</code> or <code>"LR"</code> (likelihood ratio). See
<em>Details</em> section.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>As an example, assume we start with 3g of undiluted inoculum per
tube, then use a 10-fold dilution for 2 dilutions. We now have
<code>amount = 3 * c(1, .1, .01)</code>.
</p>
<p>When all tubes are negative, the point estimate of <em>MPN</em> is
zero (same approach as Jarvis et al.). The point estimate for the BAM
tables "is listed as less than the lowest MPN for an outcome with at least
one positive tube" (App.2).
</p>
<p>When all tubes are positive, the point estimate for <em>MPN</em> is
<code>Inf</code> (same approach as Jarvis et al.) since no finite maximum
likelihood estimate (MLE) exists. The BAM tables "list the MPN for this
outcome as greater than the highest MPN for an outcome with at least one
negative tube" (App.2). Here, the difference is probably trivial since the
sample should be further diluted if all tubes test positive.
</p>
<p>The bias adjustment for the point estimate uses the method of Salama
et al. (1978). Also see Haas (1989).
</p>
<p>Currently, confidence intervals can only be calculated using the
Jarvis (2010) or likelihood ratio (LR) approach (Ridout, 1994). The BAM
tables use an alternate approach. We slightly modified Jarvis' approach
when all tubes are positive or all are negative; we use <code class="reqn">\alpha</code>
instead of <code class="reqn">\alpha / 2</code> since these are one-sided intervals. The Ridout
(1994) LR approach uses the same technique (with <code class="reqn">\alpha</code>) for these
two extreme cases.
</p>
<p>If the Rarity Index is less than <code>1e-04</code>, the experimental
results are highly improbable. The researcher may consider running the
experiment again and/or changing the dilution levels.
</p>


<h3>Value</h3>

<p>A list containing:
</p>

<ul>
<li>
<p><strong>MPN</strong>: The most probable number point estimate for
microbial density (concentration).
</p>
</li>
<li>
<p><strong>MPN_adj</strong>: The bias-adjusted point estimate for MPN.
</p>
</li>
<li>
<p><strong>variance</strong>: The estimated variance (see Jarvis et al.) of
the <em>MPN</em> estimate if <code>CI_method = "Jarvis"</code>. If all tubes
are positive or all negative, <code>variance</code> will be <code>NA</code>. If
<code>CI_method</code> is not <code>"Jarvis"</code>, <code>variance</code> will be
<code>NA</code>.
</p>
</li>
<li>
<p><strong>var_log</strong>: The estimated variance of the natural log of
the MPN estimate (see Jarvis et al.) using the Delta Method. If all
tubes are positive or all negative, <code>var_log</code> will be <code>NA</code>.
If <code>CI_method</code> is not <code>"Jarvis"</code>, <code>var_log</code> will be
<code>NA</code>.
</p>
</li>
<li>
<p><strong>conf_level</strong>: The confidence level used.
</p>
</li>
<li>
<p><strong>CI_method</strong>: The confidence interval method used.
</p>
</li>
<li>
<p><strong>LB</strong>: The lower bound of the confidence interval.
</p>
</li>
<li>
<p><strong>UB</strong>: The upper bound of the confidence interval.
</p>
</li>
<li>
<p><strong>RI</strong>: The rarity index.
</p>
</li>
</ul>
<h3>Warnings</h3>

<p>The Jarvis confidence interval assumptions of approximate normality (Delta
Method and asymptotic normality of maximum likelihood estimators) depend on
large-sample theory. The likelihood ratio assumptions also depend on
large-sample theory. Therefore, the Jarvis and LR confidence interval
approaches work best with larger experiments.
</p>


<h3>References</h3>

<p>Bacteriological Analytical Manual, 8th Edition, Appendix 2,
<a href="https://www.fda.gov/Food/FoodScienceResearch/LaboratoryMethods/ucm109656.htm">https://www.fda.gov/Food/FoodScienceResearch/LaboratoryMethods/ucm109656.htm</a>
</p>
<p>Blodgett RJ (2002). "Measuring improbability of outcomes from a
serial dilution test." <em>Communications in Statistics: Theory and
Methods</em>, 31(12), 2209-2223.
<a href="https://www.tandfonline.com/doi/abs/10.1081/STA-120017222">https://www.tandfonline.com/doi/abs/10.1081/STA-120017222</a>
</p>
<p>Blodgett RJ (2005). "Serial dilution with a confirmation step."
<em>Food Microbiology</em>, 22(6), 547-552.
<a href="https://doi.org/10.1016/j.fm.2004.11.017">https://doi.org/10.1016/j.fm.2004.11.017</a>
</p>
<p>Blodgett RJ (2010). "Does a serial dilution experiment's model
agree with its outcome?" <em>Model Assisted Statistics and Applications</em>,
5(3), 209-215. <a href="https://doi.org/10.3233/MAS-2010-0157">https://doi.org/10.3233/MAS-2010-0157</a>
</p>
<p>Haas CN (1989). "Estimation of microbial densities from dilution
count experiments" <em>Applied and Environmental Microbiology</em> 55(8),
1934-1942.
</p>
<p>Haas CN, Rose JB, Gerba CP (2014). "Quantitative microbial risk
assessment, Second Ed." <em>John Wiley &amp; Sons, Inc.</em>,
ISBN 978-1-118-14529-6.
</p>
<p>Jarvis B, Wilrich C, Wilrich P-T (2010). "Reconsideration of the
derivation of Most Probable Numbers, their standard deviations, confidence
bounds and rarity values." <em>Journal of Applied Microbiology</em>, 109,
1660-1667. <a href="https://doi.org/10.1111/j.1365-2672.2010.04792.x">https://doi.org/10.1111/j.1365-2672.2010.04792.x</a>
</p>
<p>Ridout MS (1994). "A comparison of confidence interval methods
for dilution series experiments." <em>Biometrics</em>, 50(1), 289-296.
</p>
<p>Salama IA, Koch GG, Tolley DH. (1978) "On the estimation of the
most probable number in a serial dilution technique." <em>Communications
in Statistics - Theory and Methods</em>, 7(13), 1267-1281.
</p>


<h3>See Also</h3>

<p>Shiny app:  <a href="https://mpncalc.galaxytrakr.org/">https://mpncalc.galaxytrakr.org/</a>
</p>
<p><code>apc</code> for Aerobic Plate Count
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Compare MPN, 95% CI, and RI to Jarvis -------------------------------------

# Table 1
mpn(positive = c(3, 1, 1), tubes = c(3, 3, 3), amount = c(1, .1, .01))
  #Jarvis: 7.5 (1.9, 30) RI = .209

mpn(positive = c(0, 0, 0), tubes = c(3, 3, 3), amount = c(1, .1, .01))
  #Jarvis: 0 (0, 1.1) RI = 1
mpn(positive = c(0, 0, 0), tubes = c(3, 3, 3), amount = c(1, .1, .01),
    conf_level = .975)$UB  #alpha / 2

mpn(positive = c(3, 3, 3), tubes = c(3, 3, 3), amount = c(1, .1, .01))
  #Jarvis: Inf (36, Inf) RI = 1
mpn(positive = c(3, 3, 3), tubes = c(3, 3, 3), amount = c(1, .1, .01),
    conf_level = .975)$LB  #alpha / 2

# Table 2
mpn(positive = c(20, 14, 3), tubes = c(20, 20, 20), amount = c(1, .1, .01))
  #Jarvis: 13 (7.6, 21) RI = 0.794

mpn(positive = c(50, 35, 7), tubes = c(50, 50, 50),
    amount = 2 * c(1, .1, .01))
  #Jarvis: 6.3 (4.5, 8.7) RI = .806

mpn(positive = c(1, 5, 3, 1, 1), tubes = c(1, 5, 5, 5, 5),
    amount = c(5, 1, .5, .1, .05))
  #Jarvis: 2.7 (1.3, 5.5) RI = .512

# Compare MPN and 95% CI to BAM tables --------------------------------------

# Table 1
mpn(positive = c(0, 0, 0), tubes = c(3, 3, 3), amount = c(.1, .01, .001))
  #BAM: &lt;3.0 (-, 9.5)

mpn(positive = c(0, 0, 1), tubes = c(3, 3, 3), amount = c(.1, .01, .001))
  #BAM: 3.0 (0.15, 9.6)

mpn(positive = c(2, 2, 0), tubes = c(3, 3, 3), amount = c(.1, .01, .001))
  #BAM: 21 (4.5, 42)

mpn(positive = c(3, 3, 3), tubes = c(3, 3, 3), amount = c(.1, .01, .001))
  #BAM: &gt;1100 (420, -)
mpn(positive = c(3, 3, 2), tubes = c(3, 3, 3), amount = c(.1, .01, .001))$MPN


# Table 2
mpn(positive = c(0, 0, 0), tubes = c(5, 5, 5), amount = c(.1, .01, .001))
  #BAM: &lt;1.8 (-, 6.8)
mpn(positive = c(0, 0, 1), tubes = c(5, 5, 5), amount = c(.1, .01, .001))$MPN

mpn(positive = c(4, 0, 2), tubes = c(5, 5, 5), amount = c(.1, .01, .001))
  #BAM: 21 (6.8, 40)

mpn(positive = c(5, 5, 5), tubes = c(5, 5, 5), amount = c(.1, .01, .001))
  #BAM: &gt;1600 (700, -)
mpn(positive = c(5, 5, 4), tubes = c(5, 5, 5), amount = c(.1, .01, .001))$MPN

# Compare MPN and 95% LR CI to Ridout (1994) --------------------------------

# Table 1
mpn(positive = c(0, 0, 0), tubes = c(3, 3, 3), amount = c(.1, .01, .001),
    CI_method = "LR")
  #Ridout: 0 (0, 9.0)
mpn(positive = c(2, 2, 0), tubes = c(3, 3, 3), amount = c(.1, .01, .001),
    CI_method = "LR")
  #Ridout: 21.1 (6.2, 54.3)
mpn(positive = c(3, 3, 3), tubes = c(3, 3, 3), amount = c(.1, .01, .001),
    CI_method = "LR")
  #Ridout: Inf (465.1, Inf)

</code></pre>


</div>