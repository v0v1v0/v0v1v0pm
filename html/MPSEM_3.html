<div class="container">

<table style="width: 100%;"><tr>
<td>graph-functions</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MPSEM graph Manipulation Functions</h2>

<h3>Description</h3>

<p>A set of primitive functions for creating and munipulating
MPSEM graphs.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pop.graph(n, vertex = list(), label = NULL)

add.vertex(x, n, vertex = list(), label = NULL)

add.edge(x, from, to, edge = list(), label = NULL)

rm.edge(x, id)

rm.vertex(x, id)

collapse.vertex(x, id)

Phylo2DirectedGraph(tp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The number of vertices to populate a new graph (<code>pop.graph</code>) or
to add to an existing graph (<code>add.vertex</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vertex</code></td>
<td>
<p>A list of vertex properties.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label</code></td>
<td>
<p>Labels to be given to edges or vertices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A <code>graph-class</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>from</code></td>
<td>
<p>The origins of the edges to be added (vertex labels or indices).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>to</code></td>
<td>
<p>The destinations of the edges to be added (vertex labels or
indices).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edge</code></td>
<td>
<p>A list of edge properties.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>Indentity (label or index) of vertex or edge to be removed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tp</code></td>
<td>
<p>Phylogenetic tree object of class ‘phylo’, as defined in
<code>ape-package</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A new graph can be populated with <code>n</code> vertices using function
<code>pop.graph</code>. Additional vertices can be added later with function
<code>add.vertex</code>. The graphs so created contain no edges; the latter are
added using function <code>add.edge</code>. Vertices and edges are removed using
functions <code>rm.vertex</code> and <code>rm.edge</code>, respectively.
</p>
<p>Function <code>collapse.vertex</code> allows one to remove a vertex while
reestablishing the connections between the vertices located above and below
that vertex using a new set of edges.
</p>
<p>Function <code>Phylo2DirectedGraph</code> uses the MPSEM graph functions to convert
a rooted phylogenetic tree of class ‘phylo’ (see
<code>ape-package</code>) to a <code>graph-class</code> object. It
recycles tip labels. It also creates default node labels if they were absent
from the ‘phylo’ object, and uses them as vertex labels. The resulting
acyclic graph can then be edited to represent cases that do not have a tree
topology.
</p>


<h3>Value</h3>

<p>The function returns a <code>graph-class</code> object. Objects
returned by <code>Phylo2DirectedGraph</code> have a <code>numeric</code>
edge property called ‘distance’ featuring branch lengths, and a
<code>link{logical}</code> vertex property called ‘species’ specifying
whether a vertex is a tree tip or an internal node.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>pop.graph()</code>: Create Graph
</p>
<p>Create a graph and populates it with vertices.
</p>
</li>
<li> <p><code>add.vertex()</code>: Add Vertices
</p>
<p>Add vertices to an existing graph.
</p>
</li>
<li> <p><code>add.edge()</code>: Add Edges
</p>
<p>Add edges to a graph.
</p>
</li>
<li> <p><code>rm.edge()</code>: Remove Edges
</p>
<p>Remove edges from a graph.
</p>
</li>
<li> <p><code>rm.vertex()</code>: Remove Vertices
</p>
<p>Remove vertices from a graph.
</p>
</li>
<li> <p><code>collapse.vertex()</code>: Collapse Vertices
</p>
<p>Remove vertices from a graph: remove vertices together with their associated
edges.
</p>
</li>
<li> <p><code>Phylo2DirectedGraph()</code>: Phylogenetic Tree Conversion
</p>
<p>Create a new <code>graph-class</code> object from a phylo-class object
(phylogenetic tree).
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Guillaume Guénard [aut, cre] (&lt;https://orcid.org/0000-0003-0761-3072&gt;),
  Pierre Legendre [ctb] (&lt;https://orcid.org/0000-0002-3838-3305&gt;)
Maintainer: Guillaume Guénard &lt;guillaume.guenard@umontreal.ca&gt;
</p>


<h3>References</h3>

<p>Guénard, G., Legendre, P., and Peres-Neto, P. 2013. Phylogenetic eigenvector
maps: a framework to model and predict species traits. Methods in Ecology 
and Evolution 4: 1120-1131
</p>
<p>Makarenkov, V., Legendre, L. &amp; Desdevise, Y. 2004. Modelling phylogenetic
relationships using reticulated networks. Zoologica Scripta 33: 89-96
</p>
<p>Blanchet, F. G., Legendre, P. &amp; Borcard, D. 2008. Modelling directional
spatial processes in ecological data. Ecological Modelling 215: 325-336
</p>


<h3>See Also</h3>

<p><code>graph-class</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Populate a graph with 7 vertices labeled A-G having properties x and y:
gr &lt;- pop.graph(n=7,
                vertex=list(x=rnorm(7,0,1),y=rnorm(7,0,1)),
                label=c("A","B","C","D","E","F","G"))
gr

## Adding 3 vertices H, I, and J with property x (y is absent) and a new
## property z (type character), which is unknown for A-G:
gr &lt;- add.vertex(x=gr,
                 n=3,
                 label=c("H","I","J"),
                 vertex=list(x=rnorm(3,0,1),z=c("A","B","C")))
gr
gr$vertex

## Adding 10 edges, labeled E1-E10 and with properties a and b, to the graph:
gr &lt;- add.edge(x=gr,
               from=c("A","B","B","C","C","D","D","E","E","F"),
               to=c("A","C","D","E","F","F","G","H","I","J"),
               edge=list(a=rnorm(10,0,1),b=rnorm(10,0,1)),
               label=paste("E",1:10,sep=""))
gr
gr$edge

## Removing edges 2, 4, and 7 from the graph:
print(rm.edge(gr,id=c(2,4,7)))

## Removing vertices 1, 3, 7, and 10 from the graph:
print(rm.vertex(gr,id=c(1,3,7,10)))
# Notice that the edges that had one of the removed vertex as their
# origin or destination are also removed:
print.default(rm.vertex(gr,id=c(1,3,7,10)))

## Vertex collapsing.
x &lt;- pop.graph(n=9,label=c("A","B","C","D","E","F","G","H","I"))
x &lt;- add.edge(x,from=c("A","A","B","B","C","C","D","D","E","E"),
              to=c("B","C","D","E","E","I","F","G","G","H"),
              label=paste("E",1:10,sep=""),
              edge=list(length=c(1,2,3,2,1,3,2,2,1,3)))
print.default(x)
for(i in c("A","B","C","D","E","F","G","H","I"))
  print(collapse.vertex(x,id=i))

if(require(ape)) {
  tree1 &lt;- read.tree(
    text=paste(
      "(((A:0.15,B:0.2)N4:0.15,C:0.35)N2:0.25,((D:0.25,E:0.1)N5:0.3,",
      "(F:0.15,G:0.2)N6:0.3)N3:0.1)N1;",sep=""))
  x &lt;- Phylo2DirectedGraph(tree1)
  print(x)
}

</code></pre>


</div>