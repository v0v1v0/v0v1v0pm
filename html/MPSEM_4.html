<div class="container">

<table style="width: 100%;"><tr>
<td>PEM-class</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Class and Methods for Phylogenetic Eigenvector Maps (PEM)</h2>

<h3>Description</h3>

<p>Class and methods to handle Phylogenetic Eigenvector Maps (PEM).
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'PEM'
print(x, ...)

## S3 method for class 'PEM'
as.data.frame(x, row.names = NULL, optional = FALSE, ...)

## S3 method for class 'PEM'
predict(
  object,
  targets,
  lmobject,
  newdata,
  interval = c("none", "confidence", "prediction"),
  level = 0.95,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A <code>PEM-class</code> object containing a Phylogenetic
Eigenvector Map.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters to be passed to the method. Currently
ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row.names</code></td>
<td>
<p>Included for method consistency reason; ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optional</code></td>
<td>
<p>Included for method consistency reason; ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A <code>PEM-class</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>targets</code></td>
<td>
<p>Output of <code>getGraphLocations</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lmobject</code></td>
<td>
<p>An object of class ‘lm’ (see <code>lm</code> for
details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>Auxiliary trait values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval</code></td>
<td>
<p>The kind of limits (confidence or prediction) to return with
the predictions; <code>interval="none"</code>: do not return a confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>Probability associated with the confidence of prediction interval.</p>
</td>
</tr>
</table>
<h3>Format</h3>

<p>A <code>PEM-class</code> object contains:
</p>

<dl>
<dt> x </dt>
<dd>
<p> The <code>graph-class</code> object that was used to
build the PEM (see <code>PEM.build</code>). </p>
</dd>
<dt> sp </dt>
<dd>
<p> A <code>logical</code> vector specifying which of the
vertices are tips. </p>
</dd>
<dt> B </dt>
<dd>
<p> The influence matrix for those vertices that are tips. </p>
</dd>
<dt> ne </dt>
<dd>
<p> The number of edges. </p>
</dd>
<dt> nsp </dt>
<dd>
<p> The number of species (tips). </p>
</dd>
<dt> Bc </dt>
<dd>
<p> The column-centred influence matrix. </p>
</dd>
<dt> means </dt>
<dd>
<p> The column means of <code>B</code>. </p>
</dd>
<dt> dist </dt>
<dd>
<p> Edge lengths. </p>
</dd>
<dt> a </dt>
<dd>
<p> The steepness parameter (see <code>PEM.build</code> for
details). </p>
</dd>
<dt> psi </dt>
<dd>
<p> The relative evolution rate along the edges (see
<code>PEM.build</code> for details). </p>
</dd>
<dt> w </dt>
<dd>
<p> Edge weights. </p>
</dd>
<dt> BcW </dt>
<dd>
<p> The weighted and column-centred influence matrix. </p>
</dd>
<dt> d </dt>
<dd>
<p> The singular values of <code>BcW</code>. </p>
</dd>
<dt> u </dt>
<dd>
<p> The eigenvectors (left singular vectors) of <code>BcW</code>. </p>
</dd>
<dt> vt </dt>
<dd>
<p> The right singular vectors of <code>BcW</code>. </p>
</dd>
</dl>
<p>In addition to these standard component, function,
<code>PEM.fitSimple</code> and <code>PEM.forcedSimple</code> add the
following members, which are necessary to make predictions:
</p>

<dl>
<dt> S2 </dt>
<dd>
<p> The variances of response data (one value for each response variable).
</p>
</dd>
<dt> y </dt>
<dd>
<p> A copy of the response data. </p>
</dd>
<dt> opt </dt>
<dd>
<p> The list returned by <code>optim</code>. </p>
</dd>
</dl>
<p>The estimated weighting parameters are also given as an edge property.
</p>


<h3>Details</h3>

<p>The <code>print.PEM</code> method provides the number of eigenvectors, the
number of observations these vectors are spanning, and their associated
eigenvalues.
</p>
<p>The <code>as.data.frame.PEM</code> method extracts the eigenvectors from the
object and allows one to use <code>PEM-class</code> objects as <code>data</code>
parameter in function such as <code>lm</code> and <code>glm</code>.
</p>
<p>The <code>predict.PEM</code> method is a barebone interface to make predictions. It
must be given species locations with respect to the phylogenetic graph
(<code>target</code>), which are provided by function
<code>getGraphLocations</code> and a linear model in the form of an object
from <code>lm</code>. The user must provide auxiliary trait values if
<code>lmobject</code> involves such traits.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>print(PEM)</code>: Print PEM-class
</p>
<p>A print method for PEM-class objects.
</p>
</li>
<li> <p><code>as.data.frame(PEM)</code>: Method <code>as.data.frame</code> for PEM-class Objects
</p>
<p>A method to extract the phylogenetic eigenvectors from a PEM-class object.
</p>
</li>
<li> <p><code>predict(PEM)</code>: Predict Method for PEM-class Objects
</p>
<p>A predict method to predict species trait values using Phylogenetic
Eigenvector Maps.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Guillaume Guénard [aut, cre] (&lt;https://orcid.org/0000-0003-0761-3072&gt;),
  Pierre Legendre [ctb] (&lt;https://orcid.org/0000-0002-3838-3305&gt;)
Maintainer: Guillaume Guénard &lt;guillaume.guenard@umontreal.ca&gt;
</p>


<h3>References</h3>

<p>Guénard, G., Legendre, P., and Peres-Neto, P. 2013. Phylogenetic eigenvector
maps: a framework to model and predict species traits. Methods in Ecology 
and Evolution 4: 1120-1131
</p>


<h3>See Also</h3>

<p><code>PEM-functions</code>
</p>


</div>