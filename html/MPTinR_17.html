<div class="container">

<table style="width: 100%;"><tr>
<td>prediction.plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Plot observed versus predicted values for categorical data.
</h2>

<h3>Description</h3>

<p>Plot observed minus predicted responses from a cognitive model for categorical data fit with MPTinR. Values above 0 indicate that there are to many responses in that category compared to the predictions, values below 0 indicate that there are to little responses compared to the predictions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">prediction.plot(results, model.filename, 
dataset = 1, 
absolute = TRUE, 
spacing = 2, 
axis.labels = NULL, 
ylim, model.type = c("easy", "eqn", "eqn2"), 
args.plot = list(), args.rect = list(), args.box = list(), args.points = list(), 
args.labels = list(), numbers = c("individual", "continuous"), 
pos.numbers = c("plot", "axis"), args.numbers = list(), args.abline = list(), abline)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>results</code></td>
<td>

<p>list. Results from <code>fit.mpt</code>, <code>fit.model</code>, or <code>fit.mptinr</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.filename</code></td>
<td>

<p>Same as in <code>fit.mpt</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataset</code></td>
<td>

<p>integer scalar or <code>"aggregated"</code> defining which dataset to plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>absolute</code></td>
<td>

<p>logical. Should absolute deviations (the default) or G^2 deviations be plotted. See Details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spacing</code></td>
<td>

<p>The spacing between two trees in x-axis ticks.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis.labels</code></td>
<td>

<p>The labels on the x-axis. Default is <code>Tree 1</code> to codeTree n.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>

<p>the <code>ylim</code> argument to <code>plot</code>. If missing taken from data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.type</code></td>
<td>

<p>Same as in <code>fit.mpt</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args.plot</code></td>
<td>

<p><code>list</code>. Further arguments to <code>plot</code>, see details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args.rect</code></td>
<td>

<p><code>list</code>. Further arguments to <code>rect</code>, see details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args.box</code></td>
<td>

<p><code>list</code>. Further arguments to <code>box</code>, see details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args.points</code></td>
<td>

<p><code>list</code>. Further arguments to <code>points</code>, see details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args.labels</code></td>
<td>

<p><code>list</code>. Further arguments to <code>axis</code>, see details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numbers</code></td>
<td>

<p>character vector (using partial matching) or <code>NULL</code> indicating where/if to plot numbers. Possible values are <code>"individual"</code>, <code>"continuous"</code>, or <code>NULL</code>. <code>"individual"</code> will start with <code>1</code> for the first response category in each tree/item type. <code>"continuous"</code> will use consecutive numbering matching the column numbers/ position of the data, <code>NULL</code> will plot no numbers. The default plots <code>"individual"</code> numbers.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos.numbers</code></td>
<td>

<p>character vector, indicating where to plot the points. Possible values are <code>"plot"</code> or <code>"axis"</code> (using partial matching).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args.numbers</code></td>
<td>

<p><code>list</code>. Further arguments to either <code>text</code> (if <code>pos.numbers = "plot"</code>) or <code>axis</code> (if <code>pos.numbers = "axis"</code>), see details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args.abline</code></td>
<td>

<p><code>list</code>. Further arguments to <code>abline</code>, see details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abline</code></td>
<td>

<p>logical. Whether to print vertical line at the positions of each point. If missing is set to <code>TRUE</code> if <code>pos.numbers = "axis"</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function uses base graphics to produce the plots and calls the following functions in the order given to do so: <code>plot</code> (produces an empty plot with axes), <code>rect</code> (produces the shaded area for each tree/ item type), <code>box</code> (produces another box around the plot), possibly <code>abline</code> (produces the vertical lines for each point), <code>points</code> (adds the data points), and depending on the value of <code>numbers</code> and <code>pos.numbers</code> either <code>text</code> (adds the numbers in the plot) or <code>axis</code> (adds the numbers below the plot).
</p>
<p>For all of those functions default values are set but can be changed using the corresponding argument. These argument must be a named list containing arguments to that function (see Examples). Default arguments are:
</p>

<ul>
<li> <p><code>args.plot</code>:  <code>list(xlab = "", ylab = "", main = "")</code>
</p>
</li>
<li> <p><code>args.rect</code>: <code>list(col = "grey", border = "transparent", density = 30, angle = 45)</code>
</p>
</li>
<li> <p><code>args.box</code>: nothing
</p>
</li>
<li>
<p>args.points: <code>list(pch = 1, cex = 2.25)</code>
</p>
</li>
<li>
<p>args.labels: either <code>list(line = -1)</code> or if plotting <code>numbers</code> at <code>"axis"</code>, <code>list(line = 1)</code>
</p>
</li>
<li>
<p>args.numbers (if <code>pos.numbers = "plot"</code>): <code>list(labels = as.character(numbers.pch), cex = 0.7)</code> (If you change <code>"labels"</code> you can define what to plot instead of numbers).
</p>
</li>
<li>
<p>args.numbers (if <code>pos.numbers = "axis"</code>): <code>list(labels = numbers.pch, cex.axis = 0.6, mgp = c(0,0.3,0))</code> (If you change <code>"labels"</code> you can define what to plot instead of numbers)
</p>
</li>
<li>
<p>args.abline: <code>list(col = "darkgrey")</code>.
</p>
</li>
</ul>
<p>If <code>absolute = TRUE</code> (the default) absolute deviations are plotted (i.e., observed - predicted from the model). If <code>absolute = FALSE</code> G^2 values are plotted which are computed for all predictions where data is non 0 with: </p>
<p style="text-align: center;"><code class="reqn">2 \times \mbox{data} \times (log(\mbox{data}) - log(\mbox{predictions}))</code>
</p>



<h3>Value</h3>

<p>Invoked for its side effects, but invisibly returns a <code>list</code> with the x and y positions for each point.
</p>


<h3>Note</h3>

<p>Please report all problems.
</p>


<h3>Author(s)</h3>

<p>Henrik Singmann. Thanks to David Kellen for discussion and ideas.
</p>


<h3>See Also</h3>

<p><code>fit.mpt</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
#### using the model and data from Broeder &amp; Schuetz:
data(d.broeder, package = "MPTinR")
m.2htm &lt;- system.file("extdata", "5points.2htm.model", package = "MPTinR")
m.sdt &lt;- "pkg/MPTinR/inst/extdata/broeder.sdt.model"

m.sdt &lt;- system.file("extdata", "broeder.sdt.model", package = "MPTinR")

# fit the 2HTM
br.2htm &lt;- fit.mpt(d.broeder, m.2htm)

# graphical parameters
par(mfrow = c(2,2))
prediction.plot(br.2htm, m.2htm, 4)
prediction.plot(br.2htm, m.2htm, 4, ylim = c(-4, 4), numbers = NULL, 
	args.points = list(pch = 16, cex = 1.5))
prediction.plot(br.2htm, m.2htm, 4, ylim = c(-4, 4), args.plot = list(main = "Dataset 4 - A"),
	abline = TRUE, numbers = "continuous")
prediction.plot(br.2htm, m.2htm, 4, ylim = c(-4, 4), args.plot = list(main = "Dataset 4 - B"),
	pos.numbers = "axis", abline = TRUE, 
	args.numbers = list(mgp = c(3, 0.2, 0), cex.axis = 0.35),
	args.points = list(pch = 4, cex = 1.5))
dev.off()

prediction.plot(br.2htm, m.2htm, "aggregated", axis.labels = unlist(lapply(c(10, 25, 50, 75, 90),
	paste, c("o.o", "o.n"), sep = "")))

# fit the SDT
br.sdt &lt;- fit.model(d.broeder, m.sdt, lower.bound = c(rep(-Inf, 5), 0, 1), upper.bound = Inf)

axis.labels &lt;- unlist(lapply(c(10, 25, 50, 75, 90), paste, c("o.o", "o.n"), sep = ""))
# compare predictions for aggregated data:
par(mfrow = c(2,2))
prediction.plot(br.2htm, m.2htm, "aggregated", ylim = c(-30, 30), 
	args.plot = list(main = "MPT model - absolute"), axis.labels = axis.labels)
prediction.plot(br.sdt, m.2htm, "aggregated", ylim = c(-30, 30),
	args.plot = list(main = "SDT model - absolute"), axis.labels = axis.labels)
prediction.plot(br.2htm, m.2htm, "aggregated", ylim = c(-60, 60), 
	args.plot = list(main = "MPT model - G.squared"), absolute = FALSE, 
	axis.labels = axis.labels, pos.numbers = "axis", args.points = list(pch = 8, cex = 1))
prediction.plot(br.sdt, m.2htm, "aggregated", ylim = c(-60, 60),
	args.plot = list(main = "SDT model - G.squared"), absolute = FALSE, 
	axis.labels = axis.labels, pos.numbers = "axis", args.points = list(pch = 8, cex = 1))

# comparing absoulte and G-sqaured plot with zero counts in cell 2:
par(mfrow = c(2,2))
prediction.plot(br.2htm, m.2htm, 2, ylim = c(-1, 1),
	args.plot = list(main = "MPT model - absolute"))
prediction.plot(br.sdt, m.2htm, 2, ylim = c(-1, 1),
	args.plot = list(main = "SDT model - absolute"))
prediction.plot(br.2htm, m.2htm, 2, ylim = c(-2, 2),
	args.plot = list(main = "MPT model - G.squared"), absolute = FALSE)
prediction.plot(br.sdt, m.2htm, 2, ylim = c(-2, 2),
	args.plot = list(main = "SDT model - G.squared"), absolute = FALSE)

## End(Not run)

</code></pre>


</div>