<div class="container">

<table style="width: 100%;"><tr>
<td>addcontours</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>addcontours simplifies adding contours to an xy plot of points</h2>

<h3>Description</h3>

<p>addcontours is used to add contours to a dense plot of 
xy points such as might be generated when conducting an analysis 
of the the uncertainty associated with a stock assessment, or 
other analysis using a bootstrap, a Bayesian MCMC, or even using 
asymptotic errors and sampling from a multi-variate normal distribution. 
addcontours first uses the kde2d function from the MASS package 
to translate the density of points into 2-D kernal densities, and 
then searches through the resulting densities for those points 
that would identify approximate contours. Finally it calls the 
contour function to add the identified approximate contours to 
the xy plot.
</p>


<h3>Usage</h3>

<pre><code class="language-R">addcontours(
  xval,
  yval,
  xrange,
  yrange,
  ngrid = 100,
  contval = c(0.5, 0.9),
  lwd = 1,
  col = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xval</code></td>
<td>
<p>the vector of x-axis values, one half of the data pairs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yval</code></td>
<td>
<p>the vector of y-axis values, the other half of the data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xrange</code></td>
<td>
<p>the range of x-axis data included in the graph</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yrange</code></td>
<td>
<p>the range of y-axis data included in the graph</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ngrid</code></td>
<td>
<p>the number of subdivisions by which to split the data 
along each axis; defaults to 100</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contval</code></td>
<td>
<p>the contour values, defaults to those containing 50 
and 90 percent i.e. c(0.5, 0.9)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>the width of the contour lines, defaults=1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>the col of the contour lines, default=1</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>nothing but it does add contours to a plot of points
</p>


<h3>Examples</h3>

<pre><code class="language-R"> library(mvtnorm)
 library(MASS)
 data(abdat)
 param &lt;- log(c(r= 0.42,K=9400,Binit=3400,sigma=0.05)) 
 bestmod &lt;- nlm(f=negLL,p=param,funk=simpspm,indat=abdat, 
                hessian=TRUE,logobs=log(abdat$cpue),
                typsize=magnitude(param),iterlim=1000)
 optpar &lt;- bestmod$estimate
 vcov &lt;- solve(bestmod$hessian)      # solve inverts matrices
 columns &lt;- c("r","K","Binit","sigma")
 N &lt;- 1000  # the contours improve as N increases; try 5000
 mvnpar &lt;- matrix(exp(rmvnorm(N,mean=optpar,sigma=vcov)),
                  nrow=N,ncol=4,dimnames=list(1:N,columns))
 xv &lt;- mvnpar[,"K"]
 yv &lt;- mvnpar[,"r"]
 # plotprep(width=6,height=5,newdev = FALSE)
 plot(xv,yv,type="p") # use default 0.5 and 0.9 contours.
 addcontours(xv,yv,range(xv),range(yv),lwd=2,col=2)
 points(mean(xv),mean(yv),pch=16,cex=1.5,col=2)
</code></pre>


</div>