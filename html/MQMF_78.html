<div class="container">

<table style="width: 100%;"><tr>
<td>plotprofile</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>plotprofile simplifies plotting single likelihood profiles</h2>

<h3>Description</h3>

<p>plotprofile simplifies plotting out the likelihood 
profiles of single parameters or variables. It is necessary to 
pass the function the output from the profile calculations, 
identifying the variable name against which to plot the 
likelihood while also identifying the name of the -ve log-likelihood 
column. Facilities are provided for defining the x and y axis 
labels. We need to use the function which.closest because we
use a sequence of parameter values so an exact match would be
highly unlikely.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotprofile(
  prof,
  var,
  digit = c(3, 3, 3),
  xlabel = var,
  ylabel = "-ve Log-Likelihood",
  like = "-veLL",
  defpar = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>prof</code></td>
<td>
<p>the results from the likelihood profile calculations. 
This matrix should include, as a minimum, the fixed variable 
of interest and the matching -ve log-likelihood in named 
columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>the name of the variable of interest to identify the 
column in prof in which to find the vector of fixed values 
given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digit</code></td>
<td>
<p>this is a vector of three that determine by how much 
the round function limits the values printed of the 95
mean at the top of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlabel</code></td>
<td>
<p>the x-axis label, defaults to the name of the var</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylabel</code></td>
<td>
<p>the y-axis label, defaults to -ve Log-Likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>like</code></td>
<td>
<p>identifies the name of the column containing the -ve 
log-likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>defpar</code></td>
<td>
<p>logical, should the par values be assumed or defined, 
defaults to TRUE, so only one plot will be produced and any old
par values will be restored afterwards. If part of a multiple 
plot define the formatting before calling and set this
to FALSE. This will lead to the oldpar being returned invisibly
so that eventually the par settings can be reset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>used for any other graphic parameters used.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>nothing but this does generate a plot.
</p>


<h3>Examples</h3>

<pre><code class="language-R"> data(abdat)    #usually use  ~100 steps in rval, perhaps use
 rval &lt;- seq(0.325,0.45,0.02)   # seq(0.325,0.45,0.001)
 ntrial &lt;- length(rval)
 columns &lt;- c("r","K","Binit","sigma","-veLL")
 result &lt;- matrix(0,nrow=ntrial,ncol=length(columns),
                  dimnames=list(rval,columns))
 bestest &lt;- c(r= 0.32,K=11000,Binit=4000,sigma=0.05) 
 for (i in 1:ntrial) {  #i &lt;- 1
   param &lt;- log(c(rval[i],bestest[2:4])) 
   parinit &lt;- param    
   bestmodP &lt;- nlm(f=negLLP,p=param,funk=simpspm,initpar=parinit,
                  indat=abdat,logobs=log(abdat$cpue),notfixed=c(2:4),
                  typsize=magnitude(param),iterlim=1000)
   bestest &lt;- exp(bestmodP$estimate)
   result[i,] &lt;- c(bestest,bestmodP$minimum)
 }
 plotprofile(result,var="r",defpar=TRUE,lwd=2)
</code></pre>


</div>