<div class="container">

<table style="width: 100%;"><tr>
<td>robustSPM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>robustSPM does a robustness test on quality of fit of an SPM</h2>

<h3>Description</h3>

<p>robustSPM conducts a robustness test on the quality of 
fit of an SPM. This is done by using the original optimal model 
parameters or the original guessed parameter values, add random 
variation to each of them, and re-fit the model. This process 
needs to be repeated multiple times. This should enable an 
analysis of the stability of the modelling outcomes. If the 
optimum parameters are used then add more variation, if initial 
guesses are used you may need to select different starting 
points so that the random variation covers the parameter space 
reasonably well.
</p>


<h3>Usage</h3>

<pre><code class="language-R">robustSPM(
  inpar,
  fish,
  N = 10,
  scaler = 40,
  verbose = FALSE,
  schaefer = TRUE,
  funk = simpspm,
  funkone = FALSE,
  steptol = 1e-06
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>inpar</code></td>
<td>
<p>the parameter set with which to begin the trials</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fish</code></td>
<td>
<p>the fisheries data: at least year, catch, and cpue</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>number of random trials to run; default = 10 = not enough</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaler</code></td>
<td>
<p>the divisor that sets the degree of normal random 
variation to add to the parameter values; default = 15 the 
smaller the value the more variable the outcome</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>progress and summary statistics to the screen? 
default = FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>schaefer</code></td>
<td>
<p>default = TRUE, which sets the analysis to the 
Schaefer model. setting it to FALSE applies the approximate Fox model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>funk</code></td>
<td>
<p>the function used to generate the predicted cpue</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>funkone</code></td>
<td>
<p>defaults=FALSE; use negLL or negLL1, with FALSE 
robustSPM will use negLL, with TRUE it will use negLL1
which has a constraint on the first parameter to keep it &gt; 0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>steptol</code></td>
<td>
<p>is the steptol from nlm as used in fitSPM, the 
default value is 1e-06, as usual.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list containing the results from each run, the range of values 
across runs, and the median values.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  data(dataspm)
  param &lt;- log(c(r=0.24,K=5174,Binit=2846,sigma=0.164))
  ans &lt;- fitSPM(pars=param,fish=dataspm,schaefer=TRUE,maxiter=1000)
  out &lt;- robustSPM(ans$estimate,dataspm,N=5,scaler=40,verbose=TRUE,
                   schaefer=TRUE) # N should be 50, 100, or more
  str(out)
  print(out$results)
  pairs(out$results[,c(6:8,11)]) # need a larger N!
</code></pre>


</div>