<div class="container">

<table style="width: 100%;"><tr>
<td>spm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>spm calculates the dynamics of a Schaefer or Fox model</h2>

<h3>Description</h3>

<p>spm calculates the dynamics using a Schaefer of Fox 
model. The outputs include  predicted Biomass, year, catch, cpue,
predicted cpue, contributions to q, ssq, and depletion levels. 
Generally it would be more sensible to use simpspm when fitting 
a Schaefer model or a Fox model as those functions are designed 
to generate only the log of predicted cpue as required by the 
functions ssq and negLL, but the example shows how it could be 
used. The function spm is used inside 'plotspmmod' and could be 
used alone, to generate a full list of model outputs after the 
model has been fitted. spm is designed for working with a
single vector of an index of relative abundance. If there are 
multiple vectors of the index then use simpspmM and spmCE.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spm(inp, indat, schaefer = TRUE, year = "year", cats = "catch", index = "cpue")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>inp</code></td>
<td>
<p>a vector of 3 or 4 model parameters (r,K,sigma) or (r, K,
Binit,sigma), you would use the latter if it was suspected that 
the fishery data started after some initial depletion had 
occurred. The sigma is an estimate of the variation of the cpue 
through time. This is required but is only used when fitting the 
model using negative log-likelihoods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indat</code></td>
<td>
<p>a matrix with at least columns year, catch, and cpue</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>schaefer</code></td>
<td>
<p>a logical value determining whether the spm is to 
be a simple Schaefer model (p=1) or approximately a Fox model 
(p=1e-08). The default is TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>year</code></td>
<td>
<p>the column name of the year variable (in case your dataset 
names it fishingyearinwhichthecatchwastaken), default='year'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cats</code></td>
<td>
<p>column name of the catch variable, default='catch'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p>the name of the cpue variable, default='cpue'</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list of five objects; parameters plus q, then outmat, the 
matrix with the dynamics, msy the maximum sustainable yield, and 
sumout, which contains r,K,B0,msy,p,q,Depl, FinalB, and InitDepl
</p>


<h3>Examples</h3>

<pre><code class="language-R"> data(abdat)   # spm is used inside plotspmmod
 pars &lt;- log(c(0.35,7800,3500,0.05))
 ans &lt;- plotspmmod(pars,abdat) #not fitted, just guessed
 bestSP &lt;- fitSPM(pars=pars,fish=abdat,funk=simpspm)
 outfit(bestSP)  # best fitting estimates
 ans &lt;- plotspmmod(bestSP$estimate,abdat,schaefer=TRUE)
 str(ans)
</code></pre>


</div>