<div class="container">

<table style="width: 100%;"><tr>
<td>spmCE</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>spmCE - calculates the dynamics for multiple cpue time-series</h2>

<h3>Description</h3>

<p>spmCE calculates the full dynamics using a Schaefer of Fox 
model and is used instead of spm when there are multiple index 
vectors. The outputs include  predicted Biomass, year, catch, 
cpue, predicted cpue, contributions to q, ssq, and depletion 
levels. Generally it would be more sensible to use simpspmM when 
fitting a Schaefer or Fox model as that function is designed to 
generate only the predicted cpue vectors required by the function 
negLLM, nevertheless, the example shows how it could be used.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spmCE(
  inp,
  indat,
  schaefer = TRUE,
  year = "year",
  cats = "catch",
  index = "cpue"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>inp</code></td>
<td>
<p>a vector of 2 or 3 model parameters (r,K) or (r,K,Binit), 
you would use the latter if it was suspected that the fishery 
data started after some initial depletion had occurred. In addition,  
there should then be the same number of sigma values as there are 
cpue time-series. For two cpue series with an initial depletion we 
would expect to have r, K, Binit, sigma1 and sigma2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indat</code></td>
<td>
<p>a matrix with at least columns 'year', 'catch', and 'cpue'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>schaefer</code></td>
<td>
<p>a logical value determining whether the spm is to be a
simple Schaefer model (p=1) or approximately a Fox model (p=1e-08). 
The default is TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>year</code></td>
<td>
<p>column name within indat containing the years, default='year'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cats</code></td>
<td>
<p>column name within indat containing the catches, default='catch'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p>column name within indat containing the prefix for cpue,
default='cpue'</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list of five objects; outmat the matrix with the dynamics 
results, q catchability, msy the maximum sustainable yield, the 
parameter values, and sumout, which contains r, K, B0, msy, p, 
q, Depl, FinalB, and InitDepl
</p>


<h3>Examples</h3>

<pre><code class="language-R"> data(twoindex)
 fish &lt;- as.matrix(twoindex)
 pars &lt;- log(c(0.04,155000,0.4,0.3))
 bestSP &lt;- nlm(f=negLLM,p=pars,funk=simpspmM,indat=fish,
             schaefer=TRUE,logobs=log(fish[,c("cpue1","cpue2")]),
             steptol=1e-06,harvpen=TRUE)
 outfit(bestSP)  # best fitting estimates
 getMSY(exp(bestSP$estimate))
</code></pre>


</div>