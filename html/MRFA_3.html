<div class="container">

<table style="width: 100%;"><tr>
<td>confidence.MRFA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Confidence Interval for Multiresolution Functional ANOVA (MRFA) Model</h2>

<h3>Description</h3>

<p>The function computes the confidence intervals of predicted responses (only works for linear regression model).
</p>


<h3>Usage</h3>

<pre><code class="language-R">confidence.MRFA(
  object,
  xnew,
  X,
  lambda = object$lambda,
  conf.level = 0.95,
  var.estimation = c("rss", "cv", "posthoc")[1],
  w.estimation = c("cv", "nugget")[1],
  K = 5,
  nugget = 1e-06,
  parallel = FALSE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a class MRFA object estimated by <code>MRFA_fit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xnew</code></td>
<td>
<p>a testing matrix with dimension <code>n_new</code> by <code>d</code> in which each row corresponds to a predictive location.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>input for <code>MRFA_fit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>a value. The default is <code>min(object$lambda)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>a value specifying confidence level of the confidence interval. The default is 0.95.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.estimation</code></td>
<td>
<p>a character string specifying the estimation method for variance. "rss" specifies residual sum of squares, "cv" specifies a cross-validation method with <code>K</code> fold, and "posthoc" specifies a post-hoc estimation method. The default is "rss".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w.estimation</code></td>
<td>
<p>a character string specifying the estimation method for weights w. "cv" specifies a cross-validation method with <code>K</code> fold, and "nugget" specifies a least square error method with nugget=<code>nugget</code>. The default is "cv".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>a positive integer specifying the number of folds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nugget</code></td>
<td>
<p>a value specifying the nugget value for <code>w.estimation</code>. The default is 1e-6. It only works when <code>w.estimation="nugget"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>logical. If <code>TRUE</code>, apply function in parallel using parallel backend provided by foreach.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical. If <code>TRUE</code>, additional diagnostics are printed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When The details about <code>var.estimation</code> and <code>w.estimation</code> can be seen in Sung et al. (2017+).
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>lower bound</code></td>
<td>
<p>a vector with length <code>n_new</code> displaying lower bound of predicted responses at locations <code>xnew</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper bound</code></td>
<td>
<p>a vector with length <code>n_new</code> displaying upper bound of predicted responses at locations <code>xnew</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>as above.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Chih-Li Sung &lt;iamdfchile@gmail.com&gt;
</p>


<h3>See Also</h3>

<p><code>MRFA_fit</code> for fitting of a multi-resolution functional ANOVA model; <code>predict.MRFA</code> for prediction of a multi-resolution functional ANOVA model.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 

#####             Testing function: OTL circuit function                      #####
#####   Thanks to Sonja Surjanovic and Derek Bingham, Simon Fraser University #####
otlcircuit &lt;- function(xx)
{
  Rb1  &lt;- 50   + xx[1] * 100
  Rb2  &lt;- 25   + xx[2] * 45
  Rf   &lt;- 0.5  + xx[3] * 2.5
  Rc1  &lt;- 1.2  + xx[4] * 1.3
  Rc2  &lt;- 0.25 + xx[5] * 0.95
  beta &lt;- 50   + xx[6] * 250

  Vb1 &lt;- 12*Rb2 / (Rb1+Rb2)
  term1a &lt;- (Vb1+0.74) * beta * (Rc2+9)
  term1b &lt;- beta*(Rc2+9) + Rf
  term1 &lt;- term1a / term1b

  term2a &lt;- 11.35 * Rf
  term2b &lt;- beta*(Rc2+9) + Rf
  term2 &lt;- term2a / term2b

  term3a &lt;- 0.74 * Rf * beta * (Rc2+9)
  term3b &lt;- (beta*(Rc2+9)+Rf) * Rc1
  term3 &lt;- term3a / term3b

  Vm &lt;- term1 + term2 + term3
  return(Vm)
}



library(MRFA)
#####   training data and testing data   #############
set.seed(2)
n &lt;- 100; n_new &lt;- 10; d &lt;- 6
X.train &lt;- matrix(runif(d*n), ncol = d)
Y.train &lt;- apply(X.train, 1, otlcircuit)
X.test &lt;- matrix(runif(d*n_new), ncol = d)
Y.test &lt;- apply(X.test, 1, otlcircuit)

#####   Fitting    #####
MRFA_model &lt;- MRFA_fit(X.train, Y.train)

#####   Prediction   ######
Y.pred &lt;- predict(MRFA_model, X.test, lambda = min(MRFA_model$lambda))$y_hat
print(sqrt(mean((Y.test - Y.pred)^2)))

### confidence interval ###
conf.interval &lt;- confidence.MRFA(MRFA_model, X.test, X.train, lambda = min(MRFA_model$lambda))
print(conf.interval)

## End(Not run)
</code></pre>


</div>