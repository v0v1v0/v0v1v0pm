<div class="container">

<table style="width: 100%;"><tr>
<td>cv.MRFA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute K-fold cross-validated error for Multi-Resolution Functional ANOVA (MRFA) Model</h2>

<h3>Description</h3>

<p>Computes the K-fold cross validated mean squared prediction error for multiresolution functional ANOVA model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cv.MRFA(
  X,
  Y,
  order = 10,
  level = 10,
  lambda = exp(seq(log(500), log(0.001), by = -0.01)),
  K = 10,
  plot.it = TRUE,
  parallel = FALSE,
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>input for <code>MRFA_fit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>input for <code>MRFA_fit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>input for <code>MRFA_fit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>input for <code>MRFA_fit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>lambda values at which CV curve should be computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>a positive integer specifying the number of folds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.it</code></td>
<td>
<p>logical. If <code>TRUE</code>, a CV curve will be shown. The default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>logical. If <code>TRUE</code>, apply cross-validation function in parallel using parallel backend provided by foreach. The default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical. If <code>TRUE</code>, additional diagnostics are printed. The default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to <code>MRFA_fit</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>lambda values at which CV curve is computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv</code></td>
<td>
<p>the CV curve at each value of lambda.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.error</code></td>
<td>
<p>the standard error of the CV curve</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Chih-Li Sung &lt;iamdfchile@gmail.com&gt;
</p>


<h3>See Also</h3>

<p><code>MRFA_fit</code> for fitting a multiresolution functional ANOVA model.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 

#####             Testing function: GRAMACY &amp; LEE (2009) function             #####
#####   Thanks to Sonja Surjanovic and Derek Bingham, Simon Fraser University #####
grlee09 &lt;- function(xx)
{
  x1 &lt;- xx[1]
  x2 &lt;- xx[2]
  x3 &lt;- xx[3]
  x4 &lt;- xx[4]
  x5 &lt;- xx[5]
  x6 &lt;- xx[6]

  term1 &lt;- exp(sin((0.9*(x1+0.48))^10))
  term2 &lt;- x2 * x3
  term3 &lt;- x4

  y &lt;- term1 + term2 + term3
  return(y)
}

library(MRFA)
#####   Training data and testing data   #####
set.seed(2)
n &lt;- 100; n_rep &lt;- 3; n_new &lt;- 50; d &lt;- 6
X.train &lt;- matrix(runif(d*n), ncol = d)
X.train &lt;- matrix(rep(X.train, each = n_rep), ncol = d)
Y.train &lt;- apply(X.train, 1, grlee09)
Y.train &lt;- Y.train + rnorm(n*n_rep, 0, 0.05)
X.test &lt;- matrix(runif(d*n_new), ncol = d)
Y.test &lt;- apply(X.test, 1, grlee09)

#####   Fitting    #####
MRFA_model &lt;- MRFA_fit(X.train, Y.train)

#####   Computes the K-fold cross validated   #####
cv.out &lt;- cv.MRFA(X.train, Y.train, K = 5, lambda = seq(0.01,3,0.1))

#####   Prediction : CV  ######
lambda_cv &lt;- cv.out$lambda[which.min(cv.out$cv)]
Y.pred &lt;- predict(MRFA_model, X.test, lambda = lambda_cv)$y_hat
print(sqrt(mean((Y.test - Y.pred)^2)))

## End(Not run)
</code></pre>


</div>