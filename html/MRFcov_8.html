<div class="container">

<table style="width: 100%;"><tr>
<td>plotMRF_hm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot MRF interaction parameters as a heatmap</h2>

<h3>Description</h3>

<p>This function uses outputs from fitted <code>MRFcov</code> and
<code>bootstrap_MRF</code> models to plot a heatmap of node interaction coefficients.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotMRF_hm(MRF_mod, node_names, main, plot_observed_vals, data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>MRF_mod</code></td>
<td>
<p>A fitted <code>MRFcov</code> or <code>bootstrap_MRF</code>
object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>node_names</code></td>
<td>
<p>A character vector of species names for axis labels. Default
is to use rownames from the <code>MRFcov$graph</code> slot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>An optional character title for the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_observed_vals</code></td>
<td>
<p>Logical. If <code>TRUE</code> and the family of the fitted <code>MRFcov</code>
model is <code>'binomial'</code>,
then raw observed occurrence and co-occurrence values will be extracted from <code>data</code> and overlaid on
the resulting heatmap. Note, this option is not available for <code>bootstrap_MRF</code> models</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Optional <code>dataframe</code> containing the input data where the left-most columns represent
binary occurrences of species that are represented by nodes in the graph. This call is only necessary
if users wish to overlay raw observed occurrence and co-occurrence values on the
heatmap of node interaction coefficients (only avaiable for <code>family = 'binomial'</code> models)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Interaction parameters from <code>MRF_mod</code> are plotted as a heatmap, where
red colours indicate positive interactions and blue indicate negative interactions. If
<code>plot_observed_vals == TRUE</code>, raw observed values of single occurrences (on the diagonal)
and co-occurrences for each species in <code>data</code> are overlaid on the plot
(only avaiable for <code>family = 'binomial'</code> models). Note, this option is not
available for <code>bootstrap_MRF</code> models
</p>


<h3>Value</h3>

<p>A <code>ggplot2</code> object
</p>


<h3>See Also</h3>

<p><code>MRFcov</code> <code>bootstrap_MRF</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data("Bird.parasites")
CRFmod &lt;- MRFcov(data = Bird.parasites, n_nodes = 4, family = 'binomial')
plotMRF_hm(MRF_mod = CRFmod)
plotMRF_hm(MRF_mod = CRFmod, plot_observed_vals = TRUE, data = Bird.parasites)

#To plot as an igraph network instead, we can simply extract the adjacency matrix
net &lt;- igraph::graph.adjacency(CRFmod$graph, weighted = TRUE, mode = "undirected")
igraph::plot.igraph(net, layout = igraph::layout.circle,
                   edge.width = abs(igraph::E(net)$weight),
                   edge.color = ifelse(igraph::E(net)$weight &lt; 0, 'blue', 'red'))

</code></pre>


</div>