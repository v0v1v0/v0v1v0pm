<div class="container">

<table style="width: 100%;"><tr>
<td>predict_MRF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Predict training observations from fitted MRFcov models</h2>

<h3>Description</h3>

<p>This function calculates linear predictors for node observations
using coefficients from an <code>MRFcov</code> or <code>MRFcov_spatial</code> object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">predict_MRF(
  data,
  MRF_mod,
  prep_covariates = TRUE,
  n_cores,
  progress_bar = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Dataframe. The input data to be predicted, where the <code>n_nodes</code>
left-most variables are are variables that are represented by nodes in the graph from
the <code>MRF_mod</code> model.
Colnames from this sample dataset must exactly match the colnames in the dataset that
was used to fit the <code>MRF_mod</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MRF_mod</code></td>
<td>
<p>A fitted <code>MRFcov</code> or <code>MRFcov_spatial</code> model object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prep_covariates</code></td>
<td>
<p>Logical flag stating whether to prep the dataset
by cross-multiplication (<code>TRUE</code> by default; <code>FALSE</code> when used in other functions)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_cores</code></td>
<td>
<p>Positive integer stating the number of processing cores to split the job across.
Default is <code>1</code> (no parallelisation)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress_bar</code></td>
<td>
<p>Logical. Progress bar in pbapply is used if <code>TRUE</code>, but this slows estimation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Observations for nodes in <code>data</code> are predicted using linear predictions
from <code>MRF_mod</code>. If <code>family = "binomial"</code>, a second element containing binary
predictions for nodes is returned. Note that predicting values for unobserved locations using a
spatial MRF is not currently supported
</p>


<h3>Value</h3>

<p>A <code>matrix</code> containing predictions for each observation in <code>data</code>. If
<code>family = "binomial"</code>, a second element containing binary
predictions for nodes is returned.
</p>


<h3>References</h3>

<p>Clark, NJ, Wells, K and Lindberg, O.
Unravelling changing interspecific interactions across environmental gradients
using Markov random fields. (2018). Ecology doi: 10.1002/ecy.2221
<a href="https://www.researchgate.net/publication/325184442_Unravelling_changing_interspecific_interactions_across_environmental_gradients_using_Markov_random_fields">Full text here</a>.
</p>


<h3>See Also</h3>

<p><code>MRFcov</code>, <code>cv_MRF_diag</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data("Bird.parasites")
# Fit a model to a subset of the data (training set)
CRFmod &lt;- MRFcov(data = Bird.parasites[1:300, ], n_nodes = 4, family = "binomial")

# If covariates are included, prep the dataset for gathering predictions
prepped_pred &lt;- prep_MRF_covariates(Bird.parasites[301:nrow(Bird.parasites), ], n_nodes = 4)

# Predict occurrences for the remaining subset (test set)
predictions &lt;- predict_MRF(data = prepped_pred, MRF_mod = CRFmod)

# Visualise predicted occurrences for nodes in the test set
predictions$Binary_predictions

# Predicting spatial MRFs requires the user to supply the spatially augmented dataset
data("Bird.parasites")
Latitude &lt;- sample(seq(120, 140, length.out = 100), nrow(Bird.parasites), TRUE)
Longitude &lt;- sample(seq(-19, -22, length.out = 100), nrow(Bird.parasites), TRUE)
coords &lt;- data.frame(Latitude = Latitude, Longitude = Longitude)
CRFmod_spatial &lt;- MRFcov_spatial(data = Bird.parasites, n_nodes = 4,
                                family = 'binomial', coords = coords)
predictions &lt;- predict_MRF(data = CRFmod_spatial$mrf_data,
                          prep_covariates  = FALSE,
                          MRF_mod = CRFmod_spatial)

</code></pre>


</div>