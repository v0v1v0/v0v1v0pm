<div class="container">

<table style="width: 100%;"><tr>
<td>mllMRH1</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Minus loglikelihood of an (bivariate) MRHawkes model with most recent 
immigrant probabilities
</h2>

<h3>Description</h3>

<p>Calculates the minus loglikelihood of an (bivariate) RHawkes model 
with given immigration hazard functions <code class="reqn">\mu</code>, common offspring 
density functions <code class="reqn">h</code> and bracnhing ratios <code class="reqn">\eta</code> for event times 
and event types <code>data</code> on interval <code class="reqn">[0,cens]</code>. The same as 
<code>mllMRH</code> although this version also returns the most recent 
immigrant probabilities at the censoring.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mllMRH1(data, cens, par,
       h1.fn = function(x, p) 1 / p * exp( - x / p),
       h2.fn = function(x, p) 1 / p * exp( - x / p),
       mu1.fn = function(x, p){ 
              exp(dweibull(x, shape = p[1], scale = p[2], log = TRUE) -
                  pweibull(x, shape = p[1], scale = p[2], lower.tail = FALSE, 
                  log.p = TRUE))
       },
       mu2.fn = function(x, p){
             exp(dweibull(x, shape = p[1], scale = p[2], log = TRUE) -
                 pweibull(x, shape = p[1], scale = p[2], lower.tail = FALSE, 
                 log.p = TRUE))
       },
       H1.fn = function(x, p) pexp(x, rate = 1 / p),
       H2.fn = function(x, p) pexp(x, rate = 1 / p),
       Mu1.fn = function(x, p){
         - pweibull(x, shape = p[1], scale = p[2], lower.tail = FALSE, 
                   log.p = TRUE)
       },
       Mu2.fn = function(x, p){
         - pweibull(x, shape = p[1], scale = p[2], lower.tail = FALSE, 
                    log.p = TRUE)
       })
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>A two column matrix. The first column contains the event times sorted in 
ascending order. The second column contains the corresponding event type
with the label one or two.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cens</code></td>
<td>

<p>A scalar. The censoring time.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>

<p>A numeric vector. Contains the ten parameters of the model, in order of 
the immigration parameters <code class="reqn">\mu(.)</code> for the two renewal distributions, 
the two offspring parameters <code class="reqn">h(.)</code> and lastly the four branching 
ratios <code class="reqn">\eta</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h1.fn</code></td>
<td>

<p>A (vectorized) function. The offspring density function for type one 
events. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h2.fn</code></td>
<td>

<p>A (vectorized) function. The offspring density function for type two 
events. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu1.fn</code></td>
<td>

<p>A (vectorized) function. The immigration hazard function for events of type
one. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu2.fn</code></td>
<td>

<p>A (vectorized) function. The immigration hazard function for events of type 
two. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H1.fn</code></td>
<td>

<p>A (vectorized) function. Its value at <code>t</code> gives the integral of
the offspring density function from 0 to <code>t</code> for type one events. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H2.fn</code></td>
<td>

<p>A (vectorized) function. Its value at <code>t</code> gives the integral of
the offspring density function from 0 to <code>t</code> for type two events. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mu1.fn</code></td>
<td>

<p>A (vectorized) function. Its value at <code>t</code> gives the integral of
the immigrant hazard function from 0 to <code>t</code> for type one events. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mu2.fn</code></td>
<td>

<p>A (vectorized) function. Its value at <code>t</code> gives the integral of
the immigrant hazard function from 0 to <code>t</code> for type two events. 
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mll</code></td>
<td>
<p>minus log-likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>most recent immigrant probabilities at the censoring time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of events</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Tom Stindl &lt;t.stindl@unsw.edu.au&gt;
Feng Chen &lt;feng.chen@unsw.edu.au&gt;
</p>


<h3>See Also</h3>

<p><code>mllMRH</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
  data &lt;- cbind(sort(runif(1000,0,1000)), 
                sample(1:2, size = 1000, replace = TRUE))
  tmp &lt;- mllMRH1(data = data, cens = 1001, 
                 par = c(3,1.2,1/3,0.2,1,1,0.5,0.2,0.2,0.3))
  ## last immigrant probabilities
  lip &lt;- tmp$p
  ## sample last immigrant at censoring time for component one and 
  ## component two respectively
  c(sample(0:1000, 1, replace = TRUE, prob = rowSums(lip)), 
  sample(0:1000, 1, replace = TRUE, prob = colSums(lip)))
  
</code></pre>


</div>