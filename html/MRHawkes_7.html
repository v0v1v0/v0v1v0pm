<div class="container">

<table style="width: 100%;"><tr>
<td>simMRHawkes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simulate an (bivariate) renewal Hawkes (MRHawkes) process
</h2>

<h3>Description</h3>

<p>Simulate an (bivairate) renewal Hawkes (MRHawkes) process with given renewal 
immigration distribution functions <code class="reqn">\mu</code>, offspring density functions 
<code class="reqn">h</code> and branching ratios <code class="reqn">\eta</code> using the cascading structure of the 
process.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simMRHawkes(re.dist1 = rweibull, par.redist1 = list(shape = 3, scale = 1.2), 
            re.dist2 = rweibull, par.redist2 = list(shape = 1/3, scale = 0.2), 
            h1.fn = function(x, p.h1) 1/p.h1 * exp(-x/p.h1), 
            h2.fn = function(x, p.h2) 1/p.h2 * exp(-x/p.h2), 
            p.h1 = 1, p.h2 = 1, 
            eta11 = 0.3, eta12 = 0.1, eta21 = 0.1, eta22 = 0.3, cens = 100, 
            B = 10, B0 = 50, 
            max.h1 = max(optimize(h1.fn, c(0, cens), maximum = TRUE, p = p.h1)$obj, 
                         h1.fn(0, p.h1), h1.fn(cens, p.h1)) * 1.1, 
            max.h2 = max(optimize(h2.fn, c(0, cens), maximum = TRUE, p = p.h2)$obj, 
                         h2.fn(0, p.h2), h2.fn(cens, p.h2)) * 1.1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>re.dist1</code></td>
<td>

<p>The renewal distribution for type one events.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>re.dist2</code></td>
<td>

<p>The renewal distribution for type two events.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par.redist1</code></td>
<td>

<p>A numeric list. The parameters of the renewal distribution for type one 
events.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par.redist2</code></td>
<td>

<p>A numeric list. The parameters of the renewal distribution for type two 
events.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h1.fn</code></td>
<td>

<p>A (vectorized) function. The offspring density function for type one 
events.    
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h2.fn</code></td>
<td>

<p>A (vectorized) function. The offspring density function for type two 
events.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.h1</code></td>
<td>

<p>A numeric vector. The paramters of the offspring density for type one 
events.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.h2</code></td>
<td>

<p>A numeric vector. The paramters of the offspring density for type two 
events.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta11</code></td>
<td>

<p>A numeric scalar. The self-exciting branching ratio for type one events.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta12</code></td>
<td>

<p>A numeric scalar. The cross-exciting branching ratio for type one events due 
to the effects of a type two event.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta21</code></td>
<td>

<p>A numeric scalar. The cross-exciting branching ratio for type two events due 
to the effects of a type one event.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta22</code></td>
<td>

<p>A numeric scalar. The self-exciting branching ratio for type two events.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cens</code></td>
<td>

<p>A scalar. The censoring time. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>

<p>A numeric scalar. Tuning parameter
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B0</code></td>
<td>

<p>A numeric scalar. Tuning parameter
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.h1</code></td>
<td>

<p>A numeric scalar. The maximum value of the offspring density for 
type one events.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.h2</code></td>
<td>

<p>A numeric scalar. The maximum value of the offspring density for 
type two events.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function works by simulating the arrival times of immigrants
accoridng to the respective renewal immigration distribution for each event 
type. The birth times ofoffspring from each immigrant are then simulated 
according to an non-stationary multivariate Hawkes Process (NSMHP) with 
appropriate baseline and excitation functions.
</p>


<h3>Value</h3>

<p>A numeric matrix. The row coloumn contains the event times in ascending 
order while the second coloumn contains the corresponding event type.
</p>


<h3>Author(s)</h3>

<p>Tom Stindl &lt;t.stindl@unsw.edu.au&gt;
Feng Chen &lt;feng.chen@unsw.edu.au&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">  B &lt;- 10; i &lt;- 0;
  data &lt;- replicate(B, 
                    {cat(i&lt;&lt;-i+1,'\n'); 
                    simMRHawkes(re.dist1 = rweibull, 
                                par.redist1 = list(shape = 3, scale = 1.2),
                                re.dist2 = rweibull, 
                                par.redist2 = list(shape = 1 / 3, scale = 0.2),
                                p.h1 = 1, p.h2 = 1,
                                eta11 = 0.3, eta12 = 0.1, 
                                eta21 = 0.1, eta22 = 0.3,
                                cens = 100)
                    })
</code></pre>


</div>