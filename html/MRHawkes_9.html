<div class="container">

<table style="width: 100%;"><tr>
<td>simpred</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simulate a fitted (bivariate) MRHawkes process model
</h2>

<h3>Description</h3>

<p>Simulate a fitted bivariate MRHawkes process model after the censoring time 
<code>cens</code> to a future time point <code>cens.tilde</code> using the cascading 
structure of the process.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  simpred(data, par, cens, cens.tilde, 
          re.dist1 = rweibull, 
          par.redist1 = list(shape = par[1], scale = par[2]),
          re.dist2 = rweibull, 
          par.redist2 = list(shape = par[3], scale = par[4]),
          h1.fn = function(x, p.h1) 1 / p.h1 * exp( - x / p.h1),
          h2.fn = function(x, p.h2) 1 / p.h2 * exp( - x / p.h2),
          p.h1 = par[5], p.h2 = par[6],
          eta11 = par[7], eta12 = par[8], eta21 = par[9], eta22 = par[10],
          B = 10, B0 = 50, pnp1 = NULL,
          max.h1 = max(optimize(h1.fn, c(0, cens.tilde - cens), maximum = TRUE,
                               p = p.h1)$obj, h1.fn(0, p.h1), 
                      h1.fn(cens.tilde - cens, p.h1)) * 1.1,
          max.h2 = max(optimize(h2.fn, c(0, cens.tilde - cens), maximum = TRUE,
                               p = p.h2)$obj, h2.fn(0, p.h2), 
                      h2.fn(cens.tilde - cens, p.h2)) * 1.1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>A two column matrix. The first column contains the event times sorted in 
ascending order. The second column contains the corresponding event type
with the label one or two.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>

<p>A numeric vector. Contains the ten parameters of the model, in order of 
the immigration parameters <code class="reqn">\mu(.)</code> for the two renewal distributions, 
the two offspring parameters <code class="reqn">h(.)</code> and lastly the four branching 
ratios <code class="reqn">\eta</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cens</code></td>
<td>

<p>A scalar. The censoring time.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cens.tilde</code></td>
<td>

<p>A scalar. The time that the simulation run uptil. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>re.dist1</code></td>
<td>

<p>The renewal distribution for type one events.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>re.dist2</code></td>
<td>

<p>The renewal distribution for type two events.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par.redist1</code></td>
<td>

<p>A numeric list. The parameters of the renewal distribution for type one 
events.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par.redist2</code></td>
<td>

<p>A numeric list. The parameters of the renewal distribution for type two 
events.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h1.fn</code></td>
<td>

<p>A (vectorized) function. The offspring density function for type one 
events. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h2.fn</code></td>
<td>

<p>A (vectorized) function. The offspring density function for type two 
events. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.h1</code></td>
<td>

<p>A numeric vector. The paramters of the offspring density for type one 
events.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.h2</code></td>
<td>

<p>A numeric vector. The paramters of the offspring density for type two 
events.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta11</code></td>
<td>

<p>A numeric scalar. The self-exciting branching ratio for type one events.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta12</code></td>
<td>

<p>A numeric scalar. The cross-exciting branching ratio for type one events due 
to the effects of a type two event.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta21</code></td>
<td>

<p>A numeric scalar. The cross-exciting branching ratio for type two events due 
to the effects of a type one event.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta22</code></td>
<td>

<p>A numeric scalar. The self-exciting branching ratio for type two events.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>

<p>A numeric scalar. Tuning parameter
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B0</code></td>
<td>

<p>A numeric scalar. Tuning parameter
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pnp1</code></td>
<td>

<p>A numeric square matrix. The joint last immigrant probabilities. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.h1</code></td>
<td>

<p>A numeric scalar. The maximum value of the offspring density for 
type one events.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.h2</code></td>
<td>

<p>A numeric scalar. The maximum value of the offspring density for 
for type two events.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A numeric matrix that contains the simulated event times from censoring time 
<code>cens</code> up until <code>cens.tilde</code> and the corresponding event types.
</p>


<h3>Author(s)</h3>

<p>Tom Stindl &lt;t.stindl@unsw.edu.au&gt;
Feng Chen &lt;feng.chen@unsw.edu.au&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">  
    ## Magnitude 5.5 or greater earthquakes over the 25 year period from 
    ## 01/01/1991 to 31/12/2015.
    data(fivaqks); 
    near.fiji &lt;- grep("Fiji", fivaqks$place)
    near.vanuatu &lt;- grep("Vanuatu", fivaqks$place)
    t.beg &lt;- strptime("1991-01-01 00:00:00", "%Y-%m-%d %H:%M:%S", tz = "UTC")
    t.end &lt;- strptime("2015-12-31 23:59:59", "%Y-%m-%d %H:%M:%S", tz = "UTC")
    t0 &lt;- 0
    t1 &lt;- as.numeric(t.end - t.beg)
    tms &lt;- strptime(fivaqks$time, "%Y-%m-%dT%H:%M:%OSZ", tz = "UTC")
    ts &lt;- as.numeric(tms[-1] - t.beg)
    ts &lt;- c(as.numeric(tms[1] - t.beg)/24, ts)
    ts.fi &lt;- ts[near.fiji]; ts.fi &lt;- ts.fi[ts.fi &gt;= 0 &amp; ts.fi &lt;= t1]
    ts.va &lt;- ts[near.vanuatu]; ts.va &lt;- ts.va[ts.va &gt;=0 &amp; ts.va &lt;= t1]
    ts.c &lt;- c(ts.fi, ts.va)
    z.c &lt;- c(rep(1, times = length(ts.fi)), rep(2, times = length(ts.va)))
    o &lt;- order(ts.c)
    data &lt;- cbind(ts.c[o], z.c[o])
    # simulate future event time based on MLE fitted Rhawkes model
    N &lt;- 100; i &lt;- 0;
    data.pred &lt;- replicate(N, 
                          {cat(i&lt;&lt;-i+1,'\n'); 
                          simpred(data = data,
                                    par = c(0.488, 20.10, 0.347, 9.53, 
                                            461, 720,
                                            0.472, 0.293, 0.399, -0.0774), 
                                            cens = t1, cens.tilde = t1 + 1000)
                                            })
  
</code></pre>


</div>