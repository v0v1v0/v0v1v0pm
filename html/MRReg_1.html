<div class="container">

<table style="width: 100%;"><tr>
<td>FindMaxHomoOptimalPartitions</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>FindMaxHomoOptimalPartitions</h2>

<h3>Description</h3>

<p>FindMaxHomoOptimalPartitions is a main function for inferring optimal homogeneous clusters from a multiresolution dataset <code>DataT</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">FindMaxHomoOptimalPartitions(
  DataT,
  gamma = 0.05,
  insigThs = 1e-08,
  alpha = 0.05,
  minInvs = 99,
  polyDegree = 1,
  expFlag = FALSE,
  messageFlag = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>DataT</code></td>
<td>
<p>contains a multiresolution dataset s.t.
<code>DataT$X[i,d]</code> is a value of feature <code>d</code> of individual <code>i</code>,
<code>DataT$Y[i]</code> is value of target variable of individual <code>i</code> that we want to fit <code>DataT$Y ~ DataT$X</code> in linear model, and
<code>clsLayer[i,j]</code> is a cluster ID of individual <code>i</code> at layer <code>j</code>; <code>clsLayer[i,1]</code> is the first layer that everyone typically belongs to a single cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>is a threshold to ...</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>insigThs</code></td>
<td>
<p>is a threshold to determine whether a magnitude of a feature coefficient is enough so that the feature is designated as a selected feature.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>is a significance level to determine whether a magnitude of a feature coefficient is enough so that the feature is designated as a selected feature.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minInvs</code></td>
<td>
<p>is a minimum number of individuals for a cluster to be considered for inferring eta(C)cv, otherwise, eta(C)cv=0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>polyDegree</code></td>
<td>
<p>is a degree of polynomial function that is used to fit the data.
If it is greater than 1, the polynomial formula is used in <code>lm()</code> instead of <code>"y=."</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expFlag</code></td>
<td>
<p>is an exponential flag to control the formula for data fitting.
If it is true, then the exp() formula is used in <code>lm()</code> instead of <code>"y=."</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>messageFlag</code></td>
<td>
<p>is a flag. If it is true, the function shows the text regarding the progress of computing.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>This function returns <code>Copt</code>, <code>models</code>, <code>nNodes</code>,  <code>invOptCls</code>, and <code>minR2cv</code>.
</p>
<table>
<tr style="vertical-align: top;">
<td><code> Copt </code></td>
<td>
  <p><code>Copt[p,1]</code> is equal to <code>k</code> implies a cluster that is a pth member of the maximal homogeneous partition is at kth layer and the cluster name in kth layer is <code>Copt[p,2]</code> <code>Copt[p,3]</code> is "Model Information Reduction Ratio" <code>I({C},H0,Hlin)</code> of <code>p</code>th member of the maximal homogeneous partition: positive means the linear model is better than the null model.
Lastly,<code>Copt[p,4]</code> is the squared correlation between predicted and real Y in CV step ( eta(C)cv ) of pth member of the maximal homogeneous partition. The greater <code>Copt[p,4]</code>, the higher homogeneous degree of this cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> clustInfoRecRatio </code></td>
<td>
 <p><code>models[[k]][[j]]$clustInfoRecRatio</code> is the "Cluster Information Reduction Ratio"  <code>I(Cj,Cjchildren,H)</code> between the <code>j</code>th cluster in <code>k</code>th layer
and its children clusters in <code>(k+1)</code>th layer: positive means current cluster is better than its children clusters. Hence, we should keep this cluster at the member of maximal homogeneous partition instead of its children.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> models </code></td>
<td>
 <p><code>models[[j]][[k]]</code> is a linear model of a cluster ID <code>k</code> at the layer <code>j</code>.
The <code>models[[j]][[k]]$selFeatureSet</code> represents a set of selected-feature indices of the model where the feature index 1 is the intercept,
and the feature index <code>d</code> is the (d-1)th variable <code>DataT$X[,d-1]</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>invOptCls </code></td>
<td>
 <p><code>invOptCls[i,1]</code> is the layer of optimal cluster of individual <code>i</code>. The optimal cluster of <code>i</code> is <code>invOptCls[i,2]</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minR2cv</code></td>
<td>
<p> is the value of eta(C)cv from the cluster that has the lowest eta(C)cv.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DataT</code></td>
<td>
<p>is an updated <code>DataT</code> with the helper variables for plotting and printing results.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R"># Running FindMaxHomoOptimalPartitions using simulation data
DataT&lt;-SimpleSimulation(100,type=1)
obj&lt;-FindMaxHomoOptimalPartitions(DataT,gamma=0.05)

</code></pre>


</div>