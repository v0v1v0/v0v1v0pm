<div class="container">

<table style="width: 100%;"><tr>
<td>andova</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multi Resolution Scanning for one-way ANDOVA using the multi-scale Beta-Binomial model</h2>

<h3>Description</h3>

<p>This function executes the Multi Resolution Scanning algorithm to detect differences
across the distributions of multiple groups having multiple replicates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">andova(X, G, H, n_groups = length(unique(G)), n_subgroups = NULL,
  Omega = "default", K = 6, init_state = c(0.8, 0.2, 0), beta = 1,
  gamma = 0.07, delta = 0.4, eta = 0, alpha = 0.5,
  nu_vec = 10^(seq(-1, 4)), return_global_null = TRUE, return_tree = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Matrix of the data. Each row represents an observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>Numeric vector of the group label of each observation. Labels are integers starting from 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>Numeric vector of the replicate label of each observation. Labels are integers starting from 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_groups</code></td>
<td>
<p>Number of groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_subgroups</code></td>
<td>
<p>Vector indicating the number of replicates for each grop.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Omega</code></td>
<td>
<p>Matrix defining the vertices of the sample space.
The <code>"default"</code> option defines a hyperrectangle containing all the data points.
Otherwise the user can define a matrix  where each row represents a dimension,  and the two columns contain the associated lower and upper limit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Depth of the tree. Default is <code>K = 6</code>, while the maximum is <code>K = 14</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init_state</code></td>
<td>
<p>Initial state of the hidden Markov process.
The three states are <em>null</em>, <em>altenrative</em> and <em>prune</em>, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Spatial clustering parameter of the transition probability matrix. Default is <code>beta = 1.0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>Parameter of the transition probability matrix. Default is <code>gamma = 0.07</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>Parameter of the transition probability matrix. Default is <code>delta = 0.4</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>
<p>Parameter of the transition probability matrix. Default is <code>eta = 0.0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Pseudo-counts of the Beta random probability assignments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu_vec</code></td>
<td>
<p>The support of the discrete uniform prior on nu.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_global_null</code></td>
<td>
<p>Boolean indicating whether to return the marginal posterior probability of the global null.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_tree</code></td>
<td>
<p>Boolean indicating whether to return the posterior representative tree.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An <code>mrs</code> object.
</p>


<h3>References</h3>

<p>Ma L. and Soriano J. (2018).
Analysis of distributional variation through multi-scale Beta-Binomial modeling.
<em>Journal of Computational and Graphical Statistics. Vol. 27, No. 3, 529-541.</em>.
<a href="https://doi.org/10.1080/10618600.2017.1402774">doi:10.1080/10618600.2017.1402774</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
n = 1000
M = 5
class_1 = sample(M, n, prob= 1:5, replace=TRUE  )
class_2 = sample(M, n, prob = 5:1, replace=TRUE )

Y_1 = rnorm(n, mean=class_1, sd = .2)
Y_2 = rnorm(n, mean=class_2, sd = .2)

X = matrix( c(Y_1, Y_2), ncol = 1)
G = c(rep(1,n),rep(2,n))
H = sample(3,2*n, replace = TRUE  )

ans = andova(X, G, H)
ans$PostGlobNull
plot1D(ans)
</code></pre>


</div>