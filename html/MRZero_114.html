<div class="container">

<table style="width: 100%;"><tr>
<td>mr_pivw</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Penalized inverse-variance weighted method</h2>

<h3>Description</h3>

<p>The <code>mr_pivw</code> function implements the penalized inverse-variance weighted (pIVW) method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mr_pivw(
  object,
  lambda = 1,
  over.dispersion = TRUE,
  delta = 0,
  sel.pval = NULL,
  Boot.Fieller = TRUE,
  alpha = 0.05
)

## S4 method for signature 'MRInput'
mr_pivw(
  object,
  lambda = 1,
  over.dispersion = TRUE,
  delta = 0,
  sel.pval = NULL,
  Boot.Fieller = TRUE,
  alpha = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An <code>MRInput</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>The penalty parameter in the pIVW estimator. It plays a role in the bias-variance trade-off of the estimator. It is recommended to choose <code>lambda=1</code> to achieve the smallest bias and valid inference. By default, <code>lambda=1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>over.dispersion</code></td>
<td>
<p>Should the method consider overdispersion (balanced horizontal pleiotropy)? Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>The z-score threshold for IV selection. <code>delta</code> should be greater than or equal to zero. By default, <code>delta=0</code> (i.e., no IV selection will be conducted).  See 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sel.pval</code></td>
<td>
<p>A numeric vector containing the P-values of the SNP effects on the exposure, which will be used for the IV selection. <code>sel.pval</code> should be provided when <code>delta</code> is not zero. See 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Boot.Fieller</code></td>
<td>
<p>If <code>Boot.Fieller=TRUE</code>, then the P-value and the confidence interval of the causal effect will be calculated based on the bootstrapping Fieller method. Otherwise, the P-value and the confidence interval of the causal effect will be calculated from the normal distribution. It is recommended to use the bootstrapping Fieller method when <code>Condition</code> is smaller than 10 (see 'Details'). By default, <code>Boot.Fieller=TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The significance level used to calculate the confidence intervals. The default value is 0.05.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The penalized inverse-variance weighted (pIVW) estimator accounts for weak instruments and balanced horizontal pleiotropy simultaneously
in two-sample MR with summary statistics, i.e., an exposure sample (with IV-exposure effect <code>Bx</code> and standard error <code>Bxse</code>) and
an outcome sample (with IV-outcome effect <code>By</code> and standard error <code>Byse</code>).
</p>
<p>The pIVW estimator also allows for IV selection in three-sample MR, where weak IVs are screened out using
an extra sample (with IV-exposure effect <code>Bx*</code> and standard error <code>Bxse*</code>) independent of the exposure sample and outcome sample.
Generally, the P-value for <code>Bx*</code> can be computed by <code>sel.pval=2*pnorm(abs(Bx*/Bxse*), lower.tail = FALSE)</code>,
Given <code>sel.pval</code> and a z-score threshold <code>delta</code>, the variants kept in the analysis will be those
with <code>sel.pval&lt;2*pnorm(delta,lower.tail = FALSE)</code>.
</p>
<p>The <code>mr_pivw</code> function outputs a measure <code>Condition</code> that needs to be large for reliable asymptotic properties of the pIVW estimator.
We also refer to <code>Condition</code> as effective sample size, which is a function of a measure of IV strength and the number of IVs.
When <code>delta</code> is zero (i.e., no IV selection), <code>Condition = (average F-statistic -1)*sqrt(# snps)</code>. When <code>delta</code> is not zero
(i.e., IV selection is conducted), <code>Condition = [(average F-statistic -1)*sqrt(# snps)]/c</code>,
where the numerator is computed using the selected variants, and the denominator <code>c</code> involves the selection probabilities
of all variants (see more details in the paper). We suggest that <code>Condition</code> should be greater than 5 for the pIVW estimator to achieve reliable asymptotic properties.
</p>


<h3>Value</h3>

<p>The output from the function is a <code>PIVW</code> object containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Over.dispersion</code></td>
<td>
<p><code>TRUE</code> if the method has considered balanced horizontal pleiotropy, <code>FALSE</code> otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Boot.Fieller</code></td>
<td>
<p><code>TRUE</code> if the bootstrapping Fieller method is used to calculate the P-value and the confidence interval of the causal effect, <code>FALSE</code> otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lambda</code></td>
<td>
<p>The penalty parameter in the pIVW estimator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Delta</code></td>
<td>
<p>The z-score threshold for IV selection.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Exposure</code></td>
<td>
<p>A character string giving the name given to the exposure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Outcome</code></td>
<td>
<p>A character string giving the name given to the outcome.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Estimate</code></td>
<td>
<p>The causal point estimate from the pIVW estimator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>StdError</code></td>
<td>
<p>The standard error associated with <code>Estimate</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CILower</code></td>
<td>
<p>The lower bound of the confidence interval for <code>Estimate</code>, which is derived from the bootstrapping Fieller method or normal distribution. For the bootstrapping Fieller's interval, if it contains multiple ranges, then lower limits of all ranges will be reported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CIUpper</code></td>
<td>
<p>The upper bound of the confidence interval for <code>Estimate</code>, which is derived from the bootstrapping Fieller method or normal distribution. For the bootstrapping Fieller's interval, if it contains multiple ranges, then upper limits of all ranges will be reported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Alpha</code></td>
<td>
<p>The significance level used in constructing the confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pvalue</code></td>
<td>
<p>P-value associated with the causal estimate from the pIVW estimator, which is derived from the bootstrapping Fieller method or normal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tau2</code></td>
<td>
<p>The variance of the balanced horizontal pleiotropy. <code>Tau2</code> is calculated by using all IVs in the data before conducting the IV selection.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SNPs</code></td>
<td>
<p>The number of SNPs after IV selection.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Condition</code></td>
<td>
<p>The estimated effective sample size. It is recommended to be greater than 5 for the pIVW estimator to achieve reliable asymptotic properties. See 'Details'.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Xu S., Wang P., Fung W.K. and Liu Z. (2022). A Novel Penalized Inverse-Variance Weighted Estimator for Mendelian Randomization with Applications to COVID-19 Outcomes. Biometrics. doi: 10.1111/biom.13732.
</p>


<h3>Examples</h3>

<pre><code class="language-R">mr_pivw(mr_input(bx = ldlc, bxse = ldlcse, by = chdlodds, byse = chdloddsse))

</code></pre>


</div>