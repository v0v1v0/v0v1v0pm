<div class="container">

<table style="width: 100%;"><tr>
<td>mr_cML</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Constrained maximum likelihood (cML) method</h2>

<h3>Description</h3>

<p>Constrained maximum likelihood (cML) based Mendelian
Randomization method robust to both 
correlated and uncorrelated pleiotropy.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mr_cML(
  object,
  MA = TRUE,
  DP = TRUE,
  K_vec = 0:(length(object@betaX) - 2),
  random_start = 0,
  num_pert = 200,
  random_start_pert = 0,
  maxit = 100,
  random_seed = 314,
  n,
  Alpha = 0.05
)

## S4 method for signature 'MRInput'
mr_cML(
  object,
  MA = TRUE,
  DP = TRUE,
  K_vec = 0:(length(object@betaX) - 2),
  random_start = 0,
  num_pert = 200,
  random_start_pert = 0,
  maxit = 100,
  random_seed = 314,
  n,
  Alpha = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An <code>MRInput</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MA</code></td>
<td>
<p>Whether model average is applied or not. Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DP</code></td>
<td>
<p>Whether data perturbation is applied or not. Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K_vec</code></td>
<td>
<p>Set of candidate K's, the constraint parameter 
representing number of invalid IVs. Default is from 0 to (#IV - 2).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random_start</code></td>
<td>
<p>Number of random starting points for cML, default is 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_pert</code></td>
<td>
<p>Number of perturbation when DP is TRUE, default is 200.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random_start_pert</code></td>
<td>
<p>Number of random start points for 
cML with data perturbation, default is 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>Maximum number of iterations for each optimization. 
Default is 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random_seed</code></td>
<td>
<p>Random seed, default is 314. When <code>random_seed=NULL</code>, no random seed 
will be used and the results may not be reproducible.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Sample size. When sample sizes of GWAS for exposure and outcome are different,
and/or when sample sizes of different SNPs are different, 
the smallest sample size is recommended to get conservative result and avoid type-I error.
See reference for more discussions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Alpha</code></td>
<td>
<p>Significance level for the confidence interval for estimate, default is 0.05.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The MRcML method selects invalid IVs with correlated
and/or uncorrelated peliotropic effects using constrained maximum
likelihood. <code>cML-BIC</code> gives results of the selected model with 
original data, while <code>cML-MA-BIC</code> averages over all candidate models.
<code>cML-BIC-DP</code> and <code>cML-MA-BIC-DP</code> are the versions with 
data-perturbation to account for selection uncertainty when 
many invalid IVs have weak pleiotropic effects. 
</p>
<p>When DP is performed,
two goodness-of-fit (GOF) tests are developed to check whether the 
model-based and DP- based variance estimates converge to the same estimate.
Small p-values of GOF tests indicate selection uncertainty is not ignorable, and 
results from DP is more reliable. See reference for more details.
</p>
<p>As the constrained maximum likelihood function is non-convex, multiple
random starting points could be used to find a global minimum. For some 
starting points the algorithm may not converge and a warning message will 
be prompted, typically this will not affect the results.
</p>


<h3>Value</h3>

<p>The output from the function is an <code>MRcML</code> object containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Exposure</code></td>
<td>
<p>A character string giving the name given to the exposure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Outcome</code></td>
<td>
<p>A character string giving the name given to the outcome.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Estimate</code></td>
<td>
<p>Estimate of theta.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>StdError</code></td>
<td>
<p>Standard error of estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pvalue</code></td>
<td>
<p>p-value of estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BIC_invalid</code></td>
<td>
<p>Set of selected invalid IVs if cML-BIC is performed, i.e. without MA or DP.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GOF1_p</code></td>
<td>
<p>p-value of the first goodness-of-fit test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GOF2_p</code></td>
<td>
<p>p-value of the second goodness-of-fit test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SNPs</code></td>
<td>
<p>The number of SNPs that were used in the calculation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Alpha</code></td>
<td>
<p>Significance level for the confidence interval for estimate, default is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CILower</code></td>
<td>
<p>Lower bound of the confidence interval for estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CIUpper</code></td>
<td>
<p>Upper bound of the confidence interval for estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MA</code></td>
<td>
<p>Indicator of whether model average is applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DP</code></td>
<td>
<p>Indicator of whether data perturbation is applied.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Xue, H., Shen, X., &amp; Pan, W. (2021). 
Constrained maximum likelihood-based Mendelian randomization 
robust to both correlated and uncorrelated pleiotropic effects. 
The American Journal of Human Genetics, 108(7), 1251-1269.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Perform cML-MA-BIC-DP:
mr_cML(mr_input(bx = ldlc, bxse = ldlcse, by = chdlodds,
byse = chdloddsse), num_pert=5, MA = TRUE, DP = TRUE, n = 17723)
# num_pert is set to 5 to reduce computational time
# the default value of 200 is recommended in practice

# Perform cML-BIC-DP:
mr_cML(mr_input(bx = ldlc, bxse = ldlcse, by = chdlodds,
byse = chdloddsse), MA = TRUE, DP = FALSE,, n = 17723)
   

</code></pre>


</div>