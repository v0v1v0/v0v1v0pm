<div class="container">

<table style="width: 100%;"><tr>
<td>mr_mbe</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mode-based method of Hartwig</h2>

<h3>Description</h3>

<p>The <code>mr_mbe</code> function implements the mode-based method introduced by Hartwig, Bowden and Davey Smith (2017).
</p>


<h3>Usage</h3>

<pre><code class="language-R">mr_mbe(
  object,
  weighting = "weighted",
  stderror = "simple",
  phi = 1,
  seed = 314159265,
  iterations = 10000,
  distribution = "normal",
  alpha = 0.05
)

## S4 method for signature 'MRInput'
mr_mbe(
  object,
  weighting = "weighted",
  stderror = "delta",
  phi = 1,
  seed = 314159265,
  iterations = 10000,
  distribution = "normal",
  alpha = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An <code>MRInput</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weighting</code></td>
<td>
<p>Whether the analysis should be <code>"weighted"</code> (the default option) or <code>"unweighted"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stderror</code></td>
<td>
<p>Whether standard error estimates should be i) <code>"simple"</code> - calculated as the first-order term from the delta expansion - standard error of the association with the outcome divided by the association with the exposure), or ii) <code>"delta"</code> - calculated as the second-order term from the delta expansion (the default option). The second-order term incorporates uncertainty in the genetic association with the exposure â€“ this uncertainty is ignored using the simple weighting. The <code>"simple"</code> option is referred to by Hartwig et al as "assuming NOME", and the <code>"delta"</code> option as "not assuming NOME".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>The choice of bandwidth in the kernel-smoothly density method. A value of 1 (the default value) represents the bandwidth value selected by the modified Silverman's bandwidth rule, as recommended by Hartwig et al. A value of 0.5 represents half that value, and so on.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>The random seed to use when generating the bootstrap samples used to calculate the confidence intervals (for reproducibility). The default value is 314159265. If set to <code>NA</code>, the random seed will not be set (for example, if the function is used as part of a larger simulation).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p>Number of iterations to use in the bootstrap procedure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distribution</code></td>
<td>
<p>The type of distribution used to calculate the confidence intervals, can be <code>"normal"</code> (the default option) or <code>"t-dist"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The significance level used to calculate the confidence interval. The default value is 0.05.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The mode-based estimation (MBE) method takes the variant-specific ratio estimates from each genetic variant in turn, and calculates the modal estimate. This is implemented by constructing a kernel-smoothed density out of the ratio estimates, and taking the maximum value as the modal estimate. The standard error is calculated by a bootstrap procedure, and confidence intervals based on the estimate having a normal distribution.
</p>
<p>The method should give consistent estimates as the sample size increases if a plurality (or weighted plurality) of the genetic variants are valid instruments. This means that the largest group of variants with the same causal estimate in the asymptotic limit are the valid instruments.
</p>


<h3>Value</h3>

<p>The output from the function is an <code>MRMBE</code> object containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Exposure</code></td>
<td>
<p>A character string giving the name given to the exposure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Outcome</code></td>
<td>
<p>A character string giving the name given to the outcome.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Weighting</code></td>
<td>
<p>A character string <code>"weighted"</code> or <code>"unweighted"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>StdErr</code></td>
<td>
<p>A character string <code>"simple"</code> or <code>"delta"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Phi</code></td>
<td>
<p>The value of the bandwidth factor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Estimate</code></td>
<td>
<p>The value of the causal estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>StdError</code></td>
<td>
<p>Standard error of the causal estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CILower</code></td>
<td>
<p>The lower bound of the causal estimate based on the estimated standard error and the significance level provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CIUpper</code></td>
<td>
<p>The upper bound of the causal estimate based on the estimated standard error and the significance level provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Alpha</code></td>
<td>
<p>The significance level used when calculating the confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pvalue</code></td>
<td>
<p>The p-value associated with the estimate (calculated as Estimate/StdError as per Wald test) using a normal or t-distribution (as specified in <code>distribution</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SNPs</code></td>
<td>
<p>The number of genetic variants (SNPs) included in the analysis.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Fernando Pires Hartwig, George Davey Smith, Jack Bowden. Robust inference in summary data Mendelian randomization via the zero modal pleiotropy assumption. International Journal of Epidemiology 2017; 46(6): 1985-1998. doi: 10.1093/ije/dyx102.
</p>


<h3>Examples</h3>

<pre><code class="language-R">mr_mbe(mr_input(bx = ldlc, bxse = ldlcse, by = chdlodds, byse = chdloddsse), iterations=100)
mr_mbe(mr_input(bx = ldlc, bxse = ldlcse, by = chdlodds, byse = chdloddsse),
   phi=0.5, iterations=100)
mr_mbe(mr_input(bx = ldlc, bxse = ldlcse, by = chdlodds, byse = chdloddsse),
   weighting="weighted", stderror="delta", iterations=100)
# iterations set to 100 to reduce computational time,
#  more iterations are recommended in practice

</code></pre>


</div>