<div class="container">

<table style="width: 100%;"><tr>
<td>improveSynth</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Check (and Improve) Results of Package Synth</h2>

<h3>Description</h3>

<p><code>improveSynth</code> checks the results of <code>synth</code>
for feasibility and optimality and tries to find a better solution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">improveSynth(
  synth.out,
  dataprep.out,
  lb = 1e-08,
  tol = 1e-05,
  verbose = TRUE,
  seed = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>synth.out</code></td>
<td>
<p>A result of <code>synth</code> from package 
<code>'Synth'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataprep.out</code></td>
<td>
<p>The input of function <code>synth</code> which
led to <code>synth.out</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lb</code></td>
<td>
<p>A numerical scalar (default: <code>1e-8</code>), corresponding to the
lower bound for the outer optimization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>A numerical scalar (default: <code>1e-5</code>). If the relative *and*
absolute improvement of <code>loss.v</code> and <code>loss.w</code>, respectively,
exceed <code>tol</code>, this is reported 
(if <code>verbose</code> is <code>TRUE</code>). Better optima are always looked for 
(independent of the value of <code>tol</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A logical scalar. Should the ouput be verbose (defaults to 
<code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>A numerical vector or <code>NULL</code>. See the corresponding
documentation for <code>mscmt</code>. Defaults to 1 in order to
provide reproducibility of the results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to <code>mscmt</code>. Supported 
arguments are <code>check.global</code>, <code>inner.optim</code>, <code>inner.opar</code>, 
<code>outer.optim</code>, and <code>outer.opar</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Performing SCM means solving a nested optimization problem. Depending on
the validity of the results of the inner optimization, SCM may produce
</p>

<ul>
<li>
<p> invalid or infeasible results, if the vector <code>w</code> of donor 
weights reported as the result of the inner optimization 
is in fact not optimal, ie. produces too large <code>loss.w</code>,
</p>
</li>
<li>
<p> suboptimal results, if the vector <code>v</code> of predictor weights 
reported as the result of the outer optimization is in fact not
optimal (which may be caused by shortcomings of the inner optimization).
</p>
</li>
</ul>
<p><code>improveSynth</code> first checks <code>synth.out</code> for feasibility and
then tries to find a feasible and optimal solution by applying the
optimization methods of package <code>MSCMT</code> to <code>dataprep.out</code> 
(with default settings, more flexibility will probably be added in a 
future release).
</p>


<h3>Value</h3>

<p>An updated version of <code>synth.out</code>, where <code>solution.v</code>,
<code>solution.w</code>, <code>loss.v</code>, and <code>loss.w</code> are replaced by the
optimum obtained by package <code>'MSCMT'</code> and all other components 
of <code>synth.out</code> are removed.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## check whether package 'Synth' is available
if (require("Synth")) {

## process first example of function "synth" in package 'Synth' 
## (comments are removed):

  data(synth.data)
  dataprep.out&lt;-
    dataprep(
     foo = synth.data,
     predictors = c("X1", "X2", "X3"),
     predictors.op = "mean",
     dependent = "Y",
     unit.variable = "unit.num",
     time.variable = "year",
     special.predictors = list(
        list("Y", 1991, "mean"),
        list("Y", 1985, "mean"),
        list("Y", 1980, "mean")
                              ),
     treatment.identifier = 7,
     controls.identifier = c(29, 2, 13, 17, 32, 38),
     time.predictors.prior = c(1984:1989),
     time.optimize.ssr = c(1984:1990),
     unit.names.variable = "name",
     time.plot = 1984:1996
     )

  synth.out &lt;- synth(dataprep.out)

## check and (try to) improve these results:
  synth2.out &lt;- improveSynth(synth.out,dataprep.out)
}

## End(Not run)
</code></pre>


</div>