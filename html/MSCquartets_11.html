<div class="container">

<table style="width: 100%;"><tr>
<td>expectedCFs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Produce table of expected quartet concordance factors for a species tree</h2>

<h3>Description</h3>

<p>Compiles table of expected quartet concordance factors (CFs) for gene trees under the MSC model 
on a metric species tree.
</p>


<h3>Usage</h3>

<pre><code class="language-R">expectedCFs(speciestree, plot = TRUE, model = "T1", cex = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>speciestree</code></td>
<td>
<p>phylo or character object specifying un/rooted metric species tree</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p><code>TRUE</code> (default) to produce simplex plot of CFs, or <code>FALSE</code> to omit plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>"T1" or "T3" specifying model for plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>scaling factor for size of plotted symbols</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The species tree may be rooted or unrooted, but must have edge lengths given in coalescent units. Note that while the MSC
requires a rooted metric species tree parameter, as shown in (Allman et al. 2011) the quartet CFs are independent 
of the root.
</p>
<p>In the returned table, columns are labeled by taxon names and quartet names ("12|34", etc.).
1s and 0s in taxon columns indicate the taxa in a quartet. Quartet 12|34 means the first and second 
indicated taxa form a cherry, 13|24 means the first and third form a cherry, and 14|23 means
the first and fourth form a cherry. Unresolved quartets always have expectation 0 under the MSC.
</p>
<p>If a simplex plot is produced, for the <code>T1</code> model all CFs will lie on the vertical model line, 
and many choices of 4 taxa will give the same CFs. For model <code>T3</code> the model lines the CFs are 
plotted on depend on taxon names and are essentially arbitrary.
</p>


<h3>Value</h3>

<p>an (<code>n</code> choose 4)x(<code>n</code>+3) matrix encoding
4 taxon subsets of taxa and expectation of each of the
quartets 12|34, 13|24, 14|23 across gene trees
</p>


<h3>References</h3>

<p>Allman ES, Degnan JH, Rhodes JA (2011).
“Identifying the rooted species tree from the distribution of unrooted gene trees under the coalescent.”
<em>Journal of Mathematical Biology</em>, <b>62</b>(6), 833–862.
<a href="https://doi.org/10.1007/s00285-010-0355-7">doi:10.1007/s00285-010-0355-7</a>.
</p>


<h3>See Also</h3>

<p><code>quartetTable</code>, <code>quartetTableResolved</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">stree="((((t5:5000,t6:5000):5000,t4:10000):2500,t7:12500):7500,((t8:3000,t9:3000):5000,
((t1:4000,t2:4000):2500,t3:6500):1500):12000);"
st=read.tree(text=stree)
st$edge.length=st$edge.length/10000
expectedCFs(st)

</code></pre>


</div>