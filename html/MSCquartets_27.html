<div class="container">

<table style="width: 100%;"><tr>
<td>quartetCutTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Hypothesis test for quartet counts fitting a resolved quartet tree of blobs under NMSC</h2>

<h3>Description</h3>

<p>Test the hypothesis H_0=Cut model of Allman et al. (2024),
Section 3., vs. H_1= everything else.
Returns p-value and estimate of tree of blobs topology.
</p>


<h3>Usage</h3>

<pre><code class="language-R">quartetCutTest(
  obs,
  lambda = 0,
  method = "MLest",
  smallcounts = "approximate",
  bootstraps = 10^4
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>
<p>vector of 3 counts of resolved quartet frequencies</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>parameter for power-divergence statistic (e.g., 0 for likelihood ratio statistic, 1 for Chi-squared statistic)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p><code>"MLtest"</code>,<code>"conservative"</code>, or <code>"bootstrap"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smallcounts</code></td>
<td>
<p><code>"bootstrap"</code> or <code>"approximate"</code>, method of obtaining p-value when some counts are small</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootstraps</code></td>
<td>
<p>number of samples for bootstrapping</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Cut model for quartet CFs is the NMSC combined with the quartet species network having
a cut edge separating two of the taxa from the other two.
</p>
<p>This function implements the test described in Allman et al. (2024)
as well as parametric bootstrapping,
with other procedures for when some expected counts are small.
These are more accurate tests than, say, a Chi-square with one degree of freedom,
which is not theoretically
justified near the singularity of the model, nor for small counts.
</p>
<p>If <code>method="MLtest"</code>, this uses the test for the Cut model described
in Section 3 of Allman et al. (2024), using the ML
estimate of the generating parameter.
As shown in simulations in that paper, the test is conservative when small
critical values are used for rejection.
Although the test generally performs well in practice, it lacks a uniform
asymptotic guarantee over the full parameter space.
</p>
<p>If <code>method="conservative"</code>, the test uses the Chi-square distribution with 1 degree of freedom
(the "least favorable" approach). This is asymptotically guaranteed to reject the null
hypothesis at most at a specified level, but at the expense of increased type II errors.
</p>
<p>If <code>method="bootstrap"</code>, then parametric bootstrapping is performed,
based on ML estimates of the CF. The bootstrap sample size is given by the <code>bootstrap</code> argument.
</p>
<p>When some expected topology counts are small, the methods <code>"MLest"</code> and <code>"conservative"</code>
are not appropriate.
The argument <code>smallcounts</code> determines whether bootstrapping or a faster approximate method is used.
These use ML estimates of the CF under the Cut model.
</p>
<p>If two of the three counts are small (so the estimated CF is near a vertex of the simplex),
The approximate approach
returns a precomputed p-value, found by replacing the largest observed count
with 1e+6 and performing 1e+8 bootstraps. When n is sufficiently large (at least 30) and
some expected counts are small, the probability of topological error  is small and the bootstrap p-value is
approximately independent of the largest observed count.
</p>
<p>If one of the three counts is small (so the estimated CF is near an edge of the simplex),
a chi-squared test using the binomial model for the larger counts is used, as described
by Allman et al. (2024).
</p>
<p>The returned p-value should be taken with caution when there is a small sample size, e.g. less than 30 gene trees.
</p>


<h3>Value</h3>

<p>output where <code>output$p.value</code> is a p-value and <code>output$topology</code> = 1, 2, or 3
indicates the ML estimate of the topology of the quartet tree of blobs in accord with ordering of qcCF entries.
</p>


<h3>References</h3>

<p>Allman ES, Baños H, Mitchell JD, Rhodes JA (2022).
“The tree of blobs of a species network: identifiability under the coalescent.”
<em>Journal of Mathematical Biology</em>, <b>86</b>(1), 10.
<a href="https://doi.org/10.1007/s00285-022-01838-9">doi:10.1007/s00285-022-01838-9</a>.
</p>
<p>Allman ES, Baños H, Mitchell JD, Rhodes JA (2024).
“TINNiK: Inference of the Tree of Blobs of a Species Network Under the Coalescent.”
<em>bioRxiv</em>.
<a href="https://doi.org/10.1101/2024.04.20.590418">doi:10.1101/2024.04.20.590418</a>, <a href="https://www.biorxiv.org/content/10.1101/2024.04.20.590418v1">https://www.biorxiv.org/content/10.1101/2024.04.20.590418v1</a>.
</p>
<p>Mitchell J, Allman ES, Rhodes JA (2019).
“Hypothesis testing near singularities and boundaries.”
<em>Electron. J. Statist.</em>, <b>13</b>(1), 2150-2193.
<a href="https://doi.org/10.1214/19-EJS1576">doi:10.1214/19-EJS1576</a>.
</p>


<h3>See Also</h3>

<p><code>quartetCutTestInd</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> quartetCutTest(c(17,72,11))
 quartetCutTest(c(48,11,41))
 quartetCutTest(c(11,48,41))
 quartetCutTest(c(48,41,11))

</code></pre>


</div>