<div class="container">

<table style="width: 100%;"><tr>
<td>quartetTreeTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Hypothesis test for quartet counts fitting a tree under the MSC</h2>

<h3>Description</h3>

<p>Test the hypothesis H_0= T1 or T3 model of Mitchell et al. (2019), vs. H_1 = everything else.
T1 is for a specific species quartet topology, and T3 for any species quartet topology.
</p>


<h3>Usage</h3>

<pre><code class="language-R">quartetTreeTest(
  obs,
  model = "T3",
  lambda = 0,
  method = "MLest",
  smallsample = "precomputed",
  smallcounts = "precomputed",
  bootstraps = 10^4
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>
<p>vector of 3 counts of resolved quartet frequencies</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p><code>"T1"</code> or <code>"T3"</code>, for the models of Mitchell et al. (2019)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>parameter for power-divergence statistic (e.g., 0 for likelihood ratio statistic, 1 for Chi-squared statistic)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p><code>"MLtest"</code>,<code>"conservative"</code>, or <code>"bootstrap"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smallsample</code></td>
<td>
<p><code>"precomputed"</code> or <code>"bootstrap"</code>, method of obtaining p-value when sample is small (&lt;30)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smallcounts</code></td>
<td>
<p><code>"precomputed"</code> or <code>"bootstrap"</code>, method of obtaining p-value when some (but not all) counts are small</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootstraps</code></td>
<td>
<p>number of samples for bootstrapping</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function implements two of
the versions of the test given by Mitchell et al. (2019) as well as parametric
bootstrapping, with other procedures for when some expected counts are small.
When the topology and/or the internal
quartet branch length is not specified by the null hypothesis these are more accurate tests than,
say, a Chi-square with one degree of freedom, which is not theoretically
justified near the singularities and boundaries of the models.
</p>
<p>If <code>method="MLtest"</code>, this uses the test by that name described in Section 7 of Mitchell et al. (2019).
For both the T1 and T3 models the test is slightly anticonservative over a small range of true internal edges of the quartet species tree.
Although the test generally performs well in practice, it lacks a uniform asymptotic guarantee over
the full parameter space for either T1 or T3.
</p>
<p>If <code>method="conservative"</code>, a conservative test described by Mitchell et al. (2019) is used. For model T3 this
uses the Chi-square distribution with 1 degree of freedom
(the "least favorable" approach), while for model T1
it uses the Minimum Adjusted Bonferroni, based on precomputed values from simulations with n=1e+6.
These conservative tests are asymptotically guaranteed to reject the null
hypothesis at most at a specified level, but at the expense of increased type II errors.
</p>
<p>If <code>method="bootstrap"</code>, then parametric bootstrapping is performed, based on parameter estimates of the quartet topology
and internal edge length. The bootstrap sample size is given by the <code>bootstrap</code> argument.
</p>
<p>When some or all expected topology counts are small, the methods <code>"MLest"</code> and <code>"conservative"</code> are not appropriate.
The argument <code>smallsample</code> determines whether a precomputed bootstrap of 1e+8 samples, or actual boostrapping with the specified size,
is used when the total sample is small (&lt;30).
The argument <code>smallcounts</code> determines whether bootstrapping or a faster approximate method is used when only some counts are small.
The approximate approach returns a precomputed p-value, found by replacing the largest observed count
with 1e+6 and performing 1e+8 bootstraps for the model T3. When n &gt;30 and
some expected counts are small, the quartet tree error probability is small and the bootstrap p-value is
approximately independent of the choice of T3 or T1 and of the largest observed count.
</p>
<p>For model T1, the first entry of <code>obs</code> is treated as the count of gene quartets concordant with the species tree.
</p>
<p>The returned p-value should be taken with caution when there is a small sample size, e.g. less than 30 gene trees.
The returned value of <code>$edgelength</code> is a consistent estimator, but not the MLE, of the internal
edge length in coalescent units. Although consistent, the MLE for this length is biased.
Our consistent estimator is still biased, but with less bias than the MLE. See Mitchell et al. (2019)
for more discussion on dealing with the bias of parameter estimates in the
presence of boundaries and/or singularities of parameter spaces.
</p>


<h3>Value</h3>

<p><code>output</code> where <code>output$p.value</code> is the p-value and <code>output$edgelength</code> is a consistent estimator of the
internal edge length in coalescent units, possibly <code>Inf</code>.
</p>


<h3>References</h3>

<p>Mitchell J, Allman ES, Rhodes JA (2019).
“Hypothesis testing near singularities and boundaries.”
<em>Electron. J. Statist.</em>, <b>13</b>(1), 2150-2193.
<a href="https://doi.org/10.1214/19-EJS1576">doi:10.1214/19-EJS1576</a>.
</p>


<h3>See Also</h3>

<p><code>quartetTreeTestInd</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> quartetTreeTest(c(17,72,11),"T3")
 quartetTreeTest(c(17,72,11),"T1")
 quartetTreeTest(c(72,11,17),"T1")
 quartetTreeTest(c(11,17,72),"T1")

</code></pre>


</div>