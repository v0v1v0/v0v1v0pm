<div class="container">

<table style="width: 100%;"><tr>
<td>quartetTreeTestInd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multiple independent hypothesis tests for quartet counts fitting a species tree under the MSC</h2>

<h3>Description</h3>

<p>Perform a tree hypothesis test for all quartet counts in an input table, as if the counts for different choices of 4 taxa
are independent.
</p>


<h3>Usage</h3>

<pre><code class="language-R">quartetTreeTestInd(
  rqt,
  model = "T3",
  lambda = 0,
  method = "MLest",
  smallsample = "precomputed",
  smallcounts = "precomputed",
  bootstraps = 10^4,
  speciestree = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>rqt</code></td>
<td>
<p>table of resolved quartet counts, as produced by <code>quartetTableResolved</code>, or <code>quartetStarTestInd</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p><code>"T1"</code> for a specific species tree topology, or <code>"T3"</code> for any species tree topology, with these
models explained more fully by Mitchell et al. (2019)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>power divergence statistic parameter (e.g., 0 for likelihood ratio statistic, 1 for Chi-squared statistic)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p><code>"MLest"</code>, <code>"conservative"</code>, or <code>"bootstrap"</code>; see <code>quartetTreeTest</code> for explanation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smallsample</code></td>
<td>
<p><code>"precomputed"</code> or <code>"bootstrap"</code>, method of obtaining p-value when sample is small (&lt;30)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smallcounts</code></td>
<td>
<p><code>"precomputed"</code> or <code>"bootstrap"</code>, method of obtaining p-value when some counts are small, so
the chosen <code>method</code> is inappropriate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootstraps</code></td>
<td>
<p>number of samples for bootstrapping</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>speciestree</code></td>
<td>
<p>species tree, in Newick as text, to determine quartet for T1 test; required for <code>model="T1"</code>,
ignored for <code>model="T3"</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function assumes all quartets are resolved.  The test performed and the arguments
are described more fully in <code>quartetTreeTest</code>.
</p>


<h3>Value</h3>

<p>if <code>model="T3"</code>, a copy of <code>rqt</code> with a new column <code>"p_T3"</code> appended with p-values for each quartet;
if <code>model="T1"</code>, a copy of <code>rqt</code> with 2 columns appended: <code>"p_T1"</code> with p-values, and <code>"qindex"</code>
giving index of quartet consistent with specified species tree,
i.e., 1 if 12|34 on species tree, 2 if 13|24, 3 if 14|23
</p>


<h3>References</h3>

<p>Mitchell J, Allman ES, Rhodes JA (2019).
“Hypothesis testing near singularities and boundaries.”
<em>Electron. J. Statist.</em>, <b>13</b>(1), 2150-2193.
<a href="https://doi.org/10.1214/19-EJS1576">doi:10.1214/19-EJS1576</a>.
</p>


<h3>See Also</h3>

<p><code>quartetTreeTest</code>, <code>quartetTestPlot</code>, <code>quartetStarTestInd</code>, <code>quartetTableResolved</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">gtrees=read.tree(file=system.file("extdata","dataGeneTreeSample",package="MSCquartets"))
tnames=c("t1","t2","t3","t4","t5","t6")
QT=quartetTable(gtrees,tnames)
RQT=quartetTableResolved(QT)
stree="(((t5,t6),t4),((t1,t2),t3));"
pTable3=quartetTreeTestInd(RQT,"T3")
quartetTablePrint(pTable3[1:6,])
stree="((((t5,t6),t4),t7),((t8,t9),((t1,t2),t3)));"
pTable1=quartetTreeTestInd(RQT,"T1",speciestree=stree)
quartetTablePrint(pTable1[1:6,])

</code></pre>


</div>