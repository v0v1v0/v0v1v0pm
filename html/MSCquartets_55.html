<div class="container">

<table style="width: 100%;"><tr>
<td>TINNIK</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>TINNIK algorithm to infer species tree of blobs</h2>

<h3>Description</h3>

<p>Apply the TINNIK algorithm of Allman et al. (2024) (see also Allman et al. (2022))
to infer a tree of blobs for the species network from a collection of gene trees,
under the network multispecies coalescent (NMSC) model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">TINNIK(
  genedata,
  omit = FALSE,
  epsilon = 0,
  test = "T3",
  alpha = 0.05,
  beta = 0.95,
  treemethod = fastme.bal,
  delta = 2,
  taxanames = NULL,
  plot = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>genedata</code></td>
<td>
<p>gene tree data that may be supplied in any of 3 forms:
</p>

<ol>
<li>
<p> as a character string giving the name of a file containing Newick gene trees,
</p>
</li>
<li>
<p> as a multiPhylo object containing the gene trees, or
</p>
</li>
<li>
<p> as a table of quartets on the gene trees, as produced by a previous call to
<code>TINNIK</code> or <code>quartetTableResolved</code>, which has columns only for taxa, resolved quartet counts,
and possibly p_T3, p_cut, and p_star
</p>
</li>
</ol>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omit</code></td>
<td>
<p><code>FALSE</code> to treat unresolved quartets as 1/3 of each resolution;
<code>TRUE</code> to discard unresolved quartet data; ignored if gene tree data given as quartet table</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>minimum for branch lengths to be treated as non-zero; ignored if gene tree data given as quartet table</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>a hypothesis test to perform, either "cut" or "T3" (default)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>a value or vector of significance levels for judging p-values for test specified by "test";
testing a null hypothesis of no hybridization vs. an alternative of hybridization, for each quartet;  a smaller value applies
a less conservative test for a tree (more trees), hence a stricter requirement for deciding in favor of hybridization (fewer reticulations)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>a value or vector of significance levels for judging p-values testing
a null hypothesis of a star tree (polytomy) for each quartet vs. an alternative of anything else; a smaller value applies a less conservative
test for a star tree (more polytomies), hence a stricter requirement for deciding in favor of a resolved tree or network;
if vectors, <code>alpha</code> and <code>beta</code> must have the same length</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treemethod</code></td>
<td>
<p>a function implementing a method of tree inference from a distance table,
e.g. the ape package's fastme.bal or nj</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>a minimum edge length to retain in tree of blobs (see (Allman et al. 2024) for related theory); shorter edges are collapsed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taxanames</code></td>
<td>
<p>if <code>genedata</code> is a file or a multiPhylo object, a vector of a subset
of the taxa names on the gene trees
to be analyzed, if <code>NULL</code> all taxa on the first gene tree are used; if <code>genedata</code>
is a quartet table, this argument is ignored and all taxa in the table are used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p><code>TRUE</code> produces simplex plots of hypothesis test results and plots the tree of blobs <code>FALSE</code> omits plots</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function
</p>

<ol>
<li>
<p> counts displayed quartets across gene trees to form quartet count concordance factors (qcCFs),
</p>
</li>
<li>
<p> applies appropriate hypothesis tests to judge qcCFs as representing putative hybridization,
resolved trees, or unresolved (star) trees using <code>alpha</code> and <code>beta</code> as significance levels,
</p>
</li>
<li>
<p> produces a simplex plot showing results of the hypothesis tests for all qcCFs
</p>
</li>
<li>
<p> computes the appropriate TINNIK distance table, and infers the tree of blobs from the distance.
</p>
</li>
</ol>
<p>A call of <code>TINNIK</code> with <code>genedata</code> given as a table previously output from <code>TINNIK</code> is
equivalent to a call of <code>TINNIKdist</code> followed by tree construction from the distance table.
If <code>genedata</code> is a
table previously output from <code>quartetTableResolved</code>
which lacks columns of p-values for hypothesis tests, these will be appended to the table output by <code>TINNIK</code>.
This table must contain a row with quartet counts for every 4 taxon set.
</p>
<p>If plots are produced, there are 2 simplex plots: The first shows the hypothesis test results,
and the second shows
inferred B-quartets and T-quartets. In both,
each point in the simplex plot corresponds to an empirical quartet concordance factor,
color-coded to represent test or inference results.
</p>
<p>In general, <code>alpha</code> should be chosen to be small and <code>beta</code>
to be large so that most quartets are interpreted as resolved trees. More quartets judges to have
either blob or unresolved relationships will lead to a less resolved blob tree.
</p>
<p>Usually, an initial call to <code>TINNIK</code> will not give a good analysis, as values
of <code>alpha</code> and <code>beta</code> are likely to need some adjustment based on inspecting the data. Saving the returned
table of test results from <code>TINNIK</code> will allow for the results of the time-consuming computation of qcCFs to be
saved, along with p-values,
for input to further calls of <code>TINNIK</code> with new choices of <code>alpha</code> and <code>beta</code>.
</p>
<p>See the documentation for <code>TINNIKdist</code> for an explanation of a small, rarely noticeable,
stochastic element of the algorithm.
</p>
<p>For data sets of many gene trees, user time may be reduced by using parallel code for
counting displayed quartets. See <code>quartetTableParallel</code>.
</p>


<h3>Value</h3>

<p><code>output</code> (returned invisibly), with <code>output$ToB</code> the TINNIK tree of blobs, <code>output$pTable</code>
the table of quartets and p-values for judging fit to the MSC on quartet
trees, and <code>output$Bquartets</code> a TRUE/FALSE indicator vector of B-quartets; if <code>alpha, beta</code> are vectors, <code>output$ToB</code> is a vector of trees;
the table can be used as input to <code>TINNIK</code> or <code>TINNIKdist</code> with new choices of <code>alpha, beta</code>, without re-tallying quartets on
gene trees
</p>


<h3>References</h3>

<p>Allman ES, Baños H, Mitchell JD, Rhodes JA (2022).
“The tree of blobs of a species network: identifiability under the coalescent.”
<em>Journal of Mathematical Biology</em>, <b>86</b>(1), 10.
<a href="https://doi.org/10.1007/s00285-022-01838-9">doi:10.1007/s00285-022-01838-9</a>.
</p>
<p>Allman ES, Baños H, Mitchell JD, Rhodes JA (2024).
“TINNiK: Inference of the Tree of Blobs of a Species Network Under the Coalescent.”
<em>bioRxiv</em>.
<a href="https://doi.org/10.1101/2024.04.20.590418">doi:10.1101/2024.04.20.590418</a>, <a href="https://www.biorxiv.org/content/10.1101/2024.04.20.590418v1">https://www.biorxiv.org/content/10.1101/2024.04.20.590418v1</a>.
</p>


<h3>See Also</h3>

<p><code>quartetTable</code>, <code>quartetTableParallel</code>, <code>quartetTableDominant</code>, <code>quartetCutTestInd</code>,<code>quartetTreeTestInd</code>,
<code>quartetStarTestInd</code>, <code>TINNIKdist</code>, <code>quartetTestPlot</code>, <code>pvalHist</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(pTableYeastRokas)
out=TINNIK(pTableYeastRokas, alpha=.01, beta=.05)

</code></pre>


</div>