<div class="container">

<table style="width: 100%;"><tr>
<td>WQDCrecursive</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute the Recursive Weighted Quartet Distance Consensus tree from gene tree data</h2>

<h3>Description</h3>

<p>Infer a metric species tree from counts
of quartets displayed on a collection of gene trees, as described by 
Yourdkhani and Rhodes (2020). Edge lengths are in coalescent units.
</p>


<h3>Usage</h3>

<pre><code class="language-R">WQDCrecursive(rqt, method = fastme.bal, stopAt = 2, terminal = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>rqt</code></td>
<td>
<p>a resolved quartet table as produced by <code>quartetTableResolved</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a distance-based tree building function, such as <code>fastme.bal</code> or <code>nj</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stopAt</code></td>
<td>
<p>a non-negative branch length in coalescent units; recursive calls stop when the longest 
branch in a recursively examined subtree is smaller than this value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terminal</code></td>
<td>
<p>non-negative branch length to supply for terminal branches,
whose lengths cannot be inferred by <code>WQDCrecursive</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The algorithm counts quartets displayed on the gene trees, builds a tree using <code>WQDS</code>,
determines the split corresponding to the longest edge in that tree,
and then recursively builds trees
on the taxa in each split set together with a ‘composite taxon’ formed by all
taxa in the other split set.
This approach is slower than non-recursive <code>WQDC</code>, but increases topological accuracy. Shorter branch 
lengths tend to be more accurately estimated.
</p>
<p>This function must be called with its argument a resolved quartet
table of size (n choose 4)x(n+3). Its recursive nature
requires building smaller resolved quartet tables on split sets with an additional
composite taxon.
</p>


<h3>Value</h3>

<p>an unrooted metric tree, of type phylo
</p>


<h3>References</h3>

<p>Yourdkhani S, Rhodes JA (2020).
“Inferring metric trees from weighted quartets via an intertaxon distance.”
<em>Bul. Math. Biol.</em>, <b>82</b>(97).
<a href="https://doi.org/10.1007/s11538-020-00773-4">doi:10.1007/s11538-020-00773-4</a>.
</p>


<h3>See Also</h3>

<p><code>quartetTableResolved</code>,<code>quartetTable</code>,
<code>QDC</code>, <code>QDS</code>, <code>quartetTableCollapse</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">gtrees=read.tree(file=system.file("extdata","dataGeneTreeSample",package="MSCquartets"))
tnames=taxonNames(gtrees)
QT=quartetTable(gtrees,tnames[1:6])
RQT=quartetTableResolved(QT)
stree=WQDCrecursive(RQT)
write.tree(stree)
plot(stree)

</code></pre>


</div>