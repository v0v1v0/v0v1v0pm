<div class="container">

<table style="width: 100%;"><tr>
<td>ADtest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Anderson-Darling test comparing sample and theoretical pairwise distance distributions.</h2>

<h3>Description</h3>

<p>Takes as input theoretical pairwise distance densities under the MSC and
empirical pairwise distances from gene trees in a sample, as returned by
the function <code>pairwiseDist</code>.  Uses the package <code>kSamples</code> to perform
either one test on the entire dataset or multiple tests on subsamples.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ADtest(distanceDensities, subsampleSize = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>distanceDensities</code></td>
<td>
<p>A list containing values needed for performing Anderson-Darling
test(s) on a gene tree sample and species tree, as output by <code>pairwiseDist</code>.
For details, see code for <code>pairwiseDist</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subsampleSize</code></td>
<td>
<p>A positive integer to perform multiple tests on subsamples,
or <code>FALSE</code> (default) to perform one test on full sample.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Anderson-Darling test compares the empirical distance distribution for a supplied gene tree
sample to a sample drawn from the theoretical distribution. The output, passed from the <code>kSamples</code> package,
thus says that 2 samples are being compared, to test a null-hypothesis that they come from the same distribution.
See <code>kSamples</code> documentation for function <code>ad.test</code> for more details.
</p>
<p>Repeated runs of this function will give different results, since the sample from the theoretical distribution
will vary. Under the null hypothesis p-values for different runs should be approximately
uniformly distributed.
</p>
<p>Numerical issues may result in poor performance of Anderson-Darling tests when the sample size
is very large, so
an optional parameter <code>subsampleSize</code> can be set to create subsamples of smaller size.
If <code>subsampleSize</code> is a positive integer,
Anderson-Darling tests are performed on each subset, comparing them to
a random sample of the same size from the theoretical distribution. Good fit is indicated by an approximately uniform
distribution of the subsample p-values.
</p>


<h3>Value</h3>

<p>An object of type <code>ADtestOutput</code> including a sample <code>$Sample</code> from the theoretical distance distribution of
the same size as the empirical one, and <code>$ADtest</code> which is of type <code>kSamples</code> and
has all output from the Anderson-Darling test if only
one test was performed, or the number of tests if tests were performed on subsamples.
</p>


<h3>See Also</h3>

<p><code>pairwiseDist</code>, <code>kSamples-package</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">stree=read.tree(text="((((a:10000,b:10000):10000,c:20000):10000,d:30000):10000,e:40000);")
pops=c(15000,25000,10000,1,1,1,1,1,12000)
gts=read.tree(file=system.file("extdata","genetreeSample",package="MSCsimtester"))
distDen=pairwiseDist(stree,pops,gts,"a","b")
ADtest(distDen)
ADtest(distDen,1000) 

</code></pre>


</div>