<div class="container">

<table style="width: 100%;"><tr>
<td>rootedTriple</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compare expected and sample frequencies of topological rooted triples.</h2>

<h3>Description</h3>

<p>For a given species tree with population sizes, compares the expected frequencies
of rooted triples to empirical frequencies in a sample of gene trees, using Chi-squared tests with 2 d.f.
The exact and estimated internal branch length (in coalescent units) of the rooted triple
in the species tree are also computed for comparison.  A single test can be performed
on the entire gene tree sample, or multiple tests on subsamples.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rootedTriple(
  stree,
  popSizes,
  gtSample,
  taxon1,
  taxon2,
  taxon3,
  subsampleSize = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>stree</code></td>
<td>
<p>An object of class <code>phylo</code> containing a rooted metric species tree.
Edge lengths are in number of generations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>popSizes</code></td>
<td>
<p>An ordered list containing constant population sizes for each species tree edge, for a haploid organism.
Sizes should be doubled for diploids. If <code>stree</code> has k edges, then <code>popSizes</code> must have k+1 elements,
with the final entry for the population ancestral to the root.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gtSample</code></td>
<td>
<p>An object of class <code>multiPhylo</code> holding a sample of gene trees from a simulation.
Taxon labels on gene trees must be identical to those on <code>stree</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taxon1</code></td>
<td>
<p>A string specifying one taxon on <code>stree</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taxon2</code></td>
<td>
<p>A string specifying a second taxon on <code>stree</code>, distinct from <code>taxon1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taxon3</code></td>
<td>
<p>A string specifying a third taxon on <code>stree</code>, distinct from <code>taxon1</code>, <code>taxon2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subsampleSize</code></td>
<td>
<p>A positive integer or <code>FALSE</code>, giving size of subsamples of <code>gtSample</code> to analyze.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When <code>subsampleSize</code> is <code>FALSE</code> the Chi-squared test is performed using all
gene trees in <code>gtSample</code>. Results are reported in tabular form in the console.
</p>
<p>When <code>subsampleSize</code> is positive, the  <code>N</code> trees in <code>gtSample</code>
will be partitioned into <code>N/subsampleSize</code> subsamples, with a Chi-squared test
performed for each. Histograms are plotted for (1) the p-values for the Chi-squared tests on
subsamples, and (2) subsample estimates of the internal branch length for the rooted triple on the
species tree, with the true value marked.
</p>
<p>Three distinct taxon names must be supplied, all of which must occur on <code>stree</code>
and in each of the gene trees in the sample.
</p>


<h3>Value</h3>

<p>If <code>subsampleSize</code> is <code>FALSE</code>, returns an object of type <code>rootedTripleOutput</code>
which contains a table <code>$TripletCounts</code> of empirical and expected rooted triple counts,
a p-value <code>$pv</code> from the Chi-squared test, and a column <code>$InternalEdge</code> of estimated and exact internal edge lengths.
If <code>subsampleSize</code> is <code>TRUE</code>, returns <code>NULL</code> but produces several plots.
</p>


<h3>See Also</h3>

<p><code>plotEdgeOrder</code>, <code>plotPops</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">stree=read.tree(text="((((a:10000,b:10000):10000,c:20000):10000,d:30000):10000,e:40000);")
pops=c(15000,25000,10000,1,1,1,1,1,12000)
gts=read.tree(file=system.file("extdata","genetreeSample",package="MSCsimtester"))
rootedTriple(stree,pops,gts,"a","b","c")
rootedTriple(stree,pops,gts,"a","b","c",1000) 
</code></pre>


</div>