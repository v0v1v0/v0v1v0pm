<div class="container">

<table style="width: 100%;"><tr>
<td>iSCAM2OM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Reads MPD or MCMC estimates and data from iSCAM file structure into an operating model</h2>

<h3>Description</h3>

<p>Functions for importing an iSCAM assessment. From a fitted model, <code>iSCAM2OM</code>
populates the various slots of an operating model and <code>iSCAM2Data</code> generates a Data object.
These functions rely on several functions written by Chris Grandin (DFO PBS).
</p>


<h3>Usage</h3>

<pre><code class="language-R">iSCAM2OM(
  iSCAMdir,
  nsim = 48,
  proyears = 50,
  mcmc = FALSE,
  spawn_time_frac = 0,
  Name = "iSCAM model",
  Source = "No source provided",
  length_timestep = 1,
  nyr_par_mu = 2,
  Author = "No author provided",
  report = FALSE,
  silent = FALSE
)

iSCAM2Data(
  iSCAMdir,
  Name = "iSCAM assessment",
  Source = "No source provided",
  length_timestep = 1,
  Author = "No author provided"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>iSCAMdir</code></td>
<td>
<p>A folder with iSCAM input and output files in it. Alternatively, a list returned by
load.iscam.files.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>The number of simulations to take for parameters with
uncertainty (for OM@cpars custom parameters)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proyears</code></td>
<td>
<p>The number of MSE projection years</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcmc</code></td>
<td>
<p>Logical, whether to use mcmc samples to create custom parameters cpars. Alternatively, a list
returned by read.mcmc. Set the seed for the function to sub-sample the mcmc samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spawn_time_frac</code></td>
<td>
<p>Numeric between 0-1 indicating when spawning occurs within the time step</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Name</code></td>
<td>
<p>The name of the operating model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Source</code></td>
<td>
<p>Reference to assessment documentation e.g. a url</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>length_timestep</code></td>
<td>
<p>How long is a model time step in years
(e.g. a quarterly model is 0.25, a monthly model 1/12) (currently only uses annual time step)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nyr_par_mu</code></td>
<td>
<p>integer, the number of recent years to estimate vulnerability over for future projections</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Author</code></td>
<td>
<p>Who did the assessment</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>report</code></td>
<td>
<p>logical should a numbers at age reconstruction plot be produced?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>logical should progress reporting be printed to the console?</p>
</td>
</tr>
</table>
<h3>Biological parameters</h3>

<p>The function calls <code>model &lt;- load.iscam.files(iSCAMdir)</code> and grabs the following matrices:
</p>

<ul>
<li> <p><code>model$mpd$d3_weight_mat</code> - fecundity (product of weight and maturity at age)
</p>
</li>
<li> <p><code>model$mpd$ma</code> - maturity at age
</p>
</li>
</ul>
<h3>MPD historical reconstruction</h3>

<p>The function calls <code>model &lt;- load.iscam.files(iSCAMdir)</code> and then grabs the following matrices:
</p>

<ul>
<li> <p><code>model$mpd$N</code> - abundance at age
</p>
</li>
<li> <p><code>model$mpd$F</code> - fishing mortality at age
</p>
</li>
<li> <p><code>model$mpd$M</code> - natural mortality at age
</p>
</li>
</ul>
<p>If a delay-difference model is recognized, then the following is used instead:
</p>

<ul>
<li> <p><code>model$mpd$F_dd</code> - fishing mortality at age
</p>
</li>
<li> <p><code>model$mpd$M_dd</code> - natural mortality at age
</p>
</li>
</ul>
<p>Abundance at age is reconstructed using <code>model$mpd$rt</code> (recruitment) and projected with <code>F_dd</code> and
<code>M_dd</code> to match <code>model$mpd$numbers</code>.
</p>


<h3>MCMC historical reconstruction</h3>

<p>If <code>mcmc = TRUE</code> the function calls <code>mcmc_model &lt;- read.mcmc(iSCAMdir)</code>, and grabs <code>nsim</code> sub-samples of the MCMC output
through the following arrays:
</p>

<ul>
<li> <p><code>mcmc_model$params</code> and <code>mcmc_model$ft</code> - fishing mortality at age from the fleet selectivity parameters and apical F's
</p>
</li>
<li> <p><code>mcmc_model$m</code> - year-specific natural mortality at age
</p>
</li>
<li> <p><code>mcmc_model$params$rinit</code> and <code>mcmc_model$rt</code> - recruitment and abundance
</p>
</li>
</ul>
<h3>Start age</h3>

<p>While the iSCAM start age can be greater than zero, abundance at age is back-calculated to age zero with M, maturity, growth = 0. In this
way, the stock-recruit dynamics from iSCAM are preserved.
</p>
<p>These arrays are then passed to Assess2OM to generate the operating model.
</p>


<h3>Reference points</h3>

<p>iSCAM calculates the stock-recruit relationship and subsequently a single set of MSY and unfished reference
points using R0, steepness, and unfished spawners per recruit from the mean M, fecundity, and growth (mean with
respect to time).
</p>
<p>R0 and h are recalculated for the operating model by obtaining the stock-recruit alpha and beta from the
iSCAM parameters and the mean unfished spawners per recruit in the first <code>ageM</code> (age of 50% maturity) years.
</p>


<h3>Author(s)</h3>

<p>T. Carruthers, Q. Huynh
</p>


</div>