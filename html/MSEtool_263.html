<div class="container">

<table style="width: 100%;"><tr>
<td>qestMICE</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Internal function for optimizing catchability (q) for a MICE model</h2>

<h3>Description</h3>

<p>Function returns objective function that fits both stock depletion and catch fraction among fleets
</p>


<h3>Usage</h3>

<pre><code class="language-R">qestMICE(
  par,
  depc,
  CFc,
  mode = "opt",
  np,
  nf,
  nyears,
  nareas,
  maxage,
  Nx,
  VFx,
  FretAx,
  Effind,
  distx,
  movx,
  Spat_targ,
  M_ageArrayx,
  Mat_agex,
  Fec_agex,
  Asizex,
  WatAgex,
  Len_agex,
  Karrayx,
  Linfarrayx,
  t0arrayx,
  Marrayx,
  R0x,
  R0ax,
  SSBpRx,
  SSB0x,
  hsx,
  aRx,
  bRx,
  ax,
  bx,
  Perrx,
  SRrelx,
  Rel,
  SexPars,
  x,
  plusgroup,
  optVB,
  VB0x,
  B0x,
  WtCx,
  maxF,
  MPA,
  SRRfun,
  SRRpars,
  spawn_time_frac = rep(0, np)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>Integer, the simulation number</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>depc</code></td>
<td>
<p>Numeric vector, nstock long of specified stock depletion (SSB now / SSB0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CFc</code></td>
<td>
<p>Matrix <code style="white-space: pre;">⁠[nstock, nfleet]⁠</code>, a catch fraction among fleets (sums to 1 for each stock (row))</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p>Character if 'opt' qestMICE returns the objective function otherwise the fitted values in a list</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nf</code></td>
<td>
<p>Integer, number of fleets</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nyears</code></td>
<td>
<p>Integer, number of historical years (unfished til today)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nareas</code></td>
<td>
<p>Integer, number of areas (default is 2)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxage</code></td>
<td>
<p>Integer, maximum number of age classes for calculation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nx</code></td>
<td>
<p>Array <code style="white-space: pre;">⁠[stock, age, year, area]⁠</code> of stock numbers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VFx</code></td>
<td>
<p>Array <code style="white-space: pre;">⁠[fleet, age, year, area]⁠</code> of the vulnerability curve</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FretAx</code></td>
<td>
<p>Array <code style="white-space: pre;">⁠[fleet, age, year, area]⁠</code> of the retention curve</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Effind</code></td>
<td>
<p>Array <code style="white-space: pre;">⁠[fleet, year]⁠</code> of effort</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>movx</code></td>
<td>
<p>Array <code style="white-space: pre;">⁠[stock,age,area,area]⁠</code> of movement transitions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Spat_targ</code></td>
<td>
<p>Matrix <code style="white-space: pre;">⁠[stock, fleet]⁠</code> of spatial targeting parameter (0 evenly spatial distributed, 1 proportional to vulnerable biomass)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M_ageArrayx</code></td>
<td>
<p>Array <code style="white-space: pre;">⁠[stock, age,year]⁠</code> of Natural mortality rate at age</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mat_agex</code></td>
<td>
<p>Array <code style="white-space: pre;">⁠[stock, age, year]⁠</code> of maturity (spawning fraction) at age</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Fec_agex</code></td>
<td>
<p>Array <code style="white-space: pre;">⁠[stock, age, year]⁠</code> of mature spawning weight at age</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Asizex</code></td>
<td>
<p>Matrix <code style="white-space: pre;">⁠[stock, area]⁠</code> Area size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Karrayx</code></td>
<td>
<p>Array of von B growth parameter K</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Linfarrayx</code></td>
<td>
<p>Array of von B asymptotic length parameter Linf</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t0arrayx</code></td>
<td>
<p>Array ofvon B theoretical age at zero length (t0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Marrayx</code></td>
<td>
<p>Array of mature natural mortality rate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R0x</code></td>
<td>
<p>Vector <code style="white-space: pre;">⁠[stock]⁠</code> unfished recruitment</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R0ax</code></td>
<td>
<p>Matrix <code style="white-space: pre;">⁠[stock, area]⁠</code> unfished recruitment by area</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SSBpRx</code></td>
<td>
<p>Matrix <code style="white-space: pre;">⁠[stock, area]⁠</code> spawning biomass per recruit by area</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SSB0x</code></td>
<td>
<p>Vector <code style="white-space: pre;">⁠[stock]⁠</code> Unfished spawning stock biomass</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hsx</code></td>
<td>
<p>Vector <code style="white-space: pre;">⁠[stock]⁠</code> steepness of the stock recruitment curve</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aRx</code></td>
<td>
<p>Vector <code style="white-space: pre;">⁠[stock]⁠</code> stock recruitment parameter alpha (for Ricker curve)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bRx</code></td>
<td>
<p>Vector <code style="white-space: pre;">⁠[stock]⁠</code> stock recruitment parameter beta (for Ricker curve)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ax</code></td>
<td>
<p>Vector <code style="white-space: pre;">⁠[stock]⁠</code> weight-length parameter a W=aL^b</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bx</code></td>
<td>
<p>Vector <code style="white-space: pre;">⁠[stock]⁠</code> weight-length parameter b W=aL^b</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Perrx</code></td>
<td>
<p>Matrix <code style="white-space: pre;">⁠[stock, year]⁠</code> process error - the lognormal factor for recruitment strength</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SRrelx</code></td>
<td>
<p>Integer vector <code style="white-space: pre;">⁠[stock]⁠</code> the form of the stock recruitment relationship (1 = Beverton-Holt, 2= Ricker)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rel</code></td>
<td>
<p>A list of inter-stock relationships see slot Rel of MOM object class</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SexPars</code></td>
<td>
<p>A list of sex-specific dynamics (SSBfrom, stcck_age)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Integer. The simulation number</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plusgroup</code></td>
<td>
<p>Integer vector <code style="white-space: pre;">⁠[stock]⁠</code> indicating if a plus group is used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optVB</code></td>
<td>
<p>Logical, whether to optimize to vulnerable biomass (or spawning biomass otherwise)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VB0x</code></td>
<td>
<p>Vector <code style="white-space: pre;">⁠[stock]⁠</code> unfished vulnerable biomass</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B0x</code></td>
<td>
<p>Vector <code style="white-space: pre;">⁠[stock]⁠</code> unfished total biomass</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>WtCx</code></td>
<td>
<p>Array <code style="white-space: pre;">⁠[stock, fleet, n_age]⁠</code> of weight at age in catch in the last historical year</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxF</code></td>
<td>
<p>A numeric value specifying the maximum fishing mortality for any
single age class</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MPA</code></td>
<td>
<p>An array of spatial closures by year <code style="white-space: pre;">⁠[np,nf,nyears+proyears,nareas]⁠</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SRRfun</code></td>
<td>
<p>Optional. Stock-recruit functions used if <code>SRrelc =3</code>. List of length <code>np</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SRRpars</code></td>
<td>
<p>Optional. A named list of arguments for <code>SRRfun</code>. List of length <code>np</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spawn_time_frac</code></td>
<td>
<p>Numeric. Fraction of the year when spawning occurs. Default = 0.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>T.Carruthers
</p>


</div>