<div class="container">

<table style="width: 100%;"><tr>
<td>PIT</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Probability integral transform.</h2>

<h3>Description</h3>

<p>Method returning the probability integral
transform (PIT).
</p>


<h3>Usage</h3>

<pre><code class="language-R">PIT(object, ...)

## S3 method for class 'MSGARCH_SPEC'
PIT(
  object,
  x = NULL,
  par = NULL,
  data = NULL,
  do.norm = FALSE,
  do.its = FALSE,
  nahead = 1L,
  do.cumulative = FALSE,
  ctr = list(),
  ...
)

## S3 method for class 'MSGARCH_ML_FIT'
PIT(
  object,
  x = NULL,
  newdata = NULL,
  do.norm = TRUE,
  do.its = FALSE,
  nahead = 1L,
  do.cumulative = FALSE,
  ctr = list(),
  ...
)

## S3 method for class 'MSGARCH_MCMC_FIT'
PIT(
  object,
  x = NULL,
  newdata = NULL,
  do.norm = TRUE,
  do.its = FALSE,
  nahead = 1L,
  do.cumulative = FALSE,
  ctr = list(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>Model specification of class <code>MSGARCH_SPEC</code>
created with <code>CreateSpec</code> or fit object of type <code>MSGARCH_ML_FIT</code>
created with <code>FitML</code> or <code>MSGARCH_MCMC_FIT</code> created with <code>FitMCMC</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Not used. Other arguments to <code>PIT</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Vector (of size n). Used when <code>do.its = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>Vector (of size d) or matrix (of size <code>nmcmc</code> x d) of
parameter estimates where d must have
the same length as the default parameters of the specification.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Vector (of size T) of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.norm</code></td>
<td>
<p>Logical indicating if the PIT values are transformed
into standard Normal variate. (Default: <code>do.norm = FALSE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.its</code></td>
<td>
<p>Logical indicating if the in-sample PIT is returned. (Default: <code>do.its = FALSE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nahead</code></td>
<td>
<p>Scalar indicating the number of step-ahead evaluation.
Valid only when <code>do.its = FALSE</code>. (Default: <code>nahead = 1L</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.cumulative</code></td>
<td>
<p>Logical indicating if the PIT is computed on the cumulative simulations (typically log-returns, as they can be aggregated).
Only available for <code>do.its = FALSE</code>. (Default: <code>do.cumulative = FALSE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ctr</code></td>
<td>
<p>A list of control parameters:
</p>

<ul><li> <p><code>nsim</code> (integer &gt;= 0):
Number indicating the number of simulation done for the
evaluation of the PIT at <code>nahead &gt; 1</code>. (Default: <code>nsim = 10000L</code>)
</p>
</li></ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>Vector (of size T*) of new observations. (Default: <code>newdata = NULL</code>)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If a matrix of MCMC posterior draws is given, the
Bayesian probability integral transform is calculated.
Two or more step-ahead probability integral
transform are estimated via simulation of <code>nsim</code> paths up to <code>t = T + T* + nahead</code>.
The empirical probability integral transforms is then inferred from these simulations.<br>
If <code>do.its = FALSE</code>, the vector <code>x</code> are evaluated as  <code>t = T + T* + 1, ... ,t = T + T* + nahead</code>
realizations.<br>
If <code>do.its = TRUE</code>, <code>x</code> is evaluated
at each time <code>t</code> up to time <code>t = T + T*</code>.<br>
Finally if <code>x = NULL</code> the vector <code>data</code> is evaluated for sample evaluation of the PIT.<br>
The <code>do.norm</code> argument transforms the PIT value into Normal variates so that normality test can be done.
</p>


<h3>Value</h3>

<p>A vector or matrix of class <code>MSGARCH_PIT</code>. <br>
If <code>do.its = FALSE</code>: Probability integral transform of the
points <code>x</code> at <br><code>t = T + T* + 1, ... ,t = T + T* + nahead</code> or Normal variate derived from the probability
integral transform of <code>x</code> (matrix of size <code>nahead</code> x n).<br>
If <code>do.its = TRUE</code>: In-sample  probability integral transform or Normal variate
derived from the probability integral transform of <code>data</code> if <code>x = NULL</code> (vector of
size T + T*) or in-sample  probability integral transform or Normal variate
derived from the probability integral transform of <code>x</code> (matrix of size   (T + T*) x n).
</p>


<h3>Examples</h3>

<pre><code class="language-R"># create model specification
spec &lt;- CreateSpec()

# load data
data("SMI", package = "MSGARCH")

# fit the model on the data by ML
fit &lt;- FitML(spec = spec, data = SMI)

# run PIT method in-sample
pit.its &lt;- PIT(object = fit, do.norm = TRUE, do.its = TRUE)

# diagnostic of PIT with qqnorm
qqnorm(pit.its)
qqline(pit.its)

# simulate a serie from the model
set.seed(123)
sim.series &lt;- simulate(object = spec, par = fit$par, nahead= 1000L, nsim = 1L)
sim.series &lt;- as.vector(sim.series$draw)

# run PIT method on the simualed serie with the true par
pit.x &lt;- PIT(object = spec, par = fit$par, data = sim.series, do.norm = TRUE, do.its = TRUE)
qqnorm(pit.x)
qqline(pit.x)
</code></pre>


</div>