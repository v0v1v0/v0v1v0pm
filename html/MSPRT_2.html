<div class="container">

<table style="width: 100%;"><tr>
<td>design.MSPRT</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Designing the MSPRT
</h2>

<h3>Description</h3>

<p>Given the maximum available sample size and prespecified Type I &amp; II error probabilities, this function designs/obtains the corresponding MSPRT.
</p>


<h3>Usage</h3>

<pre><code class="language-R">design.MSPRT(test.type, side = "right", theta0, theta1 = T, 
             Type1.target = 0.005, Type2.target = 0.2, 
             N.max, N1.max, N2.max, 
             sigma = 1, sigma1 = 1, sigma2 = 1, 
             batch.size, batch1.size, batch2.size, 
             nReplicate = 1e+06, verbose = T, seed = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>test.type</code></td>
<td>

<p>Character. Type of test. Currently, the package only allows 
</p>

<ul>
<li> <p><code>oneProp</code> for one-sample proportion tests
</p>
</li>
<li> <p><code>oneZ</code> for one-sample z tests
</p>
</li>
<li> <p><code>oneT</code> for one-sample t tests
</p>
</li>
<li> <p><code>twoZ</code> for two-sample z tests
</p>
</li>
<li> <p><code>twoT</code> for two-sample t tests.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>side</code></td>
<td>

<p>Character. Direction of the composite alternative hypothesis. <code>right</code> for <code class="reqn">H_1 : \theta &gt; \theta_0</code> (<strong>default</strong>), and <code>left</code> for <code class="reqn">H_1 : \theta &lt; \theta_0</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta0</code></td>
<td>

<p>Numeric. Hypothesized value of effect size (<code class="reqn">\theta_0</code>) under <code class="reqn">H_0</code>. 
</p>
<p><strong>Default:</strong> 0.5 in one-sample proportion tests, and 0 for others.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta1</code></td>
<td>

<p>Logical, numeric or list (two components with names <code>'right'</code> and <code>'left'</code>).
</p>

<ul>
<li>
<p> If <code>FALSE</code>, no comparison is done under the alternative hypothesis.
</p>
</li>
<li>
<p> If <code>TRUE</code> (<strong>Default</strong>), comparison is done at the fixed-design alternative effect size (<code class="reqn">\theta_a</code>).
</p>
</li>
<li>
<p> If numeric, this can only be in case of one-sided tests (that is, <code>side = "right"</code> or <code>"left"</code>). The comparison is done at the specified numeric value of the alternative effect size.
</p>
</li>
<li>
<p> If list, this can only be in case of two-sided tests (that is, <code>side = "both"</code>). The list has to be of the form <code>list("right" =</code> <code class="reqn">\theta_1</code><code>, "left" =</code> <code class="reqn">\theta_2</code>). Then the comparison is done at alternative effect sizes <code class="reqn">\theta_1</code> and <code class="reqn">\theta_2</code>.
</p>
</li>
</ul>
<p>Note: In case of two-sided tests at a given level of significance, there are two effect sizes under <code class="reqn">H_1</code> (one on the right of <code class="reqn">H_0</code> and one on the left) that corresponds to the same Type II error probability (or power). This list provides users with the ability where he/she can replace <code class="reqn">\theta_1</code> and <code class="reqn">\theta_2</code> by any effect sizes from each side in the form of a list as mentioned above, and can get the designed MSPRT together with its operating characteristics at those effect sizes.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Type1.target</code></td>
<td>

<p>Numeric within [0,1]. Prespecified level of Type I error probability.
</p>
<p><strong>Default:</strong> 0.005.
</p>
<p>The MSPRT exactly maintains its Type I error probability at this value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Type2.target</code></td>
<td>

<p>Numeric within [0,1]. Prespecified level of Type 2 error probability.
</p>
<p><strong>Default:</strong> 0.2.
</p>
<p>The MSPRT approximately maintains its Type II error probability at this value at the corresponding fixed-design alternative (<code class="reqn">\theta_a</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N.max</code></td>
<td>

<p>Positive integer. Maximum available sample size in one-sample tests.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N1.max</code></td>
<td>

<p>Positive integer. Maximum available sample size from Group-1 in two-sample tests.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N2.max</code></td>
<td>

<p>Positive integer. Maximum available sample size from Group-2 in two-sample tests.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>

<p>Positive numeric. Known standard deviation in one-sample z tests. 
</p>
<p><strong>Default:</strong> 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma1</code></td>
<td>

<p>Positive numeric. Known standard deviation for Group-1 in two-sample z tests. 
</p>
<p><strong>Default:</strong> 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2</code></td>
<td>

<p>Positive numeric. Known standard deviation for Group-2 in two-sample z tests. 
</p>
<p><strong>Default:</strong> 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batch.size</code></td>
<td>

<p>Integer vector. A vector denoting the number of observations that are planned to be observed at each sequential step in one-sample tests. 
</p>
<p><strong>Default:</strong>
</p>

<ul>
<li>
<p> Proportion and z tests: <code>rep(1, N.max)</code>.
</p>
</li>
<li>
<p> t tests: <code>c(2, rep(1, N.max-1))</code>.
</p>
</li>
</ul>
<p>Default values mean the sequential analysis is performed after observing each observation. This corresponds to a sequential MSPRT. If any batch size is more than 1 (or more than 2 in the 1st step for t test) it corresponds to a group sequential MSPRT.
</p>
<p>Note: First batch size for t tests needs to be at least 2. The length of batch.size equals to the maximum number of planned sequential analyses.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batch1.size</code></td>
<td>

<p>Integer vector. A vector denoting the number of observations that are planned to be observed from Group-1 at each sequential step in two-sample tests. 
</p>
<p><strong>Default:</strong>
</p>

<ul>
<li>
<p> z tests: <code>rep(1, N1.max)</code>.
</p>
</li>
<li>
<p> t tests: <code>c(2, rep(1, N1.max-1))</code>.
</p>
</li>
</ul>
<p>Default values mean the sequential analysis is performed after observing each observation from Group-1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batch2.size</code></td>
<td>

<p>Integer vector. A vector denoting the number of observations that are planned to be observed from Group-2 at each sequential step in two-sample tests. 
</p>
<p><strong>Default:</strong>
</p>

<ul>
<li>
<p> z tests: <code>rep(1, N2.max)</code>.
</p>
</li>
<li>
<p> t tests: <code>c(2, rep(1, N2.max-1))</code>.
</p>
</li>
</ul>
<p>Default values mean the sequential analysis is performed after observing each observation from Group-2.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nReplicate</code></td>
<td>

<p>Positive integer. Total number of replications to be used in Monte Carlo simulation for calculating the termination threshold and the operating characteristics of the MSPRT. 
</p>
<p><strong>Default:</strong> 1,000,000.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>Logical. If <code>TRUE</code> (<strong>default</strong>), returns messages of the current proceedings. Otherwise it doesn't.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>

<p>Integer. Random number generating seed. 
</p>
<p><strong>Default:</strong> 1.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>List. The list has the following named components in case of one-sided one-sample tests:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>TypeI.attained</code></td>
<td>

<p>Numeric in [0,1]. Type I error probability attained by the designed MSPRT.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Type2.attained</code></td>
<td>

<p>Numeric in [0,1]. Type II error probability attained by the designed MSPRT at the specified alternative effect size <code>theta1</code>. Returned only if <code>theta1</code> is <code>TRUE</code> or numeric.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>

<p>List.
</p>

<ul>
<li>
<p> If <code>theta1 = FALSE</code>, the list has one component named <code>H0</code>. It stores an integer vector of length <code>nReplicate</code>. This is the vector of sample size required by the MSPRT for each of <code>nReplicate</code> Monte Carlo simulations under <code class="reqn">H_0</code>.
</p>
</li>
<li>
<p> If <code>theta1</code> is <code>TRUE</code> or numeric, the list has two components named <code>H0</code> and <code>H1</code>. Each of these stores an integer vector of length <code>nReplicate</code>. The stored vector under <code>H0</code> is the same as in <code>theta1 = FALSE</code>. The <code>H1</code> component stored the vector of sample size required by the MSPRT for each of <code>nReplicate</code> Monte Carlo simulations under the specified alternative effect size.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EN</code></td>
<td>

<p>Numeric vector.
</p>

<ul>
<li>
<p> If <code>theta1 = FALSE</code>, the vector is of length 1. It is the number of samples required on average by the MSPRT under <code class="reqn">H_0</code>.
</p>
</li>
<li>
<p> If <code>theta1</code> is <code>TRUE</code> or numeric, the vector is of length 2. They are the number of samples required on average by the MSPRT under <code class="reqn">H_0</code> (first component) and the specified alternative effect size (second component), respectively.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>UMPBT or theta.UMPBT</code></td>
<td>

<p>The UMPBT alternative. <code>UMPBT</code> in case of one-sample proportion test and <code>theta.UMPBT</code> in case of all the other tests. Their types are the same as their output from <code>UMPBT.alt</code> function.
</p>
<p>Note: Not returned in t tests as it depends on the data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta1</code></td>
<td>

<p>Returned only if <code>theta1</code> is anything but <code>FALSE</code>. Stores the effect size under <code class="reqn">H_1</code> where the operating characteristic of the MSPRT is obtained. Of the same type as the argument <code>theta1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Type2.fixed.design</code></td>
<td>

<p>Numeric in [0,1]. Type II error probability attained by the fixed design test with sample size <code>N.max</code> and Type I error probability <code>Type1.target</code> at the alternative effect size <code>theta1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RejectH0.threshold</code></td>
<td>

<p>Positive numeric. Threshold for rejecting <code class="reqn">H_0</code> in the MSPRT.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RejectH1.threshold</code></td>
<td>

<p>Positive numeric. Threshold for accepting <code class="reqn">H_1</code> in the MSPRT.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>termination.threshold</code></td>
<td>

<p>Positive numeric. Termination threshold of the MSPRT.
</p>
</td>
</tr>
</table>
<p>In case of one-sided two-sample tests the above components are returned with following modifications:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>N:</code></td>
<td>
<p>List.
</p>

<ul>
<li>
<p> If <code>theta1 = FALSE</code> the list has one component named <code>H0</code>.
</p>
</li>
<li> <p><code>theta1</code> is <code>TRUE</code> or numeric, the list has two components named <code>H0</code> and <code>H1</code>.
</p>
<p>Each of the named components <code>H0</code> and <code>H1</code> contains a list with two components named <code>Group1</code> and <code>Group2</code>. Each of these contains the same vector corresponding to Group-1 and Group-2. In each of these, it contains the sample size required by the MSPRT in each of <code>nReplicate</code> Monte Carlo simulations under the respective effect size for the respective group.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EN</code></td>
<td>
<p>List.
</p>

<ul>
<li>
<p> If <code>theta1 = FALSE</code> the list has one component named <code>H0</code>.
</p>
</li>
<li>
<p> If <code>theta1</code> is <code>TRUE</code> or numeric, the list has two components named <code>H0</code> and <code>H1</code>.
</p>
</li>
</ul>
<p>Each of the named components <code>H0</code> or <code>H1</code> contains a list with two components named <code>Group1</code> and <code>Group2</code>. In each of these, it contains the sample size required on average by the MSPRT under the respective effect size for the respective group.
</p>
</td>
</tr>
</table>
<p>In case of two-sided tests the above components are returned with following modifications:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Type2.attained</code></td>
<td>

<p>Numeric vector of length 2 with both elements in [0,1]. The first and second component is the Type II error probability of the MSPRT at the specified alternative effect sizes <code>theta1$right</code> and <code>theta1$left</code>, respectively.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>

<p>This is the same as in one-sided tests if <code>theta1</code> is <code>FALSE</code>. If <code>theta1</code> is <code>TRUE</code> or a two-component list with names <code>right</code> and <code>left</code>, this is a list with three components with names <code>H0</code>, <code>right</code> and <code>left</code> instead of a two-component list with names <code>H0</code> and <code>H1</code>. Quantities stored under these components are the same as in one-sided tests except the quantities under <code>right</code> and <code>left</code> are the same performance of the designed MSPRT at the specified alternative effect sizes <code>theta1$right</code> and <code>theta1$left</code>, respectively.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EN</code></td>
<td>

<p>Numeric vector. The same as in one-sided tests if <code>theta1</code> is <code>FALSE</code>. If <code>theta1</code> is <code>TRUE</code> or a two-component list with names <code>right</code> and <code>left</code>, this is a numeric vector of length 3, where the first, second and third components are the average required sample size under <code class="reqn">H_0</code>, and at the specified alternative effect sizes <code>theta1$right</code> and <code>theta1$left</code>, respectively.
</p>
</td>
</tr>
</table>
<p>Additionally, the output list also contains the provided arguments of design.MSPRT, and 
</p>
<table><tr style="vertical-align: top;">
<td><code>nAnalyses</code></td>
<td>

<p>Positive integer. This is the maximum number of sequential analyses that is planned. This equals to the <code>length(batch.size)</code> in one-sample tests, and to the <code>length(batch1.size)</code> and <code>length(batch2.size)</code> in two-sample tests.
</p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>Sandipan Pramanik, Valen E. Johnson and Anirban Bhattacharya
</p>


<h3>References</h3>

<p>Pramanik S., Johnson V. E. and Bhattacharya A. (2020+). A Modified Sequential Probability Ratio Test. <a href="https://arxiv.org/pdf/1811.08478.pdf">[Arxiv]</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
##### one-sample proportion test #####

## right-sided
#design.MSPRT(test.type = 'oneProp', side = 'right',
#             N.max = 20)

## left-sided
#design.MSPRT(test.type = 'oneProp', side = 'right',
#             N.max = 20)

## two-sided
#design.MSPRT(test.type = 'oneProp', side = 'both',
#             N.max = 20)


##### one-sample z test #####

## right-sided
#design.MSPRT(test.type = 'oneZ', side = 'right',
#             N.max = 20)

## left-sided
#design.MSPRT(test.type = 'oneZ', side = 'right',
#             N.max = 20)

## two-sided
#design.MSPRT(test.type = 'oneZ', side = 'both',
#              N.max = 20)


##### one-sample t test #####

## right-sided
#design.MSPRT(test.type = 'oneT', side = 'right',
#             N.max = 20)

## left-sided
#design.MSPRT(test.type = 'oneT', side = 'right',
#             N.max = 20)

## two-sided
#design.MSPRT(test.type = 'oneT', side = 'both',
#             N.max = 20)


##### two-sample z test #####

## right-sided
#design.MSPRT(test.type = 'twoZ', side = 'right',
#             N1.max = 20, N2.max = 20)

## left-sided
#design.MSPRT(test.type = 'twoZ', side = 'left',
#             N1.max = 20, N2.max = 20)

## two-sided
#design.MSPRT(test.type = 'twoZ', side = 'both',
#             N1.max = 20, N2.max = 20)


##### two-sample t test #####

## right-sided
#design.MSPRT(test.type = 'twoT', side = 'right',
#             N1.max = 20, N2.max = 20)

## left-sided
#design.MSPRT(test.type = 'twoT', side = 'left',
#             N1.max = 20, N2.max = 20)

## two-sided
#design.MSPRT(test.type = 'twoT', side = 'both',
#             N1.max = 20, N2.max = 20)
</code></pre>


</div>