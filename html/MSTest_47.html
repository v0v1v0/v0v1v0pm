<div class="container">

<table style="width: 100%;"><tr>
<td>DLMMCTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Maximized Monte Carlo moment-based test for Markov switching model</h2>

<h3>Description</h3>

<p>This function performs the maximized Monte Carlo moment-based test for
Markov switching autoregressive models proposed in Dufour &amp; Luger (2017).
</p>


<h3>Usage</h3>

<pre><code class="language-R">DLMMCTest(Y, p, control = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Series to be tested</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Number of autoregressive lags.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>List with test procedure options including: 
</p>

<ul>
<li>
<p> N: Integer determining the number of Monte Carlo simulations. Default is set to <code>99</code> as in paper.
</p>
</li>
<li>
<p> simdist_N: Integer determining the number of simulations for CDF distribution approximation. Default is set to <code>10000</code>.
</p>
</li>
<li>
<p> getSE: Boolean indicator. If <code>TRUE</code>, standard errors for restricted model are estimated. If <code>FALSE</code> no standard errors are estimated. Default is <code>TRUE</code>.
</p>
</li>
<li>
<p> eps: Fixed positive constant that does not depend on <code>T</code> used to determine lower and upper bounds on consistent set considered for nuisance parameter space.
</p>
</li>
<li>
<p> CI_union: Boolean indicator determining if union between <code>eps</code> and confidence interval is used to determine lower and upper bound on consistent set considered for nuisance parameter space. If <code>TRUE</code> union is used and if <code>FALSE</code> only <code>eps</code> is used. Note that if standard errors obtained are not finite then only <code>eps</code> is used. Default is <code>FALSE</code>.       
</p>
</li>
<li>
<p> lambda: Numeric value for penalty on stationary constraint not being met. Default is <code>100</code>.
</p>
</li>
<li>
<p> stationary_ind: Boolean indicator determining if only stationary solutions should be considered if <code>TRUE</code> or any solution can be considered if <code>FALSE</code>. Default is <code>TRUE</code>.
</p>
</li>
<li>
<p> phi_low: Vector with lower bound for autoregressive parameters when optimizing. Default is <code>NULL</code>.
</p>
</li>
<li>
<p> phi_upp: Vector with upper bound for autoregressive parameters when optimizing. Default is <code>NULL</code>.
</p>
</li>
<li>
<p> optim_type: String determining type of numerical optimization algorithm to use. Available options are: "<code>pso</code>", ""<code>GenSA</code>", "<code>GA</code>". Default is "<code>GenSA</code>".
</p>
</li>
<li>
<p> silence: Boolean indicator determining if optimization updates should be silenced if <code>TRUE</code> or not if <code>FALSE</code>. Default is <code>FALSE</code>.
</p>
</li>
<li>
<p> threshold_stop: Numeric value determining the maximum possible p-value attainable. Default is <code>1</code>.
</p>
</li>
<li>
<p> type_control: List containing other optimization options specific to the numerical optimization algorithm used. This includes maximum number of iterations which is <code>200</code> b y default. For other options see documentation of numerical algorithm chosen.
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Value</h3>

<p>List of class <code>DLMCTest</code> (<code>S3</code> object) with attributes including: 
</p>

<ul>
<li>
<p> mdl_h0: List with restricted model attributes. This will be of class <code>ARmdl</code> if <code>p&gt;0</code> or <code>Nmdl</code> otherwise (<code>S3</code> objects). See <code>ARmdl</code> or <code>Nmdl</code>.    
</p>
</li>
<li>
<p> theta_max_min: Value of nuisance parameters when min version of p-value is maximized as discussed in Dufour &amp; Luger (2017) MMC procedure.
</p>
</li>
<li>
<p> theta_max_prod: Value of nuisance parameters when prod version of p-value is maximized as discussed in Dufour &amp; Luger (2017) MMC procedure.
</p>
</li>
<li>
<p> theta_low: Lower bound on nuisance parameter values used when searching for maximum p-value.
</p>
</li>
<li>
<p> theta_upp: Upper bound on nuisance parameter values used when searching for maximum p-value.
</p>
</li>
<li>
<p> S0_min: A (<code>1 x 4</code>)) matrix containing the four moment-based test statistics defined in (<code>11</code>) - (<code>14</code>) in Dufour &amp; Luger (2017) when <code>theta_min</code> is used.
</p>
</li>
<li>
<p> S0_prod: A (<code>1 x 4</code>)) matrix containing the four moment-based test statistics defined in (<code>11</code>) - (<code>14</code>) in Dufour &amp; Luger (2017) when <code>theta_prod</code> is used.
</p>
</li>
<li>
<p> F0_min: Test statistic value for min version of Maximized Monte Carlo moment-based test.
</p>
</li>
<li>
<p> F0_prod: Test statistic value for prod version of Maximized Monte Carlo moment-based test.
</p>
</li>
<li>
<p> FN_min: A (<code>N x 1</code>) vector with simulated test statistics for min version of Maximized Monte Carlo moment-based test under null hypothesis.
</p>
</li>
<li>
<p> FN_prod: A (<code>N x 1</code>) vector with simulated test statistics for prod version of Maximized Monte Carlo moment-based test under null hypothesis.
</p>
</li>
<li>
<p> pval_min: Maximum p-value for min version of Maximized Monte Carlo moment-based test.
</p>
</li>
<li>
<p> pval_prod: Maximum p-value for prod version of Local Monte Carlo moment-based test.
</p>
</li>
<li>
<p> FN_min_cv: Vector with 90%, 95%, and 99% Monte Carlo critical values for min version of Local Monte Carlo moment-based test.
</p>
</li>
<li>
<p> FN_prod_cv: Vector with 90%, 95%, and 99% Monte Carlo critical values for prod version of Local Monte Carlo moment-based test.
</p>
</li>
<li>
<p> control: List with test procedure options used.
</p>
</li>
<li>
<p> optim_min_output: List with optimization output for min version of Maximized Monte Carlo moment-based test.
</p>
</li>
<li>
<p> optim_prod_output: List with optimization output for prod version of Maximized Monte Carlo moment-based test.
</p>
</li>
</ul>
<h3>References</h3>

<p>Dufour, J. M., &amp; Luger, R. 2017. "Identification-robust moment-based tests for 
Markov switching in autoregressive models." <em>Econometric Reviews</em>, 36(6-9), 713-727.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1234)
# load data used in Hamilton 1989 and extended data used in CHP 2014 
y84 &lt;- as.matrix(hamilton84GNP$GNP_logdiff)
y10 &lt;- as.matrix(chp10GNP$GNP_logdiff)

# Set test procedure options
mmc_control &lt;- list(N = 99,
                    simdist_N = 10000,
                    getSE = TRUE,
                    eps = 0.0000001, 
                    CI_union = TRUE,
                    lambda = 100,
                    stationary_ind = TRUE,
                    optim_type = "GenSA",
                    silence = FALSE,
                    threshold_stop = 1,
                    type_control = list(maxit = 200))


# perform test on Hamilton 1989 data

  mmc_gnp84 &lt;- DLMMCTest(y84, p = 4, control = mmc_control)
  summary(mmc_gnp84)


</code></pre>


</div>