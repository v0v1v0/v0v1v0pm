<div class="container">

<table style="width: 100%;"><tr>
<td>HLRTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Hansen (1992) likelihood ratio test</h2>

<h3>Description</h3>

<p>This function performs Hansen's likelihood ratio test as described in Hansen (1992).
Original source code can be found <a href="https://www.ssc.wisc.edu/~bhansen/progs/jae_92.html">here</a>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">HLRTest(Y, p, control = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>A (<code>T x 1</code>) matrix of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Integer determining the number of autoregressive lags.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>List with test procedure options including: 
</p>

<ul>
<li>
<p> ix: List of Markov Switching parameters. 1 = just mean c(1,2) = mean and first param, (default: 1).
</p>
</li>
<li>
<p> msvar: Boolean indicator. If <code>TRUE</code>, there is a switch in variance. If <code>FALSE</code> only switch in mean is considered. Default is <code>FALSE</code>.
</p>
</li>
<li>
<p> qbound: Indicator that bounds q by 1-p (default: <code>FALSE</code>).
</p>
</li>
<li>
<p> gridsize: Integer determining the number of grid points for markov switching parameters. Default is <code>20</code>.
</p>
</li>
<li>
<p> pgrid_from: Double determining the initial grid point for transition probabilities. Default is <code>0.1</code>.
</p>
</li>
<li>
<p> pgrid_by: Double determining the step size for grid points of transition probabilities. This, along with <code>p_gridsize</code> will determine the bounds of search space. Default is <code>0.075</code>.
</p>
</li>
<li>
<p> pgrid_to: Double determining the end grid point for transition probabilities. Default is <code>0.925</code>.
</p>
</li>
<li>
<p> mugrid_from: Double determining the minimum value of mean in second regime. Default is <code>0.1</code>.
</p>
</li>
<li>
<p> mugrid_by: Double determining the step size for grid points of mean in second regime. This, along with <code>gridsize</code> will determine the max value of mean in second regime. Default is <code>0.1</code>.
</p>
</li>
<li>
<p> siggrid_from: Double determining the minimum value of sigma in second regime (if <code>msvar = TRUE</code>). Default is <code>0.1</code>.
</p>
</li>
<li>
<p> siggrid_by: Double determining the step size for grid points of sigma in second regime. This, along with <code>gridsize</code> will determine the max value of sigma in second regime. Default is <code>0.1</code>.
</p>
</li>
<li>
<p> N: Integer determining the number of replications. Default is <code>1000</code>.
</p>
</li>
<li>
<p> nwband: Integer determining maximum bandwidth in Bartlett kernel. Critical values and p-values are returned for each bandwidth from <code>0:nwband</code> as suggested in Hansen (1996). Default is <code>4</code>.
</p>
</li>
<li>
<p> theta_null_low: Vector determining lower bound on parameters under the null hypothesis. Length of vector should be number of model coefficients + 1 for variance. Default is to only bound variance at <code>0.01</code>.
</p>
</li>
<li>
<p> theta_null_upp: Vector determining upper bound on parameters under the null hypothesis. Length of vector should be number of model coefficients + 1 for variance. Default is to no bounds (i.e. <code>Inf</code>).
</p>
</li>
<li>
<p> optim_method: String determining the type of optimization procedure used. Allowed options are "gp-optim" for general purpose optimization using <code>optim</code> from <code>stats</code> or "nl-optim" using <code>slsqp</code> from <code>nloptr</code>. Default is "gp-optim".
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Value</h3>

<p>List of class <code>HLRTest</code> (<code>S3</code> object) with model attributes including: 
</p>

<ul>
<li>
<p> mdl_h0: List with restricted model attributes. This will be of class <code>ARmdl</code> (<code>S3</code> object). See <code>ARmdl</code>.
</p>
</li>
<li>
<p> LR0: Likelihood ratio test statistic value.
</p>
</li>
<li>
<p> LRN: A (<code>N x 1</code>) vector with simulated LRT statistics under null hypothesis.
</p>
</li>
<li>
<p> pval: P-value.
</p>
</li>
<li>
<p> LR_cv: A (<code>nwband x 3</code>) matrix with 90%, 95%, and 99% critical values in each column respectively.
</p>
</li>
<li>
<p> coef: Vector of coefficients from restricted model and grid search that maximized standardized LRT. 
</p>
</li>
<li>
<p> control: List with test procedure options used.
</p>
</li>
</ul>
<h3>References</h3>

<p>Hansen, Bruce E. 1992. “The likelihood ratio test under nonstandard conditions: testing the Markov switching model of GNP.” <em>Journal of applied Econometrics</em> 7 (S1): S61–S82.
</p>
<p>Hansen, Bruce E. 1996. “Erratum: The likelihood ratio test under nonstandard conditions: testing the Markov switching model of GNP.” <em>Journal of applied Econometrics</em> 7 (S1): S61–S82.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># --------------------------- Use simulated process ----------------------------
set.seed(1234)
# Define DGP of MS AR process
mdl_ms2 &lt;- list(n     = 200, 
                mu    = c(5,1),
                sigma = c(1,1),
                phi   = c(0.5),
                k     = 2,
                P     = rbind(c(0.90, 0.10),
                              c(0.10, 0.90)))

# Simulate process using simuMSAR() function
y_ms_simu &lt;- simuMSAR(mdl_ms2)

hlrt_control  &lt;- list(ix          = 1, 
                      gridsize    = 5,
                      p_gridsize  = 9,
                      p_stepsize  = 0.1,
                      mugrid_from = 0,
                      mugrid_by   = 1)


  hlrt &lt;- HLRTest(y_ms_simu$y, p = 1, control = hlrt_control)
  summary(hlrt)


</code></pre>


</div>