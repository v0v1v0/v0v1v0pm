<div class="container">

<table style="width: 100%;"><tr>
<td>HMmdl</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Hidden Markov model</h2>

<h3>Description</h3>

<p>This function estimates a Hidden Markov model with <code>k</code> regimes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">HMmdl(Y, k, control = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>a <code>(T x q)</code> matrix of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>integer determining the number of regimes to use in estimation. Must be greater than or equal to <code>2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>List with model options including:
</p>

<ul>
<li>
<p> getSE: Boolean. If <code>TRUE</code> standard errors are computed and returned. If <code>FALSE</code> standard errors are not computed. Default is <code>TRUE</code>.
</p>
</li>
<li>
<p> msmu: Boolean. If <code>TRUE</code> model is estimated with switch in mean. If <code>FALSE</code> model is estimated with constant mean. Default is <code>TRUE</code>.
</p>
</li>
<li>
<p> msvar: Boolean. If <code>TRUE</code> model is estimated with switch in variance. If <code>FALSE</code> model is estimated with constant variance. Default is <code>TRUE</code>.
</p>
</li>
<li>
<p> init_theta: vector of initial values. vector must contain <code>(1 x q)</code> vector <code>mu</code>, <code>vech(sigma)</code>, and <code>vec(P)</code> where sigma is a <code>(q x q)</code> covariance matrix.This is optional. Default is <code>NULL</code>, in which case <code>initVals_MSARmdl</code> is used to generate initial values.
</p>
</li>
<li>
<p> method: string determining which method to use. Options are <code>'EM'</code> for EM algorithm or <code>'MLE'</code> for Maximum Likelihood Estimation.
</p>
</li>
<li>
<p> maxit: integer determining the maximum number of EM iterations.
</p>
</li>
<li>
<p> thtol: double determining the convergence criterion for the absolute difference in parameter estimates <code>theta</code> between iterations. Default is <code>1e-6</code>.
</p>
</li>
<li>
<p> maxit_converge: integer determining the maximum number of initial values attempted until solution is finite. For example, if parameters in <code>theta</code> or <code>logLike</code> are <code>NaN</code> another set of initial values (up to <code>maxit_converge</code>) is attempted until finite values are returned. This does not occur frequently for most types of data but may be useful in some cases. Once finite values are obtained, this counts as one iteration towards <code>use_diff_init</code>. Default is <code>500</code>.
</p>
</li>
<li>
<p> use_diff_init: integer determining how many different initial values to try (that do not return <code>NaN</code>; see <code>maxit_converge</code>). Default is <code>1</code>.
</p>
</li>
<li>
<p> mle_variance_constraint: double used to determine the lower bound on the smallest eigenvalue for the covariance matrix of each regime. Default is <code>1e-3</code>.
</p>
</li>
<li>
<p> mle_theta_low: Vector with lower bounds on parameters (Used only if method = "MLE"). Default is <code>NULL</code>.
</p>
</li>
<li>
<p> mle_theta_upp: Vector with upper bounds on parameters (Used only if method = "MLE"). Default is <code>NULL</code>.
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Value</h3>

<p>List of class <code>HMmdl</code> (<code>S3</code> object) with model attributes including:
</p>

<ul>
<li>
<p> y: a <code>(T x q)</code> matrix of observations.
</p>
</li>
<li>
<p> fitted: a <code>(T x q)</code> matrix of fitted values.
</p>
</li>
<li>
<p> resid: a <code>(T x q)</code> matrix of residuals.
</p>
</li>
<li>
<p> mu: a <code>(k x q)</code> matrix of estimated means of each process.
</p>
</li>
<li>
<p> stdev: List with <code>k</code> <code>(q x 1)</code> vector of estimated standard deviation of each process.
</p>
</li>
<li>
<p> sigma: List with <code>k</code> <code>(q x q)</code> estimated covariance matrix.
</p>
</li>
<li>
<p> theta: vector containing: <code>mu</code> and <code>vech(sigma)</code>.
</p>
</li>
<li>
<p> theta_mu_ind: vector indicating location of mean with <code>1</code> and <code>0</code> otherwise.
</p>
</li>
<li>
<p> theta_sig_ind: vector indicating location of variance and covariances with <code>1</code> and <code>0</code> otherwise.
</p>
</li>
<li>
<p> theta_var_ind: vector indicating location of variances with <code>1</code> and <code>0</code> otherwise.
</p>
</li>
<li>
<p> theta_var_ind: vector indicating location of transition matrix elements with <code>1</code> and <code>0</code> otherwise.
</p>
</li>
<li>
<p> n: number of observations (same as <code>T</code>).
</p>
</li>
<li>
<p> q: number of series.
</p>
</li>
<li>
<p> k: number of regimes in estimated model.
</p>
</li>
<li>
<p> P: a <code>(k x k)</code> transition matrix.
</p>
</li>
<li>
<p> pinf: a <code>(k x 1)</code> vector with limiting probabilities of each regime.
</p>
</li>
<li>
<p> St: a <code>(T x k)</code> vector with smoothed probabilities of each regime at each time <code>t</code>.
</p>
</li>
<li>
<p> deltath: double with maximum absolute difference in vector <code>theta</code> between last iteration.
</p>
</li>
<li>
<p> iterations: number of EM iterations performed to achieve convergence (if less than <code>maxit</code>).
</p>
</li>
<li>
<p> theta_0: vector of initial values used.
</p>
</li>
<li>
<p> init_used: number of different initial values used to get a finite solution. See description of input <code>maxit_converge</code>.
</p>
</li>
<li>
<p> msmu: Boolean. If <code>TRUE</code> model was estimated with switch in mean. If <code>FALSE</code> model was estimated with constant mean.
</p>
</li>
<li>
<p> msvar: Boolean. If <code>TRUE</code> model was estimated with switch in variance. If <code>FALSE</code> model was estimated with constant variance.
</p>
</li>
<li>
<p> control: List with model options used.
</p>
</li>
<li>
<p> logLike: log-likelihood.
</p>
</li>
<li>
<p> AIC: Akaike information criterion.
</p>
</li>
<li>
<p> BIC: Bayesian (Schwarz) information criterion.
</p>
</li>
<li>
<p> Hess: Hessian matrix. Approximated using <code>hessian</code> and only returned if <code>getSE=TRUE</code>.
</p>
</li>
<li>
<p> info_mat: Information matrix. Computed as the inverse of <code>-Hess</code>. If matrix is not PD then nearest PD matrix is obtained using <code>nearest_spd</code>. Only returned if <code>getSE=TRUE</code>.
</p>
</li>
<li>
<p> nearPD_used: Boolean determining whether <code>nearPD</code> function was used on <code>info_mat</code> if <code>TRUE</code> or not if <code>FALSE</code>. Only returned if <code>getSE=TRUE</code>.
</p>
</li>
<li>
<p> theta_se: standard errors of parameters in <code>theta</code>.  Only returned if <code>getSE=TRUE</code>.
</p>
</li>
<li>
<p> trace: List with Lists of estimation output for each initial value used due to <code>use_diff_init &gt; 1</code>.
</p>
</li>
</ul>
<h3>References</h3>

<p>Dempster, A. P., N. M. Laird, and D. B. Rubin. 1977. “Maximum Likelihood from Incomplete Data via the EM Algorithm.” <em>Journal of the Royal Statistical Society</em>. Series B 39 (1): 1–38..
</p>
<p>Hamilton, James D. 1990. “Analysis of time series subject to changes in regime.” <em>Journal of econometrics</em>, 45 (1-2): 39–70.
</p>
<p>Krolzig, Hans-Martin. 1997. “The markov-switching vector autoregressive model.”. Springer.
</p>


<h3>See Also</h3>

<p><code>Nmdl</code>
</p>


</div>