<div class="container">

<table style="width: 100%;"><tr>
<td>SelectionVarStat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Variable selection using multiple statistical tests.</h2>

<h3>Description</h3>

<p>This function performs a statistical test for each mass-over-charge value to determine which are discriminants between categories. Using the distribution of resulting multiple p-values, it determines an expected number of discriminant features, and adjusted p-values that can be used to control a false discovery rate threshold.
</p>


<h3>Usage</h3>

<pre><code class="language-R">
SelectionVarStat(X,
                 Y,
                 stat.test = "Limma",
                 pi0.method="abh",
                 fdr=0.05,
                 Sampling = c("no", "up","down", "smote"))

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a <code>numeric</code> matrix corresponding to a library of mass spectra. Rows of <code>X</code> are the intensities of a mass spectrum measured on mass-over-charge values. The columns are mass-over-charge values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>a <code>factor</code> with a length equal to the number of rows in <code>X</code> and containing the categories of each mass spectrum in <code>X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stat.test</code></td>
<td>
<p>a <code>character</code> among <code>"anova"</code>, <code>"kruskal"</code>, or <code>"Limma"</code> (default). It corresponds to the test used to know if the intensity measured at a mass-over-charge value is significantly different between categories. <code>"anova"</code> is for a classical ANOVA Fisher test, <code>"kruskal"</code> is for the Kruskal-Wallis test, <code>"Limma"</code> is for an ANOVA Fisher test using the <code>limma</code> R package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi0.method</code></td>
<td>
<p>a <code>character</code> among <code>"abh"</code>, <code>"st.spline"</code>, <code>"st.boot"</code>, <code>"langaas"</code>, <code>"histo"</code>, <code>"pounds"</code>, <code>"jiang"</code>, <code>"slim"</code>. It corresponds to statistical methods used to estimate the proportion of true null hypotheses among the set of tested mass-over-charge values. See the <code>estim.pi0</code> function of the R package <code>cp4p</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fdr</code></td>
<td>
<p>a <code>numeric</code> value corresponding to False Discovery Rate threshold used to determine the differential mass-over-charge values. 0.05 by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sampling</code></td>
<td>
<p>a <code>character</code> indicating an optional subsampling method to handle imbalanced datasets: subsampling methods are either <code>"no"</code> (no subsampling), <code>"up"</code>, <code>"down"</code> or <code>"smote"</code>. <code>"no"</code> by default.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>SelectionVarStat</code> function allows performing "quick" classification of mass-over-charge values. It tries to find all the mass-over-charge values (or the number of mass-over-charge values) that are discriminant between categories. This can conduct to select "correlated" mass-over-charge values (i.e. associated to intensities evolving similarly between categories). By default, multiple moderated t-tests using the <code>limma</code> R package (bayesian regularization of variances) are performed and the p-values are corrected using an adaptive Benjamini and Hochberg procedure to control the false discovery rate. Different ways to estimate the proportion of true null hypotheses (object <code>pi0</code> returned by the function - see the  <code>cp4p</code> R package for details) can be used for the adaptive Benjamini-Hochberg procedure ("<code>abh</code>" by defaut).</p>


<h3>Value</h3>

<p>A list composed of:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>nb_to_sel</code></td>
<td>
<p>a <code>numeric</code> value corresponding to an estimation of the optimal number of mass-over-charge values to discriminate between different groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sel_moz</code></td>
<td>
<p>a <code>vector</code> with selected discriminant mass-over-charge values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ap</code></td>
<td>
<p>a <code>list</code> composed of <code>pi0</code> the proportion of non-discriminant mass-over-charge values, and <code>adjp</code> a matrix of raw p-values and corresponding ajusted p-values for all the mass-over-charge values that have been tested.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Gianetto, Quentin &amp; Combes, Florence &amp; Ramus, Claire &amp; Bruley, Christophe &amp; Coute, Yohann &amp; Burger, Thomas. (2015). Technical Brief Calibration Plot for Proteomics (CP4P): A graphical tool to visually check the assumptions underlying FDR control in quantitative experiments. Proteomics. 16. 10.1002/pmic.201500189. 
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library("MSclassifR")
library("MALDIquant")

###############################################################################
## 1. Pre-processing of mass spectra

# load mass spectra and their metadata
data("CitrobacterRKIspectra","CitrobacterRKImetadata", package = "MSclassifR")
# standard pre-processing of mass spectra
spectra &lt;- MSclassifR::SignalProcessing(CitrobacterRKIspectra)
# detection of peaks in pre-processed mass spectra
peaks &lt;- MSclassifR::PeakDetection(x = spectra, labels = CitrobacterRKImetadata$Strain_name_spot)
# matrix with intensities of peaks arranged in rows (each column is a mass-over-charge value)
IntMat &lt;- MALDIquant::intensityMatrix(peaks)
rownames(IntMat) &lt;- paste(CitrobacterRKImetadata$Strain_name_spot)
# remove missing values in the matrix
IntMat[is.na(IntMat)] &lt;- 0
# normalize peaks according to the maximum intensity value for each mass spectrum
IntMat &lt;- apply(IntMat,1,function(x) x/(max(x)))
# transpose the matrix for statistical analysis
X &lt;- t(IntMat)
# define the known categories of mass spectra for the classification
Y &lt;- factor(CitrobacterRKImetadata$Species)

###############################################################################
## 2. Estimate the optimal number of peaks to discriminate the different species

OptiPeaks &lt;- SelectionVarStat(X,
                              Y,
                              stat.test = "Limma",
                              pi0.method="abh",
                              fdr=0.05,
                              Sampling="smote")
             
## Estimation of the optimal number of peaks to discriminate species (from the pi0 parameter)
OptiPeaks$nb_to_sel

## discriminant mass-over-chage values estimated using a 5 per cent false discovery rate
OptiPeaks$sel_moz

## p-values and adjusted p-values estimated for all the tested mass-over-charge values
OptiPeaks$ap$adjp


</code></pre>


</div>