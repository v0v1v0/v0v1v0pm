<div class="container">

<table style="width: 100%;"><tr>
<td>SignalProcessing</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function performing post acquisition signal processing</h2>

<h3>Description</h3>

<p>This function performs post acquisition signal processing for <code>list</code> of <code>MassSpectrum</code> objects using commonly used methods : transform intensities ("sqrt"), smoothing ("Wavelet"), remove baseline ("SNIP"), calibrate intensities ("TIC") and align spectra. Methods used are selected from the <code>MALDIquant</code> and <code>MALDIrppa</code> R packages.
</p>


<h3>Usage</h3>

<pre><code class="language-R">
SignalProcessing(x,
                 transformIntensity_method = "sqrt",
                 smoothing_method = "Wavelet",
                 removeBaseline_method = "SNIP",
                 removeBaseline_iterations = 25,
                 calibrateIntensity_method = "TIC",
                 alignSpectra_NoiseMethod = "MAD",
                 alignSpectra_method = "lowess",
                 alignSpectra_halfWs = 11,
                 alignSpectra_SN = 3,
                 tolerance_align = 0.002,
                 referenceSpectra = NULL,
                 minFrequency= 0.5,
                 binPeaks_method = "strict",
                 keepReferenceSpectra = FALSE,
                 ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a <code>list</code> of <code>MassSpectrum</code> objects (see <code>MALDIquant</code> R package).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transformIntensity_method</code></td>
<td>
<p>a <code>character</code> indicating the method used to transform intensities: <code>"sqrt"</code> by default. This function can be replaced by another mathematical function such as <code>"log"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smoothing_method</code></td>
<td>
<p>a <code>character</code> indicating the smoothing methods used. By default, it performs undecimated <code>Wavelet</code> transform (UDWT) for <code>list</code> of <code>MassSpectrum</code> objects. This Smoothing method can be remplaced by <code>"SavitzkyGolay"</code> or <code>"MovingAverage"</code>. See <code>wavSmoothing</code> in the <code>MALDIrppa</code> R package for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>removeBaseline_method</code></td>
<td>
<p>a <code>character</code> indicating the method used to remove baseline. It uses <code>"SNIP"</code> method for <code>list</code> of <code>MassSpectrum</code> objects. This baseline estimation method can be remplaced <code>"TopHat"</code>, <code>"ConvexHull"</code> or <code>"median"</code>. See <code>removeBaseline-methods</code> of the <code>MALDIquant</code> R package for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>removeBaseline_iterations</code></td>
<td>
<p>a <code>numeric</code> value indicting the number of iterations to remove baseline (by default = <code>25</code>). See <code>removeBaseline-methods</code> of the <code>MALDIquant</code> R package for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calibrateIntensity_method</code></td>
<td>
<p>a <code>character</code> indicating the intensities calibration method used (<code>"TIC"</code> method by default).  This calibration method can be remplaced by <code>"PQN"</code> or "median".See <code>calibrateIntensity-methods</code> of the <code>MALDIquant</code> R package for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alignSpectra_NoiseMethod</code></td>
<td>
<p>a <code>character</code> indicating the noise estimation method. It uses <code>"MAD"</code> method for <code>list</code> of <code>MassSpectrum</code> objects. This noise estimation method estimation method can be remplaced <code>"SuperSmoother"</code>. See <code>estimateNoise-methods</code> of the <code>MALDIquant</code> R package for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alignSpectra_method</code></td>
<td>
<p>a <code>character</code> indicating the warping method. It uses <code>"lowess"</code> method for <code>list</code> of <code>MassSpectrum</code> objects. This warping method method can be remplaced <code>"linear"</code>, <code>"quadratic"</code> or <code>"cubic"</code> . See <code>determineWarpingFunctions</code> of the <code>MALDIquant</code> R package for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alignSpectra_halfWs</code></td>
<td>
<p>a <code>numeric</code> value half window size to detect peaks (by default = <code>11</code>). See <code>detectPeaks-methods</code> of the <code>MALDIquant</code> R package for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alignSpectra_SN</code></td>
<td>
<p>a <code>numeric</code> value indicating the signal-to-noise ratio used to detect peaks (by default = <code>3</code>). See <code>detectPeaks-methods</code> of the <code>MALDIquant</code> R package for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolerance_align</code></td>
<td>
<p>a <code>numeric</code> value indicating a maximal relative deviation of a peak position (mass) to be considered as identical in ppm (by default = <code>0.002</code>). See <code>determineWarpingFunctions</code> of the <code>MALDIquant</code> R package for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>referenceSpectra</code></td>
<td>
<p>a <code>MassPeaks</code> reference spectrum for alignment of the sample(s). If this reference spectrum is not provided, a reference spectrum is created using the <code>minFrequency</code> and <code>binPeaks_method</code> arguments. See <code>referencePeaks</code> of the <code>MALDIquant</code> R package for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minFrequency</code></td>
<td>
<p>a <code>numeric</code> minimum frequency for each peak over all analyzed spectra (by default = <code>0.5</code>) for the creation of the reference spectrum. See <code>referencePeaks</code> of the <code>MALDIquant</code> R package for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binPeaks_method</code></td>
<td>
<p>a <code>character</code> indicating the method used to equalize masses for similar peaks for the creation of the reference spectrum. The <code>"strict"</code> method is used by default corresponding to a unique peak per bin from the same sample. This method can be remplaced by <code>"relaxed"</code> corresponding to multiple peaks per bin from the same sample. See <code>binPeaks</code> of the <code>MALDIquant</code> R package for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keepReferenceSpectra</code></td>
<td>
<p>a <code>logical</code> value indicating if the created reference spectrum is returned by the function (<code>FALSE</code>, default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments from <code>MALDIrppa</code> packages for the <code>wavSmoothing</code> function such as <code>n.levels</code> (corresponding to the depth of the decomposiion for the wavelet function). See <code>wavSmoothing</code> of the <code>MALDIrppa</code> R package for details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>SignalProcessing</code> function provides an analysis pipeline for <code>MassSpectrum</code> objects including intensity transformation, smoothing, removing baseline.
</p>
<p>The <code>Wavelet</code> method relies on the <code>wavShrink</code> function of the <code>wmtsa</code> package and its dependencies (now archived by CRAN). The original C code by William Constantine and Keith L. Davidson, in turn including copyrighted routines by Insightful Corp., has been revised and included into <code>MALDIrppa</code> for the method to work.
</p>
<p>All the methods used for <code>SignalProcessing</code> functions are selected from <code>MALDIquant</code> and <code>MALDIrppa</code> packages.
</p>


<h3>Value</h3>

<p>A list of modified <code>MassSpectrum</code> objects (see <code>MALDIquant</code> R package) according to chosen arguments. If the argument <code>referenceSpectra</code> is not completed and the argument <code>keepReferenceSpectra</code> is <code>TRUE</code>, a list containing the <code>MassSpectrum</code> objects modified named <code>"spectra"</code> and the created reference spectrum named <code>"RefS"</code> is returned.</p>


<h3>References</h3>

<p>Gibb S, Strimmer K. MALDIquant: a versatile R package for the analysis of mass spectrometry data. Bioinformatics. 2012 Sep 1;28(17):2270-1. doi: <a href="https://doi.org/10.1093/bioinformatics/bts447">10.1093/bioinformatics/bts447</a>. Epub 2012 Jul 12. PMID: 22796955.
</p>
<p>Javier Palarea-Albaladejo, Kevin Mclean, Frank Wright, David G E Smith, MALDIrppa: quality control and robust analysis for mass spectrometry data, Bioinformatics, Volume 34, Issue 3, 01 February 2018, Pages 522 - 523, doi: <a href="https://doi.org/10.1093/bioinformatics/btx628">10.1093/bioinformatics/btx628</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library("MALDIquant")
library("MSclassifR")

## Load mass spectra
data("CitrobacterRKIspectra", package = "MSclassifR")

# plot first unprocessed mass spectrum
PlotSpectra(SpectralData=CitrobacterRKIspectra[[1]], col_spec="blue")

## spectral treatment
spectra &lt;- SignalProcessing(CitrobacterRKIspectra,
                            transformIntensity_method = "sqrt",
                            smoothing_method = "Wavelet",
                            removeBaseline_method = "SNIP",
                            removeBaseline_iterations = 25,
                            calibrateIntensity_method = "TIC",
                            alignSpectra_Method = "MAD",
                            alignSpectra_halfWs = 11,
                            alignSpectra_SN = 3,
                            tolerance_align = 0.002)


# plot first processed mass spectrum
PlotSpectra(SpectralData=spectra[[1]], col_spec="blue")

</code></pre>


</div>