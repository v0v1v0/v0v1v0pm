<div class="container">

<table style="width: 100%;"><tr>
<td>PeakDetection</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Detection of peaks in <code>MassSpectrum</code> objects.</h2>

<h3>Description</h3>

<p>This function performs a data analysis pipeline to pre-process mass spectra. It provides average intensities and detects peaks using functions of R packages <code>MALDIquant</code> and <code>MALDIrppa</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PeakDetection(x,
              averageMassSpec = TRUE,
              labels = NULL,
              averageMassSpectraMethod = "median",
              SNRdetection = 3,
              binPeaks = TRUE,
              PeakDetectionMethod = "MAD",
              halfWindowSizeDetection = 11,
              AlignMethod = "strict",
              Tolerance = 0.002,
              ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a <code>list</code> of <code>MassSpectrum</code> objects (see <code>MALDIquant</code> R package).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>averageMassSpec</code></td>
<td>
<p>a <code>logical</code> value indicating whether it is necessary to group the spectra according to the arguments <code>labels</code> and  <code>averageMassSpectraMethod</code>. It is fixed to <code>"TRUE"</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>a <code>list</code> of <code>factor</code> objects to do groupwise averaging.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>averageMassSpectraMethod</code></td>
<td>
<p>a <code>character</code> indicating the method used to average mass spectra according to labels. It is fixed to <code>"median"</code> by default.This function can be replaced by another mathematical function such as <code>"mean"</code>. See <code>averageMassSpectra</code> of <code>MALDIquant</code> R package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PeakDetectionMethod</code></td>
<td>
<p>a <code>character</code> indicating the noise estimation method. It uses <code>"MAD"</code> method for <code>list</code> of <code>MassSpectrum</code> objects. This noise estimation method estimation method can be remplaced <code>"SuperSmoother"</code>. See <code>estimateNoise-methods</code> of the <code>MALDIquant</code> R package for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SNRdetection</code></td>
<td>
<p>a <code>numeric</code> value indicating the signal-to-noise ratio used to detect peaks (by default = <code>3</code>). See <code>detectPeaks-methods</code> of the <code>MALDIquant</code> R package for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binPeaks</code></td>
<td>
<p>a <code>logical</code> value indicating the peaks are aligned in discrete bins. It is fixed to <code>"TRUE"</code> by default. See <code>binPeaks</code> of the <code>MALDIquant</code> R package for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>halfWindowSizeDetection</code></td>
<td>
<p>a <code>numeric</code> value half window size to detect peaks (by default = <code>11</code>). See <code>detectPeaks-methods</code> of the <code>MALDIquant</code> R package for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AlignMethod</code></td>
<td>
<p>a <code>character</code> indicating the method used to equalize masses for similar peaks. The <code>"strict"</code> method is used by default corresponding to a unique peak per bin from the same sample. This method can be remplaced by <code>"relaxed"</code> corresponding to multiple peaks per bin from the same sample. See <code>binPeaks</code> of the <code>MALDIquant</code> R package for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tolerance</code></td>
<td>
<p>a <code>numeric</code> value corresponding to the maximal deviation in peak masses to be considered as identical in ppm (by default = <code>0.002</code>). See <code>determineWarpingFunctions</code> of the <code>MALDIquant</code> R package for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments from <code>MALDIquant</code> and <code>MALDIrppa</code> packages.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>PeakDetection</code> function provides an analysis pipeline for <code>MassSpectrum</code> objects including peaks detection and binning.
</p>
<p>All the methods used for <code>PeakDetection</code> functions are selected from <code>MALDIquant</code> and <code>MALDIrppa</code> packages.
</p>


<h3>Value</h3>

<p>Returns a list of <code>MassPeaks</code> objects (see <code>MALDIquant</code> R package) for each mass spectrum in <code>x</code>.</p>


<h3>References</h3>

<p>Gibb S, Strimmer K. MALDIquant: a versatile R package for the analysis of mass spectrometry data. Bioinformatics. 2012 Sep 1;28(17):2270-1. doi: <a href="https://doi.org/10.1093/bioinformatics/bts447">10.1093/bioinformatics/bts447</a>. Epub 2012 Jul 12. PMID: 22796955.
</p>
<p>Javier Palarea-Albaladejo, Kevin Mclean, Frank Wright, David G E Smith, MALDIrppa: quality control and robust analysis for mass spectrometry data, Bioinformatics, Volume 34, Issue 3, 01 February 2018, Pages 522 - 523, doi: <a href="https://doi.org/10.1093/bioinformatics/btx628">10.1093/bioinformatics/btx628</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library("MALDIquant")
library("MSclassifR")


## Load mass spectra and metadata
data("CitrobacterRKIspectra", "CitrobacterRKImetadata", package = "MSclassifR")

## Pre-processing of mass spectra
spectra &lt;- SignalProcessing(CitrobacterRKIspectra)

## Detection of peaks in pre-processed mass spectra
peaks &lt;- PeakDetection(x = spectra,
                       averageMassSpec = FALSE,
                       labels = CitrobacterRKImetadata$Strain_name_spot,
                       averageMassSpectraMethod = "median",
                       SNRdetection = 3,
                       binPeaks = TRUE,
                       halfWindowSizeDetection = 11,
                       AlignFrequency = 0.20,
                       AlignMethod = "strict",
                       Tolerance = 0.002)

# Plot peaks on a pre-processed mass spectrum
PlotSpectra(SpectralData=spectra[[1]],Peaks=peaks[[1]],col_spec="blue",col_peak="black")
</code></pre>


</div>