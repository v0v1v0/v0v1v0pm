<div class="container">

<table style="width: 100%;"><tr>
<td>multiscale_test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Carries out the multiscale test given that the values the estimatates of
long-run variance have already been computed.</h2>

<h3>Description</h3>

<p>Carries out the multiscale test given that the values the estimatates of
long-run variance have already been computed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">multiscale_test(
  data,
  sigma = 1,
  sigma_vec = 1,
  n_ts = 1,
  grid = NULL,
  ijset = NULL,
  alpha = 0.05,
  sim_runs = 1000,
  deriv_order = 0,
  correction = TRUE,
  epidem = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Vector (in case of n_ts = 1) or matrix (in case of
n_ts &gt; 1) that contains (a number of) time series
that needs to be analyzed. In the latter case,
each column of the matrix must contain one time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>The estimator of the square root of the long-run
variance <code class="reqn">\sigma</code> in case of n_ts = 1,
or the estimator of the overdispersion parameter
<code class="reqn">\sigma</code> in case of n_ts &gt; 1 and epidemic = TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma_vec</code></td>
<td>
<p>Vector that consists of estimators of the square root
of the long-run variances <code class="reqn">\sigma_i</code> in case of
n_ts &gt; 1 and epidemic = FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_ts</code></td>
<td>
<p>Number of time series analysed. Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>Grid of location-bandwidth points as produced by
the functions <code>construct_grid</code> or
<code>construct_weekly_grid</code>, it is a list with
the elements 'gset', 'bws', 'gtype'. If not provided,
then the defalt grid is used.
For the construction of the default grid,
see <code>construct_grid</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ijset</code></td>
<td>
<p>In case of multiple time series (n_ts &gt; 1),
we need to know which pairs of time series to compare.
This matrix consists of all pairs of indices <code class="reqn">(i, j)</code>
that we want to compare. If not provided, then all
possible pairwise comparison are performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Significance level. Default is <code class="reqn">0.05</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sim_runs</code></td>
<td>
<p>Number of simulation runs to produce quantiles.
Default is 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deriv_order</code></td>
<td>
<p>In case of a single time series, this denotes the order of
the derivative of the trend that we estimate.
Default is 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correction</code></td>
<td>
<p>Logical variable, TRUE (by default) is we are using
<code class="reqn">a_k</code> and <code class="reqn">b_k</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epidem</code></td>
<td>
<p>Logical variable, TRUE if we are using
dealing with epidemic time trends. Default is FALSE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>In case of n_ts = 1, the function returns a list
with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>testing_result</code></td>
<td>
<p>A string that contains the result of the testing:
either the null hypothesis is rejected or not,
what is the confidence level and what is value of
the test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quant</code></td>
<td>
<p>Quantile that was used for testing calculated from
the Gaussian distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistics</code></td>
<td>
<p>Value of the multiscale statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test_matrix</code></td>
<td>
<p>Matrix of the test results for the multiscale test
defined in Khismatullina and Vogt (2019).
The matrix is coded as follows:
</p>

<ul>
<li>
<p> test_matrix[i,j] = -1: test rejects the null for the
j-th location <code class="reqn">u</code> and the i-th bandwidth <code class="reqn">h</code> and
indicates a decrease in the trend;
</p>
</li>
<li>
<p> test_matrix[i,j] = 0: test does not reject the null
for the j-th location <code class="reqn">u</code> and the i-th
bandwidth <code class="reqn">h</code>;
</p>
</li>
<li>
<p> test_matrix[i,j] = 1:  test rejects the null for the
j-th location <code class="reqn">u</code> and the i-th bandwidth <code class="reqn">h</code> and
indicates an increase in the trend;
</p>
</li>
<li>
<p> test_matrix[i,j] = 2: no test is carried out at j-th
location <code class="reqn">u</code> and i-th bandwidth <code class="reqn">h</code> (because
the point <code class="reqn">(u, h)</code> is excluded from the grid
as specified by the 'deletions' option
in the function <code>construct_grid</code>)</p>
</li>
</ul>
<p>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gset_with_vals</code></td>
<td>
<p>A matrix that contains the values of the normalised 
kernel averages and test results for each pair
of location-bandwidth
with the corresponding location and bandwidth.</p>
</td>
</tr>
</table>
<p>In case of n_ts &gt; 1, the function returns a list
with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>quant</code></td>
<td>
<p>Quantile that was used for testing calculated from
the gaussian distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistics</code></td>
<td>
<p>Value of the multiscale statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stat_pairwise</code></td>
<td>
<p>Matrix of the values of the pairwise statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ijset</code></td>
<td>
<p>The matrix that  consists of all pairs of indices
<code class="reqn">(i, j)</code> that we compared. The order of these
pairs corresponds to the order in the list
gset_with_vals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gset_with_vals</code></td>
<td>
<p>A list of matrices, each matrix corresponding to a 
specific pairwise comparison. The order of the list 
is determined by ijset. Each matrix contains
the values of the normalisedkernel averages
for each pair of location-bandwidth
with the corresponding location and bandwidth.</p>
</td>
</tr>
</table>
</div>