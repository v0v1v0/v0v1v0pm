<div class="container">

<table style="width: 100%;"><tr>
<td>msmFit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fitting Markov Switching Models
</h2>

<h3>Description</h3>

<p><code>msmFit</code> is an implementation for modeling Markov Switching Models using the EM algorithm
</p>


<h3>Usage</h3>

<pre><code class="language-R">	msmFit(object, k, sw, p, data, family, control)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p> an object of class "lm" or "glm", or "formula" with a symbolic description of the model to be fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p> numeric, the estimated number of regimes that the model has.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sw</code></td>
<td>
<p>a logical vector indicatig which coefficients have switching.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>integer, the number of AR coefficients that the MS model has to have. The default value is zero. If <code>p</code> is higher than zero, the last values of <code>sw</code> have to contain the AR coefficients which have switching.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> an optional data frame, list or environment (or object coercible by as.data.frame to a data frame) containing the variables in the model. If not found in data, the variables are taken from environment(formula), typically the environment from which "glm" is called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>a character value indicating what family belongs to the model. It is only required when the object is a "General linear formula".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p> a list of control parameters. See "Details".</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>control</code> argument is a list that can supply any of the following components:
</p>
<p>-<code>trace</code>: A logical value. If it is TRUE, tracing information on the progress of the optimization is produced.
</p>
<p>-<code>maxiter</code>: The maximum number of iterations in the EM method. Default is 100.
</p>
<p>-<code>tol</code>: Tolerance. The algorithm stops if it is unable to reduce the value by a factor of <code>tol</code> at a step. Default is 1e-8.
</p>
<p>-<code>maxiterOuter</code>: The number of short runs of the EM method to stablish the initial values. Default is 5
</p>
<p>-<code>maxiterInner</code>: The number of iterations in the EM method in each short run to stablish the initial values. Default is 10
</p>
<p>-<code>parallelization</code>: A logical value. Whether the process is done by using parallelization or not. Default is TRUE.
</p>


<h3>Value</h3>

<p><code>msm.fit</code> returns an object of class <code>MSM.lm</code> or <code>MSM.glm</code>, depending on the input model. 
</p>


<h3>Author(s)</h3>

<p>Jose A. Sanchez-Espigares, Alberto Lopez-Moreno
</p>


<h3>References</h3>

<p>Hamilton J.D. (1989). A New Approach to the Economic Analysis of Nonstionary Time Series and the Business Cycle. Econometrica 57: 357-384<br>
Hamilton, J.D. (1994). Time Series Analysis. Princeton University Press.<br>
Goldfeld, S., Quantd, R. (2005). 'A  Markov model for switching Regression',Journal of Econometrics 135, 349-376.<br>
Perlin, M. (2007). 'Estimation, Simulation and Forecasting of a Markov Switching Regression', (General case in Matlab).<br></p>


<h3>See Also</h3>

<p>Overview: <code>MSwM-package</code> <br>
Classes : <code>MSM.lm</code>, <code>MSM.glm</code>, <code>MSM.fitted</code><br>
Methods : <code>msmFit</code>,<code>summary</code>,<code>AIC</code>,<code>intervals</code>,<code>msmResid</code><br>
Plot : <code>plot</code>,<code>plotProb</code>,<code>plotReg</code>,<code>plotDiag</code><br></p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run
##	data(energy)
##	model=lm(Price~Oil+Gas+Coal+EurDol+Ibex35+Demand,energy)
##	mod=msmFit(model,k=2,sw=rep(TRUE,8))
##  summary(mod)
## End(Not run)</code></pre>


</div>