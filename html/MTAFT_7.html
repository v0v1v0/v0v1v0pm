<div class="container">

<table style="width: 100%;"><tr>
<td>TSMCP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>TSMCP: Two stage multiple change points detection for AFT model.</h2>

<h3>Description</h3>

<p>This function first formulates the threshold problem as a group model selection problem
so that a concave 2-norm group selection method can be applied using the 'grpreg'
package in R, and then finalizes it via a refining method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">TSMCP(Y, X, delta, c, penalty = "scad")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>the censored logarithm of the failure time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>the design matrix without the intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>the censoring indicator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p>the length of each segment in the splitting stage, defined as
<code>ceiling(c * sqrt(length(Y)))</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>
<p>Penalty type (default is "scad").</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object with the following components:
</p>

<dl>
<dt>cp</dt>
<dd>
<p>the change points.</p>
</dd>
<dt>coef</dt>
<dd>
<p>the estimated coefficients.</p>
</dd>
<dt>sigma</dt>
<dd>
<p>the variance of the error.</p>
</dd>
<dt>residuals</dt>
<dd>
<p>the residuals.</p>
</dd>
<dt>Yn</dt>
<dd>
<p>weighted Y by Kaplan-Meier weight.</p>
</dd>
<dt>Xn</dt>
<dd>
<p>weighted Xn by Kaplan-Meier weight.</p>
</dd>
</dl>
<h3>References</h3>

<p>Li, Jialiang, and Baisuo Jin. 2018. “Multi-Threshold Accelerated Failure Time Model.”
The Annals of Statistics 46 (6A): 2657–82.
</p>


<h3>See Also</h3>

<p><code>grpreg</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(grpreg)
# Generate simulated data with 500 samples and normal error distribution
dataset &lt;- MTAFT_simdata(n = 500, err = "normal")
Y &lt;- dataset[, 1]
delta &lt;- dataset[, 2]
Tq &lt;- dataset[, 3]
X &lt;- dataset[, -c(1:3)]
n1 = sum(delta)
c=seq(0.5,1.5,0.1)
m=ceiling(c*sqrt(n1))
bicy= rep(NA,length(c))
tsmc=NULL
p = ncol(X)
for(i in 1:length(c)){
    tsm=try(TSMCP(Y,X,delta,c[i],penalty = "scad"),silent=TRUE)
    if(is(tsm,"try-error")) next()
    bicy[i]=log(n)*((length(tsm[[1]])+1)*(p+1))+n*log(tsm[[3]])
    tsmc[[i]]=tsm
}

if((any(!is.na(bicy)))){
    tsmcp=tsmc[[which(bicy==min(bicy))[1]]]
    thre.LJ = Tq[tsmcp[[1]]]
    thre.num.Lj = length(thre.LJ)
    thre.LJ
    thre.num.Lj
}

</code></pre>


</div>