<div class="container">

<table style="width: 100%;"><tr>
<td>mvlm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Conduct multivariate multiple regression and MANOVA with analytic p-values</h2>

<h3>Description</h3>

<p><code>mvlm</code> is used to fit linear models with a multivariate outcome. It uses
the asymptotic null distribution of the multivariate linear model test
statistic to compute p-values (McArtor et al., under review). It therefore
alleviates the need to use approximate p-values based Wilks' Lambda, Pillai's
Trace, the Hotelling-Lawley Trace, and Roy's Greatest Root.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mvlm(formula, data, n.cores = 1, start.acc = 1e-20,
  contr.factor = "contr.sum", contr.ordered = "contr.poly")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>An object of class <code>formula</code> where the outcome (e.g. the
Y in the following formula: Y ~ x1 + x2) is a <code>n x q matrix</code>, where
<code>q</code> is the number of outcome variables being regressed onto the set
of predictors included in the formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Mandatory <code>data.frame</code> containing all of the predictors
passed to <code>formula</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.cores</code></td>
<td>
<p>Number of cores to use in parallelization through the
<code>parallel</code> pacakge.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.acc</code></td>
<td>
<p>Starting accuracy of the Davies (1980) algorithm
implemented in the <code>davies</code> function in the <code>CompQuadForm</code>
package (Duchesne &amp;  De Micheaux, 2010) that <code>mvlm</code> uses to compute
multivariate linear model p-values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contr.factor</code></td>
<td>
<p>The type of contrasts used to test unordered categorical
variables that have type <code>factor</code>. Must be a string taking one of the
following values: <code>("contr.sum", "contr.treatment", "contr.helmert")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contr.ordered</code></td>
<td>
<p>The type of contrasts used to test ordered categorical
variables that have type <code>ordered</code>. Must be a string taking one of the
following values: <code>("contr.poly", "contr.sum", "contr.treatment",
"contr.helmert")</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Importantly, the outcome of <code>formula</code> must be a <code>matrix</code>, and the
object passed to <code>data</code> must be a data frame containing all of the
variables that are named as predictors in <code>formula</code>.
</p>
<p>The conditional effects of variables of type <code>factor</code> or <code>ordered</code>
in <code>data</code> are computed based on the type of contrasts specified by
<code>contr.factor</code> and <code>contr.ordered</code>. If <code>data</code> contains an
(ordered or unordered) factor with <code>k</code> levels, a <code>k-1</code> degree of
freedom test will be conducted corresponding to that factor and the specified
contrast structure. If, instead, the user wants to assess <code>k-1</code> separate
single DF tests that comprise this omnibus effect (similar to the approach
taken by <code>lm</code>), then the appropriate model matrix should be formed in
advance and passed to <code>mvlm</code> directly in the <code>data</code> parameter. See
the package vigentte for an example by calling
<code>vignette('mvlm-vignette')</code>.
</p>


<h3>Value</h3>

<p>An object with nine elements and a summary function. Calling
<code>summary(mvlm.res)</code> produces a data frame comprised of:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Statistic</code></td>
<td>
<p>Value of the corresponding test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Numer DF</code></td>
<td>
<p>Numerator degrees of freedom for each test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pseudo R2</code></td>
<td>
<p>Size of the corresponding (omnibus or conditional) effect
on the multivariate outcome. Note that the intercept term does not have
an estimated effect size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p-value</code></td>
<td>
<p>The p-value for each (omnibus or conditional) effect.</p>
</td>
</tr>
</table>
<p>In addition to the information in the three columns comprising
<code>summary(mvlm.res)</code>, the <code>mvlm.res</code> object also contains:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>p.prec</code></td>
<td>
<p>A data.frame reporting the precision of each p-value.
These are the maximum error bound of the p-values reported by the
<code>davies</code> function in <code>CompQuadForm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.rsq</code></td>
<td>
<p>A matrix containing in its first row the overall variance
explained by the model for variable comprising Y (columns). The remaining
rows list the variance of each outcome that is explained by the conditional
effect of each predictor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.hat</code></td>
<td>
<p>Estimated regression coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj.n</code></td>
<td>
<p>Adjusted sample size used to determine whether or not the
asmptotic properties of the model are likely to hold. See McArtor et al.
(under review) for more detail.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Original input data and the <code>model.matrix</code> used to fit the
model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>The formula passed to <code>mvlm</code>.</p>
</td>
</tr>
</table>
<p>Note that the printed output of <code>summary(res)</code> will truncate p-values
to the smallest trustworthy values, but the object returned by
<code>summary(mvlm.res)</code> will contain the p-values as computed. If the error
bound of the Davies algorithm is larger than the p-value, the only conclusion
that can be drawn with certainty is that the p-value is smaller than (or
equal to) the error bound.
</p>


<h3>Author(s)</h3>

<p>Daniel B. McArtor (dmcartor@nd.edu) [aut, cre]
</p>


<h3>References</h3>

<p>Davies, R. B. (1980). The Distribution of a Linear Combination of
chi-square Random Variables. Journal of the Royal Statistical Society.
Series C (Applied Statistics), 29(3), 323-333.
</p>
<p>Duchesne, P., &amp; De Micheaux, P.L. (2010). Computing the distribution of
quadratic forms: Further comparisons between the Liu-Tang-Zhang
approximation and exact methods. Computational Statistics and Data
Analysis, 54(4), 858-862.
</p>
<p>McArtor, D. B., Grasman, R. P. P. P., Lubke, G. H., &amp; Bergeman, C. S.
(under review). A new approach to conducting linear model hypothesis tests
with a multivariate outcome.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(mvlmdata)

Y &lt;- as.matrix(Y.mvlm)

# Main effects model
mvlm.res &lt;- mvlm(Y ~ Cont + Cat + Ord, data = X.mvlm)
summary(mvlm.res)

# Include two-way interactions
mvlm.res.int &lt;- mvlm(Y ~ .^2, data = X.mvlm)
summary(mvlm.res.int)

</code></pre>


</div>