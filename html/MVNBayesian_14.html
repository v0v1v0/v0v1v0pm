<div class="container">

<table style="width: 100%;"><tr>
<td>MVN_MCMC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
MCMC simulation for MVN distribution
</h2>

<h3>Description</h3>

<p>Function to get a MCMC simulation results based on the imported MVN distribution. It is commonly used for inquiring the specified conditional probability of MVN distribuiton calculated through Bayesian posteriori.
</p>


<h3>Usage</h3>

<pre><code class="language-R"># Bayesian posteriori as input data
# data &lt;- MVN_BayesianPosteriori(dataset1, pri_mean=c(80,16,3))

# run MCMC simulation using Bayesian posteriori:
MVN_MCMC(data, steps, pars, values, tol, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>A double level list which contains the mean vector (<code>data$mean</code>) and the covariance matrix (<code>data$var</code>) of a given MVN distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>steps</code></td>
<td>

<p>A positive integer. The numbers of random vectors to be generated for MCMC step.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pars</code></td>
<td>

<p>A integer vector to declare fixed dimension(s). For example if the desired dimensions are 1st=7 and 3rd=10, set this argument as c(1,3).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>values</code></td>
<td>

<p>A numeric vector to assign value(s) to declared dimension(s). For example if the desired dimensions are 1st=7 and 3rd=10, set this argument as c(7,10).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>

<p>Tolerance. A numeric value to control the generated vectors to be accepted or rejected. Criterion uses Euclidean distance in declared dimension(s). Default value is 0.3.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Other arguments to control the process in Gibbs sampling.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>return a list which contains:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>AcceptRate</code></td>
<td>
<p>Acceptance of declared conditions of MCMC</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MCMCdata</code></td>
<td>
<p>All generated random vectors in MCMC step based on MVN distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Accept</code></td>
<td>
<p>Subset of accepted sampling in MCMCdata</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Reject</code></td>
<td>
<p>Subset of rejected sampling in MCMCdata</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>MVN_GibbsSampler</code>, <code>MVN_FConditional</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(mvtnorm)
library(plyr)

# dataset1 has three parameters: fac1, fac2 and fac3:
head(dataset1)

# Get posteriori parameters of dataset1 using prior of c(80,16,3):
BPos &lt;- MVN_BayesianPosteriori(dataset1, pri_mean=c(80,16,3))

# If we want to know when fac1=78, how fac2 responses to fac3, run:
BPos_MCMC &lt;- MVN_MCMC(BPos, steps=8000, pars=c(1), values=c(78), tol=0.3)
MCMC &lt;- BPos_MCMC$MCMCdata
head(MCMC)

# Visualization using plot3d() if necessary:
library(rgl)
plot3d(MCMC[,1], MCMC[,2], z=MCMC[,3], col=MCMC[,5]+1, size=2)

# Visualization: 2d scatter plot
MCMC_2d &lt;- BPos_MCMC$Accept
head(MCMC_2d)
plot(MCMC_2d[,3], MCMC_2d[,2], pch=20, col="red", xlab = "fac3", ylab = "fac2")

# Compared to the following scatter plot when fac1 is not fixed:
plot(BPos_MCMC$MCMCdata[,3], BPos_MCMC$MCMCdata[,2], pch=20, col="red", xlab = "fac3",
ylab = "fac2")

</code></pre>


</div>