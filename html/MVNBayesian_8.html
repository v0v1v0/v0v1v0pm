<div class="container">

<table style="width: 100%;"><tr>
<td>MixMVN_MCMC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
MCMC simulation for MVN mixture distribution
</h2>

<h3>Description</h3>

<p>Function to get a MCMC simulation results based on the imported MVN mixture distribution. It is commonly used for inquiring the specified conditional probability of MVN mixture distribuiton calculated through Bayesian posteriori.
</p>


<h3>Usage</h3>

<pre><code class="language-R"># Bayesian posteriori mix MVN as input data:
# data &lt;- MixMVN_BayesianPosteriori(dataset2[,1:4], 3)

# run MCMC simulation based on Bayesian posteriori mix MVN:
MixMVN_MCMC(data, steps, pars, values, tol, random_method, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>A matrix-like data containing the mixture probability, mean vector and covariance matrix for each cluster in each row.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>steps</code></td>
<td>

<p>A positive integer. The numbers of random vectors to be generated for MCMC step.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pars</code></td>
<td>

<p>A integer vector to declare fixed dimension(s). For example if the desired dimensions are 1st=7 and 3rd=10, set this argument as c(1,3).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>values</code></td>
<td>

<p>A numeric vector to assign value(s) to declared dimension(s). For example if the desired dimensions are 1st=7 and 3rd=10, set this argument as c(7,10).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>

<p>Tolerance. A numeric value to control the generated vectors to be accepted or rejected. Criterion uses Euclidean distance in declared dimension(s). Default value is 0.3.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random_method</code></td>
<td>

<p>The method to generate random vectors. Options are <code>"Gibbs"</code>: Gibbs sampling for MVN mixture model; and <code>"Fast"</code>: call <code>rmvnorm()</code> to generate random vectors based on matrix factorization. Default option is <code>"Fast"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Other arguments to control the process in Gibbs sampling if the <code>random_method</code> is "Gibbs".
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>return a list which contains:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>AcceptRate</code></td>
<td>
<p>Acceptance of declared conditions of MCMC</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MCMCdata</code></td>
<td>
<p>All generated random vectors in MCMC step based on MVN mixture distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Accept</code></td>
<td>
<p>Subset of accepted sampling in MCMCdata</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Reject</code></td>
<td>
<p>Subset of rejected sampling in MCMCdata</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>MixMVN_BayesianPosteriori</code>, <code>MixMVN_GibbsSampler</code>, <code>MVN_GibbsSampler</code>, <code>MVN_FConditional</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(plyr)
library(mvtnorm)
library(stats)

# dataset2 has 4 parameters: dimen1, dimen2, dimen3 and dimen4:
head(dataset2)
dataset2_dim &lt;- dataset2[,1:4] # extract parametric columns

# Get posteriori parameters of dataset2 using kmeans 3 clustering:
MixBPos &lt;- MixMVN_BayesianPosteriori(dataset2_dim, 3)

# If we want to know when dimen1=1, which clusters are accepted, run:
MixBPos_MCMC &lt;- MixMVN_MCMC(MixBPos, steps=5000, pars=c(1), values=c(1), tol=0.3)
MixBPos_MCMC$AcceptRate
result &lt;- MixBPos_MCMC$MCMCdata
head(result)

# count accepted samples by clustering:
count(result[which(result[,7]==1),5])

library(rgl)
# Visualization using plot3d() if necessary:
# Clustering result in the rest 3 dimensions:
plot3d(result[,2], result[,3], z=result[,4], col=result[,5], size=2)

# Acceptance rejection visualization:
plot3d(result[,2], result[,3], z=result[,4], col=result[,7]+1, size=2)

</code></pre>


</div>