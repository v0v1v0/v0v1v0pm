<div class="container">

<table style="width: 100%;"><tr>
<td>cluster.diagnostic</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function for Plotting Summary Cluster Diagnostic Plots</h2>

<h3>Description</h3>

<p>Plot similarity statistic profiles and the optimal joint clustering configuration for the means and the variances by group.
</p>
<p>Plot quantile profiles of means and standard deviations by group and for each clustering configuration, to check that the distributions 
of first and second moments of the MVR-transformed data approach their respective null distributions under the optimal configuration found, 
assuming independence and normality of all the variables.
</p>


<h3>Usage</h3>

<pre><code class="language-R">    cluster.diagnostic(obj, 
                       span = 0.75, 
                       degree = 2, 
                       family = "gaussian", 
                       title = "Cluster Diagnostic Plots", 
                       device = NULL, 
                       file = "Cluster Diagnostic Plots",
                       path = getwd(),
                       horizontal = FALSE, 
                       width = 8.5, 
                       height = 11, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>Object of class "<code>mvr</code>" returned by <code>mvr</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>Title of the plot. Defaults to "Cluster Diagnostic Plots".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>span</code></td>
<td>
<p>Span parameter of the <code>loess()</code> function (R package <span class="pkg">stats</span>), which controls the degree of smoothing. 
Defaults to 0.75.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>
<p>Degree parameter of the <code>loess()</code> function (R package <span class="pkg">stats</span>), which controls the degree of the polynomials to be used. 
Defaults to 2. (Normally 1 or 2. Degree 0 is also allowed, but see the "Note" in loess stats package.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>Family distribution in "gaussian", "symmetric" of the <code>loess()</code> function (R package <span class="pkg">stats</span>), used for local fitting .
If "gaussian" fitting is by least-squares, and if "symmetric" a re-descending M estimator is used with Tukey's biweight function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>device</code></td>
<td>
<p>Graphic display device in {NULL, "PS", "PDF"}. Defaults to NULL (standard output screen).
Currently implemented graphic display devices are "PS" (Postscript) or "PDF" (Portable Document Format).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>File name for output graphic. Defaults to "Cluster Diagnostic Plots".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path</code></td>
<td>
<p>Absolute path (without final (back)slash separator). Defaults to working directory path.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>horizontal</code></td>
<td>
<p><code>Logical</code> scalar. Orientation of the printed image. Defaults to <code>FALSE</code>, that is potrait orientation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p><code>Numeric</code> scalar. Width of the graphics region in inches. Defaults to 8.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>height</code></td>
<td>
<p><code>Numeric</code> scalar. Height of the graphics region in inches. Defaults to 11.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Generic arguments passed to other plotting functions.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In a plot of a similarity statistic profile, one checks the goodness of fit of the transformed data relative to the hypothesized underlying reference 
distribution with mean-0 and standard deviation-1 (e.g. <code class="reqn">N(0, 1)</code>). The red dashed line depicts the LOESS scatterplot smoother estimator.
The subroutine internally generates reference null distributions for computing the similarity statistic under each cluster configuration. 
The optimal cluster configuration (indicated by the vertical red arrow) is found where the similarity statistic reaches its minimum plus/minus 
one standard deviation (applying the conventional one-standard deviation rule). A smaller cluster number configuration indicates under-regularization, 
while over-regularization starts to occur at larger numbers. This over/under-regularization must be viewed as a form of over/under-fitting 
(see <cite>Dazard, J-E. and J. S. Rao (2012)</cite> for more details).
The quantile diagnostic plots uses empirical quantiles of the transformed means and standard deviations to check how 
closely they are approximated by theoretical quantiles derived from a standard normal <em>equal-mean</em>/<em>homoscedastic</em> 
model (solid green lines) under a given cluster configuration. To assess this goodness of fit of the transformed data, theoretical null distributions 
of the mean and variance are derived from a standard normal <em>equal-mean</em>/<em>homoscedastic</em> model with independence of the first two moments, 
i.e. assuming i.i.d. normality of the raw data. However, we do not require i.i.d. normality of the data in general: these theoretical null distributions are 
just used here as convenient ones to draw from. Note that under the assumptions that the raw data is i.i.d. standard normal ($N(0, 1)$) 
with independence of first two moments, the theoretical null distributions of means and standard deviations for each variable 
are respectively: <code class="reqn">N(0, \frac{1}{n})</code> and <code class="reqn">\sqrt{\frac{\chi_{n - G}^{2}}{n - G}}</code>, where <code class="reqn">G</code> denotes the number of sample groups. 
The optimal cluster configuration found is indicated by the most horizontal red curve. The single cluster configuration, corresponding to no transformation, 
is the most vertical curve, while the largest cluster number configuration reaches horizontality. Notice how empirical quantiles of transformed
pooled means and standard deviations converge (from red to black) to the theoretical null distributions (solid green lines) for the optimal 
configuration. One should see a convergence towards the target null, after which overfitting starts to occur (see <cite>Dazard, J-E. and J. S. Rao (2012)</cite> 
for more details).
Both cluster diagnostic plots help determine (i) whether the minimum of the <em>Similarity Statistic</em> is observed within the range of clusters 
(i.e. a large enough number of clusters has been accommodated), and (ii) whether the corresponding cluster configuration is a good fit. 
If necessary, run the procedure again with larger value of the <code>nc.max</code> parameter in the <code>mvr</code> as well as 
in <code>mvrt.test</code> functions until the minimum of the similarity statistic profile is reached.       
</p>
<p>Option <code>file</code> is used only if device is specified (i.e. non <code>NULL</code>).
</p>


<h3>Value</h3>

<p>None. Displays the plots on the chosen <code>device</code>.
</p>


<h3>Acknowledgments</h3>

<p>This work made use of the High Performance Computing Resource in the Core Facility for Advanced Research Computing at Case Western Reserve University. 
This project was partially funded by the National Institutes of Health (P30-CA043703).
</p>


<h3>Note</h3>

<p>End-user function.
</p>


<h3>Author(s)</h3>


<ul>
<li>
<p> "Jean-Eudes Dazard, Ph.D." <a href="mailto:jean-eudes.dazard@case.edu">jean-eudes.dazard@case.edu</a>
</p>
</li>
<li>
<p> "Hua Xu, Ph.D." <a href="mailto:huaxu77@gmail.com">huaxu77@gmail.com</a>
</p>
</li>
<li>
<p> "Alberto Santana, MBA." <a href="mailto:ahs4@case.edu">ahs4@case.edu</a>
</p>
</li>
</ul>
<p>Maintainer: "Jean-Eudes Dazard, Ph.D." <a href="mailto:jean-eudes.dazard@case.edu">jean-eudes.dazard@case.edu</a>    
</p>


<h3>References</h3>


<ul>
<li>
<p> Dazard J-E. and J. S. Rao (2010). "<em>Regularized Variance Estimation and Variance Stabilization of High-Dimensional Data.</em>"
In JSM Proceedings, Section for High-Dimensional Data Analysis and Variable Selection. 
Vancouver, BC, Canada: American Statistical Association IMS - JSM, 5295-5309.
</p>
</li>
<li>
<p> Dazard J-E., Hua Xu and J. S. Rao (2011). "<em>R package MVR for Joint Adaptive Mean-Variance Regularization and Variance Stabilization.</em>"
In JSM Proceedings, Section for Statistical Programmers and Analysts. 
Miami Beach, FL, USA: American Statistical Association IMS - JSM, 3849-3863.
</p>
</li>
<li>
<p> Dazard J-E. and J. S. Rao (2012). "<em>Joint Adaptive Mean-Variance Regularization and Variance Stabilization of High Dimensional Data.</em>"
Comput. Statist. Data Anal. 56(7):2317-2333.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>loess</code> (R package <span class="pkg">stats</span>) Fit a polynomial surface determined by one or more numerical predictors, using local fitting.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
    #===================================================
    # Loading the library and its dependencies
    #===================================================
    library("MVR")

    #===================================================
    # MVR package news
    #===================================================
    MVR.news()

    #================================================
    # MVR package citation
    #================================================
    citation("MVR")

    #===================================================
    # Loading of the Synthetic and Real datasets
    # (see description of datasets)
    #===================================================
    data("Synthetic", "Real", package="MVR")
    ?Synthetic
    ?Real

    #===================================================
    # Mean-Variance Regularization (Real dataset)
    # Multi-Group Assumption
    # Assuming unequal variance between groups
    # Without cluster usage
    ===================================================
    nc.min &lt;- 1
    nc.max &lt;- 30
    probs &lt;- seq(0, 1, 0.01)
    n &lt;- 6
    GF &lt;- factor(gl(n = 2, k = n/2, length = n), 
                 ordered = FALSE, 
                 labels = c("M", "S"))
    mvr.obj &lt;- mvr(data = Real, 
                   block = GF, 
                   log = FALSE, 
                   nc.min = nc.min, 
                   nc.max = nc.max, 
                   probs = probs,
                   B = 100, 
                   parallel = FALSE, 
                   conf = NULL,
                   verbose = TRUE,
                   seed = 1234)

    #===================================================
    # Summary Cluster Diagnostic Plots (Real dataset)
    # Multi-Group Assumption
    # Assuming unequal variance between groups
    #===================================================
    cluster.diagnostic(obj = mvr.obj, 
                       title = "Cluster Diagnostic Plots 
                       (Real - Multi-Group Assumption)",
                       span = 0.75, 
                       degree = 2, 
                       family = "gaussian",
                       device = NULL,
                       horizontal = FALSE, 
                       width = 8.5, 
                       height = 11)

    
## End(Not run)
</code></pre>


</div>