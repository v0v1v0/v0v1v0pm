<div class="container">

<table style="width: 100%;"><tr>
<td>target.diagnostic</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function for Plotting Summary Target Moments Diagnostic Plots</h2>

<h3>Description</h3>

<p>Plot comparative distribution densities of means and standard deviations of the data before and after Mean-Variance Regularization
to check for location shifts between observed first and second moments and their expected target values under a target centered homoscedastic model. 
</p>
<p>Plot comparative QQ scatterplots to look at departures between observed distributions of first and second moments of the MVR-transformed data
and their theoretical distributions assuming independence and normality of all the variables.
</p>


<h3>Usage</h3>

<pre><code class="language-R">    target.diagnostic(obj, 
                      title = "Target Moments Diagnostic Plots",
                      device = NULL, 
                      file = "Target Moments Diagnostic Plots",
                      path = getwd(),
                      horizontal = FALSE, 
                      width = 8.5, 
                      height = 6.5, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>Object of class "<code>mvr</code>" returned by <code>mvr</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>Title of the plot. Defaults to "Target Moments Diagnostic Plots".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>device</code></td>
<td>
<p>Graphic display device in {NULL, "PS", "PDF"}. Defaults to NULL (standard output screen).
Currently implemented graphic display devices are "PS" (Postscript) or "PDF" (Portable Document Format).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>File name for output graphic. Defaults to "Target Moments Diagnostic Plots".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path</code></td>
<td>
<p>Absolute path (without final (back)slash separator). Defaults to working directory path.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>horizontal</code></td>
<td>
<p><code>Logical</code> scalar. Orientation of the printed image. Defaults to <code>FALSE</code>, that is potrait orientation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p><code>Numeric</code> scalar. Width of the graphics region in inches. Defaults to 8.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>height</code></td>
<td>
<p><code>Numeric</code> scalar. Height of the graphics region in inches. Defaults to 6.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Generic arguments passed to other plotting functions.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The plots of the density distribution of means and standard deviations checks that the distributions of means and standard deviations 
of the MVR-transformed data have correct target first moments, i.e. with mean ~ 0 and mean ~ 1. The expected target mean and standard 
deviation are shown in red (before and) after MVR-transformation. Caption shows the p-values from the parametric two-sample two-sided t-tests 
for the equality of parameters to their expectations (assuming normality since usually sample sizes are large : <code class="reqn">p \gg 1</code>, 
or a relative robustness to moderate violations of the normality assumption).
</p>
<p>In the general case, the variables are not normally distributed and not even independent and identically distributed before 
and after MVR-transformation. Therefore, the distributions of untransformed first and second moments usually differ from their respective 
theoretical null distributions, i.e., from <code class="reqn">N(0, \frac{1}{n})</code> for the means and from <code class="reqn">\sqrt{\frac{\chi_{n - G}^{2}}{n - G}}</code> for the standard 
deviations, where <code class="reqn">G</code> denotes the number of sample groups (see <cite>Dazard, J-E. and J. S. Rao (2012)</cite> for more details). 
Also, the observed distributions of transformed first and second moments are unknown. This is reflected in the QQ plots, 
where theoretical and empirical quantiles do not necessarily align with each other. Caption shows the p-values from the nonparametric two-sample 
two-sided Kolmogorov-Smirnov tests of the null hypothesis that a parameter distribution differs from its theoretical distribution. 
Each black dot represents a variable. The red solid line depicts the interquartile line, which passes through the first and third quartiles. 
</p>
<p>Option <code>file</code> is used only if device is specified (i.e. non <code>NULL</code>).
</p>


<h3>Value</h3>

<p>None. Displays the plots on the chosen <code>device</code>.
</p>


<h3>Acknowledgments</h3>

<p>This work made use of the High Performance Computing Resource in the Core Facility for Advanced Research Computing at Case Western Reserve University. 
This project was partially funded by the National Institutes of Health (P30-CA043703).
</p>


<h3>Note</h3>

<p>End-user function.
</p>


<h3>Author(s)</h3>


<ul>
<li>
<p> "Jean-Eudes Dazard, Ph.D." <a href="mailto:jean-eudes.dazard@case.edu">jean-eudes.dazard@case.edu</a>
</p>
</li>
<li>
<p> "Hua Xu, Ph.D." <a href="mailto:huaxu77@gmail.com">huaxu77@gmail.com</a>
</p>
</li>
<li>
<p> "Alberto Santana, MBA." <a href="mailto:ahs4@case.edu">ahs4@case.edu</a>
</p>
</li>
</ul>
<p>Maintainer: "Jean-Eudes Dazard, Ph.D." <a href="mailto:jean-eudes.dazard@case.edu">jean-eudes.dazard@case.edu</a>    
</p>


<h3>References</h3>


<ul>
<li>
<p> Dazard J-E. and J. S. Rao (2010). "<em>Regularized Variance Estimation and Variance Stabilization of High-Dimensional Data.</em>"
In JSM Proceedings, Section for High-Dimensional Data Analysis and Variable Selection. 
Vancouver, BC, Canada: American Statistical Association IMS - JSM, 5295-5309.
</p>
</li>
<li>
<p> Dazard J-E., Hua Xu and J. S. Rao (2011). "<em>R package MVR for Joint Adaptive Mean-Variance Regularization and Variance Stabilization.</em>"
In JSM Proceedings, Section for Statistical Programmers and Analysts. 
Miami Beach, FL, USA: American Statistical Association IMS - JSM, 3849-3863.
</p>
</li>
<li>
<p> Dazard J-E. and J. S. Rao (2012). "<em>Joint Adaptive Mean-Variance Regularization and Variance Stabilization of High Dimensional Data.</em>"
Comput. Statist. Data Anal. 56(7):2317-2333.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>justvsn</code> (R package <span class="pkg">vsn</span>) Variance stabilization and calibration for microarray data.
<code>loess</code> (R package <span class="pkg">stats</span>) Fit a polynomial surface determined by one or more numerical predictors, using local fitting.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
    #===================================================
    # Loading the library and its dependencies
    #===================================================
    library("MVR")
    library("RColorBrewer")

    #===================================================
    # MVR package news
    #===================================================
    MVR.news()

    #================================================
    # MVR package citation
    #================================================
    citation("MVR")

    #===================================================
    # Loading of the Synthetic and Real datasets
    # (see description of datasets)
    #===================================================
    data("Synthetic", "Real", package="MVR")
    ?Synthetic
    ?Real

    #===================================================
    # Mean-Variance Regularization (Real dataset)
    # Multi-Group Assumption
    # Assuming unequal variance between groups
    # Without cluster usage
    #===================================================
    nc.min &lt;- 1
    nc.max &lt;- 30
    probs &lt;- seq(0, 1, 0.01)
    n &lt;- 6
    GF &lt;- factor(gl(n = 2, k = n/2, length = n), 
                 ordered = FALSE, 
                 labels = c("M", "S"))
    mvr.obj &lt;- mvr(data = Real, 
                   block = GF, 
                   log = FALSE, 
                   nc.min = nc.min, 
                   nc.max = nc.max, 
                   probs = probs,
                   B = 100, 
                   parallel = FALSE, 
                   conf = NULL,
                   verbose = TRUE,
                   seed = 1234)

    #===================================================
    # Summary Target Moments Diagnostic Plots (Real dataset)
    # Multi-Group Assumption
    # Assuming unequal variance between groups
    #===================================================
    target.diagnostic(obj = mvr.obj, 
                      title = "Target Moments Diagnostic Plots 
                      (Real - Multi-Group Assumption)",
                      device = NULL,
                      horizontal = FALSE, 
                      width = 8.5, 
                      height = 6.5)
    
## End(Not run)
</code></pre>


</div>