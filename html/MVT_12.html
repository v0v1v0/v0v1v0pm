<div class="container">

<table style="width: 100%;"><tr>
<td>mStudent</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multivariate t distribution</h2>

<h3>Description</h3>

<p>These functions provide the density and random number generation from the multivariate 
Student-t distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dmt(x, mean = rep(0, nrow(Sigma)), Sigma = diag(length(mean)), eta = 0.25, log = FALSE)
rmt(n = 1, mean = rep(0, nrow(Sigma)), Sigma = diag(length(mean)), eta = 0.25)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> vector or matrix of data. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p> the number of samples requested.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p> a vector giving the means of each variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p> a positive-definite covariance matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>
<p> shape parameter (must be in <code>[0,1/2)</code>). Default value is <code>0.25</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p> logical; if TRUE, the logarithm of the density function is returned.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A random vector <code class="reqn">\bold{X} = (X_1,\dots,X_p)^T</code> has a multivariate <em>t</em> distribution, 
with a <code class="reqn">\bold{\mu}</code> mean vector, covariance matrix <code class="reqn">\bold{\Sigma}</code>, and <code class="reqn">0 \leq \eta 
  &lt; 1/2</code> shape parameter, if its density function is given by
</p>
<p style="text-align: center;"><code class="reqn">
    f(\bold{x}) = K_p(\eta)|\bold{\Sigma}|^{-1/2}\left\{1 + c(\eta)(\bold{x} - \bold{\mu})^T 
    \bold{\Sigma}^{-1} (\bold{x} - \bold{\mu})\right\}^{-\frac{1}{2\eta}(1 + \eta p)}.
  </code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">
    K_p(\eta) = \left(\frac{c(\eta)}{\pi}\right)^{p/2}\frac{\Gamma(\frac{1}{2\eta}(1 + \eta p))}
    {\Gamma(\frac{1}{2\eta})},
  </code>
</p>

<p>with <code class="reqn">c(\eta)=\eta/(1 - 2\eta)</code>. This parameterization of the multivariate <em>t</em> distribution
is introduced mainly because <code class="reqn">\bold{\mu}</code> and <code class="reqn">\bold{\Sigma}</code> correspond to the mean vector 
and covariance matrix, respectively.
</p>
<p>The function <code>rmt</code> is an interface to C routines, which make calls to subroutines from LAPACK. 
The matrix decomposition is internally done using the Cholesky decomposition. If <code>Sigma</code> is not 
non-negative definite then there will be a warning message.
</p>
<p>This parameterization of the multivariate-<em>t</em> includes the normal distribution as a particular 
case when <code>eta = 0</code>.
</p>


<h3>Value</h3>

<p>If <code>x</code> is a matrix with <code class="reqn">n</code> rows, then <code>dmt</code> returns a <code class="reqn">n\times 1</code> 
vector considering each row of <code>x</code> as a copy from the multivariate <em>t</em> distribution.
</p>
<p>If <code>n = 1</code>, then <code>rmt</code> returns a vector of the same length as <code>mean</code>, otherwise 
a matrix of <code>n</code> rows of random vectors.
</p>


<h3>References</h3>

<p>Fang, K.T., Kotz, S., Ng, K.W. (1990).
<em>Symmetric Multivariate and Related Distributions</em>.
Chapman &amp; Hall, London.
</p>
<p>Gomez, E., Gomez-Villegas, M.A., Marin, J.M. (1998).
A multivariate generalization of the power exponential family of distributions.
<em>Communications in Statistics - Theory and Methods</em> <b>27</b>, 589-600.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># covariance matrix
Sigma &lt;- matrix(c(10,3,3,2), ncol = 2)
Sigma

# generate the sample
y &lt;- rmt(n = 1000, Sigma = Sigma)

# scatterplot of a random bivariate t sample with mean vector
# zero and covariance matrix 'Sigma'
par(pty = "s")
plot(y, xlab = "", ylab = "")
title("bivariate t sample (eta = 0.25)", font.main = 1)
</code></pre>


</div>