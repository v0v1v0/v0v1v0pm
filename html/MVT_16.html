<div class="container">

<table style="width: 100%;"><tr>
<td>WH.student</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Wilson-Hilferty transformation</h2>

<h3>Description</h3>

<p>Returns the Wilson-Hilferty transformation of random variables with <code class="reqn">F</code> distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">WH.student(x, center, cov, eta = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> object of class <code>'studentFit'</code> from which is extracted the estimated Mahalanobis distances of the fitted model.
Also <code>x</code> can be a vector or matrix of data with, say, <code class="reqn">p</code> columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p> mean vector of the distribution or second data vector of length <code class="reqn">p</code>. Not required if <code>x</code> have class <code>'studentFit'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov</code></td>
<td>
<p> covariance matrix (<code class="reqn">p</code> by <code class="reqn">p</code>) of the distribution. Not required if <code>x</code> have class <code>'studentFit'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>
<p> shape parameter of the multivariate t-distribution. By default the multivariate normal (<code>eta = 0</code>) is considered.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Let <code class="reqn">F</code> the following random variable:
</p>
<p style="text-align: center;"><code class="reqn">F = \frac{D^2/p}{1-2\eta}</code>
</p>

<p>where <code class="reqn">D^2</code> denotes the squared Mahalanobis distance defined as
</p>
<p style="text-align: center;"><code class="reqn">D^2 = (x - \mu)^T \Sigma^{-1} (x - \mu)</code>
</p>

<p>Thus the Wilson-Hilferty transformation is given by
</p>
<p style="text-align: center;"><code class="reqn">z = \frac{(1 - \frac{2\eta}{9})F^{1/3} - (1 - \frac{2}{9p})}{(\frac{2\eta}{9}F^{2/3} + \frac{2}{9p})^{1/2}}%
  </code>
</p>

<p>and <code class="reqn">z</code> is approximately distributed as a standard normal distribution. This is useful, for instance, in the construction of
QQ-plots.
</p>
<p>For <code>eta = 0</code>, we obtain
</p>
<p style="text-align: center;"><code class="reqn">z = \frac{F^{1/3} - (1 - \frac{2}{9p})}{(\frac{2}{9p})^{1/2}}%
  </code>
</p>

<p>which is the Wilson-Hilferty transformation for chi-square variables.
</p>


<h3>References</h3>

<p>Osorio, F., Galea, M., Henriquez, C., Arellano-Valle, R. (2023).
Addressing non-normality in multivariate analysis using the <em>t</em>-distribution. 
<em>AStA Advances in Statistical Analysis</em> <b>107</b>, 785-813.
</p>
<p>Wilson, E.B., and Hilferty, M.M. (1931).
The distribution of chi-square.
<em>Proceedings of the National Academy of Sciences of the United States of America</em> <b>17</b>, 684-688.
</p>


<h3>See Also</h3>

<p><code>cov</code>, <code>mahalanobis</code>, <code>envelope.student</code></p>


<h3>Examples</h3>

<pre><code class="language-R">data(companies)
x &lt;- companies
z &lt;- WH.student(x, center = colMeans(x), cov = cov(x))
par(pty = "s")
qqnorm(z, main = "Transformed distances Q-Q plot")
abline(c(0,1), col = "red", lwd = 2)
</code></pre>


</div>