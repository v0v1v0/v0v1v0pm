<div class="container">

<table style="width: 100%;"><tr>
<td>MLModel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MLModel and MLModelFunction Class Constructors</h2>

<h3>Description</h3>

<p>Create a model or model function for use with the <span class="pkg">MachineShop</span> package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MLModel(
  name = "MLModel",
  label = name,
  packages = character(),
  response_types = character(),
  weights = FALSE,
  predictor_encoding = c(NA, "model.frame", "model.matrix"),
  na.rm = FALSE,
  params = list(),
  gridinfo = tibble::tibble(param = character(), get_values = list(), default =
    logical()),
  fit = function(formula, data, weights, ...) stop("No fit function."),
  predict = function(object, newdata, times, ...) stop("No predict function."),
  varimp = function(object, ...) NULL,
  ...
)

MLModelFunction(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>character name of the object to which the model is assigned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label</code></td>
<td>
<p>optional character descriptor for the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>packages</code></td>
<td>
<p>character vector of package names upon which the model
depends.  Each name may be optionally followed by a comment in
parentheses specifying a version requirement.  The comment should contain
a comparison operator, whitespace and a valid version number, e.g.
<code>"xgboost (&gt;= 1.3.0)"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>response_types</code></td>
<td>
<p>character vector of response variable types to which
the model can be fit.  Supported types are <code>"binary"</code>,
<code>"BinomialVariate"</code>, <code>"DiscreteVariate"</code>, <code>"factor"</code>,
<code>"matrix"</code>, <code>"NegBinomialVariate"</code>, <code>"numeric"</code>,
<code>"ordered"</code>, <code>"PoissonVariate"</code>, and <code>"Surv"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>logical value or vector of the same length as
<code>response_types</code> indicating whether case weights are supported for
the responses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predictor_encoding</code></td>
<td>
<p>character string indicating whether the model is
fit with predictor variables encoded as a <code>"model.frame"</code>,
a <code>"model.matrix"</code>, or unspecified (default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>character string or logical specifying removal of <code>"all"</code>
(<code>TRUE</code>) cases with missing values from model fitting and prediction,
<code>"none"</code> (<code>FALSE</code>), or only those whose missing values are in the
<code>"response"</code> variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>list of user-specified model parameters to be passed to the
<code>fit</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gridinfo</code></td>
<td>
<p>tibble of information for construction of tuning grids
consisting of a character column <code>param</code> with the names of parameters
in the grid, a list column <code>get_values</code> with functions to generate grid
points for the corresponding parameters, and an optional logical column
<code>default</code> indicating which parameters to include by default in regular
grids.  Values functions may optionally include arguments <code>n</code> and
<code>data</code> for the number of grid points to generate and a
<code>ModelFrame</code> of the model fit data and formula, respectively;
and must include an ellipsis (<code>...</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>model fitting function whose arguments are a <code>formula</code>, a
<code>ModelFrame</code> named <code>data</code>, case <code>weights</code>, and an
ellipsis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predict</code></td>
<td>
<p>model prediction function whose arguments are the
<code>object</code> returned by <code>fit</code>, a <code>ModelFrame</code> named
<code>newdata</code> of predictor variables, optional vector of <code>times</code> at
which to predict survival, and an ellipsis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varimp</code></td>
<td>
<p>variable importance function whose arguments are the
<code>object</code> returned by <code>fit</code>, optional arguments passed from calls
to <code>varimp</code>, and an ellipsis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to other methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>function that returns an <code>MLModel</code> object when called
without any supplied argument values.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If supplied, the <code>grid</code> function should return a list whose elements are
named after and contain values of parameters to include in a tuning grid to
be constructed automatically by the package.
</p>
<p>Arguments <code>data</code> and <code>newdata</code> in the <code>fit</code> and <code>predict</code>
functions may be converted to data frames with <code>as.data.frame()</code>
if needed for their operation.  The <code>fit</code> function should return the
object resulting from the model fit.  Values returned by the <code>predict</code>
functions should be formatted according to the response variable types below.
</p>

<dl>
<dt>factor</dt>
<dd>
<p>matrix whose columns contain the probabilities for
multi-level factors or vector of probabilities for the second level of
binary factors.</p>
</dd>
<dt>matrix</dt>
<dd>
<p>matrix of predicted responses.</p>
</dd>
<dt>numeric</dt>
<dd>
<p>vector or column matrix of predicted responses.</p>
</dd>
<dt>Surv</dt>
<dd>
<p>matrix whose columns contain survival probabilities at
<code>times</code> if supplied or a vector of predicted survival means
otherwise.</p>
</dd>
</dl>
<p>The <code>varimp</code> function should return a vector of importance values named
after the predictor variables or a matrix or data frame whose rows are named
after the predictors.
</p>
<p>The <code>predict</code> and <code>varimp</code> functions are additionally passed a list
named <code>.MachineShop</code> containing the <code>input</code>
and <code>model</code> from <code>fit</code>.  This argument may
be included in the function definitions as needed for their implementations.
Otherwise, it will be captured by the ellipsis.
</p>


<h3>Value</h3>

<p>An <code>MLModel</code> or <code>MLModelFunction</code> class object.
</p>


<h3>See Also</h3>

<p><code>models</code>, <code>fit</code>, <code>resample</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Logistic regression model
LogisticModel &lt;- MLModel(
  name = "LogisticModel",
  response_types = "binary",
  weights = TRUE,
  fit = function(formula, data, weights, ...) {
    glm(formula, data = as.data.frame(data), weights = weights,
        family = binomial, ...)
  },
  predict = function(object, newdata, ...) {
    predict(object, newdata = as.data.frame(newdata), type = "response")
  },
  varimp = function(object, ...) {
    pchisq(coef(object)^2 / diag(vcov(object)), 1)
  }
)

data(Pima.tr, package = "MASS")
res &lt;- resample(type ~ ., data = Pima.tr, model = LogisticModel)
summary(res)

</code></pre>


</div>