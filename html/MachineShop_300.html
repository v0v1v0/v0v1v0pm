<div class="container">

<table style="width: 100%;"><tr>
<td>step_sbf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Variable Selection by Filtering</h2>

<h3>Description</h3>

<p>Creates a <em>specification</em> of a recipe step that will select variables
from a candidate set according to a user-specified filtering function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">step_sbf(
  recipe,
  ...,
  filter,
  multivariate = FALSE,
  options = list(),
  replace = TRUE,
  prefix = "SBF",
  role = "predictor",
  skip = FALSE,
  id = recipes::rand_id("sbf")
)

## S3 method for class 'step_sbf'
tidy(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>recipe</code></td>
<td>
<p>recipe object to which the step will be added.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>one or more selector functions to choose which variables will be
used to compute the components.  See <code>selections</code> for
more details.  These are not currently used by the <code>tidy</code> method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter</code></td>
<td>
<p>function whose first argument <code>x</code> is a univariate vector
or a <code>multivariate</code> data frame of candidate variables from which to
select, second argument <code>y</code> is the response variable as
defined in preceding recipe steps, and third argument <code>step</code> is the
current step.  The function should return a logical value or vector of
length equal the number of variables in <code>x</code> indicating whether to
select the corresponding variable, or return a list or data frame with
element <code>`selected`</code> containing the logical(s) and possibly with other
elements of the same length to be included in output from the <code>tidy</code>
method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>multivariate</code></td>
<td>
<p>logical indicating that candidate variables be passed to
the <code>x</code> argument of the <code>filter</code> function separately as
univariate vectors if <code>FALSE</code>, or altogether in one multivariate data
frame if <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>options</code></td>
<td>
<p>list of elements to be added to the step object for use in the
<code>filter</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replace</code></td>
<td>
<p>logical indicating whether to replace the original variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prefix</code></td>
<td>
<p>if the original variables are not replaced, the selected
variables are added to the dataset with the character string prefix added
to their names; otherwise, the original variable names are retained.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>role</code></td>
<td>
<p>analysis role that added step variables should be assigned.  By
default, they are designated as model predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skip</code></td>
<td>
<p>logical indicating whether to skip the step when the recipe is
baked.  While all operations are baked when <code>prep</code> is
run, some operations may not be applicable to new data (e.g. processing
outcome variables).  Care should be taken when using <code>skip = TRUE</code> as
it may affect the computations for subsequent operations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>unique character string to identify the step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p><code>step_sbf</code> object.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An updated version of <code>recipe</code> with the new step added to the
sequence of existing steps (if any).  For the <code>tidy</code> method, a tibble
with columns <code>terms</code> (selectors or variables selected), <code>selected</code>
(logical indicator of selected variables), and <code>name</code> of the selected
variable names.
</p>


<h3>See Also</h3>

<p><code>recipe</code>, <code>prep</code>,
<code>bake</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(recipes)

glm_filter &lt;- function(x, y, step) {
  model_fit &lt;- glm(y ~ ., data = data.frame(y, x))
  p_value &lt;- drop1(model_fit, test = "F")[-1, "Pr(&gt;F)"]
  p_value &lt; step$threshold
}

rec &lt;- recipe(rating ~ ., data = attitude)
sbf_rec &lt;- rec %&gt;%
  step_sbf(all_numeric_predictors(),
           filter = glm_filter, options = list(threshold = 0.05))

sbf_prep &lt;- prep(sbf_rec, training = attitude)
sbf_data &lt;- bake(sbf_prep, attitude)

pairs(sbf_data, lower.panel = NULL)

tidy(sbf_rec, number = 1)
tidy(sbf_prep, number = 1)

</code></pre>


</div>