<div class="container">

<table style="width: 100%;"><tr>
<td>vm_step</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>V-Step of the VEM algorithm</h2>

<h3>Description</h3>

<p>Maximization step of the Variational EM algorithm used to compute
hyper-parameters of all the kernels involved in MagmaClust.
</p>


<h3>Usage</h3>

<pre><code class="language-R">vm_step(
  db,
  old_hp_k,
  old_hp_i,
  list_mu_param,
  kern_k,
  kern_i,
  m_k,
  common_hp_k,
  common_hp_i,
  pen_diag
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>db</code></td>
<td>
<p>A tibble or data frame. Columns required: ID, Input, Output.
Additional columns for covariates can be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>old_hp_k</code></td>
<td>
<p>A named vector, tibble or data frame, containing the
hyper-parameters from the previous M-step (or initialisation) associated
with the mean GPs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>old_hp_i</code></td>
<td>
<p>A named vector, tibble or data frame, containing the
hyper-parameters from the previous  M-step (or initialisation) associated
with the individual GPs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>list_mu_param</code></td>
<td>
<p>List of parameters of the K mean GPs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kern_k</code></td>
<td>
<p>A kernel used to compute the covariance matrix of the mean GP
at corresponding timestamps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kern_i</code></td>
<td>
<p>A kernel used to compute the covariance matrix of individuals
GP at corresponding timestamps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m_k</code></td>
<td>
<p>A named list of prior mean parameters for the K mean GPs.
Length = 1 or nrow(unique(db$Input))</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>common_hp_k</code></td>
<td>
<p>A boolean indicating whether hp are common among
mean GPs (for each mu_k)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>common_hp_i</code></td>
<td>
<p>A boolean indicating whether hp are common among
individual GPs (for each y_i)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pen_diag</code></td>
<td>
<p>A number. A jitter term, added on the diagonal to prevent
numerical issues when inverting nearly singular matrices.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A named list, containing the elements <code>hp_k</code>, a tibble
containing the hyper-parameters associated with each cluster,
<code>hp_i</code>, a tibble containing the hyper-parameters
associated with the individual GPs, and <code>prop_mixture_k</code>,
a tibble containing the hyper-parameters associated with each individual,
indicating the probabilities to belong to each cluster.
</p>


<h3>Examples</h3>

<pre><code class="language-R">TRUE
</code></pre>


</div>