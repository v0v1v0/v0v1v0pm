<div class="container">

<table style="width: 100%;"><tr>
<td>Manly.EM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> EM algorithm for Manly mixture model </h2>

<h3>Description</h3>

<p>Runs the EM algorithm for a Manly mixture model with specified initial membership and transformation parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Manly.EM(X, id = NULL, la = NULL, tau = NULL, Mu = NULL, S = NULL, 
tol = 1e-5, max.iter = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X </code></td>
<td>
<p> dataset matrix (n x p)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id </code></td>
<td>
<p> initial membership vector (length n)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>la </code></td>
<td>
<p> initial transformation parameters (K x p)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau </code></td>
<td>
<p> initial vector of mixing proportions (length K)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mu </code></td>
<td>
<p> initial matrix of mean vectors (K x p)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S </code></td>
<td>
<p> initial array of covariance matrices (p x p x K)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol </code></td>
<td>
<p> tolerance level</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.iter </code></td>
<td>
<p> maximum number of iterations</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Runs the EM algorithm for a Manly mixture model for a provided dataset. Manly mixture model assumes that a multivariate Manly transformation applied to each component allows to reach near-normality. 
A user has a choice to specify either initial id vector 'id' and transformation parameters 'la' or initial mode parameters 'la', 'tau', 'Mu', and 'S'. In the case when transformation parameters are not provided, the function runs the EM algorithm without any transformations, i.e., it is equivalent to the EM algorithm for a Gaussian mixtuire model. If some transformation parameters have to be excluded from the consideration, in the corresponding positions of matrix 'la', the user has to specify value 0.
Notation: n - sample size, p - dimensionality of the dataset X, K - number of mixture components.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>la </code></td>
<td>
<p> matrix of the estimated transformation parameters (K x p)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau </code></td>
<td>
<p> vector of mixing proportions (length K)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mu </code></td>
<td>
<p> matrix of the estimated mean vectors (K x p)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S </code></td>
<td>
<p> array of the estimated covariance matrices (p x p x K)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma </code></td>
<td>
<p> matrix of posterior probabilities (n x K)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id </code></td>
<td>
<p> estimated membership vector (length n)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ll </code></td>
<td>
<p> log likelihood value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bic </code></td>
<td>
<p> Bayesian Information Criterion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter </code></td>
<td>
<p> number of EM iterations run</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flag </code></td>
<td>
<p> convergence flag (0 - success, 1 - failure)</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p>Manly.select</p>


<h3>Examples</h3>

<pre><code class="language-R">
set.seed(123)

K &lt;- 3; p &lt;- 4
X &lt;- as.matrix(iris[,-5])
id.true &lt;- rep(1:K, each = 50)

# Obtain initial memberships based on the K-means algorithm
id.km &lt;- kmeans(X, K)$cluster

# Run the EM algorithm for a Gaussian mixture model based on K-means solution
A &lt;- Manly.EM(X, id.km)
id.Gauss &lt;- A$id

ClassAgree(id.Gauss, id.true)

# Run the EM algorithm for a Manly mixture model based on Gaussian mixture solution
la &lt;- matrix(0.1, K, p)
B &lt;- Manly.EM(X, id.Gauss, la)
id.Manly &lt;- B$id

ClassAgree(id.Manly, id.true)

</code></pre>


</div>