<div class="container">

<table style="width: 100%;"><tr>
<td>predict.gamcox</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Prediction Method for <code>gamcox</code> Fits</h2>

<h3>Description</h3>

<p>Obtains spatial effects predictions and optionally estimates standard errors and confidence intervals of those predictions from a fitted Cox proportional hazard additive model object.</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class "gamcox"
## S3 method for class 'gamcox'
 predict(object, newdata = object$data, se.fit = FALSE, type=c("spatial","all"),
        reference = "median", level = 0.05, verbose=FALSE,...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>a fitted <code>gamcox</code> object.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>

<p>a data frame containing the values at which predictions are required. This argument can be missing, in which case predictions are made at the same values used to compute the object. A comprehensive effect (hazard ratio) of the covariates included in <code>newdata</code> will be predicted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.fit</code></td>
<td>

<p>if <code>TRUE</code>, pointwise standard errors and confidence intervals are computed along with the predictions.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>use <code>type="spatial"</code>(default) to estimate spatial effect, and use <code>type="all"</code> to estimate the effect of all covariates included in the model.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reference</code></td>
<td>

<p>the type of reference for the estimated effect. If <code>reference = "median"</code>,  the output will be the estimated hazard ratio (or log-ratio) compared to the median effect. If <code>reference = "mean"</code>,the output will be the estimated hazard ratio (or log-ratio) compared to the mean effect.If <code>reference</code> is a data frame indicating a specific geolocation, the out put will be the estimated hazard ratio (or log ratio) compared to the hazard of the geolocation specified by <code>reference</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>the confidence level for condifence bands.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>a logical value indicating whether to print filling values for newdata. The default is <code>verbose = FALSE</code>.      
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>extra arguments for S3 generic, ignored by <code>predict.gamcox</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pred</code></td>
<td>
<p>the estimated log hazards ratio compared to the effect specified by <code>reference</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>

<p>the standard errors along with the predictions.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.low</code></td>
<td>
<p>the lower bounds for pointwise (1-<code>level</code>) confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.high</code></td>
<td>
<p>the higher bounds for pointwise (1-<code>level</code>) confidence intervals.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Lu Bai
</p>
<p>Send bug reports to <a href="mailto:sbartell@uci.edu">sbartell@uci.edu</a>.
</p>


<h3>References</h3>

<p>Hastie TJ, Tibshirani RJ.  Generalized Additive Models.  (Chapman &amp; Hall/CRC Monographs on Statistics &amp; Applied Probability, Boca Raton, Florida, 1990).  
</p>


<h3>See Also</h3>

<p><code>modgam</code>, 
<code>predict.gamcox</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(CAdata)
data(CAmap)
fit &lt;- gamcox(Surv(time,event)~AGE + factor(INS) + lo(X,Y),data=CAdata,
       span=0.2,loess.trace="approximate")
fit
pred1 = predict(fit)
colormap(list(fit=pred1$pred,grid=data.frame(X=CAdata$X,Y=CAdata$Y)),map=CAmap,
         border.gray=0.5)

data(CAgrid)
pred2 = predict(fit,CAgrid[,c("X","Y")])
colormap(list(fit=pred2$pred,grid=data.frame(X=CAgrid$X,Y=CAgrid$Y)),map=CAmap,
        border.gray=0.5, legend.name="log hazard ratio")

## Circle significant areas based on the confidence intervals specified by conf.low and conf.high
pred3 = predict(fit,CAgrid[,c("X","Y")],se.fit=TRUE)
colormap(list(fit=pred3$pred,conf.low = pred3$conf.low, conf.high = pred3$conf.high,
          grid=data.frame(X=CAgrid$X,Y=CAgrid$Y)),map=CAmap,border.gray = 0.7,
          contours = "interval",legend.name="log hazard ratio")

</code></pre>


</div>