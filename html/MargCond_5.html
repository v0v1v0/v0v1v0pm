<div class="container">

<table style="width: 100%;"><tr>
<td>MargCond</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Function to fit joint marginal-conditional models for longitudinal multivariate data.
</h2>

<h3>Description</h3>

<p>Produces an object of class <code>"MargCond"</code> which is a marginal-conditional multivariate model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MargCond(formula, data, ID, tol = 1e-04, max.iter = 50, 
       corstr = "independence", silent = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>

<p>a two-sided linear formula object similar to those in <code>lmer</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>a data frame in which to interpret the variables occuring in the <code>formula</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ID</code></td>
<td>

<p>a vector which identifies the clusters. The length of <code>ID</code> should be the same as the number of observations. Data are assumed to be sorted so that observations on a cluster are contiguous rows for all entities in the formula.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>

<p>the tolerance used in the fitting algorithm.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.iter</code></td>
<td>

<p>the maximum number of iterations for the ES algorithm.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corstr</code></td>
<td>

<p>a character string specifying the correlation structure.
The following are permitted:
<code>"independence"</code>,
<code>"fixed"</code>,
<code>"stat_M_dep"</code>,
<code>"non_stat_M_dep"</code>,
<code>"exchangeable"</code>,
<code>"AR-M"</code> and
<code>"unstructured"</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>

<p>a logical variable controlling whether an indication at each
iteration is printed.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The joint marginal-conditional model 
</p>
<p>Care should be taken when specifying the random effects structure (see the singular models section of <a href="https://bbolker.github.io/mixedmodels-misc/glmmFAQ.html">https://bbolker.github.io/mixedmodels-misc/glmmFAQ.html</a>). As initial estimates for the expectation-substitution algorithm are taken from the univariate mixed model fits, we recommend that these models be fit separately first and examined to ensure that they are not over parameterized. 
</p>


<h3>Value</h3>

<p>An object of class <code>"MargCond"</code> representing the fit.
</p>
<p>An object of class <code>"MargCond"</code> is a list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>

<p>a named vector of coefficients.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>

<p>a named vector of outcome error standard deviations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SE</code></td>
<td>

<p>a vector of coefficient, random effect, and error standard deviations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>

<p>the residuals, that is response minus fitted values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>working.correlation</code></td>
<td>

<p>the working correlation returned by the GEE step at convergence.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rand.eff</code></td>
<td>

<p>the random effect covariance matrix.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outcomes</code></td>
<td>

<p>vector of outcome names
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Call</code></td>
<td>

<p>the matched call.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v.cov</code></td>
<td>

<p>the scaled covariance matrix of theta
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>

<p>the total number of observations
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>

<p>the total number of clusters
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>converge</code></td>
<td>

<p>logical indicator of whether the expectation-substitution algorithm converged (i.e. the difference between each element of theta from the previous iteration is smaller than <code>tol</code>, and the number of iterations is less than <code>max.iter</code>).
</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Proudfoot J. A., Faig W., Natarajan L., and Xu R. (2018) A joint marginal-conditional model for multivariate longitudinal data. <em>Statistics in Medicine.</em> <a href="https://doi.org/10.1002/sim.7552">https://doi.org/10.1002/sim.7552</a>
</p>


<h3>See Also</h3>

<p><code>gee</code>, <code>lmer</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(2112)
NN = 80
n_times = 1:3

## Simulating some data
simdat &lt;- simDat(n = NN, 
                 fixed_effects = list(c(1, 1, 2), c(1.5, 1, 3)), 
                 rand_effects = list(1, 1),
                 error_var = c(4, 4),
                 error_structure = 'normal',
                 rho = .35,
                 times = n_times,
                 X = cbind(rep(1, NN * length(n_times)), 
                           rnorm(NN * length(n_times), 0, 2), 
                           rbinom(NN * length(n_times), 1, .5)),
                 Z = cbind(rep(1, NN * length(n_times))))
                  
## Adding random missing values
aa &lt;- sample(1:nrow(simdat), 10, replace = TRUE)
bb &lt;- sample(1:7, 10, replace = TRUE)
for (i in 1:length(aa)) {
  simdat[aa[i], bb[i]] &lt;- NA
}

## A fit for this simulated multivariate longitudinal data, 
## including a random intercept and exchangeable correlation 
## structure.
summary(MargCond(c(outcome1, outcome2) ~ X2 + X3 + (1 | ID), 
        data = simdat, ID = simdat$ID, corstr = "exchangeable"))
</code></pre>


</div>