<div class="container">

<table style="width: 100%;"><tr>
<td>simDat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Function to simulate multivariate longitudinal data
</h2>

<h3>Description</h3>

<p>A function that simulates correlated multivariate data based on a set of fixed and random effects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simDat(n, fixed_effects, rand_effects, error_var = c(2, 2), 
error_structure = "normal", rho = 0, times = 1:5, X = NULL, Z = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>total sample size (number of clusters)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed_effects</code></td>
<td>

<p>list of fixed effect vectors for each outcome
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rand_effects</code></td>
<td>

<p>list of random effect vectors for each outcome
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error_var</code></td>
<td>

<p>vector of error variances for each outcome
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error_structure</code></td>
<td>

<p>structure for the random error term, either <code>"normal"</code> for multivariate normal or <code>"50:50 normal"</code> for a mixture of two normal distributions
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>

<p>correlation between outcomes
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>

<p>times for each repeated measure
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>fixed effect design matrix
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>

<p>random effect design matrix
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A dataframe included simulated outcomes and the design matrices
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(2112)
NN = 80
n_times = 1:3

## Simulating some data
simdat &lt;- simDat(n = NN, 
                 fixed_effects = list(c(1, 1, 2), c(1.5, 1, 3)), 
                 rand_effects = list(1, 1),
                 error_var = c(4, 4),
                 error_structure = 'normal',
                 rho = .35,
                 times = n_times,
                 X = cbind(rep(1, NN * length(n_times)), 
                           rnorm(NN * length(n_times), 0, 2), 
                           rbinom(NN * length(n_times), 1, .5)),
                 Z = cbind(rep(1, NN * length(n_times))))
                  
## Adding random missing values
aa &lt;- sample(1:nrow(simdat), 10, replace = TRUE)
bb &lt;- sample(1:7, 10, replace = TRUE)
for (i in 1:length(aa)) {
  simdat[aa[i], bb[i]] &lt;- NA
}
</code></pre>


</div>