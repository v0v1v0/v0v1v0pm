<div class="container">

<table style="width: 100%;"><tr>
<td>Markovstat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Stationary distribution calculation for processes with fixed/random shift size, random repair and random sampling time.
</h2>

<h3>Description</h3>

<p>Calculates the stationary distribution of a process described by a discrete state, discrete time Markov chain. The process is described by a degradation-repair cycle type model. The user must give parameters describing both the degradation and the repair. The process is not repaired until the problem is discovered by sampling, hence the control chart setup. The same, single element is monitored (i.e. the sample size is always 1).
</p>


<h3>Usage</h3>

<pre><code class="language-R">Markovstat(shiftfun = c("exp", "exp-geo", "deg"), h, k, sigma,
           s, delta, probmix = 0, probnbin = 0.5, disj = 1,
           RanRep = FALSE, alpha = NULL, beta = NULL,
           RanSam = FALSE, StateDep = FALSE, a = NULL,
           b = NULL, q = NULL, z = NULL, Vd = 100, V,
           Qparam = 30)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>shiftfun</code></td>
<td>

<p>A string defining the shift size distribution to be used. Must be either <code>"exp"</code> (exponential), <code>"exp-geo"</code> (exponential-geometric mixture) or <code>"deg"</code> (degenerate). Use <code>"deg"</code> for fixed shift size with perfect repair and guaranteed sampling, i.e. Duncan"s traditional cycle model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>

<p>The time between samplings. Must be a positive value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>

<p>The control limit (critical value). Must be a positive value. Only one sided shifts are allowed, thus there is only one control limit.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>

<p>Process standard deviation (the distribution is assumed to be normal).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>

<p>Expected number of shifts in an unit time interval.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>

<p>Expected shift size. Used as the parameter of the exponential distribution (<code>shiftfun="exp"</code> or <code>"exp-geo"</code>), or simply as the size of the shift (<code>shiftfun="deg"</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probmix</code></td>
<td>

<p>The weight of the geometric distribution in case of exponential-geometric mixture shift distribution; should be between 0 and 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probnbin</code></td>
<td>

<p>The probability parameter of the geometric distribution in case of exponential-geometric mixture shift distribution; should be between 0 and 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>disj</code></td>
<td>

<p>The size of a discrete jump in case of exponential-geometric mixture shift distribution, must be a positive number.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RanRep</code></td>
<td>

<p>Logical. Should the repair be random? Default is <code>FALSE</code> (the repair is perfect, the process is always repaired to the target value). The repair is always perfect (non-random) for <code>shiftfun="deg"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>First shape parameter for the random repair beta distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>

<p>Second shape parameter for the random repair beta distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RanSam</code></td>
<td>

<p>Logical. Should the sampling be random? Default is <code>FALSE</code> (no). The sampling is never random for <code>shiftfun="deg"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>StateDep</code></td>
<td>

<p>Logical. Should the sampling probability also depend on the distance from the target value (state dependency)? (If TRUE, a beta distribution is used for the sampling probability, if <code>FALSE</code> then a logistic function.)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>

<p>First parameter*<code>h</code> for the random sampling time beta distribution. The first shape parameter is <code>a/h</code> to create dependency on the time between samplings as described at the <code>StateDep</code> parameter.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>

<p>Second shape parameter for the random sampling time beta distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>

<p>The steepness of the curve of the random sampling time logistic function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>

<p>The logistic sigmoid"s midpoint of the random sampling time logistic function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Vd</code></td>
<td>

<p>Integer discretisation parameter: the number of states in the equidistant discretisation of the state space. Should be an integer value greater than 2.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>

<p>Numeric discretisation parameter: the maximum (positive) distance from the target value taken into account.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Qparam</code></td>
<td>

<p>Integer discretisation parameter: the number of maximum events taken into account within a sampling interval.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function return a list object of class <code>Markov_stationary</code>. The list is of length 3:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Stationary_distribution </code></td>
<td>
<p>Stationary distribution of the Markov chain. The probabilities in the stationary distribution are labeled. If <code>shiftfun</code> is "deg" then the stationary distribution is always of length 4. If <code>shiftfun</code> is not "deg" then there are multiple out-of-control (OOC) and true alarm states. These are labeled with an index and the value the state represents. If <code>shiftfun</code> is "deg" then the out-of-control and true alarm states are at a distance <code>delta</code> from the target value, and the in-control and the false alarm state are always at the target value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Transition_matrix </code></td>
<td>
<p>The transition matrix of the Markov chain. Not printed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Param_list </code></td>
<td>
<p>Parameters given to the function and various technical results used by the <code>Markovchart</code> function. Not printed.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Balazs Dobi and Andras Zempleni
</p>


<h3>References</h3>

<p>Zempleni A, Veber M, Duarte B and Saraiva P. (2004) Control charts: a cost-optimization approach for processes with random shifts. <em>Applied Stochastic Models in Business and Industry</em>, 20(3), 185-200.
</p>
<p>Dobi B and Zempleni A. (2019) Markov chain-based cost-optimal
control charts for health care data. <em>Quality and Reliability Engineering
International</em>, 35(5), 1379-1395.
</p>
<p>Dobi B and Zempleni A. (2019) Markov chain-based cost-optimal
control charts with different shift size distributions. <em>Annales Univ. Sci.
Budapest., Sect. Comp.</em>, 49, 129-146.</p>


<h3>See Also</h3>

<p><code>Markovchart</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Fixed shift size (essentially Duncan's cycle model).
res1 &lt;- Markovstat(shiftfun="deg", h=1, k=1, sigma=1, s=0.2, delta=2.5)
res1

#Exponential shift - perfect repair - deterministic sampling
res2 &lt;- Markovstat(shiftfun="exp", h=1, k=1, sigma=1, s=0.2, delta=2, Vd=30, V=18)
res2
#Notice how the In-control and the False-alarm states have non-zero probabilities.
#If the repair would be random (RanRep=TRUE), then these states would have zero probability.

#Exponential-geometric mixture shift - random repair - random sampling.
res3 &lt;- Markovstat(shiftfun='exp-geo', h=1.5, k=2, sigma=1, s=0.2,
                   delta=1.2, probmix=0.7, probnbin=0.8, disj=2,
                   RanRep=TRUE, alpha=1, beta=3, RanSam=TRUE,
                   StateDep=TRUE, a=1, b=15, Vd=40, V=8)
res3
</code></pre>


</div>