<div class="container">

<table style="width: 100%;"><tr>
<td>tabMWRfre</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create a formatted table of quality control frequency checks</h2>

<h3>Description</h3>

<p>Create a formatted table of quality control frequency checks
</p>


<h3>Usage</h3>

<pre><code class="language-R">tabMWRfre(
  res = NULL,
  acc = NULL,
  frecom = NULL,
  fset = NULL,
  runchk = TRUE,
  warn = TRUE,
  type = c("summary", "percent"),
  pass_col = "#57C4AD",
  fail_col = "#DB4325",
  digits = 0,
  suffix = "%"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>character string of path to the results file or <code>data.frame</code> for results returned by <code>readMWRresults</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acc</code></td>
<td>
<p>character string of path to the data quality objectives file for accuracy or <code>data.frame</code> returned by <code>readMWRacc</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frecom</code></td>
<td>
<p>character string of path to the data quality objectives file for frequency and completeness or <code>data.frame</code> returned by <code>readMWRfrecom</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fset</code></td>
<td>
<p>optional list of inputs with elements named <code>res</code>, <code>acc</code>, <code>frecom</code>, <code>sit</code>, or <code>wqx</code> overrides the other arguments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>runchk</code></td>
<td>
<p>logical to run data checks with <code>checkMWRresults</code> and <code>checkMWRfrecom</code>, applies only if <code>res</code> or <code>frecom</code> are file paths</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warn</code></td>
<td>
<p>logical to return warnings to the console (default)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>character string indicating <code>summary</code> or <code>percent</code> tabular output, see datails</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pass_col</code></td>
<td>
<p>character string (as hex code) for the cell color of checks that pass, applies only if <code>type = 'percent'</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fail_col</code></td>
<td>
<p>character string (as hex code) for the cell color of checks that fail, applies only if <code>type = 'percent'</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>numeric indicating number of significant digits to report for percentages</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>suffix</code></td>
<td>
<p>character string indicating suffix to append to percentage values</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function can be used with inputs as paths to the relevant files or as data frames returned by <code>readMWRresults</code>, <code>readMWRacc</code>, and <code>readMWRfrecom</code>.  For the former, the full suite of data checks can be evaluated with <code>runkchk = T</code> (default) or suppressed with <code>runchk = F</code>, as explained in the relevant help files.  In the latter case, downstream analyses may not work if data are formatted incorrectly. For convenience, a named list with the input arguments as paths or data frames can be passed to the <code>fset</code> argument instead. See the help file for <code>utilMWRinput</code>.
</p>
<p>Also note that completeness is only evaluated on parameters that are shared between the results file and data quality objectives file for frequency and completeness.  A warning is returned for parameters that do not match between the files. This warning can be suppressed by setting <code>warn = FALSE</code>.
</p>
<p>The quality control tables for frequency show the number of records that apply to a given check (e.g., Lab Blank, Field Blank, etc.) relative to the number of "regular" data records (e.g., field samples or measures) for each parameter.  A summary of all frequency checks for each parameter is provided if <code>type = "summary"</code> or a color-coded table showing similar information as percentages for each parameter is provided if <code>type = "percent"</code>.
</p>
<p>Inputs for the results and data quality objectives for accuracy and frequency and completeness are processed internally with <code>qcMWRcom</code> and the same arguments are accepted for this function, in addition to others listed above.
</p>


<h3>Value</h3>

<p>A <code>flextable</code> object with formatted results.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
##
# using file paths

# results path
respth &lt;- system.file('extdata/ExampleResults.xlsx', package = 'MassWateR')

# dqo accuracy data path
accpth &lt;- system.file('extdata/ExampleDQOAccuracy.xlsx', package = 'MassWateR')

# frequency and completeness path
frecompth &lt;- system.file('extdata/ExampleDQOFrequencyCompleteness.xlsx', 
     package = 'MassWateR')

# table as summary
tabMWRfre(res = respth, acc = accpth, frecom = frecompth, type = 'summary')

# table as percent
tabMWRfre(res = respth, acc = accpth, frecom = frecompth, type = 'percent')

##
# using data frames

# results data
resdat &lt;- readMWRresults(respth)

# accuracy data
accdat &lt;- readMWRacc(accpth)

# frequency and completeness data
frecomdat &lt;- readMWRfrecom(frecompth)

# table as summary
tabMWRfre(res = resdat, acc = accdat, frecom = frecomdat, type = 'summary')

# table as percent
tabMWRfre(res = resdat, acc = accdat, frecom = frecomdat, type = 'percent')
</code></pre>


</div>