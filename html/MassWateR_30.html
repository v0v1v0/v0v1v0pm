<div class="container">

<table style="width: 100%;"><tr>
<td>tabMWRwqx</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create and save tables in a single workbook for WQX upload</h2>

<h3>Description</h3>

<p>Create and save tables in a single workbook for WQX upload
</p>


<h3>Usage</h3>

<pre><code class="language-R">tabMWRwqx(
  res = NULL,
  acc = NULL,
  sit = NULL,
  wqx = NULL,
  fset = NULL,
  output_dir,
  output_file = NULL,
  warn = TRUE,
  runchk = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>character string of path to the results file or <code>data.frame</code> for results returned by <code>readMWRresults</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acc</code></td>
<td>
<p>character string of path to the data quality objectives file for accuracy or <code>data.frame</code> returned by <code>readMWRacc</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sit</code></td>
<td>
<p>character string of path to the site metadata file or <code>data.frame</code> for site metadata returned by <code>readMWRsites</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wqx</code></td>
<td>
<p>character string of path to the wqx metadata file or <code>data.frame</code> for wqx metadata returned by <code>readMWRwqx</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fset</code></td>
<td>
<p>optional list of inputs with elements named <code>res</code>, <code>acc</code>, <code>frecom</code>, <code>sit</code>, or <code>wqx</code> overrides the other arguments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output_dir</code></td>
<td>
<p>character string of the output directory for the results</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output_file</code></td>
<td>
<p>optional character string for the file name, must include .xlsx suffix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warn</code></td>
<td>
<p>logical to return warnings to the console (default)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>runchk</code></td>
<td>
<p>logical to run data checks with <code>checkMWRresults</code>, <code>checkMWRacc</code>, <code>checkMWRsites</code>, <code>checkMWRwqx</code>, applies only if <code>res</code>, <code>acc</code>, <code>sit</code>, or <code>wqx</code> are file paths</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function will export a single Excel workbook with three sheets, named "Project", "Locations", and "Results". The output is populated with as much content as possible based on information in the input files.  The remainder of the information not included in the output will need to be manually entered before uploading the data to WQX.  All required columns are present, but individual rows will need to be verified for completeness.  It is the responsibility of the user to verify this information is complete and correct before uploading the data.
</p>
<p>The workflow for using this function is to import the required data (results, data quality objectives file for accuracy, site metadata, and wqx metadata) and to fix any errors noted on import prior to creating the output. The function can be used with inputs as paths to the relevant files or as data frames returned by <code>readMWRresults</code>, <code>readMWRacc</code>, <code>readMWRsites</code>, and <code>readMWRwqx</code>.  For the former, the full suite of data checks can be evaluated with <code>runkchk = T</code> (default) or suppressed with <code>runchk = F</code>, as explained in the relevant help files.  In the latter case, downstream analyses may not work if data are formatted incorrectly. For convenience, a named list with the input arguments as paths or data frames can be passed to the <code>fset</code> argument instead. See the help file for <code>utilMWRinput</code>.
</p>
<p>The name of the output file can also be changed using the <code>output_file</code> argument, the default being <code>wqxtab.xlsx</code>.  Warnings can also be turned off or on (default) using the <code>warn</code> argument.  This returns any warnings when data are imported and only applies if the file inputs are paths.
</p>


<h3>Value</h3>

<p>An Excel workbook named <code>wqxtab.xlsx</code> (or name passed to <code>output_file</code>) will be saved in the directory specified by <code>output_dir</code>. The workbook will include three sheets names "Projects", "Locations", and "Results".
</p>


<h3>Examples</h3>

<pre><code class="language-R"># results data path
respth &lt;- system.file('extdata/ExampleResults.xlsx', package = 'MassWateR')

# dqo accuracy data path
accpth &lt;- system.file('extdata/ExampleDQOAccuracy.xlsx', package = 'MassWateR')

# site data path
sitpth &lt;- system.file('extdata/ExampleSites.xlsx', package = 'MassWateR')

# wqx data path
wqxpth &lt;- system.file('extdata/ExampleWQX.xlsx', package = 'MassWateR')

# results data
resdat &lt;- readMWRresults(respth)

# accuracy data
accdat &lt;- readMWRacc(accpth)

# site data
sitdat &lt;- readMWRsites(sitpth)

# wqx data
wqxdat &lt;- readMWRwqx(wqxpth)

# create workbook
tabMWRwqx(res = resdat, acc = accdat, sit = sitdat, wqx = wqxdat, output_dir = tempdir())
</code></pre>


</div>