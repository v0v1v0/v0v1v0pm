<div class="container">

<table style="width: 100%;"><tr>
<td>anlzMWRsite</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Analyze data by sites in results file</h2>

<h3>Description</h3>

<p>Analyze data by sites in results file
</p>


<h3>Usage</h3>

<pre><code class="language-R">anlzMWRsite(
  res = NULL,
  param,
  acc = NULL,
  sit = NULL,
  fset = NULL,
  type = c("box", "jitterbox", "bar", "jitterbar", "jitter"),
  thresh,
  threshlab = NULL,
  threshcol = "tan",
  site = NULL,
  resultatt = NULL,
  locgroup = NULL,
  dtrng = NULL,
  confint = FALSE,
  fill = "lightgreen",
  alpha = 0.8,
  width = 0.8,
  yscl = "auto",
  sumfun = yscl,
  byresultatt = FALSE,
  ttlsize = 1.2,
  runchk = TRUE,
  warn = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>character string of path to the results file or <code>data.frame</code> for results returned by <code>readMWRresults</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>character string of the parameter to plot, must conform to entries in the <code>"Simple Parameter"</code> column of <code>paramsMWR</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acc</code></td>
<td>
<p>character string of path to the data quality objectives file for accuracy or <code>data.frame</code> returned by <code>readMWRacc</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sit</code></td>
<td>
<p>optional character string of path to the site metadata file or <code>data.frame</code> of site metadata returned by <code>readMWRsites</code>, required if <code>locgroup</code> is not <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fset</code></td>
<td>
<p>optional list of inputs with elements named <code>res</code>, <code>acc</code>, <code>frecom</code>, <code>sit</code>, or <code>wqx</code> overrides the other arguments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>character indicating <code>"box"</code>, <code>"jitterbox"</code>, <code>"bar"</code>, <code>"jitterbar"</code> or <code>"jitter"</code>, see details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh</code></td>
<td>
<p>character indicating if relevant freshwater or marine threshold lines are included, one of <code>"fresh"</code>, <code>"marine"</code>, or <code>"none"</code>, or a single numeric value to override the values included with the package</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshlab</code></td>
<td>
<p>optional character string indicating legend label for the threshold, required only if <code>thresh</code> is numeric</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshcol</code></td>
<td>
<p>character indicating color of threshold lines if available</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>site</code></td>
<td>
<p>character string of sites to include, default all</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resultatt</code></td>
<td>
<p>character string of result attributes to plot, default all</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>locgroup</code></td>
<td>
<p>character string of location groups to plot from the <code>"Location Group"</code> column in the site metadata file, optional and only if <code>sit</code> is not <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dtrng</code></td>
<td>
<p>character string of length two for the date ranges as YYYY-MM-DD, default all</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>confint</code></td>
<td>
<p>logical indicating if confidence intervals are shown, only applies if <code>type</code> is <code>"bar"</code> or <code>"jitterbar"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill</code></td>
<td>
<p>numeric indicating fill color for boxplots or barplots</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>numeric from 0 to 1 indicating transparency of fill color</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>numeric for width of boxplots or barplots</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yscl</code></td>
<td>
<p>character indicating one of <code>"auto"</code> (default), <code>"log"</code>, or <code>"linear"</code>, see details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sumfun</code></td>
<td>
<p>character indicating one of <code>"auto"</code>, <code>"mean"</code>, <code>"geomean"</code>, <code>"median"</code>, <code>"min"</code>, or <code>"max"</code>, see details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>byresultatt</code></td>
<td>
<p>logical indicating if the plot has sites grouped separately by result attributes, see details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ttlsize</code></td>
<td>
<p>numeric value indicating font size of the title relative to other text in the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>runchk</code></td>
<td>
<p>logical to run data checks with <code>checkMWRresults</code> or <code>checkMWRacc</code>, applies only if <code>res</code> or <code>acc</code> are file paths</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warn</code></td>
<td>
<p>logical to return warnings to the console (default)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Summaries of a parameter for each site are shown as boxplots if <code>type = "box"</code> or as barplots if <code>type = "bar"</code>.  Points can be jittered over the boxplots by setting <code>type = "jitterbox"</code> or jittered over the barplots by setting <code>type = "jitterbar"</code>.  Setting <code>type = "jitter"</code> will show only the jittered points.  For <code>type = "bar"</code> or <code>type = "jitterbar"</code>, 95% confidence intervals can also be shown if <code>confint = TRUE</code> and they can be estimated (i.e., more than one result value per bar and <code>sumfun</code> is <code>"auto"</code>, <code>"mean"</code>, or <code>"geomean"</code>).
</p>
<p>Threshold lines applicable to marine or freshwater environments can be included in the plot by using the <code>thresh</code> argument.  These thresholds are specific to each parameter and can be found in the <code>thresholdMWR</code> file.  Threshold lines are plotted only for those parameters with entries in <code>thresholdMWR</code> and only if the value in <code>`Result Unit`</code> matches those in <code>thresholdMWR</code>. The threshold lines can be suppressed by setting <code>thresh = 'none'</code>. A user-supplied numeric value can also be used for the <code>thresh</code> argument to override the default values. An appropriate label must also be supplied to <code>threshlab</code> if <code>thresh</code> is numeric.
</p>
<p>The y-axis scaling as arithmetic (linear) or logarithmic can be set with the <code>yscl</code> argument.  If <code>yscl = "auto"</code> (default), the scaling is  determined automatically from the data quality objective file for accuracy, i.e., parameters with "log" in any of the columns are plotted on log10-scale, otherwise arithmetic. Setting <code>yscl = "linear"</code> or <code>yscl = "log"</code> will set the axis as linear or log10-scale, respectively, regardless of the information in the data quality objective file for accuracy.
</p>
<p>Similarly, the data will be summarized if <code>type</code> is <code>"bar"</code> or <code>"jitterbar"</code> based on the value passed to <code>sumfun</code>.  The default if no value is provided to <code>sumfun</code> is to use the appropriate summary based on the value provided to <code>yscl</code>.  If <code>yscl = "auto"</code> (default), then <code>sumfun = "auto"</code>, and the mean or geometric mean is used for the summary based on information in the data quality objective file for accuracy. Using <code>yscl = "linear"</code> or <code>yscl = "log"</code> will default to the mean or geometric mean summary if no value is provided to <code>sumfun</code>.  Any other appropriate value passed to <code>sumfun</code> will override the value passed to <code>yscl</code>.  Valid summary functions for <code>sumfun</code> include <code>"auto"</code>, <code>"mean"</code>, <code>"geomean"</code>, <code>"median"</code>, <code>"min"</code>, or <code>"max"</code>).
</p>
<p>Any entries in <code>resdat</code> in the <code>"Result Value"</code> column as <code>"BDL"</code> or <code>"AQL"</code> are replaced with appropriate values in the <code>"Quantitation Limit"</code> column, if present, otherwise the <code>"MDL"</code> or <code>"UQL"</code> columns from the data quality objectives file for accuracy are used.  Values as <code>"BDL"</code> use one half of the appropriate limit.
</p>
<p>The <code>byresultatt</code> argument can be used to group sites separately by result attributes.  For example, sites with E. coli samples can be grouped by <code>"Dry"</code> or <code>"Wet"</code> conditions if present in the <code>"Result Attribute"</code> column.   Filtering by sites first using the <code>site</code> argument is advised to reduce the amount of data that are plotted. The grouping can be filtered further by passing appropriate values in the <code>"Result Attribute"</code> column to the <code>resultatt</code> argument. Note that specifying result attributes with <code>resultatt</code> and setting <code>byresultatt = FALSE</code> will filter the plot data by the result attributes but will not plot the results separately.
</p>


<h3>Value</h3>

<p>A <code>ggplot</code> object that can be further modified.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># results data path
respth &lt;- system.file('extdata/ExampleResults.xlsx', package = 'MassWateR')

# results data
resdat &lt;- readMWRresults(respth)

# accuracy path
accpth &lt;- system.file('extdata/ExampleDQOAccuracy.xlsx', 
     package = 'MassWateR')

# accuracy data
accdat &lt;- readMWRacc(accpth)

# site data path
sitpth &lt;- system.file('extdata/ExampleSites.xlsx', package = 'MassWateR')

# site data
sitdat &lt;- readMWRsites(sitpth)

# site trends, boxplot
anlzMWRsite(res = resdat, param = 'DO', acc = accdat, type = 'box', thresh = 'fresh')

# site trends, barplot
anlzMWRsite(res = resdat, param = 'DO', acc = accdat, type = 'bar', thresh = 'fresh')

# site trends, May to July only
anlzMWRsite(res = resdat, param = 'DO', acc = accdat, type = 'box', thresh = 'fresh',
     dtrng = c('2022-05-01', '2022-07-31'))
     
# grouping by result attribute
anlzMWRsite(res = resdat, param = 'DO', acc = accdat, type = 'box', thresh = 'fresh',
     site = c('ABT-062', 'ABT-077'), byresultatt = TRUE)
     
# site trends by location group, requires sitdat
anlzMWRsite(res = resdat, param = 'DO', acc = accdat, sit = sitdat, type = 'box', 
     thresh = 'fresh', locgroup = 'Assabet')
     
</code></pre>


</div>