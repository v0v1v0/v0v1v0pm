<div class="container">

<table style="width: 100%;"><tr>
<td>match_y1y0_bc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Imputing Missing Potential Outcomes with Bias-Corrected Matching</h2>

<h3>Description</h3>

<p>Impute missing potential outcomes for each individual with bias-corrected matching.
</p>


<h3>Usage</h3>

<pre><code class="language-R">match_y1y0_bc(X, A, Y, miu1.hat, miu0.hat, K = 5, method = "euclidean")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A matrix representing covariates, where each row represents the
value of a different covariates for an individual.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>A vector representing the treatment received by each individual.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>A vector representing the observed outcome for each individual.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>miu1.hat</code></td>
<td>
<p>The estimated outcome regression function for <code class="reqn">Y^1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>miu0.hat</code></td>
<td>
<p>The estimated outcome regression function for <code class="reqn">Y^0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>When imputing missing potential outcomes, the average number of
similar individuals are taken based on covariates similarity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The distance measure to be used. It is a argument embed in
<code>dist</code> function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Here are the implementation details for the imputation processes.
Denote <code class="reqn">\hat{Y}^0_i</code> and <code class="reqn">\hat{Y}^1_i</code> as the imputed potential
outcomes for individual <code class="reqn">i</code>. For example, if <code class="reqn">A_i = 0</code>, then <code class="reqn">\hat{Y}^0_i =  Y^0_i</code>.
However, for obtaining <code class="reqn">\hat{Y}^1_i</code>, we require to introduce an outcome
regression function <code class="reqn">\mu_1(X)</code> for <code class="reqn">Y^1</code>. Let <code class="reqn">\hat{\mu}_1(X)</code> be the fitted value of
<code class="reqn">\mu_1(X)</code>, then <code class="reqn">\hat{Y}^1_i</code> is defined as follows,
</p>
<p style="text-align: center;"><code class="reqn">\hat{Y}_i^1 =  \frac 1 K \sum_{j\in\mathcal{J}_K(i)}\{Y_j+
    \hat{\mu}_1(X_i)-\hat{\mu}_1(X_j)\},</code>
</p>

<p>where <code class="reqn">\mathcal{J}_K(i)</code> represents the set of <code class="reqn">K</code> matched individuals
with <code class="reqn">A_i = 1</code>, that are the closest to the individual <code class="reqn">i</code> in terms of
covariates similarity, and vice versa.
</p>


<h3>Value</h3>

<p>Returns a matrix of completed matches, where each row is the imputed <code class="reqn">(Y^1, Y^0)</code>
for each individual.
</p>


<h3>Examples</h3>

<pre><code class="language-R">n = 100
X1 &lt;- runif(n, -0.5,0.5)
X2 &lt;- sample(c(0,1,2), n, TRUE)
X = cbind(X1, X2)
A = sample(c(0,1), n, TRUE)
Y = A * (2*X1) + X1 + X2^2 + rnorm(n)
miu1_hat &lt;- cbind(1,X) %*% as.matrix(lm(Y ~ X, subset = A==1)$coef)
miu0_hat &lt;- cbind(1,X) %*% as.matrix(lm(Y ~ X, subset = A==0)$coef)
match_y1y0_bc(X = X, A = A, Y = Y, miu1.hat = miu1_hat,
              miu0.hat = miu0_hat, K = 5)


</code></pre>


</div>