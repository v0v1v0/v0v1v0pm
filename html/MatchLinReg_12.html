<div class="container">

<table style="width: 100%;"><tr>
<td>mlr.variance</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Treatment effect variance
</h2>

<h3>Description</h3>

<p>Calculating treatment effect variance, resulting from linear regression.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mlr.variance(tr, Z.i = NULL, sigsq = 1, details = FALSE
  , idx =1:length(tr))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tr</code></td>
<td>
<p>Binary treatment indicator vector (1=treatment, 0=control), whose coefficient in the linear regression model is TE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z.i</code></td>
<td>
<p>Matrix of adjustment covariates included in linear regression. We must have <code>nrow(Z.i) == length(tr)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigsq</code></td>
<td>
<p>Variance of data generation noise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>details</code></td>
<td>
<p>Boolean flag, indicating whether intermediate objects used in generating the constrcutor vector must be returned or not (only when no repeated observations).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idx</code></td>
<td>
<p>Index of observations to be used, with possible duplication, e.g. as indexes of matched subset.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A scalar value is returned for TE variance. If <code>details = TRUE</code> and <code>Z.i</code> is not <code>NULL</code>, then the following objects are attached as attributes:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>u.i</code></td>
<td>
<p>Vector of length <code>ncol(Z.i)</code>, reflecting the mean difference between groups (control - treatment) for each included covariate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>Weighted, within-group covariance matrix of included covariates. It is a square matrix of dimension <code>ncol(Z.i)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iA</code></td>
<td>
<p>Inverse of <code>A</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Alireza S. Mahani, Mansour T.A. Sharabiani
</p>


<h3>References</h3>

<p>Link to a draft paper, documenting the supporting mathematical framework, will be provided in the next release.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(lalonde)

tr &lt;- lalonde$treat
Z.i &lt;- as.matrix(lalonde[, c("age", "educ", "black"
  , "hispan", "married", "nodegree", "re74", "re75")])

ret &lt;- mlr.variance(tr = tr, Z.i = Z.i)

# comparing with brute-force approach
X.i &lt;- cbind(tr, 1, Z.i)
ret2 &lt;- (solve(t(X.i) %*% X.i))[1, 1]

cat("check 1:", all.equal(ret2, ret), "\n")

# matching with/without replacement
idx &lt;- mlr.match(tr = tr, X = Z.i, caliper = 1.0
  , replace = FALSE)
idx.wr &lt;- mlr.match(tr = tr, X = Z.i, caliper = 1.0
  , replace = TRUE)

ret3 &lt;- mlr.variance(tr = tr, Z.i = Z.i, idx = idx)
cat("variance - matching without replacement:"
  , ret3, "\n")

ret4 &lt;- mlr.variance(tr = tr, Z.i = Z.i, idx = idx.wr)
cat("variance - matching with replacement:"
  , ret4, "\n")

</code></pre>


</div>