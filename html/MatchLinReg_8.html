<div class="container">

<table style="width: 100%;"><tr>
<td>mlr.match</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Thin wrapper around <code>Match</code> function from <code>Matching</code> package
</h2>

<h3>Description</h3>

<p>Performs propensity score or Mahalanobis matching and return indexes of treatment and control groups.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mlr.match(tr, X, psm = TRUE, replace = F, caliper = Inf
  , verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tr</code></td>
<td>
<p>Binary treatment indicator vector (1=treatment, 0=control), whose coefficient in the linear regression model is TE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Covariates used in matching, either directly (Mahalanobis matching) or indirectly (propensity score).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psm</code></td>
<td>
<p>Boolean flag, indicating whether propensity score matching should be used (<code>TRUE</code>) or Mahalanobis matching (<code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replace</code></td>
<td>
<p>Boolean flag, indicating whether matching must be done with or without replacement.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>caliper</code></td>
<td>
<p>Size of caliper (standardized distance of two observations) used in matching. Treatment and control observations with standardized distance larger than <code>caliper</code> will not be considered as eligible pairs duing matching.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Boolean flag, indicating whether size of treatment and control groups before and after matching will be printed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For propensity score matching, linear predictors from logistic regression are used (rather than predicted probabilities).
</p>


<h3>Value</h3>

<p>A vector of matched indexes, containing both treatment and control groups. Also, the following attributes are attached: 1) <code>nt</code>: size of treatment group, 2) <code>nc</code>: size of control group, 3) <code>psm.reg</code>: logistic regression object used in generating propensity scores (<code>NA</code> if <code>psm</code> is <code>FALSE</code>), 4) <code>match.obj</code>: matching object returned by <code>Match</code> function.
</p>


<h3>Author(s)</h3>

<p>Alireza S. Mahani, Mansour T.A. Sharabiani
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(lalonde)

tr &lt;- lalonde$treat
Z.i &lt;- as.matrix(lalonde[, c("age", "educ", "black"
  , "hispan", "married", "nodegree", "re74", "re75")])
Z.o &lt;- model.matrix(~ I(age^2) + I(educ^2) + I(re74^2) + I(re75^2) - 1, lalonde)

# propensity score matching on all covariates
idx &lt;- mlr.match(tr = tr, X = cbind(Z.i, Z.o), caliper = 1.0, replace = FALSE)

# improvement in maximum single-covariate bias due to matching
bias.obj.before &lt;- mlr.bias(tr = tr, Z.i = Z.i, Z.o = Z.o)
bias.before &lt;- bias.obj.before$subspace$bias
dir &lt;- bias.obj.before$subspace$dir
bias.after &lt;- as.numeric(mlr.bias(tr = tr[idx]
  , Z.i = Z.i[idx, ], Z.o = dir[idx], gamma.o = 1.0)$single$bias)

# percentage bias-squared rediction
cat("normalized bias - before:", bias.before, "\n")
cat("normalized bias - after:", bias.after, "\n")
cat("percentage squared-bias reduction:"
  , (bias.before^2 - bias.after^2)/bias.before^2, "\n")

# matching with replacement
idx.wr &lt;- mlr.match(tr = tr, X = cbind(Z.i, Z.o), caliper = 1.0
  , replace = TRUE)
bias.after.wr &lt;- as.numeric(mlr.bias(tr = tr
  , Z.i = Z.i, Z.o = dir, gamma.o = 1.0, idx = idx.wr)$single$bias)
cat("normalized bias - after (with replacement):", bias.after.wr, "\n")

</code></pre>


</div>