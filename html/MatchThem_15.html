<div class="container">

<table style="width: 100%;"><tr>
<td>matchthem</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Matches Multiply Imputed Datasets</h2>

<h3>Description</h3>

<p><code>matchthem()</code> performs matching in the supplied multiply imputed datasets, given as <code>mids</code> or <code>amelia</code> objects, by running <code>MatchIt::matchit()</code> on each of the multiply imputed datasets with the supplied arguments.
</p>


<h3>Usage</h3>

<pre><code class="language-R">matchthem(
  formula,
  datasets,
  approach = "within",
  method = "nearest",
  distance = "glm",
  link = "logit",
  distance.options = list(),
  discard = "none",
  reestimate = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A <code>formula</code> of the form <code>z ~ x1 + x2</code>, where <code>z</code> is the exposure and <code>x1</code> and <code>x2</code> are the covariates to be balanced, which is passed directly to <code>MatchIt::matchit()</code> to specify the propensity score model or treatment and covariates to be used in matching. See <code>MatchIt::matchit()</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datasets</code></td>
<td>
<p>This argument specifies the datasets containing the exposure and the potential confounders called in the <code>formula</code>. This argument must be an object of the <code>mids</code> or <code>amelia</code> class, which is typically produced by a previous call to <code>mice()</code> function from the <span class="pkg">mice</span> package or to <code>amelia()</code> function from the <span class="pkg">Amelia</span> package (the <span class="pkg">Amelia</span> package is designed to impute missing data in a single cross-sectional dataset or in a time-series dataset, currently, the <span class="pkg">MatchThem</span> package only supports the former datasets).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>approach</code></td>
<td>
<p>The approach that should be used to combine information in multiply imputed datasets. Currently, <code>"within"</code> (performing matching within each dataset) and <code>"across"</code> (estimating propensity scores within each dataset, averaging them across datasets, and performing matching using the averaged propensity scores in each dataset) approaches are available. The default is <code>"within"</code>, which has been shown to have superior performance in most cases.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>This argument specifies a matching method. Currently, <code>"nearest"</code> (nearest neighbor matching), <code>"exact"</code> (exact matching), <code>"full"</code> (optimal full matching), <code>"genetic"</code> (genetic matching), <code>"subclass"</code> (subclassication), <code>"cem"</code> (coarsened exact matching), <code>"optimal"</code> (optimal pair matching), <code>"quick"</code> (generalized full matching), and <code>("cardinality")</code> (cardinality and profile matching) methods are available. Only methods that produce a propensity score (<code>"nearest"</code>, <code>"full"</code>, <code>"genetic"</code>, <code>"subclass"</code>, <code>"optimal"</code>, and <code>"quick"</code>) are compatible with the <code>"across"</code> approach. The default is <code>"nearest"</code> for nearest neighbor matching. See <code>MatchIt::matchit()</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>The method used to estimate the distance measure (e.g., propensity scores) used in matching, if any. Only options that specify a method of estimating propensity scores (i.e., not <code>"mahalanobis"</code>) are compatible with the <code>"across"</code> approach. The default is <code>"glm"</code> for estimating propensity scores using logistic regression. See <code>MatchIt::matchit()</code> and <code>MatchIt::distance</code> for details and allowable options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link, distance.options, discard, reestimate</code></td>
<td>
<p>Arguments passed to <code>MatchIt::matchit()</code> to control estimation of the distance measure (e.g., propensity scores).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to <code>MatchIt::matchit()</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If an <code>amelia</code> object is supplied to <code>datasets</code>, it will be transformed into a <code>mids</code> object for further use. <code>matchthem()</code> works by calling <code>mice::complete()</code> on the <code>mids</code> object to extract a complete dataset, and then calls <code>MatchIt::matchit()</code> on each one, storing the output of each <code>matchit()</code> call and the <code>mids</code> in the output. All arguments supplied to <code>matchthem()</code> except <code>datasets</code> and <code>approach</code> are passed directly to <code>matchit()</code>. With the <code>"across"</code> approach, the estimated propensity scores are averaged across multiply imputed datasets and re-supplied to another set of calls to <code>matchit()</code>.
</p>


<h3>Value</h3>

<p>An object of the <code>mimids()</code> (matched multiply imputed datasets) class, which includes the supplied <code>mids</code> object (or an <code>amelia</code> object transformed into a <code>mids</code> object if supplied) and the output of the calls to <code>matchit()</code> on each multiply imputed dataset.
</p>


<h3>Author(s)</h3>

<p>Farhad Pishgar and Noah Greifer
</p>


<h3>References</h3>

<p>Daniel Ho, Kosuke Imai, Gary King, and Elizabeth Stuart (2007). Matching as Nonparametric Preprocessing for Reducing Model Dependence in Parametric Causal Inference. <em>Political Analysis</em>, 15(3): 199-236. <a href="https://gking.harvard.edu/files/abs/matchp-abs.shtml">https://gking.harvard.edu/files/abs/matchp-abs.shtml</a>
</p>
<p>Stef van Buuren and Karin Groothuis-Oudshoorn (2011). <code>mice</code>: Multivariate Imputation by Chained Equations in <code>R</code>. <em>Journal of Statistical Software</em>, 45(3): 1-67. <a href="https://doi.org/10.18637/jss.v045.i03">doi:10.18637/jss.v045.i03</a>
</p>
<p>Gary King, James Honaker, Anne Joseph, and Kenneth Scheve (2001). Analyzing Incomplete Political Science Data: An Alternative Algorithm for Multiple Imputation. <em>American Political Science Review</em>, 95: 49â€“69. <a href="https://gking.harvard.edu/files/abs/evil-abs.shtml">https://gking.harvard.edu/files/abs/evil-abs.shtml</a>
</p>


<h3>See Also</h3>

<p><code>mimids</code>
</p>
<p><code>with()</code>
</p>
<p><code>pool()</code>
</p>
<p><code>weightthem()</code>
</p>
<p><code>MatchIt::matchit()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#1

#Loading the dataset
data(osteoarthritis)

#Multiply imputing the missing values
imputed.datasets &lt;- mice::mice(osteoarthritis, m = 5)

#Matching the multiply imputed datasets
matched.datasets &lt;- matchthem(OSP ~ AGE + SEX + BMI + RAC + SMK,
                              imputed.datasets,
                              approach = 'within',
                              method = 'nearest')

#2

#Loading the dataset
data(osteoarthritis)

#Multiply imputing the missing values
imputed.datasets &lt;- Amelia::amelia(osteoarthritis, m = 5,
                                   noms = c("SEX", "RAC", "SMK", "OSP", "KOA"))

#Matching the multiply imputed datasets
matched.datasets &lt;- matchthem(OSP ~ AGE + SEX + BMI + RAC + SMK,
                              imputed.datasets,
                              approach = 'across',
                              method = 'nearest')
</code></pre>


</div>