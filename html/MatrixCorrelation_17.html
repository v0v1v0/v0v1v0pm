<div class="container">

<table style="width: 100%;"><tr>
<td>r1</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Correlational Measures for Matrices</h2>

<h3>Description</h3>

<p>Matrix similarity as described by Ramsey et al. (1984).
</p>


<h3>Usage</h3>

<pre><code class="language-R">r1(X1, X2, center = TRUE, impute = FALSE)

r2(
  X1,
  X2,
  center = TRUE,
  impute = FALSE,
  impute_par = list(max_iter = 20, tol = 10^-5)
)

r3(
  X1,
  X2,
  center = TRUE,
  impute = FALSE,
  impute_par = list(max_iter = 20, tol = 10^-5)
)

r4(
  X1,
  X2,
  center = TRUE,
  impute = FALSE,
  impute_par = list(max_iter = 20, tol = 10^-5)
)

GCD(
  X1,
  X2,
  ncomp1 = min(dim(X1)),
  ncomp2 = min(dim(X2)),
  center = TRUE,
  impute = FALSE,
  impute_par = list(max_iter = 20, tol = 10^-5)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X1</code></td>
<td>
<p>first <code>matrix</code> to be compared (<code>data.frames</code> are also accepted).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X2</code></td>
<td>
<p>second <code>matrix</code> to be compared (<code>data.frames</code> are also accepted).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p><code>logical</code> indicating if input matrices should be centered (default = TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>impute</code></td>
<td>
<p><code>logical</code> indicating if missing values are expected in <code>X1</code> or <code>X2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>impute_par</code></td>
<td>
<p>named <code>list</code> of imputation parameters in case of NAs in X1/X2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncomp1</code></td>
<td>
<p>(GCD) number of subspace components from the first <code>matrix</code> (default: full subspace).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncomp2</code></td>
<td>
<p>(GCD) number of subspace components from the second <code>matrix</code> (default: full subspace).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Details can be found in Ramsey's paper:
</p>

<ul>
<li>
<p>r1: inner product correlation
</p>
</li>
<li>
<p>r2: orientation-independent inner product correlation
</p>
</li>
<li>
<p>r3: spectra-independent inner product correlations (including orientation)
</p>
</li>
<li>
<p>r4: Spectra-Independent inner product Correlations
</p>
</li>
<li>
<p>GCD: Yanai's Generalized Coefficient of Determination (GCD) Measure. To reproduce the original GCD, use all components. When <code>X1</code> and <code>X2</code> are dummy variables, GCD is proportional with Pillai's criterion: tr(W^-1(B+W)).
</p>
</li>
</ul>
<h3>Value</h3>

<p>A single value measuring the similarity of two matrices.
</p>


<h3>Author(s)</h3>

<p>Kristian Hovde Liland
</p>


<h3>References</h3>

<p>Ramsay, JO; Berg, JT; Styan, GPH; 1984. "Matrix Correlation". Psychometrica 49(3): 403-423.
</p>


<h3>See Also</h3>

<p><code>SMI</code>, <code>RV</code> (RV2/RVadj), <code>Rozeboom</code>, <code>Coxhead</code>,
<code>allCorrelations</code> (matrix correlation comparison), <code>PCAcv (cross-validated PCA)</code>, <code>PCAimpute (PCA based imputation)</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">X1  &lt;- matrix(rnorm(100*300),100,300)
usv &lt;- svd(X1)
X2  &lt;- usv$u[,-3] %*% diag(usv$d[-3]) %*% t(usv$v[,-3])

r1(X1,X2)
r2(X1,X2)
r3(X1,X2)
r4(X1,X2)
GCD(X1,X2)
GCD(X1,X2, 5,5)

# Missing data
X1[c(1, 50, 400, 900)] &lt;- NA
X2[c(10, 200, 450, 1200)] &lt;- NA
r1(X1,X2, impute = TRUE)
r2(X1,X2, impute = TRUE)
r3(X1,X2, impute = TRUE)
r4(X1,X2, impute = TRUE)
GCD(X1,X2, impute = TRUE)
GCD(X1,X2, 5,5, impute = TRUE)


</code></pre>


</div>