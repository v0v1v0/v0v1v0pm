<div class="container">

<table style="width: 100%;"><tr>
<td>SMI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Similarity of Matrices Index (SMI)</h2>

<h3>Description</h3>

<p>A similarity index for comparing coupled data matrices.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SMI(
  X1,
  X2,
  ncomp1 = Rank(X1) - 1,
  ncomp2 = Rank(X2) - 1,
  projection = "Orthogonal",
  Scores1 = NULL,
  Scores2 = NULL,
  impute = FALSE,
  impute_par = list(max_iter = 20, tol = 10^-5)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X1</code></td>
<td>
<p>first <code>matrix</code> to be compared (<code>data.frames</code> are also accepted).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X2</code></td>
<td>
<p>second <code>matrix</code> to be compared (<code>data.frames</code> are also accepted).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncomp1</code></td>
<td>
<p>maximum number of subspace components from the first <code>matrix</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncomp2</code></td>
<td>
<p>maximum number of subspace components from the second <code>matrix</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>projection</code></td>
<td>
<p>type of projection to apply, defaults to "Orthogonal", alternatively "Procrustes".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Scores1</code></td>
<td>
<p>user supplied score-<code>matrix</code> to replace singular value decomposition of first <code>matrix</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Scores2</code></td>
<td>
<p>user supplied score-<code>matrix</code> to replace singular value decomposition of second <code>matrix</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>impute</code></td>
<td>
<p><code>logical</code> for activation of PCA based imputation for X1/X2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>impute_par</code></td>
<td>
<p>named <code>list</code> of imputation parameters in case of NAs in X1/X2.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A two-step process starts with extraction of stable subspaces using
Principal Component Analysis or some other method yielding two orthonormal bases. These bases
are compared using Orthogonal Projection (OP / ordinary least squares) or Procrustes
Rotation (PR). The result is a similarity measure that can be adjusted to various
data sets and contexts and which includes explorative plotting and permutation based testing
of matrix subspace equality.
</p>


<h3>Value</h3>

<p>A matrix containing all combinations of components. Its class is "SMI" associated
with print, plot, summary methods.
</p>


<h3>Author(s)</h3>

<p>Kristian Hovde Liland
</p>


<h3>References</h3>

<p>Ulf Geir Indahl, Tormod NÃ¦s, Kristian Hovde Liland; 2018. A similarity index for comparing coupled matrices. Journal of Chemometrics; e3049.
</p>


<h3>See Also</h3>

<p><code>plot.SMI</code> (print.SMI/summary.SMI), <code>RV</code> (RV2/RVadj), <code>r1</code> (r2/r3/r4/GCD), <code>Rozeboom</code>, <code>Coxhead</code>,
<code>allCorrelations</code> (matrix correlation comparison), <code>PCAcv (cross-validated PCA)</code>, <code>PCAimpute (PCA based imputation)</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Simulation
X1  &lt;- scale( matrix( rnorm(100*300), 100,300), scale = FALSE)
usv &lt;- svd(X1)
X2  &lt;- usv$u[,-3] %*% diag(usv$d[-3]) %*% t(usv$v[,-3])

(smi &lt;- SMI(X1,X2,5,5))
plot(smi, B = 1000 ) # default B = 10000

# Sensory analysis
data(candy)
plot( SMI(candy$Panel1, candy$Panel2, 3,3, projection = "Procrustes"),
    frame = c(2,2), B = 1000, x1lab = "Panel1", x2lab = "Panel2" ) # default B = 10000

# Missing data (100 missing completely at random points each)
X1[sort(round(runif(100)*29999+1))] &lt;- NA
X2[sort(round(runif(100)*29999+1))] &lt;- NA
(smi &lt;- SMI(X1,X2,5,5, impute = TRUE))

</code></pre>


</div>