<div class="container">

<table style="width: 100%;"><tr>
<td>plot.MatrixEQTL</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot histogram or QQ-plot of all p-values
</h2>

<h3>Description</h3>

<p>This method plots a histogram or QQ-plot of p-values
for all tests performed by <code>Matrix_eQTL_engine</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'MatrixEQTL'
plot(
    x,
    cex = 0.5,
    pch = 19,
    xlim = NULL,
    ylim = NULL,
    main = NULL,
    ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>An object returned by <code>Matrix_eQTL_engine</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>

<p>A numerical value giving the amount by which
plotting text and symbols should be magnified relative to the default.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>

<p>Plotting "character", i.e., symbol to use.
See <code>points</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>

<p>Set the range of the horisontal axis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>

<p>Set the range of the vertical axis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>

<p>Plot title.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Further graphical parameters passed to 
<code>lines</code> and <code>points</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The plot type (histogram vs. QQ-plot) is determined by the
<code>pvalue.hist</code> parameter in the call of
<code>Matrix_eQTL_engine</code> function.
</p>


<h3>Value</h3>

<p>The method does not return any value.
</p>


<h3>Note</h3>

<p>The sample code below produces figures like these:
</p>
<p>Histogram: <img src="../help/figures/histogram.png" alt="histogram.png"></p>
<p>QQ-plot: <img src="../help/figures/QQplot.png" alt="QQplot.png"></p>


<h3>Author(s)</h3>

<p>Andrey A Shabalin <a href="mailto:andrey.shabalin@gmail.com">andrey.shabalin@gmail.com</a>
</p>


<h3>References</h3>

<p>The package website:
<a href="http://www.bios.unc.edu/research/genomic_software/Matrix_eQTL/">http://www.bios.unc.edu/research/genomic_software/Matrix_eQTL/</a>
</p>


<h3>See Also</h3>

<p>See <code>Matrix_eQTL_engine</code> for reference and sample code.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(MatrixEQTL)

# Number of samples
n = 100 

# Number of variables
ngs = 2000

# Common signal in all variables
pop = 0.2*rnorm(n)

# data matrices
snps.mat = matrix(rnorm(n*ngs), ncol = ngs) + pop
gene.mat = matrix(rnorm(n*ngs), ncol = ngs) + pop + snps.mat*((1:ngs)/ngs)^9/2

# data objects for Matrix eQTL engine
snps1 = SlicedData$new( t( snps.mat ) )
gene1 = SlicedData$new( t( gene.mat ) )
cvrt1 = SlicedData$new( )
rm(snps.mat, gene.mat)

# Slice data in blocks of 500 variables
snps1$ResliceCombined(500)
gene1$ResliceCombined(500)

# Produce no output files
filename = NULL # tempfile()

# Perform analysis recording information for a histogram
meh = Matrix_eQTL_engine(
    snps = snps1, 
    gene = gene1, 
    cvrt = cvrt1, 
    output_file_name = filename, 
    pvOutputThreshold = 1e-100, 
    useModel = modelLINEAR, 
    errorCovariance = numeric(), 
    verbose = TRUE,
    pvalue.hist = 100)
    
plot(meh, col="grey")

# Perform analysis recording information for a QQ-plot
meq = Matrix_eQTL_engine(
    snps = snps1, 
    gene = gene1, 
    cvrt = cvrt1, 
    output_file_name = filename,
    pvOutputThreshold = 1e-6, 
    useModel = modelLINEAR, 
    errorCovariance = numeric(), 
    verbose = TRUE,
    pvalue.hist = "qqplot")
    
plot(meq)
</code></pre>


</div>