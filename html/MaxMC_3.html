<div class="container">

<table style="width: 100%;"><tr>
<td>mc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Monte Carlo with Tie-Breaker</h2>

<h3>Description</h3>

<p>Find the Monte Carlo (MC) p-value by generating N replications
of a statistic.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mc(
  y,
  statistic,
  ...,
  dgp = function(y) sample(y, replace = TRUE),
  N = 99,
  type = c("geq", "leq", "absolute", "two-tailed")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A vector or data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>A function or a character string that specifies
how the statistic is computed. The function needs to input the
<code>y</code> and output a scalar.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other named arguments for statistic which are
passed unchanged each time it is called</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dgp</code></td>
<td>
<p>A function. The function inputs the first argument
<code>y</code> and outputs a simulated <code>y</code>. It should represent the
data generating process under the null. Default value is the function
<code>sample(y, replace = TRUE)</code>, i.e. the
bootstrap resampling of <code>y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>An atomic vector. Number of replications of the test
statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A character string. It specifies the type of test
the p-value function produces. The possible values are
<code>geq</code>, <code>leq</code>, <code>absolute</code> and <code>two-tailed</code>.
Default is <code>geq</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>dgp</code> function defined by the user is used to
generate new observations in order to compute the simulated
statistics.
</p>
<p>Then <code>pvalue</code> is applied to the statistic and
its simulated values. <code>pvalue</code> computes the
p-value by ranking the statistic compared to its simulated
values. Ties in the ranking are broken according to a uniform
distribution.
</p>
<p>We allow for four types of p-value: <code>leq</code>, <code>geq</code>,
<code>absolute</code> and <code>two-tailed</code>. For one-tailed test,
<code>leq</code> returns the proportion of simulated values smaller
than the statistic while <code>geq</code> returns the proportion of
simulated values greater than the statistic. For two-tailed
test with a symmetric statistic, one can use the
absolute value of the statistic and its simulated values to
retrieve a two-tailed test (i.e. type = <code>absolute</code>).
If the statistic is not symmetric, one can specify the p-value
type as <code>two-tailed</code> which is equivalent to twice the minimum
of <code>leq</code> and <code>geq</code>.
</p>
<p>Ties in the ranking are broken according to a uniform
distribution.
</p>


<h3>Value</h3>

<p>The returned value is an object of class <code>mc</code>
containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>S0</code></td>
<td>
<p>Observed value of <code>statistic</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval</code></td>
<td>
<p>Monte Carlo p-value of <code>statistic</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Data specified in call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p><code>statistic</code> function specified in call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dgp</code></td>
<td>
<p><code>dgp</code> function specified in call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Number of replications specified in call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p><code>type</code> of p-value specified in call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>Original call to <code>mmc</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Value of <code>.Random.seed</code> at the start of
<code>mc</code> call.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Dufour, J.-M. (2006), Monte Carlo Tests with nuisance parameters:
A general approach to finite sample inference and nonstandard asymptotics in econometrics.
<em>Journal of Econometrics</em>, <b>133(2)</b>, 443-447.
</p>
<p>Dufour, J.-M. and Khalaf L. (2003), Monte Carlo Test Methods in Econometrics.
in Badi H. Baltagi, ed., <em>A Companion to Theoretical Econometrics</em>, Blackwell Publishing Ltd, 494-519.
</p>


<h3>See Also</h3>

<p><code>mmc</code>, <code>pvalue</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Example 1
## Kolmogorov-Smirnov Test using Monte Carlo

# Set seed
set.seed(999)

# Generate sample data
y &lt;- rgamma(8, shape = 2, rate = 1)

# Set data generating process function
dgp &lt;- function(y)  rgamma(length(y), shape = 2, rate = 1)

# Set the statistic function to the Kolomogorov-Smirnov test for gamma distribution
statistic &lt;- function(y){
    out &lt;- ks.test(y, "pgamma", shape = 2, rate = 1)
    return(out$statistic)
}

# Apply the Monte Carlo test with tie-breaker
mc(y, statistic = statistic, dgp = dgp, N = 999, type = "two-tailed")

</code></pre>


</div>