<div class="container">

<table style="width: 100%;"><tr>
<td>timeInfo</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Get time related information</h2>

<h3>Description</h3>

<p>Calculate the local time at the target location, as well as
sunrise, sunset and solar noon times, and create several temporal masks.
</p>
<p>The returned dataframe will have as many rows as the length of the incoming
UTC <code>time</code> vector and will contain the following columns:
</p>

<ul>
<li>
<p><code>localStdTime_UTC</code> – UTC representation of local <strong>standard</strong> time
</p>
</li>
<li>
<p><code>daylightSavings</code> – logical mask = TRUE if daylight savings is in effect
</p>
</li>
<li>
<p><code>localTime</code> – local clock time
</p>
</li>
<li>
<p><code>sunrise</code> – time of sunrise on each localTime day
</p>
</li>
<li>
<p><code>sunset</code> – time of sunset on each localTime day
</p>
</li>
<li>
<p><code>solarnoon</code> – time of solar noon on each localTime day
</p>
</li>
<li>
<p><code>day</code> – logical mask = TRUE between sunrise and sunset
</p>
</li>
<li>
<p><code>morning</code> – logical mask = TRUE between sunrise and solarnoon
</p>
</li>
<li>
<p><code>afternoon</code> – logical mask = TRUE between solarnoon and sunset
</p>
</li>
<li>
<p><code>night</code> – logical mask = opposite of day
</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">timeInfo(time = NULL, longitude = NULL, latitude = NULL, timezone = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>POSIXct vector with specified timezone,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>longitude</code></td>
<td>
<p>Longitude of the location of interest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>latitude</code></td>
<td>
<p>Latitude of the location of interest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timezone</code></td>
<td>
<p>Olson timezone at the location of interest.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>NOAA used the reference below to develop their Sunrise/Sunset
</p>
<p><a href="https://gml.noaa.gov/grad/solcalc/sunrise.html">https://gml.noaa.gov/grad/solcalc/sunrise.html</a> and Solar
Position
</p>
<p><a href="https://gml.noaa.gov/grad/solcalc/azel.html">https://gml.noaa.gov/grad/solcalc/azel.html</a>
Calculators.  The algorithms include corrections for atmospheric
refraction effects.
</p>
<p>Input can consist of one location and at least one POSIXct times, or one
POSIXct time and at least one location.  <var>solarDep</var> is recycled as
needed.
</p>
<p>Do not use the daylight savings time zone string for supplying
<var>dateTime</var>, as many OS will not be able to properly set it to
standard time when needed.
</p>
<p>The <code>localStdTime_UTC</code> column in the returned dataframe is primarily for
internal use and provides an important tool for creating LST daily averages
and LST axis labeling.
</p>


<h3>Value</h3>

<p>A dataframe with times and masks.
</p>


<h3>Attribution</h3>

<p>Internal functions used for ephemerides calculations were copied verbatim
from the now deprecated <strong>maptools</strong> package source
code in an effort to reduce the number of package dependencies.
</p>


<h3>Warning</h3>

<p>Compared to NOAA's original Javascript code, the sunrise and sunset estimates
from this translation may differ by +/- 1 minute, based on tests using
selected locations spanning the globe. This translation does not include
calculation of prior or next sunrises/sunsets for locations above the Arctic
Circle or below the Antarctic Circle.
</p>


<h3>Local Standard Time</h3>

<p>US EPA regulations mandate that daily averages be calculated
based on "Local Standard Time" (LST) (<em>i.e. never shifting to daylight
savings</em>). To ease work in a regulatory context, LST times are included in the
returned dataframe.
</p>


<h3>References</h3>

<p>Meeus, J. (1991) Astronomical Algorithms. Willmann-Bell, Inc.
</p>


<h3>Note</h3>

<p>NOAA notes that “for latitudes greater than 72 degrees N and S,
calculations are accurate to within 10 minutes. For latitudes less than +/-
72 degrees accuracy is approximately one minute.”
</p>


<h3>Author(s)</h3>

<p>Sebastian P. Luque <a href="mailto:spluque@gmail.com">spluque@gmail.com</a>, translated from
Greg Pelletier's <a href="mailto:gpel461@ecy.wa.gov">gpel461@ecy.wa.gov</a> VBA code (available from
<a href="https://ecology.wa.gov/Research-Data/Data-resources/Models-spreadsheets/Modeling-the-environment/Models-tools-for-TMDLs">https://ecology.wa.gov/Research-Data/Data-resources/Models-spreadsheets/Modeling-the-environment/Models-tools-for-TMDLs</a>), who in turn
translated it from original Javascript code by NOAA (see Details).
Roger Bivand <a href="mailto:roger.bivand@nhh.no">roger.bivand@nhh.no</a> adapted the code to work with
<strong>sp</strong> classes. Jonathan Callahan <a href="mailto:jonathan.callahan@gmail.com">jonathan.callahan@gmail.com</a>
adapted the source code from the <strong>maptools</strong> package to work with
<a href="https://mazamascience.github.io/MazamaTimeSeries/">MazmaTimeSeries</a> classes.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(MazamaTimeSeries)

Carmel &lt;-
  Carmel_Valley %&gt;%
  mts_filterDate(20160801, 20160810)

# Create timeInfo object for this monitor
ti &lt;- timeInfo(
  Carmel$data$datetime,
  Carmel$meta$longitude,
  Carmel$meta$latitude,
  Carmel$meta$timezone
)

t(ti[6:9,])

# Subset the data based on day/night masks
data_day &lt;- Carmel$data[ti$day,]
data_night &lt;- Carmel$data[ti$night,]

# Build two monitor objects
Carmel_day &lt;- list(meta = Carmel$meta, data = data_day)
Carmel_night &lt;- list(meta = Carmel$meta, data = data_night)

# Plot them
plot(Carmel_day$data, pch = 8, col = 'goldenrod')
points(Carmel_night$data, pch = 16, col = 'darkblue')
</code></pre>


</div>