<div class="container">

<table style="width: 100%;"><tr>
<td>ETref</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>FAO-56 Penman-Monteith grass reference evapotranspiration</h2>

<h3>Description</h3>

<p>FAO Penman-Monteith equations to compute grass reference evapotranspiration from weather data for daily, monthly, hourly or shorter periods.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ETref(
  x,
  Tmax = NULL,
  Tmin = NULL,
  Rhmax = NULL,
  Rhmin = NULL,
  Tmean = NULL,
  Rhmean = NULL,
  u = NULL,
  Rs = NULL,
  n = NULL,
  P = NULL,
  elev,
  lat.rad = NULL,
  lat.deg = NULL,
  long.deg = NULL,
  tl,
  G = NULL,
  actVP = NULL,
  control = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>date-time object or day of the year (must be date-time object if calculation period is shorter than a day)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tmax</code></td>
<td>
<p>maximum temperature [degreeC] during 24-hour period (for daily values)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tmin</code></td>
<td>
<p>minimum temperature [degreeC] during 24-hour period  (for daily values)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rhmax</code></td>
<td>
<p>maximum of air humidity [percent] during 24-hour period (for daily values)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rhmin</code></td>
<td>
<p>minimum of air humidity [percent] during 24-hour period(for daily values)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tmean</code></td>
<td>
<p>mean air temperature [degreeC]. For periods shorter 1 day.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rhmean</code></td>
<td>
<p>mean relative air humidity [percent]. For periods shorter 1 day or if Rhmax and Rhmin are missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>wind speed [m/s] at 2 meter height. If measurement height is not 2 m, define height with control &lt;- list(uz = 2)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rs</code></td>
<td>
<p>solar radiation [MJ/(m2 time)]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>actual hours of sunshine. Used to calculate Rs if Rs messurements are not available (see <code>estRs</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>air pressure [kPa]. Estimated with <code>estP</code> if missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>elev</code></td>
<td>
<p>station elevation above sea level [m]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat.rad</code></td>
<td>
<p>latitude [rad]. Use either lat.rad or lat.deg. Latitude is positive for the northern hemisphere and negative for the southern hemisphere</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat.deg</code></td>
<td>
<p>latitude [degree]. Use either lat.deg or lat.rad. Latitude is positive for the northern hemisphere and negative for the southern hemisphere</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>long.deg</code></td>
<td>
<p>longitude [degree] east of Greenwich (for periods &lt; 1 day)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tl</code></td>
<td>
<p>length of calculation period [hour] (1 for hourly, 0.5 for 30-minute and 24 for daily period).
Only needed if x is date-time object with length of 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>soil heat flux (Assumed to be 0 for daily calculations) (for calculation periods shorter than a day estimated with <code>estG</code> if missing)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>actVP</code></td>
<td>
<p>Actual vapor pressure [kPa]. If Rhmax, Rhmin and Rhmean are NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>list for control parameters and empirical factors (see details, <code>controlDefaults</code> and <code>constDefaults</code>)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<dl>
<dt>x:</dt>
<dd>
<p>must be provided as.numeric (1-366) or as a common date-time object (e.g, POSIXct, POSIXlt or Date objects).
All formats for which is.timepoint from the lubridate package returns TRUE can be used</p>
</dd>
</dl>
<dl>
<dt>control: (see also <code>controlDefaults</code> and <code>constDefaults</code>)<br>
</dt>
<dd>
<p>Lz:<br>
longitude of the centre of the local time zone (degrees west of Greenwich)<br>
- 0 for Greenwich<br>
- 345 for Germany<br>
- 330 for Cairo (Egypt)<br>
- 255 for Bangkok (Thailand)<br>
- 75, 90, 105 and 120 for Eastern, Central, Rocky Mountain and Pacific time zones (United States)<br>
Lz is only needed if calculation period is shorter than 1 day.<br><br>
uz: height of wind measurements (m) <br><br>
albedo: default 0.23 for the hypothetical grass and alfalfa reference crops used in
the FAO-56 PM equations <br><br>
as: regression constant, expressing fraction of extraterrestrial radiation reaching earth on overcast days (n = 0) (default = 0.25) <br><br>
bs: as + bs fraction of extraterrestrial radiation reaching earth on clear days (n = N) (default = 0.5)<br><br>
Tko: reference temperature [degreeC] at elevation z0. Only needed if atmospheric pressure is missing. Often assumed to be 20 degreeC. <br><br>
z0: elevation at reference level (fefault = 0 [m])<br><br>
est.ratio.Rs.Rso: <br> Rs/Rso is used to represent cloud cover. For hourly or shorter periods during the nighttime,
the ratio Rs/Rso is set equal to the Rs/Rso calculated for a time period occurring 2-3 hours before sunset.
If single values during nighttime are calculated Rs/Rso ration 2-3 hours before sunset can not be calculated
and an approximation is needed. Following Allen (1999) one can assume Rs/Rso = 0.4 to 0.6 during nighttime periods
in humid and subhumid climates and Rs/Rso = 0.7 to 0.8 in arid and semiarid climates. A value of Rs/Rso = 0.3 presumes
total cloud cover. </p>
</dd>
</dl>
<h3>Value</h3>

<p>grass reference evapotranspiration [mm]
</p>


<h3>Note</h3>

<p>eq. 6 from reference for daily and eq. 53 for hourly or shorter periods
</p>


<h3>Author(s)</h3>

<p>Ullrich Dettmann
</p>


<h3>References</h3>

<p>Allen, R. G., Pereira, L. S., Raes, D., &amp; Smith, M. (1998). Crop evapotranspiration-Guidelines for computing crop water requirements-FAO Irrigation and drainage paper 56. FAO, Rome, 300(9).
</p>


<h3>Examples</h3>

<pre><code class="language-R"># --------------------------------------------
#  Daily Evapotranspiration
# --------------------------------------------

ETref(x = 187, Rs = 22.07, elev = 100, lat.deg = 50.8, Tmax = 21.5, Tmin = 12.3,
      Rhmax = 84, Rhmin = 63,
      u = 2.78, control = list(uz = 10), P = 100.1)

# Calculation with sunshine hour (n) instead of
# global radiation (Rs) (Rs ist estimated from n with estRs):

ETref(x = 187, n = 9.25, elev = 100, lat.deg = 50.8, Tmax = 21.5, Tmin = 12.3,
     Rhmax = 84, Rhmin = 63,
     u = 2.78, control = list(uz = 10), P = 100.1)

# --------------------------------------------
#  Hourly Evapotranspiration
# --------------------------------------------

ETref(x = as.POSIXct(c('2018-10-01 14:30', '2018-10-01 15:30')),
      Tmean = c(38, 37.8), Rhmean = c(52, 52.3), u = c(3.3, 3.2), Rs = c(2.450, 2.5), elev = 8,
      lat.deg = 16.22, long.deg = 343.75, G = c(0.175, 0.178) , P = c(101.21, 101.21) ,
      control = list(Lz = 15))

# If only one time step is calculated tl must be provided (1 for hourly, 0.5 for 30 minute periods):

ETref(x = as.POSIXct('2018-10-01 14:30'), tl = 1,
      Tmean = 38, Rhmean = 52, u = 3.3, Rs = 2.450, elev = 8,
      lat.deg = 16.22, long.deg = 343.75, G = 0.1749218, P = 101.2056,
      control = list(Lz = 15))

# Calculation with missing soil heat flux (G) and atmospheric pressure (P) (G is estimated with estG
# and P with estP)

ETref(x = as.POSIXct('2018-10-01 14:30'), tl = 1,
      Tmean = 38, Rhmean = 52, u = 3.3, Rs = 2.450, elev = 8,
      lat.deg = 16.22, long.deg = 343.75,
      control = list(Lz = 15))
# --------------------------------------------
</code></pre>


</div>