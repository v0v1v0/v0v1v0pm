<div class="container">

<table style="width: 100%;"><tr>
<td>estG</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate soil heat flux (G)</h2>

<h3>Description</h3>

<p>Estimate soil heat flux (G) for periods shorter than a day.
</p>


<h3>Usage</h3>

<pre><code class="language-R">estG(
  x,
  Rs,
  Tmean,
  Rhmean,
  lat.rad = NULL,
  lat.deg = NULL,
  long.deg = NULL,
  elev = 1,
  tl,
  control = list(albedo = 0.23, Lz = 345, est.ratio.Rs.Rso = NA)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>date-time object (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rs</code></td>
<td>
<p>incoming solar radiation [MJ/(m2 time)]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tmean</code></td>
<td>
<p>Mean air temperature [degreeC]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rhmean</code></td>
<td>
<p>Mean air humidity [percent]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat.rad</code></td>
<td>
<p>latitude [rad]. Use either lat.rad or lat.deg. Latitude is positive for the northern hemisphere and negative for the southern hemisphere</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat.deg</code></td>
<td>
<p>latitude [degree]. Use either lat.deg or lat.rad. Latitude is positive for the northern hemisphere and negative for the southern hemisphere</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>long.deg</code></td>
<td>
<p>longitude of the measurement site (degrees east of Greenwich)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>elev</code></td>
<td>
<p>station elevation above sea level [m]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tl</code></td>
<td>
<p>length of calculation period [hour] (1 for hourly period, 0.5 for a 30-minute period or 24 for daily period).
Only needed if x is date-time object with length of 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>list for control parameters and empirical factors defined in
<code>controlDefaults</code> and <code>constDefaults</code> (see Details)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>during daylight periods G is estimated to be <code>Rn</code> x 0.1 During nighttime G = <code>Rn</code> x 0.5.
Day is defined for extraterrestrial radiation &gt; 0.
</p>
<dl>
<dt>x:</dt>
<dd>
<p>must be provided as a common date-time object (e.g, POSIXct, POSIXlt or Date objects).
All formats for which is.timepoint from the lubridate package returns TRUE can be used</p>
</dd>
</dl>
<dl>
<dt>control:</dt>
<dd>
<p>albedo: <br>
default 0.23 for the hypothetical grass and alfalfa reference crops used in <br>
the FAO-56 PM equations <br><br>
Lz:<br>
longitude of the centre of the local time zone (degrees west of Greenwich)<br>
- 0 for Greenwich<br>
- 345 for Germany<br>
- 330 for Cairo (Egypt)<br>
- 255 for Bangkok (Thailand)<br>
- 75, 90, 105 and 120 for Eastern, Central, Rocky Mountain and Pacific time zones (United States)<br>
Lz is only needed if calculation period is shorter 1 day. <br><br>
est.ratio.Rs.Rso: <br>
Rs/Rso is used to represent cloud cover. For hourly periods during the nighttime,
the ratio Rs/Rso is set equal to the Rs/Rso calculated for a time period occurring 2-3 hours before sunset.
If single values during nighttime are calculated Rs/Rso ration 2-3 hours before sunset can not be calculated
and an approximation is needed. Following Allen (1999) one can assume Rs/Rso = 0.4 to 0.6 during nighttime periods
in humid and subhumid climates and Rs/Rso = 0.7 to 0.8 in arid and semiarid climates. A value of Rs/Rso = 0.3 presumes
total cloud cover.</p>
</dd>
</dl>
<h3>Note</h3>

<p>eq. 45 and 46 of reference
</p>


<h3>References</h3>

<p>Allen, R. G., Pereira, L. S., Raes, D., &amp; Smith, M. (1998). Crop evapotranspiration-Guidelines for computing crop water requirements-FAO Irrigation and drainage paper 56. FAO, Rome, 300(9).
</p>


<h3>Examples</h3>

<pre><code class="language-R">estG(x = as.POSIXct(c('2018-10-01 14:30', '2018-10-01 15:00')), Tmean = 38, Rhmean = 52, Rs = 2.450,
     elev = 8, lat.deg = 16.21, long.deg = 343.75, control = list(Lz = 15))

estG(x = as.POSIXct('2018-10-01 02:30'), Tmean = 28, Rhmean = 90, tl = 1, Rs = 0, elev = 8,
     lat.deg = 16.2, long.deg = 343.75, control = list(Lz = 15, est.ratio.Rs.Rso = 0.8))

estG(x = as.POSIXct('2018-10-01 14:30'), Tmean = 38, Rhmean = 52, tl = 1, Rs = 2.450, elev = 8,
     lat.deg = 16.21, long.deg = 343.75, control = list(Lz = 15))

</code></pre>


</div>