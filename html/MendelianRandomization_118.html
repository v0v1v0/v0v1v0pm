<div class="container">

<table style="width: 100%;"><tr>
<td>mr_mvpcgmm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multivariable principal components generalized method of moments (PC-GMM) method</h2>

<h3>Description</h3>

<p>The <code>mr_mvpcgmm</code> function performs multivariable Mendelian randomization via the principal components generalized method of moments method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mr_mvpcgmm(
  object,
  nx,
  ny,
  cor.x = NULL,
  r = NULL,
  thres = 0.99,
  robust = TRUE,
  alpha = 0.05,
  ...
)

## S4 method for signature 'MRMVInput'
mr_mvpcgmm(
  object,
  nx,
  ny,
  cor.x = NULL,
  r = NULL,
  thres = 0.99,
  robust = TRUE,
  alpha = 0.05,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An <code>MRMVInput</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nx</code></td>
<td>
<p>Vector of sample sizes used to compute genetic associations with the exposure (one for each exposure).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ny</code></td>
<td>
<p>The sample size used to compute genetic associations with the outcome.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor.x</code></td>
<td>
<p>Correlation matrix for exposures. Default is to assume the exposures are uncorrelated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>The number of genetic principal components to be used to instrument the exposures. Default chooses <code>r</code> to explain 99.9% of variation in a sample weighted genetic correlation matrix (this can be varied by setting the <code>thres</code> parameter).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thres</code></td>
<td>
<p>The threshold value of variation in the sample weighted genetic correlation matrix explained by the genetic principal components. The default value is 0.99, indicating that 99% of variation is explained by the principal components. Note that if <code>r</code> and <code>thres</code> are both specified, then <code>r</code> will take precedence and <code>thres</code> will be ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>
<p>Indicates whether overdispersion heterogeneity is accounted for in the model. Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The significance level used to calculate the confidence interval. The default value is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to be passed to the optimization routines to calculate GMM estimates and overdispersion parameter.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When a Mendelian randomization analysis is performed using correlated genetic variants from a single gene region, there is a tradeoff between using too few variants (and compromising on power) and using too many variants (in which case, estimates can be highly sensitive to small variation in the correlation matrix). This method performs dimension reduction on a weighted version of the genetic correlation matrix to form principal components based on the genetic variants, which are then used as instruments. It is recommended not to include very highly correlated variants in this method (say, <code>r^2 &gt; 0.95</code>), but the method should cope well with variants correlated below this level.
</p>
<p>This function runs a multivariable version of the PC-GMM method, which can be used when there are distinct exposures associated with variants at a single gene region. Phenotypic heterogeneity (that is, the genetic associations with the exposures are not collinear) at genomic loci encoding drug targets can be exploited by multivariable Mendelian randomization to provide insight on the pathways by which pharmacological interventions may affect disease risk.
</p>
<p>This method provides two-sample multivariable Mendelian randomization estimates and associated confidence intervals that account for overdispersion heterogeneity in dimension-reduced genetic associations (when <code>robust = TRUE</code>).
</p>


<h3>Value</h3>

<p>The output from the function is an <code>MVPCGMM</code> object containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Robust</code></td>
<td>
<p><code>TRUE</code> if overdispersion heterogeneity was included in the model, <code>FALSE</code> otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Exposure</code></td>
<td>
<p>A character vector with the names given to the exposure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Outcome</code></td>
<td>
<p>A character string with the names given to the outcome.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Correlation</code></td>
<td>
<p>The matrix of genetic correlations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ExpCorrelation</code></td>
<td>
<p><code>TRUE</code> if an exposure correlation matrix was specified, <code>FALSE</code> otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CondFstat</code></td>
<td>
<p>A vector of conditional F-statistics (one for each exposure).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Estimate</code></td>
<td>
<p>A vector of causal estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>StdError</code></td>
<td>
<p>A vector of standard errors of the causal estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CILower</code></td>
<td>
<p>The lower bounds of the causal estimates based on the estimated standard errors and the significance level provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CIUpper</code></td>
<td>
<p>The upper bounds of the causal estimates based on the estimated standard errors and the significance level provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Overdispersion</code></td>
<td>
<p>The estimate of the overdispersion parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PCs</code></td>
<td>
<p>The number of genetic principal components used to instrument the exposures.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pvalue</code></td>
<td>
<p>The p-values associated with the estimates (calculated as Estimate/StdError as per Wald test) using a normal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Alpha</code></td>
<td>
<p>The significance level used when calculating the confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Heter.Stat</code></td>
<td>
<p>Heterogeneity statistic (Cochran's Q statistic) and associated p-value (for non-robust model only): the null hypothesis is that all genetic principal components estimate the same causal parameter; rejection of the null is an indication that one or more principal components may be pleiotropic.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Description of multivariable Mendelian randomization: Stephen Burgess, Simon G Thompson. Multivariable Mendelian Randomization: the use of pleiotropic genetic variants to estimate causal effects. American Journal of Epidemiology 2015; 181(4):251-260. doi: 10.1093/aje/kwu283.
</p>
<p>Description of the PC-GMM method: "Robust use of phenotypic heterogeneity at drug target genes for mechanistic insights: application of cis-multivariable Mendelian randomization to GLP1R gene region" (Preprint).
</p>


<h3>Examples</h3>

<pre><code class="language-R">mr_mvpcgmm(mr_mvinput(bx = cbind(ldlc, hdlc, trig), bxse = cbind(ldlcse, hdlcse, trigse),
   by = chdlodds, byse = chdloddsse, correlation = diag(length(ldlc))), nx=rep(17723,3), ny=17723)
# Note this example does not use variants from a single gene region, and is provided
#  to demonstrate that the code works, rather than to illustrate a recommended use case.

</code></pre>


</div>