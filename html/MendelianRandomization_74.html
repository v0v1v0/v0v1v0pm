<div class="container">

<table style="width: 100%;"><tr>
<td>mr_clr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Conditional likelihood ratio (CLR) method</h2>

<h3>Description</h3>

<p>The <code>mr_clr</code> function calculates confidence intervals based on inverting the conditional likelihood ratio and other identification-robust tests.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mr_clr(object, nx, ny, alpha = 0.05, CIMin = -10, CIMax = 10, CIStep = 0.01)

## S4 method for signature 'MRInput'
mr_clr(object, nx, ny, alpha = 0.05, CIMin = -10, CIMax = 10, CIStep = 0.01)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An <code>MRInput</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nx</code></td>
<td>
<p>The sample size used to compute genetic associations with the exposure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ny</code></td>
<td>
<p>The sample size used to compute genetic associations with the outcome.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The significance level used to calculate the confidence interval. The default value is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CIMin</code></td>
<td>
<p>The smallest value to use in the search to find the confidence interval (default is -10).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CIMax</code></td>
<td>
<p>The largest value to use in the search to find the confidence interval (default is +10).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CIStep</code></td>
<td>
<p>The step size to use in the search to find the confidence interval (default is 0.01). Using a lower value (such as 0.001) will give more precise confidence intervals, but increase run time.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In weak instrument settings, usual inference based on point estimates and standard errors may not be accurate. This method calculates confidence intervals based on inverting identification-robust tests proposed in Wang and Kang (2021, Biometrics) that provide valid inferences regardless of instrument strength.
</p>
<p>This includes conditional likelihood ratio (CLR), Kleibergen (K), and Anderson and Rubin (AR) tests.
</p>
<p>Evidence from the econometrics literature suggests that CLR inference is the best option in terms of power under a wide range of settings.
</p>
<p>Please note that these methods do not provide point estimates, only confidence intervals. While most examples provide a confidence interval that is a single range of values, in some cases the confidence interval may comprise multiple ranges of values. In other cases, a valid confidence interval may not exist.
</p>


<h3>Value</h3>

<p>The output from the function is an <code>CLR</code> object containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Exposure</code></td>
<td>
<p>A character string with the name given to the exposure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Outcome</code></td>
<td>
<p>A character string with the names given to the outcome.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Correlation</code></td>
<td>
<p>The matrix of genetic correlations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ARlower</code></td>
<td>
<p>The lower bounds of the causal estimate based on inverting Anderson and Rubin's test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ARupper</code></td>
<td>
<p>The upper bounds of the causal estimate based on inverting Anderson and Rubin's test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Klower</code></td>
<td>
<p>The lower bounds of the causal estimate based on inverting Kleibergen's test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Kupper</code></td>
<td>
<p>The upper bounds of the causal estimate based on inverting Kleibergen's test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CLRlower</code></td>
<td>
<p>The lower bounds of the causal estimate based on inverting Moreira's conditional likelihood ratio test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CLRupper</code></td>
<td>
<p>The upper bounds of the causal estimate based on inverting Moreira's conditional likelihood ratio test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CIMin</code></td>
<td>
<p>The smallest value used in the search to find the confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CIMax</code></td>
<td>
<p>The largest value used in the search to find the confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CIStep</code></td>
<td>
<p>The step size used in the search to find the confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Alpha</code></td>
<td>
<p>The significance level used when calculating the confidence intervals.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Description of the CLR method: "Weak-instrument robust tests in two-sample summary-data Mendelian randomization", S. Wang and H. Kang, Biometrics, 2021.
</p>


<h3>Examples</h3>

<pre><code class="language-R">mr_clr(mr_input(bx = calcium, bxse = calciumse,
   by = fastgluc, byse = fastglucse, correl = calc.rho), nx=6351, ny=133010)

</code></pre>


</div>