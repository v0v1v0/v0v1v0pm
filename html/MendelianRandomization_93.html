<div class="container">

<table style="width: 100%;"><tr>
<td>mr_lasso</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MR-Lasso method</h2>

<h3>Description</h3>

<p>The <code>mr_lasso</code> function performs the MR-Lasso method, which applies lasso-type penalization to the direct effects of genetic variants on the outcome.
The causal estimate is described as a post-lasso estimate, and is obtained by performing the IVW method using only those genetic variants that are identified as valid by the lasso procedure.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mr_lasso(object, distribution = "normal", alpha = 0.05, lambda = numeric(0))

## S4 method for signature 'MRInput'
mr_lasso(object, distribution = "normal", alpha = 0.05, lambda = numeric(0))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An <code>MRInput</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distribution</code></td>
<td>
<p>The type of distribution used to calculate the confidence intervals. Options are <code>"normal"</code> (default) or <code>"t-dist"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The significance level used to calculate the confidence intervals. The default value is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>The value of the tuning parameter used by the lasso procedure which controls the level of sparsity. If not specified, the tuning parameter will be calculated by the heterogeneity stopping rule.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>MR-Lasso extends the IVW model to include an intercept term for each genetic variant. These intercept terms represent associations between the
genetic variants and the outcome which bypass the risk factor. The causal effect estimates are estimated by weighted linear regression where the intercept terms are subject
to lasso-type penalization. The lasso penalization will tend to shrink the intercept terms corresponding to the valid instruments to zero.
</p>
<p>The lasso penalty relies on a tuning parameter which controls the level of sparsity. The default is to use a heterogeneity stopping rule, but a fixed value may be specified.
</p>
<p>As part of the analysis, the genetic variants are orientated so that all of the associations with the risk factor are positive (and signs of associations with the outcome are
changed to keep the orientation consistent if required). Re-orientation of the genetic variants is performed automatically as part of the function.
</p>
<p>The MR-Lasso method is performed in two steps. First, a regularized regression model is fitted, and some genetic variants are identified as valid instruments. Second, the causal effect is estimated using standard IVW with only the valid genetic variants.
The post-lasso method will be performed as long as at least two genetic variants are identified as valid instruments. The default heterogeneity stopping rule will always return at least two
genetic variants as valid instruments.
The main estimate given by the method is the post-lasso estimate. However, parameter estimates from the regularized regression model used to identify invalid variants are also provided for completeness.
</p>
<p>If a substantial proportion of genetic variants are removed from the analysis, the MR-Lasso method may give a false impression of confidence in the causal estimate due to homogeneity of the variant-specific causal estimates amongst the remaining variants. However, it is not reasonable to claim that there is strong evidence for a causal effect after a large number of variants with heterogeneous estimates have been removed from the analysis.
</p>


<h3>Value</h3>

<p>The output from the function is an <code>MRLasso</code> object containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Exposure</code></td>
<td>
<p>A character vector with the names given to the exposure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Outcome</code></td>
<td>
<p>A character string with the names given to the outcome.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Estimate</code></td>
<td>
<p>The causal estimate from the MR-Lasso method. This is the post-lasso estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>StdError</code></td>
<td>
<p>The standard error of the causal estimate from the MR-Lasso method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CILower</code></td>
<td>
<p>The lower bound of the confidence interval for the causal estimate based on the estimated standard error and the significance level provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CIUpper</code></td>
<td>
<p>The upper bound of the confidence interval for the causal estimate based on the estimated standard error and the significance level provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Alpha</code></td>
<td>
<p>The significance level used when calculating the confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pvalue</code></td>
<td>
<p>The p-value associated with the causal estimate using a normal or t-distribution (as specified in <code>distribution</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SNPs</code></td>
<td>
<p>The number of genetic variants (SNPs) included in the analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RegEstimate</code></td>
<td>
<p>The estimate from the regularized regression model used in the MR-Lasso method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RegIntercept</code></td>
<td>
<p>The intercept estimates from the regularized regression model used in the MR-Lasso method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Valid</code></td>
<td>
<p>The number of genetic variants that have been identified as valid instruments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ValidSNPs</code></td>
<td>
<p>The names of genetic variants that have been identified as valid instruments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lambda</code></td>
<td>
<p>The value of the tuning parameter used to compute <code>RegEstimate</code></p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Jessica MB Rees, Angela M Wood, Frank Dudbridge, Stephen Burgess. Robust methods in Mendelian randomization via penalization of heterogeneous causal estimates. PLoS ONE 2019; 14(9):e0222362
</p>


<h3>Examples</h3>

<pre><code class="language-R">mr_lasso(mr_input(bx = ldlc, bxse = ldlcse, by = chdlodds, byse = chdloddsse))

</code></pre>


</div>