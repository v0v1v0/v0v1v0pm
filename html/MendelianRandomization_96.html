<div class="container">

<table style="width: 100%;"><tr>
<td>mr_maxlik</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Maximum-likelihood method</h2>

<h3>Description</h3>

<p>The <code>mr_maxlik</code> function implements the maximum-likelihood method introduced by Burgess et al (2013).
</p>


<h3>Usage</h3>

<pre><code class="language-R">mr_maxlik(
  object,
  model = "default",
  correl = FALSE,
  psi = 0,
  distribution = "normal",
  alpha = 0.05,
  ...
)

## S4 method for signature 'MRInput'
mr_maxlik(
  object,
  model = "default",
  correl = FALSE,
  psi = 0,
  distribution = "normal",
  alpha = 0.05,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An <code>MRInput</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>What type of model should be used: <code>"default"</code>, <code>"random"</code> or <code>"fixed"</code>. The method naturally estimates a fixed-effect model, assuming that the same causal effect is estimated by each of the genetic variants. However, if there is heterogeneity in the causal estimates of the different variants, then confidence intervals under a fixed-effect model will be overly narrow. The random-effects model adds additional uncertainty by multiplying the standard error by the square-root of the likelihood ratio heterogeneity statistic divided by the number of genetic variants less one (unless this quantity is less than 1, in which case no modification to the standard error is made). This parallels the residual standard error in a regression model (the Cochran Q heterogeneity test statistic is equal to the square of the RSE multiplied by the number of genetic variants less one). The default setting (<code>"default"</code>) is to use a fixed-effect model with 3 genetic variants or fewer, and otherwise to use a random-effects model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correl</code></td>
<td>
<p>If the genetic variants are correlated, then this correlation can be accounted for. The matrix of correlations between must be provided in the <code>MRInput</code> object: the elements of this matrix are the correlations between the individual variants (diagonal elements are 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi</code></td>
<td>
<p>The correlation between the association with the exposure and the association with the outcome for each variant resulting from sample overlap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distribution</code></td>
<td>
<p>The type of distribution used to calculate the confidence intervals, can be <code>"normal"</code> (the default option) or <code>"t-dist"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The significance level used to calculate the confidence interval. The default value is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to be passed to the optimization method.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A likelihood function is defined by assuming that the summarized data for each genetic variant are normally distributed. A bivariate normal distribution is assumed for the associations of each genetic variant with the exposure and with the outcome. The mean of the association with the outcome is taken as the mean association with the exposure multiplied by the causal effect parameter.
</p>
<p>Thus, if there are <code>K</code> genetic variants, then <code>K+1</code> parameters are estimated by the method: one for each geneâ€“exposure association, plus the causal parameter. If the number of genetic variants is large, then maximization of this function may be an issue. If the maximum likelihood estimate substantially differs from the inverse-variance weighted estimate, this may indicate that convergence has not occurred in the optimization algorithm.
</p>
<p>The variance-covariance matrices for the bivariate normal distributions are obtained from the standard error estimates provided. The correlation <code>psi</code> between genetic associations with the exposure and with the outcome due to sample overlap can be specified; its default value is zero.
</p>
<p>Two features why this method may be preferred over the inverse-variance weighted method are the incorporation in the model of uncertainty in the genetic associations with the exposure, and of correlation between the genetic association estimates with exposure and outcome for each variant. The method is implemented both for uncorrelated and correlated genetic variants. It can also be used for a single genetic variant.
</p>
<p>The original version of the maximum-likelihood method assumed that all genetic variants identify the same causal estimate; a fixed-effect model. The causal estimate may be overly precise if the fixed-effect model is incorrect and there is substantial heterogeneity in the causal estimates from the different variants. The random-effects analysis implemented here is an ad hoc solution to the problem of heterogeneity, but one that should result in reasonable confidence intervals that incorporate this heterogeneity.
</p>


<h3>Value</h3>

<p>The output from the function is an <code>MaxLik</code> object containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Model</code></td>
<td>
<p>A character string giving the type of model used (<code>"fixed"</code>, <code>"random"</code>, or <code>"default"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Exposure</code></td>
<td>
<p>A character string giving the name given to the exposure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Outcome</code></td>
<td>
<p>A character string giving the name given to the outcome.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Correlation</code></td>
<td>
<p>The matrix of genetic correlations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Psi</code></td>
<td>
<p>The correlation between genetic associations with the exposure and with the outcome.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Estimate</code></td>
<td>
<p>The value of the causal estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>StdError</code></td>
<td>
<p>Standard error of the causal estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CILower</code></td>
<td>
<p>The lower bound of the causal estimate based on the estimated standard error and the significance level provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CIUpper</code></td>
<td>
<p>The upper bound of the causal estimate based on the estimated standard error and the significance level provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Alpha</code></td>
<td>
<p>The significance level used when calculating the confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pvalue</code></td>
<td>
<p>The p-value associated with the estimate (calculated as Estimate/StdError as per Wald test) using a normal or t-distribution (as specified in <code>distribution</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SNPs</code></td>
<td>
<p>The number of genetic variants (SNPs) included in the analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RSE</code></td>
<td>
<p>The estimated residual standard error from the regression model (always equal to 1, as a fixed-effect model is required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Heter.Stat</code></td>
<td>
<p>Heterogeneity statistic (likelihood ratio statistic) and associated p-value: the null hypothesis is that all genetic variants estimate the same causal parameter; rejection of the null is an indication that one or more variants may be pleiotropic.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Stephen Burgess, Adam S Butterworth, Simon G Thompson. Mendelian randomization analysis with multiple genetic variants using summarized data. Genetic Epidemiology 2013; 37:658-665. doi: 10.1002/gepi.21758.
</p>


<h3>Examples</h3>

<pre><code class="language-R">mr_maxlik(mr_input(bx = ldlc[1:10], bxse = ldlcse[1:10],
  by = chdlodds[1:10], byse = chdloddsse[1:10]))
mr_maxlik(mr_input(bx = ldlc[1:10], bxse = ldlcse[1:10],
  by = chdlodds[1:10], byse = chdloddsse[1:10]), psi=0.2)
mr_maxlik(mr_input(calcium, calciumse, fastgluc, fastglucse, corr=calc.rho))
  ## correlated variants

</code></pre>


</div>