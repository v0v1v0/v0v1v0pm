<div class="container">

<table style="width: 100%;"><tr>
<td>downsample</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Downsampling a Distance Visualization to Facilitate iGraph
</h2>

<h3>Description</h3>

<p>The <code>downsample</code> function implements a structured reduction 
of data points with a parent <code>Mercator</code> distance visualization to 
improve visualization and computational time, especially for the 
implementation of the iGraph visualization.
</p>


<h3>Usage</h3>

<pre><code class="language-R">downsample(target, distanceMat, cutoff)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>An <code>integer</code> number of points to which the user wishes to 
reduce the parent <code>Mercator</code> object.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distanceMat</code></td>
<td>
<p>An object of class <code>matrix</code> containing the 
distance matrix component of the parent <code>Mercator</code> object.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>An inclusion cutoff for selected points based on the 
local density within the parent data.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Mercator can be used to visualize complex networks using 
iGraph. To improve clarity of the visualization and computational 
time, we implement the <code>downsample</code> function to reduce the 
number of data points to be linked and visualized. The conceptual 
grounding for <code>downsample</code> draws on Peng Qiu's implementation of the
SPADE clustering algorithm for mass cytometry data. The
<code>downsample</code> function 
under-samples the densest regions of the data space to make it more 
likely that rarer clusters will still be adequately sampled.
</p>


<h3>Value</h3>

<p><code>downsample</code> returns an object of class <code>Mercator</code> containing 
a structured subset of items from the parent <code>Mercator</code> object.
</p>


<h3>Author(s)</h3>

<p>Kevin R. Coombes &lt;krc@silicovore.com&gt;, Caitlin E. Coombes</p>


<h3>References</h3>

<p>Qiu, P., et. al. (2011). Extracting a cellular hierarchy from high-dimensional cytometry data with SPADE. Nature biotechnology, 29(10), 886.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Form a BinaryMatrix
data("iris")
my.data &lt;- as.matrix(iris[,c(1:4)])
my.rows &lt;- as.data.frame(c(1:length(my.data[,1])))
my.binmat &lt;- BinaryMatrix(my.data, , my.rows)
my.binmat &lt;- t(my.binmat)
summary(my.binmat)

# Form and plot Mercator object
# Set K to the known number of species in the dataset
my.vis &lt;- Mercator(my.binmat, "euclid", "tsne", K=3)
summary(my.vis)
plot(my.vis, view = "tsne", main="t-SNE plot of all data points")

#Downsample the Mercator object
M &lt;- as.matrix(my.vis@distance)
set.seed(21340)
DS &lt;- downsample(50, M, 0.1)
red.vis &lt;- my.vis[DS]

#Visualize the down sampled t-SNE plot
plot(red.vis, view = "tsne", main="Down sampled t-SNE Plot")
</code></pre>


</div>