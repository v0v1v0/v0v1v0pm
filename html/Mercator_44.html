<div class="container">

<table style="width: 100%;"><tr>
<td>threshLGF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Threshing and Reaping the <code>BinaryMatrix</code>
</h2>

<h3>Description</h3>

<p>The <code>threshLGF</code> function produces an object of class 
<code>ThreshedBinaryMatrix</code> from threshing on an object of class 
<code>BinaryMatrix</code>. 
</p>
<p>The function <code>threshLGF</code> and the <code>ThreshedBinaryMatrix</code> 
object can be used to access the functionality of the <code>Thresher</code> 
R-package within Mercator.
</p>


<h3>Usage</h3>

<pre><code class="language-R">threshLGF(object, cutoff = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class <code>BinaryMatrix</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>The value of <code>delta</code> set to demarcate an 
uninformative feature. Features with a value greater than the 
cutoff will be kept.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>Thresher</code> R-package provides a variety of functionalities
for data filtering and the identification of and reduction to "informative" features.
It performs clustering using a combination of outlier detection, principal
component analysis, and von Mises Fisher mixture models. By identifying 
significant features, Thresher performs feature reduction through the 
identification and removal of noninformative features and the nonbiased 
calculation of the number of groups (K) for down-stream use.
</p>


<h3>Value</h3>

<p><code>threshLGF</code> returns an object of class <code>ThreshedBinaryMatrix</code>.
The <code>ThreshedBinaryMatrix</code> object retains all the functionality, 
slots, and methods of the <code>BinaryMatrix</code> object class with added 
features. After threshing, the <code>ThreshedBinaryMatrix</code> records the 
<code>history</code>, "Threshed."
</p>


<h3>Additional Slots</h3>


<dl>
<dt>
<code>thresher</code>:  </dt>
<dd>
<p>Returns the functions of the <code>Thresher</code> 
object class of the <code>Thresher</code> R-package.
</p>
</dd>
<dt>
<code>reaper</code>: </dt>
<dd>
<p>Returns the functions of the <code>Reaper</code> 
object class of the <code>Thresher</code> R-package.
</p>
</dd>
</dl>
<h3>Note</h3>

<p>The <code>Thresher</code> R-package applies the Auer-Gervini statistic 
for principal component analysis, outlier detection, and identification 
of uninformative features on a <code>matrix</code> of class <code>integer</code> or 
<code>numeric</code>.
</p>
<p>An initial <code>delta</code> of 0.3 is recommended.
</p>


<h3>Author(s)</h3>

<p>Kevin R. Coombes &lt;krc@silicovore.com&gt;, Caitlin E. Coombes</p>


<h3>References</h3>

<p>Wang, M., Abrams, Z. B., Kornblau, S. M., &amp; Coombes, K. R. (2018). Thresher: 
determining the number of clusters while removing outliers. BMC bioinformatics, 
19(1), 9.
</p>


<h3>See Also</h3>

<p>The <code>threshLGF</code> function creates a new object of class 
<code>ThreshedBinaryMatrix</code> from an object of class <code>BinaryMatrix</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Create a BinaryMatrix
set.seed(52134)
my.matrix &lt;- matrix(rbinom(50*100, 1, 0.15), ncol=50)
my.rows &lt;- as.data.frame(paste("R", 1:100, sep=""))
my.cols &lt;- as.data.frame(paste("C", 1:50, sep=""))
my.binmat &lt;- BinaryMatrix(my.matrix, my.cols, my.rows)
summary(my.binmat)

#Identify delta cutoff and thresh
my.binmat &lt;- threshLGF(my.binmat)
Delta &lt;- my.binmat@thresher@delta
sort(Delta)
hist(Delta, breaks=15, main="", xlab="Weight")
abline(v=0.3, col='red')
my.binmat &lt;- threshLGF(my.binmat, cutoff = 0.3)
summary(my.binmat)

#Principal Component Analysis
my.binmat@reaper@pcdim
my.binmat@reaper@nGroups
plot(my.binmat@reaper@ag)
abline(h=1, col="red")
screeplot(my.binmat@reaper)
abline(v=6, col="forestgreen", lwd=2)
</code></pre>


</div>