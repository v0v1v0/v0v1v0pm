<div class="container">

<table style="width: 100%;"><tr>
<td>meta3d</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Detect rhythmic signals from time-series datasets with individual
information</h2>

<h3>Description</h3>

<p>This is a function that takes use of any one method from ARSER, JTK_CYCLE
and Lomb-Scargle to detect rhythmic signals from time-series datasets
containing individual information.
</p>


<h3>Usage</h3>

<pre><code class="language-R">meta3d(datafile, designfile, outdir = "metaout", filestyle,
  design_libColm, design_subjectColm, minper = 20, maxper = 28,
  cycMethodOne = "JTK", timeUnit = "hour", design_hrColm,
  design_dayColm = NULL, design_minColm = NULL,
  design_secColm = NULL, design_groupColm = NULL,
  design_libIDrename = NULL, adjustPhase = "predictedPer",
  combinePvalue = "fisher", weightedMethod = TRUE,
  outIntegration = "both", ARSmle = "auto", ARSdefaultPer = 24,
  dayZeroBased = FALSE, outSymbol = "", parallelize = FALSE,
  nCores = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>datafile</code></td>
<td>
<p>a character string. The name of data file containing
time-series experimental values of all individuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>designfile</code></td>
<td>
<p>a character string. The name of experimental design file,
at least containing the library ID(column names of <code>datafile</code>),
subject ID(the individual corresponding to each library ID), and
sampling time information of each library ID.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outdir</code></td>
<td>
<p>a character string. The name of directory used to store
output files.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filestyle</code></td>
<td>
<p>a character vector(length 1 or 3). The data format of
input files, must be <code>"txt"</code>, or <code>"csv"</code>, or a character
vector containing field separator character(<code>sep</code>), quoting
character(<code>quote</code>), and the character used for decimal
points(<code>dec</code>, for details see <code>read.table</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design_libColm</code></td>
<td>
<p>a numeric value. The order index(from left to right)
of the column storing library ID in <code>designfile</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design_subjectColm</code></td>
<td>
<p>a numeric value. The order index(from left to
right) of the column storing subject ID in <code>designfile</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minper</code></td>
<td>
<p>a numeric value. The minimum period length of interested
rhythms. The default is <code>20</code> for circadian rhythms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxper</code></td>
<td>
<p>a numeric value. The maximum period length of interested
rhythms. The default is <code>28</code> for circadian rhythms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cycMethodOne</code></td>
<td>
<p>a character string. The selected method for analyzing
time-series data of each individual, must be one of <code>"ARS"</code>(ARSER),
<code>"JTK"</code>(JTK_CYCLE), or <code>"LS"</code>(Lomb-Scargle).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeUnit</code></td>
<td>
<p>a character string. The basic time-unit, must be one of
<code>"day"</code>, <code>"hour"</code>(default for circadian study),
<code>"minute"</code>, or <code>"second"</code> depending on specific experimental
design.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design_hrColm</code></td>
<td>
<p>a numeric value. The order index(from left to right)
of the column storing time point value-sampling hour information in
<code>designfile</code>. If there is no such column in <code>designfile</code>,
set it as <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design_dayColm</code></td>
<td>
<p>a numeric value. The order index(from left to right)
of the column storing time point value-sampling day information in
<code>designfile</code>. If there is no such column in <code>designfile</code>,
set it as <code>NULL</code>(default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design_minColm</code></td>
<td>
<p>a numeric value. The order index(from left to right)
of the column storing time point value-sampling minute information in
<code>designfile</code>. If there is no such column in <code>designfile</code>,
set it as <code>NULL</code>(default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design_secColm</code></td>
<td>
<p>a numeric value. The order index(from left to right)
of the column storing time point value-sampling second information in
<code>designfile</code>. If there is no such column in <code>designfile</code>,
set it as <code>NULL</code>(default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design_groupColm</code></td>
<td>
<p>a numeric value. The order index(from left to
right) of the column storing experimental group information of each
individual in <code>designfile</code>. If there is no such column in
<code>designfile</code>, set it as <code>NULL</code>(default) and take all
individuals as one group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design_libIDrename</code></td>
<td>
<p>a character vector(length 2) containing  a
matchable character string in each library ID of <code>designfile</code>, and
a replacement character string. If it is not necessary to replace
characters in library ID of <code>designfile</code>, set it as <code>NULL</code>(
default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjustPhase</code></td>
<td>
<p>a character string. The method used to adjust each
calculated phase before getting integrated phase, must be one of
<code>"predictedPer"</code>(adjust phase with predicted period length)
or <code>"notAdjusted"</code>(not adjust phase).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>combinePvalue</code></td>
<td>
<p>a character string. The method used to integrate
p-values of multiple individuals, currently only <code>"fisher"</code>(
Fisher's method) could be selected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weightedMethod</code></td>
<td>
<p>logical. If <code>TRUE</code>(default), weighted score
based on p-value of each individual will be used to integrate period,
phase and amplitude values of multiple individuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outIntegration</code></td>
<td>
<p>a character string. This parameter controls what
kinds of analysis results will be outputted, must be one of
<code>"both"</code>, <code>"onlyIntegration"</code>, or <code>"noIntegration"</code>.
See <code>meta2d</code> for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ARSmle</code></td>
<td>
<p>a character string. The strategy of using MLE method in
<code>"ARS"</code>, must be one of <code>"auto"</code>, <code>"mle"</code>, or
<code>"nomle"</code>. See <code>meta2d</code> for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ARSdefaultPer</code></td>
<td>
<p>a numeric value. The expected period length of
interested rhythm, which is a necessary parameter for <code>ARS</code>. See
<code>meta2d</code> for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dayZeroBased</code></td>
<td>
<p>logical. If <code>TRUE</code>, the first sampling day is
recorded as day zero in the <code>designfile</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outSymbol</code></td>
<td>
<p>a character string. A common prefix exists in the names of
output files.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallelize</code></td>
<td>
<p>logical. If <code>TRUE</code>, computation will be done in paralleL
Doesn't work in windows machine</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nCores</code></td>
<td>
<p>a integer. Bigger or equal to one, number of cores to use</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is originally aimed to analyze large scale periodic data with
individual information. Please pay attention to the data format of
<code>datafile</code> and <code>designfile</code>(see <code>Examples</code> part).
Time-series experimental values(missing values as <code>NA</code>) from
all individuals should be stored in <code>datafile</code>, with the first row
containing all library ID(unique identification number for each sample)
and the first column containing all detected molecular names(eg.
transcript or gene name). The <code>designfile</code> should at least have
three columns-library ID, subject ID and sampling time column.
Experimental group information of each subject ID may be in another
column. In addition, sampling time information may be stored in multiple
columns instead of one column. For example, sampling time-"36 hours" may
be recorded as "day 2"(sampling day column, <code>design_dayColm</code>) plus
"12 hours"(sampling hour column, <code>design_hrColm</code>). The library ID
in <code>datafile</code> and <code>designfile</code> should be same. If there are
different characters between library ID in these two files, try
<code>design_libIDrename</code> to keep them same.
</p>
<p><code>ARS</code>, <code>JTK</code> or <code>LS</code> could be used to analyze time-series
profiles individual by individual. <code>meta3d</code> requires that all
individuals should be analyzed by the same method before integrating
calculated p-value, period, phase, baseline value, amplitude and relative
amplitude values group by group. However, the sampling pattern among
individuals may be different and the requirement of sampling pattern for
each method is not same(see more information about these methods and their
limitations in <code>meta2d</code>). Please carefully select a proper
method for the specific dataset. <code>meta3d</code> also help users select
the suitable method through warning notes.
</p>
<p>P-values from different individuals are integrated with Fisher's method
(<code>"fisher"</code>)(Fisher,1925; implementation code from <span class="pkg">MADAM</span>).For
short time-series profiles(eg. 10 time points or less), p-values given by
Lomb-Scargle may be over conservative, which will also lead to
conservative integrated p-values. The integrated period, baseline,
amplitude and relative amplitude values are arithmetic mean of multiple
individuals, respectively. The phase is
<a href="https://en.wikipedia.org/wiki/Mean_of_circular_quantities">
mean of circular quantities</a>(<code>adjustPhase = "predictedPer"</code>)
or a arithmetic mean (<code>adjustPhase = "notAdjusted"</code>) of multiple
individual phases. For completely removing the potential problem of
averaging phases with quite different period length(also mentioned
in <code>meta2d</code>), setting <code>minper</code>, <code>maxper</code> and
<code>ARSdefaultPer</code> to a same value may be the only known way. If
<code>weightedMethod = TRUE</code> is selected, weighted scores(
<code>-log10(p-values)</code>) will be taken into account in integrating
period, phase, baseline, amplitude and relative amplitude.
</p>


<h3>Value</h3>

<p><code>meta3d</code> will write analysis results to <code>outdir</code> instead of
returning them as objects. Output files with "meta3dSubjectID" in
the file name are analysis results for each individual. Files named with
"meta3dGroupID" store integrated p-values, period, phase, baseline,
amplitude and relative amplitude values from multiple individuals of
each group and calculated FDR values based on integrated p-values.
</p>


<h3>References</h3>

<p>Glynn E. F., Chen J., and Mushegian  A. R. (2006). Detecting periodic
patterns in unevenly spaced gene expression time series using
Lomb-Scargle periodograms. <em>Bioinformatics</em>, <b>22(3)</b>,
310–316
</p>
<p>Fisher, R.A. (1925). <em>Statistical methods for research workers</em>.
Oliver and Boyd (Edinburgh).
</p>
<p>Kugler K. G., Mueller L.A., and Graber A. (2010). MADAM - an open source
toolbox for meta-analysis. <em>Source Code for Biology and Medicine</em>,
<b>5</b>, 3.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># write 'cycHumanBloodData' and 'cycHumanBloodDesign' into two 'csv' files
write.csv(cycHumanBloodData, file="cycHumanBloodData.csv",
  row.names=FALSE)
write.csv(cycHumanBloodDesign, file="cycHumanBloodDesign.csv",
  row.names=FALSE)

# detect circadian transcripts with JTK in studied individuals
meta3d(datafile="cycHumanBloodData.csv", cycMethodOne="JTK",
  designfile="cycHumanBloodDesign.csv", outdir="example",
  filestyle="csv", design_libColm=1, design_subjectColm=2,
  design_hrColm=4, design_groupColm=3)
</code></pre>


</div>