<div class="container">

<table style="width: 100%;"><tr>
<td>filterGenes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Filter out significant genes from meta-analysis results</h2>

<h3>Description</h3>

<p>After the Meta-Analysis results have been written to the <code>metaObject</code>, 
the results can be examined using different gene filtering criteria. 
This function will use the given filterParameter to select genes that fulfill the filter conditions. 
The function returns a modified version of the <code>metaObject</code> with results stored in <code>metaObject$filterResults</code>
</p>


<h3>Usage</h3>

<pre><code class="language-R">filterGenes(metaObject, isLeaveOneOut = TRUE, effectSizeThresh = 0,
  FDRThresh = 0.05, numberStudiesThresh = 1,
  heterogeneityPvalThresh = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>metaObject</code></td>
<td>
<p>a Meta object which must have the <code>$originalData</code>, <code>$metaAnalysis</code> populated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>isLeaveOneOut</code></td>
<td>
<p>Do leave-one-out analysis on discovery datasets (default: TRUE). Needs at least 2 datasets for discovery.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effectSizeThresh</code></td>
<td>
<p>a gene is selected, if the absolute value of its effect size is above this threshold (default: 0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FDRThresh</code></td>
<td>
<p>FDR cutoff: a gene is selected, if it has a p-value less than or equal to the FDR cutoff (default: 0.05)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numberStudiesThresh</code></td>
<td>
<p>number of studies in which a selected gene has to be significantly up/down regulated (default: 1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>heterogeneityPvalThresh</code></td>
<td>
<p>heterogeneity p-value cutoff (filter is off by default: <code>heterogeneityPvalThresh = 0</code>). 
Genes with significant heterogeneity and, thus a significant (low) heterogeneity p-value, can be filtered out by using e.g.: 
<code>heterogeneityPvalThresh = 0.05</code> (removes all genes with heterogeneity p-value &lt; 0.05)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A modified version of the input metaObject with an additional filterObject stored within <code>metaObject$filterResults</code>
</p>


<h3>Note</h3>

<p>Use <code>checkDataObject(metaObject, "Meta", "Pre-Filter")</code> to make sure your metaObject has the right format for filtering after running the meta-analysis with <code>runMetaAnalysis().</code>
</p>


<h3>Author(s)</h3>

<p>Francesco Vallania
</p>


<h3>See Also</h3>

<p><code>checkDataObject</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">	# filter genes with default settings 
	#(false discovery rate cutoff of 5 percent and WITH leave-one-out analysis)
	testMetaObject &lt;- filterGenes(tinyMetaObject)
	summarizeFilterResults(testMetaObject, getMostRecentFilter(testMetaObject))
	
	# filter genes with false discovery rate of 1 percent and WITHOUT leave-one-out analysis  
	testMetaObject &lt;- filterGenes(testMetaObject, FDRThresh = 0.01, isLeaveOneOut = FALSE)
	summarizeFilterResults(testMetaObject, getMostRecentFilter(testMetaObject))
</code></pre>


</div>