<div class="container">

<table style="width: 100%;"><tr>
<td>lincsBaitCorr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Run Shane's LINCS bait-based correlation on MetaIntegrator</h2>

<h3>Description</h3>

<p>LINCS Bait Corr finds perturbagens similar to a set of interest, called baits.  
It searches within a defined sub space of relevant genes, usually a disease signature
See below for an example that recreates the work we did to find the antiviral drugs
</p>


<h3>Usage</h3>

<pre><code class="language-R">lincsBaitCorr(metaObject, filterObject, dataset = "CP", baits,
  just_clin = F, hit.number.hm = 20, hm_baits = T,
  direction = "aggravate", bait_type = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>metaObject</code></td>
<td>
<p>a Meta object which must have the $originalData populated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filterObject</code></td>
<td>
<p>a MetaFilter object containing the signature genes that will be used for calculating the score</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataset</code></td>
<td>
<p>The LINCS dataset to use. One of "CP" (drugs),"SH" (shRNA),"OE" (over-expression),
"LIG" (ligands),"MUT" (mutants) (default: CP)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>baits</code></td>
<td>
<p>vector containing names of the baits being used (relevant drugs, shRNAs, etc.). See example.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>just_clin</code></td>
<td>
<p>only consider clinically relevant results (default: FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hit.number.hm</code></td>
<td>
<p>How many hits to show in a heatmap (default: 20)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hm_baits</code></td>
<td>
<p>whether or not to include the baits in the heatmap (default: FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>direction</code></td>
<td>
<p>one of "reverse", "aggravate", or "absolute" (default: "reverse") 
for whether you want to reverse the signature, aggravate it, or just want the top absolute hits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bait_type</code></td>
<td>
<p>The LINCS dataset where the baits come from. 
One of "CP" (drugs),"SH" (shRNA),"OE" (over-expression),
"LIG" (ligands),"MUT" (mutants), or NULL (don't specify) (default:NULL)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The full list of correlations as well as the dataframe with the expression of the top hits.
Also generates the heatmap of the top hits.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
####### DATA SETUP ##########
# Example won't work on tinyMetaObject because it requires real gene names
# Download the needed datasets for processing. 
sleData &lt;- getGEOData(c("GSE11909","GSE50635", "GSE39088"))

#Label classes in the datasets
sleData$originalData$GSE50635 &lt;- classFunction(sleData$originalData$GSE50635, 
  column = "subject type:ch1", diseaseTerms = c("Subject RBP +", "Subject RBP -"))
sleData$originalData$GSE11909_GPL96 &lt;- classFunction(sleData$originalData$GSE11909_GPL96, 
   column = "Illness:ch1", diseaseTerms = c("SLE"))
sleData$originalData$GSE39088 &lt;- classFunction(sleData$originalData$GSE39088, 
   column= "disease state:ch1", diseaseTerms=c("SLE"))
 #Remove the GPL97 platform that was downloaded
sleData$originalData$GSE11909_GPL97 &lt;- NULL

#Run Meta-Analysis
sleMetaAnalysis &lt;- runMetaAnalysis(sleData, runLeaveOneOutAnalysis = F, maxCores = 1)

#Filter genes
sleMetaAnalysis &lt;- filterGenes(sleMetaAnalysis, isLeaveOneOut = F, 
   effectSizeThresh = 1, FDRThresh = 0.05)
####### END DATA SETUP ##########

#Note: these are note relevant baits for SLE, just examples
 lincsBaitCorr(metaObject = sleMetaAnalysis, filterObject = sleMetaAnalysis$filterResults[[1]], 
   dataset = "CP", baits = c("NICLOSAMIDE","TYRPHOSTINA9","DISULFIRAM","SU4312","RESERPINE"))
 
## End(Not run)

</code></pre>


</div>