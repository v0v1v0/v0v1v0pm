<div class="container">

<table style="width: 100%;"><tr>
<td>spom</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Stochastic Patch Occupancy Model
</h2>

<h3>Description</h3>

<p>This function predicts the occupancy status of each patch in a landscape in the time step t+1, based on the occupancy information on time step t.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spom(sp, kern, conn, colnz, ext, param_df, 
     beta1 = NULL, b = 1, c1 = NULL, c2 = NULL, 
     z = NULL, R = NULL, succ="none", max_age=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sp</code></td>
<td>

<p>Landscape with species occupancy, object of class 'metapopulation'. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kern</code></td>
<td>

<p>'op1' or 'op2'. Dispersal kernel. See details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conn</code></td>
<td>

<p>'op1' or 'op2'. Connectivity function. See details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colnz</code></td>
<td>

<p>'op1', 'op2' or 'op3'. Colonization function. See details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ext</code></td>
<td>

<p>'op1', 'op2' or 'op3'. Extinction function. See details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param_df</code></td>
<td>

<p>Parameter data frame delivered by <code>parameter.estimate</code>, including:
</p>

<ul>
<li>
<p> alpha - Parameter relating extinction with distance.
</p>
</li>
<li>
<p> y - Parameter y in the colonization probability.  
</p>
</li>
<li>
<p> e - Parameter defining the extinction probability in a patch of unit area.
</p>
</li>
<li>
<p> x - Parameter scaling extinction risk with patch area.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta1</code></td>
<td>

<p>Parameter affecting long distance dispersal probability (if the Kern='op2').
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>

<p>Parameter scaling emigration with patch area (if conn='op1' or 'op2'). By default set to 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c1</code></td>
<td>

<p>Parameter scaling immigration with the focal patch area (if conn='op2'). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c2</code></td>
<td>

<p>Parameter c in the option 3 of the colonization probability (if colnz='op3').
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>

<p>Parameter giving the strength of the Allee effect (if colnz='op3').
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>

<p>Parameter giving the strength of the Rescue effect (if ext='op3').
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>succ</code></td>
<td>

<p>Set the preference of the species for patch successional stage: 'none', 'early', 'mid' and 'late'.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_age</code></td>
<td>

<p>Default value set to 1. This argument should not be changed by the user. It is used only when the function runs inside others.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In order to visualize which parameter combination is valid for each option, please refer to the following table (alpha, x, y and e are delivered by <code>parameter.estimate</code>, as a data frame):
</p>

<table>
<tr>
<td style="text-align: center;">
<strong>parameter</strong>  </td>
<td style="text-align: center;"> kern_1 </td>
<td style="text-align: center;"> kern_2 </td>
<td style="text-align: center;"> conn_1 </td>
<td style="text-align: center;"> conn_2 </td>
<td style="text-align: center;"> colnz_1 </td>
<td style="text-align: center;"> colnz_2 </td>
<td style="text-align: center;"> colnz_3 </td>
<td style="text-align: center;"> ext_1 </td>
<td style="text-align: center;"> ext_2</td>
<td style="text-align: center;"> ext_3</td>
</tr>
<tr>
<td style="text-align: center;">
<strong>alpha</strong> </td>
<td style="text-align: center;"> x </td>
<td style="text-align: center;"> x </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
</tr>
<tr>
<td style="text-align: center;">
<strong>x</strong> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> x </td>
<td style="text-align: center;"> x </td>
<td style="text-align: center;"> x </td>
</tr>
<tr>
<td style="text-align: center;">
<strong>y</strong> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> x </td>
<td style="text-align: center;"> x </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
</tr>
<tr>
<td style="text-align: center;">
<strong>e</strong> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> x </td>
<td style="text-align: center;"> x </td>
<td style="text-align: center;"> x </td>
</tr>
<tr>
<td style="text-align: center;">
<strong>beta1</strong> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> x </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
</tr>
<tr>
<td style="text-align: center;">
<strong>b</strong> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> x </td>
<td style="text-align: center;"> x </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
</tr>
<tr>
<td style="text-align: center;">
<strong>c1</strong> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> x </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
</tr>
<tr>
<td style="text-align: center;">
<strong>c2</strong> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> x </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
</tr>
<tr>
<td style="text-align: center;">
<strong>z</strong> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> x </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
</tr>
<tr>
<td style="text-align: center;">
<strong>R</strong> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> x </td>
</tr>
<tr>
<td style="text-align: center;">
</td>
</tr>
</table>
<p>A Stochastic Patch Occupancy Model (SPOM) is a type of model which models the occupancy status of the species on habitat patches as a Markov chain (Moilanen, 2004). These models are a good compromise between capturing sufficient biological detail and  being easy to parametrize with occupancy data. With SPOMs it is possible to predict the probability of extinction or colonization of every patch in a landscape, given the current occupancy state of all the patches (Etienne et al. 2004).
</p>
<p><em>Dispersal Kernel</em>
</p>
<p>Option 1 (Hanski, 1994 and 1999)
</p>
<p style="text-align: center;"><code class="reqn">D(D_{ij},\alpha) = exp(-\alpha.d_{ij})</code>
</p>

<p>Option 2 (Shaw, 1995)
</p>
<p style="text-align: center;"><code class="reqn">D(D_{ij},\alpha,\beta) = \frac{1}{1+\alpha.d_{ij}^\beta}</code>
</p>

<p>where <em>dij is the distance between patches i and j.</em>
</p>

<ul>
<li>
<p> Option 1 - Negative exponential. Earlier studies (until the end of the 1990) frequently used this type of thin-tailed kernels (Nathan et al. 2012).
</p>
</li>
<li>
<p> Option 2 - Fat-tailed kernel. The shape of the dispersal kernel is highly significant only when the metapopulation consists of several moderately small patch clusters, which are relatively far from each other. In this kind of a system, a patch cluster may go extinct, and long-distance dispersal will be important in determining the recolonization probability of the empty cluster (Shaw, 1995 and Moilanen, 2004). This type of fat-tailed kernels has become more frequent in recent works (Nathan et al. 2012). For </p>
<p style="text-align: center;"><code class="reqn">\beta=2</code>
</p>
<p> this is the Cauchy distribution. 
</p>
</li>
</ul>
<p><em>Connectivity</em>
</p>
<p>Option 1 (Moilanen, 2004)
</p>
<p style="text-align: center;"><code class="reqn">S_i=\sum pj.D(d_{ij},\alpha).A_j^b</code>
</p>

<p>Option 2 (Moilanen and Nieminen, 2002)
</p>
<p style="text-align: center;"><code class="reqn">S_i=A_i^c \sum p_j.D(d_{ij},\alpha).A_j^b</code>
</p>

<p>where <em>Ai and Aj are the areas of patches i(focal patch) and j(other patches), respectively; dij is the distance between patches i and j and pj is the occupation status (0/1) of patch j</em><br></p>

<ul>
<li>
<p> Option 1 - In the version of Hanski (1994), de kernel is the negative exponential (option 1) and b is set to 1. In this more flexible version, the parameter b scales emigration with patch area (Moilanen, 2004).
</p>
</li>
<li>
<p> Option 2 - In Moilanen &amp; Nieminen (2002) the kernel is the negative exponential (option 1). This metric considers the value of the focal patch's area, which was found to provide better results by Moilanen &amp; Nieminen (2002), being less sensitive to errors in the estimation of a. Parameters b and c scale, respectively emigration and immigration, as a function of patch area (focal patch in the case of c). See 'note'.
</p>
</li>
</ul>
<p><em>Colonization function</em>
</p>
<p>Option 1 (Hanski, 1994, 1999)
</p>
<p style="text-align: center;"><code class="reqn">C_i=\frac{S_i^2}{S_i^2+y^2}</code>
</p>

<p>Option 2 (Moilanen, 2004)
</p>
<p style="text-align: center;"><code class="reqn">C_i=1-exp(-y.S_i)</code>
</p>

<p>Option 3 (Ovaskainen, 2002)
</p>
<p style="text-align: center;"><code class="reqn">C_i=\frac{S_i^z}{S_i^z+\frac{1}{c}}</code>
</p>

<p>where <em>Si is connectivity.</em>
</p>

<ul>
<li>
<p> Option 1 - It's the first version of the colonization probability, it includes Allee effect (however the strength of this effect cannot be modified) Hanski (1994). Colonization probability is defined as a sigmoid function of the connectivity of patch i. 
</p>
</li>
<li>
<p> Option 2 - This option assumes that immigrating individuals originate colonization events independently, therefore, with no Allee effect. Adequate for species (plants) with passive dispersal (Moilanen, 2004). 
</p>
</li>
<li>
<p> Option 3 - Here, as in option 1, the colonization probability is defined as a sigmoid function of the connectivity of patch i, and the user can change the strength of the Allee effect, by changing the parameter z, with values &gt;1 reflecting the presence of this effect (Ovaskainen, 2002). In the original version of the IFM (option 1) Hanski (1994) assumed a relatively strong Allee effect (z=2). Parameter c describes the species ability to colonize (Ovaskainen &amp; Hanski, 2001 and Ovaskainen ,2002).
</p>
</li>
</ul>
<p><em>Extinction function</em>
</p>
<p>Option 1 (Hanski, 1994, 1999)
</p>
<p style="text-align: center;"><code class="reqn">E_i=min(1,\frac{e}{A_i^x})</code>
</p>

<p>Option 2 (Hanski and Ovaskainen, 2000 and Ovaskainen and Hanski, 2002)
</p>
<p style="text-align: center;"><code class="reqn">E_i=1-exp(\frac{-e}{A_i^x})</code>
</p>

<p>Option 3 (Ovaskainen, 2002)
</p>
<p style="text-align: center;"><code class="reqn">E_i=min[1,\frac{e}{A_i^x}.(1-C_i)^R]</code>
</p>

<p>where <em>Ai is the area of the focal patch and Ci is the colonization probability of the focal patch.</em>
</p>

<ul>
<li>
<p> Option 1 - Original version developed by Hanski (1994).
</p>
</li>
<li>
<p> Option 2 - Used e.g. in the spatially realistic Levins model (Hanski &amp; Ovaskainen, 2000 and Ovaskainen &amp; Hanski, 2002). Parameter x scales extinction probability with patch area.
</p>
</li>
<li>
<p> Option 3 - Same as option 1, but considering the Rescue effect (with the strength of this effect being given by R). If R=0 there is no Rescue effect, however, if R&gt;0, the Rescue effect grows exponentially with the probability of not being colonized. In the original version of this function Hanski (1994) assumed R=1.
</p>
</li>
</ul>
<p>Here, parameter <em>x</em> defines de degree to which the extinction rate is sensitive to the patch area. If <em>x&gt;1</em>, with the increase of <em>Ai</em> the extinction rate rapidly approximates zero. The populations in the larger patches becomes almost impossible to extinguish. However, if <em>x</em> is small the extinction rate decreases slower with increasing <em>Ai</em>. 
</p>


<h3>Value</h3>

<p>Delivers a list similar to the class 'metapopulation' but with two additional columns in the data frame nodes.characteristics: 'species2'(which is the occupation in the next time step) and turn (turnover between occupancies).
</p>


<h3>Author(s)</h3>

<p>Frederico Mestre and Fernando Canovas
</p>


<h3>References</h3>

<p>Etienne, R. S., ter Braak, C. J., and Vos, C. C. (2004). Application of stochastic patch occupancy models to real metapopulations. In Hanski, I. and Gaggiotti, O.E. (Eds.) Ecology, Genetics, and Evolution of Metapopulations. Elsevier Academic Press. 696 pp.
</p>
<p>Hanski, I. (1994). A practical model of metapopulation dynamics. Journal of Animal Ecology, 63: 151-162.
</p>
<p>Hanski, I. (1999). <em>Metapopulation Ecology</em>. Oxford University Press. 313 pp.
</p>
<p>Hanski, I., Alho, J., and Moilanen, A. (2000). Estimating the parameters of survival and migration of individuals in metapopulations. Ecology, 81(1), 239-251.
</p>
<p>Hanski, I., and Ovaskainen, O. (2000). The metapopulation capacity of a fragmented landscape. Nature, 404: 755-758.
</p>
<p>Moilanen, A. (2004). SPOMSIM: software for stochastic patch occupancy models of metapopulation dynamics. Ecological Modelling, 179(4), 533-550.
</p>
<p>Moilanen, A., and Nieminen, M. (2002). Simple connectivity measures in spatial ecology. Ecology, 83(4): 1131-1145.
</p>
<p>Nathan, R., Klein, E., Robledo-Arnuncio, J.J. and Revilla, E. (2012). Dispersal kernels: review. in Clobert, J., Baguette, M., Benton, T. and Bullock, J.M. (Eds.) Dispersal Ecology and Evolution. Oxford University Press. Oxford, UK. 462 pp.  
</p>
<p>Ovaskainen, O. (2002). The effective size of a metapopulation living in a heterogeneous patch network. The American Naturalist: 160(5), 612-628.
</p>
<p>Ovaskainen, O. and Hanski, I. (2001). Spatially structured metapopulation models: global and local assessment of metapopulation capacity. Theoretical Population Biology, 60(4), 281-302.
</p>
<p>Ovaskainen, O., and Hanski, I. (2002). Transient dynamics in metapopulation response to perturbation. Theoretical Population Biology, 61(3): 285-295.
</p>
<p>Ovaskainen, O. and Hanski, I. (2004). Metapopulation dynamics in highly fragmented landscapes. In Hanski, I. &amp; Gaggiotti, O.E. (Eds.) Ecology, Genetics, and Evolution of Metapopulations. Elsevier Academic Press. 696 pp.
</p>
<p>Shaw, M.W., (1995). Simulation of population expansion and spatial pattern when individual dispersal distributions do not decline exponentially with distance. Proc. R. Soc. London B: 259, 243-248.
</p>


<h3>See Also</h3>

<p><code>species.graph</code>, <code>simulate_graph</code>, <code>iterate.graph</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(occ.landscape)
data(param1)

#Simulating the occupation in the next time step:

landscape2 &lt;- spom(sp=occ.landscape,
			kern="op1",
			conn="op1",
			colnz="op1",
			ext="op1",
			param_df=param1,
			beta1=NULL,
			b=1,
			c1=NULL,
			c2=NULL,
			z=NULL,
			R=NULL,
			succ="none"
			)

#The output has two new columns in the data frame nodes.characteristics: species2 
#(occupation in the next time step) and turn (turnover - change of occupation status, 
#1 if changed and 0 if not).:

head(landscape2)

#         x         y      areas    radius cluster    colour nneighbour
#1 718.5011 228.47190 0.05741039 13.518245       1 #FF0000FF   91.80452
#2 494.3624  73.29165 0.08755563 16.694257       1 #FF0000FF   98.98432
#3 809.2326 245.90046 0.09384384 17.283351       1 #FF0000FF  166.68205
#4 638.8057 149.35122 0.08858989 16.792569       1 #FF0000FF   82.60306
#5 874.2010  19.78104 0.03621793 10.737097       1 #FF0000FF   92.26625
#6 605.3937  70.34944 0.03066018  9.878987       1 #FF0000FF  131.22261
#  ID species species2 turn
#1  1       1        1    0
#2  2       0        1    1
#3  3       1        1    0
#4  4       0        0    0
#5  5       0        1    1
#6  6       1        1    0

</code></pre>


</div>