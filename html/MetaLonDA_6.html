<div class="container">

<table style="width: 100%;"><tr>
<td>metalondaAll</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Metagenomic Longitudinal Differential Abundance Analysis for all Features</h2>

<h3>Description</h3>

<p>Identify significant features and their significant time interval
</p>


<h3>Usage</h3>

<pre><code class="language-R">metalondaAll(
  Count,
  Time,
  Group,
  ID,
  n.perm = 500,
  fit.method = "nbinomial",
  num.intervals = 100,
  parall = FALSE,
  pvalue.threshold = 0.05,
  adjust.method = "BH",
  time.unit = "days",
  norm.method = "none",
  prefix = "Output",
  ylabel = "Normalized Count",
  col = c("blue", "firebrick")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Count</code></td>
<td>
<p>Count matrix of all features</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Time</code></td>
<td>
<p>Time label of all samples</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Group</code></td>
<td>
<p>Group label of all samples</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ID</code></td>
<td>
<p>individual ID label for samples</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.perm</code></td>
<td>
<p>number of permutations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.method</code></td>
<td>
<p>The fitting method (nbinomial, lowess)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.intervals</code></td>
<td>
<p>The number of time intervals at which metalonda test differential abundance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parall</code></td>
<td>
<p>logic to indicate whether to use multicore</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalue.threshold</code></td>
<td>
<p>p-value threshold cutoff</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjust.method</code></td>
<td>
<p>Multiple testing correction methods</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.unit</code></td>
<td>
<p>time unit used in the Time vector (hours, days, weeks, months, etc.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norm.method</code></td>
<td>
<p>normalization method to be used to normalize count matrix (css, tmm, ra, log10, median_ratio)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prefix</code></td>
<td>
<p>prefix for the output figure</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylabel</code></td>
<td>
<p>text to be shown on the y-axis of all generated figures (default: "Normalized Count")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>two color to be used for the two groups (eg., c("red", "blue")).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list of the significant features a long with their significant time intervals
</p>


<h3>References</h3>

<p>Ahmed Metwally (ametwall@stanford.edu)
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(metalonda_test_data)
n.sample = 5
n.timepoints = 10
n.group = 2
Group = factor(c(rep(0, n.sample*n.timepoints), rep(1,n.sample*n.timepoints)))
Time = rep(rep(1:n.timepoints, times = n.sample), 2)
ID = factor(rep(1:(2*n.sample), each = n.timepoints))
points = seq(1, 10, length.out = 10)
output.nbinomial = metalondaAll(Count = metalonda_test_data, Time = Time, Group = Group,
ID = ID, n.perm = 10, fit.method =  "nbinomial", num.intervals = 100, 
parall = FALSE, pvalue.threshold = 0.05, adjust.method = "BH", 
time.unit = "hours", norm.method = "none", prefix = "Test",  time.unit = "hours", 
ylabel = "Normalized Count", col = c("black", "green"))

## End(Not run)
</code></pre>


</div>