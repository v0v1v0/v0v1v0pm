<div class="container">

<table style="width: 100%;"><tr>
<td>mppca.metabol</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fit a mixture of probabilistic principal components analysis (MPPCA) model to a metabolomic data set via the EM algorithm to perform simultaneous dimension reduction and clustering.
</h2>

<h3>Description</h3>

<p>This function fits a mixture of probabilistic principal components analysis model to metabolomic spectral data via the EM algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mppca.metabol(Y, minq=1, maxq=2, ming, maxg, scale = "none", 
epsilon = 0.1, plot.BIC = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>

<p>An N x p data matrix where each row is a spectrum.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minq</code></td>
<td>

<p>The minimum number of principal components to be fit. By default minq is 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxq</code></td>
<td>

<p>The maximum number of principal components to be fit. By default maxq is 2.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ming</code></td>
<td>

<p>The minimum number of groups to be fit.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxg</code></td>
<td>

<p>The maximum number of groups to be fit.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>

<p>Type of scaling of the data which is required. The default is "none". Options include "pareto' and "unit" scaling. See <code>scaling</code> for further details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>

<p>Value on which the convergence assessment criterion is based. Set by default to 0.1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.BIC</code></td>
<td>

<p>Logical indicating whether or not a plot of the BIC values for the different models fitted should be provided. By default, the plot is not produced.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function fits a mixture of probabilistic principal components analysis models to metabolomic spectral data via the EM algorithm. A range of models with different numbers of groups and different numbers of principal components can be fitted. The model performs simultaneous clustering of observations into unknown groups and dimension reduction simultaneously.
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>The number of principal components in the optimal MPPCA model, selected by the BIC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>The number of groups in the optimal MPPCA model, selected by the BIC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig</code></td>
<td>
<p>The posterior mode estimate of the variance of the error terms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p>A list of length g, each entry of which is a n_g x q matrix of estimates of the latent locations of each observation in group g in the principal subspace.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loadings</code></td>
<td>
<p>An array of dimension p x q x g, each sheet of which contains the maximum likelihood estimate of the p x q loadings matrix for a group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pi</code></td>
<td>
<p>The vector indicating the probability of belonging to each group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>A p x g matrix, each column of which contains a group mean.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>An N x g matrix, each row of which contains the posterior group membership probabilities for an observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clustering</code></td>
<td>
<p>A vector of length N indicating the group to which each observation belongs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BIC</code></td>
<td>
<p>A matrix containing the BIC values for the fitted models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AIC</code></td>
<td>
<p>A matrix containing the AIC values for the fitted models.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Nyamundanda Gift, Isobel Claire Gormley and Lorraine Brennan.
</p>


<h3>References</h3>

<p>Nyamundanda G., Gormley, I.C. and Brennan, L. (2010) Probabilistic principal components analysis for metabolomic data. Technical report, University College Dublin.
</p>


<h3>See Also</h3>

<p><code>mppca.scores.plot</code>, <code>mppca.loadings.plot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(BrainSpectra)
## Not run: 
mdlfit&lt;-mppca.metabol(BrainSpectra[[1]], minq=7, maxq=7, ming=4, maxg=4, 
plot.BIC = TRUE)
mppca.scores.plot(mdlfit)
mppca.loadings.plot(mdlfit, BrainSpectra[[1]])

## End(Not run)
</code></pre>


</div>