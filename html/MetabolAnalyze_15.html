<div class="container">

<table style="width: 100%;"><tr>
<td>ppca.metabol</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fit a probabilistic principal components analysis (PPCA) model to a metabolomic data set via the EM algorithm.
</h2>

<h3>Description</h3>

<p>This function fits a probabilistic principal components analysis model to metabolomic spectral data via the EM algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ppca.metabol(Y, minq=1, maxq=2, scale = "none", epsilon = 0.1, 
plot.BIC = FALSE, printout=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>

<p>An N x p data matrix where each row is a spectrum.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minq</code></td>
<td>

<p>The minimum number of principal components to be fit. By default minq is 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxq</code></td>
<td>

<p>The maximum number of principal components to be fit. By default maxq is 2.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>

<p>Type of scaling of the data which is required. The default is "none". Options include "pareto' and "unit" scaling. See <code>scaling</code> for further details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>

<p>Value on which the convergence assessment criterion is based. Set by default to 0.1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.BIC</code></td>
<td>

<p>Logical indicating whether or not a plot of the BIC values for the different models fitted should be provided. By default, the plot is not produced.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>printout</code></td>
<td>

<p>Logical indicating whether or not a statement is printed on screen detailing the progress of the algorithm.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function fits a probabilistic principal components analysis model to metabolomic spectral data via the EM algorithm. A range of models with different numbers of principal components can be fitted.
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>The number of principal components in the optimal PPCA model, selected by the BIC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig</code></td>
<td>
<p>The posterior mode estimate of the variance of the error terms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p>An N x q matrix of estimates of the latent locations of each observation in the principal subspace.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loadings</code></td>
<td>
<p>The maximum likelihood estimate of the p x q loadings matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BIC</code></td>
<td>
<p>A vector containing the BIC values for the fitted models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AIC</code></td>
<td>
<p>A vector containing the AIC values for the fitted models.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Nyamundanda Gift, Isobel Claire Gormley and Lorraine Brennan.
</p>


<h3>References</h3>

<p>Nyamundanda G., Gormley, I.C. and Brennan, L. (2010) Probabilistic principal components analysis for metabolomic data. Technical report, University College Dublin.
</p>


<h3>See Also</h3>

<p><code>ppca.metabol.jack</code>, <code>loadings.plot</code>, <code>ppca.scores.plot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(UrineSpectra)
## Not run: 
mdlfit&lt;-ppca.metabol(UrineSpectra[[1]], minq=2, maxq=2, scale="none")
loadings.plot(mdlfit)
ppca.scores.plot(mdlfit, group=UrineSpectra[[2]][,1])

## End(Not run)
</code></pre>


</div>