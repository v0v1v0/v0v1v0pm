<div class="container">

<table style="width: 100%;"><tr>
<td>ppca.metabol.jack</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fit a probabilistic principal components analysis model to a metabolomic data set, and assess uncertainty via the jackknife.
</h2>

<h3>Description</h3>

<p>Fit a probabilistic principal components analysis (PPCA) model to a metabolomic data set via the EM algorithm, and assess uncertainty in the obtained loadings estimates via the jackknife.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ppca.metabol.jack(Y, minq=1, maxq=2, scale ="none", 
epsilon = 0.1, conflevel = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>

<p>An N x p data matrix where each row is a spectrum.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minq</code></td>
<td>

<p>The minimum number of principal components to be fit. By default minq is 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxq</code></td>
<td>

<p>The maximum number of principal components to be fit. By default maxq is 2.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>

<p>Type of scaling of the data which is required. The default is "none". Options include "pareto' and "unit" scaling. See <code>scaling</code> for further details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>

<p>Value on which the convergence assessment criterion is based. Set by default to 0.1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conflevel</code></td>
<td>

<p>Level of confidence required for the loadings confidence intervals. By default 95<code class="reqn">\%</code> confidence intervals are computed.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A (range of) PPCA model(s) are fitted and an optimal model (i.e. number of principal components, q) is selected. Confidence intervals for the obtained loadings are then obtained via the jackknife i.e. a model with q principal components is fitted to the dataset <code class="reqn">N</code> times, where an observation is removed from the dataset each time. 
</p>
<p>On convergence of the algorithm, the number of loadings significantly different from zero is printed on screen. The user may then further examine the significant loadings when prompted by selecting a cutoff value from the table printed on screen. Bar plots detailing the resulting significantly high loadings are provided.
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>The number of principal components in the optimal PPCA model, selected by the BIC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig</code></td>
<td>
<p>The posterior mode estimate of the variance of the error terms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p>An N x q matrix of estimates of the latent locations of each observation in the principal subspace.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loadings</code></td>
<td>
<p>The maximum likelihood estimate of the p x q loadings matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SignifW</code></td>
<td>
<p>The maximum likelihood estimate of the loadings matrix for those loadings significantly different from zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SignifHighW</code></td>
<td>
<p>The maximum likelihood estimate of the loadings matrix for those loadings significantly different from zero and higher than a user selected cutoff point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lower</code></td>
<td>
<p>The lower limit of the confidence interval for those loadings significantly different from zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Upper</code></td>
<td>
<p>The upper limit of the confidence interval for those loadings significantly different from zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Cutoffs</code></td>
<td>
<p>A table detailing a range of cutoff points and the associated number of selected spectral bins.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>number</code></td>
<td>
<p>The number of spectral bins selected by the user.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>The cutoff value selected by the user.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BIC</code></td>
<td>
<p>A vector containing the BIC values for the fitted models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AIC</code></td>
<td>
<p>A vector containing the AIC values for the fitted models.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Nyamundanda Gift, Isobel Claire Gormley and Lorraine Brennan.
</p>


<h3>References</h3>

<p>Nyamundanda G., Gormley, I.C. and Brennan, L. (2010) Probabilistic principal components analysis for metabolomic data. Technical report, University College Dublin.
</p>


<h3>See Also</h3>

<p><code>ppca.metabol</code>, <code>loadings.jack.plot</code>, <code>ppca.scores.plot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(UrineSpectra)
## Not run: 
mdlfit&lt;-ppca.metabol.jack(UrineSpectra[[1]], minq=2, maxq=2, scale="none")
loadings.jack.plot(mdlfit)
ppca.scores.plot(mdlfit, group=UrineSpectra[[2]][,1])
## End(Not run)
</code></pre>


</div>