<div class="container">

<table style="width: 100%;"><tr>
<td>RemoveFactorsByANOVA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>RemoveFactorsByANOVA.</h2>

<h3>Description</h3>

<p><code>RemoveFactorsByANOVA</code> will remove variance from data using an ANOVA model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">RemoveFactorsByANOVA(
  y = NULL,
  sam = NULL,
  fmod = NULL,
  kmod = NULL,
  output = c("y_norm", "y_lm", "anova_y", "anova_y_norm", "boxplot")[1],
  remove_outliers = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Data vector (or data matrix) to normalize (numeric + in same order as sam).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sam</code></td>
<td>
<p>data.frame containing the factors or numerical vars for ANOVA model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fmod</code></td>
<td>
<p>Full model describing the experimental setting (provided as character string).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kmod</code></td>
<td>
<p>Reduced model describing all the biological factors to keep (provided as character string).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>Should be <code>y_norm</code> in general but can be switched for testing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove_outliers</code></td>
<td>
<p>Should be a numeric integer x (with $x=0$ : no effect; $x&gt;=1$ remove all values which have error e with $e &gt; abs(mean + x * sd)$ ).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See examples.
</p>


<h3>Value</h3>

<p>Depends on <code>output</code>. Usually the normalized data vector (or matrix).
</p>


<h3>Examples</h3>

<pre><code class="language-R"># set up sample information
sam &lt;- data.frame(
  "GT" = gl(4, 10),
  "TR" = rep(gl(2, 5), 4),
  "Batch" = sample(gl(2, 20)),
  "Order" = sample(seq(-1, 1, length.out = 40))
)

# set up artificial measurement data
set.seed(1)
# specify main effects
m1 &lt;- c(5, 6, 2, 9)[sam$GT] + c(-2, 2)[sam$TR]
m2 &lt;- c(5, -6, 2, 4)[sam$GT] + c(-2, 2)[sam$TR]
# add run order bias and noise
m1 &lt;- m1 + c(-3, 3)[sam$Batch] + 3 * sam$Order + rnorm(nrow(sam), sd = 0.5)
m2 &lt;- m2 - 5 * sam$Order + rnorm(nrow(sam), sd = 0.8)
dat &lt;- data.frame(m1, m2)

# apply function to remove variance
# full model incorporating all relevant factors defined in sample table
fmod &lt;- "GT*TR+Batch+Order"
# reduced model: factors to be kept from full model; everything elso will be removed from the data
kmod &lt;- "GT*TR"
RemoveFactorsByANOVA(y = dat[, "m1"], sam = sam, fmod = fmod, kmod = kmod, output = "anova_y")
RemoveFactorsByANOVA(y = dat[, "m1"], sam = sam, fmod = fmod, kmod = kmod, output = "anova_y_norm")
</code></pre>


</div>