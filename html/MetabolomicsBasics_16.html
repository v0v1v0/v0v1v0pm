<div class="container">

<table style="width: 100%;"><tr>
<td>ReplaceMissingValues</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>ReplaceMissingValues.</h2>

<h3>Description</h3>

<p><code>ReplaceMissingValues</code> will replace missing values within
a numeric matrix based on a principal component analysis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ReplaceMissingValues(x, ncomp = 10, silent = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Numeric matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncomp</code></td>
<td>
<p>Number of components to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>FALSE, suppress messages setting silent=TRUE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The 'nipals' algorithm is used to basically perform a PCA
on the sparse matrix. Missing values are imputed based on the major components
observed. Please check also the 'impute.nipals' function from mixOmics which
should basically give the same functionality since the 04/2021 update.
</p>


<h3>Value</h3>

<p>A matrix of similar dimensions as x without missing values.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># load raw data and sample description
raw &lt;- MetabolomicsBasics::raw
sam &lt;- MetabolomicsBasics::sam

idx &lt;- apply(raw, 2, CheckForOutliers, group = sam$GT, n_sd = 5, method = "logical")
sum(idx) # 215 values would be classified as outlier using a five-sigma band
old_vals &lt;- raw[idx] # keep outlier values for comparison
raw_filt &lt;- raw
raw_filt[idx] &lt;- NA
raw_means &lt;- apply(raw, 2, function(x) {
  sapply(split(x, sam$GT), mean, na.rm = TRUE)[as.numeric(sam$GT)]
})[idx]
raw_repl &lt;- ReplaceMissingValues(x = raw_filt)
new_vals &lt;- raw_repl[idx]
par(mfrow = c(2, 1))
breaks &lt;- seq(-0.7, 1.3, 0.05)
hist(raw_means - old_vals, breaks = breaks, main = "", xlab = "Outliers", las = 1)
hist(raw_means - new_vals, breaks = breaks, main = "", xlab = "Replaced values", las = 1)
</code></pre>


</div>