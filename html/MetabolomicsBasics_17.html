<div class="container">

<table style="width: 100%;"><tr>
<td>RestrictedPCA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>RestrictedPCA.</h2>

<h3>Description</h3>

<p><code>RestrictedPCA</code> combines an ANOVA based on 'fmod' and
restricts a PCA using the ANOVA result as a filter.
</p>


<h3>Usage</h3>

<pre><code class="language-R">RestrictedPCA(
  dat = NULL,
  sam = NULL,
  use.sam = NULL,
  group.col = NULL,
  text.col = NULL,
  fmod = NULL,
  sign.col = NULL,
  p.adjust.method = "none",
  P = 0.01,
  pcaMethods.scale = "pareto",
  n.metab.min = 20,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>Metabolite matrix (samples x metabolites).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sam</code></td>
<td>
<p>Sample definition dataframe.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.sam</code></td>
<td>
<p>Numeric index vector (or logical) to select specific samples to be included in the analysis or NULL to include all.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group.col</code></td>
<td>
<p>Column used for legend creation (column name from sam).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text.col</code></td>
<td>
<p>Column used for text annotation of data points (column name from sam).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fmod</code></td>
<td>
<p>ANOVA model to calculate before PCA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sign.col</code></td>
<td>
<p>Which column(s) of the ANOVA result shall be used for P-value filtering (specify column names or leave on NULL to filter on all).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.adjust.method</code></td>
<td>
<p>Method use to adjust P-values (e.g. none, BH or bonferroni).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>P-value threshold used as a cutoff after P-value adjustment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pcaMethods.scale</code></td>
<td>
<p>pcaMethods scale parameter (usually pareto for metabolite data).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.metab.min</code></td>
<td>
<p>Minimum number of metabolites kept for PCA calculation (even if they exceed P).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Handed through to <code>PlotMetabolitePCA</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>‘fmod' should be something like ’GT*TR+Batch' to perform
an ANOVA with these factors defined as columns in sam.
</p>


<h3>Value</h3>

<p>Will generate a PCA plot (generated by PlotMetabolitePCA internally)
restricted based on an ANOVA result based on MetaboliteANOVA.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># load raw data and sample description
raw &lt;- MetabolomicsBasics::raw
sam &lt;- MetabolomicsBasics::sam
# standard behavior
RestrictedPCA(dat = raw, sam = sam, group.col = "GT")
## Not run: 
# apply multiple testing using a strict P-value cutoff,
# dont show a legend but plot group mean values and sd's as overlay
RestrictedPCA(
  dat = raw, sam = sam, group.col = "GT", p.adjust.method = "BH", P = 10^-10,
  fmod = "GT+Batch+Order", sign.col = "GT", medsd = T, legend.x = NULL
)
# limit to a subset of samples, switching the ANOVA selection of by setting P=1
# and adding text (from \code{sam}) to each data point
RestrictedPCA(
  dat = raw, sam = sam, use.sam = which(sam$GT %in% c("Mo17", "B73")), group.col = "GT",
  fmod = "GT+Batch+Order", P = 1, sign.col = "GT", legend.x = NULL, text.col = "Batch"
)

## End(Not run)
</code></pre>


</div>