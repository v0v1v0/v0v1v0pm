<div class="container">

<table style="width: 100%;"><tr>
<td>unique_subformula_masses</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>unique_subformula_masses</h2>

<h3>Description</h3>

<p><code>unique_subformula_masses</code> will generate a numeric vector of
potential sub formula masses regarding a chemical formula as input.
</p>


<h3>Usage</h3>

<pre><code class="language-R">unique_subformula_masses(fml, names = TRUE, check_validity = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fml</code></td>
<td>
<p>Chemical formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names</code></td>
<td>
<p>Return respective sub formulas as vector names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check_validity</code></td>
<td>
<p>Filter for chemically valid formulas.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In mass spectrometry precursor masses are often fragmented and these
fragments are recorded as MS^2 spectra. A frequent task is then to compute
potential chemical formulas for the obtained MS^2 masses. The function
<code>unique_subformula_masses</code> follows the reverse approach. It allows to
calculate all masses that could be potential breakdown products of a precursor
formula
</p>


<h3>Value</h3>

<p>A named numeric vector. The names are the sub formulas for the calculated
exact masses given as numeric.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># specify a formula and calculate all potential combinatorial masses
fml &lt;- c("C6H12O6", "C11H16NO4PS", "C24H51O4P")[1]
tmp &lt;- unique_subformula_masses(fml = fml)
length(tmp); any(duplicated(tmp))
hist(tmp, breaks=seq(floor(min(tmp))-1, ceiling(max(tmp))), main=fml)
# do the same as above but check for chemical plausibility
tmp2 &lt;- unique_subformula_masses(fml = fml, check_validity=TRUE)
length(tmp2)
hist(tmp2, breaks=seq(floor(min(tmp2))-1, ceiling(max(tmp2))), main=fml)
mz &lt;- 147
tmp[abs(tmp-mz)&lt;0.5]
tmp2[abs(tmp2-mz)&lt;0.5]
</code></pre>


</div>