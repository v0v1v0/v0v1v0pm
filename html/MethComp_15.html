<div class="container">

<table style="width: 100%;"><tr>
<td>Deming</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Regression with errors in both variables (Deming regression)</h2>

<h3>Description</h3>

<p>The formal model underlying the procedure is based on a so called functional
relationship:
</p>
<p style="text-align: center;"><code class="reqn">x_i=\xi_i + e_{1i}, \qquad y_i=\alpha + \beta \xi_i + e_{2i}</code>
</p>

<p>with <code class="reqn">\mathrm{var}(e_{1i})=\sigma</code>,
<code class="reqn">\mathrm{var}(e_{2i})=\lambda\sigma</code>,
where <code class="reqn">\lambda</code> is the known variance ratio.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Deming(
  x,
  y,
  vr = sdr^2,
  sdr = sqrt(vr),
  boot = FALSE,
  keep.boot = FALSE,
  alpha = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a numeric variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vr</code></td>
<td>
<p>The assumed known ratio of the (residual) variance of the <code>y</code>s relative to that of the <code>x</code>s. Defaults to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdr</code></td>
<td>
<p>do. for standard deviations. Defaults to 1. <code>vr</code> takes precedence if both are given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot</code></td>
<td>
<p>Should bootstrap estimates of standard errors of parameters be done? If <code>boot==TRUE</code>, 1000 bootstrap samples are done, if <code>boot</code> is numeric, <code>boot</code> samples are made.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep.boot</code></td>
<td>
<p>Should the 4-column matrix of bootstrap samples be returned? If <code>TRUE</code>, the summary is printed, but the matrix is returned invisibly. Ignored if <code>boot=FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>What significance level should be used when displaying confidence intervals?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The estimates of the residual variance is based on a weighting of
the sum of squared deviations in both directions, divided by <code class="reqn">n-2</code>.
The ML estimate would use <code class="reqn">2n</code> instead, but in the model we actually
estimate <code class="reqn">n+2</code> parameters â€” <code class="reqn">\alpha, \beta</code> and
the <code class="reqn">n</code> <code class="reqn">\xi s</code>.
This is not in Peter Sprent's book (see references).
</p>


<h3>Value</h3>

<p>If <code>boot==FALSE</code> a named vector with components
<code>Intercept</code>, <code>Slope</code>, <code>sigma.x</code>, <code>sigma.y</code>, where <code>x</code>
and <code>y</code> are substituted by the variable names.
</p>
<p>If <code>boot==TRUE</code> a matrix with rows <code>Intercept</code>,
<code>Slope</code>, <code>sigma.x</code>, <code>sigma.y</code>, and colums giving the estimates,
the bootstrap standard error and the bootstrap estimate and c.i. as the 0.5,
<code class="reqn">\alpha/2</code> and <code class="reqn">1-\alpha/2</code> quantiles of the sample.
</p>
<p>If <code>keep.boot==TRUE</code> this summary is printed, but a matrix with columns
<code>Intercept</code>,
<code>Slope</code>, <code>sigma.x</code>, <code>sigma.y</code> and <code>boot</code> rows is returned.
</p>


<h3>Author(s)</h3>

<p>Bendix Carstensen, Steno Diabetes Center, <a href="mailto:bendix.carstensen@regionh.dk">bendix.carstensen@regionh.dk</a>, <a href="http://BendixCarstensen.com">http://BendixCarstensen.com</a>
</p>


<h3>References</h3>

<p>Peter Sprent: Models in Regression, Methuen &amp; Co., London 1969, ch.3.4.
</p>
<p>WE Deming: Statistical adjustment of data, New York: Wiley, 1943.
</p>


<h3>Examples</h3>

<pre><code class="language-R">

# 'True' values 
M &lt;- runif(100,0,5)
# Measurements:
x &lt;- M + rnorm(100)
y &lt;- 2 + 3 * M + rnorm(100,sd=2)
# Deming regression with equal variances, variance ratio 2.
Deming(x,y)
Deming(x,y,vr=2)
Deming(x,y,boot=TRUE)
bb &lt;- Deming(x,y,boot=TRUE,keep.boot=TRUE)
str(bb)
# Plot data with the two classical regression lines
plot(x,y)
abline(lm(y~x))
ir &lt;- coef(lm(x~y))
abline(-ir[1]/ir[2],1/ir[2])
abline(Deming(x,y,sdr=2)[1:2],col="red")
abline(Deming(x,y,sdr=10)[1:2],col="blue")
# Comparing classical regression and "Deming extreme"
summary(lm(y~x))
Deming(x,y,vr=1000000)

</code></pre>


</div>