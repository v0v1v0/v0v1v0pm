<div class="container">

<table style="width: 100%;"><tr>
<td>Meth.sim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate a dataframe containing replicate measurements on the same items
using different methods.</h2>

<h3>Description</h3>

<p>Simulates a dataframe representing data from a method comparison study. It
is returned as a <code>Meth</code> object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Meth.sim(
  Ni = 100,
  Nm = 2,
  Nr = 3,
  nr = Nr,
  alpha = rep(0, Nm),
  beta = rep(1, Nm),
  mu.range = c(0, 100),
  sigma.mi = rep(5, Nm),
  sigma.ir = 2.5,
  sigma.mir = rep(5, Nm),
  m.thin = 1,
  i.thin = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Ni</code></td>
<td>
<p>The number of items (patient, animal, sample, unit etc.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nm</code></td>
<td>
<p>The number of methods of measurement.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nr</code></td>
<td>
<p>The (maximal) number of replicate measurements for each
(item,method) pair.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nr</code></td>
<td>
<p>The minimal number of replicate measurements for each
(item,method) pair. If <code>nr&lt;Nr</code>, the number of replicates for each
(meth,item) pair is uniformly distributed on the points <code>nr:Nr</code>,
otherwise <code>nr</code> is ignored. Different number of replicates is only
meaningful if replicates are not linked, hence <code>nr</code> is also ignored
when <code>sigma.ir&gt;0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>A vector of method-specific intercepts for the linear equation
relating the "true" underlying item mean measurement to the mean measurement
on each method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>A vector of method-specific slopes for the linear equation
relating the "true" underlying item mean measurement to the mean measurement
on each method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu.range</code></td>
<td>
<p>The range across items of the "true" mean measurement.  Item
means are uniformly spaced across the range.  If a vector length <code>Ni</code>
is given, the values of that vector will be used as "true" means.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.mi</code></td>
<td>
<p>A vector of method-specific standard deviations for a method
by item random effect.  Some or all components can be zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.ir</code></td>
<td>
<p>Method-specific standard deviations for the item by
replicate random effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.mir</code></td>
<td>
<p>A vector of method-specific residual standard deviations
for a method by item by replicate random effect (residual variation).  All
components must be greater than zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m.thin</code></td>
<td>
<p>Fraction of the observations from each method to keep.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>i.thin</code></td>
<td>
<p>Fraction of the observations from each item to keep. If both
<code>m.thin</code> and <code>i.thin</code> are given the thinning is by their
componentwise product.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Data are simulated according to the following model for an observation
<code class="reqn">y_{mir}</code>: </p>
<p style="text-align: center;"><code class="reqn">y_{mir} = \alpha_m + \beta_m(\mu_i+b_{ir} +
c_{mi}) + e_{mir}</code>
</p>
<p> where
<code class="reqn">b_{ir}</code> is a random <code>item</code> by <code>repl</code> interaction (with
standard deviation for method <code class="reqn">m</code> the corresponding component of the
vector <code class="reqn">\sigma_ir</code>), <code class="reqn">c_{mi}</code> is a random
<code>meth</code> by <code>item</code> interaction (with standard deviation for method
<code class="reqn">m</code> the corresponding component of the vector <code class="reqn">\sigma_mi</code>)
and <code class="reqn">e_{mir}</code> is a residual error term (with standard deviation
for method <code class="reqn">m</code> the corresponding component of the vector
<code class="reqn">\sigma_mir</code>).  The <code class="reqn">\mu_i</code>'s are uniformly spaced
in a range specified by <code>mu.range</code>.
</p>


<h3>Value</h3>

<p>A <code>Meth</code> object, i.e. dataframe with columns
<code>meth</code>, <code>item</code>, <code>repl</code> and <code>y</code>, representing results
from a method comparison study.
</p>


<h3>Author(s)</h3>

<p>Lyle Gurrin, University of Melbourne,
<a href="http://www.epi.unimelb.edu.au/about/staff/gurrin-lyle">http://www.epi.unimelb.edu.au/about/staff/gurrin-lyle</a>
</p>
<p>Bendix Carstensen, Steno Diabetes Center, <a href="http://BendixCarstensen.com">http://BendixCarstensen.com</a>
</p>


<h3>See Also</h3>

<p><code>summary.Meth</code>, <code>plot.Meth</code>,
<code>MCmcmc</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
  Meth.sim( Ni=4, Nr=3 )
  xx &lt;- Meth.sim( Nm=3, Nr=5, nr=2, alpha=1:3, beta=c(0.7,0.9,1.2), m.thin=0.7 )
  summary( xx )
  plot( xx )
  
</code></pre>


</div>