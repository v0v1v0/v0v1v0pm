<div class="container">

<table style="width: 100%;"><tr>
<td>PBreg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Passing-Bablok regression</h2>

<h3>Description</h3>

<p>Implementation of the Passing-Bablok's procedure for assessing of the
equality of measurements by two different analytical methods.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PBreg(x, y = NULL, conf.level = 0.05, wh.meth = 1:2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a <code>Meth</code> object, alternatively a numeric vector of
measurements by method A, or a data frame of exactly two columns, first
column with measurements by method A, second column with measurements by
method B.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a numeric vector of measurements by method B - must be of the same
length as <code>x</code>. If not provided, <code>x</code> must be the <code>Meth</code>
object or a data frame of exactly 2 columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>confidence level for calculation of confidence boundaries
- 0.05 is the default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wh.meth</code></td>
<td>
<p>Which of the methods from the <code>Meth</code> object are used in
the regression.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is an implementation of the original Passing-Bablok procedure of
fitting unbiased linear regression line to data in the method comparison
studies. It calcualtes the unbiased slope and intercept, along with their
confidence intervals. However, the tests for linearity is not yet fully
implemented.
</p>
<p>It doesn't matter which results are assigned to "Method A" and "Method B",
however the "Method A" results will be plotted on the x-axis by the
<code>plot</code> method.
</p>


<h3>Value</h3>

<p><code>PBreg</code> returns an object of class <code>"PBreg"</code>, for which
the <code>print</code>, <code>predict</code> and <code>plot</code> methods are defined.
</p>
<p>An object of class <code>"PBreg"</code> is a list composed of the following
elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>a matrix of 3 columns and 2 rows, containing the
estimates of the intercept and slope, along with their confidence
boundaries.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>defined as in the <code>"lm"</code> class, as the
response minus the fitted value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>the fitted values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>the model data frame used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>a vector of two values:
the number of observations read, and the number of observations used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>A vector of all slope estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>I</code></td>
<td>
<p>A vector of all
intercept estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj</code></td>
<td>
<p>A vector of fit parameters, where <em>Ss</em>
is the number of estimated slopes (<code>length(S)</code>), <em>K</em> is the offset
for slopes &lt;(-1), <em>M1</em> and <em>M2</em> are the locations of confidence
boundaries in <code>S</code>, and <em>l</em> and <em>L</em> are the numbers of points
above and below the fitted line, used in cusum calculation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cusum</code></td>
<td>
<p>A
vector of cumulative sums of residuals sorted by the D-rank.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Di</code></td>
<td>
<p>A
vector of D-ranks.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Please note that this method can become very computationally intensive
for larger numbers of observations. One can expect a reasonable computation
times for datasets with fewer than 100 observations.
</p>


<h3>Author(s)</h3>

<p>Michal J. Figurski <a href="mailto:mfigrs@gmail.com">mfigrs@gmail.com</a>
</p>


<h3>References</h3>

<p>Passing, H. and Bablok, W. (1983), A New Biometrical Procedure
for Testing the Equality of Measurements from Two Different Analytical
Methods. <em>Journal of Clinical Chemistry and Clinical Biochemistry</em>, Vol
21, 709â€“720
</p>


<h3>See Also</h3>

<p><code>plot.PBreg, predict.PBreg, Deming</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
  ## Model data frame generation
  a &lt;- data.frame(x=seq(1, 30)+rnorm(mean=0, sd=1, n=30),
                  y=seq(1, 30)*rnorm(mean=1, sd=0.4, n=30))

  ## Call to PBreg
  x &lt;- PBreg(a)
  print(x)

  par(mfrow=c(2,2))
  plot(x, s=1:4)

  ## A real data example
  data(milk)
  milk &lt;- Meth(milk)
  summary(milk)
  PBmilk &lt;- PBreg(milk)
  par(mfrow=c(2,2))
  plot(PBmilk, s=1:4)

</code></pre>


</div>