<div class="container">

<table style="width: 100%;"><tr>
<td>simulate_evolData</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate Data Evolution along a Tree</h2>

<h3>Description</h3>

<p>This function simulates methylation data evolution along a tree. Either by simulating data at the root of the provided evolutionary tree
(if infoStr is given) or by using pre-existing data at the root (if rootData is given) and letting it evolve along the tree.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simulate_evolData(
  infoStr = NULL,
  rootData = NULL,
  tree,
  params = NULL,
  dt = 0.01,
  n_rep = 1,
  only_tip = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>infoStr</code></td>
<td>
<p>A data frame containing columns 'n' for the number of sites, and 'globalState' for the favoured global methylation state.
If customized initial equilibrium frequencies are given, it also contains columns 'u_eqFreq', 'p_eqFreq', and 'm_eqFreq'
with the equilibrium frequency values for unmethylated, partially methylated, and methylated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rootData</code></td>
<td>
<p>The output of the simulate_initialData()$data function. It represents the initial data at the root of the evolutionary tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>A string in Newick format representing the evolutionary tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>Optional data frame with specific parameter values.
Structure as in get_parameterValues() output. If not provided, default values will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dt</code></td>
<td>
<p>Length of time step for Gillespie's Tau-Leap Approximation (default is 0.01).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_rep</code></td>
<td>
<p>Number of replicates to simulate (default is 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>only_tip</code></td>
<td>
<p>Logical indicating whether to extract data only for tips (default is TRUE, FALSE to extract the information for all the tree branches).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the parameters used (<code>$params</code>), the length of the time step used for the Gillespie's tau-leap approximation (<code>$dt</code>, default 0.01), the tree used (<code>$tree</code>).
simulated data and the simulated data (<code>$data</code>). In <code>$data</code>, each list element corresponds to a simulation replicate.
</p>

<ul>
<li>
<p> If only_tip is TRUE: In <code>$data</code>, each list element corresponds to a simulation replicate.
Each replicate includes one list per tree tip, each containing:
</p>

<ul>
<li>
<p> The name of each tip in the simulated tree (e.g. replicate 2, tip 1: <code>$data[[2]][[1]]$name</code>).
</p>
</li>
<li>
<p> A list with the sequence of methylation states for each tip-specific structure (e.g. replicate 1, tip 2, 3rd structure: <code>$data[[1]][[2]]$seq[[3]]</code>.
The methylation states are encoded as 0 for unmethylated, 0.5 for partially methylated, and 1 for methylated.
</p>
</li>
</ul>
</li>
<li>
<p> If only_tip is FALSE, <code>$data</code> contains 2 lists:
</p>

<ul>
<li> <p><code>$data$branchInTree</code>: a list in which each element contains the information of the relationship with other branches:
</p>

<ul>
<li>
<p> Index of the parent branch (e.g. branch 2): <code>$data$branchInTree[[2]]$parent_index</code>)
</p>
</li>
<li>
<p> Index(es) of the offspring branch(es) (e.g. branch 1 (root)): <code>$data$branchInTree[[1]]$offspring_index</code>)
</p>
</li>
</ul>
</li>
<li> <p><code>$data$sim_data</code>: A list containing simulated data. Each list element corresponds to a simulation replicate.
Each replicate includes one list per tree branch, each containing:
</p>

<ul>
<li>
<p> The name of each branch in the simulated tree. It's NULL for the tree root and inner nodes, and the name of the tips for the tree tips.
(e.g. replicate 2, branch 1: <code>$data$sim_data[[2]][[1]]$name</code>)
</p>
</li>
<li>
<p> Information of IWE events on that branch. It's NULL for the tree root and FALSE for the branches in which no IWE event was sampled,
and a list containing <code>$islands</code> with the index(ces) of the island structure(s) that went through the IWE event and <code>$times</code>
for the branch time point(s ) in which the IWE was sampled.
(e.g. replicate 1, branch 3: <code>$data$sim_data[[1]][[3]]$IWE</code>)
</p>
</li>
<li>
<p> A list with the sequence of methylation states for each structure (the index of the list corresponds to the index
of the structures). The methylation states are encoded as 0 for unmethylated, 0.5 for partially methylated, and 1 for methylated.
(e.g. replicate 3, branch 2, structure 1: <code>$data$sim_data[[3]][[2]]$seq[[1]]</code>)
</p>
</li>
<li>
<p> A list with the methylation equilibrium frequencies for each structure (the index of the list corresponds to the index
of the structures). Each structure has a vector with 3 values, the first one corresponding to the frequency of unmethylated,
the second one to the frequency of partially methylated, and the third one to the frequency of methylated CpGs.
(e.g. replicate 3, branch 2, structure 1: <code>$data$sim_data[[3]][[2]]$eqFreqs[[1]]</code>)
</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R"># Example data
infoStr &lt;- data.frame(n = c(10, 100, 10), globalState = c("M", "U", "M"))

# Simulate data evolution along a tree with default parameters
simulate_evolData(infoStr = infoStr, tree = "(A:0.1,B:0.1);")

# Simulate data evolution along a tree with custom parameters
custom_params &lt;- get_parameterValues()
custom_params$iota &lt;- 0.5
simulate_evolData(infoStr = infoStr, tree = "(A:0.1,B:0.1);", params = custom_params)

</code></pre>


</div>