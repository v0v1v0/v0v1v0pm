<div class="container">

<table style="width: 100%;"><tr>
<td>augment.graph_lme</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Augment data with information from a <code>graph_lme</code> object</h2>

<h3>Description</h3>

<p>Augment accepts a model object and a dataset and adds information about each observation in the dataset. It includes
predicted values in the <code>.fitted</code> column, residuals in the <code>.resid</code> column, and standard errors for the fitted values in a <code>.se.fit</code> column.
It also contains the New columns always begin with a . prefix to avoid overwriting columns in the original dataset.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'graph_lme'
augment(
  x,
  newdata = NULL,
  which_repl = NULL,
  sd_post_re = FALSE,
  se_fit = FALSE,
  conf_int = FALSE,
  pred_int = FALSE,
  level = 0.95,
  edge_number = "edge_number",
  distance_on_edge = "distance_on_edge",
  coord_x = "coord_x",
  coord_y = "coord_y",
  data_coords = c("PtE", "spatial"),
  normalized = FALSE,
  no_nugget = FALSE,
  check_euclidean = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A <code>graph_lme</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>A <code>data.frame</code> or a <code>list</code> containing the covariates, the edge
number and the distance on edge for the locations to obtain the prediction. If <code>NULL</code>, the fitted values will be given for the original locations where the model was fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which_repl</code></td>
<td>
<p>Which replicates to obtain the prediction. If <code>NULL</code> predictions
will be obtained for all replicates. Default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd_post_re</code></td>
<td>
<p>Logical indicating whether or not a .sd_post_re column should be added to the augmented output containing the posterior standard deviations of the random effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se_fit</code></td>
<td>
<p>Logical indicating whether or not a .se_fit column should be added to the augmented output containing the standard errors of the fitted values. If <code>TRUE</code>, the posterior standard deviations of the random effects will also be returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf_int</code></td>
<td>
<p>Logical indicating whether or not confidence intervals for the posterior mean of the random effects should be built.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred_int</code></td>
<td>
<p>Logical indicating whether or not prediction intervals for the fitted values should be built. If <code>TRUE</code>, the confidence intervals for the posterior random effects will also be built.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>Level of confidence and prediction intervals if they are constructed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edge_number</code></td>
<td>
<p>Name of the variable that contains the edge number, the
default is <code>edge_number</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance_on_edge</code></td>
<td>
<p>Name of the variable that contains the distance on
edge, the default is <code>distance_on_edge</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coord_x</code></td>
<td>
<p>Column (or entry on the list) of the <code>data</code> that contains
the x coordinate. If not supplied, the column with name "coord_x" will be
chosen. Will not be used if <code>Spoints</code> is not <code>NULL</code> or if <code>data_coords</code> is
<code>PtE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coord_y</code></td>
<td>
<p>Column (or entry on the list) of the <code>data</code> that contains
the y coordinate. If not supplied, the column with name "coord_x" will be
chosen. Will not be used if <code>Spoints</code> is not <code>NULL</code> or if <code>data_coords</code> is
<code>PtE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data_coords</code></td>
<td>
<p>To be used only if <code>Spoints</code> is <code>NULL</code>. It decides which
coordinate system to use. If <code>PtE</code>, the user must provide <code>edge_number</code> and
<code>distance_on_edge</code>, otherwise if <code>spatial</code>, the user must provide
<code>coord_x</code> and <code>coord_y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalized</code></td>
<td>
<p>Are the distances on edges normalized?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no_nugget</code></td>
<td>
<p>Should the prediction be done without nugget?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check_euclidean</code></td>
<td>
<p>Check if the graph used to compute the resistance distance has Euclidean edges? The graph used to compute the resistance distance has the observation locations as vertices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>tidyr::tibble()</code> with columns:
</p>

<ul>
<li> <p><code>.fitted</code> Fitted or predicted value.
</p>
</li>
<li> <p><code>.relwrconf</code> Lower bound of the confidence interval of the random effects, if conf_int = TRUE
</p>
</li>
<li> <p><code>.reuprconf</code> Upper bound of the confidence interval of the random effects, if conf_int = TRUE
</p>
</li>
<li> <p><code>.fittedlwrpred</code> Lower bound of the prediction interval, if conf_int = TRUE
</p>
</li>
<li> <p><code>.fitteduprpred</code> Upper bound of the prediction interval, if conf_int = TRUE
</p>
</li>
<li> <p><code>.fixed</code> Prediction of the fixed effects.
</p>
</li>
<li> <p><code>.random</code> Prediction of the random effects.
</p>
</li>
<li> <p><code>.resid</code> The ordinary residuals, that is, the difference between observed and fitted values.
</p>
</li>
<li> <p><code>.std_resid</code> The standardized residuals, that is, the ordinary residuals divided by the standard error of the fitted values (by the prediction standard error), if se_fit = TRUE or pred_int = TRUE.
</p>
</li>
<li> <p><code>.se_fit</code> Standard errors of fitted values, if se_fit = TRUE.
</p>
</li>
<li> <p><code>.sd_post_re</code> Standard deviation of the posterior mean of the random effects, if se_fit = TRUE.
</p>
</li>
</ul>
<h3>See Also</h3>

<p>glance.graph_lme
</p>


</div>