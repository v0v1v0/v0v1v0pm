<div class="container">

<table style="width: 100%;"><tr>
<td>sample_spde</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Samples a Whittle-Matérn field on a metric graph</h2>

<h3>Description</h3>

<p>Obtains samples of a Whittle-Matérn field on a metric graph.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sample_spde(
  kappa,
  tau,
  range,
  sigma,
  sigma_e = 0,
  alpha = 1,
  graph,
  PtE = NULL,
  type = "manual",
  posterior = FALSE,
  nsim = 1,
  method = c("conditional", "Q"),
  BC = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>kappa</code></td>
<td>
<p>Range parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>Precision parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range</code></td>
<td>
<p>Practical correlation range parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>Marginal standard deviation parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma_e</code></td>
<td>
<p>Standard deviation of the measurement noise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Smoothness parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>graph</code></td>
<td>
<p>A <code>metric_graph</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PtE</code></td>
<td>
<p>Matrix with locations (edge, normalized distance on edge) where
the samples should be generated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>If "manual" is set, then sampling is done at the locations
specified in <code>PtE</code>. Set to "mesh" for simulation at mesh nodes, and to "obs"
for simulation at observation locations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posterior</code></td>
<td>
<p>Sample conditionally on the observations?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>Number of samples to be generated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Which method to use for the sampling? The options are
"conditional" and "Q". Here, "Q" is more stable but takes longer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BC</code></td>
<td>
<p>Boundary conditions for degree 1 vertices. BC = 0 gives Neumann
boundary conditions and BC = 1 gives stationary boundary conditions.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Samples a Gaussian Whittle-Matérn field on a metric graph, either
from the prior or conditionally on observations
</p>
<p style="text-align: center;"><code class="reqn">y_i = u(t_i) + \sigma_e e_i</code>
</p>

<p>on the graph,  where <code class="reqn">e_i</code> are independent standard Gaussian variables.
The parameters for the field can either be specified in terms of tau and kappa
or practical correlation range and marginal standard deviation.
</p>


<h3>Value</h3>

<p>Matrix or vector with the samples.
</p>


</div>