<div class="container">

<table style="width: 100%;"><tr>
<td>approx_horseshoe</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Run approximate MCMC algorithm for horseshoe prior</h2>

<h3>Description</h3>

<p>The approximate MCMC algorithm for the horseshoe prior
</p>


<h3>Usage</h3>

<pre><code class="language-R">approx_horseshoe(
  y,
  X,
  burn = 1000,
  iter = 5000,
  auto.threshold = TRUE,
  threshold = 0,
  tau = 1,
  s = 0.8,
  sigma2 = 1,
  w = 1,
  alpha = 0.05,
  a = 0.2,
  b = 10,
  t = 10,
  adapt_p0 = 0,
  adapt_p1 = -4.6 * 10^(-4)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Response vector, <code class="reqn">y \in \mathbb{R}^{N}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Design matrix, <code class="reqn">X \in \mathbb{R}^{N \times p}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn</code></td>
<td>
<p>Number of burn-in samples. The default is 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>Number of samples to be drawn from the posterior. The default is
5000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>auto.threshold</code></td>
<td>
<p>Argument for setting whether to use an algorithm that
automatically updates the threshold using adaptive probability.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>Threshold to be used in the approximate MCMC algorithm.
This argument is ignored when auto.threshold=TRUE. If you select
auto.threshold = FALSE and threshold = 0 (This is the default value for the
threshold argument), the threshold is set to
<code class="reqn">\sqrt{p \times min(N, p)}</code> as suggested in Johndrow et al. (2020). Or,
you can set your custom value directly through this argument. For more
information about <code class="reqn">\delta</code>, browseVignettes("Mhorseshoe") and 4.1 of
Johndrow et al. (2020).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>Initial value of the global shrinkage parameter <code class="reqn">\tau</code> when
starting the algorithm. The default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p><code class="reqn">s^{2}</code> is the variance of tau's MH proposal distribution.
0.8 is a good default. If set to 0, the algorithm proceeds by fixing the
global shrinkage parameter <code class="reqn">\tau</code> to the initial setting value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2</code></td>
<td>
<p>Initial value of error variance <code class="reqn">\sigma^{2}</code>. The default
is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>A hyperparameter of gamma prior for <code class="reqn">\sigma^{2}</code>. The default
is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p><code class="reqn">100(1-\alpha)\%</code> credible interval setting argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>A tuning parameter of the rejection sampler, where the default
value is <code class="reqn">a = 1/5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>A tuning parameter of the rejection sampler, where the default
value is <code class="reqn">b = 10</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>Threshold update cycle for adaptive probability algorithm when
auto.threshold is set to TRUE. The default is 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adapt_p0</code></td>
<td>
<p>A tuning parameter <code class="reqn">p_{0}</code> of the adaptive probability,
<code class="reqn">p(t) = exp[p_{0} + p_{1}t]</code>. The default is <code class="reqn">0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adapt_p1</code></td>
<td>
<p>A tuning parameter <code class="reqn">a_{1}</code> of the adaptive probability,
<code class="reqn">p(t) = exp[p_{0} + p_{1}t]</code>. The default is <code class="reqn">-4.6 \times 10^{-4}</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function implements the approximate algorithm introduced in Section
2.2 of Johndrow et al. (2020) and the method proposed in this package, which
improves computation speed when p &gt;&gt; N. The approximate algorithm introduces
a threshold and uses only a portion of the total <code class="reqn">p</code> columns for matrix
multiplication, reducing the computational cost compared to the existing
MCMC algorithms for the horseshoe prior. The "auto.threshold" argument
determines whether the threshold used in the algorithm will be updated by
the adaptive method proposed in this package.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>BetaHat</code></td>
<td>
<p>Posterior mean of <code class="reqn">\beta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LeftCI</code></td>
<td>
<p>Lower bound of <code class="reqn">100(1-\alpha)\%</code> credible interval for
<code class="reqn">\beta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RightCI</code></td>
<td>
<p>Upper bound of <code class="reqn">100(1-\alpha)\%</code> credible interval for
<code class="reqn">\beta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma2Hat</code></td>
<td>
<p>Posterior mean of <code class="reqn">\sigma^{2}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TauHat</code></td>
<td>
<p>Posterior mean of <code class="reqn">\tau</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LambdaHat</code></td>
<td>
<p>Posterior mean of <code class="reqn">\lambda_{j},\ j=1,2,...p.</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ActiveMean</code></td>
<td>
<p>Average number of elements in the active set per iteration
in this algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BetaSamples</code></td>
<td>
<p>Posterior samples of <code class="reqn">\beta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LambdaSamples</code></td>
<td>
<p>Posterior samples of local shrinkage parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TauSamples</code></td>
<td>
<p>Posterior samples of global shrinkage parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma2Samples</code></td>
<td>
<p>Posterior samples of <code class="reqn">sigma^{2}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ActiveSet</code></td>
<td>
<p><code class="reqn">\mathbb{R}^{iter \times p}</code> Matrix indicating active
elements as 1 and non-active elements as 0 per iteration of the MCMC
algorithm.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Johndrow, J., Orenstein, P., &amp; Bhattacharya, A. (2020).
Scalable Approximate MCMC Algorithms for the Horseshoe Prior. In Journal
of Machine Learning Research, 21, 1-61.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Making simulation data.
set.seed(123)
N &lt;- 200
p &lt;- 100
true_beta &lt;- c(rep(1, 10), rep(0, 90))

X &lt;- matrix(1, nrow = N, ncol = p) # Design matrix X.
for (i in 1:p) {
  X[, i] &lt;- stats::rnorm(N, mean = 0, sd = 1)
}

y &lt;- vector(mode = "numeric", length = N) # Response variable y.
e &lt;- rnorm(N, mean = 0, sd = 2) # error term e.
for (i in 1:10) {
  y &lt;- y + true_beta[i] * X[, i]
}
y &lt;- y + e

# Run with auto.threshold set to TRUE
result1 &lt;- approx_horseshoe(y, X, burn = 0, iter = 100,
                            auto.threshold = TRUE)

# Run with fixed custom threshold
result2 &lt;- approx_horseshoe(y, X, burn = 0, iter = 100,
                            auto.threshold = FALSE, threshold = 1/(5 * p))

# posterior mean
betahat &lt;- result1$BetaHat

# Lower bound of the 95% credible interval
leftCI &lt;- result1$LeftCI

# Upper bound of the 95% credible interval
RightCI &lt;- result1$RightCI

</code></pre>


</div>