<div class="container">

<table style="width: 100%;"><tr>
<td>calculate_surrogate_scores</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>calculate_surrogate_scores</h2>

<h3>Description</h3>

<p>Function to compute the surrogate scores by Bizzarri et al. from  the Nightingale metabolomics matrix
</p>


<h3>Usage</h3>

<pre><code class="language-R">calculate_surrogate_scores(
  met,
  pheno,
  PARAM_surrogates,
  bin_names = c("sex", "diabetes"),
  Nmax_miss = 1,
  Nmax_zero = 1,
  post = TRUE,
  roc = FALSE,
  quiet = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>met</code></td>
<td>
<p>numeric data-frame with Nightingale-metabolomics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pheno</code></td>
<td>
<p>phenotypic data.frame including this clinical variables (with the same nomenclature): "sex","diabetes", "lipidmed",  "blood_pressure_lowering_med", "current_smoking",
"metabolic_syndrome", "alcohol_consumption", "age","BMI", "ln_hscrp","waist_circumference",
"weight","height", "triglycerides", "ldl_chol", "hdlchol", "totchol", "eGFR","wbc","hgb"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PARAM_surrogates</code></td>
<td>
<p>list containing the parameters to compute the metabolomics-based surrogates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bin_names</code></td>
<td>
<p>vector of strings containing the names of the binary variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nmax_miss</code></td>
<td>
<p>numeric value indicating the maximum number of missing values allowed per sample (Number suggested=1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nmax_zero</code></td>
<td>
<p>numeric value indicating the maximum number of zeros allowed per sample (Number suggested=1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>post</code></td>
<td>
<p>logical to indicate if the function should calculate the posterior probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>roc</code></td>
<td>
<p>logical to plot ROC curves for the metabolomics surrogate (available only for the phenotypes included)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>logical to suppress the messages in the console</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Bizzarri et al. built multivariate models,using 56 metabolic features quantified by Nightingale, to predict the 19 binary characteristics of an individual.
The binary variables are: sex, diabetes status, metabolic syndrome status, lipid medication usage, blood pressure lowering medication,
current smoking, alcohol consumption, high age, middle age, low age, high hsCRP, high triglycerides, high ldl cholesterol,
high total cholesterol, low hdl cholesterol, low eGFR, low white blood cells, low hemoglobin levels.
</p>


<h3>Value</h3>

<p>if pheno is not available: list with the surrogates and the Nightingale metabolomics matrix after QC.
if pheno is available: list with the surrogates, ROC curves, phenotypes, binarized phenotypes and the Nightingale metabolomics matrix after QC,
</p>


<h3>References</h3>

<p>This function was made to vidualize the binarized variables calculated following the rules indicated in the article:
Bizzarri,D. et al. (2022) 1H-NMR metabolomics-based surrogates to impute common clinical risk factors and endpoints. EBioMedicine, 75, 103764, <a href="doi:10.1016/j.ebiom.2021.103764">doi:10.1016/j.ebiom.2021.103764</a>
</p>


<h3>See Also</h3>

<p>QCprep_surrogates
</p>


<h3>Examples</h3>

<pre><code class="language-R">require(MiMIR)
require(foreach)
require(pROC)
require(foreach)

#load dataset
m &lt;- synthetic_metabolic_dataset
p &lt;- synthetic_phenotypic_dataset
#Apply the surrogates
sur&lt;-calculate_surrogate_scores(met=m,pheno=p,MiMIR::PARAM_surrogates,bin_names=c("sex","diabetes"))

</code></pre>


</div>