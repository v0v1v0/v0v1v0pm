<div class="container">

<table style="width: 100%;"><tr>
<td>MetaboWAS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MetaboWAS</h2>

<h3>Description</h3>

<p>Function to calculate a Metabolome Wide Association study
</p>


<h3>Usage</h3>

<pre><code class="language-R">MetaboWAS(met, pheno, test_variable, covariates, img = TRUE, adj_method = "BH")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>met</code></td>
<td>
<p>numeric data.frame with the metabolomics features</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pheno</code></td>
<td>
<p>data.frame containing the phenotype of interest</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test_variable</code></td>
<td>
<p>string vector with the name of the phenotype of interest</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariates</code></td>
<td>
<p>string vector with the name of the variables to be added as a covariate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>img</code></td>
<td>
<p>logical indicating if the function should plot a Manhattan plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj_method</code></td>
<td>
<p>multiple testing correction method</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is a function to compute linear associations individually for each variable in the first data.frame
with the test variable and corrected for the selected covariates.
This function to computes linear regression modelindividually for each variable in the first data.frame
with the test variable and adjusted for potential confounders.
False Discovery Rate (FDR) is applied to account for multiple testing correction.
The user has the faculty to select the test variable and the potential covariates within the pool of variables in the phenotypic file input.
The results of the associations are reported in a Manhattan plot
</p>
<p>The p-value of the association is then corrected using Benjamini Hochberg.
Finally we use plotly to plot a Manhattan Plot, which reports on the x-axis the list of metabolites reported in the Nightingale Health,
divided in groups, and on the y-axis the -log (adjusted p-value).
</p>


<h3>Value</h3>

<p>res= the results of the MetaboWAS, manhplot= the Manhattan plot made with plotly, N_hits= the number of significant hits
</p>


<h3>References</h3>

<p>This method is also described and used in:
Bizzarri,D. et al. (2022) 1H-NMR metabolomics-based surrogates to impute common clinical risk factors and endpoints. EBioMedicine, 75, 103764, <a href="doi:10.1016/j.ebiom.2021.103764">doi:10.1016/j.ebiom.2021.103764</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">require(MiMIR)
require(plotly)
require(ggplot2)

#' #load the dataset
metabolic_measures &lt;- synthetic_metabolic_dataset
phenotypes &lt;- synthetic_phenotypic_dataset

#Computing a MetaboWAS for age corrected by sex
MetaboWAS(met=metabolic_measures, pheno=phenotypes, test_variable="age", covariates= "sex")

</code></pre>


</div>