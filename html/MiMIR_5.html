<div class="container">

<table style="width: 100%;"><tr>
<td>apply.fit_surro</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>apply.fit_surro</h2>

<h3>Description</h3>

<p>Function that apply on of the surrogates models to the NH-metabolomics concentrations
</p>


<h3>Usage</h3>

<pre><code class="language-R">apply.fit_surro(mat, FIT, post = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mat</code></td>
<td>
<p>numeric data-frame with Nightingale-metabolomics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FIT</code></td>
<td>
<p>The betas of the logistic regressions composing the surrogates by Bizzarri et al.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>post</code></td>
<td>
<p>logical to obtain posterior probabilities</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Bizzarri et al. built multivariate models,using 56 metabolic features quantified by Nightingale, to predict the 19 binary characteristics of an individual.
The binary variables are: sex, diabetes status, metabolic syndrome status, lipid medication usage, blood pressure lowering medication,
current smoking, alcohol consumption, high age, middle age, low age, high hsCRP, high triglycerides, high ldl cholesterol,
high total cholesterol, low hdl cholesterol, low eGFR, low white blood cells, low hemoglobin levels.
</p>


<h3>Value</h3>

<p>numeric data.frame with the metabolomics-based surrogates by Bizzarri et al.
</p>


<h3>References</h3>

<p>This function was made to vidualize the binarized variables calculated following the rules indicated in the article:
Bizzarri,D. et al. (2022) 1H-NMR metabolomics-based surrogates to impute common clinical risk factors and endpoints. EBioMedicine, 75, 103764, <a href="doi:10.1016/j.ebiom.2021.103764">doi:10.1016/j.ebiom.2021.103764</a>
</p>


<h3>See Also</h3>

<p>QCprep_surrogates, calculate_surrogate_scores, subset_samples_sd_surrogates, predictions_surrogates
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(MiMIR)

#load the Nightignale metabolomics dataset
metabolic_measures &lt;- read.csv("Nightingale_file_path",header = TRUE, row.names = 1)
# Do the pre-processing steps to the metabolic measures
metabolic_measures&lt;-QCprep_surrogates(as.matrix(metabolic_measures), Nmax_miss=1,Nmax_zero=1)

#load the phenotypic dataset
phenotypes &lt;- read.csv("phenotypes_file_path",header = TRUE, row.names = 1)
#Calculating the binarized surrogates
bin_pheno&lt;-binarize_all_pheno(phenotypes)

#Apply the surrogate models
surrogates&lt;-foreach::foreach(i=MiMIR::phenotypes_names$out_surro, .combine="cbind") %do% {
pred&lt;-apply.fit_surro(as.matrix(metabo_measures), 
PARAM_surrogates$models_betas[i,])}


## End(Not run)

</code></pre>


</div>