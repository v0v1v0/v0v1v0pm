<div class="container">

<table style="width: 100%;"><tr>
<td>MiRKATS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Microiome Regression-based Kernel Association Test for Survival</h2>

<h3>Description</h3>

<p>Community level test for association between microbiome composition and survival outcomes (right-censored time-to-event data) 
using kernel matrices to compare similarity between microbiome profiles with similarity in survival times.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MiRKATS(
  obstime,
  delta,
  X = NULL,
  Ks,
  beta = NULL,
  perm = FALSE,
  omnibus = "permutation",
  nperm = 999,
  returnKRV = FALSE,
  returnR2 = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obstime</code></td>
<td>
<p>A numeric vector of follow-up (survival/censoring) times.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>Event indicator: a vector of 0/1, where 1 indicates that the event was observed for a subject (so "obstime" is 
survival time), and 0 indicates that the subject was censored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A vector or matrix of numeric covariates, if applicable (default = NULL).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ks</code></td>
<td>
<p>A list of or a single numeric n by n kernel matrices or matrix (where n is the sample size).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>A vector of coefficients associated with covariates. If beta is NULL and covariates are present, coxph is used to 
calculate coefficients (default = NULL).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perm</code></td>
<td>
<p>Logical, indicating whether permutation should be used instead of analytic p-value calculation (default=FALSE). 
Not recommended for sample sizes of 100 or more.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omnibus</code></td>
<td>
<p>A string equal to either "Cauchy" or "permutation" (or nonambiguous abbreviations thereof), specifying whether 
to use the Cauchy combination test or residual permutation to generate the omnibus p-value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nperm</code></td>
<td>
<p>Integer, number of permutations used to calculate p-value if perm==TRUE (default=1000) and to calculate omnibus p-value if omnibus=="permutation".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnKRV</code></td>
<td>
<p>A logical indicating whether to return the KRV statistic. Defaults to FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnR2</code></td>
<td>
<p>A logical indicating whether to return the R-squared coefficient. Defaults to FALSE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>obstime, delta, and X should all have n rows, and the kernel or distance matrix should be a single n by n matrix. 
If a distance matrix is entered (distance=TRUE), a kernel matrix will be constructed from the distance matrix.
</p>
<p>Update in v1.1.0: MiRKATS also utilizes the OMiRKATS omnibus test if more than one kernel matrix is provided by the user. 
The OMiRKATS omnibus test calculates an overall p-value for the test via permutation. 
</p>
<p>Missing data is not permitted. Please remove individuals with missing data on y, X or in the kernel or distance matrix prior 
to using the function.
</p>
<p>The Efron approximation is used for tied survival times.
</p>


<h3>Value</h3>

<p>Return value depends on the number of kernel matrices inputted. If more than one kernel matrix is given, MiRKATS returns two
items; a vector of the labeled individual p-values for each kernel matrix, as well as an omnibus p-value from the Optimal-MiRKATS
omnibus test. If only one kernel matrix is given, then only its p-value will be given, as no omnibus test will be needed.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>p_values</code></td>
<td>
<p>individual p-values for each inputted kernel matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omnibus_p</code></td>
<td>
<p>overall omnibus p-value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>KRV</code></td>
<td>
<p>A vector of kernel RV statistics (a measure of effect size), one for each candidate kernel matrix. Only returned if returnKRV = TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R2</code></td>
<td>
<p>A vector of R-squared statistics, one for each candidate kernel matrix. Only returned if returnR2 = TRUE</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Nehemiah Wilson, Anna Plantinga
</p>


<h3>References</h3>

<p>Plantinga, A., Zhan, X., Zhao, N., Chen, J., Jenq, R., and Wu, M.C. MiRKAT-S: a distance-based test of association between
microbiome composition and survival times. Microbiome, 2017:5-17. doi: 10.1186/s40168-017-0239-9
</p>
<p>Zhao, N., Chen, J.,Carroll, I. M., Ringel-Kulka, T., Epstein, M.P., Zhou, H., Zhou, J. J., Ringel, Y., Li, H. and Wu, M.C. (2015)).
Microbiome Regression-based Kernel Association Test (MiRKAT). American Journal of Human Genetics, 96(5):797-807
</p>
<p>Chen, J., Chen, W., Zhao, N., Wu, M~C.and Schaid, D~J. (2016) Small Sample Kernel Association Tests for Human Genetic and
Microbiome Association Studies. 40:5-19. doi: 10.1002/gepi.21934
</p>
<p>Efron, B. (1977) "The efficiency of Cox's likelihood function for censored data." Journal of the American statistical 
Association 72(359):557-565.
</p>
<p>Davies R.B. (1980) Algorithm AS 155: The Distribution of a Linear Combination of chi-2 Random Variables, Journal of the Royal 
Statistical Society Series C, 29:323-333
</p>


<h3>Examples</h3>

<pre><code class="language-R">
###################################
# Generate data
library(GUniFrac)


# Throat microbiome data
data(throat.tree)
data(throat.otu.tab)

unifracs = GUniFrac(throat.otu.tab, throat.tree, alpha = c(1))$unifracs
if (requireNamespace("vegan")) {
 library(vegan)
 BC= as.matrix(vegdist(throat.otu.tab, method="bray"))
 Ds = list(w = unifracs[,,"d_1"], uw = unifracs[,,"d_UW"], BC = BC)
} else {
 Ds = list(w = unifracs[,,"d_1"], uw = unifracs[,,"d_UW"])
}

Ks = lapply(Ds, FUN = function(d) D2K(d))

# Covariates and outcomes
covar &lt;- matrix(rnorm(120), nrow=60)
S &lt;- rexp(60, 3)   # survival time 
C &lt;- rexp(60, 1)   # censoring time 
D &lt;- (S&lt;=C)        # event indicator
U &lt;- pmin(S, C)    # observed follow-up time

MiRKATS(obstime = U, delta = D, X = covar, Ks = Ks, beta = NULL)


</code></pre>


</div>