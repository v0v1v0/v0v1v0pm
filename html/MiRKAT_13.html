<div class="container">

<table style="width: 100%;"><tr>
<td>MiRKAT_binary</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Microbiome Regression-Based Kernel Association Test for binary outcomes</h2>

<h3>Description</h3>

<p>Called by MiRKAT if the outcome variable is dichotomous (out_type="D")
</p>
<p>This function is called by the exported function MiRKAT if the argument "out_type" of MiRKAT is equal to "D" (for dichotomous).
</p>
<p>Each argument of MiRKAT_continuous is given the value of the corresponding argument given by the user to MiRKAT.
</p>
<p>Function not exported
</p>


<h3>Usage</h3>

<pre><code class="language-R">MiRKAT_binary(
  y,
  X = NULL,
  Ks,
  method = "davies",
  family = "binomial",
  omnibus = "permutation",
  nperm = 999,
  returnKRV = FALSE,
  returnR2 = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A numeric vector of the dichotomous outcome variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A numerical matrix or data frame, containing additional covariates that you want to adjust for (Default = NULL). If it is 
NULL, a intercept only model was fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ks</code></td>
<td>
<p>A list of n by n kernel matrices (or a single n by n kernel matrix), where n is the sample size. It can be constructed 
from microbiome data through distance metric or other approaches, such as linear kernels or Gaussian kernels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A string telling R which method to use to compute the kernel specific p-value (default = "davies"). "davies" 
represents an exact method that computes the p-value by inverting the characteristic function of the mixture chisq. We adopt an 
exact variance component tests because most of the studies concerning microbiome compositions have modest sample size. "moment" 
represents an approximation method that matches the first two moments. "permutation" represents a permutation approach for 
p-value calculation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>A string describing the error distribution and link function to be used in the linear model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omnibus</code></td>
<td>
<p>A string equal to either "Cauchy" or "permutation" (or nonambiguous abbreviations thereof), specifying whether 
to use the Cauchy combination test or residual permutation to generate the omnibus p-value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nperm</code></td>
<td>
<p>the number of permutations if method = "permutation" or when multiple kernels are considered. if method = "davies" 
or "moment", nperm is ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnKRV</code></td>
<td>
<p>A logical indicating whether to return the KRV statistic. Defaults to FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnR2</code></td>
<td>
<p>A logical indicating whether to return the R-squared coefficient. Defaults to FALSE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If only one candidate kernel matrix is considered, returns a list containing the p-value for the candidate kernel matrix. 
If more than one candidate kernel matrix is considered, returns a list with two elements: the individual p-values for
each candidate kernel matrix, and the omnibus p-value. 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>p_values</code></td>
<td>
<p>p-value for each candidate kernel matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omnibus_p</code></td>
<td>
<p>omnibus p-value if multiple kernel matrices are considered</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>KRV</code></td>
<td>
<p>A vector of kernel RV statistics (a measure of effect size), one for each candidate kernel matrix. Only returned if returnKRV = TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R2</code></td>
<td>
<p>A vector of R-squared statistics, one for each candidate kernel matrix. Only returned if returnR2 = TRUE</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Ni Zhao
</p>


<h3>References</h3>

<p>Zhao, N., Chen, J.,Carroll, I. M., Ringel-Kulka, T., Epstein, M.P., Zhou, H., Zhou, J. J., Ringel, Y., Li, H. and Wu, M.C. (2015)).
Microbiome Regression-based Kernel Association Test (MiRKAT). American Journal of Human Genetics, 96(5):797-807
</p>
<p>Chen, J., Chen, W., Zhao, N., Wu, M~C.and Schaid, D~J. (2016) Small Sample Kernel Association Tests for Human Genetic and 
Microbiome Association Studies. 40: 5-19. doi: 10.1002/gepi.21934
</p>
<p>Davies R.B. (1980) Algorithm AS 155: The Distribution of a Linear Combination of chi-2 Random Variables, Journal of the Royal
Statistical Society. Series C , 29, 323-333.
</p>
<p>Satterthwaite, F. (1946). An approximate distribution of estimates of variance components. Biom. Bull. 2, 110-114.
</p>
<p>Lee S, Emond MJ, Bamshad MJ, Barnes KC, Rieder MJ, Nickerson DA; NHLBI GO Exome Sequencing Project-ESP Lung Project Team, 
Christiani DC, Wurfel MM, Lin X. (2012) Optimal unified approach for rare variant association testing with application to 
small sample case-control whole-exome sequencing studies. American Journal of Human Genetics, 91, 224-237.
</p>
<p>Zhou, J. J. and Zhou, H.(2015) Powerful Exact Variance Component Tests for the Small Sample Next Generation Sequencing Studies 
(eVCTest), in submission.
</p>


</div>