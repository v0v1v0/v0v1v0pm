<div class="container">

<table style="width: 100%;"><tr>
<td>MMiRKAT</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multivariate Microbiome Regression-based Kernel Association Test</h2>

<h3>Description</h3>

<p>Test for association between overall microbiome composition and multiple continuous outcomes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MMiRKAT(Y, X = NULL, Ks, returnKRV = FALSE, returnR2 = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>A numerical n by p matrix of p continuous outcome variables, n being sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A numerical n by q matrix or data frame, containing q additional covariates that you want to adjust for (Default = NULL).
If it is NULL, an intercept only model is fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ks</code></td>
<td>
<p>A list of numerical n by n kernel matrices, or a single n by n kernel matrix, where n is the sample size. Kernels can be 
constructed from distance matrices (such as Bray-Curtis or UniFrac distances) using the function D2K, or through other mathematical approaches.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnKRV</code></td>
<td>
<p>A logical indicating whether to return the KRV statistic. Defaults to FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnR2</code></td>
<td>
<p>A logical indicating whether to return the R-squared coefficient. Defaults to FALSE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Missing data is not permitted. Please remove all individuals with missing Y, X, K prior to analysis
</p>
<p>The method of generating kernel specific p-values is "davies", which represents an exact method that computes the p-value by
inverting the characteristic function of the mixture chisq.
</p>


<h3>Value</h3>

<p>Returns a list of the MMiRKAT p-values for each inputted kernel matrix, labeled with the names of the kernels, if given.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>p_values</code></td>
<td>
<p>list of the p-values for each individual kernel matrix inputted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>KRV</code></td>
<td>
<p>A vector of kernel RV statistics (a measure of effect size), one for each candidate kernel matrix. Only returned if returnKRV = TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R2</code></td>
<td>
<p>A vector of R-squared statistics, one for each candidate kernel matrix. Only returned if returnR2 = TRUE</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Nehemiah Wilson, Haotian Zheng, Xiang Zhan, Ni Zhao
</p>


<h3>References</h3>

<p>Zheng, H., Zhan, X., Tong, X., Zhao, N., Maity,A., Wu, M.C., and Chen,J. A small-sample multivariate kernel machine test for 
microbiome association studies. Genetic Epidemiology, 41(3), 210-220. DOI: 10.1002/gepi.22030
</p>


<h3>Examples</h3>

<pre><code class="language-R"> 
library(GUniFrac)
if(requireNamespace("vegan")) { library(vegan) }

data(throat.tree)
data(throat.otu.tab)
data(throat.meta)

unifracs &lt;- GUniFrac(throat.otu.tab, throat.tree, alpha=c(0, 0.5, 1))$unifracs

if(requireNamespace("vegan")) {
 BC= as.matrix(vegdist(throat.otu.tab , method="bray"))
 Ds = list(w = unifracs[,,"d_1"], u = unifracs[,,"d_UW"], BC = BC) 
} else {
 Ds = list(w = unifracs[,,"d_1"], u = unifracs[,,"d_UW"]) 
}
Ks = lapply(Ds, FUN = function(d) D2K(d)) 

n = nrow(throat.otu.tab)
Y = matrix(rnorm(n*3, 0, 1), n, 3)

covar = cbind(as.numeric(throat.meta$Sex == "Male"), as.numeric(throat.meta$PackYears))
MMiRKAT(Y = Y, X = covar, Ks = Ks) 

</code></pre>


</div>