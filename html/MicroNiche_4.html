<div class="container">

<table style="width: 100%;"><tr>
<td>hurlberts.Bn</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Hurlbert's niche breadth index
</h2>

<h3>Description</h3>

<p>This index is a measurement of niche breadth (Bn) of a taxon in relation to an environmental parameter,
such as pH or temperature. A value of 0 indicates an inverse relationship between taxon 
abundance and the environmental parameter, whilst 1 indicates a positive relationship between
taxon abundance and the environmental parameter. A value of 0.5 indicates no relationship.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hurlberts.Bn(df, R, sampleInfo, envInfo, q = 1.65)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>

<p>A matrix of taxa (rows) by samples (columns) as discrete counts per sample. Col 1 must be
a taxon identifier. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>

<p>The number of different environments being compared.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampleInfo</code></td>
<td>

<p>A categorical variable identifying which samples correspond to which environment.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>envInfo</code></td>
<td>

<p>A quantitative variable of some environmental parameter measured per sample.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>

<p>A coefficient for the LOQ, set to 1.65. Decreasing or increasing q will affect which taxa
are flagged as being below the LOQ.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Taxon inputs must be as discrete counts across samples, with a taxon identifier in column 1. 
This function also performs null model testing against a distribution of Bn generated from 
R random proportions permuted 999 times. This allows the user to perform significance testing 
and to determine a probability that the taxa Bn differs from the null Bn. The output includes 
each taxon's Bn, a P value of significance testing against the null model distribution, and a 
Benjamin-Hochberg adjusted P value to account for false discovery rate. 
</p>
<p>A plot of the null distribution with 0.05 and 0.95 quantiles highlighted as red dotted lines 
is also provided. 
</p>
<p>Finally, this function also calculates the limit of quantification (LOQ) to identify taxa 
whose niche cannot be confidently measured. A plot of log abundance x taxon rank is provided
to visualise the distribution of the data, a fitted lognormal taxa rank model, and the 
LOQ determined based on the standard deviation of the lognormal model. 
</p>
<p>Hurlbert's niche breadth is calculated as follows:
Bn[j] = 1/sum(p[i]^2/r[i]) 
whereby p[i] is the proportion of taxon j in environment i and r[i] is the proportion of the
environmental parameter in i.
</p>
<p>This function depends on ggplot2 to generate a plot of the null distribution and reshape2
to identify the taxa below the LOQ.
</p>


<h3>Value</h3>

<p>An object of class "data.frame" that gives the Bn, P value and adjusted P value for each taxon.
A column noting taxa that fall below the LOQ are identified as T.
</p>


<h3>Note</h3>

<p>The null model testing becomes increasingly robust with increasing R. If R == 2 the results
should be interpreted with caution. 
</p>


<h3>Author(s)</h3>

<p>Damien Finn
</p>


<h3>References</h3>

<p>Feinsinger et al. 1981. A simple measure of niche breadth. Ecology 62(1):27-32
</p>


<h3>See Also</h3>

<p>feinsingers.PS
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(df)
sampleInfo &lt;- c(rep("R1",10), rep("R2",10), rep("R3",10), rep("R4",10))
pH.grad &lt;- c(2.1, 2.2, 2, 1.9, 2.1, 1.8, 1.9, 2, 2.1, 1.9, 3.5, 3.6, 3.5, 
             3.4, 3.6, 3.5, 3.5, 3.4, 3.7, 3.4, 6.6, 6.5, 6.4, 6.8, 7, 6.6, 
             6.8, 6.9, 7, 7.1, 8, 8.2, 7.9, 8.1, 7.8, 7.9, 8.3, 8.2, 8.1, 7.9) 
res &lt;- hurlberts.Bn(df, 4, sampleInfo, pH.grad)
</code></pre>


</div>