<div class="container">

<table style="width: 100%;"><tr>
<td>levins.Bn</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Levins' niche breadth index
</h2>

<h3>Description</h3>

<p>This index is a measurement of niche breadth (Bn) of a taxon weighted by the number of differing
environments (R), whereby a value of 1 indicates generalist taxa that are equally abundant
across environments, and 0 indicates specialist taxa that favour specific environments.
</p>


<h3>Usage</h3>

<pre><code class="language-R">levins.Bn(df, R, sampleInfo, q = 1.65)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>

<p>A matrix of taxa (rows) by samples (columns) as discrete counts per sample. Col 1 must be
a taxon identifier.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>

<p>The number of different environments being compared.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampleInfo</code></td>
<td>

<p>A categorical variable identifying which samples correspond to which environment.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>

<p>A coefficient for the LOQ, set to 1.65. Decreasing or increasing q will affect which taxa
are flagged as being below the LOQ.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Taxon inputs must be as discrete counts across samples, with a taxon identifier in column 1.  
This function also performs null model testing against a distribution of Bn generated from 
R random proportions permuted 999 times. This allows the user to perform significance testing 
and to determine a probability that the taxa Bn differs from the null Bn. The output includes 
each taxon's Bn, a P value of significance testing against the null model distribution, and a 
Benjamin-Hochberg adjusted P value to account for false discovery rate. 
</p>
<p>A plot of the null distribution with 0.05 and 0.95 quantiles highlighted as red dotted lines 
is also provided. 
</p>
<p>Finally, this function also calculates the limit of quantification (LOQ) to identify taxa 
whose niche cannot be confidently measured. A plot of log abundance x taxon rank is provided
to visualise the distribution of the data, a fitted lognormal taxa rank model, and the 
LOQ determined based on the standard deviation of the lognormal model. 
</p>
<p>Levin's niche breadth is calculated as follows:
Bn[j] = (1/R)/sum(p[i]^2) 
whereby R is the number of differing environments and p[i] is the proportion of taxon j in
environment i. 
</p>
<p>This function depends on ggplot2 to generate a plot of the null distribution and reshape2
to identify the taxa below the LOQ.
</p>


<h3>Value</h3>

<p>An object of class "data.frame" that gives the Bn, P value and adjusted P value for each taxon.
A column noting taxa that fall below the LOQ are identified as T.
</p>


<h3>Note</h3>

<p>The null model testing becomes increasingly robust with increasing R. If R == 2 the results
should be interpreted with caution. 
</p>


<h3>Author(s)</h3>

<p>Damien Finn
</p>


<h3>References</h3>

<p>Feinsinger et al. 1981. A simple measure of niche breadth. Ecology 62(1):27-32
</p>


<h3>See Also</h3>

<p>levins.overlap
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(df)
sampleInfo &lt;- c(rep("R1",10), rep("R2",10), rep("R3",10), rep("R4",10))
res &lt;- levins.Bn(df, 4, sampleInfo)
</code></pre>


</div>