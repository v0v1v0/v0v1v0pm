<div class="container">

<table style="width: 100%;"><tr>
<td>linda.plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot LinDA Results</h2>

<h3>Description</h3>

<p>The function produces the effect size plot of the differential features and volcano plot based on the output from <code>linda</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">linda.plot(
  linda.obj,
  variables.plot,
  titles = NULL,
  alpha = 0.05,
  lfc.cut = 1,
  legend = FALSE,
  directory = NULL,
  width = 11,
  height = 8
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>linda.obj</code></td>
<td>
<p>return from function <code>linda</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variables.plot</code></td>
<td>
<p>vector; variables whose results are to be plotted. For example, suppose the return
value <code>variables</code> is equal to <code>('x1', 'x2', 'x3b', 'x3c', 'x1:x2')</code>, then one could set <code>variables.plot = c('x3b', 'x1:x2')</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>titles</code></td>
<td>
<p>vector; titles of the effect size plot and volcano plot for each variable in <code>variables.plot</code>.
Default is NULL. If NULL, the titles will be set as <code>variables.plot</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>a numerical value between 0 and 1; cutoff for <code>padj</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lfc.cut</code></td>
<td>
<p>a positive numerical value; cutoff for <code>log2FoldChange</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>TRUE or FALSE; whether to show the legends of the effect size plot and volcano plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>directory</code></td>
<td>
<p>character; the directory to save the figures, e.g., <code>getwd()</code>. Default is NULL. If NULL, figures will not be saved.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>the width of the graphics region in inches. See R function <code>pdf</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>height</code></td>
<td>
<p>the height of the graphics region in inches. See R function <code>pdf</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of <code>ggplot2</code> objects.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>plot.lfc</code></td>
<td>
<p>a list of effect size plots. Each plot corresponds to one variable in <code>variables.plot</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.volcano</code></td>
<td>
<p>a list of volcano plots. Each plot corresponds to one variable in <code>variables.plot</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Huijuan Zhou,
Jun Chen,
Xianyang Zhang
</p>


<h3>References</h3>

<p>Zhou, H., He, K., Chen, J., Zhang, X. (2022). LinDA: linear models for differential abundance analysis of microbiome compositional data. Genome biology, 23(1), 95.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(smokers)
ind &lt;- smokers$meta$AIRWAYSITE == 'Throat' &amp; smokers$meta$SIDEOFBODY == 'Left'
otu.tab &lt;- as.data.frame(smokers$otu[, ind])
depth &lt;- colSums(otu.tab)
meta &lt;- cbind.data.frame(Smoke = factor(smokers$meta$SMOKER[ind]),
                         Sex = factor(smokers$meta$SEX[ind]))
                         
ind  &lt;- depth &gt;= 1000
linda.obj &lt;- linda(otu.tab[, ind], meta[ind, ], formula = '~Smoke+Sex',
           feature.dat.type = 'count', 
           prev.filter = 0.1, is.winsor = TRUE, outlier.pct = 0.03,
           p.adj.method = "BH", alpha = 0.1)
           
linda.plot(linda.obj, c('Smokey', 'Sexmale'),
           titles = c('Smoke: n v.s. y', 'Sex: female v.s. male'), 
           alpha = 0.1, lfc.cut = 1, legend = TRUE, directory = NULL,
            width = 11, height = 8)
</code></pre>


</div>