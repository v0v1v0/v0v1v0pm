<div class="container">

<table style="width: 100%;"><tr>
<td>linda.wald.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Wald test for bias-corrected regression coefficients</h2>

<h3>Description</h3>

<p>The function implements Wald test for bias-corrected regression coefficients generated from the <code>linda</code> function.
One can utilize the function to perform ANOVA-type analyses. For example, if you have a cateogrical variable with three levels, you can test whether all levels have the same effect.
</p>


<h3>Usage</h3>

<pre><code class="language-R">linda.wald.test(
  linda.obj,
  L,
  model = c("LM", "LMM"),
  alpha = 0.05,
  p.adj.method = "BH"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>linda.obj</code></td>
<td>
<p>return from the <code>linda</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>A matrix for testing <code>Lb = 0</code>, where <code>b</code> includes the intercept and all fixed effects from runing <code>linda</code>. Thus the number of columns of L must be equal to <code>length(variables)+1</code>, where <code>variables</code> is from <code>linda.obj</code>, which does not include the intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p><code>'LM'</code> or <code>'LMM'</code> indicating the model fitted in {linda} is linear model or linear mixed-effect model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>significance level for testing <code>Lb = 0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.adj.method</code></td>
<td>
<p>P-value adjustment approach. See R function <code>p.adjust</code>. The default is 'BH'.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data frame with columns
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Fstat</code></td>
<td>
<p>Wald statistics for each taxon</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df1</code></td>
<td>
<p>The numerator degrees of freedom</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df2</code></td>
<td>
<p>The denominator degrees of freedom</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalue</code></td>
<td>
 <p><code>1 - pf(Fstat, df1, df2)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>padj</code></td>
<td>
 <p><code>p.adjust(pvalue, method = p.adj.method)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reject</code></td>
<td>
 <p><code>padj &lt;= alpha</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Huijuan Zhou <a href="mailto:huijuanzhou2019@gmail.com">huijuanzhou2019@gmail.com</a>
Jun Chen <a href="mailto:Chen.Jun2@mayo.edu">Chen.Jun2@mayo.edu</a>
Xianyang Zhang <a href="mailto:zhangxiany@stat.tamu.edu">zhangxiany@stat.tamu.edu</a>
</p>


<h3>References</h3>

<p>Zhou, H., He, K., Chen, J., Zhang, X. (2022). LinDA: linear models for differential abundance analysis of microbiome compositional data. Genome biology, 23(1), 95.
</p>


<h3>Examples</h3>

<pre><code class="language-R">

data(smokers)

ind &lt;- smokers$meta$AIRWAYSITE == 'Throat'
otu.tab &lt;- as.data.frame(smokers$otu[, ind])
depth &lt;- colSums(otu.tab)
meta &lt;- cbind.data.frame(Smoke = factor(smokers$meta$SMOKER[ind]),
                         Sex = factor(smokers$meta$SEX[ind]),
                         Site = factor(smokers$meta$SIDEOFBODY[ind]),
                         SubjectID = factor(smokers$meta$HOST_SUBJECT_ID[ind]))
ind  &lt;- depth &gt;= 1000
linda.obj &lt;- linda(otu.tab[, ind], meta[ind, ], formula = '~Smoke+Sex+(1|SubjectID)',
           feature.dat.type = 'count', 
           prev.filter = 0.1, is.winsor = TRUE, outlier.pct = 0.03,
           p.adj.method = "BH", alpha = 0.1)
#  L matrix (2x3) is designed to test the second (Smoke) and the third (Sex) coefficient to be 0.
# For a categorical variable &gt; two levels, similar L can be designed to do ANOVA-type test. 
L &lt;- matrix(c(0, 1, 0, 0, 0, 1), nrow = 2, byrow = TRUE)
result &lt;- linda.wald.test(linda.obj, L, 'LMM', alpha = 0.1)


</code></pre>


</div>