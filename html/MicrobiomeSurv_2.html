<div class="container">

<table style="width: 100%;"><tr>
<td>CVLasoelascox</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cross Validations for Lasso Elastic Net Survival predictive models and Classification</h2>

<h3>Description</h3>

<p>The function does cross validation for Lasso, Elastic net and Ridge regressions models before the survial analysis and classification.
The survival analysis is based on the selected taxa in the presence or absence of prognostic factors.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CVLasoelascox(
  Survival,
  Censor,
  Micro.mat,
  Prognostic,
  Standardize = TRUE,
  Alpha = 1,
  Fold = 4,
  Ncv = 10,
  nlambda = 100,
  Mean = TRUE,
  Quantile = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Survival</code></td>
<td>
<p>A vector of survival time with length equals to number of subjects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Censor</code></td>
<td>
<p>A vector of censoring indicator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Micro.mat</code></td>
<td>
<p>A large or small microbiome profile matrix. A matrix with microbiome profiles where the number of rows is equal to the number of taxa and number of columns is equal to number of patients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Prognostic</code></td>
<td>
<p>A dataframe containing possible prognostic(s) factor and/or treatment effect to be used in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Standardize</code></td>
<td>
<p>A Logical flag for the standardization of the microbiome matrix, prior to fitting the model sequence. The coefficients are always returned on the original scale. Default is standardize=TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Alpha</code></td>
<td>
<p>The mixing parameter for glmnet (see <code>glmnet</code>). The range is 0&lt;= Alpha &lt;= 1. The Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Fold</code></td>
<td>
<p>Number of folds to be used for the cross validation. Its value ranges between 3 and the number of subjects in the dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ncv</code></td>
<td>
<p>Number of validations to be carried out. The default is 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlambda</code></td>
<td>
<p>The number of lambda values - default is 100 as in glmnet.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mean</code></td>
<td>
<p>The cut off value for the classifier, default is the mean cutoff.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Quantile</code></td>
<td>
<p>If users want to use quantile as cutoff point. They need to specify Mean = FALSE and a quantile that they wish to use. The default is the median cutoff.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function performs the cross validations for Lasso, Elastic net and Ridge regressions models for Cox proportional hazard model.
Taxa are selected at each iteration and then use for the classifier.
Which implies that predictive taxa is varied from one cross validation to the other depending on selection.
The underline idea is to investigate the Hazard Ratio for the train and test data based on the optimal lambda selected for the non-zero shrinkage coefficients, the nonzero selected taxa will thus be used in the survival analysis and in calculation of the risk scores for each sets of data.
</p>


<h3>Value</h3>

<p>A object of class <code>cvle</code> is returned with the following values
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Coef.mat</code></td>
<td>
<p>A matrix of coefficients with rows equals to number of cross validations and columns equals to number of taxa.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>A vector of estimated optimum lambda for each iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>A vector of the number of selected taxa.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HRTrain</code></td>
<td>
<p>A matrix of survival information for the training dataset. It has three columns representing the estimated HR, the 95% lower confidence interval and the 95% upper confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HRTest</code></td>
<td>
<p>A matrix of survival information for the test dataset. It has three columns representing the estimated HR, the 95% lower confidence interval and the 95% upper confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pld</code></td>
<td>
<p>A vector of partial likelihood deviance at each cross validations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mi.mat</code></td>
<td>
<p>A matrix with 0 and 1. Number of rows equals to number of iterations and number of columns equals to number of 1 taxon indicates that the particular taxon was selected or had nonzero coefficient and otherwise it is zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Micro.mat</code></td>
<td>
<p>The Microbiome data matrix that was used for the analysis either same as Mdata or a reduced version.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Thi Huyen Nguyen, <a href="mailto:thihuyen.nguyen@uhasselt.be">thihuyen.nguyen@uhasselt.be</a>
</p>
<p>Olajumoke Evangelina Owokotomo, <a href="mailto:olajumoke.x.owokotomo@gsk.com">olajumoke.x.owokotomo@gsk.com</a>
</p>
<p>Ziv Shkedy
</p>


<h3>See Also</h3>

<p><code>coxph</code>, <code>EstimateHR</code>, <code>glmnet</code>, <code>Lasoelascox</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Prepare data
data(Week3_response)
Week3_response = data.frame(Week3_response)
surv_fam_shan_w3 = data.frame(cbind(as.numeric(Week3_response$T1Dweek),
as.numeric(Week3_response$T1D)))
colnames(surv_fam_shan_w3) = c("Survival", "Censor")
prog_fam_shan_w3 = data.frame(factor(Week3_response$Treatment_new))
colnames(prog_fam_shan_w3) = c("Treatment")
data(fam_shan_trim_w3)
names_fam_shan_trim_w3 =
c("Unknown", "Lachnospiraceae", "S24.7", "Lactobacillaceae", "Enterobacteriaceae", "Rikenellaceae")
fam_shan_trim_w3 = data.matrix(fam_shan_trim_w3[ ,2:82])
rownames(fam_shan_trim_w3) = names_fam_shan_trim_w3

# Using the function
CV_lasso_fam_shan_w3 = CVLasoelascox(Survival = surv_fam_shan_w3$Survival,
                                     Censor = surv_fam_shan_w3$Censor,
                                     Micro.mat = fam_shan_trim_w3,
                                     Prognostic = prog_fam_shan_w3,
                                     Standardize = TRUE,
                                     Alpha = 1,
                                     Fold = 4,
                                     Ncv = 10,
                                     nlambda = 100)

# Number of selected taxa per CV
CV_lasso_fam_shan_w3@n

# Get the matrix of coefficients
CV_lasso_fam_shan_w3@Coef.mat

# Survival information of the train dataset
CV_lasso_fam_shan_w3@HRTrain

# Survival information of the test dataset
CV_lasso_fam_shan_w3@HRTest
</code></pre>


</div>