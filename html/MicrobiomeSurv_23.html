<div class="container">

<table style="width: 100%;"><tr>
<td>DistHR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Null Distribution of the Estimated HR</h2>

<h3>Description</h3>

<p>This function generates the null distribution of the HR by permutation approach either using a large microbiome matrix or a reduced version by supervised pca approach.
Several ways of permutation setting can be implemented.
That is, the function can be used to generate null distributions for four different validation schemes which are PLS based, PCA based, Majority votes based and Lasso based.
Note this function internally calls function  <code>SurvPcaClass</code>, <code>SurvPlsClass</code>, <code>Majorityvotes</code>, and <code>Lasoelascox</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">DistHR(
  Survival,
  Censor,
  Micro.mat,
  Prognostic = NULL,
  Mean = TRUE,
  Quantile = 0.5,
  Reduce = FALSE,
  Select = 5,
  nperm = 100,
  case = 2,
  Method = "BH",
  Validation = c("PLSbased", "PCAbased", "L1based", "MVbased")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Survival</code></td>
<td>
<p>A vector of survival time with length equals to number of subjects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Censor</code></td>
<td>
<p>A vector of censoring indicator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Micro.mat</code></td>
<td>
<p>A large or small microbiome profile matrix. A matrix with microbiome profiles where the number of rows should be equal to the number of taxa and number of columns should be equal to number of patients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Prognostic</code></td>
<td>
<p>A dataframe containing possible prognostic(s) factor and/or treatment effect to be used in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mean</code></td>
<td>
<p>The cut off value for the classifier, default is the mean cutoff.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Quantile</code></td>
<td>
<p>If user want to use quantile as cutoff point. They need to specify Mean = FALSE and a quantile that they want to use. The default is the median cutoff.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Reduce</code></td>
<td>
<p>A boolean parameter indicating if the microbiome profile matrix should be reduced, default is TRUE and larger microbiome profile matrix is reduced by supervised pca approach and first pca is extracted from the reduced matrix to be used in the classifier.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Select</code></td>
<td>
<p>Number of taxa (default is 5) to be selected from supervised PCA. This is valid only if the argument Reduce=TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nperm</code></td>
<td>
<p>Number of permutations to be used and default 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>case</code></td>
<td>
<p>There are seven different ways on how to call this argument:
</p>

<ol>
<li>
<p>Permute survival only.
</p>
</li>
<li>
<p>Permute survival and rows of data frame of the prognostic factors.
</p>
</li>
<li>
<p>Permute survival, rows of data frame of the prognostic factors, columns of microbiome matrix independently.
</p>
</li>
<li>
<p>Permute microbiome matrix only.
</p>
</li>
</ol>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Method</code></td>
<td>
<p>A multiplicity adjustment Method that user can choose. The default is BH Method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Validation</code></td>
<td>
<p>There are four different validation schemes where the null distribution can be estimated. That is c("PLSbased","PCAbased","L1based","MVbased").</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A object of class <code>perm</code> is returned with the following values
</p>
<table>
<tr style="vertical-align: top;">
<td><code>HRobs</code></td>
<td>
<p>Estimated HR for low risk group on the original data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HRperm</code></td>
<td>
<p>Estimated HR for low risk group on the permuted data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nperm</code></td>
<td>
<p>Number of permutations carried out.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Validation</code></td>
<td>
<p>The validation scheme that was used.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Thi Huyen Nguyen, <a href="mailto:thihuyen.nguyen@uhasselt.be">thihuyen.nguyen@uhasselt.be</a>
</p>
<p>Olajumoke Evangelina Owokotomo, <a href="mailto:olajumoke.x.owokotomo@gsk.com">olajumoke.x.owokotomo@gsk.com</a>
</p>
<p>Ziv Shkedy
</p>


<h3>See Also</h3>

<p><code>coxph</code>, <code>EstimateHR</code>, <code>SurvPcaClass</code>, <code>SurvPlsClass</code>, <code>Majorityvotes</code>, <code>Lasoelascox</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Prepare data
data(Week3_response)
Week3_response = data.frame(Week3_response)
surv_fam_shan_w3 = data.frame(cbind(as.numeric(Week3_response$T1Dweek),
as.numeric(Week3_response$T1D)))
colnames(surv_fam_shan_w3) = c("Survival", "Censor")
prog_fam_shan_w3 = data.frame(factor(Week3_response$Treatment_new))
colnames(prog_fam_shan_w3) = c("Treatment")
data(fam_shan_trim_w3)
names_fam_shan_trim_w3 =
c("Unknown", "Lachnospiraceae", "S24.7", "Lactobacillaceae", "Enterobacteriaceae", "Rikenellaceae")
fam_shan_trim_w3 = data.matrix(fam_shan_trim_w3[ ,2:82])
rownames(fam_shan_trim_w3) = names_fam_shan_trim_w3
# Using the function
DistHR_fam_shan_w3 = DistHR(Survival = surv_fam_shan_w3$Survival,
                            Micro.mat = fam_shan_trim_w3,
                            Censor = surv_fam_shan_w3$Censor,
                            Prognostic=prog_fam_shan_w3,
                            Mean = TRUE,
                            Quantile=0.5,
                            Reduce= FALSE,
                            Select = 5,
                            nperm=100,
                            case=4,
                            Method = "BH",
                            Validation="PCAbased")

# Method that can be used for the result
show(DistHR_fam_shan_w3)
summary(DistHR_fam_shan_w3)
plot(DistHR_fam_shan_w3)

</code></pre>


</div>