<div class="container">

<table style="width: 100%;"><tr>
<td>Lasoelascox</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Wapper function for glmnet</h2>

<h3>Description</h3>

<p>The function uses the glmnet function to firstly do the variable selection either with Lasso, Elastic net or ridge regressions before the survial analysis.
The survival analysis is based on the selected taxa in the presence or absence of prognostic factors.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Lasoelascox(
  Survival,
  Censor,
  Micro.mat,
  Prognostic,
  Plots = FALSE,
  Standardize = TRUE,
  Alpha = 1,
  Fold = 4,
  nlambda = 100,
  Mean = TRUE,
  Quantile = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Survival</code></td>
<td>
<p>A vector of survival time with length equals to number of subjects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Censor</code></td>
<td>
<p>A vector of censoring indicator</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Micro.mat</code></td>
<td>
<p>A large or small microbiome matrix. A matrix with microbiome profiles where the number of rows is equal to the number of taxa and number of columns is equal to number of patients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Prognostic</code></td>
<td>
<p>A dataframe containing possible prognostic(s) factor and/or treatment effect to be used in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Plots</code></td>
<td>
<p>A boolean parameter indicating if plots should be shown. Default is FALSE. If TRUE, the first plot is the partial likelihood deviance against the logarithmn of each lambda while the second is the coefficients versus the lambdas</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Standardize</code></td>
<td>
<p>A Logical flag for the standardization of the microbiome matrix, prior to fitting the model sequence. The coefficients are always returned on the original scale. Default is standardize=TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Alpha</code></td>
<td>
<p>The mixing parameter for glmnet (see <code>glmnet</code>). The range is 0&lt;= Alpha &lt;= 1. The Default is 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Fold</code></td>
<td>
<p>number of folds to be used for the cross validation. Its value ranges between 3 and the number of subjects in the dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlambda</code></td>
<td>
<p>The number of lambda values - default is 100 as in glmnet.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mean</code></td>
<td>
<p>The cut off value for the classifier, default is the mean cutoff</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Quantile</code></td>
<td>
<p>If user want to use quantile as cutoff point. They need to specify Mean = FALSE and a quantile that they want to use. The default is the median cutoff</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is a wrapper function for glmnet and it fits models using either Lasso, Elastic net and Ridge regressions.
This is done in the presence or absence of prognostic factors.
The prognostic factor when available will always be forced to be in the model so no penalty for it.
Optimum lambda will be used to select the non-zero shrinkage coefficients, the nonzero selceted taxa will thus be used in the survival analysis and in calculation of the risk scores.
</p>


<h3>Value</h3>

<p>A object is returned with the following values
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Coefficients.NonZero</code></td>
<td>
<p>The coefficients of the selected taxa</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Selected.Mi</code></td>
<td>
<p>The selected taxa</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The number of selected taxa</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Risk.scores</code></td>
<td>
<p>The risk scores of the subjects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Risk.group</code></td>
<td>
<p>The risk classification of the subjects based on the specified cutoff point</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SurvFit</code></td>
<td>
<p>The cox analysis of the riskgroup based on the selected taxa and the prognostic factors</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Thi Huyen Nguyen, <a href="mailto:thihuyen.nguyen@uhasselt.be">thihuyen.nguyen@uhasselt.be</a>
</p>
<p>Olajumoke Evangelina Owokotomo, <a href="mailto:olajumoke.x.owokotomo@gsk.com">olajumoke.x.owokotomo@gsk.com</a>
</p>
<p>Ziv Shkedy
</p>


<h3>See Also</h3>

<p><code>coxph</code>
</p>
<p><code>coxph</code>,
<code>EstimateHR</code>,
<code>glmnet</code>,
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Prepare data
data(Week3_response)
Week3_response = data.frame(Week3_response)
surv_fam_shan_w3 = data.frame(cbind(as.numeric(Week3_response$T1Dweek),
as.numeric(Week3_response$T1D)))
colnames(surv_fam_shan_w3) = c("Survival", "Censor")
prog_fam_shan_w3 = data.frame(factor(Week3_response$Treatment_new))
colnames(prog_fam_shan_w3) = c("Treatment")
data(fam_shan_trim_w3)
names_fam_shan_trim_w3 =
c("Unknown", "Lachnospiraceae", "S24.7", "Lactobacillaceae", "Enterobacteriaceae", "Rikenellaceae")
fam_shan_trim_w3 = data.matrix(fam_shan_trim_w3[ ,2:82])
rownames(fam_shan_trim_w3) = names_fam_shan_trim_w3
# Using the function
lasso_fam_shan_w3 = Lasoelascox(Survival = surv_fam_shan_w3$Survival,
                                Censor = surv_fam_shan_w3$Censor,
                                Micro.mat = fam_shan_trim_w3,
                                Prognostic = prog_fam_shan_w3,
                                Plots = TRUE,
                                Standardize = TRUE,
                                Alpha = 1,
                                Fold = 4,
                                nlambda = 100,
                                Mean = TRUE)

# View the selected taxa
lasso_fam_shan_w3$Selected.mi

# Number of selected taxa
lasso_fam_shan_w3$n

# View the classification group of each subject
lasso_fam_shan_w3$Risk.Group

# View the survival analysis result
lasso_fam_shan_w3$SurvFit
</code></pre>


</div>