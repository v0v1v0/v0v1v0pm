<div class="container">

<table style="width: 100%;"><tr>
<td>SecondFilter</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>This function is used for the second step of filtering which removes OTUs based on a threshold.</h2>

<h3>Description</h3>

<p>This function is used for the second step of filtering which removes OTUs based on a threshold.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SecondFilter(zero.per.group, Micro.mat, threshold = 0.7, week = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>zero.per.group</code></td>
<td>
<p>a n x 9 matrix. Columns are number of zero in control groups, proportion of zeros in control group,
number of subject in control group, number of zero in treated groups, proportion of zeros in treated group,
number of subject in treated group, total number of zeros, proportion of zeros in total, number of subject</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Micro.mat</code></td>
<td>
<p>OTU matrix (rows are otus, columns are subjects)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>user can choose. For instance, if threshold is 0.7, the function will remove OTUs having at least 70% of zeros in one of two groups</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>week</code></td>
<td>
<p>A specific time point. To use when having different time points in the dataset.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A smaller microbiome matrix.
</p>
<table><tr style="vertical-align: top;">
<td><code>Micro.mat.new</code></td>
<td>
<p>an smaller OTU matrix with less OTUs</p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>Thi Huyen Nguyen, <a href="mailto:thihuyen.nguyen@uhasselt.be">thihuyen.nguyen@uhasselt.be</a>
</p>
<p>Olajumoke Evangelina Owokotomo, <a href="mailto:olajumoke.x.owokotomo@gsk.com">olajumoke.x.owokotomo@gsk.com</a>
</p>
<p>Ziv Shkedy
</p>


<h3>See Also</h3>

<p><code>SecondFilter</code>
</p>
<p><code>SecondFilter</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Read dataset
data(Week3_otu)
Week3_otu = data.frame(Week3_otu)
otu_mat_w3 = t(data.matrix(Week3_otu[ , 1:2720]))

# Import dataset from the result of zero_per_group
data(data_zero_per_group_otu_w3)

# Using the function
otu_trim_w3 = SecondFilter(zero.per.group = data_zero_per_group_otu_w3,
                           Micro.mat = otu_mat_w3, threshold = 0.7, week = 3)
</code></pre>


</div>