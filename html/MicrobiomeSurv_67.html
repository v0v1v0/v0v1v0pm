<div class="container">

<table style="width: 100%;"><tr>
<td>SurvPlsClass</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Survival PLS and Classification for microbiome data</h2>

<h3>Description</h3>

<p>The function performs partial least squares (PLS) and principal component regression on microbiome matrix and fit Cox proportional hazard model with covariates using the first PLS scores as covariates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SurvPlsClass(
  Survival,
  Micro.mat,
  Censor,
  Reduce = TRUE,
  Select = 150,
  Prognostic = NULL,
  Plots = FALSE,
  Mean = TRUE,
  Quantile = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Survival</code></td>
<td>
<p>A vector of survival time with length equals to number of subjects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Micro.mat</code></td>
<td>
<p>A large or small microbiome profile matrix. A matrix with microbiome profiles where the number of rows should be equal to the number of taxa and number of columns should be equal to number of patients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Censor</code></td>
<td>
<p>A vector of censoring indicator</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Reduce</code></td>
<td>
<p>A boolean parameter indicating if the microbiome profile matrix should be reduced, default is TRUE and larger microbiome profile matrix is reduced by supervised pca approach and first pca is extracted from the reduced matrix to be used in the classifier.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Select</code></td>
<td>
<p>Number of  taxa (default is 5) to be selected from supervised PCA. This is valid only if the argument Reduce=TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Prognostic</code></td>
<td>
<p>A dataframe containing possible prognostic(s) factor and/or treatment effect to be used in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Plots</code></td>
<td>
<p>A boolean parameter indicating if the plots should be shown. Default is FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mean</code></td>
<td>
<p>The cut off value for the classifier, default is the mean cutoff</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Quantile</code></td>
<td>
<p>If user want to use quantile as cutoff point. They need to specify Mean = FALSE and a quantile that they want to use. The default is the median cutoff</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function reduces larger microbiome matrix to smaller version using supervised pca approach.
The function performs the PLS on the reduced microbiome matrix and fit Cox proportional hazard model with first PLS scores as a covariate afterwards.
And classifier is then built based on the first PLS scores multiplied by its estimated regression coefficient.
Patients are classified using mean of the risk scores as default. However, user can choose any quantile.
This function can handle single and multiple taxa. Prognostic factors can also be included to enhance classification.
</p>


<h3>Value</h3>

<p>A object is returned with the following values
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Survfit</code></td>
<td>
<p>The cox proportional regression result using the first PCA</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Riskscores</code></td>
<td>
<p>A vector of risk scores which is equal to the number of patents.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Riskgroup</code></td>
<td>
<p>The classification of the subjects based on the PCA into low or high risk group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pc1</code></td>
<td>
<p>The First PCA scores based on either the reduced Metabolite matrix or the full matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>KMplot</code></td>
<td>
<p>The Kaplan-Meier survival plot of the riskgroup</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SurvBPlot</code></td>
<td>
<p>The distribution of the survival in the riskgroup</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Riskpls</code></td>
<td>
<p>The plot of  Risk scores vs first PLS</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Thi Huyen Nguyen, <a href="mailto:thihuyen.nguyen@uhasselt.be">thihuyen.nguyen@uhasselt.be</a>
</p>
<p>Olajumoke Evangelina Owokotomo, <a href="mailto:olajumoke.x.owokotomo@gsk.com">olajumoke.x.owokotomo@gsk.com</a>
</p>
<p>Ziv Shkedy
</p>


<h3>See Also</h3>

<p><code>coxph</code>,
<code>EstimateHR</code>, <code>plsr</code>,
<code>SurvPcaClass</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Prepare data
data(Week3_response)
Week3_response = data.frame(Week3_response)
surv_fam_shan_w3 = data.frame(cbind(as.numeric(Week3_response$T1Dweek),
as.numeric(Week3_response$T1D)))
colnames(surv_fam_shan_w3) = c("Survival", "Censor")
prog_fam_shan_w3 = data.frame(factor(Week3_response$Treatment_new))
colnames(prog_fam_shan_w3) = c("Treatment")
data(fam_shan_trim_w3)
names_fam_shan_trim_w3 =
c("Unknown", "Lachnospiraceae", "S24.7", "Lactobacillaceae", "Enterobacteriaceae", "Rikenellaceae")
fam_shan_trim_w3 = data.matrix(fam_shan_trim_w3[ ,2:82])
rownames(fam_shan_trim_w3) = names_fam_shan_trim_w3
# Using the function
SPLS_fam_shan_w3 = SurvPlsClass(Survival = surv_fam_shan_w3$Survival,
                                Micro.mat = fam_shan_trim_w3,
                                Censor = surv_fam_shan_w3$Censor,
                                Reduce=TRUE,
                                Select=5,
                                Prognostic = prog_fam_shan_w3,
                                Plots = TRUE,
                                Mean = TRUE)

# Getting the survival regression output
SPLS_fam_shan_w3$SurvFit

# Getting the riskscores
SPLS_fam_shan_w3$Riskscores

# Getting the riskgroup
SPLS_fam_shan_w3$Riskgroup

# Obtaining the first principal component scores
SPLS_fam_shan_w3$pc1
</code></pre>


</div>