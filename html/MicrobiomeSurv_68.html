<div class="container">

<table style="width: 100%;"><tr>
<td>Top1Uni</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>This function finds out the taxon has the smallest p-value, then calculate risk score of patients based on that taxon.
Categorized subjects into high or low risk groups based on the mean of the risk score as a cutoff point
Checking whether the two groups are significant difference in the probability to be survival.</h2>

<h3>Description</h3>

<p>This function finds out the taxon has the smallest p-value, then calculate risk score of patients based on that taxon.
Categorized subjects into high or low risk groups based on the mean of the risk score as a cutoff point
Checking whether the two groups are significant difference in the probability to be survival.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Top1Uni(Result, Micro.mat, Survival, Censor, Plots = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Result</code></td>
<td>
<p>A Result statistic of all taxon.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Micro.mat</code></td>
<td>
<p>A large or small microbiome matrix. A matrix with microbiome profiles where the number of rows should be equal to the number of taxa and number of columns should be equal to number of patients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Survival</code></td>
<td>
<p>Survival A vector of survival time with length equals to number of subjects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Censor</code></td>
<td>
<p>A vector of censoring indicator</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Plots</code></td>
<td>
<p>A boolean parameter indicating if plots should be shown. Default is FALSE. If TRUE, the first plot is plot of the observed Kaplan-Meier curves per group while the second is boxplot of the two groups.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list is returned with the following values
</p>
<table>
<tr style="vertical-align: top;">
<td><code>name.top1</code></td>
<td>
<p>Taxon having the smallest p-value in the univariate coxPH model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sum.top1</code></td>
<td>
<p>Result statistic of the taxon containing coefficient, exponential of coefficient, raw p.value using LRT, and p.value after using BH adjustment</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>KMplot.top1</code></td>
<td>
<p>Kaplan-Meier plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.rank.top1</code></td>
<td>
<p>Log-rank test</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Thi Huyen Nguyen, <a href="mailto:thihuyen.nguyen@uhasselt.be">thihuyen.nguyen@uhasselt.be</a>
</p>
<p>Olajumoke Evangelina Owokotomo, <a href="mailto:olajumoke.x.owokotomo@gsk.com">olajumoke.x.owokotomo@gsk.com</a>
</p>
<p>Ziv Shkedy
<code>Top1Uni</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Prepare data
data(Week3_response)
Week3_response = data.frame(Week3_response)
surv_fam_shan_w3 = data.frame(cbind(as.numeric(Week3_response$T1Dweek),
as.numeric(Week3_response$T1D)))
colnames(surv_fam_shan_w3) = c("Survival", "Censor")
prog_fam_shan_w3 = data.frame(factor(Week3_response$Treatment_new))
colnames(prog_fam_shan_w3) = c("Treatment")
data(fam_shan_trim_w3)
names_fam_shan_trim_w3 =
c("Unknown", "Lachnospiraceae", "S24.7", "Lactobacillaceae", "Enterobacteriaceae", "Rikenellaceae")
fam_shan_trim_w3 = data.matrix(fam_shan_trim_w3[ ,2:82])
rownames(fam_shan_trim_w3) = names_fam_shan_trim_w3
# Obtain summary statistics for families
summary_fam_shan_w3 = CoxPHUni(Survival = surv_fam_shan_w3$Survival,
                               Censor = surv_fam_shan_w3$Censor,
                               Prognostic = prog_fam_shan_w3,
                               Micro.mat = fam_shan_trim_w3,
                               Method = "BH")

# Analysis of the taxon having smallest p-value (in the result of using CoxPHUni function)
top1_fam_shan_w3 = Top1Uni(Result = summary_fam_shan_w3,
                           Micro.mat = fam_shan_trim_w3,
                           Survival = surv_fam_shan_w3$Survival,
                           Censor = surv_fam_shan_w3$Censor,
                           Plots = TRUE)
</code></pre>


</div>