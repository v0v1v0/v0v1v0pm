<div class="container">

<table style="width: 100%;"><tr>
<td>modelCountDataJAGS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimates population-level relative abundance from count data</h2>

<h3>Description</h3>

<p>Uses a Bayesian hierarchical model to estimate relative abundance of regional
populations from count-based data (e.g., Breeding Bird Survey)
</p>


<h3>Usage</h3>

<pre><code class="language-R">modelCountDataJAGS(count_data, ni = 20000, nt = 5, nb = 5000, nc = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>count_data</code></td>
<td>
<p>List containing the following elements:
' </p>

<dl>
<dt><code>C</code></dt>
<dd>
<p>nYears by nRoutes matrix containing the observed number of individuals counted at each route in each year.</p>
</dd>
<dt><code>strat</code></dt>
<dd>
<p>Vector of length nRoutes indicating the population/region in which each route is located.</p>
</dd>
<dt><code>routesPerStrata</code></dt>
<dd>
<p>Vector of length 1 or nStrata containing the number of routes (i.e. counts) per population. If length(routesPerStrata) == 1, number of routes is identical for each population.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ni</code></td>
<td>
<p>Number of MCMC iterations. Default = 20000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nt</code></td>
<td>
<p>Thinning rate. Default = 5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb</code></td>
<td>
<p>Number of MCMC iterations to discard as burn-in. Default = 5000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nc</code></td>
<td>
<p>Number of chains. Default = 3.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>modelCountDataJAGS</code> returns an mcmc object containing posterior samples for each monitored parameter.
</p>


<h3>References</h3>

<p>Cohen, E. B., J. A. Hostetler, M. T. Hallworth, C. S. Rushing, T. S. Sillett,
and P. P. Marra. 2018. Quantifying the strength of migratory connectivity.
Methods in Ecology and Evolution 9: 513-524.
<a href="https://doi.org/10.1111/2041-210X.12916">doi:10.1111/2041-210X.12916</a>
</p>
<p>Link, W. A. and J. R. Sauer. 2002. A hierarchical analysis of population
change with application to Cerulean Warblers. Ecology 83: 2832-2840.
<a href="https://doi.org/10.1890/0012-9658%282002%29083%5B2832%3AAHAOPC%5D2.0.CO%3B2">doi:10.1890/0012-9658(2002)083[2832:AHAOPC]2.0.CO;2</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(150)

### Set parameters for simulation ----

# Number of populations
nStrata. &lt;- 4
# Number of routes w/i each population (assumed to be balanced)
routePerStrat. &lt;- 30 # reduced from 90 for example speed
# Number of years
nYears. &lt;- 5 # reduced from 10 for example speed
# log(Expected number of birds counted at each route)
alphaStrat. &lt;- 1.95
# standard deviation of normal distribution assumed for route/observer random
# effects
sdRoute. &lt;- 0.6
# standard deviation of normal distribution assumed for year random effects
sdYear. &lt;- 0.18


# Number of simulated datasets to create and model
nsims &lt;- 50 # reduced from 100 for example speed
# Number of MCMC iterations
ni. &lt;- 1000 # reduced from 15000 for example speed
# Number of iterations to thin from posterior (reduced from 5)
nt. &lt;- 1
# Number of iterations to discard as burn-in
nb. &lt;- 500 # reduced from 5000 for example speed
# Number of MCMC chains
nc. &lt;- 1 # reduced from 3 for example speed

### Create empty matrix to store model output ---
sim_in &lt;- vector("list", nsims)
sim_out &lt;- vector("list", nsims)


# Simulation ---

system.time(for(s in 1:nsims){
  cat("Simulation",s,"of",nsims,"\n")

  # Simulate data
  sim_data &lt;- simCountData(nStrata = nStrata., routesPerStrata = routePerStrat.,
                           nYears = nYears., alphaStrat = alphaStrat.,
                           sdRoute = sdRoute., sdYear = sdYear.)
  sim_in[[s]] &lt;- sim_data


  # Estimate population-level abundance
  out_mcmc &lt;- modelCountDataJAGS(count_data = sim_data, ni = ni., nt = nt.,
                                 nb = nb., nc = nc.)

  # Store model output
  sim_out[[s]] &lt;- out_mcmc
  remove(out_mcmc)

})


### Check that relative abundance is, on average, equal for each population
prop.table(sapply(sim_in, function(x) return(rowsum(colSums(x$C), x$strat))), 2)

rel_names &lt;- paste0('relN[', 1:nStrata., ']')
rel_abund1 &lt;- data.frame(sim=1:nsims,
                         ra1.mean=NA, ra2.mean=NA, ra3.mean=NA, ra4.mean=NA,
                         ra1.low=NA, ra2.low=NA, ra3.low=NA, ra4.low=NA,
                         ra1.high=NA, ra2.high=NA, ra3.high=NA, ra4.high=NA,
                         ra1.cover=0, ra2.cover=0, ra3.cover=0, ra4.cover=0)
for (s in 1:nsims) {
  rel_abund1[s, 2:5] &lt;- summary(sim_out[[s]])$statistics[rel_names, "Mean"]
  rel_abund1[s, 6:9] &lt;- summary(sim_out[[s]])$quantiles[rel_names, 1]
  rel_abund1[s, 10:13] &lt;- summary(sim_out[[s]])$quantiles[rel_names, 5]
}
rel_abund1 &lt;- transform(rel_abund1,
                        ra1.cover = (ra1.low&lt;=0.25 &amp; ra1.high&gt;=0.25),
                        ra2.cover = (ra2.low&lt;=0.25 &amp; ra2.high&gt;=0.25),
                        ra3.cover = (ra3.low&lt;=0.25 &amp; ra3.high&gt;=0.25),
                        ra4.cover = (ra4.low&lt;=0.25 &amp; ra4.high&gt;=0.25))

summary(rel_abund1)


</code></pre>


</div>