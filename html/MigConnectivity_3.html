<div class="container">

<table style="width: 100%;"><tr>
<td>calcMC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Migratory connectivity strength function</h2>

<h3>Description</h3>

<p>Migratory connectivity strength function
</p>


<h3>Usage</h3>

<pre><code class="language-R">calcMC(originDist, targetDist, originRelAbund, psi, sampleSize = NULL)

calcStrength(originDist, targetDist, originRelAbund, psi, sampleSize = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>originDist</code></td>
<td>
<p>Distances between the B origin sites.  Symmetric B by B
matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>targetDist</code></td>
<td>
<p>Distances between the W target sites.  Symmetric W by W
matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>originRelAbund</code></td>
<td>
<p>Relative abundances at B origin sites. Numeric vector
of length B that sums to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi</code></td>
<td>
<p>Transition probabilities between B origin and W target sites.
Matrix with B rows and W columns where rows sum to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampleSize</code></td>
<td>
<p>Total sample size of animals that psi was calculated from.
Should be the number of animals released in one of the origin sites and
observed in one of the target sites.  Optional, but recommended.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>scalar real value, usually between 0 and 1 (can be negative),
indicating the strength of migratory connectivity.
</p>
<p>If <code>sampleSize</code> is provided, this function uses the standard (relative
abundance and small-sample size corrected) formula for MC.  If not, it uses
the MC(R) formula, which only corrects for relative abundance.
</p>


<h3>References</h3>

<p>Cohen, E. B., J. A. Hostetler, M. T. Hallworth, C. S. Rushing, T. S. Sillett,
and P. P. Marra. 2018. Quantifying the strength of migratory connectivity.
Methods in Ecology and Evolution 9: 513 - 524.
<a href="https://doi.org/10.1111/2041-210X.12916">doi:10.1111/2041-210X.12916</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Example with three breeding and three nonbreeding sites
nBreeding &lt;- 3
nNonBreeding &lt;- 3
psi &lt;- matrix(c(0.4, 0.35, 0.25,
                0.3, 0.4, 0.3,
                0.2, 0.3, 0.5), nBreeding, nNonBreeding, byrow = TRUE)
breedDist &lt;- matrix(c(0, 1, 2,
                      1, 0, 1,
                      2, 1, 0), nBreeding, nBreeding)
nonBreedDist &lt;- matrix(c(0, 5, 10,
                      5, 0, 5,
                      10, 5, 0), nNonBreeding, nNonBreeding)
relN &lt;- rep(1/nBreeding, nBreeding)
round(calcMC(breedDist, nonBreedDist, relN, psi), 3) # == 0.05

# Example with small sample size
sampleSize &lt;- 20 * nBreeding
round(calcMC(breedDist, nonBreedDist, relN, psi, sampleSize = sampleSize), 3) # == 0.026

###############################################################################
# Example data input values
###############################################################################

#########################
#Input values 1 of 3
# Eight transition probability scenarios
#########################
nScenarios1 &lt;- length(samplePsis)
MC1 &lt;- rep(NA, nScenarios1)
for (i in 1:nScenarios1) {
  MC1[i] &lt;- calcMC(sampleOriginDist[[1]], sampleTargetDist[[1]],
                   sampleOriginRelN[[1]], samplePsis[[i]])
}
names(MC1) &lt;- names(samplePsis)
round(MC1, 6)

#########################
#Input values 2 of 3
# 12 spatial arrangements that result in different distances between regions
# Distance scenarios
## A) Base distances, linear/ linear    1
## B) Distance between breeding sites 2 and 3 doubled
## C) Distance between breeding sites 2 and 3 halved
## D) Distance between breeding sites 3 and 4 doubled
## E) Distance between breeding sites 3 and 4 halved
## F) Breeding sites on square grid/ winter linear   6
## G) Distance between wintering sites 2 and 3 doubled
## H) Distance between wintering sites 2 and 3 halved
## I) Distance between wintering sites 3 and 4 doubled
## J) Distance between wintering sites 3 and 4 halved
## K) Breeding linear, Wintering sites on square grid
## L) Wintering and breeding on square grid  12
#########################

# Get MC strengths
nScenarios2 &lt;- length(sampleOriginPos)
MC2 &lt;- matrix(NA, nScenarios1, nScenarios2)
rownames(MC2) &lt;- names(samplePsis)
colnames(MC2) &lt;- names(sampleOriginPos)
for (i in 1:nScenarios1) {
  for (j in 1:nScenarios2) {
    MC2[i, j] &lt;- calcMC(sampleOriginDist[[j]], sampleTargetDist[[j]],
                        sampleOriginRelN[[1]], samplePsis[[i]])
  }
}

t(round(MC2, 4))

# Different way of comparing results
MC.diff2 &lt;- apply(MC2, 2, "-", MC2[ , 1])
t(round(MC.diff2, 4))

#########################
#Input values 3 of 3
# Changes to relative breeding abundance:
#   1. Base
#   2. Abundance at site B doubled
#   3. Abundance at site B halved
#   4. Abundance at site D doubled
#   5. Abundance at site D halved
# For all eight transition probability matrices and three distance scenarios
#########################

nScenarios3 &lt;- length(sampleOriginRelN)

# Get MC strengths for breeding linear/ winter linear arrangement
MC3 &lt;- matrix(NA, nScenarios1, nScenarios3)
rownames(MC3) &lt;- names(samplePsis)
colnames(MC3) &lt;- names(sampleOriginRelN)
for (i in 1:nScenarios1) {
  for (j in 1) {
    for (k in 1:nScenarios3) {
      MC3[i, k] &lt;- calcMC(sampleOriginDist[[j]], sampleTargetDist[[j]],
                          sampleOriginRelN[[k]], samplePsis[[i]])
    }
  }
}
t(round(MC3, 4)) # linear arrangement

# Get MC strengths for breeding grid/ winter grid arrangement
MC4 &lt;- matrix(NA, nScenarios1, nScenarios3)
rownames(MC4) &lt;- names(samplePsis)
colnames(MC4) &lt;- names(sampleOriginRelN)
for (i in 1:nScenarios1) {
  for (j in nScenarios2) {
    for (k in 1:nScenarios3) {
      MC4[i, k] &lt;- calcMC(sampleOriginDist[[j]], sampleTargetDist[[j]],
                          sampleOriginRelN[[k]], samplePsis[[i]])
    }
  }
}
t(round(MC4, 4)) # grid arrangement

# Get MC strengths for breeding grid, winter linear arrangement
MC5 &lt;- matrix(NA, nScenarios1, nScenarios3)
rownames(MC5) &lt;- names(samplePsis)
colnames(MC5) &lt;- names(sampleOriginRelN)
for (i in 1:nScenarios1) {
  for (j in 6) {
    for (k in 1:nScenarios3) {
      MC5[i, k] &lt;- calcMC(sampleOriginDist[[j]], sampleTargetDist[[j]],
                          sampleOriginRelN[[k]], samplePsis[[i]])
    }
  }
}
t(round(MC5, 4)) # breeding grid, winter linear arrangement

</code></pre>


</div>