<div class="container">

<table style="width: 100%;"><tr>
<td>plot_tsne_pq</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot a tsne low dimensional representation of a phyloseq object</h2>

<h3>Description</h3>


<a href="https://adrientaudiere.github.io/MiscMetabar/articles/Rules.html#lifecycle">
<img src="https://img.shields.io/badge/lifecycle-experimental-orange" alt="lifecycle-experimental"></a>

<p>Partially inspired by <code>phylosmith::tsne_phyloseq()</code> function developed by Schuyler D. Smith.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_tsne_pq(
  physeq,
  method = "bray",
  dims = 2,
  theta = 0,
  perplexity = 30,
  fact = NA,
  ellipse_level = 0.95,
  plot_dims = c(1, 2),
  na_remove = TRUE,
  force_factor = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>physeq</code></td>
<td>
<p>(required): a <code>phyloseq-class</code> object obtained
using the <code>phyloseq</code> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A method to calculate distance using <code>vegan::vegdist()</code> function (default: "bray")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dims</code></td>
<td>
<p>(Int) Output dimensionality (default: 2)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>(Numeric) Speed/accuracy trade-off (increase for less accuracy), set to 0.0 for exact TSNE (default: 0.0 see details in the man page of <code>Rtsne::Rtsne</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perplexity</code></td>
<td>
<p>(Numeric) Perplexity parameter (should not be bigger than 3 * perplexity &lt; nrow(X) - 1, see details in the man page of <code>Rtsne::Rtsne</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fact</code></td>
<td>
<p>Name of the column in <code>physeq@sam_data</code> used to color points and compute ellipses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ellipse_level</code></td>
<td>
<p>The level used in stat_ellipse. Set to NULL to discard ellipse (default = 0.95)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_dims</code></td>
<td>
<p>A vector of 2 values defining the rank of dimension to plot (default: c(1,2))</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na_remove</code></td>
<td>
<p>(logical, default TRUE) Does the samples with NA values in fact are removed? (default: true)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force_factor</code></td>
<td>
<p>(logical, default TRUE) Force the fact column to be a factor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments passed on to <code>Rtsne::Rtsne()</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A ggplot object
</p>


<h3>Author(s)</h3>

<p>Adrien Taudi√®re
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(data_fungi)
if (requireNamespace("Rtsne")) {
  plot_tsne_pq(data_fungi, fact = "Height", perplexity = 15)
}

if (requireNamespace("Rtsne")) {
  plot_tsne_pq(data_fungi, fact = "Time") + geom_label(aes(label = Sample_id, fill = Time))
  plot_tsne_pq(data_fungi, fact = "Time", na_remove = FALSE, force_factor = FALSE)
}


</code></pre>


</div>