<div class="container">

<table style="width: 100%;"><tr>
<td>psmelt_samples_pq</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Build a sample information tibble from physeq object</h2>

<h3>Description</h3>


<a href="https://adrientaudiere.github.io/MiscMetabar/articles/Rules.html#lifecycle">
<img src="https://img.shields.io/badge/lifecycle-experimental-orange" alt="lifecycle-experimental"></a>

<p>Hill numbers are the number of equiprobable species giving the same diversity
value as the observed distribution.
</p>
<p>Note that contrary to <code>hill_pq()</code>, this function does not take into
account for difference in the number of sequences per samples/modalities.
You may use rarefy_by_sample = TRUE if the mean number of sequences per
samples differs among modalities.
</p>


<h3>Usage</h3>

<pre><code class="language-R">psmelt_samples_pq(
  physeq,
  hill_scales = c(0, 1, 2),
  filter_zero = TRUE,
  rarefy_by_sample = FALSE,
  taxa_ranks = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>physeq</code></td>
<td>
<p>(required): a <code>phyloseq-class</code> object obtained
using the <code>phyloseq</code> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hill_scales</code></td>
<td>
<p>(a vector of integer) The list of q values to compute
the hill number H^q. If Null, no hill number are computed. Default value
compute the Hill number 0 (Species richness), the Hill number 1
(exponential of Shannon Index) and the Hill number 2 (inverse of Simpson
Index).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter_zero</code></td>
<td>
<p>(logical, default TRUE) Do we filter non present OTU from
samples ? For the moment, this has no effect on the result because the dataframe
is grouped by samples with abundance summed across OTU.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rarefy_by_sample</code></td>
<td>
<p>(logical, default FALSE) If TRUE, rarefy
samples using <code>phyloseq::rarefy_even_depth()</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taxa_ranks</code></td>
<td>
<p>A vector of taxonomic ranks. For examples c("Family","Genus").
If taxa ranks is not set (default value = NULL), taxonomic information are not
present in the resulting tibble.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A tibble with a row for each sample. Columns provide information
from <code>sam_data</code> slot as well as hill numbers, Abundance (nb of sequences),
and Abundance_log10 (<em>log10(1+Abundance)</em>).
</p>


<h3>Author(s)</h3>

<p>Adrien Taudi√®re
</p>


<h3>Examples</h3>

<pre><code class="language-R">if (requireNamespace("ggstatsplot")) {
  psm_tib &lt;- psmelt_samples_pq(data_fungi_mini, hill_scales = c(0, 2, 7))
  ggstatsplot::ggbetweenstats(psm_tib, Height, Hill_0)
  ggstatsplot::ggbetweenstats(psm_tib, Height, Hill_7)

  psm_tib_tax &lt;- psmelt_samples_pq(data_fungi_mini, taxa_ranks = c("Class", "Family"))
  ggplot(filter(psm_tib_tax, Abundance &gt; 2000), aes(y = Family, x = Abundance, fill = Time)) +
    geom_bar(stat = "identity") +
    facet_wrap(~Height)
}
</code></pre>


</div>