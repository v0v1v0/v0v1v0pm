<div class="container">

<table style="width: 100%;"><tr>
<td>vsearch_clustering</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Recluster sequences of an object of class <code>physeq</code>
or cluster a list of DNA sequences using vsearch software</h2>

<h3>Description</h3>


<a href="https://adrientaudiere.github.io/MiscMetabar/articles/Rules.html#lifecycle">
<img src="https://img.shields.io/badge/lifecycle-maturing-blue" alt="lifecycle-maturing"></a>

<p>A wrapper of VSEARCH software.
</p>


<h3>Usage</h3>

<pre><code class="language-R">vsearch_clustering(
  physeq = NULL,
  dna_seq = NULL,
  nproc = 1,
  id = 0.97,
  vsearchpath = "vsearch",
  tax_adjust = 0,
  vsearch_cluster_method = "--cluster_size",
  vsearch_args = "--strand both",
  keep_temporary_files = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>physeq</code></td>
<td>
<p>(required): a <code>phyloseq-class</code> object obtained
using the <code>phyloseq</code> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dna_seq</code></td>
<td>
<p>You may directly use a character vector of DNA sequences
in place of physeq args. When physeq is set, dna sequences take the value of
<code>physeq@refseq</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nproc</code></td>
<td>
<p>(default: 1)
Set to number of cpus/processors to use for the clustering</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>(default: 0.97) level of identity to cluster</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vsearchpath</code></td>
<td>
<p>(default: vsearch) path to vsearch</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tax_adjust</code></td>
<td>
<p>(Default 0) See the man page
of <code>merge_taxa_vec()</code> for more details.
To conserved the taxonomic rank of the most abundant ASV,
set tax_adjust to 0 (default). For the moment only tax_adjust = 0 is
robust</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vsearch_cluster_method</code></td>
<td>
<p>(default: "–cluster_size) See other possible
methods in the <a href="https://github.com/torognes/vsearch">vsearch manual</a> (e.g. <code>--cluster_size</code> or <code>--cluster_smallmem</code>)
</p>

<ul>
<li> <p><code>--cluster_fast</code> : Clusterize the fasta sequences in filename, automatically sort by decreasing sequence length beforehand.
</p>
</li>
<li> <p><code>--cluster_size</code> : Clusterize the fasta sequences in filename, automatically sort by decreasing sequence abundance beforehand.
</p>
</li>
<li> <p><code>--cluster_smallmem</code> : Clusterize the fasta sequences in filename without automatically modifying their order beforehand. Sequence are expected to be sorted by decreasing sequence length, unless <em>–usersort</em> is used.
In that case you may set <code>vsearch_args</code> to vsearch_args = "–strand both –usersort"
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vsearch_args</code></td>
<td>
<p>(default : "–strand both") a one length character element defining other parameters to
passed on to vsearch.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep_temporary_files</code></td>
<td>
<p>(logical, default: FALSE) Do we keep temporary files ?
</p>

<ul>
<li>
<p> temp.fasta (refseq in fasta or dna_seq sequences)
</p>
</li>
<li>
<p> cluster.fasta (centroid if method = "vsearch")
</p>
</li>
<li>
<p> temp.uc (clusters if method = "vsearch")
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function use the <code>merge_taxa_vec()</code> function to
merge taxa into clusters. By default tax_adjust = 0. See the man page
of <code>merge_taxa_vec()</code>.
</p>
<p>This function is mainly a wrapper of the work of others.
Please cite <a href="https://github.com/torognes/vsearch">vsearch</a>.
</p>


<h3>Value</h3>

<p>A new object of class <code>physeq</code> or a list of cluster if dna_seq
args was used.
</p>


<h3>Author(s)</h3>

<p>Adrien Taudière
</p>


<h3>References</h3>

<p>VSEARCH can be downloaded from
<a href="https://github.com/torognes/vsearch">https://github.com/torognes/vsearch</a>.
More information in the associated publication
<a href="https://pubmed.ncbi.nlm.nih.gov/27781170">https://pubmed.ncbi.nlm.nih.gov/27781170</a>.
</p>


<h3>See Also</h3>

<p><code>postcluster_pq()</code>, <code>swarm_clustering()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

summary_plot_pq(data_fungi)
d_vs &lt;- vsearch_clustering(data_fungi)
summary_plot_pq(d_vs)


</code></pre>


</div>