<div class="container">

<table style="width: 100%;"><tr>
<td>write_pq</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Save phyloseq object in the form of multiple csv tables.</h2>

<h3>Description</h3>


<a href="https://adrientaudiere.github.io/MiscMetabar/articles/Rules.html#lifecycle">
<img src="https://img.shields.io/badge/lifecycle-maturing-blue" alt="lifecycle-maturing"></a>

<p>This is the reverse function of <code>read_pq()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">write_pq(
  physeq,
  path = NULL,
  rdata = FALSE,
  one_file = FALSE,
  write_sam_data = TRUE,
  sam_data_first = FALSE,
  clean_pq = TRUE,
  reorder_taxa = FALSE,
  rename_taxa = FALSE,
  remove_empty_samples = TRUE,
  remove_empty_taxa = TRUE,
  clean_samples_names = TRUE,
  silent = FALSE,
  verbose = FALSE,
  quote = FALSE,
  sep_csv = "\t",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>physeq</code></td>
<td>
<p>(required): a <code>phyloseq-class</code> object obtained
using the <code>phyloseq</code> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path</code></td>
<td>
<p>a path to the folder to save the phyloseq object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rdata</code></td>
<td>
<p>(logical) does the phyloseq object is also saved in Rdata format?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>one_file</code></td>
<td>
<p>(logical) if TRUE, combine all data in one file only</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>write_sam_data</code></td>
<td>
<p>(logical) does the samples data are add to
the file. Only used if <code>one_file</code> is TRUE.
Note that these option result in a lot of NA values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sam_data_first</code></td>
<td>
<p>(logical) if TRUE, put the sample data at the top of the table
Only used if <code>one_file</code> and write_sam_data are both TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clean_pq</code></td>
<td>
<p>(logical)
If set to TRUE, empty samples are discarded after subsetting taxa (ASV, OTU, ...)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reorder_taxa</code></td>
<td>
<p>(logical) if TRUE the otu_table is ordered by the number of
sequences of taxa (ASV, OTU, ...) (descending order). Default to TRUE. Only possible if clean_pq
is set to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rename_taxa</code></td>
<td>
<p>reorder_taxa (logical) if TRUE, taxa (ASV, OTU, ...) are renamed by their position
in the OTU_table (asv_1, asv_2, ...). Default to FALSE. Only possible if clean_pq
is set to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove_empty_samples</code></td>
<td>
<p>(logical) Do you want to remove samples
without sequences (this is done after removing empty taxa)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove_empty_taxa</code></td>
<td>
<p>(logical) Do you want to remove taxa
without sequences (this is done before removing empty samples)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clean_samples_names</code></td>
<td>
<p>(logical) Do you want to clean samples names?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>(logical) If true, no message are printing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>(logical) Additional informations in the message
the verbose parameter overwrite the silent parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quote</code></td>
<td>
<p>a logical value (default FALSE) or a numeric vector.
If TRUE, any character or factor columns will be surrounded by
double quotes.  If a numeric vector, its elements are taken
as the indices of columns to quote.  In both cases, row and
column names are quoted if they are written. If FALSE nothing is quoted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sep_csv</code></td>
<td>
<p>(default tabulation) separator for column</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments passed on to <code>utils::write.table()</code> function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Build a folder (path) containing one to four csv tables
(refseq.csv, otu_table.csv, tax_table.csv, sam_data.csv)
and if present a phy_tree in Newick format
</p>


<h3>Author(s)</h3>

<p>Adrien Taudi√®re
</p>


<h3>See Also</h3>

<p><code>save_pq()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">write_pq(data_fungi, path = paste0(tempdir(), "/phyloseq"))
write_pq(data_fungi, path = paste0(tempdir(), "/phyloseq"), one_file = TRUE)
unlink(paste0(tempdir(), "/phyloseq"), recursive = TRUE)
</code></pre>


</div>