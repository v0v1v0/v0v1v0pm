<div class="container">

<table style="width: 100%;"><tr>
<td>biplot_pq</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Visualization of two samples for comparison</h2>

<h3>Description</h3>


<a href="https://adrientaudiere.github.io/MiscMetabar/articles/Rules.html#lifecycle">
<img src="https://img.shields.io/badge/lifecycle-maturing-blue" alt="lifecycle-maturing"></a>

<p>Graphical representation of distribution of taxa across two samples.
</p>


<h3>Usage</h3>

<pre><code class="language-R">biplot_pq(
  physeq,
  fact = NULL,
  merge_sample_by = NULL,
  rarefy_after_merging = FALSE,
  inverse_side = FALSE,
  left_name = NULL,
  left_name_col = "#4B3E1E",
  left_fill = "#4B3E1E",
  left_col = "#f3f2d9",
  right_name = NULL,
  right_name_col = "#1d2949",
  right_fill = "#1d2949",
  right_col = "#1d2949",
  log10trans = TRUE,
  nudge_y = c(0.3, 0.3),
  geom_label = FALSE,
  text_size = 3,
  size_names = 5,
  y_names = NA,
  ylim_modif = c(1, 1),
  nb_samples_info = TRUE,
  plotly_version = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>physeq</code></td>
<td>
<p>(required): a <code>phyloseq-class</code> object obtained
using the <code>phyloseq</code> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fact</code></td>
<td>
<p>(default: NULL) Name of the factor in <code>physeq@sam_data</code>.
If left to NULL use the <code>left_name</code> and <code>right_name</code> parameter as modality.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>merge_sample_by</code></td>
<td>
<p>(default: NULL) if not <code>NULL</code> samples of
physeq are merged using the vector set by <code>merge_sample_by</code>. This
merging used the <code>merge_samples2()</code>. In the case of
<code>biplot_pq()</code> this must be a factor with two levels only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rarefy_after_merging</code></td>
<td>
<p>Rarefy each sample after merging by the
modalities merge_sample_by</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inverse_side</code></td>
<td>
<p>Inverse the side (put the right modality in the left side).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>left_name</code></td>
<td>
<p>Name fo the left sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>left_name_col</code></td>
<td>
<p>Color for the left name</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>left_fill</code></td>
<td>
<p>Fill fo the left sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>left_col</code></td>
<td>
<p>Color fo the left sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>right_name</code></td>
<td>
<p>Name fo the right sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>right_name_col</code></td>
<td>
<p>Color for the right name</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>right_fill</code></td>
<td>
<p>Fill fo the right sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>right_col</code></td>
<td>
<p>Color fo the right sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log10trans</code></td>
<td>
<p>(logical) Does abundancy is log10 transformed ?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nudge_y</code></td>
<td>
<p>A parameter to control the y position of abundancy values.
If a vector of two values are set. The first value is for the left side.
and the second value for the right one. If one value is set,
this value is used for both side.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geom_label</code></td>
<td>
<p>(default: FALSE, logical) if TRUE use the <code>ggplot2::geom_label()</code> function
instead of <code>ggplot2::geom_text()</code> to indicate the numbers of sequences.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text_size</code></td>
<td>
<p>size for the number of sequences</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size_names</code></td>
<td>
<p>size for the names of the 2 samples</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_names</code></td>
<td>
<p>y position for the names of the 2 samples. If NA (default),
computed using the maximum abundances values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim_modif</code></td>
<td>
<p>vector of two values. Modificator (by a multiplication)
of ylim. If one value is set, this value is used for both limits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb_samples_info</code></td>
<td>
<p>(default: TRUE, logical) if TRUE and merge_sample_by is set,
add the number of samples merged for both levels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotly_version</code></td>
<td>
<p>If TRUE, use <code>plotly::ggplotly()</code> to return
a interactive ggplot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments for the ggplot function</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A plot
</p>


<h3>Author(s)</h3>

<p>Adrien Taudi√®re
</p>


<h3>Examples</h3>

<pre><code class="language-R">data_fungi_2Height &lt;- subset_samples(data_fungi_mini, Height %in% c("Low", "High"))
biplot_pq(data_fungi_2Height, "Height", merge_sample_by = "Height")
</code></pre>


</div>