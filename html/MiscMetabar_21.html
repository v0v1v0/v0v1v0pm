<div class="container">

<table style="width: 100%;"><tr>
<td>blast_to_derep</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Blast some sequence against sequences from of a <code>derep-class</code>
object.</h2>

<h3>Description</h3>


<a href="https://adrientaudiere.github.io/MiscMetabar/articles/Rules.html#lifecycle">
<img src="https://img.shields.io/badge/lifecycle-experimental-orange" alt="lifecycle-experimental"></a>

<p>Use the blast software.
</p>


<h3>Usage</h3>

<pre><code class="language-R">blast_to_derep(
  derep,
  seq2search,
  blastpath = NULL,
  id_cut = 90,
  bit_score_cut = 50,
  min_cover_cut = 50,
  e_value_cut = 1e-30,
  unique_per_seq = FALSE,
  score_filter = FALSE,
  list_no_output_query = FALSE,
  min_length_seq = 200,
  args_makedb = NULL,
  args_blastn = NULL,
  nproc = 1,
  keep_temporary_files = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>derep</code></td>
<td>
<p>The result of <code>dada2::derepFastq()</code>. A list of <code>derep-class</code>
object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seq2search</code></td>
<td>
<p>(required) path to a fasta file defining the sequences
you want to blast against the taxa (ASV, OTU) sequences from the physeq object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blastpath</code></td>
<td>
<p>path to blast program</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id_cut</code></td>
<td>
<p>(default: 90) cut of in identity percent to keep result</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bit_score_cut</code></td>
<td>
<p>(default: 50) cut of in bit score to keep result
The higher the bit-score, the better the sequence similarity.
The bit-score is the requires size of a sequence database in which the current
match could be found just by chance. The bit-score is a log2 scaled and
normalized raw-score. Each increase by one doubles the required database size
(2bit-score).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_cover_cut</code></td>
<td>
<p>(default: 50) cut of in query cover (%) to keep result</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e_value_cut</code></td>
<td>
<p>(default: 1e-30)  cut of in e-value (%) to keep result
The BLAST E-value is the number of expected hits of similar quality (score)
that could be found just by chance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unique_per_seq</code></td>
<td>
<p>(logical, default FALSE) if TRUE only return the better match
(higher <strong>bit score</strong>) for each sequence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>score_filter</code></td>
<td>
<p>(logical, default TRUE) does results are filter by score? If
FALSE, <code>id_cut</code>,<code>bit_score_cut</code>, <code>e_value_cut</code> and <code>min_cover_cut</code> are ignored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>list_no_output_query</code></td>
<td>
<p>(logical) does the result table include
query sequences for which <code>blastn</code> does not find any correspondence?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_length_seq</code></td>
<td>
<p>(default: 200) Removed sequences with less than
<code>min_length_seq</code> from derep before blast. Set to 0 to discard filtering
sequences by length.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args_makedb</code></td>
<td>
<p>Additional parameters parse to makeblastdb command</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args_blastn</code></td>
<td>
<p>Additional parameters parse to blastn command</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nproc</code></td>
<td>
<p>(default: 1)
Set to number of cpus/processors to use for blast (args -num_threads
for blastn command)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep_temporary_files</code></td>
<td>
<p>(logical, default: FALSE) Do we keep temporary
files :
</p>

<ul>
<li>
<p> db.fasta (refseq transformed into a database)
</p>
</li>
<li>
<p> dbase list of files (output of blastn)
</p>
</li>
<li>
<p> blast_result.txt the summary result of blastn using
<code style="white-space: pre;">⁠-outfmt "6 qseqid qlen sseqid slen length pident evalue bitscore qcovs"⁠</code>
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A blast table
</p>


<h3>Author(s)</h3>

<p>Adrien Taudière
</p>


<h3>See Also</h3>

<p><code>blast_pq()</code> to use <code>refseq</code> slot as query sequences
against un custom database and <code>blast_to_phyloseq()</code>  to use
<code>refseq</code> slot as a database
</p>


</div>