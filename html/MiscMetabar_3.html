<div class="container">

<table style="width: 100%;"><tr>
<td>accu_plot_balanced_modality</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot accumulation curves with balanced modality and depth rarefaction</h2>

<h3>Description</h3>


<a href="https://adrientaudiere.github.io/MiscMetabar/articles/Rules.html#lifecycle">
<img src="https://img.shields.io/badge/lifecycle-experimental-orange" alt="lifecycle-experimental"></a>

<p>This function (i) rarefy (equalize) the number of samples per modality of a
factor and (ii) rarefy the number of sequences per sample (depth). The
seed is set to 1:nperm. Thus, with exacly the same parameter, including
nperm values, results must be identical.
</p>


<h3>Usage</h3>

<pre><code class="language-R">accu_plot_balanced_modality(
  physeq,
  fact,
  nperm = 99,
  step = 2000,
  by.fact = TRUE,
  progress_bar = TRUE,
  quantile_prob = 0.975,
  rarefy_by_sample_before_merging = TRUE,
  sample.size = 1000,
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>physeq</code></td>
<td>
<p>(required): a <code>phyloseq-class</code> object obtained
using the <code>phyloseq</code> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fact</code></td>
<td>
<p>(required) The variable to rarefy. Must be present in
the <code>sam_data</code> slot of the physeq object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nperm</code></td>
<td>
<p>(int) The number of permutations to perform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step</code></td>
<td>
<p>(int) distance among points calculated to plot lines.
A low value give better plot but is more time consuming.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by.fact</code></td>
<td>
<p>(logical, default TRUE)
First merge the OTU table by factor to plot only one line by factor</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress_bar</code></td>
<td>
<p>(logical, default TRUE) Do we print progress during
the calculation?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantile_prob</code></td>
<td>
<p>(float, <code style="white-space: pre;">⁠[0:1]⁠</code>) the value to compute the quantile.
Minimum quantile is compute using 1-quantile_prob.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rarefy_by_sample_before_merging</code></td>
<td>
<p>(logical, default TRUE):
rarefy_by_sample_before_merging = FALSE is buggy for the moment.Please
only use rarefy_by_sample_before_merging = TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample.size</code></td>
<td>
<p>(int) A single integer value equal to the number of
reads being simulated, also known as the depth. See
<code>phyloseq::rarefy_even_depth()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>(logical). If TRUE, print additional informations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other params for be passed on to <code>accu_plot()</code> function</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A ggplot2 plot representing the richness accumulation plot
</p>


<h3>Author(s)</h3>

<p>Adrien Taudière
</p>


<h3>See Also</h3>

<p><code>accu_plot()</code>, <code>rarefy_sample_count_by_modality()</code>, <code>phyloseq::rarefy_even_depth()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data_fungi_woNA4Time &lt;-
  subset_samples(data_fungi, !is.na(Time))
data_fungi_woNA4Time@sam_data$Time &lt;- paste0("time-", data_fungi_woNA4Time@sam_data$Time)
accu_plot_balanced_modality(data_fungi_woNA4Time, "Time", nperm = 3)

data_fungi_woNA4Height &lt;-
  subset_samples(data_fungi, !is.na(Height))
accu_plot_balanced_modality(data_fungi_woNA4Height, "Height", nperm = 3)

</code></pre>


</div>