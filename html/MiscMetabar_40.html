<div class="container">

<table style="width: 100%;"><tr>
<td>filter_asv_blast</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Filter undesirable taxa using blast against a custom database.</h2>

<h3>Description</h3>


<a href="https://adrientaudiere.github.io/MiscMetabar/articles/Rules.html#lifecycle">
<img src="https://img.shields.io/badge/lifecycle-experimental-orange" alt="lifecycle-experimental"></a>

<p>Use the blast software.
</p>


<h3>Usage</h3>

<pre><code class="language-R">filter_asv_blast(
  physeq,
  fasta_for_db = NULL,
  database = NULL,
  clean_pq = TRUE,
  add_info_to_taxtable = TRUE,
  id_filter = 90,
  bit_score_filter = 50,
  min_cover_filter = 50,
  e_value_filter = 1e-30,
  ...
)

filter_taxa_blast(
  physeq,
  fasta_for_db = NULL,
  database = NULL,
  clean_pq = TRUE,
  add_info_to_taxtable = TRUE,
  id_filter = 90,
  bit_score_filter = 50,
  min_cover_filter = 50,
  e_value_filter = 1e-30,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>physeq</code></td>
<td>
<p>(required): a <code>phyloseq-class</code> object obtained
using the <code>phyloseq</code> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fasta_for_db</code></td>
<td>
<p>path to a fasta file to make the blast database</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>database</code></td>
<td>
<p>path to a blast database</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clean_pq</code></td>
<td>
<p>(logical)
If set to TRUE, empty samples and empty taxa (ASV, OTU) are discarded
after filtering.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add_info_to_taxtable</code></td>
<td>
<p>(logical, default TRUE) Does the blast information
are added to the taxtable ?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id_filter</code></td>
<td>
<p>(default: 90) cut of in identity percent to keep result</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bit_score_filter</code></td>
<td>
<p>(default: 50) cut of in bit score to keep result
The higher the bit-score, the better the sequence similarity.
The bit-score is the requires size of a sequence database in which the current
match could be found just by chance. The bit-score is a log2 scaled and
normalized raw-score. Each increase by one doubles the required database size
(2bit-score).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_cover_filter</code></td>
<td>
<p>(default: 50) cut of in query cover (%) to keep result</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e_value_filter</code></td>
<td>
<p>(default: 1e-30)  cut of in e-value (%) to keep result
The BLAST E-value is the number of expected hits of similar quality (score)
that could be found just by chance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Others options for the <code>blast_pq()</code> function. See <code>?blast_pq</code>.
Note that params <code>unique_per_seq</code> must be lft to TRUE and <code>score_filter</code>
must be left to FALSE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A new <code>phyloseq-class</code> object.
</p>


</div>