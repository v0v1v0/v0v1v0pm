<div class="container">

<table style="width: 100%;"><tr>
<td>hill_test_rarperm_pq</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test multiple times effect of factor on Hill diversity
with different rarefaction even depth</h2>

<h3>Description</h3>


<a href="https://adrientaudiere.github.io/MiscMetabar/articles/Rules.html#lifecycle">
<img src="https://img.shields.io/badge/lifecycle-experimental-orange" alt="lifecycle-experimental"></a>

<p>This reduce the risk of a random drawing of a exceptional situation of an unique rarefaction.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hill_test_rarperm_pq(
  physeq,
  fact,
  hill_scales = c(0, 1, 2),
  nperm = 99,
  sample.size = min(sample_sums(physeq)),
  verbose = FALSE,
  progress_bar = TRUE,
  p_val_signif = 0.05,
  type = "non-parametrique",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>physeq</code></td>
<td>
<p>(required): a <code>phyloseq-class</code> object obtained
using the <code>phyloseq</code> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fact</code></td>
<td>
<p>(required) Name of the factor in <code>physeq@sam_data</code> used to plot
different lines</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hill_scales</code></td>
<td>
<p>(a vector of integer) The list of q values to compute
the hill number H^q. If Null, no hill number are computed. Default value
compute the Hill number 0 (Species richness), the Hill number 1
(exponential of Shannon Index) and the Hill number 2 (inverse of Simpson
Index).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nperm</code></td>
<td>
<p>(int) The number of permutations to perform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample.size</code></td>
<td>
<p>(int) A single integer value equal to the number of
reads being simulated, also known as the depth. See
<code>phyloseq::rarefy_even_depth()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>(logical). If TRUE, print additional informations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress_bar</code></td>
<td>
<p>(logical, default TRUE) Do we print progress during
the calculation?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_val_signif</code></td>
<td>
<p>(float, <code style="white-space: pre;">⁠[0:1]⁠</code>) The mimimum value of p-value to count a
test as significant int the <code>prop_signif</code> result.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A character specifying the type of statistical approach
(See <code>ggstatsplot::ggbetweenstats()</code> for more details):
</p>

<ul>
<li>
<p> "parametric"
</p>
</li>
<li>
<p> "nonparametric"
</p>
</li>
<li>
<p> "robust"
</p>
</li>
<li>
<p> "bayes"
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments passed on to <code>ggstatsplot::ggbetweenstats()</code> function</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of 6 components :
</p>

<ul>
<li>
<p> method
</p>
</li>
<li>
<p> expressions
</p>
</li>
<li>
<p> plots
</p>
</li>
<li>
<p> pvals
</p>
</li>
<li>
<p> prop_signif
</p>
</li>
<li>
<p> statistics
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Adrien Taudière
</p>


<h3>See Also</h3>

<p><code>ggstatsplot::ggbetweenstats()</code>, <code>hill_pq()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
if (requireNamespace("ggstatsplot")) {
  hill_test_rarperm_pq(data_fungi, "Time", nperm = 2)
  res &lt;- hill_test_rarperm_pq(data_fungi, "Height", nperm = 9, p.val = 0.9)
  patchwork::wrap_plots(res$plots[[1]])
  res$plots[[1]][[1]] + res$plots[[2]][[1]] + res$plots[[3]][[1]]
  res$prop_signif
  res_para &lt;- hill_test_rarperm_pq(data_fungi, "Height", nperm = 9, type = "parametrique")
  res_para$plots[[1]][[1]] + res_para$plots[[2]][[1]] + res_para$plots[[3]][[1]]
  res_para$pvals
  res_para$method
  res_para$expressions[[1]]
}

</code></pre>


</div>