<div class="container">

<table style="width: 100%;"><tr>
<td>merge_taxa_vec</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Merge taxa in groups (vectorized version)</h2>

<h3>Description</h3>


<a href="https://adrientaudiere.github.io/MiscMetabar/articles/Rules.html#lifecycle">
<img src="https://img.shields.io/badge/lifecycle-stable-green" alt="lifecycle-stable"></a>

<p>Firstly release in the <a href="https://github.com/mikemc/speedyseq/">speedyseq</a> R
package by Michael R. McLaren.
</p>
<p>Merge taxa in <code>x</code> into a smaller set of taxa defined by the vector <code>group</code>.
Taxa whose value in <code>group</code> is NA will be dropped. New taxa will be named
according to the most abundant taxon in each group (<code>phyloseq</code> and
<code>otu_table</code> objects) or the first taxon in each group (all other phyloseq
component objects).
</p>
<p>If <code>x</code> is a phyloseq object with a phylogenetic tree, then the new taxa will
be ordered as they are in the tree. Otherwise, the taxa order can be
controlled by the <code>reorder</code> argument, which behaves like the <code>reorder</code>
argument in <code>base::rowsum()</code>. <code>reorder = FALSE</code> will keep taxa in
the original order determined by when the member of each group first appears
in <code>taxa_names(x)</code>; <code>reorder = TRUE</code> will order new taxa according to their
corresponding value in <code>group</code>.
</p>
<p>The <code>tax_adjust</code> argument controls the handling of taxonomic disagreements
within groups. Setting <code>tax_adjust == 0</code> causes no adjustment; the taxonomy
of the new group is set to the archetype taxon (see below). Otherwise,
disagreements within a group at a given rank cause the values at lower ranks
to be set to <code>NA</code>. If <code>tax_adjust == 1</code> (the default), then a rank where all
taxa in the group are already NA is not counted as a disagreement, and lower
ranks may be kept if the taxa agree. This corresponds to the original
phyloseq behavior. If <code>tax_adjust == 2</code>, then these NAs are treated as a
disagreement; all ranks are set to NA after the first disagreement or NA.
</p>


<h3>Usage</h3>

<pre><code class="language-R">merge_taxa_vec(x, group, reorder = FALSE, tax_adjust = 1L)

## S4 method for signature 'phyloseq'
merge_taxa_vec(x, group, reorder = FALSE, tax_adjust = 1L)

## S4 method for signature 'otu_table'
merge_taxa_vec(x, group, reorder = FALSE)

## S4 method for signature 'taxonomyTable'
merge_taxa_vec(x, group, reorder = FALSE, tax_adjust = 1L)

## S4 method for signature 'phylo'
merge_taxa_vec(x, group)

## S4 method for signature 'XStringSet'
merge_taxa_vec(x, group, reorder = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A phyloseq object or component object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>A vector with one element for each taxon in <code>physeq</code> that
defines the new groups. see <code>base::rowsum()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reorder</code></td>
<td>
<p>Logical specifying whether to reorder the taxa by their
<code>group</code> values. Ignored if <code>x</code> has (or is) a phylogenetic tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tax_adjust</code></td>
<td>
<p>0: no adjustment; 1: phyloseq-compatible adjustment; 2:
conservative adjustment</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A new phyloseq-class, otu_table, tax_table, XStringset or
sam_data object depending on the class of the x param
</p>


<h3>Author(s)</h3>

<p>Michael R. McLaren (orcid: <a href="https://orcid.org/0000-0003-1575-473X">0000-0003-1575-473X</a>) modified by Adrien Taudiere
</p>


<h3>See Also</h3>

<p>Function in MiscMetabar that use this function: <code>postcluster_pq()</code>
</p>
<p><code>base::rowsum()</code>
</p>
<p><code>phyloseq::merge_taxa()</code>
</p>


</div>