<div class="container">

<table style="width: 100%;"><tr>
<td>plot_ancombc_pq</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot ANCOMBC2 result for phyloseq object</h2>

<h3>Description</h3>


<a href="https://adrientaudiere.github.io/MiscMetabar/articles/Rules.html#lifecycle">
<img src="https://img.shields.io/badge/lifecycle-experimental-orange" alt="lifecycle-experimental"></a>

<p>Graphical representation of ANCOMBC2 result.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_ancombc_pq(
  physeq,
  ancombc_res,
  filter_passed = TRUE,
  filter_diff = TRUE,
  min_abs_lfc = 0,
  tax_col = "Genus",
  tax_label = "Species",
  add_marginal_vioplot = TRUE,
  add_label = TRUE,
  add_hline_cut_lfc = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>physeq</code></td>
<td>
<p>(required): a <code>phyloseq-class</code> object obtained
using the <code>phyloseq</code> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ancombc_res</code></td>
<td>
<p>(required) the result of the ancombc_pq function
For the moment only bimodal factors are possible.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter_passed</code></td>
<td>
<p>(logical, default TRUE) Do we filter using the column
passed_ss? The passed_ss value is  TRUE if the taxon passed the sensitivity
analysis, i.e., adding different pseudo-counts to 0s would not change the results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter_diff</code></td>
<td>
<p>(logical, default TRUE) Do we filter using the column
diff? The diff value is TRUE if the taxon is significant
(has q less than alpha)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_abs_lfc</code></td>
<td>
<p>(integer, default 0) Minimum absolute value to filter
results based on Log Fold Change. For ex. a value of 1 filter out taxa
for which the abundance in a given level of the modalty is not at least
the double of the abundance in the other level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tax_col</code></td>
<td>
<p>The taxonomic level (must be present in <code>tax_table</code> slot)
to color the points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tax_label</code></td>
<td>
<p>The taxonomic level (must be present in <code>tax_table</code> slot)
to add label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add_marginal_vioplot</code></td>
<td>
<p>(logical, default TRUE) Do we add a marginal
vioplot representing all the taxa lfc from ancombc_res.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add_label</code></td>
<td>
<p>(logical, default TRUE) Do we add a label?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add_hline_cut_lfc</code></td>
<td>
<p>(logical, default NULL) Do we add two horizontal
lines when min_abs_lfc is set (different from zero)?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is mainly a wrapper of the work of others.
Please make a reference to <code>ANCOMBC::ancombc2()</code> if you
use this function.
</p>


<h3>Value</h3>

<p>A ggplot2 object. If add_marginal_vioplot is TRUE, this is a
patchworks of plot made using <code>patchwork::plot_layout()</code>.
</p>


<h3>Author(s)</h3>

<p>Adrien Taudi√®re
</p>


<h3>Examples</h3>

<pre><code class="language-R">
if (requireNamespace("mia")) {
  data_fungi_mini@tax_table &lt;- phyloseq::tax_table(cbind(
    data_fungi_mini@tax_table,
    "taxon" = taxa_names(data_fungi_mini)
  ))

  res_time &lt;- ancombc_pq(
    data_fungi_mini,
    fact = "Time",
    levels_fact = c("0", "15"),
    tax_level = "taxon",
    verbose = TRUE
  )

  plot_ancombc_pq(data_fungi_mini, res_time,
    filter_passed = FALSE,
    tax_label = "Genus", tax_col = "Order"
  )
  plot_ancombc_pq(data_fungi_mini, res_time, tax_col = "Genus")
  plot_ancombc_pq(data_fungi_mini, res_time,
    filter_passed = FALSE,
    filter_diff = FALSE, tax_col = "Family", add_label = FALSE
  )
}

</code></pre>


</div>