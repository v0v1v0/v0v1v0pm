<div class="container">

<table style="width: 100%;"><tr>
<td>plot_deseq2_pq</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot DESeq2 results for a phyloseq or a DESeq2 object.</h2>

<h3>Description</h3>


<a href="https://adrientaudiere.github.io/MiscMetabar/articles/Rules.html#lifecycle">
<img src="https://img.shields.io/badge/lifecycle-experimental-orange" alt="lifecycle-experimental"></a>

<p>Graphical representation of DESeq2 analysis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_deseq2_pq(
  data,
  contrast = NULL,
  tax_table = NULL,
  pval = 0.05,
  taxolev = "Genus",
  select_taxa = NULL,
  color_tax = "Phylum",
  tax_depth = NULL,
  verbose = TRUE,
  jitter_width = 0.1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>(required) a <code>phyloseq-class</code> or a
<code>DESeqDataSet-class</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrast</code></td>
<td>
<p>(required) contrast specifies what comparison to extract
from the object to build a results table. See <code>results</code>
man page for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tax_table</code></td>
<td>
<p>Required if data is a
<code>DESeqDataSet-class</code> object.
The taxonomic table used to find the <code>taxa</code> and <code>color_taxa</code>
arguments. If data is a <code>phyloseq-class</code> object, data@tax_table
is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval</code></td>
<td>
<p>(default: 0.05) the significance cutoff used for optimizing
the independent filtering. If the adjusted p-value cutoff (FDR) will be a
value other than 0.05, pval should be set to that value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taxolev</code></td>
<td>
<p>taxonomic level of interest</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>select_taxa</code></td>
<td>
<p>Either the name of the taxa (in the form of <code>DESeq2::results()</code>)
or a logical vector (length of the results from <code>DESeq2::results()</code>) to select taxa
to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color_tax</code></td>
<td>
<p>taxonomic level used for color or a
color vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tax_depth</code></td>
<td>
<p>Taxonomic depth to test for differential
distribution among contrast. If Null the analysis is done at the OTU
(i.e. Species) level. If not Null, data need to be a column name in
the <code>tax_table</code> slot of the <code>phyloseq-class</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>whether the function print some information during
the computation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jitter_width</code></td>
<td>
<p>width for the jitter positioning</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed on to <code>DESeq</code>
or <code>ggplot</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Please cite <code>DESeq2</code> package if you use chis function.
</p>


<h3>Value</h3>

<p>A <code>ggplot</code>2 plot representing DESeq2 results
</p>


<h3>Author(s)</h3>

<p>Adrien Taudi√®re
</p>


<h3>See Also</h3>

<p><code>DESeq</code>
</p>
<p><code>results</code>
</p>
<p><code>plot_edgeR_pq</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

data("GlobalPatterns", package = "phyloseq")
GP &lt;- subset_taxa(GlobalPatterns, GlobalPatterns@tax_table[, 1] == "Archaea")
GP &lt;- subset_samples(GP, SampleType %in% c("Soil", "Skin"))
if (requireNamespace("DESeq2")) {
  res &lt;- DESeq2::DESeq(phyloseq_to_deseq2(GP, ~SampleType),
    test = "Wald", fitType = "local"
  )
  plot_deseq2_pq(res, c("SampleType", "Soil", "Skin"),
    tax_table = GP@tax_table, color_tax = "Kingdom"
  )
  plot_deseq2_pq(res, c("SampleType", "Soil", "Skin"),
    tax_table = GP@tax_table, color_tax = "Kingdom",
    pval = 0.7
  )
  plot_deseq2_pq(res, c("SampleType", "Soil", "Skin"),
    tax_table = GP@tax_table, color_tax = "Class",
    select_taxa = c("522457", "271582")
  )
}

</code></pre>


</div>