<div class="container">

<table style="width: 100%;"><tr>
<td>MLmatrixt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Maximum likelihood estimation for matrix variate t distributions</h2>

<h3>Description</h3>

<p>For the matrix variate normal distribution, maximum likelihood estimates
exist for <code class="reqn">N &gt; max(p/q,q/p)+1</code> and are unique for <code class="reqn">N &gt; max(p,q)</code>.
The number necessary for the matrix variate t has not been worked out but
this is a lower bound. This implements an ECME algorithm to estimate the
mean, covariance, and degrees of freedom parameters. An AR(1), compound
symmetry, or independence restriction can be proposed for either or both
variance matrices. However, if they are inappropriate for the data, they may
fail with a warning.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MLmatrixt(
  data,
  row.mean = FALSE,
  col.mean = FALSE,
  row.variance = "none",
  col.variance = "none",
  df = 10,
  fixed = TRUE,
  tol = .Machine$double.eps^0.5,
  max.iter = 5000,
  U,
  V,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Either a list of matrices or a 3-D array with matrices in
dimensions 1 and 2, indexed by dimension 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row.mean</code></td>
<td>
<p>By default, <code>FALSE</code>. If <code>TRUE</code>, will fit a
common mean within each row. If both this and <code>col.mean</code> are
<code>TRUE</code>, there will be a common mean for the entire matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.mean</code></td>
<td>
<p>By default, <code>FALSE</code>. If <code>TRUE</code>, will fit a
common mean within each row. If both this and <code>row.mean</code> are
<code>TRUE</code>, there will be a common mean for the entire matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row.variance</code></td>
<td>
<p>Imposes a variance structure on the rows. Either
'none', 'AR(1)', 'CS' for 'compound symmetry', 'Correlation' for a
correlation matrix, or 'Independence' for
independent and identical variance across the rows.
Only positive correlations are allowed for AR(1) and CS and these
restrictions may not be guaranteed to converge.
Note that while maximum likelihood estimators are available (and used)
for the unconstrained variance matrices, <code>optim</code> is used for any
constraints so it may be considerably slower.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.variance</code></td>
<td>
<p>Imposes a variance structure on the columns.
Either 'none', 'AR(1)', 'CS', 'Correlation', or 'Independence'.
Only positive correlations are allowed for
AR(1) and CS.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>Starting value for the degrees of freedom. If <code>fixed = TRUE</code>,
then this is required and not updated. By default, set to 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>Whether <code>df</code> is estimated or fixed.
By default, <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Convergence criterion. Measured against square deviation
between iterations of the two variance-covariance matrices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.iter</code></td>
<td>
<p>Maximum possible iterations of the algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U</code></td>
<td>
<p>(optional) Can provide a starting point for the U matrix.
By default, an identity matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>(optional) Can provide a starting point for the V matrix.
By default, an identity matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>(optional) additional arguments can be passed to <code>optim</code>
if using restrictions on the variance.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list with the following elements:
</p>

<dl>
<dt><code>mean</code></dt>
<dd>
<p>the mean matrix</p>
</dd>
<dt><code>U</code></dt>
<dd>
<p>the between-row covariance matrix</p>
</dd>
<dt><code>V</code></dt>
<dd>
<p>the between-column covariance matrix</p>
</dd>
<dt><code>var</code></dt>
<dd>
<p>the scalar variance parameter
(the first entry of the covariances are restricted to unity)</p>
</dd>
<dt><code>nu</code></dt>
<dd>
<p>the degrees of freedom parameter</p>
</dd>
<dt><code>iter</code></dt>
<dd>
<p>the number of iterations</p>
</dd>
<dt><code>tol</code></dt>
<dd>
<p>the squared difference between iterations of
the variance matrices at the time of stopping</p>
</dd>
<dt><code>logLik</code></dt>
<dd>
<p>log likelihood of result.</p>
</dd>
<dt><code>convergence</code></dt>
<dd>
<p>a convergence flag,
<code>TRUE</code> if converged.</p>
</dd>
<dt><code>call</code></dt>
<dd>
<p>The (matched) function call.</p>
</dd>
</dl>
<h3>References</h3>

<div class="sourceCode"><pre>Thompson, G Z.  R Maitra, W Q Meeker, A Bastawros (2019),
"Classification with the matrix-variate-t distribution", arXiv
e-prints arXiv:1907.09565 &lt;https://arxiv.org/abs/1907.09565&gt;

Dickey, James M. 1967. “Matricvariate Generalizations of the
Multivariate t Distribution and the Inverted Multivariate t
Distribution.” Ann. Math. Statist. 38 (2): 511–18.
\doi{10.1214/aoms/1177698967}

Liu, Chuanhai, and Donald B. Rubin. 1994. “The ECME Algorithm:
A Simple Extension of EM and ECM with Faster Monotone Convergence.”
Biometrika 81 (4): 633–48.
      \doi{10.2307/2337067}
</pre></div>
<p>Meng, Xiao-Li, and Donald B. Rubin. 1993. “Maximum Likelihood Estimation
via the ECM Algorithm: A General Framework.” Biometrika 80 (2): 267–78.
<a href="https://doi.org/10.1093/biomet/80.2.267">doi:10.1093/biomet/80.2.267</a>
</p>
<div class="sourceCode"><pre>Rubin, D.B. 1983. “Encyclopedia of Statistical Sciences.” In, 4th ed.,
  272–5. John Wiley.
</pre></div>


<h3>See Also</h3>

<p><code>rmatrixnorm()</code>, <code>rmatrixt()</code>,
<code>MLmatrixnorm()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(20180202)
# drawing from a distribution with specified mean and covariance
A &lt;- rmatrixt(
  n = 100, mean = matrix(c(100, 0, -100, 0, 25, -1000), nrow = 2),
  L = matrix(c(2, 1, 0, .1), nrow = 2), list = TRUE, df = 5
)
# fitting maximum likelihood estimates
results &lt;- MLmatrixt(A, tol = 1e-5, df = 5)
print(results)
</code></pre>


</div>