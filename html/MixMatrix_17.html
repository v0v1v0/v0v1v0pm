<div class="container">

<table style="width: 100%;"><tr>
<td>rmatrixnorm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Matrix variate Normal distribution functions</h2>

<h3>Description</h3>

<p>Density and random generation for the matrix variate
normal distribution
</p>


<h3>Usage</h3>

<pre><code class="language-R">rmatrixnorm(
  n,
  mean,
  L = diag(dim(as.matrix(mean))[1]),
  R = diag(dim(as.matrix(mean))[2]),
  U = L %*% t(L),
  V = t(R) %*% R,
  list = FALSE,
  array = NULL,
  force = FALSE
)

dmatrixnorm(
  x,
  mean = matrix(0, p, n),
  L = diag(p),
  R = diag(n),
  U = L %*% t(L),
  V = t(R) %*% R,
  log = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations to generate - must be a positive integer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p><code class="reqn">p \times q</code>  matrix of means</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p><code class="reqn">p \times p</code>  matrix specifying relations
among the rows.
By default, an identity matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p><code class="reqn">q \times q</code>  matrix specifying relations among the
columns.  By default, an identity matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U</code></td>
<td>
<p><code class="reqn">LL^T</code>  - <code class="reqn">p \times p</code>
positive definite variance-covariance
matrix for rows, computed from <code class="reqn">L</code> if not specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p><code class="reqn">R^T R</code>  - <code class="reqn">q \times q</code>
positive definite variance-covariance
matrix for columns, computed from <code class="reqn">R</code>  if not specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>list</code></td>
<td>
<p>Defaults to <code>FALSE</code> . If this is <code>TRUE</code> , then the
output will be a list of matrices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>array</code></td>
<td>
<p>If <code class="reqn">n = 1</code>  and this is not specified and <code>list</code>  is
<code>FALSE</code> , the function will return a matrix containing the one
observation. If <code class="reqn">n &gt; 1</code> , should be the opposite of <code>list</code> .
If <code>list</code>  is <code>TRUE</code> , this will be ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force</code></td>
<td>
<p>If TRUE, will take the input of <code>L</code> and/or <code>R</code>
directly - otherwise computes <code>U</code> and <code>V</code> and uses Cholesky
decompositions. Useful for generating degenerate normal distributions.
Will also override concerns about potentially singular matrices
unless they are not, in fact, invertible.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>quantile for density</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>logical; if TRUE, probabilities p are given as log(p).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>rmatrixnorm</code> returns either a list of
<code class="reqn">n</code>  <code class="reqn">p \times q</code>  matrices or
a <code class="reqn">p \times q \times n</code>  array.
</p>
<p><code>dmatrixnorm</code> returns the density at <code>x</code>.
</p>


<h3>References</h3>

<p>Gupta, Arjun K, and Daya K Nagar. 1999.
Matrix Variate Distributions.
Vol. 104. CRC Press. ISBN:978-1584880462
</p>


<h3>See Also</h3>

<p><code>rmatrixt()</code>, <code>rmatrixinvt()</code>,
<code>rnorm()</code> and <code>stats::Distributions()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(20180202)
# a draw from a matrix variate normal with a certain mean
# and row-wise covariance
rmatrixnorm(
  n = 1, mean = matrix(c(100, 0, -100, 0, 25, -1000), nrow = 2),
  L = matrix(c(2, 1, 0, .1), nrow = 2), list = FALSE
)
set.seed(20180202)
# another way of specifying this - note the output is equivalent
A &lt;- rmatrixnorm(
  n = 10, mean = matrix(c(100, 0, -100, 0, 25, -1000), nrow = 2),
  L = matrix(c(2, 1, 0, .1), nrow = 2), list = TRUE
)
A[[1]]
# demonstrating the dmatrixnorm function
dmatrixnorm(A[[1]],
  mean = matrix(c(100, 0, -100, 0, 25, -1000), nrow = 2),
  L = matrix(c(2, 1, 0, .1), nrow = 2), log = TRUE
)
</code></pre>


</div>