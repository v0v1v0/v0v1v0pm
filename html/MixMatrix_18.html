<div class="container">

<table style="width: 100%;"><tr>
<td>rmatrixt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Distribution functions for the matrix variate t distribution.</h2>

<h3>Description</h3>

<p>Density and random generation for the matrix variate t distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rmatrixt(
  n,
  df,
  mean,
  L = diag(dim(as.matrix(mean))[1]),
  R = diag(dim(as.matrix(mean))[2]),
  U = L %*% t(L),
  V = t(R) %*% R,
  list = FALSE,
  array = NULL,
  force = FALSE
)

dmatrixt(
  x,
  df,
  mean = matrix(0, p, n),
  L = diag(p),
  R = diag(n),
  U = L %*% t(L),
  V = t(R) %*% R,
  log = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations for generation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>degrees of freedom (<code class="reqn">&gt;0</code>, may be non-integer),
<code style="white-space: pre;">⁠df = 0, Inf⁠</code> is allowed and will return a normal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p><code class="reqn">p \times q</code> This is really a 'shift' rather than a
mean, though the expected value will be equal to this if
<code class="reqn">df &gt; 2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p><code class="reqn">p \times p</code>  matrix specifying relations among the rows.
By default, an identity matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p><code class="reqn">q \times q</code>  matrix specifying relations among the
columns. By default, an identity matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U</code></td>
<td>
<p><code class="reqn">LL^T</code>  - <code class="reqn">p \times p</code>   positive definite matrix for
rows, computed from <code class="reqn">L</code> if not specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p><code class="reqn">R^T R</code>  - <code class="reqn">q \times q</code>  positive definite matrix for
columns, computed from <code class="reqn">R</code>  if not specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>list</code></td>
<td>
<p>Defaults to <code>FALSE</code> . If this is <code>TRUE</code> , then the
output will be a list of matrices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>array</code></td>
<td>
<p>If <code class="reqn">n = 1</code>  and this is not specified and <code>list</code>  is
<code>FALSE</code> , the function will return a matrix containing the one
observation. If <code class="reqn">n &gt; 1</code> , should be the opposite of <code>list</code> .
If <code>list</code>  is <code>TRUE</code> , this will be ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force</code></td>
<td>
<p>In <code>rmatrix</code>: if <code>TRUE</code>, will take the input of
<code>R</code> directly - otherwise uses <code>V</code> and uses Cholesky
decompositions. Useful for generating degenerate t-distributions.
Will also override concerns about potentially singular matrices
unless they are not, in fact, invertible.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>quantile for density</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>logical; in <code>dmatrixt</code>, if <code>TRUE</code>, probabilities
<code>p</code> are given as <code>log(p)</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The matrix <code class="reqn">t</code>-distribution is parameterized slightly
differently from the univariate and multivariate <code class="reqn">t</code>-distributions
</p>

<ul><li>
<p> the variance is scaled by a factor of <code>1/df</code>.
In this parameterization, the variance for a <code class="reqn">1 \times 1</code> matrix
variate <code class="reqn">t</code>-distributed random variable with identity variance matrices
is <code class="reqn">1/(df-2)</code> instead of <code class="reqn">df/(df-2)</code>. A Central Limit Theorem
for the matrix variate <code class="reqn">T</code> is then that as <code>df</code> goes to
infinity, <code class="reqn">MVT(0, df, I_p, df*I_q)</code> converges to
<code class="reqn">MVN(0,I_p,I_q)</code>.
</p>
</li></ul>
<h3>Value</h3>

<p><code>rmatrixt</code> returns either a list of <code class="reqn">n</code>
<code class="reqn">p \times q</code>  matrices or a
<code class="reqn">p \times q \times n</code>
array.
</p>
<p><code>dmatrixt</code> returns the density at <code>x</code>.
</p>


<h3>References</h3>

<p>Gupta, Arjun K, and Daya K Nagar. 1999.
Matrix Variate Distributions.
Vol. 104. CRC Press. ISBN:978-1584880462
</p>
<p>Dickey, James M. 1967. “Matricvariate Generalizations of the Multivariate t
Distribution and the Inverted Multivariate t
Distribution.” Ann. Math. Statist. 38 (2): 511–18.
<a href="https://doi.org/10.1214/aoms/1177698967">doi:10.1214/aoms/1177698967</a>
</p>


<h3>See Also</h3>

<p><code>rmatrixnorm()</code>,
<code>rmatrixinvt()</code>,<code>rt()</code> and
<code>stats::Distributions()</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(20180202)
# random matrix with df = 10 and the given mean and L matrix
rmatrixt(
  n = 1, df = 10, mean = matrix(c(100, 0, -100, 0, 25, -1000), nrow = 2),
  L = matrix(c(2, 1, 0, .1), nrow = 2), list = FALSE
)
# comparing 1-D distribution of t to matrix
summary(rt(n = 100, df = 10))
summary(rmatrixt(n = 100, df = 10, matrix(0)))
# demonstrating equivalence of 1x1 matrix t to usual t
set.seed(20180204)
x &lt;- rmatrixt(n = 1, mean = matrix(0), df = 1)
dt(x, 1)
dmatrixt(x, df = 1)
</code></pre>


</div>