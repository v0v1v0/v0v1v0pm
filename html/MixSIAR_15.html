<div class="container">

<table style="width: 100%;"><tr>
<td>run_model</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Run the JAGS model</h2>

<h3>Description</h3>

<p><code>run_model</code> calls JAGS to run the mixing model created by
<code>write_JAGS_model</code>. This happens when the "RUN MODEL" button is
clicked in the GUI.
</p>


<h3>Usage</h3>

<pre><code class="language-R">run_model(
  run,
  mix,
  source,
  discr,
  model_filename,
  alpha.prior = 1,
  resid_err = NULL,
  process_err = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>run</code></td>
<td>
<p>list of MCMC parameters (chainLength, burn, thin, chains, calcDIC).
Alternatively, a user can use a pre-defined parameter set by specifying a
valid string:
</p>

<ul>
<li> <p><code>"test"</code>: chainLength=1000, burn=500, thin=1, chains=3
</p>
</li>
<li> <p><code>"very short"</code>: chainLength=10000, burn=5000, thin=5, chains=3
</p>
</li>
<li> <p><code>"short"</code>: chainLength=50000, burn=25000, thin=25, chains=3
</p>
</li>
<li> <p><code>"normal"</code>: chainLength=100000, burn=50000, thin=50, chains=3
</p>
</li>
<li> <p><code>"long"</code>: chainLength=300000, burn=200000, thin=100, chains=3
</p>
</li>
<li> <p><code>"very long"</code>: chainLength=1000000, burn=500000, thin=500, chains=3
</p>
</li>
<li> <p><code>"extreme"</code>: chainLength=3000000, burn=1500000, thin=500, chains=3
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mix</code></td>
<td>
<p>output from <code>load_mix_data</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>source</code></td>
<td>
<p>output from <code>load_source_data</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>discr</code></td>
<td>
<p>output from <code>load_discr_data</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model_filename</code></td>
<td>
<p>name of JAGS model file (usually should match <code>filename</code>
input to <code>write_JAGS_model</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha.prior</code></td>
<td>
<p>Dirichlet prior on p.global (default = 1, uninformative)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resid_err</code></td>
<td>
<p>include residual error in the model? (no longer used, read from 'model_filename')</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>process_err</code></td>
<td>
<p>include process error in the model? (no longer used, read from 'model_filename')</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>jags.1, a <code>rjags</code> model object
</p>
<p><em>Note: Tracer values are normalized before running the JAGS model.</em> This
allows the same priors to be used regardless of scale of the tracer data, 
without using the data to select the prior (i.e. by setting the prior mean equal
to the sample mean). Normalizing the tracer data does not affect the proportion
estimates (p_k), but does affect users seeking to plot the posterior predictive
distribution for their data. For each tracer, we calculate the pooled mean and
standard deviation of the mix and source data, then subtract the pooled mean 
and divide by the pooled standard deviation from the mix and source data. 
For details, see lines 226-269.
</p>


</div>