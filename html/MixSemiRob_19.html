<div class="container">

<table style="width: 100%;"><tr>
<td>mixregPvary</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mixture of Regression Models with Varying Mixing Proportions</h2>

<h3>Description</h3>

<p>‘mixregPvary’ is used to estimate a mixture of regression models with varying proportions:
</p>
<p style="text-align: center;"><code class="reqn">Y|_{\boldsymbol{x},Z=z} \sim \sum_{c=1}^C\pi_c(z)N(\boldsymbol{x}^{\top}\boldsymbol{\beta}_c,\sigma_c^2).</code>
</p>

<p>The varying proportions are estimated using a local constant regression method (kernel regression).
</p>


<h3>Usage</h3>

<pre><code class="language-R">mixregPvary(x, y, C = 2, z = NULL, u = NULL, h = NULL,
             kernel = c("Gaussian", "Epanechnikov"), ini = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an n by p matrix of explanatory variables. The intercept will be automatically added to x.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>an n-dimensional vector of response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>number of mixture components. Default is 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>a vector of a variable with varying-proportions. It can be any of the variables in <code>x</code>.
Default is NULL, and the first variable in <code>x</code> will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>a vector of grid points for the local constant regression method to estimate the proportions.
If NULL (default), 100 equally spaced grid points are automatically generated
between the minimum and maximum values of z.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>bandwidth for kernel density estimation. If NULL (default), the bandwidth is
calculated based on the method of Botev et al. (2010).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>
<p>character, determining the kernel function used in local constant method:
<code>Gaussian</code> or <code>Epanechnikov</code>. Default is <code>Gaussian</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ini</code></td>
<td>
<p>initial values for the parameters. Default is NULL, which obtains the initial values
using the <code>regmixEM</code> function of the ‘mixtools’ package.
If specified, it can be a list with the form of
<code>list(pi, beta, var)</code>, where
<code>pi</code> is a vector of length C of mixing proportions,
<code>beta</code> is a (p + 1) by C matrix for component regression coefficients, and
<code>var</code> is a vector of length C of component variances.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>pi_u</code></td>
<td>
<p>length(u) by C matrix of estimated mixing proportions at grid points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi_z</code></td>
<td>
<p>n by C matrix of estimated mixing proportions at z.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>(p + 1) by C matrix of estimated component regression coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>C-dimensional vector of estimated component variances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>final log-likelihood.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Huang, M. and Yao, W. (2012). Mixture of regression models with varying mixing proportions:
a semiparametric approach. Journal of the American Statistical Association, 107(498), 711-724.
</p>
<p>Botev, Z. I., Grotowski, J. F., and Kroese, D. P. (2010). Kernel density estimation via diffusion.
The Annals of Statistics, 38(5), 2916-2957.
</p>


<h3>See Also</h3>

<p><code>mixregPvaryGen</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">n = 100
C = 2
u = seq(from = 0, to = 1, length = 100)
true_beta = cbind(c(4, - 2), c(0, 3))
true_var = c(0.09, 0.16)
data = mixregPvaryGen(n, C)
x = data$x
y = data$y
est = mixregPvary(x, y, C, z = x, u, h = 0.08)
</code></pre>


</div>