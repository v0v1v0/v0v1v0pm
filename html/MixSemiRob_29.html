<div class="container">

<table style="width: 100%;"><tr>
<td>semimrBinFull</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Semiparametric Mixture of Binomial Regression with a Degenerate Component
with Constant Proportion and Time-Varying Success Probability (Backfitting)</h2>

<h3>Description</h3>

<p>‘semimrBinFull’ implements the backfitting method (Cao and Yao, 2012)
for semiparametric estimation of a mixture of binomial distributions with one degenerate component,
with constant proportion and time-varying success probability <code class="reqn">p</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">semimrBinFull(t, x, N, tg = NULL, tune = 1, tol = 1e-02)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>a vector of time variable along which <code class="reqn">p(t)</code> varies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a vector of observed number of successes. The length of <code>t</code> and <code>x</code> must be the same.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>a scalar, specifying the number of trials for the Binomial distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tg</code></td>
<td>
<p>grid points of time used in the kernel regression for the estimation of <code class="reqn">p(t)</code>.
Default is NULL, and 100 equally spaced grid points will automatically generated
using the minimum and maximum values of <code>t</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tune</code></td>
<td>
<p>a scalar, specifying the percentage of data included in local estimation.
related to the bandwidth selection and local estimation. Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>stopping criteria for the algorithm.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The semiparametric mixture of binomial regression model is as follows:
</p>
<p style="text-align: center;"><code class="reqn">w \times (N,p(t))+(1-w)\times B(N,0),</code>
</p>

<p>where <code class="reqn">B(N,p)</code> is the probability mass function of a binomial distribution
with the number of trials <code class="reqn">N</code> and the success probability <code class="reqn">p</code>.
Here, the second component is a degenerate distribution with mass 1 on 0.
The time-varying success probability <code class="reqn">p(t)</code> for the binomial components
are estimated by the kernel regression using a full iterative backfitting procedure with some bandwidth.
</p>


<h3>Value</h3>

<p>A list containing the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>pt</code></td>
<td>
<p>estimated time-varying success probabilities for the first component.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>estimated constant proportion for the first component.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>bandwidth for the kernel regression. The bandwidth calculation can be found in Section 4 of Cao and Yao (2012).</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Cao, J. and Yao, W. (2012). Semiparametric mixture of binomial regression with a degenerate component.
Statistica Sinica, 27-46.
</p>


<h3>See Also</h3>

<p><code>semimrBin</code>, <code>semimrBinOne</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">nobs = 50
tobs = seq(from = 0, to = 1, length.out = nobs)
pi1Tru = 0.4
ptTru = 0.3 * (1.5 + cos(2 * pi * tobs))
nfine = nobs
tfine = seq(from = 0, to = 1, length.out = nfine)
b = rbinom(nobs, size = 1, pi1Tru)
yobs = apply(X = matrix(ptTru), 1, rbinom, n = 1, size = 7)
yobs = ifelse(b == 1, 0, yobs)
ftfull = semimrBinFull(t = tobs, x = yobs, N = 7, tg = tfine)
</code></pre>


</div>