<div class="container">

<table style="width: 100%;"><tr>
<td>semimrLocal</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Semiparametric Mixtures of Nonparametric Regressions with Local EM-type Algorithm</h2>

<h3>Description</h3>

<p>‘semimrLocal’ is used to estimate a mixture of regression models, where the mixing proportions
and variances remain constant, but the component regression functions are smooth functions (<code class="reqn">m(\cdot)</code>)
of a covariate. The model is expressed as follows:
</p>
<p style="text-align: center;"><code class="reqn">\sum_{j=1}^C\pi_j\phi(y|m(x_j),\sigma^2_j).</code>
</p>

<p>This function provides the one-step backfitting estimate using the local EM-type algorithm (LEM) (Xiang and Yao, 2018).
As of version 1.1.0, this function supports a two-component model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">semimrLocal(x, y, u = NULL, h = NULL, ini = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a vector of covariate values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector of response values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>a vector of grid points for spline method to estimate the proportions.
If NULL (default), 100 equally spaced grid points are automatically generated
between the minimum and maximum values of x.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>bandwidth for the nonparametric regression. If NULL (default), the bandwidth is
calculated based on the method of Botev et al. (2010).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ini</code></td>
<td>
<p>initial values for the parameters. Default is NULL, which obtains the initial values
using regression spline approximation. If specified, it can be a list with the form of
<code>list(pi, mu, var)</code>, where
<code>pi</code> is a vector of length 2 of mixing proportions,
<code>mu</code> is a length(x) by 2 matrix of component means with length(x) rows, and
<code>var</code> is a vector of length 2 of variances.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>pi</code></td>
<td>
<p>vector of length 2 of estimated mixing proportions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>length(x) by 2 matrix of estimated mean functions at x, <code class="reqn">m(x)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu_u</code></td>
<td>
<p>length(u) by 2 matrix of estimated mean functions at grid point u, <code class="reqn">m(u)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>vector of length 2 estimated component variances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lik</code></td>
<td>
<p>final likelihood.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Xiang, S. and Yao, W. (2018). Semiparametric mixtures of nonparametric regressions.
Annals of the Institute of Statistical Mathematics, 70, 131-154.
</p>
<p>Botev, Z. I., Grotowski, J. F., and Kroese, D. P. (2010). Kernel density estimation via diffusion.
The Annals of Statistics, 38(5), 2916-2957.
</p>


<h3>See Also</h3>

<p><code>semimrGlobal</code>, <code>semimrGen</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># produce data that matches the description using semimrGen function
# true_mu = (4 - sin(2 * pi * x), 1.5 + cos(3 * pi * x))
n = 100
u = seq(from = 0, to = 1, length = 100)
true_p = c(0.3, 0.7)
true_var = c(0.09, 0.16)
out = semimrGen(n, true_p[1], true_var, u)

x = out$x
y = out$y
true_mu = out$true_mu
true = list(true_p = true_p, true_mu = true_mu, true_var = true_var)

# estimate parameters using semimrLocal function.
est = semimrLocal(x, y)
</code></pre>


</div>