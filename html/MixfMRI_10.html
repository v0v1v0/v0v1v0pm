<div class="container">

<table style="width: 100%;"><tr>
<td>Covariance Matrices of Logit ETA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Covariance Matrices of Logit ETA</h2>

<h3>Description</h3>

<p>These functions computes covariance matrix of logit ETA.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  cov.logit.ETA(x, fcobj, cov.param = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an input list of two elements <code>X.gbd</code> and <code>PV.gbd</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fcobj</code></td>
<td>
<p>a <code>fclust</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.param</code></td>
<td>
<p>a covariance matrix of <code>dim = d * d</code> for parameters,
which is also a return of <code>cov.param()</code>.
<code>d</code> is total number of parameters which is dependent
on data and models.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These functions are required to compute covariance matrices of
logit ETA.
</p>
<p>Input the returns of <code>cov.param()</code>
to <code>cov.logit.ETA()</code> to obtain the cov matrix for logit ETA
by the multivariate delta method on the cov matrix for parameters.
</p>


<h3>Value</h3>

<p>A matrix.
</p>


<h3>Author(s)</h3>

<p>Wei-Chen Chen and Ranjan Maitra.
</p>


<h3>References</h3>

<p>Chen, W.-C. and Maitra, R. (2021)
“A Practical Model-based Segmentation Approach for Accurate
Activation Detection in Single-Subject functional Magnetic
Resonance Imaging Studies”,
<em>arXiv:2102.03639</em>.
</p>


<h3>See Also</h3>

<p><code>EMCluster::lmt()</code>, <code>lmt.I()</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(MixfMRI, quietly = TRUE)
.FC.CT$model.X &lt;- "I"
.FC.CT$CONTROL$debug &lt;- 0
K &lt;- 3
  

.rem &lt;- function(){

  ### Fit toy1.
  set.seed(1234)
  X.gbd &lt;- toy1$X.gbd
  X.range &lt;- apply(X.gbd, 2, range)
  X.gbd &lt;- t((t(X.gbd) - X.range[1,]) / (X.range[2,] - X.range[1,]))
  PV.gbd &lt;- toy1$PV.gbd
  fcobj &lt;- fclust(X.gbd, PV.gbd, K = K, min.1st.prop = 0.5)
  
  ### Test cov matrix of posterior z.
  x &lt;- list(X.gbd = X.gbd, PV.gbd = PV.gbd)
  post.z &lt;- post.prob(x, fcobj)
  cov.param &lt;- cov.param(x, fcobj, post.z)
  cov.logit.ETA &lt;- cov.logit.ETA(x, fcobj, cov.param = cov.param$cov)
  
  ### Compute cov matrxi of eta_k - eta_1 for all k &gt; 1.
  A &lt;- cbind(rep(-1, K - 1), diag(1, K - 1))
  ETA &lt;- fcobj$param$ETA
  log.or &lt;- log(ETA / (1 - ETA)) %*% t(A)
  cov.log.or &lt;- A %*% cov.logit.ETA %*% t(A)

}

</code></pre>


</div>