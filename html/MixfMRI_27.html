<div class="container">

<table style="width: 100%;"><tr>
<td>Likelihood Mixture Tests with Identity Cov Matrix or Only p-values</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Likelihood Mixture Tests with Identity Cov Matrix or Only p-values</h2>

<h3>Description</h3>

<p>These functions test two mixture Gaussian fMRI models with diagonal
covariance matrices and different numbers of clusters.
These functions are similar to the <code>EMCluster::lmt(</code>), but is coded
for fMRI models in <span class="pkg">MixfMRI</span>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  lmt.I(fcobj.0, fcobj.a, X.gbd, PV.gbd, tau = 0.5, n.mc.E.delta = 1000,
        n.mc.E.chi2 = 1000, verbose = FALSE)
  lmt.pv(fcobj.0, fcobj.a, X.gbd, PV.gbd, tau = 0.5, n.mc.E.delta = 1000,
        n.mc.E.chi2 = 1000, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fcobj.0</code></td>
<td>
<p>a <code>fclust</code> object for the null hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fcobj.a</code></td>
<td>
<p>a <code>fclust</code> object for the alternative hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X.gbd</code></td>
<td>
<p>a data matrix of <code>N</code> voxel locations.
<code>dim(X.gbd) = N x 3</code> for 3D data and
<code>N x 2</code> for 2D data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PV.gbd</code></td>
<td>
<p>a p-value vector of signals associated with voxels.
<code>length(PV.gbd) = N</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>proportion of null and alternative hypotheses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.mc.E.delta</code></td>
<td>
<p>number of Monte Carlo simulations for expectation
of delta (difference of logL).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.mc.E.chi2</code></td>
<td>
<p>number of Monte Carlo simulations for expectation
of chisquare statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>if verbose.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function calls several subroutines to compute information,
likelihood ratio statistics, degrees of freedom, non-centrality
of chi-squared distributions ... etc. Based on Monte Carlo methods
to estimate parameters of likelihood mixture tests, this function
return a p-value for testing H0: <code>fcobj.0</code> v.s. Ha: <code>fcobj.a</code>.
</p>
<p><code>lmt.pv()</code> only uses <code>PV.gbd</code>.
</p>


<h3>Value</h3>

<p>A list of class <code>lmt.I</code> are returned.
</p>


<h3>Author(s)</h3>

<p>Wei-Chen Chen and Ranjan Maitra.
</p>


<h3>References</h3>

<p>Chen, W.-C. and Maitra, R. (2021)
“A Practical Model-based Segmentation Approach for Accurate
Activation Detection in Single-Subject functional Magnetic
Resonance Imaging Studies”,
<em>arXiv:2102.03639</em>.
</p>


<h3>See Also</h3>

<p><code>EMCluster::lmt()</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(MixfMRI, quietly = TRUE)
library(EMCluster, quietly = TRUE)
.FC.CT$model.X &lt;- "I"
.FC.CT$check.X.unit &lt;- FALSE
.FC.CT$CONTROL$debug &lt;- 0
  

.rem &lt;- function(){

  ### Fit toy1.
  set.seed(1234)
  X.gbd &lt;- toy1$X.gbd
  PV.gbd &lt;- toy1$PV.gbd
  ret.2 &lt;- fclust(X.gbd, PV.gbd, K = 2)
  ret.3 &lt;- fclust(X.gbd, PV.gbd, K = 3)
  ret.4 &lt;- fclust(X.gbd, PV.gbd, K = 4)
  ret.5 &lt;- fclust(X.gbd, PV.gbd, K = 5)
  
  ### ARI
  RRand(toy1$CLASS.gbd, ret.2$class)
  RRand(toy1$CLASS.gbd, ret.3$class)
  RRand(toy1$CLASS.gbd, ret.4$class)
  RRand(toy1$CLASS.gbd, ret.5$class)
  
  ### Test toy1.
  (lmt.23 &lt;- lmt.I(ret.2, ret.3, X.gbd, PV.gbd))
  (lmt.24 &lt;- lmt.I(ret.2, ret.4, X.gbd, PV.gbd))
  (lmt.25 &lt;- lmt.I(ret.2, ret.5, X.gbd, PV.gbd))
  (lmt.34 &lt;- lmt.I(ret.3, ret.4, X.gbd, PV.gbd))
  (lmt.35 &lt;- lmt.I(ret.3, ret.5, X.gbd, PV.gbd))
  (lmt.45 &lt;- lmt.I(ret.4, ret.5, X.gbd, PV.gbd))
  
  ### Test toy1 using p-values only.
  (lmt.pv.23 &lt;- lmt.pv(ret.2, ret.3, X.gbd, PV.gbd))
  (lmt.pv.24 &lt;- lmt.pv(ret.2, ret.4, X.gbd, PV.gbd))
  (lmt.pv.25 &lt;- lmt.pv(ret.2, ret.5, X.gbd, PV.gbd))
  (lmt.pv.34 &lt;- lmt.pv(ret.3, ret.4, X.gbd, PV.gbd))
  (lmt.pv.35 &lt;- lmt.pv(ret.3, ret.5, X.gbd, PV.gbd))
  (lmt.pv.45 &lt;- lmt.pv(ret.4, ret.5, X.gbd, PV.gbd))

}

</code></pre>


</div>