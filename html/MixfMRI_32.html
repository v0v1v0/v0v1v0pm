<div class="container">

<table style="width: 100%;"><tr>
<td>LRT</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Likelihood ratio tests</h2>

<h3>Description</h3>

<p>Likelihood ratio tests for merging clusters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  lrt(PV.gbd, CLASS.gbd, K, H0.alpha = .FC.CT$LRT$H0.alpha,
      H0.beta = .FC.CT$LRT$H0.beta)

  lrt2(PV.gbd, CLASS.gbd, K, H0.mean = .FC.CT$LRT$H0.mean,
    upper.beta = .FC.CT$INIT$BETA.beta.max, proc = c("1", "2", "weight"))

  lrt.betamean(PV.gbd, CLASS.gbd, K, proc = c("1", "2"))

  lrt.betaab(PV.gbd, CLASS.gbd, K, proc = c("1", "2"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>PV.gbd</code></td>
<td>
<p>a p-value vector of signals associated with voxels.
<code>length(PV.gbd) = N</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CLASS.gbd</code></td>
<td>
<p>a classification vector of signals associated with voxels.
<code>length(CLASS.gbd) = N</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>number of clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H0.alpha</code></td>
<td>
<p>null hypothesis for the alpha parameter of Beta distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H0.beta</code></td>
<td>
<p>null hypothesis for the beta parameter of Beta distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H0.mean</code></td>
<td>
<p>null hypothesis for the mean of Beta distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper.beta</code></td>
<td>
<p>BETA.beta.max, maximum value of beta parameter of
Beta distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proc</code></td>
<td>
<p>q-value procedure for adjusting p-values.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These functions perform likelihood ratio tests for merging clusters.
Only p-values coordinates (Beta density) are tested, while
voxel location coordinates (multivariate Normal density) are not involved
in testing.
</p>
<p><code>lrt.betamean</code> tests if means of any two pairs of mixture
(p-value) component were the same.
The chi-square distribution with 1 degree of freedom is used.
</p>
<p><code>lrt.betaab</code> tests if alpha and beta of any two pairs of mixture
(p-value) components were the same.
The chi-square distribution with 2 degrees of freedom is used.
</p>
<p>Procedure to adjust/select plausible p-values,
<code>proc = "1"</code> uses q-value <code>qvalue()</code>,
<code>proc = "2"</code> uses <code>fdr.bh.p2()</code>, and
<code>proc = "weight"</code> uses a weighted version of <code>fdr.bh.p2()</code>.
</p>


<h3>Value</h3>

<p>A matrix contains MLEs of parameters of Beta distribution under the null
hypothesis and the union of null and alternative hypotheses. The matrix
also contains testing statistics and p-values.
</p>


<h3>Author(s)</h3>

<p>Wei-Chen Chen and Ranjan Maitra.
</p>


<h3>References</h3>

<p>Chen, W.-C. and Maitra, R. (2021)
“A Practical Model-based Segmentation Approach for Accurate
Activation Detection in Single-Subject functional Magnetic
Resonance Imaging Studies”,
<em>arXiv:2102.03639</em>.
</p>


<h3>See Also</h3>

<p><code>PARAM</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(MixfMRI, quietly = TRUE)
set.seed(1234)

### Test 2d data.
da &lt;- pval.2d.mag
id &lt;- !is.na(da)
PV.gbd &lt;- da[id]
id.loc &lt;- which(id, arr.ind = TRUE)
X.gbd &lt;- t(t(id.loc) / dim(da))
ret &lt;- fclust(X.gbd, PV.gbd, K = 2, min.1st.prop = 0.95)
# print(ret)

### p-values of rest clusters.
ret.lrt &lt;- lrt(PV.gbd, ret$class, K = 2)
print(ret.lrt)

.rem &lt;- function(){

  ret.lrt2 &lt;- lrt2(PV.gbd, ret$class, K = 3)
  print(ret.lrt2)

}

</code></pre>


</div>