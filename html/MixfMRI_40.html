<div class="container">

<table style="width: 100%;"><tr>
<td>Plotting</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Main plotting function</h2>

<h3>Description</h3>

<p>Main plotting function in <span class="pkg">MixfMRI</span>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  plotfclust(da, posterior, main = NULL, xlim = NULL, ylim = NULL)
  plotfclustpv(da, posterior, main = NULL, xlim = NULL, ylim = NULL)

  plotpv(da, posterior, PARAM, zlim = c(0, 0.01), plot.mean = TRUE,
         xlab = "", ylab = "", main = NULL, xlim = NULL, ylim = NULL,
         col = my.YlOrRd(), ignore.bg = FALSE)
  plotpvlegend(zlim = c(0, 0.01), n.level = 20, main = NULL,
               col = my.YlOrRd())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>da</code></td>
<td>
<p>a data set to be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posterior</code></td>
<td>
<p>a posterior data set to be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PARAM</code></td>
<td>
<p>a returning parameter object from <code>fclust()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>title of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>limits of x-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>limits of y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zlim</code></td>
<td>
<p>limits of z-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>labels of x-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>labels of y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.mean</code></td>
<td>
<p>if plotting mean values of each cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>colors to be drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ignore.bg</code></td>
<td>
<p>if ignoring the background.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.level</code></td>
<td>
<p>number of levels to be plotted.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These are example functions to plot results, simulations, and datasets.
</p>


<h3>Value</h3>

<p>Return plots.
</p>


<h3>Author(s)</h3>

<p>Wei-Chen Chen and Ranjan Maitra.
</p>


<h3>References</h3>

<p>Chen, W.-C. and Maitra, R. (2021)
“A Practical Model-based Segmentation Approach for Accurate
Activation Detection in Single-Subject functional Magnetic
Resonance Imaging Studies”,
<em>arXiv:2102.03639</em>.
</p>


<h3>See Also</h3>

<p><code>set.global()</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(MixfMRI, quietly = TRUE)
set.seed(1234)
  

.rem &lt;- function(){

  ### Check 2d data.
  da &lt;- pval.2d.complex
  id &lt;- !is.na(da)
  PV.gbd &lt;- da[id]
  hist(PV.gbd, nclass = 100, main = "p-value")
  
  ### Test 2d data.
  id.loc &lt;- which(id, arr.ind = TRUE)
  X.gbd &lt;- t(t(id.loc) / dim(da))
  ret &lt;- fclust(X.gbd, PV.gbd, K = 3)
  print(ret)
  
  ### p-values of rest clusters.
  ret.lrt &lt;- lrt(PV.gbd, ret$class, K = 3)
  print(ret.lrt)
  ret.lrt2 &lt;- lrt2(PV.gbd, ret$class, K = 3)
  print(ret.lrt2)
  
  ### Plotting.
  par(mfrow = c(2, 2), mar = c(0, 0, 2, 0))
  plotpv(da, ret$posterior, ret$param,
         zlim = c(0.005, 0.008), main = "Mean of Beta Distribution")
  plotpv(da, ret$posterior, ret$param,
         plot.mean = FALSE, main = "p-value")
  par(mar = c(5.1, 4.1, 4.1, 2.1))
  plotpvlegend(zlim = c(0.005, 0.008), main = "Mean of Beta Distribution")
  plotpvlegend(zlim = c(0, 0.01), main = "p-value")

}

</code></pre>


</div>