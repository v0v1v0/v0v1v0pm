<div class="container">

<table style="width: 100%;"><tr>
<td>MGHM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multivariate Generalized Hyperbolic Mixture (MGHM)</h2>

<h3>Description</h3>

<p>Carries out model-based clustering using a multivariate generalized hyperbolic
mixture (MGHM). The function will determine itself if the data set is
complete or incomplete and fit the appropriate model accordingly. In the incomplete
case, the data set must be at least bivariate, and missing values are assumed to
be missing at random (MAR).
</p>


<h3>Usage</h3>

<pre><code class="language-R">MGHM(
  X,
  G,
  model = c("GH", "NIG", "SNIG", "SC", "C", "St", "t", "N", "SGH", "HUM", "H", "SH"),
  criterion = c("BIC", "AIC", "KIC", "KICc", "AIC3", "CAIC", "AICc", "ICL", "AWE", "CLC"),
  max_iter = 20,
  epsilon = 0.01,
  init_method = c("kmedoids", "kmeans", "hierarchical", "mclust", "manual"),
  clusters = NULL,
  outlier_cutoff = 0.95,
  deriv_ctrl = list(eps = 1e-08, d = 1e-04, zero.tol = sqrt(.Machine$double.eps/7e-07), r
    = 6, v = 2, show.details = FALSE),
  progress = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">d</code> matrix or data frame where <code class="reqn">n</code> is the number of
observations and <code class="reqn">d</code> is the number of variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>An integer vector specifying the numbers of clusters, which must be at least 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>A string indicating the mixture model to be fitted; "GH" for generalized
hyperbolic by default. See the details section for a list of available distributions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>A character string indicating the information criterion for model
selection. "BIC" is used by default. See the details section for a list of available
information criteria.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_iter</code></td>
<td>
<p>(optional) A numeric value giving the maximum number of
iterations each EM algorithm is allowed to use; 20 by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>(optional) A number specifying the epsilon value for the
Aitken-based stopping criterion used in the EM algorithm: 0.01 by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init_method</code></td>
<td>
<p>(optional) A string specifying the method to initialize
the EM algorithm. "kmedoids" clustering is used by default. Alternative
methods include "kmeans", "hierarchical", "mclust", and "manual". When "manual" is chosen,
a vector <code>clusters</code> of length <code class="reqn">n</code> must be specified. If the data set is
incomplete, missing values will be first filled based on the mean imputation method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clusters</code></td>
<td>
<p>(optional) A vector of length <code class="reqn">n</code> that specifies the initial
cluster memberships of the user when <code>init_method</code> is set to "manual".
Both numeric and character vectors are acceptable. This argument is NULL by
default, so that it is ignored whenever other given initialization methods
are chosen.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outlier_cutoff</code></td>
<td>
<p>(optional) A number between 0 and 1 indicating the
percentile cutoff used for outlier detection. This is only relevant for t mixture.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deriv_ctrl</code></td>
<td>
<p>(optional) A list containing arguments to control the numerical
procedures for calculating the first and second derivatives. Some values are
suggested by default. Refer to functions <code>grad</code> and <code>hessian</code> under
the package <code>numDeriv</code> for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>
<p>(optional) A logical value indicating whether the
fitting progress should be displayed; TRUE by default.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Beside the generalized hyperbolic distribution, the function can fit mixture
via its special and limiting cases. Available distributions include
</p>

<ul>
<li>
<p> GH - Generalized Hyperbolic
</p>
</li>
<li>
<p> NIG - Normal-Inverse Gaussian
</p>
</li>
<li>
<p> SNIG - Symmetric Normal-Inverse Gaussian
</p>
</li>
<li>
<p> SC - Skew-Cauchy
</p>
</li>
<li>
<p> C - Cauchy
</p>
</li>
<li>
<p> St - Skew-<em>t</em>
</p>
</li>
<li>
<p> t - Student's <em>t</em>
</p>
</li>
<li>
<p> N - Normal or Gaussian
</p>
</li>
<li>
<p> SGH - Symmetric Generalized Hyperbolic
</p>
</li>
<li>
<p> HUM- Hyperbolic Univariate Marginals
</p>
</li>
<li>
<p> H - Hyperbolic
</p>
</li>
<li>
<p> SH - Symmetric Hyperbolic
</p>
</li>
</ul>
<p>Available information criteria include
</p>

<ul>
<li>
<p> AIC - Akaike information criterion
</p>
</li>
<li>
<p> BIC - Bayesian information criterion
</p>
</li>
<li>
<p> KIC - Kullback information criterion
</p>
</li>
<li>
<p> KICc - Corrected Kullback information criterion
</p>
</li>
<li>
<p> AIC3 - Modified AIC
</p>
</li>
<li>
<p> CAIC - Bozdogan's consistent AIC
</p>
</li>
<li>
<p> AICc - Small-sample version of AIC
</p>
</li>
<li>
<p> ICL - Integrated Completed Likelihood criterion
</p>
</li>
<li>
<p> AWE - Approximate weight of evidence
</p>
</li>
<li>
<p> CLC - Classification likelihood criterion
</p>
</li>
</ul>
<h3>Value</h3>

<p>An object of class <code>MixtureMissing</code> with:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>The model used to fit the data set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi</code></td>
<td>
<p>Mixing proportions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>Component location vectors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>Component dispersion matrices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Component skewness vectors. Only available if <code>model</code> is GH, NIG, SNIG, SC, SGH, HUM, H, or SH; NULL otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Component index parameters. Only available if <code>model</code> is GH, NIG, SNIG, SGH, HUM, H, or SH; NULL otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omega</code></td>
<td>
<p>Component concentration parameters. Only available if <code>model</code> is GH, NIG, SNIG, SGH, HUM, H, or SH; NULL otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>Component degrees of freedom. Only available if <code>model</code> is St or t; NULL otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z_tilde</code></td>
<td>
<p>An <code class="reqn">n</code> by <code class="reqn">G</code> matrix where each row indicates the expected
probabilities that the corresponding observation belongs to each cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clusters</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n</code> indicating cluster
memberships determined by the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outliers</code></td>
<td>
<p>A logical vector of length <code class="reqn">n</code> indicating observations that are outliers. Only available if <code>model</code> is t; NULL otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The original data set if it is complete; otherwise, this is
the data set with missing values imputed by appropriate expectations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>complete</code></td>
<td>
<p>An <code class="reqn">n</code> by <code class="reqn">d</code> logical matrix indicating which cells have no missing values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npar</code></td>
<td>
<p>The breakdown of the number of parameters to estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_iter</code></td>
<td>
<p>Maximum number of iterations allowed in the EM algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter_stop</code></td>
<td>
<p>The actual number of iterations needed when fitting the
data set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>final_loglik</code></td>
<td>
<p>The final value of log-likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>All the values of log-likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AIC</code></td>
<td>
<p>Akaike information criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BIC</code></td>
<td>
<p>Bayesian information criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>KIC</code></td>
<td>
<p>Kullback information criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>KICc</code></td>
<td>
<p>Corrected Kullback information criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AIC3</code></td>
<td>
<p>Modified AIC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CAIC</code></td>
<td>
<p>Bozdogan's consistent AIC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AICc</code></td>
<td>
<p>Small-sample version of AIC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ent</code></td>
<td>
<p>Entropy.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ICL</code></td>
<td>
<p>Integrated Completed Likelihood criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AWE</code></td>
<td>
<p>Approximate weight of evidence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CLC</code></td>
<td>
<p>Classification likelihood criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init_method</code></td>
<td>
<p>The initialization method used in model fitting.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Browne, R. P. and McNicholas, P. D. (2015). A mixture of generalized hyperbolic distributions.
<em>Canadian Journal of Statistics</em>, 43(2):176–198. <br><br>
Wei, Y., Tang, Y., and McNicholas, P. D. (2019). Mixtures of generalized hyperbolic
distributions and mixtures of skew-<em>t</em> distributions for model-based clustering
with incomplete data. <em>Computational Statistics &amp; Data Analysis</em>, 130:18–41.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data('bankruptcy')

#++++ With no missing values ++++#

X &lt;- bankruptcy[, 2:3]
mod &lt;- MGHM(X, G = 2, init_method = 'kmedoids', max_iter = 10)

summary(mod)
plot(mod)

#++++ With missing values ++++#

set.seed(1234)

X &lt;- hide_values(bankruptcy[, 2:3], prop_cases = 0.1)
mod &lt;- MGHM(X, G = 2, init_method = 'kmedoids', max_iter = 10)

summary(mod)
plot(mod)

</code></pre>


</div>