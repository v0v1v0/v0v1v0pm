<div class="container">

<table style="width: 100%;"><tr>
<td>estimate_lineages</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate Lineage Proportions In Samples</h2>

<h3>Description</h3>

<p>Create summary tables containing data on lineages identified in samples, including estimates of relative proportions of lineages and identities of associated characteristic mutations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">estimate_lineages(
  muts.df,
  min.alt.freq = 0.01,
  dates = NULL,
  lineage.muts = NULL,
  read.muts.from = NULL,
  scale = TRUE,
  use.median = FALSE,
  outfile.name = NULL,
  presence.thresh = 0.5,
  samps.to.inc = NULL,
  locs.to.inc = NULL,
  lineages.to.inc = NULL,
  report.all = FALSE,
  depths.from = "all"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>muts.df</code></td>
<td>
<p>A data frame (produced by <code>call_mutations()</code>) storing mutation information for samples to analyze. Must contain columns SAMP_NAME, CHR, POS, GENE, ALT_ID, AF, &amp; DP. Alternatively, the mutation data can be read in from a (comma-separated) file with the <code>read.muts.from()</code> argument. See the <em>write.mut.table</em> argument in <code>call_mutations()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.alt.freq</code></td>
<td>
<p>Minimum frequency (0-1) for mutation to be counted. Default = 0.01.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dates</code></td>
<td>
<p>Path to optional csv file with cols "SAMP_NAME", "LOCATION", and "DATE". Sample names need to match those in <em>samp_mutations</em> data frame created by <code>call_mutations()</code>. Dates should be provided in the format <em>mmddyyyy</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lineage.muts</code></td>
<td>
<p><em>(Required)</em> Path to csv file with cols "Gene", "Mutation", and  "Lineage" defining mutations associated with lineages of interest. See example file at "https://github.com/mikesovic/MixviR/blob/main/mutation_files/outbreak_20220217.csv". Additional columns will be ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>read.muts.from</code></td>
<td>
<p>An alternative to <em>muts.df</em> for providing input. If a data frame generated by <code>call_mutations()</code> was previously written to a (comma-separated) file (see <em>write.mut.table</em> in <code>call_mutations()</code>), the mutation data can be read in from that file by providing its path.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>Logical to indicate whether estimated proportions of lineages within a sample should be scaled down to sum to 1 if the sum of the initial estimates is &gt; 1. Default = TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.median</code></td>
<td>
<p>Logical to define the metric used to estimate frequencies of lineages in samples. Default = FALSE (mean is used).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outfile.name</code></td>
<td>
<p>If writing output to file, a character string giving the name/path of the file (csv) to be written.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>presence.thresh</code></td>
<td>
<p>Numeric (0-1) defining a proportion of characteristic mutations that must be present in the sample for a lineage to be considered present. This threshold is applied if <em>report.all</em> = FALSE (the default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samps.to.inc</code></td>
<td>
<p>Character vector of one or more sample names to include. If NULL (default), all samples are included.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>locs.to.inc</code></td>
<td>
<p>Character vector of one or more locations to include. If NULL (default), all locations are included. Applies only if a dates file is provided, and these locations must match those in the 'LOCATION' column of that file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lineages.to.inc</code></td>
<td>
<p>Character vector of one or more lineages to test for and report in results. If NULL (default), all lineages listed in the lineage.muts file are evaluated and reported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>report.all</code></td>
<td>
<p>Logical indicating whether to report results for all lineages (TRUE), or just those with a proportion of mutations present that exceeds <em>presence.thresh</em>. Default FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>depths.from</code></td>
<td>
<p>Character, one of "all" (default) or "characteristic". If "all", average sequencing depths are calculated based on all mutations in a sample. If "characteristic", mean depths are calculated from the set of mutations that occur in only one analyzed lineage (mutations shared by two or more lineages are filtered out prior to calculating depths).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Data frame containing estimates of proportions of each lineage in the sample.
</p>


<h3>Examples</h3>

<pre><code class="language-R">estimate_lineages(lineage.muts = system.file("extdata", 
                                             "example_lineage_muts.csv", 
                                             package = "MixviR"), 
                  read.muts.from = system.file("extdata", 
                                               "sample_mutations.csv", 
                                               package = "MixviR"))
</code></pre>


</div>