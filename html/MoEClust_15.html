<div class="container">

<table style="width: 100%;"><tr>
<td>MoEClust-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MoEClust: Gaussian Parsimonious Clustering Models with Covariates and a Noise Component</h2>

<h3>Description</h3>

<p>Clustering via parsimonious Gaussian Mixtures of Experts using the <em>MoEClust</em> models introduced by Murphy and Murphy (2020) &lt;<a href="https://doi.org/10.1007/s11634-019-00373-8">doi:10.1007/s11634-019-00373-8</a>&gt;. This package fits finite Gaussian mixture models with gating and/or expert network covariates using a range of parsimonious covariance parameterisations from the GPCM family via the EM/CEM algorithm. Visualisation of the results of such models using generalised pairs plots and the inclusion of an additional noise component is also facilitated.
</p>


<h3>Usage</h3>

<p>The most important function in the <span class="pkg">MoEClust</span> package is: <code>MoE_clust</code>, for fitting the model via EM/CEM with gating and/or expert network covariates, supplied via formula interfaces.
</p>
<p><code>MoE_compare</code> is provided for conducting model selection between different results from <code>MoE_clust</code> using different covariate combinations &amp;/or initialisation strategies, etc.
</p>
<p><code>MoE_stepwise</code> is provided for conducting a greedy forward stepwise search to identify the optimal model in terms of the number of components, GPCM covariance type, and the subsets of gating/expert network covariates.
</p>
<p><code>MoE_control</code> allows supplying additional arguments to <code>MoE_clust</code> and <code>MoE_stepwise</code> which govern, among other things, controls on the inclusion of an additional noise component and controls on the initialisation of the allocations for the EM/CEM algorithm.
</p>
<p>A dedicated plotting function (<code>plot.MoEClust</code>) exists for visualising the results using generalised pairs plots, for examining the gating network, and/or log-likelihood, and/or clustering uncertainties, and/or similarity matrix, and/or graphing model selection criteria values. The generalised pairs plots (<code>MoE_gpairs</code>) visualise all pairwise relationships between clustered response variables and associated continuous, categorical, and/or ordinal covariates in the gating &amp;/or expert networks, coloured according to the MAP classification, and also give the marginal distributions of each variable (incl. the covariates) along the diagonal.
</p>
<p>An <code>as.Mclust</code> method is provided to coerce the output of class <code>"MoEClust"</code> from <code>MoE_clust</code> to the <code>"Mclust"</code> class, to facilitate use of plotting and other functions for the <code>"Mclust"</code> class within the <span class="pkg">mclust</span> package. As per <span class="pkg">mclust</span>, <span class="pkg">MoEClust</span> also facilitates modelling with an additional noise component (with or without the mixing proportion for the noise component depending on covariates).
</p>
<p>Finally, a <code>predict</code> method is provided for predicting the fitted response and probability of cluster membership (and by extension the MAP classification) for new data, in the form of new covariates and new response data, or new covariates only.
</p>
<p>Other functions also exist, e.g. <code>MoE_crit</code>, <code>MoE_dens</code>, <code>MoE_estep</code>, <code>MoE_compare</code>, and <code>aitken</code>, which are all used within <code>MoE_clust</code> but are nonetheless made available for standalone use. 
</p>
<p>The package also contains two data sets: <code>ais</code> and <code>CO2data</code>.
</p>


<h3>Details</h3>


<dl>
<dt>Type: </dt>
<dd>
<p>Package</p>
</dd>
<dt>Package: </dt>
<dd>
<p>MoEClust</p>
</dd>
<dt>Version: </dt>
<dd>
<p>1.5.2</p>
</dd>
<dt>Date: </dt>
<dd>
<p>2023-12-10 (this version), 2017-11-28 (original release)</p>
</dd>
<dt>Licence: </dt>
<dd>
<p>GPL (&gt;= 3)</p>
</dd>
</dl>
<h3>See Also</h3>

<p>Further details and examples are given in the associated vignette document:<br><code>vignette("MoEClust", package = "MoEClust")</code>
</p>


<h3>Author(s)</h3>

<p>Keefe Murphy [aut, cre], Thomas Brendan Murphy [ctb]
</p>
<p><strong>Maintainer</strong>: Keefe Murphy - &lt;<a href="mailto:keefe.murphy@mu.ie">keefe.murphy@mu.ie</a>&gt;
</p>


<h3>References</h3>

<p>Murphy, K. and Murphy, T. B. (2020). Gaussian parsimonious clustering models with covariates and a noise component. <em>Advances in Data Analysis and Classification</em>, 14(2): 293-325. &lt;<a href="https://doi.org/10.1007/s11634-019-00373-8">doi:10.1007/s11634-019-00373-8</a>&gt;.
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://cran.r-project.org/package=MoEClust">https://cran.r-project.org/package=MoEClust</a>
</p>
</li>
<li>
<p> Report bugs at <a href="https://github.com/Keefe-Murphy/MoEClust">https://github.com/Keefe-Murphy/MoEClust</a>
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">data(ais)

# Fit two sets of models
res1  &lt;- MoE_clust(ais[,3:7], G=2, gating= ~ BMI, expert= ~ sex,
                   modelNames=c("VEE", "EVE", "VVE"), network.data=ais)
res2  &lt;- MoE_clust(ais[,3:7], G=2, equalPro=TRUE, expert= ~ sex,
                   modelNames=c("VEE", "EVE", "VVE"), network.data=ais) 
        
# Compare the best model from each set of results
(comp &lt;- MoE_compare(res1, res2, optimal.only=TRUE))

# Produce a plot for the optimal model                                                   
plot(comp$optimal, what="gpairs")

# Summarise its classification table, component parameters, and gating/expert networks
summary(comp$optimal, classification=TRUE, parameters=TRUE, networks=TRUE)

data(CO2data)
CO2   &lt;- CO2data$CO2
GNP   &lt;- CO2data$GNP

# Fit a range of models 
m1    &lt;- MoE_clust(CO2, G=1:3)
m2    &lt;- MoE_clust(CO2, G=2:3, gating= ~ GNP)
m3    &lt;- MoE_clust(CO2, G=1:3, expert= ~ GNP)
m4    &lt;- MoE_clust(CO2, G=2:3, gating= ~ GNP, expert= ~ GNP)
m5    &lt;- MoE_clust(CO2, G=2:3, equalPro=TRUE)
m6    &lt;- MoE_clust(CO2, G=2:3, expert= ~ GNP, equalPro=TRUE)

# Extract the model with highest BIC
(comp &lt;- MoE_compare(m1, m2, m3, m4, m5, m6, criterion="bic"))
 
# See if a better model can be found using greedy forward stepwise selection
# Conduct a stepwise search on the same data
(mod1 &lt;- MoE_stepwise(CO2, CO2data[,"GNP", drop=FALSE]))

# Conduct another stepwise search considering models with a noise component
(mod2 &lt;- MoE_stepwise(CO2, CO2data[,"GNP", drop=FALSE], noise=TRUE))

# Compare all sets of results to choose the optimal model
(best &lt;- MoE_compare(mod1, mod2, comp, pick=1)$optimal)
</code></pre>


</div>