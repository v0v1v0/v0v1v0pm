<div class="container">

<table style="width: 100%;"><tr>
<td>MoE_compare</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Choose the best MoEClust model</h2>

<h3>Description</h3>

<p>Takes one or more sets of MoEClust models fitted by <code>MoE_clust</code> (or <code>MoE_stepwise</code>) and ranks them according to the BIC, ICL, or AIC. It's possible to respect the internal ranking within each set of models, or to discard models within each set which were already deemed sub-optimal. This function can help with model selection via exhaustive or stepwise searches.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MoE_compare(...,
            criterion = c("bic", "icl", "aic"),
            pick = 10L,
            optimal.only = FALSE)

## S3 method for class 'MoECompare'
print(x,
      index = seq_len(x$pick),
      posidens = TRUE,
      rerank = FALSE,
      digits = 3L,
      details = TRUE, 
      maxi = length(index),
      ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>One or more objects of class <code>"MoEClust"</code> outputted by <code>MoE_clust</code>. All models must have been fit to the same data set. A single <em>named</em> list of such objects can also be supplied. Additionally, objects of class <code>"MoECompare"</code> outputted by this very function can also be supplied here.
</p>
<p>This argument is only relevant for the <code>MoE_compare</code> function and will be ignored for the associated <code>print</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>The criterion used to determine the ranking. Defaults to <code>"bic"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pick</code></td>
<td>
<p>The (integer) number of models to be ranked and compared. Defaults to <code>10L</code>. Will be constrained by the number of models within the <code>"MoEClust"</code> objects supplied via <code>...</code> if <code>optimal.only</code> is <code>FALSE</code>, otherwise constrained simply by the number of <code>"MoEClust"</code> objects supplied. Setting <code>pick=Inf</code> is a valid way to select all models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimal.only</code></td>
<td>
<p>Logical indicating whether to only rank models already deemed optimal within each <code>"MoEClust"</code> object (<code>TRUE</code>), or to allow models which were deemed suboptimal enter the final ranking (<code>FALSE</code>, the default). See <code>details</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x, index, posidens, rerank, digits, details, maxi</code></td>
<td>
<p>Arguments required for the associated <code>print</code> function:
</p>

<dl>
<dt><code>x</code></dt>
<dd>
<p>An object of class <code>"MoECompare"</code> resulting from a call to <code>MoE_compare</code>.</p>
</dd>
<dt><code>index</code></dt>
<dd>
<p>A logical or numeric vector giving the indices of the rows of the table of ranked models to print. This defaults to the full set of ranked models. It can be useful when the table of ranked models is large to examine a subset via this <code>index</code> argument, for display purposes. See <code>rerank</code>.</p>
</dd>
<dt><code>posidens</code></dt>
<dd>
<p>A logical indicating whether models which have been flagged for having positive log-densities should be included in the comparison (defaults to <code>TRUE</code>). Such models may correspond to spurious solutions and can be discarded by specifying <code>posidens=FALSE</code>. Only relevant if any of the <code>"MoEClust"</code> objects being compared were themselves run with <code>posidens=TRUE</code>.</p>
</dd>
<dt><code>rerank</code></dt>
<dd>
<p>A logical indicating whether the ranks should be recomputed when subsetting using <code>index</code>. Defaults to <code>FALSE</code>. Only relevant when <code>details=TRUE</code>.</p>
</dd>
<dt><code>digits</code></dt>
<dd>
<p>The number of decimal places to round model selection criteria to (defaults to 3).</p>
</dd>
<dt><code>details</code></dt>
<dd>
<p>Logical indicating whether some additional details should be printed, defaults to <code>TRUE</code>. Exists to facilitate <code>MoE_stepwise</code> printing.</p>
</dd>
<dt><code>maxi</code></dt>
<dd>
<p>A number specifying the maximum number of rows/models to print. Defaults to <code>length(index)</code>.</p>
</dd>
</dl>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The purpose of this function is to conduct model selection on <code>"MoEClust"</code> objects, fit to the same data set, with different combinations of gating/expert network covariates or different initialisation settings.
</p>
<p>Model selection will have already been performed in terms of choosing the optimal number of components and GPCM/<span class="pkg">mclust</span> model type within each supplied set of results, but <code>MoE_compare</code> will respect the internal ranking of models when producing the final ranking if <code>optimal.only</code> is <code>FALSE</code>: otherwise only those models already deemed optimal within each <code>"MoEClust"</code> object will be ranked.
</p>
<p>As such if two sets of results are supplied when <code>optimal.only</code> is <code>FALSE</code>, the 1st, 2nd and 3rd best models could all belong to the first set of results, meaning a model deemed suboptimal according to one set of covariates could be superior to one deemed optimal under another set of covariates.
</p>


<h3>Value</h3>

<p>A list of class <code>"MoECompare"</code>, for which a dedicated print function exists, containing the following elements (each of length <code>pick</code>, and ranked according to <code>criterion</code>, where appropriate):
</p>
<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The name of the data set to which the models were fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimal</code></td>
<td>
<p>The single optimal model (an object of class <code>"MoEClust"</code>) among those supplied, according to the chosen <code>criterion</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pick</code></td>
<td>
<p>The final number of ranked models. May be different (i.e. less than) the supplied <code>pick</code> value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MoENames</code></td>
<td>
<p>The names of the supplied <code>"MoEClust"</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelNames</code></td>
<td>
<p>The <code>mclustModelNames</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>The optimal numbers of components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>The numbers of estimated parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iters</code></td>
<td>
<p>The numbers of EM/CEM iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bic</code></td>
<td>
<p>BIC values, ranked according to <code>criterion</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>icl</code></td>
<td>
<p>ICL values, ranked according to <code>criterion</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aic</code></td>
<td>
<p>AIC values, ranked according to <code>criterion</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>Maximal log-likelihood values, ranked according to <code>criterion</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gating</code></td>
<td>
<p>The gating formulas.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expert</code></td>
<td>
<p>The expert formulas.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>algo</code></td>
<td>
<p>The algorithm used for fitting the model - either <code>"EM"</code>, <code>"CEM"</code>, <code>"cemEM"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>equalPro</code></td>
<td>
<p>Logical indicating whether mixing proportions were constrained to be equal across components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hypvol</code></td>
<td>
<p>Hypervolume parameters for the noise component if relevant, otherwise set to <code>NA</code> (see <code>MoE_control</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noise</code></td>
<td>
<p>The type of noise component fitted (if any). Only displayed if at least one of the compared models has a noise component.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noise.gate</code></td>
<td>
<p>Logical indicating whether gating covariates were allowed to influence the noise component's mixing proportion. Only printed for models with a noise component, when at least one of the compared models has gating covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>equalNoise</code></td>
<td>
<p>Logical indicating whether the mixing proportion of the noise component for <code>equalPro</code> models is also equal (<code>TRUE</code>) or estimated (<code>FALSE</code>).</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The <code>criterion</code> argument here need not comply with the criterion used for model selection within each <code>"MoEClust"</code> object, but be aware that a mismatch in terms of <code>criterion</code> <em>may</em> require the optimal model to be re-fit in order to be extracted, thereby slowing down <code>MoE_compare</code>.
</p>
<p>If random starts had been used via <code>init.z="random"</code> the <code>optimal</code> model may not necessarily correspond to the highest-ranking model in the presence of a criterion mismatch, due to the randomness of the initialisation. 
</p>
<p>A dedicated <code>print</code> function exists for objects of class <code>"MoECompare"</code>.
</p>
<p><code>plot.MoEClust</code> and <code>as.Mclust</code> can both also be called on objects of class <code>"MoECompare"</code>.
</p>


<h3>Author(s)</h3>

<p>Keefe Murphy - &lt;<a href="mailto:keefe.murphy@mu.ie">keefe.murphy@mu.ie</a>&gt;
</p>


<h3>References</h3>

<p>Murphy, K. and Murphy, T. B. (2020). Gaussian parsimonious clustering models with covariates and a noise component. <em>Advances in Data Analysis and Classification</em>, 14(2): 293-325. &lt;<a href="https://doi.org/10.1007/s11634-019-00373-8">doi:10.1007/s11634-019-00373-8</a>&gt;.
</p>


<h3>See Also</h3>

<p>See <code>MoE_stepwise</code> for identifying the optimal model and its covariates via greedy forward stepwise selection.<br></p>
<p><code>MoE_clust</code>, <code>mclustModelNames</code>, <code>plot.MoEClust</code>, <code>as.Mclust</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(CO2data)
CO2   &lt;- CO2data$CO2
GNP   &lt;- CO2data$GNP

# Fit a range of models 
m1    &lt;- MoE_clust(CO2, G=1:3)
m2    &lt;- MoE_clust(CO2, G=2:3, gating= ~ GNP)
m3    &lt;- MoE_clust(CO2, G=1:3, expert= ~ GNP)
m4    &lt;- MoE_clust(CO2, G=2:3, gating= ~ GNP, expert= ~ GNP)
m5    &lt;- MoE_clust(CO2, G=2:3, equalPro=TRUE)
m6    &lt;- MoE_clust(CO2, G=2:3, expert= ~ GNP, equalPro=TRUE)
m7    &lt;- MoE_clust(CO2, G=2:3, expert= ~ GNP, tau0=0.1)

# Rank only the optimal models and examine the best model
(comp &lt;- MoE_compare(m1, m2, m3, m4, m5, m6, m7, optimal.only=TRUE))
(best &lt;- comp$optimal)
(summ &lt;- summary(best, classification=TRUE, parameters=TRUE, networks=TRUE))

# Examine all models visited, including those already deemed suboptimal
# Only print models with expert covariates &amp; more than one component
comp2 &lt;- MoE_compare(m1, m2, m3, m4, m5, m6, m7, pick=Inf)
print(comp2, index=comp2$expert != "None" &amp; comp2$G &gt; 1)

# Conduct a stepwise search on the same data
(mod1 &lt;- MoE_stepwise(CO2, GNP))

# Conduct another stepwise search considering models with a noise component
(mod2 &lt;- MoE_stepwise(CO2, GNP, noise=TRUE))

# Compare both sets of results to choose the optimal model
(best &lt;- MoE_compare(mod1, mod2, optimal.only=TRUE)$optimal)
</code></pre>


</div>