<div class="container">

<table style="width: 100%;"><tr>
<td>as.Mclust</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Convert MoEClust objects to the Mclust class</h2>

<h3>Description</h3>

<p>Converts an object of class <code>"MoEClust"</code> generated by <code>MoE_clust</code> and converts it to an object of class <code>"Mclust"</code> as generated by fitting <code>Mclust</code>, to facilitate use of plotting and other functions for the <code>"Mclust"</code> class within the <span class="pkg">mclust</span> package. Some caution is advised when converting models with gating &amp;/or expert covariates (see Note below).
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'MoEClust'
as.Mclust(x,
         expert.covar = TRUE,
         signif = 0L,
         ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class <code>"MoEClust"</code> generated by <code>MoE_clust</code> or an object of class <code>"MoECompare"</code> generated by <code>MoE_compare</code>. Models with a noise component are facilitated here too.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expert.covar</code></td>
<td>
<p>Logical (defaults to <code>TRUE</code>) governing whether the extra variability in the component means is added to the MVN ellipses corresponding to the component covariance matrices in the presence of expert network covariates. See the function <code>expert_covar</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>signif</code></td>
<td>
<p>Significance level for outlier removal. Must be a single number in the interval [0, 1). Corresponds to the percentage of data to be considered extreme and therefore removed (half of <code>signif</code> at each endpoint, on a column-wise basis). The default, <code>0</code>, corresponds to no outlier removal. <strong>Only</strong> invoke this argument as an aid to visualisation via <code>plot.Mclust</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to other methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Of course, the user is always encouraged to use the dedicated <code>plot</code> function for objects of the <code>"MoEClust"</code> class instead, but calling <code>plot</code> after converting via <code>as.Mclust</code> can be particularly useful for univariate mixtures.
</p>
<p>In the presence of expert network covariates, the component-specific covariance matrices are (by default, via the argument <code>expert.covar</code>) modified for plotting purposes via the function <code>expert_covar</code>, in order to account for the extra variability of the means, usually resulting in bigger shapes &amp; sizes for the MVN ellipses.
</p>
<p>The <code>signif</code> argument is intended only to aid visualisation via <code>plot.Mclust</code>, as plots therein can be sensitive to outliers, particularly with regard to axis limits.
</p>


<h3>Value</h3>

<p>An object of class <code>"Mclust"</code>. See <code>methods(class="Mclust")</code> for a (non-exhaustive) list of functions which can be applied to this class.
</p>


<h3>Note</h3>

<p>Mixing proportions are averaged over observations in components in the presence of gating network covariates during the coercion.
</p>
<p>Plots may be quite misleading in the presence of gating &amp;/or (especially) expert network covariates when the <code>what</code> argument is <code>"density"</code> within <code>plot.Mclust</code>; users are <strong>strongly</strong> encouraged to use <code>MoE_gpairs</code> with <code>response.type="density"</code> instead.
</p>
<p>Predictions (via <code>predict.Mclust</code>) will also be misleading in the presence of covariates of any kind when <code>newdata</code> is supplied; thus, users are <strong>strongly</strong> encouraged to use <code>predict.MoEClust</code> instead. 
</p>
<p>The functions <code>clustCombi</code> and <code>clustCombiOptim</code> can be safely used (provided <code>as.Mclust(x)</code> is supplied as the <code>object</code> argument to <code>clustCombi</code>), as they only rely on <code>x$z</code> and <code>x$G</code> only. See the examples below.
</p>
<p>Users may expect MoEClust models with no covariates of any kind to be identical to models fitted via <span class="pkg">mclust</span>, but this is not necessarily true: see the <code>MoE_control</code> argument <code>asMclust</code>.
</p>


<h3>Author(s)</h3>

<p>Keefe Murphy - &lt;<a href="mailto:keefe.murphy@mu.ie">keefe.murphy@mu.ie</a>&gt;
</p>


<h3>References</h3>

<p>Fraley, C. and Raftery, A. E. (2002). Model-based clustering, discriminant analysis, and density estimation. <em>Journal of the American Statistical Association</em>, 97(458): 611-631.
</p>
<p>Scrucca L., Fop M., Murphy T. B. and Raftery A. E. (2016). mclust 5: clustering, classification and density estimation using Gaussian finite mixture models. <em>The R Journal</em>, 8(1): 289-317.
</p>


<h3>See Also</h3>

<p><code>Mclust</code>, <code>plot.Mclust</code>, <code>MoE_clust</code>, <code>plot.MoEClust</code>, <code>expert_covar</code>, <code>MoE_control</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># library(mclust)

# Fit a gating network mixture of experts model to the ais data
# data(ais)
# mod   &lt;- MoE_clust(ais[,3:7], G=1:9, gating= ~ BMI + sex, network.data=ais)

# Convert to the "Mclust" class and examine the classification
# mod2  &lt;- as.Mclust(mod)
# plot(mod2, what="classification")

# Examine the uncertainty
# plot(mod2, what="uncertainty")

# Return the optimal number of clusters according to entropy
# combi &lt;- mclust::clustCombi(object=mod2)
# optim &lt;- mclust::clustCombiOptim(object=combi)
# table(mod2$classification, ais$sex)
# table(optim$cluster.combi, ais$sex)

# While we could have just used plot.MoEClust above,
# plot.Mclust is especially useful for univariate data
# data(CO2data)
# res &lt;- MoE_clust(CO2data$CO2, G=3, equalPro=TRUE, expert = ~ GNP, network.data=CO2data)
# plot(as.Mclust(res))
</code></pre>


</div>