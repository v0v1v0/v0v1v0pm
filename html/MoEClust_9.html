<div class="container">

<table style="width: 100%;"><tr>
<td>expert_covar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Account for extra variability in covariance matrices with expert covariates</h2>

<h3>Description</h3>

<p>In the presence of expert network covariates, this helper function modifies the component-specific covariance matrices of a <code>"MoEClust"</code> object, in order to account for the extra variability due to the component means, usually resulting in bigger shapes &amp; sizes for the MVN ellipses in <code>MoE_gpairs</code> plots. The function also works for univariate response data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">expert_covar(x,
             weighted = TRUE,
             ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class <code>"MoEClust"</code> generated by <code>MoE_clust</code>, or an object of class <code>"MoECompare"</code> generated by <code>MoE_compare</code>. Models with a noise component are facilitated here too.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weighted</code></td>
<td>
<p>A logical indicating whether the estimated cluster membership probabilities should be used to provide a weighted estimate of the variability due to the component means. Defaults to <code>TRUE</code>. The option <code>weighted=FALSE</code> is provided only so that previous behaviour under earlier versions of this package can be recovered but is otherwise not recommended.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Catches unused arguments.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is used internally by <code>MoE_gpairs</code>, <code>plot.MoEClust(x, what="gpairs")</code>, and <code>as.Mclust</code>, for visualisation purposes.
</p>


<h3>Value</h3>

<p>The <code>variance</code> component only from the <code>parameters</code> list from the output of a call to <code>MoE_clust</code>, modified accordingly.
</p>


<h3>Note</h3>

<p>The <code>modelName</code> of the resulting <code>variance</code> object may not correspond to the model name of the <code>"MoEClust"</code> object, in particular <code>scale</code>, <code>shape</code>, &amp;/or <code>orientation</code> may no longer be constrained across clusters, and <code>cholsigma</code>, if it was in the input, will be discarded from the output. Usually, the <code>modelName</code> of the transformed <code>variance</code> object will be <code>"VVV"</code> for multivariate data and <code>"V"</code> for univariate data, but not always. Furthermore, the output will drop certain row and column names from the output.
</p>


<h3>Author(s)</h3>

<p>Keefe Murphy - &lt;<a href="mailto:keefe.murphy@mu.ie">keefe.murphy@mu.ie</a>&gt;
</p>


<h3>References</h3>

<p>Murphy, K. and Murphy, T. B. (2020). Gaussian parsimonious clustering models with covariates and a noise component. <em>Advances in Data Analysis and Classification</em>, 14(2): 293-325. &lt;<a href="https://doi.org/10.1007/s11634-019-00373-8">doi:10.1007/s11634-019-00373-8</a>&gt;.
</p>


<h3>See Also</h3>

<p><code>MoE_clust</code>, <code>MoE_gpairs</code>, <code>plot.MoEClust</code>, <code>as.Mclust</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(ais)
res   &lt;- MoE_clust(ais[,3:7], G=2, gating= ~ 1, expert= ~ sex,
                   network.data=ais, modelNames="EEE", equalPro=TRUE)

# Extract the variance object
res$parameters$variance

# Modify the variance object
expert_covar(res)
</code></pre>


</div>