<div class="container">

<table style="width: 100%;"><tr>
<td>mop.learning</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting mixtures of polynomials</h2>

<h3>Description</h3>

<p>These functions fit mixtures of polynomials (MOPs).  
Least square optimization is used to  
minimize the quadratic error between the empirical 
cumulative distribution and the estimated one.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mop.learning(X, nparam, domain)

bestMOP(X, domain, maxParam = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A <code>"numeric"</code> data vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nparam</code></td>
<td>
<p>Number of parameters of the function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>domain</code></td>
<td>
<p>A <code>"numeric"</code> containing the interval over which the function is defined.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxParam</code></td>
<td>
<p>A <code>"numeric"</code> value indicating the maximum number of coefficients in the function. By default it is <code>NULL</code>,
which means that the number of parameter is not limited. The output is the function which gets 
the best BIC (with at most<code>maxParam</code> parameters if not NULL).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>mop.learning()</code>:
The returned value <code>$Function</code> is the only visible element which contains the algebraic expression. 
Using attributes the name of the others elements are shown and also they can be extracted with <code>$</code>.
The summary of the function also shows all these elements.
</p>
<p><code>bestMOP()</code>:
The first returned value <code>$bestPx</code> contains the output of the <code>mop.learning()</code> function
with the number of parameters which gets the best BIC values, taking into account the  
BIC score to penalize the functions. It evaluates the two next functions,
if the BIC score does not improve then the function with the last best BIC is returned.
</p>


<h3>Value</h3>

<p><code>mop.lerning()</code> returns a list of n elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Function</code></td>
<td>
<p>An <code>"motbf"</code> object of the <code>'mop'</code> subclass.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Subclass</code></td>
<td>
<p><code>'mop'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Domain</code></td>
<td>
<p>The range where the function is defined to be a legal density function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Iterations</code></td>
<td>
<p>The number of iterations that the optimization problem takes to minimize
the errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Time</code></td>
<td>
<p>The CPU time employed.</p>
</td>
</tr>
</table>
<p><code>bestMOP()</code> returns a list including the polynomial function with the best BIC score, 
the number of parameters and an array with 
the BIC values of the evaluated functions.
</p>


<h3>See Also</h3>

<p>univMoTBF A complete function for learning MOPs which includes extra options.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## 1. EXAMPLE 
data &lt;- rnorm(1000)

## MOP with fix number of degrees
fx &lt;- mop.learning(data, nparam=7, domain=range(data))
fx
hist(data, prob=TRUE, main="")
plot(fx, col=2, xlim=range(data), add=TRUE)

## Best MOP in terms of BIC
fMOP &lt;- bestMOP(data, domain=range(data))
attributes(fMOP)
fMOP$bestPx
hist(data, prob=TRUE, main="")
plot(fMOP$bestPx, col=2, xlim=range(data), add=TRUE)

## 2. EXAMPLE
data &lt;- rbeta(4000, shape1=1/2, shape2=1/2)

## MOP with fix number of degrees 
fx &lt;- mop.learning(data, nparam=6, domain=range(data))
fx
hist(data, prob=TRUE, main="")
plot(fx, col=2, xlim=range(data), add=TRUE)

## Best MOP in terms of BIC
fMOP &lt;- bestMOP(data, domain=range(data), maxParam=6)
attributes(fMOP)
fMOP$bestPx
attributes(fMOP$bestPx)
hist(data, prob=TRUE, main="")
plot(fMOP$bestPx, col=2, xlim=range(data), add=TRUE)
</code></pre>


</div>