<div class="container">

<table style="width: 100%;"><tr>
<td>MCmeanvarTMD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Monte Carlo Mean and variance for doubly truncated multivariate distributions
</h2>

<h3>Description</h3>

<p>It computes the Monte Carlo mean vector and variance-covariance matrix for some doubly truncated skew-elliptical distributions. Monte Carlo simulations are performed via slice Sampling.
It supports the <code>p</code>-variate Normal, Skew-normal (SN), Extended Skew-normal (ESN) and Unified Skew-normal (SUN) as well as the Student's-t, Skew-t (ST), Extended Skew-t (EST) and Unified Skew-t (SUT) distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MCmeanvarTMD(lower = rep(-Inf,length(mu)),upper = rep(Inf,length(mu)),mu,Sigma
,lambda = NULL,tau = NULL,Gamma = NULL,nu = NULL,dist,n = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>

<p>the vector of lower limits of length <code class="reqn">p</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>

<p>the vector of upper limits of length <code class="reqn">p</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>

<p>a numeric vector of length <code class="reqn">p</code> representing the location parameter.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>

<p>a numeric positive definite matrix with dimension <code class="reqn">p</code>x<code class="reqn">p</code> representing the scale parameter.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>

<p>a numeric matrix of dimension <code class="reqn">p</code>x<code class="reqn">q</code> representing the skewness/shape matrix parameter for the SUN and SUT distribution. For the ESN and EST distributions (<code class="reqn">q=1</code>), <code>lambda</code> is a numeric vector of dimension <code class="reqn">p</code> (see examples at the end of this help). If <code>all(lambda == 0)</code>, the SUN/ESN/SN (SUT/EST/ST) reduces to a normal (t) symmetric distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>

<p>a numeric vector of length <code class="reqn">q</code> representing the extension parameter for the SUN and SUT distribution. For the ESN and EST distributions, <code>tau</code> is a positive scalar (<code class="reqn">q=1</code>). Furthermore, if <code>tau == 0</code>, the ESN (EST) reduces to a SN (ST) distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gamma</code></td>
<td>

<p>a correlation matrix with dimension <code class="reqn">q</code>x<code class="reqn">q</code>. It must be provided only for the SUN and SUT cases. For particular cases SN, ESN, ST and EST, we have that <code>Gamma == 1</code> (see examples at the end of this help).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>

<p>It represents the degrees of freedom for the Student's t-distribution being a positive real number.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>

<p>represents the truncated distribution to be used. The values are <code>normal</code>, <code>SN</code> , <code>ESN</code> and <code>SUN</code> for the doubly truncated Normal, Skew-normal, Extended Skew-normal and Unified-skew normal distributions and,
<code>t</code>, <code>ST</code> , <code>EST</code> and <code>SUT</code> for the for the doubly truncated Student-t, Skew-t, Extended Skew-t and Unified skew-t distributions.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>number of Monte Carlo samples to be generated.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>It returns a list with three elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>the estimate for the mean vector of length <code class="reqn">p</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EYY</code></td>
<td>
<p>the estimate for the second moment matrix of dimensions <code class="reqn">p</code>x<code class="reqn">p</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varcov</code></td>
<td>
<p>the estimate for the variance-covariance matrix of dimensions <code class="reqn">p</code>x<code class="reqn">p</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Christian E. Galarza &lt;<a href="mailto:cgalarza88@gmail.com">cgalarza88@gmail.com</a>&gt; and
Victor H. Lachos &lt;<a href="mailto:hlachos@uconn.edu">hlachos@uconn.edu</a>&gt;
</p>
<p>Maintainer: Christian E. Galarza &lt;<a href="mailto:cgalarza88@gmail.com">cgalarza88@gmail.com</a>&gt;
</p>


<h3>References</h3>

<p>Arellano-Valle, R. B. &amp; Genton, M. G. (2005). On fundamental skew distributions. Journal of Multivariate
Analysis, 96, 93-116.
</p>
<p>Ho, H. J., Lin, T. I., Chen, H. Y., &amp; Wang, W. L. (2012). Some results on the truncated multivariate t distribution. Journal of Statistical Planning and Inference, 142(1), 25-40.
</p>


<h3>See Also</h3>

<p><code>meanvarTMD</code>, <code>rmvSN</code>,<code>rmvESN</code>,<code>rmvST</code>, <code>rmvEST</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">a = c(-0.8,-0.7,-0.6)
b = c(0.5,0.6,0.7)
mu = c(0.1,0.2,0.3)
Sigma = matrix(data = c(1,0.2,0.3,0.2,1,0.4,0.3,0.4,1),
               nrow = length(mu),ncol = length(mu),byrow = TRUE)


## Normal case

# Theoretical value
value1 = meanvarTMD(a,b,mu,Sigma,dist="normal")

#MC estimate
MC11 = MCmeanvarTMD(a,b,mu,Sigma,dist="normal") #by defalut n = 10000
MC12 = MCmeanvarTMD(a,b,mu,Sigma,dist="normal",n = 10^5) #more precision

## Skew-t case
 
# Theoretical value
value2 = meanvarTMD(a,b,mu,Sigma,lambda = c(-2,0,1),nu = 4,dist = "ST")

#MC estimate
MC21 = MCmeanvarTMD(a,b,mu,Sigma,lambda = c(-2,0,1),nu = 4,dist = "ST")

## More...

MC5 = MCmeanvarTMD(a,b,mu,Sigma,lambda = c(-2,0,1),tau = 1,dist = "ESN")
MC6 = MCmeanvarTMD(a,b,mu,Sigma,lambda = c(-2,0,1),tau = 1,nu = 4,dist = "EST")


#Skew-unified Normal (SUN) and Skew-unified t (SUT) distributions

Lambda = matrix(c(1,0,2,-3,0,-1),3,2) #A skewness matrix p times q
Gamma  = matrix(c(1,-0.5,-0.5,1),2,2) #A correlation matrix q times q
tau    = c(-1,2)                      #A vector of extension parameters of dim q

MC7 = MCmeanvarTMD(a,b,mu,Sigma,lambda = Lambda,tau = c(-1,2),Gamma = Gamma,dist = "SUN")
MC8 = MCmeanvarTMD(a,b,mu,Sigma,lambda = Lambda,tau = c(-1,2),Gamma = Gamma,nu = 1,dist = "SUT")

</code></pre>


</div>