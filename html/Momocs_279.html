<div class="container">

<table style="width: 100%;"><tr>
<td>fgProcrustes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Full Generalized Procrustes alignment between shapes</h2>

<h3>Description</h3>

<p>Directly borrowed from Claude (2008), called there the <code>fgpa2</code> function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fgProcrustes(x, tol, coo)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an array, a list of configurations, or an Out, Opn or Ldk object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>numeric when to stop iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coo</code></td>
<td>
<p>logical, when working on <code>Out</code> or <code>Opn</code>, whether to use <code>$coo</code> rather than <code>$ldk</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If performed on an Out or an Opn object, will try to use the <code>$ldk</code> slot,
if landmarks have been previousy defined, then (with a message) on the <code>$coo</code> slot,
but in that case, all shapes must have the same number of coordinates (coo_sample may help).
</p>


<h3>Value</h3>

<p>a list with components:
</p>

<ul>
<li> <p><code>rotated</code> array of superimposed configurations
</p>
</li>
<li> <p><code>iterationnumber</code> number of iterations
</p>
</li>
<li> <p><code>Q</code> convergence criterion
</p>
</li>
<li> <p><code>Qi</code> full list of Q
</p>
</li>
<li> <p><code>Qd</code> difference between successive Q
</p>
</li>
<li> <p><code>interproc.dist</code> minimal sum of squared norms of pairwise differences between
all shapes in the superimposed sample
</p>
</li>
<li> <p><code>mshape</code> mean shape configuration
</p>
</li>
<li> <p><code>cent.size</code> vector of centroid sizes.
</p>
</li>
</ul>
<p> or an Out, Opn or an Ldk object.
</p>


<h3>Note</h3>

<p>Slightly less optimized than procGPA in the shapes package (~20% on my machine).
Will be optimized when performance will be the last thing to improve!
Silent message and progress bars (if any) with <code>options("verbose"=FALSE)</code>.
</p>


<h3>References</h3>

<p>Claude, J. (2008). Morphometrics with R. Analysis (p. 316). Springer.
</p>


<h3>See Also</h3>

<p>Other procrustes functions: 
<code>fProcrustes()</code>,
<code>fgsProcrustes()</code>,
<code>pProcrustes()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># on Ldk
w &lt;- wings %&gt;% slice(1:5) # for the sake of speed
stack(w)
fgProcrustes(w, tol=0.1) %&gt;% stack()

# on Out
h &lt;- hearts %&gt;% slice(1:5) # for the sake of speed
stack(h)
fgProcrustes(h) %&gt;%  stack()
</code></pre>


</div>