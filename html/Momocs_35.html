<div class="container">

<table style="width: 100%;"><tr>
<td>calibrate_harmonicpower</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Quantitative calibration, through harmonic power, for Out and Opn objects</h2>

<h3>Description</h3>

<p>Estimates the number of harmonics required for the four Fourier methods
implemented in Momocs: elliptical Fourier analysis
(see efourier), radii variation analysis (see rfourier)
and tangent angle analysis (see tfourier) and
discrete Fourier transform (see dfourier).
It returns and can plot cumulated harmonic power whether dropping
the first harmonic or not, and based and the maximum possible number
of harmonics on the <code>Coo</code> object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calibrate_harmonicpower()

calibrate_harmonicpower_efourier(
  x,
  id = 1:length(x),
  nb.h,
  drop = 1,
  thresh = c(90, 95, 99, 99.9),
  plot = TRUE
)

calibrate_harmonicpower_rfourier(
  x,
  id = 1:length(x),
  nb.h,
  drop = 1,
  thresh = c(90, 95, 99, 99.9),
  plot = TRUE
)

calibrate_harmonicpower_tfourier(
  x,
  id = 1:length(x),
  nb.h,
  drop = 1,
  thresh = c(90, 95, 99, 99.9),
  plot = TRUE
)

calibrate_harmonicpower_sfourier(
  x,
  id = 1:length(x),
  nb.h,
  drop = 1,
  thresh = c(90, 95, 99, 99.9),
  plot = TRUE
)

calibrate_harmonicpower_dfourier(
  x,
  id = 1:length(x),
  nb.h,
  drop = 1,
  thresh = c(90, 95, 99, 99.9),
  plot = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a <code>Coo</code> of <code>Opn</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>the shapes on which to perform calibrate_harmonicpower. All of them by default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb.h</code></td>
<td>
<p>numeric the maximum number of harmonic, on which to base the cumsum</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop</code></td>
<td>
<p>numeric the number of harmonics to drop for the cumulative sum</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh</code></td>
<td>
<p>vector of numeric for drawing horizontal lines, and also used for
<code>minh</code> below</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical whether to plot the result or simply return the matrix
Silent message and progress bars (if any) with <code>options("verbose"=FALSE)</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The power of a given harmonic <code class="reqn">n</code> is calculated as follows for
elliptical Fourier analysis and the n-th harmonic:
<code class="reqn">HarmonicPower_n \frac{A^2_n+B^2_n+C^2_n+D^2_n}{2}</code>
and as follows for radii variation and tangent angle:
<code class="reqn">HarmonicPower_n= \frac{A^2_n+B^2_n+C^2_n+D^2_n}{2}</code>
</p>


<h3>Value</h3>

<p>returns a list with component:
</p>

<ul>
<li> <p><code>gg</code> a ggplot object, <code>q</code> the quantile matrix
</p>
</li>
<li> <p><code>minh</code> a quick summary that returns the number of harmonics required to achieve
a certain proportion of the total harmonic power.
</p>
</li>
</ul>
<h3>See Also</h3>

<p>Other calibration: 
<code>calibrate_deviations()</code>,
<code>calibrate_r2()</code>,
<code>calibrate_reconstructions</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">b5 &lt;- bot %&gt;% slice(1:5)
b5  %&gt;% calibrate_harmonicpower_efourier(nb.h=12)
b5  %&gt;% calibrate_harmonicpower_rfourier(nb.h=12)
b5  %&gt;% calibrate_harmonicpower_tfourier(nb.h=12)
b5  %&gt;% calibrate_harmonicpower_sfourier(nb.h=12)

# on Opn
olea %&gt;% slice(1:5) %&gt;%
    calibrate_harmonicpower_dfourier(nb.h=12)

# let customize the ggplot
library(ggplot2)
cal &lt;- b5  %&gt;% calibrate_harmonicpower_efourier(nb.h=12)
cal$gg + theme_minimal() +
coord_cartesian(xlim=c(3.5, 12.5), ylim=c(90, 100)) +
ggtitle("Harmonic power calibration")

</code></pre>


</div>