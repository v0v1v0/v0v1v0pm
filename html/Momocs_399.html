<div class="container">

<table style="width: 100%;"><tr>
<td>MSHAPES</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mean shape calculation for Coo, Coe, etc.</h2>

<h3>Description</h3>

<p>Quite a versatile function that calculates mean (or median, or whatever function)
on list or an array of shapes, an Ldk object. It can also be used on Coe objects.
In that case, the reverse transformation (from coefficients to shapes) is calculated, (within
groups defined with the fac argument if provided) and the Coe object is <em>also</em> returned
(in <code style="white-space: pre;">⁠$Coe⁠</code>) along with a list of shapes (in <code style="white-space: pre;">⁠$shp⁠</code>) and can then be passed to <code>plot_MSHAPES</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MSHAPES(x, fac = NULL, FUN = mean, nb.pts = 120, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a list, array, Ldk, LdkCoe, OutCoe or OpnCoe or PCA object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fac</code></td>
<td>
<p>factor specification for fac_dispatcher</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN</code></td>
<td>
<p>a function to compute the mean shape (mean by default, by median can be considered)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb.pts</code></td>
<td>
<p>numeric the number of points for calculated shapes (only Coe objects)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>useless here.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>the averaged shape; on Coe objects, a list with two components: <code>$Coe</code> object of the same class, and
<code>$shp</code> a list of matrices of (x, y) coordinates. On PCA and LDA objects, the FUN (typically mean or median)
of scores on <code>PCs</code> or <code>LDs</code>. This method used on the latter objects may be moved to another function at some point.
</p>


<h3>See Also</h3>

<p>Other multivariate: 
<code>CLUST()</code>,
<code>KMEANS()</code>,
<code>KMEDOIDS()</code>,
<code>LDA()</code>,
<code>MANOVA_PW()</code>,
<code>MANOVA()</code>,
<code>MDS()</code>,
<code>NMDS()</code>,
<code>PCA()</code>,
<code>classification_metrics()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#### on shapes
MSHAPES(wings)
MSHAPES(wings$coo)
MSHAPES(coo_sample(bot, 24)$coo)
stack(wings)
coo_draw(MSHAPES(wings))

bot.f &lt;- efourier(bot, 12)
MSHAPES(bot.f) # the mean (global) shape
ms &lt;- MSHAPES(bot.f, 'type')
ms$Coe
class(ms$Coe)
ms &lt;- ms$shp
coo_plot(ms$beer)
coo_draw(ms$whisky, border='forestgreen')
</code></pre>


</div>