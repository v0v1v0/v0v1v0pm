<div class="container">

<table style="width: 100%;"><tr>
<td>npoly</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate natural polynomial fits on open outlines</h2>

<h3>Description</h3>

<p>Calculates natural polynomial coefficients,
through a linear model fit (see lm), from a matrix of (x; y) coordinates
or an Opn object
</p>


<h3>Usage</h3>

<pre><code class="language-R">npoly(x, ...)

## Default S3 method:
npoly(x, degree, ...)

## S3 method for class 'Opn'
npoly(
  x,
  degree,
  baseline1 = c(-0.5, 0),
  baseline2 = c(0.5, 0),
  nb.pts = 120,
  ...
)

## S3 method for class 'list'
npoly(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a matrix (or a list) of (x; y) coordinates or an Opn object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>useless here</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>
<p>polynomial degree for the fit (the Intercept is also returned)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>baseline1</code></td>
<td>
<p>numeric the <code class="reqn">(x; y)</code> coordinates of the first baseline
by default <code class="reqn">(x= -0.5; y=0)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>baseline2</code></td>
<td>
<p>numeric the <code class="reqn">(x; y)</code> coordinates of the second baseline
by default <code class="reqn">(x= 0.5; y=0)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb.pts</code></td>
<td>
<p>number of points to sample and on which to calculate polynomials</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>when applied on a single shape, a list with components:
</p>

<ul>
<li> <p><code>coeff</code> the coefficients (including the intercept)
</p>
</li>
<li> <p><code>ortho</code> whether orthogonal or natural polynomials were fitted
</p>
</li>
<li> <p><code>degree</code> degree of the fit (could be retrieved through <code>coeff</code> though)
</p>
</li>
<li> <p><code>baseline1</code> the first baseline point (so far the first point)
</p>
</li>
<li> <p><code>baseline2</code> the second baseline point (so far the last point)
</p>
</li>
<li> <p><code>r2</code> the r2 from the fit
</p>
</li>
<li> <p><code>mod</code> the raw lm model
</p>
</li>
</ul>
<p>otherwise, an OpnCoe object.
</p>


<h3>See Also</h3>

<p>Other polynomials: 
<code>opoly_i()</code>,
<code>opoly()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(olea)
o &lt;- olea[1]
op &lt;- opoly(o, degree=4)
op
# shape reconstruction
opi &lt;- opoly_i(op)
coo_plot(o)
coo_draw(opi, border="red")
# R2 for degree 1 to 10
r &lt;- numeric()
for (i in 1:10) { r[i] &lt;- npoly(o, degree=i)$r2 }
plot(2:10, r[2:10], type='b', pch=20, col='red', main='R2 / degree')
</code></pre>


</div>