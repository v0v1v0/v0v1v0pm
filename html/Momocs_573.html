<div class="container">

<table style="width: 100%;"><tr>
<td>which_out</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Identify outliers</h2>

<h3>Description</h3>

<p>A simple wrapper around dnorm that helps identify outliers. In particular,
it may be useful on Coe object (in this case a PCA is first calculated) and also
on Ldk for detecting possible outliers on freshly digitized/imported datasets.
</p>


<h3>Usage</h3>

<pre><code class="language-R">which_out(x, conf, nax, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>object, either Coe or a numeric on which to search for outliers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf</code></td>
<td>
<p>confidence for dnorm (1e-3 by default)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nax</code></td>
<td>
<p>number of axes to retain (only for Coe),
if &lt;1 retain enough axes to retain this proportion of the variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters to be passed to PCA (only for Coe)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a vector of indices
</p>


<h3>Note</h3>

<p>experimental. dnorm parameters used are <code>median(x), sd(x)</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># on a numeric
x &lt;- rnorm(10)
x[4] &lt;- 99
which_out(x)

# on a Coe
bf &lt;- bot %&gt;% efourier(6)
bf$coe[c(1, 6), 1] &lt;- 5
which_out(bf)

# on Ldk
w_no &lt;- w_ok &lt;- wings
w_no$coo[[2]][1, 1] &lt;- 2
w_no$coo[[6]][2, 2] &lt;- 2
which_out(w_ok, conf=1e-12) # with low conf, no outliers
which_out(w_no, conf=1e-12) # as expected

# a way to illustrate, filter outliers
# conf has been chosen deliberately low to show some outliers
x_f &lt;- bot %&gt;% efourier
x_p &lt;- PCA(x_f)
# which are outliers (conf is ridiculously low here)
which_out(x_p$x[, 1], 0.5)
cols &lt;- rep("black", nrow(x_p$x))
outliers &lt;- which_out(x_p$x[, 1], 0.5)
cols[outliers] &lt;- "red"
plot(x_p, col=cols)
# remove them for Coe, rePCA, replot
x_f %&gt;% slice(-outliers) %&gt;% PCA %&gt;% plot

# or directly with which_out.Coe
# which relies on a PCA
outliers &lt;- x_f %&gt;% which_out(0.5, nax=0.95) %&gt;% na.omit()
x_f %&gt;% slice(-outliers) %&gt;% PCA %&gt;% plot
</code></pre>


</div>