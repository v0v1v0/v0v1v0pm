<div class="container">

<table style="width: 100%;"><tr>
<td>simregions</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate regions data</h2>

<h3>Description</h3>

<p><code>simregions()</code> simulates vertebrae and PCOs that satisfy certain constraints.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simregions(
  nvert,
  nregions,
  nvar = 1,
  r2 = 0.95,
  minvert = 3,
  cont = TRUE,
  sl.dif = 0
)

## S3 method for class 'regions_sim'
plot(x, scores = 1, lines = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nvert</code></td>
<td>
<p><code>numeric</code>; the number of vertebrae for which to simulate data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nregions</code></td>
<td>
<p><code>numeric</code>; the desired number of regions in the simulated data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nvar</code></td>
<td>
<p><code>numeric</code>; the number of PCO axes to simulate. Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r2</code></td>
<td>
<p><code>numeric</code>; a vector containing the <code class="reqn">R^2</code> of the true segmented regression model for each simulated PCO. If a single value is supplied, all PCOs will receive that value. Otherwise, one value should be supplied for each simulated PCO.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minvert</code></td>
<td>
<p><code>numeric</code>; the minimum number of vertebrae allowed in each region. Default is 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cont</code></td>
<td>
<p><code>logical</code>; whether to use models that are continuous (<code>TRUE</code>) or discontinuous (<code>FALSE</code>) at the breakpoints to generate the data. Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sl.dif</code></td>
<td>
<p><code>numeric</code>; the minimum required difference in slopes between adjacent regions, expressed as a proportion of the maximal difference between allowable slopes. Must be between 0 and 1. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a <code>regions_sim</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p><code>numeric</code>; for which simulated PCO scores the simulated values should be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lines</code></td>
<td>
<p><code>logical</code>; whether to display the simulated regression lines on the plot. Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>ignored.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>simregions()</code> generates PCO scores for each requested vertebra such that certain conditions are met. The slopes for each region are drawn from a uniform distribution with limits of -.5 and .5. If a set of slopes contains two adjacent slopes that have a difference less than <code>sl.dif</code>, it is rejected and a new one is drawn. The scaling of the PCOs is determined by the slopes and the requested <code class="reqn">R^2</code>. The PCOs will not necessarily be in order from most variable to least variable as they are in a traditional PCO analysis.
</p>
<p>Intercepts (the intercept of the first region when <code>cont = TRUE</code> and the intercept of all regions when <code>cont = FALSE</code>) are drawn from a uniform distribution with limits of <code class="reqn">-n/4</code> and <code class="reqn">n/4</code>, where <code class="reqn">n</code> is the number of breakpoints, one less than <code>nregions</code>. Intercepts other than the first when <code>cont = TRUE</code> are determined by the slopes.
</p>
<p>The <code>cont</code>, <code>r2</code>, and <code>sl.dif</code> arguments control how easy it is for fitted segmented regression models to capture the true structure. When <code>cont = TRUE</code>, it can be harder to determine exactly where regions begin and end, especially if <code>sl.dif</code> is 0. When <code>r2</code> is high, there is little variation around the true line, so the fitted lines will be more precise and region boundaries clearer. When <code>sl.dif</code> is high, slopes of adjacent regions are different from each other, so it is easier to detect region boundaries. Setting <code>sl.dif</code> to between .5 and 1 ensures that the slopes in adjacent regions have different signs.
</p>


<h3>Value</h3>

<p><code>simregions()</code> returns a <code>regions_sim</code> object, which contains the vertebra indices in the <code>Xvar</code> entry, the PCO scores in the <code>Yvar</code> entry, the simulated breakpoints in the <code>BPs</code> entry, the simulated model coefficients in the <code>coefs</code> entry, and the simulated error standard deviation in the <code>ersd</code> entry. The attribute <code>"design"</code> contains the design matrix, which when multiplied by the coefficients and added to a random normal variate with standard deviation equal to the error standard deviation yields the observed PCO scores.
</p>
<p><code>plot()</code> returns a <code>ggplot</code> object that can be manipulated using <code>ggplot2</code> syntax. The plot is similar to that produced by <code>plot.regions_pco()</code> and to that produced by <code>plotsegreg()</code> except that the displayed lines (if requested) are the true rather than fitted regression lines.
</p>


<h3>See Also</h3>

<p><code>calcregions()</code> for fitting segmented regression models to the simulated data; <code>calcmodel()</code> for fitting a single segmented regression model to the simulated data; <code>plotsegreg()</code> for plotting estimated regression lines.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Simulate 40 vertebra, 4 regions (3 breakpoints), 3 PCOs,
# true model R2 of .9, continuous
set.seed(11)
sim &lt;- simregions(nvert = 30, nregions = 4, nvar = 3, r2 = .95,
                  minvert = 3, cont = TRUE)

sim

# Plot the true data-generating lines and breakpoints
plot(sim, scores = 1:3)

# Run segmented regression models on simulated data,
# up to 6 regions
simresults &lt;- calcregions(sim, scores = 1:3, noregions = 6,
                          minvert = 3, cont = TRUE,
                          verbose = FALSE)

summary(simresults)

# Select best model for each number of regions
(simmodels &lt;- modelselect(simresults))

# Evaluate support for each model and rank models
(simsupp &lt;- modelsupport(simmodels))
# AICc supports 3-4 regions

# Evaluate model performance of best model
modelperf(sim, modelsupport = simsupp,
          criterion = "aic", model = 1)
# Second best model (3 regions) does quite well, too
modelperf(sim, modelsupport = simsupp,
          criterion = "aic", model = 2)

#Plot best model fit
plotsegreg(sim, scores = 1:3,
           modelsupport = simsupp,
           criterion = "aic", model = 1)

# Calculate variability of estimate breakpoints for
# 3-region model; high uncertainty for breakpoints
# 1 and 2. Note weighted value for breakpoint 2
# differs from that of best model
bpvar &lt;- calcBPvar(simresults, noregions = 4,
                   pct = .05, criterion = "aic")
bpvar

# Plot estimated vertebral map with variability
plotvertmap(sim, modelsupport = simsupp, model = 1,
            criterion = "aic", text = TRUE)

# True map; pretty close
plotvertmap(sim, bps = c(3, 7, 24),
            text = TRUE)
</code></pre>


</div>