<div class="container">

<table style="width: 100%;"><tr>
<td>lands.grp.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Significance tests between sets of weights
</h2>

<h3>Description</h3>

<p><code>lands.grp.test()</code> performs a statistical test for whether the optimal adaptive landscape for two subgroups are significantly different from each other. The p-value of the test is the proportion of weight sets that are shared between the two subgroups among their respective top weight sets. <code>multi.lands.grp.test()</code> performs this test for all pairs of subgroups.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lands.grp.test(grpa, grpb, method = "chi-squared",
               quantile = 0.05)

multi.lands.grp.test(x, method = "chi-squared",
                     quantile = 0.05)

## S3 method for class 'lands.grp.test'
print(x, digits = max(3L, getOption("digits") - 3L), ...)

## S3 method for class 'multi.lands.grp.test'
print(x, digits = max(3L, getOption("digits") - 3L), 
      style = "matrix", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>grpa, grpb</code></td>
<td>

<p>for <code>lands.grp.test()</code>, the two <code>grp_Wprime</code> objects containing the adaptive landscapes to be compared; these are the output of calls to <code>calcGrpWprime</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>for <code>multi.lands.grp.test()</code>, a <code>by_Wprime</code> object, the output of a call to <code>calcWprimeBy</code>.
</p>
<p>for <code>print()</code>, the output of a call to <code>lands.grp.test()</code> or <code>multi.lands.grp.test()</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>the method used to determine which sets of weights are in the "best" sets of weights that are to be comapred between the two groups. Allowable options include <code>"chi-squared"</code> and <code>"quantile"</code>. See <code>calcGrpWprime</code> for details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantile</code></td>
<td>

<p>the top quantile used to determine the best sets of weights to be included in the average to compute the optimal set of weights. Should be a number between 0 and 1, with a low value indicating that only the few top sets of weights will be used. See <code>calcGrpWprime</code> for details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>

<p>the number of significant digits to print.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>style</code></td>
<td>

<p>how to display the results of the pairwise tests; allowable options include <code>"matrix"</code> and <code>"table"</code>. Abbreviations allowed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>passed to <code>print.default</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>lands.grp.test()</code> performs pairwise comparisons between two adaptive groups by comparing the number of shared landscapes <code class="reqn">n_{A+B}</code> in the top percentile of each group with the total number of landscapes in this top percentile <code class="reqn">n_{total}</code>. The probability <code class="reqn">P(A=B)</code> thus is calculated as:
</p>
<p style="text-align: center;"><code class="reqn">
P(A=B) = n_{A+B}/n_{total}
</code>
</p>

<p>If <code>method = "quantile"</code> is used, then the top percentile is defined by <code>quantile</code>. If <code>method = "chi-squared"</code> is used, then the top percentile is calculated from the chi-squared value <code class="reqn">\chi^2_i</code> as: </p>
<p style="text-align: center;"><code class="reqn">\chi^2_i = -2 \log \frac{Z_{max}}{Z_i}</code>
</p>
<p> where <code class="reqn">Z_{max}</code> is the largest <code class="reqn">Z</code> among the weights, and a p-value is computed for each <code class="reqn">\chi^2_i</code> value using a <code class="reqn">\chi^2</code> distribution with 2 d.f.; any set of weights with a p-value less than <code>quantile</code> is included in the optimal set of weights.
</p>
<p><code>multi.lands.grp.test()</code> is a wrapper for <code>lands.grp.test()</code>, applying the function pairwise to all combinations of groups calculated by <code>calcWprimeBy</code>.
</p>


<h3>Value</h3>

<p>For <code>lands.grp.test()</code>, a <code>lands.grp.test</code> object containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>n.match</code></td>
<td>
<p>the number of sets of weights that match between the two supplied subgroups</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.val</code></td>
<td>
<p>the p-value of the test, computed as the number of sets of weights that match divided by the number of sets of weights compared</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>matching</code></td>
<td>
<p>a matrix containing the sets of weights that match between the two subgroups</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the argument supplied to <code>method</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantile</code></td>
<td>
<p>the argument supplied to <code>quantile</code></p>
</td>
</tr>
</table>
<p>For <code>multi.lands.grp.test()</code>, a <code>multi.lands.grp.test</code> object containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>a data frame containing the results of the tests, with the columns <code>Group A</code> and <code>Group B</code> indicating the groups involved in the comparison, the column <code>Matches</code> containing the number of matching sets of weights in the comparison, and the column <code>p value</code> containing the p-value of the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the argument supplied to <code>method</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantile</code></td>
<td>
<p>the argument supplied to <code>quantile</code></p>
</td>
</tr>
</table>
<p>For <code>print.multi.lands.grp.test()</code>, setting <code>style = "table"</code> prints the <code>res</code> component as-is; setting <code>style = "matrix"</code> creates a matrix where the p-values of the test are below the diagonal and the number of matches of the test are above the diagonal.
</p>


<h3>References</h3>

<p>Jones, K. E., Dickson, B. V., Angielczyk, K. D., &amp; Pierce, S. E. (2021). Adaptive landscapes challenge the "lateral-to-sagittal"" paradigm for mammalian vertebral evolution. Current Biology, 31(9), 1883-1892.
</p>


<h3>See Also</h3>

<p><code>calcGrpWprime</code> and <code>calcWprimeBy</code> for creatign the objects used as inputs to these functions
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("warps")
data("turtles")

warps_fnc &lt;- as_fnc_df(warps, 
                       func.names = c("hydro", "fea"))

kr_surf &lt;- krige_surf(warps_fnc, new_data = turtles)

grid_weights &lt;- generate_weights(n = 3, data = kr_surf)

all_lscps &lt;- calc_all_lscps(kr_surf,
                            grid_weights = grid_weights)

# Comparing adaptive landscapes of Ecology groups S and M
wprime_S &lt;- calcGrpWprime(all_lscps,
                          index = Ecology == "S")
wprime_M &lt;- calcGrpWprime(all_lscps,
                          index = Ecology == "M")
lands.grp.test(wprime_S, wprime_M)

# Comparing adaptive landscapes of all Group subgroups
wprime_by_Group &lt;- calcWprimeBy(all_lscps, by = ~Group)
tests &lt;- multi.lands.grp.test(wprime_by_Group)
tests
print(tests, style = "table")
</code></pre>


</div>