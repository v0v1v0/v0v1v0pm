<div class="container">

<table style="width: 100%;"><tr>
<td>calc_lscp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Calculate a single weighted adaptive landscape
</h2>

<h3>Description</h3>

<p><code>calc_lscp()</code> calculates a single weighted landscape from a set of kriged surfaces of functional characteristics and a set of weights for those characteristics. This landscape can then be plotted using <code>plot.wtd_lscp</code>. Additionally computes the fitness values for a sample of additional coordinates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calc_lscp(data, weights, ...)

## S3 method for class 'kriged_surfaces'
calc_lscp(data, weights, ...)

## S3 method for class 'all_lscps'
calc_lscp(data, weights, i, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>a <code>kriged_surfaces</code> or <code>all_lscps</code> object; the output of a call to <code>krige_surf</code> or <code>calc_all_lscps</code>, repsectively. If no <code>new_data</code> component is included in <code>data</code>, only the adaptive landscape will be produced.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>

<p>a vector of weights, one for each functional characteristic. These weights should be nonnegative and sum to 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>i</code></td>
<td>

<p>when <code>data</code> is an <code>all_lscps</code> object, the index of the set of weights in the <code>grid_weights</code> object supplied to <code>calc_all_lscps()</code> to use to create the weighted landscape.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>ignored.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>calc_lscp()</code> operates on the kriged surfaces stored in <code>data</code> by multiplying the functional characteristic values of each point on the surface grid by the weights and computing the sum of those values to arrive at a "fitness" value that is represented by the maximum height of the combined adaptive landscape. When a <code>new_data</code> component is present in <code>data</code> (e.g., because a <code>new_data</code> argument was supplied to <code>krige_surf()</code> or <code>data</code> is the output of a call to <code>krige_new_data()</code>), the weighted fitness values will be computed for the coordinates in <code>new_data</code> as well.
</p>


<h3>Value</h3>

<p>A <code>wtd_lscp</code> object, which contains the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>a named vector of the supplied weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Wprime</code></td>
<td>
<p>a list containing the weighted <code>grid</code> and <code>new_data</code> components of <code>data</code>, where the values of the functional characteristics for each location on the surface are weighted by the supplied weights and an additiona column, <code>Z</code>, has been added containing the height of the adaptive landscape at that point.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>plot.wtd_lscp</code> for plotting the resulting weighted landscape.
</p>
<p><code>generate_weights</code> for generating a matrix of weights.
</p>
<p><code>calc_all_lscps</code> for computing weighted landscapes for a matrix of weights (i.e., rather than the single set of weights that can be used with <code>calc_lscp</code>). For finding an optimal set of weights, <code>calc_all_lscps</code> should be used, though it only produces the weighted fitness values for each set of weightd and not the weighted functional characteristic surfaces.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("warps")

warps_fnc &lt;- as_fnc_df(warps, func.names = c("hydro", "fea"))

kr_surf &lt;- krige_surf(warps_fnc)

weights &lt;- c(hydro = .5, fea = .5)

w_lscp &lt;- calc_lscp(kr_surf, weights = weights)

plot(w_lscp)

# Adding new_data
data("turtles")
kr_surf &lt;- krige_new_data(kr_surf, new_data = turtles)

w_lscp &lt;- calc_lscp(kr_surf, weights = weights)
w_lscp
plot(w_lscp)

## See further use with calc_all_lscps() 
## at help("calc_all_lscps")
</code></pre>


</div>