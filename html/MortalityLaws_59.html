<div class="container">

<table style="width: 100%;"><tr>
<td>MortalityLaw</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit Mortality Laws</h2>

<h3>Description</h3>

<p>Fit parametric mortality models given a set of input data which can be
represented by death counts and mid-interval population estimates
<code>(Dx, Ex)</code> or age-specific death rates <code>(mx)</code> or death
probabilities <code>(qx)</code>. Using the argument <code>law</code> one can specify
the model to be fitted. So far more than 27 parametric models have been
implemented; check the <code>availableLaws</code> function to learn
about the available options. The models can be fitted under
the maximum likelihood methodology or by selecting a loss function to be
optimised. See the implemented loss function by running the
<code>availableLF</code> function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MortalityLaw(x, Dx = NULL, Ex = NULL, mx = NULL, qx = NULL,
                law = NULL,
                opt.method = "LF2",
                parS = NULL,
                fit.this.x = x,
                custom.law = NULL,
                show = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Vector of ages at the beginning of the age interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dx</code></td>
<td>
<p>Object containing death counts. An element of the <code>Dx</code> object
represents the number of deaths during the year to persons aged x to x+n.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ex</code></td>
<td>
<p>Exposure in the period. <code>Ex</code> can be approximated by the
mid-year population aged x to x+n.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mx</code></td>
<td>
<p>Life table death rate in age interval [x, x+n).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qx</code></td>
<td>
<p>Probability of dying in age interval [x, x+n).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>law</code></td>
<td>
<p>The name of the mortality law/model to be used. e.g.
<code>gompertz</code>, <code>makeham</code>, ... To investigate all the possible options,
see <code>availableLaws</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt.method</code></td>
<td>
<p>How would you like to find the parameters? Specify the
function to be optimize. Available options: the Poisson likelihood function
<code>poissonL</code>; the Binomial likelihood function -<code>binomialL</code>; and
6 other loss functions. For more details, check the <code>availableLF</code>
function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parS</code></td>
<td>
<p>Starting parameters used in the optimization process (optional).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.this.x</code></td>
<td>
<p>Select the ages to be considered in model fitting.
By default <code>fit.this.x = x</code>. One may want to exclude from the fitting
procedure, say, the advanced ages where the data is sparse.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>custom.law</code></td>
<td>
<p>Allows you to fit a model that is not defined
in the package. Accepts as input a function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show</code></td>
<td>
<p>Choose whether to display a progress bar during the fitting
process. Logical. Default: <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments to be passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Depending on the complexity of the model, one of following
optimization strategies is employed: </p>

<ol>
<li>
<p> Nelder-Mead method: approximates a local optimum of a problem with n
variables when the objective function varies smoothly and is unimodal.
For details see <code>optim</code>;
</p>
</li>
<li>
<p> PORT routines: provides unconstrained optimization and optimization
subject to box constraints for complicated functions. For details check
<code>nlminb</code>;
</p>
</li>
<li>
<p> Levenberg-Marquardt algorithm: damped least-squares method.
For details check <code>nls.lm</code>.
</p>
</li>
</ol>
<h3>Value</h3>

<p>The output is of the <code>"MortalityLaw"</code> class with the components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>input</code></td>
<td>
<p>List with arguments provided in input. Saved for convenience.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>info</code></td>
<td>
<p>Brief information about the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>Estimated coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>Fitted values of the selected model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>Deviance residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>goodness.of.fit</code></td>
<td>
<p>List containing goodness of fit measures like
AIC, BIC and log-Likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt.diagnosis</code></td>
<td>
<p>Resultant optimization object useful for
checking the convergence etc.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Marius D. Pascariu
</p>


<h3>See Also</h3>

<p><code>availableLaws</code>
<code>availableLF</code>
<code>LifeTable</code>
<code>ReadHMD</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Example 1: --------------------------
# Fit Makeham Model for Year of 1950.

x  &lt;- 45:75
Dx &lt;- ahmd$Dx[paste(x), "1950"]
Ex &lt;- ahmd$Ex[paste(x), "1950"]

M1 &lt;- MortalityLaw(x = x, Dx = Dx, Ex = Ex, law = 'makeham')

M1
ls(M1)
coef(M1)
summary(M1)
fitted(M1)
predict(M1, x = 45:95)
plot(M1)


# Example 2: --------------------------
# We can fit the same model using a different data format
# and a different optimization method.
x  &lt;- 45:75
mx &lt;- ahmd$mx[paste(x), ]
M2 &lt;- MortalityLaw(x = x, mx = mx, law = 'makeham', opt.method = 'LF1')
M2
fitted(M2)
predict(M2, x = 55:90)

# Example 3: --------------------------
# Now let's fit a mortality law that is not defined
# in the package, say a reparameterized Gompertz in
# terms of modal age at death
# hx = b*exp(b*(x-m)) (here b and m are the parameters to be estimated)

# A function with 'x' and 'par' as input has to be defined, which returns
# at least an object called 'hx' (hazard rate).
my_gompertz &lt;- function(x, par = c(b = 0.13, M = 45)){
  hx  &lt;- with(as.list(par), b*exp(b*(x - M)) )
  return(as.list(environment()))
}

M3 &lt;- MortalityLaw(x = x, Dx = Dx, Ex = Ex, custom.law = my_gompertz)
summary(M3)
# predict M3 for different ages
predict(M3, x = 85:130)


# Example 4: --------------------------
# Fit Heligman-Pollard model for a single
# year in the dataset between age 0 and 100 and build a life table.

x  &lt;- 0:100
mx &lt;- ahmd$mx[paste(x), "1950"] # select data
M4 &lt;- MortalityLaw(x = x, mx = mx, law = 'HP', opt.method = 'LF2')
M4
plot(M4)

LifeTable(x = x, qx = fitted(M4))
</code></pre>


</div>