<div class="container">

<table style="width: 100%;"><tr>
<td>mplusRcov</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create Mplus code for various residual covariance structures.</h2>

<h3>Description</h3>

<p>This function makes it easy to write the Mplus syntax for various
residual covariance structure.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mplusRcov(
  x,
  type = c("homogenous", "heterogenous", "cs", "toeplitz", "ar", "un"),
  r = "rho",
  e = "e",
  collapse = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>input character vector of variable names, ordered by time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A character string indicating the type of residual covariance
structure to be used. Defaults to ‘homogenous’. Current options include
‘homogenous’, ‘heterogenous’, ‘cs’ for compound symmetric,
‘toeplitz’ for banded toeplitz, ‘ar’ for autoregressive, and
‘un’ for unstructured.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>a character vector of the base label to name covariance parameters.
Defaults to ‘rho’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e</code></td>
<td>
<p>a character vector of the error variance of the variable.
Used to create constraints on the covariance parameters. Defaults to ‘e’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>collapse</code></td>
<td>
<p>whether to collapse the covariance code using ‘PWITH’. Note that
at the time of writing, Mplus does not allow more than 80 characters per row.
Defaults to <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <strong>homogenous</strong> residual covariance structure estimates one parameter:
the residual variance, <code class="reqn">\sigma^{2}_{e}</code>. The residual variance
is assumed to be identical for all variables and all covariances are
assumed to be zero. The structure is represented in this table.
</p>

<table>
<tr>
<td style="text-align: left;">
    </td>
<td style="text-align: left;"> t1 </td>
<td style="text-align: left;"> t2 </td>
<td style="text-align: left;"> t3 </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> tn </td>
</tr>
<tr>
<td style="text-align: left;">
  t1 </td>
<td style="text-align: left;"> <code class="reqn">\sigma^{2}_{e}</code> </td>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
  t2 </td>
<td style="text-align: left;"> 0 </td>
<td style="text-align: left;"> <code class="reqn">\sigma^{2}_{e}</code> </td>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
  t3 </td>
<td style="text-align: left;"> 0 </td>
<td style="text-align: left;"> 0 </td>
<td style="text-align: left;"> <code class="reqn">\sigma^{2}_{e}</code> </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
  ... </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> ... </td>
</tr>
<tr>
<td style="text-align: left;">
  tn </td>
<td style="text-align: left;"> 0 </td>
<td style="text-align: left;"> 0 </td>
<td style="text-align: left;"> 0 </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> <code class="reqn">\sigma^{2}_{e}</code> </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>The <strong>heterogenous</strong> residual covariance structure estimates
<b>n</b> parameters, where <b>n</b> is the number of variables.
A unique residual variance is estimated for every variable. All
covariances are assumed to be zero. The structure is represented in this table.
</p>

<table>
<tr>
<td style="text-align: left;">
    </td>
<td style="text-align: left;"> t1 </td>
<td style="text-align: left;"> t2 </td>
<td style="text-align: left;"> t3 </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> tn </td>
</tr>
<tr>
<td style="text-align: left;">
  t1 </td>
<td style="text-align: left;"> <code class="reqn">\sigma^{2}_{e1}</code> </td>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
  t2 </td>
<td style="text-align: left;"> 0 </td>
<td style="text-align: left;"> <code class="reqn">\sigma^{2}_{e2}</code> </td>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
  t3 </td>
<td style="text-align: left;"> 0 </td>
<td style="text-align: left;"> 0 </td>
<td style="text-align: left;"> <code class="reqn">\sigma^{2}_{e3}</code> </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
  ... </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> ... </td>
</tr>
<tr>
<td style="text-align: left;">
  tn </td>
<td style="text-align: left;"> 0 </td>
<td style="text-align: left;"> 0 </td>
<td style="text-align: left;"> 0 </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> <code class="reqn">\sigma^{2}_{en}</code> </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>The <strong>compound symmetric</strong> residual covariance structure estimates
two parameters: one for the residual variance , <code class="reqn">\sigma^{2}_{e}</code>,
and one for the covariance. The residual variance
is assumed to be identical for all variables and all covariances are
assumed to be identical. The structure is represented in this table.
</p>

<table>
<tr>
<td style="text-align: left;">
    </td>
<td style="text-align: left;"> t1 </td>
<td style="text-align: left;"> t2 </td>
<td style="text-align: left;"> t3 </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> tn </td>
</tr>
<tr>
<td style="text-align: left;">
  t1 </td>
<td style="text-align: left;"> <code class="reqn">\sigma^{2}_{e}</code> </td>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
  t2 </td>
<td style="text-align: left;"> <code class="reqn">\rho</code> </td>
<td style="text-align: left;"> <code class="reqn">\sigma^{2}_{e}</code> </td>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
  t3 </td>
<td style="text-align: left;"> <code class="reqn">\rho</code> </td>
<td style="text-align: left;"> <code class="reqn">\rho</code> </td>
<td style="text-align: left;"> <code class="reqn">\sigma^{2}_{e}</code> </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
  ... </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> ... </td>
</tr>
<tr>
<td style="text-align: left;">
  tn </td>
<td style="text-align: left;"> <code class="reqn">\rho</code> </td>
<td style="text-align: left;"> <code class="reqn">\rho</code> </td>
<td style="text-align: left;"> <code class="reqn">\rho</code> </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> <code class="reqn">\sigma^{2}_{e}</code> </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>The <strong>toeplitz</strong> residual covariance structure estimates
<b>n</b> parameters, one for every band of the matrix.
The residual variance , <code class="reqn">\sigma^{2}_{e}</code>, is
assumed to be identical for all variables. The covariances one step removed
are all assumed identical. Likewise for all further bands.
The structure is represented in this table.
</p>

<table>
<tr>
<td style="text-align: left;">
    </td>
<td style="text-align: left;"> t1 </td>
<td style="text-align: left;"> t2 </td>
<td style="text-align: left;"> t3 </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> tn </td>
</tr>
<tr>
<td style="text-align: left;">
  t1 </td>
<td style="text-align: left;"> <code class="reqn">\sigma^{2}_{e}</code> </td>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
  t2 </td>
<td style="text-align: left;"> <code class="reqn">\rho</code> </td>
<td style="text-align: left;"> <code class="reqn">\sigma^{2}_{e}</code> </td>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
  t3 </td>
<td style="text-align: left;"> <code class="reqn">\rho_{2}</code> </td>
<td style="text-align: left;"> <code class="reqn">\rho</code> </td>
<td style="text-align: left;"> <code class="reqn">\sigma^{2}_{e}</code> </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
  ... </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> ... </td>
</tr>
<tr>
<td style="text-align: left;">
  tn </td>
<td style="text-align: left;"> <code class="reqn">\rho_{n}</code> </td>
<td style="text-align: left;"> <code class="reqn">\rho_{n - 1}</code> </td>
<td style="text-align: left;"> <code class="reqn">\rho_{n - 2}</code> </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> <code class="reqn">\sigma^{2}_{e}</code> </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>The <strong>autoregressive</strong> residual covariance structure has two parameters:
the residual variance, <code class="reqn">\sigma^{2}_{e}</code> and
the correlation between adjacent time points, <code class="reqn">\rho</code>. The variances
are constrained to be equal for all time points. A single correlation
parameter is estimated. The <code class="reqn">\rho</code> is the correlation between adjacent
time points such as 1 and 2 or 2 and 3. More distant relationships are assumed
to have smaller correlations, decreasing exponentially. Thus between 1 and 3,
the estimate is <code class="reqn">\rho^2</code>. The structure is represented in this table.
</p>

<table>
<tr>
<td style="text-align: left;">
    </td>
<td style="text-align: left;"> t1 </td>
<td style="text-align: left;"> t2 </td>
<td style="text-align: left;"> t3 </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> tn </td>
</tr>
<tr>
<td style="text-align: left;">
  t1 </td>
<td style="text-align: left;"> <code class="reqn">\sigma^{2}_{e}</code> </td>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
  t2 </td>
<td style="text-align: left;"> <code class="reqn">\rho</code> </td>
<td style="text-align: left;"> <code class="reqn">\sigma^{2}_{e}</code> </td>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
  t3 </td>
<td style="text-align: left;"> <code class="reqn">\rho^2</code> </td>
<td style="text-align: left;"> <code class="reqn">\rho</code> </td>
<td style="text-align: left;"> <code class="reqn">\sigma^{2}_{e}</code> </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
  ... </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> ... </td>
</tr>
<tr>
<td style="text-align: left;">
  tn </td>
<td style="text-align: left;"> <code class="reqn">\rho^{n-1}</code> </td>
<td style="text-align: left;"> <code class="reqn">\rho^{n-2}</code> </td>
<td style="text-align: left;"> <code class="reqn">\rho^{n-3}</code> </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> <code class="reqn">\sigma^{2}_{e}</code> </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>Because structural equation models generally model covariance structures,
the autoregressive residual structure must be parameterized in terms of
covariances. This is done in two parts. First, the function returns
syntax to estimate all the pairwise covariances, labelling the parameters
<code class="reqn">\rho</code>, <code class="reqn">\rho^2</code>, etc. so that they are constrained to be
equal. Next, it returns the syntax for the necessary model constraints to
constrain the different covariances, to decrease exponentially in their
correlations. This is done via:
</p>
<p style="text-align: center;"><code class="reqn">\rho^2 = (\frac{\rho}{\sigma^2_{e}})^{2}\sigma^2_{e}</code>
</p>

<p>and likewise for all later time points.
</p>
<p>The <strong>unstructured</strong> residual covariance structure estimates
<code class="reqn">\frac{n(n + 1)}{2}</code> parameters. It is unstructured
in that every variance and covariance is freely estimated with no
constraints. However, in most cases, this results in an overparameterized
model and is unestimable. The structure is represented in this table.
</p>

<table>
<tr>
<td style="text-align: left;">
    </td>
<td style="text-align: left;"> t1 </td>
<td style="text-align: left;"> t2 </td>
<td style="text-align: left;"> t3 </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> tn </td>
</tr>
<tr>
<td style="text-align: left;">
  t1 </td>
<td style="text-align: left;"> <code class="reqn">\sigma^{2}_{e1}</code> </td>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
  t2 </td>
<td style="text-align: left;"> <code class="reqn">\rho_{1}</code> </td>
<td style="text-align: left;"> <code class="reqn">\sigma^{2}_{e2}</code> </td>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
  t3 </td>
<td style="text-align: left;"> <code class="reqn">\rho_{2}</code> </td>
<td style="text-align: left;"> <code class="reqn">\rho_{3}</code> </td>
<td style="text-align: left;"> <code class="reqn">\sigma^{2}_{e3}</code> </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
  ... </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> ... </td>
</tr>
<tr>
<td style="text-align: left;">
  tn </td>
<td style="text-align: left;"> <code class="reqn">\rho_{5}</code> </td>
<td style="text-align: left;"> <code class="reqn">\rho_{6}</code> </td>
<td style="text-align: left;"> <code class="reqn">\rho_{7}</code> </td>
<td style="text-align: left;"> ... </td>
<td style="text-align: left;"> <code class="reqn">\sigma^{2}_{en}</code> </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>Value</h3>

<p>A named character vector of class ‘MplusRstructure’ with four elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>all</code></td>
<td>
<p>A character string collapsing all other sections.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Variances</code></td>
<td>
<p>A character string containing all of the variances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Covariances</code></td>
<td>
<p>A character string containing all of the
covariances, properly labelled to allow constraints and the
autoregressive residual covariance structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Constraints</code></td>
<td>
<p>A character string containing the ‘MODEL CONSTRAINT’
section and code needed to parameterize the residual covariance structure
as autoregressive.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Joshua F. Wiley &lt;jwiley.psych@gmail.com&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R"># all five structures collapsing
mplusRcov(letters[1:4], "homogenous", "rho", "e", TRUE)
mplusRcov(letters[1:4], "heterogenous", "rho", "e", TRUE)
mplusRcov(letters[1:4], "cs", "rho", "e", TRUE)
mplusRcov(letters[1:4], "toeplitz", "rho", "e", TRUE)
mplusRcov(letters[1:4], "ar", "rho", "e", TRUE)
mplusRcov(letters[1:4], "un", "rho", "e", TRUE)

# all five structures without collapsing
# useful for long names or many variables
# where a line may cross 80 characters
mplusRcov(letters[1:4], "homogenous", "rho", "e", FALSE)
mplusRcov(letters[1:4], "heterogenous", "rho", "e", FALSE)
mplusRcov(letters[1:4], "cs", "rho", "e", FALSE)
mplusRcov(letters[1:4], "toeplitz", "rho", "e", FALSE)
mplusRcov(letters[1:4], "ar", "rho", "e", FALSE)
mplusRcov(letters[1:4], "un", "rho", "e", FALSE)
</code></pre>


</div>