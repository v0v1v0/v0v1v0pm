<div class="container">

<table style="width: 100%;"><tr>
<td>r.squaredGLMM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pseudo-R-squared for Generalized Mixed-Effect models</h2>

<h3>Description</h3>

<p>Calculate conditional and marginal coefficient of determination for 
Generalized mixed-effect models (<code class="reqn">R_{GLMM}^{2}</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">r.squaredGLMM(object, null, ...)
## S3 method for class 'merMod'
r.squaredGLMM(object, null, envir = parent.frame(), pj2014 = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a fitted linear model object. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null</code></td>
<td>
<p>optionally, a null model, including only random effects. See ‘Details’. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>envir</code></td>
<td>
<p>optionally, the <code>environment</code> in which the null model is to be evaluated.
Defaults to the current frame. See <code>eval</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pj2014</code></td>
<td>
<p>logical, if <code>TRUE</code> and <code>object</code> is of <code>poisson</code> 
family, the result will include <code class="reqn">R_{GLMM}^{2}</code> using original formulation of 
Johnson (2014). This requires fitting <code>object</code> with an observation-level
random effect term added. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments, ignored.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>There are two types of <code class="reqn">R_{GLMM}^{2}</code>: marginal and conditional.
</p>
<p><em>Marginal <code class="reqn">R_{GLMM}^{2}</code></em> represents the variance explained by the fixed 
effects, and is defined as:
</p>
<p style="text-align: center;"><code class="reqn">R_{GLMM(m)}^{2}= \frac{\sigma_f^2}{\sigma_f^2 + \sigma_{\alpha}^2 + \sigma_{\varepsilon }^2}
</code>
</p>

<p><em>Conditional <code class="reqn">R_{GLMM}^{2}</code></em> represents the variance explained by the
entire model, including both fixed and random effects. It is calculated
by the equation:
</p>
<p style="text-align: center;"><code class="reqn">R_{GLMM(c)}^{2}= \frac{\sigma_f^2 + \sigma_{\alpha}^2}{\sigma_f^2 + \sigma_{\alpha}^2 + \sigma_{\varepsilon }^2}
</code>
</p>

<p>where <code class="reqn">\sigma_f^2</code>
is the variance of the fixed effect components,
<code class="reqn">\sigma_{\alpha}</code> 
is the variance of the random effects, and  
<code class="reqn">\sigma_\epsilon^2</code>
is the “observation-level” variance.
</p>
<p>Three methods are available for deriving the observation-level variance
<code class="reqn">\sigma_\varepsilon</code>: the delta method, lognormal approximation and using the
trigamma function.
</p>
<p>The delta method can be used with for all distributions and link functions,
while lognormal approximation and trigamma function are limited to distributions
with logarithmic link. Trigamma-estimate is recommended whenever available.
Additionally, for binomial distributions, theoretical variances exist
specific for each link function distribution.
</p>
<p><em>Null model</em>. Calculation of the observation-level variance involves in 
some cases fitting a <em>null</em> model containing no fixed effects other than 
intercept, otherwise identical to the original model (including all the random 
effects). When using <code>r.squaredGLMM</code> for several models differing only in 
their fixed effects, in order to avoid redundant calculations, the null model 
object can be passed as the argument <code>null</code>.
Otherwise, a null model will be fitted <em>via</em> updating the original model.
This assumes that all the variables used in the original model call have the 
same values as when the model was fitted. The function warns about this when 
fitting the null model is required. This warnings can be disabled by setting  
<code>options(MuMIn.noUpdateWarning = TRUE)</code>. 
</p>


<h3>Value</h3>

<p><code>r.squaredGLMM</code> returns a two-column numeric <code>matrix</code>, each (possibly
named) row holding values for marginal and conditional <code class="reqn">R_{GLMM}^{2}</code>
calculated with different methods, such as “delta”,
“log-normal”, “trigamma”, or “theoretical” for models
of <code>binomial</code> family. 	
</p>


<h3>Note</h3>

<p><strong>Important</strong>: as of <span class="pkg">MuMIn</span> version 1.41.0, 
<code>r.squaredGLMM</code> returns a revised statistics based on Nakagawa et 
al. (2017) paper. The returned value's format also has changed (it is a 
<code>matrix</code> rather than a numeric vector as before). Pre-1.41.0 version of the
function calculated the “theoretical” <code class="reqn">R_{GLMM}^{2}</code> for <code>binomial</code>
models.
</p>
<p><code class="reqn">R_{GLMM}^{2}</code> can be calculated also for fixed-effect models. In
the simpliest case of <abbr><span class="acronym">OLS</span></abbr> it reduces to <code>var(fitted) /
(var(fitted) + deviance / 2)</code>. Unlike likelihood-ratio based <code class="reqn">R^{2}</code> for 
<abbr><span class="acronym">OLS</span></abbr>, value of this statistic differs from that of
the classical <code class="reqn">R^{2}</code>.
</p>
<p>Currently methods exist for classes: <code>merMod</code>, <code>lme</code>,
<code>glmmTMB</code>, <code>glmmADMB</code>, <code>glmmPQL</code>, <code>cpglm</code>(<code>m</code>) and
(<code>g</code>)<code>lm</code>.
</p>
<p>For families other than gaussian, Gamma, poisson, binomial and negative binomial,
the residual variance is obtained using <code>get_variance</code> 
from package <span class="pkg">insight</span>.
</p>
<p>See note in <code>r.squaredLR</code> help page for comment on using <code class="reqn">R^{2}</code> in 
model selection.
</p>


<h3>Author(s)</h3>

<p>Kamil Bartoń. This implementation is based on <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> code from 
‘Supporting Information’ for Nakagawa et al. (2014), 
(the extension for random-slopes) Johnson (2014), and includes developments from
Nakagawa et al. (2017).
</p>


<h3>References</h3>

<p>Nakagawa, S., Schielzeth, H. 2013 A general and simple method for obtaining
<code class="reqn">R^{2}</code> from Generalized Linear Mixed-effects Models. <em>Methods in
Ecology and Evolution</em> <b>4</b>, 133–142.
</p>
<p>Johnson, P. C. D. 2014 Extension of Nakagawa &amp; Schielzeth’s <code class="reqn">R_{GLMM}^{2}</code> to random 
slopes models. <em>Methods in Ecology and Evolution</em> <b>5</b>, 44–946.
</p>
<p>Nakagawa, S., Johnson, P. C. D., Schielzeth, H. 2017 The coefficient of
determination <code class="reqn">R^{2}</code> and intra-class correlation coefficient from generalized
linear mixed-effects models revisited and expanded.
<em>J. R. Soc. Interface</em> <b>14</b>, 20170213.
</p>


<h3>See Also</h3>

<p><code>summary.lm</code>, <code>r.squaredLR</code>
</p>
<p><code>r2</code> from package <span class="pkg">performance</span> calculates
<code class="reqn">R_{GLMM}^{2}</code> also for variance at different levels, with optional confidence 
intervals. <span class="pkg">r2glmm</span> has functions for <code class="reqn">R^{2}</code> and partial <code class="reqn">R^{2}</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">

data(Orthodont, package = "nlme")

fm1 &lt;- lme(distance ~ Sex * age, ~ 1 | Subject, data = Orthodont)

fmnull &lt;- lme(distance ~ 1, ~ 1 | Subject, data = Orthodont)

r.squaredGLMM(fm1)
r.squaredGLMM(fm1, fmnull)
r.squaredGLMM(update(fm1, . ~ Sex), fmnull)

r.squaredLR(fm1)
r.squaredLR(fm1, null.RE = TRUE)
r.squaredLR(fm1, fmnull) # same result

## Not run: 
if(require(MASS)) {
    fm &lt;- glmmPQL(y ~ trt + I(week &gt; 2), random = ~ 1 | ID, 
        family = binomial, data = bacteria, verbose = FALSE)
    fmnull &lt;- update(fm, . ~ 1)
    r.squaredGLMM(fm)

    # Include R2GLMM (delta method estimates) in a model selection table:
    # Note the use of a common null model
    dredge(fm, extra = list(R2 = function(x) r.squaredGLMM(x, fmnull)["delta", ]))
    
}

## End(Not run)

</code></pre>


</div>