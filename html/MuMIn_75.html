<div class="container">

<table style="width: 100%;"><tr>
<td>r.squaredLR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Likelihood-ratio based pseudo-R-squared</h2>

<h3>Description</h3>

<p>Calculate a coefficient of determination based on the likelihood-ratio test
(<code class="reqn">R_{LR}^{2}</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">r.squaredLR(object, null = NULL, null.RE = FALSE, ...)

null.fit(object, evaluate = FALSE, RE.keep = FALSE, envir = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a fitted model object. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null</code></td>
<td>
<p>a fitted <em>null</em> model. If not provided, <code>null.fit</code> will
be used to construct it. <code>null.fit</code>'s capabilities are limited to only 
a few model classes, for others the <em>null</em> model has to be specified
manually. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null.RE</code></td>
<td>
<p> logical, should the null model contain random factors?  Only 
used if no <em>null</em> model is given, otherwise omitted, with a warning. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>evaluate</code></td>
<td>
<p>if <code>TRUE</code> evaluate the fitted model object else return
the call. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RE.keep</code></td>
<td>
<p>if <code>TRUE</code>, the random effects of the original model are 
included. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>envir</code></td>
<td>
<p>the environment in which the <em>null</em> model is to be
evaluated, defaults to the environment of the original model's formula. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments, of which only <code>x</code> would be used, to 
maintain compatibility with older versions (<code>x</code> has been replaced 
with <code>object</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This statistic is is one of the several proposed pseudo-<code class="reqn">R^{2}</code>'s for
nonlinear regression models. It is based on an improvement from <em>null</em>
(intercept only) model to the fitted model, and calculated as
</p>
<p style="text-align: center;"><code class="reqn">
  R_{LR}^{2}=1-\exp(-\frac{2}{n}(\log\mathcal{L}(x)-\log\mathcal{L}(0)))
</code>
</p>

<p>where <code class="reqn">\log\mathcal{L}(x)</code> and <code class="reqn">\log\mathcal{L}(0)</code> are the log-likelihoods of the
fitted and the <em>null</em> model respectively.
<abbr><span class="acronym">ML</span></abbr> estimates are used if models have been 
fitted by <abbr><span class="acronym">RE</span></abbr>stricted <abbr><span class="acronym">ML</span></abbr> (by calling <code>logLik</code> with argument 
<code>REML = FALSE</code>). Note that the <em>null</em> model can include the random 
factors of the original model, in which case the statistic represents the 
‘variance explained’ by fixed effects.
</p>
<p>For <abbr><span class="acronym">OLS</span></abbr> models the value is consistent with classical <code class="reqn">R^{2}</code>. In some 
cases (e.g. in logistic regression), the maximum <code class="reqn">R_{LR}^{2}</code> is less than one. 
The modification proposed by Nagelkerke (1991) adjusts the <code class="reqn">R_{LR}^{2}</code> to achieve 
1 at its maximum:
<code class="reqn">\bar{R}^{2} = R_{LR}^{2} / \max(R_{LR}^{2})
</code>
where
<code class="reqn">\max(R_{LR}^{2}) = 1 - \exp(\frac{2}{n}\log\mathcal{L}(\textrm{0}))
</code>.
</p>
<p><code>null.fit</code> tries to guess the <em>null</em> model call, given the provided
fitted model object. This would be usually a <code>glm</code>. The function will give
an error for an unrecognised class.
</p>


<h3>Value</h3>

<p><code>r.squaredLR</code> returns a value of <code class="reqn">R_{LR}^{2}</code>, and the
attribute <code>"adj.r.squared"</code> gives the Nagelkerke's modified statistic.
Note that this is not the same as nor equivalent to the classical 
‘adjusted R squared’.
</p>
<p><code>null.fit</code> returns the fitted <em>null</em> model object (if
<code>evaluate = TRUE</code>) or an unevaluated call to fit a <em>null</em> model.
</p>


<h3>Note</h3>

<p><code class="reqn">R^{2}</code> is a useful goodness-of-fit measure as it has the interpretation
of the proportion of the variance ‘explained’, but it performs poorly in
model selection, and is not suitable for use in the same way as the information
criteria.
</p>


<h3>References</h3>

<p>Cox, D. R. and Snell, E. J. 1989 <em>The analysis of binary data</em>, 2nd ed.
London, Chapman and Hall.
</p>
<p>Magee, L. 1990 <code class="reqn">R^{2}</code> measures based on Wald and likelihood ratio joint
significance tests. <em>Amer. Stat.</em> <b>44</b>, 250–253.
</p>
<p>Nagelkerke, N. J. D. 1991 A note on a general definition of the coefficient of
determination. <em>Biometrika</em> <b>78</b>, 691–692.
</p>


<h3>See Also</h3>

<p><code>summary.lm</code>, <code>r.squaredGLMM</code>
</p>
<p><code>r2</code> from package <span class="pkg">performance</span> calculates
many different types of <code class="reqn">R^{2}</code>.
</p>


</div>