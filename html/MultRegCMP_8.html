<div class="container">

<table style="width: 100%;"><tr>
<td>mcmc_cmp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MCMC Algorithm for Conway-Maxwell-Poisson Regression Model for Multivariate Correlated Count Data</h2>

<h3>Description</h3>

<p>MCMC Algorithm to estimate the parameters in the regression model for multivariate correlated count data
</p>


<h3>Usage</h3>

<pre><code class="language-R">mcmc_cmp(
  y,
  X,
  S = 10000,
  nburn = 5000,
  initial_beta,
  initial_gamma,
  initial_b,
  prior_mean_beta,
  prior_var_beta,
  prior_mean_gamma,
  prior_var_gamma,
  v_0,
  R_0,
  intercept = FALSE,
  scale_b,
  scale_beta,
  scale_gamma,
  scale_cov_b,
  scale_cov_beta,
  scale_cov_gamma,
  inc_burn = FALSE,
  re_chain = TRUE,
  way = 2,
  random_seed,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Matrix of observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Covariates list, each element is the design matrix for each column of y</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>Number of MCMC samples to be drawn</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nburn</code></td>
<td>
<p>Number of MCMC samples to burn-in</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial_beta</code></td>
<td>
<p>List with initial value of <code class="reqn">beta</code> for each response</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial_gamma</code></td>
<td>
<p>List with initial value of <code class="reqn">gamma</code> for each response</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial_b</code></td>
<td>
<p>Initital value of <code class="reqn">b</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior_mean_beta</code></td>
<td>
<p>Prior mean for <code class="reqn">beta</code>. (Default zero vector)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior_var_beta</code></td>
<td>
<p>Prior covariance matrix for <code class="reqn">beta</code> (Default <code class="reqn">I</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior_mean_gamma</code></td>
<td>
<p>Prior mean for <code class="reqn">beta</code>. (Default zero vector)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior_var_gamma</code></td>
<td>
<p>Prior covariance matrix for <code class="reqn">gamma</code> (Default <code class="reqn">I</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v_0</code></td>
<td>
<p>Prior degrees of freedom of random effects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R_0</code></td>
<td>
<p>Prior covariance matrix of random effects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>Logical value indicating whether include the intercept</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale_b</code></td>
<td>
<p>Covariance matrix for RW proposals of the random effects (Default <code class="reqn">I</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale_beta</code></td>
<td>
<p>List with initial values for the scale matrices of <code class="reqn">beta</code> (Default <code class="reqn">I</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale_gamma</code></td>
<td>
<p>List with initial values for the scale matrices of <code class="reqn">gamma</code> (Default <code class="reqn">I</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale_cov_b</code></td>
<td>
<p>Scale parameter for the RW of random effects. (Default <code class="reqn">2.4/sqrt(2)</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale_cov_beta</code></td>
<td>
<p>Scale parameter for the covariance of the proposals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale_cov_gamma</code></td>
<td>
<p>Scale parameter for the covariance of the proposals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inc_burn</code></td>
<td>
<p>logical: include burned samples in the return</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>re_chain</code></td>
<td>
<p>logical: If the posterior samples for the r.e are include. False return just the mean</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>way</code></td>
<td>
<p>How to calculate the MCMC updates, based on Chib (2001)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random_seed</code></td>
<td>
<p>Random seed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters of the MCMC algorithm</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>posterior_b</code></td>
<td>
<p>List with posterior values of the random effects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimation_beta</code></td>
<td>
<p>Estimation of beta parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posterior_beta</code></td>
<td>
<p>List with posterior values of beta</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimation_gamma</code></td>
<td>
<p>Estimation of gamma parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posterior_gamma</code></td>
<td>
<p>List with posterior values of gamma</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posterior_D</code></td>
<td>
<p>Values of covariance matrix D</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted_mu</code></td>
<td>
<p>Posterior of location parameters for each response</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted_nu</code></td>
<td>
<p>Posterior of shape parameters for ecah response</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accept_rate_b</code></td>
<td>
<p>Acceptance rate of Random Effects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accept_rate_beta</code></td>
<td>
<p>Acceptance rate of beta</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accept_rate_gamma</code></td>
<td>
<p>Acceptance rate of gamma</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale_beta</code></td>
<td>
<p>Estimated Scale matrix for beta parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale_gamma</code></td>
<td>
<p>Estimated Scale matrix for gamma parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>List of covariates used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Matrix of observed counts</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">
  n = 50; J = 2
  X = list(matrix(rnorm(3*n), ncol = 3), matrix(rnorm(3*n), ncol = 3))
  beta &lt;- list(c(1,0.1, 1), c(0, 0.5, -0.5))
  mu &lt;- exp(prod_list(X, beta))
  y = matrix(rpois(n = length(mu), lambda = mu), nrow = n)
  fit &lt;- mcmc_cmp(y, X, S = 10000, nburn = 1000, scale_cov_b = 0.8,
  scale_cov_beta = 0.04, scale_cov_gamma = 0.06)

</code></pre>


</div>