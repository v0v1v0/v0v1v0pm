<div class="container">

<table style="width: 100%;"><tr>
<td>perm_gehan</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multivariate permutation Gehan test</h2>

<h3>Description</h3>

<p>Computes the p-value of the multivariate permutation Gehan test described in Persson et al. (2019).
</p>


<h3>Usage</h3>

<pre><code class="language-R">perm_gehan(B = 999, z, delta.z, n1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>An integer specifying the number of permutations to perform. The default is 999. It is recommended to use <code>choose_B</code> for choosing <code>B</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>A matrix containing the observed (possibly censored) survival times for the two groups. The observations for the first group should be one the first <code>n1</code> rows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta.z</code></td>
<td>
<p>A matrix containing the censoring status of each observation in <code>z</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n1</code></td>
<td>
<p>An integer specifying the sample size of the first group.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Multivariate version of the logrank and Gehan tests were described by
Wei &amp; Lachin (1984). Persson et al. (2019) described permutation versions of
these tests, with improved performance.
</p>


<h3>Value</h3>

<p>A p-value.
</p>


<h3>References</h3>

<p>Persson I, Arnroth L, Thulin M (2019).
“Multivariate two sample permutation tests for trials with multiple time to event outcomes.”
<em>Pharmaceutical Statistics</em>, <b>18</b>, 476–485.
doi: <a href="https://doi.org/10.1002/pst.1938">10.1002/pst.1938</a>, <a href="https://doi.org/10.1002/pst.1938">https://doi.org/10.1002/pst.1938</a>.
</p>
<p>Wei LJ, Lachin JM (1984).
“Two sample asymptotically distribution free tests for incomplete multivariate observations.”
<em>Journal of the American Statistical Association</em>, <b>79(387)</b>, 653–661.
doi: <a href="https://doi.org/10.1080/01621459.1984.10478093">10.1080/01621459.1984.10478093</a>, <a href="https://doi.org/10.1080/01621459.1984.10478093">https://doi.org/10.1080/01621459.1984.10478093</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Diabetes data:
?diabetes
# Survival times for the two groups:
x &lt;- as.matrix(subset(diabetes, LASER==1)[c(6,8)])
y &lt;- as.matrix(subset(diabetes, LASER==2)[c(6,8)])
# Censoring status for the two groups:
delta.x &lt;- as.matrix(subset(diabetes, LASER==1)[c(7,9)])
delta.y &lt;- as.matrix(subset(diabetes, LASER==2)[c(7,9)])
# Create the input for the test:
z &lt;- rbind(x, y)
delta.z &lt;- rbind(delta.x, delta.y)
# Run the test with 50 permutations:
perm_gehan(B = 50, z, delta.z, n1 = nrow(x))
# In most cases, it is preferable to use more than 50
# permutations for computing p-values. choose_B() can
# be used to determine how many permutations are needed.

</code></pre>


</div>