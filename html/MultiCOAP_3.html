<div class="container">

<table style="width: 100%;"><tr>
<td>MultiCOAP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit the multi-study covariate-augmented overdispersed Poisson factor model via variational inference</h2>

<h3>Description</h3>

<p>Fit the high-dimensional multi-study covariate-augmented overdispersed Poisson factor model via variational inference.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MultiCOAP(
  XcList,
  ZList,
  q = 15,
  qs = rep(2, length(XcList)),
  rank_use = NULL,
  aList = NULL,
  init = c("MSFRVI", "LFM"),
  epsELBO = 1e-05,
  maxIter = 30,
  verbose = TRUE,
  seed = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>XcList</code></td>
<td>
<p>a length-M list with each component a count matrix, which is the observed count matrix from each source/study.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ZList</code></td>
<td>
<p>a length-M list with each component a matrix that is the covariate matrix from each study.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>an optional integer, specify the number of study-shared factors; default as 15.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qs</code></td>
<td>
<p>a integer vector with length M, specify the number of study-specifed factors; default as 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank_use</code></td>
<td>
<p>an optional integer, specify the rank of the regression coefficient matrix; default as NULL, which means that rank is the dimension of covariates in Z.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aList</code></td>
<td>
<p>an optional length-M list with each component a vector, the normalization factors of each study; default as full-one vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>an optional string, specify the initialization method, default as "MSFRVI".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsELBO</code></td>
<td>
<p>an optional positive vlaue, tolerance of relative variation rate of the envidence lower bound value, defualt as '1e-5'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxIter</code></td>
<td>
<p>the maximum iteration of the VEM algorithm. The default is 30.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>a logical value, whether output the information in iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>an optional integer, specify the random seed for reproducibility in initialization.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>init="MSFRVI"</code>, it will use the results from multi-study linear factor model as initial values; If <code>init="LFM"</code>, it will use the results from linear factor model by combing data from all studies as initials.
</p>


<h3>Value</h3>

<p>return a list including the following components: (1) F, a list composed by the posterior estimation of study-shared factor matrix for each study; (2) H,  a list composed by the posterior estimation of study-specified factor matrix for each study; 
(3) Sf, a list consisting of the posterior estimation of covariance matrix of study-shared factors for each study; (4) Sh, a list consisting of the posterior estimation of covariance matrix of study-specified factors for each study;
(5) A, the loading matrix corresponding to study-shared factors; (6) B, a list composed by the loading matrices corresponding to the study-specified factors;
(7) bbeta, the estimated regression  coefficient matrix; (8) invLambda, the inverse of the estimated variances of error;  (9) ELBO: the ELBO value when algorithm stops; (7) ELBO_seq: the sequence of ELBO values.
(11) qrlist, the number of factors and rank of regression coefficient matrix used in fitting;  (12) time.use, the elapsed time for model fitting.
</p>


<h3>References</h3>

<p>None
</p>


<h3>See Also</h3>

<p><code>MSFRVI</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">seed &lt;- 1; nvec &lt;- c(100,300); p&lt;- 300;
d &lt;- 3; q&lt;- 3; qs &lt;- rep(2,2)
datlist &lt;- gendata_simu_multi2(seed=seed, nvec=nvec, p=p, d=d, q=3, qs=qs)
fit_mcoap &lt;- MultiCOAP(datlist$Xlist, ZList = datlist$Zlist, q=3, qs=qs, rank_use = d)
str(fit_mcoap)
</code></pre>


</div>