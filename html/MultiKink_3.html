<div class="container">

<table style="width: 100%;"><tr>
<td>KinkTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test the existence of kink effect in the multi-kink quantile regression</h2>

<h3>Description</h3>

<p>This function tests the existence of a kink effect in the multi-kink quantile regression.
</p>


<h3>Usage</h3>

<pre><code class="language-R">KinkTest(
  y,
  thre.x,
  cont.z,
  id,
  tau = 0.5,
  NB = 200,
  sparsity = "nid",
  bandwidth_type = c("Hall-Sheather", "Bofinger", "Chamberlain")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A numeric vector of response.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thre.x</code></td>
<td>
<p>A numeric vector of scalar covariate with threshold effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cont.z</code></td>
<td>
<p>A numeric matrix of design covariates with constant slopes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>A numeric vector of index used for longitudinal data; can be missing or NULL for iid data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>A numeric scalar representing the quantile level (default is 0.5).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NB</code></td>
<td>
<p>An integer specifying the resampling times (default is 200).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sparsity</code></td>
<td>
<p>The error term type. Specify one from "iid" and "nid" (default is "nid").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandwidth_type</code></td>
<td>
<p>The bandwidth type. Specify one from "Hall-Sheather", "Bofinger", or "Chamberlain" (default is "Hall-Sheather").</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the p-value (pv), the statistic based on the original data (Tn), and the statistics by wild bootstrap (Tn.NB).
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Example 1: i.i.d data type
library(quantreg)
n = 200
Z1 &lt;- rexp(n,1)
Z2 &lt;- rbinom(n,1,0.5)
Z &lt;- cbind(Z1,Z2)
epsilon &lt;- rnorm(n,0,1)
X &lt;- runif(n,-2,1)
psi &lt;- c(-1,0)
k &lt;- length(psi)
PSI &lt;- matrix(rep(psi,rep(n,k)),ncol=k)
XP &lt;- matrix(rep(X,k),nrow=n)
XR &lt;- cbind(1,X,pmax((XP-PSI),0),Z)
bet &lt;- c(1,-1,0,0,sqrt(3),-sqrt(3))
Y &lt;- XR %*% bet + epsilon
obj &lt;- KinkTest(y=Y,thre.x=X,cont.z=Z,
                bandwidth_type=c("Hall-Sheather"))
obj$pv

## Not run: 
# Example 2: longitudinal data
library(quantreg)
N = 200
T = 5
subject = rep(1:N,each=T)
NT = N*T
Z1 &lt;- rexp(NT,1)
Z2 &lt;- rbinom(NT,1,0.5)
Z &lt;- cbind(Z1,Z2)
epsilon &lt;- rnorm(NT,0,1)
X &lt;- runif(NT,-2,1)
psi &lt;- c(-1,0)
k &lt;- length(psi)
PSI &lt;- matrix(rep(psi,rep(NT,k)),ncol=k)
a &lt;- rnorm(N,0,1)
A &lt;- rep(a,each=T)
XP &lt;- matrix(rep(X,k),nrow=NT)
XR &lt;- cbind(1,X,pmax((XP-PSI),0),Z)
bet &lt;- c(1,-1,0,0,sqrt(3),-sqrt(3))
Y &lt;- XR %*% bet + A + epsilon
obj &lt;- KinkTest(y=Y,thre.x=X,cont.z=Z,id=subject,
                bandwidth_type=c("Hall-Sheather"))
obj$pv

## End(Not run)
</code></pre>


</div>