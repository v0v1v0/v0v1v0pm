<div class="container">

<table style="width: 100%;"><tr>
<td>search.model</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Search for the global maximum of the log-likelihood</h2>

<h3>Description</h3>

<p>It search for the global maximum of the log-likelihood given a vector of possible number
of classes to try for.</p>


<h3>Usage</h3>

<pre><code class="language-R">search.model(S, yv = rep(1,ns), kv, X = NULL, link = 0, disc = 0,
             difl = 0, multi = 1:J, fort = FALSE, tol = 10^-10,
             nrep = 2, glob = FALSE, disp=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>matrix of all response sequences observed at least once in the sample and listed row-by-row
(use 999 for missing response)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yv</code></td>
<td>
<p>vector of the frequencies of every response configuration in <code>S</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kv</code></td>
<td>
<p>vector of the possible numbers of latent classes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>matrix of covariates that affects the weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>type of link function (1 = global logits, 2 = local logits);
with global logits the Graded Response model
results; with local logits the  Partial Credit results (with dichotomous responses, global logits
is the same as using local logits resulting in the Rasch or the 2PL model depending on the value
assigned to disc)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>disc</code></td>
<td>
<p>indicator of constraints on the discriminating indices (0 = all equal to one, 1 = free)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>difl</code></td>
<td>
<p>indicator of constraints on the difficulty levels (0 = free, 1 = rating scale parametrization)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>multi</code></td>
<td>
<p>matrix with a number of rows equal to the number of dimensions and elements in each row
equal to the indices of the items measuring the dimension corresponding to that row</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fort</code></td>
<td>
<p>to use fortran routines when possible</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>tolerance level for checking convergence of the algorithm as relative difference between 
consecutive log-likelihoods</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrep</code></td>
<td>
<p>number of repetitions of each random initialization</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>glob</code></td>
<td>
<p>to use global logits in the covariates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>disp</code></td>
<td>
<p>to dispaly partial output</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>out.single</code></td>
<td>
<p>output of each single model (as from est_multi_poly) for each k in kv</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bicv</code></td>
<td>
<p>value of BIC index for each k in kv</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lkv</code></td>
<td>
<p>value of log-likelihood for each k in kv</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Francesco Bartolucci, Silvia Bacci, Michela Gnaldi - University of Perugia (IT)</p>


<h3>References</h3>

<p>Bartolucci, F. (2007), A class of multidimensional IRT models for testing unidimensionality and clustering
items, <em>Psychometrika</em>, <b>72</b>, 141-157.
</p>
<p>Bacci, S., Bartolucci, F. and Gnaldi, M. (2012), A class of Multidimensional Latent Class IRT models for 
ordinal polytomous item responses, <em>Technical report</em>, http://arxiv.org/abs/1201.4667.</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## Search Multidimensional LC IRT models for binary responses
# Aggregate data
data(naep)
X = as.matrix(naep)
out = aggr_data(X)
S = out$data_dis
yv = out$freq
# Define matrix to allocate each item on one dimension 
multi1 = rbind(c(1,2,9,10),c(3,5,8,11),c(4,6,7,12))
out2 = search.model(S, yv = yv, kv=c(1:4),multi=multi1)

## End(Not run)
</code></pre>


</div>