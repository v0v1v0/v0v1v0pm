<div class="container">

<table style="width: 100%;"><tr>
<td>class_item</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Hierarchical classification of test items</h2>

<h3>Description</h3>

<p>It performs a hierarchical classification of a set of test items on the basis of 
the responses provided by a sample of subjects. The classification is based on a
sequence of likelihood ratio tests between pairs of multidimensional models suitably formulated.</p>


<h3>Usage</h3>

<pre><code class="language-R">class_item(S, yv, k, link = 1, disc = 0, difl = 0, fort = FALSE,
           disp = FALSE, tol = 10^-10)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>matrix of all response sequences observed at least once in the sample and listed row-by-row
(use 999 for missing response)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yv</code></td>
<td>
<p>vector of the frequencies of every response configuration in <code>S</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>number of ability levels (or latent classes)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>type of link function (1 = global logits, 2 = local logits);
with global logits the Graded Response model
results; with local logits the  Partial Credit results (with dichotomous responses, global logits
is the same as using local logits resulting in the Rasch or the 2PL model depending on the value
assigned to disc)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>disc</code></td>
<td>
<p>indicator of constraints on the discriminating indices (0 = all equal to one, 1 = free)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>difl</code></td>
<td>
<p>indicator of constraints on the difficulty levels (0 = free, 1 = rating scale parametrization)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fort</code></td>
<td>
<p>to use fortran routines when possible</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>disp</code></td>
<td>
<p>to display the likelihood evolution step by step</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>tolerance level for convergence</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>merge</code></td>
<td>
<p>input for the dendrogram represented by the <code>R</code> function <code>plot</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>height</code></td>
<td>
<p>input for the dendrogram represented by the <code>R</code> function <code>plot</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lk</code></td>
<td>
<p>maximum log-likelihood of the model resulting from each aggregation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>np</code></td>
<td>
<p>number of free parameters of the model resulting from each aggregation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lk0</code></td>
<td>
<p>maximum log-likelihood of the latent class model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>np0</code></td>
<td>
<p>number of free parameters of the latent class model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>list of groups resulting (step-by-step) from the hierarchical clustering</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dend</code></td>
<td>
<p>hclust object to represent the histogram</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>command used to call the function</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Francesco Bartolucci, Silvia Bacci, Michela Gnaldi - University of Perugia (IT)</p>


<h3>References</h3>

<p>Bartolucci, F. (2007), A class of multidimensional IRT models for testing unidimensionality and clustering
items, <em>Psychometrika</em>, <b>72</b>, 141-157.
</p>
<p>Bacci, S., Bartolucci, F. and Gnaldi, M. (2012), A class of Multidimensional Latent Class IRT models for 
ordinal polytomous item responses, <em>Technical report</em>, http://arxiv.org/abs/1201.4667.</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## Model-based hierarchical classification of items from simulated data
# Setup
r = 6  # number of items
n = 1000  # sample size
bev = rep(0,r) 
k = r/2
multi = rbind(1:(r/2),(r/2+1):r)
L = chol(matrix(c(1,0.6,0.6,1),2,2))
data = matrix(0,n,r)
model = 1 
# Create data
Th = matrix(rnorm(2*n),n,2)
for(i in 1:n) for(j in 1:r){
	if(j&lt;=r/2){
    	pc = exp(Th[i,1]-bev[j]); pc = pc/(1+pc)
	}else{
		pc = exp(Th[i,2]-bev[j]); pc = pc/(1+pc)
    }
    data[i,j] = runif(1)&lt;pc
}
# Aggregate data
out = aggr_data(data)
S = out$data_dis
yv = out$freq
# Create dendrogram for items classification, by assuming k=3 latent
# classes and a Rasch parameterization
out = class_item(S,yv,k=3,link=1)
summary(out)
plot(out$dend)

## End(Not run)

## Not run: 
## Model-based hierarchical classification of NAEP items
# Aggregate data
data(naep)
X = as.matrix(naep)
out = aggr_data(X)
S = out$data_dis
yv = out$freq
# Create dendrogram for items classification, by assuming k=4 latent
# classes and a Rasch parameterization
out = class_item(S,yv,k=4,link=1)   
summary(out)
plot(out$dend)

## End(Not run)
</code></pre>


</div>