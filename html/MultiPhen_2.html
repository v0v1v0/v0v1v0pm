<div class="container">

<table style="width: 100%;"><tr>
<td>mPhen</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
A function for the genetic association testing of multiple phenotypes
</h2>

<h3>Description</h3>

<p>mPhen performs association testing between genetic variants (SNPs; CNVs) and multiple phenotypes. The primary purpose is for modelling and testing multiple phenotypes jointly by performing an ordinal regression where SNPs are treated as the outcome and multiple phenotypes are predictors; this can have large increases in statistical power to detect genotype-phenotype associations over the univariate approach (method described in O'Reilly et al. 2012, see below). However, mPhen can also be used to perform standard univariate linear regression (SNP as predictor) and univariate ordinal regression (SNP as outcome) on the phenotypes under study. mPhen can be applied to directly genotyped or imputed data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mPhen(genoData, phenoData, phenotypes = "all",
      covariates = NULL, resids = NULL, strats = NULL, 
      opts = mPhen.options(c("regression","pheno.input")))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>genoData</code></td>
<td>

<p>Either a matrix (for directly measured genotypes) or 3 dimensional array (for imputed genotypes). The first dimension (rows) corresponds to individuals, and row.names are inidividual IDs. The second dimension corresponds to SNPS, with col.names equal to the snp identifiers. For directly measured genotypes, the value in each cell is a numeric genotype( i.e. AA = 0, AB=1, BB = 2).  For imputed genotypes, the 3rd dimension corresponds to genotypes (with dimnames(genoData)[[3]]) equal to a numeric vector corresponding to genotype values. The values in these cells are the probability of each genotype multiplied by 1000.  For copy number genotypes the numeric values correspond to numbers of copies.  An example provided by 'snps' and 'snps.imputed'
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phenoData</code></td>
<td>

<p>Matrix containing phenotype data, where each row corresponds to an individual and row.names are individual IDs. Each column contains data on a certain phenotype across the sample of individuals (can be quantitative, case/control or ordinal. Must be numeric); the column header provides the phenotype name. An example is provided by 'pheno'. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phenotypes</code></td>
<td>

<p>Vector of phenotype names, to be tested.  If value is 'all' then all phenotypes are included after removing covariates and residuals.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariates</code></td>
<td>

<p>Vector of phenotypes, from phenoData, to be considered as covariates to be controlled for in the regression (Default is no covariates).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resids</code></td>
<td>

<p>Vector of residuals, from phenoData, alternative way to adjust for covariates, which pre-calculates offset terms to use in the per SNP regression (Default is no residuals).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strats</code></td>
<td>

<p>Statification vector (i.e. cases/controls, exposed/not exposed, male/female etc), from phenoData (Default is no stratification).
</p>
</td>
</tr>
</table>
<table><tr style="vertical-align: top;">
<td><code>opts</code></td>
<td>
<p>A list of options, which is obtained from mPhen.options(c("regression","pheno.input")).  To get more information about these options, type 
mPhen.options(c("regression","pheno.input"),descr=TRUE)</p>
</td>
</tr></table>
<h3>Value</h3>

<p>Returns a list, with two items.  The first item (Results) is a  Results is a 4 dimensional matrix, with
dimensions [strata, snps, phenotypes, result_type], where result_type includes beta, pvalue and Nobs.  The second item is a vector of minor allele frequencies.
</p>


<h3>Note</h3>

<p>The user should remember that the genotype data file is always a matrix of at least a column, hence if taking a subset of 1 SNP in the non-imputed genotype data matrix, the option drop = FALSE should be used (see the example below)
</p>


<h3>Author(s)</h3>

<p>Lachlan Coin, Federico Calboli, Clive Hoggart, Paul O'Reilly, Yotsawat Pomyen.
</p>
<p>Maintainer, Federico Calboli <a href="mailto:f.calboli@imperial.ac.uk">f.calboli@imperial.ac.uk</a> 
</p>


<h3>References</h3>

<p>O'Reilly et al. 2012. MultiPhen: Joint model of multiple phenotypes can increase discovery in GWAS. http://dx.plos.org/10.1371/journal.pone.0034861</p>


<h3>Examples</h3>

<pre><code class="language-R">data(snps); data(snps.imputed); data(pheno)
opts = mPhen.options(c("regression","pheno.input"))
res = mPhen(snps, pheno, phenotypes = "all",
      covariates = c('testPheno3', 'testPheno4'),opts = opts) 
# performs a MultiPhen analysis, with snp as outcome,
# and phenotypes testPheno1, testPheno2 as predictors, 
#with testPheno3 and testPheno4 as covariates using ordinal regression

res = mPhen(snps, pheno, phenotypes = c('testPheno1', 'testPheno2'), 
      covariates = c('testPheno3', 'testPheno4'), resids = 'testPheno5', opts = opts) 
# the same as above, with the fifth phenotype as residual 

res = mPhen(snps[,2, drop = FALSE], pheno, phenotypes = c('testPheno1', 'testPheno2'), 
      covariates = 'testPheno3',  opts = opts) 
# please note the use use of drop = FALSE if analysing only one SNP


res = mPhen(snps.imputed, pheno, phenotypes = c('testPheno1', 'testPheno2'), 
      covariates = 'testPheno3',  opts = opts) 
# for imputed data
</code></pre>


</div>