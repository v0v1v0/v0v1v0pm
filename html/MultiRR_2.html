<div class="container">

<table style="width: 100%;"><tr>
<td>Anal.MultiRR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fits a multilevel random regression to n simulated data frames. 
</h2>

<h3>Description</h3>

<p>Performs multilevel random regressions to objects created with the function Sim.MultiRR.   
</p>


<h3>Usage</h3>

<pre><code class="language-R">Anal.MultiRR(x)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>Object created with the function sim.MultiRR.  
</p>
</td>
</tr></table>
<h3>Value</h3>

<p>A list of results from the multi-level random regression for n simulated
data sets.
</p>


<h3>Author(s)</h3>

<p>Yimen Araya
</p>


<h3>References</h3>

<p>Araya-Ajoy Y.G., Mathot, K. J., Dingemanse N. J. (2015) An approach to estimate short-term, long-term, and reaction norm repeatability. Methods in Ecology and Evolution.
</p>


<h3>See Also</h3>

<p><code>Sim.MultiRR</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Example 1: Balanced sampling design.
#Define sample sizes.
n.ind &lt;-c(40, 50) ##Numbers of individuals to simulate.
SeriesPerInd &lt;- c(4, 5) ##Number of series per individual to simulate.
ObsPerLevel &lt;- 2 ##Number of observations per level in the environmental gradient.
 
#Number of simulated data sets, use at least 10.
n.sim=3

#Define the environmetal gradient.
EnvGradient &lt;- c(-0.5, 0.5)
 
#Define the population level parameters.
PopInt &lt;- 0 ##Population level intercept.
PopSlope &lt;- -0.5 ##Population level slope.
 
#Define individual level parameters
VCVInd &lt;-matrix(c(0.3, 0.15, 0.15, 0.3),2,2) ##Creates a variance-covariance matrix.
 
#Define series level parameters
VCVSeries &lt;-matrix(c(0.3, 0.15, 0.15, 0.3),2,2) ##Creates a variance-covariance matrix.
 
#Define the residual variance.
ResVar &lt;- 0.4
 
#Simulate the data sets.
sim.data &lt;- Sim.MultiRR(n.ind=n.ind, SeriesPerInd=SeriesPerInd, 
ObsPerLevel=ObsPerLevel, EnvGradient=EnvGradient, PopInt=PopInt, PopSlope=PopSlope, 
VCVInd=VCVInd, VCVSeries=VCVSeries, ResVar=ResVar, n.sim=3)
 
#Analyze the simulated data sets. This may take a while.
ressim &lt;- Anal.MultiRR(sim.data)

#Summarize the results of the multi-level random regressions. 
Summary(ressim) 
 
#Estimate bias.
Bias(ressim)
 
#Estiamte imprecision.
Imprecision(ressim)
 
#Estimate power.
Power(ressim)

#Example 2: Unbalanced sampling design.
#Define sample sizes.
n.ind &lt;-40 ##Numbers of individuals to simulate.
SeriesPerInd &lt;- 4 ##Number of series per individual to simulate.
ObsPerLevel &lt;- 2 ##Number of observations per level in the environmental gradient.

#Define the proportion of individuals that were sampled in all the series.
#All individuals were assayed at least once, 0.9 of individuals twice...

prop.ind&lt;-c(1, 0.9, 0.8, 0.7)

#Define the total number of observations
n.obs=300

#Number of simulated data sets, use at least 10.
n.sim=3

#Define the environmetal gradient.
EnvGradient &lt;- c(-0.5, 0.5)
 
#Define the population level parameters.
PopInt &lt;- 0 ##Population level intercept.
PopSlope &lt;- -0.5 ##Population level slope.

#Define the individual level parameters.
VCVInd &lt;-matrix(c(0.3, 0.15, 0.15, 0.3),2,2) ##Creates a variance-covariance matrix.
 
#Define the series level parameters.
VCVSeries &lt;-matrix(c(0.3, 0.15, 0.15, 0.3),2,2) ##Creates a variance-covariance matrix.
 
#Define the residual variance.
ResVar &lt;- 0.4
 
#Simulate the data.
sim.data &lt;- Sim.MultiRR(n.ind=n.ind, SeriesPerInd=SeriesPerInd, ObsPerLevel=ObsPerLevel,
EnvGradient=EnvGradient, PopInt=PopInt, PopSlope=PopSlope, VCVInd= VCVInd, VCVSeries=VCVSeries,
ResVar=ResVar, n.sim=n.sim, unbalanced=TRUE, prop.ind=c(1, 0.9, 0.8, 0.7), 
complete.observations=FALSE, n.obs=n.obs)
 
#Analyze simulated data sets. This may take a while.
ressim &lt;- Anal.MultiRR(sim.data)
 
#Summarize the results of the multi-level random regressions.
Summary(ressim)
 
#Estimate bias.
Bias(ressim)
 
#Estiamte imprecision.
Imprecision(ressim)
 
#Estimate power.
Power(ressim)  
</code></pre>


</div>