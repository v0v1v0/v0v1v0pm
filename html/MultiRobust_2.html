<div class="container">

<table style="width: 100%;"><tr>
<td>MR.mean</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multiply Robust Estimation of the Marginal Mean</h2>

<h3>Description</h3>

<p><code>MR.mean()</code> is used to estimate the marginal mean of a variable which is subject to missingness. Multiple missingness probability models and outcome regression models can be accommodated.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MR.mean(response, reg.model = NULL, mis.model = NULL, moment = NULL,
  order = 1, data, bootstrap = FALSE, bootstrap.size = 300,
  alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>The response variable of interest whose marginal mean is to be estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reg.model</code></td>
<td>
<p>A list of outcome regression models defined by <code>glm.work</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mis.model</code></td>
<td>
<p>A list of missingness probability models defined by <code>glm.work</code>. The dependent variable is always specified as <code>R</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>moment</code></td>
<td>
<p>A vector of auxiliary variables whose moments are to be calibrated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>A numeric value. The order of moments up to which to be calibrated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame with missing data encoded as <code>NA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootstrap</code></td>
<td>
<p>Logical. If <code>bootstrap = TRUE</code>, the bootstrap will be applied to calculate the standard error and construct a Wald confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootstrap.size</code></td>
<td>
<p>A numeric value. Number of bootstrap resamples generated if <code>bootstrap = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Significance level used to construct the 100(1 - <code>alpha</code>)% Wald confidence interval.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>The estimated value of the marginal mean.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SE</code></td>
<td>
<p>The bootstrap standard error of <code>mu</code> when <code>bootstrap = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI</code></td>
<td>
<p>A Wald-type confidence interval based on <code>mu</code> and <code>SE</code> when <code>bootstrap = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>The calibration weights if any <code>reg.model</code>, <code>mis.model</code> or <code>moment</code> is specified.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Han, P. and Wang, L. (2013). Estimation with missing data: beyond double robustness. <em>Biometrika</em>, <strong>100</strong>(2), 417–430.
</p>
<p>Han, P. (2014). A further study of the multiply robust estimator in missing data analysis. <em>Journal of Statistical Planning and Inference</em>, <strong>148</strong>, 101–110.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Simulated data set
set.seed(123)
n &lt;- 400
gamma0 &lt;- c(1, 2, 3)
alpha0 &lt;- c(-0.8, -0.5, 0.3)
X &lt;- runif(n, min = -2.5, max = 2.5)
p.mis &lt;- 1 / (1 + exp(alpha0[1] + alpha0[2] * X + alpha0[3] * X ^ 2))
R &lt;- rbinom(n, size = 1, prob = 1 - p.mis)
a.x &lt;- gamma0[1] + gamma0[2] * X + gamma0[3] * exp(X)
Y &lt;- rnorm(n, a.x, sd = sqrt(4 * X ^ 2 + 2))
dat &lt;- data.frame(X, Y)
dat[R == 0, 2] &lt;- NA

# Define the outcome regression models and missingness probability models
reg1 &lt;- glm.work(formula = Y ~ X + exp(X), family = gaussian)
reg2 &lt;- glm.work(formula = Y ~ X + I(X ^ 2), family = gaussian)
mis1 &lt;- glm.work(formula = R ~ X + I(X ^ 2), family = binomial(link = logit))
mis2 &lt;- glm.work(formula = R ~ X + exp(X), family = binomial(link = cloglog))
MR.mean(response = Y, reg.model = list(reg1, reg2), 
        mis.model = list(mis1, mis2), data = dat)
MR.mean(response = Y, moment = c(X), order = 2, data = dat)

</code></pre>


</div>