<div class="container">

<table style="width: 100%;"><tr>
<td>MR.quantile</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multiply Robust Estimation of the Marginal Quantile</h2>

<h3>Description</h3>

<p><code>MR.quantile()</code> is used to estimate the marginal quantile of a variable which is subject to missingness. Multiple missingness probability models and imputation models are allowed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MR.quantile(response, tau = 0.5, imp.model = NULL, mis.model = NULL,
  moment = NULL, order = 1, L = 30, data, bootstrap = FALSE,
  bootstrap.size = 300, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>The response variable of interest whose marginal quantile is to be estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>A numeric value in (0,1). The quantile to be estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>imp.model</code></td>
<td>
<p>A list of imputation models defined by <code>glm.work</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mis.model</code></td>
<td>
<p>A list of missingness probability models defined by <code>glm.work</code>. The dependent variable is always specified as <code>R</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>moment</code></td>
<td>
<p>A vector of auxiliary variables whose moments are to be calibrated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>A numeric value. The order of moments up to which to be calibrated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>Number of imputations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame with missing data encoded as <code>NA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootstrap</code></td>
<td>
<p>Logical. If <code>bootstrap = TRUE</code>, the bootstrap will be applied to calculate the standard error and construct a Wald confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootstrap.size</code></td>
<td>
<p>A numeric value. Number of bootstrap resamples generated if <code>bootstrap = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Significance level used to construct the 100(1 - <code>alpha</code>)% Wald confidence interval.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>The estimated value of the marginal quantile.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SE</code></td>
<td>
<p>The bootstrap standard error of <code>q</code> when <code>bootstrap = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI</code></td>
<td>
<p>A Wald-type confidence interval based on <code>q</code> and <code>SE</code> when <code>bootstrap = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>The calibration weights if any <code>imp.model</code>, <code>mis.model</code> or <code>moment</code> is specified.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Han, P., Kong, L., Zhao, J. and Zhou, X. (2019). A general framework for quantile estimation with incomplete data. <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em>. <strong>81</strong>(2), 305â€“333.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Simulated data set
set.seed(123)
n &lt;- 400
gamma0 &lt;- c(1, 2, 3)
alpha0 &lt;- c(-0.8, -0.5, 0.3)
X &lt;- runif(n, min = -2.5, max = 2.5)
p.mis &lt;- 1 / (1 + exp(alpha0[1] + alpha0[2] * X + alpha0[3] * X ^ 2))
R &lt;- rbinom(n, size = 1, prob = 1 - p.mis)
a.x &lt;- gamma0[1] + gamma0[2] * X + gamma0[3] * exp(X)
Y &lt;- rnorm(n, a.x, sd = sqrt(4 * X ^ 2 + 2))
dat &lt;- data.frame(X, Y)
dat[R == 0, 2] &lt;- NA

# Define the outcome regression models and missingness probability models
imp1 &lt;- glm.work(formula = Y ~ X + exp(X), family = gaussian)
imp2 &lt;- glm.work(formula = Y ~ X + I(X ^ 2), family = gaussian)
mis1 &lt;- glm.work(formula = R ~ X + I(X ^ 2), family = binomial(link = logit))
mis2 &lt;- glm.work(formula = R ~ X + exp(X), family = binomial(link = cloglog))
MR.quantile(response = Y, tau = 0.25, imp.model = list(imp1, imp2),
            mis.model = list(mis1, mis2), L = 10, data = dat)
MR.quantile(response = Y, tau = 0.25, moment = c(X), order = 2, data = dat)
</code></pre>


</div>