<div class="container">

<table style="width: 100%;"><tr>
<td>MR.quantreg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multiply Robust Estimation for Quantile Regression</h2>

<h3>Description</h3>

<p><code>MR.quantreg()</code> is used for quantile regression with missing responses and/or missing covariates. Multiple missingness probability models and imputation models are allowed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MR.quantreg(formula, tau = 0.5, imp.model = NULL, mis.model = NULL,
  moment = NULL, order = 1, L = 30, data, bootstrap = FALSE,
  bootstrap.size = 300, alpha = 0.05, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>The <code>formula</code> of the linear quantile regression model of interest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>A numeric value in (0,1). The quantile to be estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>imp.model</code></td>
<td>
<p>A list of possibly multiple lists of the form <code>list(list.1, list.2, ..., list.K)</code>, where <code>K</code> is the total number of different imputation models. For the <em>k</em>-th imputation model, <code>list.k</code> is a list of possibly multiple models, each of which is defined by <code>glm.work</code> and imputes one single missing variable marginally. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mis.model</code></td>
<td>
<p>A list of missingness probability models defined by <code>glm.work</code>. The dependent variable is always specified as <code>R</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>moment</code></td>
<td>
<p>A vector of auxiliary variables whose moments are to be calibrated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>A numeric value. The order of moments up to which to be calibrated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>Number of imputations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame with missing data encoded as <code>NA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootstrap</code></td>
<td>
<p>Logical. If <code>bootstrap = TRUE</code>, the bootstrap will be applied to calculate the standard error and construct a Wald confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootstrap.size</code></td>
<td>
<p>A numeric value. Number of bootstrap resamples generated if <code>bootstrap = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Significance level used to construct the 100(1 - <code>alpha</code>)% Wald confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Addition arguments for the function <code>rq</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>MR.quantreg()</code> currently deals with data with one missingness pattern. When multiple variables are subject to missingness, their values are missing simultaneously. The method in Han et al. (2019) specifies an imputation model by modeling the joint distribution of the missing variables conditional on the fully observed variables. In contrast, the function <code>MR.quantreg()</code> specifies an imputation model by separately modeling the marginal distribution of each missing variable conditional on the fully observed variables. These marginal distribution models for different missing variables constitute one joint imputation model. Different imputation models do not need to model the marginal distribution of each missing variable differently.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>The estimated quantile regression coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SE</code></td>
<td>
<p>The bootstrap standard error of <code>coefficients</code> when <code>bootstrap = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI</code></td>
<td>
<p>A Wald-type confidence interval based on <code>coefficients</code> and <code>SE</code> when <code>bootstrap = TRUE</code>.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Han, P., Kong, L., Zhao, J. and Zhou, X. (2019). A general framework for quantile estimation with incomplete data. <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em>. <strong>81</strong>(2), 305â€“333.
</p>


<h3>See Also</h3>

<p><code>rq</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Simulated data set
set.seed(123)
n &lt;- 400
gamma0 &lt;- c(1, 2, 3)
alpha0 &lt;- c(-0.8, -0.5, 0.3)
S &lt;- runif(n, min = -2.5, max = 2.5) # auxiliary variables
X1 &lt;- rbinom(n, size = 1, prob = 0.5) # covariate X1
X2 &lt;- rexp(n) # covariate X2
p.obs &lt;- 1 / (1 + exp(alpha0[1] + alpha0[2] * S + alpha0[3] * S ^ 2)) # non-missingness probability
R &lt;- rbinom(n, size = 1, prob = p.obs)
a.x &lt;- gamma0[1] + gamma0[2] * X1 + gamma0[3] * X2
Y &lt;- rnorm(n, a.x)
dat &lt;- data.frame(S, X1, X2, Y)
dat[R == 0, c(2, 4)] &lt;- NA # X1 and Y may be missing

# marginal imputation models for X1
impX1.1 &lt;- glm.work(formula = X1 ~ S, family = binomial(link = logit))
impX1.2 &lt;- glm.work(formula = X1 ~ S + X2, family = binomial(link = cloglog))
# marginal imputation models for Y
impY.1 &lt;- glm.work(formula = Y ~ S, family = gaussian)
impY.2 &lt;- glm.work(formula = Y ~ S + X2, family = gaussian)
# missingness probability models
mis1 &lt;- glm.work(formula = R ~ S + I(S ^ 2), family = binomial(link = logit))
mis2 &lt;- glm.work(formula = R ~ I(S ^ 2), family = binomial(link = cloglog))
# this example considers the following K = 3 imputation models for imputing the missing (X1, Y)
imp1 &lt;- list(impX1.1, impY.1)
imp2 &lt;- list(impX1.1, impY.2)
imp3 &lt;- list(impX1.2, impY.1)

results &lt;- MR.quantreg(formula = Y ~ X1 + X2, tau = 0.75, imp.model = list(imp1, imp2, imp3),
                       mis.model = list(mis1, mis2), L = 10, data = dat)
results$coefficients
MR.quantreg(formula = Y ~ X1 + X2, tau = 0.75, 
            moment = c(S, X2), order = 2, data = dat)$coefficients
</code></pre>


</div>