<div class="container">

<table style="width: 100%;"><tr>
<td>CommutatorMatr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Commutator Matrix</h2>

<h3>Description</h3>

<p>This function generates various types of commutator matrices.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CommutatorMatr(Type, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Type</code></td>
<td>
<p>A string specifying the type of commutator matrix. Choices are "Kmn", "Kperm", "Mixing", or "Moment".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments specific to the type of commutator matrix (see Details).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>CommutatorMatr</code> supports the following types of commutator matrices:
</p>

<dl>
<dt>Kmn</dt>
<dd>
<p><strong>Description:</strong> Transforms <code>vec(A)</code> to <code>vec(A^T)</code>, where <code>A^T</code> is the transpose of matrix <code>A</code>. An option for sparse matrix is provided. By default, a non-sparse matrix is produced. Using sparse matrices increases computation times but requires far less memory.
<strong>Arguments:</strong>
</p>

<dl>
<dt>
<code>m</code> (integer)</dt>
<dd>
<p>Number of rows of the first matrix.</p>
</dd>
<dt>
<code>n</code> (integer)</dt>
<dd>
<p>Number of columns of the first matrix.</p>
</dd>
<dt>
<code>useSparse</code> (logical, optional)</dt>
<dd>
<p>If TRUE, returns a sparse matrix. Default is FALSE.</p>
</dd>
</dl>
</dd>
<dt>Kperm</dt>
<dd>
<p><strong>Description:</strong> Generates a commutation matrix for a specified permutation of matrix dimensions. An option for sparse matrix is provided. By default, a non-sparse matrix is produced. Using sparse matrices increases computation times but requires far less memory.
<strong>Arguments:</strong>
</p>

<dl>
<dt>
<code>perm</code> (integer vector)</dt>
<dd>
<p>The permutation vector.</p>
</dd>
<dt>
<code>dims</code> (integer vector)</dt>
<dd>
<p>The dimensions of the matrices involved.</p>
</dd>
<dt>
<code>useSparse</code> (logical, optional)</dt>
<dd>
<p>If TRUE, returns a sparse matrix. Default is FALSE.</p>
</dd>
</dl>
</dd>
<dt>Mixing</dt>
<dd>
<p><strong>Description:</strong> Generates the Mixing commutation matrix used in linear algebra transformations involving tensor products. An option for sparse matrix is provided. By default, a non-sparse matrix is produced. Using sparse matrices increases computation times but requires far less memory.
<strong>Arguments:</strong>
</p>

<dl>
<dt>
<code>d1</code> (integer vector)</dt>
<dd>
<p>Dimensions of the first set.</p>
</dd>
<dt>
<code>d2</code> (integer vector)</dt>
<dd>
<p>Dimensions of the second set.</p>
</dd>
<dt>
<code>useSparse</code> (logical, optional)</dt>
<dd>
<p>If TRUE, returns a sparse matrix. Default is FALSE.</p>
</dd>
</dl>
</dd>
<dt>Moment</dt>
<dd>
<p><strong>Description:</strong> Generates the Moment commutation matrix based on partitioning of moments. An option for sparse matrix is provided. By default, a non-sparse matrix is produced. Using sparse matrices increases computation times but requires far less memory.
<strong>Arguments:</strong>
</p>

<dl>
<dt>
<code>el_rm</code> (integer vector)</dt>
<dd>
<p>Elements of the partition.</p>
</dd>
<dt>
<code>d</code> (integer)</dt>
<dd>
<p>Dimension of the partition.</p>
</dd>
<dt>
<code>useSparse</code> (logical, optional)</dt>
<dd>
<p>If TRUE, returns a sparse matrix. Default is FALSE.</p>
</dd>
</dl>
</dd>
</dl>
<h3>Value</h3>

<p>Depending on the  type:
</p>

<dl>
<dt>Kmn</dt>
<dd>
<p>A commutation matrix of dimension <code class="reqn">mn \times mn</code>. If <code>useSparse=TRUE</code>, an object of class "dgCMatrix" is produced.</p>
</dd>
<dt>Kperm</dt>
<dd>
<p>A square permutation matrix of size <code>prod(dims)</code>. If <code>useSparse=TRUE</code>, an object of class "dgCMatrix" is produced.</p>
</dd>
<dt>Mixing</dt>
<dd>
<p>A square matrix of dimension <code>prod(d1) * prod(d2)</code>. If <code>useSparse=TRUE</code>, an object of class "dgCMatrix" is produced.</p>
</dd>
<dt>Moment</dt>
<dd>
<p>A commutator matrix for moment formulae.</p>
</dd>
</dl>
<h3>See Also</h3>

<p>Other Commutators: 
<code>CommutatorIndx()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Example for Kmn
CommutatorMatr("Kmn", m = 3, n = 2)

# Example for Kperm
dims &lt;- c(2, 3, 2)
perm &lt;- c(1, 3, 2)
CommutatorMatr("Kperm", perm = perm, dims = dims)

# Example for Mixing
d1 &lt;- c(2, 3, 2)
d2 &lt;- c(3, 2, 2)
CommutatorMatr("Mixing", d1 = d1, d2 = d2)

# Example for Moment
n &lt;- 4
r &lt;- 2
m &lt;- 1
d &lt;- 2
PTA &lt;- PartitionTypeAll(n)
el_r &lt;- PTA$eL_r[[r]][m,]
CommutatorMatr("Moment", el_r = el_r, d = d)
</code></pre>


</div>