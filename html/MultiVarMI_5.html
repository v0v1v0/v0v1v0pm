<div class="container">

<table style="width: 100%;"><tr>
<td>MVN.corr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculation of Intermediate Correlation Matrix</h2>

<h3>Description</h3>

<p>This function calculates an intermediate correlation matrix for Poisson, ordinal, and continuous random variables, with specified target correlations and marginal properties.</p>


<h3>Usage</h3>

<pre><code class="language-R">MVN.corr(indat, var.types, ord.mps=NULL, nct.sum=NULL, count.rate=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>indat</code></td>
<td>
<p>A data frame containing multivariate data. Continuous variables should be standardized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.types</code></td>
<td>
<p>The variable type corresponding to each column in dat, taking values of "NCT" for continuous data, "O" for ordinal or binary data, or "C" for count data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ord.mps</code></td>
<td>
<p>A list containing marginal probabilities for binary and ordinal variables as packaged from output in <code>ordmps</code>. Default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nct.sum</code></td>
<td>
<p>A matrix containing summary statistics for continuous variables as packaged from output in <code>nctsum</code>. Default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>count.rate</code></td>
<td>
<p>A vector containing rates for count variables as packaged from output in <code>countrate</code>. Default is NULL.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The intermediate correlation matrix.</p>


<h3>References</h3>

<p>Demirtas, H. and Hedeker, D. (2011). A practical way for computing approximate lower and upper correlation bounds. <em>The American Statistician</em>, <b>65(2)</b>, 104-109.
</p>
<p>Demirtas, H., Hedeker, D., and Mermelstein, R. J. (2012). Simulation of massive public health data by power polynomials. <em>Statistics in Medicine</em>, <b>31(27)</b>, 3337-3346.
</p>
<p>Demirtas, H. (2016). A note on the relationship between the phi coefficient and the tetrachoric correlation under nonnormal underlying distributions. <em>The American Statistician</em>, <b>70(2)</b>, 143-148.
</p>
<p>Demirtas, H. and Hedeker, D. (2016). Computing the point-biserial correlation under any underlying continuous distribution. <em>Communications in Statistics-Simulation and Computation</em>, <b>45(8)</b>, 2744-2751.
</p>
<p>Demirtas, H., Ahmadian, R., Atis, S., Can, F.E., and Ercan, I. (2016). A nonnormal look at polychoric correlations: modeling the change in correlations before and after discretization. <em>Computational Statistics</em>, <b>31(4)</b>, 1385-1401.
</p>
<p>Ferrari, P.A. and Barbiero, A. (2012). Simulating ordinal data. <em>Multivariate Behavioral Research</em>, <b>47(4)</b>, 566-589.
</p>
<p>Fleishman A.I. (1978). A method for simulating non-normal distributions. <em>Psychometrika</em>, <b>43(4)</b>, 521-532.
</p>
<p>Vale, C.D. and Maurelli, V.A. (1983). Simulating multivariate nonnormal distributions. <em>Psychometrika</em>, <b>48(3)</b>, 465-471.
</p>


<h3>See Also</h3>

<p><code>MI</code>, <code>MVN.dat</code>, <code>ordmps</code>, <code>nctsum</code>, <code>countrate</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
library(PoisBinOrdNonNor)
n&lt;-1e4
lambdas&lt;-list(1, 3)
mps&lt;-list(c(.2, .8), c(.6, 0, .3, .1))
moms&lt;-list(c(-1, 1, 0, 1), c(0, 3, 0, 2))
  
#generate Poisson, ordinal, and continuous data
cmat.star &lt;- find.cor.mat.star(cor.mat = .8 * diag(6) + .2, 
                               no.pois = length(lambdas), 
                               no.ord = length(mps),
                               no.nonn = length(moms), 
                               pois.list = lambdas, 
                               ord.list = mps, 
                               nonn.list = moms)

mydata &lt;- genPBONN(n, 
                   no.pois = length(lambdas), 
                   no.ord = length(mps), 
                   no.nonn = length(moms),
                   cmat.star = cmat.star, 
                   pois.list = lambdas,
                   ord.list = mps, 
                   nonn.list = moms)

#set a sample of each variable to missing
mydata&lt;-apply(mydata, 2, function(x) {
  x[sample(1:n, size=n/10)]&lt;-NA
  return(x)
})

mydata&lt;-data.frame(mydata)

#get information for use in function
ord.info&lt;-ordmps(ord.dat=mydata[,c('X3', 'X4')])
nct.info&lt;-nctsum(nct.dat=mydata[,c('X5', 'X6')])
count.info&lt;-countrate(count.dat=mydata[,c('X1', 'X2')])

#extract marginal probabilites, continuous properties, and count rates
mps&lt;-sapply(ord.info, "[[", 2)
nctsum&lt;-sapply(nct.info, "[[", 2)
rates&lt;-sapply(count.info, "[[", 2)

#replace continuous with standardized forms
mydata[,c('X5', 'X6')]&lt;-sapply(nct.info, "[[", 1)[,c('X5', 'X6')] 

var.types&lt;-c('C', 'C', 'O', 'O', 'NCT', 'NCT')
mvn.cmat&lt;-MVN.corr(indat=mydata,
                   var.types=var.types,
                   ord.mps=mps,
                   nct.sum=nctsum,
                   count.rate=rates)

</code></pre>


</div>