<div class="container">

<table style="width: 100%;"><tr>
<td>whitening</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>This function provides an estimation of the inverse of the square root of the covariance matrix of each row of the residuals matrix.</h2>

<h3>Description</h3>

<p>This function provides an estimation of the inverse of the square root of the covariance matrix of each row of the residuals matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">whitening(residuals, typeDep, pAR = 1, qMA = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>the residuals matrix obtained by fitting a linear model to each column of the response matrix as if they were independent</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>typeDep</code></td>
<td>
<p>character in c("AR1", "ARMA", "nonparam") defining which type of dependence to use</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pAR</code></td>
<td>
<p>numerical, only use if typeDep = "ARMA", the parameter p for the ARMA(p, q) process</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qMA</code></td>
<td>
<p>numerical, only use if typeDep = "ARMA", the parameter q for the ARMA(p, q) process</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>It returns the estimation of the inverse of the square root of the covariance matrix of each row of the residuals matrix.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(copals_camera)
Y &lt;- scale(Y[, 1:100])
X &lt;- model.matrix(~ group + 0)
residuals &lt;- lm(as.matrix(Y) ~ X - 1)$residuals
whitening(residuals, "AR1")
</code></pre>


</div>