<div class="container">

<table style="width: 100%;"><tr>
<td>rrr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Penalized reduced rank regression for tensors
</h2>

<h3>Description</h3>

<p>Fits a linear model to estimate one multi-way array from another, under the restriction that the coefficient array has given PARAFAC rank.  By default, estimates are chosen to minimize a least-squares objective;  an optional penalty term allows for $L_2$ regularization of the coefficient array.  
</p>


<h3>Usage</h3>

<pre><code class="language-R">rrr(X,Y,R=1,lambda=0,annealIter=0,convThresh=10^(-5), seed=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>A predictor array of dimension N x P_1 x ... x P_L.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>

<p>An outcome array of dimension N x Q_1 x ... X Q_M.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>

<p>Assumed rank of the P_1 x ... x P_L x Q_1 x ... x Q_M coefficient array. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>

<p>Ridge ($L_2$) penalty parameter for the coefficient array.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>annealIter</code></td>
<td>

<p>Number of tempering iterations to improve initialization 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convThresh</code></td>
<td>

<p>Converge threshold for the absolute difference in the objective function between two iterations
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>

<p>Random seed for generation of initial values.
</p>
</td>
</tr>
</table>
<h3>Value</h3>


<table>
<tr style="vertical-align: top;">
<td><code>U</code></td>
<td>

<p>List of length L. U[[l]]: P_l x R gives the coefficient basis for the l'th mode of X.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>

<p>List of length M. V[[m]]: Q_m x R gives the coefficient basis for the m'th mode of Y.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>

<p>Coefficient array of dimension P_1 x ... x P_L x Q_1 x ... x Q_M.  Given by the CP factorization defined by U and V.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sse</code></td>
<td>

<p>Vector giving the sum of squared residuals at each iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sseR</code></td>
<td>

<p>Vector giving the value of the objective (sse+penalty) at each iteration.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Eric F. Lock 
</p>


<h3>References</h3>

<p>Lock, E. F.  (2018). Tensor-on-tensor regression. Journal of Computational and Graphical Statistics, 27 (3): 638-647, 2018.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(SimData) ##loads simulated X: 100 x 15 x 20 and Y: 100 x 5 x 10 
Results &lt;- rrr(X,Y,R=2)  ##Fit rank 2 model with no regularization
Y_pred &lt;- ctprod(X,Results$B,2)  ##Array of fitted values
</code></pre>


</div>