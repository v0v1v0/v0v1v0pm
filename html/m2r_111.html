<div class="container">

<table style="width: 100%;"><tr>
<td>snf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Smith normal form</h2>

<h3>Description</h3>

<p>For an integer matrix M, this computes the matrices D, P, and Q such that
<em>D = PMQ</em>, which can be seen as an analogue of the singular value
decomposition. All are integer matrices, and P and Q are unimodular (have
determinants +- 1).
</p>


<h3>Usage</h3>

<pre><code class="language-R">snf(mat, code = FALSE)

snf.(mat, code = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mat</code></td>
<td>
<p>a matrix (integer entries)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>code</code></td>
<td>
<p>return only the M2 code? (default: <code>FALSE</code>)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list of <code>m2_matrix</code> objects with names <code>D</code>, <code>P</code>, and
<code>Q</code>
</p>


<h3>See Also</h3>

<p><code>m2_matrix()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run:  requires Macaulay2

##### basic usage
########################################

M &lt;- matrix(c(
   2,  4,   4,
  -6,  6,  12,
  10, -4, -16
), nrow = 3, byrow = TRUE)

snf(M)

(mats &lt;- snf(M))
P &lt;- mats$P; D &lt;- mats$D; Q &lt;- mats$Q

P %*% M %*% Q                # = D
solve(P) %*% D %*% solve(Q)  # = M

det(P)
det(Q)


M &lt;- matrix(c(
     1,    2,    3,
     1,   34,   45,
  2213, 1123, 6543,
     0,    0,    0
), nrow = 4, byrow = TRUE)
(mats &lt;- snf(M))
P &lt;- mats$P; D &lt;- mats$D; Q &lt;- mats$Q
P %*% M %*% Q                # = D



##### understanding lattices
########################################




# cols of m generate the lattice L
M &lt;- matrix(c(2,-1,1,3), nrow = 2)
row.names(M) &lt;- c("x", "y")
M

# plot lattice
df &lt;- expand.grid(x = -20:20, y = -20:20)
pts &lt;- t(apply(df, 1, function(v) M %*% v))
w &lt;- c(-15, 15)
plot(pts, xlim = w, ylim = w)

# decompose m
(mats &lt;- snf(M))
P &lt;- mats$P; D &lt;- mats$D; Q &lt;- mats$Q

# PMQ = D, the columns of MQ = P^(-1) D  are a simpler basis of
# the lattice generated by (the cols of) M
(basis &lt;- solve(P) %*% D)

# plot lattice generated by new basis
pts2 &lt;- t(apply(df, 1, function(v) basis %*% v))
points(pts2, pch = "*", col = "red")



##### other options
########################################

snf.(M)
snf(M, code = TRUE)





## End(Not run)

</code></pre>


</div>