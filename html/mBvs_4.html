<div class="container">

<table style="width: 100%;"><tr>
<td>mmzipBvs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
The function to perform variable selection for marginalized multivariate zero-inflated Poisson models
</h2>

<h3>Description</h3>

<p>The function can be used to perform variable selection for marginalized multivariate zero-inflated Poisson models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mmzipBvs(Y, lin.pred, data, offset = NULL, zero_cutoff = 0.05, hyperParams,
 startValues, mcmcParams)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>

<p>a data.frame containing <code class="reqn">q</code> count outcomes from <code>n</code> subjects. It is of dimension <code class="reqn">n\times q</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lin.pred</code></td>
<td>

<p>a list containing three formula objects: the first formula specifies the <code class="reqn">p_z</code> covariates for which variable selection is to be performed in the binary component of the model; the second formula specifies the <code class="reqn">p_x</code> covariates for which variable selection is to be performed in the count part of the model; the third formula specifies the <code class="reqn">p_0</code> confounders to be adjusted for (but on which variable selection is not to be performed) in the regression analysis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>a data.frame containing the variables named in the formulas in <code>lin.pred</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>

<p>an optional numeric vector with an a priori known component to be included as the
linear predictor in the count part of model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zero_cutoff</code></td>
<td>

<p>Response variable with proportions of zeros less than <code>zero.cutoff</code> will be removed from the binary model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hyperParams</code></td>
<td>

<p>(update this)
a list containing lists or vectors for hyperparameter values in hierarchical models. Components include,
<code>rho0</code> (degrees of freedom for inverse-Wishart prior for <code class="reqn">\Sigma_V</code>),
<code>Psi0</code> (a scale matrix for inverse-Wishart prior for <code class="reqn">\Sigma_V</code>),
<code>mu_alpha0</code> (hyperparameter <code class="reqn">\mu_{\alpha_0}</code> in the prior of <code class="reqn">\alpha_0</code>),
<code>mu_alpha</code> (a numeric vector of length <code class="reqn">q</code> for hyperparameter <code class="reqn">\mu_{\alpha}</code> in the prior of <code class="reqn">\alpha</code>),
<code>mu_beta0</code> (hyperparameter <code class="reqn">\mu_{\beta_0}</code> in the prior of <code class="reqn">\beta_0</code>),
<code>mu_beta</code> (a numeric vector of length <code class="reqn">q</code> for hyperparameter <code class="reqn">\mu_{\beta}</code> in the prior of <code class="reqn">\beta</code>),
<code>a_alpha0</code> (hyperparameter <code class="reqn">a_{\alpha_0}</code> in the prior of <code class="reqn">\sigma^2_{\alpha_0}</code>),
<code>b_alpha0</code> (hyperparameter <code class="reqn">b_{\alpha_0}</code> in the prior of <code class="reqn">\sigma^2_{\alpha_0}</code>),
<code>a_alpha</code> (hyperparameter <code class="reqn">a_{\alpha}</code> in the prior of <code class="reqn">\sigma^2_{\alpha}</code>),
<code>b_alpha</code> (hyperparameter <code class="reqn">b_{\alpha}</code> in the prior of <code class="reqn">\sigma^2_{\alpha}</code>),
<code>a_beta0</code> (hyperparameter <code class="reqn">a_{\beta_0}</code> in the prior of <code class="reqn">\sigma^2_{\beta_0}</code>),
<code>b_beta0</code> (hyperparameter <code class="reqn">b_{\beta_0}</code> in the prior of <code class="reqn">\sigma^2_{\beta_0}</code>),
<code>a_beta</code> (hyperparameter <code class="reqn">a_{\beta}</code> in the prior of <code class="reqn">\sigma^2_{\beta}</code>),
<code>b_beta</code> (hyperparameter <code class="reqn">b_{\beta}</code> in the prior of <code class="reqn">\sigma^2_{\beta}</code>),
<code>v_beta</code> (a numeric vector of length <code class="reqn">q</code> for the standard deviation hyperparameter <code class="reqn">v_{\beta}</code> of the regression parameter <code class="reqn">\beta</code> prior),
<code>omega_beta</code> (a numeric vector of length <code class="reqn">p_x-p_0</code> for the hyperparameter <code class="reqn">\omega_{\beta}</code> in the prior of the variable selection indicator),
<code>v_alpha</code> (a numeric vector of length <code class="reqn">q</code> for the standard deviation hyperparameter <code class="reqn">v_{\alpha}</code> of the regression parameter <code class="reqn">\alpha</code> prior),
<code>omega_alpha</code> (a numeric vector of length <code class="reqn">p_z-p_0</code> for the hyperparameter <code class="reqn">\omega_{\alpha}</code> in the prior of the variable selection indicator),
See Examples below.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startValues</code></td>
<td>

<p>a numeric vector containing starting values for model parameters. See Examples below.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcmcParams</code></td>
<td>

<p>(update this)
a list containing variables required for MCMC sampling. Components include,
<code>run</code> (a list containing numeric values for setting the overall run: 
<code>numReps</code>, total number of scans; <code>thin</code>, extent of thinning; <code>burninPerc</code>, the proportion of burn-in).
<code>tuning</code> (a list containing numeric values relevant to tuning parameters for specific updates in Metropolis-Hastings algorithm: 
<code>beta0.prop.var</code>, variance of the proposal density for <code class="reqn">\beta_0</code>;<code>beta.prop.var</code>, variance of the proposal density for <code class="reqn">B</code>;<code>alpha.prop.var</code>, variance of the proposal density for <code class="reqn">A</code>;<code>V.prop.var</code>, variance of the proposal density for <code class="reqn">V</code>.)
See Examples below.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>mmzipBvs</code> returns an object of class <code>mmzipBvs</code>.
</p>


<h3>Author(s)</h3>

<p>Kyu Ha Lee, Brent A. Coull, Jacqueline R. Starr <br>
Maintainer: Kyu Ha Lee &lt;klee15239@gmail.com&gt;
</p>


<h3>References</h3>

<p>update this
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 

# loading a data set
data(simData_mzip)
Y &lt;- simData_mzip$Y
data &lt;- simData_mzip$X

n = dim(Y)[1]
q = dim(Y)[2]

form.bin     &lt;- as.formula(~cov.1)
form.count    &lt;- as.formula(~cov.1)
form.adj    &lt;- as.formula(~1)
form &lt;- list(form.bin, form.count, form.adj)

p_adj = dim(model.frame(form[[3]], data=data))[2]
p0 &lt;- dim(model.frame(form[[1]], data=data))[2] + p_adj
p1 &lt;- dim(model.frame(form[[2]], data=data))[2] + p_adj

#####################
## Hyperparameters ##

Sigma_me &lt;- 0.5
Sigma_var &lt;- 1
rho0 &lt;- 2*Sigma_me^2/Sigma_var+q+3
psi0 &lt;- Sigma_me*(rho0-q-1)

hyperParams_mmzip &lt;- list(v_beta=rep(3, q), omega_beta=rep(0.5, p1-p_adj), 
a_beta=rep(0.5, p1), b_beta=rep(0.5, p1), mu_beta0=rep(0, q), a_beta0=0.5, b_beta0=0.5, 
v_alpha=rep(3, q), omega_alpha=rep(0.5, p0-p_adj), 
a_alpha=rep(0.5, p0), b_alpha=rep(0.5, p0), mu_alpha0=rep(0, q), a_alpha0=0.5, b_alpha0=0.5, 
rho0=rho0, Psi0=diag(psi0, q), mu_m=rep(0, q), v_m=0.5)


###################
## MCMC SETTINGS ##

run &lt;- list(numReps=100, thin=1, burninPerc=0.5)
storage &lt;- list(storeV=FALSE, storeW=FALSE)
vs &lt;- list(count=TRUE, binary=TRUE)
tuning &lt;- list(L_group=100, L_m=20, eps_group=0.00001, eps_m=0.00001, 
Mvar_group=1, Mvar_m=1, beta_prop_var=0.0001, alpha_prop_var=0.0001)

mcmc_mmzip &lt;- list(run=run, storage=storage, vs=vs, tuning=tuning)


#####################
## Starting Values

startValues_mmzip &lt;- initiate_startValues(form, Y, data, "MMZIP")

#####################
## Other settings

offset &lt;- data$total
zero_cutoff=0.05

#######################
## Fitting the MMZIP ##
#######################

fit.mmzip &lt;- mmzipBvs(Y, form, data, offset, zero_cutoff, hyperParams_mmzip, 
startValues_mmzip, mcmc_mmzip)

print(fit.mmzip)
summ.fit.mmzip &lt;- summary(fit.mmzip); names(fit.mmzip)
summ.fit.mmzip


## End(Not run)


</code></pre>


</div>