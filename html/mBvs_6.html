<div class="container">

<table style="width: 100%;"><tr>
<td>mzipBvs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
The function to perform variable selection for conditional multivariate zero-inflated Poisson models
</h2>

<h3>Description</h3>

<p>The function can be used to perform variable selection for conditional multivariate zero-inflated Poisson models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mzipBvs(Y, lin.pred, data, model = "generalized", offset = NULL, hyperParams, startValues,
 mcmcParams)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>

<p>a data.frame containing <code class="reqn">q</code> count outcomes from <code>n</code> subjects. It is of dimension <code class="reqn">n\times q</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lin.pred</code></td>
<td>

<p>a list containing three formula objects: the first formula specifies the <code class="reqn">p_z</code> covariates for which variable selection is to be performed in the binary component of the model; the second formula specifies the <code class="reqn">p_x</code> covariates for which variable selection is to be performed in the count part of the model; the third formula specifies the <code class="reqn">p_0</code> confounders to be adjusted for (but on which variable selection is not to be performed) in the regression analysis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>a data.frame containing the variables named in the formulas in <code>lin.pred</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>a character that specifies the type of model: A generalized multivariate Bayesian variable selection method of Lee et al.(2018) can be implemented by setting <code>model="generalized"</code>. A simpler model that assumes one common variable selection indicator (<code class="reqn">\gamma_{j,k}=\delta_{j,k}</code>) and the same covariance pattern (<code class="reqn">R=R_V</code>) for two model parts can be used by setting <code>model="restricted1"</code>. iii) Another simpler model that assumes the same covariance pattern (<code class="reqn">R=R_V</code>) but separate variable selection indicators for the binary and count parts of the model can be implemented by setting <code>model="restricted2"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>

<p>an optional numeric vector with an a priori known component to be included as the
linear predictor in the count part of model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hyperParams</code></td>
<td>

<p>a list containing lists or vectors for hyperparameter values in hierarchical models. Components include,
<code>rho0</code> (degrees of freedom for inverse-Wishart prior for <code class="reqn">\Sigma_V</code>),
<code>Psi0</code> (a scale matrix for inverse-Wishart prior for <code class="reqn">\Sigma_V</code>),
<code>mu_alpha0</code> (hyperparameter <code class="reqn">\mu_{\alpha_0}</code> in the prior of <code class="reqn">\alpha_0</code>),
<code>mu_alpha</code> (a numeric vector of length <code class="reqn">q</code> for hyperparameter <code class="reqn">\mu_{\alpha}</code> in the prior of <code class="reqn">\alpha</code>),
<code>mu_beta0</code> (hyperparameter <code class="reqn">\mu_{\beta_0}</code> in the prior of <code class="reqn">\beta_0</code>),
<code>mu_beta</code> (a numeric vector of length <code class="reqn">q</code> for hyperparameter <code class="reqn">\mu_{\beta}</code> in the prior of <code class="reqn">\beta</code>),
<code>a_alpha0</code> (hyperparameter <code class="reqn">a_{\alpha_0}</code> in the prior of <code class="reqn">\sigma^2_{\alpha_0}</code>),
<code>b_alpha0</code> (hyperparameter <code class="reqn">b_{\alpha_0}</code> in the prior of <code class="reqn">\sigma^2_{\alpha_0}</code>),
<code>a_alpha</code> (hyperparameter <code class="reqn">a_{\alpha}</code> in the prior of <code class="reqn">\sigma^2_{\alpha}</code>),
<code>b_alpha</code> (hyperparameter <code class="reqn">b_{\alpha}</code> in the prior of <code class="reqn">\sigma^2_{\alpha}</code>),
<code>a_beta0</code> (hyperparameter <code class="reqn">a_{\beta_0}</code> in the prior of <code class="reqn">\sigma^2_{\beta_0}</code>),
<code>b_beta0</code> (hyperparameter <code class="reqn">b_{\beta_0}</code> in the prior of <code class="reqn">\sigma^2_{\beta_0}</code>),
<code>a_beta</code> (hyperparameter <code class="reqn">a_{\beta}</code> in the prior of <code class="reqn">\sigma^2_{\beta}</code>),
<code>b_beta</code> (hyperparameter <code class="reqn">b_{\beta}</code> in the prior of <code class="reqn">\sigma^2_{\beta}</code>),
<code>v_beta</code> (a numeric vector of length <code class="reqn">q</code> for the standard deviation hyperparameter <code class="reqn">v_{\beta}</code> of the regression parameter <code class="reqn">\beta</code> prior),
<code>omega_beta</code> (a numeric vector of length <code class="reqn">p_x-p_0</code> for the hyperparameter <code class="reqn">\omega_{\beta}</code> in the prior of the variable selection indicator),
<code>v_alpha</code> (a numeric vector of length <code class="reqn">q</code> for the standard deviation hyperparameter <code class="reqn">v_{\alpha}</code> of the regression parameter <code class="reqn">\alpha</code> prior),
<code>omega_alpha</code> (a numeric vector of length <code class="reqn">p_z-p_0</code> for the hyperparameter <code class="reqn">\omega_{\alpha}</code> in the prior of the variable selection indicator),
See Examples below.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startValues</code></td>
<td>

<p>a numeric vector containing starting values for model parameters. See Examples below.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcmcParams</code></td>
<td>

<p>a list containing variables required for MCMC sampling. Components include,
<code>run</code> (a list containing numeric values for setting the overall run: 
<code>numReps</code>, total number of scans; <code>thin</code>, extent of thinning; <code>burninPerc</code>, the proportion of burn-in).
<code>tuning</code> (a list containing numeric values relevant to tuning parameters for specific updates in Metropolis-Hastings algorithm: 
<code>beta0.prop.var</code>, variance of the proposal density for <code class="reqn">\beta_0</code>;<code>beta.prop.var</code>, variance of the proposal density for <code class="reqn">B</code>;<code>alpha.prop.var</code>, variance of the proposal density for <code class="reqn">A</code>;<code>V.prop.var</code>, variance of the proposal density for <code class="reqn">V</code>.)
See Examples below.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>mzipBvs</code> returns an object of class <code>mzipBvs</code>. <br></p>


<h3>Author(s)</h3>

<p>Kyu Ha Lee, Brent A. Coull, Jacqueline R. Starr <br>
Maintainer: Kyu Ha Lee &lt;klee15239@gmail.com&gt;
</p>


<h3>References</h3>

<p>Lee, K. H., Coull, B. A., Moscicki, A.-B., Paster, B. J., Starr, J. R. (2020),
Bayesian variable selection for multivariate zero-inflated models: application to microbiome count data, <em>Biostatistics</em>, Volume 21, Issue 3, Pages 499-517. <br></p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
# loading a data set
data(simData_mzip)
Y &lt;- simData_mzip$Y
data &lt;- simData_mzip$X

n = dim(Y)[1]
q = dim(Y)[2]

form.bin     &lt;- as.formula(~cov.1)
form.count    &lt;- as.formula(~cov.1)
form.adj    &lt;- as.formula(~1)
lin.pred &lt;- list(form.bin, form.count, form.adj)

Xmat0 &lt;- model.frame(lin.pred[[1]], data=data)
Xmat1 &lt;- model.frame(lin.pred[[2]], data=data)
Xmat_adj &lt;- model.frame(lin.pred[[3]], data=data)

p_adj = ncol(Xmat_adj)
p0 &lt;- ncol(Xmat0) + p_adj
p1 &lt;- ncol(Xmat1) + p_adj

nonz &lt;- rep(NA, q)
for(j in 1:q) nonz[j] &lt;- sum(Y[,j] != 0)

#####################
## Hyperparameters ##

## Generalized model
##
rho0     &lt;- q + 3 + 1
Psi0    &lt;- diag(3, q)

mu_alpha0     &lt;- 0
mu_alpha    &lt;- rep(0, q)

mu_beta0    &lt;- 0
mu_beta        &lt;- rep(0, q)

a_alpha0    &lt;- 0.7
b_alpha0     &lt;- 0.7

a_alpha        &lt;- rep(0.7, p0)
b_alpha     &lt;- rep(0.7, p0)

a_beta0        &lt;- 0.7
b_beta0     &lt;- 0.7

a_beta        &lt;- rep(0.7, p1)
b_beta         &lt;- rep(0.7, p1)

v_beta = rep(1, q)
omega_beta = rep(0.1, p1-p_adj)
v_alpha = rep(1, q)
omega_alpha = rep(0.1, p0-p_adj)

##
hyperParams.gen &lt;- list(rho0=rho0, Psi0=Psi0, mu_alpha0=mu_alpha0, mu_alpha=mu_alpha,
mu_beta0=mu_beta0, mu_beta=mu_beta, a_alpha0=a_alpha0, b_alpha0=b_alpha0,
a_alpha=a_alpha, b_alpha=b_alpha, a_beta0=a_beta0, b_beta0=b_beta0,
a_beta=a_beta, b_beta=b_beta, v_beta=v_beta, omega_beta=omega_beta,
v_alpha=v_alpha, omega_alpha=omega_alpha)

###################
## MCMC SETTINGS ##

## Setting for the overall run
##
numReps    &lt;- 100
thin       &lt;- 1
burninPerc &lt;- 0.5

## Settings for storage
##
storeV      &lt;-    TRUE
storeW      &lt;-    TRUE

## Tuning parameters for specific updates
##
##  - Generalized model
beta0.prop.var    &lt;- 0.5
alpha.prop.var    &lt;- 0.5
beta.prop.var    &lt;- 0.5
V.prop.var    &lt;- 0.05

##
mcmc.gen &lt;- list(run=list(numReps=numReps, thin=thin, burninPerc=burninPerc),
storage=list(storeV=storeV, storeW=storeW),
tuning=list(beta0.prop.var=beta0.prop.var, alpha.prop.var=alpha.prop.var,
beta.prop.var=beta.prop.var, V.prop.var=V.prop.var))

#####################
## Starting Values ##

## Generalized model
##
B &lt;- matrix(0.1, p1, q, byrow = T)
A &lt;- matrix(0.1, p0, q, byrow = T)

V &lt;- matrix(rnorm(n*q, 0, 0.1), n, q)
W &lt;- matrix(rnorm(n*q, 0, 0.1), n, q)

beta0 &lt;- log(as.vector(apply(Y, 2, mean)))
alpha0 &lt;- log(nonz/n / ((n-nonz)/n))

Sigma_V    &lt;- matrix(0, q, q)
diag(Sigma_V) &lt;- 1

R        &lt;- matrix(0, q, q)
diag(R) &lt;- 1

sigSq_alpha0 &lt;- 1
sigSq_alpha &lt;- rep(1, p0)
sigSq_beta0 &lt;- 1
sigSq_beta &lt;- rep(1, p1)

startValues.gen &lt;- list(B=B, A=A, V=V, W=W, beta0=beta0, alpha0=alpha0, R=R,
sigSq_alpha0=sigSq_alpha0,
sigSq_alpha=sigSq_alpha, sigSq_beta0=sigSq_beta0, sigSq_beta=sigSq_beta, Sigma_V=Sigma_V)


###################################
## Fitting the generalized model ##
###################################
fit.gen &lt;- mzipBvs(Y, lin.pred, data, model="generalized", offset=NULL, hyperParams.gen,
startValues.gen, mcmc.gen)

print(fit.gen)
summ.fit.gen &lt;- summary(fit.gen); names(summ.fit.gen)
summ.fit.gen


## End(Not run)
</code></pre>


</div>