<div class="container">

<table style="width: 100%;"><tr>
<td>beta.multidim.plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Illustrate Functional beta-Diversity indices for pairs of assemblages in a
multidimensional space</h2>

<h3>Description</h3>

<p>Illustrate overlap between convex hulls shaping species assemblages in a
multidimensional functional space.<strong>Before plotting beta functional
diversity indices should have been computed using the</strong>
<code>beta.fd.multidim</code> <strong>function</strong>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">beta.multidim.plot(
  output_beta_fd_multidim,
  plot_asb_nm,
  beta_family,
  plot_sp_nm = NULL,
  faxes = NULL,
  name_file = NULL,
  faxes_nm = NULL,
  range_faxes = c(NA, NA),
  color_bg = "grey95",
  shape_sp = c(pool = 3, asb1 = 22, asb2 = 21),
  size_sp = c(pool = 0.7, asb1 = 1.2, asb2 = 1),
  color_sp = c(pool = "grey50", asb1 = "blue", asb2 = "red"),
  fill_sp = c(pool = NA, asb1 = "white", asb2 = "white"),
  fill_vert = c(pool = NA, asb1 = "blue", asb2 = "red"),
  color_ch = c(pool = NA, asb1 = "blue", asb2 = "red"),
  fill_ch = c(pool = "white", asb1 = "blue", asb2 = "red"),
  alpha_ch = c(pool = 1, asb1 = 0.3, asb2 = 0.3),
  nm_size = 3,
  nm_color = "black",
  nm_fontface = "plain",
  check_input = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>output_beta_fd_multidim</code></td>
<td>
<p>the list returned by
<code>beta.fd.multidim</code> when <code>details_returned = TRUE</code>.
Thus, even if this function will illustrate functional beta-diversity for
a single pair of assemblages, plots will be scaled according to all
assemblages for which indices were computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_asb_nm</code></td>
<td>
<p>a vector with names of the 2 assemblages for which
functional beta-diversity will be illustrated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_family</code></td>
<td>
<p>a character string for the type of beta-diversity index
for which values will be printed, <code>'Jaccard'</code> (default) and/or
<code>'Sorensen'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_sp_nm</code></td>
<td>
<p>a vector containing species names that are to be plotted.
Default: <code>plot_nm_sp = NULL</code> (no name plotted).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>faxes</code></td>
<td>
<p>a vector with names of axes to plot (as columns names in
<code>output_beta_fd_multidim$details$input$sp_faxes_coord</code> ). <strong>You
can only plot from 2 to 4 axes for graphical reasons</strong>.
Default: <code>faxes = NULL</code> (the four first axes will be plotted).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name_file</code></td>
<td>
<p>a character string with name of file to save the figure
(without extension). Default: <code>name_file = NULL</code> which means plot is
displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>faxes_nm</code></td>
<td>
<p>a vector with axes labels for figure. Default: as
<code>faxes</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range_faxes</code></td>
<td>
<p>a vector with minimum and maximum values of axes. Note
that to have a fair representation of position of species in all plots,
they should have the same range. Default: <code>faxes_lim = c(NA, NA)</code> (the
range is computed according to the range of values among all axes).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color_bg</code></td>
<td>
<p>a R color name or an hexadecimal code used to fill
plot background. Default: <code>color_bg = "grey95"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape_sp</code></td>
<td>
<p>a vector with 3 numeric values referring to the shape of
symbol used for species from the 'pool' absent from the 2 assemblages, and
for species present in the 2 assemblages ('asb1', and 'asb2'),
respectively. Default: <code>shape_sp = c(pool = 3, asb1 = 22, asb2 = 21)</code> so
cross, square and circle.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size_sp</code></td>
<td>
<p>a numeric value referring to the size of symbols for
species. Default: <code style="white-space: pre;">⁠is size_sp = c(pool = 0.8, asb1 = 1, asb2 = 1)⁠</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color_sp</code></td>
<td>
<p>a vector with 3 names or hexadecimal codes referring to the
colour of symbol for species. Default is:
<code>color_sp = c(pool = "grey50", asb1 = "blue", asb2 = "red")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill_sp</code></td>
<td>
<p>a vector with 3 names or hexadecimal codes referring to the
color to fill symbol (if <code>shape_sp</code> &gt; 20) for species of the pool and
of the 2 assemblages. Default is:
<code>fill_sp = c(pool = NA, asb1 = "white", asb2 = "white")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill_vert</code></td>
<td>
<p>a vector with 3 names or hexadecimal codes
referring to the colour to fill symbol (if <code>shape_sp</code> &gt; 20) for
species being vertices of the convex hulls of the pool of species and of
the 2 assemblages. Default is:
<code>fill_vert = c(pool = NA, asb1 = "blue", asb2 = "red")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color_ch</code></td>
<td>
<p>a vector with 3 names or hexadecimal codes referring to the
border of the convex hulls of the pool of species and by the 2 assemblages.
Default is: <code>color_ch = c(pool = NA, asb1 = "blue", asb2 = "red")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill_ch</code></td>
<td>
<p>a vector with 3 names or hexadecimal codes referring to the
filling of the convex hull of the pool of species and of the 2 assemblages.
Default is <code>fill_ch = c(pool = "white", asb1 = "blue", asb2 = "red")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_ch</code></td>
<td>
<p>a vector with 3 numeric value for transparency of
the filling of the convex hulls (0 = high transparency, 1 = no
transparency). Default is:
<code>alpha_ch = c(pool = 1, asb1 = 0.3, asb2 = 0.3)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nm_size</code></td>
<td>
<p>a numeric value for size of species label. Default is <code>3</code>
(in points).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nm_color</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the color
of species label. Default is <code>black.</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nm_fontface</code></td>
<td>
<p>a character string for font of species labels (e.g.
"italic", "bold"). Default is <code>'plain'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check_input</code></td>
<td>
<p>a logical value indicating whether key features the
inputs are checked (e.g. class and/or mode of objects, names of rows
and/or columns, missing values). If an error is detected, a detailed
message is returned. Default: <code>check.input = TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If <code>name_file</code> is <code>NULL</code>, it returns a <code>patchwork</code>
figure with overlap between convex hulls projected in 2-dimensional spaces
for the given pair of assemblages. Values of functional beta-diversity
indices are shown on top-right corner of the figure. If <code>name_file</code> is
not <code>NULL</code>, the plot is saved locally.
</p>


<h3>Author(s)</h3>

<p>Sebastien Villeger and Camille Magneville
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Load Species*Traits dataframe:
 data("fruits_traits", package = "mFD")

# Load Assemblages*Species dataframe:
 data("baskets_fruits_weights", package = "mFD")

# Load Traits categories dataframe:
 data("fruits_traits_cat", package = "mFD")

# Compute functional distance
 sp_dist_fruits &lt;- mFD::funct.dist(sp_tr         = fruits_traits,
                                   tr_cat        = fruits_traits_cat,
                                   metric        = "gower",
                                   scale_euclid  = "scale_center",
                                   ordinal_var   = "classic",
                                   weight_type   = "equal",
                                   stop_if_NA    = TRUE)

# Compute functional spaces quality to retrieve species coordinates matrix:
 fspaces_quality_fruits &lt;- mFD::quality.fspaces(
                                  sp_dist             = sp_dist_fruits,
                                  maxdim_pcoa         = 10,
                                  deviation_weighting = "absolute",
                                  fdist_scaling       = FALSE,
                                  fdendro             = "average")

# Retrieve species coordinates matrix:
 sp_faxes_coord_fruits &lt;- fspaces_quality_fruits$details_fspaces$sp_pc_coord

# Get the occurrence dataframe:
 asb_sp_fruits_summ &lt;- mFD::asb.sp.summary(asb_sp_w = baskets_fruits_weights)
 asb_sp_fruits_occ &lt;- asb_sp_fruits_summ$"asb_sp_occ"

# Compute beta diversity indices:
 beta_fd_fruits &lt;- mFD::beta.fd.multidim(
  sp_faxes_coord   = sp_faxes_coord_fruits[, c("PC1", "PC2", "PC3", "PC4")],
  asb_sp_occ       = asb_sp_fruits_occ,
  check_input      = TRUE,
  beta_family      = c("Jaccard"),
  details_returned = TRUE)

# Compute beta fd plots:
 beta.multidim.plot(
   output_beta_fd_multidim = beta_fd_fruits,
   plot_asb_nm             = c("basket_1", "basket_6"),
   beta_family             = c("Jaccard"),
   plot_sp_nm              = c("apple", "cherry", "lemon"),
   faxes                   = paste0("PC", 1:4),
   name_file               = NULL,
   faxes_nm                = NULL,
   range_faxes             = c(NA, NA),
   color_bg                = "grey95",
   shape_sp                = c(pool = 3, asb1 = 22, asb2 = 21),
   size_sp                 = c(pool = 0.8, asb1 = 1, asb2 = 1),
   color_sp                = c(pool = "grey50", asb1 = "blue",
                               asb2 = "red"),
   fill_sp                 = c(pool = NA, asb1 = "white", asb2 = "white"),
   fill_vert               = c(pool = NA, asb1 = "blue", asb2 = "red"),
   color_ch                = c(pool = NA, asb1 = "blue", asb2 = "red"),
   fill_ch                 = c(pool = "white", asb1 = "blue",
                               asb2 = "red"),
   alpha_ch                = c(pool = 1, asb1 = 0.3, asb2 = 0.3),
   nm_size                 = 3,
   nm_color                = "black",
   nm_fontface             = "plain",
   check_input             = TRUE)

</code></pre>


</div>