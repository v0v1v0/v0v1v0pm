<div class="container">

<table style="width: 100%;"><tr>
<td>funct.dist</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute functional distance between species</h2>

<h3>Description</h3>

<p>For a given combination of traits, this function returns the functional
distance matrix between species.
</p>


<h3>Usage</h3>

<pre><code class="language-R">funct.dist(
  sp_tr,
  tr_cat,
  metric,
  scale_euclid = "scale_center",
  ordinal_var = "classic",
  weight_type = "equal",
  stop_if_NA = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sp_tr</code></td>
<td>
<p>a data frame of traits values (columns) for each species
(rows).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tr_cat</code></td>
<td>
<p>a data frame containing three columns for each trait (rows):
</p>

<ul>
<li> <p><strong>trait_name</strong>: the name of all traits as in <code>sp_tr</code> data
frame;
</p>
</li>
<li> <p><strong>trait_type</strong>: the category code for each trait as followed:
<code>N</code> for Nominal traits (factor variable), <code>O</code> for Ordinal traits
(ordered variable), <code>C</code> for Circular traits (integer values),
<code>Q</code> for quantitative traits (numeric values) that is allowed
<strong>only</strong> if there are at least 2 species with the same value, and
<code>F</code> for fuzzy traits (i.e. described with several values defined with
several column); </p>
</li>
<li> <p><strong>fuzzy_name</strong>: name of fuzzy-coded trait to
which 'sub-trait' belongs (if trait is not fuzzy, ignored so could be
trait name or NA). </p>
</li>
<li> <p><strong>trait_weight</strong>: Optional, a numeric vector
of length n (traits number) to specify a weight for each trait.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>
<p>the distance to be computed:
<code>euclidean</code>, the Euclidean distance,
<code>gower</code>, the Classical Gower distance as defined by Gower (1971), extent
by de Bello <em>et al.</em> (2021) and based on the <code>gawdis</code>
function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale_euclid</code></td>
<td>
<p>only when computing euclidean distance a string value to
compute (or not) scaling of quantitative traits using the
<code>tr.cont.scale</code> function.
Possible options are:
<code>range</code> (standardize by the range:
<code class="reqn">({x' = x - min(x) )} / (max(x) - min (x))</code>)
<code>center</code> (use the center transformation: <code class="reqn">x' = x - mean(x)</code>),
<code>scale</code> (use the scale transformation: <code class="reqn">x' = \frac{x}{sd(x)}</code>),
<code>scale_center</code> (use the scale-center transformation:
<code class="reqn">x' = \frac{x - mean(x)}{sd(x)}</code>), or
<code>noscale</code> traits are not scaled
Default is <code>scale_center</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ordinal_var</code></td>
<td>
<p>a character string specifying the method to be used for
ordinal variables (i.e. ordered).
<code>classic</code> simply treats ordinal variables as continuous variables;
<code>metric</code> refers to Eq. 3 of Podani (1999);
<code>podani</code> refers to Eqs. 2a-b of Podani (1999),
Both options convert ordinal variables to ranks. Default is <code>classic</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight_type</code></td>
<td>
<p>the type of used method to weight traits.
<code>user</code> user defined weights in tr_cat,
<code>equal</code> all traits having the same weight.
More methods are available using <code>gawdis</code> from
<code>gawdis</code> package. To compute gower distance with fuzzy trait and
weight please refer to <code>gawdis</code>. Default is <code>equal</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stop_if_NA</code></td>
<td>
<p>a logical value to stop or not the process if the
<code>sp_tr</code> data frame contains NA. Functional measures are sensitive to
missing traits. For further explanations, see the Note section.
Default is <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>dist</code> object containing distance between each pair of species.
</p>


<h3>Note</h3>

<p>If the <code>sp_tr</code> data frame contains <code>NA</code> you can either
chose to compute anyway functional distances (but keep in mind that
<strong>Functional measures are sensitive to missing traits!</strong>) or you can
delete species with missing or extrapolate missing traits (see
Johnson <em>et al.</em> (2020)).
</p>


<h3>Author(s)</h3>

<p>Nicolas Loiseau and Sebastien Villeger
</p>


<h3>References</h3>

<p>de Bello <em>et al.</em> (2021) Towards a more balanced combination of multiple
traits when computing functional differences between species.
<em>Method in Ecology and Evolution</em>, <strong>12</strong>, 443-448.<br>
Gower (1971 ) A general coefficient of similarity and some of its
properties. <em>Biometrics</em>, <strong>27</strong>, 857-871.<br>
Johnson <em>et al.</em> (2020) Handling missing values in trait data.
<em>Global Ecology and Biogeography</em>, <strong>30</strong>, 51-62.<br>
Podani (1999) Extending Gower's general coefficient of similarity to ordinal
characters, <em>Taxon</em>, <strong>48</strong>, 331-340.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load Species x Traits data
data("fruits_traits", package = "mFD")

# Load Traits x Categories data
data("fruits_traits_cat", package = "mFD")

# Remove fuzzy traits for this example and thus remove lat column:
fruits_traits     &lt;- fruits_traits[ , -c(6:8)]
fruits_traits_cat &lt;- fruits_traits_cat[-c(6:8), ]
fruits_traits_cat &lt;- fruits_traits_cat[ , -3]

# Compute Functional Distance
sp_dist_fruits &lt;- mFD::funct.dist(sp_tr         = fruits_traits,
                                  tr_cat        = fruits_traits_cat,
                                  metric        = "gower",
                                  scale_euclid  = "scale_center",
                                  ordinal_var   = "classic",
                                  weight_type   = "equal",
                                  stop_if_NA    = TRUE)
sp_dist_fruits
</code></pre>


</div>