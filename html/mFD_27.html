<div class="container">

<table style="width: 100%;"><tr>
<td>funct.space.plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot species position in a functional space</h2>

<h3>Description</h3>

<p>This function illustrates the position of species along pairs of axes of a
functional space
</p>


<h3>Usage</h3>

<pre><code class="language-R">funct.space.plot(
  sp_faxes_coord,
  faxes = NULL,
  name_file = NULL,
  faxes_nm = NULL,
  range_faxes = c(NA, NA),
  color_bg = "grey95",
  color_pool = "darkturquoise",
  fill_pool = "white",
  shape_pool = 21,
  size_pool = 1,
  plot_ch = TRUE,
  color_ch = "darkblue",
  fill_ch = "white",
  alpha_ch = 1,
  plot_vertices = TRUE,
  color_vert = "darkturquoise",
  fill_vert = "darkturquoise",
  shape_vert = 22,
  size_vert = 1,
  plot_sp_nm = NULL,
  nm_size = 3,
  nm_color = "black",
  nm_fontface = "plain",
  check_input = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sp_faxes_coord</code></td>
<td>
<p>a matrix of species coordinates in a
multidimensional functional space. Species coordinates have been retrieved
thanks to <code>tr.cont.fspace</code> or <code>quality.fspaces</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>faxes</code></td>
<td>
<p>a vector with names of axes to plot (as columns names in
<code>sp_faxes_coord</code>). <strong>You can only plot from 2 to 4 axes for
graphical reasons</strong>. Default: <code>faxes = NULL</code> (the four first axes will be
plotted).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name_file</code></td>
<td>
<p>a character string with name of file to save the
figure (without extension). Default: <code>name_file = NULL</code> which means plot
is displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>faxes_nm</code></td>
<td>
<p>a vector with axes labels for figure. Default: as
<code>faxes</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range_faxes</code></td>
<td>
<p>a vector with minimum and maximum values of axes
used for all plots to have a fair representation of position of species.
Default: <code>range_faxes = c(NA, NA)</code> (the range is computed
according to the range of values among all axes). If at least one of the
value provided is within the range of coordinates, then convex hull could
not be plotted so <code>plot_ch</code> should be <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color_bg</code></td>
<td>
<p>a R color name or an hexadecimal code used to fill plot
background. Default: <code>color_bg = "grey95"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color_pool</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the
color of symbol for species. Default: <code>color_pool = 'darkgreen'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill_pool</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the
color to fill species symbol (if <code>shape_pool</code> &gt;20). Default:
<code>fill_pool = 'white'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape_pool</code></td>
<td>
<p>a numeric value referring to the shape of symbol used for
species. Default: <code>shape_pool = 21</code> (filled circle).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size_pool</code></td>
<td>
<p>a numeric value referring to the size of symbol for
species. Default: <code>size_pool = 1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_ch</code></td>
<td>
<p>a logical value indicating whether the convex hull shaping
the pool of species should be illustrated. If <code>plot_ch = TRUE</code>, convex
hull of all species in the multidimensional space described in
<code>sp_faxes_coord</code> is computed and its projection in 2D spaces are
drawn as polygons. Default: <code>plot_ch = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color_ch</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the
border of the convex hull filled by the pool of species. Default:
<code>color_ch = "darkblue"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill_ch</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the
filling of the convex hull filled by the pool of species. Default:
<code>fill_ch = "white"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_ch</code></td>
<td>
<p>a numeric value for transparency of the filling of the
convex hull (0 = high transparency, 1 = no transparency). Default:
<code>alpha_ch = 1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_vertices</code></td>
<td>
<p>a logical value defining whether vertices of the convex
hull shaping the pool of species should be illustrated. If
<code>plot_vertices = TRUE</code>, vertices of convex hull computed in the
multidimensional space from <code>sp_faxes_coord</code> and are plotted with
aesthetics listed below '..._vert' (species not being vertices are plotted
with aesthetics described above for '.._sp'. Default:
<code>plot_vertices = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color_vert</code></td>
<td>
<p>a character value referring to the color of symbol for
vertices if <code>plot_vertices = TRUE</code>.
Default: <code>color_vert = 'darkturquoise'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill_vert</code></td>
<td>
<p>a character value referring to the color for filling symbol
for vertices  (if <code>shape_vert</code> &gt;20). Default:
<code>fill_vert = 'darkturquoise'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape_vert</code></td>
<td>
<p>a numeric value referring to the symbol used to show
vertices position if <code>plot_vertices = TRUE</code>. Default: <code>shape_vert = 23</code>
(filled diamond).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size_vert</code></td>
<td>
<p>a numeric value referring to the size of symbol for
vertices Default: <code>size_vert = 1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_sp_nm</code></td>
<td>
<p>a vector containing species names that are to be printed
near their position. Default: <code>plot_nm_sp = NULL</code> (no name plotted).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nm_size</code></td>
<td>
<p>a numeric value for size of species label. Default is <code>3</code>
(in points).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nm_color</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the color
of species label. Default: <code>nm_color = 'black'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nm_fontface</code></td>
<td>
<p>a character string for font of species labels (e.g.
"italic", "bold"). Default: <code>nm_fontface = 'plain'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check_input</code></td>
<td>
<p>a logical value indicating whether key features the
inputs are checked (e.g. class and/or mode of objects, names of rows
and/or columns, missing values). If an error is detected, a detailed
message is returned. Default: <code>check_input = TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If <code>name_file</code> is <code>NULL</code>, a list containing <code>ggplot2</code>
objects is returned: plots of functional space along all pairs of axes
(named according to axes names, e.g. "PC1_PC2"), figure 'caption', and the
full figure 'patchwork' built using the library <code>patchwork</code>.
If <code>name_file</code> is not <code>NULL</code> a 300dpi png file
is saved in the working directory. Ranges of axes are the same for all
panels and if required projection of the convex hull computed in the
multidimensional space provided as input <code>sp_faxes_coord</code> is
illustrated with a polygon. Species being vertices of this convex hull are
shown with aesthetics provided as inputs <code>..._vert</code>. Labels for
species listed in <code>plot_sp_nm</code> are added with if required arrows
using <code>ggrepel</code>. Summary about species and dimensionality are printed
on top-right corner of the figure.
</p>


<h3>Author(s)</h3>

<p>Camille Magneville and Sebastien Villeger
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load Species*Traits dataframe:
 data("fruits_traits", package = "mFD")

# Load Assemblages*Species dataframe:
 data("baskets_fruits_weights", package = "mFD")

# Load Traits categories dataframe:
 data("fruits_traits_cat", package = "mFD")

# Compute functional distance
 sp_dist_fruits &lt;- mFD::funct.dist(sp_tr         = fruits_traits,
                                  tr_cat         = fruits_traits_cat,
                                  metric         = "gower",
                                  scale_euclid   = "scale_center",
                                  ordinal_var    = "classic",
                                  weight_type    = "equal",
                                  stop_if_NA     = TRUE)

# Compute functional spaces quality to retrieve species coordinates matrix:
 fspaces_quality_fruits &lt;- mFD::quality.fspaces(
  sp_dist             = sp_dist_fruits,
  maxdim_pcoa         = 10,
  deviation_weighting = "absolute",
  fdist_scaling       = FALSE,
  fdendro             = "average")

# Retrieve species coordinates matrix:
sp_faxes_coord_fruits &lt;- fspaces_quality_fruits$details_fspaces$sp_pc_coord

# Plot functional spaces:
mFD::funct.space.plot(
 sp_faxes_coord    = sp_faxes_coord_fruits[, c("PC1", "PC2", "PC3", "PC4")],
  faxes             = NULL,
  name_file         = NULL,
  faxes_nm          = NULL,
  range_faxes       = c(NA, NA),
  color_bg          = "grey95",
  color_pool          = "darkturquoise",
  fill_pool           = "white",
  shape_pool          = 21,
  size_pool           = 1,
  plot_ch           = TRUE,
  color_ch          = "darkblue",
  fill_ch           = "white",
  alpha_ch          = 1,
  plot_vertices     = TRUE,
  color_vert        = "darkturquoise",
  fill_vert         = "darkturquoise",
  shape_vert        = 22,
  size_vert         = 1,
 plot_sp_nm         = NULL,
 nm_size            = 3,
 nm_color           = "black",
 nm_fontface        = "plain",
 check_input        = TRUE)
</code></pre>


</div>