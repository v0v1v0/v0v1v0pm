<div class="container">

<table style="width: 100%;"><tr>
<td>quality.fspaces.plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot functional space quality with a chosen quality metric</h2>

<h3>Description</h3>

<p>Plot functional space quality with a chosen quality metric
</p>


<h3>Usage</h3>

<pre><code class="language-R">quality.fspaces.plot(
  fspaces_quality,
  quality_metric,
  fspaces_plot,
  name_file = NULL,
  range_dist = NULL,
  range_dev = NULL,
  range_qdev = NULL,
  gradient_deviation = c(neg = "darkblue", nul = "grey80", pos = "darkred"),
  gradient_deviation_quality = c(low = "yellow", high = "red"),
  x_lab = "Trait-based distance"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fspaces_quality</code></td>
<td>
<p>output from the <code>quality.fspaces</code>
function, that is a list with all data needed to illustrate quality of
functional spaces based on deviation between species trait-based distance
and distance in functional spaces built using PCoA (and dendrogram).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quality_metric</code></td>
<td>
<p>a character string with the name of the quality metric
to illustrate. Should be one of the column names of
<code>fspaces_quality$quality_fspaces</code>. See help of
<code>quality.fspaces</code> for the meaning of these names regarding
type of deviation and scaling of distance in functional space. Default:
<code>'mad'</code> (Mean absolute deviation).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fspaces_plot</code></td>
<td>
<p>a vector with names of functional spaces to consider.
Should be a subset of the row names of
<code>quality_fspaces$quality_fspaces</code>. Maximum of 10 spaces allowed to
keep decent plot size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name_file</code></td>
<td>
<p>a character string with name of file to save the
figure (without extension). Default: <code>NULL</code> which means plot is displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range_dist</code></td>
<td>
<p>a vector with minimum and maximum values to
display for species pairwise distances (x-axis for all panels and y-axes
of top panel). Default: NULL, which means range is 0 to maximum distance
among all the functional spaces to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range_dev</code></td>
<td>
<p>a vector with minimum and maximum values to display
for deviation to trait-based distance (y-axis of middle panel). Default:
NULL, which means range is set to range of deviation among all the
functional spaces to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range_qdev</code></td>
<td>
<p>a vector with minimum and maximum values to
display for deviation to trait-based distance (y-axis of bottom panel).
Default:NULL, which means range is from 0 to the maximum of (transformed)
deviation among all the functional spaces to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gradient_deviation</code></td>
<td>
<p>a vector of 3 colors for illustrating raw
deviation with <code>scale_colour_gradient2</code>. The first
value ('neg') is for the lowest negative deviation, the second value
('nul')is for null deviation and the third value ('pos') is for the
highest positive deviation. Default gradient is from darkblue to grey to
red.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gradient_deviation_quality</code></td>
<td>
<p>2 colors (named 'low' and 'high') for
illustrating transformed deviation used to compute quality metric with
<code>scale_colour_gradient2</code> (default gradient is from
yellow to red).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_lab</code></td>
<td>
<p>a character string with title to display below X axis.
Default is 'Trait-based distance'.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A png file (resolution 300dpi) saved in the current working
directory. Quality of each functional space is illustrated with three
panels : - top row shows trait-based distance between species vs.
space-based distance. - middle row shows trait-based distance vs.
deviation between space-based and trait-based distances - bottom row shows
trait-based distance between species vs. transformed deviation used to
compute the quality metric All plots have the same X axis. All plots on a
given row have the same Y axis and color palette. Type of distance in
functional space (Euclidean in PCoA, Cophenetic on tree) are abbreviated,
as well as type of transformation of distance (scaling) and of deviation
(Absolute or Squared)
</p>


<h3>Author(s)</h3>

<p>Sebastien Villeger and Camille Magneville
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load Species*Traits dataframe:
data("fruits_traits", package = "mFD")

# Load Assemblages*Species dataframe:
data("baskets_fruits_weights", package = "mFD")

# Load Traits categories dataframe:
data("fruits_traits_cat", package = "mFD")

# Compute functional distance
sp_dist_fruits &lt;- mFD::funct.dist(sp_tr         = fruits_traits,
                                  tr_cat        = fruits_traits_cat,
                                  metric        = "gower",
                                  scale_euclid  = "scale_center",
                                  ordinal_var   = "classic",
                                  weight_type   = "equal",
                                  stop_if_NA    = TRUE)

# Compute functional spaces quality to retrieve species coordinates matrix:
fspaces_quality_fruits &lt;- mFD::quality.fspaces(
 sp_dist             = sp_dist_fruits,
 maxdim_pcoa         = 10,
 deviation_weighting = "absolute",
 fdist_scaling       = FALSE,
 fdendro             = "average")

 # Illustrate the quality of functional spaces:
 mFD::quality.fspaces.plot(
  fspaces_quality            = fspaces_quality_fruits,
  quality_metric             = "mad",
  fspaces_plot               = c("tree_average", "pcoa_2d", "pcoa_3d", 
                              "pcoa_4d", "pcoa_5d"),
  name_file                  = NULL, 
  range_dist                 = NULL, 
  range_dev                  = NULL, 
  range_qdev                 = NULL,
  gradient_deviation         = c(neg = "darkblue", nul = "grey80", 
                                 pos = "darkred"),
  gradient_deviation_quality = c(low ="yellow", high = "red"),
  x_lab                      = "Trait-based distance")
</code></pre>


</div>