<div class="container">

<table style="width: 100%;"><tr>
<td>traits.faxes.cor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Correlation between Traits and Axes</h2>

<h3>Description</h3>

<p>Compute relationship between all traits and all axes of the functional
space. For continuous trait a linear model is computed and r2 and p-value
are returned. For other types of traits, a Kruskal-Wallis test is computed
and eta2 statistics is returned.
Option allows to plot trait-axis relationships with scatterplot and boxplot
for continuous and non-continuous traits, respectively.
</p>


<h3>Usage</h3>

<pre><code class="language-R">traits.faxes.cor(
  sp_tr,
  sp_faxes_coord,
  tr_nm = NULL,
  faxes_nm = NULL,
  plot = FALSE,
  name_file = NULL,
  color_signif = "darkblue",
  color_non_signif = "gray80",
  stop_if_NA = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sp_tr</code></td>
<td>
<p>a data frame containing species as rows and traits as columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sp_faxes_coord</code></td>
<td>
<p>a matrix of species coordinates in a multidimensional
functional space. Species coordinates have been retrieved
thanks to <code>tr.cont.fspace</code> or <code>quality.fspaces</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tr_nm</code></td>
<td>
<p>a vector gathering the names of traits (as in <code>sp_tr</code>) to
consider. If <code>NULL</code> all traits are considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>faxes_nm</code></td>
<td>
<p>a vector gathering the names of PCoA axes (as in
<code>sp_faxes_coord</code>) to consider.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>a logical value indicating whether plot illustrating relations
between trait and axes should be drawn. <strong>You can only plot relationships
for up to 10 traits and/or 10 axes</strong>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name_file</code></td>
<td>
<p>the file name (without extension) to save the plot as a 300
dpi JPEG file. Default is <code>NULL</code> which means plot is only displayed. If
<code>plot = FALSE</code> this argument is ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color_signif</code></td>
<td>
<p>an R color name or an hexadecimal code referring to
the color of points when relationships between the trait and the axis is
significant. Default is <code>darkblue</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color_non_signif</code></td>
<td>
<p>an R color name or an hexadecimal code referring to
the
color of points when relationships between the trait and the axis are not
significant. Default is <code>gray80</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stop_if_NA</code></td>
<td>
<p>a logical value to stop or not the process if the
<code>sp_tr</code> data frame contains NA. Functional measures are sensitive to
missing traits. For further explanations, see the Note section.
Default is <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>1 data frame with for each combination of trait and axis (rows), the
name of the test performed, and the corresponding statistics and p-value.
If <code>plot = TRUE</code> a multi-panel figure with traits as columns and axes as
rows is also plotted. When relationships between trait and axis is
significant the points are colored, else they remain grayish.
</p>


<h3>Author(s)</h3>

<p>Nicolas Loiseau and Sebastien Villeger
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load Species x Traits Data
data("fruits_traits", package = "mFD")

# Load Traits categories dataframe
data("fruits_traits_cat", package = "mFD")

# Compute Functional Distance
sp_dist_fruits &lt;- mFD::funct.dist(sp_tr  = fruits_traits,
 tr_cat = fruits_traits_cat,
 metric = "gower",
 scale_euclid  = "scale_center",
 ordinal_var = "classic",
 weight_type = "equal",
 stop_if_NA  = TRUE)
  
# Compute Functional Spaces Quality (to retrieve species coordinates)
fspaces_quality_fruits &lt;- mFD::quality.fspaces(
  sp_dist             = sp_dist_fruits, 
  maxdim_pcoa         = 10,
  deviation_weighting = "absolute",
  fdist_scaling       = FALSE,
  fdendro             = "average")
  
# Retrieve Species Coordinates
sp_faxes_coord_fruits &lt;- fspaces_quality_fruits$details_fspaces$sp_pc_coord

# Compute Correlation between Traits and Functional Axes
mFD::traits.faxes.cor(
  sp_tr          = fruits_traits, 
  sp_faxes_coord = sp_faxes_coord_fruits, 
  tr_nm          = NULL, 
  faxes_nm       = NULL,
  name_file      = NULL, 
  color_signif   = "darkblue",
  color_non_signif = "gray80")
</code></pre>


</div>