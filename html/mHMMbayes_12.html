<div class="container">

<table style="width: 100%;"><tr>
<td>plot.mHMM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plotting the posterior densities for a fitted multilevel HMM</h2>

<h3>Description</h3>

<p><code>plot.mHMM</code> plots the posterior densities for a fitted multilevel hidden
Markov model for the group and subject level parameters simultaneously. The
plotted posterior densities are either for the transition probability matrix
gamma, or for the emission distribution probabilities (categorical data) or
means and standard deviation (continuous data).
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'mHMM'
plot(
  x,
  component = "gamma",
  dep = 1,
  col,
  dep_lab,
  cat_lab,
  lwd1 = 2,
  lwd2 = 1,
  lty1 = 1,
  lty2 = 3,
  legend_cex,
  burn_in,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Object of class <code>mHMM</code>, generated by the function
<code>mHMM</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>component</code></td>
<td>
<p>String specifying if the displayed posterior densities
should be for the transition probability matrix gamma (<code>component =
"gamma"</code>), or for the emission distribution probabilities (<code>component
= "emiss"</code>). In case of the latter and the model is based on multiple
dependent variables, the user has to indicate for which dependent variable
the posterior densities have to be plotted, see <code>dep</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dep</code></td>
<td>
<p>Integer specifying for which dependent variable the posterior
densities should be plotted. Only required if one wishes to plot the
emission distribution probabilities and the model is based on multiple
dependent variables. Defaults to <code>dep = 1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>Vector of colors for the posterior density lines. If one is
plotting the posterior densities for gamma, or the posterior densities of
Normally distributed emission probabilities, the vector has length <code>m</code>
(i.e., number of hidden states). If one is plotting the posterior densities
for categorical emission probabilities, the vector has length
<code>q_emiss[k]</code> (i.e., the number of outcome categories for the dependent
variable <code>k</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dep_lab</code></td>
<td>
<p>Optional string when plotting the posterior
densities of the emission probabilities with length 1, denoting the label
for the dependent variable plotted. Automatically obtained from the input
object <code>x</code> when not specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cat_lab</code></td>
<td>
<p>Optional vector of strings when plotting the posterior
densities of categorical emission probabilities, denoting the labels of the
categorical outcome values. Automatically generated when not provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd1</code></td>
<td>
<p>Positive number indicating the line width of the posterior
density at the group level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd2</code></td>
<td>
<p>Positive number indicating the line width of the posterior
density at the subject level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty1</code></td>
<td>
<p>Positive number indicating the line type of the posterior
density at the group level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty2</code></td>
<td>
<p>Positive number indicating the line type of the posterior
density at the subject level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend_cex</code></td>
<td>
<p>A numerical value giving the amount by which plotting text
and symbols in the legend should be magnified relative to the default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn_in</code></td>
<td>
<p>An integer which specifies the number of iterations to discard
when obtaining the model parameter summary statistics. When left
unspecified, the burn in period specified at creating the <code>mHMM</code>
object with the function <code>mHMM</code> will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments to be passed to methods (see <code>par</code>)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note that the standard deviation of the (variable and) state specific Normal
emission distribution in case of continuous data is fixed over subjects.
Hence, for the standard deviation, only the posterior distribution at the
group level is plotted.
</p>


<h3>Value</h3>

<p><code>plot.mHMM</code> returns a plot of the posterior densities. Depending
on whether (<code>component = "gamma"</code>) or (<code>component = "emiss"</code>),
the plotted posterior densities are either for the transition probability
matrix gamma or for the emission distribution probabilities, respectively.
</p>


<h3>See Also</h3>

<p><code>mHMM</code> for fitting the multilevel hidden Markov
model, creating the object <code>mHMM</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">###### Example on package example data, see ?nonverbal
# First run the function mHMM on example data

# specifying general model properties:
m &lt;- 2
n_dep &lt;- 4
q_emiss &lt;- c(3, 2, 3, 2)

# specifying starting values
start_TM &lt;- diag(.8, m)
start_TM[lower.tri(start_TM) | upper.tri(start_TM)] &lt;- .2
start_EM &lt;- list(matrix(c(0.05, 0.90, 0.05, 0.90, 0.05, 0.05), byrow = TRUE,
                        nrow = m, ncol = q_emiss[1]), # vocalizing patient
                 matrix(c(0.1, 0.9, 0.1, 0.9), byrow = TRUE, nrow = m,
                        ncol = q_emiss[2]), # looking patient
                 matrix(c(0.90, 0.05, 0.05, 0.05, 0.90, 0.05), byrow = TRUE,
                        nrow = m, ncol = q_emiss[3]), # vocalizing therapist
                 matrix(c(0.1, 0.9, 0.1, 0.9), byrow = TRUE, nrow = m,
                        ncol = q_emiss[4])) # looking therapist

# Run a model without covariate(s):
out_2st &lt;- mHMM(s_data = nonverbal, gen = list(m = m, n_dep = n_dep,
                q_emiss = q_emiss), start_val = c(list(start_TM), start_EM),
                mcmc = list(J = 11, burn_in = 5))

## plot the posterior densities for gamma
plot(out_2st, component = "gamma")


</code></pre>


</div>