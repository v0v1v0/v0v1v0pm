<div class="container">

<table style="width: 100%;"><tr>
<td>obtain_emiss</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Obtain the emission distribution probabilities for a fitted multilevel HMM</h2>

<h3>Description</h3>

<p><code>obtain_emiss</code> obtains the emission distribution for an object
containing a fitted multilevel hidden Markov model, either at the group
level, i.e., representing the average emission distribution over all
subjects, or at the subject level, returning the emission distribution for
each subject.
</p>


<h3>Usage</h3>

<pre><code class="language-R">obtain_emiss(object, level = "group", burn_in = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class <code>mHMM</code>, generated by the function
<code>mHMM</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>String specifying if the returned transition probability matrix
gamma should be at the group level (<code>level = "group"</code>), i.e.,
representing the average transition probability matrix over all subjects,
or at the subject level (<code>level = "subject"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn_in</code></td>
<td>
<p>An integer which specifies the number of iterations to discard
when obtaining the model parameter summary statistics. When left
unspecified (<code>burn_in = NULL</code>), the burn in period specified when
creating the <code>mHMM</code> object will be used.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>obtain_emiss</code> creates an object of the class <code>mHMM_emiss</code>.
Depending on the specification at the input variable <code>level</code>, the
output is either a list of matrices with the emission distribution at the
group level (if <code>level = "group"</code>) for each dependent variable, or a
list of lists, where for each dependent variable a list is returned with
the number of elements equal to the number of subjects analyzed (if
<code>level = 'subject'</code>). In the latter scenario, each matrix in the lower
level list represents the subject specific emission distribution for a specific
dependent variable.
</p>


<h3>See Also</h3>

<p><code>mHMM</code> for fitting the
multilevel hidden Markov model.
</p>


<h3>Examples</h3>

<pre><code class="language-R">###### Example on package data, see ?nonverbal

# specifying general model properties:
m &lt;- 2
n_dep &lt;- 4
q_emiss &lt;- c(3, 2, 3, 2)

# specifying starting values
start_TM &lt;- diag(.8, m)
start_TM[lower.tri(start_TM) | upper.tri(start_TM)] &lt;- .2
start_EM &lt;- list(matrix(c(0.05, 0.90, 0.05,
                          0.90, 0.05, 0.05), byrow = TRUE,
                        nrow = m, ncol = q_emiss[1]), # vocalizing patient
                 matrix(c(0.1, 0.9,
                          0.1, 0.9), byrow = TRUE, nrow = m,
                        ncol = q_emiss[2]), # looking patient
                 matrix(c(0.90, 0.05, 0.05,
                          0.05, 0.90, 0.05), byrow = TRUE,
                        nrow = m, ncol = q_emiss[3]), # vocalizing therapist
                 matrix(c(0.1, 0.9,
                          0.1, 0.9), byrow = TRUE, nrow = m,
                        ncol = q_emiss[4])) # looking therapist

# Run a model without covariate(s):
out_2st &lt;- mHMM(s_data = nonverbal,
                gen = list(m = m, n_dep = n_dep, q_emiss = q_emiss),
                start_val = c(list(start_TM), start_EM),
                mcmc = list(J = 11, burn_in = 5))

out_2st
summary(out_2st)

# obtaining the emission probabilities at the group and subject level
obtain_emiss(out_2st, level = "group")
obtain_emiss(out_2st, level = "subject")



</code></pre>


</div>