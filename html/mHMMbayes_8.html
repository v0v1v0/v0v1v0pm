<div class="container">

<table style="width: 100%;"><tr>
<td>obtain_gamma</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Obtain the transition probabilities gamma for a fitted multilevel HMM</h2>

<h3>Description</h3>

<p><code>obtain_gamma</code> obtains the transition probability matrix (TPM) for an
object containing a fitted multilevel hidden Markov model. The TPM can be
obtained either at the group level, i.e., representing the average transition
probability matrix over all subjects, or at the subject level, returning the
transition probability matrices for each subject.
</p>


<h3>Usage</h3>

<pre><code class="language-R">obtain_gamma(object, level = "group", burn_in = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class <code>mHMM</code>, generated by the function
<code>mHMM</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>String specifying if the returned transition probability matrix
gamma should be at the group level (<code>level = "group"</code>), i.e.,
representing the average transition probability matrix over all subjects,
or at the subject level (<code>level = "subject"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn_in</code></td>
<td>
<p>An integer which specifies the number of iterations to discard
when obtaining the model parameter summary statistics. When left
unspecified (<code>burn_in = NULL</code>), the burn in period specified when
creating the <code>mHMM</code> object will be used.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>obtain_gamma</code> creates an object of the class <code>mHMM_gamma</code>.
This object can be directly plotted using the function
<code>plot.mHMM_gamma()</code>, or simply <code>plot()</code>. Depending on the
specification at the input variable <code>level</code>, the output is either a
matrix with the transition probabilities at the group level (if <code>level
  = "group"</code>), or a list of matrices (with the number of elements equal to
the number of subjects analyzed, if <code>level = 'subject'</code>), where each
matrix in the list represents a subject specific transition probability
matrix.
</p>


<h3>See Also</h3>

<p><code>mHMM</code> for fitting the multilevel hidden Markov model,
and <code>plot.mHMM_gamma</code> for plotting the obtained transition
probabilities.
</p>


<h3>Examples</h3>

<pre><code class="language-R">###### Example on package data

# specifying general model properties:
m &lt;- 2
n_dep &lt;- 4
q_emiss &lt;- c(3, 2, 3, 2)

# specifying starting values
start_TM &lt;- diag(.8, m)
start_TM[lower.tri(start_TM) | upper.tri(start_TM)] &lt;- .2
start_EM &lt;- list(matrix(c(0.05, 0.90, 0.05,
                          0.90, 0.05, 0.05), byrow = TRUE,
                        nrow = m, ncol = q_emiss[1]), # vocalizing patient
                 matrix(c(0.1, 0.9,
                          0.1, 0.9), byrow = TRUE, nrow = m,
                        ncol = q_emiss[2]), # looking patient
                 matrix(c(0.90, 0.05, 0.05,
                          0.05, 0.90, 0.05), byrow = TRUE,
                        nrow = m, ncol = q_emiss[3]), # vocalizing therapist
                 matrix(c(0.1, 0.9,
                          0.1, 0.9), byrow = TRUE, nrow = m,
                        ncol = q_emiss[4])) # looking therapist

# Run a model without covariate(s):
out_2st &lt;- mHMM(s_data = nonverbal,
                gen = list(m = m, n_dep = n_dep, q_emiss = q_emiss),
                start_val = c(list(start_TM), start_EM),
                mcmc = list(J = 11, burn_in = 5))

out_2st
summary(out_2st)

# obtaining the transition probabilities at the group and subject level
obtain_gamma(out_2st, level = "group")
obtain_gamma(out_2st, level = "subject")



</code></pre>


</div>