<div class="container">

<table style="width: 100%;"><tr>
<td>mmpa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Number of Assays Required using Marker-Assisted Mini-Pooling with Algorithm
(mMPA)</h2>

<h3>Description</h3>

<p>Function <code>mmpa(...)</code> calculates the number of assays required, when
using mMPA, for
pools that are formed following the order of individual samples in the data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mmpa(v, s, K = 5, vf_cut = 1000, lod = 0, msg = T)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>A vector of non-negative numerical assay results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>A vector of risk scores; <code>s</code> must have the same
length as <code>v</code>. The risk score <code>s</code> needs to be positively
associated with <code>v</code>; othewise an error message will be generated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Pool size; default is <code>K = 5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vf_cut</code></td>
<td>
<p>Cutoff value for defining positive cases;
default is <code>vf_cut = 1000</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lod</code></td>
<td>
<p>A vector of lower limits of detection or a scalar if the limits are the
same; default is <code>lod = 0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>msg</code></td>
<td>
<p>Message generated during calculation; default is <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For a given sample (v_i, s_i), i = 1, ..., N, the first <code>K</code> samples are combined to
form a pool, the next <code>K</code> samples are combined to form the second
pool, and so on. If the number of samples for the last pool is less than
<code>K</code>, these remaining samples are not used to form a pool (i.e.
not included
in the calculation) . Therefore, a total of
<code>N%/%K</code> pools are formed. The function calculates the number of
assays needed for each of these pools.
</p>


<h3>Value</h3>

<p>A vectorof length <code>N%/%K</code> for the numbers of assays needed for all pools
that are formed.
</p>


<h3>References</h3>

<p>Liu T, Hogan JW, Daniels, MJ, Coetzer M, Xu Y, Bove G, et al. Improved HIV-1 Viral Load
Monitoring Capacity Using Pooled Testing with Marker-Assisted Deconvolution. Journal of
AIDS. 2017;75(5): 580-587.
</p>
<p>Bilder CR, Tebbs JM, Chen P. Informative retesting. Journal of the American
Statistical Association. 2010;105(491):942-955.
</p>
<p>May S, Gamst A, Haubrich R, Benson C, Smith DM. Pooled nucleic acid testing
to identify antiretroviral treatment failure during HIV infection. Journal
of Acquired Immune Deficiency Syndromes. 2010;53(2):194-201.
</p>


<h3>See Also</h3>

<p>minipool, mpa, pooling_mc
</p>


<h3>Examples</h3>

<pre><code class="language-R">K=5; n = 50;
n.pool  = n/K; n.pool
#   [1] 10
set.seed(100)
pvl = rgamma(n, shape = 2.8, scale = 150)
riskscore = (rank(pvl)/n) * 0.5 + runif(n) * 0.5
mmpa(v = pvl, s = riskscore)
#   A total of 10 pools are formed.
#   The numbers of assays required by these pools are:
#   [1] 3 3 4 4 2 3 3 4 3 3

</code></pre>


</div>