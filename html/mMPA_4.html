<div class="container">

<table style="width: 100%;"><tr>
<td>pooling_mc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Monte Carlo Simulation for Estimating the Number of Assays Required
when Using Pooled Testing</h2>

<h3>Description</h3>

<p>This function uses Monte Carlo (MC) to simulate different orders in
which the samples would be collected to form pools. Unlike the
function <code>minipool</code>, <code>mpa</code>, and <code>mmpa</code> that calculate
the number of assays
needed for pools that are formed following the exact order
of the samples that are listed in the data, this function
<code>pooling_mc</code> permutes the data many (<code>perm_num</code>) times
so as to estimate the average number of
assays required (ATR) per individual. Using MC avoids the dependence
on any
specific ordering of forming pools.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pooling_mc(v, s = NULL, K = 5, vf_cut = 1000, lod = 0,
  method = "mmpa", perm_num = 100, msg = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>A vector of non-negative numerical assay results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>A vector of risk scores; <code>s</code> must be provided if <code>method = "mmpa"</code>
and have the same length as <code>v</code>. The risk score <code>s</code> needs to be positively
associated with <code>v</code>; othewise an error message will be generated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Pool size; default is <code>K = 5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vf_cut</code></td>
<td>
<p>Cutoff value for defining positive cases;
default is <code>vf_cut = 1000</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lod</code></td>
<td>
<p>A vector of lower limits of detection or a scalar if the limits are the
same; default is <code>lod = 0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Method that is used for pooled testing; must be one of <code>minipool</code>,
<code>mpa</code>, and <code>mmpa</code>. By default, <code>method = "mmpa"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perm_num</code></td>
<td>
<p>The number of permutation to be used for the calculation;
default is <code>100</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>msg</code></td>
<td>
<p>Message generated during calculation; default is <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The outcome is a matrix of dimension <code>num_pool</code> by <code>perm_num</code>.
The row number is the number of pools (<code>num_pool</code>) from each permutation
of the data, which is
determined by the sample size <code>N</code> and pool size <code>K</code>; <code>num_pool
= N%/%K</code>. The column number is the number of
permutations (<code>num_pool</code>).
</p>


<h3>References</h3>

<p>Liu T, Hogan JW, Daniels, MJ, Coetzer M, Xu Y, Bove G, et al. Improved HIV-1 Viral Load
Monitoring Capacity Using Pooled Testing with Marker-Assisted Deconvolution. Journal of
AIDS. 2017;75(5): 580-587.
</p>
<p>Bilder CR, Tebbs JM, Chen P. Informative retesting. Journal of the American
Statistical Association. 2010;105(491):942-955.
</p>
<p>May S, Gamst A, Haubrich R, Benson C, Smith DM. Pooled nucleic acid testing to
identify antiretroviral treatment failure during HIV infection. Journal of Acquired
Immune Deficiency Syndromes. 2010;53(2):194-201.
</p>
<p>Dorfman R. The detection of defective members of large populations. The
Annals of Mathematical Statistics. 1943;14(4):436-440.
</p>


<h3>See Also</h3>

<p>minipool, mpa, mmpa
</p>


<h3>Examples</h3>

<pre><code class="language-R">### sample size = 300
n = 300;
set.seed(100)
pvl = rgamma(n, shape = 2.8, scale = 150)
summary(pvl)
#   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
#   53      225      392     424    564    1373
riskscore = (rank(pvl)/n) * 0.5 + runif(n) * 0.5
cor(pvl, riskscore, method = "spearman")
#   [1] 0.69
### Pool size K is set to 5
K=5;
### so, the number of pools = 60
n.pool  = n/K; n.pool
#   [1] 60
foo = pooling_mc(pvl, riskscore, perm_num = 100)
### Average number of assays needed per pool for each of the 100
### permutations of the data
apply(foo, 2, mean)
#   [1] 3.43 3.33 3.35 3.47 3.37 3.33 3.37 3.27 3.43 3.28 3.32 3.35 3.35 3.37
#   [15] 3.38 3.37 3.30 3.43 3.28 3.38 3.42 3.35 3.35 3.48 3.30 3.47 3.40 3.35
#  [29] 3.25 3.30 3.38 3.43 3.25 3.45 3.35 3.33 3.42 3.38 3.40 3.33 3.32 3.38
#   [43] 3.33 3.37 3.37 3.33 3.35 3.38 3.38 3.30 3.30 3.33 3.37 3.32 3.30 3.40
#   [57] 3.37 3.42 3.30 3.37 3.38 3.32 3.45 3.38 3.37 3.50 3.33 3.40 3.28 3.37
#   [71] 3.23 3.33 3.23 3.42 3.32 3.32 3.45 3.35 3.32 3.32 3.33 3.33 3.30 3.38
#   [85] 3.37 3.33 3.33 3.20 3.37 3.33 3.30 3.40 3.40 3.32 3.33 3.37 3.40 3.38
#   [99] 3.30 3.33
### Estimated average number of assays needed per pool
mean(foo)
#   3.35
### Estimated average number of assays needed per individual
mean(foo)/K
#   [1] 0.67
</code></pre>


</div>