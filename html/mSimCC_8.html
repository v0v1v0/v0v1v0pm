<div class="container">

<table style="width: 100%;"><tr>
<td>microsim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Generate microsimulated cohorts
</h2>

<h3>Description</h3>

<p>Generates several microsimulated cohorts with desired specifications.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  microsim(seed=1234, nsim, transition, abs_states, sympt_states, prob_sympt, size, 
           p_men, min_age, max_age, utilityCoefs, costCoefs.md, costCoefs.nmd, 
           costCoefs.i, disc=3, vacc=FALSE, vacc.age=NULL, ndoses=NULL, vacc.cov=NULL, 
           vacc.eff=NULL, vacc.type=NULL, vacc.prop=NULL, vaccprice.md=NULL, 
           vaccprice.nmd=NULL, vaccprice.i=NULL, screening=FALSE, screenType=0, 
           scrSchema=0, screenPeriod=NULL, cytoType=NULL, screenPrice.md=NULL, 
           screenPrice.nmd=NULL, screenPrice.i=NULL, colpoPrice.md=NULL, 
           colpoPrice.nmd=NULL, colpoPrice.i=NULL, hpvTestPrice.md=NULL, 
           hpvTestPrice.nmd=NULL, hpvTestPrice.i=NULL, cytoHpvPrice.md=NULL, 
           cytoHpvPrice.nmd=NULL, cytoHpvPrice.i=NULL, biopsPrice.md=NULL, 
           biopsPrice.nmd=NULL, biopsPrice.i=NULL, screenCoverage=NULL, screenSensi=NULL,
           screenSensi2=NULL, screenSensi3=NULL, colpoSensi=NULL, biopSensi=NULL, 
           hpvTestSensi=NULL, treatProbs, nAnnualVisits=0, nAnnualVisitsLSIL=0, 
           nAnnualVisitsHSIL=0, cytoHPVPeriod=0, cytoHPVPostColpo=0, 
           cytoHPVPostBiop=NULL, cytoLSILperiod=0, cytoHSILperiod=0, switchAge=0, 
           C_period=NULL, hpvPeriod=0, nCores=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>

<p>seed to be used in the simulation. Default value is <code>1234</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>

<p>number of cohorts to be simulated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transition</code></td>
<td>

<p>transition probabilities matrix.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abs_states</code></td>
<td>

<p>vector with the absorbing states.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sympt_states</code></td>
<td>

<p>vector with the health states that might present symptoms.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob_sympt</code></td>
<td>

<p>vector with the probability of presenting symptoms for each health state that might present symptoms. Should have the same length of <code>sympt_states</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>

<p>number of individuals on each simulated cohort.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_men</code></td>
<td>

<p>proportion of men in the simulated cohorts.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_age</code></td>
<td>

<p>lowest age in the cohort.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_age</code></td>
<td>

<p>largest age in the cohort.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>utilityCoefs</code></td>
<td>

<p>vector with the utilities for each health state.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>costCoefs.md</code></td>
<td>

<p>vector with the direct medical costs for each health state.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>costCoefs.nmd</code></td>
<td>

<p>vector with the direct non medical costs for each health state.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>costCoefs.i</code></td>
<td>

<p>vector with the indirect costs for each health state.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>disc</code></td>
<td>

<p>discount rate in percentage. Default value is <code>3</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vacc</code></td>
<td>

<p>boolean value specifying if the considered scenario includes vaccination. Default value is <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vacc.age</code></td>
<td>

<p>vector with ages at vaccination if the considered scenario includes vaccination. Default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndoses</code></td>
<td>

<p>number of doses of vaccine if the considered scenario includes vaccination. Default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vacc.cov</code></td>
<td>

<p>vaccine coverage if the considered scenario includes vaccination. Default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vacc.eff</code></td>
<td>

<p>vaccine effectivity if the considered scenario includes vaccination. Default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vacc.type</code></td>
<td>

<p>type of vaccine if the considered scenario includes vaccination, character with values <code>biv</code> for bivalent, <code>quad</code> for quadrivalent and <code>nona</code> for nonavalent vaccines. Default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vacc.prop</code></td>
<td>

<p>proportion of vaccinated women on each age group if the considered scenario includes vaccination. Default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vaccprice.md</code></td>
<td>

<p>vaccine direct medical costs if the considered scenario includes vaccination. Default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vaccprice.nmd</code></td>
<td>

<p>vaccine direct non medical costs if the considered scenario includes vaccination. Default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vaccprice.i</code></td>
<td>

<p>vaccine indirect if the considered scenario includes vaccination. Default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>screening</code></td>
<td>

<p>boolean specifying if the considered scenario includes screening of any type. Default value is <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>screenType</code></td>
<td>

<p>type of screening. <code>1</code> stands for organized screening, <code>2</code> stands for opportunistic screening. Default value is <code>0</code> (no screening).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scrSchema</code></td>
<td>

<p>screening schema. <code>1</code> stands for cytology alone with repeat cytology for triage, <code>2</code> stands for cytology with HPV triage, <code>3</code> stands for HPV with cytology triage and <code>4</code> stands for HPV genotyping with cytology triage. Default value is <code>0</code> (no screening).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>screenPeriod</code></td>
<td>

<p>screening period (in years). Default value is <code>NULL</code> (no screening).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cytoType</code></td>
<td>

<p>type of cytology. <code>0</code> stands for conventional cytology, <code>1</code> stands for Liquid Based Cytology (LBC). Default value is <code>NULL</code> (no cytology).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>screenPrice.md</code></td>
<td>

<p>medical direct cost of cytology. Default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>screenPrice.nmd</code></td>
<td>

<p>non-medical direct cost of cytology. Default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>screenPrice.i</code></td>
<td>

<p>indirect cost of cytology. Default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colpoPrice.md</code></td>
<td>

<p>medical direct cost of colposcopy. Default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colpoPrice.nmd</code></td>
<td>

<p>non-medical direct cost of colposcopy. Default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colpoPrice.i</code></td>
<td>

<p>indirect cost of colposcopy. Default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hpvTestPrice.md</code></td>
<td>

<p>medical direct cost of HPV test. Default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hpvTestPrice.nmd</code></td>
<td>

<p>non-medical direct cost of HPV test. Default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hpvTestPrice.i</code></td>
<td>

<p>indirect cost of HPV test. Default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cytoHpvPrice.md</code></td>
<td>

<p>medical direct cost of HPV reflex test, in case <code>cytoType=1</code>. Default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cytoHpvPrice.nmd</code></td>
<td>

<p>non-medical direct cost of HPV reflex test, in case <code>cytoType=1</code>. Default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cytoHpvPrice.i</code></td>
<td>

<p>indirect cost of HPV reflex test, in case <code>cytoType=1</code>. Default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>biopsPrice.md</code></td>
<td>

<p>medical direct cost of biopsy. Default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>biopsPrice.nmd</code></td>
<td>

<p>non-medical direct cost of biopsy. Default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>biopsPrice.i</code></td>
<td>

<p>indirect cost of biopsy. Default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>screenCoverage</code></td>
<td>

<p>cytology coverage for each age group. Default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>screenSensi</code></td>
<td>

<p>cytology sensitivity for each age group. Default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>screenSensi2</code></td>
<td>

<p>cytology sensitivity after cytology for each age group. Default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>screenSensi3</code></td>
<td>

<p>cytology sensitivity after HPV test for each age group. Default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colpoSensi</code></td>
<td>

<p>colposcopy sensitivity for each age group. Default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>biopSensi</code></td>
<td>

<p>biopsy sensitivity for each age group. Default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hpvTestSensi</code></td>
<td>

<p>HPV test sensitivity for each age group. Default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treatProbs</code></td>
<td>

<p>probability of recuperation after treatment for each FIGO I - FIGO IV states.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nAnnualVisits</code></td>
<td>

<p>number of annual visits after colposcopy for screening schema <code>1</code>. Default value is <code>0</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nAnnualVisitsLSIL</code></td>
<td>

<p>number of annual visits after LSIL for screening schema <code>2</code>. Default value is <code>0</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nAnnualVisitsHSIL</code></td>
<td>

<p>number of annual visits after HSIL for screening schema <code>2</code>. Default value is <code>0</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cytoHPVPeriod</code></td>
<td>

<p>cytology and HPV test protocol period for screening schemas <code>3</code> and <code>4</code>. Default value is <code>0</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cytoHPVPostColpo</code></td>
<td>

<p>cytology and HPV test protocol period after colposcopy protocol for screening schemas <code>3</code> and <code>4</code>. Default value is <code>0</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cytoHPVPostBiop</code></td>
<td>

<p>cytology and HPV test protocol period after biopsy protocol for screening schemas <code>2</code>. Default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cytoLSILperiod</code></td>
<td>

<p>period for cytology after LSIL detection for screening schame <code>2</code>. Default value is <code>0</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cytoHSILperiod</code></td>
<td>

<p>period for cytology after HSIL detection for screening schame <code>2</code>. Default value is <code>0</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>switchAge</code></td>
<td>

<p>age at which screening protocol changes for screening schemas <code>3</code> and <code>4</code>. Default value is <code>0</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C_period</code></td>
<td>

<p>vector with screening periods (in years) before and after switch age for screening schemas <code>3</code> and <code>4</code>. Default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hpvPeriod</code></td>
<td>

<p>period for HPV test in screening schema <code>2</code>. Default value is <code>0</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nCores</code></td>
<td>

<p>number of cores of the computer. Default value is <code>1</code>.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Data frame containing the simulated cohorts and the individual history for each person in each simulated cohort.
</p>


<h3>Author(s)</h3>

<p>David Moriña (Universitat de Barcelona), Pedro Puig (Universitat Autònoma de Barcelona) and Mireia Diaz (Institut Català d'Oncologia)
</p>


<h3>References</h3>

<p>Georgalis L, de Sanjosé S, Esnaola M, Bosch F X, Diaz M. Present and future of cervical cancer prevention in Spain: a cost-effectiveness analysis. European Journal of Cancer Prevention 2016;<b>25</b>(5):430-439.
</p>
<p>Moriña D, de Sanjosé S, Diaz M. Impact of model calibration on cost-effectiveness analysis of cervical cancer prevention 2017;<b>7</b>.
</p>


<h3>See Also</h3>

<p><code>mSimCC-package</code>, <code>bCohort</code>, <code>costs</code>, <code>le</code>,
<code>plotCIN1Incidence</code>, <code>plotCIN2Incidence</code>, <code>plotCIN3Incidence</code>,
<code>plotIncidence</code>, <code>plotMortality</code>, <code>plotPrevalence</code>,
<code>qalys</code>, <code>yls</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(probs)
nsim       &lt;- 3
p.men      &lt;- 0
size       &lt;- 20
min.age    &lt;- 10
max.age    &lt;- 84

#### Natural history
hn &lt;- microsim(seed=1234, nsim, probs, abs_states=c(10, 11), sympt_states=c(5, 6, 7, 8), 
               prob_sympt=c(0.11, 0.23, 0.66, 0.9), 
                size, p.men, min.age, max.age, 
                utilityCoefs = c(1, 1, 0.987, 0.87, 0.87, 0.76, 0.67, 0.67, 0.67, 0.938, 0, 0),
                costCoefs.md = c(0, 0, 254.1, 1495.9, 1495.9, 5546.8, 12426.4, 23123.4, 
                                 34016.6, 0, 0, 0),
                costCoefs.nmd = c(0, 0, 81.4, 194.1, 194.1, 219.1, 219.1, 219.1, 219.1, 0, 0, 0),
                costCoefs.i = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0), disc=3, 
                treatProbs=c(0,0,1,1,1,0.9894,0.9422,0.8262,0.5507,0,0,0),
                nCores=1) ### individual level
</code></pre>


</div>