<div class="container">

<table style="width: 100%;"><tr>
<td>mhor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculating Odds Ratios</h2>

<h3>Description</h3>

<p><code>mhor()</code> calculates odds ratios, Mantel Haenszel pooled estimates and
95% CI.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mhor(
  data,
  exp,
  case,
  strata = NULL,
  exp_value = NULL,
  case_value = NULL,
  digits = 4
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data.frame</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exp</code></td>
<td>
<p>exposure or independent variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>case</code></td>
<td>
<p>case or dependent variables (outcomes)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strata</code></td>
<td>
<p>if specified, MH OR is calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exp_value</code></td>
<td>
<p>value for exposure as reference</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>case_value</code></td>
<td>
<p>value for outcome as reference</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>specify rounding of numbers. See <code>round</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Rows and Columns can be rearranged by specifying
<code>exp_value</code> and <code>case_value</code>. This is used
when the exposed and case values are not at the right place in 2x2 tables.
</p>
<p>Reference row value can be specified in <code>exp_value</code>.
</p>
<p>Attributable fractions, <code>Attr. Frac. Exp</code> and  <code>Attr. Frac. Pop</code>
among exposed and population are calculated when OR is greater than or
equal to 1.
If OR is less than 1, preventable fractions,  <code>Prev. Frac. Exp</code>
and  <code>Attr. Frac. Pop</code> are calculated.
</p>
<p>It produces a table with Odds Ratio, 95% CI as well as
p-value. If <code>strata</code> is specified, <code>Mantel-Haenzsel</code> Pooled
estimates of <code style="white-space: pre;">⁠Odds Ratio⁠</code> is generated along with Chi-squared test for
homogeneity.
</p>
<p><strong>Odds Ratio, OR</strong>
</p>
<p style="text-align: center;"><code class="reqn">OR = (D1 x H0) / (D0 x H1)</code>
</p>

<p><strong>Error Factor, EF using Woolf's formula</strong>
</p>
<p style="text-align: center;"><code class="reqn">95\% CI = OR / EF or OR x EF</code>
</p>

<p style="text-align: center;"><code class="reqn">EF = exp(1.96 x SE(log(OR)))</code>
</p>

<p style="text-align: center;"><code class="reqn">SE(log(OR)) = \sqrt{1/D1 + 1/H1 + 1/D0 + 1/H0}</code>
</p>

<p><strong>Calculating p-value from Wald's z test</strong>
</p>
<p style="text-align: center;"><code class="reqn">z = log OR / SE (log OR)</code>
</p>

<p><strong>Mantel-Haenszel's OR</strong>
</p>
<p style="text-align: center;"><code class="reqn">ORMH = Q / R</code>
</p>

<p style="text-align: center;"><code class="reqn">Q = \sum{(D1i x H0i) / ni}</code>
</p>

<p style="text-align: center;"><code class="reqn">R = \sum{(D0i x H1i) / ni}</code>
</p>

<p><strong>Calculating CI for MH-OR</strong>
</p>
<p style="text-align: center;"><code class="reqn">95\% CI = OR / EF or OR x EF</code>
</p>

<p style="text-align: center;"><code class="reqn">SE(ORMH) = \sqrt{V / (Q x R)}</code>
</p>

<p style="text-align: center;"><code class="reqn">V = \sum{(Di x Hi x n0i x n1i) / ( (ni)^2 x (ni - 1))}</code>
</p>

<p><strong>Chi-square test for MHOR, df = 1</strong>
</p>
<p style="text-align: center;"><code class="reqn">X^2 (MH), Chi-square value = U^2 / V</code>
</p>

<p style="text-align: center;"><code class="reqn">U = O - E</code>
</p>

<p style="text-align: center;"><code class="reqn">O = \sum{D1i}</code>
</p>

<p style="text-align: center;"><code class="reqn">E = \sum{Di x n1i / ni}</code>
</p>

<p><strong>Chi-square test for Heterogeneity</strong>
</p>
<p style="text-align: center;"><code class="reqn">X^2 = \sum{(D1i x H0i - ORMH x D0i x H1i)^2 / ORMH x Vi x ni^2}</code>
</p>



<h3>Value</h3>

<p>data.frame
</p>


<h3>Author(s)</h3>

<p>Email: <a href="mailto:dr.myominnoo@gmail.com">dr.myominnoo@gmail.com</a>
</p>
<p>Website: <a href="https://myominnoo.github.io/">https://myominnoo.github.io/</a>
</p>


<h3>References</h3>


<ol>
<li>
<p> Betty R. Kirkwood, Jonathan A.C. Sterne (2006, ISBN:978–0–86542–871–3)
</p>
</li>
<li>
<p> B. Burt Gerstman (2013, ISBN:978-1-4443-3608-5)
</p>
</li>
<li>
<p> Douglas G Altman (2005, ISBN:0 7279 1375 1)
</p>
</li>
</ol>
<h3>Examples</h3>

<pre><code class="language-R">

### Example from Essential Medical Statistics
# Page 178, Chapter 18: Controlling for confounding: Stratification
lepto &lt;- expandtbl(
    male = c(36, 14, 50, 50), female = c(24, 126, 10, 90),
    exp_name = "area", exp_lvl = c("Rural", "Urban"),
    case_name = "ab", case_lvl = c("Yes", "No"),
    strata_name = "gender"
)

## label variables and data
lepto &lt;- label(lepto, "Prevalence survey of leptospirosis in West Indies")
lepto &lt;- label(lepto, area="Type of area", ab = "Leptospirosis Antibodies",
                  gender="Gener: Male or Female")

## Calculate OR
mhor(lepto, area, ab)

## Calculate MHOR
mhor(lepto, area, ab, gender)


</code></pre>


</div>