<div class="container">

<table style="width: 100%;"><tr>
<td>sim.data.single</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Generate single-level simulation data
</h2>

<h3>Description</h3>

<p> This function generates a single-level dataset with given parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim.data.single(Z, Theta, Sigma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p> a vector of treatment/exposure assignment.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Theta</code></td>
<td>
<p> a 2 by 2 matrix, containing the model coefficients.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p> a 2 by 2 matrix, is the covariance matrix of the model errors.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p> The single level mediation model is
</p>
<p style="text-align: center;"><code class="reqn">M=ZA+E_1,</code>
</p>

<p style="text-align: center;"><code class="reqn">R=ZC+MB+E_2.</code>
</p>

<p><code>Theta[1,1] = A</code>, <code>Theta[1,2] = C</code> and <code>Theta[2,2] = B</code>; <code>Sigma</code> is the covariance matrix of <code class="reqn">(E_1,E_2)</code>.
</p>


<h3>Value</h3>

<p> The function returns a dataframe with variables <code>Z</code>, <code>M</code> and <code>R</code>.
</p>


<h3>Author(s)</h3>

<p> Yi Zhao, Brown University, <a href="mailto:yi_zhao@brown.edu">yi_zhao@brown.edu</a>;
Xi Luo, Brown University, <a href="mailto:xi.rossi.luo@gmail.com">xi.rossi.luo@gmail.com</a>
</p>


<h3>References</h3>

<p>Zhao, Y., &amp; Luo, X. (2014). <em>Estimating Mediation Effects under Correlated Errors with an Application to fMRI.</em> arXiv preprint arXiv:1410.7217.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  ###################################################
  # Generate a single-level dataset

  # covariance matrix of errors
  delta&lt;-0.5
  Sigma&lt;-matrix(c(1,2*delta,2*delta,4),2,2)

  # model coefficients
  A0&lt;-0.5
  B0&lt;--1
  C0&lt;-0.5

  Theta&lt;-matrix(c(A0,0,C0,B0),2,2)

  # number of trials
  n&lt;-100

  # generate a treatment assignment vector
  set.seed(100)
  Z&lt;-matrix(rbinom(n,size=1,0.5),n,1)

  # Data
  set.seed(5000)
  data.single&lt;-sim.data.single(Z,Theta,Sigma)
  ###################################################
</code></pre>


</div>