<div class="container">

<table style="width: 100%;"><tr>
<td>cliBrtSunDurFrcGrid</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimator for Fraction of Bright Sunshine Duration</h2>

<h3>Description</h3>

<p>Estimates monthly averages for daily fraction of bright sunshine duration, for a given region and
year, by using the monthly time series of temperature and precipitation, and the elevation data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cliBrtSunDurFrcGrid(
  rs.temp,
  rs.prec,
  rl.elv,
  sc.year = 2000,
  aprchSIM = c("Solar123", "SPLASH"),
  filename = "",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>rs.temp</code></td>
<td>
<p>multi-layer Raster*/SpatRaster object with one-year time series of monthly mean air temperature
(in °C)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rs.prec</code></td>
<td>
<p>multi-layer Raster*/SpatRaster object with one-year time series of monthly precipitation sum
(in mm)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rl.elv</code></td>
<td>
<p>single-layer Raster*/SpatRaster object with the elevation values (in meters above sea level)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sc.year</code></td>
<td>
<p>'numeric' scalar with the value of the year (using astronomical year numbering)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aprchSIM</code></td>
<td>
<p>'character' vector of length 1 that indicates the formula used to estimate the value of solar
irradiance/irradiation for a specific day. Valid values are as follows: <br>
(a) <code>'Solar123'</code> -
in this approach, first, the mean hourly solar irradiance under cloudless-sky conditions is calculated as
proposed by Yin (1997b), with a minor modification, using the daytime means of optical air mass and
cosine zenith; the former is computed as recommended by Yin (1997b), while the latter is estimated by using
Eq 5 of Yin (1997a); however, in contrast to the original approach, where the solar constant was fixed at
<code class="reqn">4.9212 MJ m^{-2} hr^{-1}</code>, according to Yin (1999), its value is corrected by
calendar day for the variable ellipticity of the Earth's orbit, by using the scheme of Brock (1981); in the
calculations, the values of solar declination and daylength are derived by using the approach of Brock (1981);
<br>
(b) <code>'SPLASH'</code> -
in this approach, first, under varying orbital parameters, the daily solar radiation at the top of the
atmosphere is calculated (<code class="reqn">H_{0}</code>, Eq 7 in Davis et al. (2017)), and then this value is
multiplied by the atmospheric transmittivity to obtain the value of daily surface radiation; in this case as
well, cloudless conditions are assumed, i.e., the transmission coefficient is taken into account with an
universal value of 0.75, however, its value is modified as a function of elevation, by using the scheme of
Allen (1996); the daylength is calculated via Eq 1.6.11 in Duffie and Beckman (1991), using the sunset hour
angle (<code class="reqn">h_{s}</code>, Eq 8. in Davis et al. (2017)); finally, the mean hourly surface radiation is
derived as the quotient of the daily surface radiation and the daylength.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filename</code></td>
<td>
<p>output filename</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments passed on to <code>writeRaster</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See <code>cliBrtSunDurFrcPoints</code>.
</p>


<h3>Value</h3>

<p>A 12-layer SpatRaster object with one-year time series of monthly mean relative sunshine duration.
</p>


<h3>Note</h3>

<p>The objects <code>'rs.temp'</code> and <code>'rs.prec'</code> must be 12-layer Raster*/SpatRaster objects, while the
object <code>'rl.elv'</code> has to be a single-layer Raster*/SpatRaster object. These Raster*/SpatRaster objects
must have the same bounding box, projection, and resolution. The object <code>'sc.year'</code> has to be a single
integer number.
</p>


<h3>References</h3>

<p><cite>Allen RG (1996) Assessing integrity of weather data for reference evapotranspiration estimation. J Irrig
Drain Eng 122(2):97–106. <a href="https://doi.org/10.1061/%28ASCE%290733-9437%281996%29122%3A2%2897%29">doi:10.1061/(ASCE)0733-9437(1996)122:2(97)</a></cite>
</p>
<p><cite>Berger A, Loutre MF (1991) Insolation values for the climate of the last 10 million years. Quat Sci Rev
10(4):297-317. <a href="https://doi.org/10.1016/0277-3791%2891%2990033-Q">doi:10.1016/0277-3791(91)90033-Q</a></cite>
</p>
<p><cite>Brock TD (1981) Calculating solar radiation for ecological studies. Ecol Model 14(1–2):1-19.
<a href="https://doi.org/10.1016/0304-3800%2881%2990011-9">doi:10.1016/0304-3800(81)90011-9</a></cite>
</p>
<p><cite>Davis TW, Prentice IC, Stocker BD, Thomas RT, Whitley RJ, Wang H, Evans BJ, Gallego-Sala AV, Sykes MT,
Cramer W (2017) Simple process-led algorithms for simulating habitats (SPLASH v.1.0): robust indices of
radiation, evapotranspiration and plant-available moisture. Geosci Model Dev 10(2):689–708.
<a href="https://doi.org/10.5194/gmd-10-689-2017">doi:10.5194/gmd-10-689-2017</a></cite>
</p>
<p><cite>Duffie JA, Beckman WA (1991) Solar Engineering of Thermal Processes. Second Edition. Wiley-Interscience,
New York, NY</cite>
</p>
<p><cite>Yin X (1997a) Calculating daytime mean relative air mass. Agric For Meteorol 87(2-3):85-90.
<a href="https://doi.org/10.1016/S0168-1923%2897%2900029-4">doi:10.1016/S0168-1923(97)00029-4</a></cite>
</p>
<p><cite>Yin X (1997b) Optical Air Mass: Daily Integration and its Applications. Meteorol Atmos Phys 63(3-4):227-233.
<a href="https://doi.org/10.1007/BF01027387">doi:10.1007/BF01027387</a></cite>
</p>
<p><cite>Yin X (1999) Bright Sunshine Duration in Relation to Precipitation, Air Temperature and Geographic Location.
Theor Appl Climatol 64(1–2):61–68. <a href="https://doi.org/10.1007/s007040050111">doi:10.1007/s007040050111</a></cite>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(raster)

# Loading mandatory data for the Example 'Single-Year Grid'
data(inp_exSglyGrid)
inp_exSglyGrid &lt;- lapply(inp_exSglyGrid, crop, extent(20.15, 20.25, 46.25, 46.35))

# Estimate values of the monthly mean relative sunshine duration
# at a grid cell near Szeged, Hungary (46.3N, 20.2E), in the year 2010
with(inp_exSglyGrid, {
rs.bsdf &lt;- cliBrtSunDurFrcGrid(temp, prec, elv, sc.year = 2010)
rs.bsdf
})


</code></pre>


</div>