<div class="container">

<table style="width: 100%;"><tr>
<td>f_dmss_dW</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Calculate Derivative of Cost Function wrt W
</h2>

<h3>Description</h3>

<p>Calculate the first derivative of objective function with respect to W, given data and requisite model parameter values.
</p>


<h3>Usage</h3>

<pre><code class="language-R">f_dmss_dW(U, Xstar, W, yerrs, cc)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>U</code></td>
<td>

<p>Numeric matrix, <code>N</code> x <code>d_u</code> of activation inputs.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xstar</code></td>
<td>

<p>Numeric matrix, <code>N</code> x <code>m</code>.  The “new” polynomial inputs created by applying the activation layer, <code>W</code>, to <code>U</code>.  Accomplished computationally with fun <code>f_mactivate</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>

<p>Numeric matrix, <code>d_u</code> x <code>m</code>, the multiplicative activation layer.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yerrs</code></td>
<td>

<p>Numeric vector of length <code>N</code>.  <code>y</code> minus <code>yhat</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cc</code></td>
<td>

<p>Numeric vector of length <code>m</code>.  Coefficients for <code>Xstar</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>There is really no need for user to call this function directly; this function is called by the fitting functions in this library.
<b>Important.</b> Computationally there are (at least) two ways to solve this derivative, one is O(Nd), the other is O(Nd^2) (d is the number of columns in <code>U</code>).  This function uses the first, computationally less expensive method.  It is not an approximation; the simplification occurs simply by dividing out the appropriate partial term rather than taking the full product of terms across <code>U</code>.  This has a very important implication of which we must be aware: <b>zeros in <code>U</code> may result in division by zero!</b>  This function will handle the errors, but the ultimate consequence of zeros in <code>U</code> is that the derivative returned by this function may not be accurate.  We should eliminate zeros in <code>U</code>.  Standardizing <code>U</code> is one good solution.  If zeros are only present because of “one-hot” indicators (dummies), another possible solution is to substitute -1 for 0 (actually not a bad practice anyway).
</p>


<h3>Value</h3>

<p>Numeric matrix, <code>d_u</code> x <code>m</code>.
</p>


<h3>See Also</h3>

<p><code>f_mactivate</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#######
</code></pre>


</div>