<div class="container">

<table style="width: 100%;"><tr>
<td>mediate_iv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mediation Analysis for Count and Zero-Inflated Count Data Using Instrumental
Variable Method</h2>

<h3>Description</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script><p> 'mediate_iv' is used to estimate controlled or natural
direct effect ratio, indirect (mediation) effect ratio for count and
zero-inflated count data using Instrumental Variable (IV) method
described in Guo, Z., Small, D.S., Gansky, S.A., Cheng, J. (2018).
</p>


<h3>Usage</h3>

<pre><code class="language-R">mediate_iv(
  y,
  z,
  m,
  zm.int = FALSE,
  ydist = "poisson",
  mtype = "binary",
  x.IV,
  x.nonIV = NULL,
  tol = 1e-05,
  n.init = 3,
  control = list(),
  conf.level = 0.95,
  sims = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Outcome variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>Treatment variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>Mediator variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zm.int</code></td>
<td>
<p>A logical value. if 'FALSE' the interaction of treatment
by mediator will not be included in the outcome model; if 'TRUE' the interaction
will be included in the outcome model. Default is 'FALSE'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ydist</code></td>
<td>
<p>A character string indicating outcome distribution which will
be used to fit for getting the initial parameter estimates. Can only take
one of the these three values - 'poisson', 'negbin', or 'neyman type a'
Default is 'poisson'. Use 'neyman type a' for zero-inflated outcomes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mtype</code></td>
<td>
<p>A character string indicating mediator type, either 'binary'
or 'continuous'. Default is 'binary'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.IV</code></td>
<td>
<p>Specifies baseline variable(s) to construct Instrumental Variable(s),
Use <code>cbind()</code> for 2 or more IVs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.nonIV</code></td>
<td>
<p>Specifies baseline variable(s) that are not used to construct
Instrumental Variable(s) as covariates. Use <code>cbind()</code> for 2 or more non
IVs. Default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Numeric tolerance value for parameter convergence. When the square
root of sum of squared difference between two consecutive set of optimized
parameters less than <code>tol</code>, then the convergence is reached.
Default is 1e-5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.init</code></td>
<td>
<p>Number of set of initial parameter values. Default is 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>A list of parameters governing the nonlinear optimization
algorithm behavior (to minimize the profile empirical log-likelihood).
This list is the same as that for <code>BBoptim()</code>, which is a wrapper
for <code>spg()</code>. <code>control</code> default is
<code>list(maxit = 1500, M = c(50, 10), ftol=1e-10, gtol = 1e-05,
 maxfeval = 10000, maximize = FALSE, trace = FALSE, triter = 10,
 eps = 1e-07, checkGrad=NULL)</code>.  See <code>spg</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>Level of the returned two-sided bootstrap confidence
intervals. The default value, 0.95, is to return the 2.5 and 97.5
percentiles of the simulated quantities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sims</code></td>
<td>
<p>Number of Monte Carlo draws for nonparametric bootstrap.
Default is 1000.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>'mediate_iv' is to estimate the controlled and natural direct and
indirect ratios of randomized treatment around and through mediators when
there is unmeasured confounding. This function considers count and
zero-inflated count outcomes, and binary and continuous mediators. The
estimation uses an instrumental variable approach with empirical
likelihood and estimating equations, where no parametric assumption is
needed for the outcome distribution.
</p>
<p><em>Controlled effect ratio</em>
</p>
<p>Given the generalized linear model for the expected potential outcomes:
\[f[E(Y(z,m)|x,u)] = \beta_0 + \beta_zz + \beta_mm + \beta_xx + u,\]
where \(f\) is a log-link function, \(\beta_0\) is the intercept,
\(z\) is the treatment, \(m\) is pre-specified mediator value, \(x\)
are baseline covariates, \(\beta_z\), \(\beta_m\), \(\beta_x\) are
their corresponding coefficients, \(u\) are unmeasured confounders and
\(Y(z,m)\) is the potential outcome under treatment \(z\) and mediator
\(m\).
Then the controlled direct effect ratio when the treatment changes from
\(z^\ast\) to \(z\) while keeping the mediator at \(m\):
</p>
\[\frac{E[Y(z,m)|x,u]}{E[Y(z^\ast,m)|x,u]} = \exp[\beta_z(z-z^\ast)]\]
<p>and the controlled indirect effect ratio when the mediator changes from
\(m^\ast\) to \(m\) while keeping the treatment at \(z\):
\[\frac{E[Y(z,m)|x,u]}{E[Y(z,m^\ast)|x,u]} = \exp[\beta_m(m-m^\ast)]\]
</p>
<p><em>Natural effect ratio</em>
</p>
<p>Given a generalized linear model for the expected potential outcomes and
a model for the mediator:
\[f[E(Y(z,M^{z^\ast}|x,u))] = \beta_0 + \beta_zz + \beta_mM^{z^\ast} + \beta_xx
   + u,\]
where \(f\) is a log-link function, \(M^{z^\ast}\) is the potential
mediator under treatment \(z^\ast\), and \(Y(z,M^{z^\ast})\) is
the potential outcome under treatment \(z\) and potential mediator
\(M^{z^\ast}\)
\[h[E(M^{z^\ast}|x,u)] = \alpha_0 + \alpha_zz^\ast + \alpha_xx +
  \alpha_{IV}z^\ast x^{IV} + u,\]
where \(h\) is an identity function for continuous mediators and logit
function for binary mediators; \(\alpha_{IV}\) is the coefficient for
instrumental variables \(x^{IV}\), \(z^\ast x^{IV}\), interaction of randomized
treatment and instrumental variables, and \(M^z\) is the potential mediator
under treatment \(z^\ast\).
Then the natural direct effect ratio is:
\[\frac{E[Y(z,M^{z^\ast})|x,u]}{E[Y(z^\ast,M^{z^\ast}|x,u]} = \exp[\beta_z(z-z^\ast)].\]
And the natural indirect effect ratio with a continuous mediator is:
\[\frac{E[Y(z,M^z)|x,u]}{E[Y(z,M^{z^\ast})|x,u]} = \exp[\beta_m\alpha_z(z-z^\ast)
 + \beta_m\alpha_{IV}x^{IV}(z-z^\ast)].\]
The natural indirect effect ratio with a binary mediator is:
\[\frac{E[Y(z,M^z)|x,u]}{E[Y(z,M^{z^\ast})|x,u]}
  = \frac{P(M^z = 1|x,u)\exp(\beta_m) + P(M^z = 0|x, u)}
  {P(M^{z^\ast} = 1|x,u) \exp(\beta_m) + P(M^{z^\ast} = 0|x, u)}. \]
</p>
<p>The parameters are estimated by the maximized empirical likelihood
estimates, which are solutions to the estimating equations that maximizes
the empirical likelihood. See details in Guo, Z., Small, D.S., Gansky,
S.A., Cheng, J. (2018).
</p>


<h3>Value</h3>

<p><code>mediate_iv</code> returns a list with the following components and
prints them out in a matrix format:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>parameter estimates from optimized profile empirical
log-likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ter, ter.ci</code></td>
<td>
<p>point estimate for total effect ratio
and its bootstrap confidence interval.</p>
</td>
</tr>
</table>
<p>If the interaction between treatment and mediator is not specified, ie,
zm.int=FALSE, a list of additional components are:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>der, der.ci</code></td>
<td>
<p>point estimate for controlled direct effect ratio and
its bootstrap confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>der.nat, der.nat.ci</code></td>
<td>
<p>point estimate for natural direct effect
ratio and its bootstrap confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ier, ier.ci</code></td>
<td>
<p>point estimate for controlled indirect effect ratio
and its bootstrap confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ier.nat, ier.nat.ci</code></td>
<td>
<p>point estimate for natural indirect effect ratio
and its bootstrap confidence interval; They are only applicable to
continuous mediator.</p>
</td>
</tr>
</table>
<p>If the interaction between treatment and mediator is specified, ie,
zm.int=TRUE, which is only supported for binary mediator, a list of
additional components are:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>der.m0, der.m0.ci</code></td>
<td>
<p>point estimate for controlled direct effect ratio
when m = 0 and its bootstrap confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>der.m1, der.m1.ci</code></td>
<td>
<p>point estimate for controlled direct effect ratio
when m = 1 and its bootstrap confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>der.nat.m0, der.nat.m0.ci</code></td>
<td>
<p>point estimate for natural direct effect
ratio when m = 0 and its bootstrap confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>der.nat.m1, der.nat.m1.ci</code></td>
<td>
<p>point estimate for natural direct effect
ratio when m = 1 and its bootstrap confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ier.z0, ier.z0.ci</code></td>
<td>
<p>point estimate for controlled indirect effect
ratio when z = 0 and its bootstrap confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ier.z1, ier.z1.ci</code></td>
<td>
<p>point estimate for controlled indirect effect
ratio when z = 1 and its bootstrap confidence interval.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Nancy Cheng,
<a href="mailto:Nancy.Cheng@ucsf.edu">Nancy.Cheng@ucsf.edu</a>; Zijian Guo,
<a href="mailto:zijguo@stat.rutgers.edu">zijguo@stat.rutgers.edu</a>; Jing Cheng,
<a href="mailto:Jing.Cheng@ucsf.edu">Jing.Cheng@ucsf.edu</a>.
</p>


<h3>References</h3>

<p>Guo, Z., Small, D.S., Gansky, S.A., Cheng, J. (2018), Mediation analysis
for count and zero-inflated count data without sequential ignorability
and its application in dental studies. Journal of the Royal Statistical
Society, Series C.; 67(2):371-394.
</p>
<p>Ismail AI, Ondersma S, Willem Jedele JM, et al. (2011) Evaluation of
a brief tailored motivational intervention to prevent early childhood
caries.
Community Dentistry and Oral Epidemiology 39: 433â€“448.
</p>


<h3>See Also</h3>

<p><code>el.test</code>, <code>BBoptim</code>, <code>spg</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># For illustration purposes a small number of bootstrap iterations are used
data("midvd_bt100")
# The outcome is Poisson distribution
ee &lt;- mediate_iv(y = midvd_bt100$Untreated_W3,
                 z = midvd_bt100$intervention,
                 m = midvd_bt100$PBrush_6, ydist = "poisson",
                 mtype = "binary", x.IV = midvd_bt100$BrushTimes_W2,
                 tol = 0.5, n.init = 1,
                 control = list(maxit = 15, ftol = 0.5, gtol = 0.5,
                                trace = FALSE),
                 sims = 3)

</code></pre>


</div>