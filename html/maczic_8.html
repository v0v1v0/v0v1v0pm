<div class="container">

<table style="width: 100%;"><tr>
<td>plot_sensitivity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot Sensitivity Graph</h2>

<h3>Description</h3>

<p>'plot_sensitivity' performs sensitivity analysis when there is a treatment-
induced mediator-outcome confounder by varying coefficient of treatment in
the confounder model and plots sensitivity graph.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_sensitivity(
  model.u,
  n.beta.u = 10,
  model.m,
  model.y,
  sims = 1000,
  boot = FALSE,
  confounder = "confd.name",
  treat = "treat.name",
  mediator = "med.name",
  covariates = NULL,
  outcome = NULL,
  digits = 3,
  xlab = "Beta.u",
  ylab = "Effect",
  xlim = NULL,
  ylim = NULL,
  main = NULL,
  type = "l",
  col = c("black", "black", "black"),
  pch = NULL,
  lty = c(1, 2, 3),
  legend.x,
  legend.y = NULL,
  legend.inset = 0.05,
  legend = c("Direct Effect", "Mediation Effect", "Total Effect"),
  legend.horiz = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model.u</code></td>
<td>
<p>A fitted model object for confounder. Can be of class 'lm',
'polr', 'bayespolr', 'glm', 'bayesglm', 'gam', 'rq', or 'survreg'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.beta.u</code></td>
<td>
<p>Number of varying coefficient of treatment in the confounder
model. This number is adjusted as n.beta.u + 1 if n.beta.u is an even
number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.m</code></td>
<td>
<p>A fitted model object for mediator. Can be of class 'lm',
'polr', 'bayespolr', 'glm', 'bayesglm', 'gam', 'rq', or 'survreg'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.y</code></td>
<td>
<p>A fitted model object for outcome. Can be of class 'lm',
'polr', 'bayespolr', 'glm', 'bayesglm', 'gam', 'vglm', 'rq', 'survreg',
or 'zeroinfl'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sims</code></td>
<td>
<p>Number of Monte Carlo draws for quasi-Bayesian approximation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot</code></td>
<td>
<p>A logical value. if 'FALSE' a quasi-Bayesian approximation is
used for confidence intervals; if 'TRUE' nonparametric bootstrap will be
used. Default is 'FALSE'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>confounder</code></td>
<td>
<p>A character string indicating the name of the confounder
variable used in the models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treat</code></td>
<td>
<p>A character string indicating the name of the treatment
variable used in the models.  The treatment can be either binary (integer
or a two-valued factor) or continuous (numeric).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mediator</code></td>
<td>
<p>A character string indicating the name of the mediator
variable used in the models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariates</code></td>
<td>
<p>A list or data frame containing values for a subset of the
pre-treatment covariates in 'model.m' and 'model.y'. If provided, the
function will return the estimates conditional on those covariate values.
Default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outcome</code></td>
<td>
<p>A character string indicating the name of the outcome
variable in ‘model.y’. Only necessary if 'model.y' is of class 'survreg';
otherwise ignored.Default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>integer indicating the number of decimal places to round
the values to be returned. Default is 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab</code></td>
<td>
<p>Labels for x and y axes, as in <code>plot</code>.
Default xlab = "Beta.u", ylab = "Effect".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim, ylim</code></td>
<td>
<p>Ranges of x and y axes, as in <code>plot</code>.
The default value, NULL, indicates that the range of the finite values to be
plotted should be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>A main title for the plot, as in <code>plot</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A character string (length 1 vector) or vector of 1-character
strings indicating the type of plot for 3 columns of y, as in
<code>plot</code>. Default is 'l' for lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>A vector of strings indicating the colors for 3 lines of y.
Default is ("black","black","black").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>A vector of plotting characters or symbols, as in
<code>plot</code>. Default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>
<p>A vector of line types, as in <code>plot</code>. Default is
c(1,2,3).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.x, legend.y</code></td>
<td>
<p>The x and y co-ordinates to be used to position
the legend, see x, y in <code>legend</code>. Default legend.y = NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.inset</code></td>
<td>
<p>Inset distance(s) from the margins as a fraction of the
plot region when legend is placed by keyword, as <code>inset</code> in
<code>legend</code>. Default is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>A character or expression vector of 3 to appear in the
legend, as in <code>legend</code>. Default is c("Direct Effect",
"Mediation Effect", "Total Effect")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.horiz</code></td>
<td>
<p>A logical value. If TRUE, set the legend horizontally
Default is FALSE, which sets the legend vertically.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function uses the estimated coefficient of treatment in the
fitted confounder model with observed data (see Cheng et al 2018) as the
middle point (mid.beta.u), and calculates 1 unit change in the coefficient
as |2*mid.beta.u/3/(n-1)| where n = n.beta.u if n.beta.u is an odd number
and n = n.beta.u+1 if n.beta.u is an even number, and n.beta.u is the
number of varying coefficient of treatment specified by users.
<code>mediate_zi_vcoef</code> is then used to estimate average causal
mediation effects (indirect effect), average direct effects, and total
effect for each value of the treatment coefficient in the confounder
model. The function prints all the effect estimates, and produces the
sensitivity graph.
</p>


<h3>Value</h3>

<p><code>plot_sensitivity</code> produces sensitivity graph and returns an
object of data frame with the following columns:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>beta.u</code></td>
<td>
<p>coefficient of treatment in the confounder model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d0, d1</code></td>
<td>
<p>point estimates for average causal mediation effects under
the control and treatment conditions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z0, z1</code></td>
<td>
<p>point estimates for average direct effect under the control
and treatment conditions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d.avg, z.avg</code></td>
<td>
<p>simple averages of d0 and d1, z0 and z1, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau.coef</code></td>
<td>
<p>point estimate for total effect.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Nancy Cheng,
<a href="mailto:Nancy.Cheng@ucsf.edu">Nancy.Cheng@ucsf.edu</a>; Jing Cheng,
<a href="mailto:Jing.Cheng@ucsf.edu">Jing.Cheng@ucsf.edu</a>.
</p>


<h3>References</h3>

<p>Cheng, J., Cheng, N.F., Guo, Z., Gregorich, S., Ismail, A.I.,
Gansky, S.A (2018) Mediation analysis for count and zero-inflated count
data. Statistical Methods in Medical Research. 27(9):2756-2774.
</p>
<p>Ismail AI, Ondersma S, Willem Jedele JM, et al. (2011) Evaluation of
a brief tailored motivational intervention to prevent early childhood
Community Dentistry and Oral Epidemiology 39: 433–448.
</p>


<h3>See Also</h3>

<p><code>mediate_zi_vcoef</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data("midvd_bt100")
uFit &lt;- glm(PDVisit_6 ~ intervention + BrushTimes_W2 + HealthyMeals_W2
                        + PDVisit_W2,
            family = 'binomial', data = midvd_bt100)
mFit &lt;- glm(PBrushBedt_6 ~ intervention + BrushTimes_W2 + HealthyMeals_W2
                           + PBrush_W2 + PDVisit_6,
            family = 'binomial', data = midvd_bt100)
yFit &lt;- zeroinfl(Untreated_W3 ~ intervention + PBrushBedt_6 + BrushTimes_W2
                                + HealthyMeals_W2 + PBrush_W2 + PDVisit_6,
                 data = midvd_bt100)
# For illustration purposes a small number of simulations are used
plot_sensitivity(uFit, n.beta.u = 5, mFit, yFit, sims = 25,
                 treat = "intervention", mediator = "PBrushBedt_6",
                 confounder = "PDVisit_6",
                 main = "Effects on the number of new untreated cavities at 2 years",
                 legend.x = "right")

</code></pre>


</div>