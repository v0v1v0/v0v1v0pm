<div class="container">

<table style="width: 100%;"><tr>
<td>reitsma</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fit the bivariate model of Reitsma et al. (2005) and extensions.
</h2>

<h3>Description</h3>

<p>The function fits the bivariate model of Reitsma et al. (2005) that Harbord et al. (2007) have shown to be equivalent to the HSROC of Rutter&amp;Gatsonis (2001). We specify the model as a linear mixed model with known variances of the random effects, similar to the computational approach by Reitsma et al. (2005). Variance components are estimated by restricted maximum likelihood (REML) as a default but ML estimation is available as well. In addition meta-regression is possible and the use of other transformations than the logit, using the approach of Doebler et al. (2012).
</p>


<h3>Usage</h3>

<pre><code class="language-R">reitsma(data, ...)
## Default S3 method:
reitsma(data = NULL, subset=NULL, formula = NULL,
         TP="TP", FN="FN", FP="FP", TN="TN", 
         alphasens = 1, alphafpr = 1, 
         correction = 0.5, correction.control = "all",
         method = "reml",  
         control = list(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>any object that can be converted to a data frame with integer variables for observed frequencies of true positives, false negatives, false positives and true negatives. The names of the variables  are provided by the arguments <code>TP</code>, <code>FN</code>, <code>FP</code> and <code>TN</code> (see their defaults). Alternatively the data can be a matrix with column names including <code>TP</code>, <code>FN</code>, <code>FP</code> and <code>TN</code>. If no <code>data</code> is specified, the function will check the <code>TP</code>, <code>FN</code>, <code>FP</code> and <code>TN</code> arguments.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TP</code></td>
<td>
<p>character or integer: name for vector of integers that is a variable of <code>data</code> or a vector of integers. If <code>data</code> is not <code>NULL</code>, names are expected, otherwise integers are.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FN</code></td>
<td>
<p>character or integer: name for vector of integers that is a variable of <code>data</code> or a vector of integers. If <code>data</code> is not <code>NULL</code>, names are expected, otherwise integers are.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FP</code></td>
<td>
<p>character or integer: name for vector of integers that is a variable of <code>data</code> or a vector of integers. If <code>data</code> is not <code>NULL</code>, names are expected, otherwise integers are.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TN</code></td>
<td>
<p>character or integer: name for vector of integers that is a variable of <code>data</code> or a vector of integers. If <code>data</code> is not <code>NULL</code>, names are expected, otherwise integers are.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>the rows of <code>data</code> to be used as a subset in all calculations. If <code>NULL</code> (the default) then the complete data is considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>Formula for meta-regression using standard <code>formula</code>. The left hand side of this formula must be <code>cbind(tsens, tfpr)</code> and if <code>formula</code> is <code>NULL</code> (the default), then the formula <code>cbind(tsens, tfpr) ~ 1</code> is used, i.e. a model without covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alphasens</code></td>
<td>
<p>Transformation parameter for (continuity corrected) sensitivities, see details. If set to 1 (the default) the logit transformation is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alphafpr</code></td>
<td>
<p>Transformation parameter for (continuity corrected) false positive rates, see details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correction</code></td>
<td>
<p>numeric, continuity correction applied if zero cells</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correction.control</code></td>
<td>
<p>character, if set to <code>"all"</code> (the default) the continuity correction is added to the whole data if only one cell in one study is zero. If set to <code>"single"</code> the correction is only applied to rows of the data which have a zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>character, either <code>"fixed"</code>, <code>"ml"</code>, <code>"mm"</code>, <code>"vc"</code> or <code>"reml"</code> (the default)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of control parameters, see the documentation of <code>mvmeta</code></p>
</td>
</tr>
</table>
<p>.
</p>
<table><tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments to be passed on to other functions, currently ignored</p>
</td>
</tr></table>
<h3>Details</h3>

<p>In a first step the observed frequencies are continuity corrected if values of 0 or 1 would result for the sensitivity or false positive rate otherwise. Then the sensitivities and false positive rates are transformed using the transformation
</p>
<p style="text-align: center;"><code class="reqn">
x \mapsto t_\alpha(x) := \alpha\log(x) - (2-\alpha)\log(1-x).
</code>
</p>

<p>Note that for <code class="reqn">\alpha=1</code>, the default value, the logit transformation results, i.e. the approach of Reitsma et al. (2005). A bivariate random effects model is then fitted to the pairs of transformed sensitivities and false positive rates.
</p>
<p>Parameter estimation makes use of the fact that the fixed effect parameters can be profiled in the likelihood. Internally the function <code>mvmeta</code> is called. Currently only standard errors for the fixed effects are available. Note that when using <code>method = "mm"</code> or <code>method = "vc"</code>, no likelihood can be computed and hence no AIC or BIC values.
</p>
<p>If you want other summary points like negative or positive likelihood ratios, see <code>SummaryPts</code>, while for positive or negative predictive values, see <code>predv_r</code> and <code>predv_d</code>.
</p>


<h3>Value</h3>

<p>An object of the class <code>reitsma</code> for which many standard methods are available. See <code>reitsma-class</code> for details.
</p>


<h3>Author(s)</h3>

<p>Philipp Doebler &lt;philipp.doebler@googlemail.com&gt;
</p>


<h3>References</h3>

<p>Rutter, C., &amp; Gatsonis, C. (2001). “A hierarchical regression approach to meta-analysis of
diagnostic test accuracy evaluations.” <em>Statistics in Medicine</em>, <b>20</b>, 2865–2884.
</p>
<p>Reitsma, J., Glas, A., Rutjes, A., Scholten, R., Bossuyt, P., &amp; Zwinderman, A. (2005).
“Bivariate analysis of sensitivity and specificity produces informative summary
measures in diagnostic reviews.” <em>Journal of Clinical Epidemiology</em>, <b>58</b>, 982–990.
</p>
<p>Harbord, R., Deeks, J., Egger, M., Whiting, P., &amp; Sterne, J. (2007). “A unification of
models for meta-analysis of diagnostic accuracy studies.” <em>Biostatistics</em>, <b>8</b>, 239–251.
</p>
<p>Doebler, P., Holling, H., Boehning, D. (2012) “A Mixed Model Approach to Meta-Analysis of Diagnostic Studies with Binary Test Outcome.” <em>Psychological Methods</em>, to appear
</p>


<h3>See Also</h3>

<p><code>reitsma-class</code>, <code>talpha</code>, <code>SummaryPts</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(Dementia)
(fit &lt;- reitsma(Dementia))
summary(fit)
plot(fit)

## Meta-Regression
data(smoking) # contains more than one 2x2-table
## reduce to subset of independent 2x2-tables by using the 
## first table from each study only
smoking1 &lt;- subset(smoking, smoking$result_id == 1)
## use type of questionnaire as covariate
(fit &lt;- reitsma(smoking1, formula = cbind(tsens, tfpr) ~ type))
summary(fit) ## sensitivities significantly lower for SAQ
</code></pre>


</div>