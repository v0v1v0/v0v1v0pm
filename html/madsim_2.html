<div class="container">

<table style="width: 100%;"><tr>
<td>madsim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Main function of the package "madsim"</h2>

<h3>Description</h3>

<p>function madsim() allows to generate two biological conditions
synthetic microarray dataset with known characteristics. These data
have similar behavior as those obtained with current microarray
platforms. Hence, they can be used for performance evaluation of data
meta-analysis methods.</p>


<h3>Usage</h3>

<pre><code class="language-R">madsim(mdata = NULL, n = 10000, ratio = 0,
              fparams = data.frame(m1=7,m2=7,shape2=4,lb=4,ub=14,pde=0.02,sym=0.5),
              dparams = data.frame(lambda1=0.13, lambda2=2, muminde=1, sdde=0.5),
              sdn = 0.4, rseed = 50)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mdata</code></td>
<td>
<p> a data frame with numerical values to be used as seed,
its length should be greater than 100. When set to
NULL (default) data generated are fully synthetic:
<code>mdata = NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p> an integer specifying the number of genes in the data generated:
<code>n = 10000</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratio</code></td>
<td>
<p> a flag (0,1) allowing to have log2 intensitie or log2 ratio:
<code>ratio = 0</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fparams</code></td>
<td>
<p> a data frame containing 7 components defining the data
lower (lb) and upper bound (ub), the beta distribution
shape (shape2) parameter, the percentage of differentially
expressed (pde) number of genes and the partition of the
number of down and up regulated (sym) genes:<br><code>fparams=data.frame(m1=7,m2=7,shape2=2,lb=4,ub=14,pde=0.02,sym=0.5)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dparams</code></td>
<td>
<p> a data frame containing 4 components defining how low and
high expressed genes are distributed (lambda1), and
how changes are for DE genes (lambda2, muminde, sdde):<br><code>dparams = data.frame(lambda1=0.13,lambda2=2,muminde=1,sdde=0.5)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdn</code></td>
<td>
<p> a positive scalar used as standard deviation for the
additive gaussian noise: <code>sdn = 0.4</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rseed</code></td>
<td>
<p> an integer used as seed for generating random number
by the computer in use: <code>rseed = 50</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>User provides a subset of parameters. A detailed description of
these parameters is available in the reference given below.
Default parameters settings (in arguments above) can be 
modified.</p>


<h3>Value</h3>

<p>Returned is a data frame containing 3 components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>xdata</code></td>
<td>
<p> a dataset with sizes, the number of rows and columns, specified
by input parameters n and m1+m2, respectively</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xid</code></td>
<td>
<p> a vector of indexes with values are from the set (0, -1, 1).
These values are used for non differentially expressed, down-
and up-regulated genes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xsd</code></td>
<td>
<p> a scalar containing the standard deviation of first
column of the dataset generated</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Doulaye Dembele</p>


<h3>References</h3>

<p>Dembele D. (2013), A Flexible Microarray Data Simulation Model.
Microarrays, 2013, 2(2):115-130</p>


<h3>Examples</h3>

<pre><code class="language-R">    # load a sample of real microarray data
    data(madsim_test)

    # set parameters settings
    mdata &lt;- madsim_test$V1;
    fparams &lt;- data.frame(m1 = 7, m2 = 7, shape2 = 4, lb = 4, ub = 14,pde=0.02,sym=0.5);
    dparams &lt;- data.frame(lambda1 = 0.13, lambda2 = 2, muminde = 1, sdde = 0.5);
    sdn &lt;- 0.4; rseed &lt;- 50;

    # generate fully synthetic data
    mydata1 &lt;- madsim(mdata = NULL, n = 10000, ratio = 0, fparams, dparams, sdn, rseed);

    # use true affymetrix data to generate synthetic data
    mydata2 &lt;- madsim(mdata = madsim_test, n=10000, ratio=0,fparams,dparams,sdn,rseed);

    
    A1 &lt;- 0.5*(mydata1$xdata[,12] + mydata1$xdata[,1]);
    M1 &lt;- mydata1$xdata[,12] - mydata1$xdata[,1];

    A2 &lt;- 0.5*(mydata2$xdata[,12] + mydata2$xdata[,1]);
    M2 &lt;- mydata2$xdata[,12] - mydata2$xdata[,1];

    # draw MA plot using samples 1 and 12
    op &lt;- par(mfrow = c())
       plot(A1,M1)
       plot(A2,M2)
    par(op)
</code></pre>


</div>