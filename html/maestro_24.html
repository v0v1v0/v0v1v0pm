<div class="container">

<table style="width: 100%;"><tr>
<td>run_schedule</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Run a schedule</h2>

<h3>Description</h3>

<p>Given a schedule in a <code>maestro</code> project, runs the pipelines that are scheduled to execute
based on the current time.
</p>


<h3>Usage</h3>

<pre><code class="language-R">run_schedule(
  schedule,
  orch_frequency = "1 day",
  check_datetime = lubridate::now(tzone = "UTC"),
  resources = list(),
  run_all = FALSE,
  n_show_next = 5,
  cores = 1,
  logging = FALSE,
  log_file = NULL,
  log_file_max_bytes = 1e+06,
  quiet = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>schedule</code></td>
<td>
<p>object of type MaestroSchedule created using <code>build_schedule()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>orch_frequency</code></td>
<td>
<p>of the orchestrator, a single string formatted like "1 day", "2 weeks", "hourly", etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check_datetime</code></td>
<td>
<p>datetime against which to check the running of pipelines (default is current system time in UTC)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resources</code></td>
<td>
<p>named list of shared resources made available to pipelines as needed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>run_all</code></td>
<td>
<p>run all pipelines regardless of the schedule (default is <code>FALSE</code>) - useful for testing.
Does not apply to pipes with a <code>maestroSkip</code> tag.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_show_next</code></td>
<td>
<p>show the next n scheduled pipes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cores</code></td>
<td>
<p>number of cpu cores to run if running in parallel. If &gt; 1, <code>furrr</code> is used and
a multisession plan must be executed in the orchestrator (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logging</code></td>
<td>
<p>whether or not to write the logs to a file (default = <code>FALSE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log_file</code></td>
<td>
<p>path to the log file (ignored if <code>logging == FALSE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log_file_max_bytes</code></td>
<td>
<p>numeric specifying the maximum number of bytes allowed in the log file before purging the log (within a margin of error)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>silence metrics to the console (default = <code>FALSE</code>)</p>
</td>
</tr>
</table>
<h3>Details</h3>



<h4>Pipeline schedule logic</h4>

<p>The function <code>run_schedule()</code> examines each pipeline in the schedule table and determines
whether it is scheduled to run at the current time using some simple time arithmetic. We assume
<code>run_schedule(schedule, check_datetime = Sys.time())</code>, but this need not be the case.
</p>



<h4>Output</h4>

<p><code>run_schedule()</code> returns the same MaestroSchedule object with modified attributes. Use <code>get_status()</code>
to examine the status of each pipeline and use <code>get_artifacts()</code> to get any return values from the
pipelines as a list.
</p>



<h4>Pipelines with arguments (resources)</h4>

<p>If a pipeline takes an argument that doesn't include a default value, these can be supplied
in the orchestrator via <code>run_schedule(resources = list(arg1 = val))</code>. The name of the argument
used by the pipeline must match the name of the argument in the list. Currently, each named
resource must refer to a single object. In other words, you can't have two pipes using
the same argument but requiring different values.
</p>



<h4>Running in parallel</h4>

<p>Pipelines can be run in parallel using the <code>cores</code> argument. First, you must run <code>future::plan(future::multisession)</code>
in the orchestrator. Then, supply the desired number of cores to the <code>cores</code> argument. Note that
console output appears different in multicore mode.
</p>



<h3>Value</h3>

<p>MaestroSchedule object
</p>


<h3>Examples</h3>

<pre><code class="language-R">
if (interactive()) {
  pipeline_dir &lt;- tempdir()
  create_pipeline("my_new_pipeline", pipeline_dir, open = FALSE)
  schedule &lt;- build_schedule(pipeline_dir = pipeline_dir)

  # Runs the schedule every 1 day
  run_schedule(
    schedule,
    orch_frequency = "1 day",
    quiet = TRUE
  )

  # Runs the schedule every 15 minutes
  run_schedule(
    schedule,
    orch_frequency = "15 minutes",
    quiet = TRUE
  )
}
</code></pre>


</div>