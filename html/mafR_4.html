<div class="container">

<table style="width: 100%;"><tr>
<td>get_py_MAF_handle</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Utilities to manage Python environment and torch tensors
</h2>

<h3>Description</h3>

<p>Utility initializing a Python environment for running <code>zuko.flows.MAF</code> and retrieving it.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  get_py_MAF_handle(envir, reset=FALSE, torch_device="cpu", GPU_mem=NULL,
                    verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>envir</code></td>
<td>
<p>An environment (in the R sense) initialized as shown in the Examples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reset</code></td>
<td>
<p>Boolean: Whether to reinitialize the Python session or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>torch_device</code></td>
<td>
<p>Character: <code>"cpu"</code>; or a GPU backend, either <code>"cuda"</code> (or <code>"cuda:0"</code>, etc.) or <code>"mps"</code> depending on system capabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GPU_mem</code></td>
<td>
<p>For development purposes (effect is complicated). An amount of (dedicated) GPU memory, in bytes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Boolean. Whether to print some messages or not.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If successful, <code>get_py_MAF_handle</code> returns the modified input environment. 
If sourcing the Python code provided by <span class="pkg">mafR</span> failed (presumably from trying to use an improperly set-up Python environment), the error condition message is returned.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Initialization of Python session:
my_env &lt;- list2env(list(is_set=FALSE),parent = emptyenv())
my_env &lt;- get_py_MAF_handle(my_env, reset=FALSE, torch_device="cpu")
    
if (inherits(my_env,"environment"))  {
    # =&gt; provides access to:
    my_env$torch # Imported Python package (result of reticulate::import("torch"))
    my_env$device # the torch_device
    # and to internal definitions for MAF training 
}
</code></pre>


</div>