<div class="container">

<table style="width: 100%;"><tr>
<td>calCov</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate stationary Gaussian process kernel</h2>

<h3>Description</h3>

<p>Covariance calculations for Gaussian process kernels.
Currently supports matern, rbf, compact1, periodicMatern, generalMatern, and rationalQuadratic kernels.
Can also return m_phi and other additional quantities useful for ODE inference.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calCov(
  phi,
  rInput,
  signrInput,
  bandsize = NULL,
  complexity = 3,
  kerneltype = "matern",
  df,
  noiseInjection = 1e-07
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>the kernel hyper-parameters. See details for hyper-parameter specification for each <code>kerneltype</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rInput</code></td>
<td>
<p>the distance matrix between all time points s and t, i.e., |s - t|</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>signrInput</code></td>
<td>
<p>the sign matrix of the time differences, i.e., sign(s - t)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandsize</code></td>
<td>
<p>size for band matrix approximation. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>complexity</code></td>
<td>
<p>integer value for the complexity of the kernel calculations desired:
</p>

<ul>
<li>
<p> 0 includes C only
</p>
</li>
<li>
<p> 1 additionally includes Cprime, Cdoubleprime, dCdphi
</p>
</li>
<li>
<p> 2 or above additionally includes Ceigen1over, CeigenVec, Cinv, mphi, Kphi, Keigen1over, KeigenVec, Kinv, mphiLeftHalf, dCdphiCube
</p>
</li>
</ul>
<p>See details for their definitions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kerneltype</code></td>
<td>
<p>must be one of <code>matern</code>, <code>rbf</code>, <code>compact1</code>, <code>periodicMatern</code>, <code>generalMatern</code>, <code>rationalQuadratic</code>. See details for the kernel formulae.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>degrees of freedom, for <code>generalMatern</code> and <code>rationalQuadratic</code> kernels only.  Default is <code>df=2.01</code> for <code>generalMatern</code> and <code>df=0.01</code> for <code>rationalQuadratic</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noiseInjection</code></td>
<td>
<p>a small value added to the diagonal elements of C and Kphi for numerical stability</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The covariance formulae and the hyper-parameters <code>phi</code> for the supported kernels are as follows.  Stationary kernels have <code class="reqn">C(s,t) = C(r)</code> where <code class="reqn">r = |s-t|</code> is the distance between the two time points.   Generally, the hyper-parameter <code>phi[1]</code> controls the overall variance level while <code>phi[2]</code> controls the bandwidth.
</p>

<dl>
<dt><code>matern</code></dt>
<dd>
<p> This is the simplified Matern covariance with <code>df = 5/2</code>:
</p>
<p style="text-align: center;"><code class="reqn">C(r) = phi[1] * (1 + \sqrt 5 r/phi[2] + 5r^2/(3 phi[2]^2)) * \exp(-\sqrt 5 r/phi[2])</code>
</p>

</dd>
<dt><code>rbf</code></dt>
<dd>
<p style="text-align: center;"><code class="reqn">C(r) = phi[1] * \exp(-r^2/(2 phi[2]^2))</code>
</p>

</dd>
<dt><code>compact1</code></dt>
<dd>
<p style="text-align: center;"><code class="reqn">C(r) = phi[1] * \max(1-r/phi[2],0)^4 * (4r/phi[2]+1) </code>
</p>

</dd>
<dt><code>periodicMatern</code></dt>
<dd>
<p>Define <code class="reqn">r' =  | \sin(r \pi/phi[3])*2 |</code>.  Then the covariance is given by <code class="reqn">C(r')</code> using the Matern formula.
</p>
</dd>
<dt><code>generalMatern</code></dt>
<dd>
<p style="text-align: center;"><code class="reqn">C(r) = phi[1] * 2^(1-df) / \Gamma(df) * ( \sqrt(2.0 * df) * r / phi[2] )^df * besselK( \sqrt(2.0 * df) * r / phi[2] , df)</code>
</p>

<p>where <code>besselK</code> is the modified Bessel function of the second kind.
</p>
</dd>
<dt><code>rationalQuadratic</code></dt>
<dd>
<p style="text-align: center;"><code class="reqn">C(r) = phi[1] * (1 + r^2/(2 df phi[2]^2))^(-df)</code>
</p>

</dd>
</dl>
<p>The kernel calculations available and their definitions are as follows: 
</p>

<dl>
<dt>C</dt>
<dd>
<p>The covariance matrix corresponding to the distance matrix <code>rInput</code>.</p>
</dd>
<dt>Cprime</dt>
<dd>
<p>The cross-covariance matrix  <code class="reqn">d C(s,t) / ds</code>.</p>
</dd>
<dt>Cdoubleprime</dt>
<dd>
<p>The cross-covariance matrix  <code class="reqn">d^2 C(s,t) / ds dt</code>.</p>
</dd>
<dt>dCdphi</dt>
<dd>
<p>A list with the matrices <code class="reqn">dC / dphi</code> for each element of phi.</p>
</dd>
<dt>Ceigen1over</dt>
<dd>
<p>The reciprocals of the eigenvalues of C.</p>
</dd>
<dt>CeigenVec</dt>
<dd>
<p>Matrix of eigenvectors of C.</p>
</dd>
<dt>Cinv</dt>
<dd>
<p>The inverse of C.</p>
</dd>
<dt>mphi</dt>
<dd>
<p>The matrix <code>Cprime * Cinv</code>.</p>
</dd>
<dt>Kphi</dt>
<dd>
<p>The matrix <code>Cdoubleprime - Cprime * Kinv * t(Cprime)</code>.</p>
</dd>
<dt>Keigen1over</dt>
<dd>
<p>The reciprocals of the eigenvalues of Kphi.</p>
</dd>
<dt>Kinv</dt>
<dd>
<p>The inverse of Kphi.</p>
</dd>
<dt>mphiLeftHalf</dt>
<dd>
<p>The matrix <code>Cprime * CeigenVec</code>.</p>
</dd>
<dt>dCdphiCube</dt>
<dd>
<p><code class="reqn">dC / dphi</code> as a 3-D array, with the third dimension corresponding to the elements of phi.</p>
</dd>
</dl>
<p>If <code>bandsize</code> is a positive integer, additionally CinvBand, mphiBand, and KinvBand are provided in the return list, which are
band matrix approximations to Cinv, mphi, and Kinv with the specified <code>bandsize</code>.
</p>


<h3>Value</h3>

<p>A list containing the kernel calculations included by the value of <code>complexity</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">foo  &lt;- outer(0:40, t(0:40), '-')[, 1, ]
r &lt;- abs(foo)
signr &lt;- -sign(foo)
calCov(c(0.2, 2), r, signr, bandsize = 20, kerneltype = "generalMatern", df = 2.01)

</code></pre>


</div>