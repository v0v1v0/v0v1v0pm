<div class="container">

<table style="width: 100%;"><tr>
<td>plot.magioutput</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate plots from <code>magioutput</code> object</h2>

<h3>Description</h3>

<p>Plots inferred system trajectories or diagnostic traceplots from the output of <code>MagiSolver</code>
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'magioutput'
plot(
  x,
  type = "traj",
  obs = TRUE,
  ci = TRUE,
  ci.col = "skyblue",
  comp.names,
  par.names,
  est = "mean",
  lower = 0.025,
  upper = 0.975,
  sigma = FALSE,
  lp = TRUE,
  nplotcol = 3,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a <code>magioutput</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>string; the default <code>type = "traj"</code> plots inferred trajectories, while setting <code>type = "trace"</code> generates diagnostic traceplots for the MCMC samples of the parameters and log-posterior values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>
<p>logical; if true, points will be added on the plots for the observations when <code>type = "traj"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>logical; if true, credible bands/intervals will be added to the plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.col</code></td>
<td>
<p>string; color to use for credible bands.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comp.names</code></td>
<td>
<p>vector of system component names, when <code>type = "traj"</code>. If provided, should be the same length as the number of system components in <code class="reqn">X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par.names</code></td>
<td>
<p>vector of parameter names, when <code>type = "trace"</code>. If provided, should be the same length as the number of parameters in <code class="reqn">\theta</code>, or the combined length of <code class="reqn">\theta</code> and <code class="reqn">\sigma</code> when <code>sigma = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>
<p>string specifying the posterior quantity to plot as the estimate. Can be "mean", "median", "mode", or "none". Default is "mean", which plots the posterior mean of the MCMC samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>the lower quantile of the credible band/interval, default is 0.025. Only used if <code>ci = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>the upper quantile of the credible band/interval, default is 0.975. Only used if <code>ci = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>logical; if true, the noise levels <code class="reqn">\sigma</code> will be included in the traceplots when <code>type = "trace"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lp</code></td>
<td>
<p>logical; if true, the values of the log-posterior will be included in the traceplots when <code>type = "trace"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nplotcol</code></td>
<td>
<p>the number of subplots per row.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to <code>plot</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Plots the inferred system trajectories (when <code>type = "traj"</code>) or diagnostic traceplots of the parameters and log-posterior (when <code>type = "trace"</code>) from the MCMC samples.
By default, the posterior mean is treated as the estimate of the trajectories and parameters (<code>est = "mean"</code>).
Alternatives are the posterior median (<code>est = "median"</code>, taken component-wise) and the posterior mode (<code>est = "mode"</code>, approximated by the MCMC sample with the highest log-posterior value).
</p>
<p>The default <code>type = "traj"</code> produces plots of the inferred trajectories and credible bands from the MCMC samples, one subplot for each system component.
By default, <code>lower = 0.025</code> and <code>upper = 0.975</code> produces a central 95% credible band when <code>ci = TRUE</code>.
Adding the observed data points (<code>obs = TRUE</code>) can provide a visual assessment of the inferred trajectories.
</p>
<p>Setting <code>type = "trace"</code> generates diagnostic traceplots for the MCMC samples of the system parameters and the values of the log-posterior, which is a useful tool for informally assessing convergence.
In this case, the <code>est</code> and <code>ci</code> options add horizontal lines to the plots that indicate the estimate (in red) and credible interval (in green) for each parameter.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Set up odeModel list for the Fitzhugh-Nagumo equations
fnmodel &lt;- list(
  fOde = fnmodelODE,
  fOdeDx = fnmodelDx,
  fOdeDtheta = fnmodelDtheta,
  thetaLowerBound = c(0, 0, 0),
  thetaUpperBound = c(Inf, Inf, Inf)
)

# Example FN data
data(FNdat)
y &lt;- setDiscretization(FNdat, by = 0.25)

# Create magioutput from a short MagiSolver run (demo only, more iterations needed for convergence)
result &lt;- MagiSolver(y, fnmodel, control = list(nstepsHmc = 20, niterHmc = 500)) 

# Inferred trajectories
plot(result, comp.names = c("V", "R"), xlab = "Time", ylab = "Level")

# Parameter trace plots
plot(result, type = "trace", par.names = c("a", "b", "c", "sigmaV", "sigmaR"), sigma = TRUE)

</code></pre>


</div>