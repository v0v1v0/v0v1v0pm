<div class="container">

<table style="width: 100%;"><tr>
<td>subsums</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sums of submatrices</h2>

<h3>Description</h3>

<p>Returns the sums of submatrices of an array; multidimensional moving
window averaging</p>


<h3>Usage</h3>

<pre><code class="language-R">subsums(a,p,func="sum",wrap=TRUE, pad=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>Array to be analysed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Argument specifying the subarrays to be summed.  If a vector
of length greater than one,
it is assumed to be of length <code>d=length(dim(a))</code>, and is
interpreted to be the dimensions of the subarrays, with
the size of the window's <code class="reqn">n{^{\rm th}}</code> dimension being
<code>a[n]</code>.  If the length of <code>p</code> is one, recycling is used.
</p>
<p>If not a vector, is assumed to be a matrix with <code>d</code> columns, each
row representing the coordinates of the elements to be summed.  See
examples.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>func</code></td>
<td>
<p>Function to be applied over the elements of the moving
window.  Default value of <code>sum</code> gives the sum as used in
<code>is.2x2.correct()</code>;  other choices might be <code>mean</code>,
<code>prod</code>, or <code>max</code>.  
</p>
<p>If <code>sum=""</code>, return the array of dimension
<code>c(dim(a),prod(p))</code> where each hyperplane is a shifted version
of <code>a</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wrap</code></td>
<td>
<p>Boolean, with default value of <code>TRUE</code> meaning to view
array <code>a</code> as a n-dimensional torus.  Thus, if
<code>x=subsums(a,p,wrap=TRUE)</code>, and if <code>dim(a)=c(a_1,...,a_d)</code>
then <code>x[a_1,...,a_d]</code> is the sum of all corner elements of
<code>a</code>.
</p>
<p>If <code>FALSE</code>, do not wrap <code>a</code> and return an array of
dimension <code>dim(a)+p-1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pad</code></td>
<td>
<p>If <code>wrap</code> is <code>TRUE</code>, <code>pad</code> is
the value used   to pad the array with.  Use a “neutral” value here;
for example, if <code>func=sum</code>, then use 0; if <code>max</code>, use
<code class="reqn">-\infty</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The offset is specified so that <code>allsums(a,v)[1,1,...,1]=
    sum(a[1:v[1],1:v[2],...,1:v[n]])</code>, where <code>n=length(dim(a))</code>.
</p>
<p>Function <code>subsums()</code> is used in <code>is.2x2.correct()</code> and
<code>is.diagonally.correct()</code>. 
</p>


<h3>Author(s)</h3>

<p>Robin K. S. Hankin</p>


<h3>Examples</h3>

<pre><code class="language-R">  data(Ollerenshaw)
  subsums(Ollerenshaw,c(2,2))
  subsums(Ollerenshaw[,1:10],c(2,2))
  subsums(Ollerenshaw, matrix(c(0,6),2,2)) # effectively, is.bree.correct()

  # multidimensional example.  
  a &lt;- array(1,c(3,4,2))
  subsums(a,2)             # note that p=2 is equivalent to p=c(2,2,2);
                           # all elements should be identical

  subsums(a,2,wrap=FALSE)  #note "middle" elements &gt; "outer" elements


  #Example of nondefault function:
  x &lt;- matrix(1:42,6,7)
  subsums(x,2,func="max",pad=Inf,wrap=TRUE)  
  subsums(x,2,func="max",pad=Inf,wrap=FALSE)
</code></pre>


</div>