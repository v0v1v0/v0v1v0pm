<div class="container">

<table style="width: 100%;"><tr>
<td>magerr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Error bar plotting
</h2>

<h3>Description</h3>

<p>A function to add x and y error bars to plots. Low and high error bars can be generated.
</p>


<h3>Usage</h3>

<pre><code class="language-R">magerr(x, y, xlo, ylo, xhi = xlo, yhi = ylo, corxy, length = 0.02,
col = 'black', fill = FALSE, poly = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>Numeric vector; x location of data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>Numeric vector; y location of data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlo</code></td>
<td>

<p>Numeric vector; error on the low side for x values. This can be positive or negative- the absolute vaue is used. If length 1, then will be repeated length(<span class="option">x</span>) times.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylo</code></td>
<td>

<p>Numeric vector; error on the low side for y values. This can be positive or negative- the absolute vaue is used. If length 1, then will be repeated length(<span class="option">x</span>) times.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xhi</code></td>
<td>

<p>Numeric vector; error on the high side for x values. This can be positive or negative- the absolute vaue is used. By default this will inherit the xlo value. If length 1, then will be repeated length(<span class="option">x</span>) times.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yhi</code></td>
<td>

<p>Numeric vector; error on the high side for y values. This can be positive or negative- the absolute vaue is used. By default this will inherit the ylo value. If length 1, then will be repeated length(<span class="option">x</span>) times.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corxy</code></td>
<td>

<p>Numeric vector; if this parameter exists then error ellipses will be drawn instead of error bars. It takes the value of the sigma_x sigma_y correlation, i.e. corxy=covxy/(xlo*ylo). If length 1, then will be repeated length(<span class="option">x</span>) times.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>length</code></td>
<td>

<p>Numeric vector; length of error bar ends. If length 1, then will be repeated length(<span class="option">x</span>) times.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>

<p>Either the colour of the error bars or the outline colour of the error ellipses.  If length 1, then will be repeated length(<span class="option">x</span>) times.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill</code></td>
<td>

<p>Logical; if TRUE then the error ellipses will be filled, if FALSE then only the border will be drawn.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>poly</code></td>
<td>

<p>Logical; is FALSE then error bars or ellipses will be drawn, if TRUE then approximate error polygon will be shown instead.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Further arguments to be passed to the <code>arrows</code> / <code>draw.ellipse</code> / <code>polygon</code> functions used to draw the error bars / error ellipses (<span class="option">corxy</span> not missing) / error polygon (<span class="option">poly</span>=TRUE).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note that with <span class="option">poly</span>=TRUE the x values are used igoring any error terms, and the point value y errors are used to define the limits of the polygon, with straight lines joining the points. The <span class="option">col</span> option is used to fill the polygon with a colour (so the default black is probably not a great choice). The <code>polygon</code> function takes the argument <span class="option">border</span> (parsed by dots from the <code>magerr</code> function) to colour the outer lines, so for a more subtle error polygon you might want to use <span class="option">col</span>=lightgrey, <span class="option">border</span>=NA, where NA means no outer border lines are drawn.
</p>


<h3>Value</h3>

<p>Called for the side effect of plotting error bars.
</p>


<h3>Author(s)</h3>

<p>Aaron Robotham
</p>


<h3>See Also</h3>

<p><code>magplot</code>, <code>magaxis</code>, <code>maglab</code>, <code>magmap</code>, <code>magrun</code>, <code>arrows</code>, <code>draw.ellipse</code>, <code>polygon</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Basic x and y errors added to plot
temp=cbind(x=runif(10),y=runif(10),xerr=runif(10,0.05,0.2),yerr=runif(10,0.1,0.3),
corxy=runif(10,-1,1))
magplot(temp[,1:2])
magerr(x=temp[,1],y=temp[,2],xlo=temp[,3],ylo=temp[,4])
# Example of errors on plots wityh log axes
magplot(temp[,1:2],log='xy')
magerr(x=temp[,1],y=temp[,2],xlo=temp[,3],ylo=temp[,4])

#Example of error ellipses

magplot(temp[,1:2])
magerr(x=temp[,1],y=temp[,2],xlo=temp[,3],ylo=temp[,4])
magerr(x=temp[,1],y=temp[,2],xlo=temp[,3],ylo=temp[,4],corxy=temp[,5])

</code></pre>


</div>