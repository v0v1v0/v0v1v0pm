<div class="container">

<table style="width: 100%;"><tr>
<td>magcon</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
2D quantile images and contours
</h2>

<h3>Description</h3>

<p>This function generates pretty images and contours that reflect the 2D quantile levels of the data. This means the user can immediately assess the 2D regime that contains an arbitrary percentage of the data. This function was designed particularly with the output of MCMC posteriors in mind, where visualising the location of the 68% and 95% 2D quantiles for covariant parameters is a necessary part of the post MCMC analysis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">magcon(x, y, h, doim = TRUE, docon = TRUE, dobar = TRUE, ngrid = 100, add = FALSE,
  xlab = '', ylab = '', imcol = c(NA,rev(rainbow(1000, start = 0, end = 2/3))),
  conlevels = c(0.5, pnorm(1) - pnorm(-1), 0.95), barposition = "topright",
  barorient = "v",bartitle = "Contained %", bartitleshift = 0, xlim = NULL, ylim = NULL,
  weights = NULL,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>x values to contour. If x is a two (or more) column matrix or data.frame and y is missing as an argument, then the first column is used for x and the second column for y.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>y values to contour.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>

<p>Smoothing parameter to pass to kde2d. Can take 1 or 2 arguments for x and optionally y smoothing.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>doim</code></td>
<td>

<p>Should an image be generated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>docon</code></td>
<td>

<p>Should contours be overlain.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dobar</code></td>
<td>

<p>Should a magbar colour bar be added describing the image levels (doim must also be true for this to appear).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ngrid</code></td>
<td>

<p>The ngrid to send to kde2d / sm.density to determine the resolution of the smoothing.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>

<p>Should the output of this function be added to the current plot. If FALSE then a new plot is generated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>

<p>Label for x-axis, only used if add=FALSE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>

<p>Label for y-axis, only used if add=FALSE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>imcol</code></td>
<td>

<p>The colour palette to use for the image (this is also sent to magbar).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conlevels</code></td>
<td>

<p>Specific quantile contours to add. Default is for 50%, 68% and 95% contours, i.e. these contours contain that perecentage of the data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>barposition</code></td>
<td>

<p>The position to use for magbar. See magbar help for more details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>barorient</code></td>
<td>

<p>The orientation to use for magbar. See magbar help for more details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bartitle</code></td>
<td>

<p>Title to use for magbar.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bartitleshift</code></td>
<td>

<p>Control of how far the magbar title is shifted away from its default position.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>

<p>The x limits to use for the data. Default of NULL calculates the range based on the provided x data vector. Data will be clipped between the extremes given. If xlim[1]&gt;xlim[2] plotted axes will be flipped compared to default.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>

<p>The y limits to use for the data. Default of NULL calculates the range based on the provided y data vector. Data will be clipped between the extremes given. If ylim[1]&gt;ylim[2] plotted axes will be flipped compared to default.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>

<p>A vector of weights to pass onto sm.density (that does the 2D density estimate). This must be the same length as the x and y vectors if specified.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Other arguments to pass to the <code>contour</code> function, e.g. lty=c(2,1,3).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is particularly designed to assess the output for MCMC posteriors since it highlights the confidence regimes quite clearly. More generally it can show the quantile distributions for any 2D data.
</p>


<h3>Value</h3>

<p>Called for the side effect of generating images and contours representing quantile in 2D data.
</p>


<h3>Author(s)</h3>

<p>Aaron Robotham
</p>


<h3>See Also</h3>

<p><code>magplot</code>, <code>magaxis</code>, <code>maglab</code>, <code>magmap</code>, <code>magrun</code>, <code>magbar</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
temp = cbind(rnorm(1e3),rnorm(1e3))
magcon(temp[,1],temp[,2])

## End(Not run)
</code></pre>


</div>