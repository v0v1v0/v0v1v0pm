<div class="container">

<table style="width: 100%;"><tr>
<td>inference_stan</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Run inference</h2>

<h3>Description</h3>

<p>This function helps you run inference with rstan using a prior object from make_prior.
Note that you must install Stan: <code>install.packages("rstan")</code>, see <a href="https://mc-stan.org/">mc-stan.org</a>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">inference_stan(
  prior_obj,
  use_likelihood = TRUE,
  print_prior = TRUE,
  path = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>prior_obj</code></td>
<td>
<p>An object from make_prior, from makemyprior_gui,
from inference_stan, or from inference_inla (for refitting model)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_likelihood</code></td>
<td>
<p>Whether to sample from the prior only (<code>FALSE</code>, can be used for e.g.
debugging or to look at the priors on variance parameters when using an HD prior, see also Details), or
to use the likelihood and data to get the posterior (<code>TRUE</code>, default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print_prior</code></td>
<td>
<p>Whether to print a text with the chosen prior or not (default <code>TRUE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path</code></td>
<td>
<p>Path to folder. See compile_stan. Only necessary if compiled code is
stored somewhere else than in <code>tempdir()</code> or the package directory (checking <code>tempdir()</code> first).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments to be sent to sampling. Useful arguments include:
</p>

<dl>
<dt><code>iter</code></dt>
<dd>
<p>number of iterations for each chain (including burn-in, 2000 is the default)</p>
</dd>
<dt><code>warmup</code></dt>
<dd>
<p>number of iterations for the burn-in (default is <code>iter</code>/2)</p>
</dd>
<dt><code>chains</code></dt>
<dd>
<p>number of chains</p>
</dd>
<dt><code>init</code></dt>
<dd>
<p>initial value of the model parameters on internal parameterization (log-variances and covariate coefficients)</p>
</dd>
<dt><code>seed</code></dt>
<dd>
<p>seed value for random number generation</p>
</dd>
</dl>
<p>See sampling for more details. Note that for inference with <code>stan</code>, the <code>Ntrials</code> (the size parameter for binomial likelihood) and 
<code>E</code> (the mean E_i in  E_i*exp(eta_i) for Poisson likelihood) argument must be included in the data object, and
cannot be provided to this function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>We cannot sample from a Jeffreys' prior since it is improper.
If <code>use_likelihood = FALSE</code> and Jeffreys' prior is used for the total variance, the prior will be changed to a Gaussian(0,1) prior on
the log total variance. This means that it does not make sense to look at the variances/standard deviations/precisions,
but the variance proportions will be correct. Note that this is only an issue when sampling from the prior
(i.e., not using the likelihood).
</p>


<h3>Value</h3>

<p>A named list with a prior object (<code>prior</code>), a stan-object (<code>stan</code>) and some data stan requires (<code>stan_data</code>).
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 

vignette("make_prior", package = "makemyprior")

## End(Not run)

ex_prior &lt;- makemyprior_example_model()
if (interactive() &amp;&amp; requireNamespace("rstan")){
  posterior &lt;- inference_stan(ex_prior, iter = 100)
  # Note: For reliable results, increase the number of iterations (e.g., 'iter = 2000')
  plot(posterior)
}

## Not run: 

posterior &lt;- inference_stan(ex_prior, use_likelihood = TRUE, iter = 1e4, chains = 1, seed = 1)
plot(posterior)

## End(Not run)


</code></pre>


</div>