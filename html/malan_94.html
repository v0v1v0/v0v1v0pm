<div class="container">

<table style="width: 100%;"><tr>
<td>sample_geneology</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate a geneology with constant population size.</h2>

<h3>Description</h3>

<p>This function simulates a geneology where the last generation has <code>population_size</code> individuals.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sample_geneology(
  population_size,
  generations,
  generations_full = 1L,
  generations_return = 3L,
  enable_gamma_variance_extension = FALSE,
  gamma_parameter_shape = 5,
  gamma_parameter_scale = 1/5,
  progress = TRUE,
  verbose_result = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>population_size</code></td>
<td>
<p>The size of the population.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>generations</code></td>
<td>
<p>The number of generations to simulate:
</p>

<ul>
<li>
<p> -1 for simulate to 1 founder
</p>
</li>
<li>
<p> else simulate this number of generations.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>generations_full</code></td>
<td>
<p>Number of full generations to be simulated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>generations_return</code></td>
<td>
<p>How many generations to return (pointers to) individuals for.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>enable_gamma_variance_extension</code></td>
<td>
<p>Enable symmetric Dirichlet (and disable standard Wright-Fisher).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma_parameter_shape</code></td>
<td>
<p>Parameter related to symmetric Dirichlet distribution for each man's probability to be father. Refer to details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma_parameter_scale</code></td>
<td>
<p>Parameter realted to symmetric Dirichlet distribution for each man's probability to be father. Refer to details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>
<p>Show progress.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose_result</code></td>
<td>
<p>Verbose result.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>By the backwards simulating process of the Wright-Fisher model,
individuals with no descendants in the end population are not simulated.
If for some reason additional full generations should be simulated,
the number can be specified via the <code>generations_full</code> parameter.
This can for example be useful if one wants to simulate the
final 3 generations although some of these may not get (male) children.
</p>
<p>Let <code class="reqn">\alpha</code> be the parameter of a symmetric Dirichlet distribution
specifying each man's probability to be the father of an arbitrary
male in the next generation. When <code class="reqn">\alpha = 5</code>, a man's relative probability
to be the father has 95\
constant 1 under the standard Wright-Fisher model and the standard deviation in
the number of male offspring per man is 1.10 (standard Wright-Fisher = 1).
</p>
<p>This symmetric Dirichlet distribution is implemented by drawing
father (unscaled) probabilities from a Gamma distribution with
parameters <code>gamma_parameter_shape</code> and <code>gamma_parameter_scale</code>
that are then normalised to sum to 1.
To obtain a symmetric Dirichlet distribution with parameter <code class="reqn">\alpha</code>,
the following must be used:
<code class="reqn">`gamma_parameter_shape` = \alpha</code>
and
<code class="reqn">`gamma_parameter_scale` = 1/\alpha</code>.
</p>


<h3>Value</h3>

<p>A malan_simulation / list with the following entries:
</p>

<ul>
<li> <p><code>population</code>. An external pointer to the population.
</p>
</li>
<li> <p><code>generations</code>. Generations actually simulated, mostly useful when parameter <code>generations = -1</code>.
</p>
</li>
<li> <p><code>founders</code>. Number of founders after the simulated <code>generations</code>.
</p>
</li>
<li> <p><code>growth_type</code>. Growth type model.
</p>
</li>
<li> <p><code>sdo_type</code>. Standard deviation in a man's number of male offspring. StandardWF or GammaVariation depending on <code>enable_gamma_variance_extension</code>.
</p>
</li>
<li> <p><code>end_generation_individuals</code>. Pointers to individuals in end generation.
</p>
</li>
<li> <p><code>individuals_generations</code>. Pointers to individuals in last <code>generations_return</code> generation (if <code>generations_return = 3</code>, then individuals in the last three generations are returned).
</p>
</li>
</ul>
<p>If <code>verbose_result</code> is true, then these additional components are also returned:
</p>

<ul>
<li> <p><code>individual_pids</code>. A matrix with pid (person id) for each individual.
</p>
</li>
<li> <p><code>father_pids</code>. A matrix with pid (person id) for each individual's father.
</p>
</li>
<li> <p><code>father_indices</code>. A matrix with indices for fathers.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>sample_geneology_varying_size()</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">sim &lt;- sample_geneology(100, 10)
str(sim, 1)
sim$population
peds &lt;- build_pedigrees(sim$population)
peds

</code></pre>


</div>