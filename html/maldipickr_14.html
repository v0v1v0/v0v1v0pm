<div class="container">

<table style="width: 100%;"><tr>
<td>process_spectra</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Process Bruker MALDI Biotyper spectra <em>à la</em> Strejcek et al. (2018)</h2>

<h3>Description</h3>

<p>Process Bruker MALDI Biotyper spectra <em>à la</em> Strejcek et al. (2018)
</p>


<h3>Usage</h3>

<pre><code class="language-R">process_spectra(
  spectra_list,
  spectra_names = get_spectra_names(spectra_list),
  rds_prefix = deprecated()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>spectra_list</code></td>
<td>
<p>A list of MALDIquant::MassSpectrum objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spectra_names</code></td>
<td>
<p>A tibble::tibble (or data.frame) of sanitized spectra names by default from get_spectra_names. If provided manually, the column <code>sanitized_name</code> will be used to name the spectra.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rds_prefix</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a> Writing to disk as RDS is no longer supported. A character indicating the prefix for the <code>.RDS</code> output files to be written in the <code>processed</code> directory. By default, no prefix are given and thus no files are written.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Based on the original implementation, the function performs the following tasks:
</p>

<ol>
<li>
<p> Square-root transformation
</p>
</li>
<li>
<p> Mass range trimming to 4-10 kDa as they were deemed most determinant by Strejcek et al. (2018)
</p>
</li>
<li>
<p> Signal smoothing using the Savitzky-Golay method and a half window size of 20
</p>
</li>
<li>
<p> Baseline correction with the SNIP procedure
</p>
</li>
<li>
<p> Normalization by Total Ion Current
</p>
</li>
<li>
<p> Peak detection using the SuperSmoother procedure and with a signal-to-noise ratio above 3
</p>
</li>
<li>
<p> Peak filtering. This step has been added to discard peaks with a negative signal-to-noise ratio probably due to being on the edge of the mass range.
</p>
</li>
</ol>
<h3>Value</h3>

<p>A named list of three objects:
</p>

<ul>
<li> <p><code>spectra</code>: a list the length of the spectra list of MALDIquant::MassSpectrum objects.
</p>
</li>
<li> <p><code>peaks</code>: a list the length of the spectra list of MALDIquant::MassPeaks objects.
</p>
</li>
<li> <p><code>metadata</code>: a tibble indicating the median signal-to-noise ratio (<code>SNR</code>) and peaks number for all spectra list (<code>peaks</code>), with spectra names in the <code>name</code> column.
</p>
</li>
</ul>
<h3>Note</h3>

<p>The original R code on which this function is based is accessible at: <a href="https://github.com/strejcem/MALDIvs16S">https://github.com/strejcem/MALDIvs16S</a>
</p>


<h3>References</h3>

<p>Strejcek M, Smrhova T, Junkova P &amp; Uhlik O (2018). “Whole-Cell MALDI-TOF MS versus 16S rRNA Gene Analysis for Identification and Dereplication of Recurrent Bacterial Isolates.” <em>Frontiers in Microbiology</em> 9 <a href="doi:10.3389/fmicb.2018.01294">doi:10.3389/fmicb.2018.01294</a>.
</p>


<h3>See Also</h3>

<p>import_biotyper_spectra and check_spectra for the inputs and merge_processed_spectra for further analysis.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Get an example directory of six Bruker MALDI Biotyper spectra
directory_biotyper_spectra &lt;- system.file(
  "toy-species-spectra",
  package = "maldipickr"
)
# Import the six spectra
spectra_list &lt;- import_biotyper_spectra(directory_biotyper_spectra)
# Transform the spectra signals according to Strejcek et al. (2018)
processed &lt;- process_spectra(spectra_list)
# Overview of the list architecture that is returned
#  with the list of processed spectra, peaks identified and the
#  metadata table
str(processed, max.level = 2)
# A detailed view of the metadata with the median signal-to-noise
#  ratio (SNR) and the number of peaks
processed$metadata
</code></pre>


</div>