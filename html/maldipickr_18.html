<div class="container">

<table style="width: 100%;"><tr>
<td>set_reference_spectra</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Set a reference spectrum for each cluster</h2>

<h3>Description</h3>

<p>Define a high-quality spectra as a representative
spectra of the cluster based on the highest median signal-to-noise ratio
and the number of detected peaks
</p>


<h3>Usage</h3>

<pre><code class="language-R">set_reference_spectra(cluster_df, metadata_df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cluster_df</code></td>
<td>
<p>A tibble of <em>n</em> rows for each spectra produced by delineate_with_similarity function with at least the following columns:
</p>

<ul>
<li> <p><code>name</code>: the rownames of the similarity matrix indicating the spectra names
</p>
</li>
<li> <p><code>membership</code>: integers stating the cluster number to which the spectra belong to. It starts from 1 to <em>c</em>, the total number of clusters.
</p>
</li>
<li> <p><code>cluster_size</code>: integers indicating the total number of spectra in the corresponding cluster.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metadata_df</code></td>
<td>
<p>A tibble of <em>n</em> rows for each spectra produced by the process_spectra function with median signal-to-noise ratio (<code>SNR</code>), peaks number (<code>peaks</code>), and spectra names in the <code>name</code> column.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A merged tibble in the same order as <code>cluster_df</code> with both the columns of <code>cluster_df</code> and <code>metadata_df</code>, as well as a logical column <code>is_reference</code> indicating if the spectrum is the reference spectra of the cluster.
</p>


<h3>See Also</h3>

<p>delineate_with_similarity, pick_spectra
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Get an example directory of six Bruker MALDI Biotyper spectra
# Import the six spectra and
# Transform the spectra signals according to Strejcek et al. (2018)
processed &lt;- system.file(
  "toy-species-spectra",
  package = "maldipickr"
) %&gt;%
  import_biotyper_spectra() %&gt;%
  process_spectra()

# Toy similarity matrix between the six example spectra of
#  three species. The cosine metric is used and a value of
#  zero indicates dissimilar spectra and a value of one
#  indicates identical spectra.
cosine_similarity &lt;- matrix(
  c(
    1, 0.79, 0.77, 0.99, 0.98, 0.98,
    0.79, 1, 0.98, 0.79, 0.8, 0.8,
    0.77, 0.98, 1, 0.77, 0.77, 0.77,
    0.99, 0.79, 0.77, 1, 1, 0.99,
    0.98, 0.8, 0.77, 1, 1, 1,
    0.98, 0.8, 0.77, 0.99, 1, 1
  ),
  nrow = 6,
  dimnames = list(
    c(
      "species1_G2", "species2_E11", "species2_E12",
      "species3_F7", "species3_F8", "species3_F9"
    ),
    c(
      "species1_G2", "species2_E11", "species2_E12",
      "species3_F7", "species3_F8", "species3_F9"
    )
  )
)
# Delineate clusters based on a 0.92 threshold applied
#  to the similarity matrix
clusters &lt;- delineate_with_similarity(
  cosine_similarity,
  threshold = 0.92
)

# Set reference spectra with the toy example
set_reference_spectra(clusters, processed$metadata)
</code></pre>


</div>