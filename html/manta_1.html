<div class="container">

<table style="width: 100%;"><tr>
<td>AS204</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Algorithm AS 204</h2>

<h3>Description</h3>

<p>Distribution of a positive linear combination of <code class="reqn">\chi^2</code> random variables.
</p>


<h3>Usage</h3>

<pre><code class="language-R">AS204(
  c,
  lambda,
  mult = rep(1, length(lambda)),
  delta = rep(0, length(lambda)),
  maxit = 1e+05,
  eps = 1e-14,
  mode = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p>value point at which distribution is to be evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>the weights <code class="reqn">\lambda_j</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mult</code></td>
<td>
<p>the multiplicities <code class="reqn">m_j</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>the non-centrality parameters <code class="reqn">\delta^2_j</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>the maximum number of terms <code class="reqn">K</code> (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>the desired level of accuracy.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p>if "<code>mode</code>" &gt; 0 then <code class="reqn">\beta=mode\lambda_{min}</code>,
otherwise <code class="reqn">\beta=2/(1/\lambda_{min}+1/\lambda_{max})</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Algorithm AS 204 evaluates the expression
</p>
<p style="text-align: center;"><code class="reqn">
P [X &lt; c] = P [ \sum_{j=1}^n \lambda_j \chi^2(m_j, \delta^2_j) &lt; c ]
</code>
</p>

<p>where <code class="reqn">\lambda_j</code> and <code class="reqn">c</code> are positive constants and 
<code class="reqn">\chi^2(m_j, \delta^2_j)</code> represents an independent <code class="reqn">\chi^2</code> 
random variable with <code class="reqn">m_j</code> degrees of freedom and non-centrality
parameter <code class="reqn">\delta^2_j</code>. This can be approximated by the truncated series 
</p>
<p style="text-align: center;"><code class="reqn">
\sum_{k=0}^{K-1} a_k P [\chi^2(m+2k) &lt; c/\beta]
</code>
</p>
 
<p>where <code class="reqn">m = \sum_{j=1}^n m_j</code> and <code class="reqn">\beta</code> is an arbitrary constant 
(as given by argument "mode"). 
</p>
<p>The <code>C++</code> implementation of algorithm AS 204 used here is identical 
to the one employed by the <code>farebrother</code> method
in the <code>CompQuadForm</code> package, with minor modifications.
</p>


<h3>Value</h3>

<p>The function returns the probability <code class="reqn">P[X &gt; c] = 1 - P[X &lt; c]</code> 
if the AS 204 fault indicator is 0 (see Note below), and <code>NULL</code> if 
the fault indicator is 4, 5 or 9, as the corresponding faults can be
corrected by increasing "<code>eps</code>". Other faults raise an error.
</p>


<h3>Note</h3>

<p>The algorithm AS 204 defines the following fault indicators:
<strong>-j)</strong> one or more of the constraints <code class="reqn">\lambda_j &gt; 0</code>, 
<code class="reqn">m_j &gt; 0</code> and <code class="reqn">\delta^2_j \ge 0</code> is not satisfied.
<strong>1)</strong> non-fatal underflow of <code class="reqn">a_0</code>.
<strong>2)</strong> one or more of the constraints <code class="reqn">n &gt; 0</code>, 
<code class="reqn">c &gt; 0</code>, <code class="reqn">maxit &gt; 0</code> and <code class="reqn">eps &gt; 0</code> is not satisfied.
<strong>3)</strong> the current estimate of the probability is &lt; -1.
<strong>4)</strong> the required accuracy could not be obtained in <code class="reqn">maxit</code> iterations.
<strong>5)</strong> the value returned by the procedure does not satisfy 
<code class="reqn">0 \le P [X &lt; c] \le 1</code>.
<strong>6)</strong> the density of the linear form is negative.
<strong>9)</strong> faults 4 and 5.
<strong>10)</strong> faults 4 and 6. 
<strong>0)</strong> otherwise.
</p>


<h3>Author(s)</h3>

<p>Diego Garrido-Mart√≠n
</p>


<h3>References</h3>

<p>P. Duchesne, P. Lafaye de Micheaux, Computing the distribution of quadratic forms: 
Further comparisons between the Liu-Tang-Zhang approximation and exact methods, 
Computational Statistics and Data Analysis, Vol. 54, (2010), 858-862 
</p>
<p>Farebrother R.W., Algorithm AS 204: The distribution of a Positive Linear Combination 
of chi-squared random variables, Journal of the Royal Statistical Society, 
Series C (applied Statistics), Vol. 33, No. 3 (1984), 332-339
</p>


<h3>See Also</h3>

<p>farebrother
</p>


</div>