<div class="container">

<table style="width: 100%;"><tr>
<td>do_mc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Monte Carlo Estimates for
'indirect_effects' and
'cond_indirect_effects'</h2>

<h3>Description</h3>

<p>Generate Monte Carlo
estimates to be used by
<code>cond_indirect_effects()</code>,
<code>indirect_effect()</code>, and
<code>cond_indirect()</code>,
</p>


<h3>Usage</h3>

<pre><code class="language-R">do_mc(
  fit,
  R = 100,
  seed = NULL,
  parallel = TRUE,
  ncores = max(parallel::detectCores(logical = FALSE) - 1, 1),
  make_cluster_args = list(),
  progress = TRUE
)

gen_mc_est(fit, R = 100, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>The output of
<code>lavaan::sem()</code>.
It can also be
a <code>lavaan.mi</code> object
returned by
<code>semTools::runMI()</code> or
its wrapper, such as <code>semTools::sem.mi()</code>.
The output of
<code>stats::lm()</code> is not supported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>The number of replications.
Default is 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>The seed for the
generating Monte Carlo estimates.
Default is <code>NULL</code> and seed is not set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>Not used. Kept
for compatibility with <code>do_boot()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>Not used. Kept
for compatibility with <code>do_boot()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>make_cluster_args</code></td>
<td>
<p>Not used. Kept
for compatibility with <code>do_boot()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>
<p>Logical. Display
progress or not. Default is <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>It uses the parameter
estimates and their variance-covariance
matrix to generate Monte Carlo
estimates of the parameter estimates
in a model fitted by
<code>lavaan::sem()</code>. The stored estimates
can then be used by
<code>cond_indirect_effects()</code>,
<code>indirect_effect()</code>, and
<code>cond_indirect()</code> to form
Monte Carlo confidence intervals.
</p>
<p>It also supports a model estimated
by multiple imputation using
<code>semTools::runMI()</code> or its wrapper,
such as <code>semTools::sem.mi()</code>.
The pooled estimates and their
variance-covariance matrix will be used
to generate the Monte Carlo estimates.
</p>
<p>This approach removes the need to
repeat Monte Carlo simulation in
each call to
<code>cond_indirect_effects()</code>,
<code>indirect_effect()</code>, and
<code>cond_indirect()</code>. It also ensures
that the same set of Monte Carlo
estimates is used in all subsequent
analysis.
</p>


<h4>Multigroup Models</h4>

<p>Since Version 0.1.14.2, support for
multigroup models has been added for models
fitted by <code>lavaan</code>.
</p>



<h3>Value</h3>

<p>A <code>mc_out</code>-class object
that can be used for the <code>mc_out</code>
argument of
<code>cond_indirect_effects()</code>,
<code>indirect_effect()</code>, and
<code>cond_indirect()</code> for forming
Monte Carlo confidence intervals. The
object is a list with the number of
elements equal to the number of
Monte Carlo replications. Each element
is a
list of the parameter estimates and
sample variances and covariances of
the variables in each Monte Carlo
replication.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>do_mc()</code>: A general purpose function for
creating Monte Carlo estimates to be reused
by other functions. It returns a
<code>mc_out</code>-class object.
</p>
</li>
<li> <p><code>gen_mc_est()</code>: Generate Monte Carlo
estimates and store them in the <code>external</code>
slot: <code>external$manymome$mc</code>. For advanced
users.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>fit2mc_out()</code>, which
implements the Monte Carlo simulation.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(lavaan)
data(data_med_mod_ab1)
dat &lt;- data_med_mod_ab1
mod &lt;-
"
m ~ x + w + x:w + c1 + c2
y ~ m + w + m:w + x + c1 + c2
"
fit &lt;- sem(mod, dat)
# In real research, R should be 5000 or even 10000
mc_out &lt;- do_mc(fit, R = 100, seed = 1234)
wlevels &lt;- mod_levels(w = "w", fit = fit)
wlevels
out &lt;- cond_indirect_effects(wlevels = wlevels,
                             x = "x",
                             y = "y",
                             m = "m",
                             fit = fit,
                             mc_ci = TRUE,
                             mc_out = mc_out)
out

</code></pre>


</div>