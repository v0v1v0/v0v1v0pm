<div class="container">

<table style="width: 100%;"><tr>
<td>stehman2014</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Thematic map accuracy and area under stratified random sampling when the strata differ from 
the map classes.</h2>

<h3>Description</h3>

<p>Implements the estimators described in Stehman (2014) for overall accuracy, producer's 
accuracy, user's accuracy, and area. Includes precision estimates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">stehman2014(s, r, m, Nh_strata, margins = TRUE, order)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>character vector. Strata class labels. The object will be coerced to factor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>character vector. Reference class labels. The object will be coerced to factor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>character vector. Map class labels. The object will be coerced to factor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nh_strata</code></td>
<td>
<p>numeric vector. Number of pixels forming each stratum. It must be named (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margins</code></td>
<td>
<p>logical. If <code>FALSE</code>, the error matrix produced includes no margins (sum of the 
rows and columns).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>(optional) character vector. Classes to be displayed in the results and their sequence.
If missing, equal to <code>sort(unique(c(r,m)))</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Argument <code>Nh_strata</code> must be named to explicitly and clearly identify the stratum that 
each entry refers to. The names of <code>Nh_strata</code> are expected to match the strata class 
labels of argument <code>s</code>.
</p>
<p>In the error matrix returned, the entries corresponding to no observed cases will present
<code>NA</code> rather than 0. This is to emphasize the difference between the absence of cases
and the presence of some (few) cases that represent a very small proportion of area (almost
zero) and thus possibly rounded to zero. However, <code>NA</code> means zero proportion of area.
</p>


<h3>Value</h3>

<p>A list with the estimates and error matrix.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>OA</code></td>
<td>
<p>overall accuracy</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>UA</code></td>
<td>
<p>user's accuracy</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PA</code></td>
<td>
<p>producer's accuracy</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>area</code></td>
<td>
<p>area proportion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SEoa</code></td>
<td>
<p>standard error of OA</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SEua</code></td>
<td>
<p>standard error of UA</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SEpa</code></td>
<td>
<p>standard error of PA</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SEa</code></td>
<td>
<p>standard error of area proportion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>matrix</code></td>
<td>
<p>confusion error (area proportion). Rows and columns represent map and reference class labels, respectively</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Hugo Costa
</p>


<h3>References</h3>

<p>Stehman, S. V. (2014). Estimating area and map accuracy for stratified random sampling when the strata are different from the map classes. <em>Int. J. Remote Sens.</em>, 35, 4923-4939.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Numerical example in Stheman (2014)
s&lt;-c(rep("A",10), rep("B",10), rep("C",10), rep("D",10))
m&lt;-c(rep("A",7), rep("B",3), "A", rep("B",11), rep("C",6), "B", "B", rep("D",10))
r&lt;-c(rep("A",5), "C", "B", "A", "B", "C", "A", rep("B",5), "A", "A", "B", 
     "B", rep("C",5), "D", "D", "B", "B", "A", rep("D",7), "C", "C", "B")
Nh_strata&lt;-c(40000, 30000, 20000, 10000)
names(Nh_strata)&lt;-c("A", "B", "C", "D")
e&lt;-stehman2014(s, r, m, Nh_strata)

e$area[1]                  # Proportion of area of class A (compare with paper in p. 4932)
e$area[3]                  # Proportion of area of class C (p. 4932)
e$OA                       # Overall accuracy (p. 4932)
e$UA[2]                    # User's accuracy of class B (compare with paper in p. 4934)
e$PA[2]                    # Producer's accuracy of class B (p. 4934)
e$matrix[2,3]              # Cell (2, 3) of the error matrix (p. 4935)
e$SEa[1]                   # Standard error (SE) for proportion of area of class A (p. 4935)
e$SEa[3]                   # Standard error (SE) for proportion of area of class C (p. 4935)
e$SEoa                     # SE for overall accuracy (p. 4936)
e$SEua[2]                  # SE for user's accuracy of class B (p. 4936)
e$SEpa[2]                  # SE for producer's accuracy of class B (p. 4936)

# change class order
stehman2014(s, r, m, Nh_strata, order=c("D","C","B","A"))

# the number (and name) of strata and map classes may differ
s&lt;-c(rep("a",5), rep("aa",5), rep("b",10), rep("c",10), rep("d",10))
Nh_strata&lt;-c("a"=20000, "aa"=20000, "b"=30000, "c"=20000, "d"=10000)
stehman2014(s, r, m, Nh_strata)

# m (map) may include classes not found in r (reference)
m&lt;-c(rep("A",7), rep("B",3), "A", rep("B",11), rep("C",6), "B", "B", rep("D",9), "XX")
stehman2014(s, r, m, Nh_strata)

# r (reference) may include classes not found in m (map)
m&lt;-c(rep("A",7), rep("B",3), "A", rep("B",11), rep("C",6), "B", "B", rep("D",10))
r&lt;-c(rep("A",5), "C", "B", "A", "B", "C", "A", rep("B",5), "A", "A", "B",
     "B", rep("C",5), "D", "D", "B", "B", "A", rep("D",7), "C", "C", "YY")
stehman2014(s, r, m, Nh_strata)

# can add classes not found neither in r nor m
stehman2014(s, r, m, Nh_strata, order=c("A","B","C","D","YY","ZZ"))
</code></pre>


</div>