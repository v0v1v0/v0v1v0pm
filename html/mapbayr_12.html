<div class="container">

<table style="width: 100%;"><tr>
<td>augment.mapbayests</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute full PK profile prediction from mapbayr estimates.</h2>

<h3>Description</h3>

<p>Compute full PK profile prediction from mapbayr estimates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'mapbayests'
augment(
  x,
  data = NULL,
  start = NULL,
  end = NULL,
  delta = NULL,
  ci = FALSE,
  ci_width = 90,
  ci_method = "delta",
  ci_sims = 500,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A <code>mapbayests</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>dataset to pass to mrgsolve for simulation (default is dataset used for estimation)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start, end, delta</code></td>
<td>
<p>start, end and delta of simulation time passed to <code>mrgsim()</code> (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>a logical. If TRUE, compute a confidence interval around the prediction (default is FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci_width</code></td>
<td>
<p>a number between 0 and 100, width of the confidence interval (default is "90" for a 90%CI)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci_method</code></td>
<td>
<p>method to compute the confidence interval. Can be "delta" (the default) to use the Delta approximation. Alternatively "simulations" for a more accurate approach, but also more time-consuming.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci_sims</code></td>
<td>
<p>number of replicates to simulate in order to derive the confidence interval (default is 500)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments passed to <code>mrgsim()</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is called in the background by <code>plot()</code> in order to simulate the full PK profile, and return a <code>mapbayests</code> object with an additional <code>aug_tab</code> data.frame inside. The latter is used with by the plot method.
The time grid, for each PK profile (i.e. patient) is defaulted with the minimum time in the dataset for <code>start</code> and the maximum time in the dataset +20% for <code>end</code>. <code>delta</code> is a power of 10 (e.g. 0.1, 1, 10 etc...), automatically chosen to render visually appealing graphs with a reasonable computing time (about 200 time points).
Additional arguments can be passed to <code>mrgsim()</code> through <code>...</code>. Note that <code>recsort</code> is set to 3 (see mrgsolve documentation for more details).
</p>


<h3>Value</h3>

<p>a <code>mapbayests</code> object, augmented of an <code>aug_tab</code> data.frame.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#x is the result of `mapbayest()`.
#Default plot is returned by:
# plot(x)
#Argument passed to `plot()` are passed to `augment()` in the background:
# plot(x, end = 240, ci = TRUE)
#Save the augmented object if simulation time is long
# x2 &lt;- augment(x, ci = TRUE, ci_method = "simulations", ci_sims = 10000) %&gt;%
# plot(x2)

</code></pre>


</div>