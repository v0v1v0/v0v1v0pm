<div class="container">

<table style="width: 100%;"><tr>
<td>data_helpers</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Data helpers: functions to build the dataset</h2>

<h3>Description</h3>

<p>Use <code>adm_rows()</code>, <code>obs_rows()</code> and <code>add_covariates()</code> to create or modify a dataset from scratch, from a pre-existing dataset, or from a dataset stored into a 'mrgsolve' model.
</p>


<h3>Details</h3>

<p>Instead of importing a '.csv' file, or painfully build a data set with a call to <code>data.frame()</code> and mind how to format the data, you can pass information about:
</p>

<ul>
<li>
<p> administrations with <code>adm_rows()</code>,
</p>
</li>
<li>
<p> observations with <code>obs_rows()</code>,
</p>
</li>
<li>
<p> covariates with <code>add_covariates()</code>,
</p>
</li>
</ul>
<p>all being called jointly with a pipe (<code style="white-space: pre;">⁠%&gt;%⁠</code> or <code style="white-space: pre;">⁠|&gt;⁠</code>).
These functions can be used to create or modify a dataset as a proper data.frame, or to create or modify a dataset within a 'mrgsolve' model (<code style="white-space: pre;">⁠@args$data⁠</code> slot).
The latter is particularly useful in order to:
</p>

<ul>
<li>
<p> automatically use default administration and observation compartments,
</p>
</li>
<li>
<p> automatically duplicate rows if there are several depot compartments,
</p>
</li>
<li>
<p> automatically set <code>rate = -2</code> if model has zero-order absorption pathways,
</p>
</li>
<li>
<p> automatically duplicate rows if concentrations of Parent drug and Metabolite are observed together,
</p>
</li>
<li>
<p> automatically add "Amount Of Last Administration" and "Time Of Last Administration" variables if these are covariates,
</p>
</li>
<li>
<p> subsequently call <code>mrgsim()</code> or <code>mapbayest()</code>.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">library(magrittr)
# First option: work with a data.frame

adm_rows(amt = 1000, cmt = 1, addl = 4, ii = 12) %&gt;%
  obs_rows(time = c(12.3, 45.6), DV = c(.111, .222), cmt = 2) %&gt;%
  obs_rows(time = 48, cmt = 2) %&gt;%
  add_covariates(BW = 90, SEX = 0, TOLA = TRUE)

# You can even inform "time" using date and hours:
adm_rows(amt = 1000, cmt = 1, addl = 4, ii = 12, .datehour = "2022-01-01 11:11:11") %&gt;%
  obs_rows(.datehour = "2022-01-02 22:22:22", DV = 0.111, cmt = 2)

# Second option: work with a dataset within a 'mrgsolve' model

mod &lt;- exmodel(add_exdata = FALSE)
# call `mrgsolve::see(mod)` to see how default compartment were coded
adm_cmt(mod)
obs_cmt(mod)

mod %&gt;%
  adm_rows(amt = 10000) %&gt;%
  obs_rows(time = c(1.5, 4.4, 7.5, 24.6), DV = c(91.2904, 110.826, 79.384, 20.6671)) %&gt;%
  # get_data() # for curiosity, you can extract the data set at this step
  mapbayest()


</code></pre>


</div>