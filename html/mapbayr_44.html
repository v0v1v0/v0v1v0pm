<div class="container">

<table style="width: 100%;"><tr>
<td>mapbayr_vpc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Visual Predicted Checks</h2>

<h3>Description</h3>

<p>Visual Predicted Checks
</p>


<h3>Usage</h3>

<pre><code class="language-R">mapbayr_vpc(
  x,
  data = NULL,
  nrep = 500,
  pcvpc = TRUE,
  idv = "time",
  stratify_on = NULL,
  start = NULL,
  end = NULL,
  delta = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the model object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>NMTRAN-like data set</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrep</code></td>
<td>
<p>a numeric, the number of replicates for stochastic simulations. Default is 500.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pcvpc</code></td>
<td>
<p>a logical, if <code>TRUE</code> (the default) will output "prediction-corrected VPC" (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idv</code></td>
<td>
<p>a character indicating the variable used as independent variable. Default is "time", alternatively use "tad" to automatically compute the time after last dose.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stratify_on</code></td>
<td>
<p>a character (vector) indicating the variables of the data used to stratify the results. Variables must be numeric (as they are passed to <code>mrgsolve::carry_out()</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start, end, delta, ...</code></td>
<td>
<p>passed to <code>mrgsolve::mrgsim()</code></p>
</td>
</tr>
</table>
<h3>Details</h3>


<ul><li>
<p> Prediction-corrected VPC
</p>
</li></ul>
<p>By default, VPC are prediction corrected (Bergstrand et al (2011) <a href="https://doi.org/10.1208/s12248-011-9255-z">doi:10.1208/s12248-011-9255-z</a>).
This correction is advised if several levels of doses or covariates are in the dataset for instance.
Note that the implemented correction formula does not take into account the 'lower bound' term (<em>lbij</em>), nor the log-transformed variables.
</p>


<h3>Value</h3>

<p>a <code>ggplot</code> object, results of the VPC. The median and the 50%, 80% and 90% prediction intervals of the simulated distributions are reported.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(mrgsolve)
library(magrittr)
# Define a model. Adding variability to house model because default is 0.
mod &lt;- house() %&gt;%
  omat(dmat(rep(0.2,4)))

# Creating dataset for the example
# Same concentration, but different dose (ID 2) and covariate (ID 3)
data &lt;- adm_rows(ID = 1, amt = 1000, cmt = 1, addl = 6, ii = 12) %&gt;%
  obs_rows(DV = 50, cmt = 2, time = 7 * 12) %&gt;%
  adm_rows(ID = 2, time = 0, amt = 2000, cmt = 1, addl = 6, ii = 12) %&gt;%
  obs_rows(DV = 50, cmt = 2, time = 7 * 12) %&gt;%
  adm_rows(ID = 3, time = 0, amt = 1000, cmt = 1, addl = 6, ii = 12) %&gt;%
  obs_rows(DV = 50, cmt = 2, time = 7 * 12) %&gt;%
  add_covariates(SEX = c(0,0,0,0,1,1))

mapbayr_vpc(mod, data, nrep = 30) # prediction-corrected by default
mapbayr_vpc(mod, data, idv = "tad", start = 72, nrep = 30)
mapbayr_vpc(mod, data, pcvpc = FALSE, nrep = 30)
mapbayr_vpc(mod, data, stratify_on = "SEX", nrep = 30)
</code></pre>


</div>