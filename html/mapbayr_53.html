<div class="container">

<table style="width: 100%;"><tr>
<td>obs_rows</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Add observation lines to a dataset</h2>

<h3>Description</h3>

<p>The <code>obs_rows()</code> function adds an one or several observation lines to a dataset provided as a proper data.frame or within a 'mrgsolve' model. Used in combination with <code>adm_rows()</code> and <code>add_covariates()</code>, it helps the creation of datasets in the proper format for simulations with 'mrgsolve' or parameter estimation with 'mapbayr', as explained in data_helpers.
</p>


<h3>Usage</h3>

<pre><code class="language-R">obs_rows(x, ...)

## S3 method for class 'data.frame'
obs_rows(
  x,
  ID = NULL,
  time = NULL,
  evid = 0L,
  cmt,
  DV = NA_real_,
  mdv = NULL,
  .datehour = NULL,
  ...
)

## S3 method for class 'missing'
obs_rows(...)

## S3 method for class 'mrgmod'
obs_rows(x, cmt = NULL, DV = NA_real_, DVmet = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>either a data.frame or a 'mrgsolve' model object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional columns</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ID</code></td>
<td>
<p>subject ID (default is 1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>event time. Default is 0 if no previous events. Mind consistency with <code>.datehour</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>evid</code></td>
<td>
<p>event identification (default is 1 for administration, 0 for observation)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cmt</code></td>
<td>
<p>compartment (no default, except if <code style="white-space: pre;">⁠[OBS]⁠</code> was tagged in the <code style="white-space: pre;">⁠$CMT⁠</code> block in model code. See <code>examples</code>.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DV</code></td>
<td>
<p>dependent value, i.e. observed concentration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mdv</code></td>
<td>
<p>missing dependent value (default is 0 a non-missing concentration value to take into account for parameter estimation, 1 otherwise)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.datehour</code></td>
<td>
<p>a object of class POSIXct, a number or a character vector that can be passed to <code>parse_datehour()</code>. Using <code>.datehour</code> will update the value of <code>time</code> in the dataset, with units in hours. Mind consistency with the <code>time</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DVmet</code></td>
<td>
<p>second observation at the same time (e.g. a metabolite, "DVmet") observed jointly with parent drug ("DV"). Works only if <code>x</code> is a 'mrgsolve' model where two <code style="white-space: pre;">⁠[OBS]⁠</code> compartments were defined (see <code>examples</code>)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a data.frame, or a 'mrgsolve' model with a dataset in the <code style="white-space: pre;">⁠@args$data⁠</code> slot (accessible with <code>get_data()</code>).
</p>


<h3>See Also</h3>

<p>data_helpers
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Create a dataset from scratch
obs_rows(time = 12, DV = 0.12, cmt = 2)

# Pipe-friendly addition of observation record to a pre-existing dataset
library(magrittr)
obs_rows(time = 12, DV = 0.12, cmt = 2) %&gt;%
  obs_rows(time = c(24, 36, 48), DV = c(0.34, 0.56, 0.78), mdv = c(0, 1, 0), cmt = 2)

# Inform times using the `.datehour` argument:
obs_rows(.datehour = "2020-01-01 11:11", DV = 0.12, cmt = 1) %&gt;%
  obs_rows(.datehour = "2020-01-02 22:22", DV = 0.34, cmt = 1) %&gt;%
  obs_rows(time = 48, DV = 0.56, cmt = 1)

# Start from a 'mrgsolve' model
library(mrgsolve)
house() %&gt;%
  obs_rows(time = 12, DV = 0.12, cmt = 2) %&gt;%
  obs_rows(time = c(24, 36, 48), DV = c(0.34, 0.56, 0.78), mdv = c(0, 1, 0), cmt = 2) %&gt;%
  mrgsim()

# Default observation compartments
# Set default observation compartments in the code with `[OBS]`
model &lt;- mcode("model", "
$CMT @annotated
DEPOT : Depot
CENTR : Central [OBS]
", compile = FALSE)
obs_cmt(model)

# Thus, no need to manually specify `cmt = 2` anymore.
model %&gt;%
  obs_rows(time = 12, DV = 0.12) %&gt;%
  obs_rows(time = c(24, 36, 48), DV = c(0.34, 0.56, 0.78), mdv = c(0, 1, 0)) %&gt;%
  get_data()

# Automatic lines duplication if parent + metabolite defined in the model
model &lt;- mcode("model", "
$CMT @annotated
DEPOT : Depot
CENTR : Central [OBS]
PERIPH : Periph
METABO : Metabo [OBS]
", compile = FALSE)
obs_cmt(model)

model %&gt;%
  obs_rows(time = 12, DV = 0.12, DVmet = 120) %&gt;%
  obs_rows(
    time = c(24, 36, 48), DV = c(0.34, 0.56, 0.78),
    mdv = c(0, 1, 0), DVmet = c(340, 560, 780)
  ) %&gt;%
  get_data()
</code></pre>


</div>