<div class="container">

<table style="width: 100%;"><tr>
<td>use_posterior</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Use posterior estimation</h2>

<h3>Description</h3>

<p>Use posterior estimation
</p>


<h3>Usage</h3>

<pre><code class="language-R">use_posterior(
  x,
  update_omega = FALSE,
  update_cov = TRUE,
  update_eta = TRUE,
  .zero_re = NULL,
  simplify = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A <code>mapbayests</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>update_omega</code></td>
<td>
<p>Update the OMEGA matrix with the variance-covariance matrix of estimation (a logical, default is <code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>update_cov</code></td>
<td>
<p>Update the values of covariates with the individual values (a logical, default is <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>update_eta</code></td>
<td>
<p>Update the values of ETA with the final estimates (a logical, default is <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.zero_re</code></td>
<td>
<p>Set all elements of the OMEGA or SIGMA matrix to zero. Default is "both" if <code>update_omega</code> is FALSE, "sigma" otherwise. (possible values are "both", "sigma", "omega", "none")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simplify</code></td>
<td>
<p>a logical. If TRUE (the default) and only one ID, one mrgmod is returned instead of a list of length 1</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function takes the results of an estimation (i.e. a <code>mapbayests</code> object) and return a modified <code>mrgmod</code> in order to perform <em>a posteriori</em> simulations. Modifications are:
</p>

<ul>
<li>
<p> If <code>update_eta</code> is <code>TRUE</code>, the values of ETA are updated to the estimated values (instead of 0) in $PARAM.
</p>
</li>
<li>
<p> If <code>update_cov</code> is <code>TRUE</code>, the covariates values are updated to the values of the individual (instead of default model values) in $PARAM.
</p>
</li>
<li>
<p> If <code>update_omega</code> is <code>TRUE</code>, the values of OMEGA are updated with the variance-covariance matrix of estimation (i.e. an approximation of the <em>a posteriori</em> distribution) instead of the inter-individual variability (i.e. the <em>a priori</em> distribution). Use this command in order to derive a confidence interval of concentrations that reflects the uncertainty about parameter estimation when a large number of profiles are simulated. Note that if inter-individual variability was initially defined in multiple $OMEGA blocks in the model, they will be collapsed to a single full matrix (this is irreversible).
</p>
</li>
<li>
<p> Depending on the values of <code>.zero_re</code>, the elements of $OMEGA or $SIGMA can be set to zero, whether you want to simulate one profile, or several in order to derive confidence/prediction intervals.
It does not handle time-varying covariates: only the first value will be used as the individual value.
</p>
</li>
</ul>
<h3>Value</h3>

<p>a mrgmod, or a list of mrgmod if there is more than 1 ID
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(magrittr)
est &lt;- mapbayest(exmodel())
est %&gt;%
  use_posterior() %&gt;%
  mrgsolve::ev(amt = 50000) %&gt;%
  mrgsolve::mrgsim()

</code></pre>


</div>