<div class="container">

<table style="width: 100%;"><tr>
<td>mb_matrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Retrieve a matrix of travel times from the Mapbox Directions API</h2>

<h3>Description</h3>

<p>Retrieve a matrix of travel times from the Mapbox Directions API
</p>


<h3>Usage</h3>

<pre><code class="language-R">mb_matrix(
  origins,
  destinations = NULL,
  profile = "driving",
  fallback_speed = NULL,
  output = c("duration", "distance"),
  duration_output = c("minutes", "seconds"),
  access_token = NULL,
  depart_at = NULL,
  allow_large_matrix = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>origins</code></td>
<td>
<p>The input coordinates of your request. Acceptable inputs include a list of
coordinate pair vectors in <code>c(x, y)</code> format or an <code>sf</code> object.
For sf linestrings or polygons, the distance between centroids will be taken.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>destinations</code></td>
<td>
<p>The destination coordinates of your request. If <code>NULL</code> (the default), a many-to-many matrix using <code>origins</code> will be returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>profile</code></td>
<td>
<p>One of "driving" (the default), "driving-traffic", "walking", or "cycling".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fallback_speed</code></td>
<td>
<p>A value expressed in kilometers per hour used to estimate travel time when a route cannot be found between locations. The returned travel time will be based on the straight-line estimate of travel between the locations at the specified fallback speed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>one of <code>"duration"</code> (the default), which will be measured in either minutes or seconds (depending on the value of <code>duration_output</code>), or <code>"distance"</code>, which will be returned in meters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>duration_output</code></td>
<td>
<p>one of <code>"minutes"</code> (the default) or <code>"seconds"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>access_token</code></td>
<td>
<p>A Mapbox access token (required)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>depart_at</code></td>
<td>
<p>(optional) For the "driving" or "driving-traffic" profiles, the departure date and time to reflect historical traffic patterns. If "driving-traffic" is used, live traffic will be mixed in with historical traffic for dates/times near to the current time. Should be specified as an ISO 8601 date/time, e.g. <code>"2023-03-31T09:00"</code>. The time must be set to the current time or in the future.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allow_large_matrix</code></td>
<td>
<p><code>mb_matrix()</code> will prevent the user from calculating large travel-time matrices (greater than 25x25) by default, as they may lead to unexpected charges.  If the user sets this argument to <code>TRUE</code>, <code>mb_matrix()</code> will bypass this error and calculate the large matrix for the user.  Defaults to <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An R matrix of source-destination travel times.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 

library(mapboxapi)
library(tigris)
library(mapdeck)

philly_tracts &lt;- tracts("PA", "Philadelphia", cb = TRUE, class = "sf")
downtown_philly &lt;- mb_geocode("Philadelphia City Hall, Philadelphia PA")

time_to_downtown &lt;- mb_matrix(philly_tracts, downtown_philly)

philly_tracts$time &lt;- time_to_downtown

mapdeck(style = mapdeck_style("light")) %&gt;%
  add_polygon(
    data = philly_tracts,
    fill_colour = "time",
    fill_opacity = 0.6,
    legend = TRUE
  )

## End(Not run)

</code></pre>


</div>