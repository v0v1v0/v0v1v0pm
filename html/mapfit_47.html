<div class="container">

<table style="width: 100%;"><tr>
<td>phfit.density</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>PH fitting with density function</h2>

<h3>Description</h3>

<p>Estimates PH parameters from density function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">phfit.density(
  ph,
  f,
  deformula = deformula.zeroinf,
  weight.zero = 1e-12,
  weight.reltol = 1e-08,
  start.divisions = 8,
  max.iter = 12,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ph</code></td>
<td>
<p>An object of R6 class. The estimation algorithm is selected depending on this class.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>A function object for a density function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deformula</code></td>
<td>
<p>An object for formulas of numerical integration.
It is not necessary to change it when the density function is defined on
the positive domain [0,infinity).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight.zero</code></td>
<td>
<p>A absolute value which is regarded as zero in numerical integration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight.reltol</code></td>
<td>
<p>A value for precision of numerical integration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.divisions</code></td>
<td>
<p>A value for starting value of divisions in deformula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.iter</code></td>
<td>
<p>A value for the maximum number of iterations to increase divisions in deformula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Options for EM steps, which is also used to send the arguments to density function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list with components, which is an object of S3 class <code>phfit.result</code>;
</p>
<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>an object for estimated PH class.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>llf</code></td>
<td>
<p>a value of the maximum log-likelihood (a negative value of the cross entropy).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>a value of degrees of freedom of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>KL</code></td>
<td>
<p>a value of Kullback-Leibler divergence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>the number of iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>a logical value for the convergence of estimation algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ctime</code></td>
<td>
<p>computation time (user time).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an object for data class</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aerror</code></td>
<td>
<p>a value of absolute error for llf at the last step of algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rerror</code></td>
<td>
<p>a value of relative error for llf at the last step of algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>options</code></td>
<td>
<p>a list of options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Any of density function can be applied to the argument <code>f</code>, where
<code>f</code> should be defined <code>f &lt;- function(x, ...)</code>.
The first argument of <code>f</code> should be an integral parameter.
The other parameters are set in the argument <code>...</code> of <code>phfit.density</code>.
The truncated density function can also be used directly.
</p>


<h3>Examples</h3>

<pre><code class="language-R">####################
##### truncated density
####################

## PH fitting for general PH
(result1 &lt;- phfit.density(ph=ph(2), f=dnorm, mean=3, sd=1))

## PH fitting for CF1
(result2 &lt;- phfit.density(ph=cf1(2), f=dnorm, mean=3, sd=1))

## PH fitting for hyper Erlang
(result3 &lt;- phfit.density(ph=herlang(3), f=dnorm, mean=3, sd=1))

## mean
ph.mean(result1$model)
ph.mean(result2$model)
ph.mean(result3$model)

## variance
ph.var(result1$model)
ph.var(result2$model)
ph.var(result3$model)

## up to 5 moments 
ph.moment(5, result1$model)
ph.moment(5, result2$model)
ph.moment(5, result3$model)

</code></pre>


</div>