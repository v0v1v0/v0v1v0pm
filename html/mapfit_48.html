<div class="container">

<table style="width: 100%;"><tr>
<td>phfit.group</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>PH fitting with grouped data</h2>

<h3>Description</h3>

<p>Estimates PH parameters from grouped data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">phfit.group(ph, counts, breaks, intervals, instants, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ph</code></td>
<td>
<p>An object of R6 class. The estimation algorithm is selected depending on this class.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>counts</code></td>
<td>
<p>A vector of the number of points in intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>
<p>A vector for a sequence of points of boundaries of intervals.
This is equivalent to <code>c(0,cumsum(intervals))</code>.
If this is missing, it is assigned to <code>0:length(counts)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intervals</code></td>
<td>
<p>A vector of time lengths for intervals.
This is equivalent to <code>diff(breaks)</code>).
If this is missing, it is assigned to <code>rep(1,length(counts))</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>instants</code></td>
<td>
<p>A vector of integers to indicate whether sample is drawn at
the last of interval. If instant is 1, a sample is drawn at the last of interval.
If instant is 0, no sample is drawn at the last of interval.
By using instant, point data can be expressed by grouped data.
If instant is missing, it is given by <code>rep(0L,length(counts))</code>, i.e.,
there are no samples at the last of interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further options for EM steps.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list with components, which is an object of S3 class <code>phfit.result</code>;
</p>
<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>an object for estimated PH class.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>llf</code></td>
<td>
<p>a value of the maximum log-likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>a value of degrees of freedom of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aic</code></td>
<td>
<p>a value of Akaike information criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>the number of iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>a logical value for the convergence of estimation algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ctime</code></td>
<td>
<p>computation time (user time).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an object for data class</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aerror</code></td>
<td>
<p>a value of absolute error for llf at the last step of algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rerror</code></td>
<td>
<p>a value of relative error for llf at the last step of algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>options</code></td>
<td>
<p>a list of options used in the fitting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>In this method, we can handle truncated data using <code>NA</code> and <code>Inf</code>;
<code>phfit.group(ph=cf1(5), counts=c(countsdata, NA), breaks=c(breakdata, +Inf))</code>
<code>NA</code> means missing of count data at the corresponding interval, and <code>Inf</code> is allowed to put
the last of breaks or intervals which represents a special interval [the last break point,infinity).
</p>


<h3>Examples</h3>

<pre><code class="language-R">## make sample
wsample &lt;- rweibull(n=100, shape=2, scale=1)
wgroup &lt;- hist(x=wsample, breaks="fd", plot=FALSE)

## PH fitting for general PH
(result1 &lt;- phfit.group(ph=ph(2), counts=wgroup$counts, breaks=wgroup$breaks))

## PH fitting for CF1
(result2 &lt;- phfit.group(ph=cf1(2), counts=wgroup$counts, breaks=wgroup$breaks))

## PH fitting for hyper Erlang
(result3 &lt;- phfit.group(ph=herlang(3), counts=wgroup$counts, breaks=wgroup$breaks))

## mean
ph.mean(result1$model)
ph.mean(result2$model)
ph.mean(result3$model)

## variance
ph.var(result1$model)
ph.var(result2$model)
ph.var(result3$model)

## up to 5 moments 
ph.moment(5, result1$model)
ph.moment(5, result2$model)
ph.moment(5, result3$model)

</code></pre>


</div>