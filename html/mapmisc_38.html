<div class="container">

<table style="width: 100%;"><tr>
<td>openmap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Download map tiles</h2>

<h3>Description</h3>

<p>Downloads map tiles from Openstreetmap.org and other servers.
</p>


<h3>Usage</h3>

<pre><code class="language-R">	openmap(x, zoom, 
	  path="http://tile.openstreetmap.org/",
	  maxTiles = 9, 
	  crs=ifelse(is.numeric(x), mapmisc::crsLL, terra::crs(x)),   
	  buffer=0, fact=1, 
		verbose=getOption('mapmiscVerbose'),
	  cachePath=getOption('mapmiscCachePath'),
	  suffix=NULL
)

	osmTiles(name, xyz, suffix)

	openmapAttribution(name, 
	  type=c('text','latex','markdown','html', 'auto'), 
	  short=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>An a spatial object  
from which an extent and crs can be obtained.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zoom	</code></td>
<td>

<p>the zoom level, when missing it will be determined by maxTiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path</code></td>
<td>
	
<p>Source of map tiles, see <a href="http://diseasemapping.r-forge.r-project.org/mapLayers.html">http://diseasemapping.r-forge.r-project.org/mapLayers.html</a>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxTiles</code></td>
<td>
	
<p>If zoom is missing, zoom will be chosen such that the 
number of map tiles is less than or equl to this number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crs</code></td>
<td>
<p>Projection for the output, defaulting to the same projection as
<code>x</code>.  If <code>x</code> has no projection, 
for instance when <code>x</code> is a matrix or extent, 
<code>crs</code> is also used as the projection of <code>x</code>.  If <code>crs</code> is <code>NA</code> or missing and <code>x</code> has no crs, long-lat is used.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>buffer</code></td>
<td>
<p>Extend the extent for which the map is requested, in units
of <code>x</code>.  Can be negative, or a vector of length 2 for different x and y 
extensions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fact</code></td>
<td>
<p>Passed to increase or decrease resolution, values above 1
help to produce a clearer image.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>Print information about map images being downloaded, defaults to <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cachePath</code></td>
<td>
<p>Location to store downloaded map images, defaults to <code>tempdir()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>name of a tile path, if missing a vector of all available tile paths
is returned.  <code>name</code> can be any of the names of the vector returned when 
<code>name</code> is unspecified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>format for the attribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>short</code></td>
<td>
<p>short or long attribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xyz</code></td>
<td>
<p>format of xyz coordinates in URL's</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>suffix</code></td>
<td>
<p>string to append to URL's, i.e. <code>'.png'</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These functions download, display, and manipulate map tiles stored in a
standard way either on a web server or a local folder.
</p>
<p>Map tiles are a set of PNG images that span the world at a set of zoom
levels. Zoom level 1 has four 256x256 pixel tiles
in a 2x2 pattern over the whole world. In general, zoom level n has <code class="reqn">2^n</code>
by <code class="reqn">2^n</code> tiles. Zoom levels go up to about 17 or 18 depending on the tile
server.
</p>
<p>See <a href="https://mc.bbbike.org/mc/">https://mc.bbbike.org/mc/</a> for a more possible map tiles (not all of which are compatible with openmap)
</p>
<p>Be sure to attribute any maps you publish, the <code>osmAttribution</code> function will assist.  If <code>type = 'auto'</code> then markdown format will be used unless a variable <code>mdToTex</code> is defined and equal to <code>TRUE</code>.
</p>


<h3>Value</h3>

<p><code>openmap</code> returns a <code>SpatRaster</code> with indexed colours or RGB layers.
</p>
<p><code>openmapAttribution</code> returns a character string.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data("netherlands")
nldTiles = terra::unwrap(nldTiles)
plot(nldTiles)

openmapAttribution('osm', short=TRUE, type='markdown')

openmapAttribution("stamen-watercolor", type='text')


myraster = rast(matrix(1:100,10,10),extent=ext(8, 18, 0, 10), crs=crsLL)

myPoints = as.points(myraster)[seq(1, ncell(myraster), len=12)]

names(osmTiles())


	mytiles = try(openmap(myraster, zoom=5, verbose=TRUE))

oldpar =	map.new(myraster)
	plot(mytiles, add=TRUE)
	points(myPoints,col='red')

	myPoints = project(myPoints, crsMerc)
	map.new(myPoints)

	mytiles = try(openmap(myPoints,
		path='https://livemap-tiles1.waze.com/tiles', verbose=TRUE, buffer=5))
	plot(mytiles, add=TRUE)

	points(myPoints, col='red')

par(oldpar)


</code></pre>


</div>