<div class="container">

<table style="width: 100%;"><tr>
<td>mapmixture</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot Pie Charts on Map</h2>

<h3>Description</h3>

<p>Plot admixture proportions as pie charts on a projected map.
In data sets where there are multiple individuals per site,
the function will calculate the mean average admixture proportion for each site.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mapmixture(
  admixture_df,
  coords_df,
  cluster_cols = NULL,
  cluster_names = NULL,
  boundary = NULL,
  crs = 4326,
  basemap = NULL,
  pie_size = 1,
  pie_border = 0.2,
  pie_border_col = "black",
  pie_opacity = 1,
  land_colour = "#d9d9d9",
  sea_colour = "#deebf7",
  expand = FALSE,
  arrow = TRUE,
  arrow_size = 1,
  arrow_position = "tl",
  scalebar = TRUE,
  scalebar_size = 1,
  scalebar_position = "tl",
  plot_title = "",
  plot_title_size = 12,
  axis_title_size = 10,
  axis_text_size = 8,
  basemap_border = TRUE,
  basemap_border_col = "black",
  basemap_border_lwd = 0.1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>admixture_df</code></td>
<td>
<p>data.frame or tibble containing admixture data (see examples).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coords_df</code></td>
<td>
<p>data.frame or tibble containing coordinates data (see examples).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster_cols</code></td>
<td>
<p>character vector of colours the same length as the number of clusters.
If <code>NULL</code>, a blue-green palette is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster_names</code></td>
<td>
<p>character vector of names the same length as the number of clusters.
If <code>NULL</code>, the cluster column names are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boundary</code></td>
<td>
<p>named numeric vector defining the map bounding. e.g. <code>c(xmin=-15, xmax=15, ymin=30, ymax=50)</code>.
If <code>NULL</code>, a default bounding box is calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crs</code></td>
<td>
<p>coordinate reference system. Default is the WGS 84 - World Geodetic System 1984 (EPSG:<code>4326</code>).
See <code>?sf::st_crs</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basemap</code></td>
<td>
<p>SpatRaster or sf object to use as the basemap. A SpatRaster object can be created from a file
using the <code>terra::rast()</code> function. A sf object can be created from a file
using the <code>sf::st_read()</code> function. If <code>NULL</code>, world country boundaries are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pie_size</code></td>
<td>
<p>numeric value of zero or greater.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pie_border</code></td>
<td>
<p>numeric value of zero or greater.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pie_border_col</code></td>
<td>
<p>string denoting colour of pie border.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pie_opacity</code></td>
<td>
<p>numeric value of zero to one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>land_colour</code></td>
<td>
<p>string defining the colour of land.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sea_colour</code></td>
<td>
<p>string defining the colour of sea.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expand</code></td>
<td>
<p>expand axes (<code>TRUE</code> or <code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arrow</code></td>
<td>
<p>show arrow (<code>TRUE</code> or <code>FALSE</code>). Added using the <code>ggspatial::annotation_north_arrow()</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arrow_size</code></td>
<td>
<p>numeric value of zero or greater.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arrow_position</code></td>
<td>
<p>string defining the position of the arrow (<code>"tl"</code>, <code>"tr"</code>, <code>"bl"</code>, <code>"br"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scalebar</code></td>
<td>
<p>show scalebar (<code>TRUE</code> or <code>FALSE</code>). Added using the <code>ggspatial::annotation_scale()</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scalebar_size</code></td>
<td>
<p>numeric value of zero or greater.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scalebar_position</code></td>
<td>
<p>string defining the position of the scalebar (<code>"tl"</code>, <code>"tr"</code>, <code>"bl"</code>, <code>"br"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_title</code></td>
<td>
<p>string defining the main title of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_title_size</code></td>
<td>
<p>numeric value of zero or greater.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis_title_size</code></td>
<td>
<p>numeric value of zero or greater.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis_text_size</code></td>
<td>
<p>numeric value of zero or greater.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basemap_border</code></td>
<td>
<p>boolean denoting whether to show basemap polygon borders.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basemap_border_col</code></td>
<td>
<p>string defining colour of basemap polygon borders.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basemap_border_lwd</code></td>
<td>
<p>numeric value defining linewidth of basemap polygon borders.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A ggplot object.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Admixture Format 1
file &lt;- system.file("extdata", "admixture1.csv", package = "mapmixture")
admixture1 &lt;- read.csv(file)

# Admixture Format 2
file &lt;- system.file("extdata", "admixture2.csv", package = "mapmixture")
admixture2 &lt;- read.csv(file)

# Admixture Format 3
file &lt;- system.file("extdata", "admixture3.csv", package = "mapmixture")
admixture3 &lt;- read.csv(file)

# Coordinates Format
file &lt;- system.file("extdata", "coordinates.csv", package = "mapmixture")
coordinates &lt;- read.csv(file)

# Plot using default parameters
mapmixture(admixture1, coordinates)

# Plot using the ETRS89-extended / LAEA Europe coordinate reference system
mapmixture(admixture1, coordinates, crs = 3035)

# Plot using custom parameters
mapmixture(
  admixture_df = admixture1,
  coords_df = coordinates,
  cluster_cols = c("#f1a340","#998ec3"),
  cluster_names = c("Group 1","Group 2"),
  crs = "+proj=merc +a=6378137 +b=6378137 +lat_ts=0 +lon_0=0 +x_0=0 +y_0=0 +units=m",
  boundary = c(xmin=-15, xmax=16, ymin=40, ymax=62),
  pie_size = 1.5,
  pie_border = 0.2,
  pie_opacity = 1,
  land_colour = "#d9d9d9",
  sea_colour = "#deebf7",
  expand = FALSE,
  arrow = TRUE,
  arrow_size = 1,
  arrow_position = "tl",
  scalebar = TRUE,
  scalebar_size = 1,
  scalebar_position = "tl",
  plot_title = "Mapmixture Figure",
  plot_title_size = 15,
  axis_title_size = 12,
  axis_text_size = 10
)
</code></pre>


</div>