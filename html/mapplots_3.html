<div class="container">

<table style="width: 100%;"><tr>
<td>barplot2D</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Draw 2-dimensional barplots 
</h2>

<h3>Description</h3>

<p>This function is used by <code>draw.barplot2D</code> to add a 2-dimensional barplot at a specific location to an existing plot. It can be used directly but in general it is advisable to use <code>draw.barplot2D</code> instead.
</p>


<h3>Usage</h3>

<pre><code class="language-R">barplot2D(z, x = 0, y = 0, width = 1, height = 1, colour, add = TRUE, col.frame = NULL, 
	lwd.frame = 1, threshold = 1.1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>

<p>vector, containing positive numbers (NAs are discarded), to be used as the area of the rectangles 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colour</code></td>
<td>

<p>a vector (same length as <code>z</code>) of colors to be used in filling the rectangles
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>

<p>the location of the centre of the pie on the x and y-scale of the existing plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width, height</code></td>
<td>

<p>the width and height of the 2D barplot (user coordinate units).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>

<p>logical, should the 2D barplot be added to an existing plot&gt; Defaults to TRUE
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.frame</code></td>
<td>

<p>the colour of the frame of the 2D barplot
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd.frame</code></td>
<td>

<p>the line width of the frame of the 2D barplot
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>

<p>the maximum acceptable aspect ratio of the rectangles 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>arguments to be passed to <code>polygon</code>
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The algorithm that determines the location of each rectangle within the 2D-barplot is as follows: 1) Start with a rectangle representing the highest value of <code>z</code>. 2) Try to put the first rectangle on the left. 3) If it too elongated, try to put two rectangles, on top of each other, on the left. 4) When you have placed those rectangles, proceed with the remaining rectangles.
</p>
<p>More precisely, we choose the number of rectables to stack so as to minimize the following penalty: penalty for the first rectangle in the stack + penalty for the last where the penalty of a rectangle is: <code>ratio - 1.1</code>. where <code>ratio</code> is the ratio of the longer side by the smaller.
</p>


<h3>Author(s)</h3>

<p>Adapted by Hans Gerritsen
</p>


<h3>References</h3>

<p>This function was adapted from code pulbished on <a href="http://zoonek2.free.fr/UNIX/48_R/03.html">http://zoonek2.free.fr/UNIX/48_R/03.html</a> (accessed 1 Jun 2012).
</p>


<h3>See Also</h3>

<p><code>draw.barplot2D</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">plot(NA,NA, xlim=c(-1,1), ylim=c(-1,1) )
barplot2D(z=rpois(6,10), x=-0.5, y=0.5, width=0.75, height=0.75, colour=rainbow(6))
barplot2D(z=rpois(4,10), x=0.5, y=-0.5, width=0.5, height=0.5, colour=rainbow(4))
</code></pre>


</div>