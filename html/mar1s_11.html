<div class="container">

<table style="width: 100%;"><tr>
<td>seasonal.smooth</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Smooth Seasonal Component of Time Series </h2>

<h3>Description</h3>

<p>Extracts seasonal component of time series by fitting the data with a
linear combination of smooth periodic functions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">seasonal.smooth(x, basis = create.fourier.basis(nbasis = 3), lambda = 0, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>A univariate time series.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basis</code></td>
<td>

<p>A functional basis object (see <code>basisfd</code>). By
default, use a linear combination of <code>const</code>,
<code>sin((2*pi)*t)</code> and <code>cos((2*pi)*t)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>

<p>A nonnegative number specifying the amount of smoothing. By default,
apply no additional smoothing.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Not currently used.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Although it is possible to specify arbitrary functional basis object,
the function will only work properly if the basis is periodical on the
unit interval. It is recommended to use a Fourier basis with default
period (<code>create.fourier.basis</code>).
</p>
<p>Positive values of <code>lambda</code> imply a restriction on roughness of
the result. The more the value, the more smooth result is; see
<code>smooth.basis</code> for more detailed description.
</p>


<h3>Value</h3>

<p>A time series object with times from 0 to 1 and the same frequency as
<code>x</code>. The smoothing functional data object is stored in attribute
<code>fd</code>.
</p>


<h3>See Also</h3>

<p><code>smooth.basisPar</code>, <code>fd</code> for
functional data objects, <code>seasonal.ave</code> for alternative
seasonal extraction method.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(19860306)

## Artificial example
x &lt;- ts(sin(2*pi*(3:97)/10) + 0.5*rnorm(length(3:97)),
	start = c(0, 3), frequency = 10)

fourier3 &lt;- seasonal.smooth(x)
fourier9 &lt;- seasonal.smooth(x, create.fourier.basis(nbasis = 9))
fourier9s&lt;- seasonal.smooth(x, create.fourier.basis(nbasis = 9), 1E-6)

plot.default(time(x)%%1, x, xlab = "Phase")
points(fourier3, pch = 20,  col = "blue")
lines(attr(fourier3, "fd"), col = "blue")
points(fourier9, pch = 20,  col = "green")
lines(attr(fourier9, "fd"), col = "green")
points(fourier9s,pch = 20,  col = "red")
lines(attr(fourier9s, "fd"),col = "red")
legend("bottomleft",
       legend = c("Fourier-3 basis",
		  "Fourier-9 basis",
		  "Fourier-9 basis, smooth"),
       col = c("blue", "green", "red"),
       lty = "solid")

## Realistic example
data(nesterov.index, package = "mar1s")
x &lt;- log(nesterov.index[, "mean"])
x[x &lt; -10] &lt;- -Inf

fourier3 &lt;- seasonal.smooth(x)
fourier9 &lt;- seasonal.smooth(x, create.fourier.basis(nbasis = 9))
fourier9s&lt;- seasonal.smooth(x, create.fourier.basis(nbasis = 9), 2E-5)

plot.default(time(x)%%1, x, xlab = "Phase", pch = ".")
lines(attr(fourier3, "fd"), col = "blue")
lines(attr(fourier9, "fd"), col = "green")
lines(attr(fourier9s,"fd"), col = "red")
legend("topleft",
       legend = c("Fourier-3 basis",
		  "Fourier-9 basis",
		  "Fourier-9 basis, smooth"),
       col = c("blue", "green", "red"),
       lty = "solid")
</code></pre>


</div>