<div class="container">

<table style="width: 100%;"><tr>
<td>marble</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>fit a robust Bayesian variable selection model for G×E interactions.</h2>

<h3>Description</h3>

<p>fit a robust Bayesian variable selection model for G×E interactions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">marble(
  X,
  Y,
  E,
  clin,
  max.steps = 10000,
  robust = TRUE,
  sparse = TRUE,
  debugging = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>the matrix of predictors (genetic factors). Each row should be an observation vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>the continuous response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E</code></td>
<td>
<p>a matrix of environmental factors. E will be centered. The interaction terms between X (genetic factors) and E will be automatically created and included in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clin</code></td>
<td>
<p>a matrix of clinical variables. Clinical variables are not subject to penalty. Clinical variables will be centered and a column of 1 will be added to the Clinical matrix as the intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.steps</code></td>
<td>
<p>the number of MCMC iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>
<p>logical flag. If TRUE, robust methods will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sparse</code></td>
<td>
<p>logical flag. If TRUE, spike-and-slab priors will be used to shrink coefficients of irrelevant covariates to zero exactly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debugging</code></td>
<td>
<p>logical flag. If TRUE, progress will be output to the console and extra information will be returned.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Consider the data model described in "<code>dat</code>":
</p>
<p style="text-align: center;"><code class="reqn">Y_{i} = \alpha_{0} + \sum_{k=1}^{q}\alpha_{k}E_{ik}+\sum_{t=1}^{m}\gamma_{t}clin_{it}+\beta_{j}X_{ij}+\sum_{k=1}^{q}\eta_{jk}X_{ij}E_{ik}+\epsilon_{i},</code>
</p>

<p>Where <code class="reqn">\alpha_{0}</code> is the intercept, <code class="reqn">\alpha_{k}</code>'s and <code class="reqn">\gamma_{t}</code>'s are the regression coefficients corresponding to effects of environmental and clinical factors.
And <code class="reqn">\beta_{j}</code>'s and <code class="reqn">\eta_{jk}</code>'s are the regression coefficients of the genetic variants and G<code class="reqn">\times</code>E interactions effects, correspondingly. 
</p>
<p>When sparse=TRUE (default), spike–and–slab priors are imposed to identify important main and interaction effects. If sparse=FALSE, Laplacian shrinkage will be used.
</p>
<p>When robust=TRUE (default), the distribution of <code class="reqn">\epsilon_{i}</code> is defined as a Laplace distribution with density
<code class="reqn">
f(\epsilon_{i}|\nu) = \frac{\nu}{2}\exp\left\{-\nu |\epsilon_{i}|\right\}
</code>, (<code class="reqn">i=1,\dots,n</code>), which leads to a Bayesian formulation of LAD regression. If robust=FALSE, <code class="reqn">\epsilon_{i}</code> follows a normal distribution.
</p>
<p>Here, a rank list of the main and interaction effects is provided. For method incorporating spike-and-slab priors,  
the inclusion probability is used to indicate the importance of predictors. 
We use a binary indicator <code class="reqn">\phi</code> to denote that the membership of the non-spike distribution. 
Take the main effect of the <code class="reqn">j</code>th genetic factor, <code class="reqn">X_{j}</code>, as an example. 
Suppose we have collected H posterior samples from MCMC after burn-ins. The <code class="reqn">j</code>th G factor is included 
in the marginal G<code class="reqn">\times</code>E model at the <code class="reqn">j</code>th MCMC iteration if the corresponding indicator is 1, i.e., <code class="reqn">\phi_j^{(h)} = 1</code>. 
Subsequently, the posterior probability of retaining the <code class="reqn">j</code>th genetic main effect in the final marginal model is defined as the average of all the indicators for the <code class="reqn">j</code>th G factor among the H posterior samples. 
That is, <code class="reqn">p_j = \hat{\pi} (\phi_j = 1|y) = \frac{1}{H} \sum_{h=1}^{H} \phi_j^{(h)}, \;  j = 1, \dots,p.</code>
A larger posterior inclusion probability <code class="reqn">j</code>th indicates a stronger empirical evidence that the <code class="reqn">j</code>th genetic main effect has a non-zero coefficient, i.e., a stronger association with the phenotypic trait. 
For method without spike-and-slab priors, variable selection is based on different level of credible intervals.
</p>
<p>Both <code class="reqn">X</code>, <code class="reqn">clin</code> and <code class="reqn">E</code> will be standardized before the generation of interaction terms to avoid the multicollinearity between main effects and interaction terms.
</p>
<p>Please check the references for more details about the prior distributions.
</p>


<h3>Value</h3>

<p>an object of class ‘marble’ is returned, which is a list with component:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>posterior</code></td>
<td>
<p>the posterior samples of coefficients from the MCMC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficient</code></td>
<td>
<p>the estimated value of coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ranklist</code></td>
<td>
<p>the rank list of main and interaction effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn.in</code></td>
<td>
<p>the total number of burn-ins.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p>the total number of iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>
<p>the design matrix of all effects.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Lu, X., Fan, K., Ren, J., and Wu, C. (2021). Identifying Gene–Environment Interactions With Robust Marginal Bayesian Variable Selection.
<em>Frontiers in Genetics</em>, 12:667074 <a href="https://doi.org/10.3389/fgene.2021.667074">doi:10.3389/fgene.2021.667074</a>
</p>


<h3>See Also</h3>

<p><code>GxESelection</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(dat)

## default method
max.steps=5000
fit=marble(X, Y, E, clin, max.steps=max.steps)

## coefficients of parameters
fit$coefficient

## Estimated values of main G effects 
fit$coefficient$G

## Estimated values of interactions effects 
fit$coefficient$GE

## Rank list of main G effects and interactions 
fit$ranklist


## alternative: robust selection
fit=marble(X, Y, E, clin, max.steps=max.steps, robust=TRUE, sparse=FALSE)
fit$coefficient
fit$ranklist

## alternative: non-robust sparse selection
fit=marble(X, Y, E, clin, max.steps=max.steps, robust=FALSE, sparse=FALSE)
fit$coefficient
fit$ranklist


</code></pre>


</div>