<div class="container">

<table style="width: 100%;"><tr>
<td>march.dcmm.construct</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Construct a double chain Markov model (DCMM).</h2>

<h3>Description</h3>

<p>Construct a <code>march.Dcmm-class</code> object, with visible order <em>orderVC</em>, hidden order <em>orderHC</em> and <em>M</em> hidden states, according to a <code>march.Dataset-class</code>.
The first <em>maxOrder</em>-<em>orderVC</em> elements of each sequence are truncated in order to return a model
which can be compared with other Markovian model of visible order maxOrder. The construction is performed either by an evolutionary algorithm (EA) or by improving an existing DCMM.
The EA performs <em>gen</em> generations on a population of <em>popSize</em> individuals. The EA behaves as a Lamarckian evolutionary algorithm, using a Baum-Welch algorithm as
optimization step, running until log-likelihood improvement is less than <em>stopBw</em> or for <em>iterBw</em> iterations. Finally only the best individual from the population is returned as solution.
If a seedModel is provided, the only step executed is the optimization step, parameters related to the EA do not apply in this case.
</p>


<h3>Usage</h3>

<pre><code class="language-R">march.dcmm.construct(
  y,
  orderHC,
  orderVC,
  M = 2,
  gen = 5,
  popSize = 4,
  maxOrder = orderVC,
  seedModel = NULL,
  iterBw = 2,
  stopBw = 0.1,
  Amodel = "mtd",
  Cmodel = "mtd",
  AMCovar = 0,
  CMCovar = 0,
  AConst = FALSE,
  pMut = 0.05,
  pCross = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the dataset from which the Dcmm will be constructed <code>march.Dataset-class</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>orderHC</code></td>
<td>
<p>the order of the hidden chain of the constructed Dcmm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>orderVC</code></td>
<td>
<p>the order of the visible chain of the constructed Dcmm (0 for a HMM).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>the number of hidden states of the Dcmm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gen</code></td>
<td>
<p>the number of generations performed by the EA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>popSize</code></td>
<td>
<p>the number of individuals stored into the population.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxOrder</code></td>
<td>
<p>the maximum visible order among the set of Markovian models to compare.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seedModel</code></td>
<td>
<p>a model to optimize using Baum-Welch algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterBw</code></td>
<td>
<p>the number of iterations performed by the Baum-Welch algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stopBw</code></td>
<td>
<p>the minimum increase in quality (log-likelihood) authorized in the Baum-Welch algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Amodel</code></td>
<td>
<p>the modeling of the hidden transition matrix (mtd, mtdg or complete)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Cmodel</code></td>
<td>
<p>the modeling of the visible transition matrix (mtd, mtdg or complete)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AMCovar</code></td>
<td>
<p>vector of the size Ncov indicating which covariables are used into the hidden process (0: no, 1:yes)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CMCovar</code></td>
<td>
<p>vector of the size Ncov indicating which covariables are used into the visible process (0: no, 1:yes)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AConst</code></td>
<td>
<p>logical, indicating whether or not the hidden transition matrix has the identity (diagonal) constraint</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pMut</code></td>
<td>
<p>mutation probability for the evolutionary algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pCross</code></td>
<td>
<p>crossover probability for the evolutionary algorithm</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>the best <code>march.Dcmm-class</code> constructed by the EA or the result of the Baum-Welch algorithm on <em>seedModel</em>.
</p>


<h3>Author(s)</h3>

<p>Emery Kevin
</p>


<h3>See Also</h3>

<p><code>march.Dcmm-class</code>, <code>march.Model-class</code>, <code>march.Dataset-class</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Construct a 2 hidden states DCMM for the pewee data
# with hidden order set to 2 and visible order set to 1.
# The estimation procedure uses both the evolutionary algorithm (population size 2, 
# one generation) and the Bauw-Welch algorithm (one iteration).
## Not run: march.dcmm.construct(y=pewee,orderHC=2,
                              orderVC=1,M=2,popSize=2,gen=1,iterBw=1,stopBw=0.0001)
 
# Same as above, but the DCMM is replaced by a HMM (the visible order OrderVC is set to zero).
HMM&lt;-march.dcmm.construct(y=pewee,orderHC=2,orderVC=0,M=2,popSize=2,gen=1,iterBw=1,stopBw=0.0001)  

# A first model is computed using both EA and Baum-Welch algorithms.
# The previous model is improved through two rounds of Baum-Welch optimization.
models &lt;- list()
models[[length(models)+1]] &lt;- HMM
models[[length(models)+1]] &lt;- march.dcmm.construct(y=pewee,seedModel=models[[1]],
                                                   orderVC=0,iterBw=10,stopBw=0.001)
models[[length(models)+1]] &lt;- march.dcmm.construct(y=pewee,seedModel=models[[2]],
                                                   orderVC=0,iterBw=10,stopBw=0.0001)
# Show performance indicators (ll, number of independent parameters,
# BIC and AIC) for all computed models.
#r &lt;- do.call(rbind,lapply(models,march.summary))
#print(r)

# Construct a three hidden states, first-order HMM (hence OrderVC=0) for the sleep data.
# By setting gen=1 and popSize=1, the estimation procedure uses only the Baum-Welch algorithm.
HMM &lt;- march.dcmm.construct(pewee,orderHC=1,orderVC=0,M=2,gen=1,popSize=1,iterBw=10,stopBw=0.0001)
## End(Not run)


</code></pre>


</div>