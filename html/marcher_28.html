<div class="container">

<table style="width: 100%;"><tr>
<td>selectModel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Select residual model</h2>

<h3>Description</h3>

<p>Given a complex vector of movement residuals, will use AIC to select the order of the autocorrelation, i.e. white noise (WN), position autocorrelation (OU), or position and velocity autocorrelation (OUF)
</p>


<h3>Usage</h3>

<pre><code class="language-R">selectModel(Z.res, T = NULL, method = c("ar", "like")[1],
  showtable = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Z.res</code></td>
<td>
<p>complex vector of residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T</code></td>
<td>
<p>time vector (only needed for method = 'like')</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>One of 'ar' or 'like' - whether to use the AR equivalence (faster, but needs to be regular) or likelihood estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showtable</code></td>
<td>
<p>whether to return the AIC values of the respective models</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A character string - <code>'wn'</code>, <code>'ou'</code> or <code>'ouf'</code>.  Optionally also the AIC table.
</p>


<h3>Examples</h3>

<pre><code class="language-R">require(marcher)

# white noise example
Z1 &lt;- rnorm(100) + 1i*rnorm(100)

# OU example
T &lt;- 1:100
p.s2 &lt;- c(tau.z = 5, tau.v = 0)
S2 &lt;- outer(T, T, getCov, p=p.s2, model="ou")
Z2 &lt;- mvrnorm2(n = 1, mu = rep(0,length(T)), S2) + 
     1i * mvrnorm2(n = 1, mu = rep(0,length(T)),  S2)

# OUF example
p.s3 &lt;- c(tau.z = 5, tau.v = 2)
S3 &lt;- outer(T, T, getCov, p=p.s3, model="ouf")
Z3 &lt;- mvrnorm2(n = 1, mu = rep(0,length(T)), S3) + 
  1i * mvrnorm2(n = 1, mu = rep(0,length(T)),  S3)


# plot all three
par(mfrow=c(1,3), mar = c(2,2,2,2))
plot(Z1, asp=1, type="o")
plot(Z2, asp=1, type="o")
plot(Z3, asp=1, type="o")

# select models using 'ar' method (results might vary!)

selectModel(Z1, T = T, method = "ar", showtable = TRUE)
selectModel(Z2, T = T, method = "ar", showtable = TRUE)
selectModel(Z3, T = T, method = "ar", showtable = TRUE)

selectModel(Z1, T = T, method = "like", showtable = TRUE)
selectModel(Z2, T = T, method = "like", showtable = TRUE)
selectModel(Z3, T = T, method = "like", showtable = TRUE)

# repeat using irregular times (requiring "like" method)

T &lt;- cumsum(rexp(100))

# white noise example
p.s1 &lt;- c(tau.z = 0, tau.v = 0)
S1 &lt;- outer(T, T, getCov, p=p.s1, model="wn")
Z1 &lt;- mvrnorm2(n = 1, mu = rep(0,length(T)), S1) + 
  1i * mvrnorm2(n = 1, mu = rep(0,length(T)),  S1)

# OU example
p.s2 &lt;- c(tau.z = 5, tau.v = 0)
S2 &lt;- outer(T, T, getCov, p=p.s2, model="ou")
Z2 &lt;- mvrnorm2(n = 1, mu = rep(0,length(T)), S2) + 
  1i * mvrnorm2(n = 1, mu = rep(0,length(T)),  S2)

# OUF example
p.s3 &lt;- c(tau.z = 5, tau.v = 2)
S3 &lt;- outer(T, T, getCov, p=p.s3, model="ouf")
Z3 &lt;- mvrnorm2(n = 1, mu = rep(0,length(T)), S3) + 
  1i * mvrnorm2(n = 1, mu = rep(0,length(T)),  S3)

Z.list &lt;- list(Z1, Z2, Z3)

# plot
par(mfrow=c(1,3), mar = c(2,2,2,2))
lapply(Z.list, function(z) plot(z, asp=1, type="o"))

# select model
lapply(Z.list, function(z) selectModel(z, T = T, method = "like", showtable = TRUE))
</code></pre>


</div>