<div class="container">

<table style="width: 100%;"><tr>
<td>diffcoeff</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Molecular Diffusion Coefficients</h2>

<h3>Description</h3>

<p>Calculates the molecular and ionic diffusion coefficients in 
<code class="reqn">m^2 s^{-1}</code>, for several inorganic species in seawater 
at a given salinity, temperature, and pressure.
</p>
<p>Based on Chapter 4 in Boudreau (1997)
</p>


<h3>Usage</h3>

<pre><code class="language-R">diffcoeff(S = 35, t = 25, P = 1.013253,
      species = c("H2O", "O2", "CO2", "H2", "CH4", "DMS",
      "He", "Ne", "Ar", "Kr", "Xe", "Rn",
      "N2", "H2S", "NH3", "NO", "N2O", "CO", "SO2",
      "OH", "F", "Cl", "Br", "I",
      "HCO3", "CO3", "H2PO4", "HPO4", "PO4",
      "HS", "HSO3", "SO3", "HSO4", "SO4", "IO3", "NO2", "NO3",
      "H", "Li", "Na", "K", "Cs","Ag","NH4",
      "Ca", "Mg", "Fe", "Mn", "Ba", "Be", "Cd", "Co",
      "Cu", "Hg", "Ni", "Sr", "Pb", "Ra", "Zn", "Al", "Ce",
      "La", "Pu", "H3PO4", "BOH3", "BOH4", "H4SiO4"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>Salinity, -,
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>Temperature, <code class="reqn">^\circ</code>C,
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>True pressure, bar,
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>species </code></td>
<td>
<p>character vector with the names of the chemical species whose
diffusion coefficient should be calculated.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>To correct for salinity, the Stokes-Einstein relationship is used.
This is not quite accurate, but is at least consistent.
</p>
<p><code class="reqn">H_3PO_4</code> : Least (1984) determined D(H3PO4) at 25 deg C and 0 S.
Assume that this value can be scaled by the Stokes-Einstein
relationship to any other temperature.
</p>
<p><code class="reqn">B(OH)_3</code> : Mackin (1986) determined D(B(OH)3) at 25 deg C and
about 29.2 S. Assume that this value can be scaled by the
Stokes-Einstein relationship to any other temperature.
</p>
<p><code class="reqn">B(OH)_4</code> : No information on this species.  Boudreau and Canfield
(1988) assume it is 12.5% smaller than B(OH)3.
</p>
<p><code class="reqn">H_4SiO_4</code> : Wollast and Garrels (1971) found D(H4SiO4) at 25 deg
C and 36.1 ppt S.  Assume that this value can be scaled by the
Stokes-Einstein relationship to any other temperature.
</p>
<p>Arguments salinity, temperature or pressure can be vectors. In order to avoid 
confusion, S, t and P must have either same length or length 1. More flexible 
combinations are of course possible with <code>expand.grid</code>
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> with the diffusion coefficients <code class="reqn">m^2 s^{-1}</code>
of the selected chemical species.
</p>


<h3>Author(s)</h3>

<p>Filip Meysman &lt;filip.meysman@nioz.nl&gt;,
Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;
</p>


<h3>References</h3>

<p>Based on Chapter 4 in Boudreau (1997) :
</p>
<p>Boudreau BP, 1997. Diagenetic Models and their Implementation. Modelling
Transport and Reactions in Aquatic Sediments. Springer. Berlin.
</p>
<p>who cites:
</p>
<p>for self-diffusion coefficient H2O:
</p>
<p>Cohen MH and Turnbull D. 1959. Molecular transport in liquids and
glasses.  Journal of chemical physics 31 (5): 1164-1169
</p>
<p>Krynicki K, Green CD and Sawyer DW, 1978.  Pressure and
temperature-dependence of self-diffusion in water.  Faraday
discussions 66: 199-208
</p>
<p>for gases O2 and CO2:
</p>
<p>Novel relation by Boudreau (1997) based on new compilation of data
</p>
<p>for gases He, Ne, Kr, Xe, Rn, H2, CH4:
</p>
<p>Jahne B, Heinz G, and Dietrich W, 1987. Measurements of the
diffusion coefficients of sparingly soluble gases in water.
J. Geophys. Res., 92:10,767-10,776.
</p>
<p>for Ar:
</p>
<p>Ohsumi T and Horibe Y, 1984. Diffusivity of He and Ar in deep-sea sediments,
Earth and Planetary Science Letters 70, 61-68.
</p>
<p>for DMS:
</p>
<p>Saltzman ES, King DB, Holmen K, and Leck C, 1993. Experimental Determination
of the Diffusion Coefficient of Dimethylsulfide in Water, J. Geophys. Res.,
98(C9), 16, 481-486.
</p>
<p>for other gases (N2, H2S, NH3, NO, N2O, CO, SO2):
</p>
<p>Wilke CR and Chang P, 1955. Correlation of diffusion coefficients in
dilute solutions. Aiche journal 1 (2): 264-270
</p>
<p>with the correction proposed by
</p>
<p>Hayduk W and Laudie H, 1974.  Prediction of diffusion-coefficients for
nonelectrolytes in dilute aqueous-solutions. Aiche journal 20 (3):
611-615
</p>
<p>for ions:
</p>
<p>Hayduk W and Laudie H, 1974.  Prediction of diffusion-coefficients for
nonelectrolytes in dilute aqueous-solutions. Aiche journal 20 (3):
611-615
</p>
<p>for H3PO4, B(OH)3, B(OH)4, H4SiO4 : see details
</p>


<h3>See Also</h3>

<p><code>coriolis</code>, <code>viscosity</code>,
<code>ssd2rad</code>, <code>vertmean</code>,
<code>gravity</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">diffcoeff(S = 15, t = 15)*1e4*3600*24         # cm2/day
diffcoeff(t = 10, species = "O2")             # m2/s
difftemp &lt;- diffcoeff(t = 0:30)[,1:13]
matplot(0:30, difftemp, xlab = "temperature", ylab = "m2/s",
        main = "Molecular/ionic diffusion", type = "l",
        col = 1:13, lty = 1:13)
legend("topleft", ncol = 2, cex = 0.8, title = "mean", 
       col = 1:13, lty = 1:13,
       legend = cbind(names(difftemp),
       format(colMeans(difftemp), digits = 4)))

## vector-valued salinity
select &lt;- c("O2", "CO2", "NH3", "NH4", "NO3")
diffsal &lt;- diffcoeff(S = 0:35, species = select)
matplot(0:35, diffsal, xlab = "salinity", ylab = "m2/s",
         main = "Molecular/ionic diffusion", type = "l",
         col = 1:length(select), lty = 1:length(select))
legend("topleft", ncol = 2, cex = 0.8, title = "mean",
       col = 1:length(select), lty = 1:length(select),
       legend = cbind(select, format(colMeans(diffsal), digits = 4)))

## vector-valued temperature
difftemp &lt;- diffcoeff(S = 1, t=1:20, species = select)
matplot(1:20, difftemp, xlab = "temperature", ylab = "m2/s",
        main = "Molecular/ionic diffusion", type = "l",
        col = 1:length(select), lty = 1:length(select))
legend("topleft", ncol = 2, cex = 0.8, title = "mean",
       col = 1:length(select), lty = 1:length(select),
       legend = cbind(select, format(colMeans(difftemp), digits = 4)))

## combination of S and t
diffsaltemp &lt;- diffcoeff(S = rep(c(1, 35), each = 20), 
                         t = rep(1:20, 2), species = select)
       
</code></pre>


</div>