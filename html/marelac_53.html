<div class="container">

<table style="width: 100%;"><tr>
<td>vertmean</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Vertical Volume Weighted Mean of Matter Concentrations in Water
Bodies
</h2>

<h3>Description</h3>

<p>Calculate vertical mean values which respect to depths of different
layers or lake morphometry.
</p>


<h3>Usage</h3>

<pre><code class="language-R">vertmean(depth, vari, level, top, bot, vol, total=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>depth</code></td>
<td>
<p>sorted vector of sampled depths,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vari</code></td>
<td>
<p>measurements corresponding to <code>depth</code> (concentration,
temperature, ...), </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>surface water level (above ground or above sea level (m
a.s.l.), depending on bathymetric function used,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>top</code></td>
<td>
<p>top water level of requested layer over which to average or
integrate,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bot</code></td>
<td>
<p>bottom water level of requested layer over which to average or
intgrate,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vol</code></td>
<td>
<p>hypsographic function to be used (e.g. <code>vol.depth</code>),</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>total</code></td>
<td>
<p>if <code>TRUE</code> the total sum over the water body is
returned (integrated value), instead of the volumetric mean.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Volumetric average respectively total value (for total =<code>TRUE</code>) for a
given quantity (concentration, energy, temperature) in the requested
layer between depths <code>top</code> and <code>bottom</code>.
</p>


<h3>Author(s)</h3>

<p>Thomas Petzoldt</p>


<h3>See Also</h3>

<p><code>coriolis</code>, <code>viscosity</code>,
<code>diffcoeff</code>, <code>ssd2rad</code>,
<code>gravity</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## define a bathymetric formula for a given lake or basin
## z:     water depth  (m below surface)
## zz:    water column (m above ground)
## level: total water depth (m above ground or above reference level)
weight.vol &lt;- function(z, level) {
  zz  &lt;- level - z
  if (any(zz &lt; 0)) stop("depth &gt; maximum depth")
  vol &lt;- 175947 * zz^2 + 2686 * zz^3 # m^3
}

## area is first derivative
area &lt;- function(z, level) {
  zz  &lt;- level - z
  A   &lt;-   0.5 * 175947 * zz + 1/3 * 2686 * zz^2 # m^2
}

## dummy formula for depth-weighted averaging
## (water column, instead of bathymetric curve)
weight.column &lt;- function(z, level) {z}

## Plot of lake volume (bathymetric curve)
par(mfrow = c(1, 2))
z &lt;- 0:12
V &lt;- weight.vol(z, 12)
plot(V, z, type = "l", ylim = c(12, 0), xlab = "Volume (m3)",
  ylab = "Depth (m)")
polygon(c(V, 0), c(z, 0), col = "cyan")

## Test Data
level &lt;- 12
depth &lt;- c(0, 1, 3.5, 5, 7, 10, 10.5, 11.5)
pconc &lt;- c(3.7, 4.2, 6.1, 8.9, 7.8, 9.7, 11.4, 11.4)

## Plot test data
plot(pconc, depth, xlim=range(c(0, pconc)), ylim=c(12,0), type="n",
  xlab="P concentration (mu g / L)", ylab="Depth (m)")
segments(rep(0, 13), depth, pconc, depth, lwd=3)

## simple means
m &lt;- mean(pconc[depth &lt;= 4])
lines(c(m, m), c(0, 4), col="blue", lwd=2)

m &lt;- mean(pconc[depth &gt;= 4])
lines(c(m, m), c(4, 12), col="blue", lwd=2)

## depth weighted
m &lt;- vertmean(depth, pconc, level, top=0, bot=4, weight.column)
lines(c(m, m), c(0, 4), col="red", lwd=2)

m &lt;- vertmean(depth, pconc, level, top=4, bot=12, weight.column)
lines(c(m, m), c(4, 12), col="red", lwd=2)

## volume weighted
m &lt;- vertmean(depth, pconc, level, top=0, bot=4, weight.vol)
lines(c(m, m), c(0, 4), col="green", lwd=2)

m &lt;- vertmean(depth, pconc, level, top=4, bot=12, weight.vol)
lines(c(m, m), c(4, 12), col="green", lwd=2)

m &lt;- vertmean(depth, pconc, level, top=4, bot=12, weight.vol)
lines(c(m, m), c(4, 12), col="green", lwd=2)

legend("topright", col=c("blue", "red", "green"), lwd=2, cex=0.7,
  legend=c("non weighted", "depth weighted", "volume weighted"))

## total sum over the whole water column
vertmean(depth, pconc, level, top=0, bot=12, weight.vol, total=TRUE)
</code></pre>


</div>