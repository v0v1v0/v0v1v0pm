<div class="container">

<table style="width: 100%;"><tr>
<td>rsm.diag</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Diagnostics for Regression-Scale Models 
</h2>

<h3>Description</h3>

<p>Calculates different types of residuals, Cook's distance and the
leverages for a regression-scale model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rsm.diag(rsmfit, weighting = "observed")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>rsmfit</code></td>
<td>

<p>an <code>rsm</code> object, i.e. the result of a call to <code>rsm</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weighting</code></td>
<td>

<p>character string; defines the weight matrix that should be used 
in the calculation of the residuals and diagnostics.  Possible 
choices are <code>"observed"</code>, <code>"score"</code>, <code>"deviance"</code> 
and <code>"max"</code>; see <cite>Jorgensen (1984)</cite> for their 
definition.  The default is <code>"observed"</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If the weighting scheme is <code>"observed"</code>, the weights used are 
the values stored in the <code>q2</code> component of the <code>rsm</code> 
object <code>rsmfit</code>.  Otherwise, they are calculated by 
<code>rsm.diag</code>.  Some of the <abbr><span class="acronym">IRLS</span></abbr> weights returned by 
<code>rsm</code> may be negative if the error distribution is Student's
t or user-defined.  In order to avoid missing values in the 
residuals and regression diagnostics, the default weighting scheme 
used in <code>rsm.diag</code> switches automatically from 
<code>"observed"</code> to <code>"score"</code> unless otherwise specified.  The
<code>"score"</code> weights are also used by default if Huber's least 
favourable error distribution is used.
</p>
<p>There are three types of residuals.  The response residuals are 
taken on the response scale, whereas the probability transform 
residuals are on the <code class="reqn">U(0,1)</code> scale.  The remaining 
ones follow approximately the standard normal distribution.  
</p>
<p>More details and in particular the definitions of the above 
residuals and diagnostics can be found in <cite>Brazzale (2000, 
Section 6.3.1)</cite>.
</p>


<h3>Value</h3>

<p>Returns a list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>resid</code></td>
<td>

<p>the response residuals on the response scale.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rd</code></td>
<td>

<p>the standardized deviance residuals from the <abbr><span class="acronym">IRLS</span></abbr> fit.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rp</code></td>
<td>

<p>the standardized Pearson residuals from the <abbr><span class="acronym">IRLS</span></abbr> fit.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rg</code></td>
<td>

<p>the deletion residuals from the <abbr><span class="acronym">IRLS</span></abbr> fit.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rs</code></td>
<td>

<p>the <code class="reqn">r^*</code> residuals from the <abbr><span class="acronym">IRLS</span></abbr> fit.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rcs</code></td>
<td>

<p>the probability transform residuals from the <abbr><span class="acronym">IRLS</span></abbr> fit.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cook</code></td>
<td>

<p>Cook's distance.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>

<p>the leverages of the observations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dispersion</code></td>
<td>

<p>the value of the scale parameter.
</p>
</td>
</tr>
</table>
<h3>Acknowledgments</h3>

<p>This function is based on A.J. Canty's function <code>glm.diag</code> 
contained in the package <span class="pkg">boot</span>.
</p>


<h3>Note</h3>

<p>Huber's least favourable distribution represents a special case.  
The regression diagnostics are only meaningful if the errors 
<em>truly</em> follow a Huber-type distribution.  This no longer holds
if the option <code>family = Huber</code> in <code>rsm</code> is used to 
obtain the M-estimates of the parameters in place or the maximum 
likelihood estimates.
</p>


<h3>References</h3>

<p>Brazzale, A. R. (2000) <em>Practical Small-Sample Parametric 
Inference</em>.  Ph.D. Thesis N. 2230, Department of Mathematics, Swiss 
Federal Institute of Technology Lausanne.
</p>
<p>Jorgensen, B. (1984) The delta algorithm and GLIM.  <em>Int. Stat.
Rev.</em>, <b>52</b>, 283–300.
</p>
<p>Davison, A. C. and Snell, E. J. (1991) Residuals and diagnostics.  
In <em>Statistical Theory and Modelling: In Honour of Sir David 
Cox</em> (eds. D. V. Hinkley, N. Reid, and E. J. Snell), 83–106.  
London: Chapman &amp; Hall.
</p>
<p>Davison, A. C. and Tsai, C.-L. (1992)  Regression model diagnostics.
<em>Int. Stat. Rev.</em>, <b>60</b>, 337–353.
</p>


<h3>See Also</h3>

<p><code>rsm.diag.plots</code>, <code>rsm.object</code>, 
<code>summary.rsm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Sea Level Data
data(venice)
attach(venice)
Year &lt;- 1:51/51
c11 &lt;- cos(2*pi*1:51/11) ; s11 &lt;- sin(2*pi*1:51/11)
c19 &lt;- cos(2*pi*1:51/18.62) ; s19 &lt;- sin(2*pi*1:51/18.62)
venice.rsm &lt;- rsm(sea ~ Year + I(Year^2) + c11 + s11 + c19 + s19, 
                  family = extreme)
venice.diag &lt;- rsm.diag(venice.rsm)
## observed weights
detach()

## Darwin's Data on Growth Rates of Plants
data(darwin)
darwin.rsm &lt;- rsm(cross-self ~ pot - 1, family = Huber, data = darwin)
darwin.diag &lt;- rsm.diag(darwin.rsm)
## score weights
</code></pre>


</div>