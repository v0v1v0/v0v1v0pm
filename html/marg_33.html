<div class="container">

<table style="width: 100%;"><tr>
<td>rsm.diag.plots</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Diagnostic Plots for Regression-Scale Models
</h2>

<h3>Description</h3>

<p>Generates diagnostic plots for a regression-scale model using 
different types of residuals, Cook's distance and the leverages.    
</p>


<h3>Usage</h3>

<pre><code class="language-R">rsm.diag.plots(rsmfit, rsmdiag = NULL, weighting = NULL, 
               which = NULL, subset = NULL, iden = FALSE, 
               labels = NULL, ret = FALSE, ...)
## S3 method for class 'rsm'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>rsmfit, x</code></td>
<td>

<p>a <code>rsm</code> object, i.e. the result of a call to <code>rsm</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rsmdiag</code></td>
<td>

<p>the object returned by a call to <code>rsm.diag</code> containing the
regression diagnostics for the regression-scale model defined by 
<code>rsmfit</code>.  If not supplied, this object is created by 
<code>rsm.diag.plots</code> and returned upon request (if 
<code>ret = TRUE</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weighting</code></td>
<td>

<p>character string; defines the weight matrix that should be used in
the calculation of the residuals and diagnostics.  Possible  
choices are <code>"observed"</code>, <code>"score"</code>, <code>"deviance"</code> 
and <code>"max"</code>; see <cite>Jorgensen (1984)</cite> for their 
definition.  Will only be used if the <code>rsmdiag</code> argument is
missing.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>

<p>which plot to print.  Admissible values are <code>2</code> to <code>7</code> 
corresponding to the choices in the menu below.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>

<p>subset of data used in the original <code>rsm</code> fit: should be 
the same than the <code>subset</code> option used in the call to 
<code>rsm</code> which generated <code>rsmfit</code>.  Needed only if the
<code>subset</code> option was used in the call to <code>rsm</code>.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iden</code></td>
<td>

<p>logical argument.  If <code>TRUE</code>, the user will be prompted after
the plots are drawn.  A positive integer will select a plot and 
invoke <code>identify()</code> on that plot.  After exiting 
<code>identify()</code>, the user is again prompted, this loop 
continuing until the user responds to the prompt with <code>0</code>.  
If <code>iden</code> is <code>FALSE</code> (default) the user cannot 
interact with the plots.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>

<p>a vector of labels for use with <code>identify()</code> if 
<code>iden</code> is <code>TRUE</code>.  If it is not supplied, then the 
labels are derived from <code>rsmfit</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ret</code></td>
<td>

<p>logical argument indicating if <code>rsmdiag</code> should be 
returned; the default is <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>additional arguments such as graphical parameters.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The diagnostics required for the plots are calculated by 
<code>rsm.diag</code>.  These are then used to produce the plots
on the current graphics device.
</p>
<p>A menu lists all the plots that can be produced. They may be one or 
all of the following:
</p>
<pre>
 Make a plot selection (or 0 to exit)

1: All
2: Response residuals against fitted values
3: Deviance residuals against fitted values
4: QQ-plot of deviance residuals
5: Normal QQ-plot of r* residuals
6: Cook statistic against h/(1-h)
7: Cook statistic against observation number

Selection:
  </pre>
<p>In the normal scores plots, the dotted line represents the expected 
line if the residuals are normally distributed, i.e. it is the line 
with intercept 0 and slope 1.
</p>
<p>In general, when plotting Cook's distance against the standardized 
leverages, there will be two dotted lines on the plot.  The 
horizontal line is at <code class="reqn">8/(n-2p)</code>, where <code class="reqn">n</code> is 
the number of observations and <code class="reqn">p</code> is the number of 
estimated parameters.  Points above this line may be points with 
high influence on the model.  The vertical line is at 
<code class="reqn">2p/(n-2p)</code> and points to the right of this line have
high leverage compared to the variance of the raw residual at that 
point.  If all points are below the horizontal line or to the left 
of the vertical line then the line is not shown.
</p>
<p>Use of <code>iden = TRUE</code> is encouraged for proper exploration of 
these plots as a guide to how well the model fits the data and 
whether certain observations have an unduly large effect on 
parameter estimates.
</p>


<h3>Value</h3>

<p>If <code>ret</code> is <code>TRUE</code> then the value of <code>rsmdiag</code> 
is returned, otherwise there is no returned value.
</p>


<h3>Side Effects</h3>

<p>The current device is cleared.  If <code>iden = TRUE</code>, interactive 
identification of points is enabled.  All screens are closed, but 
not cleared, on termination of the function.
</p>


<h3>Acknowledgments</h3>

<p>This function is based on A. J. Canty's function 
<code>glm.diag.plots</code> contained in the package <span class="pkg">boot</span>.
</p>


<h3>References</h3>

<p>Davison, A. C. and Snell, E. J. (1991) Residuals and diagnostics.  
In <em>Statistical Theory and Modelling: In Honour of Sir David 
Cox</em> (eds. D. V. Hinkley, N. Reid, and E. J. Snell), 83–106.  
London: Chapman &amp; Hall, London.
</p>
<p>Davison, A. C. and Tsai, C.-L. (1992) Regression model diagnostics.
<em>Int. Stat. Rev.</em>, <b>60</b>, 337–353.
</p>
<p>Jorgensen, B. (1984) The Delta Algorithm and GLIM.  <em>Int. Stat.
Rev.</em>, <b>52</b>, 283–300.
</p>


<h3>See Also</h3>

<p><code>rsm.diag</code>, <code>rsm.object</code>, 
<code>identify</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Sea Level Data
data(venice)
attach(venice)
Year &lt;- 1:51/51
c11 &lt;- cos(2*pi*1:51/11) ; s11 &lt;- sin(2*pi*1:51/11)
c19 &lt;- cos(2*pi*1:51/18.62) ; s19 &lt;- sin(2*pi*1:51/18.62)
venice.rsm &lt;- rsm(sea ~ Year + I(Year^2) + c11 + s11 + c19 + s19, 
                  family = extreme)
## Not run: 
rsm.diag.plots(venice.rsm, which = 3)

## End(Not run)
## or
## Not run: 
plot(venice.rsm)

## End(Not run)
## menu-driven
##
rsm.diag.plots(venice.rsm, which = 5, las = 1)
## normal QQ-plot of r* residuals 
## Not run: 
rsm.diag.plots(venice.rsm, which = 7, iden = T, labels = paste(1931:1981))

## End(Not run)
## year 1932 highly influential
detach()
</code></pre>


</div>