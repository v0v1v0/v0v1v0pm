<div class="container">

<table style="width: 100%;"><tr>
<td>image.lm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Perspective and heatmap/contour plots for models</h2>

<h3>Description</h3>

<p>Draw one or more perspectives plots reflecting predictions or marginal effects from a model, or the same using a flat heatmap or “filled contour” (<code>image</code>) representation. Currently methods exist for “lm”, “glm”, and “loess” models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'lm'
image(
  x,
  xvar = attributes(terms(x))[["term.labels"]][1],
  yvar = attributes(terms(x))[["term.labels"]][2],
  dx = xvar,
  what = c("prediction", "effect"),
  type = c("response", "link"),
  vcov = stats::vcov(x),
  nx = 25L,
  ny = nx,
  nz = 20,
  xlab = xvar,
  ylab = yvar,
  xaxs = "i",
  yaxs = xaxs,
  bty = "o",
  col = gray(seq(0.05, 0.95, length.out = nz), alpha = 0.75),
  contour = TRUE,
  contour.labels = NULL,
  contour.drawlabels = TRUE,
  contour.cex = 0.6,
  contour.col = "black",
  contour.lty = 1,
  contour.lwd = 1,
  ...
)

## S3 method for class 'glm'
image(
  x,
  xvar = attributes(terms(x))[["term.labels"]][1],
  yvar = attributes(terms(x))[["term.labels"]][2],
  dx = xvar,
  what = c("prediction", "effect"),
  type = c("response", "link"),
  vcov = stats::vcov(x),
  nx = 25L,
  ny = nx,
  nz = 20,
  xlab = xvar,
  ylab = yvar,
  xaxs = "i",
  yaxs = xaxs,
  bty = "o",
  col = gray(seq(0.05, 0.95, length.out = nz), alpha = 0.75),
  contour = TRUE,
  contour.labels = NULL,
  contour.drawlabels = TRUE,
  contour.cex = 0.6,
  contour.col = "black",
  contour.lty = 1,
  contour.lwd = 1,
  ...
)

## S3 method for class 'loess'
image(
  x,
  xvar = attributes(terms(x))[["term.labels"]][1],
  yvar = attributes(terms(x))[["term.labels"]][2],
  dx = xvar,
  what = c("prediction", "effect"),
  type = c("response", "link"),
  vcov = stats::vcov(x),
  nx = 25L,
  ny = nx,
  nz = 20,
  xlab = xvar,
  ylab = yvar,
  xaxs = "i",
  yaxs = xaxs,
  bty = "o",
  col = gray(seq(0.05, 0.95, length.out = nz), alpha = 0.75),
  contour = TRUE,
  contour.labels = NULL,
  contour.drawlabels = TRUE,
  contour.cex = 0.6,
  contour.col = "black",
  contour.lty = 1,
  contour.lwd = 1,
  ...
)

## S3 method for class 'lm'
persp(
  x,
  xvar = attributes(terms(x))[["term.labels"]][1],
  yvar = attributes(terms(x))[["term.labels"]][2],
  dx = xvar,
  what = c("prediction", "effect"),
  type = c("response", "link"),
  vcov = stats::vcov(x),
  nx = 25L,
  ny = nx,
  theta = 45,
  phi = 10,
  shade = 0.75,
  xlab = xvar,
  ylab = yvar,
  zlab = if (match.arg(what) == "prediction") "Predicted value" else
    paste0("Marginal effect of ", dx),
  ticktype = c("detailed", "simple"),
  ...
)

## S3 method for class 'glm'
persp(
  x,
  xvar = attributes(terms(x))[["term.labels"]][1],
  yvar = attributes(terms(x))[["term.labels"]][2],
  dx = xvar,
  what = c("prediction", "effect"),
  type = c("response", "link"),
  vcov = stats::vcov(x),
  nx = 25L,
  ny = nx,
  theta = 45,
  phi = 10,
  shade = 0.75,
  xlab = xvar,
  ylab = yvar,
  zlab = if (match.arg(what) == "prediction") "Predicted value" else
    paste0("Marginal effect of ", dx),
  ticktype = c("detailed", "simple"),
  ...
)

## S3 method for class 'loess'
persp(
  x,
  xvar = attributes(terms(x))[["term.labels"]][1],
  yvar = attributes(terms(x))[["term.labels"]][2],
  dx = xvar,
  what = c("prediction", "effect"),
  type = c("response", "link"),
  vcov = stats::vcov(x),
  nx = 25L,
  ny = nx,
  theta = 45,
  phi = 10,
  shade = 0.75,
  xlab = xvar,
  ylab = yvar,
  zlab = if (match.arg(what) == "prediction") "Predicted value" else
    paste0("Marginal effect of ", dx),
  ticktype = c("detailed", "simple"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A model object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xvar</code></td>
<td>
<p>A character string specifying the name of variable to use as the ‘<span class="samp">⁠x⁠</span>’ dimension in the plot. See <code>persp</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yvar</code></td>
<td>
<p>A character string specifying the name of variable to use as the ‘<span class="samp">⁠y⁠</span>’ dimension in the plot. See <code>persp</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dx</code></td>
<td>
<p>A character string specifying the name of the variable for which the conditional average marginal effect is desired when <code>what = "effect"</code>. By default this is <code>xvar</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>what</code></td>
<td>
<p>A character string specifying whether to draw “prediction” (fitted values from the model, calculated using <code>predict</code>) or “effect” (marginal effect of <code>dx</code>, using <code>margins</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A character string specifying whether to calculate predictions on the response scale (default) or link (only relevant for non-linear models).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov</code></td>
<td>
<p>A matrix containing the variance-covariance matrix for estimated model coefficients, or a function to perform the estimation with <code>model</code> as its only argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nx</code></td>
<td>
<p>An integer specifying the number of points across <code>x</code> at which to calculate the predicted value or marginal effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ny</code></td>
<td>
<p>An integer specifying the number of points across <code>y</code> at which to calculate the predicted value or marginal effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nz</code></td>
<td>
<p>An integer specifying, for <code>image</code>, the number of breakpoints to use when coloring the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>A character string specifying the value of <code>xlab</code> in <code>persp</code> or <code>image</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>A character string specifying the value of <code>ylab</code> in <code>persp</code> or <code>image</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xaxs</code></td>
<td>
<p>A character string specifying the x-axis type (see <code>par</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yaxs</code></td>
<td>
<p>A character string specifying the y-axis type (see <code>par</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bty</code></td>
<td>
<p>A character string specifying the box type (see <code>par</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>A character vector specifying colors to use when coloring the contour plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contour</code></td>
<td>
<p>For <code>image</code>, a logical specifying whether to overlay contour lines onto the heatmap using <code>contour</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contour.labels</code></td>
<td>
<p>For <code>image</code>, if <code>contour = TRUE</code> a logical specifying whether to overlay contour lines onto the heatmap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contour.drawlabels</code></td>
<td>
<p>For <code>image</code>, if <code>contour = TRUE</code> a logical specifying whether to overlay contour lines onto the heatmap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contour.cex</code></td>
<td>
<p>For <code>image</code>, if <code>contour = TRUE</code> and <code>contour.drawlabels = TRUE</code> a numeric specifying the label size for contour line labels (see <code>par</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contour.col</code></td>
<td>
<p>For <code>image</code>, if <code>contour = TRUE</code> a character string specifying a color for contour lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contour.lty</code></td>
<td>
<p>For <code>image</code>, if <code>contour = TRUE</code> an integer specifying a line type for contour lines (see <code>par</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contour.lwd</code></td>
<td>
<p>For <code>image</code>, if <code>contour = TRUE</code> an integer specifying a line width for contour lines (see <code>par</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to <code>persp</code> or <code>image</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>For <code>persp</code>, an integer vector specifying the value of <code>theta</code> in <code>persp</code>. If length greater than 1, multiple subplots are drawn with different rotations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>For <code>persp</code>, an integer vector specifying the value of <code>phi</code> in <code>persp</code>. If length greater than 1, multiple subplots are drawn with different rotations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shade</code></td>
<td>
<p>For <code>persp</code>, an integer vector specifying the value of <code>shade</code> in <code>persp</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zlab</code></td>
<td>
<p>A character string specifying the value of <code>zlab</code> (vertical axis label) in <code>persp</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ticktype</code></td>
<td>
<p>A character string specifying one of: “detailed” (the default) or “simple”. See <code>persp</code>.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>plot.margins</code>, <code>cplot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
  require('datasets')
  # prediction from several angles
  m &lt;- lm(mpg ~ wt*drat, data = mtcars)
  persp(m, theta = c(45, 135, 225, 315))

  # flat/heatmap representation
  image(m)

  # marginal effect of 'drat' across drat and wt
  m &lt;- lm(mpg ~ wt*drat*I(drat^2), data = mtcars)
  persp(m, xvar = "drat", yvar = "wt", what = "effect", 
        nx = 10, ny = 10, ticktype = "detailed")

  # a non-linear model
  m &lt;- glm(am ~ wt*drat, data = mtcars, family = binomial)
  persp(m, theta = c(30, 60)) # prediction
  # flat/heatmap representation
  image(m)

  # effects on linear predictor and outcome
  persp(m, xvar = "drat", yvar = "wt", what = "effect", type = "link")
  persp(m, xvar = "drat", yvar = "wt", what = "effect", type = "response")

## End(Not run)

</code></pre>


</div>