<div class="container">

<table style="width: 100%;"><tr>
<td>arma.filter</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>arma.filter</h2>

<h3>Description</h3>

<p>Filtering of (kvar-variate) time series with marima
type model.
</p>
<p>Calculation of residuals and filtered values of timeseries using
a marima model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">arma.filter(series = NULL, ar.poly = array(diag(kvar), dim = c(kvar, kvar,
  1)), ma.poly = array(diag(kvar), dim = c(kvar, kvar, 1)), means = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>series</code></td>
<td>
<p>matrix holding the kvar by n multivariate timeseries
(if (kvar &gt; n) the series is transposed and a warning is given).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ar.poly</code></td>
<td>
<p>(kvar, kvar, p+1) array containing autoregressive matrix
polynomial model part. If the filtering is to be performed for
undifferenced data when the analysis (in marima) was done for differenced
data, the input array ar.poly should incorporate the ar-representation
of the differensing operation (using, for example:
ar.poly &lt;- pol.mul(ar.estimate, dif.poly,
L = ( dim(ar.estimates)[3]+dim(dif.poly)[3])), where 'dif.poly'
was obtained when differencing the time series (using define.dif)
before analysing it with marima (giving the ar.estimate) .</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ma.poly</code></td>
<td>
<p>(kvar, kvar, q+1) array containing moving average matrix
polynomial model part.
</p>
<p>If a leading unity matrix is not included in the ar- and/or the ma-part
of the model this is automatically taken care of in the function
(in that case the dimensions of the model arrays used in arma.filter()
are, respectively, (kvar, kvar, p+1) and (kvar, kvar, q+1)).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>means</code></td>
<td>
<p>vector (length = kvar) indicating whether means are
subtracted or not (0/1). Default : means = 1 saying that all means
are subtracted (equivalent to means = c(1, 1, ..., 1)).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>estimates = estimated values for input series
</p>
<p>residuals = corresponding residuals. It is noted that the
residuals computed by arma.filter may deviate slightly from the
marima-residuals (which are taken from the last repeated regression
step performed). The residuals computed by arma.filter are constructed
by filtering (successive use of the arma model) and using a heuristic
method for the first residuals.
</p>
<p>averages = averages of variables in input series
</p>
<p>mean.pattern = pattern of means as used in filtering
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(marima)
data(austr)
series&lt;-t(austr)[,1:90]
# Define marima model
Model5 &lt;- define.model(kvar=7,ar=1,ma=1,rem.var=1,reg.var=6:7)

# Estimate marima model
Marima5 &lt;- marima(series,Model5$ar.pattern,Model5$ma.pattern,penalty=1)

# Calculate residuals by filtering
Resid &lt;- arma.filter(series, Marima5$ar.estimates,
     Marima5$ma.estimates)

# Compare residuals

plot(Marima5$residuals[2, 5:90], Resid$residuals[2, 5:90],
xlab='marima residuals', ylab='arma.filter residuals')

</code></pre>


</div>