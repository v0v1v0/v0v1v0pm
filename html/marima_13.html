<div class="container">

<table style="width: 100%;"><tr>
<td>marima.sim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>marima.sim</h2>

<h3>Description</h3>

<p>Simulation of multivariate arma model of
type 'marima'.
</p>


<h3>Usage</h3>

<pre><code class="language-R">marima.sim(kvar = 1, ar.model = NULL, ar.dif = NULL, ma.model = NULL,
  averages = rep(0, kvar), resid.cov = diag(kvar), seed = NULL,
  nstart = 0, nsim = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>kvar</code></td>
<td>
<p>dimension of one observation (from
kvar-variate time series).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ar.model</code></td>
<td>
<p>array holding the autoregressive part of model, 
organised as in the marima$ar.estimates. May be
empty (default = NULL) when there is no autoregressive part.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ar.dif</code></td>
<td>
<p>array holding differencing polynomium of model, 
typically generated by applying the function define.dif. May be
empty (default = NULL) when differencing is not included.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ma.model</code></td>
<td>
<p>array holding the moving average part of model, 
organised as in the marima$ma.estimates. May be
empty (default = NULL) when there is no moving average part.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>averages</code></td>
<td>
<p>vector holding the kvar averages of the
variables in the simulated series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resid.cov</code></td>
<td>
<p>(kvar x kvar) innovation covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>seed for random number generator (set.seed(seed)).
If the seed is set by the user, the random number generator is 
initialised. If seed is not set no initialisation is done.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nstart</code></td>
<td>
<p>number of extra observations in the start of the
simulated series to be left out before returning. If nstart=0
in calling marima.sim a suitable value is computed (see code).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>length of (final) simulated series.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Simulated kvar variate time series of length = nsim.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(marima)
data(austr)
old.data &lt;- t(austr)[, 1:83]
Model2   &lt;- define.model(kvar=7, ar=c(1), ma=c(1),
                    rem.var=c(1, 6, 7), indep=NULL)
Marima2  &lt;- marima(old.data, means=1, ar.pattern=Model2$ar.pattern, 
 ma.pattern=Model2$ma.pattern, Check=FALSE, Plot="none", penalty=4)

resid.cov  &lt;- Marima2$resid.cov
averages   &lt;- Marima2$averages
        ar &lt;- Marima2$ar.estimates
        ma &lt;- Marima2$ma.estimates

N    &lt;- 1000
kvar &lt;- 7

y.sim &lt;- marima.sim(kvar = kvar, ar.model = ar, ma.model = ma, 
  seed = 4711, averages = averages, resid.cov = resid.cov, nsim = N)

# Now simulate from model identified by marima (model=Marima2).
# The relevant ar and ma patterns are saved in 
# Marima2$out.ar.pattern and Marima2$out.ma.pattern, respectively: 

Marima.sim &lt;- marima( t(y.sim), means=1, 
     ar.pattern=Marima2$out.ar.pattern, 
     ma.pattern=Marima2$out.ma.pattern, 
     Check=FALSE, Plot="none", penalty=0) 

cat("Comparison of simulation model and estimates", 
" from simulated data. \n")
   round(Marima2$ar.estimates[, , 2], 4)
round(Marima.sim$ar.estimates[, , 2], 4)

   round(Marima2$ma.estimates[, , 2], 4)
round(Marima.sim$ma.estimates[, , 2], 4)

</code></pre>


</div>