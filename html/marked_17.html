<div class="container">

<table style="width: 100%;"><tr>
<td>create.dm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Creates a design matrix for a parameter</h2>

<h3>Description</h3>

<p>Creates a design matrix using the design dataframe, a formula and any
intervals defined for time, cohort and age.
</p>


<h3>Usage</h3>

<pre><code class="language-R">create.dm(x, formula, time.bins=NULL, cohort.bins=NULL, age.bins=NULL, 
                  chunk_size=1e7, remove.intercept=NULL,remove.unused.columns=TRUE)
       
       create.dml(ddl,model.parameters,design.parameters,restrict=FALSE,
             chunk_size=1e7,use.admb=FALSE,remove.unused.columns=TRUE,simplify=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>design dataframe created by <code>create.dmdf</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>formula for model in R format</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.bins</code></td>
<td>
<p>any bins of time to collapse values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cohort.bins</code></td>
<td>
<p>any bins of cohort to collapse values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>age.bins</code></td>
<td>
<p>any bins of cohort to collapse values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chunk_size</code></td>
<td>
<p>specifies amount of memory to use in creating design
matrices; amount used is 8*chunk_size/1e6 MB (default 80MB)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove.intercept</code></td>
<td>
<p>if TRUE, forces removal of intercept in design
matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove.unused.columns</code></td>
<td>
<p>if TRUE, unused columns are removed; otherwise they are left</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ddl</code></td>
<td>
<p>Design data list which contains a list element for each parameter
type; if NULL it is created</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design.parameters</code></td>
<td>
<p>Specification of any grouping variables for design
data for each parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.parameters</code></td>
<td>
<p>List of model parameter specifications</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>restrict</code></td>
<td>
<p>if TRUE, only use design data with Time &gt;= Cohort</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.admb</code></td>
<td>
<p>if TRUE uses mixed.model.admb for random effects; otherwise mixed.model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simplify</code></td>
<td>
<p>if TRUE simplies real parameter structure for some models; at this time it is not more efficient so ignore</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>create.dm returns a fixed effect design matrix constructed with the design dataframe and the
formula for a single parametre.  It excludes any columns that are all 0. create.dml returns a list with an element for
for each parameter with a sub-list for the fixed effect (fe) and random effects. The re structure depends
on switch use.admb. When TRUE, it contains a single design matrix (re.dm) and indices for random effects (re.indices).
When FALSE, it returns re.list which is a list with an element for each random component containing re.dm and indices for
that random effect (eg (1|id) + (1|time) would produce elements for id and time.
</p>


<h3>Author(s)</h3>

<p>Jeff Laake
</p>


</div>