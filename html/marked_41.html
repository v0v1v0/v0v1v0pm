<div class="container">

<table style="width: 100%;"><tr>
<td>js</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting function for Jolly-Seber model using Schwarz-Arnason POPAN
formulation</h2>

<h3>Description</h3>

<p>A function for computing MLEs for a specified Jolly-Seber open population
capture-recapture model for processed dataframe <code>x</code> with user specified
formulas in <code>parameters</code> that create list of design matrices
<code>dml</code>. This function can be called directly but is most easily called
from <code>crm</code> that sets up needed arguments.
</p>


<h3>Usage</h3>

<pre><code class="language-R">js(
  x,
  ddl,
  dml,
  model_data = NULL,
  parameters,
  accumulate = TRUE,
  initial = NULL,
  method = "BFGS",
  hessian = FALSE,
  debug = FALSE,
  chunk_size = 1e+07,
  refit,
  itnmax = NULL,
  control = NULL,
  scale,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>processed dataframe created by process.data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ddl</code></td>
<td>
<p>list of dataframes for design data; created by call to
<code>make.design.data</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dml</code></td>
<td>
<p>list of design matrices created by <code>create.dm</code> from
formula and design data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model_data</code></td>
<td>
<p>a list of all the relevant data for fitting the model including
imat, Phi.dm,p.dm,Phi.fixed,p.fixed, and time.intervals. It is used to save values
and avoid accumulation again if the model was re-rerun with an additional call to js when
using autoscale or re-starting with initial values.  It is stored with returned model object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>
<p>equivalent to <code>model.parameters</code> in <code>crm</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accumulate</code></td>
<td>
<p>if TRUE will accumulate capture histories with common
value and with a common design matrix for Phi and p to speed up execution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial</code></td>
<td>
<p>initial values for parameters if desired; if named vector
from previous run it will match to columns with same name</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>method to use for optimization; see <code>optimx</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessian</code></td>
<td>
<p>if TRUE will compute and return the hessian</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debug</code></td>
<td>
<p>if TRUE will print out information for each iteration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chunk_size</code></td>
<td>
<p>specifies amount of memory to use in accumulating capture
histories; amount used is 8*chunk_size/1e6 MB (default 80MB)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>refit</code></td>
<td>
<p>non-zero entry to refit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>itnmax</code></td>
<td>
<p>maximum number of iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>control string for optimization functions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>vector of scale values for parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>any remaining arguments are passed to additional parameters
passed to <code>optimx</code> or <code>js.lnl</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>It is easiest to call <code>js</code> through the function <code>crm</code>.
Details are explained there.
</p>
<p>Be cautious with this function at present.  It does not include many checks
to make sure values like fixed values will remain in the specified range of
the data.  Normally this would not be a big problem but because
<code>js.lnl</code> calls an external FORTRAN subroutine via
<code>cjs.lnl</code>, if it gets a subscirpt out of bounds, it will cause R
to terminate.  So make sure to save your workspace frequently if you use
this function in its current implementation.
</p>


<h3>Value</h3>

<p>The resulting value of the function is a list with the class of
crm,js such that the generic functions print and coef can be used.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>named vector of parameter estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lnl</code></td>
<td>
<p>-2*log
likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AIC</code></td>
<td>
<p>lnl + 2* number of parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>result from <code>optimx</code>; if 0 <code>optimx</code> thinks it
converged</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>count</code></td>
<td>
<p><code>optimx</code> results of number of function
evaluations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reals</code></td>
<td>
<p>dataframe of data and real Phi and p estimates for
each animal-occasion excluding those that occurred before release</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcv</code></td>
<td>
<p>var-cov matrix of betas if hessian=TRUE was set</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jeff Laake
</p>


<h3>References</h3>

<p>Schwarz, C. J., and A. N. Arnason. 1996. A general methodology
for the analysis of capture-recapture experiments in open populations.
Biometrics 52:860-873.
</p>


</div>