<div class="container">

<table style="width: 100%;"><tr>
<td>HMMLikelihood</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Hidden Markov Model likelihood functions</h2>

<h3>Description</h3>

<p>Function HMMLikelihood computes the log-likelihood via hmm.lnl which is a wrapper for the
FORTRAN code hmm_like.f.  The function HMMlikelihood is called from optimizer and it in turn calls hmm.lnl after
setting up parameters.
</p>
<p>For an R version of the HMMLikelihood and related code see <code>R_HMMLikelihood</code>
</p>


<h3>Usage</h3>

<pre><code class="language-R">HMMLikelihood(par,type,xx,xstart,mx,T,freq=1,fct_dmat,fct_gamma,fct_delta,ddl,
                         dml,parameters,debug=FALSE,return.mat=FALSE,sup=NULL,check=FALSE)
       reals(ddl,dml,parameters,parlist,indices=NULL)
       hmm.lnl(x,start,m,T,dmat,gamma,delta,freq,debug)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>vector of parameter values for log-likelihood evaluation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>vector of parameter names used to split par vector into types</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xx</code></td>
<td>
<p>matrix of observed sequences (row:id; column:occasion/time); xx used instead of x to avoid conflict in optimx</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xstart</code></td>
<td>
<p>for each ch, the first non-zero x value and the occasion of the first non-zero value; ; xstart used instead of start to avoid conflict in optimx</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mx</code></td>
<td>
<p>number of states; mx used instead of m to avoid conflict in optimx</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T</code></td>
<td>
<p>number of occasions; sequence length</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freq</code></td>
<td>
<p>vector of history frequencies or 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fct_dmat</code></td>
<td>
<p>function to create D from parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fct_gamma</code></td>
<td>
<p>function to create gamma - transition matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fct_delta</code></td>
<td>
<p>function to create initial state distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ddl</code></td>
<td>
<p>design data list of parameters for each id</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dml</code></td>
<td>
<p>list of design matrices; one entry for each parameter; each entry contains fe and re for fixed and random effects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>
<p>formulas for each parameter type</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debug</code></td>
<td>
<p>if TRUE, print out par values and -log-likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.mat</code></td>
<td>
<p>If TRUE, returns list of transition, observation and delta arrays.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sup</code></td>
<td>
<p>list of supplemental information that may be needed by the function but only needs to be computed once; currently only used for MVMS models for dmat</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check</code></td>
<td>
<p>if TRUE, checks validity of gamma, dmat and delta to look for any errors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>same as xx but for call to hmm.lnl</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>same as mx but for call to hmm.lnl</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dmat</code></td>
<td>
<p>observation probability matrices</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>transition matrices</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>initial distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parlist</code></td>
<td>
<p>list of parameter strings used to split par vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>same as xstart but for hmm.lnl</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indices</code></td>
<td>
<p>specific indices for computation unless NULL</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>HMMLikelihood returns log-likelihood for a single sequence and
hmm.lnl returns the negative log-likelihood value for each capture history. reals
returns either the column dimension of design matrix for parameter or the real parameter vector
</p>


<h3>Author(s)</h3>

<p>Jeff Laake
</p>


<h3>References</h3>

<p>Zucchini, W. and I.L. MacDonald. 2009. Hidden Markov Models for Time Series: An Introduction using R. Chapman and Hall, Boca Raton, FL. 275p.
</p>


<h3>See Also</h3>

<p>R_HMMLikelihood
</p>


</div>