<div class="container">

<table style="width: 100%;"><tr>
<td>pca_pen</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Penalized Principal Component Analysis for Marker Gene Selection</h2>

<h3>Description</h3>

<p>This function solves the optimization problem
</p>
<p style="text-align: center;"><code class="reqn">\min\quad-\mathrm{tr}(SX) + \lambda p(X),</code>
</p>

<p style="text-align: center;"><code class="reqn">s.t.\quad O\preceq X \preceq I, \quad X \ge 0, \quad\mathrm{and}\quad \mathrm{tr}(X)=1,</code>
</p>

<p>where <code class="reqn">O\preceq X \preceq I</code> means all eigenvalues of <code class="reqn">X</code> are
between 0 and 1, <code class="reqn">X \ge 0</code> means all elements of <code class="reqn">X</code> are nonnegative,
and <code class="reqn">p(X)</code> is a penalty function defined in the article
(see the <strong>References</strong> section).
</p>


<h3>Usage</h3>

<pre><code class="language-R">pca_pen(
  S,
  gr,
  lambda,
  w = 1.5,
  alpha = 0.01,
  maxit = 1000,
  eps = 1e-04,
  verbose = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>The sample correlation matrix of gene expression.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gr</code></td>
<td>
<p>Indices of genes that are treated as markers in the prior information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Tuning parameter to control the sparsity of eigenvectors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>Tuning parameter to control the weight on prior information.
Larger <code class="reqn">w</code> means genes not in the prior list are less likely
to be selected as markers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Step size of the optimization algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>Maximum number of iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>Tolerance parameter for convergence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Level of verbosity.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the following components:
</p>

<dl>
<dt>projection</dt>
<dd>
<p>The estimated projection matrix.</p>
</dd>
<dt>evecs</dt>
<dd>
<p>The estimated eigenvectors.</p>
</dd>
<dt>niter</dt>
<dd>
<p>Number of iterations used in the optimization process.</p>
</dd>
<dt>err_v</dt>
<dd>
<p>The optimization error in each iteration.</p>
</dd>
</dl>
<h3>References</h3>

<p>Qiu, Y., Wang, J., Lei, J., &amp; Roeder, K. (2020).
Identification of cell-type-specific marker genes from co-expression patterns in tissue samples.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)
n = 200  # Sample size
p = 500  # Number of genes
s = 50   # Number of true signals

# The first s genes are true markers, and others are noise
Sigma = matrix(0, p, p)
Sigma[1:s, 1:s] = 0.9
diag(Sigma) = 1

# Simulate data from the covariance matrix
x = matrix(rnorm(n * p), n) %*% chol(Sigma)

# Sample correlation matrix
S = cor(x)

# Indices of prior marker genes
# Note that we have omitted 10 true markers, and included 10 false markers
gr = c(1:(s - 10), (s + 11):(s + 20))

# Run the algorithm
res = pca_pen(S, gr, lambda = 0.1, verbose = 1)

# See if we can recover the true correlation structure
image(res$projection, asp = 1)

</code></pre>


</div>