<div class="container">

<table style="width: 100%;"><tr>
<td>LR.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Log-rank based test for the validity of the Markov assumption.</h2>

<h3>Description</h3>

<p>Function LR.test performs the log-rank test described in
Titman &amp; Putter (2020).
</p>


<h3>Usage</h3>

<pre><code class="language-R">LR.test(
  data,
  times = times,
  from,
  to,
  replicas = 1000,
  formula = NULL,
  fn = list(function(x) mean(abs(x), na.rm = TRUE)),
  fn2 = list(function(x) mean(x, na.rm = TRUE)),
  min_time = 0,
  other_weights = NULL,
  dist = c("poisson", "normal")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Multi-state data in <code>msdata</code> format. Should also contain
(dummy codings of) the relevant covariates; no factors allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>Grid of time points at which to compute the statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>from</code></td>
<td>
<p>The starting state of the transition to check the Markov 
condition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>to</code></td>
<td>
<p>The last state of the considered transition to check the 
Markov condition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replicas</code></td>
<td>
<p>Number of wild bootstrap replications to perform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>Right-hand side of the formula. If NULL will fit with no
covariates (formula="1" will also work), offset terms can also be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fn</code></td>
<td>
<p>A list of summary functions to be applied to the individual zbar
traces (or a list of lists)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fn2</code></td>
<td>
<p>A list of summary functions to be applied to the overall
chi-squared trace</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_time</code></td>
<td>
<p>The minimum time for calculating optimal weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>other_weights</code></td>
<td>
<p>Other (than optimal) weights can be specified here</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>Distribution of wild bootstrap random weights, either "poisson"
for centred Poisson (default), or "normal" for standard normal</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>LR.test returns an object of class "markovMSM", which is a list
with the following items: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>localTestLR</code></td>
<td>
<p>p-value of AUC local tests for each times and transitions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>globalTestLR</code></td>
<td>
<p>p-value of AUC global tests for each transition</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>Grid of time points at which to compute the statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replicas</code></td>
<td>
<p>Number of wild bootstrap replications to perform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>Expression of the LR.test used.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Gustavo Soutinho and Luis Meira-Machado.
</p>


<h3>References</h3>

<p>Titman AC, Putter H (2020). General tests of the Markov property
in multi-state models. <em>Biostatistics</em>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
set.seed(1234)
library(markovMSM)
data("colonMSM")
positions&lt;-list(c(2, 3), c(3), c())
namesStates =  c("Alive", "Rec",  "Death")
tmat &lt;-transMatMSM(positions, namesStates)
timesNames = c(NA, "time1","Stime")
status=c(NA, "event1","event")
trans = tmat
db_long&lt;- prepMSM(data=colonMSM, trans, timesNames, status)
res&lt;-LR.test(data=db_long, times=180, from = 2, to = 3, replicas = 1000)
res$globalTestLR

times&lt;-c(73.5, 117, 223, 392, 681)
res2&lt;-LR.test(data=prothr, times=times, from = 2, to = 3, replicas = 1000)
res2$localTestLR
res2$globalTestLR

res3&lt;-LR.test(data=prothr, times=times, from = 2, to = 1, replicas = 1000)
res3$localTestLR
res3$globalTestLR

</code></pre>


</div>