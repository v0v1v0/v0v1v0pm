<div class="container">

<table style="width: 100%;"><tr>
<td>PHM.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cox PH global test for checking the Markov condition on Multi-state 
Models.</h2>

<h3>Description</h3>

<p>This function is used to obtain a global test to check the 
Markov condition for each transition based on Cox Proportional hazard models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PHM.test(data, from, to)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame in long format containing the subject <code>id</code>;
<code>from</code> corresponding to the starting state;the receiving state, 
<code>to</code>; the transition number, <code>trans</code>; the  starting time of the 
transition given by <code>Tstart</code>; the stopping time of the transition, 
<code>Tstop</code>, and <code>status</code> for the  status variable, with 1 indicating
an event (transition), 0 a censoring.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>from</code></td>
<td>
<p>The starting state of the transition to check the Markov 
condition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>to</code></td>
<td>
<p>The last state of the considered transition to check the 
Markov condition.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object with a list with the following outcomes:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>p-value of Cox global tests for each transition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>from</code></td>
<td>
<p>The starting state of the transition to check the Markov 
condition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>to</code></td>
<td>
<p>The last state of the considered transition to check the 
Markov condition.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Gustavo Soutinho and Luis Meira-Machado.
</p>


<h3>References</h3>

<p>Kay, R (1986). A Markov model for analyzing cancer markers and 
disease states in survival studies. <em>Biometrics</em> 42, 457-481.
Soutinho G, Meira-Machado L (2021). Methods for checking the Markov condition
in multi-state survival data. <em>Computational Statistics</em>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(markovMSM)
data("colonMSM")
db_wide&lt;-colonMSM
positions&lt;-list(c(2, 3), c(3), c())
namesStates =  c("Alive", "Rec",  "Death")
tmat &lt;-transMatMSM(positions, namesStates)
timesNames = c(NA, "time1","Stime")
status=c(NA, "event1","event")
trans = tmat
db_long&lt;- prepMSM(data=db_wide, trans, timesNames, status)
res1&lt;-PHM.test(data=db_long, from = 2, to=3)
res1

data("ebmt4")
db_wide &lt;- ebmt4
positions=list(c(2, 3, 5, 6), c(4, 5, 6), c(4, 5, 6),
               c(5, 6), c(6), c())
namesStates = c("Tx", "Rec", "AE", "Rec+AE", "Rel", "Death")
tmat &lt;-transMatMSM(positions, namesStates)
timesNames = c(NA, "rec", "ae","recae", "rel", "srv")
status=c(NA, "rec.s", "ae.s", "recae.s","rel.s", "srv.s")
trans = tmat
db_long&lt;- prepMSM(data=db_wide, trans, timesNames, status)
db_long$trans&lt;-as.factor(db_long$trans)
res2&lt;-PHM.test(data=db_long, from = 5, to=6)
res2$p.value
res2$from
res2$to
</code></pre>


</div>