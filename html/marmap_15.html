<div class="container">

<table style="width: 100%;"><tr>
<td>dist2isobath</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Computes the shortest great circle distance between any point and a given isobath
</h2>

<h3>Description</h3>

<p>Computes the shortest (great circle) distance between a set of points and an isoline of depth or altitude. Points can be selected interactively by clicking on a map.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dist2isobath(mat, x, y=NULL, isobath=0, locator=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mat</code></td>
<td>

<p>Bathymetric data matrix of class <code>bathy</code>, as imported with <code>read.bathy</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>Either a list of two elements (numeric vectors of longitude and latitude), a 2-column matrix or data.frame of longitudes and latitudes, or a numeric vector of longitudes.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>Either <code>NULL</code> (default) or a numerical vector of latitudes. Ignored if <code>x</code> is not a numeric vector.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>isobath</code></td>
<td>

<p>A single numerical value indicating the isobath to which the shortest distance is to be computed (default is set to 0, <em>i.e.</em> the coastline).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>locator</code></td>
<td>

<p>Logical. Whether to choose data points interactively with a map or not. If <code>TRUE</code>, a bathymetric map must have been plotted and both <code>x</code> and <code>y</code> are both ignored.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Further arguments to be passed to <code>locator</code> when the interactive mode is used (<code>locator=TRUE</code>).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>dist2isobath</code> allows the user to compute the shortest great circle distance between a set of points (selected interactively on a map or not) and a user-defined isobath. <code>dist2isobath</code> takes advantage of functions from packages <code>sp</code> (<code>Lines()</code> and <code>SpatialLines()</code>) and <code>geosphere</code> (<code>dist2Line</code>) to compute the coordinates of the nearest location along a given isobath for each point provided by the user.
</p>


<h3>Value</h3>

<p>A 5-column data.frame. The first column contains the distance in meters between each point and the nearest point located on the given <code>isobath</code>. Columns 2 and 3 indicate the longitude and latitude of starting points (<em>i.e.</em> either coordinates provided as <code>x</code> and <code>y</code> or coordinates of points selected interactively on a map when <code>locator=TRUE</code>) and columns 4 and 5 contains coordinates (longitudes and latitudes) arrival points <em>i.e.</em> the nearest points on the <code>isobath</code>.
</p>


<h3>Author(s)</h3>

<p>Benoit Simon-Bouhet
</p>


<h3>See Also</h3>

<p><code>linesGC</code>, <code>lc.dist</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load NW Atlantic data and convert to class bathy
data(nw.atlantic)
atl &lt;- as.bathy(nw.atlantic)

# Create vectors of latitude and longitude
lon &lt;- c(-70, -65, -63, -55, -48)
lat &lt;- c(33, 35, 40, 37, 33)

# Compute distances between each point and the -200m isobath
d &lt;- dist2isobath(atl, lon, lat, isobath = -200)
d

# Visualize the great circle distances
blues &lt;- c("lightsteelblue4","lightsteelblue3","lightsteelblue2","lightsteelblue1")
plot(atl, image=TRUE, lwd=0.1, land=TRUE, bpal = list(c(0,max(atl),"grey"), c(min(atl),0,blues)))
plot(atl, deep=-200, shallow=-200, step=0, lwd=0.6, add=TRUE)
points(lon,lat, pch=21, col="orange4", bg="orange2", cex=.8)
linesGC(d[2:3],d[4:5])
</code></pre>


</div>