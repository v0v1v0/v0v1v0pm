<div class="container">

<table style="width: 100%;"><tr>
<td>subsetSQL</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Creating and querying local SQL database for bathymetric data
</h2>

<h3>Description</h3>

<p><code>subsetSQL</code> queries the local SQL database created with <code>setSQL</code> to extract smaller data subsets.
</p>


<h3>Usage</h3>

<pre><code class="language-R">setSQL(bathy, header = TRUE, sep = ",", db.name = "bathy_db")
subsetSQL(min_lon, max_lon, min_lat, max_lat, db.name = "bathy_db")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>bathy</code></td>
<td>

<p>A text file containing a comma-separated, three-column table with longitude, latitude and depth data (no default)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>header</code></td>
<td>

<p>does the xyz file contains a row of column names (default = TRUE)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sep</code></td>
<td>

<p>character separating columns in the xyz file, (default=",")
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_lon</code></td>
<td>

<p>minimum longitude of the data to be extracted from the local SQL database
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_lon</code></td>
<td>

<p>maximum longitude of the data to be extracted from the local SQL database
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_lat</code></td>
<td>

<p>minimum latitude of the data to be extracted from the local SQL database
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_lat</code></td>
<td>

<p>maximum latitude of the data to be extracted from the local SQL database
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>db.name</code></td>
<td>

<p>The name of (or path to) the SQL database to be created on disk by <code>setSQL</code> or from which <code>subsetSQL</code> will extract data ("bathy_db" by default)
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Functions <code>setSQL</code> and <code>subsetSQL</code> were built to work together. <code>setSQL</code> builds an SQL database and saves it on disk. <code>subsetSQL</code> queries that local database and the fields <code>min_lon</code>, <code>max_lon</code>, etc, are used to extract a subset of the database. The functions were built as two entities so that multiple queries can be done multiple times, without re-building the database each time. These functions were designed to access the very large (&gt;5Go) ETOPO 2022 file that can be downloaded from the NOAA website (<a href="https://www.ncei.noaa.gov/products/etopo-global-relief-model">https://www.ncei.noaa.gov/products/etopo-global-relief-model</a>)
</p>


<h3>Value</h3>

<p><code>setSQL</code> returns <code>TRUE</code> if the database was successfully created. <code>subsetSQL</code> returns a matrix of class <code>bathy</code> that can directly be used with <code>plot.bathy</code>.
</p>


<h3>Note</h3>

<p>If unspecified, <code>db.name</code> is set to "bathy_db" by default. Thus, theere must be no database file called <code>bathy_db</code> in the working directory prior to running <code>setSQL</code> unless a different name is used for the new database.
Make sure that your "bathy" input is a xyz text file (for function <code>setSQL</code>) with 3 columns containing longitude, latitude and depth data, in that order.
<code>setSQL</code> and <code>subsetSQL</code> were modified on Nov. 2, 2014 to comply with RSQLite 1.0.0.
</p>


<h3>Author(s)</h3>

<p>Eric Pante
</p>


<h3>References</h3>

<p>NOAA National Centers for Environmental Information. 2022: ETOPO 2022 15 Arc-Second Global Relief Model. NOAA National Centers for Environmental Information. <a href="https://doi.org/doi.org/10.25921/fd45-gt74">doi:doi.org/10.25921/fd45-gt74</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# load NW Atlantic data
data(nw.atlantic)

# write data to disk as a comma-separated text file
write.table(nw.atlantic, "NW_Atlantic.csv", sep=",", quote=FALSE, row.names=FALSE)

# prepare SQL database
setSQL(bathy="NW_Atlantic.csv")

# uses data from the newly-created SQL database:
subsetSQL(min_lon=-70,max_lon=-50,
             min_lat=35, max_lat=41) -&gt; test

# visualize the results (of class bathy)
summary(test)

# remove temporary database and CSV files
system("rm bathy_db") # remove file, for unix-like systems
system("rm NW_Atlantic.csv") # remove file, for unix-like systems

## End(Not run)
</code></pre>


</div>