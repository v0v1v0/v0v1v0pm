<div class="container">

<table style="width: 100%;"><tr>
<td>marquee_parse</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Parse a text as marquee</h2>

<h3>Description</h3>

<p>marquee uses an extension of CommonMark with no support for HTML code (it is
rendered verbatim). The focus is to allow easy formatting of text for
graphics, rather than fully fledged typesetting. See <em>marquee syntax</em> for
more about the format.
</p>


<h3>Usage</h3>

<pre><code class="language-R">marquee_parse(text, style = classic_style(), ignore_html = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>text</code></td>
<td>
<p>A character string. The core quality of markdown is that any text
is valid markdown so there is no restrictions on the content</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>style</code></td>
<td>
<p>A style set such as <code>classic_style()</code> that defines how the text
should be rendered</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ignore_html</code></td>
<td>
<p>Should HTML code be removed from the output</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data frame describing the various tokens of the text and the style
to apply to them. The output is mainly meant for programmatic consumption
such as in <code>marquee_grob()</code>
</p>


<h3>marquee tags</h3>

<p>marquee tokenizes the input text into blocks and spans. It recognises the
following tags:
</p>
<p><strong>Block tags</strong>
</p>
<p><code>body</code> is the parent tag of a markdown document. It never contains any text
itself, only other blocks.
</p>
<p><code>ul</code> is an unordered list. It contains a number of <code>li</code> children
</p>
<p><code>ol</code> is an ordered list. It contains a number of <code>li</code> children
</p>
<p><code>li</code> is a list element. If the list is tight it contains text directly inside
of it. If not, text are placed inside child <code>p</code> blocks
</p>
<p><code>hr</code> is a horizontal line, spanning the width of the parent block. For
styling, the bottom border size is used when rendering
</p>
<p><code>h1</code>-<code>h6</code> are headings at different levels
</p>
<p><code>cb</code> is a code block. Text inside code blocks are rendered verbatim, i.e. it
cannot contain any children
</p>
<p><code>p</code> is a standard paragraph block. Text separated by two line-ends are
separated into separate paragraphs
</p>
<p><code>qb</code> is a quote block. It may contain children
</p>
<p><strong>Span tags</strong>
</p>
<p><code>em</code> is an emphasized text span. Often this means italicizing the text, but
it is ultimately up to the renderer
</p>
<p><code>str</code> is strong text, often rendered with bold text
</p>
<p><code>a</code> is a link text. While marquee rendering doesn't allow for links, it can
still be rendered in a particular way
</p>
<p><code>code</code> is text rendered as code. Often this uses a monospaced font. Text
inside this span is rendered verbatim
</p>
<p><code>u</code> is text that should be underlined
</p>
<p><code>del</code> is text that should have strikethrough
</p>
<p><em>custom spans</em> is a marquee specific extension to the syntax that allows you
to make up tags on the fly. See the section on marquee syntax for more.
</p>


<h3>marquee syntax</h3>

<p>marquee uses md4c which is a fully CommonMark compliant markdown parser.
CommonMark is an effort to create an internally coherent markdown
specification, something that was missing from the original markdown
description. If you are used to writing markdown, you are used to CommonMark.
Below is a list of notable additions or details about the specific way
marquee handles CommonMark
</p>
<p><strong>Underlines and strikethrough</strong>
</p>
<p>While not part of the basic CommonMark spec, underline and strikethrough are
supported by marquee using <code style="white-space: pre;">⁠_⁠</code> and <code>~</code> (e.g. <code style="white-space: pre;">⁠_underline this_⁠</code> and <code style="white-space: pre;">⁠~this was an error~⁠</code>).
</p>
<p><strong>Images</strong>
</p>
<p>Image tags (<code style="white-space: pre;">⁠![image title](path/to/image)⁠</code>) are supported, but the title is
ignored. The path is returned as the token text.
</p>
<p><strong>HTML</strong>
</p>
<p>HTML tags are ignored, i.e. they are rendered verbatim. This is not that
different from classic markdown rendering except that people often convert
markdown to HTML where these tags suddenly have meaning. They do not carry
any special significance when rendered with marquee
</p>
<p><strong>Custom tags</strong>
</p>
<p>While markdown provides most of what is necessary for standard text markup,
there are situations, especially in visualisation, where we need something
more. Often users reach for inline HTML spans for that, but since HTML is
fully ignored in marquee this is not an option. Further, adding in HTML
decreases readability of the unformatted text a lot.
</p>
<p>With marquee you can create a custom span using the <code style="white-space: pre;">⁠{.tag &lt;some text&gt;}⁠</code>
syntax, e.g. <code style="white-space: pre;">⁠{.sm small text}⁠</code> to wrap "small text" in the <code>sm</code> tag. You can
alternatively use <code style="white-space: pre;">⁠{#tag &lt;some text&gt;}⁠</code> for the same effect. The only
difference is that in the former syntax the <code>.</code> is stripped from the tag name,
whereas in the latter the <code style="white-space: pre;">⁠#⁠</code> remains part of the name. See the Styling
section for the primal use of the latter syntax.
</p>


<h3>Styling</h3>

<p>During parsing, each token is assigned a style based on the provided style
set. The styling is cascading, but without the intricacies of CSS. A child
element inherits the styling of it's parent for the options that are set to
<code>NULL</code> in the style matching the child tag. Any style element that are
<code>relative()</code> are computed based on the value of the parent style element.
<code>em()</code> elements are resolved based on the size element of the child style,
and <code>rem()</code> elements are resolved using the size element of the <code>body</code> style.
If a style is not provided for the tag, it fully inherits the style of it's
parent.
</p>
<p><strong>Automatic coloring</strong>
Recognizing that the primary use for custom tags may be to change the color
of some text, marquee provides a shortcut for this. If a style is not found
for the tag in the provided style set, marquee will check if the tag matches
a valid color (i.e. a string from <code>grDevices::colors()</code>, or a valid hex
string, e.g. <code style="white-space: pre;">⁠#53f2a9⁠</code>). If it is a valid color it will set this as the font
color of the style. This means that parsing <code>"Color {.red this} red"</code>
automatically sets the color of <code>"this"</code> to red, even if no style is provided
for the <code>red</code> tag. Likewise, parsing <code>"Color {#00FF00 me} green"</code> will
automatically set the color of <code>"me"</code> to #00FF00 (fully saturated green).
</p>


<h3>Additional parsing information</h3>

<p>Apart from splitting the text up into tokens, <code>marquee_parse()</code> also provides
some additional information useful for rendering the output in the expected
way. The <code>id</code> column refers the tokens back to the original input text, the
<code>block</code> relates tokens together into blocks. Block elements increment the
block count when they are entered, and decrement it when they are excited.
The <code>type</code> column provides the type of the block. The <code>indentation</code> column
provides the node level in the tree. A child block will increase the
indentation for as long as it is active. <code>ol_index</code> provides the number
associated with the ordered list element. <code>tight</code> indicates whether the list
is tight (i.e. it was provided with no empty lines between list elements).
The <code>ends</code> column indicate until which row in the output the tag is active
(i.e. the tag is closed after the row indicated by the value in this column).
</p>


<h3>Examples</h3>

<pre><code class="language-R">marquee_parse("# Header of the example\nSome body text", classic_style())

</code></pre>


</div>