<div class="container">

<table style="width: 100%;"><tr>
<td>gregTree</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute a regression tree estimator</h2>

<h3>Description</h3>

<p>Calculates a regression tree estimator for a finite population mean/proportion or total based on sample data collected from a complex sampling design and auxiliary population data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gregTree(
  y,
  xsample,
  xpop,
  pi = NULL,
  pi2 = NULL,
  var_est = FALSE,
  var_method = "LinHB",
  B = 1000,
  pval = 0.05,
  perm_reps = 500,
  bin_size = NULL,
  fpc = TRUE,
  messages = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A numeric vector of the sampled response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xsample</code></td>
<td>
<p>A data frame of the auxiliary data in the sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xpop</code></td>
<td>
<p>A data frame of population level auxiliary information.  It must contain the same names as xsample.  If datatype = "raw", must contain unit level data.  If datatype = "totals" or "means", then contains one row of aggregated, population totals or means for the auxiliary data. Default is "raw".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi</code></td>
<td>
<p>A numeric vector of inclusion probabilities for each sampled unit in y.  If NULL, then simple random sampling without replacement is assumed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi2</code></td>
<td>
<p>A square matrix of the joint inclusion probabilities.  Needed for the "LinHT" variance estimator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_est</code></td>
<td>
<p>A logical indicating whether or not to compute a variance estimator.  Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_method</code></td>
<td>
<p>The method to use when computing the variance estimator.  Options are a Taylor linearized technique: "LinHB"= Hajek-Berger estimator, "LinHH" = Hansen-Hurwitz estimator, "LinHTSRS" = Horvitz-Thompson estimator under simple random sampling without replacement, and "LinHT" = Horvitz-Thompson estimator or a resampling technique: "bootstrapSRS" = bootstrap variance estimator under simple random sampling without replacement. The default is "LinHB".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>The number of bootstrap samples if computing the bootstrap variance estimator.  Default is 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval</code></td>
<td>
<p>Designated p-value level to reject null hypothesis in permutation test used to fit the regression tree. Default value is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perm_reps</code></td>
<td>
<p>An integer specifying the number of permutations for each permutation test run to fit the regression tree. Default value is 500.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bin_size</code></td>
<td>
<p>A integer specifying the minimum number of observations in each node.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fpc</code></td>
<td>
<p>Default to TRUE, logical for whether or not the variance calculation should include a finite population correction when calculating the "LinHTSRS" or the "SRSbootstrap" variance estimator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>messages</code></td>
<td>
<p>A logical indicating whether to output the messages internal to mase. Default is TRUE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of output containing:
</p>
<p>* pop_total: Estimate of population total.
</p>
<p>* pop_mean: Estimate of the population mean (or proportion).
</p>
<p>* weights: Survey weights produced by gregTree.
</p>
<p>* pop_total_var: Estimated variance of population total estimate.
</p>
<p>* pop_mean_var: Estimated variance of population mean estimate.
</p>


<h3>References</h3>

<p>McConville K~S, Toth D (2018).
“Automated selection of post-strata using a model-assisted regression tree estimator.”
<em>Scandinavian Journal of Statistics</em>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(dplyr)
data(IdahoPop)
data(IdahoSamp)

xsample &lt;- filter(IdahoSamp, COUNTYFIPS == "16055") 
xpop &lt;- filter(IdahoSamp, COUNTYFIPS == "16055")

gregTree(y = xsample$BA_TPA_ADJ,
         xsample = xsample[c("tcc", "elev")],
         xpop = xpop[c("tcc", "elev")],
         var_est = TRUE)

</code></pre>


</div>