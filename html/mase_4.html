<div class="container">

<table style="width: 100%;"><tr>
<td>horvitzThompson</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute the Horvitz-Thompson Estimator</h2>

<h3>Description</h3>

<p>Calculate the Horvitz-Thompson Estimator for a finite population mean/proportion or total based on sample data collected from a complex sampling design.
</p>


<h3>Usage</h3>

<pre><code class="language-R">horvitzThompson(
  y,
  pi = NULL,
  N = NULL,
  pi2 = NULL,
  var_est = FALSE,
  var_method = "LinHB",
  B = 1000,
  fpc = TRUE,
  messages = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A numeric vector of the sampled response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi</code></td>
<td>
<p>A numeric vector of inclusion probabilities for each sampled unit in y.  If NULL, then simple random sampling without replacement is assumed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>A numeric value of the population size. If NULL, it is estimated with the sum of the inverse of the pis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi2</code></td>
<td>
<p>A square matrix of the joint inclusion probabilities.  Needed for the "LinHT" variance estimator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_est</code></td>
<td>
<p>A logical indicating whether or not to compute a variance estimator.  Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_method</code></td>
<td>
<p>The method to use when computing the variance estimator.  Options are a Taylor linearized technique: "LinHB"= Hajek-Berger estimator, "LinHH" = Hansen-Hurwitz estimator, "LinHTSRS" = Horvitz-Thompson estimator under simple random sampling without replacement, and "LinHT" = Horvitz-Thompson estimator or a resampling technique: "bootstrapSRS" = bootstrap variance estimator under simple random sampling without replacement. The default is "LinHB".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>The number of bootstrap samples if computing the bootstrap variance estimator.  Default is 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fpc</code></td>
<td>
<p>Default to TRUE, logical for whether or not the variance calculation should include a finite population correction when calculating the "LinHTSRS" or the "SRSbootstrap" variance estimator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>messages</code></td>
<td>
<p>A logical indicating whether to output the messages internal to mase. Default is TRUE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>List of output containing:
</p>
<p>* pop_total: Estimate of population total.
</p>
<p>* pop_mean: Estimate of population mean.
</p>
<p>* pop_total_var: Estimated variance of population total estimate.
</p>
<p>* pop_mean_var: Estimated variance of population mean estimate.
</p>


<h3>References</h3>

<p>Horvitz DG, Thompson DJ (1952).
“A generalization of sampling without replacement from a finite universe.”
<em>Journal of the American Statistical Association</em>, <b>47</b>, 663-685.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(dplyr)
data(IdahoSamp)
data(IdahoPop)
xsample &lt;- filter(IdahoSamp, COUNTYFIPS == "16055")
xpop &lt;- filter(IdahoPop, COUNTYFIPS == "16055") 

horvitzThompson(y = xsample$BA_TPA_ADJ,
                N = xpop$npixels,
                var_est = TRUE,
                var_method = "LinHTSRS")

</code></pre>


</div>