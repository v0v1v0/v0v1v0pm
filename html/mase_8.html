<div class="container">

<table style="width: 100%;"><tr>
<td>postStrat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute a post-stratified estimator</h2>

<h3>Description</h3>

<p>Calculates a post-stratified estimator for a finite population mean/proportion or total based on sample data collected from a complex sampling design and a single, categorical auxiliary population variable.
</p>


<h3>Usage</h3>

<pre><code class="language-R">postStrat(
  y,
  xsample,
  xpop,
  pi = NULL,
  N = NULL,
  var_est = FALSE,
  var_method = "LinHB",
  pi2 = NULL,
  datatype = "raw",
  B = 1000,
  fpc = TRUE,
  messages = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A numeric vector of the sampled response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xsample</code></td>
<td>
<p>A vector containing the post-stratum for each sampled unit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xpop</code></td>
<td>
<p>A vector or data frame, depending on datatype.  If datatype = "raw", then a vector containing the post-stratum for each population unit.  If datatype = "totals" or "means", then a data frame, where the first column lists the possible post-strata and the second column contains the population total or proportion in each post-stratum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi</code></td>
<td>
<p>A numeric vector of inclusion probabilities for each sampled unit in y.  If NULL, then simple random sampling without replacement is assumed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>A numeric value of the population size. If NULL, it is estimated with the sum of the inverse of the pis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_est</code></td>
<td>
<p>Default to FALSE, logical for whether or not to compute estimate of variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_method</code></td>
<td>
<p>The method to use when computing the variance estimator.  Options are a Taylor linearized technique: "LinHB"= Hajek-Berger estimator, "LinHH" = Hansen-Hurwitz estimator, "LinHTSRS" = Horvitz-Thompson estimator under simple random sampling without replacement, and "LinHT" = Horvitz-Thompson estimator or a resampling technique: "bootstrapSRS" = bootstrap variance estimator under simple random sampling without replacement, "SRSunconditional" = simple random sampling variance estimator which accounts for random strata.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi2</code></td>
<td>
<p>A square matrix of the joint inclusion probabilities.  Needed for the "LinHT" variance estimator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datatype</code></td>
<td>
<p>Default to "raw", takes values "raw", "totals" or "means" for whether the user is providing the raw population stratum memberships, the population totals of each stratum, or the population proportions of each stratum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>The number of bootstrap samples if computing the bootstrap variance estimator.  Default is 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fpc</code></td>
<td>
<p>Default to TRUE, logical for whether or not the variance calculation should include a finite population correction when calculating the "LinHTSRS", "SRSunconditional", or the "SRSbootstrap" variance estimator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>messages</code></td>
<td>
<p>A logical indicating whether to output the messages internal to mase. Default is TRUE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of output containing:
</p>
<p>* pop_total: Estimate of population total.
</p>
<p>* pop_mean: Estimate of the population mean (or proportion).
</p>
<p>* pop_total_var: Estimated variance of population total estimate.
</p>
<p>* pop_mean_var: Estimated variance of population mean estimate.
</p>
<p>* strat_ests: Table of total and mean estimates for each strata.
</p>
<p>* weights: Survey weights produced by PS.
</p>


<h3>References</h3>

<p>Cochran W~G (1977).
<em>Sampling Techniques</em>, 3rd edition.
John Wiley &amp; Sons, New York. 
</p>
<p>Sarndal C~E, Swensson B, Wretman J (1992).
<em>Model Assisted Survey Sampling</em>.
Springer-Verlag, New York.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(tidyr)
library(dplyr)

data(IdahoPop)
data(IdahoSamp)

xsample &lt;- filter(IdahoSamp, COUNTYFIPS == "16055")
xpop &lt;- filter(IdahoPop, COUNTYFIPS == "16055")

pop &lt;- xpop[c("tnt.1", "tnt.2")] |&gt; 
    pivot_longer(everything(), names_to = "tnt", values_to = "prop") |&gt;
    mutate(tnt = as.numeric(gsub("\\D", "", tnt)))
    
postStrat(y = xsample$BA_TPA_ADJ,
          N = xpop$npixels,
          xsample = xsample$tnt,
          xpop = pop,
          datatype = "means",
          var_est = TRUE,
          var_method = "SRSunconditional")
          
</code></pre>


</div>