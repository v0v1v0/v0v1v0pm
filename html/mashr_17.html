<div class="container">

<table style="width: 100%;"><tr>
<td>cov_ed</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Perform "extreme deconvolution" (Bovy et al) on a subset of
the data</h2>

<h3>Description</h3>

<p>Perform "extreme deconvolution" (Bovy et al) on a subset of
the data
</p>


<h3>Usage</h3>

<pre><code class="language-R">cov_ed(data, Ulist_init, subset = NULL, algorithm = c("bovy", "teem"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a mash data object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ulist_init</code></td>
<td>
<p>a named list of covariance matrices to use to
initialize ED; default is to use matrices from PCs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>a subset of data to be used when ED is run (set to
NULL for all the data)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>algorithm</code></td>
<td>
<p>algorithm to run ED</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments to be passed to ED algorith, see
<code>extreme_deconvolution</code> for algorithm 'bovy', or
<code>teem_wrapper</code> for algorithm 'teem'</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Runs the extreme deconvolution algorithm from Bovy et al
(Annals of Applied Statistics) to estimate data-driven covariance
matrices. It can be initialized with, for example running <code>cov_pca</code> with,
say, 5 PCs.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data = mash_set_data(Bhat = cbind(c(1,2),c(3,4)), Shat = cbind(c(1,1),c(1,1)))
U_pca = cov_pca(data,2)
U_x = apply(data$Bhat, 2, function(x) x - mean(x))
U_xx = t(U_x) %*% U_x / nrow(U_x)
cov_ed(data,c(U_pca, list(xx = U_xx)))

## End(Not run)

</code></pre>


</div>