<div class="container">

<table style="width: 100%;"><tr>
<td>mash_compute_vloglik</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute vector of loglikelihood for fitted mash object on
new data</h2>

<h3>Description</h3>

<p>Compute vector of loglikelihood for fitted mash object on
new data
</p>


<h3>Usage</h3>

<pre><code class="language-R">mash_compute_vloglik(g, data, algorithm.version = c("Rcpp", "R"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>A mash object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A set of data on which to compute the loglikelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>algorithm.version</code></td>
<td>
<p>Indicate R or Rcpp version</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The log-likelihood for each element is <code class="reqn">p(Bhat_j |
Shat_j,g,\alpha)</code> where <code class="reqn">Bhat_j | B_j, Shat_j \sim N(B_j,
Shat_j)</code> and <code class="reqn">B_j/Shat_j^\alpha | Shat_j \sim g</code> Here the value
of <code class="reqn">\alpha</code> is set when setting up the data object in
'mash_set_data'. If g is a mash object (safest!) then the function
will check that this value matches the <code class="reqn">\alpha</code> used when
fitting 'mash'. Note: as a convenience, this function can also be
called with g a mixture distribution with same structure as the
fitted_g from a mash object. This is mostly useful when doing
simulations, where you might want to compute the likelihood under
the "true" g. When used in this way the user is responsible for
making sure that the g makes sense with the alpha set in data.
</p>


<h3>Value</h3>

<p>The vector of log-likelihoods for each data point computed
using g.
</p>


<h3>Examples</h3>

<pre><code class="language-R">simdata = simple_sims(50,5,1)
data = mash_set_data(simdata$Bhat, simdata$Shat)
m = mash(data, cov_canonical(data))
mash_compute_vloglik(m,data)

</code></pre>


</div>