<div class="container">

<table style="width: 100%;"><tr>
<td>massiveORT</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>A wrapper to fisher.test to get over representation analysis of gene sets.</h2>

<h3>Description</h3>

<p>The function massiveORT essentially is a wrapper to the function fisher.test in charge to 1) arrange the input to feed fisher.test in sequence for each gene set, 2) arrange the output in a data frame compatible with the other function of the package, and 3) compute the universe of genes for the analysis. </p>


<h3>Usage</h3>

<pre><code class="language-R">massiveORT(gene_list, gene_sets, universe = NULL, 
          alternative = c("greater", "less", "two.sided"))</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>gene_list</code></td>
<td>
<p>a list of gene names, or gene ids that have to match the corresponidng in the gene-set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gene_sets</code></td>
<td>
<p>a character vector of gene-sets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>universe</code></td>
<td>
<p>a list of gene, or gene ids, that defines the universe for the analysis (see details); NULL by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis of the fisher.test; must be one of "two.sided", "greater" (default) or "less".</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function allows to define externally or compute the universe of reference of the analysis. By default (universe = NULL), the universe is computed starting from the gene names contributing at least once in each gene set. </p>


<h3>Value</h3>

<p>A data frame with columns
</p>
<table>
<tr style="vertical-align: top;">
<td><code>universe_size</code></td>
<td>
<p>size of the universe of genes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geneList_size</code></td>
<td>
<p>size of intersection between the gene list and the universe.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geneSet_size</code></td>
<td>
<p>size of intersection between the gene set and the universe.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geneList_in_GenesSet_size</code></td>
<td>
<p>size of the intersection between the geneList and the geneSet.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>odds_ratio</code></td>
<td>
<p>odd ratio coming from the fisher.test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log2_odds_ratio</code></td>
<td>
<p>log2 transformation of odds_ratio.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>p-values associated with the gene-set coming from the fisher.test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BH.value</code></td>
<td>
<p>Benijamini and Hockberg adjustment of the p.values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B.value</code></td>
<td>
<p>Bonferroni adjustment of the p.values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>relevance</code></td>
<td>
<p>marginal ordering of the table.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Stefano M. Pagnotta</p>


<h3>References</h3>

<p>Cerulo, Pagnotta (2022) <a href="https://doi.org/10.3390/e24050739">doi:10.3390/e24050739</a></p>


<h3>See Also</h3>

<p>fisher.test, cut_by_significance</p>


<h3>Examples</h3>

<pre><code class="language-R">library(massiveGST)

# get the gene profile
fname &lt;- system.file("extdata", package="massiveGST")
fname &lt;- file.path(fname, "pre_ranked_list.txt")
geneProfile &lt;- get_geneProfile(fname)
geneList &lt;- names(head(geneProfile, 1000))

# get the gene-sets
geneSets &lt;- get_geneSets_from_msigdbr(category = "C5", subcategory = "CC", what = "gene_symbol")
geneSets &lt;- geneSets[1:250]

# run the function
ans &lt;- massiveORT(geneList, geneSets)
cut_by_significance(ans)

plot(cut_by_significance(ans), geneSets,as.network = TRUE)
</code></pre>


</div>