<div class="container">

<table style="width: 100%;"><tr>
<td>mastSpectralDensity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Volatility and period for mast data</h2>

<h3>Description</h3>

<p>Extracts time series attributes for tree or population fecundity.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  mastSpectralDensity( x, maxPeriod = length(x)/2, PLOT = FALSE, ylim = NULL )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p><code>numeric vector</code> of sequential fecundity values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxPeriod</code></td>
<td>
<p>the number of frequencies/periods to include.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PLOT</code></td>
<td>
<p><code>logical</code> to plot spectrum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>if <code>PLOT</code>, values for lower and upper bounds.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Returns attributes of volatility and period for a sequence of fecundity values for a single tree (or population) in <code>x</code>, which may often be on a log scale.  
</p>
<p>More detailed examples can be obtained with: <code>browseVignettes('mastif')</code>
</p>


<h3>Value</h3>

<p>Returns a <code>list</code> that includes <code>spect</code>, a <code>matrix</code> of power values ordered by frequency (1/period). To permit comparisons between series that differ in length, <code>totVar</code> (total variance) and <code>volatility</code> (period-weighted variance) are divided by the length of the series. Mean and standard deviation for the weighted period are <code>periodMu</code> and <code>periodSd</code>.
</p>


<h3>Author(s)</h3>

<p>James S Clark, <a href="mailto:jimclark@duke.edu">jimclark@duke.edu</a>
</p>


<h3>References</h3>

<p>Qiu, T, ..., and J.S. Clark. 2023. Mutualist dispersers and the global distribution of masting: mediation by climate and fertility. in review.
</p>


<h3>See Also</h3>

<p><code>mastif</code> for analysis
</p>
<p>A more detailed vignette is can be obtained with:
</p>
<p><code>browseVignettes('mastif')</code>
</p>
<p>website 'http://sites.nicholas.duke.edu/clarklab/code/'.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
d &lt;- "https://github.com/jimclarkatduke/mast/blob/master/outputAbies.rdata?raw=True"
repmis::source_data( d )

# single Abies tree from fitted output$prediction$fecPred:

wt &lt;- which( fecPred$treeID == "BAMT1-1" )
s  &lt;- mastSpectralDensity( log(fecPred$fecEstMu[ wt ]), PLOT = TRUE )

# population year effects (log scale) for an ecoRegion_species in output$parameters$betaYrRand:

x &lt;- betaYrRand['3_abiesAmabilis', ]    
x &lt;- x[ x != 0 ]                        # ecoRegion_species vary in observation years
s &lt;- mastSpectralDensity( x, PLOT = TRUE )

</code></pre>


</div>