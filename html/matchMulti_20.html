<div class="container">

<table style="width: 100%;"><tr>
<td>matchSchools</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Match Schools on Student-based Distance</h2>

<h3>Description</h3>

<p>Takes in a school distance matrix created using information from the
first-stage student match and matches schools optimally, potentially
</p>


<h3>Usage</h3>

<pre><code class="language-R">matchSchools(
  dmat,
  students,
  treatment,
  school.id,
  school.fb,
  penalty,
  verbose,
  tol,
  solver = "rlemon"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dmat</code></td>
<td>
<p>a distance matrix for schools, with a row for each treated
school and a column for each control school.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>students</code></td>
<td>
<p>a dataframe containing student and school covariates, with a
different row for each student.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treatment</code></td>
<td>
<p>the column name of the binary treatment status indicator in
the <code>students</code> dataframe.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>school.id</code></td>
<td>
<p>the column name of the unique school ID in the
<code>students</code> dataframe.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>school.fb</code></td>
<td>
<p>an optional list of character vectors, each containing a
subset of the column names of <code>students</code>.  Each element of the list
should contain all the names in previous elements (producing a nested
structure).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>
<p>a numeric value, treated as the cost to the objective
function of excluding a treated school.  If it is set lower, more schools
will be excluded.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>a logical value indicating whether detailed output should be
printed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>a numeric tolerance value for comparing distances.  It may need
to be raised above the default when matching with many levels of refined
balance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>solver</code></td>
<td>
<p>Name of package used to solve underlying network flow problem, 
one of 'rlemon' and 'rrelaxiv'.  rrelaxiv carries an 
academic license and is not hosted on CRAN so it must be installed 
separately.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>school.fb</code> argument encodes a refined covariate balance
constraint: the matching algorithm optimally balances the interaction of the
variables in the first list element, then attempts to further balance the
interaction in the second element, and so on.  As such variables should be
added in order of priority for balance.
</p>


<h3>Value</h3>

<p>a dataframe with two columns, one containing treated school IDs and
the other containing matched control school IDs.
</p>


<h3>Author(s)</h3>

<p>Luke Keele, Penn State University, <a href="mailto:ljk20@psu.edu">ljk20@psu.edu</a>
</p>
<p>Sam Pimentel, University of California, Berkeley, <a href="mailto:spi@berkeley.edu">spi@berkeley.edu</a>
</p>


</div>