<div class="container">

<table style="width: 100%;"><tr>
<td>matchStudents</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute Student Matches for all Pairs of Schools</h2>

<h3>Description</h3>

<p>Iterates over all possible treated-control school pairs, optionally computes
and stores an optimal student match for each one, and generates a distance
matrix for schools based on the quality of each student match.
</p>


<h3>Usage</h3>

<pre><code class="language-R">matchStudents(
  students,
  treatment,
  school.id,
  match.students,
  student.vars,
  school.caliper = NULL,
  verbose,
  penalty.qtile,
  min.keep.pctg
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>students</code></td>
<td>
<p>a dataframe containing student covariates, with a different
row for each student.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treatment</code></td>
<td>
<p>the column name of the binary treatment status indicator in
the <code>students</code> dataframe.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>school.id</code></td>
<td>
<p>the column name of the unique school ID in the
<code>students</code> dataframe.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>match.students</code></td>
<td>
<p>logical value.  If <code>TRUE</code>, students are matched
within school pairs and some students will be excluded.  If <code>FALSE</code>,
all students will be retained in the matched sample for each school pair.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>student.vars</code></td>
<td>
<p>column names of variables in <code>students</code> on which to
match students and assess balance of student matches in evaluating match
quality.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>school.caliper</code></td>
<td>
<p>matrix with one row for each treated school and one
column for each control school, containing zeroes for pairings allowed by
the caliper and <code>Inf</code> values for forbidden pairings.  When <code>NULL</code>
no caliper is imposed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>a logical value indicating whether detailed output should be
printed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty.qtile</code></td>
<td>
<p>a numeric value between 0 and 1 specifying a quantile
of the distribution of all student-student matching distances.  The
algorithm will prefer to exclude treated students rather than form pairs
with distances exceeding this quantile.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.keep.pctg</code></td>
<td>
<p>a minimum percentage of students in the smaller school
in a pair which must be retained, even when treated students are excluded.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>penalty.qtile</code> and <code>min.keep.pctg</code> control the rate at which
students are trimmed from the match.  If the quantile is high enough no
students should be excluded in any match; if the quantile is very low the
<code>min.keep.pctg</code> can still ensure a minimal sample size in each match.
</p>


<h3>Value</h3>

<p>A list with two elements: </p>
<table>
<tr style="vertical-align: top;">
<td><code>student.matches</code></td>
<td>
<p> a list with one
element for each treated school.  Each element is a list with one element
for each control school, and each element of these secondary lists is a
dataframe containing the matched sample for the corresponding
treated-control pairing. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>schools.matrix</code></td>
<td>
<p> a matrix with one row for
each treated school and one column for each control school, giving matching
distances based on the student match. </p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Luke Keele, Penn State University, <a href="mailto:ljk20@psu.edu">ljk20@psu.edu</a>
</p>
<p>Sam Pimentel, University of California, Berkeley, <a href="mailto:spi@berkeley.edu">spi@berkeley.edu</a>
</p>


</div>