<div class="container">

<table style="width: 100%;"><tr>
<td>is.symmetric.matrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Is a matrix symmetric or positive-definite?</h2>

<h3>Description</h3>

<p>Determines if a matrix is square, symmetric, positive-definite, or positive semi-definite.
</p>


<h3>Usage</h3>

<pre><code class="language-R">is.square.matrix(A)

is.symmetric.matrix(A, tol = .Machine$double.eps^0.5)

is.positive.semi.definite(A, tol = .Machine$double.eps^0.5)

is.positive.definite(A, tol = .Machine$double.eps^0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>A numeric matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>A numeric tolerance level used to check if a matrix is symmetric. That is, a matrix is symmetric if the difference between the matrix and its transpose is between -<code>tol</code> and <code>tol</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A tolerance is added to indicate if a matrix <em>A</em> is approximately symmetric. If <em>A</em> is not symmetric, a message and first few rows of the matrix is printed. If <em>A</em> has any missing values, NA is returned.
</p>

<ul>
<li> <p><code>is.symmetric.matrix</code> returns TRUE if <em>A</em> is a numeric, square and symmetric matrix; otherwise, returns FALSE.  A matrix is symmetric if the absolute difference between <em>A</em> and its transpose is less than <code>tol</code>.
</p>
</li>
<li> <p><code>is.positive.semi.definite</code> returns TRUE if a real, square, and symmetric matrix <em>A</em> is positive semi-definite.  A matrix is positive semi-definite if its smallest eigenvalue is greater than or equal to zero.
</p>
</li>
<li> <p><code>is.positive.definite</code> returns TRUE if a real, square, and symmetric matrix  <em>A</em> is positive-definite.  A matrix is positive-definite if its smallest eigenvalue is greater than zero.
</p>
</li>
</ul>
<h3>Note</h3>

<p>Functions are adapted from Frederick Novomestky's <span class="pkg">matrixcalc</span> package in order to implement the <code>rmatnorm</code> function. The following changes are made: </p>

<ul>
<li>
<p>  I changed argument x to A to reflect usual matrix notation.
</p>
</li>
<li>
<p> For <code>is.symmetric</code>, I added a tolerance so that <em>A</em> is symmetric even provided small differences between <em>A</em> and its transpose. This is useful for <code>rmatnorm</code> function, which was used repeatedly to generate matrixNormal random variates in a Markov chain.
</p>
</li>
<li>
<p> For <code>is.positive.semi.definite</code> and <code>is.positive.definite</code>,  I also saved time by avoiding a <code>for-loop</code> and instead calculating the minimum of eigenvalues.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">## Example 0: Not square matrix
B &lt;- matrix(c(1, 2, 3, 4, 5, 6), nrow = 2, byrow = TRUE)
B
is.square.matrix(B)

## Example 1: Not a matrix. should get an error.
df &lt;- as.data.frame(matrix(c(1, 2, 3, 4, 5, 6), nrow = 2, byrow = TRUE))
df
## Not run: 
is.square.matrix(df)

## End(Not run)

## Example 2: Not symmetric &amp; compare against matrixcalc
F &lt;- matrix(c(1, 2, 3, 4), nrow = 2, byrow = TRUE)
F
is.square.matrix(F)
is.symmetric.matrix(F) # should be FALSE
if (!requireNamespace("matrixcalc", quietly = TRUE)) {
  matrixcalc::is.symmetric.matrix(F)
} else {
  message("you need to install the package matrixcalc to compare this example")
}

## Example 3: Symmetric but negative-definite. The functions are same.
# eigenvalues are  3 -1
G &lt;- matrix(c(1, 2, 2, 1), nrow = 2, byrow = TRUE)
G
is.symmetric.matrix(G)
if (!requireNamespace("matrixcalc", quietly = TRUE)) {
  matrixcalc::is.symmetric.matrix(G)
} else {
  message("you need to install the package matrixcalc to compare this example.")
}
isSymmetric.matrix(G)
is.positive.definite(G) # FALSE
is.positive.semi.definite(G) # FALSE

## Example 3b: A missing value in G
G[1, 1] &lt;- NA
is.symmetric.matrix(G) # NA
is.positive.definite(G) # NA

## Example 4: positive definite matrix
# eigenvalues are 3.4142136 2.0000000 0.585786
Q &lt;- matrix(c(2, -1, 0, -1, 2, -1, 0, -1, 2), nrow = 3, byrow = TRUE)
is.symmetric.matrix(Q)
is.positive.definite(Q)

## Example 5: identity matrix is always positive definite
I &lt;- diag(1, 3)
is.square.matrix(I) # TRUE
is.symmetric.matrix(I) # TRUE
is.positive.definite(I) # TRUE
</code></pre>


</div>