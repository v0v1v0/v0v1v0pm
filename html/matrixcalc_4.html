<div class="container">

<table style="width: 100%;"><tr>
<td>D.matrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Duplication matrix </h2>

<h3>Description</h3>

<p>This function constructs the linear transformation D that maps
vech(A) to vec(A) when A is a symmetric matrix
</p>


<h3>Usage</h3>

<pre><code class="language-R">D.matrix(n)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p> a positive integer value for the order of the underlying matrix </p>
</td>
</tr></table>
<h3>Details</h3>

<p>Let <code class="reqn">{\bf{T}}_{i,j}</code> be an <code class="reqn">n \times n</code> matrix with 1 in its <code class="reqn">\left( {i,j} \right)</code> element <code class="reqn">1 \le i,j \le n</code>.
and zeroes elsewhere. These matrices are constructed by the function <code>T.matrices</code>.  The formula for the
transpose of matrix <code class="reqn">\bf{D}</code> is <code class="reqn">{\bf{D'}} = \sum\limits_{j = 1}^n {\sum\limits_{i = j}^n {{{\bf{u}}_{i,j}}\;{{\left( {vec\;{{\bf{T}}_{i,j}}} \right)}^\prime }} } </code>
where <code class="reqn">{{{\bf{u}}_{i,j}}}</code> is the column vector in the order <code class="reqn">\frac{1}{2}n\left( {n + 1} \right)</code> identity
matrix for column <code class="reqn">k = \left( {j - 1} \right)n + i - \frac{1}{2}j\left( {j - 1} \right)</code>.  The function
<code>u.vectors</code> generates these vectors.
</p>


<h3>Value</h3>

<p>It returns an <code class="reqn">{n^2}\; \times \;\frac{1}{2}n\left( {n + 1} \right)</code> matrix.
</p>


<h3>Author(s)</h3>

<p> Frederick Novomestky <a href="mailto:fnovomes@poly.edu">fnovomes@poly.edu</a> </p>


<h3>References</h3>

<p>Magnus, J. R. and H. Neudecker (1980). The elimination matrix, some lemmas and applications,
<em>SIAM Journal on Algebraic Discrete Methods</em>, 1(4), December 1980, 422-449.
</p>
<p>Magnus, J. R. and H. Neudecker (1999). <em>Matrix Differential Calculus with Applications in Statistics and Econometrics</em>,
Second Edition, John Wiley.
</p>


<h3>See Also</h3>

<p><code>T.matrices</code>,
<code>u.vectors</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">D &lt;- D.matrix( 3 )
A &lt;- matrix( c( 1, 2, 3,
                2, 3, 4,
                3, 4, 5), nrow=3, byrow=TRUE )
vecA &lt;- vec( A )
vechA&lt;- vech( A )
y &lt;- D %*% vechA
print( y )
print( vecA )
</code></pre>


</div>