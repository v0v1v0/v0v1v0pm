<div class="container">

<table style="width: 100%;"><tr>
<td>MoE,mph-method</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit method for mph/miph class, using mixture-of-experts regression</h2>

<h3>Description</h3>

<p>Fit method for mph/miph class, using mixture-of-experts regression
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'mph'
MoE(
  x,
  formula,
  y,
  data,
  alpha_mat = NULL,
  delta = numeric(0),
  stepsEM = 1000,
  r = 1,
  maxit = 100,
  reltol = 1e-08,
  rand_init = T
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class mph.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a regression formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A matrix of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame of covariates (they need to be scaled for the regression).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_mat</code></td>
<td>
<p>Matrix with initial distribution vectors for each row of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>Matrix with right-censoring indicators (1 uncensored, 0 right censored).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stepsEM</code></td>
<td>
<p>Number of EM steps to be performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>Sub-sampling parameter, defaults to 1 (not supported for this method).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>Maximum number of iterations when optimizing the g function (inhomogeneous likelihood).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reltol</code></td>
<td>
<p>Relative tolerance when optimizing g function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rand_init</code></td>
<td>
<p>Random initiation in the R-step of the EM algorithm.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">under_mph &lt;- mph(structure = c("general", "general"), dimension = 3) 
x &lt;-  miph(under_mph, gfun = c("weibull", "weibull"), gfun_pars = list(c(2), c(3)))
n &lt;- 100
responses &lt;- cbind(rexp(n), rweibull(n, 2, 3))
covariates &lt;- data.frame(age = sample(18:65, n, replace = TRUE) / 100, income = runif(n, 0, 0.99))
f &lt;- responses ~ age + income
MoE(x = x, formula = f, y = responses, data = covariates, stepsEM = 20)
</code></pre>


</div>