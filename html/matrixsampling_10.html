<div class="container">

<table style="width: 100%;"><tr>
<td>rmatrixt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Matrix t sampler</h2>

<h3>Description</h3>

<p>Samples the matrix t-distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rmatrixt(n, nu, M, U, V, checkSymmetry = TRUE, keep = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>sample size, a positive integer</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>degrees of freedom, a positive number</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>mean matrix, without constraints</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U</code></td>
<td>
<p>columns covariance matrix, a positive semidefinite matrix of order equal
to <code>nrow(M)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>rows covariance matrix, a positive semidefinite matrix of order equal
to <code>ncol(M)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>checkSymmetry</code></td>
<td>
<p>logical, whether to check the symmetry of <code>U</code> and <code>V</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep</code></td>
<td>
<p>logical, whether to return an array with class <span class="pkg">keep</span></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A numeric three-dimensional array;
simulations are stacked along the third dimension (see example).
</p>


<h3>Note</h3>

<p>When <code>p=1</code> and <code>V=nu</code> or when <code>m=1</code> and <code>U=nu</code>, the
distribution is the multivariate t-distribution.
</p>


<h3>Examples</h3>

<pre><code class="language-R">nu &lt;- 4
m &lt;- 2
p &lt;- 3
M &lt;- matrix(1, m, p)
U &lt;- toeplitz(m:1)
V &lt;- toeplitz(p:1)
Tsims &lt;- rmatrixt(10000, nu, M, U, V)
dim(Tsims) # 2 3 10000
apply(Tsims, 1:2, mean) # approximates M
vecTsims &lt;- t(apply(Tsims, 3, function(X) c(t(X))))
round(cov(vecTsims), 1) # approximates 1/(nu-2) * kronecker(U,V)
## the `keep` class is nice when m=1 or p=1:
Tsims &lt;- rmatrixt(2, nu, M=1:3, U=diag(3), V=1)
Tsims[,,1] # dimensions 3 1
# without `keep`, dimensions are lost:
rmatrixt(2, nu, M=1:3, U=diag(3), V=1, keep=FALSE)[,,1]
</code></pre>


</div>