<div class="container">

<table style="width: 100%;"><tr>
<td>rwishart</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Wishart sampler</h2>

<h3>Description</h3>

<p>Samples a Wishart distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rwishart(n, nu, Sigma, Theta = NULL, epsilon = 0,
  checkSymmetry = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>sample size, a positive integer</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>degrees of freedom, a positive number;
if <code>nu &lt; p-1</code> where <code>p</code> is the dimension (the order of <code>Sigma</code>),
must be an integer;
in the noncentral case (i.e. when <code>Theta</code> is not the null matrix), <code>nu</code>
must satisfy <code>nu &gt;= p-1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>scale matrix, a positive semidefinite real matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Theta</code></td>
<td>
<p>noncentrality parameter, a positive semidefinite real matrix of
same order as <code>Sigma</code>; setting it to <code>NULL</code> (default) is
equivalent to setting it to the zero matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>a number involved in the algorithm only if it positive; its role
is to guarantee the invertibility of the sampled matrices; see Details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>checkSymmetry</code></td>
<td>
<p>logical, whether to check the symmetry of <code>Sigma</code>
and <code>Theta</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The argument <code>epsilon</code> is a threshold whose role is to guarantee
that the algorithm samples invertible matrices when <code>nu &gt; p-1</code> and
<code>Sigma</code> is positive definite.
The sampled matrices are theoretically invertible under these conditions,
but due to numerical issues, they are not always invertible when
<code>nu</code> is close to <code>p-1</code>, i.e. when <code>nu-p+1</code> is small.
In this case, the chi-squared distributions involved in the algorithm can
generate zero values or values close to zero, yielding the non-invertibility
of the sampled matrices. These values are replaced with <code>epsilon</code> if they are
smaller than <code>epsilon</code>.
</p>


<h3>Value</h3>

<p>A numeric three-dimensional array;
simulations are stacked along the third dimension (see example).
</p>


<h3>Note</h3>

<p>A sampled Wishart matrix is always positive semidefinite.
It is positive definite if <code>nu &gt; p-1</code> and <code>Sigma</code> is positive
definite, in theory (see Details).
</p>
<p>In the noncentral case, i.e. when <code>Theta</code> is not null, the Ahdida &amp; Alfonsi
algorithm is used if <code>nu</code> is not an integer and <code>p-1 &lt; nu &lt; 2p-1</code>, or
if <code>nu = p-1</code>. The simulations are slower in this case.
</p>


<h3>References</h3>

<p>A. Ahdida &amp; A. Alfonsi. Exact and high-order discretization schemes
for Wishart processes and their affine extensions.
<em>The Annals of Applied Probability</em> <strong>23</strong>, 2013, 1025-1073.
</p>


<h3>Examples</h3>

<pre><code class="language-R">nu &lt;- 4
p &lt;- 3
Sigma &lt;- toeplitz(p:1)
Theta &lt;- diag(p)
Wsims &lt;- rwishart(10000, nu, Sigma, Theta)
dim(Wsims) # 3 3 10000
apply(Wsims, 1:2, mean) # approximately nu*Sigma+Theta
# the epsilon argument:
Wsims_det &lt;- apply(rwishart(10000, nu=p-1+0.001, Sigma), 3, det)
length(which(Wsims_det &lt; .Machine$double.eps))
Wsims_det &lt;- apply(rwishart(10000, nu=p-1+0.001, Sigma, epsilon=1e-8), 3, det)
length(which(Wsims_det &lt; .Machine$double.eps))
</code></pre>


</div>