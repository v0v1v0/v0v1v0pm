<div class="container">

<table style="width: 100%;"><tr>
<td>rmatrixbeta</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Matrix Beta sampler</h2>

<h3>Description</h3>

<p>Samples a matrix Beta (type I) distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rmatrixbeta(n, p, a, b, Theta1 = NULL, Theta2 = NULL, def = 1,
  checkSymmetry = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>sample size, a positive integer</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>dimension, a positive integer</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a, b</code></td>
<td>
<p>parameters of the distribution, positive numbers with constraints given
in Details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Theta1</code></td>
<td>
<p>numerator noncentrality parameter, a positive semidefinite real
matrix of order <code>p</code>; setting it to <code>NULL</code> (default) is
equivalent to setting it to the zero matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Theta2</code></td>
<td>
<p>denominator noncentrality parameter, a positive semidefinite real
matrix of order <code>p</code>; setting it to <code>NULL</code> (default) is
equivalent to setting it to the zero matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>def</code></td>
<td>
<p><code>1</code> or <code>2</code>, the definition used; see Details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>checkSymmetry</code></td>
<td>
<p>logical, whether to check the symmetry of <code>Theta1</code>
and <code>Theta2</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A Beta random matrix <code class="reqn">U</code> is defined as follows.
Take two independent Wishart random matrices
S<sub>1</sub> ~ W<sub>p</sub>(2a,I<sub>p</sub>,Θ<sub>1</sub>)
and
S<sub>2</sub> ~ W<sub>p</sub>(2b,I<sub>p</sub>,Θ<sub>2</sub>).
</p>

<ul>
<li> <p><strong>definition 1</strong>:
U = (S<sub>1</sub>+S<sub>2</sub>)<sup>-½</sup>S<sub>1</sub>(S<sub>1</sub>+S<sub>2</sub>)<sup>-½</sup></p>
</li>
<li> <p><strong>definition 2</strong>:
U = S<sub>1</sub><sup>½</sup>(S<sub>1</sub>+S<sub>2</sub>)<sup>-1</sup>S<sub>1</sub><sup>½</sup></p>
</li>
</ul>
<p>In the central case, the two definitions yield the same distribution.
Under definition 2, the Beta distribution is related to the Beta type II
distribution by
U ~ V(I+V)<sup>-1</sup>.
</p>
<p>Parameters <code>a</code> and <code>b</code> are positive numbers that satisfy the
following constraints:
</p>

<ul>
<li>
<p> if both <code>Theta1</code> and <code>Theta2</code> are the null matrix,
<code>a+b &gt; (p-1)/2</code>; if <code>a &lt; (p-1)/2</code>, it must be half an integer;
if <code>b &lt; (p-1)/2</code>, it must be half an integer
</p>
</li>
<li>
<p> if <code>Theta1</code> is not the null matrix, <code>a &gt;= (p-1)/2</code>;
if <code>b &lt; (p-1)/2</code>, it must be half an integer
</p>
</li>
<li>
<p> if <code>Theta2</code> is not the null matrix, <code>b &gt;= (p-1)/2</code>;
if <code>a &lt; (p-1)/2</code>, it must be half an integer</p>
</li>
</ul>
<h3>Value</h3>

<p>A numeric three-dimensional array;
simulations are stacked along the third dimension (see example).
</p>


<h3>Warning</h3>

<p>Definition 2 requires the calculation of the square root of
S<sub>1</sub> ~ W<sub>p</sub>(2a,I<sub>p</sub>,Θ<sub>1</sub>)
(see Details). While S<sub>1</sub> is always
positive semidefinite in theory, it could happen that the simulation of
S<sub>1</sub> is not positive semidefinite,
especially when <code>a</code> is small. In this case the calculation of the square root
will return <code>NaN</code>.
</p>


<h3>Note</h3>

<p>The matrix variate Beta distribution is usually defined only for
<code class="reqn">a &gt; (p-1)/2</code> and <code class="reqn">b &gt; (p-1)/2</code>. In this case, a random matrix <code class="reqn">U</code>
generated from this distribution satisfies <code class="reqn">0 &lt; U &lt; I</code>.
For an half integer <code class="reqn">a \le (p-1)/2</code>, it satisfies <code class="reqn">0 \le U &lt; I</code>
and <code class="reqn">rank(U)=2a</code>.
For an half integer <code class="reqn">b \le (p-1)/2</code>, it satisfies <code class="reqn">0 &lt; U \le I</code>
and <code class="reqn">rank(I-U)=2b</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">Bsims &lt;- rmatrixbeta(10000, 3, 1, 1)
dim(Bsims) # 3 3 10000
</code></pre>


</div>