<div class="container">

<table style="width: 100%;"><tr>
<td>rmatrixnormal</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Matrix normal sampler</h2>

<h3>Description</h3>

<p>Samples the matrix normal distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rmatrixnormal(n, M, U, V, checkSymmetry = TRUE, keep = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>sample size, a positive integer</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>mean matrix, without constraints</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U</code></td>
<td>
<p>columns covariance matrix, a positive semidefinite matrix of order equal
to <code>nrow(M)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>rows covariance matrix, a positive semidefinite matrix of order equal
to <code>ncol(M)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>checkSymmetry</code></td>
<td>
<p>logical, whether to check the symmetry of <code>U</code> and <code>V</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep</code></td>
<td>
<p>logical, whether to return an array with class <span class="pkg">keep</span></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A numeric three-dimensional array;
simulations are stacked along the third dimension (see example).
</p>


<h3>Examples</h3>

<pre><code class="language-R">m &lt;- 3
p &lt;- 2
M &lt;- matrix(1, m, p)
U &lt;- toeplitz(m:1)
V &lt;- toeplitz(p:1)
MNsims &lt;- rmatrixnormal(10000, M, U, V)
dim(MNsims) # 3 2 10000
apply(MNsims, 1:2, mean) # approximates M
vecMNsims &lt;- t(apply(MNsims, 3, function(X) c(t(X))))
round(cov(vecMNsims)) # approximates kronecker(U,V)
</code></pre>


</div>