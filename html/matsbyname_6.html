<div class="container">

<table style="width: 100%;"><tr>
<td>aggregate_byname</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Aggregate rows and columns in a matrix</h2>

<h3>Description</h3>

<p>Rows (<code>margin = 1</code>), columns (<code>margin = 2</code>), or both (<code>margin = c(1, 2)</code>, the default)
are aggregated according to <code>aggregation_map</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">aggregate_byname(
  a,
  aggregation_map = NULL,
  margin = c(1, 2),
  pattern_type = "exact"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>A matrix or list of matrices whose rows or columns are to be aggregated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aggregation_map</code></td>
<td>
<p>A named list of rows or columns to be aggregated (or <code>NULL</code>). See <code>details</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margin</code></td>
<td>
<p><code>1</code>, <code>2</code>, or <code>c(1, 2)</code> for row aggregation, column aggregation, or both.
As a string, <code>margin</code> can be a row or column type.
Default is <code>c(1, 2)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pattern_type</code></td>
<td>
<p>See <code>RCLabels::make_or_pattern()</code>.
Default is "exact".</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When <code>aggregation_map</code> is <code>NULL</code> (the default),
rows (or columns or both) of same name are aggregated together.
</p>
<p>If <code>aggregation_map</code> is not <code>NULL</code>, it must be a named list.
The name of each <code>aggregation_map</code> item is the name of a row or column in output
that will contain the specified aggregation.
The value of each item in <code>aggregation_map</code> must be a vector of names of rows or columns in <code>a</code>.
The names in the value are aggregated and inserted into the output with the name of the value.
For example <code>aggregation_map = list(new_row = c("r1", "r2"))</code>
will aggregate rows "r1" and "r2", delete rows "r1" and "r2", and insert a new row
whose name is "new_row" and whose value is the sum of rows "r1" and "r2'.
</p>
<p>The values in the <code>aggregation_map</code> are interpreted as regular expressions, and
they are escaped using <code>Hmisc::escapeRegex()</code> prior to use.
</p>
<p><code>margin</code> can be a string, in which case it is interpreted as a row or column type.
If a string <code>margin</code> does not match a row or column type,
<code>a</code> is returned unmodified.
</p>
<p>Note that aggregation on one margin only will sort only the aggregated margin, because
the other margin is not guaranteed to have unique names.
</p>


<h3>Value</h3>

<p>A version of <code>a</code> with aggregated rows and/or columns
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(dplyr)
library(tibble)
m &lt;- matrix(1:9, byrow = TRUE, nrow = 3, 
            dimnames = list(c("r2", "r1", "r1"), c("c2", "c1", "c1"))) %&gt;% 
  setrowtype("rows") %&gt;% setcoltype("cols")
# Aggregate all rows by establishing an aggregation map (`am`)
am &lt;- list(new_row = c("r1", "r2"))
aggregate_byname(m, aggregation_map = am, margin = 1)
# aggregate_byname() also works with lists and in data frames
m1 &lt;- matrix(42, nrow = 1, dimnames = list(c("r1"), c("c1")))
m2 &lt;- matrix(1:4, byrow = TRUE, nrow = 2, 
             dimnames = list(c("a", "a"), c("a", "a")))
m3 &lt;- matrix(1:9, byrow = TRUE, nrow = 3, 
             dimnames = list(c("r2", "r1", "r1"), c("c2", "c1", "c1")))
DF &lt;- tibble(m = list(m1, m1, m1, m2, m2, m2, m3, m3, m3), 
             margin = list(1, 2, c(1,2), 1, 2, c(1, 2), 1, 2, c(1, 2))) %&gt;% 
  mutate(
    aggregated = aggregate_byname(m, margin = margin), 
  )
m1
DF$aggregated[[1]] # by rows
DF$aggregated[[2]] # by cols
DF$aggregated[[3]] # by rows and cols
m2
DF$aggregated[[4]] # by rows
DF$aggregated[[5]] # by cols
DF$aggregated[[6]] # by rows and cols
m3
DF$aggregated[[7]] # by rows
DF$aggregated[[8]] # by cols
DF$aggregated[[9]] # by rows and cols
</code></pre>


</div>