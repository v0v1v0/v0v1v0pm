<div class="container">

<table style="width: 100%;"><tr>
<td>expand_to_tidy</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Expand a <code>matsindf</code> data frame</h2>

<h3>Description</h3>

<p>Any tidy data frame of matrices (in which each row represents one matrix observation)
can also be represented as a tidy data frame
with each non-zero matrix entry as an observation on its own row.
This function (and <code>collapse_to_matrices()</code>) convert between the two representations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">expand_to_tidy(
  .DF,
  matnames = "matnames",
  matvals = "matvals",
  rownames = "rownames",
  colnames = "colnames",
  rowtypes = "rowtypes",
  coltypes = "coltypes",
  drop = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.DF</code></td>
<td>
<p>The data frame containing <span class="pkg">matsindf</span>-style matrices.
(<code>.DF</code> may also be a named list of matrices, in which case
names of the matrices are taken from the names of items in the list and
list items are expected to be matrices.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>matnames</code></td>
<td>
<p>The name of the column in <code>.DF</code> containing matrix names (a string).
Default is "matnames".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>matvals</code></td>
<td>
<p>The name of the column in <code>.DF</code> containing IO-style matrices or constants (a string),
This will also be the name of the column containing matrix entries in the output data frame.
Default is "matvals".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rownames</code></td>
<td>
<p>The name for the output column of row names (a string).
Default is "rownames".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colnames</code></td>
<td>
<p>The name for the output column of column names (a string).
Default is "colnames".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rowtypes</code></td>
<td>
<p>An optional name for the output column of row types (a string).
Default is "rowtypes".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coltypes</code></td>
<td>
<p>The optional name for the output column of column types (a string)
Default is "coltypes".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop</code></td>
<td>
<p>If specified, the value to be dropped from output,
For example, <code>drop = 0</code> will cause <code>0</code> entries in the matrices to be deleted from output.
If <code>NA</code>, no values are dropped from output.
Default is <code>NA</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Names for output columns are specified in the <code>rownames</code>, <code>colnames</code>,
<code>rowtypes</code>, and <code>coltypes</code>, arguments.
The entries of the <span class="pkg">matsindf</span>-style matrices are stored in an output column named <code>values.</code>
</p>


<h3>Value</h3>

<p>A tidy data frame containing expanded <span class="pkg">matsindf</span>-style matrices
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(dplyr)
library(matsbyname)
ptype &lt;- "Products"
itype &lt;- "Industries"
tidy &lt;- data.frame(Country  = c( "GH",  "GH",  "GH",  "GH",  "GH",  "GH",  "GH",
                                 "US",  "US",  "US",  "US", "GH", "US"),
                  Year      = c( 1971,  1971,  1971,  1971,  1971,  1971,  1971,
                                 1980,  1980,  1980,  1980, 1971, 1980),
                  matrix    = c(  "U",   "U",   "Y",   "Y",   "Y",   "V",   "V",
                                  "U",   "U",   "Y",   "Y", "eta", "eta"),
                  row       = c(  "c1",  "c2",  "c1",  "c2",  "c2",  "i1",  "i2",
                                  "c1",  "c1",  "c1",  "c2", NA, NA),
                  col       = c(  "i1",  "i2",  "i1",  "i2",  "i3",  "c1",  "c2",
                                  "i1",  "i2",  "i1",  "i2", NA, NA),
                  rowtypes  = c( ptype, ptype, ptype, ptype, ptype, itype, itype,
                                 ptype, ptype, ptype, ptype, NA, NA),
                  coltypes  = c(itype, itype, itype, itype, itype, ptype, ptype,
                                itype, itype, itype, itype, NA, NA),
                  vals      = c(11  ,  22,    11 ,   22 ,   23 ,   11 ,   22 ,
                                11 ,   12 ,   11 ,   22,   0.2, 0.3)) %&gt;%
  group_by(Country, Year, matrix)
mats &lt;- collapse_to_matrices(tidy, matnames = "matrix", rownames = "row", colnames = "col",
                             rowtypes = "rowtypes", coltypes = "coltypes",
                             matvals = "vals") %&gt;%
  ungroup()
expand_to_tidy(mats, matnames = "matrix", matvals = "vals",
                     rownames = "rows", colnames = "cols",
                     rowtypes = "rt",   coltypes = "ct")
expand_to_tidy(mats, matnames = "matrix", matvals = "vals",
                     rownames = "rows", colnames = "cols",
                     rowtypes = "rt",   coltypes = "ct", drop = 0)
</code></pre>


</div>