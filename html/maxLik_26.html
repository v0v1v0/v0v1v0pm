<div class="container">

<table style="width: 100%;"><tr>
<td>hessian</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Hessian matrix</h2>

<h3>Description</h3>

<p>This function extracts the Hessian of the objective function at optimum.
The Hessian information should be supplied by the underlying
optimization algorithm, possibly by an approximation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hessian(x, ...)
## Default S3 method:
hessian(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an optimization result of class ‘maxim’ or ‘maxLik’</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments for methods</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A numeric matrix, the Hessian of the model at the estimated parameter
values.  If the maximum is flat, the Hessian
is singular.  In that case you may want to invert only the
non-singular part of the matrix.  You may also want to fix certain
parameters (see <code>activePar</code>).
</p>


<h3>Author(s)</h3>

<p>Ott Toomet</p>


<h3>See Also</h3>

<p><code>maxLik</code>, <code>activePar</code>, <code>condiNumber</code></p>


<h3>Examples</h3>

<pre><code class="language-R"># log-likelihood for normal density
# a[1] - mean
# a[2] - standard deviation
ll &lt;- function(a) sum(-log(a[2]) - (x - a[1])^2/(2*a[2]^2))
x &lt;- rnorm(100) # sample from standard normal
ml &lt;- maxLik(ll, start=c(1,1))
# ignore eventual warnings "NaNs produced in: log(x)"
summary(ml) # result should be close to c(0,1)
hessian(ml) # How the Hessian looks like
sqrt(-solve(hessian(ml))) # Note: standard deviations are on the diagonal
#
# Now run the same example while fixing a[2] = 1
mlf &lt;- maxLik(ll, start=c(1,1), activePar=c(TRUE, FALSE))
summary(mlf) # first parameter close to 0, the second exactly 1.0
hessian(mlf)
# Note that now NA-s are in place of passive
# parameters.
# now invert only the free parameter part of the Hessian
sqrt(-solve(hessian(mlf)[activePar(mlf), activePar(mlf)]))
# gives the standard deviation for the mean
</code></pre>


</div>