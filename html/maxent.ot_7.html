<div class="container">

<table style="width: 100%;"><tr>
<td>predict_probabilities</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Predict probabilities of OT candidates</h2>

<h3>Description</h3>

<p>Predict probabilities of candidates based on their violation profiles and
constraint weights.
</p>


<h3>Usage</h3>

<pre><code class="language-R">predict_probabilities(
  test_input,
  constraint_weights,
  output_path = NA,
  out_sep = ",",
  encoding = "unknown",
  temperature = DEFAULT_TEMPERATURE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>test_input</code></td>
<td>
<p>The input data frame/data table/tibble. This should contain one
or more OT tableaux consisting of mappings between underlying and surface
forms with observed frequency and violation profiles. Constraint violations
must be numeric.
</p>
<p>For an example of the data frame format, see inst/extdata/sample_data_frame.csv.
You can read this file into a data frame using read.csv or into a tibble
using dplyr::read_csv.
</p>
<p>This function also supports the legacy OTSoft file format. You can use this
format by passing in a file path string to the OTSoft file rather than a
data frame.
</p>
<p>For examples of OTSoft format, see inst/extdata/sample_data_file.txt.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constraint_weights</code></td>
<td>
<p>A vector of constraint weights to use. These are typically
generated by the <code>optimize_weights</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output_path</code></td>
<td>
<p>(optional) A string specifying the path to a file to
which the predictions will be saved. If the file exists it will be overwritten.
If this argument isn't provided, the output will not be written to a file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out_sep</code></td>
<td>
<p>(optional) The delimiter used in the output files.
Defaults to commas.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>encoding</code></td>
<td>
<p>(optional) The character encoding of the input file. Defaults
to "unknown".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>temperature</code></td>
<td>
<p>(optional) The temperature parameter, which should be a
real number <code class="reqn">&gt;= 1</code>. Defaults to 1.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For each input/output pair in the provided file this function
will calculate the probability of that output given the input form and the
provided weights. This probability is defined as
</p>
<p style="text-align: center;"><code class="reqn">P(y|x; w) = \frac{1}{Z_w(x)}\exp(-\sum_{k=1}^{m}{w_k f_k(y, x)})</code>
</p>

<p>where <code class="reqn">f_k(y, x)</code> is the number of violations of constraint <code class="reqn">k</code>
incurred by mapping underlying <code class="reqn">x</code> to surface <code class="reqn">y</code>, <code class="reqn">w_k</code> is the
weight associated with constraint <code class="reqn">k</code>, and  <code class="reqn">Z_w(x)</code> is a
normalization term defined as
</p>
<p style="text-align: center;"><code class="reqn">Z_w(x) = \sum_{y\in\mathcal{Y}(x)}{\exp(-\sum_{k=1}^{m}{w_k f_k(y, x)})}</code>
</p>

<p>where <code class="reqn">\mathcal{Y}(x)</code> is the set of all output candidates for input
<code class="reqn">x</code>.
</p>
<p>The resulting probabilities will be appended to a data frame object
representing the input tableaux. This data frame can also be saved to a file
if the <code>output_path</code> argument is provided.
</p>


<h3>Value</h3>

<p>An object with the following named attributes:
</p>

<ul>
<li> <p><code>log_lik</code>: the log likelihood of the data under the provided
weights
</p>
</li>
<li> <p><code>predictions</code>: A data table containing all the tableaux, with
probabilities assigned to each candidate and errors.
</p>
</li>
</ul>
<h3>Using temperature</h3>

<p>If the temperature parameter <code class="reqn">T</code> is specified, <code class="reqn">P(y|x; w)</code> is
calculated as
</p>
<p style="text-align: center;"><code class="reqn">\frac{1}{Z_w(x)}\exp(-\sum_{k=1}^{m}{(w_k f_k(y, x)})/T)</code>
</p>
<p> and
<code class="reqn">Z_w(x)</code> is similarly calculated as
</p>
<p style="text-align: center;"><code class="reqn">\sum_{y\in \mathcal{Y}(x)}{\exp(-\sum_{k=1}^{m}{(w_k f_k(y, x))/T})}</code>
</p>

<p>Larger values of <code class="reqn">T</code> move the predicted probabilities of output
candidates for a particular input towards equality with one another. For
example, if a particular input has two candidate outputs, higher values of
<code class="reqn">T</code> will move the probability of each towards <code>0.5</code>.
</p>
<p>The temperature parameter can be used to generate less categorical
predictions in a way that is independent of the constraint weights. See
Ackley, Hinton, and Sejnowski (1985, p. 150-152) for more detail, and Hayes
et al. (2009) and Mayer (2021, Ch. 4) for examples of temperature used in
practice. By default this parameter is set to <code>1</code>, which renders the
equations in this section equivalent to the standard calculations of
probability.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Get paths to toy data file
  df_file &lt;- system.file(
      "extdata", "sample_data_frame.csv", package = "maxent.ot"
  )
  # Fit weights to dataframe with no biases
  tableaux_df &lt;- read.csv(df_file)
  fit_model &lt;- optimize_weights(tableaux_df)
  predict_probabilities(tableaux_df, fit_model$weights)

  # Do so with a temperature parameter
  predict_probabilities(tableaux_df, fit_model$weights, temperature = 2)

  # Save predictions to a file
  tmp_output &lt;- tempfile()
  predict_probabilities(tableaux_df, fit_model$weights, output_path=tmp_output)
</code></pre>


</div>