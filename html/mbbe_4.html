<div class="container">

<table style="width: 100%;"><tr>
<td>run_mbbe</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Execute MBBE Analysis</h2>

<h3>Description</h3>

<p>This function runs the MBBE analysis. It's typically called by <code>run_mbbe_json</code>
which provides the necessary options via a JSON file.
</p>


<h3>Usage</h3>

<pre><code class="language-R">run_mbbe(
  crash_value,
  ngroups,
  reference_groups,
  test_groups,
  num_parallel,
  samp_size,
  run_dir,
  model_source,
  nmfe_path,
  delta_parms,
  use_check_identifiable,
  NCA_end_time,
  rndseed,
  simulation_data_path,
  plan = c("multisession", "sequential", "multicore"),
  alpha_error = 0.05,
  NTID = FALSE,
  model_averaging_by = "study",
  user_R_code = FALSE,
  R_code_path = "",
  save_plots = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>crash_value</code></td>
<td>
<p>Numeric. Value to be returned for BIC in models that crash during either bootstrap or simulation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ngroups</code></td>
<td>
<p>Integer. Number of groups in the simulated data (e.g., an ABBA design has 4 groups).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reference_groups</code></td>
<td>
<p>Numeric vector. Indices of the groups representing the reference formulation (e.g., c(2,3) for an ABBA design).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test_groups</code></td>
<td>
<p>Numeric vector. Indices of the groups representing the test formulation (e.g., c(1,4) for an ABBA design).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_parallel</code></td>
<td>
<p>Integer. Number of NONMEM processes (both bootstrap and simulation) to run concurrently.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samp_size</code></td>
<td>
<p>Integer. Size of the bootstrap and simulation samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>run_dir</code></td>
<td>
<p>Character string. Directory for NONMEM execution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model_source</code></td>
<td>
<p>Character string. Paths to the NONMEM control files for model averaging.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmfe_path</code></td>
<td>
<p>Character string. Path to the nmfe executable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta_parms</code></td>
<td>
<p>Numeric. Parameter difference threshold defining identifiability.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_check_identifiable</code></td>
<td>
<p>Logical. Should identifiability be checked based on the criterion defined by <a href="https://www.page-meeting.org/default.asp?abstract=5951">Aoki</a>?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NCA_end_time</code></td>
<td>
<p>Numeric. The NCA calculation will start at 0 and end at this value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rndseed</code></td>
<td>
<p>Integer. Random seed for reproducibility.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simulation_data_path</code></td>
<td>
<p>Character string. Path to the simulation dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plan</code></td>
<td>
<p>Character string (default: "multisession"). Parallel execution plan. Can be "multisession", "sequential", or "multicore".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_error</code></td>
<td>
<p>Numeric (default: 0.05). Alpha error rate for statistical tests.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NTID</code></td>
<td>
<p>Logical (default: FALSE). Is the drug a narrow therapeutic index drug?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model_averaging_by</code></td>
<td>
<p>Character string (default: "study"). Method of model averaging, either "study" or "subject".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>user_R_code</code></td>
<td>
<p>Logical (default: FALSE). Should custom R code be used for model penalty?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R_code_path</code></td>
<td>
<p>Character string. If <code>user_R_code</code> is TRUE, this parameter defines the path to the custom R script.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save_plots</code></td>
<td>
<p>Logical (default: <code>FALSE</code>). Set to <code>TRUE</code> to save plot output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional args</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is primarily intended to be called by <code>run_mbbe_json</code>, which provides input parameters through a JSON configuration.
</p>


<h3>Value</h3>

<p>A list containing:
</p>

<ul>
<li> <p><code>Cmax_power</code>: Power for Cmax
</p>
</li>
<li> <p><code>AUClast_power</code>: Power for AUClast
</p>
</li>
<li> <p><code>AUCinf_power</code>: Power for AUCinf
</p>
</li>
<li> <p><code>run_dir</code>: Directory where the function was executed
</p>
</li>
<li> <p><code>Num_identifiable</code>: Number of identifiable parameters
</p>
</li>
<li> <p><code>BICS</code>: Bayesian Information Criterion Scores
</p>
</li>
</ul>
</div>