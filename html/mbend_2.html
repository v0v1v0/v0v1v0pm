<div class="container">

<table style="width: 100%;"><tr>
<td>bend</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Matrix bending to positive-definite</h2>

<h3>Description</h3>

<p>Bending a symmetric non-positive-definite matrix to positive-definite, using weighted or unweighted methods.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bend(
  inmat,
  wtmat,
  reciprocal = FALSE,
  max.iter = 10000,
  small.positive = 1e-04,
  method = "hj"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>inmat</code></td>
<td>
<p>: The <code>matrix</code> to be bent.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wtmat</code></td>
<td>
<p>: The weight <code>matrix</code> for weighted bending. If no input is provided, the unweighted method (default) is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reciprocal</code></td>
<td>
<p>: If <code>TRUE</code>, reciprocal of the weighting factors are used. If no input is provided, default = <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.iter</code></td>
<td>
<p>: Maximum number of iterations. If no input is provided, default = 10000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>small.positive</code></td>
<td>
<p>: Eigenvalues smaller than this value are replaced with this value. If no input is provided, default = 0.0001.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>: <code>"hj"</code> (Jorjani et al., 2003) or <code>"lrs"</code> (Schaeffer, 2014), default = <code>"hj"</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>bent : The bent <code>matrix</code>.
</p>
<p>init.ev : Eigenvalues of the initial (<code>inmat</code>) matrix.
</p>
<p>final.ev : Eigenvalues of the <code>bent</code> matrix.
</p>
<p>min.dev : <code>min(bent - inmat)</code>.
</p>
<p>max.dev : <code>max(bent - inmat)</code>.
</p>
<p>loc.min.dev : Location (indices) of <code>min.dev</code> element.
</p>
<p>loc.max.dev : Location (indices) of <code>max.dev</code> element.
</p>
<p>ave.dev : Average deviation (<code>bent - inmat</code>) of the upper triangle elements (excluding diagonal elements for correlation matrices).
</p>
<p>AAD : Average absolute deviation of the upper triangle elements (excluding diagonal elements for correlation matrices) of <code>bent</code> and <code>inmat</code>.
</p>
<p>Cor : Correlation between the upper triangle elements (excluding diagonal elements for correlation matrices) of <code>bent</code> and <code>inmat</code>.
</p>
<p>RMSD : Root of mean squared deviation of the upper triangle elements (excluding diagonal elements for correlation matrices) of <code>bent</code> and <code>inmat</code>.
</p>
<p>w_gt_0 : Number of weight elements greater than 0, in the upper triangle of <code>wtmat</code> (for weighted bending).
</p>
<p>wAAD : Weighted <code>AAD</code> (for weighted bending).
</p>
<p>wCor : Weighted <code>Cor</code> (for weighted bending).
</p>
<p>wRMSD : Weighted <code>RMSD</code> (for weighted bending).
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Test data
V = matrix(nrow=5, ncol=5, c( # matrix to be bent
100,  95,  80,  40,  40,
 95, 100,  95,  80,  40,
 80,  95, 100,  95,  80,
 40,  80,  95, 100,  95,
 40,  40,  80,  95, 100))
W = matrix(nrow=5, ncol=5, c( # matrix of weights
1000,  500,   20,   50,  200,
 500, 1000,  500,    5,   50,
  20,  500, 1000,   20,   20,
  50,    5,   20, 1000,  200,
 200,   50,   20,  200, 1000))

# Example 1: Unweighted bending
bend(V)
## The default method (Jojani et al. 2003) is used.

# Example 2: Weighted bending using reciprocal of the weighting factors
bend(inmat=V, wtmat=W, reciprocal=TRUE)

# Example 3: Bending with fixed elements
## Assume we want to keep V[1:2, 1:2] constant.
W2 = W; W2[1:2, 1:2] = 0
bend(inmat=V, wtmat=W2, reciprocal=TRUE)

# Example 4: Bending a correlation matrix
V2 = cov2cor(V)
bend(V2, W, reciprocal=TRUE)

# Example 5: Bending using the method of Schaeffer (2014)
bend(inmat=V, method="lrs")

# Example 6: Bending a correlation matrix using the method of Schaeffer (2014)
bend(V2, method="lrs")

# Example 7: Bending the same correlation matrix using a weighted development of Schaeffer (2014)
bend(V2, W, reciprocal=TRUE, method="lrs")

# Example 8: Bending a covariance matrix using a weighted development of Schaeffer (2014)
bend(V, W, reciprocal=TRUE, method="lrs")

</code></pre>


</div>