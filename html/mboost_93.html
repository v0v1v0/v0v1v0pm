<div class="container">

<table style="width: 100%;"><tr>
<td>varimp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Variable Importance </h2>

<h3>Description</h3>

<p>In-bag risk reduction per base-learner as variable importance for boosting.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'mboost'
varimp(object, ...)

## S3 method for class 'varimp'
plot(x, percent = TRUE, type = c("variable", "blearner"), 
  blorder = c("importance", "alphabetical", "rev_alphabetical", "formula"),
  nbars = 10L, maxchar = 20L, xlab = NULL, ylab = NULL, xlim, auto.key, ...)
## S3 method for class 'varimp'
as.data.frame(x, row.names = NULL, optional = FALSE, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p> an object of class <code>mboost</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> an object of class <code>varimp</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>percent</code></td>
<td>
<p> logical, indicating whether variable importance should be 
specified in percent.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p> a character string specifying whether to draw bars for variables
(<code>"variable"</code>, default) or base-learners (<code>"blearner"</code>) in the 
model (no effect for a glmboost object).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blorder</code></td>
<td>
<p> a character string specifying the order of the base-learners
in the plot. The default <code>"importance"</code> corresponds to the order of the
base-learner importance, <code>"alphabetical"</code> and <code>"rev_alphabetical"</code> 
to alphabetical order, respectively its reverse, and <code>"formula"</code> to 
their order in the model formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbars</code></td>
<td>
<p> integer, maximum number of bars to be plotted. If <code>nbars</code> 
is exceeded, least important variables / base-learners are summarized as
"other".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxchar</code></td>
<td>
<p> integer, maximum number of characters in bar labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>text for the x-axis label. If not set (default is <code>NULL</code>) 
x-axis label is generated automatically depending on argument 
<code>percent</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>text for the y-axis label. If not set (default is <code>NULL</code>) 
y-axis label is generated automatically depending on argument <code>type</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p> the x limits of the plot. Defaults are from <code>0</code> to total 
reduction, or from <code>0</code> to <code>1</code> for <code>percent = TRUE</code>. (In case 
of negative risk reductions, default limits are from total negative to total
positve reduction, or the latter normalized by the total absolute reduction 
for <code>percent = TRUE</code>.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>auto.key</code></td>
<td>
<p> logical, or a list passed to <code>lattice::barchart</code>. By 
default <code>auto.key=TRUE</code> provides automatically generated legends showing 
the underlying base-learners in the stacked barchart 
(<code>type = "variable"</code>). If there is an unique base-learner for each 
variable(-interaction), <code>auto.key = FALSE</code> is default setting. 
For <code>type = "blearner"</code> the argument has no effect at all.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> additional arguments passed to <code>lattice::barchart</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row.names</code></td>
<td>
<p> NULL or a character vector giving the row names for the 
data frame. Missing values are not allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optional</code></td>
<td>
<p>logical. If TRUE, setting row names and converting column 
names (to syntactic names: see make.names) is optional.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function extracts the in-bag risk reductions per boosting step of a 
fitted <code>mboost</code> model and accumulates it individually for each base-learner
contained in the model. This quantifies the individual contribution to risk 
reduction of each base-learner and can thus be used to compare the importance 
of different base-learners or variables in the model. Starting from offset only, 
in each boosting step risk reduction is computed as the difference between 
in-bag risk of the current and the previous model and is accounted for the 
base-learner selected in the particular step.
</p>
<p>The results can be plotted in a bar plot either for the base-learners, or the
variables contained in the model. The bars are ordered according to variable 
importance. If their number  exceeds <code>nbars</code> the least important are 
summarized as "other". If bars are plotted per  variable, all base-learners 
containing the same variable will be accumulated in a stacked bar. This is of 
use for models including for example seperate base-learners for the linear and 
non-linear part of a covariate effect (see <code>?bbs</code> option 
<code>center=TRUE</code>). However, variable interactions are treated as individual 
variables, as their desired handling might depend on context.
</p>
<p>As a comparison the selection frequencies are added to the respective 
base-learner labels in the plot (rounded to three digits). For stacked bars 
they are ordered accordingly.
</p>


<h3>Value</h3>

<p> An object of class <code>varimp</code> with available <code>plot</code> and
<code>as.data.frame</code> methods. 
</p>
<p>Converting a <code>varimp</code> object results in a <code>data.frame</code> containing the 
risk reductions, selection frequencies and the corresponding base-learner and 
variable names as ordered <code>factors</code> (ordered according to their particular 
importance).</p>


<h3>Author(s)</h3>

<p>Tobias Kuehn (<a href="mailto:tobi.kuehn@gmx.de">tobi.kuehn@gmx.de</a>), 
Almond Stoecker (<a href="mailto:almond.stoecker@gmail.com">almond.stoecker@gmail.com</a>)
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(iris)
### glmboost with multiple variables and intercept
iris$setosa &lt;- factor(iris$Species == "setosa")
iris_glm &lt;- glmboost(setosa ~ 1 + Sepal.Width + Sepal.Length + Petal.Width +
                         Petal.Length,
                     data = iris, control = boost_control(mstop = 50), 
                     family = Binomial(link = c("logit")))
varimp(iris_glm)
### importance plot with four bars only
plot(varimp(iris_glm), nbars = 4)

### gamboost with multiple variables
iris_gam &lt;- gamboost(Sepal.Width ~ 
                         bols(Sepal.Length, by = setosa) +
                         bbs(Sepal.Length, by = setosa, center = TRUE) + 
                         bols(Petal.Width) +
                         bbs(Petal.Width, center = TRUE) + 
                         bols(Petal.Length) +
                         bbs(Petal.Length, center = TRUE),
                     data = iris)
varimp(iris_gam)
### stacked importance plot with base-learners in rev. alphabetical order
plot(varimp(iris_gam), blorder = "rev_alphabetical")

### similar ggplot
## Not run:  
library(ggplot2)
ggplot(data.frame(varimp(iris_gam)), aes(variable, reduction, fill = blearner)) + 
    geom_bar(stat = "identity") + coord_flip() 
## End(Not run)
</code></pre>


</div>