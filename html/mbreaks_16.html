<div class="container">

<table style="width: 100%;"><tr>
<td>mdl</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Comprehensive structural change estimation and testing</h2>

<h3>Description</h3>

<p><code>mdl()</code> calls main functions of the <code>mbreaks</code> package to execute the following
estimation procedures:
</p>

<ul>
<li>
<p><code>dotest()</code> conducts Sup F tests of <code>0</code> versus <code>m</code> breaks and Double Max tests
</p>
</li>
<li>
<p><code>doseqtests()</code> conducts the sequential Sup F tests of l versus l+1 breaks
</p>
</li>
<li>
<p><code>doorder()</code> conducts the number of breaks selection from <code>1</code> to <code>m</code>
breaks using information critera: <code style="white-space: pre;">⁠{'KT','BIC','LWZ'}⁠</code>
</p>
</li>
<li>
<p><code>dosequa()</code> conducts the number of breaks selection by sequential tests
from <code>1</code> to <code>m</code> breaks using sequential Sup F tests
</p>
</li>
<li>
<p><code>dofix()</code> conducts structural break model estimation with <code>fixn</code> breaks
</p>
</li>
</ul>
<p>All the procedures automatically identify if the <code>model</code> is either i) pure structural
breaks model or ii) partial structural breaks model
</p>


<h3>Usage</h3>

<pre><code class="language-R">mdl(
  y_name,
  z_name = NULL,
  x_name = NULL,
  data,
  eps1 = 0.15,
  m = 5,
  prewhit = 1,
  robust = 1,
  hetdat = 1,
  hetvar = 1,
  hetomega = 1,
  hetq = 1,
  maxi = 10,
  eps = 1e-05,
  fixn = -1,
  fixb = 0,
  betaini = 0,
  printd = 0,
  const = 1,
  signif = 2,
  h = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y_name</code></td>
<td>
<p>name of dependent variable in the data set</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z_name</code></td>
<td>
<p>name of independent variables in the data set which coefficients are allowed to change
across regimes. <code>default</code> is vector of 1 (Mean-shift model)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_name</code></td>
<td>
<p>name of independent variables in the data set which coefficients are constant across
regimes. <code>default</code> is <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>the data set for estimation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps1</code></td>
<td>
<p>value of trimming (in percentage) for the construction
and critical values. Minimal segment length <code>h</code> will be set
at <code>default</code> = int(<code>eps1</code>*T) (T is total sample size).
</p>

<ul>
<li>
<p><code>eps1=0.05</code> Maximal value of <code>m</code> = 10
</p>
</li>
<li>
<p><code>eps1=0.10</code> Maximal value of <code>m</code> = 8
</p>
</li>
<li>
<p><code>eps1=.15</code> Maximal value of <code>m</code> = 5
</p>
</li>
<li>
<p><code>eps1=.20</code> Maximal value of <code>m</code> = 3
</p>
</li>
<li>
<p><code>eps1=.25</code> Maximal value of <code>m</code> = 2
</p>
</li>
<li>
<p><code>eps1=0</code> This option allows users to explicitly specify
minimum segment length <code>h</code> parameters. However, this option will not
be allowed for testing and testing related functions</p>
</li>
</ul>
<p> The <code>default</code> value is set at 0.15</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>Maximum number of structural changes allowed. If not specify,
m will be set to <code>default</code> value matching <code>eps1</code> input</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prewhit</code></td>
<td>
<p>set to <code>1</code> to apply AR(1) prewhitening prior to estimating
the long run covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>
<p>set to <code>1</code> to allow for heterogeneity
and autocorrelation in the residuals, <code>0</code> otherwise.
The method used is Andrews(1991) automatic bandwidth with AR(1) approximation with quadratic
kernel. Note: Do not set to <code>1</code> if lagged dependent variables are
included as regressors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hetdat</code></td>
<td>
<p>option for the construction of the F tests. Set to 1 if want to
allow different moment matrices of the regressors across segments.
If <code>hetdat</code> = <code>0</code>, the same moment matrices are assumed for each segment
and estimated from the ful sample. It is recommended to set
<code>hetdat</code>=<code>1</code> if number of regressors <code>x</code> &gt; <code>0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hetvar</code></td>
<td>
<p>option for the construction of the F tests.Set to <code>1</code>
if users want to allow for the variance of the residuals to be different across segments.
If <code>hetvar</code>=<code>0</code>, the variance of the residuals is assumed constant
across segments and constructed from the full sample. <code>hetvar</code>=<code>1</code> when <code>robust</code> =<code>1</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hetomega</code></td>
<td>
<p>used in the construction of the confidence intervals for the break
dates. If <code>hetomega</code>=<code>0</code>, the long run covariance matrix of zu is
assumed identical across segments (the variance of the errors u if <code>robust</code>=0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hetq</code></td>
<td>
<p>used in the construction of the confidence intervals for the break
dates. If <code>hetq</code>=<code>0</code>, the moment matrix of the data is assumed identical
across segments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxi</code></td>
<td>
<p>number of maximum iterations for recursive calculations of finding
global minimizers.<code>default</code> = 10 (For partial change model ONLY)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>convergence criterion for recursive calculations (For partial change model ONLY)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixn</code></td>
<td>
<p>number of pre-specified breaks. <code>default</code> = -1. It will be replaced
automatically to 2 if no specification is given (For partial change model ONLY)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixb</code></td>
<td>
<p>option to use fixed initial input <code class="reqn">\beta</code>. If <code>1</code>,
the model will use values given in <code>betaini</code>. If <code>0</code>, betaini is skipped</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betaini</code></td>
<td>
<p>Initial <code class="reqn">beta_0</code> to use in estimation (Must be a <code style="white-space: pre;">⁠p x 1⁠</code> matrix, where p is number of x variables)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>printd</code></td>
<td>
<p>Print option for model estimation. <code>default</code> = 0, to
suppress intermediate outputs printing to console</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>const</code></td>
<td>
<p>indicates whether the regression model include an
intercept changing across regimes. Default value is 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>signif</code></td>
<td>
<p>significance level used to sequential test to select number of breaks.
</p>

<ul>
<li>
<p> 4: 1% level
</p>
</li>
<li>
<p> 3: 2.5% level
</p>
</li>
<li>
<p> 2: 5% level
</p>
</li>
<li>
<p> 1: 10% level
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>Minimum segment length of regime considered in estimation. If users want to specify a particular value, please set <code>eps1=0</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list that contains the following:
</p>

<ul>
<li>
<p>sbtests: class <code>sbtests</code> of Sup F tests of 0 versus m breaks and Double Max tests
</p>
</li>
<li>
<p>seqtests: class <code>seqtests</code> of sequential Sup F test of l versus l+1 breaks 
</p>
</li>
<li>
<p>BIC: class <code>model</code> of structural break model with estimated number of breaks by BIC criterion
</p>
</li>
<li>
<p>LWZ: class <code>model</code> of structural break model with estimated number of breaks by LWZ criterion
</p>
</li>
<li>
<p>KT: class <code>model</code> of structural break model with estimated number of breaks by KT criterion
</p>
</li>
<li>
<p>sequa: class <code>model</code> of structural break model with estimated number of breaks by sequential tests
</p>
</li>
<li>
<p>fix:  class <code>model</code> of structural break model with pre-specified <code>fixn</code> number of breaks
</p>
</li>
</ul>
<p>Note: All <code>default</code> values of error assumptions (<code>robust</code>,
<code>hetdat</code>, <code>hetvar</code>, <code>hetq</code>) are set to 1. The implications on
the structure of model's errors related to individual settings are explained within
the arguments section for each option.
</p>


<h3>See Also</h3>

<p><code>dotest()</code>, <code>doseqtests()</code>, <code>doorder()</code>, <code>dosequa()</code>, and <code>dofix()</code>
which are functions called by <code>mdl()</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"> US_rate = mdl('rate',data=real)
 nkpc_lbs = mdl('inf',c('inflag','lbs','inffut'),data=nkpc,prewhit = 0)

</code></pre>


</div>