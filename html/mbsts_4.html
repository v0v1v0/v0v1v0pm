<div class="container">

<table style="width: 100%;"><tr>
<td>mbsts_function</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Main function for the multivariate Bayesian structural time series (MBSTS) model</h2>

<h3>Description</h3>

<p>The MBSTS model uses MCMC to sample from the posterior distribution of a MBSTS model. The model is given by
</p>
<p style="text-align: center;"><code class="reqn">y=\mu+\tau+\omega+\beta X+\epsilon,</code>
</p>

<p>where <code class="reqn">\mu</code>, <code class="reqn">\tau</code>, <code class="reqn">\omega</code>, <code class="reqn">\beta X</code>, and <code class="reqn">\epsilon</code> denote the trend component, the seasonal component, the cycle component, the regression component, and the error term, respectively. Note that, without a regression component, the MBSTS model is an ordinary state space time series model. The predictors and response variables in the MBSTS model are designed to be contemporaneous. Lags and differences can be generated by manipulating the predictor matrix. The "spike-and-slab" prior is used for the regression component of models, which enables feature selection among a large number of features.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mbsts_function(
  Y,
  Xtrain,
  STmodel,
  ki,
  pii,
  b = NULL,
  v0,
  kapp = 0.01,
  R2 = 0.8,
  v = 0.01,
  ss = 0.01,
  mc = 500,
  burn = 50
)

## S4 method for signature 'array'
mbsts_function(
  Y,
  Xtrain,
  STmodel,
  ki,
  pii,
  b = NULL,
  v0,
  kapp = 0.01,
  R2 = 0.8,
  v = 0.01,
  ss = 0.01,
  mc = 500,
  burn = 50
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>A (<code class="reqn">n*m</code>)-dimensional matrix containing multiple target series, where <code class="reqn">n</code> is the number of observations and <code class="reqn">m</code> is the number of target series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xtrain</code></td>
<td>
<p>A (<code class="reqn">n*K</code>)-dimensional matrix containing all candidate predictor series for each target series. <code class="reqn">K=\sum k_i</code> is the number of all candidate predictors for all target series. The first <code class="reqn">k_1</code> variables are the set of candidate predictors for the first target series, and the next <code class="reqn">k_2</code> variables are the set of candidate predictors for the second target series, etc. Note that, one variable can appear in the X.star several times, since different target series can contain the same candidate predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>STmodel</code></td>
<td>
<p>A state space model of SSmodel class returned by tsc.setting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ki</code></td>
<td>
<p>A vector of integer values denoting the acumulated number of predictors for target series. For example, if there are three target series where the first has <code class="reqn">8</code> predictors, the second has <code class="reqn">6</code> predictors, and the third has <code class="reqn">10</code> predictors, then the vector is c(<code class="reqn">8,14,24</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pii</code></td>
<td>
<p>A vector describing the prior inclusion probability of each candidate predictor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>NULL or a vector describing the prior means of regression coefficients. The default value is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v0</code></td>
<td>
<p>A numerical value describing the prior degree of freedom of the inverse Wishart distribution for <code class="reqn">\Sigma_\epsilon</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kapp</code></td>
<td>
<p>A scalar value describing the number of observations worth of weight on the prior mean vector. The default value is <code class="reqn">0.01</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R2</code></td>
<td>
<p>A numerical value taking value in <code class="reqn">[0,1]</code>, describing the expected percentage of variation of <code class="reqn">Y</code> to be explained by the model. The default value is <code class="reqn">0.8</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>A numerical value describing the prior degree of freedom of the inverse Wishart distribution for (<code class="reqn">\Sigma_\mu,\Sigma_\delta,\Sigma_\tau,\Sigma_\omega</code>). The default value is <code class="reqn">0.01</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ss</code></td>
<td>
<p>A numerical value describing the prior scale matrix of the inverse Wishart distribution for (<code class="reqn">\Sigma_\mu,\Sigma_\delta,\Sigma_\tau,\Sigma_\omega</code>). The default value is <code class="reqn">0.01</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mc</code></td>
<td>
<p>A positive integer giving the desired number of MCMC draws. The default value is <code class="reqn">500</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn</code></td>
<td>
<p>A positive integer giving the number of initial MCMC draws to be discarded. The default value is <code class="reqn">50</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of mbsts class
</p>


<h3>Author(s)</h3>

<p>Jinwen Qiu <a href="mailto:qjwsnow_ctw@hotmail.com">qjwsnow_ctw@hotmail.com</a> Ning Ning <a href="mailto:patricianing@gmail.com">patricianing@gmail.com</a>
</p>


<h3>References</h3>

<p>Qiu, Jammalamadaka and Ning (2018), Multivariate Bayesian Structural Time Series Model, <em>Journal of Machine Learning Research</em> 19.68: 1-33.
</p>
<p>Ning and Qiu (2021), The mbsts package: Multivariate Bayesian Structural Time Series Models in R.
</p>
<p>Jammalamadaka, Qiu and Ning (2019), Predicting a Stock Portfolio with the Multivariate Bayesian Structural Time Series Model: Do News or Emotions Matter?, <em>International Journal of Artificial Intelligence</em>, Vol. 17, Number 2.
</p>


</div>