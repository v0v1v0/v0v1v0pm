<div class="container">

<table style="width: 100%;"><tr>
<td>est_marg_lik</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate the marginal likelihood for an inference model.</h2>

<h3>Description</h3>

<p>Estimate the marginal likelihood for an inference model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">est_marg_lik(
  fasta_filename,
  inference_model = beautier::create_ns_inference_model(),
  beast2_options = beastier::create_mcbette_beast2_options(),
  os = rappdirs::app_dir()$os
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fasta_filename</code></td>
<td>
<p>name of the FASTA file</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inference_model</code></td>
<td>
<p>an inference model,
as can be created by create_inference_model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beast2_options</code></td>
<td>
<p>a <code>beast2_options</code> structure,
as can be created by create_mcbette_beast2_options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>os</code></td>
<td>
<p>name of the operating system,
must be <code>unix</code> (Linux, Mac) or <code>win</code> (Windows)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list showing the estimated marginal likelihoods
(and its estimated error), its items are::
</p>

<ul>
<li> <p><code>marg_log_lik</code>: estimated marginal (natural) log likelihood
</p>
</li>
<li> <p><code>marg_log_lik_sd</code>: estimated error of <code>marg_log_lik</code>
</p>
</li>
<li> <p><code>esses</code> the Effective Sample Size
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Rich√®l J.C. Bilderbeek
</p>


<h3>See Also</h3>


<ul>
<li> <p>can_run_mcbette: see if 'mcbette' can run
</p>
</li>
<li> <p>est_marg_liks: estimate multiple marginal likelihoods
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">if (can_run_mcbette()) {

  # An example FASTA file
  fasta_filename &lt;- system.file("extdata", "simple.fas", package = "mcbette")

  # A testing inference model with inaccurate (thus fast) marginal
  # likelihood estimation
  inference_model &lt;- beautier::create_ns_inference_model()

  # Shorten the run, by doing a short (dirty, unreliable) MCMC
  inference_model$mcmc &lt;- beautier::create_test_ns_mcmc()

  # Setup the options for BEAST2 to be able to call BEAST2 packages
  beast2_options &lt;- beastier::create_mcbette_beast2_options()

  # Estimate the marginal likelihood
  est_marg_lik(
    fasta_filename = fasta_filename,
    inference_model = inference_model,
    beast2_options = beast2_options
  )

  beastier::remove_beaustier_folders()
}
</code></pre>


</div>