<div class="container">

<table style="width: 100%;"><tr>
<td>MCCCA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>apply MCCCA for dataset.</h2>

<h3>Description</h3>

<p>Applies MCCCA to <code>mcccadata.list</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MCCCA(
  mccca.data,
  K.vec = K.vec,
  known.vec = NULL,
  knowncluster.list = NULL,
  nstart = 3,
  maxit = 50,
  p = 2,
  tol = 1e-08,
  verbose = TRUE,
  remove.miss = TRUE,
  kmeans.initial = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mccca.data</code></td>
<td>
<p>A list created in <code>create.MCCCAdata</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K.vec</code></td>
<td>
<p>An integer vector of length C (the number of classes). Each element corresponds to the number of clusters in each class specified for estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>known.vec</code></td>
<td>
<p>A vector of length C giving logical values indicating whether a cluster allocation in each class is known or not. The default is all <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knowncluster.list</code></td>
<td>
<p>A vector of length C giving logical values indicating whether a cluster allocation in each class is known or not. The default is all <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nstart</code></td>
<td>
<p>An integer indicating the number of random initial values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>An integer indicating the maximum number of iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>An integer indicating the dimension of quantification.The default is 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>A numeric value indicating the absolute convergence tolerance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A logical value indicating. If <code>TRUE</code>, tracing information on the progress of the optimization is produced.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove.miss</code></td>
<td>
<p>A logical value indicating whether categories nobody choose are removed nor not. The default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kmeans.initial</code></td>
<td>
<p>A logical value indicating whether the 1st initial value for indicator matrix is generated by kmeans or not. The default is <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>Bg</code>,<code>Gg</code> and <code>Qg</code> are scaled <code>B</code>,<code>G</code> and <code>Q</code> respectively, such that the average squared deviation from the origin of the row and column points is the same (See section 2.3 in the paper).
</p>
<p>If you want to specify the cluster allocation for some or all classes, prepare the following two.
</p>
<p>-<code>knowncluster.list</code>: A list of C vectors. The length of each vector in the list should be the same as the number of rows in each matrix in the <code>data.list</code>
(ex. <code>length(knowncluster.list[[c]])=nrow(data.list[[c]])</code>, (c=1,..,C)).
For example, suppose that <code>data.list</code> is a list of 4 matrices (meaning C=4),
and the cluster assignment is known only for the second class,
and the assignments in other classes are estimated. In this case,
the second vector of <code>knowncluster.list</code> should be specified as the vector of cluster indexes
to which the observations in each row of <code>data.list[[2]]</code> belong, with length <code>nrow(data.list[[2]])</code>,
and the other vectors (1, 3, and 4) in the list can be specified as <code>NA</code>. For each vector in the <code>knowncluster.list</code>,
the specified cluster index should start from 1, and there should not be any skipping numbers.
</p>
<p>-<code>known.vec</code>: A vector of logical values of length C. For example,
if C=4 and you want to know the cluster assignment of only the second class, it should be <code>known.vec=c(FALSE,TRUE,FALSE,FALSE)</code>.
</p>


<h3>Value</h3>

<p>Returns a list with the following elements.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>A (Kxp) quantification matrix for all clusters (K=<code>sum(K.vec)</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gg</code></td>
<td>
<p>Scaled <code>G</code>. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>A (Qxp) quantification matrix for all categories (Q=<code>sum(q.vec)</code>, and <code>q.vec</code> is given in <code>create.MCCCAdata</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Bg</code></td>
<td>
<p>Scaled <code>B</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q</code></td>
<td>
<p>A (Nxp) quantification matrix for all observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Qg</code></td>
<td>
<p>Scaled <code>Q</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clses.list</code></td>
<td>
<p>A list of C vectors, giving the estimated cluster index for each observation in each class.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clses.vec</code></td>
<td>
<p>A vector of length N, where each element represents the cluster index to which the observations in the rows of <code>data.mat</code> (given in <code>mccca.data</code>) belong.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optval</code></td>
<td>
<p>A numeric value giving the optimized value of the objective function that is the smallest among all initial values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optval.vec</code></td>
<td>
<p>A numeric vector of length <code>nstart</code> giving the optimized values of the objective function for each initial value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stepconv</code></td>
<td>
<p>An integer giving the number of iterations until convergence at the initial value where the objective function was the smallest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stepconv.vec</code></td>
<td>
<p>An integer vector of length <code>nstart</code> giving the number of iterations until convergence for each initial value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>catename.vec</code></td>
<td>
<p>A characteristic vector of length <code>Q</code> that combines the category names of each categorical variable into a single vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>catename.vari.vec</code></td>
<td>
<p>A characteristic vector of length <code>Q</code> with <code>catename.vec</code> plus the name of categorical variable (by default, this is used as the column name of <code>B</code> and <code>Bg</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cate.removed</code></td>
<td>
<p>If there is a category that no one chooses and <code>remove.miss</code>=TRUE, <code>cate.removed</code> gives which category was removed (given by the index of column in dummy matrix). Otherwise, return <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster.vec</code></td>
<td>
<p>An integer vector of length K, where each index in the <code>clses.list</code> and <code>clses.vec</code> indicates which class it corresponds to.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q.vec</code></td>
<td>
<p>A vector of length J, same as the one given in <code>mccca.data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K.vec</code></td>
<td>
<p>A vector of length C, which is used as an input in this <code>MCCCA</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>classlabel</code></td>
<td>
<p>A characteristic vector of length C, same as the one given in <code>mccca.data</code>.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Takagishi &amp; Michel van de Velden (2022): Visualizing Class Specific
Heterogeneous Tendencies in Categorical Data, Journal of Computational and Graphical Statistics,
DOI: 10.1080/10618600.2022.2035737
</p>


<h3>See Also</h3>

<p><code>create.MCCCAdata</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#setting
N &lt;- 100 ; J &lt;- 5 ; Ktrue &lt;- 2 ; q.vec &lt;- rep(5,J) ; noise.prop &lt;- 0.2
extcate.vec=c(2,3)#the number of categories for each external variable

#generate categorical variable data
catedata.list &lt;- generate.onedata(N=N,J=J,Ktrue=Ktrue,q.vec=q.vec,noise.prop = noise.prop)
data.cate=catedata.list$data.mat
clstr0.vec=catedata.list$clstr0.vec

#generate external variable data
data.ext=generate.ext(N,extcate.vec=extcate.vec)

#create mccca.list to be applied to MCCCA function
mccca.data=create.MCCCAdata(data.cate,ext.mat=data.ext,clstr0.vec =clstr0.vec)

#specify the number of cluster for each of C classes
C=length(mccca.data$data.list)
K.vec=rep(2,C)

#apply MCCCA
mccca.res=MCCCA(mccca.data,K.vec=K.vec)

#plot MCCCA result
plot(mccca.res)

#if you want to specify cluster allocation in the 2nd class:
knowncluster.list=rep(list(NA),C)
#specify cluster index for the 2nd class
N2=nrow(mccca.data$data.list[[2]])
knowncluster.list[[2]]=rep(c(1,2),times=c(2,N2-2))
known.vec=c(FALSE,TRUE,FALSE,FALSE,FALSE,FALSE)
mccca.res=MCCCA(mccca.data,K.vec=K.vec,known.vec=known.vec,knowncluster.list = knowncluster.list)
</code></pre>


</div>