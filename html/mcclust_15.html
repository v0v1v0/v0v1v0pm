<div class="container">

<table style="width: 100%;"><tr>
<td>relabel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Stephens' Relabelling Algorithm for Clusterings</h2>

<h3>Description</h3>

<p>For a sample of clusterings in which corresponding clusters have different labels the algorithm attempts to bring 
the clusterings to a unique labelling.  
</p>


<h3>Usage</h3>

<pre><code class="language-R">relabel(cls, print.loss = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cls</code></td>
<td>
<p>a matrix in which every row corresponds to a clustering of the <code>ncol(cls)</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.loss</code></td>
<td>
<p>logical, should current value of loss function be printed after each iteration? Defaults to TRUE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The algorithm minimizes the loss function </p>
<p style="text-align: center;"><code class="reqn">\sum_{m=1}^M\sum_{i=1}^n\sum_{j=1}^K-\log\hat{p}_{ij} \cdot I_{\{z_i^{(m)}=j\}}</code>
</p>

<p>over the <code class="reqn">M</code> clusterings, <code class="reqn">n</code> observations and <code class="reqn">K</code> clusters, where <code class="reqn">\hat{p}_{ij}</code> is the
estimated probability that observation <code class="reqn">i</code> belongs to cluster <code class="reqn">j</code> and <code class="reqn">z_i^{(m)}</code> indicates to which cluster
observation <code class="reqn">i</code> belongs in clustering <code class="reqn">m</code>. <code class="reqn">I_{\{.\}}</code> is an indicator function.
</p>
<p>Minimization is achieved by iterating the estimation of <code class="reqn">\hat{p}_{ij}</code> over all clusterings and the
minimization of the loss function in each clustering by permuting the cluster labels. The latter is
done by linear programming.   
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cls</code></td>
<td>
<p>the input <code>cls</code> with unified labelling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>an <code class="reqn">n \times K</code> matrix, where entry <code class="reqn">[i,j]</code> contains the estimated probability that observation
<code class="reqn">i</code> belongs to cluster <code class="reqn">j</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loss.val</code></td>
<td>
<p>value of the loss function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>
<p>vector of cluster memberships that have the highest probabilities <code class="reqn">\hat{p}_{ij}</code>.</p>
</td>
</tr>
</table>
<h3>Warning</h3>

<p>The algorithm assumes that the number of clusters <code class="reqn">K</code> is fixed. If this is not the case
<code class="reqn">K</code> is taken to be the most common number of clusters. Clusterings with other numbers of clusters are discarded
and a warning is issued.   
</p>


<h3>Note</h3>

 
<p>The implementation is a variant of the algorithm of Stephens which is originally applied to draws of parameters 
for each observation, not to cluster labels.   
</p>


<h3>Author(s)</h3>

<p> Arno Fritsch, <a href="mailto:arno.fritsch@tu-dortmund.de">arno.fritsch@tu-dortmund.de</a></p>


<h3>References</h3>

<p>Stephens, M. (2000) Dealing with label switching in mixture models. 
<em>Journal of the Royal Statistical Society Series B</em>, <b>62</b>, 795â€“809. </p>


<h3>See Also</h3>

 <p><code>lp.transport</code> for the linear programming, <code>maxpear</code>, <code>minbinder</code>, <code>medv</code>
for other possibilities of processing a sample of clusterings.</p>


<h3>Examples</h3>

<pre><code class="language-R">(cls &lt;- rbind(c(1,1,2,2),c(1,1,2,2),c(1,2,2,2),c(2,2,1,1)))
# group 2 in clustering 4 corresponds to group 1 in clustering 1-3.
cls.relab &lt;- relabel(cls)
cls.relab$cls
</code></pre>


</div>