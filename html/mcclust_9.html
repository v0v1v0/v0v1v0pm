<div class="container">

<table style="width: 100%;"><tr>
<td>maxpear</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Maximize/Compute Posterior Expected Adjusted Rand Index</h2>

<h3>Description</h3>

<p>Based on a posterior similarity matrix of a sample of clusterings <code>maxpear</code> finds the clustering that maximizes the 
posterior expected Rand adjusted index (PEAR) with the true clustering, while <code>pear</code> computes PEAR for several provided clusterings. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">maxpear(psm, cls.draw = NULL, method = c("avg", "comp", "draws",
         "all"), max.k = NULL)

pear(cls,psm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>psm</code></td>
<td>
<p> a posterior similarity matrix, usually obtained from a call to <code>comp.psm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cls, cls.draw</code></td>
<td>
<p>a matrix in which every row corresponds to a clustering of the <code>ncol(cls)</code> objects.
<code>cls.draw</code> refers to the clusterings that have been used to compute <code>psm</code>, <code>cls.draw</code> has to be provided if 
<code>method="draw"</code> or <code>"all"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the maximization method used. Should be one of <code>"avg"</code>, <code>"comp"</code>, <code>"draws"</code> or <code>"all"</code>. The default is <code>"avg"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.k</code></td>
<td>
<p> integer, if <code>method="avg"</code> or <code>"comp"</code> the maximum number of clusters up to which the hierarchical clustering is cut.
Defaults to <code>ceiling(nrow(psm)/8)</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For <code>method="avg"</code> and <code>"comp"</code> <code>1-psm</code> is used as a distance matrix for hierarchical clustering with average/complete linkage.
The hierachical clustering is cut for the cluster sizes <code>1:max.k</code> and PEAR computed for these clusterings.<br>
Method <code>"draws"</code> simply computes PEAR for each row of <code>cls.draw</code> and takes the maximum.<br>
If <code>method="all"</code> all maximization methods are applied. 
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>
<p>clustering with maximal value of PEAR. If <code>method="all"</code> a matrix containing the clustering with the higest value
of PEAR over all methods in the first row and the clusterings of the individual methods in the next rows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>value of PEAR. A vector corresponding to the rows of <code>cl</code> if <code>method="all"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the maximization method used.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Arno Fritsch, <a href="mailto:arno.fritsch@tu-dortmund.de">arno.fritsch@tu-dortmund.de</a></p>


<h3>References</h3>

<p>Fritsch, A. and Ickstadt, K. (2009) An improved criterion for clustering based on the
posterior similarity matrix, <em>Bayesian Analysis</em>, accepted.</p>


<h3>See Also</h3>

 <p><code>comp.psm</code> for computing posterior similarity matrix, <code>minbinder</code>, <code>medv</code>, <code>relabel</code>
for other possibilities for processing a sample of clusterings.</p>


<h3>Examples</h3>

<pre><code class="language-R">data(cls.draw1.5) 
# sample of 500 clusterings from a Bayesian cluster model 
tru.class &lt;- rep(1:8,each=50) 
# the true grouping of the observations
psm1.5 &lt;- comp.psm(cls.draw1.5)
mpear1.5 &lt;- maxpear(psm1.5)
table(mpear1.5$cl, tru.class)

# Does hierachical clustering with Ward's method lead 
# to a better value of PEAR?
hclust.ward &lt;- hclust(as.dist(1-psm1.5), method="ward")
cls.ward &lt;- t(apply(matrix(1:20),1, function(k) cutree(hclust.ward,k=k)))
ward1.5 &lt;- pear(cls.ward, psm1.5)
max(ward1.5) &gt; mpear1.5$value

</code></pre>


</div>