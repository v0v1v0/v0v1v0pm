<div class="container">

<table style="width: 100%;"><tr>
<td>add_lagr.mcgf_rs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Add lagr model outputted from <code>fit_lagr()</code> to a <code>mcgf_rs</code> object.</h2>

<h3>Description</h3>

<p>Add lagr model outputted from <code>fit_lagr()</code> to a <code>mcgf_rs</code> object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'mcgf_rs'
add_lagr(x, fit_lagr_ls, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An <code>mcgf_rs</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit_lagr_ls</code></td>
<td>
<p>Output from the <code>fit_lagr()</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments. Not in use.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>After fitting the Lagrangian model by <code>fit_lagr()</code>, the results can be
added to <code>x</code> by <code>add_base()</code>. To supply the Lagrangian model directly,
use <code>lagr&lt;-</code> to add the Lagrangian model; the value must contain the same
output as <code>add_lagr.mcgf()</code> or <code>add_lagr.mcgf_rs()</code>.
</p>


<h3>Value</h3>

<p><code>x</code> with newly added attributes of the Lagrangian model.
</p>


<h3>See Also</h3>

<p>Other functions on fitting an mcgf_rs: 
<code>add_base.mcgf_rs()</code>,
<code>fit_base.mcgf_rs()</code>,
<code>fit_lagr.mcgf_rs()</code>,
<code>krige.mcgf_rs()</code>,
<code>krige_new.mcgf_rs()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(sim3)
sim3_mcgf &lt;- mcgf_rs(sim3$data, dists = sim3$dists, label = sim3$label)
sim3_mcgf &lt;- add_acfs(sim3_mcgf, lag_max = 5)
sim3_mcgf &lt;- add_ccfs(sim3_mcgf, lag_max = 5)

# Fit a fully symmetric model with known variables
fit_fs &lt;- fit_base(
    sim3_mcgf,
    lag_ls = 5,
    model_ls = "fs",
    rs = FALSE,
    par_init_ls = list(list(beta = 0)),
    par_fixed_ls = list(list(
        nugget = 0,
        c = 0.05,
        gamma = 0.5,
        a = 0.5,
        alpha = 0.2
    ))
)

# Set beta to 0 to fit a separable model with known variables
fit_fs[[1]]$fit$par &lt;- 0

# Store the fitted separable model to 'sim3_mcgf'
sim3_mcgf &lt;- add_base(sim3_mcgf, fit_base_ls = fit_fs)

# Fit a regime-switching Lagrangian model.
fit_lagr_rs &lt;- fit_lagr(
    sim3_mcgf,
    model_ls = list("lagr_tri"),
    par_init_ls = list(
        list(v1 = -50, v2 = 50),
        list(v1 = 100, v2 = 100)
    ),
    par_fixed_ls = list(list(lambda = 0.2, k = 2))
)

# Store the fitted Lagrangian model to 'sim3_mcgf'
sim3_mcgf &lt;- add_lagr(sim3_mcgf, fit_lagr_ls = fit_lagr_rs)
model(sim3_mcgf)
</code></pre>


</div>