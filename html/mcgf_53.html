<div class="container">

<table style="width: 100%;"><tr>
<td>cor_stat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate general stationary correlation.</h2>

<h3>Description</h3>

<p>Calculate general stationary correlation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cor_stat(
  base = c("sep", "fs"),
  lagrangian = c("none", "lagr_tri", "lagr_askey"),
  par_base,
  par_lagr,
  lambda,
  h,
  h1,
  h2,
  u,
  base_fixed = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>base</code></td>
<td>
<p>Base model, <code>sep</code> or <code>fs</code> for now. Or correlation matrix/array.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lagrangian</code></td>
<td>
<p>Lagrangian model, <code>none</code>, <code>lagr_tri</code>, or <code>lagr_askey</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par_base</code></td>
<td>
<p>Parameters for the base model (symmetric), used only when
<code>base_fixed = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par_lagr</code></td>
<td>
<p>Parameters for the Lagrangian model. Used only when
<code>lagrangian</code> is not <code>none</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Weight of the Lagrangian term, <code class="reqn">\lambda\in[0, 1]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>Euclidean distance matrix or array, used only when
<code>base_fixed = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h1</code></td>
<td>
<p>Horizontal distance matrix or array, same dimension as <code>h</code>. Used
only when <code>lagrangian</code> is not <code>none</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h2</code></td>
<td>
<p>Vertical distance matrix or array, same dimension as <code>h</code>. Used
only when <code>lagrangian</code> is not <code>none</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>Time lag, same dimension as <code>h</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base_fixed</code></td>
<td>
<p>Logical; if TRUE, <code>base</code> is the correlation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The general station model, a convex combination of a base model
and a Lagrangian model, has the form
</p>
<p style="text-align: center;"><code class="reqn">C(\mathbf{h}, u)=(1-\lambda)C_{\text{Base}}(\mathbf{h}, u)+
\lambda C_{\text{Lagr}}(\mathbf{h}, u),</code>
</p>

<p>where <code class="reqn">\lambda</code> is the weight of the Lagrangian term.
</p>
<p>If <code>base_fixed = TRUE</code>, the correlation is of the form
</p>
<p style="text-align: center;"><code class="reqn">C(\mathbf{h}, u)=(1-\lambda)C_{\text{Base}}+
\lambda C_{\text{Lagr}}(\mathbf{h}, u),</code>
</p>

<p>where <code>base</code> is a correlation matrix/array and <code>par_base</code> and <code>h</code> are not
used.
</p>
<p>When <code>lagrangian = "none"</code>, <code>lambda</code> must be 0.
</p>


<h3>Value</h3>

<p>Correlations for the general stationary model. Same dimension of
<code>base</code> if <code>base_fixed = FALSE</code>.
</p>


<h3>See Also</h3>

<p>Other correlation functions: 
<code>cor_cauchy()</code>,
<code>cor_exp()</code>,
<code>cor_fs()</code>,
<code>cor_lagr_askey()</code>,
<code>cor_lagr_exp()</code>,
<code>cor_lagr_tri()</code>,
<code>cor_sep()</code>,
<code>cor_stat_rs()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">par_s &lt;- list(nugget = 0.5, c = 0.01, gamma = 0.5)
par_t &lt;- list(a = 1, alpha = 0.5)
par_base &lt;- list(par_s = par_s, par_t = par_t)
par_lagr &lt;- list(v1 = 5, v2 = 10)
h1 &lt;- matrix(c(0, 5, -5, 0), nrow = 2)
h2 &lt;- matrix(c(0, 8, -8, 0), nrow = 2)
h &lt;- sqrt(h1^2 + h2^2)
u &lt;- matrix(0.1, nrow = 2, ncol = 2)
cor_stat(
    base = "sep", lagrangian = "lagr_tri", par_base = par_base,
    par_lagr = par_lagr, lambda = 0.8, h = h, h1 = h1, h2 = h2, u = u
)

h1 &lt;- array(c(0, 5, -5, 0), dim = c(2, 2, 3))
h2 &lt;- array(c(0, 8, -8, 0), dim = c(2, 2, 3))
h &lt;- sqrt(h1^2 + h2^2)
u &lt;- array(rep(c(0.1, 0.2, 0.3), each = 4), dim = c(2, 2, 3))
fit_base &lt;- cor_fs(
    nugget = 0.5, c = 0.01, gamma = 0.5, a = 1, alpha = 0.5,
    beta = 0.0, h = h, u = u
)
par_lagr &lt;- list(v1 = 5, v2 = 10)
cor_stat(
    base = fit_base, lagrangian = "lagr_askey", par_lagr = par_lagr,
    h1 = h1, h2 = h2, u = u, lambda = 0.8, base_fixed = TRUE
)

</code></pre>


</div>