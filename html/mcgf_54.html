<div class="container">

<table style="width: 100%;"><tr>
<td>cor_stat_rs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate general stationary correlation.</h2>

<h3>Description</h3>

<p>Calculate general stationary correlation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cor_stat_rs(
  n_regime,
  base_ls,
  lagrangian_ls,
  par_base_ls,
  par_lagr_ls,
  lambda_ls,
  h_ls,
  h1_ls,
  h2_ls,
  u_ls,
  base_fixed = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n_regime</code></td>
<td>
<p>Integer, number of regimes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base_ls</code></td>
<td>
<p>List of base model, <code>sep</code> or <code>fs</code> for now. Or list of
correlation matrices/arrays.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lagrangian_ls</code></td>
<td>
<p>List of Lagrangian model, <code>lagr_tri</code> or <code>lagr_askey</code>
for now.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par_base_ls</code></td>
<td>
<p>List of parameters for the base model, used only when
<code>base_fixed = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par_lagr_ls</code></td>
<td>
<p>List of parameters for the Lagrangian model.  Used only
when <code>lagrangian_ls</code> is not <code>none</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda_ls</code></td>
<td>
<p>List of weight of the Lagrangian term,
<code class="reqn">\lambda\in[0, 1]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h_ls</code></td>
<td>
<p>List of Euclidean distance matrix or array,
used only when <code>base_fixed = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h1_ls</code></td>
<td>
<p>List of horizontal distance matrix or array, same dimension as
<code>h_ls</code>. Used only when <code>lagrangian_ls</code> is not <code>none</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h2_ls</code></td>
<td>
<p>List of vertical distance matrix or array, same dimension as
<code>h_ls</code>. Used only when <code>lagrangian_ls</code> is not <code>none</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u_ls</code></td>
<td>
<p>List of time lag, same dimension as <code>h_ls</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base_fixed</code></td>
<td>
<p>Logical; if TRUE, <code>base_ls</code> is the list of correlation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>It gives a list of general stationary correlation for <code>n_regime</code>
regimes. See cor_stat for the model details. Model parameters are lists of
length 1 or <code>n_regime</code>. When length is 1, same values are used for all
regimes. If <code>base_fixed = TRUE</code>, the base is a list of correlation and
<code>par_base_ls</code> and <code>h_ls</code> are not used.
</p>


<h3>Value</h3>

<p>Correlations for the general stationary model. Same dimension of
<code>base_ls</code> if <code>base_fixed = TRUE</code>.
</p>


<h3>See Also</h3>

<p>Other correlation functions: 
<code>cor_cauchy()</code>,
<code>cor_exp()</code>,
<code>cor_fs()</code>,
<code>cor_lagr_askey()</code>,
<code>cor_lagr_exp()</code>,
<code>cor_lagr_tri()</code>,
<code>cor_sep()</code>,
<code>cor_stat()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Fit general stationary model with sep base.
par_s &lt;- list(nugget = 0.5, c = 0.01, gamma = 0.5)
par_t &lt;- list(a = 1, alpha = 0.5)
par_base &lt;- list(par_s = par_s, par_t = par_t)
h1 &lt;- array(c(0, 5, -5, 0), dim = c(2, 2, 3))
h2 &lt;- array(c(0, 8, -8, 0), dim = c(2, 2, 3))
h &lt;- sqrt(h1^2 + h2^2)
u &lt;- array(rep(c(1, 2, 3), each = 4), dim = c(2, 2, 3))
cor_stat_rs(
    n_regime = 2,
    base_ls = list("sep"),
    lagrangian_ls = list("none", "lagr_tri"),
    par_base_ls = list(par_base),
    par_lagr_ls = list(NULL, list(v1 = 10, v2 = 20)),
    lambda_ls = list(0, 0.2),
    h_ls = list(h),
    h1_ls = list(NULL, h1),
    h2_ls = list(NULL, h2),
    u_ls = list(u, u + 1)
)

# Fit general stationary model given fs as the base model.
h1 &lt;- array(c(0, 5, -5, 0), dim = c(2, 2, 3))
h2 &lt;- array(c(0, 8, -8, 0), dim = c(2, 2, 3))
h &lt;- sqrt(h1^2 + h2^2)
u &lt;- array(rep(c(0.1, 0.2, 0.3), each = 4), dim = c(2, 2, 3))
fit_base &lt;- cor_fs(
    nugget = 0.5, c = 0.01, gamma = 0.5, a = 1, alpha = 0.5,
    beta = 0.0, h = h, u = u
)
par_lagr &lt;- list(v1 = 5, v2 = 10)
cor_stat_rs(
    n_regime = 2,
    par_lagr_ls = list(par_lagr),
    h1_ls = list(h1),
    h2_ls = list(h2),
    u_ls = list(u, u + 1),
    lambda_ls = list(0, 0.8),
    base_ls = list(fit_base),
    lagrangian = list("lagr_tri", "lagr_askey"),
    base_fixed = TRUE
)

</code></pre>


</div>