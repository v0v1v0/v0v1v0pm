<div class="container">

<table style="width: 100%;"><tr>
<td>find_dists_new</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate (signed) distances between coordinates</h2>

<h3>Description</h3>

<p>Calculate (signed) distances between coordinates
</p>


<h3>Usage</h3>

<pre><code class="language-R">find_dists_new(
  locations,
  locations_new,
  longlat = TRUE,
  origin = 1L,
  return_grid = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>locations</code></td>
<td>
<p>A matrix or data.frame of 2D points, the first column is
x/longitude, and the second column is y/latitude.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>locations_new</code></td>
<td>
<p>A matrix or data.frame of 2D points, the first column is
x/longitude, and the second column is y/latitude.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>longlat</code></td>
<td>
<p>Logical, if TURE Great Circle (WGS84 ellipsoid) distance;
if FALSE, Euclidean distance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>origin</code></td>
<td>
<p>Optional; used when <code>longlat</code> is TRUE. An integer index
indicating the reference location from <code>locations</code> which will be used as
the origin. Same <code>origin</code> from <code>find_dists</code> must be used to ensure
consistancy between outputs from <code>find_dists</code> and <code>find_dists_new</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_grid</code></td>
<td>
<p>Logical; used when <code>longlat</code> is TRUE. If TRUE the mapped
coordinates on a 2D plane for all locations is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Optional arguments passed to <code>.find_dists_new()</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>locations</code> and <code>locations_new</code> must be matrices or data.frames containing
2 columns, first column x/longitude, and second column y/latitude. The row
names of <code>locations</code> and <code>locations_new</code> are used as the names of the
locations.
</p>
<p>If <code>longlat</code> is TRUE, the original coordinates are mapped to a 2D Euclidean
plane given the reference location from <code>locations</code>. First, the Great Circle
(WGS84 ellipsoid) signed distance matrices are calculated, where the original
latitudes are replaced by the the mean of latitudes in <code>locations</code> to find
the signed longitudinal distances and the original longitudes are replaced by
the the mean of longitudes in <code>locations</code> to find the signed latitudinal
distances. Then given the index of a reference location <code>origin</code>, a new set
of coordinates in a 2D plane is generated where the coordinates are
determined by the signed distances between the locations and the reference
location. Finally distance matrices of the new coordinates for all stations
are outputted.
</p>


<h3>Value</h3>

<p>A list of distance matrices for all locations. If <code>return_grid</code> is
TRUE, a list consists of a list of distance matrices for all locations,
the mapped 2D grid for all locations, and the origin is returned.
</p>


<h3>Examples</h3>

<pre><code class="language-R">lon &lt;- c(110, 120, 130)
lat &lt;- c(50, 55, 60)
locations &lt;- cbind(lon, lat)
rownames(locations) &lt;- paste("Site", 1:3)
find_dists(locations)

locations_new &lt;- c(115, 55)
find_dists_new(locations, locations_new)
</code></pre>


</div>