<div class="container">

<table style="width: 100%;"><tr>
<td>fit_base.mcgf_rs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Parameter estimation for symmetric correlation functions for an <code>mcgf_rs</code>
object.</h2>

<h3>Description</h3>

<p>Parameter estimation for symmetric correlation functions for an <code>mcgf_rs</code>
object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'mcgf_rs'
fit_base(
  x,
  lag_ls,
  horizon = 1,
  model_ls,
  method_ls = "wls",
  optim_fn_ls = "nlminb",
  par_fixed_ls = list(NULL),
  par_init_ls,
  lower_ls = list(NULL),
  upper_ls = list(NULL),
  other_optim_fn_ls = list(NULL),
  dists_base_ls = list(NULL),
  scale_time = 1,
  rs = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An <code>mcgf_rs</code> object containing attributes <code>dists</code>, <code>acfs</code>, <code>ccfs</code>,
and <code>sds</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lag_ls</code></td>
<td>
<p>List of integer time lags.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>horizon</code></td>
<td>
<p>Integer forecast horizon.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model_ls</code></td>
<td>
<p>List of base models, each element must be one of <code>spatial</code>,
<code>temporal</code>, <code>sep</code>, <code>fs</code>. Only <code>sep</code> and <code>fs</code> are supported when <code>mle</code> is used
in <code>model_ls</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method_ls</code></td>
<td>
<p>List of parameter estimation methods, weighted least square
(<code>wls</code>) or maximum likelihood estimation (<code>mle</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim_fn_ls</code></td>
<td>
<p>List of optimization functions, each element must be one
of <code>nlminb</code>, <code>optim</code>, <code>other</code>. When use <code>other</code>, supply <code>other_optim_fn_ls</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par_fixed_ls</code></td>
<td>
<p>List of fixed parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par_init_ls</code></td>
<td>
<p>List of initial values for parameters to be optimized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower_ls</code></td>
<td>
<p>Optional; list of lower bounds of parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper_ls</code></td>
<td>
<p>Optional: list of upper bounds of parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>other_optim_fn_ls</code></td>
<td>
<p>Optional, list of other optimization functions. The
first two arguments must be initial values for the parameters and a function
to be minimized respectively (same as that of <code>optim</code> and <code>nlminb</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dists_base_ls</code></td>
<td>
<p>List of lists of distance matrices. If NULL, <code>dists(x)</code>
is used. Each element must be a matrix or an array of distance matrices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale_time</code></td>
<td>
<p>Scale of time unit, default is 1. <code>lag</code> is divided by
<code>scale_time</code> for parameter estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rs</code></td>
<td>
<p>Logical; if TRUE <code>x</code> is treated as a regime-switching, FALSE if the
parameters need to be estimated in a non-regime-switching setting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to all <code>optim_fn_ls</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This functions is the regime-switching variant of <code>fit_base.mcgf()</code>.
Arguments are in lists. The length of arguments that end in <code style="white-space: pre;">⁠_ls⁠</code> must be 1
or the same as the number of regimes in <code>x</code>. If the length of an argument is
1, then it is set the same for all regimes. Refer to <code>fit_base.mcgf()</code> for
more details of the arguments.
</p>
<p>Note that both <code>wls</code> and <code>mle</code> are heuristic approaches when <code>x</code> contains
observations from a subset of the discrete spatial domain, though estimation
results are close to that using the full spatial domain for large sample
sizes.
</p>


<h3>Value</h3>

<p>A list containing outputs from optimization functions of <code>optim_fn</code>
for each regime.
</p>


<h3>See Also</h3>

<p>Other functions on fitting an mcgf_rs: 
<code>add_base.mcgf_rs()</code>,
<code>add_lagr.mcgf_rs()</code>,
<code>fit_lagr.mcgf_rs()</code>,
<code>krige.mcgf_rs()</code>,
<code>krige_new.mcgf_rs()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(sim2)
sim2_mcgf &lt;- mcgf_rs(sim2$data, dists = sim2$dists, label = sim2$label)
sim2_mcgf &lt;- add_acfs(sim2_mcgf, lag_max = 5)
sim2_mcgf &lt;- add_ccfs(sim2_mcgf, lag_max = 5)

# Fit a regime-switching pure spatial model
fit_spatial &lt;-
    fit_base(
        sim2_mcgf,
        lag_ls = 5,
        model_ls = "spatial",
        par_init_ls = list(c(c = 0.00005, gamma = 0.5)),
        par_fixed_ls = list(c(nugget = 0))
    )
lapply(fit_spatial[1:2], function(x) x$fit)

# Fit a regime-switching pure temporal model
fit_temporal &lt;-
    fit_base(
        sim2_mcgf,
        lag_ls = 5,
        model_ls = "temporal",
        par_init_ls = list(
            list(a = 0.8, alpha = 0.8),
            list(a = 0.1, alpha = 0.1)
        )
    )
lapply(fit_temporal[1:2], function(x) x$fit)

# Fit a regime-switching separable model
fit_sep &lt;- fit_base(
    sim2_mcgf,
    lag_ls = 5,
    model_ls = "sep",
    par_init_ls = list(list(
        c = 0.00005,
        gamma = 0.5,
        a = 0.5,
        alpha = 0.5
    )),
    par_fixed_ls = list(c(nugget = 0))
)
lapply(fit_sep[1:2], function(x) x$fit)
</code></pre>


</div>