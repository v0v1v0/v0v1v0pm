<div class="container">

<table style="width: 100%;"><tr>
<td>mblogit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Baseline-Category Logit Models for Categorical and Multinomial Responses</h2>

<h3>Description</h3>

<p>The function <code>mblogit</code> fits baseline-category logit models for categorical
and multinomial count responses with fixed alternatives.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mblogit(
  formula,
  data = parent.frame(),
  random = NULL,
  catCov = c("free", "diagonal", "single"),
  subset,
  weights = NULL,
  na.action = getOption("na.action"),
  model = TRUE,
  x = FALSE,
  y = TRUE,
  contrasts = NULL,
  method = NULL,
  estimator = c("ML", "REML"),
  dispersion = FALSE,
  start = NULL,
  from.table = FALSE,
  groups = NULL,
  control = if (length(random)) mmclogit.control(...) else mclogit.control(...),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>the model formula. The response must be a factor or a matrix
of counts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame, list or environment (or object coercible
by <code>as.data.frame</code> to a data frame) containing the variables
in the model.  If not found in <code>data</code>, the variables are taken from
<code>environment(formula)</code>, typically the environment from which
<code>glm</code> is called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random</code></td>
<td>
<p>an optional formula or list of formulas that specify the
random-effects structure or NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>catCov</code></td>
<td>
<p>a character string that specifies optional restrictions
on the covariances of random effects between the logit equations.
"free" means no restrictions, "diagonal" means that random effects
pertinent to different categories are uncorrelated, while "single" means
that the random effect variances pertinent to all categories are identical.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be
used in the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>an optional vector of weights to be used in the fitting
process.  Should be <code>NULL</code> or a numeric vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen when the data
contain <code>NA</code>s.  The default is set by the <code>na.action</code> setting
of <code>options</code>, and is <code>na.fail</code> if that is unset.
The ‘factory-fresh’ default is <code>na.omit</code>.  Another
possible value is <code>NULL</code>, no action.  Value <code>na.exclude</code>
can be useful.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a logical value indicating whether <em>model frame</em> should be
included as a component of the returned value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>logical values indicating whether the response vector and model
matrix used in the fitting process should be returned as components of
the returned value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>an optional list. See the <code>contrasts.arg</code> of
<code>model.matrix.default</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p><code>NULL</code> or a character string, either "PQL" or "MQL",
specifies the type of the quasilikelihood approximation to be used if a
random-effects model is to be estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimator</code></td>
<td>
<p>a character string; either "ML" or "REML", specifies which
estimator is to be used/approximated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dispersion</code></td>
<td>
<p>a logical value or a character string; whether and how a
dispersion parameter should be estimated. For details see
<code>dispersion</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>an optional matrix of starting values (with as many rows
as logit equations). If the model has random effects, the matrix
should have a "VarCov" attribute wtih starting values for
the random effects (co-)variances. If the random effects model
is estimated with the "PQL" method, the starting values matrix
should also have a "random.effects" attribute, which should have
the same structure as the "random.effects" component of an object
returned by <code>mblogit()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>from.table</code></td>
<td>
<p>a logical value; do the data represent a contingency table,
e.g. were created by applying <code>as.data.frame()</code> a the result of
<code>table()</code> or <code>xtabs()</code>.  This relevant only if the response is
a factor. This argument should be set to <code>TRUE</code> if the data do come
from a contingency table. Correctly setting <code>from.table=TRUE</code> in
this case, will lead to efficiency gains in computing, but more
importantly overdispersion will correctly be computed if present.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>an optional formula that specifies groups of observations
relevant for the specification of overdispersed response counts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of parameters for the fitting process.  See
<code>mclogit.control</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments to be passed to <code>mclogit.control</code> or
<code>mmclogit.control</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>mblogit</code> internally rearranges the data into a
'long' format and uses <code>mclogit.fit</code> to compute
estimates. Nevertheless, the 'user data' are unaffected.
</p>


<h3>Value</h3>

<p><code>mblogit</code> returns an object of class "mblogit", which has almost
the same structure as an object of class "glm". The
difference are the components <code>coefficients</code>, <code>residuals</code>,
<code>fitted.values</code>, <code>linear.predictors</code>, and <code>y</code>, which are
matrices with number of columns equal to the number of response
categories minus one.
</p>


<h3>References</h3>

<p>Agresti, Alan. 2002.
<em>Categorical Data Analysis.</em> 2nd ed, Hoboken, NJ: Wiley.
<a href="https://doi.org/10.1002/0471249688">doi:10.1002/0471249688</a>
</p>
<p>Breslow, N.E. and D.G. Clayton. 1993.
"Approximate Inference in Generalized Linear Mixed Models".
<em>Journal of the American Statistical Association</em> 88 (421): 9-25.
<a href="https://doi.org/10.1080/01621459.1993.10594284">doi:10.1080/01621459.1993.10594284</a>
</p>


<h3>See Also</h3>

<p>The function <code>multinom</code> in package <span class="pkg">nnet</span> also
fits multinomial baseline-category logit models, but has a slightly less
convenient output and does not support overdispersion or random
effects. However, it provides some other options. Baseline-category logit
models are also supported by the package <span class="pkg">VGAM</span>, as well as some
reduced-rank and (semi-parametric) additive generalisations.  The package
<span class="pkg">mnlogit</span> estimates logit models in a way optimized for large numbers
of alternatives.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(MASS) # For 'housing' data
library(nnet)
library(memisc)

(house.mult&lt;- multinom(Sat ~ Infl + Type + Cont, weights = Freq,
                       data = housing))


(house.mblogit &lt;- mblogit(Sat ~ Infl + Type + Cont, weights = Freq,
                         data = housing))

summary(house.mult)

summary(house.mblogit)

mtable(house.mblogit)
</code></pre>


</div>