<div class="container">

<table style="width: 100%;"><tr>
<td>rangepowerTransform</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Range–power transformation</h2>

<h3>Description</h3>

<p>Functions to compute univariate range–power transformation and its
back-transform.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rangepowerTransform(x, lbound = -Inf, ubound = +Inf, lambda = 1)

rangepowerBackTransform(y, lbound = -Inf, ubound = +Inf, lambda = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A numeric vector of data values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lbound</code></td>
<td>
<p>A numerical value of variable lower bound.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ubound</code></td>
<td>
<p>A numerical value of variable upper bound.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>A numerical value for the power transformation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A numeric vector of transformed data values.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <em>range-power transformation</em> can be applied to variables with
bounded support.
</p>
<p><strong>Lower bound case</strong>
</p>
<p>Suppose <code class="reqn">x</code> is a univariate random variable with lower bounded support
<code class="reqn">\mathcal{S}_{\mathcal{X}} \equiv (l,\infty)</code>, where <code class="reqn">l &gt; -\infty</code>.
Consider a preliminary <em>range transformation</em> defined as <code class="reqn">x \mapsto
(x - l)</code>, which maps <code class="reqn">\mathcal{S}_{\mathcal{X}} \to \mathbb{R}^{+}</code>.<br>
The <em>range-power transformation</em> is a continuous monotonic transformation
defined as
</p>
<p style="text-align: center;"><code class="reqn"> t(x; \lambda) = 
\begin{cases} \dfrac{(x-l)^{\lambda} - 1}{\lambda} &amp; 
\quad\text{if}\; \lambda \ne 0 \\[1ex] \log(x-l) &amp;
\quad\text{if}\; \lambda = 0 
\end{cases} </code>
</p>

<p>with back-transformation function
</p>
<p style="text-align: center;"><code class="reqn"> t^{-1}(y; \lambda) = 
\begin{cases} (\lambda y + 1)^{1/\lambda} + l &amp;
\quad\text{if}\; \lambda \ne 0 \\[1ex] \exp(y)+l &amp; 
\quad\text{if}\; \lambda = 0 
\end{cases} </code>
</p>

<p><strong>Lower and upper bound case</strong>
</p>
<p>Suppose <code class="reqn">x</code> is a univariate random variable with bounded support
<code class="reqn">\mathcal{S}_{\mathcal{X}} \equiv (l,u)</code>, where <code class="reqn">-\infty &lt; l &lt; u &lt;
+\infty</code>. Consider a preliminary <em>range transformation</em> defined as
<code class="reqn">x \mapsto (x - l)/(u - x)</code>, which maps <code class="reqn">\mathcal{S}_{\mathcal{X}}
\to \mathbb{R}^{+}</code>.<br>
In this case, the <em>range-power transformation</em> is a continuous monotonic
transformation defined as
</p>
<p style="text-align: center;"><code class="reqn"> t(x; \lambda) =
\begin{cases} 
\dfrac{ \left( \dfrac{x-l}{u-x} \right)^{\lambda} - 1}{\lambda} &amp; 
\quad\text{if}\; \lambda \ne 0 \\[2ex] 
\log \left( \dfrac{x-l}{u-x} \right) &amp; 
\quad\text{if}\; \lambda = 0, 
\end{cases} </code>
</p>
<p> with back-transformation function
</p>
<p style="text-align: center;"><code class="reqn"> t^{-1}(y; \lambda) = 
\begin{cases}
\dfrac{l + u (\lambda y + 1)^{1/\lambda}}{1+(\lambda y + 1)^{1/\lambda}} &amp;
\quad\text{if}\; \lambda \ne 0 \\[1ex] \dfrac{l + u \exp(y)}{1+\exp(y)} &amp;
\quad\text{if}\; \lambda = 0 
\end{cases} </code>
</p>



<h3>Value</h3>

<p>Returns a vector of transformed or back-transformed values.
</p>


<h3>Author(s)</h3>

<p>Luca Scrucca
</p>


<h3>References</h3>

<p>Scrucca L. (2019) A transformation-based approach to Gaussian
mixture density estimation for bounded data. <em>Biometrical Journal</em>,
61:4, 873–888. <a href="https://doi.org/10.1002/bimj.201800174">doi:10.1002/bimj.201800174</a>
</p>


<h3>See Also</h3>

<p><code>densityMclustBounded</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Lower bound case
x = rchisq(1000, 5)
y = rangepowerTransform(x, lbound = 0, lambda = 1/3)
par(mfrow=c(2,2))
hist(x, main = NULL, breaks = 21); rug(x)
hist(y, xlab = "y = t(x)", main = NULL, breaks = 21); rug(y)
xx = rangepowerBackTransform(y, lbound = 0, lambda = 1/3)
hist(xx, xlab = "t^-1(y) = x", main = NULL, breaks = 21); rug(xx)
plot(x, xx, ylab = "t^-1(y)"); abline(0,1)

# Lower and upper bound case
x = rbeta(1000, 2, 1)
y = rangepowerTransform(x, lbound = 0, ubound = 1, lambda = 0)
par(mfrow=c(2,2))
hist(x, main = NULL, breaks = 21); rug(x)
hist(y, xlab = "y = t(x)", main = NULL, breaks = 21); rug(y)
xx = rangepowerBackTransform(y, lbound = 0, ubound = 1, lambda = 0)
hist(xx, xlab = "t^-1(y) = x", main = NULL, breaks = 21); rug(xx)
plot(x, xx, ylab = "t^-1(y)"); abline(0,1)

</code></pre>


</div>