<div class="container">

<table style="width: 100%;"><tr>
<td>Get diagnostics</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Get diagnostic statistics
</h2>

<h3>Description</h3>

<p>These functions calculated diagnostic statistics for objects of class <code>mcmcOutput</code>. Optionally, only values that are worse than a predefined threshold will be returned, and values can be sorted so that the worst are at the start of the output vector.
</p>


<h3>Usage</h3>

<pre><code class="language-R">getMCE(x, pc=TRUE, bad=5, sort=TRUE)
getNeff(x, bad=10000, sort=TRUE)
getRhat(x, bad=1.1, sort=TRUE)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>an object of any class with MCMC output that can be coerced to class <code>mcmcOutput</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pc</code></td>
<td>

<p>if TRUE, the value of the MC error as a percentage of the posterior SD will be returned.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bad</code></td>
<td>

<p>threshold for "bad" values: only values above this (for <code>getMCE</code> or <code>getRhat</code>) or below this (for <code>getNeff</code>) will be returned. If <code>bad = NA</code>, all values will be returned, including NAs.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sort</code></td>
<td>

<p>if TRUE, the values will be sorted, with the worst at the top.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>getRhat</code> returns the Brooks-Gelman-Rubin (BGR) convergence diagnostic (Brooks &amp; Gelman 1998), a non-parametric 'interval' estimator of the 'potential scale reduction factor' for MCMC output. Similar to the function <code>coda::gelman.diag</code>, but faster when thousands of parameters are involved and will not cause R to crash.
</p>
<p><code>getMCE</code> returns the Monte Carlo standard error calculated using the batch method of Lunn et al (2013, p77); see also Roberts (1996).
</p>
<p><code>getNeff</code> returns the effective number of draws taking account of autocorrelation within each chain. It is a wrapper for <code>coda::effectiveSize</code>.
</p>


<h3>Value</h3>

<p>A named vector with the values of the diagnostic. Values of NA will be excluded unless <code>bad = NA</code>. It may have length 0 if no values are bad.
</p>


<h3>Author(s)</h3>

<p>Mike Meredith
</p>


<h3>References</h3>

<p>Brooks, S.P. &amp; Gelman, A. (1998) General methods for monitoring convergence of iterative simulations. <em>Journal of Computational and Graphical Statistics</em>, 7, 434-455.
</p>
<p>Lunn, D., Jackson, C., Best, N., Thomas, A., &amp; Spiegelhalter, D. (2013) <em>The BUGS book: a practical introduction to Bayesian analysis</em>, Chapman and Hall.
</p>
<p>Roberts, G.O. (1996). Markov chain concepts related to sampling algorithms. In <em>Markov Chain Monte Carlo in practice</em> (eds W.R. Gilks, D.J. Spiegelhalter &amp; S. Richardson). Chapman &amp; Hall, London.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(mcmcListExample)
mco &lt;- mcmcOutput(mcmcListExample)

getMCE(mco, bad=2)
getMCE(mco, bad=0)  # returns all except NAs
getMCE(mco, bad=NA)  # returns all including NAs
getMCE(mco, bad=NA, sort=FALSE)  # returns all, in original order

getNeff(mco, bad=2800)
getNeff(mco, bad=Inf)  # returns all except NAs
getNeff(mco, bad=NA)   # returns all including NAs

getRhat(mco)
getRhat(mco, bad=0)
getRhat(mco, bad=NA, sort=FALSE)

# Extract the values with 'bad' MCE and do plots:
( badNodes &lt;- names(getMCE(mco, bad=2)) )
( badMco &lt;- mco[badNodes] )
plot(badMco)
</code></pre>


</div>