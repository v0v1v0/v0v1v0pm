<div class="container">

<table style="width: 100%;"><tr>
<td>multiESS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Effective Sample Size of a multivariate Markov chain as described in Vats et al. (2015).</h2>

<h3>Description</h3>

<p>Calculate the effective sample size of the Markov chain, using the multivariate dependence
structure of the process.
</p>


<h3>Usage</h3>

<pre><code class="language-R">multiESS(x, covmat = NULL, g = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a matrix or data frame of Markov chain output. Number of rows is the Monte Carlo sample
size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covmat</code></td>
<td>
<p>optional matrix estimate obtained using <code>mcse.multi</code> or <code>mcse.initseq</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>a function that represents features of interest. <code>g</code> is applied to each row of <code>x</code> and
thus <code>g</code> should take a vector input only. If <code>g</code> is <code>NULL</code>, <code>g</code> is set to be identity, which
is estimation of the mean of the target density.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments for <code>mcse.multi</code> function. Don't use this if a suitable matrix estimate
from <code>mcse.multi</code> or <code>mcse.initseq</code> is already obtained.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Effective sample size is the size of an iid sample with the same variance as the current sample.
ESS is given by </p>
<p style="text-align: center;"><code class="reqn">ESS = n\frac{|\Lambda|^{1/p}}{|\Sigma|^{1/p}},</code>
</p>
<p> where <code class="reqn">\Lambda</code> is the
sample covariance matrix for <code>g</code> and <code class="reqn">\Sigma</code> is an estimate of the Monte Carlo standard
error for <code>g</code>.
</p>


<h3>Value</h3>

<p>The function returns the estimated effective sample size.
</p>


<h3>References</h3>

<p>Vats, D., Flegal, J. M., and, Jones, G. L Multivariate output analysis for Markov chain Monte Carlo, 
<em>Biometrika</em>, <b>106</b>, 321â€“-337.
</p>


<h3>See Also</h3>

<p><code>minESS</code>, which calculates the minimum effective samples required for the
problem.
<code>ess</code> which calculates univariate effective sample size using a Markov chain and a
function g.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Bivariate Normal with mean (mu1, mu2) and covariance sigma
n &lt;- 1e3
mu &lt;- c(2, 50)
sigma &lt;- matrix(c(1, 0.5, 0.5, 1), nrow = 2)
out &lt;- BVN_Gibbs(n, mu, sigma)

multiESS(out)

</code></pre>


</div>