<div class="container">

<table style="width: 100%;"><tr>
<td>make_mcmatrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Generate a multi-companion matrix from spectral description</h2>

<h3>Description</h3>

<p>Generate a multi-companion matrix or its Jordan decomposition from
spectral parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">make_mcmatrix(type = "real", what.res = "matrix", ..., eigval0)

make_mcchains(eigval, co, dim, len.block, eigval0 = FALSE,
              mo.col = NULL, what.co = "bottom", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>eigval</code></td>
<td>
<p> the eigenvalues, a numeric vector </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>co</code></td>
<td>
<p> the seeding parameters for the eigenvectors, a matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dim</code></td>
<td>
<p> the dimension of the matrix, a positive integer </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>len.block</code></td>
<td>
<p> lengths of Jordan chains,
<code>len.block[i]</code> is for <code>eigval[i]</code> </p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p> mode of the matrix, real or complex </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>what.res</code></td>
<td>
<p> format of the result, see details </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eigval0</code></td>
<td>
<p> If TRUE completes the matrix to a square matrix, see
details. <code>eigval0</code> is ignored by <code>make_mcmatrix</code> (it
always sets it to <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>for <code>make_mcmatrix</code>, these are additional arguments to be passed
to  <code>make_mcchains</code>. For <code>make_mcchains</code>, arguments in
<code>"..."</code> are passed on to  <code>mc_0chains</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mo.col</code></td>
<td>

<p>the last non-zero column in the top of the mc-matrix. The default is
<code>dim</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>what.co</code></td>
<td>

<p>a character string equal to <code>"bottom"</code> (default) or
<code>"top"</code>, specifying whether the 'co' parameters give the last
or the first few elements of the (generalised) eigenvectors.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>make_mcmatrix</code> creates a multi-companion matrix specified by
spectral parameters. <code>make_mcchains</code> creates a matrix of
eigenvectors and generalised eigenvectors from the given spectral
parameters.
</p>
<p><code>make_mcmatrix</code> passes the spectral parameters to
<code>make_mcchains</code> to generate the (generalised) eigenvectors. It
then calls <code>Jordan_matrix</code> to create the corresponding Jordan
matrix.  The results are combined to produce the multicompanion
matrix.  By default, the real part is returned, which is appropriate
if all complex spectral parameters come in complex conjugate
pairs. This may be changed by argument <code>type</code>. A list containing
the matrix and the Jordan factors is returned if <code>what.res =
  "list"</code>.
</p>
<p>The closely related function <code>sim_mc</code> is like
<code>make_mcmatrix</code> but it does not need complete specification of
the matrix - it completes
any missing information (eigenvalues, co) with randomly generated
entries. The result of both functions is a list or ordinary matrix,
use <code>mCompanion</code> to obtain a <code>MultiCompanion</code> object
directly.
</p>
<p><code>make_mcchains</code> constructs the eigensystem, <code>make_mcmatrix</code>
calls <code>make_mcchains</code> (passing the <code>...</code> arguments to it)
and forms the matrix. <code>make_mcchains</code> passes the <code>...</code>
arguments to <code>mc_0chains</code>.



</p>
<p><code>make_mcchains</code> creates the full eigenvectors from the <code>co</code>
parameters. If the number of vectors is smaller then <code>dim</code> and
<code>eigval0</code> is TRUE  it then completes the system with chains for
the zero eigenvalue. More specifically, it assumes that the number of
the given chains is <code>mo.col</code>,  takes chains corresponding
to the zero eigenvalue, if any, and adds additional eigenvectors
and/or generalised eigenvectors to construct the complete system.
</p>
<p>The mc-order is determined from the dimension of the 'co'
parameters. If that is equal to <code>dim</code>, the mc-matrix is actually a
general matrix.
</p>
<p><strong>TODO:</strong> cover the case <code>mo &lt; mo.col</code>?
</p>


<h3>Value</h3>

<p><code>make_mcmatrix</code> normally returns the multi-companion matrix (as an
ordinary matrix) having the given spectral properties but if
<code>what.res = "list"</code>, it returns a list containing the matrix and
the spectral information:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>eigval</code></td>
<td>
<p>eigenvalues, a vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>len.block</code></td>
<td>
<p>lengths of Jordan chains, a vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mo</code></td>
<td>
<p>multi-companion order, positive integer</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eigvec</code></td>
<td>
<p>generalied eigenvectors, a matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>co</code></td>
<td>
<p>seeding parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mo.col</code></td>
<td>
<p>top order</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mat</code></td>
<td>
<p>the multi-companion matrix, a matrix</p>
</td>
</tr>
</table>
<p><code>make_mcchains</code> returns a similar list without the component
<code>mat</code>.
</p>


<h3>Note</h3>

<p>The result is an ordinary matrix. Also, some entries that should
be 0 may be non-zero due to numerical error.
</p>
<p>To get a MultiCompanion object use <code>mCompanion</code>.
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>References</h3>


<p>Boshnakov GN (2002).
“Multi-companion matrices.”
<em>Linear Algebra Appl.</em>, <b>354</b>, 53–83.
ISSN 0024-3795, <a href="https://doi.org/10.1016/S0024-3795%2801%2900475-X">doi:10.1016/S0024-3795(01)00475-X</a>.
</p>
<p>Boshnakov GN, Iqelan BM (2009).
“Generation of time series models with given spectral properties.”
<em>J. Time Series Anal.</em>, <b>30</b>(3), 349–368.
ISSN 0143-9782, <a href="https://doi.org/10.1111/j.1467-9892.2009.00617.x">doi:10.1111/j.1467-9892.2009.00617.x</a>.
</p>


<h3>See Also</h3>

<p><code>make_mcev</code>,
<code>make_mcgev</code>,
<code>sim_mc</code>,
<code>mCompanion</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">make_mcmatrix(eigval = c(1, 0.5), co = cbind(c(1,1), c(1, -1)), dim = 4,
              mo.col = 2,
              len.block = c(1, 1))

## one unit root, one root = 0.5
make_mcmatrix(eigval = c(1, 0.5), co = cbind(c(1,1), c(1, -1)), dim = 6,
              mo.col = 2,
              len.block = c(1, 1))

## two simple unit roots, one root = 0.5
make_mcmatrix(eigval = c(1, 1, 0.5), co = cbind(c(1,1), c(1, -1), c(1, 1)), dim = 6,
              mo.col = 3,
              len.block = c(1, 1, 1))

## two unit roots with a single Jordan chain, one root = 0.5
make_mcmatrix(eigval = c(1, 0.5), co = cbind(c(1,1), c(0, 1), c(1, 1)), dim = 6,
              len.block = c(2, 1))


## make_mcchains
make_mcchains(c(1, 0.5), co = cbind(c(1,1), c(1, 1)), dim = 4,
              len.block = c(1, 1), eigval0 = TRUE)

## one unit root, one root = 0.5
make_mcchains(c(1, 0.5), co = cbind(c(1,1), c(1, 1)), dim = 6,
              len.block = c(1, 1), eigval0 = TRUE)

## two simple unit roots, one root = 0.5
make_mcchains(c(1, 1, 0.5), co = cbind(c(1,1), c(1, -1), c(1, 1)), dim = 6,
              len.block = c(1, 1, 1), eigval0 = TRUE)

## two unit roots with a single Jordan chain, one root = 0.5
make_mcchains(c(1, 0.5), co = cbind(c(1,1), c(1, -1), c(1, 1)), dim = 6,
              len.block = c(2, 1), eigval0 = TRUE)



## examples with mc-order = dim
make_mcchains(c(1), co = cbind(c(1,1,1,1), c(1,2,1,1)), dim = 4,
              len.block = c(2), eigval0 = TRUE)
## do not complete with chians for the 0 eigval:
make_mcchains(c(1), co = cbind(c(1,1,1,1), c(1,2,1,1)), dim = 4,
              len.block = c(2), eigval0 = FALSE)

make_mcmatrix(eigval = c(1), co = cbind(c(1,1,1,1), c(1,2,1,1)), dim = 4,
              len.block = c(2))
make_mcmatrix(eigval = c(1), co = cbind(c(1,1,1,1), c(1,2,3,4)), dim = 4,
              len.block = c(2))
</code></pre>


</div>