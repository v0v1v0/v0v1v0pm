<div class="container">

<table style="width: 100%;"><tr>
<td>mc_factorize</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Factorise multi-companion matrices </h2>

<h3>Description</h3>

<p>Companion factorization of multi-companion matrices.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mc_factorize(x, mo, mo.col)
mc_leftc(x, mo, mo.col)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> a multi-companion matrix or its top. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mo</code></td>
<td>
<p> multi-companion order, number of structural top rows. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mo.col</code></td>
<td>
<p> number of non-trivial columns in the top of the matrix. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The companion factorization of a multi-companion matrix, <code class="reqn">X</code>, of
(multi-companion) order <code class="reqn">p</code> is
<code class="reqn">X=A_1\times\cdots\times A_p</code>,
where <code class="reqn">A_i</code>, <code class="reqn">i=1,\dots,p</code>, are companion
matrices.
</p>
<p><code>mc_leftc</code> factorises a multi-companion matrix into a product
of companion times multi-companion.
</p>
<p><code>mc_factorize</code> calls <code>mc_leftc</code> a number of times to compute
the full factorisation.
</p>
<p>If <code>x</code> is not a matrix an attempt is made to convert it to
matrix. If <code>x</code> is a vector it is converted to a matrix with 1 row.
</p>
<p><code>x</code> may be the whole matrix or its top.
If <code>mo</code> is missing <code>x</code> is assumed to be the top of the
matrix and the multi-companion order is set to its number of rows.
</p>
<p><code>mo.col</code> defaults to the number of columns of <code>x</code>.
It is important to specify <code>mo.col</code> if there are columns of
zeroes in the top of the matrix. Otherwise the factorisation usually
fails with a message (from <code>solve</code>) that the system is exactly
singular. Note however that for objects of class MultiCompanion this
situation is handled automatically (unless the user overwrites the
default behaviour).
</p>


<h3>Value</h3>

<p>for <code>mc_factorize</code>, a matrix whose i-th row is the first row of
the i-th companion factor.
</p>
<p>for <code>mc_leftc</code>, a numeric vector containing the first row of the
companion factor. 
</p>


<h3>Level</h3>

<p>0</p>


<h3>Note</h3>

<p>The companion factorisation does not always exist but currently this
possibility is not handled. Even if it exists, it may be numerically
unstable.
</p>
<p>Also, if <code>mo.col</code> is smaller than the number of columns, then the
factorisation is not unique, the one having <code>mo.col</code> non-zero
entries is computed.   The existence is not treated.
</p>
<p><code>mc_leftc</code> is probably the first function I wrote for
multi-companion matrices. It does not do checks consistently. The
MultiCompanion class can be used here.
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>References</h3>


<p>Boshnakov GN (2002).
“Multi-companion matrices.”
<em>Linear Algebra Appl.</em>, <b>354</b>, 53–83.
ISSN 0024-3795, <a href="https://doi.org/10.1016/S0024-3795%2801%2900475-X">doi:10.1016/S0024-3795(01)00475-X</a>.
</p>


<h3>See Also</h3>

 <p><code>mc_from_factors</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">mat2 &lt;- make_mcmatrix(eigval = c(1), co = cbind(c(1,1,1,1), c(0,1,0,0)), dim = 4, len.block = c(2))
mat2
eigen(mat2)
mc_leftc(mat2, mo = 4, mo.col = 2)
mCompanion(mat2)
mCompanion(mat2, mo=4, mo.col=2)
mc_leftc(mCompanion(mat2), mo = 4, mo.col = 2)
mc_eigen(mCompanion(mat2), mo = 4, mo.col = 2)
mc_eigen(mCompanion(mat2, mo=4, mo.col=2), mo = 4, mo.col = 2)
</code></pre>


</div>