<div class="container">

<table style="width: 100%;"><tr>
<td>null_complement</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute the orthogonal complement of a subspace</h2>

<h3>Description</h3>

<p>Computes the orthogonal complement of a subspace relative
to a universe.</p>


<h3>Usage</h3>

<pre><code class="language-R">null_complement(m, universe = NULL, na.allow = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>

<p>NA or a matrix whose columns define the subspace, a vector is
treated as a matrix with one column.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>universe</code></td>
<td>

<p>a matrix whose columns specify the subspace relative to
which to compute the complement, the default is the full space.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.allow</code></td>
<td>

<p>if <code>TRUE</code>, default, treat NA's specially, see Details.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>null_complement</code> computes the orthogonal complement of a
subspace (spanned by the columns of <code>m</code>) relative to a universe.
</p>
<p>Argument <code>universe</code> can be used to specify a subspace w.r.t.
which to compute the complement.  If <code>universe</code> is <code>NULL</code>
(the default), the complement w.r.t. the full space is computed. The
full space is the <code class="reqn">n</code>-dimensional space, where <code class="reqn">n</code> is the
number of rows of argument <code>m</code>.
</p>
<p><code>null_complement</code> returns a matrix whose columns give a basis of
the required subspace.
</p>
<p><code>null_complement</code> uses <code>Null()</code> from package MASS for the
actual computation. <code>null_complement(m, na.allow = FALSE)</code> is
equivalent to <code>Null(m)</code>.
</p>
<p><code>m</code> is typically a matrix whose columns represent the subspace
w.r.t. which to compute the complement.
<code>null_complement</code> can also deal with NA's in <code>m</code>. This
facility can be turned off by specifying <code>na.allow = FALSE</code>.
</p>
<p>If <code>na.allow = TRUE</code>, the default, and <code>m</code> is identical to
<code>NA</code>, <code>universe</code> is returned (i.e. <code>m = NA</code> represents
the empty subspace). Note that in this case <code>universe</code> cannot be
NULL, since there is no way to determine the dimension of the full
space.
</p>
<p>Otherwise, <code>m</code> is a matrix. If all elements of <code>m</code> are
<code>NA</code>, a matrix of NA's is returned with number of columns equal
to <code>ncol(universe) - ncol(m)</code>.
</p>


<h3>Value</h3>

<p>a matrix representing a basis of the requested subspace
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>Examples</h3>

<pre><code class="language-R">m1 &lt;- diag(1, nrow = 3, ncol = 2)
null_complement(m1)

null_complement(c(1,1,0))
null_complement(c(1,1,0), m1)

## the columns of the result from null_complement() are orthogonal
## to  the 1st argument:
t(c(1,1,0)) %*% null_complement(c(1,1,0))
t(c(1,1,0)) %*% null_complement(c(1,1,0), m1)

null_complement(rep(NA_real_, 3), m1)
null_complement(NA, m1)
</code></pre>


</div>