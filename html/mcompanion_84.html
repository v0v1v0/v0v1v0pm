<div class="container">

<table style="width: 100%;"><tr>
<td>sim_mc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Simulate a multi-companion matrix </h2>

<h3>Description</h3>

<p>Simulate a multi-companion matrix with partially or  fully specified spectral
properties.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim_mc(dim, mo, mo.col = dim, eigval, len.block, type.eigval = NULL,
       co, eigabs, eigsign, type = "real",
       value = "real", value.type = "", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dim</code></td>
<td>
<p> dimension of the matrix. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mo</code></td>
<td>
<p> multi-companion order. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mo.col</code></td>
<td>
<p> number of structural columns. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eigval</code></td>
<td>
<p> eigenvalues, one for each Jordan block. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>len.block</code></td>
<td>

<p>lengths of the Jordan blocks corresponding to <code>eigval</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type.eigval</code></td>
<td>
<p> types of the eigenvalues, a character vector </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>co</code></td>
<td>
 <p><code>co</code> parameters, see Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eigabs</code></td>
<td>
<p> moduli (absolute values) of eigenvalues, see Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eigsign</code></td>
<td>
<p>signs or complex arguments of eigenvalues, see Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p> passed down to generators (???) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p> what to return </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value.type</code></td>
<td>
<p>  type of the value (???)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>further arguments to passed on to <code>sim_chains</code> and
<code>sim_numbers</code>, see Details.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>sim_mc</code> generates a multi-companion matrix of dimension
<code>dim x dim</code> and multi-companion order <code>mo</code>. The matrix has
the spectral properties specified by the arguments. Values that cannot
be inferred from the arguments are simulated.
</p>
<p>Arguments <code>dim</code>, <code>mo</code>, and <code>mo.col</code> define the
structure of the matrix. The first two are compulsory but the last
one, <code>mo.col</code>, is optional. If no other arguments are supplied
<code>sim_mc</code> produces a matrix with all spectral parameters
simulated.
</p>
<p>The number of non-zero eigenvalues is at most <code>mo.col</code>.
If <code>mo.col &lt; dim</code> the multi-companion matrix has structural
eigenvectors/chains corresponding to the zero eigenvalue(s), see
the references. These chains are generated automatically.
</p>
<p>Arguments <code>type.eigval</code>, <code>eigabs</code>, <code>eigsign</code> and
<code>eigval</code> are vectors used to specify the types and the values of
the eigenvalues. Any or all of them may be missing or NULL. Those
present must have the same length.
</p>
<p>It is not necessary to specify eigenvalues and eigenvectors
corresponding to eigenvalues equal to zero, since the structural
eigenchains needed when <code>mo.col &lt; dim</code> are created automatically.
In practice, the number of the non-zero eigenvalues is usually equal
to <code>mo.col</code>.  The net effect is that the arguments specifying the
spectral structure of the matrix normally need to specify the spectral
information about the non-zero <code>eigval</code> only.
</p>
<p>Some or all of the eigenvalues may be specified partially or fully
using arguments <code>eigabs</code>, <code>eigsign</code>, and
<code>eigval</code>. Non-NA entries in <code>eigval</code> specify complete
eigenvalues. Non-NA entries in <code>eigabs</code> specify absolute values
of eigenvalues. Non-NA entries in <code>eigsign</code> specify signs of real
eigenvalues or complex arguments of complex eigenvalues. Generally, if
the entry for an eigenvalue in <code>eigval</code> is a number (not
<code>NA</code>), then the corresponding entries in <code>eigabs</code> and
<code>eigsign</code> will be <code>NA</code>. This is not enforced and a limited
check for consistency is made in case of redundant information.
</p>
<p><code>type.eigval</code> is a character vector describing the types of the
eigenvalues, where "r", "c", and "cp" stand for real, complex, and
complex pair, respectively. It is best to have one entry only for each
complex pair (specified by "cp"), rather than two "c" entries.
</p>
<p>If <code>type.eigval</code> is NULL (default) and <code>eigval</code> is supplied,
then <code>type.eigval</code> is inferred from the imaginary part of
<code>eigval</code> ("r" or "cp"), if it is complex.
</p>
<p>For compatibility with older versions of this function <code>eigval</code>
may be a character vector in which case it is simply assigned to
<code>type.eigval</code>.
</p>
<p>If both, <code>type.eigval</code> and <code>eigval</code>, are missing a default
allocation of the types of the eigenvalues is chosen.
</p>
<p><strong>TODO: complete the description below.</strong>
</p>
<p>The remaining spectral parameters may be specified with the argument
<code>co</code> with missing entries for the "free" entries. (!!! This is not
complete, it may be better to have separate arguments for the absolute
value and the angle, as for eigenvalues, and an option for
normalisation of these coefficients. ???)
</p>
<p>Generators other than the default ones may be specified in the
<code>...</code>  argument. These are passed to <code>sim_numbers</code> and
<code>sim_chains</code>.  Again, for the "co" arguments the support
is not finished.
</p>


<h3>Value</h3>

<p>if <code>value.type</code> is the character string <code>"matrix"</code>, the
required multi-companion matrix. Otherwise, if
<code>value.type=="list"</code>, a list containing also the spectral
information (this list is the same as the one from
<code>make_mcmatrix</code>)).
</p>


<h3>Note</h3>

<p>A canonical form is needed, especially when there are repeated
eigenvalues whose eigenvectors may be chosen to be orthogonal, at
least. (nyakade v zapiskite mi tryabva da ima kanonichna forma!)
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>References</h3>


<p>Boshnakov GN (2002).
“Multi-companion matrices.”
<em>Linear Algebra Appl.</em>, <b>354</b>, 53–83.
ISSN 0024-3795, <a href="https://doi.org/10.1016/S0024-3795%2801%2900475-X">doi:10.1016/S0024-3795(01)00475-X</a>.
</p>
<p>Boshnakov GN, Iqelan BM (2009).
“Generation of time series models with given spectral properties.”
<em>J. Time Series Anal.</em>, <b>30</b>(3), 349–368.
ISSN 0143-9782, <a href="https://doi.org/10.1111/j.1467-9892.2009.00617.x">doi:10.1111/j.1467-9892.2009.00617.x</a>.
</p>


<h3>See Also</h3>

<p><code>gbutils::sim_numbers</code> and
<code>sim_chains</code> for arguments that control the
distributions of the random numbers.
</p>
<p><code>make_mcmatrix</code> creates the matrix.
</p>


<h3>Examples</h3>

<pre><code class="language-R">m0 &lt;- sim_mc(3,2)   # simulate 3x3 2-companion matrix
abs(m0$eigval)      # eigval random, so their abs values

# now fix moduli of eigenvalues, and
# ask for one real ev and one complex pair of ev's
m1 &lt;- sim_mc(3,2,eigabs=c(0.25,0.5), type.eigval=c("r","cp"))
m1$eigval
abs(m1$eigval)

# same as above, since type.eigval happens to be the default
# dim is odd, by default first ev is real, rest are complex pairs
m1a &lt;- sim_mc(3,2,eigabs=c(0.25,0.5))
m1a$eigval
abs(m1a$eigval)

# simulate 6x6 4-companion matrix
# with ev's at the seasonal frequencies (1.57 3.141593 -1.57)
# and random moduli. 3 complex pairs of ev's
m2 &lt;- sim_mc(6,4, eigsign = pi*c(1/2,1,-1/2) )
Arg(m2$eigval)
</code></pre>


</div>