<div class="container">

<table style="width: 100%;"><tr>
<td>VAR2pcfilter</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>PAR representations of VAR models</h2>

<h3>Description</h3>

<p>Give the univariate periodic autoregression representation of a VAR
model. Several arrangements are supported as discussed by
Boshnakov and Iqelan (2009). If the VAR model
contains unit roots on the unit circle, then the univariate model is
periodically integrated.
</p>


<h3>Usage</h3>

<pre><code class="language-R">VAR2pcfilter(phi, ..., Sigma, Phi0, Phi0inv, D, what = "coef", perm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>VAR coefficients, a matrix, see Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>alternative way to specify the VAR coefficients by giving a matrix
for each lag in separate arguments, see section ‘Details’.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>covariance matrix of innovations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Phi0</code></td>
<td>
<p>coefficient matrix at lag 0 (alternative to <code>Sigma</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Phi0inv</code></td>
<td>
<p>inverse of <code>Phi0</code> (alternative to <code>Sigma</code> and
<code>Phi0</code>). If <code>Phi0inv</code> is lower triangular, then it is the
Cholesky factor of Sigma (in Sigma<code class="reqn">{} = LDL'</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>the diagonal matrix corresponding to <code>Phi0</code>, not used if
<code>Sigma</code> is specified.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>what</code></td>
<td>
<p>what to return, a string. If equal to <code>"coef"</code>,
return the PAR coefficients only (as a matrix with one row for each
“season”); if equal to <code>"coef.and.var"</code> return also the
innovation variances. Otherwise return additional quantities (useful
for exploration).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perm</code></td>
<td>

<p>a permutation specifying the ordering of the variables when treated
as “seasons”. The default, <code>d:1</code>, corresponds to the U-form,
see section ‘Details’.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>VAR2pcfilter</code> converts a VAR model to a scalar periodic
autoregressive (PAR) model. There are various ways to specify a VAR
model and associate its variables with seasons of the scalar
representation, see Boshnakov and Iqelan (2009)
for a detailed discussion and the terminology used here.
</p>

<p>The VAR coefficients <code>phi,...</code> are those in the standard form of
the VAR model (e.g., see Boshnakov and Iqelan 2009).
There are two ways to specify them. The first is to put them side by
side in a matrix <code class="reqn">[\Phi_1, \ldots, \Phi_p]</code> and give this matrix
as argument <code>phi</code>. Alternatively, the matrices <code class="reqn">\Phi_i</code> may
be given directly as arguments to <code>VAR2pcfilter</code>, as in
<code>VAR2pcfilter(Phi1, Phi2, Phi3, Sigma = Sigma)</code>.
</p>
<p>The specification of the model can be completed by giving the
covariance matrix, <code>Sigma</code>, of the innovations.  Alternatively,
it is possible to give the components of the <code class="reqn">UDU'</code> decomposition
of <code>Sigma</code>. In this case argument <code>D</code> is a vector giving the
diagonal of the matrix <code class="reqn">D</code>, while <code>Phi0inv</code> represents the
upper triangular matrix <code class="reqn">U</code>. A further option is to use argument
<code>Phi0</code> to specify the inverse of <code class="reqn">U</code>. In summary, give either
<code>Sigma</code> or <code>D</code> and one of <code>Phi0inv</code> and <code>Phi0</code>.
</p>
<p><code>Phi0</code> can e interpreted as the coefficient at lag zero in the
U-form (Boshnakov and Iqelan 2009) of the VAR model.
<code>diag(D)</code> is the variance matrix of the innovations in that
form. <code>D</code> also gives the variances of the innovations in the PAR
(periodic autoregression) form.
</p>
<p>By default, <code>VAR2pcfilter</code> constructs the U-form of the VAR model
and extracts the coefficients of the PAR filter from it. This means
that the variables in the multivariate vector are given “seasons” in
reverse order (the first variable takes the last season, and so on).
For the reasons behind this default, see
Boshnakov and Iqelan (2009).  Another
arrangement can be chosen with the help of argument
<code>perm</code>. <code>perm</code> should be a permutation specifying the
desired allocation of variables to seasons. The default corresponds to
<code>perm=d:1</code>, where <code>d</code> is the number of
seasons. <code>perm=1:d</code> could be used to request the “natural”
order.
</p>
<p>When <code>D</code> and <code>Phi0inv</code> (or <code>Phi0</code>) are given, the
matrix <code>Sigma</code> is not computed if argument <code>perm</code> is missing
but it is if <code>perm</code> is present. This means that <code>perm = d:1</code>
may be used to force the formation of <code>Sigma</code> and recomputation
of <code>Phi0</code> and <code>Phi0inv</code>. This is redundant if the latter two
are unit upper-triangular (which is assumed but not checked) but may
be handy if, for example, the Cholesky decomposition with a lower
triangular matrix is available.
</p>


<h3>Value</h3>

<p>If <code>what="coef"</code>, a matrix containing the periodic model
coefficients (one row for each season).
</p>
<p>If <code>what="coef.and.var"</code>, a list containing the coefficients and
the innovations' variances:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>pcfilter</code></td>
<td>
<p>PAR coefficients, a matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>innovation variances, a vector</p>
</td>
</tr>
</table>
<p>Otherwise the returned list contains an additional component,
<code>Uform</code>, which is itself a list with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>covariance matrix of innovations,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U0</code></td>
<td>
<p>coefficient for lag zero,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U</code></td>
<td>
<p>the remaining AR coefficients,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U0inv</code></td>
<td>
<p>the inverse of <code>U0</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perm</code></td>
<td>
<p>permutation giving the season of each variable.</p>
</td>
</tr>
</table>
<p>Note: <code>U0</code> and <code>U</code> correspond to <code class="reqn">A0</code> and <code class="reqn">A</code> in the
reference (Boshnakov and Iqelan 2009).
</p>


<h3>Note</h3>

<p>This function uses some non-exported internal functions:
</p>

<dl>
<dt>.ldl</dt>
<dd>
<p>Computes the LDL' Cholesky decomposition with unit
lower-triangular matrix L,
</p>
</dd>
<dt>.udu</dt>
<dd>
<p>Computes the UDU' Cholesky decomposition with unit
upper-triangular matrix U.
</p>
</dd>
</dl>
<p>Could export these if they are deemed more widely useful.
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>References</h3>

<p>Boshnakov GN, Iqelan BM (2009).
“Generation of time series models with given spectral properties.”
<em>J. Time Series Anal.</em>, <b>30</b>(3), 349–368.
ISSN 0143-9782, <a href="https://doi.org/10.1111/j.1467-9892.2009.00617.x">doi:10.1111/j.1467-9892.2009.00617.x</a>.
</p>


<h3>See Also</h3>

<p><code>mf_VSform</code>,
<code>sim_pcfilter</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## create a pc filter
rfi &lt;- sim_pcfilter(2,3)
rfi$pcfilter

## turn it into VAR form
flt &lt;- new("MultiFilter", coef = rfi$pcfilter)
I1 &lt;- mf_VSform(flt, form="I")
I1

## from VAR to scalar form
flt2 &lt;- VAR2pcfilter(I1$Phi, Sigma = I1$Phi0inv %*% t(I1$Phi0inv))
flt2

## confirm that we are back to the original
##   (VAR2pcfilter doesn't drop redundant zeroes, so we do it manually)
    all.equal(flt2[ , 1:3], rfi$pcfilter) ## TRUE
</code></pre>


</div>