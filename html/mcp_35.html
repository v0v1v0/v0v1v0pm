<div class="container">

<table style="width: 100%;"><tr>
<td>hypothesis</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test hypotheses on mcp objects.</h2>

<h3>Description</h3>

<p>Returns posterior probabilities and Bayes Factors for flexible hypotheses involving
model parameters. The documentation for the argument <code>hypotheses</code> below
shows examples of how to specify hypotheses, and <a href="https://lindeloev.github.io/mcp/articles/comparison.html">read worked examples on the mcp website</a>.
For directional hypotheses, <code style="white-space: pre;">⁠hypothesis`` executes the hypothesis string in a ⁠</code>tidybayes“ environment and summerises the proportion of samples where
the expression evaluates to TRUE. For equals-hypothesis, a Savage-Dickey
ratio is computed. Savage-Dickey requires a prior too, so remember
<code>mcp(..., sample = "both")</code>. This function is heavily inspired by the
'hypothesis' function from the 'brms' package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hypothesis(fit, hypotheses, width = 0.95, digits = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>An <code>mcpfit</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hypotheses</code></td>
<td>
<p>String representation of a logical test involving model parameters.
Takes R code that evaluates to TRUE or FALSE in a vectorized way.
</p>
<p>Directional hypotheses are specified using &lt;, &gt;, &lt;=, or &gt;=. <code>hypothesis</code>
returns the posterior probability and odds in favor of the stated hypothesis.
The odds can be interpreted as a Bayes Factor. For example:
</p>

<ul>
<li> <p><code>"cp_1 &gt; 30"</code>:  the first change point is above 30.
</p>
</li>
<li> <p><code>"int_1 &gt; int_2"</code>: the intercept is greater in segment 1 than 2.
</p>
</li>
<li> <p><code>"x_2 - x_1 &lt;= 3"</code>: the difference between slope 1 and 2 is less
than or equal to 3.
</p>
</li>
<li> <p><code>"int_1 &gt; -2 &amp; int_1 &lt; 2"</code>: int_1 is between -2 and 2 (an interval hypothesis). This can be useful as a Region Of Practical Equivalence test (ROPE).
</p>
</li>
<li> <p><code>"cp_1^2 &lt; 30 | (log(x_1) + log(x_2)) &gt; 5"</code>: be creative.
</p>
</li>
<li> <p><code>"`cp_1_id[1]` &gt; `cp_1_id[2]`"</code>: id1 is greater than id2, as estimated
through the varying-by-"id" change point in segment 1. Note that <code>``</code>
required for varying effects.
</p>
</li>
</ul>
<p>Hypotheses can also test equality using the equal sign (=). This runs a
Savage-Dickey test, i.e., the proportion by which the probability density
has increased from the prior to the posterior at a given value. Therefore,
it requires <code>mcp(sample = "both")</code>. There are two requirements:
First, there can only be one equal sign, so don't use and (&amp;) or or (|).
Second, the point to test has to be on the right, and the variables on the left.
</p>

<ul>
<li> <p><code>"cp_1 = 30"</code>: is the first change point at 30? Or to be more precise:
by what factor has the credence in cp_1 = 30 risen/fallen when
conditioning on the data, relative to the prior credence?
</p>
</li>
<li> <p><code>"int_1 + int_2 = 0"</code>: Is the sum of two intercepts zero?
</p>
</li>
<li> <p><code>"`cp_1_id[John]`/`cp_1_id[Erin]` = 2"</code>: is the varying change
point for John (which is relative to 'cp_1“) double that of Erin?
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>Float. The width of the highest posterior density interval
(between 0 and 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>a non-null value for digits specifies the minimum number of
significant digits to be printed in values. The default, NULL, uses
getOption("digits"). (For the interpretation for complex numbers see signif.)
Non-integer values will be rounded down, and only values greater than or
equal to 1 and no greater than 22 are accepted.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data.frame with a row per hypothesis and the following columns:
</p>

<ul>
<li> <p><code>hypothesis</code> is the hypothesis; often re-arranged to test against zero.
</p>
</li>
<li> <p><code>mean</code> is the posterior mean of the left-hand side of the hypothesis.
</p>
</li>
<li> <p><code>lower</code> is the lower bound of the (two-sided) highest-density interval of width <code>width</code>.
</p>
</li>
<li> <p><code>upper</code> is the upper bound of ditto.
</p>
</li>
<li> <p><code>p</code> Posterior probability.
For "=" (Savage-Dickey), it is the BF converted to p.
For directional hypotheses, it is the proportion of samples that returns TRUE.
</p>
</li>
<li> <p><code>BF</code> Bayes Factor in favor  of the hypothesis.
For "=" it is the Savage-Dickey density ratio.
For directional hypotheses, it is p converted to odds.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Jonas Kristoffer Lindeløv <a href="mailto:jonas@lindeloev.dk">jonas@lindeloev.dk</a>
</p>


</div>