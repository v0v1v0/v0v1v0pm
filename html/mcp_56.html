<div class="container">

<table style="width: 100%;"><tr>
<td>pp_eval</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fits and predictions from samples and newdata</h2>

<h3>Description</h3>

<p>Fits and predictions from samples and newdata
</p>


<h3>Usage</h3>

<pre><code class="language-R">pp_eval(
  object,
  newdata = NULL,
  summary = TRUE,
  type = "fitted",
  probs = TRUE,
  rate = TRUE,
  prior = FALSE,
  which_y = "ct",
  varying = TRUE,
  arma = TRUE,
  nsamples = NULL,
  samples_format = "tidy",
  scale = "response",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An <code>mcpfit</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>A <code>tibble</code> or a <code>data.frame</code> containing predictors in the model. If <code>NULL</code> (default),
the original data is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summary</code></td>
<td>
<p>Summarise at each x-value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>One of:
</p>

<ul>
<li>
<p> "fitted": return fitted values. See also <code>fitted()</code>
</p>
</li>
<li>
<p> "predict": return predicted values, using random dispersion around the central tendency
(e.g., <code>y_predict = rnorm(N, y_fitted, sigma_fitted)</code> for <code>family = gaussian()</code>).
See also <code>predict()</code>.
</p>
</li>
<li>
<p> "residuals": same as "predict" but the observed y-values are subtracted. See also <code>residuals()</code>
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>
<p>Vector of quantiles. Only in effect when <code>summary == TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate</code></td>
<td>
<p>Boolean. For binomial models, plot on raw data (<code>rate = FALSE</code>) or
response divided by number of trials (<code>rate = TRUE</code>). If FALSE, linear
interpolation on trial number is used to infer trials at a particular x.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>TRUE/FALSE. Plot using prior samples? Useful for <code>mcp(..., sample = "both")</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which_y</code></td>
<td>
<p>What to plot on the y-axis. One of
</p>

<ul>
<li> <p><code>"ct"</code>: The central tendency which is often the mean after applying the
link function.
</p>
</li>
<li> <p><code>"sigma"</code>: The variance
</p>
</li>
<li> <p><code>"ar1"</code>, <code>"ar2"</code>, etc. depending on which order of the autoregressive
effects you want to plot.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varying</code></td>
<td>
<p>One of:
</p>

<ul>
<li> <p><code>TRUE</code> All varying effects (<code>fit$pars$varying</code>).
</p>
</li>
<li> <p><code>FALSE</code> No varying effects (<code>c()</code>).
</p>
</li>
<li>
<p> Character vector: Only include specified varying parameters - see <code>fit$pars$varying</code>.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arma</code></td>
<td>
<p>Whether to include autoregressive effects.
</p>

<ul>
<li> <p><code>TRUE</code> Compute autoregressive residuals. Requires the response variable in <code>newdata</code>.
</p>
</li>
<li> <p><code>FALSE</code> Disregard the autoregressive effects. For <code>family = gaussian()</code>, <code>predict()</code> just use <code>sigma</code> for residuals.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsamples</code></td>
<td>
<p>Integer or <code>NULL</code>. Number of samples to return/summarise.
If there are varying effects, this is the number of samples from each varying group.
<code>NULL</code> means "all". Ignored if both are <code>FALSE</code>. More samples trade speed for accuracy.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samples_format</code></td>
<td>
<p>One of "tidy" or "matrix". Controls the output format when <code>summary == FALSE</code>.
See more under "value"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>One of
</p>

<ul>
<li>
<p> "response": return on the observed scale, i.e., after applying the inverse link function.
</p>
</li>
<li>
<p> "linear": return on the parameter scale (where the linear trends are modelled).
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Currently unused</p>
</td>
</tr>
</table>
<h3>Value</h3>


<ul>
<li>
<p> If <code>summary = TRUE</code>: A <code>tibble</code> with the posterior mean for each row in <code>newdata</code>,
If <code>newdata</code> is <code>NULL</code>, the data in <code>fit$data</code> is used.
</p>
</li>
<li>
<p> If <code>summary = FALSE</code> and <code>samples_format = "tidy"</code>: A <code>tidybayes</code> <code>tibble</code> with all the posterior
samples (<code>Ns</code>) evaluated at each row in <code>newdata</code> (<code>Nn</code>), i.e., with <code style="white-space: pre;">⁠Ns x Nn⁠</code> rows. If there are
varying effects, the returned data is expanded with the relevant levels for each row.
</p>
<p>The return columns are:
</p>

<ul>
<li>
<p> Predictors from <code>newdata</code>.
</p>
</li>
<li>
<p> Sample descriptors: ".chain", ".iter", ".draw" (see the <code>tidybayes</code> package for more), and "data_row" (<code>newdata</code> rownumber)
</p>
</li>
<li>
<p> Sample values: one column for each parameter in the model.
</p>
</li>
<li>
<p> The estimate. Either "predict" or "fitted", i.e., the name of the <code>type</code> argument.
</p>
</li>
</ul>
</li>
<li>
<p> If <code>summary = FALSE</code> and <code>samples_format = "matrix"</code>: An <code>N_draws</code> X <code>nrows(newdata)</code> matrix with fitted/predicted
values (depending on <code>type</code>). This format is used by <code>brms</code> and it's useful as <code>yrep</code> in
<code style="white-space: pre;">⁠bayesplot::ppc_*⁠</code> functions.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Jonas Kristoffer Lindeløv <a href="mailto:jonas@lindeloev.dk">jonas@lindeloev.dk</a>
</p>


<h3>See Also</h3>

<p><code>fitted.mcpfit</code> <code>predict.mcpfit</code> <code>residuals.mcpfit</code>
</p>


</div>