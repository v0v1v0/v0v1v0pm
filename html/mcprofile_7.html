<div class="container">

<table style="width: 100%;"><tr>
<td>mcprofile</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Construction of Multiple Contrast Profiles</h2>

<h3>Description</h3>

<p>Calculates signed root deviance profiles given a <code>glm</code> or <code>lm</code> object. The profiled parameters of interest are defined by providing a contrast matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mcprofile(object, CM, control = mcprofileControl(), grid = NULL)

## S3 method for class 'glm'
mcprofile(object, CM, control = mcprofileControl(),
  grid = NULL)

## S3 method for class 'lm'
mcprofile(object, CM, control = mcprofileControl(),
  grid = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class <code>glm</code> or <code>lm</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CM</code></td>
<td>
<p>A contrast matrix for the definition of parameter linear combinations (<code>CM %*% coefficients(object)</code>). The number of columns should be equal to the number of estimated parameters. Providing row names is recommendable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>A list with control arguments. See <code>mcprofileControl</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>A matrix or list with profile support coordinates. Each column of the matrix or slot in a list corresponds to a row in the contrast matrix, each row of the grid matrix or element of a numeric vector in each list slot corresponds to a candidate of the contrast parameter. If NULL (default), a grid is found automatically similar to function <code>profile.glm</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The profiles are calculates separately for each row of the contrast matrix. The profiles are calculated by constrained IRWLS optimization, implemented in function <code>orglm</code>, using the quadratic programming algorithm of package <code>quadprog</code>.
</p>


<h3>Value</h3>

<p>An object of class mcprofile. The slot <code>srdp</code> contains the profiled signed root deviance statistics. The <code>optpar</code> slot contains a matrix with profiled parameter estimates.
</p>


<h3>See Also</h3>

<p><code>profile.glm</code>, <code>glht</code>, <code>contrMat</code>, <code>confint.mcprofile</code>, <code>summary.mcprofile</code>, <code>solve.QP</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#######################################
## cell transformation assay example ##
#######################################

str(cta)
## change class of cta$conc into factor
cta$concf &lt;- factor(cta$conc, levels=unique(cta$conc))

ggplot(cta, aes(y=foci, x=concf)) + 
  geom_boxplot() +
  geom_dotplot(binaxis = "y", stackdir = "center", binwidth = 0.2) +  
  xlab("concentration")
    
    
# glm fit assuming a Poisson distribution for foci counts
# parameter estimation on the log link
# removing the intercept
fm &lt;- glm(foci ~ concf-1, data=cta, family=poisson(link="log"))

### Comparing each dose to the control by Dunnett-type comparisons
# Constructing contrast matrix
library(multcomp)
CM &lt;- contrMat(table(cta$concf), type="Dunnett")

# calculating signed root deviance profiles
(dmcp &lt;- mcprofile(fm, CM))
# plot profiles
plot(dmcp)
# confidence intervals
(ci &lt;- confint(dmcp))
plot(ci)
</code></pre>


</div>