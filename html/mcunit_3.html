<div class="container">

<table style="width: 100%;"><tr>
<td>expect_mcmc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test of MCMC chain</h2>

<h3>Description</h3>

<p>Test of MCMC steps having the correct stationary distribution
without assuming reversibility of the chain. Details of this are in
Gandy and Scott (2020); it uses ideas
described in the appendix of
Gandy and Veraart (2017).
</p>


<h3>Usage</h3>

<pre><code class="language-R">expect_mcmc(object, control = NULL, thinning = NULL, joint = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A list describing the MCMC sampler with the following elements:
</p>

<ul>
<li>
<p> genprior: A function with no arguments that generates a sample of the prior distribution. No default value.
</p>
</li>
<li>
<p> gendata: A function that takes as input the parameter value (of the type generated by genprior) and returns the observed data as an arbitrary R object. No default value.
</p>
</li>
<li>
<p> stepMCMC: A function that takes three arguments:
</p>

<ul>
<li>
<p> theta: the current position of the chain (of the same type as produced by the prior),
</p>
</li>
<li>
<p> dat: the observed data (of the same type as produced by gendat)
</p>
</li>
<li>
<p> thinning: the number of steps the chain should take. 1 corresponds to one step.
</p>
</li>
</ul>
</li>
<li>
<p> test: Function that takes either one or two arguments, and returns a vector with components which will be used for checking the MCMC sampler. The first argument is interpreted as a parameter value, and if a second argument exists, it is interpreted as a data value. An example is the identity function: function(x) x. Alternatively, if you have access to the model's likelihood function, you could use: function(x,y) likelihood(x,y).
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list controlling the algorithm
</p>

<ul>
<li>
<p> n number of samples to be taken in the first step. Default: 1e3
</p>
</li>
<li>
<p> maxseqsteps: Number of sequential attempts to use. Default: 7.
</p>
</li>
<li>
<p> incn: Factor by which to multiply n from the second  sequential attempt onward. Default: 4.
</p>
</li>
<li>
<p> level: bound on the type I error, ie the probability of wrongly rejecting a sampler with the correct distribution. Default: 1e-5.
</p>
</li>
<li>
<p> debug: If positive  then debug information will be printed via 'message()'. Default: 0.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thinning</code></td>
<td>
<p>Amount of thinning for the MCMC chain. 1 corresponds to no thinning. Default: automatically computed to ensure an autocorrelation of at most 0.5 at lag 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>joint</code></td>
<td>
<p>If TRUE, then the MCMC uses systematic scan of both data and parameters, rather than just updating parameters with the sampler to be tested. Default: FALSE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The first argument, invisibly, to allow chaining of expectations.
</p>


<h3>References</h3>

<p>Gandy A, Scott J (2020).
“Unit Testing for MCMC and other Monte Carlo Methods.”
<a href="https://arxiv.org/abs/2001.06465">https://arxiv.org/abs/2001.06465</a>.<br><br> Gandy A, Veraart LAM (2017).
“A Bayesian Methodology for Systemic Risk Assessment in Financial Networks.”
<em>Management Science</em>, <b>63</b>(12), 4428–4446.
doi: <a href="https://doi.org/10.1287/mnsc.2016.2546">10.1287/mnsc.2016.2546</a>, <a href="https://doi.org/10.1287/mnsc.2016.2546">https://doi.org/10.1287/mnsc.2016.2546</a>.
</p>


<h3>See Also</h3>

<p>expect_mcmc_reversible
</p>


<h3>Examples</h3>

<pre><code class="language-R">object &lt;- list(genprior=function() rnorm(1),
               gendata=function(theta) rnorm(5,theta),
               stepMCMC=function(theta,data,thinning){
                  f &lt;- function(x) prod(dnorm(data,x))*dnorm(x)  
                  for (i in 1:thinning){
                     thetanew = rnorm(1,mean=theta,sd=1)
                     if (runif(1)&lt;f(thetanew)/f(theta))
                     theta &lt;- thetanew
                  }
                  theta
               }
               )
expect_mcmc(object)
</code></pre>


</div>