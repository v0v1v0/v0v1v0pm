<div class="container">

<table style="width: 100%;"><tr>
<td>expect_mcmc_reversible</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test of MCMC chain assuming reversibility of the chain</h2>

<h3>Description</h3>

<p>Test of MCMC steps having the correct stationary distribution
assuming reversibility of the chain. Uses ideas from
Besag and Clifford (1989) as extended to
possible ties in Gandy and Scott (2020).
</p>


<h3>Usage</h3>

<pre><code class="language-R">expect_mcmc_reversible(
  object,
  control = NULL,
  thinning = NULL,
  nsteps = 10,
  p = 1,
  tolerance = 1e-08
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A list describing the MCMC sampler with the following elements:
</p>

<ul>
<li>
<p> genprior: A function with no arguments that generates a sample of the prior distribution. No default value.
</p>
</li>
<li>
<p> gendata: A function that takes as input the parameter value (of the type generated by genprior) and returns the observed data as an arbitrary R object. No default value.
</p>
</li>
<li>
<p> stepMCMC: A function that takes three arguments:
</p>

<ul>
<li>
<p> theta: the current position of the chain (of the same type as produced by the prior),
</p>
</li>
<li>
<p> dat: the observed data (of the same type as produced by gendat)
</p>
</li>
<li>
<p> thinning: the number of steps the chain should take. 1 corresponds to one step.
</p>
</li>
</ul>
</li>
<li>
<p> test: Function that takes either one or two arguments, and returns a vector with components which will be used for checking the MCMC sampler. The first argument is interpreted as a parameter value, and if a second argument exists, it is interpreted as a data value. An example is the identity function: function(x) x. Alternatively, if you have access to the model's likelihood function, you could use: function(x,y) likelihood(x,y).
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list controlling the algorithm
</p>

<ul>
<li>
<p> n number of samples to be taken in the first step. Default: 1e3
</p>
</li>
<li>
<p> maxseqsteps: Number of sequential attempts to use. Default: 7.
</p>
</li>
<li>
<p> incn: Factor by which to multiply n from the second  sequential attempt onward. Default: 4.
</p>
</li>
<li>
<p> level: bound on the type I error, ie the probability of wrongly rejecting a sampler with the correct distribution. Default: 1e-5.
</p>
</li>
<li>
<p> debug: If positive  then debug information will be printed via 'message()'. Default: 0.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thinning</code></td>
<td>
<p>Amount of thinning for the MCMC chain. 1 corresponds to no thinning. Default: automatically computed to ensure an autocorrelation of at most 0.5 at lag 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsteps</code></td>
<td>
<p>Number of steps of the chain to use. Default: 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>The probability with which the MCMC updates the parameter as opposed to the data in a given step. If less than 1.0, then the MCMC is a random scan on both data and parameters. Default: 1.0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolerance</code></td>
<td>
<p>Absolute error where value of the samplers are treated as equal. Default: 1e-8.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The first argument, invisibly, to allow chaining of expectations.
</p>


<h3>References</h3>

<p>Besag J, Clifford P (1989).
“Generalized Monte Carlo significance tests.”
<em>Biometrika</em>, <b>76</b>(4), 633–642.
doi: <a href="https://doi.org/10.1093/biomet/76.4.633">10.1093/biomet/76.4.633</a>, <a href="https://doi.org/10.1093/biomet/76.4.633">https://doi.org/10.1093/biomet/76.4.633</a>.<br><br> Gandy A, Scott J (2020).
“Unit Testing for MCMC and other Monte Carlo Methods.”
<a href="https://arxiv.org/abs/2001.06465">https://arxiv.org/abs/2001.06465</a>.
</p>


<h3>See Also</h3>

<p>expect_mcmc
</p>


<h3>Examples</h3>

<pre><code class="language-R">object &lt;- list(genprior=function() rnorm(1),
               gendata=function(theta) rnorm(5,theta),
               stepMCMC=function(theta,data,thinning){
                  f &lt;- function(x) prod(dnorm(data,x))*dnorm(x)  
                  for (i in 1:thinning){
                     thetanew = rnorm(1,mean=theta,sd=1)
                     if (runif(1)&lt;f(thetanew)/f(theta))
                     theta &lt;- thetanew
                  }
                  theta
               },
               test=function(x) x
               )
expect_mcmc_reversible(object)
</code></pre>


</div>