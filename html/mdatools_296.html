<div class="container">

<table style="width: 100%;"><tr>
<td>plsda</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Partial Least Squares Discriminant Analysis</h2>

<h3>Description</h3>

<p><code>plsda</code> is used to calibrate, validate and use of partial least squares discrimination
analysis (PLS-DA) model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plsda(
  x,
  c,
  ncomp = min(nrow(x) - 1, ncol(x), 20),
  center = TRUE,
  scale = FALSE,
  cv = NULL,
  exclcols = NULL,
  exclrows = NULL,
  x.test = NULL,
  c.test = NULL,
  method = "simpls",
  lim.type = "ddmoments",
  alpha = 0.05,
  gamma = 0.01,
  info = "",
  ncomp.selcrit = "min",
  classname = NULL,
  cv.scope = "local"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>matrix with predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p>vector with class membership (should be either a factor with class names/numbers in case of
multiple classes or a vector with logical values in case of one class model).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncomp</code></td>
<td>
<p>maximum number of components to calculate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>logical, center or not predictors and response values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>logical, scale (standardize) or not predictors and response values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv</code></td>
<td>
<p>cross-validation settings (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclcols</code></td>
<td>
<p>columns of x to be excluded from calculations (numbers, names or vector with logical values)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclrows</code></td>
<td>
<p>rows to be excluded from calculations (numbers, names or vector with logical values)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.test</code></td>
<td>
<p>matrix with predictors for test set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c.test</code></td>
<td>
<p>vector with reference class values for test set (same format as calibration values).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>method for calculating PLS model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lim.type</code></td>
<td>
<p>which method to use for calculation of critical limits for residual distances (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>significance level for extreme limits for T2 and Q disances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>significance level for outlier limits for T2 and Q distances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>info</code></td>
<td>
<p>short text with information about the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncomp.selcrit</code></td>
<td>
<p>criterion for selecting optimal number of components (<code>'min'</code> for first local minimum of
RMSECV and <code>'wold'</code> for Wold's rule.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>classname</code></td>
<td>
<p>name (label) of class in case if PLS-DA is used for one-class discrimination model. In this case
it is expected that parameter 'c' will be a vector with logical values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.scope</code></td>
<td>
<p>scope for center/scale operations inside CV loop: 'global' — using globally computed mean and std
or 'local' — recompute new for each local calibration set.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>plsda</code> class is based on <code>pls</code> with extra functions and plots covering
classification functionality. All plots for <code>pls</code> can be used. E.g. of you want to see the
real predicted values (y in PLS) instead of classes use <code>plotPredictions.pls(model)</code> instead
of <code>plotPredictions(model)</code>.
</p>
<p>Cross-validation settings, <code>cv</code>, can be a number or a list. If <code>cv</code> is a number, it
will be used as a number of segments for random cross-validation (if <code>cv = 1</code>, full
cross-validation will be preformed). If it is a list, the following syntax can be used:
<code>cv = list('rand', nseg, nrep)</code> for random repeated cross-validation with <code>nseg</code>
segments and <code>nrep</code> repetitions or <code>cv = list('ven', nseg)</code> for systematic splits
to <code>nseg</code> segments ('venetian blinds').
</p>
<p>Calculation of confidence intervals and p-values for regression coefficients are available
only by jack-knifing so far. See help for <code>regcoeffs</code> objects for details.
</p>


<h3>Value</h3>

<p>Returns an object of <code>plsda</code> class with following fields (most inherited from class
<code>pls</code>):
</p>
<table>
<tr style="vertical-align: top;">
<td><code>ncomp </code></td>
<td>
<p>number of components included to the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncomp.selected </code></td>
<td>
<p>selected (optimal) number of components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xloadings </code></td>
<td>
<p>matrix with loading values for x decomposition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yloadings </code></td>
<td>
<p>matrix with loading values for y (c)  decomposition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights </code></td>
<td>
<p>matrix with PLS weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coeffs </code></td>
<td>
<p>matrix with regression coefficients calculated for each component.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>info </code></td>
<td>
<p>information about the model, provided by user when build the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calres </code></td>
<td>
<p>an object of class <code>plsdares</code> with PLS-DA results for a calibration
data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>testres </code></td>
<td>
<p>an object of class <code>plsdares</code> with PLS-DA results for a test data,
if it was provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cvres </code></td>
<td>
<p>an object of class <code>plsdares</code> with PLS-DA results for cross-validation,
if this option was chosen.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Sergey Kucheryavskiy (svkucheryavski@gmail.com)
</p>


<h3>See Also</h3>

<p>Specific methods for <code>plsda</code> class:
</p>

<table>
<tr>
<td style="text-align: left;">
 <code>print.plsda</code> </td>
<td style="text-align: left;"> prints information about a <code>pls</code> object.</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>summary.plsda</code> </td>
<td style="text-align: left;"> shows performance statistics for the model.</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>plot.plsda</code> </td>
<td style="text-align: left;"> shows plot overview of the model.</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>predict.plsda</code> </td>
<td style="text-align: left;"> applies PLS-DA model to a new data.</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>Methods, inherited from <code>classmodel</code> class:
</p>

<table>
<tr>
<td style="text-align: left;">
 <code>plotPredictions.classmodel</code> </td>
<td style="text-align: left;"> shows plot with predicted values.</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>plotSensitivity.classmodel</code> </td>
<td style="text-align: left;"> shows sensitivity plot.</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>plotSpecificity.classmodel</code> </td>
<td style="text-align: left;"> shows specificity plot.</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>plotMisclassified.classmodel</code> </td>
<td style="text-align: left;"> shows misclassified ratio plot.</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>See also methods for class <code>pls</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">### Examples for PLS-DA model class

library(mdatools)

## 1. Make a PLS-DA model with full cross-validation and show model overview

# make a calibration set from iris data (3 classes)
# use names of classes as class vector
x.cal = iris[seq(1, nrow(iris), 2), 1:4]
c.cal = iris[seq(1, nrow(iris), 2), 5]

model = plsda(x.cal, c.cal, ncomp = 3, cv = 1, info = 'IRIS data example')
model = selectCompNum(model, 1)

# show summary and basic model plots
# misclassification will be shown only for first class
summary(model)
plot(model)

# summary and model plots for second class
summary(model, nc = 2)
plot(model, nc = 2)

# summary and model plot for specific class and number of components
summary(model, nc = 3, ncomp = 3)
plot(model, nc = 3, ncomp = 3)

## 2. Show performance plots for a model
par(mfrow = c(2, 2))
plotSpecificity(model)
plotSensitivity(model)
plotMisclassified(model)
plotMisclassified(model, nc = 2)
par(mfrow = c(1, 1))

## 3. Show both class and y values predictions
par(mfrow = c(2, 2))
plotPredictions(model)
plotPredictions(model, res = "cal", ncomp = 2, nc = 2)
plotPredictions(structure(model, class = "regmodel"))
plotPredictions(structure(model, class = "regmodel"), ncomp = 2, ny = 2)
par(mfrow = c(1, 1))

## 4. All plots from ordinary PLS can be used, e.g.:
par(mfrow = c(2, 2))
plotXYScores(model)
plotYVariance(model)
plotXResiduals(model)
plotRegcoeffs(model, ny = 2)
par(mfrow = c(1, 1))

</code></pre>


</div>