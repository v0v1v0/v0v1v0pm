<div class="container">

<table style="width: 100%;"><tr>
<td>prep.alsbasecorr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Baseline correction using asymetric least squares</h2>

<h3>Description</h3>

<p>Baseline correction using asymetric least squares
</p>


<h3>Usage</h3>

<pre><code class="language-R">prep.alsbasecorr(data, plambda = 5, p = 0.1, max.niter = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>matrix with spectra (rows correspond to individual spectra)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plambda</code></td>
<td>
<p>power of the penalty parameter (e.g. if plambda = 5, lambda = 10^5)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>assymetry ratio (should be between 0 and 1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.niter</code></td>
<td>
<p>maximum number of iterations</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function implements baseline correction algorithm based on Whittaker smoother. The method
was first shown in [1]. The function has two main parameters - power of a penalty parameter
(usually varies betwen 2 and 9) and the ratio of assymetry (usually between 0.1 and 0.001). The
choice of the parameters depends on how broad the disturbances of the baseline are and how
narrow the original spectral peaks are.
</p>


<h3>Value</h3>

<p>preprocessed spectra.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># take spectra from carbs dataset
data(carbs)
spectra = mda.t(carbs$S)

# apply the correction
pspectra = prep.alsbasecorr(spectra, plambda = 3, p = 0.01)

# show the original and the corrected spectra individually
par(mfrow = c(3, 1))
for (i in 1:3) {
   mdaplotg(list(
      original = mda.subset(spectra, i),
      corrected = mda.subset(pspectra, i)
   ), type = "l", col = c("black", "red"), lwd = c(2, 1), main = rownames(spectra)[i])
}

</code></pre>


</div>