<div class="container">

<table style="width: 100%;"><tr>
<td>randtest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Randomization test for PLS regression</h2>

<h3>Description</h3>

<p><code>randtest</code> is used to carry out randomization/permutation test for a PLS regression model
</p>


<h3>Usage</h3>

<pre><code class="language-R">randtest(
  x,
  y,
  ncomp = 15,
  center = TRUE,
  scale = FALSE,
  nperm = 1000,
  sig.level = 0.05,
  silent = TRUE,
  exclcols = NULL,
  exclrows = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>matrix with predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>vector or one-column matrix with response.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncomp</code></td>
<td>
<p>maximum number of components to test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>logical, center or not predictors and response values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>logical, scale (standardize) or not predictors and response values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nperm</code></td>
<td>
<p>number of permutations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig.level</code></td>
<td>
<p>significance level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>logical, show or not test progress.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclcols</code></td>
<td>
<p>columns of x to be excluded from calculations (numbers, names or vector with logical values)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclrows</code></td>
<td>
<p>rows to be excluded from calculations (numbers, names or vector with logical values)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The class implements a method for selection of optimal number of components in PLS1 regression
based on the randomization test [1]. The basic idea is that for each component from 1 to
<code>ncomp</code> a statistic T, which is a covariance between t-score (X score, derived from a PLS
model) and the reference Y values, is calculated. By repeating this for randomly permuted
Y-values a distribution of the statistic is obtained. A parameter <code>alpha</code> is computed to
show how often the statistic T, calculated for permuted Y-values, is the same or higher than
the same statistic, calculated for original data without permutations.
</p>
<p>If a component is important, then the covariance for unpermuted data should be larger than the
covariance for permuted data and therefore the value for <code>alpha</code> will be quie small (there
is still a small chance to get similar covariance). This makes <code>alpha</code> very similar to
p-value in a statistical test.
</p>
<p>The <code>randtest</code> procedure calculates alpha for each component, the values can be observed
using <code>summary</code> or <code>plot</code> functions. There are also several function, allowing e.g.
to show distribution of statistics and the critical value for each component.
</p>


<h3>Value</h3>

<p>Returns an object of <code>randtest</code> class with following fields:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>nperm </code></td>
<td>
<p>number of permutations used for the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stat </code></td>
<td>
<p>statistic values calculated for each component.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha </code></td>
<td>
<p>alpha values calculated for each component.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statperm </code></td>
<td>
<p>matrix with statistic values for each permutation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corrperm </code></td>
<td>
<p>matrix with correlation between predicted and reference y-vales for each
permutation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncomp.selected </code></td>
<td>
<p>suggested number of components.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>S. Wiklund et al. Journal of Chemometrics 21 (2007) 427-439.
</p>


<h3>See Also</h3>

<p>Methods for <code>randtest</code> objects:
</p>

<table>
<tr>
<td style="text-align: left;">
 <code>print.randtest</code> </td>
<td style="text-align: left;"> prints information about a <code>randtest</code> object.</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>summary.randtest</code> </td>
<td style="text-align: left;"> shows summary statistics for the test.</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>plot.randtest</code> </td>
<td style="text-align: left;"> shows bar plot for alpha values.</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>plotHist.randtest</code> </td>
<td style="text-align: left;"> shows distribution of statistic plot.</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>plotCorr.randtest</code> </td>
<td style="text-align: left;"> shows determination coefficient plot.</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">### Examples of using the test

## Get the spectral data from Simdata set and apply SNV transformation

data(simdata)

y = simdata$conc.c[, 3]
x = simdata$spectra.c
x = prep.snv(x)

## Run the test and show summary
## (normally use higher nperm values &gt; 1000)
r = randtest(x, y, ncomp = 4, nperm = 200, silent = FALSE)
summary(r)

## Show plots

par( mfrow = c(3, 2))
plot(r)
plotHist(r, ncomp = 3)
plotHist(r, ncomp = 4)
plotCorr(r, 3)
plotCorr(r, 4)
par( mfrow = c(1, 1))

</code></pre>


</div>