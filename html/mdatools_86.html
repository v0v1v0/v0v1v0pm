<div class="container">

<table style="width: 100%;"><tr>
<td>mcrals.cal</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Identifies pure variables</h2>

<h3>Description</h3>

<p>The method identifies indices of pure variables using the SIMPLISMA
algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mcrals.cal(
  D,
  ncomp,
  cont.constraints,
  spec.constraints,
  spec.ini,
  cont.forced,
  spec.forced,
  cont.solver,
  spec.solver,
  max.niter,
  tol,
  verbose
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>matrix with the spectra</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncomp</code></td>
<td>
<p>number of pure components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cont.constraints</code></td>
<td>
<p>a list with constraints to be applied to contributions  (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spec.constraints</code></td>
<td>
<p>a list with constraints to be applied to spectra  (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spec.ini</code></td>
<td>
<p>a matrix with initial estimation of the pure components spectra.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cont.forced</code></td>
<td>
<p>a matrix which allows to force some of the concentration values (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spec.forced</code></td>
<td>
<p>a matrix which allows to force some of the spectra values (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cont.solver</code></td>
<td>
<p>which function to use as a solver for resolving of pure components contributions (see detials).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spec.solver</code></td>
<td>
<p>which function to use as a solver for resolving of pure components spectra (see detials).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.niter</code></td>
<td>
<p>maximum number of iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>tolerance, when explained variance change is smaller than this value, iterations stop.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical, if TRUE information about every iteration will be shown.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function returns a list with with following fields:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>ncomp </code></td>
<td>
<p>number of pure components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resspec</code></td>
<td>
<p>matrix with resolved spectra.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rescont</code></td>
<td>
<p>matrix with resolved contributions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cont.constraints</code></td>
<td>
<p>list with contribution constraints provided by user.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spec.constraints</code></td>
<td>
<p>list with spectra constraints provided by user.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.niter</code></td>
<td>
<p>maximum number of iterations</p>
</td>
</tr>
</table>
</div>