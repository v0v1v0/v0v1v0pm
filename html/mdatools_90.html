<div class="container">

<table style="width: 100%;"><tr>
<td>mcrpure</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multivariate curve resolution based on pure variables</h2>

<h3>Description</h3>

<p><code>mcrpure</code> allows to resolve spectroscopic data to linear combination of individual spectra
and contributions using the pure variables approach.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mcrpure(
  x,
  ncomp,
  purevars = NULL,
  offset = 0.05,
  exclrows = NULL,
  exclcols = NULL,
  info = ""
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>spectra of mixtures (matrix or data frame).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncomp</code></td>
<td>
<p>maximum number of components to calculate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>purevars</code></td>
<td>
<p>vector with indices for pure variables (optional, if you want to provide the variables directly).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>offset for correcting noise in computing maximum angles (should be value within [0, 1)).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclrows</code></td>
<td>
<p>rows to be excluded from calculations (numbers, names or vector with logical values).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclcols</code></td>
<td>
<p>columns to be excluded from calculations (numbers, names or vector with logical values).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>info</code></td>
<td>
<p>a short text with description of the case (optional).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The method estimates purity of each variable and then uses the purest ones to decompose the
spectral data into spectra ('resspec') and contributions ('rescont') of individual
chemical components by ordinary least squares.
</p>
<p>The pure variabes are identified using stepwise maximum angle calculations and described in
detail in [1]. So the purity of a spectral variable (wavelength, wavenumber) is actually an
angle (measured in degrees) between the variable and vector of ones for the first component;
and between the variable and space formed by previously found pure variables for the other
components.
</p>


<h3>Value</h3>

<p>Returns an object of <code>mcrpure</code> class with the following fields:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>resspec</code></td>
<td>
<p>matrix with resolved spectra.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rescont</code></td>
<td>
<p>matrix with resolved contributions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>purevars</code></td>
<td>
<p>indices of the selected pure variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>purevals</code></td>
<td>
<p>purity values for the selected pure variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>purityspec</code></td>
<td>
<p>purity spectra (matrix with purity values for each variable and component).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expvar </code></td>
<td>
<p>vector with explained variance for each component (in percent).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cumexpvar </code></td>
<td>
<p>vector with cumulative explained variance for each component (in percent).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>offset value used to compute the purity</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncomp</code></td>
<td>
<p>number of resolved components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>info </code></td>
<td>
<p>information about the model, provided by user when build the model.</p>
</td>
</tr>
</table>
<p>More details and examples can be found in the Bookdown tutorial.
</p>


<h3>Author(s)</h3>

<p>Sergey Kucheryavskiy (svkucheryavski@gmail.com)
</p>


<h3>References</h3>

<p>1. Willem Windig, Neal B. Gallagher, Jeremy M. Shaver, Barry M. Wise. A new approach for
interactive self-modeling mixture analysis. Chemometrics and Intelligent Laboratory Systems,
77 (2005) 85â€“96. DOI: 10.1016/j.chemolab.2004.06.009
</p>


<h3>See Also</h3>

<p>Methods for <code>mcrpure</code> objects:
</p>

<table>
<tr>
<td style="text-align: left;">
   <code>summary.mcrpure</code> </td>
<td style="text-align: left;"> shows some statistics for the case.</td>
</tr>
<tr>
<td style="text-align: left;">
   <code>unmix.mcrpure</code> </td>
<td style="text-align: left;"> makes unmixing of new set of spectra.</td>
</tr>
<tr>
<td style="text-align: left;">
   <code>predict.mcrpure</code> </td>
<td style="text-align: left;"> computes contributions by projection of new spectra to
   the resolved ones.</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>Plotting methods for <code>mcrpure</code> objects:
</p>

<table>
<tr>
<td style="text-align: left;">
   <code>plotPurity.mcrpure</code> </td>
<td style="text-align: left;"> shows plot with maximum purity of each component.</td>
</tr>
<tr>
<td style="text-align: left;">
   <code>plotPuritySpectra.mcrpure</code> </td>
<td style="text-align: left;"> shows plot with purity spectra.</td>
</tr>
<tr>
<td style="text-align: left;">
   <code>plotSpectra.mcr</code> </td>
<td style="text-align: left;"> shows plot with resolved spectra.</td>
</tr>
<tr>
<td style="text-align: left;">
   <code>plotContributions.mcr</code> </td>
<td style="text-align: left;"> shows plot with resolved contributions.</td>
</tr>
<tr>
<td style="text-align: left;">
   <code>plotVariance.mcr</code> </td>
<td style="text-align: left;"> shows plot with explained variance.</td>
</tr>
<tr>
<td style="text-align: left;">
   <code>plotCumVariance.mcr</code> </td>
<td style="text-align: left;"> shows plot with cumulative explained variance.</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">library(mdatools)

# resolve mixture of carbonhydrates Raman spectra

data(carbs)
m = mcrpure(carbs$D, ncomp = 3)

# examples for purity spectra plot (you can select which components to show)
par(mfrow = c(2, 1))
plotPuritySpectra(m)
plotPuritySpectra(m, comp = 2:3)

# you can do it manually and combine e.g. with original spectra
par(mfrow = c(1, 1))
mdaplotg(
   list(
      "spectra" = prep.norm(carbs$D, "area"),
      "purity" = prep.norm(mda.subset(mda.t(m$resspec), 1), "area")
   ), col = c("gray", "red"), type = "l"
)

# show the maximum purity for each component
par(mfrow = c(1, 1))
plotPurity(m)

# plot cumulative and individual explained variance
par(mfrow = c(1, 2))
plotVariance(m)
plotCumVariance(m)

# plot resolved spectra (all of them or individually)
par(mfrow = c(2, 1))
plotSpectra(m)
plotSpectra(m, comp = 2:3)

# plot resolved contributions (all of them or individually)
par(mfrow = c(2, 1))
plotContributions(m)
plotContributions(m, comp = 2:3)

# of course you can do this manually as well, e.g. show original
# and resolved spectra
par(mfrow = c(1, 1))
mdaplotg(
   list(
      "original" = prep.norm(carbs$D, "area"),
      "resolved" = prep.norm(mda.subset(mda.t(m$resspec), 1), "area")
   ), col = c("gray", "red"), type = "l"
)

# in case if you have reference spectra of components you can compare them with
# the resolved ones:
par(mfrow = c(3, 1))
for (i in 1:3) {
   mdaplotg(
      list(
         "pure" = prep.norm(mda.subset(mda.t(carbs$S), 1), "area"),
         "resolved" = prep.norm(mda.subset(mda.t(m$resspec), 1), "area")
      ), col = c("gray", "red"), type = "l", lwd = c(3, 1)
   )
}

# See bookdown tutorial for more details.

</code></pre>


</div>