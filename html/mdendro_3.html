<div class="container">

<table style="width: 100%;"><tr>
<td>linkage</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extended Agglomerative Hierarchical Clustering</h2>

<h3>Description</h3>

<p>Agglomerative hierarchical clustering on a dataset of distances or
similarities, returning a multifurcated dendrogram or <dfn>multidendrogram</dfn>.
Descriptive measures to analyze the resulting dendrogram are additionally
provided.
</p>


<h3>Usage</h3>

<pre><code class="language-R">linkage(prox, type.prox = "distance", digits = NULL,
        method = "arithmetic", par.method = 0, weighted = FALSE,
        group = "variable")

descval(prox, type.prox = "distance", digits = NULL,
        method = "versatile", par.method = c(-1,0,+1), weighted = FALSE,
        group = "variable", measure = "cor")

descplot(prox, ..., type.prox = "distance", digits = NULL,
         method = "versatile", par.method = c(-1,0,+1), weighted = FALSE,
         group = "variable", measure = "cor", slope = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>prox</code></td>
<td>
<p>A structure of class <code>"dist"</code> containing non-negative
proximity data (distances or similarities). All the linkage methods are
meant to be used with non-squared proximity data as input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type.prox</code></td>
<td>
<p>A character string to indicate whether the proximity data
represent <code>"distance"</code> (default) or <code>"similarity"</code> between
objects. Methods <code>"ward"</code> and <code>"centroid"</code> cannot be used with 
similarity data as input, while the rest of the linkage methods can be used 
with both distances and similarities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>An integer value specifying the precision, i.e. the number of
significant decimal digits to be used for the comparisons between proximity
data. This is an important parameter, since equal proximity data at a
certain precision may become different by increasing its value. Thus, it may
be responsible of the existence of tied proximity data. If the value of this
parameter is negative or <code>NULL</code> (default), then the precision is
automatically set to the number of significant decimal digits in the input
proximity data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A character string specifying the linkage method to be used. For
<code>linkage()</code>, this should be one of: <code>"single"</code>, <code>"complete"</code>,
<code>"arithmetic"</code>, <code>"geometric"</code>, <code>"harmonic"</code>,
<code>"versatile"</code>, <code>"ward"</code>, <code>"centroid"</code> or <code>"flexible"</code>. 
Methods <code>"versatile"</code> and <code>"flexible"</code> are the only two methods 
that can be used in <code>descval()</code> and <code>descplot()</code>. See the 
<em>Details</em> section.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par.method</code></td>
<td>
<p>A real value, in the case of <code>linkage()</code>, or a vector
of real values, in the case of <code>descval()</code> and <code>descplot()</code>, 
required as parameter for the methods <code>"versatile"</code> and 
<code>"flexible"</code>. The range of possible values is <code>[-Inf, +Inf]</code> for 
<code>"versatile"</code>, and <code>[-1, +1]</code> for <code>"flexible"</code>. See the 
<em>Details</em> section.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weighted</code></td>
<td>
<p>A logical value to choose between the weighted and the
unweighted (default) versions of some linkage methods. Weighted linkage
gives merging branches in a dendrogram equal weight regardless of the number
of objects carried on each branch. Such a procedure weights objects
unequally, contrasting with unweighted linkage that gives equal weight to
each object in the clusters. This parameter has no effect on the
<code>"single"</code> and <code>"complete"</code> linkages.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>A character string to choose a grouping criterion between the
<code>"variable"</code>-group approach (default) that returns a multifurcated
dendrogram (m-ary tree), and the <code>"pair"</code>-group approach that returns a
bifurcated dendrogram (binary tree). See the <em>Details</em> section.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>measure</code></td>
<td>
<p>A character string specifying the descriptive measure to be
plotted. This should be one of: <code>"cor"</code>, for cophenetic correlation
coefficient; <code>"sdr"</code>, for space distortion ratio; <code>"ac"</code>, for
agglomerative coefficient; <code>"cc"</code>, for chaining coefficient; or
<code>"tb"</code>, for tree balance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slope</code></td>
<td>
<p>A real value representing the slope of a sigmoid function to
map the <code>"versatile"</code> linkage unbounded interval <code>(-Inf, +Inf)</code>
onto the bounded interval <code>(-1, +1)</code>. It can be used to improve the
distribution of points along the <em>x</em> axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Graphical parameters (see <code>par</code>) may also be supplied
and are passed to <code>plot.default</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Starting from a matrix of proximity data (distances or similarities),
<code>linkage()</code> calculates its dendrogram with the most commonly used
agglomerative hierarchical clustering methods, i.e. single linkage, complete
linkage, arithmetic linkage (also known as average linkage) and Ward's method.
Importantly, it contains a new parameterized method named versatile linkage
(Fernandez and Gomez, 2020), which includes single linkage, complete linkage 
and average linkage as particular cases, and which naturally defines two new 
methods, geometric linkage and harmonic linkage.
</p>
<p>The difference between the available hierarchical clustering methods rests in
the way the proximity between two clusters is defined from the proximity
between their constituent objects:
</p>

<ul>
<li> <p><code>"single"</code>: the proximity between clusters equals the minimum
distance or the maximum similarity between objects.
</p>
</li>
<li> <p><code>"complete"</code>: the proximity between clusters equals the maximum
distance or the minimum similarity between objects.
</p>
</li>
<li> <p><code>"arithmetic"</code>: the proximity between clusters equals the
arithmetic mean proximity between objects. Also known as average linkage,
WPGMA (weighted version) or UPGMA (unweighted version).
</p>
</li>
<li> <p><code>"geometric"</code>: the proximity between clusters equals the
geometric mean proximity between objects.
</p>
</li>
<li> <p><code>"harmonic"</code>: the proximity between clusters equals the harmonic
mean proximity between objects.
</p>
</li>
<li> <p><code>"versatile"</code>: the proximity between clusters equals the
generalized power mean proximity between objects. It depends on the value
of <code>par.method</code>, with the following linkage methods as particular
cases: <code>"complete"</code> (<code>par.method=+Inf</code>), <code>"arithmetic"</code>
(<code>par.method=+1</code>), <code>"geometric"</code> (<code>par.method=0</code>),
<code>"harmonic"</code> (<code>par.method=-1</code>) and <code>"single"</code>
(<code>par.method=-Inf</code>).
</p>
</li>
<li> <p><code>"ward"</code>: the distance between clusters is a weighted squared
Euclidean distance between the centroids of each cluster. This method is 
available only for distance data.
</p>
</li>
<li> <p><code>"centroid"</code>: the distance between clusters equals the square of
the Euclidean distance between the centroids of each cluster. Also known 
as WPGMC (weighted version) or UPGMC (unweighted version). This method is
available only for distance data. Note that both centroid versions, 
weighted and unweighted, may yield inversions that make dendrograms 
difficult to interpret.
</p>
</li>
<li> <p><code>"flexible"</code>: the proximity between clusters is a weighted sum of
the proximity between clusters in the previous iteration. It depends on
the value of <code>par.method</code>, in the range <code>[-1, +1]</code>, and it is
equivalent to <code>"arithmetic"</code> linkage when <code>par.method=0</code>.
</p>
</li>
</ul>
<p>With the argument <code>group</code>, users can choose between a variable-group
approach (default) that returns a multifurcated dendrogram or multidendrogram,
and a pair-group approach that returns a bifurcated dendrogram.
Multidendrograms were introduced (Fernandez and Gomez, 2008) to solve the 
non-uniqueness problem that arises when two or more minimum proximity values 
between different clusters are equal during the agglomerative process. 
Multidendrograms group more than two clusters when tied proximity values 
occur, what produces a uniquely determined solution that does not depend on 
the order of the input data. When there are no tied proximity values, the 
variable-group approach gives the same result as the pair-group one.
</p>
<p><code>descval()</code> and <code>descplot()</code> can be used with methods 
<code>"versatile"</code> and <code>"flexible"</code> to analyze the variation of any 
descriptive measure as a function of the corresponding method parameter. Both 
functions return a vector with the numerical values of the descriptive measure
evaluated at the points contained in the parameter <code>par.method</code>. Function
<code>descplot()</code>, in addition, draws the corresponding plot.
</p>


<h3>Value</h3>

<p>An object of class <code>"linkage"</code> that describes the multifurcated
dendrogram obtained. The object is a list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The call that produced the result.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>Number of significant decimal digits used as precision. It is
given by the user or automatically set to the number of significant decimal
digits in the input proximity data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>merger</code></td>
<td>
<p>A list of vectors of integer that describes the merging of
clusters at each step of the clustering. If a number <code class="reqn">j</code> in a vector is
negative, then singleton cluster <code class="reqn">-j</code> was merged at this stage. If
<code class="reqn">j</code> is positive, then the merge was with the cluster formed at stage
<code class="reqn">j</code> of the algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>height</code></td>
<td>
<p>A vector with the proximity values between merging clusters (for
the particular agglomeration) at the successive stages.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range</code></td>
<td>
<p>A vector with the range (the maximum minus the minimum) of
proximity values between merging clusters. It is equal to 0 for binary
clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>A vector giving a permutation of the original observations to
allow for plotting, in the sense that the branches of a clustering tree
will not cross.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coph</code></td>
<td>
<p>Object of class <code>"dist"</code> containing the cophenetic
(or ultrametric) proximity data in the output dendrogram, sorted in the same
order as the input proximity data in <code>prox</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binary</code></td>
<td>
<p>A logical value indicating whether the output dendrogram is a
binary tree or, on the contrary, it contains an agglomeration of more than
two clusters due to the existence of tied proximity data. Its value is
always <code>TRUE</code> when the <code>"pair"</code> grouping criterion is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor</code></td>
<td>
<p>Cophenetic correlation coefficient (Sokal and Rohlf, 1962),
defined as the Pearson correlation coefficient between the output cophenetic
proximity data and the input proximity data. It is a measure of how
faithfully the dendrogram preserves the pairwise proximity between objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdr</code></td>
<td>
<p>Space distortion ratio (Fernandez and Gomez, 2020), calculated as 
the difference between the maximum and minimum cophenetic proximity data, 
divided by the difference between the maximum and minimum initial proximity 
data. Space dilation occurs when the space distortion ratio is greater than 
1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ac</code></td>
<td>
<p>Agglomerative coefficient (Rousseeuw, 1986), a number between 0
and 1 measuring the strength of the clustering structure obtained.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cc</code></td>
<td>
<p>Chaining coefficient (Williams <em>et al.</em>, 1966), a number
between 0 and 1 measuring the tendency for clusters to grow by the addition
of clusters much smaller rather than by fusion with other clusters of
comparable size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tb</code></td>
<td>
<p>Tree balance (Fernandez and Gomez, 2020), a number between 0 and 1 
measuring the equality in the number of leaves in the branches concerned at 
each fusion in the hierarchical tree.</p>
</td>
</tr>
</table>
<p>Class <code>"linkage"</code> has methods for the following generic functions:
<code>print</code>, <code>summary</code>, <code>plot</code> (see 
<code>plot.linkage</code>), <code>as.dendrogram</code>, 
<code>as.hclust</code> and <code>cophenetic</code>.
</p>


<h3>Note</h3>

<p>Except for the cases containing tied proximity data, the following 
equivalences hold between function <code>linkage()</code> in package <em>mdendro</em>,
function <code>hclust()</code> in package <em>stats</em>, and function 
<code>agnes()</code> in package <em>cluster</em>. Special attention must be 
paid to the equivalence with methods <code>"centroid"</code> and <code>"median"</code> of 
function <code>hclust()</code>, since these methods require the input 
distances to be squared before calling <code>hclust()</code> and, 
consequently, the square root of its results should be taken afterwards. When 
relevant, weighted (<code>W</code>) or unweighted (<code>U</code>) versions of the linkage
methods and the value for <code>par.method</code> (<code class="reqn">\beta</code>) are indicated:
</p>

<table>
<tr>
<td style="text-align: left;">
    <code>linkage()</code> </td>
<td style="text-align: left;"> <code>hclust()</code> </td>
<td style="text-align: left;"> <code>agnes()</code> </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>==================</code> </td>
<td style="text-align: left;"> <code>============</code> </td>
<td style="text-align: left;">
      <code>===================</code> </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>"single"</code> </td>
<td style="text-align: left;"> <code>"single"</code> </td>
<td style="text-align: left;"> <code>"single"</code> </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>"complete"</code> </td>
<td style="text-align: left;"> <code>"complete"</code> </td>
<td style="text-align: left;"> <code>"complete"</code> </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>"arithmetic", U</code> </td>
<td style="text-align: left;"> <code>"average"</code> </td>
<td style="text-align: left;"> <code>"average"</code> </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>"arithmetic", W</code> </td>
<td style="text-align: left;"> <code>"mcquitty"</code> </td>
<td style="text-align: left;"> <code>"weighted"</code> </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>"ward"</code> </td>
<td style="text-align: left;"> <code>"ward.D2"</code> </td>
<td style="text-align: left;"> <code>"ward"</code> </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>"centroid", U</code> </td>
<td style="text-align: left;"> <code>"centroid"</code> </td>
<td style="text-align: left;"> <code>--------</code> </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>"centroid", W</code> </td>
<td style="text-align: left;"> <code>"median"</code> </td>
<td style="text-align: left;"> <code>--------</code> </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>"flexible", U, </code> <code class="reqn">\beta</code> </td>
<td style="text-align: left;"> <code>--------</code> </td>
<td style="text-align: left;">
      <code>"gaverage", </code> <code class="reqn">\beta</code> </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>"flexible", W, </code> <code class="reqn">\beta</code> </td>
<td style="text-align: left;"> <code>--------</code> </td>
<td style="text-align: left;">
      <code>"flexible", </code> <code class="reqn">(1-\beta)/2</code>
  </td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Alberto Fernandez <a href="mailto:alberto.fernandez@urv.cat">alberto.fernandez@urv.cat</a> and Sergio Gomez 
<a href="mailto:sergio.gomez@urv.cat">sergio.gomez@urv.cat</a>.
</p>


<h3>References</h3>

<p>Fernandez, A.; Gomez, S. (2008). Solving non-uniqueness in agglomerative 
hierarchical clustering using multidendrograms. 
<em>Journal of Classification</em>, <b>25</b>, 43–65.
</p>
<p>Fernandez, A.; Gomez, S. (2020). Versatile linkage: a family of 
space-conserving strategies for agglomerative hierarchical clustering. 
<em>Journal of Classification</em>, <b>37</b>, 584–597.
</p>
<p>Rousseeuw, P.J. (1986). A visual display for hierarchical classification. In
E. Diday <em>et al.</em> (eds.) <em>Data Analysis and Informatics 4</em>, pp.
743–748. Amsterdam: North-Holland.
</p>
<p>Sokal, R.R.; Rohlf, F.J. (1962). The comparison of dendrograms by objective
methods. <em>Taxon</em>, <b>11</b>, 33–40.
</p>
<p>Williams, W.T.; Lambert, J.M.; Lance, G.N. (1966). Multivariate methods in
plant ecology: V. Similarity analyses and information-analysis.
<em>Journal of Ecology</em>, <b>54</b>, 427–445.
</p>


<h3>See Also</h3>

<p><code>plot.linkage</code>, <code>dist</code>, <code>dendrogram</code>,
<code>hclust</code>, <code>agnes</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Plot and summary of unweighted arithmetic linkage (UPGMA) dendrogram
lnk1 &lt;- linkage(UScitiesD)
plot(lnk1)
summary(lnk1)

## Linkage of similarity data (non-negative correlations)
sim &lt;- as.dist(cor(EuStockMarkets))
lnk2 &lt;- linkage(sim, type.prox = "similarity")
plot(lnk2)

## Use function as.dendrogram to plot with package dendextend
d &lt;- dist(scale(mtcars))  # distances of standardized data
lnk &lt;- linkage(d, digits = 1, method = "complete")
lnk.dend &lt;- as.dendrogram(lnk)
plot(dendextend::set(lnk.dend, "branches_k_color", k = 4),
     nodePar = list(cex = 0.4, lab.cex = 0.5))

## Plot heatmap containing multidendrograms
heatmap(scale(mtcars), hclustfun = linkage)

## Plot of different versatile linkages as we increase the method parameter
d = as.dist(matrix(c( 0,  7, 16, 12,
                      7,  0,  9, 19,
                     16,  9,  0, 12,
                     12, 19, 12, 0), nrow = 4))
par(mfrow = c(2, 3))
vals &lt;- c(-Inf, -1, 0, +1, +Inf)
names &lt;- c("single", "harmonic", "geometric", "arithmetic", "complete")
for (i in 1:length(vals)) {
  lnk &lt;- linkage(d, digits = 1, method = "versatile", par.method = vals[i])
  plot(lnk, main = paste0("versatile (", vals[i], ") = ", names[i]),
       ylim = c(0, 20), cex = 0.6)
}

## Analyze how descriptive measures depend on versatile linkage parameter
par(mfrow = c(2, 3))
measures &lt;- c("cor", "sdr", "ac", "cc", "tb")
vals &lt;- c(-Inf, (-20:+20), +Inf)
for (measure in measures) {
  descplot(UScitiesD, method = "versatile", par.method = vals,
           measure = measure,  main = measure, type = "o", col = "blue")
}
</code></pre>


</div>