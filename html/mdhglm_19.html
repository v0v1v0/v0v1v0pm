<div class="container">

<table style="width: 100%;"><tr>
<td>jointfit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fitting Multivariate Double Hierarchical Generalized Linear Models using
h-likelihood Approach
</h2>

<h3>Description</h3>

<p>The jointfit is used to fit a multivariate double hierarchical generalized linear models (MDHGLMs) allowing
different models for multivariate response variables where each response follow DHGLM. A variety of distributions and link
functions for both response and the random effects are allowed. Fixed and random
effects can also be fitted in both the mean and the dispersion components. To call the fitting function
jointfit, models for the mean and dispersion must be specified by DHGLMMODELING object
preferably created by calling the DHGLMMODELING function.</p>


<h3>Usage</h3>

<pre><code class="language-R">jointfit(RespDist="gaussian",BinomialDen=NULL, DataMain, MeanModel,DispersionModel=NULL,
PhiFix=NULL,LamFix=NULL,structure="correlated",mord=0,dord=1,convergence=1e-05,
Init_Corr=NULL, EstimateCorrelations=TRUE, ZZCorr=NULL, factor=NULL, REML=TRUE,order=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>RespDist</code></td>
<td>
<p>The distribution of the response is set by the option <code>RespDist</code>. The user can set
it to: "gaussian" (default), "binomial", "poisson", or "gamma".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BinomialDen</code></td>
<td>
<p>When <code>RespDist</code>="binomial", one should use the option <code>BinomialDen</code> to specify
the denominator for the binomial distribution. This should be "NULL" (default)
or a numeric vector of length equal to the length of <code>DataMain</code>. When specified
as <code>BinomialDen</code>=NULL and <code>RespDist</code>="binomial", the denominator is 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DataMain</code></td>
<td>
<p>The option <code>DataMain</code> determines the data frame to be used (non-optional).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MeanModel</code></td>
<td>
<p>For the mean model, this option requires <code>DGHLMMODELING</code> object which
should specified by the option Model="mean".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DispersionModel</code></td>
<td>
<p>For the overdispersion model, this option requires <code>DGHLMMODELING</code> object
which should be specified by the option Model="dispersion".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PhiFix</code></td>
<td>
<p>The option for overdispersion parameters (phi) to be estimated or maintaned constant.
Specifying defaults such as <code>PhiFix</code> =NULL implies that phi is to be estimated. If not, phi is fixed at a value
specified by <code>PhiFix</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LamFix</code></td>
<td>
<p>The option for random-effect variance (lambda) to be estimated or maintaned constant.
Specifying defaults such as <code>LamFix</code> =NULL implies that lambda is to be estimated. If not, lambda is fixed at a value
specified by <code>LamFix</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>structure</code></td>
<td>
<p>The option <code>structure</code> determines structure of random effects. When <code>structure</code>="correlated" (or "shared"),
correlated (or "shared") random-effects model is specified. Factor analysis can be fitted by specifying <code>structure</code>="factor".
Furthremore, selection model for missing data can be also fitted by specifying <code>structure</code>="selection".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mord</code></td>
<td>
<p>The option <code>mord</code> specifies the order of Laplace approximation to the marginal
likelihood for fitting the mean parameters. The choice is either 0 or 1 (default).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dord</code></td>
<td>
<p>The option <code>dord</code> specifies the order of adjusted
profile likelihood for fitting the dispersion parameters. The choice is either 1
(default) or 2.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>Setting this option determines the criterion for convergence, which is computed
as the absolute difference between the values of all the estimated parameters in
the previous and current iterations. The default criterion is 1e-06.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Init_Corr</code></td>
<td>
<p>Setting initial values of correlation (or shared parameters) between random effects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EstimateCorrelations</code></td>
<td>
<p>Correlation are estimated or fixed when <code>EstimateCorrelations</code>=TRUE (default) or <code>EstimateCorrelations</code>=FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ZZCorr</code></td>
<td>
<p>List of model matrices for random effects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factor</code></td>
<td>
<p>factor structure when <code>structure</code>="factor"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>REML</code></td>
<td>
<p>Giving REML estimates when <code>REML</code>=TRUE (default) or ML estimates when <code>REML</code>=FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>first order approximation when <code>order</code>=1 (default) or second order approximation when <code>order</code>=2 for factor analysis</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">data(eg)
eg1&lt;-eg[1:100,] ## using sampled data to have faster results 

jm1&lt;-DHGLMMODELING(Link="identity", LinPred=y1~dose+dose2+(1|litter),RandDist="gaussian")
jm2&lt;-DHGLMMODELING(Link="logit", LinPred=y2~dose+dose2+(1|litter),RandDist="gaussian")

Init_Corr=list(c(0))
SSC=list(as.factor(c(eg1$litter,eg1$litter)),as.factor(c(eg1$litter,eg1$litter)))
EstimateOverDisp=c(TRUE,FALSE)
LaplaceFixed=c(TRUE,TRUE)
ZZ1&lt;-model.matrix(~as.factor(eg1$litter)-1)
ZZCorr=list(ZZ1,ZZ1)

#### independent random-effects model ####
res_ind&lt;-jointfit(RespDist=c("gaussian","binomial"),DataMain=list(eg1,eg1),
    MeanModel=list(jm1,jm2),structure="correlated",
    Init_Corr=Init_Corr,EstimateCorrelations=FALSE,convergence=1,ZZCorr=ZZCorr)

#### correlated random-effects model ####
res_corr&lt;-jointfit(RespDist=c("gaussian","binomial"),DataMain=list(eg1,eg1),
    MeanModel=list(jm1,jm2),structure="correlated",
    Init_Corr=Init_Corr,convergence=1,ZZCorr=ZZCorr)

#### shared random-effects model ####
Init_Corr=c(1,-10)
res_saturated&lt;-jointfit(RespDist=c("gaussian","binomial"),DataMain=list(eg1,eg1),
    MeanModel=list(jm1,jm2),structure="shared",
    Init_Corr=Init_Corr,convergence=1)
</code></pre>


</div>