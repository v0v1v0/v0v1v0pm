<div class="container">

<table style="width: 100%;"><tr>
<td>yjt_dist</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Scaled <code class="reqn">t</code> Distribution with Yeo-Johnson and Box-Cox Transformations
</h2>

<h3>Description</h3>

<p>Collection of functions for the Yeo-Johnson transformation
(Yeo &amp; Johnson, 2000) and the corresponding distribution family of scaled
<code class="reqn">t</code> distribution with and without Yeo-Johnson transformation
(see Details). The Yeo-Johnson transformation can also be applied for bounded variables
on <code class="reqn">(0,1)</code> which uses a probit transformation (see Details; argument <code>probit</code>).
</p>
<p>The Box-Cox transformation (<code>bc</code>; Sakia, 1992)
can be applied for variables with positive values.
</p>


<h3>Usage</h3>

<pre><code class="language-R"># Yeo-Johnson transformation and its inverse transformation
yj_trafo(y, lambda, use_rcpp=TRUE, probit=FALSE)
yj_antitrafo(y, lambda, probit=FALSE)

#---- scaled t distribution with Yeo-Johnson transformation
dyjt_scaled(x, location=0, shape=1, lambda=1, df=Inf, log=FALSE, probit=FALSE)
ryjt_scaled(n, location=0, shape=1, lambda=1, df=Inf, probit=FALSE)

fit_yjt_scaled(x, df=Inf, par_init=NULL, lambda_fixed=NULL, weights=NULL, probit=FALSE)
## S3 method for class 'fit_yjt_scaled'
coef(object, ...)
## S3 method for class 'fit_yjt_scaled'
logLik(object, ...)
## S3 method for class 'fit_yjt_scaled'
summary(object, digits=4, file=NULL, ...)
## S3 method for class 'fit_yjt_scaled'
vcov(object, ...)

# Box-Cox transformation and its inverse transformation
bc_trafo(y, lambda)
bc_antitrafo(y, lambda)

#---- scaled t distribution with Box-Cox transformation
dbct_scaled(x, location=0, shape=1, lambda=1, df=Inf, log=FALSE, check_zero=TRUE)
rbct_scaled(n, location=0, shape=1, lambda=1, df=Inf)

fit_bct_scaled(x, df=Inf, par_init=NULL, lambda_fixed=NULL, weights=NULL)
## S3 method for class 'fit_bct_scaled'
coef(object, ...)
## S3 method for class 'fit_bct_scaled'
logLik(object, ...)
## S3 method for class 'fit_bct_scaled'
summary(object, digits=4, file=NULL, ...)
## S3 method for class 'fit_bct_scaled'
vcov(object, ...)

#---- scaled t distribution
dt_scaled(x, location=0, shape=1, df=Inf, log=FALSE)
rt_scaled(n, location=0, shape=1, df=Inf)

fit_t_scaled(x, df=Inf, par_init=NULL, weights=NULL)
## S3 method for class 'fit_t_scaled'
coef(object, ...)
## S3 method for class 'fit_t_scaled'
logLik(object, ...)
## S3 method for class 'fit_t_scaled'
summary(object, digits=4, file=NULL, ...)
## S3 method for class 'fit_t_scaled'
vcov(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>Numeric vector
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>

<p>Transformation parameter <code class="reqn">\lambda</code> for Yeo-Johnson transformation
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_rcpp</code></td>
<td>
<p>Logical indicating whether <span class="pkg">Rcpp</span> package should be used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probit</code></td>
<td>
<p>Logical indicating whether probit transformation should be
applied for bounded variables on <code class="reqn">(0,1)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Numeric vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>location</code></td>
<td>
<p>Location parameter of (transformed) scaled <code class="reqn">t</code> distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape</code></td>
<td>
<p>Shape parameter of (transformed) scaled <code class="reqn">t</code> distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>Degrees of freedom of (transformed) scaled <code class="reqn">t</code> distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>Logical indicating whether logarithm of the density should be
computed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check_zero</code></td>
<td>
<p>Logical indicating whether check for inadmissible values
should be conducted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of observations to be simulated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par_init</code></td>
<td>
<p>Optional vector of initial parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda_fixed</code></td>
<td>
<p>Optional value for fixed <code class="reqn">\lambda</code> parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Optional vector of sampling weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>Object of class <code>fit_yjt_scaled</code> or <code>fit_t_scaled</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>Number of digits used for rounding in <code>summary</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>File name for the <code>summary</code> to be sunk into</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Let <code class="reqn">g_\lambda</code> be the Yeo-Johnson transformation. A random variable <code class="reqn">X</code>
is distribution as Scaled <code class="reqn">t</code> with Yeo-Johnson transformation with location
<code class="reqn">\mu</code>, scale <code class="reqn">\sigma</code> and transformation parameter <code class="reqn">\lambda</code>
iff <code class="reqn">X=g_\lambda ( \mu + \sigma Z ) </code> and <code class="reqn">Z</code> is <code class="reqn">t</code> distributed
with <code>df</code> degrees of freedom.
</p>
<p>For a bounded variable <code class="reqn">X</code> on <code class="reqn">(0,1)</code>, the probit transformation <code class="reqn">\Phi</code>
is applied such that <code class="reqn">X=\Phi( g_\lambda ( \mu + \sigma Z ) ) </code> with a <code class="reqn">t</code>
distributed variable <code class="reqn">Z</code>.
</p>
<p>For a Yeo-Johnson normally distributed variable, a normally distributed variable results in
case of <code class="reqn">\lambda=1</code>. For a Box-Cox normally distributed variable, a normally
distributed variable results for <code class="reqn">\lambda=1</code>.
</p>


<h3>Value</h3>

<p>Vector or an object of fitted distribution depending on the called function
</p>


<h3>References</h3>

<p>Sakia, S. M. (1992). The Box-Cox transformation technique: A review.
<em>The Statistician, 41</em>(2), 169-178.
<a href="https://doi.org/10.2307/2348250">doi:10.2307/2348250</a>
</p>
<p>Yeo, I.-K., &amp; Johnson, R. (2000). A new family of power transformations to
improve normality or symmetry. <em>Biometrika, 87</em>(4), 954-959.
<a href="https://doi.org/10.1093/biomet/87.4.954">doi:10.1093/biomet/87.4.954</a>
</p>


<h3>See Also</h3>

<p>See <code>yjt_regression</code> for fitting a regression model in which
the response variable is distributed according to the scaled <code class="reqn">t</code>
distribution with Yeo-Johnson transformation.
</p>
<p>See <code>car::yjPower</code> for fitting the Yeo-Johnson
transformation in the <span class="pkg">car</span> package. See <code>car::bcPower</code> for the
Box-Cox transformation.
</p>
<p>The scaled <code class="reqn">t</code> distribution can be also found in
<code>metRology::dt.scaled</code> (<span class="pkg">metRology</span> package).
</p>
<p>See <code>stats::dt</code> for the <code class="reqn">t</code> distribution.
</p>
<p>See the <span class="pkg">fitdistrplus</span> package or the general
<code>stats4::mle</code> function
for fitting several distributions in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#############################################################################
# EXAMPLE 1: Transforming values according to Yeo-Johnson transformation
#############################################################################

# vector of y values
y &lt;- seq(-3,3, len=100)

# non-negative lambda values
plot( y, mdmb::yj_trafo( y, lambda=1 ), type="l", ylim=8*c(-1,1),
           ylab=expression( g[lambda] (y) ) )
lines( y, mdmb::yj_trafo( y, lambda=2 ), lty=2 )
lines( y, mdmb::yj_trafo( y, lambda=.5 ), lty=3 )
lines( y, mdmb::yj_trafo( y, lambda=0 ), lty=4 )

# non-positive lambda values
plot( y, mdmb::yj_trafo( y, lambda=-1 ), type="l", ylim=8*c(-1,1),
           ylab=expression(g[lambda] (y) ) )
lines( y, mdmb::yj_trafo( y, lambda=-2 ), lty=2 )
lines( y, mdmb::yj_trafo( y, lambda=-.5 ), lty=3 )
lines( y, mdmb::yj_trafo( y, lambda=0 ), lty=4 )

## Not run: 
#############################################################################
# EXAMPLE 2: Density of scaled t distribution
#############################################################################

# define location and scale parameter
m0 &lt;- 0.3
sig &lt;- 1.5
#-- compare density of scaled t distribution with large degrees of freedom
#   with normal distribution
y1 &lt;- mdmb::dt_scaled( y, location=m0, shape=sig, df=100 )
y2 &lt;- stats::dnorm( y, mean=m0, sd=sig )
max(abs(y1-y2))

#############################################################################
# EXAMPLE 3: Simulating and fitting the scaled t distribution
#############################################################################

#-- simulate data with 10 degrees of freedom
set.seed(987)
df0 &lt;- 10    # define degrees of freedom
x &lt;- mdmb::rt_scaled( n=1E4, location=m0, shape=sig, df=df0 )
#** fit data with df=10 degrees of freedom
fit1 &lt;- mdmb::fit_t_scaled(x=x, df=df0 )
#** compare with fit from normal distribution
fit2 &lt;- mdmb::fit_t_scaled(x=x, df=Inf )  # df=Inf is the default

#-- some comparisons
coef(fit1)
summary(fit1)
logLik(fit1)
AIC(fit1)
AIC(fit2)

#############################################################################
# EXAMPLE 4: Simulation and fitting of scaled t distribution with
#            Yeo-Johnson transformation
#############################################################################

# define parameters of transformed scaled t distribution
m0 &lt;- .5
sig &lt;- 1.5
lam &lt;- .5

# evaluate density
x &lt;- seq( -5, 5, len=100 )
y &lt;- mdmb::dyjt_scaled( x, location=m0, shape=sig, lambda=lam )
graphics::plot( x, y, type="l")

# transform original values
mdmb::yj_trafo( y=x, lambda=lam )

#** simulate data
set.seed(987)
x &lt;- mdmb::ryjt_scaled(n=3000, location=m0, shape=sig, lambda=lam )
graphics::hist(x, breaks=30)

#*** Model 1: Fit data with lambda to be estimated
fit1 &lt;- mdmb::fit_yjt_scaled(x=x)
summary(fit1)
coef(fit1)

#*** Model 2: Fit data with lambda fixed to simulated lambda
fit2 &lt;- mdmb::fit_yjt_scaled(x=x, lambda_fixed=lam)
summary(fit2)
coef(fit2)

#*** Model 3: Fit data with lambda fixed to 1
fit3 &lt;- mdmb::fit_yjt_scaled(x=x, lambda_fixed=1)

#-- compare log-likelihood values
logLik(fit1)
logLik(fit2)
logLik(fit3)

#############################################################################
# EXAMPLE 5: Approximating the chi square distribution
#            with yjt and bct distribution
#############################################################################

#-- simulate data
set.seed(987)
n &lt;- 3000
df0 &lt;- 5
x &lt;- stats::rchisq( n=n, df=df0 )

#-- plot data
graphics::hist(x, breaks=30)

#-- fit data with yjt distribution
fit1 &lt;- mdmb::fit_yjt_scaled(x)
summary(fit1)
c1 &lt;- coef(fit1)

#-- fit data with bct distribution
fit2 &lt;- mdmb::fit_bct_scaled(x)
summary(fit2)
c2 &lt;- coef(fit2)
# compare log-likelihood values
logLik(fit1)
logLik(fit2)

#-- plot chi square distribution and approximating yjt distribution
y &lt;- seq( .01, 3*df0, len=100 )
dy &lt;- stats::dchisq( y, df=df0 )
graphics::plot( y, dy, type="l", ylim=c(0, max(dy) )*1.1 )
# approximation with scaled t distribution and Yeo-Johnson transformation
graphics::lines( y, mdmb::dyjt_scaled(y, location=c1[1], shape=c1[2], lambda=c1[3]),
                     lty=2)
# approximation with scaled t distribution and Box-Cox transformation
graphocs::lines( y, mdmb::dbct_scaled(y, location=c2[1], shape=c2[2], lambda=c2[3]),
                     lty=3)
# appoximating normal distribution
graphics::lines( y, stats::dnorm( y, mean=df0, sd=sqrt(2*df0) ), lty=4)
graphics::legend( .6*max(y), .9*max(dy), c("chi square", "yjt", "bct", "norm"),
                     lty=1:4)

#############################################################################
# EXAMPLE 6: Bounded variable on (0,1) with Probit Yeo-Johnson transformation
#############################################################################

set.seed(876)
n &lt;- 1000
x &lt;- stats::rnorm(n)
y &lt;- stats::pnorm( 1*x + stats::rnorm(n, sd=sqrt(.5) ) )
dat &lt;- data.frame( y=y, x=x )

#*** fit Probit Yeo-Johnson distribution
mod1 &lt;- mdmb::fit_yjt_scaled(x=y, probit=TRUE)
summary(mod1)

#*** estimation using regression model
mod2 &lt;- mdmb::yjt_regression( y ~ x, data=dat, probit=TRUE )
summary(mod2)

## End(Not run)
</code></pre>


</div>