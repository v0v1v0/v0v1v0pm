<div class="container">

<table style="width: 100%;"><tr>
<td>cohesionclass</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate the cohesion of samples for each network</h2>

<h3>Description</h3>

<p>The cohesion is a method for quantifying the connectivity of microbial communities &lt;doi:10.1038/ismej.2017.91&gt;.
It is defined:
</p>
<p style="text-align: center;"><code class="reqn">C_{j}^{pos} = \sum_{i=1}^{n} a_{i} \cdot \bar{r_{i}}_{|r&gt;0}</code>
</p>

<p style="text-align: center;"><code class="reqn">C_{j}^{neg} = \sum_{i=1}^{n} a_{i} \cdot \bar{r_{i}}_{|r&lt;0}</code>
</p>

<p>where <code class="reqn">C_{j}^{pos}</code> is the positive cohesion, and <code class="reqn">C_{j}^{neg}</code> is the negative cohesion.
<code class="reqn">a_{i}</code> is the relative abundance of species i in sample j.
<code class="reqn">\bar{r_{i}}_{|r&gt;0}</code> denotes the mean weight (correlation coefficient, interaction strength) of all the edges (related with species i) with positive association.
</p>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-cohesionclass-new"><code>cohesionclass$new()</code></a>
</p>
</li>
<li> <p><a href="#method-cohesionclass-cal_diff"><code>cohesionclass$cal_diff()</code></a>
</p>
</li>
<li> <p><a href="#method-cohesionclass-plot"><code>cohesionclass$plot()</code></a>
</p>
</li>
<li> <p><a href="#method-cohesionclass-clone"><code>cohesionclass$clone()</code></a>
</p>
</li>
</ul>
<hr>
<a id="method-cohesionclass-new"></a>



<h4>Method <code>new()</code>
</h4>



<h5>Usage</h5>

<div class="r"><pre>cohesionclass$new(network_list)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>network_list</code></dt>
<dd>
<p>a list with multiple networks; all the networks should be <code>trans_network</code> object 
created from <code>trans_network</code> class of microeco package.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p><code>res_list</code>, stored in the object.
It includes two tables: res_feature and res_sample. In res_feature, the r_pos and r_neg columns mean the <code class="reqn">\bar{r_{i}}_{|r&gt;0}</code> and <code class="reqn">\bar{r_{i}}_{|r&lt;0}</code>.
In res_sample, the c_pos and c_neg columns denote <code class="reqn">C_{j}^{pos}</code> and <code class="reqn">C_{j}^{neg}</code>.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>t1 &lt;- cohesionclass$new(soil_amp_network)

</pre>
</div>


<hr>
<a id="method-cohesionclass-cal_diff"></a>



<h4>Method <code>cal_diff()</code>
</h4>

<p>Differential test.
</p>


<h5>Usage</h5>

<div class="r"><pre>cohesionclass$cal_diff(
  measure = "c_pos",
  method = c("anova", "KW", "KW_dunn", "wilcox", "t.test")[1],
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>measure</code></dt>
<dd>
<p>default "c_pos"; "c_pos" or "c_neg" in the <code>res_list$sample</code>; "r_pos" or "r_neg" in the <code>res_list$feature</code>.</p>
</dd>
<dt><code>method</code></dt>
<dd>
<p>default "anova"; see the following available options:
</p>

<dl>
<dt><strong>'anova'</strong></dt>
<dd>
<p>Duncan's multiple range test for anova</p>
</dd>
<dt><strong>'KW'</strong></dt>
<dd>
<p>KW: Kruskal-Wallis Rank Sum Test for all groups (&gt;= 2)</p>
</dd>
<dt><strong>'KW_dunn'</strong></dt>
<dd>
<p>Dunn's Kruskal-Wallis Multiple Comparisons, see <code>dunnTest</code> function in <code>FSA</code> package</p>
</dd>
<dt><strong>'wilcox'</strong></dt>
<dd>
<p>Wilcoxon Rank Sum and Signed Rank Tests for all paired groups </p>
</dd>
<dt><strong>'t.test'</strong></dt>
<dd>
<p>Student's t-Test for all paired groups</p>
</dd>
</dl>
</dd>
<dt><code>...</code></dt>
<dd>
<p>parameters passed to <code>cal_diff</code> function of <code>trans_alpha</code> class of <code>microeco</code> package.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p><code>res_diff</code> in object. See the Return of <code>cal_diff</code> function in <code>trans_alpha</code> class of <code>microeco</code> package.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>\donttest{
t1$cal_diff(method = "wilcox")
}
</pre>
</div>


<hr>
<a id="method-cohesionclass-plot"></a>



<h4>Method <code>plot()</code>
</h4>

<p>Plot the result.
</p>


<h5>Usage</h5>

<div class="r"><pre>cohesionclass$plot(measure = "c_pos", ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>measure</code></dt>
<dd>
<p>default "c_pos"; "c_pos" or "c_neg" in the <code>res_list$sample</code>; "r_pos" or "r_neg" in the <code>res_list$feature</code>.</p>
</dd>
<dt><code>...</code></dt>
<dd>
<p>parameters pass to <code>plot_alpha</code> function of <code>trans_alpha</code> class of <code>microeco</code> package.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p><code>ggplot</code>.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>\donttest{
t1$plot(boxplot_add = "none", add_sig = TRUE)
}
</pre>
</div>


<hr>
<a id="method-cohesionclass-clone"></a>



<h4>Method <code>clone()</code>
</h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>cohesionclass$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt>
<dd>
<p>Whether to make a deep clone.</p>
</dd>
</dl>
</div>




<h3>Examples</h3>

<pre><code class="language-R">
## ------------------------------------------------
## Method `cohesionclass$new`
## ------------------------------------------------

t1 &lt;- cohesionclass$new(soil_amp_network)


## ------------------------------------------------
## Method `cohesionclass$cal_diff`
## ------------------------------------------------


t1$cal_diff(method = "wilcox")


## ------------------------------------------------
## Method `cohesionclass$plot`
## ------------------------------------------------


t1$plot(boxplot_add = "none", add_sig = TRUE)

</code></pre>


</div>