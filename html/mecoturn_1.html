<div class="container">

<table style="width: 100%;"><tr>
<td>betaturn</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Analyze the 'turnover' of microbial communities.</h2>

<h3>Description</h3>

<p>Analyze the 'turnover' of microbial communities, i.e. beta-diversity along a gradient &lt;doi:10.1111/j.1461-0248.2010.01552.x&gt;.
The workflow consists of the steps of dissimilarity matrix generation, matrix conversion, differential test and visualization.
</p>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-betaturn-new"><code>betaturn$new()</code></a>
</p>
</li>
<li> <p><a href="#method-betaturn-cal_group_distance"><code>betaturn$cal_group_distance()</code></a>
</p>
</li>
<li> <p><a href="#method-betaturn-cal_group_distance_diff"><code>betaturn$cal_group_distance_diff()</code></a>
</p>
</li>
<li> <p><a href="#method-betaturn-plot_group_distance"><code>betaturn$plot_group_distance()</code></a>
</p>
</li>
<li> <p><a href="#method-betaturn-clone"><code>betaturn$clone()</code></a>
</p>
</li>
</ul>
<hr>
<a id="method-betaturn-new"></a>



<h4>Method <code>new()</code>
</h4>



<h5>Usage</h5>

<div class="r"><pre>betaturn$new(
  dataset,
  measure = "bray",
  filter_thres = 0,
  abundance.weighted = TRUE,
  null.model = NULL,
  runs = 1000,
  iterations = 1000,
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>dataset</code></dt>
<dd>
<p>the object of <code>microtable</code> class.</p>
</dd>
<dt><code>measure</code></dt>
<dd>
<p>default "bray"; beta diversity dissimilarity metric; 
must be one of <code>c("bray", "jaccard", "wei_unifrac", "unwei_unifrac", "betaMPD", "betaMNTD", "betaNRI", "betaNTI", "ses_UniFrac", "RCbray")</code>
or other options in parameter <code>method</code> of <code>vegan::vegdist</code> function.
If the distance matrix has been in the beta_diversity list of microtable object, 
the function can ignore this step. Otherwise, the function can generate the corresponding beta diversity distance matrix in the microtable object.
bray: Bray-Curtis; RCbray: Raupâ€“Crick based Bray-Curtis; wei_unifrac: weighted UniFrac; ses_UniFrac: standardized deviation of UniFrac.</p>
</dd>
<dt><code>filter_thres</code></dt>
<dd>
<p>default 0; the relative abundance threshold used to filter features with low abundance.</p>
</dd>
<dt><code>abundance.weighted</code></dt>
<dd>
<p>default TRUE; whether use abundance-weighted method for the phylogenetic metrics.</p>
</dd>
<dt><code>null.model</code></dt>
<dd>
<p>default NULL; one of <code>c("taxa.labels", "richness", "frequency", "sample.pool", "phylogeny.pool", "independentswap", "trialswap")</code>,
in which "taxa.labels" can only be used for phylogenetic analysis. 
See <code>null.model</code> parameter of <code>ses.mntd</code> function in <code>picante</code> package for the algorithm details.</p>
</dd>
<dt><code>runs</code></dt>
<dd>
<p>default 1000; simulation number of times for null model.</p>
</dd>
<dt><code>iterations</code></dt>
<dd>
<p>default 1000; iteration number for part null models to perform; see iterations parameter of <code>picante::randomizeMatrix</code> function.</p>
</dd>
<dt><code>...</code></dt>
<dd>
<p>parameters passed to <code>cal_betadiv</code> function of <code>microtable</code> class when provided measure is not in the current vector;
parameters passed to <code>cal_betamntd</code> function of <code>trans_nullmodel</code> class when <code>measure = "betaMNTD"</code>;
parameters passed to <code>cal_ses_betamntd</code> function of <code>trans_nullmodel</code> class when <code>measure = "betaNTI"</code>.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p><code>dataset</code>, stored in the object. The new dataset has a beta_diversity list and the calculated distance matrix in the list.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>data(wheat_16S)
b1 &lt;- betaturn$new(wheat_16S, measure = "bray")
</pre>
</div>


<hr>
<a id="method-betaturn-cal_group_distance"></a>



<h4>Method <code>cal_group_distance()</code>
</h4>

<p>Convert sample distances within groups or between groups.
</p>


<h5>Usage</h5>

<div class="r"><pre>betaturn$cal_group_distance(
  group,
  within_group = TRUE,
  by_group = NULL,
  ordered_group = NULL,
  sep = " vs ",
  add_cols = NULL
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>group</code></dt>
<dd>
<p>one colname of sample_table in <code>microtable</code> object used for group distance convertion.</p>
</dd>
<dt><code>within_group</code></dt>
<dd>
<p>default TRUE; whether transform sample distance within groups? If FALSE, transform sample distances between any two groups.</p>
</dd>
<dt><code>by_group</code></dt>
<dd>
<p>default NULL; one colname of sample_table in <code>microtable</code> object.
If provided, convert distances according to the provided by_group parameter. This is especially useful for ordering and filtering values further.
When <code>within_group = TRUE</code>, the result of by_group parameter is the format of paired groups.
When <code>within_group = FALSE</code>, the result of by_group parameter is the format same with the group information in <code>sample_table</code>.</p>
</dd>
<dt><code>ordered_group</code></dt>
<dd>
<p>default NULL; a vector representing the ordered elements of <code>group</code> parameter; only useful when within_group = FALSE.</p>
</dd>
<dt><code>sep</code></dt>
<dd>
<p>default TRUE; a character string to separate the group names after merging them into a new name.</p>
</dd>
<dt><code>add_cols</code></dt>
<dd>
<p>default NULL; add several columns of sample_table to the final <code>res_group_distance</code> table according to the <code>by_group</code> column; 
invoked only when <code>within_group = FALSE</code>.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p><code>res_group_distance</code> stored in object.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>b1$cal_group_distance(group = "Type", within_group = FALSE, by_group = "Plant_ID")
</pre>
</div>


<hr>
<a id="method-betaturn-cal_group_distance_diff"></a>



<h4>Method <code>cal_group_distance_diff()</code>
</h4>

<p>Differential test of distances among groups.
</p>


<h5>Usage</h5>

<div class="r"><pre>betaturn$cal_group_distance_diff(...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>...</code></dt>
<dd>
<p>parameters passed to <code>cal_group_distance_diff</code> function of <code>trans_beta</code> class.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p><code>res_group_distance_diff</code> stored in object.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>b1$cal_group_distance_diff(method = "wilcox")
</pre>
</div>


<hr>
<a id="method-betaturn-plot_group_distance"></a>



<h4>Method <code>plot_group_distance()</code>
</h4>

<p>Plot the distance between samples within or between groups.
</p>


<h5>Usage</h5>

<div class="r"><pre>betaturn$plot_group_distance(...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>...</code></dt>
<dd>
<p>parameters passed to <code>plot_group_distance</code> function of <code>trans_beta</code> class.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p><code>ggplot</code>.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>b1$plot_group_distance()
</pre>
</div>


<hr>
<a id="method-betaturn-clone"></a>



<h4>Method <code>clone()</code>
</h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>betaturn$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt>
<dd>
<p>Whether to make a deep clone.</p>
</dd>
</dl>
</div>




<h3>Examples</h3>

<pre><code class="language-R">
## ------------------------------------------------
## Method `betaturn$new`
## ------------------------------------------------

data(wheat_16S)
b1 &lt;- betaturn$new(wheat_16S, measure = "bray")

## ------------------------------------------------
## Method `betaturn$cal_group_distance`
## ------------------------------------------------

b1$cal_group_distance(group = "Type", within_group = FALSE, by_group = "Plant_ID")

## ------------------------------------------------
## Method `betaturn$cal_group_distance_diff`
## ------------------------------------------------

b1$cal_group_distance_diff(method = "wilcox")

## ------------------------------------------------
## Method `betaturn$plot_group_distance`
## ------------------------------------------------

b1$plot_group_distance()
</code></pre>


</div>