<div class="container">

<table style="width: 100%;"><tr>
<td>extract_entities</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract Medication Entities From Phrase</h2>

<h3>Description</h3>

<p>This function searches a phrase for medication dosing entities of interest. It
is called within <code>medExtractR</code> and generally not intended for use outside
that function. The <code>phrase</code> argument containing text to search corresponds to an
individual mention of the drug of interest.
</p>


<h3>Usage</h3>

<pre><code class="language-R">extract_entities(
  phrase,
  p_start,
  p_stop,
  unit,
  frequency_fun = NULL,
  intaketime_fun = NULL,
  duration_fun = NULL,
  route_fun = NULL,
  strength_sep = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phrase</code></td>
<td>
<p>Text to search.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_start</code></td>
<td>
<p>Start position of phrase within original text.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_stop</code></td>
<td>
<p>End position of phrase within original text.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unit</code></td>
<td>
<p>Unit of measurement for medication strength, e.g. ‘mg’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frequency_fun</code></td>
<td>
<p>Function used to extract frequency.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intaketime_fun</code></td>
<td>
<p>Function used to extract intake time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>duration_fun</code></td>
<td>
<p>Function used to extract duration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>route_fun</code></td>
<td>
<p>Function used to extract route.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strength_sep</code></td>
<td>
<p>Delimiter for contiguous medication strengths.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Parameter settings used in extracting frequency and intake time,
including additional arguments to the <code>&lt;entity&gt;_fun</code> arguments. Use <code>frequency_dict</code>,
<code>intaketime_dict</code>, <code>duration_dict</code>, and <code>route_dict</code> to identify
custom frequency, intake time, duration, and route dictionaries, respectively.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Various medication dosing entities are extracted within this function
including the following:
</p>
<p><em>strength</em>: The amount of drug in a given dosage form (i.e., tablet, capsule).<br><em>dose amount</em>: The number of tablets, capsules, etc. taken at a given intake time.<br><em>dose strength</em>: The total amount of drug given intake. This quantity would be
equivalent to strength x dose amount, and appears similar to strength when
dose amount is absent.<br><em>frequency</em>: The number of times per day a dose is taken, e.g.,
“once daily” or ‘2x/day’.<br><em>intaketime</em>: The time period of the day during which a dose is taken,
e.g., ‘morning’, ‘lunch’, ‘in the pm’.<br><em>duration</em>: How long a patient is on a drug regimen, e.g., ‘2 weeks’,
‘mid-April’, ‘another 3 days’.<br><em>route</em>: The administration route of the drug, e.g., ‘by mouth’,
‘IV’, ‘topical’.<br></p>
<p>Note that extraction of the entities drug name, dose change, and time of last dose are not
handled by the <code>extract_entities</code> function. Those entities are extracted separately
and appended to the <code>extract_entities</code> output within the main <code>medExtractR</code> function.
Strength, dose amount, and dose strength are primarily numeric quantities, and are identified
using a combination of regular expressions and rule-based approaches. Frequency, intake time,
route, and duration, on the other hand, use dictionaries for identification.
</p>
<p>By default and when an argument <code>&lt;entity&gt;_fun</code> is <code>NULL</code>, the
<code>extract_generic</code> function will be used to extract that entity. This function
can also inherit user-defined entity dictionaries, supplied as arguments <code>&lt;entity&gt;_dict</code>
to <code>medExtractR</code> or <code>medExtractR_tapering</code> (see documentation files for main function(s) for details).
</p>
<p>The <code>stength_sep</code> argument is <code>NULL</code> by default, but can be used to
identify shorthand for morning and evening doses. For example, consider the
phrase “Lamotrigine 300-200” (meaning 300 mg in the morning and 200 mg
in the evening). The argument <code>strength_sep = '-'</code> identifies
the full expression <em>300-200</em> as <em>dose strength</em> in this phrase.
</p>


<h3>Value</h3>

<p>data.frame with entities information. At least one row per entity is returned,
using <code>NA</code> when no expression was found for a given entity.<br>
The “entity” column of the output contains the formatted label for that entity, according to
the following mapping.<br>
strength: “Strength”<br>
dose amount: “DoseAmt”<br>
dose strength: “DoseStrength”<br>
frequency: “Frequency”<br>
intake time: “IntakeTime”<br>
duration: “Duration”<br>
route: “Route”<br>
Sample output for the phrase “Lamotrigine 200mg bid” would look like:<br></p>

<table>
<tr>
<td style="text-align: right;">
 entity   </td>
<td style="text-align: right;">  expr</td>
</tr>
<tr>
<td style="text-align: right;">
 IntakeTime  </td>
<td style="text-align: right;">  &lt;NA&gt;</td>
</tr>
<tr>
<td style="text-align: right;">
 Strength  </td>
<td style="text-align: right;">   &lt;NA&gt;</td>
</tr>
<tr>
<td style="text-align: right;">
 DoseAmt   </td>
<td style="text-align: right;">  &lt;NA&gt;</td>
</tr>
<tr>
<td style="text-align: right;">
 Route   </td>
<td style="text-align: right;">  &lt;NA&gt;</td>
</tr>
<tr>
<td style="text-align: right;">
 Duration   </td>
<td style="text-align: right;">  &lt;NA&gt;</td>
</tr>
<tr>
<td style="text-align: right;">
 Frequency </td>
<td style="text-align: right;">  bid;19:22</td>
</tr>
<tr>
<td style="text-align: right;">
 DoseStrength  </td>
<td style="text-align: right;">  200mg;13:18
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">note &lt;- "Lamotrigine 25 mg tablet - 3 tablets oral twice daily"
extract_entities(note, 1, nchar(note), "mg")
# A user-defined dictionary can be used instead of the default
my_dictionary &lt;- data.frame(c("daily", "twice daily"))
extract_entities(note, 1, 53, "mg", frequency_dict = my_dictionary)
</code></pre>


</div>