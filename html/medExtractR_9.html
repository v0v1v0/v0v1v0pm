<div class="container">

<table style="width: 100%;"><tr>
<td>extract_entities_tapering</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract Medication Entities From Phrase - Extension of <code>extract_entities</code> for Tapering application</h2>

<h3>Description</h3>

<p>This function searches a phrase for medication dosing entities of interest. It
is called within <code>medExtractR_tapering</code> and generally not intended for use outside
that function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">extract_entities_tapering(
  phrase,
  p_start,
  d_stop,
  unit,
  frequency_fun = NULL,
  intaketime_fun = NULL,
  duration_fun = NULL,
  route_fun = NULL,
  doseschedule_fun = NULL,
  preposition_fun = NULL,
  timekeyword_fun = NULL,
  transition_fun = NULL,
  dosechange_fun = NULL,
  strength_sep = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phrase</code></td>
<td>
<p>Text to search.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_start</code></td>
<td>
<p>Start position of phrase within original text.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d_stop</code></td>
<td>
<p>End position of drug name within original text.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unit</code></td>
<td>
<p>Unit of measurement for medication strength, e.g., ‘mg’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frequency_fun</code></td>
<td>
<p>Function used to extract frequency.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intaketime_fun</code></td>
<td>
<p>Function used to extract intake time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>duration_fun</code></td>
<td>
<p>Function used to extract duration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>route_fun</code></td>
<td>
<p>Function used to extract route.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>doseschedule_fun</code></td>
<td>
<p>Function used to extract dose schedule.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>preposition_fun</code></td>
<td>
<p>Function used to extract preposition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timekeyword_fun</code></td>
<td>
<p>Function used to extract time keyword.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transition_fun</code></td>
<td>
<p>Function used to extract transition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dosechange_fun</code></td>
<td>
<p>Function used to extract dose change.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strength_sep</code></td>
<td>
<p>Delimiter for contiguous medication strengths.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Parameter settings used in extracting frequency and intake time,
including additional arguments to <code>frequency_fun</code> and
<code>intaketime_fun</code>. Use <code>frequency_dict</code> to identify custom frequency
dictionaries and <code>intaketime_dict </code> to identify custom intake time
dictionaries. Similarly, for all other entities with a corresponding <code>&lt;entity&gt;_fun</code>,
a custom dictionary can be supplied with the argument <code>&lt;entity&gt;_dict</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Various medication dosing entities are extracted within this function
including the following:
</p>
<p><em>strength</em>: The amount of drug in a given dosage form (i.e., tablet, capsule).<br><em>dose amount</em>: The number of tablets, capsules, etc. taken at a given intake time.<br><em>dose strength</em>: The total amount of drug given intake. This quantity would be
equivalent to strength x dose amount, and appears similar to strength when
dose amount is absent.<br><em>frequency</em>: The number of times per day a dose is taken, e.g.,
“once daily” or ‘2x/day’.<br><em>intaketime</em>: The time period of the day during which a dose is taken,
e.g., ‘morning’, ‘lunch’, ‘in the pm’.<br><em>duration</em>: How long a patient is on a drug regimen, e.g., ‘2 weeks’,
‘mid-April’, ‘another 3 days’.<br><em>route</em>: The administration route of the drug, e.g., ‘by mouth’,
‘IV’, ‘topical’.<br><em>dose change</em>: Whether the dosage of the drug was changed, e.g.,
‘increase’, ‘adjust’, ‘reduce’.<br><em>dose schedule</em>: Keywords which represent special dosing regimens, such as tapering
schedules, alternating doses, or stopping keywords, e.g., ‘weaning’,
‘even days’ or ‘odd_days’, ‘discontinue’.<br><em>time keyword</em>: Whether the dosing regimen is a past dose, current dose,
or future dose, e.g., ‘currently’, ‘remain’, ‘yesterday’.<br><em>transition</em>: Words or symbols that link consecutive doses of a tapering
regimen, e.g., ‘then’, ‘followed by’, or a comma ‘,’.<br><em>preposition</em>: Prepositions that occur immediately next to another
identified entity, e.g., ‘to’, ‘until’, ‘for’.<br><em>dispense amount</em>: The number of pills prescribed to the patient.<br><em>refill</em>: The number of refills allowed for the patient's prescription.<br></p>
<p>Similar to the basic implementation, drug name and and time of last dose are not
handled by the <code>extract_entities_tapering</code> function. Those entities are extracted separately
and appended to the <code>extract_entities_tapering</code> output within the main <code>medExtractR_tapering</code>
function. In the tapering extension, however, dose change is treated the same as other dictionary-based
entities and extracted within <code>extract_entities_tapering</code>. Strength, dose amount, dose strength, dispense amount,
and refill are primarily numeric quantities, and are identified using a combination of
regular expressions and rule-based approaches. All other entities use dictionaries for
identification. For more information about the default dictionary for a specific entity,
view the documentation file for the object <code>&lt;entity&gt;_vals</code>.
</p>
<p>By default and when an argument <code>&lt;entity&gt;_fun</code> is <code>NULL</code>, the
<code>extract_generic</code> function will be used to extract that entity. This function
can also inherit user-defined entity dictionaries for each entity, supplied as arguments <code>&lt;entity&gt;_dict</code>
to <code>medExtractR</code> or <code>medExtractR_tapering</code> (see documentation files for main function(s) for details).
</p>
<p>Note that <code>extract_entities_tapering</code> has the argument <code>d_stop</code>. This differs
from <code>extract_entities</code>, which uses the end position of the full search window. This
is a consequence of <code>medExtractR</code> using a fixed search window length and <code>medExtractR_tapering</code>
dynamically constructing a search window.
</p>


<h3>Value</h3>

<p>data.frame with entities information. At least one row per entity is returned,
using <code>NA</code> when no expression was found for a given entity.<br>
The “entity” column of the output contains the formatted label for that entity, according to
the following mapping.<br>
strength: “Strength”<br>
dose amount: “DoseAmt”<br>
dose strength: “DoseStrength”<br>
frequency: “Frequency”<br>
intake time: “IntakeTime”<br>
duration: “Duration”<br>
route: “Route”<br>
dose change: “DoseChange”<br>
dose schedule: “DoseScheule”<br>
time keyword: “TimeKeyword”<br>
transition: “Transition”<br>
preposition: “Preposition”<br>
dispense amount: “DispenseAmt”<br>
refill: “Refill”<br>
Sample output for the phrase “Lamotrigine 200mg bid for 14 days” would look like:<br></p>

<table>
<tr>
<td style="text-align: right;">
 entity   </td>
<td style="text-align: right;">  expr</td>
</tr>
<tr>
<td style="text-align: right;">
 IntakeTime  </td>
<td style="text-align: right;">  &lt;NA&gt;</td>
</tr>
<tr>
<td style="text-align: right;">
 Strength  </td>
<td style="text-align: right;">   &lt;NA&gt;</td>
</tr>
<tr>
<td style="text-align: right;">
 DoseAmt   </td>
<td style="text-align: right;">  &lt;NA&gt;</td>
</tr>
<tr>
<td style="text-align: right;">
 DoseChange   </td>
<td style="text-align: right;">  &lt;NA&gt;</td>
</tr>
<tr>
<td style="text-align: right;">
 DoseSchedule   </td>
<td style="text-align: right;">  &lt;NA&gt;</td>
</tr>
<tr>
<td style="text-align: right;">
 TimeKeyword   </td>
<td style="text-align: right;">  &lt;NA&gt;</td>
</tr>
<tr>
<td style="text-align: right;">
 Transition   </td>
<td style="text-align: right;">  &lt;NA&gt;</td>
</tr>
<tr>
<td style="text-align: right;">
 Preposition   </td>
<td style="text-align: right;">  &lt;NA&gt;</td>
</tr>
<tr>
<td style="text-align: right;">
 DispenseAmt   </td>
<td style="text-align: right;">  &lt;NA&gt;</td>
</tr>
<tr>
<td style="text-align: right;">
 Refill   </td>
<td style="text-align: right;">  &lt;NA&gt;</td>
</tr>
<tr>
<td style="text-align: right;">
 Frequency </td>
<td style="text-align: right;">  bid;19:22</td>
</tr>
<tr>
<td style="text-align: right;">
 DoseStrength  </td>
<td style="text-align: right;">  200mg;13:18</td>
</tr>
<tr>
<td style="text-align: right;">
 Preposition </td>
<td style="text-align: right;"> for;23:26</td>
</tr>
<tr>
<td style="text-align: right;">
 Duration </td>
<td style="text-align: right;"> 14 days;27:34
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">note &lt;- "prednisone 20mg daily tapering to 5mg daily over 2 weeks"
extract_entities_tapering(note, 1, 11, "mg")
# A user-defined dictionary can be used instead of the default
my_dictionary &lt;- data.frame(c("daily", "twice daily"))
extract_entities(note, 1, 11, "mg", frequency_dict = my_dictionary)
</code></pre>


</div>