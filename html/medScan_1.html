<div class="container">

<table style="width: 100%;"><tr>
<td>medScan</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Large Scale Single Mediator Hypothesis Testing</h2>

<h3>Description</h3>

<p>A collection of methods for large scale single mediator hypothesis
testing. The six included methods for testing the mediation effect are Sobel's
test, Max P test, joint significance test under the composite null hypothesis,
high dimensional mediation testing, divide-aggregate composite null test,
and Sobel's test under the composite null hypothesis. Du, J., Zhou, X., Hao, W.,
Liu, Y., Smith, J. A., &amp; Mukherjee, B. (2022). "Methods for Large-scale Single
Mediator Hypothesis Testing: Possible Choices and Comparisons."
</p>


<h3>Usage</h3>

<pre><code class="language-R">medScan(z.alpha, z.beta, method)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>z.alpha</code></td>
<td>
<p>the z-test statistic for alpha (exposure effect on the mediator).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z.beta</code></td>
<td>
<p>the z-test statistic for beta (mediator effect on the outcome).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the method to use for testing the mediation effect. It should
belong to one of the six methods: <code>"Sobel"</code>, <code>"MaxP"</code>, <code>"JT_comp"</code>, <code>"HDMT"</code>,
<code>"DACT"</code>, and <code>"Sobel_comp"</code>.
(1) Sobel’s test (<code>method = "Sobel"</code>), (2) Max P test
(<code>method = "MaxP"</code>), (3) joint significance test under the composite null hypothesis (<code>method = "JT_comp"</code>), (4) high
dimensional mediation testing (<code>method = "HDMT"</code>), (5) Divide-Aggregate Composite-null Test (<code>method = "DACT"</code>), and
(6) Sobel’s test under the composite null hypothesis (<code>method = "Sobel_comp"</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The available methods are:
(1) Sobel’s test (<code>method = "Sobel"</code>), (2) Max P test
(<code>method = "MaxP"</code>), (3) joint significance test under the composite null hypothesis (<code>method = "JT_comp"</code>), (4) high
dimensional mediation testing (<code>method = "HDMT"</code>), (5) Divide-Aggregate Composite-null Test (<code>method = "DACT"</code>), and
(6) Sobel’s test under the composite null hypothesis (<code>method = "Sobel_comp"</code>).
</p>
<p>We incorporated code from the DACT R package formerly on CRAN. Author: Zhonghua Liu
Maintainer: Zhonghua Liu, zhhliu@hku.hk.
</p>


<h3>Value</h3>

<p>A list that contains
</p>
<table>
<tr style="vertical-align: top;">
<td><code>pvalues:</code></td>
<td>
<p>p-values for all mediators from the chosen method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi:</code></td>
<td>
<p>the estimated proportions of the three null cases from the HDMT
method. pi00 is the proportion of alpha=beta=0; pi01 is the proportion of
alpha=0 and beta!=0; and pi10 is the proportion of alpha!=0 and beta=0.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Sobel, M. E. (1982). Asymptotic confidence intervals for indirect effects in structural equation models. Sociological methodology, 13, 290-312.
</p>
<p>MacKinnon, D. P., Lockwood, C. M., Hoffman, J. M., West, S. G., &amp; Sheets, V. (2002). A comparison of methods to test mediation and other intervening variable effects. Psychological methods, 7(1), 83.
</p>
<p>Huang, Y. T. (2019). Genome-wide analyses of sparse mediation effects under composite null hypotheses. The Annals of Applied Statistics, 13(1), 60-84.
</p>
<p>Liu, Z., Shen, J., Barfield, R., Schwartz, J., Baccarelli, A. A., &amp; Lin, X. (2022). Large-scale hypothesis testing for causal mediation effects with applications in genome-wide epigenetic studies. Journal of the American Statistical Association, 117(537), 67-81.
</p>
<p>Dai, J. Y., Stanford, J. L., &amp; LeBlanc, M. (2022). A multiple-testing procedure for high-dimensional mediation hypotheses. Journal of the American Statistical Association, 117(537), 198-213.
</p>
<p>Du, Jiacong, et al. "Methods for large‐scale single mediator hypothesis testing: Possible choices and comparisons." Genetic Epidemiology 47.2 (2023): 167-184.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># simulate data under the mixture null
n=10000
u = runif(n,0,1)
z.alpha = z.beta = rep(NA,0)
pi00 = 0.98
pi10 = 0.01
pi01 = 0.01
for(i in 1:n){
  if(u[i]&lt;=pi00){
    z.alpha[i] = rnorm(1, 0, 1)
    z.beta[i] = rnorm(1, 0, 1)
  } else if (u[i]&lt;= pi00+pi10){
    z.alpha[i] = rnorm(1, 1, 1)
    z.beta[i] = rnorm(1, 0, 1)
  } else {
    z.alpha[i] = rnorm(1, 0, 1)
    z.beta[i] = rnorm(1, 1, 1)
  }
}

# obtain p-values

# method = "Sobel", "MaxP", "HDMT", "Sobel_comp", "JT_comp", "DACT"
obj = medScan(z.alpha = z.alpha, z.beta = z.beta, method = "Sobel")
qqman::qq(obj$pvalues,  xlim = c(0,4), ylim = c(0,4), main = "Sobel")




</code></pre>


</div>