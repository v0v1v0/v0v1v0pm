<div class="container">

<table style="width: 100%;"><tr>
<td>mixnegbinom.em</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Expectation-Maximization Algorithm for the Mixture of Negative Binomial Distributions
</h2>

<h3>Description</h3>

<p>This function provides the empirical Bayes estimates for the parameters <code>theta</code> of a mixture of two negative binomial distributions (see <code>dmixnegbinom</code>) using an Expectation-Maximization algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mixnegbinom.em(dat, theta0, maxiter = 50000, toler = 0.01,
	se = TRUE, stratified = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>an object of class "mederrData".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta0</code></td>
<td>
<p>initial values for the parameters to be optimized over.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>a positive integer specifying the maximum number of iterations to be performed before the program is terminated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>toler</code></td>
<td>
<p>a positive scalar giving the tolerance at which the change in the log-likelihood is considered close enough to zero to terminate the algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>logical; if TRUE the standard errors of the estimates are also returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stratified</code></td>
<td>
<p>logical; if TRUE the analysis will be performed by stratifying on the hospitals.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For further details see Myers et al. (2011).
</p>


<h3>Value</h3>

<p><code>mixnegbinom.em</code> returns a list with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>theta.hat </code></td>
<td>
<p>The best set of parameters found.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>final.err </code></td>
<td>
<p>The last change in the log-likelihood; it has to be smaller than the <code>toler</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>final.ll </code></td>
<td>
<p>The likelihood value corresponding to <code>theta.hat</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>final.score </code></td>
<td>
<p>The log-likelihood score value corresponding to <code>theta.hat</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.iter </code></td>
<td>
<p>The number of iterations performed to find the proposed solution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se </code></td>
<td>
<p>Only if argument <code>se</code> is true. A vector of estimates standard errors for the solution found.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N </code></td>
<td>
<p>The vector of observed error profiles counts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E </code></td>
<td>
<p>The vector of expected error profiles counts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior </code></td>
<td>
<p>A character string giving the prior used; for this function is set to "mixgamma", i.e. a mixture of two gamma distributions as in DuMouchel (1999).</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Sergio Venturini <a href="mailto:sergio.venturini@unicatt.it">sergio.venturini@unicatt.it</a>, 
</p>
<p>Jessica A. Myers <a href="mailto:jmyers6@partners.org">jmyers6@partners.org</a>
</p>


<h3>References</h3>

<p>DuMouchel W. (1999), "Bayesian Data Mining in Large Frequency Tables, with an Application to the FDA Spontaneous Reporting System". The American Statistician, 53, 177-190.
</p>
<p>Myers, J. A., Venturini, S., Dominici, F. and Morlock, L. (2011), "Random Effects Models for Identifying the Most Harmful Medication Errors in a Large, Voluntary Reporting Database". Technical Report.
</p>


<h3>See Also</h3>

<p><code>dmixnegbinom</code>,
<code>EBGM</code>,
<code>negbinom.em</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data("simdata", package = "mederrRank")
summary(simdata)

fit &lt;- bhm.mcmc(simdata, nsim = 1000, burnin = 500, scale.factor = 1.1)
resamp &lt;- bhm.resample(fit, simdata, p.resample = .1,
	k = c(3, 6, 10, 30, 60, Inf), eta = c(.5, .8, 1, 1.25, 2))
fit2 &lt;- bhm.constr.resamp(fit, resamp, k = 3, eta = .8)
plot(fit, fit2, simdata)

theta0 &lt;- c(10, 6, 100, 100, .1)
ans &lt;- mixnegbinom.em(simdata, theta0, 50000, 0.01,
	se = TRUE, stratified = TRUE)
ans$theta
ans$se

summary(fit2, ans, simdata)
## End(Not run)
</code></pre>


</div>