<div class="container">

<table style="width: 100%;"><tr>
<td>bhm.constr.resamp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Markov Chain Monte Carlo Estimation (Step 2) of the Bayesian Hierarchical Model for Identifying the Most Harmful Medication Errors 
</h2>

<h3>Description</h3>

<p>This function represents the "constructor" function for the resampling procedure used in this package. <code>bhm.resample</code> calculates the importance ratios, and performs the sampling, and then this function constructs the resampled model based on that information.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bhm.constr.resamp(model, resample, k, eta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>an object of class "mederrFit".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resample</code></td>
<td>
<p>an object of class "mederrResample".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p><code class="reqn">k</code> (number of degrees of freedom) value to use in the resampling procedure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>
<p><code class="reqn">\eta</code> (skewing paramter) value to use in the resampling procedure.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Deviations from the normal, i.e. <code class="reqn">(k = \infty, \eta = 1)</code>, random effects distribution using a different pair of <code class="reqn">k</code> and <code class="reqn">\eta</code> values are considered. The methodology implemented here is the importance link function resampling approach introduce by MacEachern and Peruggia (2000): based on the <code class="reqn">(k = \infty, \eta = 1)</code> chain, new posterior samples under a new set of <code class="reqn">(k, \eta)</code> values is obtained.
</p>


<h3>Value</h3>

<p><code>bhm.constr.resamp</code> returns an object of the class "mederrFit".
</p>


<h3>Author(s)</h3>

<p>Sergio Venturini <a href="mailto:sergio.venturini@unicatt.it">sergio.venturini@unicatt.it</a>, 
</p>
<p>Jessica A. Myers <a href="mailto:jmyers6@partners.org">jmyers6@partners.org</a>
</p>


<h3>References</h3>

<p>MacEachern, S. and Peruggia, M. (2000), "Importance Link Function Estimation for Markov Chain Monte Carlo Methods", Journal of Computational and Graphical Statistics, 9, 99-121.
</p>
<p>Myers, J. A., Venturini, S., Dominici, F. and Morlock, L. (2011), "Random Effects Models for Identifying the Most Harmful Medication Errors in a Large, Voluntary Reporting Database". Technical Report.
</p>


<h3>See Also</h3>

<p><code>bhm.mcmc</code>,
<code>bhm.resample</code>,
<code>mederrData</code>,
<code>mederrFit</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data("simdata", package = "mederrRank")
summary(simdata)

fit &lt;- bhm.mcmc(simdata, nsim = 1000, burnin = 500, scale.factor = 1.1)
resamp &lt;- bhm.resample(fit, simdata, p.resample = .1,
	k = c(3, 6, 10, 30, 60, Inf), eta = c(.5, .8, 1, 1.25, 2))
fit2 &lt;- bhm.constr.resamp(fit, resamp, k = 3, eta = .8)
plot(fit, fit2, simdata)

theta0 &lt;- c(10, 6, 100, 100, .1)
ans &lt;- mixnegbinom.em(simdata, theta0, 50000, 0.01, se = TRUE,
	stratified = TRUE)

summary(fit2, ans, simdata)

## End(Not run)
</code></pre>


</div>