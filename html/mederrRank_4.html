<div class="container">

<table style="width: 100%;"><tr>
<td>bhm.mcmc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Markov Chain Monte Carlo Estimation (Step 1) of the Bayesian Hierarchical Model for Identifying the Most Harmful Medication Errors 
</h2>

<h3>Description</h3>

<p>This function implements the Markov Chain Monte Carlo estimation methodology for the Bayesian hierarchical model described in Myers et al. (2011).
</p>


<h3>Usage</h3>

<pre><code class="language-R">bhm.mcmc(dat, nsim = 2000, burnin = 500, scale.factor = 1,
	adaptive.int = 100, adaptive.max = 1000, prior = NULL,
	init = NULL, tuneD = NULL, tuneT = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>an object of class "mederrData".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>number of iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>number of burn-in iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.factor</code></td>
<td>
<p>scale factor of the random effects proposal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adaptive.int</code></td>
<td>
<p>iteration interval at which the standard error of the random effects proposal distribution is updated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adaptive.max</code></td>
<td>
<p>last iteration at which the standard error of the random effects proposal distribution is updated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>an optional list of the hyperparameters values; see the Details section below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>an optional list of initial values for the model parameters; see the Details section below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tuneD</code></td>
<td>
<p>an optional vector of the <code class="reqn">\delta_j</code> proposal distribution variances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tuneT</code></td>
<td>
<p>an optional vector of the <code class="reqn">\theta_i</code> proposal distribution variances.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Bayesian hierarchical model (with crossed random effects) implemented here for identifying the medication error profiles with the largest log odds of harm is
</p>
<p style="text-align: center;"><code class="reqn">y_{ij} | N_{ij}, p_{ij} \sim Bin(N_{ij},p_{ij})</code>
</p>

<p style="text-align: center;"><code class="reqn">logit(p_{ij}) = \gamma + \theta_i + \delta_j</code>
</p>

<p style="text-align: center;"><code class="reqn">\theta_i | \sigma, \eta, k \sim St(0,\sigma,k,\eta), \qquad i=1,\ldots,n</code>
</p>

<p style="text-align: center;"><code class="reqn">\delta_j | \tau^2 \sim N(0,\tau^2), \qquad j=1,\ldots,J</code>
</p>

<p style="text-align: center;"><code class="reqn">\gamma \sim N(g,G)</code>
</p>

<p style="text-align: center;"><code class="reqn">\sigma^2 \sim IG(a_1,b_1)</code>
</p>

<p style="text-align: center;"><code class="reqn">\tau^2 \sim IG(a_2,b_2)</code>
</p>

<p style="text-align: center;"><code class="reqn">k \sim Unif(0,\infty)</code>
</p>

<p style="text-align: center;"><code class="reqn">\eta \sim Unif(0,\infty),</code>
</p>

<p>where <code class="reqn">N_{ij}</code> denotes the number of times that the error profile <code class="reqn">i</code> is cited on a report from hospital j and <code class="reqn">y_{ij}</code> is the corresponding number of times that profile <code class="reqn">i</code> in hospital <code class="reqn">j</code> was reported with harm.
This function implements the first model estimation step in which the values <code class="reqn">k = \infty</code> and <code class="reqn">k = 1</code>, i.e. a symmetric normal distribution, is forced for the error profiles' random effects. A sample from the joint posterior distribution of all other parameters via Markov Chain Monte Carlo with adaptive Metropolis steps for each set of random effects is obtained. For more details see Myers et al. (2011).
</p>


<h3>Value</h3>

<p><code>bhm.mcmc</code> returns an object of the class "mederrFit".
</p>


<h3>Author(s)</h3>

<p>Sergio Venturini <a href="mailto:sergio.venturini@unicatt.it">sergio.venturini@unicatt.it</a>, 
</p>
<p>Jessica A. Myers <a href="mailto:jmyers6@partners.org">jmyers6@partners.org</a>
</p>


<h3>References</h3>

<p>Myers, J. A., Venturini, S., Dominici, F. and Morlock, L. (2011), "Random Effects Models for Identifying the Most Harmful Medication Errors in a Large, Voluntary Reporting Database". Technical Report.
</p>


<h3>See Also</h3>

<p><code>bhm.resample</code>,
<code>mederrData</code>,
<code>mederrFit</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data("simdata", package = "mederrRank")
summary(simdata)

fit &lt;- bhm.mcmc(simdata, nsim = 1000, burnin = 500, scale.factor = 1.1)
resamp &lt;- bhm.resample(fit, simdata, p.resample = .1,
	k = c(3, 6, 10, 30, 60, Inf), eta = c(.5, .8, 1, 1.25, 2))
fit2 &lt;- bhm.constr.resamp(fit, resamp, k = 3, eta = .8)
plot(fit, fit2, simdata)

theta0 &lt;- c(10, 6, 100, 100, .1)
ans &lt;- mixnegbinom.em(simdata, theta0, 50000, 0.01, se = TRUE,
	stratified = TRUE)

summary(fit2, ans, simdata)
## End(Not run)
</code></pre>


</div>