<div class="container">

<table style="width: 100%;"><tr>
<td>dmixnegbinom</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
The Negative Binomial Mixture Distribution
</h2>

<h3>Description</h3>

<p>Density function for a mixture of two negative binomial distributions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dmixnegbinom(x, theta, E, log.p = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector of (non-negative integer) quantiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>vector of parameters for the negative binomial distribution mixture.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E</code></td>
<td>
<p>vector of (non-negative integer) expected counts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.p</code></td>
<td>
<p>logical; if TRUE, probabilities p are given as log(p).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The mixture of two negative binomial distributions has density
</p>
<p style="text-align: center;"><code class="reqn">P(N = x) = theta[5] f(x;theta[1],theta[2],E) + (1 - theta[5]) f(x;theta[3],theta[4],E),</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">f(x;\alpha,\beta,E) = \frac{\Gamma(\alpha + x)}{\Gamma(\alpha) x!}\frac{1}{(1 + \beta/E)^x}\frac{1}{(1 + E/\beta)^\alpha}</code>
</p>

<p>for <code class="reqn">x = 0,1,\ldots,\alpha</code>, <code class="reqn">\alpha, \beta, E &gt; 0</code> and <code class="reqn">0 &lt; theta[5] \leq 1</code>.
The mixture of two negative binomial distributions represents the marginal distribution of the counts <code class="reqn">N</code> coming from Poisson data with parameter <code class="reqn">\lambda</code> and a mixture of two gamma distributions as its prior. For details see the paper by Dumouchel (1999).
</p>


<h3>Value</h3>

<p><code>dmixnegbinom</code> gives the density corresponding to the <code>E</code> and <code>theta</code> values provided.
</p>


<h3>Author(s)</h3>

<p>Sergio Venturini <a href="mailto:sergio.venturini@unicatt.it">sergio.venturini@unicatt.it</a>, 
</p>
<p>Jessica A. Myers <a href="mailto:jmyers6@partners.org">jmyers6@partners.org</a>
</p>


<h3>References</h3>

<p>DuMouchel W. (1999), "Bayesian Data Mining in Large Frequency Tables, with an Application to the FDA Spontaneous Reporting System". The American Statistician, 53, 177-190.
</p>
<p>Myers, J. A., Venturini, S., Dominici, F. and Morlock, L. (2011), "Random Effects Models for Identifying the Most Harmful Medication Errors in a Large, Voluntary Reporting Database". Technical Report.
</p>


<h3>See Also</h3>

<p><code>dnbinom</code>,
<code>rmixnegbinom</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data("simdata", package = "mederrRank")
ni &lt;- simdata@numi
theta0 &lt;- c(10, 6, 100, 100, .1)
ans &lt;- mixnegbinom.em(simdata, theta0, 50000, 0.01,
	se = FALSE, stratified = TRUE)
theta &lt;- ans$theta.hat
N.E &lt;- cbind(ans$N[1:ni], ans$E[1:ni])[sort(ans$N[1:ni], index.return = TRUE)$ix, ]
N.ix &lt;- match(unique(N.E[, 1]), N.E[, 1])
N &lt;- N.E[N.ix, 1]
E &lt;- N.E[N.ix, 2]
dens &lt;- dmixnegbinom(N, theta, E)
hist(N.E[, 1], breaks = 40, freq = FALSE)
points(N, dens)

## End(Not run)
</code></pre>


</div>