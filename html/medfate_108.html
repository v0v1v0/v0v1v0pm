<div class="container">

<table style="width: 100%;"><tr>
<td>hydraulics_supplyfunctions</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Hydraulic supply functions</h2>

<h3>Description</h3>

<p>Set of functions used in the implementation of hydraulic supply functions (Sperry and Love 2015).
</p>


<h3>Usage</h3>

<pre><code class="language-R">hydraulics_EXylem(
  psiPlant,
  psiUpstream,
  kxylemmax,
  c,
  d,
  allowNegativeFlux = TRUE,
  psiCav = 0
)

hydraulics_E2psiXylem(E, psiUpstream, kxylemmax, c, d, psiCav = 0)

hydraulics_E2psiXylemUp(E, psiDownstream, kxylemmax, c, d, psiCav = 0)

hydraulics_EVanGenuchten(psiRhizo, psiSoil, krhizomax, n, alpha, l = 0.5)

hydraulics_ECrit(psiUpstream, kxylemmax, c, d, pCrit = 0.001)

hydraulics_E2psiVanGenuchten(
  E,
  psiSoil,
  krhizomax,
  n,
  alpha,
  psiStep = -1e-04,
  psiMax = -10
)

hydraulics_E2psiTwoElements(
  E,
  psiSoil,
  krhizomax,
  kxylemmax,
  n,
  alpha,
  c,
  d,
  psiCav = 0,
  psiStep = -1e-04,
  psiMax = -10
)

hydraulics_E2psiBelowground(E, hydraulicNetwork, psiIni = as.numeric(c(0)))

hydraulics_E2psiAboveground(E, psiRootCrown, hydraulicNetwork)

hydraulics_E2psiNetwork(E, hydraulicNetwork, psiIni = as.numeric(c(0)))

hydraulics_supplyFunctionOneXylem(
  psiSoil,
  v,
  kstemmax,
  stemc,
  stemd,
  psiCav = 0,
  maxNsteps = 200L,
  dE = 0.01
)

hydraulics_supplyFunctionTwoElements(
  Emax,
  psiSoil,
  krhizomax,
  kxylemmax,
  n,
  alpha,
  c,
  d,
  psiCav = 0,
  dE = 0.1,
  psiMax = -10
)

hydraulics_supplyFunctionThreeElements(
  Emax,
  psiSoil,
  krhizomax,
  kxylemmax,
  kleafmax,
  n,
  alpha,
  stemc,
  stemd,
  leafc,
  leafd,
  psiCav = 0,
  dE = 0.1,
  psiMax = -10
)

hydraulics_supplyFunctionBelowground(
  hydraulicNetwork,
  minFlow = 0,
  pCrit = 0.001
)

hydraulics_supplyFunctionAboveground(
  Erootcrown,
  psiRootCrown,
  hydraulicNetwork
)

hydraulics_supplyFunctionNetwork(hydraulicNetwork, minFlow = 0, pCrit = 0.001)

hydraulics_regulatedPsiXylem(E, psiUpstream, kxylemmax, c, d, psiStep = -0.01)

hydraulics_regulatedPsiTwoElements(
  Emax,
  psiSoil,
  krhizomax,
  kxylemmax,
  n,
  alpha,
  c,
  d,
  dE = 0.1,
  psiMax = -10
)

hydraulics_initSperryNetworks(x)

hydraulics_supplyFunctionPlot(
  x,
  draw = TRUE,
  type = "E",
  speciesNames = FALSE,
  ylim = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>psiPlant</code></td>
<td>
<p>Plant water potential (in MPa).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psiUpstream</code></td>
<td>
<p>Water potential upstream (in MPa). In a one-component model corresponds to soil potential. In a two-component model corresponds to the potential inside the roots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kxylemmax</code></td>
<td>
<p>Maximum xylem hydraulic conductance (defined as flow per leaf surface unit and per pressure drop).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c, d</code></td>
<td>
<p>Parameters of the Weibull function (generic xylem vulnerability curve).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allowNegativeFlux</code></td>
<td>
<p>A boolean to indicate whether negative flux (i.e. from plant to soil) is allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psiCav</code></td>
<td>
<p>Minimum water potential (in MPa) experienced (for irreversible cavitation).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E</code></td>
<td>
<p>Flow per surface unit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psiDownstream</code></td>
<td>
<p>Water potential upstream (in MPa).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psiRhizo</code></td>
<td>
<p>Soil water potential (in MPa) in the rhizosphere (root surface).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psiSoil</code></td>
<td>
<p>Soil water potential (in MPa). A scalar or a vector depending on the function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>krhizomax</code></td>
<td>
<p>Maximum rhizosphere hydraulic conductance (defined as flow per leaf surface unit and per pressure drop).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n, alpha, l</code></td>
<td>
<p>Parameters of the Van Genuchten function (rhizosphere vulnerability curve).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pCrit</code></td>
<td>
<p>Critical water potential (in MPa).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psiStep</code></td>
<td>
<p>Water potential precision (in MPa).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psiMax</code></td>
<td>
<p>Minimum (maximum in absolute value) water potential to be considered (in MPa).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hydraulicNetwork</code></td>
<td>
<p>List with the hydraulic characteristics of nodes in the hydraulic network.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psiIni</code></td>
<td>
<p>Vector of initial water potential values (in MPa).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psiRootCrown</code></td>
<td>
<p>Soil water potential (in MPa) at the root crown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>Proportion of fine roots within each soil layer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kstemmax</code></td>
<td>
<p>Maximum stem xylem hydraulic conductance (defined as flow per leaf surface unit and per pressure drop).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stemc, stemd</code></td>
<td>
<p>Parameters of the Weibull function for stems (stem xylem vulnerability curve).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxNsteps</code></td>
<td>
<p>Maximum number of steps in the construction of supply functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dE</code></td>
<td>
<p>Increment of flow per surface unit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Emax</code></td>
<td>
<p>Maximum flow per surface unit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kleafmax</code></td>
<td>
<p>Maximum leaf hydraulic conductance (defined as flow per leaf surface unit and per pressure drop).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leafc, leafd</code></td>
<td>
<p>Parameters of the Weibull function for leaves (leaf vulnerability curve).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minFlow</code></td>
<td>
<p>Minimum flow in supply function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Erootcrown</code></td>
<td>
<p>Flow per surface unit at the root crown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class <code>spwbInput</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>draw</code></td>
<td>
<p>A flag to indicate whether the supply function should be drawn or just returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Plot type for <code>hydraulics_supplyFunctionPlot</code>, either <code>"E"</code>, 
<code>"ERhizo"</code>, <code>"StemPsi"</code>, <code>"RootPsi"</code> or <code>"dEdP"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>speciesNames</code></td>
<td>
<p>A flag to indicate the use of species names instead of cohort names in plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>Graphical parameter to override function defaults.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Function <code>hydraulics_supplyFunctionPlot</code> draws a plot of the supply function for the given <code>soil</code> object and network properties of each plant cohort in <code>x</code>. Function <code>hydraulics_vulnerabilityCurvePlot</code> draws a plot of the vulnerability curves for the given <code>soil</code> object and network properties of each plant cohort in <code>x</code>.
</p>


<h3>Value</h3>

<p>Values returned for each function are:
</p>

<ul>
<li>
<p><code>hydraulics_E2psiXylem</code>: The plant (leaf) water potential (in MPa) corresponding to the input flow, according to the xylem supply function and given an upstream (soil or root) water potential.
</p>
</li>
<li>
<p><code>hydraulics_E2psiVanGenuchten</code>: The root water potential (in MPa) corresponding to the input flow, according to the rhizosphere supply function and given a soil water potential.
</p>
</li>
<li>
<p><code>hydraulics_E2psiTwoElements</code>: The plant (leaf) water potential (in MPa) corresponding to the input flow, according to the rhizosphere and plant supply functions and given an input soil water potential.
</p>
</li>
<li>
<p><code>hydraulics_E2psiNetwork</code>: The rhizosphere, root crown and plant (leaf water potential (in MPa) corresponding to the input flow, according to the vulnerability curves of rhizosphere, root and stem elements in a network.
</p>
</li>
<li>
<p><code>hydraulics_Ecrit</code>: The critical flow according to the xylem supply function and given an input soil water potential.
</p>
</li>
<li>
<p><code>hydraulics_EVanGenuchten</code>: The flow (integral of the vulnerability curve) according to the rhizosphere supply function and given an input drop in water potential (soil and rhizosphere).
</p>
</li>
<li>
<p><code>hydraulics_EXylem</code>: The flow (integral of the vulnerability curve) according to the xylem supply function and given an input drop in water potential (rhizosphere and plant).
</p>
</li>
<li>
<p><code>hydraulics_supplyFunctionOneXylem</code>, <code>hydraulics_supplyFunctionTwoElements</code> and
<code>hydraulics_supplyFunctionNetwork</code>: A list with different numeric vectors with information of the two-element supply function:
</p>

<ul>
<li>
<p><code>E</code>: Flow values (supply values).
</p>
</li>
<li>
<p><code>FittedE</code>: Fitted flow values (for <code>hydraulics_supplyFunctionTwoElements</code>).
</p>
</li>
<li>
<p><code>Elayers</code>: Flow values across the roots of each soil layer (only for <code>hydraulics_supplyFunctionNetwork</code>).
</p>
</li>
<li>
<p><code>PsiRhizo</code>: Water potential values at the root surface (only for <code>hydraulics_supplyFunctionNetwork</code>).
</p>
</li>
<li>
<p><code>PsiRoot</code>: Water potential values inside the root crown (not for <code>hydraulics_supplyFunctionOneXylem</code>).
</p>
</li>
<li>
<p><code>PsiPlant</code>: Water potential values at the canopy (leaf).
</p>
</li>
<li>
<p><code>dEdP</code>: Derivatives of the supply function.
</p>
</li>
</ul>
</li>
<li>
<p><code>hydraulics_supplyFunctionPlot</code>: If <code>draw = FALSE</code> a list with the result of calling <code>hydraulics_supplyFunctionNetwork</code> for each cohort. 
</p>
</li>
<li>
<p><code>hydraulics_regulatedPsiXylem</code>: Plant water potential after regulation (one-element loss function) given an input water potential.
</p>
</li>
<li>
<p><code>hydraulics_regulatedPsiTwoElements</code>: Plant water potential after regulation (two-element loss function) given an input soil water potential.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Miquel De Cáceres Ainsa, CREAF
</p>


<h3>References</h3>

<p>Sperry, J. S., F. R. Adler, G. S. Campbell, and J. P. Comstock. 1998. Limitation of plant water use by rhizosphere and xylem conductance: results from a model. Plant, Cell and Environment 21:347–359.
</p>
<p>Sperry, J. S., and D. M. Love. 2015. What plant hydraulics can tell us about responses to climate-change droughts. New Phytologist 207:14–27.
</p>


<h3>See Also</h3>

<p><code>hydraulics_psi2K</code>, <code>hydraulics_maximumStemHydraulicConductance</code>, <code>spwb</code>, <code>soil</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">kstemmax = 4 # in mmol·m-2·s-1·MPa-1
stemc = 3 
stemd = -4 # in MPa
psiVec = seq(-0.1, -7.0, by =-0.01)

#Vulnerability curve
kstem = unlist(lapply(psiVec, hydraulics_xylemConductance, kstemmax, stemc, stemd))
plot(-psiVec, kstem, type="l",ylab="Xylem conductance (mmol·m-2·s-1·MPa-1)", 
     xlab="Canopy pressure (-MPa)", lwd=1.5,ylim=c(0,kstemmax))

</code></pre>


</div>