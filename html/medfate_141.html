<div class="container">

<table style="width: 100%;"><tr>
<td>light_advanced</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Advanced radiation transfer functions</h2>

<h3>Description</h3>

<p>Functions <code>light_layerDirectIrradianceFraction</code> and <code>light_layerDiffuseIrradianceFraction</code> calculate 
the fraction of above-canopy direct and diffuse radiation reaching each vegetation layer. 
Function <code>light_layerSunlitFraction</code> calculates the proportion of sunlit leaves in each vegetation layer. 
Function <code>light_cohortSunlitShadeAbsorbedRadiation</code> calculates the amount of radiation absorbed 
by cohort and vegetation layers, while differentiating between sunlit and shade leaves.
</p>


<h3>Usage</h3>

<pre><code class="language-R">light_leafAngleCDF(leafAngle, p, q)

light_leafAngleBetaParameters(leafAngle, leafAngleSD)

light_directionalExtinctionCoefficient(p, q, solarElevation)

light_layerDirectIrradianceFraction(
  LAIme,
  LAImd,
  LAImx,
  kb,
  ClumpingIndex,
  alpha,
  gamma,
  trunkExtinctionFraction = 0.1
)

light_layerDiffuseIrradianceFraction(
  LAIme,
  LAImd,
  LAImx,
  K,
  ClumpingIndex,
  ZF,
  alpha,
  gamma,
  trunkExtinctionFraction = 0.1
)

light_cohortSunlitShadeAbsorbedRadiation(
  Ib0,
  Id0,
  LAIme,
  LAImd,
  LAImx,
  kb,
  K,
  ClumpingIndex,
  ZF,
  alpha,
  gamma,
  trunkExtinctionFraction = 0.1
)

light_layerSunlitFraction(LAIme, LAImd, kb, ClumpingIndex)

light_instantaneousLightExtinctionAbsortion(
  LAIme,
  LAImd,
  LAImx,
  p,
  q,
  ClumpingIndex,
  alphaSWR,
  gammaSWR,
  ddd,
  ntimesteps = 24L,
  trunkExtinctionFraction = 0.1
)

light_longwaveRadiationSHAW(
  LAIme,
  LAImd,
  LAImx,
  LWRatm,
  Tsoil,
  Tair,
  trunkExtinctionFraction = 0.1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>leafAngle</code></td>
<td>
<p>Average leaf inclination angle (in radians).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p, q</code></td>
<td>
<p>Parameters of the beta distribution for leaf angles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leafAngleSD</code></td>
<td>
<p>Standard deviation of leaf inclination angle (in radians).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>solarElevation</code></td>
<td>
<p>Solar elevation (in radians).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LAIme</code></td>
<td>
<p>A numeric matrix of live expanded LAI values per vegetation layer (row) and cohort (column).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LAImd</code></td>
<td>
<p>A numeric matrix of dead LAI values per vegetation layer (row) and cohort (column).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LAImx</code></td>
<td>
<p>A numeric matrix of maximum LAI values per vegetation layer (row) and cohort (column).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kb</code></td>
<td>
<p>A vector of direct light extinction coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ClumpingIndex</code></td>
<td>
<p>The extent to which foliage has a nonrandom spatial distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>A vector of leaf absorbance by species.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>A vector of leaf reflectance values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trunkExtinctionFraction</code></td>
<td>
<p>Fraction of extinction due to trunks (for winter deciduous forests).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>A vector of light extinction coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ZF</code></td>
<td>
<p>Fraction of sky angles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ib0</code></td>
<td>
<p>Above-canopy direct incident radiation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Id0</code></td>
<td>
<p>Above-canopy diffuse incident radiation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alphaSWR</code></td>
<td>
<p>A vecfor of hort-wave absorbance coefficients for each cohort.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gammaSWR</code></td>
<td>
<p>A vector of short-wave reflectance coefficients (albedo) for each cohort.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ddd</code></td>
<td>
<p>A dataframe with direct and diffuse radiation for different subdaily time steps (see function <code>radiation_directDiffuseDay</code> in package meteoland).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntimesteps</code></td>
<td>
<p>Number of subdaily time steps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LWRatm</code></td>
<td>
<p>Atmospheric downward long-wave radiation (W/m2).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tsoil</code></td>
<td>
<p>Soil temperature (Celsius).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tair</code></td>
<td>
<p>Canopy layer air temperature vector (Celsius).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Functions for short-wave radiation are adapted from Anten &amp; Bastiaans (2016), 
whereas long-wave radiation balance follows Flerchinger et al. (2009). 
Vegetation layers are assumed to be ordered from bottom to top.
</p>


<h3>Value</h3>

<p>Functions <code>light_layerDirectIrradianceFraction</code>, <code>light_layerDiffuseIrradianceFraction</code>
and <code>light_layerSunlitFraction</code> return a numeric vector of length equal to the number of vegetation layers. 
</p>
<p>Function <code>light_cohortSunlitShadeAbsorbedRadiation</code> returns a list with 
two elements (matrices): <code>I_sunlit</code> and <code>I_shade</code>.
</p>


<h3>Author(s)</h3>

<p>Miquel De Cáceres Ainsa, CREAF
</p>


<h3>References</h3>

<p>Anten, N.P.R., Bastiaans, L., 2016. The use of canopy models to analyze light competition among plants, in: Hikosaka, K., Niinemets, U., Anten, N.P.R. (Eds.), Canopy Photosynthesis: From Basics to Application. Springer, pp. 379–398.
</p>
<p>Flerchinger, G. N., Xiao, W., Sauer, T. J., Yu, Q. 2009. Simulation of within-canopy radiation exchange. NJAS - Wageningen Journal of Life Sciences 57 (1): 5–15. https://doi.org/10.1016/j.njas.2009.07.004.
</p>


<h3>See Also</h3>

<p><code>spwb</code>, <code>light_basic</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">solarElevation &lt;- 0.67 # in radians
SWR_direct &lt;- 1100
SWR_diffuse &lt;- 300
PAR_direct &lt;- 550
PAR_diffuse &lt;- 150

LAI &lt;- 2
nlayer &lt;- 10
LAIlayerlive &lt;- matrix(rep(LAI/nlayer,nlayer),nlayer,1)
LAIlayerdead &lt;- matrix(0,nlayer,1)
meanLeafAngle &lt;- 60 # in degrees
sdLeafAngle &lt;- 20

beta &lt;- light_leafAngleBetaParameters(meanLeafAngle*(pi/180), sdLeafAngle*(pi/180))

## Extinction coefficients
kb &lt;- light_directionalExtinctionCoefficient(beta["p"], beta["q"], solarElevation)
kd_PAR &lt;- 0.5
kd_SWR &lt;- kd_PAR/1.35
</code></pre>


</div>