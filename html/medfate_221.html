<div class="container">

<table style="width: 100%;"><tr>
<td>plot.spwb</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plots simulation results</h2>

<h3>Description</h3>

<p>Function <code>plot</code> plots time series of the results of the soil plant water balance model (see <code>spwb</code>), 
plant water balance model (see <code>pwb</code>), the forest growth model (see <code>growth</code>) 
or the forest dynamics model (see <code>fordyn</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'spwb'
plot(
  x,
  type = "PET_Precipitation",
  cohorts = NULL,
  bySpecies = FALSE,
  dates = NULL,
  subdaily = FALSE,
  xlim = NULL,
  ylim = NULL,
  xlab = NULL,
  ylab = NULL,
  summary.freq = NULL,
  ...
)

## S3 method for class 'pwb'
plot(
  x,
  type = "PlantTranspiration",
  cohorts = NULL,
  bySpecies = FALSE,
  dates = NULL,
  subdaily = FALSE,
  xlim = NULL,
  ylim = NULL,
  xlab = NULL,
  ylab = NULL,
  summary.freq = NULL,
  ...
)

## S3 method for class 'growth'
plot(
  x,
  type = "PET_Precipitation",
  cohorts = NULL,
  bySpecies = FALSE,
  dates = NULL,
  subdaily = FALSE,
  xlim = NULL,
  ylim = NULL,
  xlab = NULL,
  ylab = NULL,
  summary.freq = NULL,
  ...
)

## S3 method for class 'fordyn'
plot(
  x,
  type = "StandBasalArea",
  cohorts = NULL,
  bySpecies = FALSE,
  dates = NULL,
  xlim = NULL,
  ylim = NULL,
  xlab = NULL,
  ylab = NULL,
  summary.freq = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class <code>spwb</code>, <code>pwb</code>, <code>growth</code> or <code>fordyn</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>The information to be plotted (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cohorts</code></td>
<td>
<p>An integer, boolean or character vector to select the plant cohorts to be plotted. If <code>cohorts = "T"</code> (resp. <code>cohorts = "S"</code>) then all tree (resp. shrub) cohorts will be displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bySpecies</code></td>
<td>
<p>Allows aggregating output by species, before drawing plots (only has an effect with some values of <code>type</code>). Aggregation can involve a sum (as for plant lai or transpiration) or a LAI-weighted mean (as for plant stress or plant water potential), where LAI values are those of <code>LAIlive</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dates</code></td>
<td>
<p>A Date vector with a subset of dates to be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subdaily</code></td>
<td>
<p>Whether subdaily results should be shown, only for simulations using <code>transpirationMode = "Sperry"</code> and having set <code>subdailyResults = TRUE</code> in the simulation control object. If <code>subdaily = TRUE</code>, then the valid strings for <code>type</code> are listed in <code>plot.spwb_day</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>Range of values for x.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>Range of values for y.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>x-axis label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>y-axis label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summary.freq</code></td>
<td>
<p>Frequency of summary statistics (see <code>cut.Date</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters for function <code>plot</code> (not used).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The following plots are currently available for <code>spwb</code> (most of them also for <code>pwb</code>):
</p>

<ul>
<li>
<p><code>"PET_Precipitation"</code>: Potential evapotranspiration and Precipitation.
</p>
</li>
<li>
<p><code>"PET_NetRain"</code>: Potential evapotranspiration and Net rainfall.
</p>
</li>
<li>
<p><code>"Snow"</code>: Snow precipitation and snowpack dynamics.
</p>
</li>
<li>
<p><code>"Export"</code>: Water exported through deep drainage and surface runoff.
</p>
</li>
<li>
<p><code>"Evapotranspiration"</code>: Plant transpiration and soil evaporation.
</p>
</li>
<li>
<p><code>"SoilPsi"</code>: Soil water potential.
</p>
</li>
<li>
<p><code>"SoilRWC"</code>: Soil relative water content (in percent of field capacity).
</p>
</li>
<li>
<p><code>"SoilTheta"</code>: Soil moisture water content (in percent volume).
</p>
</li>
<li>
<p><code>"SoilVol"</code>: Soil water volumetric content (in mm).
</p>
</li>
<li>
<p><code>"PlantExtraction"</code>: Water extracted by plants from each soil layer.
</p>
</li>
<li>
<p><code>"HydraulicRedistribution"</code>: Water added to each soil layer coming from other soil layers, transported through the plant hydraulic network.
</p>
</li>
<li>
<p><code>"LAI"</code>: Expanded and dead leaf area index of the whole stand.
</p>
</li>
<li>
<p><code>"PlantLAI"</code>: Plant cohort leaf area index (expanded leaves).
</p>
</li>
<li>
<p><code>"PlantLAIlive"</code>: Plant cohort leaf area index ("live" leaves).
</p>
</li>
<li>
<p><code>"PlantStress"</code>: Plant cohort average daily drought stress.
</p>
</li>
<li>
<p><code>"PlantTranspiration"</code>: Plant cohort transpiration.
</p>
</li>
<li>
<p><code>"TranspirationPerLeaf"</code>: Plant cohort transpiration per leaf area.
</p>
</li>
<li>
<p><code>"PlantGrossPhotosynthesis"</code>: Plant cohort photosynthesis.
</p>
</li>
<li>
<p><code>"GrossPhotosynthesisPerLeaf"</code>: Plant cohort photosynthesis per leaf area.
</p>
</li>
<li>
<p><code>"StemRWC"</code>: Average daily stem relative water content.
</p>
</li>
<li>
<p><code>"LeafRWC"</code>: Average daily leaf relative water content.
</p>
</li>
<li>
<p><code>"LFMC"</code>: Live fuel moisture content.
</p>
</li>
</ul>
<p>The following plots are available for <code>spwb</code> and <code>pwb</code> <em>only if</em> <code>transpirationMode = "Granier"</code>:
</p>

<ul>
<li>
<p><code>"PlantPsi"</code>: Plant cohort water potential.
</p>
</li>
<li>
<p><code>"FPAR"</code>: Fraction of PAR at the canopy level of each plant cohort.
</p>
</li>
<li>
<p><code>"AbsorbedSWRFraction"</code>: Fraction of SWR absorbed by each plant cohort.
</p>
</li>
</ul>
<p>The following plots are available for <code>spwb</code> and <code>pwb</code> <em>only if</em> <code>transpirationMode = "Sperry"</code>:
</p>

<ul>
<li>
<p><code>"SoilPlantConductance"</code>: Average instantaneous overall soil plant conductance (calculated as the derivative of the supply function).
</p>
</li>
<li>
<p><code>"LeafPsiMin"</code>:  Midday leaf water potential.
</p>
</li>
<li>
<p><code>"LeafPsiMax"</code>:  Pre-dawn leaf water potential.
</p>
</li>
<li>
<p><code>"LeafPsiRange"</code>:  Range of leaf water potential.
</p>
</li>
<li>
<p><code>"LeafPsiMin_SL"</code>: Minimum water potential of sunlit leaves.
</p>
</li>
<li>
<p><code>"LeafPsiMax_SL"</code>: Maximum water potential of sunlit leaves.
</p>
</li>
<li>
<p><code>"LeafPsiMin_SH"</code>: Minimum water potential of shade leaves.
</p>
</li>
<li>
<p><code>"LeafPsiMax_SH"</code>: Maximum water potential of shade leaves.
</p>
</li>
<li>
<p><code>"TempMin_SL"</code>: Minimum temperature of sunlit leaves.
</p>
</li>
<li>
<p><code>"TempMax_SL"</code>: Maximum temperature of sunlit leaves.
</p>
</li>
<li>
<p><code>"TempMin_SH"</code>: Minimum temperature of shade leaves.
</p>
</li>
<li>
<p><code>"TempMax_SH"</code>: Maximum temperature of shade leaves.
</p>
</li>
<li>
<p><code>"GSWMin_SL"</code>: Minimum stomatal conductance of sunlit leaves.
</p>
</li>
<li>
<p><code>"GSWMax_SL"</code>: Maximum stomatal conductance of sunlit leaves.
</p>
</li>
<li>
<p><code>"GSWMin_SH"</code>: Minimum stomatal conductance of shade leaves.
</p>
</li>
<li>
<p><code>"GSWMax_SH"</code>: Maximum stomatal conductance of shade leaves.
</p>
</li>
<li>
<p><code>"StemPsi"</code>:  Midday (upper) stem water potential.
</p>
</li>
<li>
<p><code>"RootPsi"</code>:  Midday root crown water potential.
</p>
</li>
<li>
<p><code>"PlantNetPhotosynthesis"</code>:  Plant cohort net photosynthesis.
</p>
</li>
<li>
<p><code>"NetPhotosynthesisPerLeaf"</code>:  Plant cohort net photosynthesis per leaf area.
</p>
</li>
<li>
<p><code>"PlantWUE"</code>:  Plant cohort daily water use efficiency.
</p>
</li>
<li>
<p><code>"PlantAbsorbedSWR"</code>:  Plant cohort absorbed short wave radiation.
</p>
</li>
<li>
<p><code>"AbsorbedSWRPerLeaf"</code>:  Plant cohort absorbed short wave radiation per leaf area.
</p>
</li>
<li>
<p><code>"PlantNetLWR"</code>:  Plant cohort net long wave radiation.
</p>
</li>
<li>
<p><code>"NetLWRPerLeaf"</code>:  Plant cohort net long wave radiation per leaf area.
</p>
</li>
<li>
<p><code>"AirTemperature"</code>:  Minimum/maximum/mean daily temperatures above canopy.
</p>
</li>
<li>
<p><code>"CanopyTemperature"</code>:  Minimum/maximum/mean daily temperatures inside canopy.
</p>
</li>
<li>
<p><code>"SoilTemperature"</code>:  Minimum/maximum/mean daily temperatures inside the first soil layer.
</p>
</li>
<li>
<p><code>"CanopyEnergyBalance"</code>:  Canopy energy balance components.
</p>
</li>
<li>
<p><code>"SoilEnergyBalance"</code>:  Soil energy balance components.
</p>
</li>
</ul>
<p>In addition to the former, the following plots are available for objects <code>growth</code> or <code>fordyn</code>:
</p>

<ul>
<li>
<p><code>"CarbonBalance"</code>:  Stand-level carbon balance components.
</p>
</li>
<li>
<p><code>"BiomassBalance"</code>:  Stand-level biomass balance components.
</p>
</li>
<li>
<p><code>"GrossPhotosynthesis"</code>:  Gross photosynthesis rate per dry weight.
</p>
</li>
<li>
<p><code>"MaintenanceRespiration"</code>:  Maintenance respiration cost per dry weight.
</p>
</li>
<li>
<p><code>"PhotosynthesisMaintenanceRatio"</code>:  The ratio of gross photosynthesis over maintenance respiration.
</p>
</li>
<li>
<p><code>"RootExudation"</code>:  Root exudation rate per dry weight.
</p>
</li>
<li>
<p><code>"LabileCarbonBalance"</code>:  Labile carbon balance per dry weight.
</p>
</li>
<li>
<p><code>"SugarLeaf"</code>:  Sugar concentration in leaves.
</p>
</li>
<li>
<p><code>"StarchLeaf"</code>:  Starch concentration in leaves.
</p>
</li>
<li>
<p><code>"SugarSapwood"</code>:  Sugar concentration in sapwood.
</p>
</li>
<li>
<p><code>"StarchSapwood"</code>:  Starch concentration in sapwood.
</p>
</li>
<li>
<p><code>"SugarTransport"</code>:  Phloem sugar transport rate.
</p>
</li>
<li>
<p><code>"StructuralBiomassBalance"</code>:  Daily structural biomass balance (g dry · ind-2).
</p>
</li>
<li>
<p><code>"LabileBiomassBalance"</code>:  Daily labile biomass balance (g dry · ind-2).
</p>
</li>
<li>
<p><code>"PlantBiomassBalance"</code>:  Daily plant biomass balance, i.e. labile change + structural change (g dry · ind-2).
</p>
</li>
<li>
<p><code>"MortalityBiomassLoss"</code>:  Biomass loss due to mortality (g dry · m-2).    
</p>
</li>
<li>
<p><code>"PlantBiomassBalance"</code>:  Daily cohort biomass balance (including mortality) (g dry · m-2).
</p>
</li>
<li>
<p><code>"LeafBiomass"</code>: Leaf structural dry biomass per individual.
</p>
</li>
<li>
<p><code>"SapwoodBiomass"</code>: Sapwood dry biomass per individual.
</p>
</li>
<li>
<p><code>"FineRootBiomass"</code>: Fine root dry biomass per individual.
</p>
</li>
<li>
<p><code>"SapwoodArea"</code>:  Sapwood area per individual.
</p>
</li>
<li>
<p><code>"LeafArea"</code>:  Leaf area per individual.
</p>
</li>
<li>
<p><code>"FineRootArea"</code>: Fine root area per individual (only for <code>transpirationMode = "Sperry"</code> or <code>transpirationMode = "Sureau"</code>).
</p>
</li>
<li>
<p><code>"DBH"</code>: Diameter at breast height (in cm) for an average individual of each plant cohort.
</p>
</li>
<li>
<p><code>"Height"</code>: Height (in cm) for an average individual of each plant cohort.
</p>
</li>
<li>
<p><code>"SAgrowth"</code>:  Sapwood area growth rate.
</p>
</li>
<li>
<p><code>"LAgrowth"</code>:  Leaf area growth rate.
</p>
</li>
<li>
<p><code>"FRAgrowth"</code>:  Fine root area growth rate (only for <code>transpirationMode = "Sperry"</code> or <code>transpirationMode = "Sureau"</code>).
</p>
</li>
<li>
<p><code>"HuberValue"</code>:  Ratio of leaf area to sapwood area.
</p>
</li>
<li>
<p><code>"RootAreaLeafArea"</code>:  Ratio of fine root area to leaf area (only for <code>transpirationMode = "Sperry"</code> or <code>transpirationMode = "Sureau"</code>).
</p>
</li>
</ul>
<p>Finally, the following plots are only available for <code>fordyn</code> simulation results:
</p>

<ul>
<li>
<p><code>"StandBasalArea"</code>: Stand basal area of living trees.
</p>
</li>
<li>
<p><code>"StandDensity"</code>: Stand density of living trees.
</p>
</li>
<li>
<p><code>"SpeciesBasalArea"</code>: Basal area of living trees by species.
</p>
</li>
<li>
<p><code>"SpeciesDensity"</code>: Density of living trees by species.
</p>
</li>
<li>
<p><code>"CohortBasalArea"</code>: Basal area of living trees by plant cohort.
</p>
</li>
<li>
<p><code>"CohortDensity"</code>: Density of living trees by plant cohort.
</p>
</li>
</ul>
<h3>Value</h3>

<p>An ggplot object
</p>


<h3>Author(s)</h3>

<p>Miquel De Cáceres Ainsa, CREAF
</p>


<h3>See Also</h3>

<p><code>spwb</code>, <code>pwb</code>, <code>growth</code>, <code>fordyn</code>, <code>summary.spwb</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#Load example daily meteorological data
data(examplemeteo)

#Load example plot plant data
data(exampleforest)

#Default species parameterization
data(SpParamsMED)

#Define soil with default soil params (4 layers)
examplesoil &lt;- defaultSoilParams(4)

#Initialize control parameters
control &lt;- defaultControl("Granier")

#Initialize input
x &lt;- spwbInput(exampleforest,examplesoil, SpParamsMED, control)

#Call simulation function
S1 &lt;- spwb(x, examplemeteo, latitude = 41.82592, elevation = 100)

#Plot results
plot(S1)

</code></pre>


</div>