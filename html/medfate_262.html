<div class="container">

<table style="width: 100%;"><tr>
<td>soil</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Soil initialization</h2>

<h3>Description</h3>

<p>Initializes soil parameters and state variables for its use in simulations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">soil(x, VG_PTF = "Toth")

## S3 method for class 'soil'
summary(object, model = "SX", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A data frame of soil parameters (see an example in <code>defaultSoilParams</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VG_PTF</code></td>
<td>
<p>Pedotransfer functions to obtain parameters for the van Genuchten-Mualem equations. Either <code>"Carsel"</code> (Carsel and Parrish 1988) or <code>"Toth"</code> (Toth et al. 2015).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class <code>soil</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Either 'SX' or 'VG' for Saxton or Van Genuchten pedotransfer models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters to <code>summary</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Function <code>summary</code> prompts a description of soil characteristics and state variables (water content and temperature) 
according to a water retention curve (either Saxton's or Van Genuchten's). 
Volume at field capacity is calculated assuming a soil water potential equal to -0.033 MPa. 
Parameter <code>Temp</code> is initialized as missing for all soil layers. 
</p>
<p>If available, the user can specify columns <code>VG_alpha</code>, <code>VG_n</code>, <code>VG_theta_res</code>, <code>VG_theta_sat</code> and <code>K_sat</code>,
to override Van Genuchten parameters an saturated conductivity estimated from pedotransfer functions when calling function <code>soil</code>.
</p>


<h3>Value</h3>

<p>Function <code>soil</code> returns a data frame of class <code>soil</code> with the following columns:
</p>

<ul>
<li>
<p><code>widths</code>: Width of soil layers (in mm).
</p>
</li>
<li>
<p><code>sand</code>: Sand percentage for each layer (in percent volume).
</p>
</li>
<li>
<p><code>clay</code>: Clay percentage for each layer (in percent volume).
</p>
</li>
<li>
<p><code>om</code>: Organic matter percentage for each layer (in percent volume).
</p>
</li>
<li>
<p><code>nitrogen</code>: Sum of total nitrogen (ammonia, organic and reduced nitrogen) for each layer (in g/kg).
</p>
</li>
<li>
<p><code>rfc</code>: Percentage of rock fragment content for each layer.
</p>
</li>
<li>
<p><code>macro</code>: Macroporosity for each layer (estimated using Stolf et al. 2011).
</p>
</li>
<li>
<p><code>Ksat</code>: Saturated soil conductivity for each layer (estimated using function <code>soil_saturatedConductivitySX</code>.
</p>
</li>
<li>
<p><code>VG_alpha</code>, <code>VG_n</code>, <code>VG_theta_res</code>, <code>VG_theta_sat</code>: Parameters for van Genuchten's pedotransfer functions, for each layer, corresponding to the USDA texture type.
</p>
</li>
<li>
<p><code>W</code>: State variable with relative water content of each layer (in as proportion relative to FC).
</p>
</li>
<li>
<p><code>Temp</code>: State variable with temperature (in ºC) of each layer.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Miquel De Cáceres Ainsa, CREAF
</p>


<h3>References</h3>

<p>Carsel, R.F., and Parrish, R.S. 1988. Developing joint probability distributions of soil water retention characteristics. Water Resources Research 24: 755–769.
</p>
<p>Tóth, B., Weynants, M., Nemes, A., Makó, A., Bilas, G., and Tóth, G. 2015. New generation of hydraulic pedotransfer functions for Europe. European Journal of Soil Science 66: 226–238.
</p>
<p>Stolf, R., Thurler, A., Oliveira, O., Bacchi, S., Reichardt, K., 2011. Method to estimate soil macroporosity and microporosity based on sand content and bulk density. Rev. Bras. Ciencias do Solo 35, 447–459.
</p>


<h3>See Also</h3>

<p><code>soil_redefineLayers</code>, <code>soil_psi2thetaSX</code>, <code>soil_psi2thetaVG</code>, <code>spwb</code>, <code>defaultSoilParams</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Default parameters
df_soil &lt;- defaultSoilParams()

# Initializes soil
s = soil(df_soil)
s

# Prints soil characteristics according to Saxton's water retention curve
summary(s, model="SX")

# Prints soil characteristics according to Van Genuchten's water retention curve
summary(s, model="VG")

# Add columns 'VG_theta_sat' and 'VG_theta_res' with custom values
df_soil$VG_theta_sat &lt;- 0.400 
df_soil$VG_theta_res &lt;- 0.040 

# Reinitialize soil (should override estimations)
s2 = soil(df_soil)
s2
summary(s2, model="VG")
</code></pre>


</div>