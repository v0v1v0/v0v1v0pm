<div class="container">

<table style="width: 100%;"><tr>
<td>soil_thermodynamics</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Soil thermodynamic functions</h2>

<h3>Description</h3>

<p>Functions <code>soil_thermalConductivity</code> and <code>soil_thermalCapacity</code> calculate thermal conductivity and thermal capacity 
for each soil layer, given its texture and water content. Functions <code>soil_temperatureGradient</code> and <code>soil_temperatureChange</code> 
are used to calculate soil temperature gradients (in ºC/m) and temporal temperature change (in ºC/s) 
given soil layer texture and water content (and possibly including heat flux from above).
</p>


<h3>Usage</h3>

<pre><code class="language-R">soil_thermalCapacity(soil, model = "SX")

soil_thermalConductivity(soil, model = "SX")

soil_temperatureGradient(widths, Temp)

soil_temperatureChange(
  widths,
  Temp,
  sand,
  clay,
  W,
  Theta_SAT,
  Theta_FC,
  Gdown,
  tstep
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>soil</code></td>
<td>
<p>Soil object (returned by function <code>soil</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Either 'SX' or 'VG' for Saxton's or Van Genuchten's pedotransfer models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>widths</code></td>
<td>
<p>Width of soil layers (in mm).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Temp</code></td>
<td>
<p>Temperature (in ºC) for each soil layer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sand</code></td>
<td>
<p>Percentage of sand (in percent weight) for each layer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clay</code></td>
<td>
<p>Percentage of clay (in percent weight) for each layer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>Soil moisture (in percent of field capacity) for each layer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Theta_SAT</code></td>
<td>
<p>Relative water content (in percent volume) at saturation for each layer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Theta_FC</code></td>
<td>
<p>Relative water content (in percent volume) at field capacity for each layer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gdown</code></td>
<td>
<p>Downward heat flux from canopy to soil (in W·m-2).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tstep</code></td>
<td>
<p>Time step (interval) in seconds.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Function <code>soil_thermalConductivity</code> returns a vector with values of thermal conductivity (W/m/ºK) for each soil layer. 
</p>
<p>Function <code>soil_thermalCapacity</code> returns a vector with values of heat storage capacity (J/m3/ºK) for each soil layer. 
</p>
<p>Function <code>soil_temperatureGradient</code> returns a vector with values of temperature gradient between consecutive soil layers. 
</p>
<p>Function <code>soil_temperatureChange</code> returns a vector with values of instantaneous temperature change (ºC/s) for each soil layer.
</p>


<h3>Author(s)</h3>

<p>Miquel De Cáceres Ainsa, CREAF
</p>


<h3>References</h3>

<p>Cox, P.M., Betts, R.A., Bunton, C.B., Essery, R.L.H., Rowntree, P.R., and Smith, J. 1999. The impact of new land surface physics on the GCM simulation of climate and climate sensitivity. Climate Dynamics 15: 183–203.
</p>
<p>Dharssi, I., Vidale, P.L., Verhoef, A., MacPherson, B., Jones, C., and Best, M. 2009. New soil physical properties implemented in the Unified Model at PS18. 9–12.
</p>


<h3>See Also</h3>

<p><code>soil</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Define soil and complete parameters
examplesoil = soil(defaultSoilParams(4))

soil_thermalConductivity(examplesoil)
soil_thermalCapacity(examplesoil)

#Values change when altering water content (drier layers have lower conductivity and capacity)
examplesoil$W = c(0.1, 0.4, 0.7, 1.0)
soil_thermalConductivity(examplesoil)
soil_thermalCapacity(examplesoil)

</code></pre>


</div>