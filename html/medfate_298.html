<div class="container">

<table style="width: 100%;"><tr>
<td>soil_texture</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Soil texture and hydraulics</h2>

<h3>Description</h3>

<p>Low-level functions relating soil texture with soil hydraulics and soil water content.
</p>


<h3>Usage</h3>

<pre><code class="language-R">soil_saturatedConductivitySX(clay, sand, bd, om = NA_real_, mmol = TRUE)

soil_unsaturatedConductivitySX(
  theta,
  clay,
  sand,
  bd,
  om = NA_real_,
  mmol = TRUE
)

soil_thetaSATSX(clay, sand, om = NA_real_)

soil_theta2psiSX(clay, sand, theta, om = NA_real_)

soil_psi2thetaSX(clay, sand, psi, om = NA_real_)

soil_psi2kVG(ksat, n, alpha, theta_res, theta_sat, psi)

soil_psi2cVG(n, alpha, theta_res, theta_sat, psi)

soil_psi2thetaVG(n, alpha, theta_res, theta_sat, psi)

soil_theta2psiVG(n, alpha, theta_res, theta_sat, theta)

soil_USDAType(clay, sand)

soil_thetaFC(soil, model = "SX")

soil_thetaWP(soil, model = "SX")

soil_thetaSAT(soil, model = "SX")

soil_waterFC(soil, model = "SX")

soil_waterSAT(soil, model = "SX")

soil_waterWP(soil, model = "SX")

soil_waterPsi(soil, psi, model = "SX")

soil_waterExtractable(soil, model = "SX", minPsi = -5)

soil_theta(soil, model = "SX")

soil_water(soil, model = "SX")

soil_rockWeight2Volume(pWeight, bulkDensity, rockDensity = 2.3)

soil_psi(soil, model = "SX")

soil_conductivity(soil, model = "SX")

soil_capacitance(soil, model = "SX")

soil_saturatedWaterDepth(soil, model = "SX")

soil_vanGenuchtenParamsCarsel(soilType)

soil_campbellParamsClappHornberger(soilType)

soil_vanGenuchtenParamsToth(clay, sand, om, bd, topsoil)

soil_retentionCurvePlot(
  soil,
  model = "SX",
  layer = 1,
  psi = seq(0, -6, by = -0.01),
  relative = TRUE,
  to = "SAT"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>clay</code></td>
<td>
<p>Percentage of clay (in percent weight).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sand</code></td>
<td>
<p>Percentage of sand (in percent weight).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bd</code></td>
<td>
<p>Bulk density (in g/cm3).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>om</code></td>
<td>
<p>Percentage of organic matter (optional, in percent weight).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mmol</code></td>
<td>
<p>Boolean flag to indicate that saturated conductivity units should be returned in mmol/m/s/MPa. If <code>mmol = FALSE</code> then units are cm/day.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>Relative water content (in percent volume).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi</code></td>
<td>
<p>Water potential (in MPa).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ksat</code></td>
<td>
<p>saturated hydraulic conductance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n, alpha, theta_res, theta_sat</code></td>
<td>
<p>Parameters of the Van Genuchten-Mualem model (m = 1 - 1/n).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>soil</code></td>
<td>
<p>Initialized soil object (returned by function <code>soil</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Either 'SX' or 'VG' for Saxton's or Van Genuchten's water retention models; or 'both' to plot both retention models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minPsi</code></td>
<td>
<p>Minimum water potential (in MPa) to calculate the amount of extractable water.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pWeight</code></td>
<td>
<p>Percentage of corresponding to rocks, in weight.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bulkDensity</code></td>
<td>
<p>Bulk density of the soil fraction (g/cm3).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rockDensity</code></td>
<td>
<p>Rock density (g/cm3).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>soilType</code></td>
<td>
<p>A string indicating the soil type.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>topsoil</code></td>
<td>
<p>A boolean flag to indicate topsoil layer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>layer</code></td>
<td>
<p>Soil layer to be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>relative</code></td>
<td>
<p>Boolean flag to indicate that retention curve should be relative to field capacity or saturation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>to</code></td>
<td>
<p>Either 'SAT' (saturation) or 'FC' (field capacity).</p>
</td>
</tr>
</table>
<h3>Details</h3>


<ul>
<li>
<p><code>soil_psi2thetaSX()</code> and <code>soil_theta2psiSX()</code> calculate water potentials (MPa) and water contents (theta) using texture data the formulae of Saxton et al. (1986) or Saxton &amp; Rawls (2006) depending on whether organic matter is available.
</p>
</li>
<li>
<p><code>soil_psi2thetaVG()</code> and <code>soil_theta2psiVG()</code> to the same calculations as before, but using the Van Genuchten - Mualem equations (Wösten &amp; van Genuchten 1988). 
</p>
</li>
<li>
<p><code>soil_saturatedConductivitySX()</code> returns the saturated conductivity of the soil (in cm/day or mmol/m/s/MPa), estimated from formulae of Saxton et al. (1986) or Saxton &amp; Rawls (2006) depending on whether organic matter is available.
</p>
</li>
<li>
<p><code>soil_unsaturatedConductivitySX()</code> returns the unsaturated conductivity of the soil (in cm/day or mmol/m/s/MPa), estimated from formulae of Saxton et al. (1986) or Saxton &amp; Rawls (2006) depending on whether organic matter is available.
</p>
</li>
<li>
<p><code>soil_USDAType()</code> returns the USDA type (a string) for a given texture.
</p>
</li>
<li>
<p><code>soil_vanGenuchtenParamsCarsel()</code> gives parameters for van Genuchten-Mualem equations (alpha, n, theta_res and theta_sat, where alpha is in MPa-1) for a given texture type (Leij et al. 1996) 
</p>
</li>
<li>
<p><code>soil_vanGenuchtenParamsToth()</code> gives parameters for van Genuchten-Mualem equations (alpha, n, theta_res and theta_sat, where alpha is in MPa-1) for a given texture, organic matter and bulk density (Toth et al. 2015).
</p>
</li>
<li>
<p><code>soil_psi()</code> returns the water potential (MPa) of each soil layer, according to its water retention model.
</p>
</li>
<li>
<p><code>soil_theta()</code> returns the moisture content (as percent of soil volume) of each soil layer, according to its water retention model.
</p>
</li>
<li>
<p><code>soil_water()</code> returns the water volume (mm) of each soil layer, according to its water retention model.
</p>
</li>
<li>
<p><code>soil_conductivity()</code> returns the conductivity of each soil layer (mmol/m/s/MPa), according the Saxton model.
</p>
</li>
<li>
<p><code>soil_waterExtractable()</code> returns the water volume (mm) extractable from the soil according to its water retention curves and up to a given soil water potential.
</p>
</li>
<li>
<p><code>soil_waterFC()</code> and <code>soil_thetaFC()</code> calculate the water volume (in mm) and moisture content (as percent of soil volume) of each soil layer at field capacity, respectively.
</p>
</li>
<li>
<p><code>soil_waterWP()</code> and <code>soil_thetaWP()</code> calculate the water volume (in mm) and moisture content (as percent of soil volume) of each soil layer at wilting point (-1.5 MPa), respectively. 
</p>
</li>
<li>
<p><code>soil_waterSAT()</code>, <code>soil_thetaSATSX()</code> and <code>soil_thetaSAT()</code> calculate the saturated water volume (in mm) and moisture content (as percent of soil volume) of each soil layer.
</p>
</li>
<li>
<p><code>soil_saturatedWaterDepth()</code> returns the depth to saturation in mm from surface.
</p>
</li>
<li>
<p><code>soil_rockWeight2Volume()</code> transforms rock percentage from weight to volume basis.
</p>
</li>
<li>
<p><code>soil_retentionCurvePlot()</code> allows ploting the water retention curve of a given soil layer.
</p>
</li>
</ul>
<h3>Value</h3>

<p>Depends on the function (see details).
</p>


<h3>Author(s)</h3>

<p>Miquel De Cáceres Ainsa, CREAF
</p>


<h3>References</h3>

<p>Leij, F.J., Alves, W.J., Genuchten, M.T. Van, Williams, J.R., 1996. The UNSODA Unsaturated Soil Hydraulic Database User’s Manual Version 1.0.
</p>
<p>Saxton, K.E., Rawls, W.J., Romberger, J.S., Papendick, R.I., 1986. Estimating generalized soil-water characteristics from texture. Soil Sci. Soc. Am. J. 50, 1031–1036.
</p>
<p>Saxton, K.E., Rawls, W.J., 2006. Soil water characteristic estimates by texture and organic matter for hydrologic solutions. Soil Sci. Soc. Am. J. 70, 1569. doi:10.2136/sssaj2005.0117
</p>
<p>Wösten, J.H.M., &amp; van Genuchten, M.T. 1988. Using texture and other soil properties to predict the unsaturated soil hydraulic functions. Soil Science Society of America Journal 52: 1762–1770.
</p>
<p>Tóth, B., Weynants, M., Nemes, A., Makó, A., Bilas, G., and Tóth, G. 2015. New generation of hydraulic pedotransfer functions for Europe. European Journal of Soil Science 66: 226–238.
</p>


<h3>See Also</h3>

<p><code>soil</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Determine USDA soil texture type
type = soil_USDAType(clay=40, sand=10)
type

#Van Genuchten's params (bulk density = 1.3 g/cm)
vg = soil_vanGenuchtenParamsToth(40,10,1,1.3,TRUE)
vg

# Define soil with default params
soil_df &lt;- defaultSoilParams(4)
soil_df

# Initialize soil parameters and state variables
s = soil(soil_df)

# Plot Saxton's and Van Genuchten's water retention curves
soil_retentionCurvePlot(s, model="both")

</code></pre>


</div>