<div class="container">

<table style="width: 100%;"><tr>
<td>modelInput</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Input for simulation models</h2>

<h3>Description</h3>

<p>Functions <code>spwbInput()</code> and <code>growthInput()</code> take an object of class <code>forest</code> 
and a soil data input to create input objects for simulation functions <code>spwb</code> (or <code>pwb</code>) and <code>growth</code>, respectively.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spwbInput(x, soil, SpParams, control)

growthInput(x, soil, SpParams, control)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class <code>forest</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>soil</code></td>
<td>
<p>An object of class <code>data.frame</code> or <code>soil</code>, containing soil parameters per soil layer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SpParams</code></td>
<td>
<p>A data frame with species parameters (see <code>SpParamsDefinition</code> and <code>SpParamsMED</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>A list with default control parameters (see <code>defaultControl</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Functions <code>spwbInput()</code> and <code>growthInput()</code> initialize inputs differently depending on control parameters.
</p>
<p><em>IMPORTANT NOTE</em>: Older function names <code>forest2spwbInput</code> and <code>forest2growthInput</code> are now deprecated, but 
they can still be used for back-compatibility.
</p>


<h3>Value</h3>

<p>Function <code>spwbInput()</code> returns a list of class <code>spwbInput</code> with the following elements (rows of data frames are identified as specified by function <code>plant_ID</code>):
</p>

<ul>
<li>
<p><code>control</code>: List with control parameters (see <code>defaultControl</code>).
</p>
</li>
<li>
<p><code>soil</code>: A data frame with initialized soil parameters (see <code>soil</code>).
</p>
</li>
<li>
<p><code>snowpack</code>: The amount of snow (in mm) in the snow pack over the soil.
</p>
</li>
<li>
<p><code>canopy</code>: A list of stand-level state variables.
</p>
</li>
<li>
<p><code>cohorts</code>: A data frame with cohort information, with columns <code>SP</code> and <code>Name</code>.
</p>
</li>
<li>
<p><code>above</code>: A data frame with columns  <code>H</code>, <code>CR</code> and <code>LAI</code> (see function <code>forest2aboveground</code>).
</p>
</li>
<li>
<p><code>below</code>: A data frame with columns <code>Z50</code>, <code>Z95</code>.  If <code>control$transpirationMode = "Sperry"</code> additional columns are <code>fineRootBiomass</code> and <code>coarseRootSoilVolume</code>.
</p>
</li>
<li>
<p><code>belowLayers</code>: A list. If <code>control$transpirationMode = "Granier"</code> it contains elements: 
</p>

<ul>
<li>
<p><code>V</code>: A matrix with the proportion of fine roots of each cohort (in rows) in each soil layer (in columns).
</p>
</li>
<li>
<p><code>L</code>: A matrix with the length of coarse roots of each cohort (in rows) in each soil layer (in columns).
</p>
</li>
<li>
<p><code>Wpool</code>: A matrix with the soil moisture relative to field capacity around the rhizosphere of each cohort (in rows) in each soil layer (in columns).
</p>
</li>
</ul>
<p>If <code>control$transpirationMode = "Sperry"</code> or <code>control$transpirationMode = "Sureau"</code> there are the following additional elements:
</p>

<ul>
<li>
<p><code>VGrhizo_kmax</code>: A matrix with maximum rhizosphere conductance values of each cohort (in rows) in each soil layer (in columns).
</p>
</li>
<li>
<p><code>VGroot_kmax</code>: A matrix with maximum root xylem conductance values of each cohort (in rows) in each soil layer (in columns).
</p>
</li>
<li>
<p><code>RhizoPsi</code>: A matrix with the water potential around the rhizosphere of each cohort (in rows) in each soil layer (in columns).
</p>
</li>
</ul>
</li>
<li>
<p><code>paramsPhenology</code>: A data frame with leaf phenology parameters:
</p>

<ul>
<li>
<p><code>PhenologyType</code>: Leaf phenology type.
</p>
</li>
<li>
<p><code>LeafDuration</code>: Leaf duration (in years).
</p>
</li>
<li>
<p><code>Sgdd</code>: Degree days needed for leaf budburst (for winter decideous species).
</p>
</li>
<li>
<p><code>Tbgdd</code>: Base temperature for the calculation of degree days to leaf budburst.
</p>
</li>
<li>
<p><code>Ssen</code>: Degree days corresponding to leaf senescence.
</p>
</li>
<li>
<p><code>Phsen</code>: Photoperiod corresponding to start counting senescence degree-days.
</p>
</li>
<li>
<p><code>Tbsen</code>: Base temperature for the calculation of degree days to leaf senescence.
</p>
</li>
</ul>
</li>
<li>
<p><code>paramsAnatomy</code>: A data frame with plant anatomy parameters for each cohort:
</p>

<ul>
<li>
<p><code>Hmax</code>: Maximum plant height (cm).
</p>
</li>
<li>
<p><code>Hmed</code>: Median plant height (cm).
</p>
</li>
<li>
<p><code>Al2As</code>: Leaf area to sapwood area ratio (in m2·m-2).
</p>
</li>
<li>
<p><code>Ar2Al</code>: Fine root area to leaf area ratio (in m2·m-2).
</p>
</li>
<li>
<p><code>SLA</code>: Specific leaf area (mm2/mg = m2/kg).
</p>
</li>
<li>
<p><code>LeafWidth</code>: Leaf width (in cm).
</p>
</li>
<li>
<p><code>LeafDensity</code>: Density of leaf tissue (dry weight over volume).
</p>
</li>
<li>
<p><code>WoodDensity</code>: Density of wood tissue (dry weight over volume).
</p>
</li>
<li>
<p><code>FineRootDensity</code>: Density of fine root tissue (dry weight over volume).
</p>
</li>
<li>
<p><code>SRL</code>: Specific Root length (cm·g-1).
</p>
</li>
<li>
<p><code>RLD</code>: Root length density (cm·cm-3).
</p>
</li>
<li>
<p><code>r635</code>: Ratio between the weight of leaves plus branches and the weight of leaves alone for branches of 6.35 mm.
</p>
</li>
</ul>
</li>
<li>
<p><code>paramsInterception</code>: A data frame with rain interception and light extinction parameters for each cohort:
</p>

<ul>
<li>
<p><code>kPAR</code>: PAR extinction coefficient.
</p>
</li>
<li>
<p><code>g</code>: Canopy water retention capacity per LAI unit (mm/LAI).
</p>
</li>
</ul>
<p>If <code>control$transpirationMode = "Sperry"</code> or <code>control$transpirationMode = "Sureau"</code> additional columns are:
</p>

<ul>
<li>
<p><code>gammaSWR</code>: Reflectance (albedo) coefficient for SWR .
</p>
</li>
<li>
<p><code>alphaSWR</code>: Absorbance coefficient for SWR .
</p>
</li>
</ul>
</li>
<li>
<p><code>paramsTranspiration</code>: A data frame with parameters for transpiration and photosynthesis. If <code>control$transpirationMode = "Granier"</code>, columns are:
</p>

<ul>
<li>
<p><code>Gswmin</code>: Minimum stomatal conductance to water vapor (in mol H2O·m-2·s-1).
</p>
</li>
<li>
<p><code>Tmax_LAI</code>: Coefficient relating LAI with the ratio of maximum transpiration over potential evapotranspiration.
</p>
</li>
<li>
<p><code>Tmax_LAIsq</code>: Coefficient relating squared LAI with the ratio of maximum transpiration over potential evapotranspiration.
</p>
</li>
<li>
<p><code>Psi_Extract</code>: Water potential corresponding to 50% relative transpiration (in MPa).
</p>
</li>
<li>
<p><code>Exp_Extract</code>: Parameter of the Weibull function regulating transpiration reduction.
</p>
</li>
<li>
<p><code>VCstem_c</code>, <code>VCstem_d</code>: Parameters of the stem xylem vulnerability curve (Weibull).
</p>
</li>
<li>
<p><code>WUE</code>: Daily water use efficiency (gross photosynthesis over transpiration) under no light, water or CO2 limitations and VPD = 1kPa (g C/mm water).
</p>
</li>
<li>
<p><code>WUE_par</code>: Coefficient regulating the influence of % PAR on gross photosynthesis.
</p>
</li>
<li>
<p><code>WUE_co2</code>: Coefficient regulating the influence of atmospheric CO2 concentration on gross photosynthesis.
</p>
</li>
<li>
<p><code>WUE_vpd</code>: Coefficient regulating the influence of vapor pressure deficit (VPD) on gross photosynthesis.
</p>
</li>
</ul>
<p>If <code>control$transpirationMode = "Sperry"</code> columns are:
</p>

<ul>
<li>
<p><code>Gswmin</code>: Minimum stomatal conductance to water vapor (in mol H2O·m-2·s-1).
</p>
</li>
<li>
<p><code>Gswmax</code>: Maximum stomatal conductance to water vapor (in mol H2O·m-2·s-1).
</p>
</li>
<li>
<p><code>Vmax298</code>: Maximum Rubisco carboxilation rate at 25ºC (in micromol CO2·s-1·m-2).
</p>
</li>
<li>
<p><code>Jmax298</code>: Maximum rate of electron transport at 25ºC (in micromol photons·s-1·m-2).
</p>
</li>
<li>
<p><code>Kmax_stemxylem</code>: Sapwood-specific hydraulic conductivity of stem xylem (in kg H2O·s-1·m-1·MPa-1).
</p>
</li>
<li>
<p><code>Kmax_rootxylem</code>: Sapwood-specific hydraulic conductivity of root xylem (in kg H2O·s-1·m-1·MPa-1).
</p>
</li>
<li>
<p><code>VCleaf_kmax</code>: Maximum leaf hydraulic conductance (in mmol H2O·s-1·m-2·MPa-1).
</p>
</li>
<li>
<p><code>VCleaf_c</code>, <code>VCleaf_d</code>: Parameters of the leaf vulnerability curve (Weibull).
</p>
</li>
<li>
<p><code>VCstem_kmax</code>: Maximum stem xylem conductance (in mmol H2O·s-1·m-2·MPa-1).
</p>
</li>
<li>
<p><code>VCstem_c</code>, <code>VCstem_d</code>: Parameters of the stem xylem vulnerability curve (Weibull).
</p>
</li>
<li>
<p><code>VCroot_c</code>, <code>VCroot_d</code>: Parameters of the root xylem vulnerability curve (Weibull).
</p>
</li>
<li>
<p><code>Plant_kmax</code>: Maximum whole-plant conductance (in mmol H2O·s-1·m-2·MPa-1).
</p>
</li>
<li>
<p><code>FR_leaf</code>, <code>FR_stem</code>, <code>FR_root</code>: Fraction of whole-plant resistance corresponding to each segment.
</p>
</li>
</ul>
<p>If <code>control$transpirationMode = "Sureau"</code> columns are:
</p>

<ul>
<li>
<p><code>Gswmin</code>: Minimum stomatal conductance to water vapor (in mol H2O·m-2·s-1).
</p>
</li>
<li>
<p><code>Gswmax</code>: Maximum stomatal conductance to water vapor (in mol H2O·m-2·s-1).
</p>
</li>
<li>
<p><code>Gsw_AC_slope</code>: Slope of the Gsw vs Ac/Cs relationship (see <code>photo_photosynthesisBaldocchi</code>).
</p>
</li>
<li>
<p><code>Gs_P50</code>, <code>Gs_slope</code>: Parameters of the curve describing the decrease in stomatal conductance as a function of leaf water potential (sigmoid).
</p>
</li>
<li>
<p><code>Vmax298</code>: Maximum Rubisco carboxylation rate at 25ºC (in micromol CO2·s-1·m-2).
</p>
</li>
<li>
<p><code>Jmax298</code>: Maximum rate of electron transport at 25ºC (in micromol photons·s-1·m-2).
</p>
</li>
<li>
<p><code>Kmax_stemxylem</code>: Sapwood-specific hydraulic conductivity of stem xylem (in kg H2O·s-1·m-1·MPa-1).
</p>
</li>
<li>
<p><code>Kmax_rootxylem</code>: Sapwood-specific hydraulic conductivity of root xylem (in kg H2O·s-1·m-1·MPa-1).
</p>
</li>
<li>
<p><code>VCleaf_kmax</code>: Maximum leaf hydraulic conductance (in mmol H2O·s-1·m-2·MPa-1).
</p>
</li>
<li>
<p><code>VCleaf_c</code>, <code>VCleaf_d</code>: Parameters of the leaf vulnerability curve (Weibull).
</p>
</li>
<li>
<p><code>VCleaf_P50</code>, <code>VCleaf_slope</code>: Parameters of the leaf vulnerability curve (sigmoid).
</p>
</li>
<li>
<p><code>VCstem_kmax</code>: Maximum stem xylem conductance (in mmol H2O·s-1·m-2·MPa-1).
</p>
</li>
<li>
<p><code>VCstem_c</code>, <code>VCstem_d</code>: Parameters of the stem xylem vulnerability curve (Weibull).
</p>
</li>
<li>
<p><code>VCstem_P50</code>, <code>VCstem_slope</code>: Parameters of the stem xylem vulnerability curve (sigmoid).
</p>
</li>
<li>
<p><code>VCroot_c</code>, <code>VCroot_d</code>: Parameters of the root xylem vulnerability curve (Weibull).
</p>
</li>
<li>
<p><code>VCroot_P50</code>, <code>VCroot_slope</code>: Parameters of the root xylem vulnerability curve (sigmoid).
</p>
</li>
<li>
<p><code>Plant_kmax</code>: Maximum whole-plant conductance (in mmol H2O·s-1·m-2·MPa-1).
</p>
</li>
<li>
<p><code>FR_leaf</code>, <code>FR_stem</code>, <code>FR_root</code>: Fraction of whole-plant resistance corresponding to each segment.
</p>
</li>
</ul>
</li>
<li>
<p><code>paramsWaterStorage</code>: A data frame with plant water storage parameters for each cohort:
</p>

<ul>
<li>
<p><code>LeafPI0</code>: Osmotic potential at full turgor of leaves (MPa).
</p>
</li>
<li>
<p><code>LeafEPS</code>: Modulus of elasticity (capacity of the cell wall to resist changes in volume in response to changes in turgor) of leaves (MPa).
</p>
</li>
<li>
<p><code>LeafAF</code>: Apoplastic fraction (proportion of water outside the living cells) in leaves.
</p>
</li>
<li>
<p><code>Vleaf</code>: Storage water capacity in leaves, per leaf area (L/m2).
</p>
</li>
<li>
<p><code>StemPI0</code>: Osmotic potential at full turgor of symplastic xylem tissue (MPa).
</p>
</li>
<li>
<p><code>StemEPS</code>: Modulus of elasticity (capacity of the cell wall to resist changes in volume in response to changes in turgor) of symplastic xylem tissue (Mpa).
</p>
</li>
<li>
<p><code>StemAF</code>: Apoplastic fraction (proportion of water outside the living cells) in stem xylem.
</p>
</li>
<li>
<p><code>Vstem</code>: Storage water capacity in sapwood, per leaf area (L/m2).
</p>
</li>
</ul>
</li>
<li>
<p><code>internalPhenology</code> and <code>internalWater</code>: data frames to store internal state variables.
</p>
</li>
<li>
<p><code>internalFCCS</code>: A data frame with fuel characteristics, according to <code>fuel_FCCS</code> (only if <code>fireHazardResults = TRUE</code>, in the control list).
</p>
</li>
</ul>
<p>Function <code>growthInput()</code> returns a list of class <code>growthInput</code> with the same elements as <code>spwbInput</code>, but with additional information. 
</p>

<ul>
<li>
<p>Element <code>above</code> includes the following additional columns:
</p>

<ul>
<li>
<p><code>LA_live</code>: Live leaf area per individual (m2/ind).
</p>
</li>
<li>
<p><code>LA_dead</code>: Dead leaf area per individual (m2/ind).
</p>
</li>
<li>
<p><code>SA</code>: Live sapwood area per individual (cm2/ind). 
</p>
</li>
</ul>
</li>
<li>
<p><code>paramsGrowth</code>: A data frame with growth parameters for each cohort:
</p>

<ul>
<li>
<p><code>RERleaf</code>: Maintenance respiration rates (at 20ºC) for leaves (in g gluc·g dry-1·day-1).
</p>
</li>
<li>
<p><code>RERsapwood</code>: Maintenance respiration rates (at 20ºC) for sapwood (in g gluc·g dry-1·day-1).
</p>
</li>
<li>
<p><code>RERfineroot</code>: Maintenance respiration rates (at 20ºC) for fine roots (in g gluc·g dry-1·day-1).
</p>
</li>
<li>
<p><code>CCleaf</code>: Leaf construction costs (in g gluc·g dry-1).
</p>
</li>
<li>
<p><code>CCsapwood</code>: Sapwood construction costs (in g gluc·g dry-1).
</p>
</li>
<li>
<p><code>CCfineroot</code>: Fine root construction costs (in g gluc·g dry-1).
</p>
</li>
<li>
<p><code>RGRleafmax</code>: Maximum leaf relative growth rate (in m2·cm-2·day-1).
</p>
</li>
<li>
<p><code>RGRsapwoodmax</code>: Maximum sapwood relative growth rate (in cm2·cm-2·day-1).
</p>
</li>
<li>
<p><code>RGRfinerootmax</code>: Maximum fine root relative growth rate (in g dry·g dry-1·day-1).
</p>
</li>
<li>
<p><code>SRsapwood</code>: Sapwood daily senescence rate (in day-1).
</p>
</li>
<li>
<p><code>SRfineroot</code>: Fine root daily senescence rate (in day-1).
</p>
</li>
<li>
<p><code>RSSG</code>: Minimum relative starch for sapwood growth (proportion).
</p>
</li>
<li>
<p><code>fHDmin</code>: Minimum value of the height-to-diameter ratio (dimensionless).
</p>
</li>
<li>
<p><code>fHDmax</code>: Maximum value of the height-to-diameter ratio (dimensionless).
</p>
</li>
<li>
<p><code>WoodC</code>: Wood carbon content per dry weight (g C /g dry).
</p>
</li>
</ul>
</li>
<li>
<p><code>paramsMortalityRegeneration</code>: A data frame with mortality/regeneration parameters for each cohort:
</p>

<ul>
<li>
<p><code>MortalityBaselineRate</code>: Deterministic proportion or probability specifying the baseline reduction of cohort's density occurring in a year.
</p>
</li>
<li>
<p><code>SurvivalModelStep</code>: Time step in years of the empirical survival model depending on stand basal area (e.g. 10).
</p>
</li>
<li>
<p><code>SurvivalB0</code>: Intercept of the logistic baseline survival model depending on stand basal area.
</p>
</li>
<li>
<p><code>SurvivalB1</code>: Slope of the logistic baseline survival model depending on stand basal area.
</p>
</li>
<li>
<p><code>RecrTreeDensity</code>: Density of tree recruits from seeds.
</p>
</li>
<li>
<p><code>IngrowthTreeDensity</code>: Density of trees reaching ingrowth DBH.
</p>
</li>
<li>
<p><code>RecrTreeDBH</code>: DBH for tree recruits from seeds or resprouting (e.g. 1 cm).
</p>
</li>
<li>
<p><code>IngrowthTreeDBH</code>: Ingrowth DBH for trees (e.g. 7.5 cm).
</p>
</li>
</ul>
</li>
<li>
<p><code>paramsAllometry</code>: A data frame with allometric parameters for each cohort:
</p>

<ul>
<li>
<p><code>Aash</code>: Regression coefficient relating the square of shrub height with shrub area.
</p>
</li>
<li>
<p><code>Absh</code>, <code>Bbsh</code>: Allometric coefficients relating phytovolume with dry weight of shrub individuals.
</p>
</li>
<li>
<p><code>Acr</code>, <code>B1cr</code>, <code>B2cr</code>, <code>B3cr</code>, <code>C1cr</code>, <code>C2cr</code>: Regression coefficients used to calculate crown ratio of trees.
</p>
</li>
<li>
<p><code>Acw</code>, <code>Bcw</code>: Regression coefficients used to calculated crown width of trees.
</p>
</li>
</ul>
</li>
<li> <p><code>internalAllocation</code>: A data frame with internal allocation variables for each cohort:
</p>

<ul>
<li>
<p><code>allocationTarget</code>: Value of the allocation target variable.
</p>
</li>
<li>
<p><code>leafAreaTarget</code>: Target leaf area (m2) per individual.
</p>
</li>
<li>
<p><code>sapwoodAreaTarget</code>: Target sapwood area (cm2) per individual.
</p>
</li>
<li>
<p><code>fineRootBiomassTarget</code>: Target fine root biomass (g dry) per individual.
</p>
</li>
<li>
<p><code>crownBudPercent</code>: Percentage of the crown with buds.
</p>
</li>
</ul>
</li>
<li>
<p><code>internalCarbon</code>: A data frame with the concentration (mol·gluc·l-1) of metabolic and storage carbon compartments for leaves and sapwood.
</p>
</li>
<li>
<p><code>internalMortality</code>: A data frame to store the cumulative mortality (density for trees and cover for shrubs) predicted during the simulation,
also distinguishing mortality due to starvation or dessication.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Miquel De Cáceres Ainsa, CREAF
</p>


<h3>See Also</h3>

<p><code>resetInputs</code>, <code>spwb</code>, <code>soil</code>,  
<code>forest</code>, <code>SpParamsMED</code>, <code>defaultSoilParams</code>, <code>plant_ID</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Load example plot plant data
data(exampleforest)

# Example of aboveground parameters taken from a forest
# described using LAI and crown ratio
data(exampleforest2)

#Default species parameterization
data(SpParamsMED)


# Define soil with default soil params (4 layers)
examplesoil &lt;- defaultSoilParams(4)

# Initialize control parameters using 'Granier' transpiration mode
control &lt;- defaultControl("Granier")

# Prepare spwb input
spwbInput(exampleforest, examplesoil, SpParamsMED, control)
                
# Prepare input for 'Sperry' transpiration mode
control &lt;- defaultControl("Sperry")
spwbInput(exampleforest,examplesoil,SpParamsMED, control)

# Prepare input for 'Sureau' transpiration mode
control &lt;- defaultControl("Sureau")
spwbInput(exampleforest,examplesoil,SpParamsMED, control)

# Example of initialization from a forest 
# described using LAI and crown ratio
control &lt;- defaultControl("Granier")
spwbInput(exampleforest2, examplesoil, SpParamsMED, control)

</code></pre>


</div>