<div class="container">

<table style="width: 100%;"><tr>
<td>transp_maximumTranspirationModel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Maximum transpiration vs. LAI</h2>

<h3>Description</h3>

<p>Builds a model of maximum transpiration (Tmax) over potential evapotranspiration (PET) for increasing leaf area index (LAI) values for each plant cohort.
</p>


<h3>Usage</h3>

<pre><code class="language-R">transp_maximumTranspirationModel(
  x,
  meteo,
  latitude,
  elevation,
  slope,
  aspect,
  LAI_seq = c(0.1, 0.25, seq(0.5, 10, by = 0.5)),
  draw = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class <code>spwbInput</code>, built using the 'Sperry' transpiration mode.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meteo</code></td>
<td>
<p>A data frame with daily meteorological data series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>latitude</code></td>
<td>
<p>Latitude (in degrees).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>elevation, slope, aspect</code></td>
<td>
<p>Elevation above sea level (in m), slope (in degrees) and aspect (in degrees from North).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LAI_seq</code></td>
<td>
<p>Sequence of stand LAI values to be tested.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>draw</code></td>
<td>
<p>Logical flag to indicate plotting of results.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function performs a meta-modelling exercise using the Sperry transpiration model, with the aim to estimate coefficients 
for the equation used in the Granier transpiration model (Granier et al. 1999). The model to be fitted is: <code>y ~ a*LAI + b*LAI^2</code>, 
where <code>y</code> is the ratio between maximum transpiration (Tmax) and Penman's potential evapotranspiration (PET) and <code>LAI</code> is the stand LAI. 
Unlike the original equation of Granier et al. (1999), we fit a zero intercept model so that LAI = 0 translates into zero plant transpiration. 
</p>
<p>The function fits the model for each cohort separately, assuming it represents the whole stand. 
For each stand LAI value in the input sequence, the function uses simulations with Sperry transpiration and the input weather to estimate <code>y = Tmax/PET</code> 
as a function of stand's LAI (deciduous stands include leaf phenology). 
Once simulations have been conducted for each stand LAI value, the function fits a Generalized Linear Model with the above equation, 
assuming a Gamma distribution of residuals and an identity link.
</p>
<p>The coefficients of the model can be used to parametrize Granier's transpiration, 
since coefficients <code>a</code> and <code>b</code> in the equation above correspond to parameters <code>Tmax_LAI</code> and <code>Tmax_LAIsq</code>, 
respectively (see <code>SpParamsMED</code>).
</p>


<h3>Value</h3>

<p>Returns a list with as many elements as plant cohorts, each element being a <code>glm</code> model.
</p>


<h3>Author(s)</h3>

<p>Miquel De Cáceres Ainsa, CREAF
</p>


<h3>References</h3>

<p>Granier A, Bréda N, Biron P, Villette S (1999) A lumped water balance model to evaluate duration and intensity of drought constraints in forest stands. Ecol Modell 116:269–283. https://doi.org/10.1016/S0304-3800(98)00205-1.
</p>


<h3>See Also</h3>

<p><code>spwb</code>, <code>transp_transpirationGranier</code>, <code>transp_transpirationSperry</code>, <code>SpParamsMED</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#Load example daily meteorological data
data(examplemeteo)

# Load example plot plant data
data(exampleforest)

# Load default species parameters
data(SpParamsMED)

# Define soil with default soil params
examplesoil &lt;- defaultSoilParams(4)

# Initialize control parameters for 'Sperry' transpiration mode
control &lt;- defaultControl(transpirationMode="Sperry")

# Initialize input
x2 &lt;- spwbInput(exampleforest,examplesoil, SpParamsMED, control)

# Estimate maximum transpiration ratio models for each cohort
# Weather is subset to speed-up results
m &lt;- transp_maximumTranspirationModel(x2, examplemeteo[1:10,], 
                                     41.82592, elevation = 100, 
                                     slope = 0, aspect = 0)

# Inspect the model for first cohort
m[[1]]


</code></pre>


</div>