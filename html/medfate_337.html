<div class="container">

<table style="width: 100%;"><tr>
<td>transp_stomatalregulation</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Stomatal regulation</h2>

<h3>Description</h3>

<p>Set of high-level functions used in the calculation of stomatal conductance and transpiration. 
Function <code>transp_profitMaximization</code> calculates gain and cost functions, 
as well as profit maximization from supply and photosynthesis input functions. 
Function <code>transp_stomatalRegulationPlot</code> produces a plot with the cohort supply functions against water potential 
and a plot with the cohort photosynthesis functions against water potential, both with the maximum profit values indicated.
</p>


<h3>Usage</h3>

<pre><code class="language-R">transp_profitMaximization(
  supplyFunction,
  photosynthesisFunction,
  Gswmin,
  Gswmax
)

transp_stomatalRegulationPlot(
  x,
  meteo,
  day,
  timestep,
  latitude,
  elevation,
  slope = NA,
  aspect = NA,
  type = "E"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>supplyFunction</code></td>
<td>
<p>Water supply function (see <code>hydraulics_supplyFunctionNetwork</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>photosynthesisFunction</code></td>
<td>
<p>Function returned by <code>photo_photosynthesisFunction()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gswmin, Gswmax</code></td>
<td>
<p>Minimum and maximum stomatal conductance to water vapour (mol·m-2·s-1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class <code>spwbInput</code> built using the 'Sperry' transpiration mode.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meteo</code></td>
<td>
<p>A data frame with daily meteorological data series (see <code>spwb</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>day</code></td>
<td>
<p>An integer to identify a day (a row) within <code>meteo</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timestep</code></td>
<td>
<p>An integer between 1 and <code>ndailysteps</code> specified in <code>x</code> (see <code>defaultControl</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>latitude</code></td>
<td>
<p>Latitude (in degrees).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>elevation, slope, aspect</code></td>
<td>
<p>Elevation above sea level (in m), slope (in degrees) and aspect (in degrees from North).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A string with plot type, either <code>"E"</code> (transpiration flow), <code>"Ag"</code> (gross photosynthesis), <code>"An"</code> (net photosynthesis), <code>"Gsw"</code> (stomatal conductance to water vapour), <code>"T"</code> (temperature) or <code>"VPD"</code> (leaf vapour pressure deficit).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Function <code>transp_profitMaximization</code> returns a list with the following elements:
</p>

<ul>
<li>
<p><code>Cost</code>: Cost function [0-1].
</p>
</li>
<li>
<p><code>Gain</code>: Gain function [0-1].
</p>
</li>
<li>
<p><code>Profit</code>: Profit function [0-1].
</p>
</li>
<li>
<p><code>iMaxProfit</code>: Index corresponding to maximum profit (starting from 0).
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Miquel De Cáceres Ainsa, CREAF
</p>


<h3>References</h3>

<p>Sperry, J. S., M. D. Venturas, W. R. L. Anderegg, M. Mencuccini, D. S. Mackay, Y. Wang, and D. M. Love. 2017. Predicting stomatal responses to the environment from the optimization of photosynthetic gain and hydraulic cost. Plant Cell and Environment 40, 816-830 (doi: 10.1111/pce.12852).
</p>


<h3>See Also</h3>

<p><code>transp_transpirationSperry</code>, <code>hydraulics_supplyFunctionNetwork</code>, <code>biophysics_leafTemperature</code>, <code>photo_photosynthesis</code>, <code>spwb_day</code>, <code>plot.spwb_day</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Load example daily meteorological data
data(examplemeteo)

#Load example plot plant data
data(exampleforest)

#Default species parameterization
data(SpParamsMED)

#Define soil with default soil params (4 layers)
examplesoil &lt;- defaultSoilParams(4)

#Initialize control parameters
control &lt;- defaultControl(transpirationMode="Sperry")

#Initialize input
x2 &lt;- spwbInput(exampleforest,examplesoil, SpParamsMED, control)

# Stomatal VPD curve and chosen value for the 12th time step at day 100
transp_stomatalRegulationPlot(x2, examplemeteo, day=100, timestep = 12,
                              latitude = 41.82592, elevation = 100, type="VPD")
 
</code></pre>


</div>