<div class="container">

<table style="width: 100%;"><tr>
<td>wind</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Models for canopy turbulence</h2>

<h3>Description</h3>

<p>Models for canopy turbulence by Katul et al (2004).
</p>


<h3>Usage</h3>

<pre><code class="language-R">wind_canopyTurbulenceModel(zm, Cx, hm, d0, z0, model = "k-epsilon")

wind_canopyTurbulence(
  zmid,
  LAD,
  canopyHeight,
  u,
  windMeasurementHeight = 200,
  model = "k-epsilon"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>zm</code></td>
<td>
<p>A numeric vector with height values (m).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Cx</code></td>
<td>
<p>Effective drag = Cd x leaf area density.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hm</code></td>
<td>
<p>Canopy height (m).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d0</code></td>
<td>
<p>Zero displacement height (m).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z0</code></td>
<td>
<p>Momentum roughness height (m).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Closure model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zmid</code></td>
<td>
<p>A numeric vector of mid-point heights (in cm) for canopy layers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LAD</code></td>
<td>
<p>A numeric vector of leaf area density values (m3/m2).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>canopyHeight</code></td>
<td>
<p>Canopy height (in cm).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>Measured wind speed (m/s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>windMeasurementHeight</code></td>
<td>
<p>Height of wind speed measurement with respect to canopy height (cm).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Implementation in Rcpp of the K-epsilon canopy turbulence models by Katul et al (2004) originally in Matlab code (https://nicholas.duke.edu/people/faculty/katul/k_epsilon_model.htm).
</p>


<h3>Value</h3>

<p>Function <code>wind_canopyTurbulenceModel</code> returns a data frame of vertical profiles for variables:
</p>

<ul>
<li>
<p><code>z1</code>: Height values.
</p>
</li>
<li>
<p><code>U1</code>: U/u*, where U is mean velocity and u* is friction velocity.
</p>
</li>
<li>
<p><code>dU1</code>: dUdz/u*, where dUdz is mean velocity gradient and u* is friction velocity.
</p>
</li>
<li>
<p><code>epsilon1</code>: epsilon/(u^3/h) where epsilon is the turbulent kinetic dissipation rate, u* is friction velocity and h is canopy height.
</p>
</li>
<li>
<p><code>k1</code>: k/(u*^2), where k is the turbulent kinetic energy and u* is friction velocity.
</p>
</li>
<li>
<p><code>uw1</code>: &lt;uw&gt;/(u*^2), where &lt;uw&gt; is the Reynolds stress and u* is friction velocity.
</p>
</li>
<li>
<p><code>Lmix1</code>: Mixing length.
</p>
</li>
</ul>
<p>Function <code>wind_canopyTurbulence</code> returns a data frame of vertical profiles for transformed variables:
</p>

<ul>
<li>
<p><code>zmid</code>: Input mid-point heights (in cm) for canopy layers.
</p>
</li>
<li>
<p><code>u</code>: Wind speed (m/s).
</p>
</li>
<li>
<p><code>du</code>: Mean velocity gradient (1/s).
</p>
</li>
<li>
<p><code>epsilon</code>: Turbulent kinetic dissipation rate.
</p>
</li>
<li>
<p><code>k</code>: Turbulent kinetic energy.
</p>
</li>
<li>
<p><code>uw</code>: Reynolds stress.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Miquel De Cáceres Ainsa, CREAF
</p>


<h3>References</h3>

<p>Katul GG, Mahrt L, Poggi D, Sanz C (2004) One- and two-equation models for canopy turbulence. Boundary-Layer Meteorol 113:81–109. https://doi.org/10.1023/B:BOUN.0000037333.48760.e5
</p>


<h3>See Also</h3>

<p><code>vprofile_windExtinction</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Default species parameterization
data(SpParamsMED)

#Load example plot plant data
data(exampleforest)

#Canopy height (in m)
h= max(exampleforest$treeData$Height/100) 
d0 = 0.67*h
z0 = 0.08*h

#Height values (cm)
z = seq(50,1000, by=50)
zm = z/100 # (in m)

# Leaf area density
lad = vprofile_leafAreaDensity(exampleforest, SpParamsMED, draw = FALSE,
                               z = c(0,z))
  
# Effective drag
Cd = 0.2
Cx = Cd*lad
  
# canopy turbulence model
wind_canopyTurbulenceModel(zm, Cx,h,d0,z0)

</code></pre>


</div>