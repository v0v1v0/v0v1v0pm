<div class="container">

<table style="width: 100%;"><tr>
<td>growth_day</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Single-day simulation</h2>

<h3>Description</h3>

<p>Function <code>spwb_day</code> performs water balance for a single day and <code>growth_day</code> 
performs water and carbon balance for a single day.
</p>


<h3>Usage</h3>

<pre><code class="language-R">growth_day(
  x,
  date,
  meteovec,
  latitude,
  elevation,
  slope = NA_real_,
  aspect = NA_real_,
  runon = 0,
  lateralFlows = NULL,
  waterTableDepth = NA_real_,
  modifyInput = TRUE
)

spwb_day(
  x,
  date,
  meteovec,
  latitude,
  elevation,
  slope = NA_real_,
  aspect = NA_real_,
  runon = 0,
  lateralFlows = NULL,
  waterTableDepth = NA_real_,
  modifyInput = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class <code>spwbInput</code> or <code>growthInput</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>date</code></td>
<td>
<p>Date as string "yyyy-mm-dd".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meteovec</code></td>
<td>
<p>A named numerical vector with weather data. See variable names in parameter <code>meteo</code> of <code>spwb</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>latitude</code></td>
<td>
<p>Latitude (in degrees).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>elevation, slope, aspect</code></td>
<td>
<p>Elevation above sea level (in m), slope (in degrees) and aspect (in degrees from North).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>runon</code></td>
<td>
<p>Surface water amount running on the target area from upslope (in mm).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lateralFlows</code></td>
<td>
<p>Lateral source/sink terms for each soil layer (interflow/to from adjacent locations) as mm/day.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>waterTableDepth</code></td>
<td>
<p>Water table depth (in mm). When not missing, capillarity rise will be allowed if lower than total soil depth.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modifyInput</code></td>
<td>
<p>Boolean flag to indicate that the input <code>x</code> object is allowed to be modified during the simulation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The simulation functions allow using three different sub-models of transpiration and photosynthesis:
</p>

<ul>
<li>
<p>The sub-model corresponding to 'Granier' transpiration mode is illustrated by function <code>transp_transpirationGranier</code> and was described in De Caceres et al. (2015),
and implements an approach originally described in Granier et al. (1999). 
</p>
</li>
<li>
<p>The sub-model corresponding to 'Sperry' transpiration mode is illustrated by function <code>transp_transpirationSperry</code> and was described in De Caceres et al. (2021), and
implements a modelling approach originally described in Sperry et al. (2017).  
</p>
</li>
<li>
<p>The sub-model corresponding to 'Sureau' transpiration mode is illustrated by function <code>transp_transpirationSureau</code> and was described for model SurEau-Ecos v2.0 in Ruffault et al. (2022). 
</p>
</li>
</ul>
<p>Simulations using the 'Sperry' or 'Sureau' transpiration mode are computationally much more expensive than 'Granier'.
</p>


<h3>Value</h3>

<p>Function <code>spwb_day()</code> returns a list of class <code>spwb_day</code> with the 
following elements:
</p>

<ul>
<li>
<p><code>"cohorts"</code>: A data frame with cohort information, copied from <code>spwbInput</code>.
</p>
</li>
<li>
<p><code>"topography"</code>: Vector with elevation, slope and aspect given as input. 
</p>
</li>
<li>
<p><code>"weather"</code>: A vector with the input weather.
</p>
</li>
<li>
<p><code>"WaterBalance"</code>: A vector of water balance components (rain, snow, net rain, infiltration, ...) for the simulated day, equivalent to one row of 'WaterBalance' object given in <code>spwb</code>.
</p>
</li>
<li>
<p><code>"Soil"</code>: A data frame with results for each soil layer:
</p>

<ul>
<li>
<p><code>"Psi"</code>: Soil water potential (in MPa) at the end of the day.
</p>
</li>
<li>
<p><code>"HerbTranspiration"</code>: Water extracted by herbaceous plants from each soil layer (in mm).
</p>
</li>
<li>
<p><code>"HydraulicInput"</code>: Water entering each soil layer from other layers, transported via plant roots (in mm).
</p>
</li>
<li>
<p><code>"HydraulicOutput"</code>: Water leaving each soil layer (going to other layers or the transpiration stream) (in mm).
</p>
</li>
<li>
<p><code>"PlantExtraction"</code>: Water extracted by woody plants from each soil layer (in mm).
</p>
</li>
</ul>
</li>
<li>
<p><code>"Stand"</code>: A named vector with with stand values for the simulated day, equivalent to one row of 'Stand' object returned by <code>spwb</code>.
</p>
</li>
<li>
<p><code>"Plants"</code>: A data frame of results for each plant cohort (see <code>transp_transpirationGranier</code> or <code>transp_transpirationSperry</code>).
</p>
</li>
</ul>
<p>The following items are only returned when <code>transpirationMode = "Sperry"</code> or  <code>transpirationMode = "Sureau"</code>:
</p>

<ul>
<li>
<p><code>"EnergyBalance"</code>: Energy balance of the stand (see <code>transp_transpirationSperry</code>).
</p>
</li>
<li>
<p><code>"RhizoPsi"</code>: Minimum water potential (in MPa) inside roots, after crossing rhizosphere, per cohort and soil layer.
</p>
</li>
<li>
<p><code>"SunlitLeaves"</code> and <code>"ShadeLeaves"</code>: For each leaf type, a data frame with values of LAI, Vmax298 and Jmax298 for leaves of this type in each plant cohort.
</p>
</li>
<li>
<p><code>"ExtractionInst"</code>: Water extracted by each plant cohort during each time step.
</p>
</li>
<li>
<p><code>"PlantsInst"</code>: A list with instantaneous (per time step) results for each plant cohort (see <code>transp_transpirationSperry</code>).
</p>
</li>
<li>
<p><code>"LightExtinction"</code>: A list of information regarding radiation balance through the canopy, as returned by function <code>light_instantaneousLightExtinctionAbsortion</code>.
</p>
</li>
<li>
<p><code>"CanopyTurbulence"</code>: Canopy turbulence (see <code>wind_canopyTurbulence</code>).
</p>
</li>
</ul>
<h3>Author(s)</h3>


<ul>
<li>
<p>Miquel De Cáceres Ainsa, CREAF
</p>
</li>
<li>
<p>Nicolas Martin-StPaul, URFM-INRAE
</p>
</li>
</ul>
<h3>References</h3>

<p>De Cáceres M, Martínez-Vilalta J, Coll L, Llorens P, Casals P, Poyatos R, Pausas JG, Brotons L. (2015) Coupling a water balance model with forest inventory data to predict drought stress: the role of forest structural changes vs. climate changes. Agricultural and Forest Meteorology 213: 77-90 (doi:10.1016/j.agrformet.2015.06.012).
</p>
<p>De Cáceres M, Mencuccini M, Martin-StPaul N, Limousin JM, Coll L, Poyatos R, Cabon A, Granda V, Forner A, Valladares F, Martínez-Vilalta J (2021) Unravelling the effect of species mixing on water use and drought stress in holm oak forests: a modelling approach. Agricultural and Forest Meteorology 296 (doi:10.1016/j.agrformet.2020.108233).
</p>
<p>Granier A, Bréda N, Biron P, Villette S (1999) A lumped water balance model to evaluate duration and intensity of drought constraints in forest stands. Ecol Modell 116:269–283. https://doi.org/10.1016/S0304-3800(98)00205-1.
</p>
<p>Ruffault J, Pimont F, Cochard H, Dupuy JL, Martin-StPaul N (2022) 
SurEau-Ecos v2.0: a trait-based plant hydraulics model for simulations of plant water status and drought-induced mortality at the ecosystem level.
Geoscientific Model Development 15, 5593-5626 (doi:10.5194/gmd-15-5593-2022).
</p>
<p>Sperry, J. S., M. D. Venturas, W. R. L. Anderegg, M. Mencuccini, D. S. Mackay, Y. Wang, and D. M. Love. 2017. Predicting stomatal responses to the environment from the optimization of photosynthetic gain and hydraulic cost. Plant Cell and Environment 40, 816-830 (doi: 10.1111/pce.12852).
</p>


<h3>See Also</h3>

<p><code>spwbInput</code>, <code>spwb</code>,  <code>plot.spwb_day</code>,  
<code>growthInput</code>, <code>growth</code>,  <code>plot.growth_day</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Load example daily meteorological data
data(examplemeteo)

#Load example plot plant data
data(exampleforest)

#Default species parameterization
data(SpParamsMED)

#Define soil parameters
examplesoil &lt;- defaultSoilParams(4)

# Day to be simulated
d &lt;- 100
meteovec &lt;- unlist(examplemeteo[d,-1])
date &lt;- as.character(examplemeteo$dates[d])

#Simulate water balance one day only (Granier mode)
control &lt;- defaultControl("Granier")
x1 &lt;- spwbInput(exampleforest,examplesoil, SpParamsMED, control)
sd1 &lt;- spwb_day(x1, date, meteovec,  
                latitude = 41.82592, elevation = 100, slope=0, aspect=0) 

#Simulate water balance for one day only (Sperry mode)
control &lt;- defaultControl("Sperry")
x2 &lt;- spwbInput(exampleforest, examplesoil, SpParamsMED, control)
sd2 &lt;-spwb_day(x2, date, meteovec,
              latitude = 41.82592, elevation = 100, slope=0, aspect=0)

#Plot plant transpiration (see function 'plot.swb.day()')
plot(sd2)

#Simulate water balance for one day only (Sureau mode)
control &lt;- defaultControl("Sureau")
x3 &lt;- spwbInput(exampleforest, examplesoil, SpParamsMED, control)
sd3 &lt;-spwb_day(x3, date, meteovec,
              latitude = 41.82592, elevation = 100, slope=0, aspect=0)


#Simulate water and carbon balance for one day only (Granier mode)
control &lt;- defaultControl("Granier")
x4  &lt;- growthInput(exampleforest,examplesoil, SpParamsMED, control)
sd4 &lt;- growth_day(x4, date, meteovec,
                latitude = 41.82592, elevation = 100, slope=0, aspect=0)

</code></pre>


</div>