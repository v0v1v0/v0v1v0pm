<div class="container">

<table style="width: 100%;"><tr>
<td>hydraulics_conductancefunctions</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Hydraulic confuctance functions</h2>

<h3>Description</h3>

<p>Set of functions used in the calculation of soil and plant hydraulic conductance.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hydraulics_psi2K(psi, psi_extract, exp_extract = 3)

hydraulics_K2Psi(K, psi_extract, exp_extract = 3)

hydraulics_averagePsi(psi, v, exp_extract, psi_extract)

hydraulics_xylemConductance(psi, kxylemmax, c, d)

hydraulics_xylemPsi(kxylem, kxylemmax, c, d)

hydraulics_psiCrit(c, d, pCrit = 0.001)

hydraulics_vanGenuchtenConductance(psi, krhizomax, n, alpha)

hydraulics_correctConductanceForViscosity(kxylem, temp)

hydraulics_psi2Weibull(psi50, psi88 = NA_real_, psi12 = NA_real_)

hydraulics_vulnerabilityCurvePlot(
  x,
  soil = NULL,
  type = "leaf",
  vulnerabilityFunction = "Weibull",
  psiVec = seq(-0.1, -8, by = -0.01),
  relative = FALSE,
  speciesNames = FALSE,
  draw = TRUE,
  ylim = NULL,
  xlab = NULL,
  ylab = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>psi</code></td>
<td>
<p>A scalar (or a vector, depending on the function) with water potential (in MPa).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi_extract</code></td>
<td>
<p>Soil water potential (in MPa) corresponding to 50% whole-plant relative transpiration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exp_extract</code></td>
<td>
<p>Exponent of the whole-plant relative transpiration Weibull function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Whole-plant relative conductance (0-1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>Proportion of fine roots within each soil layer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kxylemmax</code></td>
<td>
<p>Maximum xylem hydraulic conductance (defined as flow per leaf surface unit and per pressure drop).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c, d</code></td>
<td>
<p>Parameters of the Weibull function (generic xylem vulnerability curve).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kxylem</code></td>
<td>
<p>Xylem hydraulic conductance (defined as flow per surface unit and per pressure drop).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pCrit</code></td>
<td>
<p>Proportion of maximum conductance considered critical for hydraulic functioning.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>krhizomax</code></td>
<td>
<p>Maximum rhizosphere hydraulic conductance (defined as flow per leaf surface unit and per pressure drop).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n, alpha</code></td>
<td>
<p>Parameters of the Van Genuchten function (rhizosphere vulnerability curve).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>temp</code></td>
<td>
<p>Temperature (in degrees Celsius).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi50, psi88, psi12</code></td>
<td>
<p>Water potentials (in MPa) corresponding to 50%, 88% and 12% percent conductance loss.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class <code>spwbInput</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>soil</code></td>
<td>
<p>A list containing the description of the soil (see <code>soil</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Plot type for <code>hydraulics_vulnerabilityCurvePlot</code>, either <code>"leaf"</code>, 
<code>"stem"</code>, <code>"root"</code> or <code>"rhizosphere"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vulnerabilityFunction</code></td>
<td>
<p>String indicating the function used to represent vulnerability in plant segments, either "Weibull" or "Sigmoid".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psiVec</code></td>
<td>
<p>Vector of water potential values to evaluate for the vulnerability curve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>relative</code></td>
<td>
<p>A flag to relativize vulnerability curves to the [0-1] interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>speciesNames</code></td>
<td>
<p>A flag to indicate the use of species names instead of cohort names in plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>draw</code></td>
<td>
<p>A flag to indicate whether the vulnerability curve should be drawn or just returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim, xlab, ylab</code></td>
<td>
<p>Graphical parameters to override function defaults.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Details of plant hydraulic models are given the medfate book. 
Function <code>hydraulics_vulnerabilityCurvePlot</code> draws a plot of the vulnerability curves for the given <code>soil</code> object and network properties of each plant cohort in <code>x</code>.
</p>


<h3>Value</h3>

<p>Values returned for each function are:
</p>

<ul>
<li>
<p><code>hydraulics_psi2K</code>: Whole-plant relative conductance (0-1).
</p>
</li>
<li>
<p><code>hydraulics_K2Psi</code>: Soil water potential (in MPa) corresponding to the given whole-plant relative conductance value (inverse of <code>hydraulics_psi2K()</code>).
</p>
</li>
<li>
<p><code>hydraulics_averagePsi</code>: The average water potential (in MPa) across soil layers.
</p>
</li>
<li>
<p><code>hydraulics_vanGenuchtenConductance</code>: Rhizosphere conductance corresponding to an input water potential (soil vulnerability curve).
</p>
</li>
<li>
<p><code>hydraulics_xylemConductance</code>: Xylem conductance (flow rate per pressure drop) corresponding to an input water potential (plant vulnerability curve).
</p>
</li>
<li>
<p><code>hydraulics_xylemPsi</code>: Xylem water potential (in MPa) corresponding to an input xylem conductance (flow rate per pressure drop).
</p>
</li>
<li>
<p><code>hydraulics_psi2Weibull</code>: Parameters of the Weibull vulnerability curve that goes through the supplied psi50 and psi88 values.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Miquel De Cáceres Ainsa, CREAF
</p>


<h3>References</h3>

<p>Sperry, J. S., F. R. Adler, G. S. Campbell, and J. P. Comstock. 1998. Limitation of plant water use by rhizosphere and xylem conductance: results from a model. Plant, Cell and Environment 21:347–359.
</p>
<p>Sperry, J. S., and D. M. Love. 2015. What plant hydraulics can tell us about responses to climate-change droughts. New Phytologist 207:14–27.
</p>


<h3>See Also</h3>

<p><code>hydraulics_supplyFunctionPlot</code>, <code>hydraulics_maximumStemHydraulicConductance</code>, <code>spwb</code>, <code>soil</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#Manual display of vulnerability curve
kstemmax = 4 # in mmol·m-2·s-1·MPa-1
stemc = 3 
stemd = -4 # in MPa
psiVec = seq(-0.1, -7.0, by =-0.01)
kstem = unlist(lapply(psiVec, hydraulics_xylemConductance, kstemmax, stemc, stemd))
plot(-psiVec, kstem, type="l",ylab="Xylem conductance (mmol·m-2·s-1·MPa-1)", 
     xlab="Canopy pressure (-MPa)", lwd=1.5,ylim=c(0,kstemmax))

#Load example dataset
data(exampleforest)

#Default species parameterization
data(SpParamsMED)

#Initialize soil with default soil params (4 layers)
examplesoil &lt;- defaultSoilParams(4)

#Initialize control parameters
control &lt;- defaultControl("Granier")

#Switch to 'Sperry' transpiration mode
control &lt;- defaultControl("Sperry")

#Initialize input
x &lt;- spwbInput(exampleforest,examplesoil, SpParamsMED, control)

#Leaf vulnerability curves
hydraulics_vulnerabilityCurvePlot(x, type="leaf")

#Stem vulnerability curves
hydraulics_vulnerabilityCurvePlot(x, type="stem")
             
</code></pre>


</div>