<div class="container">

<table style="width: 100%;"><tr>
<td>spwb_land_day</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>One-day watershed simulations</h2>

<h3>Description</h3>

<p>Functions to perform one-day simulations on a watershed described by a set of connected grid cells.
</p>

<ul>
<li>
<p>Function <code>spwb_land_day</code> implements a distributed hydrological model that simulates daily local water balance, from <code>spwb_day</code>,
on grid cells of a watershed while accounting for overland runoff, subsurface flow and groundwater flow between cells.
</p>
</li>
<li>
<p>Function <code>growth_land_day</code> is similar to <code>spwb_land_day</code>, but includes daily local carbon balance, growth and mortality processes in grid cells,
provided by <code>growth_day</code>.
</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">spwb_land_day(
  r,
  sf,
  SpParams,
  meteo = NULL,
  date = NULL,
  local_control = medfate::defaultControl(),
  watershed_control = default_watershed_control(),
  parallelize = FALSE,
  num_cores = detectCores() - 1,
  chunk_size = NULL,
  progress = TRUE
)

growth_land_day(
  r,
  sf,
  SpParams,
  meteo = NULL,
  date = NULL,
  local_control = medfate::defaultControl(),
  watershed_control = default_watershed_control(),
  parallelize = FALSE,
  num_cores = detectCores() - 1,
  chunk_size = NULL,
  progress = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>An object of class <code>SpatRaster</code>, defining the raster topology.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sf</code></td>
<td>
<p>An object of class <code>sf</code> as described in <code>spwb_land</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SpParams</code></td>
<td>
<p>A data frame with species parameters (see <code>SpParamsMED</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meteo</code></td>
<td>
<p>Input meteorological data (see <code>spwb_spatial</code> and details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>date</code></td>
<td>
<p>A string with the date to be simulated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>local_control</code></td>
<td>
<p>A list of control parameters (see <code>defaultControl</code>) for function <code>spwb_day</code> or <code>growth_day</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>watershed_control</code></td>
<td>
<p>A list of watershed control parameters (see <code>default_watershed_control</code>). Importantly, the sub-model used
for lateral water flows - either Francés et al. (2007) or Caviedes-Voullième et al. (2023) - is specified there.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallelize</code></td>
<td>
<p>Boolean flag to try parallelization (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_cores</code></td>
<td>
<p>Integer with the number of cores to be used for parallel computation (by default it will use all clusters minus one).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chunk_size</code></td>
<td>
<p>Integer indicating the size of chunks to be sent to different processes (by default, the number of spatial elements divided by the number of cores).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>
<p>Boolean flag to display progress information for simulations.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See details in <code>spwb_land</code>.
</p>


<h3>Value</h3>

<p>Functions <code>spwb_land_day</code> and <code>spwb_land_day</code> return a sf object:
</p>

<ul>
<li>
<p><code>geometry</code>: Spatial geometry.
</p>
</li>
<li>
<p><code>state</code>: A list of model input objects for each simulated stand.
</p>
</li>
<li>
<p><code>aquifer</code>: A numeric vector with the water volume in the aquifer of each cell.
</p>
</li>
<li>
<p><code>snowpack</code>: A numeric vector with the snowpack water equivalent volume of each cell.
</p>
</li>
<li>
<p><code>result</code>: A list of cell detailed results (only for those indicated in the input), with contents depending on the local model.
</p>
</li>
<li>
<p><code>outlet</code>: A logical vector indicating outlet cells.
</p>
</li>
<li>
<p><code>MinTemperature</code>: Minimum temperature (degrees Celsius).
</p>
</li>
<li>
<p><code>MaxTemperature</code>: Maximum temperature (degrees Celsius).
</p>
</li>
<li>
<p><code>PET</code>: Potential evapotranspiration (in mm).
</p>
</li>
<li>
<p><code>Rain</code>: Rainfall (in mm).
</p>
</li>
<li>
<p><code>Snow</code>: Snowfall (in mm).
</p>
</li>
<li>
<p><code>Snowmelt</code>: Snow melt (in mm).
</p>
</li>
<li>
<p><code>Interception</code>: Rainfall interception (in mm).
</p>
</li>
<li>
<p><code>NetRain</code>: Net rainfall, i.e. throughfall, (in mm).
</p>
</li>
<li>
<p><code>Infiltration</code>: The amount of water infiltrating into the soil (in mm).
</p>
</li>
<li>
<p><code>InfiltrationExcess</code>: The amount of water exceeding the soil infiltration capacity (in mm).
</p>
</li>
<li>
<p><code>SaturationExcess</code>: The amount of water that reaches the soil surface because of soil saturation (in mm).
</p>
</li>
<li>
<p><code>Runoff</code>: The amount of water exported via surface runoff (in mm).
</p>
</li>
<li>
<p><code>DeepDrainage</code>: The amount of water draining from soil to the aquifer via deep drainage (in mm).
</p>
</li>
<li>
<p><code>CapillarityRise</code>: Water entering the soil via capillarity rise (mm) from the water table.
</p>
</li>
<li>
<p><code>SoilEvaporation</code>: Bare soil evaporation (in mm).
</p>
</li>
<li>
<p><code>Transpiration</code>: Woody plant transpiration (in mm).
</p>
</li>
<li>
<p><code>HerbTranspiration</code>: Herbaceous transpiration (in mm).
</p>
</li>
<li>
<p><code>InterflowInput</code>: The amount of water that reaches the soil of the cell from adjacent cells via subsurface flow (in mm).
</p>
</li>
<li>
<p><code>InterflowOutput</code>: The amount of water that leaves the soil of the cell towards adjacent cells via subsurface flow (in mm).
</p>
</li>
<li>
<p><code>InterflowBalance</code>: The balance of water circulating via subsurface flow (in mm).
</p>
</li>
<li>
<p><code>BaseflowInput</code>: The amount of water that reaches the aquifer of the cell from adjacent cells via groundwater flow (in mm).
</p>
</li>
<li>
<p><code>BaseflowOutput</code>: The amount of water that leaves the aquifer of the cell towards adjacent cells via groundwater flow (in mm).
</p>
</li>
<li>
<p><code>BaseflowBalance</code>: The balance of water circulating via groundwater flow (in mm).
</p>
</li>
<li>
<p><code>AquiferExfiltration</code>: The amount of water of the cell that generates surface runoff due to the aquifer reaching the soil surface (in mm).
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Miquel De Cáceres Ainsa, CREAF.
</p>
<p>Maria González-Sanchís, Universitat Politecnica de Valencia.
</p>
<p>Daniel Caviedes-Voullième, Forschungszentrum Julich.
</p>
<p>Mario Morales-Hernández, Universidad de Zaragoza.
</p>


<h3>References</h3>

<p>Francés, F., Vélez, J.I. &amp; Vélez, J.J. (2007). Split-parameter structure for the automatic calibration of distributed hydrological models. Journal of Hydrology, 332, 226–240.
</p>
<p>Caviedes-Voullième, D., Morales-Hernández, M., Norman, M.R. &amp; Ogzen-Xian, I. (2023). SERGHEI (SERGHEI-SWE) v1.0: a performance-portable high-performance parallel-computing shallow-water solver for hydrology and environmental hydraulics. Geoscientific Model Development, 16, 977-1008.
</p>


<h3>See Also</h3>

<p><code>default_watershed_control</code>,  <code>spwb_day</code>,  <code>growth_day</code>,
<code>spwb_land</code>,
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load example watershed data after burnin period
data("example_watershed_burnin")

# Set request for daily model results in cells number 3, 6 (outlet) and 9
example_watershed_burnin$result_cell &lt;- FALSE
example_watershed_burnin$result_cell[c(3,6,9)] &lt;- TRUE

# Get bounding box to determine limits
b &lt;- sf::st_bbox(example_watershed_burnin)
b

# Define a raster topology, using terra package, 
# with the same CRS as the watershed. In this example cells have 100 m side.
# Coordinates in the 'sf' object are assumed to be cell centers
r &lt;-terra::rast(xmin = 401380, ymin = 4671820, xmax = 402880, ymax = 4672620, 
                nrow = 8, ncol = 15, crs = "epsg:32631")

# Load example meteo data frame from package meteoland
data("examplemeteo")
  
# Load default medfate parameters
data("SpParamsMED")
  
# Watershed control parameters (TETIS model; Frances et al. 2007)
ws_control &lt;- default_watershed_control("tetis")

# Launch simulation 
date &lt;- "2001-03-01"
sf_out &lt;- spwb_land_day(r, example_watershed_burnin, SpParamsMED, examplemeteo, 
                        date = date, 
                        watershed_control = ws_control)

</code></pre>


</div>