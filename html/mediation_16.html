<div class="container">

<table style="width: 100%;"><tr>
<td>medsens</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sensitivity Analysis for Causal Mediation Effects</h2>

<h3>Description</h3>

<p>'medsens' is used to perform sensitivity analysis on the average causal 
mediation effects and direct effects for violations of the sequential 
ignorability assumption.  The function takes output from '<code>mediate</code>' and
calculates the true average causal mediation effects and direct effects for
different values of the sensitivity parameter representing the degree of the
sequential ignorability violation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">medsens(x, rho.by = 0.1, sims = 1000,
  eps = sqrt(.Machine$double.eps), effect.type = c("indirect",
  "direct", "both"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class 'mediate', typically an output from the 
<code>mediate</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho.by</code></td>
<td>
<p>a numeric value between 0 and 1 indicating the increment for 
the sensitivity parameter, rho.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sims</code></td>
<td>
<p>the number of Monte Carlo draws for the calculation of confidence
intervals. Only used in cases where either the mediator or outcome variable
is binary.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>convergence tolerance parameter for the iterative FGLS. Only used 
when both the mediator and outcome models are linear.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effect.type</code></td>
<td>
<p>a character string indicating which effect(s) to be 
analyzed.  Default is "indirect".</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is the workhorse function for sensitivity analyses for average
causal mediation effects. The sensitivity analysis can be used to assess
the robustness of the findings from <code>mediate</code> to the violation of 
sequential ignorability, the crucial identification assumption necessary
for the estimates to be valid. The analysis proceeds by quantifying the
degree of sequential ignorability violation as the correlation between the
error terms of the mediator and outcome models, and then calculating the
true values of the average causal mediation effect for given values of this
sensitivity parameter, rho. The original findings are deemed sensitive if 
the true effects are found to vary widely as function of rho.
</p>
<p>The sensitivity analysis is only implemented for the following three model 
combinations: linear mediator and outcome models (both of class 'lm'), 
binary probit mediator (fitted via 'glm' with family "binomial" and link 
"probit") and linear outcome models, and linear mediator and binary probit 
outcome models.  In addition, the binary outcome model cannot include a 
treatment-mediator interaction term. An error is returned if the 'mediate' 
object in 'x' is based on other model combinations.  As of version 3.0, the
sensitivity analysis can also be conducted with respect to the average 
direct effect by setting 'effect.type' to "direct" (or "both" if results
for the average causal mediation effect are also desired).
</p>
<p>Users should note that computation can take significant time for 
<code>medsens</code>. Setting 'rho.by' to a larger number significantly decreases
computational time, as does decreasing 'eps' (for the linear-linear case)
or the number of simulations 'sims' (for the binary-linear and
linear-binary cases).
</p>


<h3>Value</h3>

<p><code>medsens</code> returns an object of class "<code>medsens</code>", a list 
containing the following elements. Some of these elements are not available
depending on the 'effect.type' argument specified by the user. The output 
can then be passed to the <code>summary</code> (i.e., 
<code>summary.medsens</code>) and <code>plot</code> (i.e., 
<code>plot.medsens</code>) functions to produce tabular and graphical 
summaries of the results.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>d0, d1</code></td>
<td>
<p>vectors of point estimates for average causal mediation 
effects under the control and treatment conditions for each value of 
sensitivity parameter rho.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper.d0, lower.d0, upper.d1, lower.d1</code></td>
<td>
<p>vectors of upper and lower 
confidence limits for average causal mediation effect under the control 
and treatment conditions for each value of rho.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z0, z1</code></td>
<td>
<p>vectors of point estimates for average direct effect under 
the control and treatment conditions for each value of sensitivity 
parameter rho.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper.z0, lower.z0, upper.z1, lower.z1</code></td>
<td>
<p>vectors of upper and lower 
confidence limits for average direct effect under the control and 
treatment conditions for each value of rho.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>a vector of point estimates for total effect for each value of 
rho.  Only present when the outcome model is binary.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper.tau, lower.tau</code></td>
<td>
<p>vectors of upper and lower confidence limits 
for total effect.  Only present when the outcome model is binary.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>a vector of point estimates for the proportion mediated for each 
value of rho.  Only present when the outcome model is binary.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper.nu, lower.nu</code></td>
<td>
<p>vectors of upper and lower confidence limits 
for the proportion mediated.  Only present when the outcome model is binary.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>a numeric vector containing the values of sensitivity 
parameter rho used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho.by</code></td>
<td>
<p>a numeric value indicating the increment of rho used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sims</code></td>
<td>
<p>a numeric value indicating the number of Monte Carlo draws 
used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>err.cr.d, err.cr.z</code></td>
<td>
<p>the values of rho with which the average causal 
mediation and direct effects are zero.  Vectors of length two if 'INT' is 
'TRUE'; numeric values otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ind.d0, ind.d1, ind.z0, ind.z1</code></td>
<td>
<p>vectors of 0s/1s, indicating whether 
the confidence intervals of d0, d1, z0 and z1 do not cover zero for each 
value of rho.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R2star.prod</code></td>
<td>
<p>a numeric vector containing the values of the products 
of the two "R square stars", representing the proportions of residual 
variance in the mediator and outcome explained by the hypothesized 
unobserved confounder. The values correspond to those of rho. See 
<code>plot.medsens</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R2tilde.prod</code></td>
<td>
<p>a numeric vector containing the values of the products 
of the two "R square tildes", representing the proportions of total 
variance in the mediator and outcome explained by the hypothesized 
unobserved confounder. The values correspond to those of rho. See 
<code>plot.medsens</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R2star.d.thresh, R2star.z.thresh</code></td>
<td>
<p>the values of the product of "R 
square stars" for which the average causal mediation and direct effects are 
zero, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R2tilde.d.thresh, R2tilde.z.thresh</code></td>
<td>
<p>the values of the product of "R 
square tildes" for which the average causal mediation and direct effects 
are zero, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r.square.y, r.square.m</code></td>
<td>
<p>the usual R square statistics for the 
outcome and mediator models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>INT</code></td>
<td>
<p>a logical value indicating whether interaction between the 
treatment and mediator is allowed in the original mediate object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>the confidence level used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effect.type</code></td>
<td>
<p>the 'effect.type' argument used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>a character string indicating the type of the mediator and 
outcome models used. Currently either "ct" (linear mediator and outcome 
models), 'bm' (binary mediator and linear outcome models) or 'bo' (linear 
mediator and binary outcome models).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robustSE</code></td>
<td>
<p>‘TRUE’ or ‘FALSE’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>the clusters used.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Dustin Tingley, Harvard University, 
<a href="mailto:dtingley@gov.harvard.edu">dtingley@gov.harvard.edu</a>; Teppei Yamamoto, Massachusetts Institute
of Technology, <a href="mailto:teppei@mit.edu">teppei@mit.edu</a>; Jaquilyn Waddell-Boie, Princeton 
University, <a href="mailto:jwaddell@princeton.edu">jwaddell@princeton.edu</a>; Kentaro Hirose, Princeton 
University, <a href="mailto:hirose@princeton.edu">hirose@princeton.edu</a>; Luke Keele, Penn State 
University, <a href="mailto:ljk20@psu.edu">ljk20@psu.edu</a>; Kosuke Imai, Princeton University, 
<a href="mailto:kimai@princeton.edu">kimai@princeton.edu</a>.
</p>


<h3>References</h3>

<p>Tingley, D., Yamamoto, T., Hirose, K., Imai, K. and Keele, L. 
(2014). "mediation: R package for Causal Mediation Analysis", Journal of 
Statistical Software, Vol. 59, No. 5, pp. 1-38.
</p>
<p>Imai, K., Keele, L., Tingley, D. and Yamamoto, T. (2011). Unpacking the 
Black Box of Causality: Learning about Causal Mechanisms from Experimental 
and Observational Studies, American Political Science Review, Vol. 105, No.
4 (November), pp. 765-789.
</p>
<p>Imai, K., Keele, L. and Tingley, D. (2010) A General Approach to Causal 
Mediation Analysis, Psychological Methods, Vol. 15, No. 4 (December), pp. 
309-334.
</p>
<p>Imai, K., Keele, L. and Yamamoto, T. (2010) Identification, Inference, and 
Sensitivity Analysis for Causal Mediation Effects, Statistical Science,
Vol. 25, No. 1 (February), pp. 51-71.
</p>
<p>Imai, K., Keele, L., Tingley, D. and Yamamoto, T. (2009) "Causal Mediation 
Analysis Using R" in Advances in Social Science Research Using R, ed. H. D.
Vinod New York: Springer.
</p>


<h3>See Also</h3>

<p><code>mediate</code>, <code>summary.medsens</code>, 
<code>plot.medsens</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Examples with JOBS II Field Experiment

# **For illustration purposes a small number of simulations are used**

data(jobs)

####################################################
# Example 1: Binary treatment 
####################################################
# Fit parametric models
b &lt;- lm(job_seek ~ treat + econ_hard + sex + age, data=jobs)
c &lt;- lm(depress2 ~ treat + job_seek + econ_hard + sex + age, data=jobs)

# Pass model objects through mediate function
med.cont &lt;- mediate(b, c, treat="treat", mediator="job_seek", sims=50)
# med.cont &lt;- mediate(b, c, treat="treat", mediator="job_seek", sims=50, robustSE = T)
# jobs$cluster &lt;- rep(1:30, each = 30)[-1]
# med.cont &lt;- mediate(b, c, treat="treat", mediator="job_seek", sims=50, cluster = jobs$cluster)

# Pass mediate output through medsens function
sens.cont &lt;- medsens(med.cont, rho.by=.1, eps=.01, effect.type="both")

# Use summary function to display results
summary(sens.cont)

# Plot true ACMEs and ADEs as functions of rho
par.orig &lt;- par(mfrow = c(2,2))
plot(sens.cont, main="JOBS", ylim=c(-.2,.2))

# Plot true ACMEs and ADEs as functions of "R square tildes"
plot(sens.cont, sens.par="R2", r.type="total", sign.prod="positive")
par(par.orig)

####################################################
# Example 2: Categorical treatment 
####################################################
## Not run: 

# Purely for illustration, think of educ as a ``treatment''

b &lt;- lm(job_seek ~ educ + sex, data=jobs)
c &lt;- lm(depress2 ~ educ + job_seek + sex, data=jobs)

# compare two categories of educ --- gradwk and somcol
med.cont &lt;- mediate(b, c, treat="educ", mediator="job_seek", sims=50, 
                    control.value = "gradwk", treat.value = "somcol")
sens.cont &lt;- medsens(med.cont, rho.by=.1, eps=.01, effect.type="both")
summary(sens.cont)

## End(Not run)

</code></pre>


</div>