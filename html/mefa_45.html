<div class="container">

<table style="width: 100%;"><tr>
<td>melt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Melt (Convert) an Object of Class 'mefa' Into 'stcs'</h2>

<h3>Description</h3>

<p>The function converts a wide formatted 'mefa' object into a long formatted 'stcs' object. The resulting segment column can take various formats.
</p>


<h3>Usage</h3>

<pre><code class="language-R">melt(x, ...)
## S3 method for class 'mefa'
melt(x, segm.var = NULL, by.samp = TRUE,
raw.out = FALSE, drop.zero = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class 'mefa'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>segm.var</code></td>
<td>
<p><code>NULL</code> (default) or column indices of samples (if <code>by.samp = TRUE</code>) or taxa tables (if <code>by.samp = FALSE</code>). If it refers to more than one column, their interaction is taken. If <code>NULL</code>, the resulting segment column is filled with <code>"undefined"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by.samp</code></td>
<td>
<p>logical, if <code>TRUE</code> (default) <code>segm.var</code> is taken from the samples table (<code>x$samp</code>), if <code>FALSE</code> <code>segm.var</code> is taken from the taxa table (<code>x$taxa</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>raw.out</code></td>
<td>
<p>logical, whether the result should contain all the zeros that is in the crosstabulated (wide) matrix (<code>TRUE</code>) or not (<code>FALSE</code>, default). Removing the zeros is straightforward for sparse matrices. But empty samples can be retained if <code>drop.zero = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop.zero</code></td>
<td>
<p>logical, whether samples with zero total count should be leaved out (<code>TRUE</code>) or not (<code>FALSE</code>, default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments passed to the function <code>stcs</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If a 'mefa' objet has original segments and <code>segm.var = NULL</code>, the function returns original segments. In this case, the <code>raw.out = TRUE</code> cannot be applied (because segments have different zero samples, so the option is meaningless). If the 'mefa' object contains only a data matrix without dimnames, rows and columns are numbered before melting.
</p>
<p>Besides the goal to convert from wide format to long format, this 'mefa' specific implementation is also useful, if a segment is not coded along with the long formatted database, but can be found in a linked table of samples or species. In this way, a 'mefa' object with new segments can be defined easily.
</p>
<p>If melting is done with a vector that is not part of the tables inside the 'mefa' object, it must have a class attribute to be recognised, use e.g. the <code>as.factor</code> function (see 'Examples').
</p>


<h3>Value</h3>

<p>An object of class 'stsc' if <code>raw = FALSE</code>, pure 'data.frame' otherwise (because the zero count flag cannot be applied).
</p>


<h3>Author(s)</h3>

<p>P\'eter S\'olymos, <a href="mailto:solymos@ualberta.ca">solymos@ualberta.ca</a>
</p>


<h3>References</h3>

<p>S\'olymos P. (2008) mefa: an R package for handling and reporting count data. <em>Community Ecology</em> <b>9</b>, 125–127.
</p>
<p>S\'olymos P. (2009) Processing ecological data in R with the mefa package. <em>Journal of Statistical Software</em> <b>29(8)</b>, 1–28. <a href="https://doi.org/10.18637/jss.v029.i08">doi:10.18637/jss.v029.i08</a>
</p>
<p><a href="http://mefa.r-forge.r-project.org/">http://mefa.r-forge.r-project.org/</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(dol.count, dol.samp, dol.taxa)
x &lt;- mefa(stcs(dol.count), dol.samp, dol.taxa)
## Long format with original segments
melt(x)
## Long format with undefined segment
melt(as.mefa(x, segment = FALSE))
## These two are identical
melt(x, "microhab")
melt(x, x$samp$microhab) ## this is a factor
## Using a simple vector as factor
melt(x, as.factor(rbinom(dim(x)[1], 1, 0.5)))
## Interaction
melt(x, c("method", "microhab"))
## From taxa table
melt(x, "familia", by.samp = FALSE)
## Example for non-integer data
y &lt;- x$xtab
y[y &gt; 0] &lt;-  y[y &gt; 0] + 0.123
z &lt;- mefa(y)
melt(z)
</code></pre>


</div>