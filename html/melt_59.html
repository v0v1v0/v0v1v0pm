<div class="container">

<table style="width: 100%;"><tr>
<td>el_eval</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Empirical likelihood for general estimating functions</h2>

<h3>Description</h3>

<p>Computes empirical likelihood with general estimating functions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">el_eval(g, weights = NULL, control = el_control())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>A numeric matrix, or an object that can be coerced to a numeric
matrix. Each row corresponds to an observation of an estimating function.
The number of rows must be greater than the number of columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>An optional numeric vector of weights to be used in the
fitting process. The length of the vector must be the same as the number of
rows in <code>g</code>. Defaults to <code>NULL</code>, corresponding to identical weights. If
non-<code>NULL</code>, weighted empirical likelihood is computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>An object of class ControlEL constructed by
<code>el_control()</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Let <code class="reqn">X_i</code> be independent and identically distributed
<code class="reqn">p</code>-dimensional random variable from an unknown distribution <code class="reqn">P</code>
for <code class="reqn">i = 1, \dots, n</code>. We assume that <code class="reqn">P</code> has a positive definite
covariance matrix. For a parameter of interest
<code class="reqn">\theta(F) \in {\rm{I\!R}}^p</code>, consider a <code class="reqn">p</code>-dimensional smooth
estimating function <code class="reqn">g(X_i, \theta)</code> with a moment condition
</p>
<p style="text-align: center;"><code class="reqn">\textrm{E}[g(X_i, \theta)] = 0.</code>
</p>

<p>We assume that there exists an unique <code class="reqn">\theta_0</code> that solves the above
equation. Given a value of <code class="reqn">\theta</code>, the (profile) empirical likelihood
ratio is defined by
</p>
<p style="text-align: center;"><code class="reqn">R(\theta) =
  \max_{p_i}\left\{\prod_{i = 1}^n np_i :
  \sum_{i = 1}^n p_i g(X_i, \theta) = 0, p_i \geq 0, \sum_{i = 1}^n p_i = 1
  \right\}.</code>
</p>

<p><code>el_mean()</code> computes the empirical log-likelihood ratio statistic
<code class="reqn">-2\log R(\theta)</code> with the <code class="reqn">n</code> by <code class="reqn">p</code> numeric matrix <code>g</code>,
whose <code class="reqn">i</code>th row is <code class="reqn">g(X_i, \theta)</code>. Since the estimating function
can be arbitrary, <code>el_eval()</code> does not return an object of class
EL, and the associated generics and methods are not
applicable.
</p>


<h3>Value</h3>

<p>A list of the following optimization results:
</p>

<ul>
<li> <p><code>optim</code> A list with the following optimization results:
</p>

<ul>
<li> <p><code>lambda</code> A numeric vector of the Lagrange multipliers of the dual
problem.
</p>
</li>
<li> <p><code>iterations</code> A single integer for the number of iterations performed.
</p>
</li>
<li> <p><code>convergence</code> A single logical for the convergence status.
</p>
</li>
</ul>
</li>
<li> <p><code>logp</code> A numeric vector of the log probabilities of the empirical
likelihood.
</p>
</li>
<li> <p><code>logl</code> A single numeric of the empirical log-likelihood.
</p>
</li>
<li> <p><code>loglr</code> A single numeric of the empirical log-likelihood ratio.
</p>
</li>
<li> <p><code>statistic</code> A single numeric of minus twice the empirical log-likelihood
ratio with an asymptotic chi-square distribution.
</p>
</li>
<li> <p><code>df</code> A single integer for the degrees of freedom of the statistic.
</p>
</li>
<li> <p><code>pval</code> A single numeric for the <code class="reqn">p</code>-value of the statistic.
</p>
</li>
<li> <p><code>nobs</code> A single integer for the number of observations.
</p>
</li>
<li> <p><code>npar</code> A single integer for the number of parameters.
</p>
</li>
<li> <p><code>weights</code> A numeric vector of the re-scaled weights used for the model
fitting.
</p>
</li>
</ul>
<h3>References</h3>

<p>Qin J, Lawless J (1994).
“Empirical Likelihood and General Estimating Equations.”
<em>The Annals of Statistics</em>, <strong>22</strong>(1), 300–325.
<a href="https://doi.org/10.1214/aos/1176325370">doi:10.1214/aos/1176325370</a>.
</p>


<h3>See Also</h3>

<p>EL, <code>el_control()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123526)
mu &lt;- 0
sigma &lt;- 1
x &lt;- rnorm(100)
g &lt;- matrix(c(x - mu, (x - mu)^2 - sigma^2), ncol = 2)
el_eval(g, weights = rep(c(1, 2), each = 50))
</code></pre>


</div>