<div class="container">

<table style="width: 100%;"><tr>
<td>el_glm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Empirical likelihood for generalized linear models</h2>

<h3>Description</h3>

<p>Fits a generalized linear model with empirical likelihood.
</p>


<h3>Usage</h3>

<pre><code class="language-R">el_glm(
  formula,
  family = gaussian,
  data,
  weights = NULL,
  na.action,
  start = NULL,
  etastart = NULL,
  mustart = NULL,
  offset,
  control = el_control(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>An object of class <code>formula</code> (or one that can be coerced to
that class): a symbolic description of the model to be fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>A description of the error distribution and link function to be
used in the model. Only the result of a call to a family function is
supported. See ‘Details’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>An optional data frame, list or environment (or object coercible
by <code>as.data.frame()</code> to a data frame) containing the variables in the
formula. If not found in data, the variables are taken from
<code>environment(formula)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>An optional numeric vector of weights to be used in the
fitting process. Defaults to <code>NULL</code>, corresponding to identical weights. If
non-<code>NULL</code>, weighted empirical likelihood is computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>A function which indicates what should happen when the data
contain <code>NA</code>s. The default is set by the <code>na.action</code> setting of
<code>options</code>, and is <code>na.fail</code> if that is unset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>Starting values for the parameters in the linear predictor.
Defaults to <code>NULL</code> and is passed to <code>glm.fit()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>etastart</code></td>
<td>
<p>Starting values for the linear predictor. Defaults to <code>NULL</code>
and is passed to <code>glm.fit()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mustart</code></td>
<td>
<p>Starting values for the vector of means. Defaults to <code>NULL</code>
and is passed to <code>glm.fit()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>An optional expression for specifying an <em>a priori</em> known
component to be included in the linear predictor during fitting. This
should be <code>NULL</code> or a numeric vector or matrix of extents matching those of
the response. One or more <code>offset</code> terms can be included in the formula
instead or as well, and if more than one are specified their sum is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>An object of class ControlEL constructed by
<code>el_control()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to be passed to <code>glm.control()</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Suppose that we observe <code class="reqn">n</code> independent random variables
<code class="reqn">{Z_i} \equiv {(X_i, Y_i)}</code> from a common distribution, where <code class="reqn">X_i</code>
is the <code class="reqn">p</code>-dimensional covariate (including the intercept if any) and
<code class="reqn">Y_i</code> is the response. A generalized linear model specifies that
<code class="reqn">{\textrm{E}(Y_i | X_i)} = {\mu_i}</code>,
<code class="reqn">{G(\mu_i)} = {X_i^\top \theta}</code>, and
<code class="reqn">{\textrm{Var}(Y_i | X_i)} = {\phi V(\mu_i)}</code>,
where <code class="reqn">\theta = (\theta_0, \dots, \theta_{p-1})</code> is an unknown
<code class="reqn">p</code>-dimensional parameter, <code class="reqn">\phi</code> is an optional dispersion
parameter, <code class="reqn">G</code> is a known smooth link function, and <code class="reqn">V</code> is a known
variance function.
</p>
<p>With <code class="reqn">H</code> denoting the inverse link function, define the quasi-score
</p>
<p style="text-align: center;"><code class="reqn">{g_1(Z_i, \theta)} =
  \left\{
  H^\prime(X_i^\top \theta) \left(Y_i - H(X_i^\top \theta)\right) /
  \left(\phi V\left(H(X_i^\top \theta)\right)\right)
  \right\}
  X_i.</code>
</p>

<p>Then we have the estimating equations
<code class="reqn">\sum_{i = 1}^n g_1(Z_i, \theta) = 0</code>.
When <code class="reqn">\phi</code> is known, the (profile) empirical likelihood ratio for a
given <code class="reqn">\theta</code> is defined by
</p>
<p style="text-align: center;"><code class="reqn">R_1(\theta) =
  \max_{p_i}\left\{\prod_{i = 1}^n np_i :
  \sum_{i = 1}^n p_i g_1(Z_i, \theta) = 0,\
  p_i \geq 0,\
  \sum_{i = 1}^n p_i = 1
  \right\}.</code>
</p>

<p>With unknown <code class="reqn">\phi</code>, we introduce another estimating function based on
the squared residuals. Let <code class="reqn">{\eta} = {(\theta, \phi)}</code> and
</p>
<p style="text-align: center;"><code class="reqn">{g_2(Z_i, \eta)} =
  \left(Y_i - H(X_i^\top \theta)\right)^2 /
  \left(\phi^2 V\left(H(X_i^\top \theta)\right)\right) - 1 / \phi.</code>
</p>

<p>Now the empirical likelihood ratio is defined by
</p>
<p style="text-align: center;"><code class="reqn">R_2(\eta) =
  \max_{p_i}\left\{\prod_{i = 1}^n np_i :
  \sum_{i = 1}^n p_i g_1(Z_i, \eta) = 0,\
  \sum_{i = 1}^n p_i g_2(Z_i, \eta) = 0,\
  p_i \geq 0,\
  \sum_{i = 1}^n p_i = 1
  \right\}.</code>
</p>

<p><code>el_glm()</code> first computes the parameter estimates by calling <code>glm.fit()</code>
(with <code>...</code> if any) with the <code>model.frame</code> and <code>model.matrix</code> obtained from
the <code>formula</code>. Note that the maximum empirical likelihood estimator is the
same as the the quasi-maximum likelihood estimator in our model. Next, it
tests hypotheses based on asymptotic chi-square distributions of the
empirical likelihood ratio statistics. Included in the tests are overall
test with
</p>
<p style="text-align: center;"><code class="reqn">H_0: \theta_1 = \theta_2 = \cdots = \theta_{p-1} = 0,</code>
</p>

<p>and significance tests for each parameter with
</p>
<p style="text-align: center;"><code class="reqn">H_{0j}: \theta_j = 0,\ j = 0, \dots, p-1.</code>
</p>

<p>The available families and link functions are as follows:
</p>

<ul>
<li> <p><code>gaussian</code>: <code>"identity"</code>, <code>"log"</code>, and <code>"inverse"</code>.
</p>
</li>
<li> <p><code>binomial</code>: <code>"logit"</code>, <code>"probit"</code>, and <code>"log"</code>.
</p>
</li>
<li> <p><code>poisson</code>: <code>"log"</code>, <code>"identity"</code>, and <code>"sqrt"</code>.
</p>
</li>
<li> <p><code>quasipoisson</code>: <code>"log"</code>, <code>"identity"</code>, and <code>"sqrt"</code>.
</p>
</li>
</ul>
<h3>Value</h3>

<p>An object of class of GLM.
</p>


<h3>References</h3>

<p>Chen SX, Cui H (2003).
“An Extended Empirical Likelihood for Generalized Linear Models.”
<em>Statistica Sinica</em>, <strong>13</strong>(1), 69–81.
</p>
<p>Kolaczyk ED (1994).
“Empirical Likelihood for Generalized Linear Models.”
<em>Statistica Sinica</em>, <strong>4</strong>(1), 199–218.
</p>


<h3>See Also</h3>

<p>EL, GLM, <code>el_lm()</code>, <code>elt()</code>,
<code>el_control()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("warpbreaks")
fit &lt;- el_glm(wool ~ .,
  family = binomial, data = warpbreaks, weights = NULL, na.action = na.omit,
  start = NULL, etastart = NULL, mustart = NULL, offset = NULL
)
summary(fit)
</code></pre>


</div>