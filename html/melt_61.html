<div class="container">

<table style="width: 100%;"><tr>
<td>el_lm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Empirical likelihood for linear models</h2>

<h3>Description</h3>

<p>Fits a linear model with empirical likelihood.
</p>


<h3>Usage</h3>

<pre><code class="language-R">el_lm(
  formula,
  data,
  weights = NULL,
  na.action,
  offset,
  control = el_control(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>An object of class <code>formula</code> (or one that can be coerced to
that class) for a symbolic description of the model to be fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>An optional data frame, list or environment (or object coercible
by <code>as.data.frame()</code> to a data frame) containing the variables in
<code>formula</code>. If not found in data, the variables are taken from
<code>environment(formula)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>An optional numeric vector of weights to be used in the
fitting process. Defaults to <code>NULL</code>, corresponding to identical weights. If
non-<code>NULL</code>, weighted empirical likelihood is computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>A function which indicates what should happen when the data
contain <code>NA</code>s. The default is set by the <code>na.action</code> setting of
<code>options</code>, and is <code>na.fail</code> if that is unset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>An optional expression for specifying an <em>a priori</em> known
component to be included in the linear predictor during fitting. This
should be <code>NULL</code> or a numeric vector or matrix of extents matching those of
the response. One or more <code>offset</code> terms can be included in the formula
instead or as well, and if more than one are specified their sum is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>An object of class ControlEL constructed by
<code>el_control()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to be passed to the low level regression
fitting functions. See ‘Details’.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Suppose that we observe <code class="reqn">n</code> independent random variables
<code class="reqn">{Z_i} \equiv {(X_i, Y_i)}</code> from a common distribution, where <code class="reqn">X_i</code>
is the <code class="reqn">p</code>-dimensional covariate (including the intercept if any) and
<code class="reqn">Y_i</code> is the response. We consider the following linear model:
</p>
<p style="text-align: center;"><code class="reqn">Y_i = X_i^\top \theta + \epsilon_i,</code>
</p>

<p>where <code class="reqn">\theta = (\theta_0, \dots, \theta_{p-1})</code> is an unknown
<code class="reqn">p</code>-dimensional parameter and the errors <code class="reqn">\epsilon_i</code> are
independent random variables that satisfy
<code class="reqn">\textrm{E}(\epsilon_i | X_i)</code> = 0. We assume that the errors have
finite conditional variances. Then the least square estimator of
<code class="reqn">\theta</code> solves the following estimating equations:
</p>
<p style="text-align: center;"><code class="reqn">\sum_{i = 1}^n(Y_i - X_i^\top \theta)X_i = 0.</code>
</p>

<p>Given a value of <code class="reqn">\theta</code>, let
<code class="reqn">{g(Z_i, \theta)} = {(Y_i - X_i^\top \theta)X_i}</code> and the (profile)
empirical likelihood ratio is defined by
</p>
<p style="text-align: center;"><code class="reqn">R(\theta) =
  \max_{p_i}\left\{\prod_{i = 1}^n np_i :
  \sum_{i = 1}^n p_i g(Z_i, \theta) = \theta,\
   p_i \geq 0,\
  \sum_{i = 1}^n p_i = 1
  \right\}.</code>
</p>

<p><code>el_lm()</code> first computes the parameter estimates by calling <code>lm.fit()</code>
(with <code>...</code> if any) with the <code>model.frame</code> and <code>model.matrix</code> obtained from
the <code>formula</code>. Note that the maximum empirical likelihood estimator is the
same as the the quasi-maximum likelihood estimator in our model. Next, it
tests hypotheses based on asymptotic chi-square distributions of the
empirical likelihood ratio statistics. Included in the tests are overall
test with
</p>
<p style="text-align: center;"><code class="reqn">H_0: \theta_1 = \theta_2 = \cdots = \theta_{p-1} = 0,</code>
</p>

<p>and significance tests for each parameter with
</p>
<p style="text-align: center;"><code class="reqn">H_{0j}: \theta_j = 0,\ j = 0, \dots, p-1.</code>
</p>



<h3>Value</h3>

<p>An object of class of LM.
</p>


<h3>References</h3>

<p>Owen A (1991).
“Empirical Likelihood for Linear Models.”
<em>The Annals of Statistics</em>, <strong>19</strong>(4), 1725–1747.
<a href="https://doi.org/10.1214/aos/1176348368">doi:10.1214/aos/1176348368</a>.
</p>


<h3>See Also</h3>

<p>EL, LM, <code>el_glm()</code>, <code>elt()</code>,
<code>el_control()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Linear model
data("thiamethoxam")
fit &lt;- el_lm(fruit ~ trt, data = thiamethoxam)
summary(fit)

## Weighted data
wfit &lt;- el_lm(fruit ~ trt, data = thiamethoxam, weights = visit)
summary(wfit)

## Missing data
fit2 &lt;- el_lm(fruit ~ trt + scb, data = thiamethoxam,
  na.action = na.omit, offset = NULL
)
summary(fit2)
</code></pre>


</div>