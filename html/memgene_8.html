<div class="container">

<table style="width: 100%;"><tr>
<td>mgQuick</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Memgene analysis of genetic distance data (main interface for package)
</h2>

<h3>Description</h3>

<p>Performs multiple–typical–steps in a memgene
analysis of genetic distance data.  Gracefully handles
potential errors.  Steps are as follows:
</p>
<p>1.   Find MEM eigenvectors given 
coordinates (<code>coords</code>)<br></p>
<p>2.   Perform separate forward selections of positive and
negative MEM eigenvectors against genetic distance (<code>genD</code>),
to identify a significant
subset, using parameters <code>forwardPerm</code> as the number of
permutations and <code>forwardAlpha</code> as the alpha level
for a significant eigenvector.  NOTE: The number of permutations
<code>forwardPerm</code> is set at 100 by default to reduce analysis time for
exploratory analyses.  This number should be increased for final analyses.<br></p>
<p>3.   Find the fit of the selected eigenvectors to the
genetic distance data (using RDA).<br></p>
<p>4.   Optionally run a permutation test (<code>finalPerm</code>) for
the fit of the selected eigenvectors to the genetic distance
data.<br></p>
<p>5.   Produce MEMGENE variables using the fitted values from the RDA
analysis.  MEMGENE variables are the eigenvectors from a PCA of the fitted
values.  These are the product of memgene and can be used for visualization
and subsequent analyses.
</p>
<p>6.   Optionally produce plots of the scores for the
first <code>n</code> MEMGENE variables if <code>doPlot = n</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mgQuick(genD, coords, longlat = FALSE, truncation = NULL,
    transformation = NULL, forwardPerm = 100, forwardAlpha = 0.05,
    finalPerm = NULL, doPlot = NULL, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>genD</code></td>
<td>

<p>A symmetrical distance matrix giving the genetic distances among
individual genotypes or populations
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>

<p>A two column <code>matrix</code> or <code>data.frame</code> of x and y coordinates of sampling locations of individual genotypes
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>longlat</code></td>
<td>

<p>If <code>TRUE</code> then <code>coords</code> are longitude and latitude, so
find the geodesic distances among sampling locations using the <code>geosphere</code> package
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>truncation</code></td>
<td>

<p><code>NULL</code> under typical usage.  See <code>mgMEM</code> for experimental options.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transformation</code></td>
<td>

<p><code>NULL</code> under typical usage.  See <code>mgMEM</code> for experimental options.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>forwardPerm</code></td>
<td>

<p>The number of permutations in the randomization test for the forward selection of MEM eigenvectors. The default <code>forwardPerm=100</code> is sufficient for exploratory purposes, however this should be increased for final analyses.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>forwardAlpha</code></td>
<td>

<p>The 1-alpha level for the forward selection process
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>finalPerm</code></td>
<td>

<p>The number of permutations for the final randomization test of the reduced model.  <code>NULL</code> by
default does not perform a final randomization test.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>doPlot</code></td>
<td>

<p>Plot <code>doPlot = n</code> MEMGENE variables
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>If <code>TRUE</code> then report progress to the console
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list<br><code>$P</code> gives the probability of the null hypothesis for the RDA on the final model<br><code>$RSqAdj</code> is the adjusted R2 for the RDA, understood as the proportion of
all genetic variation that is explicable by spatial pattern (i.e. spatial genetic
signal)<br><code>$memgene</code> contains a matrix with the MEMGENE variables in columns<br><code>$memSelected</code> gives a matrix containing the selected MEM eigenvectors in columns<br><code>$whichSelectPos</code> gives the indices of the selected MEM eigenvectors with positive eigenvalues (i.e. from <code>$mem</code>)<br><code>$whichSelectNeg</code> gives the indices of the selected MEM eigenvectors with negative eigenvalues (i.e. from <code>$mem</code>)<br><code>$mem</code> the output of <code>mgMEM</code> given <code>coords</code>
</p>


<h3>Author(s)</h3>

<p>Pedro Peres-Neto (peres-neto.pedro@uqam.ca)<br>
Paul Galpern (pgalpern@ucalgary.ca)
</p>


<h3>References</h3>

<p>Galpern, P., Peres-Neto, P., Polfus, J., and Manseau, M.  2014.  MEMGENE: Spatial pattern detection in genetic distance data.  Submitted.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
## Prepare the radial data for analysis
radialData &lt;- read.csv(system.file("extdata/radial.csv", package="memgene"))
radialGen &lt;- radialData[, -c(1,2)]
radialXY &lt;- radialData[, 1:2]
if (require(adegenet)) {
  radialDM &lt;- codomToPropShared(radialGen)
} else {
  stop("adegenent package required to produce genetic distance matrix in example.")
}

## Run the MEMGENE analysis
radialAnalysis &lt;- mgQuick(radialDM, radialXY)

## Extract the scores on the first 3 MEMGENE variables
## for subsequent analysis
radialMEMGENE1 &lt;- radialAnalysis$memgene[, 1]
radialMEMGENE2 &lt;- radialAnalysis$memgene[, 2]
radialMEMGENE3 &lt;- radialAnalysis$memgene[, 3]

## Find the proportion of variation explained by all MEMGENE variables
propVariation &lt;- radialAnalysis$sdev/sum(radialAnalysis$sdev)

## End(Not run)
</code></pre>


</div>