<div class="container">

<table style="width: 100%;"><tr>
<td>ratio_test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Ratio-based test against a change in persistence</h2>

<h3>Description</h3>

<p>This function performs a ratio-based test against a change in persistence. Under the null hypothesis the time series is I(0) throughout and
under the alternative a change from either I(1) to I(0) or I(0) to I(1) has occured.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ratio_test(x, trend = c("none", "linear"), tau = 0.2,
  statistic = c("mean", "max", "exp"), type = c("BT", "LT", "HLT",
  "HLTmin"), m = 0, z = 9, simu = 0, M = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the univariate numeric vector to be investigated. Missing values are not allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trend</code></td>
<td>
<p>whether the time series exhibits a trend, <code>"none"</code> implies no trend and <code>"linear"</code> implies a linear trend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>the function tests in the interval <code>[T*tau,T*(1-tau)]</code> for a break in persistence with T being the length of the time series. It must hold that <code>0&lt;tau&lt;0.5</code>, default is <code>tau=0.2</code> as commonly used in the literature. Note that if <code>type="BT"</code> or <code>type="HLT"</code> and <code>T*tau&lt;= 1 + as.numeric(trend=="linear")</code>, <code>type="LT"</code> and <code>T*tau&lt;=1+ as.numeric(trend=="linear") + (m&gt;3)*(m-3)</code>, or <code>type="HLT"</code> and <code>T*tau&lt;=(z+1)</code> the test statistic cannot be calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>which type of test statistic should be used, <code>"mean"</code> corresponds to Hansen's (1991) mean score, <code>"max"</code> to Andrews' (1993) maximum statistic, and <code>"exp"</code> to Andrews and Ploberger's (1994) mean-exponential statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>which type of ratio test should be performed, <code>"BT"</code> for the standard ratio test by Busetti and Taylor (2004), <code>"LT"</code> for the modified ratio test by Leybourne and Taylor (2004), and <code>"HLT"</code>" respectively <code>"HLTmin"</code> are the modified tests by Harvey, Leybourne, and Taylor (2006). See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>Number of covariances used for the estimation of the long run variance if <code>statistic=LT</code> is used. Default is <code>m=0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>Number of polynomials used if <code>"HLT"</code> or <code>"HLTmin"</code> are considered. Default is <code>z=9</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simu</code></td>
<td>
<p>whether critical values should be simulated or interpolated, <code>simu=1</code> means simulation, <code>simu=0</code> means interpolation based on critical values for <code>tau=0.2</code>. See details. Default is <code>simu=0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>number of replications in case critical values should be simulated. Default is <code>M=10000</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Busetti and Taylor (2004) (BT) introduced a test that is able to identify when time series
exhibit changes in persistence. Under the null
hypothesis, the series is constant I(0), i.e. stationary. Under the alternative the series exhibits a
break either from I(0) to I(1) or I(1) to I(0). As the test is oversized for weakly dependent time series,
Leybourne and Taylor (2004) (LT) standardized the test statistic by an estimate of the long run variance using m lags.
Another problem is that constant I(1) processes are neither covered under the null nor the alternative.
Here, the test often rejects the null although no change in persistence occured.
Harvey, Leybourne, and Taylor (2006) (HLT) introduced a modification where they multiply the test statistic by
a unit root test. This allows the test statistic to have the same critical values under both constant I(0) and constant I(1).
It should be noted, however, that only the critical values are identical, the distribution is highly irregular.
</p>
<p>The critical values of the tests vary with the sample size. If <code>simu=0</code>, the critical values provided
are based on linear interpolation of the critical values simulated by Harvey, Leybourne, and Taylor (2006). These are, however, only valid for <code>tau=0.2</code>, <code>m=0</code>, and <code>z=9</code>. 
In case that non-default values are chosen for <code>tau</code>, <code>m</code>, or <code>z</code>, it is recommended to set <code>simu=1</code> which means that critical values are simulated based on the given data using M replications. 
Caution, for a time series of length <code>T=100</code> and <code>M=10,000</code> replications this takes approximately fifteen minutes with increasing duration for higher T or M.  
It should be noted, however, that M smaller than 10,000 make the results unreliable.
</p>


<h3>Value</h3>

<p>Returns a matrix that consists of test statistic and critical values (corresponding to <code>alpha=0.1,0.05,0.01</code>) for testing against a change from I(1) to I(0), I(0) to I(1), and against a change in an unknown direction.
</p>


<h3>Author(s)</h3>

<p>Janis Becker
</p>


<h3>References</h3>

<p>Busetti, F. and Taylor, R. (2004): Tests of stationarity against a change in persistence. Journal of Econometrics, 123, pp. 33-66.
</p>
<p>Leybourne, S. and Taylor, R. (2004): On tests for changes in persistence. Economics letters, 84, pp. 107-115.
</p>
<p>Harvey, D., Leybourne, S. and Taylor, R. (2006): Modified tests for a change in persistence. Journal of Econometrics, 134, pp. 441-469.
</p>


<h3>See Also</h3>

<p><code>cusum_test</code>, <code>LBI_test</code>, <code>LKSN_test</code>, <code>MR_test</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(410)

# generate dummy-data
series &lt;- c(rnorm(100), cumsum(rnorm(100))) 

# test for a break in persistence
ratio_test(series)
</code></pre>


</div>