<div class="container">

<table style="width: 100%;"><tr>
<td>estfun.lmerMod</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract Case-wise and Cluster-wise Derivatives for Linear Mixed Effects Models</h2>

<h3>Description</h3>

<p>A function for extracting the case-wise and cluster-wise 
derivatives of a linear mixed effects models fitted via <span class="pkg">lme4</span>. 
This function returns the case-wise and cluster-wise 
scores, evaluated at the ML estimates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'lmerMod'
estfun(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class <code>lmerMod</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments, including <code>level</code> and <code>ranpar</code>
(<code>level = 2</code> and <code>ranpar = "var"</code> are default; see details).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If <code>level = 2</code>, a <em>g</em> by <em>p</em> score matrix, corresponding to 
<em>g</em> clusters and <em>p</em> parameters. If <code>level = 1</code>, a <em>n</em> by 
<em>p</em> score matrix, corresponding to 
<em>n</em> observations and <em>p</em> parameters. 
For models with multiple clustering variables (three-level models, 
crossed random effects), an error is thrown if <code>level = 2</code>.    
If <code>ranpar = "var"</code>, the random effects are parameterized as 
variance/covariance; If <code>ranpar = "sd"</code>, the random effects are 
parameterized as standard deviation/correlation.  
</p>


<h3>References</h3>

<p>Wang, T. &amp; Merkle, E. C. (2018). Derivative Computations and Robust Standard
Errors for Linear Mixed Effects Models in lme4. <em>Journal of Statistical 
Software</em>, <b>87</b>(1), 1-16. doi: <a href="https://doi.org/10.18637/jss.v087.c01">10.18637/jss.v087.c01</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# The sleepstudy example
lme4fit &lt;- lmer(Reaction ~ Days + (Days|Subject), sleepstudy, REML = FALSE)

# casewise scores
estfun(lme4fit, level = 1, ranpar = "var")

# clusterwise scores
estfun(lme4fit, level = 2, ranpar = "sd")

## End(Not run)
</code></pre>


</div>