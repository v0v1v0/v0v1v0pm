<div class="container">

<table style="width: 100%;"><tr>
<td>cplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Scatter plot of observations for a pair of devices with calibration curve. </h2>

<h3>Description</h3>

<p>Creates a scatter plot for any pair of observations in the data.frame and 
superimposes the calibration curve.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cplot(df, i, j, leg.loc="topleft", regress=FALSE, lw=1, t.size=1, alpha.beta.sigma=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p> n (no. of items) x N (no. of methods) matrix or data.frame containing the measurements. N must be &gt;= 3 and n &gt; N. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>i</code></td>
<td>
<p> Select column i for device i. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>j</code></td>
<td>
<p> Select column j for device j not equal to i.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leg.loc</code></td>
<td>
<p> Location of the legend. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regress</code></td>
<td>
<p> If TRUE, add both naive regression lines (for comparison only). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lw</code></td>
<td>
<p> Line widths.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t.size</code></td>
<td>
<p> Text size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha.beta.sigma</code></td>
<td>
<p> By default, <code>cplot</code> computes the bias (alpha, beta) and
imprecision (sigma) estimates using ncb.od. You can override this by specifying a
3 x N matrix of values with alpha on the first row, beta on the second row, and
sigma on the third row, in the same order as the methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>By default, <code>cplot</code> displays the corresponding calibration curve for
devices i and j based on the parameter estimates for alpha, beta, and sigma computed
using <code>ncb.od</code>. You can overide this calibration curve by providing argument
alpha.beta.sigma with different estimates. Both naive regression lines (device i 
regressed on device j, and device j regressed on device i) by setting "regress=TRUE". 
Note, however, that the calibration curve will fall somewhere between these two
regression lines, depending on the the ratio of the imprecision standard deviations
(sigmas). (This may not hold if there are missing measurement data values given that ordinary regression requires deleting any item with one or more missing values.)
</p>


<h3>Value</h3>

<p>Produces a scatter plot with the calibration curve and titles that includes the
calibration equation and the scale-bias adjusted imprecision standard deviations.
</p>


<h3>Author(s)</h3>

<p> Richard A. Bilonick </p>


<h3>References</h3>

<p> Jaech, J. L. (1985) <em>Statistical Analysis of Measurement Errors</em>. New York: Wiley. </p>


<h3>See Also</h3>

 <p><code>merror.pairs </code></p>


<h3>Examples</h3>

<pre><code class="language-R">
library(merror)
data(pm2.5)

# Make various calibration plots for pm2.5 measurements
par(mfrow=c(2,2))
cplot(pm2.5,2,1)
cplot(pm2.5,3,1)
cplot(pm2.5,4,1)
# Add the naive regression lines JUST for comparison
cplot(pm2.5,5,1,regress=TRUE,t.size=0.9)

# This is redundant but illustrates using the
# argument alpha.beta.sigma
a &lt;- ncb.od(pm2.5)$sigma.table$alpha.ncb[1:5]
b &lt;- ncb.od(pm2.5)$sigma.table$beta[1:5]
s &lt;- ncb.od(pm2.5)$sigma.table$sigma[1:5]

alpha.beta.sigma &lt;- t(data.frame(a,b,s))

cplot(pm2.5,2,1,alpha.beta.sigma=alpha.beta.sigma)
cplot(pm2.5,2,1,alpha.beta.sigma=alpha.beta.sigma,regress=TRUE)
data(pm2.5)

## Not run: 
# Use omx function to specify the data for alpha.beta.sigma
pm &lt;- pm2.5

# omx uses OpenMx which does not like periods in data column names
names(pm) &lt;- c('ms_conc_1','ws_conc_1','ms_conc_2','ws_conc_2','frm')

# Fit one-factor measurement error model with FRM sampler as reference
omxfit &lt;- omx(data=pm[,c(5,1:4)],bs.q=c(0.025,0.5,0.975),reps=100)

# Make a calibration plot using the results from omx instead of the default ncb.od
cplot(pm[,c(5,1:4)],1,2,alpha.beta.sigma=omxfit$abs)

## End(Not run)


</code></pre>


</div>