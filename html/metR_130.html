<div class="container">

<table style="width: 100%;"><tr>
<td>Smooth2D</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Smooths a 2D field</h2>

<h3>Description</h3>

<p>Smooth a 2D field using a user-supplied method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Smooth2D(x, y, value, method = smooth_svd(0.01))

smooth_dct(kx = 0.5, ky = kx)

smooth_svd(variance_lost = 0.01)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>Vector of x and y coordinates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>Vector of values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The method to use smooth. Must be a function that takes a matrix
and returns the smoothed matrix. Build-in methods are <code>smooth_svd()</code> and <code>smooth_dct()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kx, ky</code></td>
<td>
<p>Proportion of components to keep in the x and
y direction respectively. Lower values increase the smoothness.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variance_lost</code></td>
<td>
<p>Maximum percentage of variance lost after smoothing.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>smooth_svd()</code> computes the SVD of the field and reconstructs it keeping only
the leading values that ensures a maximum variance lost.
<code>smooth_dct()</code> computes the Discrete Cosine Transform of the field and sets
a proportion of the components to zero.
</p>


<h3>Value</h3>

<p>A vector of the same length as value.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(ggplot2)
# Creates a noisy version of the volcano dataset and applies the smooth
volcano &lt;- reshape2::melt(datasets::volcano, value.name = "original")
volcano$noisy &lt;- with(volcano, original + 1.5*rnorm(length(original)))

volcano$smooth_svd &lt;- with(volcano, Smooth2D(Var2, Var1, noisy, method = smooth_svd(0.005)))
volcano$smooth_dct &lt;- with(volcano, Smooth2D(Var2, Var1, noisy, method = smooth_dct(kx = 0.4)))

volcano &lt;- reshape2::melt(volcano, id.vars = c("Var1", "Var2"))

ggplot(volcano, aes(Var1, Var2)) +
  geom_contour(aes(z = value, color = after_stat(level))) +
  scale_color_viridis_c() +
  coord_equal() +
  facet_wrap(~variable, ncol = 2)
</code></pre>


</div>