<div class="container">

<table style="width: 100%;"><tr>
<td>FitLm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fast estimates of linear regression</h2>

<h3>Description</h3>

<p>Computes a linear regression with stats::.lm.fit and returns the estimate
and, optionally, standard error for each regressor.
</p>


<h3>Usage</h3>

<pre><code class="language-R">FitLm(y, ..., intercept = TRUE, weights = NULL, se = FALSE, r2 = se)

ResidLm(y, ..., intercept = TRUE, weights = NULL)

Detrend(y, time = seq_along(y))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>numeric vector of observations to model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>numeric vectors of variables used in the modelling</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>logical indicating whether to automatically add the intercept</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>numerical vector of weights (which doesn't need to be normalised)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>logical indicating whether to compute the standard error</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r2</code></td>
<td>
<p>logical indicating whether to compute r squared</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>time vector to use for detrending. Only necessary in the case of
irregularly sampled timeseries</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>FitLm returns a list with elements
</p>

<dl>
<dt>term</dt>
<dd>
<p>the name of the regressor</p>
</dd>
<dt>estimate</dt>
<dd>
<p>estimate of the regression</p>
</dd>
<dt>std.error</dt>
<dd>
<p>standard error</p>
</dd>
<dt>df</dt>
<dd>
<p>degrees of freedom</p>
</dd>
<dt>r.squared</dt>
<dd>
<p>Percent of variance explained by the model (repeated in each term)</p>
</dd>
<dt>adj.r.squared</dt>
<dd>
<p> r.squared' adjusted based on the degrees of freedom)</p>
</dd>
</dl>
<p>ResidLm and Detrend returns a vector of the same length
</p>
<p>If there's no complete cases in the regression, <code>NA</code>s are returned with no
warning.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Linear trend with "signficant" areas shaded with points
library(data.table)
library(ggplot2)
system.time({
  regr &lt;- geopotential[, FitLm(gh, date, se = TRUE), by = .(lon, lat)]
})

ggplot(regr[term != "(Intercept)"], aes(lon, lat)) +
    geom_contour(aes(z = estimate, color = after_stat(level))) +
    stat_subset(aes(subset = abs(estimate) &gt; 2*std.error), size = 0.05)

# Using stats::lm() is much slower and with no names.
## Not run: 
system.time({
  regr &lt;- geopotential[, coef(lm(gh ~ date))[2], by = .(lon, lat)]
})

## End(Not run)

</code></pre>


</div>