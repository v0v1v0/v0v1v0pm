<div class="container">

<table style="width: 100%;"><tr>
<td>thermodynamics</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Thermodynamics</h2>

<h3>Description</h3>

<p>Functions related to common atmospheric thermodynamic relationships.
</p>


<h3>Usage</h3>

<pre><code class="language-R">IdealGas(p, t, rho, R = 287.058)

Adiabat(p, t, theta, p0 = 1e+05, kappa = 2/7)

VirtualTemperature(p, t, e, tv, epsilon = 0.622)

MixingRatio(p, e, w, epsilon = 0.622)

ClausiusClapeyron(t, es)

DewPoint(p, ws, td, epsilon = 0.622)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>pressure</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>temperature</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>density</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>gas constant for air</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>potential temperature</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p0</code></td>
<td>
<p>reference pressure</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kappa</code></td>
<td>
<p>ratio of dry air constant and specific heat capacity at constant pressure</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e</code></td>
<td>
<p>vapour partial pressure</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tv</code></td>
<td>
<p>virtual temperature</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>ratio of dry air constant and vapour constant</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>mixing ratio</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>es</code></td>
<td>
<p>saturation vapour partial pressure</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ws</code></td>
<td>
<p>saturation mixing ratio</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>td</code></td>
<td>
<p>dewpoint</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>IdealGas</code> computes pressure, temperature or density of air according to the
ideal gas law <code class="reqn">P=\rho R T</code>.
</p>
<p><code>Adiabat</code> computes pressure, temperature or potential temperature according to
the adiabatic relationship <code class="reqn">\theta = T (P0/P)^\kappa</code>.
</p>
<p><code>VirtualTemperature</code> computes pressure, temperature, vapour partial pressure or
virtual temperature according to the virtual temperature definition
<code class="reqn">T(1 - e/P(1 - \epsilon))^{-1}</code>.
</p>
<p><code>MixingRatio</code> computes pressure, vapour partial temperature, or mixing ratio
according to <code class="reqn">w = \epsilon e/(P - e)</code>.
</p>
<p><code>ClausiusClapeyron</code> computes saturation pressure or temperature according
to the August-Roche-Magnus formula <code class="reqn">es = a exp{bT/(T + c)}</code> with temperature
in Kelvin and saturation pressure in Pa.
</p>
<p><code>DewPoint</code> computes pressure, saturation mixing ration or dew point
from the relationship <code class="reqn">ws =  \epsilon es(Td)/(p - es(Td))</code>. Note that the
computation of dew point is approximated.
</p>
<p>Is important to take note of the units in which each variable is provided.
With the default values, pressure should be passed in Pascals, temperature and
potential temperature in Kelvins, and density in <code class="reqn">kg/m^3</code>.
<code>ClausiusClayperon</code> and <code>DewPoint</code> require and return values in those units.
</p>
<p>The defaults value of the <code>R</code> and <code>kappa</code> parameters are correct for dry air,
for the case of moist air, use the virtual temperature instead of the actual
temperature.
</p>


<h3>Value</h3>

<p>Each function returns the value of the missing state variable.
</p>


<h3>References</h3>

<p>http://www.atmo.arizona.edu/students/courselinks/fall11/atmo551a/ATMO_451a_551a_files/WaterVapor.pdf
</p>


<h3>See Also</h3>

<p>Other meteorology functions: 
<code>Derivate()</code>,
<code>EOF()</code>,
<code>GeostrophicWind()</code>,
<code>WaveFlux()</code>,
<code>waves</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">IdealGas(1013*100, 20 + 273.15)
IdealGas(1013*100, rho = 1.15) - 273.15

(theta &lt;- Adiabat(70000, 20 + 273.15))
Adiabat(70000, theta = theta) - 273.15

# Relative humidity from T and Td
t &lt;- 25 + 273.15
td &lt;- 20 + 273.15
p &lt;- 1000000
(rh &lt;- ClausiusClapeyron(td)/ClausiusClapeyron(t))

# Mixing ratio
ws &lt;- MixingRatio(p, ClausiusClapeyron(t))
w &lt;- ws*rh
DewPoint(p, w) - 273.15    # Recover Td

</code></pre>


</div>