<div class="container">

<table style="width: 100%;"><tr>
<td>blockplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Generate a “block plot” - a histogram variant identifiying individual data points.
</h2>

<h3>Description</h3>

<p>A “block plot” is a histogram variant identifiying individual data points. Histogram bars are replaced 
by a stack of rectangles (“blocks”, each of which is labelled. <code>blockplot</code> provides for grouped 
data, which generates vertically separated subplots for each group. Fills and label colours can be specified 
for each data point.
</p>


<h3>Usage</h3>

<pre><code class="language-R">	blockplot(x, ...)

	bplot(x, ...)

	## Default S3 method:
blockplot(x, breaks = "23", labels = paste(1:length(x)), groups = NA, 
		xlim = NULL, ylim = NULL, 
		main = NULL, xlab = NULL, ylab = "Frequency", grp.labs = FALSE, 
		include.lowest = TRUE, right = TRUE, nclass = NULL, 
		plot = TRUE,  add=FALSE, ...)

	
	## S3 method for class 'formula'
blockplot(x, data = NULL, ..., subset, main = NULL, xlab = NULL)
	
	
	nclass.23(x)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> An R object. For the default method, a vector of values for which the blockplot is desired. 
For the formula method, a valid formula, such as <code>y ~ grp</code> (see Details).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> For the formula method, a data frame or list from which the variables in <code>formula</code>
should be taken.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p> For the formula method, an optional vector specifying a subset of observations to be
used for plotting.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>
<p> Either a specification for choosing breakpoints for “binning” 
the data, or a vector giving the breakpoints themselves. The 
specification can be a single number, a function, or a character 
string identifying a function. See ‘Details’ for detailed 
specification. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>Labels for data points, passed to <code>text</code>; in principle of any type acceptable to <code>text</code>. 
Labels are placed inside boxes so should be short for readability.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>An optional grouping variable, coerced to factor. If present, one subplot is produced for each non-empty group.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p> Limits <code>(x1, x2)</code> for the horizontal (<code class="reqn">x</code>) range of the plot. The default is the range of <code>breaks</code>, after computation if necessary.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p> limits for the vertical range of the plot. Will be overridden if <code>square=TRUE</code> (see below).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>Main title for the plot, passed to <code>plot</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab</code></td>
<td>
<p> x- and y-axis labels for the plot. As usual, either can be expressions (see <code>plotmath</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grp.labs</code></td>
<td>
<p> Logical, determining whether group labels are plotted, or 
a vector of labels. See ‘Details’.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include.lowest</code></td>
<td>
<p> Logical, indicating whether a value equal to the lowest 
(or highest, for <code>right = FALSE</code>) <code>breaks</code> value should be included 
in a given bin. Passed to <code>cut</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>right</code></td>
<td>
<p>Logical, indicating whether the bin intervals should be closed on the right (and open 
on the left) or vice versa. Passed to <code>cut</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nclass</code></td>
<td>
<p>Suggested number of classes for <code>breaks</code>; equivalent to a single 
numerical value for <code>breaks</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>If <code>FALSE</code>, no plot is produced. The return value is returned invisibly.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>If <code>TRUE</code>, the plot is added to an existing figure. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further parameters passed to other functions, in particular, <code>bkp</code>, 
which creates the plot, and <code>plot</code>
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>blockplot</code> produces a block plot - a histogram variant identifying individual
data points. Histogram bars are replaced by a stack of rectangles (“blocks”, 
each of which can be (and by default, is) labelled.
</p>
<p><code>bplot</code> is an alias for <code>blockplot</code>.
</p>
<p>For the formula method, <code>x</code> is a formula, such as <code>y ~ grp</code>, in which <code>y</code> is a numeric vector
of data values to be split into groups according to the grouping variable <code>grp</code> (usually a factor). 
More than one grouping variable can be specified, in which case subplots are produced for each level
of the interaction between grouping factors.
</p>
<p>The specification for breakpoints, <code>breaks</code>, is modelled closely on that for 
<code>hist</code>. <code>breaks</code> can be one of:
</p>

<ul>
<li>
<p> a vector giving the (equally spaced) breakpoints between bins;
</p>
</li>
<li>
<p> a function to compute the vector of breakpoints;
</p>
</li>
<li>
<p> a single number giving the suggested number of bins for the
blockplot;
</p>
</li>
<li>
<p> a character string naming an algorithm to compute the
number of cells. Values of <code>"23"</code> (the default),
<code>"Sturges"</code>, <code>"Scott"</code>, <code>"FD"</code> and 
<code>"Freedman-Diaconis"</code> are currently 
supported; see below for their effect
</p>
</li>
<li>
<p> a function to compute the number of bins.
</p>
</li>
</ul>
<p>In the last three cases the number is a suggestion only, as the breakpoints 
will be set to “pretty” values. 
</p>
<p>The different character string specifications correspond to “nclass” 
functions, including those used by <code>hist</code>; see <code>nclass.FD</code> 
for details of those. In addition, the default <code>"23"</code> corresponds to the 
function <code>nclass.23</code>. This is just a wrapper for the one-line expression
</p>
<p><code>ceiling(length(x)^(2/3))</code>,
</p>
<p>which appears to provide good results for block plots.
</p>
<p>Considerable control of graphical elements is provided by the plotting function 
<code>bkp</code>, which is called by <code>blockplot</code>. In particular, arguments 
passed through <code>...</code> to <code>bkp</code> can control:
</p>

<ul>
<li>
<p> The general shape of the plot, including the asbect ratio of the “blocks”;
</p>
</li>
<li>
<p> whether a plot should be added to an existing figure (<code>add</code>)
</p>
</li>
<li>
<p> the fill colour and shading, the border width, type and colour, and the font size 
and colour of individual blocks;
</p>
</li>
<li>
<p> the vertical location of the plot in the figure region <code>offset</code>;
</p>
</li>
<li>
<p> the vertical spacing between multiple plots on the same figure when a grouping 
variable is provided (<code>grp.spacing</code> and <code>grp.at</code>;
</p>
</li>
<li>
<p> the presence, location and appearance of labels for individual subplots;
</p>
</li>
<li>
<p> whether axes are plotted on any of the four sides of the plot;
</p>
</li>
<li>
<p> the appearance or omission of empty groups.
</p>
</li>
</ul>
<p>See <code>bkp</code> for further details.  
</p>


<h3>Value</h3>

<p>Blockplot currently returns an object of class <code>blockplot</code>, which is a list with elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The original data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>If there is more than one group, a factor of groups for each data point,
with additional attribute <code>"gname"</code> containing a default name for the grouping 
variable(s). <code>groups</code> is set to <code>NA</code> if there is only one group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.left</code></td>
<td>
<p>Vector of x-coordinates for the left side of each block</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.height</code></td>
<td>
<p>Vector of y-coordinates for each box, relative to the group baseline</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.mid</code></td>
<td>
<p>Vector of x-coordinates for the middle of each block (the text location)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.mid</code></td>
<td>
<p>Vector of x-coordinates for the middle of each block (the text location)</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The name “block plot” may not be in general use, but the package author 
has been unable to identify either an alternative designation or an original source
for this type of plot. An example - apparently hand drawn - was given in ISO 5725-2:1994 (referenced above).
</p>


<h3>Author(s)</h3>

<p>S Ellison <a href="mailto:s.ellison@lgcgroup.com">s.ellison@lgcgroup.com</a>
</p>


<h3>References</h3>

<p>ISO 5725-2:1994 <em>Accuracy (trueness and precision) of measurement methods 
and results – Part 2: Basic method for the determination of repeatability 
and reproducibility of a standard measurement method.</em> ISO, Geneva, 1994.
</p>


<h3>See Also</h3>

<p>For plotting and control of plot appearance:
<code>link{bkp}</code> 
</p>
<p>For graphical elements:
<code>text</code>, <code>rect</code>
</p>
<p>For specification of <code>breaks</code>:
<code>link{nclass.Sturges}</code>, <code>link{nclass.Scott}</code>, <code>link{nclass.FD}</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#A simple blockplot
set.seed(55)
x&lt;-rnorm(48, 15)
blockplot(x)

#Aspect ratio control for square blocks
blockplot(x, square=TRUE)

# Specifying groups 
grp &lt;- gl(3, 16)
blockplot(x, groups=grp)

#Formula interface
blockplot(x~grp)

#Vectorised colour specification
blockplot(x~grp, square=TRUE, fill=ifelse(1:48 %in% c(15, 23, 24), "gold", "white") )

#Group labelling
blockplot(x~grp, square=TRUE, grp.labs=paste("Level", 1:3), grp.pos=2)

#A missing group
xm &lt;- x
xm[ grp == "2" ] &lt;- NA
blockplot(xm~grp, square=TRUE, grp.labs=paste("Level", 1:3), grp.pos=2)

blockplot(xm~grp, square=TRUE, grp.labs=paste("Level", 1:3), grp.pos=2, drop.unused=FALSE)

</code></pre>


</div>