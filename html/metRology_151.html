<div class="container">

<table style="width: 100%;"><tr>
<td>youden.plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Youden plots
</h2>

<h3>Description</h3>

<p>A Youden plot is a bivariate scatter plot, named for its use by W. M Youden in 
interlaboratory studies. This implementation includes data ellipses based on Pearson, 
Spearman, Kendall or several robust covariance measures.
</p>


<h3>Usage</h3>

<pre><code class="language-R">youden.plot(x, ...)

yplot(x, ...)

## Default S3 method:
youden.plot(x, y = NULL, type = c("points", "labels", "both", "outliers"), 
	labels, probs = c(0.95, 0.99), x0, y0,  pch = par("pch"), cex = par("cex"), 
	col = par("col"), bg = par("bg"), main, xlab, ylab,  
	xlim = c("data", "ellipse", "all"), ylim = c("data", "ellipse", "all"), 
	col.axes = 2, lwd.axes = 1, lty.axes = 1, cex.lab = 0.7, pos = 3, 
	out.method = c("F", "chisq", "n"), n.out, p.out = 0.99, 
	add = FALSE,  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>An R <code>numeric</code> object. Can be a vector (in which case <code>y</code> must be specified 
and of the same length) or a two-column numeric matrix.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>A numeric vector of the same length as <code>x</code>. It is an error to provide <code>y</code> 
in addition to a two-column matrix for <code>x</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>The type of plot produced. See Details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>

<p>Character vector of text labels for data points. Defaults to <code>row.names(x)</code> if
<code>x</code> is a matrix or data frame with row names, <code>names(x)</code> if <code>x</code> is a 
named vector, and to <code>1:length(x)</code> or <code>1:nrow(x)</code> 
as appropriate if <code>x</code> does not have names.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>

<p>Numeric vector of probabilities for data ellipses.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x0, y0</code></td>
<td>

<p>If specified, data ellipses will be centred on <code>(x0, y0)</code> instead of using the 
location calculated from the data.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch, cex, col, bg</code></td>
<td>

<p>passed to <code>points</code>; see <code>points</code> for details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main, xlab, ylab</code></td>
<td>

<p>Plot titles. If missing, titles are based on the names of the objects plotted. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim, ylim</code></td>
<td>

<p>Specifications for horizintal and vertical plot limits. Each can be either a length 2 
numeric vector (as usual) or a character value matching one of <code>"data"</code>, 
<code>"ellipse"</code> or <code>"all"</code>. If <code>"data"</code>, the relevant limits are set to 
include the range of the data. If <code>"ellipse"</code>, the relevant limits are set to 
include the whole of the outermost ellipse. If <code>"all"</code>, limits are set to include 
both the data and the outermost ellipse.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.axes, lwd.axes, lty.axes</code></td>
<td>

<p>Colour, line width and line type for vertical and horizontal location markers
drawn through the ellipse centre.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.lab</code></td>
<td>

<p>Size for data point labels; see <code>text</code> for details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos</code></td>
<td>

<p>a position specifier for data point labels; see <code>text</code> for details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out.method</code></td>
<td>

<p>Character specifying outlier marking. See Details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.out</code></td>
<td>

<p>Number of outliers marked if <code>out.method=="n"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.out</code></td>
<td>

<p>Confidence level at which points are marked as outliers if <code>out.method</code> is
one of <code>"F"</code> or <code>"chisq"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>

<p>If <code>TRUE</code>, ellipses and points are added to an existing plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> Named arguments passed to other functions. In particular:
</p>

<ul>
<li>
<p>Arguments <code>cov.method</code>, <code>cov.control</code>, <code>scalefn</code>, and <code>locfn</code> 
will be passed to <code>cov.dellipse</code> to control the (optionally robust) 
location, scale and covariance estimates used for the ellipses. 
</p>
</li>
<li>
<p>Arguments <code>sub</code>, <code>ann</code>, <code>axes</code>, <code>frame.plot</code>, and <code>asp</code> 
are passed to <code>plot</code> to add a sub-title, control axes and annotation and, 
importantly, control the plot aspect ratio.
</p>
</li>
<li>
<p>Arguments <code>col.ellipse</code>, <code>lty.ellipse</code>, <code>lwd.ellipse</code>, <code>fill</code>, 
<code>density</code>, <code>angle</code>, <code>npoints</code>, <code>prinax</code>, <code>col.prinax</code>, 
<code>lty.prinax</code>, and <code>lwd.prinax</code> are passed to <code>plot.d.ellipse</code>
to control the appearance of ellipses and ellipse principal axes.
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>type</code> controls the type of plot produced. Allowed types and their effect are:
</p>

<dl>
<dt><code>points</code></dt>
<dd>
<p>Points only are drawn.</p>
</dd>
<dt><code>labels</code></dt>
<dd>
<p>Point labels only are drawn</p>
</dd>
<dt><code>both</code></dt>
<dd>
<p>Points are drawn with labels</p>
</dd>
<dt><code>outliers</code></dt>
<dd>
<p>Points are drawn and outlying points are labelled (see below)</p>
</dd>
</dl>
<p>Ellipses are constructed based on a location and covariance matrix constructed from the data 
by the method specified by <code>cov.method</code>. <code>probs</code> specifies the approximate coverage.
See <code>data.ellipse</code> for details of covariance methods and ellipse specification.
</p>
<p>The outlier identification method, if any, is specified by <code>out.method</code> and controlled by 
one of <code>n.out</code> or <code>p.out</code>. If <code>out.method</code> is <code>"F"</code> or <code>"chisq"</code>, 
points with Mahalanobis distance greater than an upper critical value with probability <code>p.out</code> 
are considered to be outliers. The critical values used are
</p>

<dl>
<dt><code>"F"</code></dt>
<dd>
<p>Mahalanobis distance greater than 
<code> 2 * (n-1) * qf(p.out, 2, n-1) / (n-2)</code></p>
</dd>
<dt><code>"chisq"</code></dt>
<dd>
<p>Mahalanobis distance greater than <code>qchisq(p.out, 2)</code></p>
</dd>
</dl>
<p>which( md &gt; 2 * (n-1) * qf(p.out, 2, n-1) / (n-2) ) #F dist

The Mahalanobis distance is calculated based on the covariance matrix used to consstruct plot ellipses.
</p>
<p>If <code>out.method</code> is <code>"n"</code>, the outermost <code>n.out</code> points (judged by Mahalanobis distance)
are marked as outliers. Specifying <code>out.method="n"</code> and <code>n.out=0</code> suppresses outlier 
identification.
If outliers are marked, a list of marked outliers is included in the returned list 
(see Value, below).
</p>
<p><code>yplot</code> is an alias for <code>youden.plot</code>
</p>


<h3>Value</h3>

<p>Invisibly returns the plotted data ellipses as an object of class <code>d.ellipse</code>. 
</p>


<h3>Author(s)</h3>

<p>S L R Ellison (s.ellison@lgcgroup.com)
</p>


<h3>References</h3>

<p>Youden, W.J. and Steiner, E.H.  (1975) <em>Statistical Manual of the AOAC</em>. AOAC 
International, Washington, US. ISBN 0-935584-15-3
</p>
<p>ISO 13528:2005, Statistical methods for use in proficiency testing by interlaboratory
comparisons, International Organization for Standardization, Geneva (2005)
</p>


<h3>See Also</h3>

<p><code>d.ellipse</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(chromium)
data(potassium)

( yy &lt;- youden.plot(chromium, main="Chromium") )

#With outlier ID (F based)
youden.plot(chromium, main="Chromium", xlim='a', ylim='a', type='o', p.out=0.95)
	#Note use of xlim="a" etc. to ensure both ellipses and data are included.
	
#Top 5 most distant outliers (5 is also the default)
youden.plot(chromium, main="Chromium", xlim='a', ylim='a', type='o', out.method="n", n.out=5)

#With ellipse principal axes
#(useful to specify asp=1 or the axes will not always appear orthogonal)
youden.plot(chromium, main="Chromium", 
	xlim='a', ylim='a', type='o', p.out=0.99, prinax=TRUE, lty.prinax=2, asp=1.0)

youden.plot(potassium, main="Potassium")

#A different pairs plot ...
panel.youden &lt;- function(x, y, ...) youden.plot(x, y, add=TRUE, type="o", cex=1, pos=1, p.out=0.95)
pairs(chromium, upper.panel=panel.youden)


</code></pre>


</div>