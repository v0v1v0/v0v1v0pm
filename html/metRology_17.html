<div class="container">

<table style="width: 100%;"><tr>
<td> bootMSD </td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Parametric bootstrap for median scaled difference </h2>

<h3>Description</h3>

<p>Generates a parametric bootstrap for the median of scaled differences 
from each point in a data set to all other points..
</p>


<h3>Usage</h3>

<pre><code class="language-R">        bootMSD(x, ...)

        ## Default S3 method:
bootMSD(x, s = mad, B = 3000, probs = c(0.95, 0.99), 
                method = c("rnorm", "lhs"), keep = FALSE, labels = names(x), ...)

        ## S3 method for class 'MSD'
bootMSD(x, B = 3000, probs = c(0.95, 0.99), 
                method = c("rnorm", "lhs"), keep = FALSE, labels = names(x), ...)
	
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>An R object. For the default method, a vector of observations. For the <code>MSD</code>
method, an object of class <code>"MSD"</code>. For <code>print</code>, <code>summary</code> and <code>plot</code>
methods, an object of class <code>"bootMSD"</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>Either a function returning an estimate of scale for <code>x</code> or a vector of 
length <code>length(x)</code> of standard errors or standard uncertainties in 
<code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>

<p>Scalar number of bootstrap replicates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>

<p>Vector of probabilities at which to calculate upper quantiles. Passed to
<code>quantile</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>Character value describing the simulation method. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep</code></td>
<td>

<p>If <code>keep == TRUE</code> the individual bootstrap replicates are retained.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>

<p>Character vector of labels for individual values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Parameters passed to other methods. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>bootMSD</code> calculates a parametric bootstrap simulation (or Monte carlo simulation)
of the results of <code>msd</code> applied to data. This allows individual case-specific 
quantiles and <em>p</em>-values to be estimated that allow for different standard errors 
(or standard uncertainties) <code>s</code>. 
</p>
<p>The sampling method is currently either sampling from <code>rnorm</code> or by latin hypercube sampling
using <code>lhs</code>.
</p>
<p>Individual upper quantiles for probabilities <code>probs</code> and <em>p</em>-values are estimated 
directly from the bootstrap replicates. Quantiles use <code>quantile</code>. <em>p</em>-values 
are estimated from the proportion of replicates that exceed the observed MSD calculated by 
<code>msd</code>. Note that the <code>print</code> method for the <code>summary</code> object does 
not report zero proportions as identically zero. 	
</p>


<h3>Value</h3>

<p>An object of class "bootMSD", consisting of a vector of length <code>length(x)</code> of median 
scaled absolute deviations for each observation, with attributes:
</p>

<ul>
<li>
<p>msdvector of raw calculated MSD values calculated by <code>msd</code>
</p>
</li>
<li>
<p>labelscharacter vector of labels, by default taken from <code>x</code>
</p>
</li>
<li>
<p>probsvextor of probabilities supplied and used for quantiles
</p>
</li>
<li>
<p>critical.valuesmatrix of quantiles. Each row corresponds to a probability 
in <code>probs</code> and each column to an individual data point.
</p>
</li>
<li>
<p>pvals<em>p</em>-values estimated as the observed proportion of
simulated values exceeding the MSD value calculated by <code>msd</code>.
</p>
</li>
<li>
<p>BNumber of bootstrap replicates used.
</p>
</li>
<li>
<p>methodThe sampling method used by the parametric bootstrap.
</p>
</li>
<li>
<p>tIf <code>keep == TRUE</code>, the individual bootstrap replicates 
generated by <code>bootMSD</code>. Set to <code>NA</code> if <code>keep == FALSE</code>.
</p>
</li>
</ul>
<p>Summary, print and plot methods are provided for the class; see <code>bootMSD-class</code>. 
</p>


<h3>Author(s)</h3>

<p>S. L. R. Ellison <a href="mailto:s.ellison@lgc.co.uk">s.ellison@lgc.co.uk</a>
</p>


<h3>See Also</h3>

<p><code>msd</code>, <code>bootMSD-class</code>, <code>print.bootMSD</code>, 
<code>plot.bootMSD</code>, <code>summary.bootMSD</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
  data(Pb)
  ## Not run: 
  #Default method:
  set.seed(1023)
  boot.Pb.default &lt;- bootMSD(Pb$value, Pb$u)  # Uses individual standard uncertainties
  summary(boot.Pb.default)
  
  
  #Method for MSD object:
  msd.Pb&lt;-msd(Pb$value, Pb$u)  # Uses individual standard uncertainties
  boot.Pb &lt;- bootMSD(msd.Pb, B=5000)
  	#Increased replication compared to default
  summary(boot.Pb)
  
  # NOTE: The default summary gives individual observation p-values. 
  # To correct for multiple comparisons, apply 
  # a suitable p-value adjustment:
  summary(boot.Pb, p.adjust="holm")

  
## End(Not run)


</code></pre>


</div>