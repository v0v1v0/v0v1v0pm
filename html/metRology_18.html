<div class="container">

<table style="width: 100%;"><tr>
<td>boxplot.mandel.kh</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Box plot of Mandel's h or k statistics
</h2>

<h3>Description</h3>

<p>Produces a box plot of Mandel's statistics, with optional outlier labels
and indicator lines for unusual values.
</p>


<h3>Usage</h3>

<pre><code class="language-R">	## S3 method for class 'mandel.kh'
boxplot(x, probs=c(0.95, 0.99), main,  
		xlab=attr(x, "grouped.by"), ylab=attr(x, "mandel.type"),
		separators=FALSE, zero.line=TRUE, ylim,  p.adjust="none", 
		frame.plot = TRUE, horizontal=FALSE, at,
		... , 
		col.ind=1, lty.ind=c(2,1), lwd.ind=1, 
		col.sep="lightgrey", lwd.sep=1, lty.sep=1,
		lwd.zero=1, col.zero=1, lty.zero=1,
		outlier.labels=row.names(x), cex.lab=0.7, col.lab=1, 
		adj=NULL, pos=NULL, srt=0 )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class <code>"mandel.kh"</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>

<p>Indicator lines are drawn for these probabilities. Note that
<code>probs</code> is interpreted as specifying two-tailed probabilities
for Mandel's h and one-sided (upper tail) probabilities for
Mandel's k.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>

<p>a main title for the plot. If missing, the default is
<code> paste(deparse(substitute(x)), " - Mandel's", 
                     attr(x, "mandel.type"), 
                     if(attr(x, "mandel.method") == "robust") "(Robust variant)")</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>

<p>a label for the x axis; defaults to the <code>grouped.by</code> attribute for
<code>x</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>

<p>a label for the x axis; defaults to the <code>mandel.type</code> attribute for
<code>x</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>separators</code></td>
<td>

<p>Logical; if <code>TRUE</code>, separator lines are drawn between groups of values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zero.line</code></td>
<td>

<p>logical; if <code>TRUE</code> a horizontal line is drawn at zero.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>

<p>the y limits of the plot. For Mandel's k, the default lower limit for y is zero.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.adjust</code></td>
<td>

<p>Correction method for probabilities. If not <code>"none"</code>, passed to <code>p.adjust</code>
prior to calculating indicator lines. Usually, indicator lines are drawn without 
correction (that is, with <code>p.adjust="none"</code>); specifying a p-value correction 
effectively turns the Mandel's 	statistics into single outlier tests.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frame.plot</code></td>
<td>

<p>Logical; If <code>TRUE</code> a box is drawn around the plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>horizontal</code></td>
<td>

<p>if <code>TRUE</code> boxes are plotted horizontally and separators, indicators etc
adjusted accordingly.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>at</code></td>
<td>

<p>numeric vector giving the locations where the boxplots should
be drawn; defaults to <code>1:n</code> where <code>n</code> is the number of boxes.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Other (usually graphical) parameters passed to <code>barplot</code>. Note that some 
parameters appear after ... to prevent spurious argument matching inside
<code>barplot.default</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.ind, lty.ind, lwd.ind</code></td>
<td>

<p>Graphical parameters used for the indicator lines, recyckled to <code>length(probs)</code>. 
For <code>attr(x, "mandel.type")=="h"</code> the graphical parameters are applied to negative
as well as positive indicator lines, applied outwards from zero.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.sep, lwd.sep, lty.sep</code></td>
<td>

<p>Graphical parameters used for the separator lines.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd.zero, col.zero, lty.zero</code></td>
<td>

<p>Graphical parameters used for the zero line.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outlier.labels</code></td>
<td>

<p>Either a logical indicating whether outliers should be labelled or a character vector
of length nrow(x) giving labels. Defaults to row.names(x). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.lab, col.lab</code></td>
<td>

<p>Character size and colour for outlier labels, passed to <code>text</code> as 
<code>col</code> and <code>cex</code> respectively.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj, pos</code></td>
<td>

<p>Position of outlier labels relative to outliers; passed to <code>text</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>srt</code></td>
<td>

<p>Label rotation, in degrees, for outlier labels; passed to <code>text</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This plot produces a box plot (using <code>boxplot.default</code>) of the variables in an object of 
class <code>"mandel.kh"</code>. 
</p>
<p>If labels are specified for outliers (the default), outliers are first located based on the 
locations given by boxplot.default. WARNING: ties may be mislabelled, as the label 
allocated will be the _first_ point at that location.  
</p>
<p>Indicator lines are, if requested, drawn as for <code>plot.mandel.kh</code>.
</p>
<p>Vertical separators are drawn at midpoints of <code>at</code>. If 
</p>


<h3>Value</h3>

<p><code>boxplot.mandel.kh</code> returns the box plot statistics returned by 
<code>boxplot</code>, invisibly.
</p>


<h3>Author(s)</h3>

<p>S Ellison <a href="mailto:s.ellison@lgc.co.uk">s.ellison@lgc.co.uk</a>
</p>


<h3>See Also</h3>

<p><code>boxplot</code> for box plot arguments, and <code>text</code> for outlier label
location, colour and rotation.
<code>mandel.h</code>, <code>mandel.k</code>, <code>mandel.kh</code>,
<code>pmandelh</code>, <code>pmandelk</code>  for probabilities, quantiles etc.
</p>
<p>See <code>plot.mandel.kh</code> for the 'classic' Mandel plot.
</p>


<h3>Examples</h3>

<pre><code class="language-R">   data(RMstudy)

   h &lt;- with(RMstudy, mandel.h(RMstudy[2:9], g=Lab))
   boxplot(h, las=2) 
   	#Recall that for normally distributed data mandel's h should 
   	#have the same dispersion (and IQR) for all groups. But outliers adversely 
   	#affect the estimate of dispersion, so the interquartile ranges differ.
   	#The same effect also accounts for the many boxplot outliers visible
   	#inside the classical Mandel indicator lines; the indicators also 
   	#assume normality.
   	
   #with separators:
   boxplot(h, las=2, separators=TRUE)
   
   #With different labels and label colours:
   boxplot(h, las=2, outlier.labels=paste(1:nrow(h)), col.lab=1:5) 
   
   #... and a horizontal variant (note use of pos to change label positions)
   par(omd=c(0.1,1,0,1))		#to make room for axis labels
   boxplot(h, las=1, separators=TRUE, horizontal=TRUE, pos=1)

</code></pre>


</div>