<div class="container">

<table style="width: 100%;"><tr>
<td>.pmsd.xnorm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Internal functions for package RKC.
</h2>

<h3>Description</h3>

<p>The following functions are used internally by pmsd and qmsd.
</p>


<h3>Usage</h3>

<pre><code class="language-R">.pmsd.xnorm(q, x, n, sd = 1, scale = FALSE, method="exact")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>vector of quantiles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>scalar value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations in data set to which msd is applied</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd</code></td>
<td>
<p>Standard deviation, used to scale q.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>If scale is <code>TRUE</code>, <code>sd</code> is divided by <code>sqrt(2)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Controls method of calculation; see <code>pmsd</code> for details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Provides the distribution function for msd given a value x, using the cumulative 
probability for an order statistics givn in Mood, Graybill and Boes (1974) pp252ff.  
<code>pmsd</code> integrates (using <code>integrate</code>) over x to obtain the distribution 
function for msd for random x.</p>


<h3>Value</h3>

<p>A vector of probabilities</p>


<h3>Author(s)</h3>

<p>S Ellison <a href="mailto:s.ellison@lgc.co.uk">s.ellison@lgc.co.uk</a></p>


<h3>References</h3>

<p>Mood, Graybill and Boes (1974) pp252ff
</p>


<h3>See Also</h3>

<p><code>pmsd</code>, <code>msd</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## The function is currently defined as
function(q, x, n, sd=1, scale=FALSE) {

if(scale) sd &lt;- sd/sqrt(2)

pxnorm&lt;-function(q,x,sd=1) ifelse(q&gt;0, pnorm(x+q, 0, sd)-pnorm(x-q, 0, sd), 0) 

Fy&lt;-rep(0, length(q))

n.med&lt;-floor(n/2) #exact for odd samples, low for even
#Note that for n values there are n-1 differences,
#so an even-n case is an odd-median case
ph&lt;-pxnorm(q,x,sd)

for(j in n.med:(n-1)) Fy &lt;- Fy + choose(n-1,j) * (ph^j) * (1-ph)^(n-j-1)

return(Fy)

  }
</code></pre>


</div>