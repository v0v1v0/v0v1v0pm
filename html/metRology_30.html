<div class="container">

<table style="width: 100%;"><tr>
<td> cplot </td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Consistency plot for Key Comparisons </h2>

<h3>Description</h3>

<p>Produces a consistency plot for typical metrology comparison data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  cplot(x,u,labels=names(x), p.adjust.method="holm", ordered=TRUE,
        breaks=c(0,0.001,0.01, 0.05, 0.1,1), 
        col=terrain.colors(length(breaks)-1), log.p=FALSE,
        main=paste("Consistency map -", deparse(substitute(x))), 
        subtitle=NULL, key=FALSE, 
        key.width=2.54, key.height=0.6,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Vector of reported values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>Vector of length <code>length(x)</code> of standard uncertainties</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>Vector of of length <code>length(x)</code> labels for x-axis marks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.adjust.method</code></td>
<td>
<p>p-value adjustment method; passed to <code>p.adjust</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ordered</code></td>
<td>
<p>If <code>TRUE</code> (the default) observations are arranged in ascending order of <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>
<p>Vector of breaks; passed to <code>image</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>Vector of colours of length <code>length(breaks)-1</code>. Passed to <code>image</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.p</code></td>
<td>
<p>If <code>TRUE</code>, the plot shows <code>-log_10(p)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main, subtitle</code></td>
<td>
<p>Main and subtitle for plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>key</code></td>
<td>
<p>If <code>TRUE</code> a key is added to the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>key.width, key.height</code></td>
<td>
<p>Width and height of key, if plotted. See details for specification.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Graphical parameters passed to <code>image</code>. If present, <code>cex.axis</code> is passed 
to <code>axis</code> for main figure axes only.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Calculates the (square, symmetric matrix of) optionally adjusted p-values for a 
two-tailed z-test of <code>|x[i]-x[j]|/sqrt(u[i]^2+u[j]^2)</code> against zero
and plots the p-values as an image.
</p>
<p><code>p.adjust</code> is called prior to plotting to correct for multiple comparisons. 
To suppress adjustment, set <code>p.adjust.method="none"</code>. 
</p>
<p>key.height is a fraction of the figure region height. key.width is the width 
of the key area in cm, unless under 1, in which case it is interpreted as a 
fraction of the plot region width.
</p>
<p>If <code>log.p</code> is <code>TRUE</code> and <code>subtitle</code> <code>NULL</code>, 
a subtitle indicating the use of log.p is added to the plot, 
</p>


<h3>Value</h3>

<p>Invisibly returns a matrix of pairwise test p-values or, if <code>log.p==TRUE</code>,
matrix of <code>-log_10(p)</code>.	
</p>


<h3>Author(s)</h3>

<p>S Ellison <a href="mailto:s.ellison@lgc.co.uk">s.ellison@lgc.co.uk</a></p>


<h3>See Also</h3>

<p><code>p.adjust</code>, <code>image</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
  data(Pb)
  cplot(Pb$value, Pb$u, key=TRUE)

</code></pre>


</div>