<div class="container">

<table style="width: 100%;"><tr>
<td> pmsd </td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Median scaled difference probabilities and quantiles </h2>

<h3>Description</h3>

<p>Cumulative lower tail probability and quantile for median of scaled differences.
</p>


<h3>Usage</h3>

<pre><code class="language-R">	dmsd(q, n, method=c('fast', 'exact', 'even', 'asymp'), max.odd=199)
	
	pmsd(q, n, lower.tail = TRUE, 
		method=c('fast', 'exact', 'even', 'asymp'), max.odd=199)
	           
	qmsd(p, n, lower.tail = TRUE, 
		method=c('fast', 'exact', 'even', 'asymp'), max.odd=199)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>Vector of quantiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Vector of probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of observations from which msd was calculated. Unused (and can be missing)
for <code>method="asymp"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>logical; if TRUE (the default), probabilities are P[X &lt;= x];
otherwise, P[X &gt; x]. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Calculation method. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.odd</code></td>
<td>
<p>Highest odd <code>n</code> for which exact values are calculated.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>pmsd</code>, <code>dmsd</code> and <code>qmsd</code> return probabilities, densities and quantiles, respectively, 
for the median scaled difference applied to a single observation in a standard normal
distribution, where otehr values are also IID normal.
</p>
<p><code>n</code> is the number of observations in the data set of interest and <em>not</em> the degrees of 
freedom or number of differences (msd for a value x[i] in a set of <code>n</code> observations 
involves <code>n-1</code> scaled differences).
</p>
<p><code>n</code>, <code>p</code> and <code>q</code> are recycled to the length of the longest, as necessary.
</p>
<p><code>method</code> determines the method of calculation. 
For <code>method="fast"</code>, probabilities are calculated using monotonic spline 
interpolation on precalculated probabilities. <code>qmsd</code> with <code>method="fast"</code> is obtained 
by root-finding on the corresponding spline function using <code>uniroot</code>, and densities are 
estimated from the first derivative of the interpolating spline. This provides fast 
calculation, and values for most practical probabilities are within 10^-6 of exact calculations. 
For high probabilites and for low quantiles (below 0.48) at high <code>n</code>, fast quantile accuracy 
is poorer due to the very low function gradients in this regions, but is still guaranteed 
monotonic with <code>p</code>.
</p>
<p>For <code>method="exact"</code>, probabilities and densities are calculated using quadrature 
integration for an order statistic. For odd <code>n</code>, this requires a double integral. Values for 
odd <code>n</code> accordingly take about an order of magnitude longer to obtain than for even <code>n</code>. 
This can be slow (seconds for a vector of several hundred values of <code>q</code> on an Intel x86
machine running at 1-2GHz). <code>qmsd</code> with <code>method="exact"</code> is obtained by root-finding from 
<code>pmsd(..., method="excat")</code> using <code>uniroot</code>, and is over an order of magnitude slower than 
<code>pmsd</code> pmsd. 
</p>
<p>For <code>method="exact"</code>, asymptotic (large <code class="reqn">n</code>) probabilities, densities and quantiles are 
returned. <code>n</code> is unused and can be missing. 
</p>
<p>For <code>method="exact"</code>, odd <code>n</code> above <code>max.odd</code> are replaced with the next lower 
even value.  This  provides a fair approximation for <code>n</code> above 30 (though the fast method is better)
and a good approximation above the default of 199. Values of <code>max.odd</code> above 199 are not recommended 
as integration can become unstable at high odd <code>n</code>; a warning is issued if <code>max.odd &gt; 199</code>. 
</p>
<p>For <code>method="even"</code>, an exact calculation is performed with any odd <code>n</code> replaced with the 
next lower even value. This is equivalent to setting <code>method="exact"</code> and <code>max.odd=0</code>. 
This is provided for interest only; the <code>method="fast"</code> method provides a substantially better 
approximation for odd <code>n</code> than <code>method="even"</code> and is faster.
</p>
<p>Note that these functions are appropriate for the distribution of single values. If 
seeking an outlier test in a data set of size <code class="reqn">N</code>, either adjust <code>p</code> for <code class="reqn">N</code> 
comparisons before applying <code>qmsd</code> to find a critical value, or adjust the returned 
<em>p</em>-values using, for example, Holm adjustment.
</p>


<h3>Value</h3>

<p>A vector of length <code>length(p)</code> or <code>length(q)</code> (or, if longer, <code>length(n)</code>) of 
cumulative probabilities, densities or quantiles respectively.
</p>


<h3>Author(s)</h3>

<p>S Ellison <a href="mailto:s.ellison@lgc.co.uk">s.ellison@lgc.co.uk</a></p>


<h3>See Also</h3>

<p><code>msd</code> for calculation of MSD values, and <code>bootMSD</code> for 
a parametric bootstrap (MCS) method of obtaining <em>p</em>-values and quantiles
for the more general non-IID case.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
  data(Pb)
  msd(Pb$value)          # Uses mad(Pb$value) as scale estimate
  msd(Pb$value, Pb$u)    # Scales differences using standard uncertainties

</code></pre>


</div>