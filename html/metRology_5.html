<div class="container">

<table style="width: 100%;"><tr>
<td>algS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
‘Algorithm S’ - robust estimate of pooled standard deviation
</h2>

<h3>Description</h3>

<p>‘Algorithm S’ calculates a robust estimate of pooled standard deviation 
from a set of standard deviations
</p>


<h3>Usage</h3>

<pre><code class="language-R">	algS(s, degfree, na.rm = FALSE, prob.eta = 0.9, 
		is.range = FALSE, tol = .Machine$double.eps^0.25, 
		maxiter = 25, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p> A vector of standard deviations or, if <code>is.range</code> is <code>TRUE</code>,
ranges.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degfree</code></td>
<td>
<p>Scalar number of degrees of freedom associated with all 
values in <code>s</code>. If a vector is supplied,  <code>median(degfree)</code> will be used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>a logical value indicating whether 'NA' values should be
stripped before the computation proceeds.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob.eta</code></td>
<td>
<p>prob.eta is set to specify the lower tail area of the chi-squared 
distribution used as a cut-off.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>is.range</code></td>
<td>
<p>if is.range is TRUE, s is interpreted as a vector of positive differences of 
duplcate observations and degfree is set to 1
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Convergence tolerance Iteration continues until the relative 
change in estimated pooled sd drops below <code>tol</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>Maximum number of iterations permitted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Controls information displayed during iteration; see Details.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Algorithm S is suggested by ISO 5725-5:1998 as a robust estimator of 
pooled standard deviation <code class="reqn">s_{pool}</code> from standard deviations of 
groups of size <code class="reqn">\nu+1</code>. 
</p>
<p>The algorithm calculates a ‘limit factor’, <code class="reqn">\eta</code>, set to 
<code>qchisq(prob.eta, degfree)</code>. Following an initial estimate of 
<code class="reqn">s_{pool}</code> as <code>median(s)</code>, the standard deviations <code class="reqn">s_i</code>
are replaced with <code class="reqn">w_i=min(\eta*s_{pool}, s_i)</code> 
and an updated value for <code class="reqn">s_{pool}</code> calculated as
</p>
<p style="text-align: center;"><code class="reqn">\xi*\sqrt{\frac{\sum_{i=1}^{p} (w_i)^2}{p}}</code>
</p>

<p>where <code class="reqn">p</code> is the number of standard deviations and <code class="reqn">\xi</code> is calculated as
</p>
<p style="text-align: center;"><code class="reqn">\xi=\frac{1}{\sqrt{\chi_{p-1}^{2}\left(\nu\eta^{2}+\left(1-p_{\eta}\right)\eta^{2}\right)}}</code>
</p>

<p>If the <code class="reqn">s_i</code> are ranges of two values, ISO 5725 recommends 
carrying out the above iteration on the ranges and then dividing by 
<code class="reqn">\sqrt{\nu+1}</code>; in the implementation here, this
is done prior to returning the estimate.
</p>
<p>If <code>verbose</code> is non-zero, the current iteration number
and estimate are printed; if <code>verbose&gt;1</code>, the current set
of truncated values <code class="reqn">w</code> is also printed.
</p>


<h3>Value</h3>

<p>A scalar estimate of poooled standard deviation.
</p>


<h3>Author(s)</h3>

<p>S L R Ellison <a href="mailto:s.ellison@lgc.co.uk">s.ellison@lgc.co.uk</a>
</p>


<h3>References</h3>

<p>ISO 5725-5:1998 Accuracy (trueness and precision) of measurement methods and 
results - Part 5: Alternative methods for the determination of the precision 
of a standard measurement method
</p>


<h3>See Also</h3>

<p><code>algA</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#example from ISO 5725-5:1998 (cell ranges for percent creosote)

cdiff &lt;- c(0.28, 0.49, 0.40, 0.00, 0.35, 1.98, 0.80, 0.32, 0.95)

algS(cdiff, is.range=TRUE)
	

#Compare with the sd of the two values (based on the range)
c.sd &lt;- cdiff/sqrt(2)
algS(c.sd, degfree=1, verbose=TRUE)


</code></pre>


</div>