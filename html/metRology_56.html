<div class="container">

<table style="width: 100%;"><tr>
<td> kplot </td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Dot-and-bar plot for Key Comparisons </h2>

<h3>Description</h3>

<p>Produces a dot plot of typical metrology comparison data (value/uncertainty) with 
error bars, assigned value and uncertainty and optional percentage deviation axis or 
marginal density
</p>


<h3>Usage</h3>

<pre><code class="language-R">kplot(x, ...)

## Default S3 method:
kplot(x,U=NULL, labels=names(x),  assigned=NULL, U.assigned=NULL, 
	U.lo=U, U.hi=U, k=2, strata=NULL,
	do.percent=!is.null(assigned) &amp;&amp; !do.pdf, 
	ordered=TRUE, order.strata=levels(strata),
	xlim=c(0.5, length(x)+0.5), ylim,
	main=NULL, xlab=NULL, ylab=NULL,
	axis.main=2, axis.pct=4, at=1:length(x), at.main=NULL,
	cex.axis=0.8, las=2, las.pct=1, ylab.line=2.5, 
	ylab.line.pct=2.1, ci.width=0.03, col.ci=par("fg"), 
	lty.ci=par("lty"), lwd.ci=par("lwd"), pch=21, 
	col=par("fg"), bg="white", add.outliers=FALSE, 
	outlier.offset=0.2, mar=NULL, box=TRUE,
	do.pdf=FALSE, do.individual.pdf=do.pdf, 
	col.pdf=par("fg"), lwd.pdf=1, lty.pdf=1,
	do.total.pdf=TRUE, col.total.pdf=col.pdf[1], 
	lwd.total.pdf=2, lty.total.pdf=1, n.pdf=200, 
	pdf.layout=c(4,1), pdf.scale=0.7, pdf.offset=0.05, 
	xlim.pdf, pdf.axis=FALSE, las.pdf=0, 
	mgp.pdf=c(3,0.5,0), ...)
	
## S3 method for class 'ilab'
kplot(x, ...)

kpoints(x,U=NULL, labels=names(x), U.lo=U, U.hi=U, k=2, 
	strata=NULL, ordered=TRUE, order.strata=levels(strata),
	at=1:length(x), ci.width=0.03, col.ci=par("fg"), 
	lty.ci=par("lty"), lwd.ci=par("lwd"), pch=21, 
	col=par("fg"), bg="white", add.outliers=FALSE, 
	outlier.offset=0.2, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an R object. For the default method, a vector of reported values. For the 
ilab method, an object of class ‘ilab’</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U</code></td>
<td>
<p>Vector of length <code>length(x)</code> of expanded uncertainties</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>Vector of of length <code>length(x)</code> labels for x-axis marks. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>assigned</code></td>
<td>
<p>Assigned value for the comparison. Plotted as a horizontal line on the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U.assigned</code></td>
<td>
<p>Expanded uncertainty for the assigned value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U.lo, U.hi</code></td>
<td>
<p>Vectors of of length <code>length(x)</code> of lower and upper 
limits for the uncertainty intervals around the reported 
values, to allow asymmetric intervals. Both default to U. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Coverage factor originally used in calculating U. Required only if 
<code>do.pdf=TRUE</code>, as k is used to calculate standard uncertainties 
from U. k can be a scalar (recycled to length  <code>length(x)</code> 
if necessary) or a vector of length of length <code>length(x)</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strata</code></td>
<td>
<p>A Factor identifying subsets of the data. Currently not implemented.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.percent</code></td>
<td>
<p>Logical indicating whether percentage deviation should be 
plotted as a secondary axis. Defaults to <code>TRUE</code> if an assigned 
value is provided and <code>FALSE</code> if there is no assigned value 
or if a marginal density is  required via <code>do.pdf=TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ordered</code></td>
<td>
<p>If <code>TRUE</code>, values are plotted in ascending order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order.strata</code></td>
<td>
<p>Character vector showing the order of plotting for strata. 
Currently not implemented.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim, ylim</code></td>
<td>
<p>Plot limits as in <code>plot.default</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main, xlab, ylab</code></td>
<td>
<p>Titles; see <code>?title</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis.main, axis.pct</code></td>
<td>
<p>Integers specifying on which side of the plot the relevant axis is to
be drawn, passed to <code>axis</code> as <code>side</code>. The axis is placed as for follows: 
1=below, 2=left, 3=above and 4=right. The main axis (<code>axis.main</code>) is provided 
in the same units as <code>x</code>; the percentage axis (<code>axis.pct</code>) shows 
corresponding percentage deviation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>at</code></td>
<td>
<p>Vector of x-axis locations for the data points, x-axis tick marks and labels. 
Defaults to <code>1:length(x)</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>at.main</code></td>
<td>
<p>The points at which tick-marks are to be drawn on the main (y) axis. 
Passed to <code>axis</code> via <code>at</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.axis</code></td>
<td>
<p>The magnification to be used for axis annotation
relative to the current setting of 'cex'. Passed to <code>axis</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>las, las.pct</code></td>
<td>
<p>Integers defining x- and y axis and percentage axis label
orientation; see <code>par(las)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab.line, ylab.line.pct</code></td>
<td>
<p>Margin lines for main and percentage axis titles. 
Passed to <code>axis</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.width</code></td>
<td>
<p>Width of error bar terminators, passed to <code>arrows</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.ci, lty.ci, lwd.ci</code></td>
<td>
<p>Graphical parameters for the error bars; passed 
to <code>arrows</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch, col, bg</code></td>
<td>
<p>Graphical parameters for data points, passed to <code>points</code>. 
<code>bg</code> specifies the fill colour for <code>pch</code> from 21 to 25. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.outliers</code></td>
<td>
<p>If <code>TRUE</code>, points outside <code>ylim</code> are indicated as 
an arrow indicating the direction in which the omitted points lie, with 
a text label showing the reported value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outlier.offset</code></td>
<td>
<p>X-offset (in x-axis units) specifying lateral location of outlier 
tet labels relative to x-axis location of the outlier indicator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mar</code></td>
<td>
<p>Plot margins as in <code>par(mar)</code>. The default varies depending on 
<code>do.pct</code> and <code>do.pdf</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>box</code></td>
<td>
<p>If <code>TRUE</code>, a box is drawn round the plot region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.pdf</code></td>
<td>
<p>If <code>TRUE</code>, a marginal density and/or individual densities for the 
individual reported values are plotted based on the reported 
values <code>x</code> and standard uncertainties calculated as <code>U/k</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.individual.pdf</code></td>
<td>
<p>Logical controlling whether the individual densities 
are plotted as well as/instead of the combined density.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.pdf, lwd.pdf, lty.pdf</code></td>
<td>
<p>Graphical parameters controlling the appearance of 
the marginal density plot(s). Vectors are permitted, allowing different 
styles for each individual pdf.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.total.pdf</code></td>
<td>
<p>Logical controlling whether the sum of individual densities 
is plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.total.pdf, lwd.total.pdf, lty.total.pdf</code></td>
<td>
<p>Graphical parameters controlling the 
appearance of the marginal density plot for the combined density. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.pdf</code></td>
<td>
<p>Number of points used to construct the marginal density.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdf.layout</code></td>
<td>
<p>Vector of length 2 specifying the relative sizes of the main plot and 
marginal density plot. See <code>?layout</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdf.scale, pdf.offset</code></td>
<td>
<p>Offset and scaling factor used to control the location 
and height of the marginal density plot(s). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim.pdf</code></td>
<td>
<p>Controls the x-axis (i.e. the horizontal axis) for the marginal density 
plotting area. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdf.axis</code></td>
<td>
<p>If <code>TRUE</code> and no other axis has been plotted to the right of the main plot, 
an axis is plotted with the marginal density.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>las.pdf, mgp.pdf</code></td>
<td>
<p>Axis control parameters passed to <code>axis</code> to plot the axis for the 
marginal density.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Parameters passed to other functions; currently unused.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>do.pdf=TRUE</code> a marginal density plot is added. This plot is constructed 
from a set of (currently) normal densities centred at <code>x</code> with standard 
deviation <code>U/k</code>.
</p>
<p>If a marginal density is plotted, <code>par("layout")</code> is changed to 
<code>pdf.layout</code>; otherwise, <code>par("layout")</code> is set to <code>matrix(1)</code>. 
Both override any previously set layout. <code>par("layout")</code> is preserved on exit.
</p>
<p>The ‘ilab’ method passes all parameters in ‘...’ to the default method
with default values for <code>x</code>, upper and lower bounds <code>U.lo</code> and <code>U.hi</code>, 
labels and title taken from the <code>ilab</code> object.
</p>
<p><code>kpoints</code> is a convenience function for adding points with confidence 
intervals to an existing plot. <code>kpoints</code> is not a generic function  
and requires a vector <code>x</code>. Note that <code>kpoints</code> does not check for 
the presence of a marginal density plot.
</p>


<h3>Value</h3>

<p>Invisibly returns a list with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>The order for plotting the original data, as returned by <code>order</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>at</code></td>
<td>
<p> x-axis locations used, in plotting order. </p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>S Ellison <a href="mailto:s.ellison@lgc.co.uk">s.ellison@lgc.co.uk</a></p>


<h3>See Also</h3>

<p><code>arrows</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
  data(Pb)
  kplot(Pb$value, Pb$U, assigned=2.99, U.assigned=0.06)
  kplot(Pb$value, Pb$U, assigned=2.99, U.assigned=0.06, do.pdf=TRUE)
	
  #Use of return value for annotation
  kp&lt;-kplot(Pb$value, Pb$U, assigned=2.99, U.assigned=0.06)
  text(kp$at, Pb$value-Pb$U, Pb$lab, srt=90, pos=4, cex=0.7)

</code></pre>


</div>