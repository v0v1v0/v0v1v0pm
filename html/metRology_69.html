<div class="container">

<table style="width: 100%;"><tr>
<td>mandel.k</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Calculate Mandel's k statistics for replicate observations
</h2>

<h3>Description</h3>

<p><code>mandel.k</code> calculates Mandel's k statistics for replicate observations. 
Mandel's k an indicator of precision compared to the pooled standard deviation across
all groups.</p>


<h3>Usage</h3>

<pre><code class="language-R">	mandel.k(x, g = NULL, m = NULL, na.rm = T, rowname = NULL, 
			method=c("classical", "robust"), n = NA, ...)

	## Default S3 method:
mandel.k(x, g = NULL, m = NULL, na.rm = T, rowname = NULL, 
			method=c("classical", "robust"), n = NA, ...)

	## S3 method for class 'ilab'
mandel.k(x, g = NULL, m = NULL, na.rm = T, rowname = NULL, 
			method=c("classical", "robust"), n = NA, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An R object (see Details below), which contains replicate observations or, 
if <code>g</code> is absent, means or standard deviations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>A primary grouping factor, usually corresponding to Laboratory in an
inter-laboratory study. If not present, <code>x</code> is taken as 
a set of means or standard deviations (depending on whether 
<code>type</code> is <code>"h"</code> or <code>"k"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>A secondary grouping factor, usually corresponding to test item 
or measured quantity. <code>m</code> is ignored if <code>x</code> has
more than one column.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>A logical value indicating whether 'NA' values should be
stripped before the computation proceeds. Passed to functions 
such as <code>mean</code> and <code>sd</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rowname</code></td>
<td>
<p>A single character label for the primary grouping factor 
(e.g. "Lab", "Organisation").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Character scalar giving the calculation method. <code>"classical"</code> gives the
traditional calculation; <code>"robust"</code> gives a robust variant (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>scalar number of observations per group. Required only if <code>x</code> consists of 
calculated standard deviations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters passed to other methods. Currently not 
implemented.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>mandel.k</code> is a convenience wrapper for mandel.kh(..., type="k"). It is generic, 
with methods for numeric vectors, arrays, data frames, matrices and objects of 
class <code>'ilab'</code>. All parameters are passed to <code>mandel.kh</code>.
</p>
<p>Mandel's <code class="reqn">k</code> is an indicator of relative dispersion for grouped 
sets of observations. Given a set of observations <code class="reqn">x_{ijl}</code> where <code class="reqn">i, j, l</code>
denotes observation <code class="reqn">l</code>, <code class="reqn">l=1, 2, ... n</code> for measurand or test item <code class="reqn">j</code> and group
(usually laboratory) <code class="reqn">i</code>, <code class="reqn">i=1, 2, ... p</code>, Mandel's <code class="reqn">k</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">k=\sqrt{\frac{s_{ij}^2}{\sum_{i=1}^p{s_{ij}^2/p}}}</code>
</p>

<p>where <code class="reqn">s_{ij}</code> is the standard deviation of values <code class="reqn">x_{ijk}</code> over <code class="reqn">k=1, 2, ..., n</code>. 
</p>
<p>If <code>x</code> is a vector, one-dimensional array or single-column matrix, values are aggregated 
by <code>g</code> and, if present, by <code>m</code>. If <code>x</code> is a data frame or matrix, each column 
is aggregated by <code>g</code> and <code>m</code> silently ignored if present. In all cases, if <code>g</code>
is <code>NULL</code> or missing, each row (or value, if a vector) in <code>x</code> 
is taken as a pre-calculated mean (for Mandel's h) or standard deviation (for Mandel's k).
</p>
<p>If <code>x</code> is an object of class <code>'ilab'</code>, <code>g</code> defaults to <code>'$org'</code> and 
<code>m</code> to <code>$measurand</code>. 
</p>
<p>The returned object includes a label (<code>'grouped.by'</code>) for the primary grouping factor. 
For the <code>'ilab'</code> method, this is "Organisation". For other methods, If <code>rowname</code> is 
non-null, <code>rowname</code> is used. If <code>rowname</code> is NULL, the default is <code>deparse(substitute(g))</code>;
if <code>g</code> is also NULL or missing, "Row" is used.
</p>
<p>If <code>method="robust"</code>, Mandel's <code class="reqn">k</code> is calculated by replacing the classical pooled standard 
deviation with the robust pooled standard deviation calculated by algorithm S (see <code>algS</code>). 
</p>


<h3>Value</h3>

<p>mandel.k returns an object of class <code>"mandel.kh"</code>, which is  a data frame consisting
of the required Mandel's statistics and in which each row corresponds to a level of <code>g</code>
and each column to a level of <code>m</code> or (if <code>x</code> was a matrix or data frame) to the 
corresponding column in <code>x</code>. In addition to the class, the object has attributes:
</p>

<dl>
<dt>'mandel.type'</dt>
<dd>
<p><code>"h"</code> or <code>"k"</code></p>
</dd>
<dt>'grouped.by'</dt>
<dd>
<p>Character scalar giving the label used for the grouping 
factor <code>g</code>; see Details above for the defaults.</p>
</dd>
<dt>'n'</dt>
<dd>
<p>Number of observations per group (<code>n</code> if specified</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>S Ellison <a href="mailto:s.ellison@lgc.co.uk">s.ellison@lgc.co.uk</a>
</p>


<h3>References</h3>

<p>Accuracy (trueness and precision) of measurement methods and results â€“ Part 2: 
Basic method for the determination of repeatability and reproducibility of a 
standard measurement method. ISO, Geneva (1994).
</p>


<h3>See Also</h3>

<p><code>mandel.h</code>, <code>mandel.kh</code>;  
<code>pmandelh</code>, <code>pmandelk</code>  for probabilities, quantiles etc.;
<code>plot.mandel.kh</code>, <code>barplot.mandel.kh</code> for plotting methods.
</p>


<h3>Examples</h3>

<pre><code class="language-R">	data(RMstudy)

	#Data frame examples: note no secondary grouping factor
	h &lt;- with(RMstudy, mandel.k(RMstudy[2:9], g=Lab))
	plot(h, las=2)

	#Vector variant
	RMstk &lt;- stack(RMstudy[,2:9])
	names(RMstk) &lt;- c("x", "meas")
		#names replace 'values' and 'ind'
	RMstk$Lab &lt;- rep(RMstudy$Lab, 8)
	h2 &lt;- with(RMstk, mandel.k(x, g=Lab, m=meas, rowname="Laboratory"))
		#Note use of rowname to override g
	plot(h2, las=2)
	
	#ilab method
	RM.ilab &lt;- with(RMstk, construct.ilab(org=Lab, x=x, measurand=meas, 
		item=factor(rep("CRM", nrow(RMstk))) ) )

	plot(mandel.k(RM.ilab))
	
	#Robust variant
	krob &lt;- with(RMstudy, mandel.kh(RMstudy[2:9], g=Lab, type="k", method="robust"))
	plot(krob, las=2)
</code></pre>


</div>