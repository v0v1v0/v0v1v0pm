<div class="container">

<table style="width: 100%;"><tr>
<td>barplot.mandel.kh</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Barplot of Mandel's h or k statistics
</h2>

<h3>Description</h3>

<p><code>barplot.mandel.kh</code> produces a bar plot of Mandel's statistics, suitably
grouped and with appropriate indicator lines for unusual values.
</p>


<h3>Usage</h3>

<pre><code class="language-R">	## S3 method for class 'mandel.kh'
barplot(height, probs = c(0.95, 0.99), main,
		xlab = attr(height, "grouped.by"), 
		ylab = attr(height, "mandel.type"), separators = TRUE, 
		zero.line = TRUE, ylim, p.adjust = "none", 
		frame.plot = TRUE, ..., 
		col.ind = 1, lty.ind = c(2, 1), lwd.ind = 1, 
		col.sep = "lightgrey", lwd.sep = 1, lty.sep = 1, 
		lwd.zero = 1, col.zero = 1, lty.zero = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>height</code></td>
<td>
<p>An object of class <code>'mandel.kh'</code> (the name is for consistency 
with <code>barplot</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>

<p>Indicator lines are drawn for these probabilities. Note that
<code>probs</code> is interpreted as specifying two-tailed probabilities
for Mandel's h and one-sided (upper tail) probabilities for
Mandel's k.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>

<p>a main title for the plot. If missing, the default is
<code> paste(deparse(substitute(x)), " - Mandel's", 
                     attr(x, "mandel.type"), 
                     if(attr(x, "mandel.method") == "robust") "(Robust variant)")</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>

<p>a label for the x axis; defaults to the <code>grouped.by</code> attribute for
<code>x</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>

<p>a label for the x axis; defaults to the <code>mandel.type</code> attribute for
<code>x</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>separators</code></td>
<td>

<p>Logical; if <code>TRUE</code>, separator lines are drawn between groups of values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zero.line</code></td>
<td>

<p>logical; if <code>TRUE</code> a horizontal line is drawn at zero.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>

<p>the y limits of the plot. For Mandel's k, the default lower limit is zero.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.adjust</code></td>
<td>

<p>Correction method for probabilities. If not <code>"none"</code>, passed to <code>p.adjust</code>
prior to calculating indicator lines. Usually, indicator lines are drawn without 
correction (that is, with <code>p.adjust="none"</code>); specifying a p-value correction 
effectively turns the Mandel's 	statistics into single outlier tests.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frame.plot</code></td>
<td>

<p>Logical; If <code>TRUE</code> a box is drawn around the plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Other (usually graphical) parameters passed to <code>barplot</code>. Note that some 
parameters appear after ... to prevent spurious argument matching inside
<code>barplot.default</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.ind, lty.ind, lwd.ind</code></td>
<td>

<p>Graphical parameters used for the indicator lines, recyckled to <code>length(probs)</code>. 
For <code>attr(x, "mandel.type")=="h"</code> the graphical parameters are applied to negative
as well as positive indicator lines, applied outwards from zero.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.sep, lwd.sep, lty.sep</code></td>
<td>

<p>Graphical parameters used for the separator lines.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd.zero, col.zero, lty.zero</code></td>
<td>

<p>Graphical parameters used for the zero line.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Mandel's statistics are traditionally plotted for inter-laboratory study data, 
grouped by laboratory, to give a rapid graphical view of laboratory bias and 
relative precision. This plot produces a grouped, side-by-side bar plot.
</p>
<p>For classical Mandel statistics, indicator lines are drawn based on <code>qmandelh</code>
or  <code>qmandelk</code> as appropriate. For robust variants, indicator lines use
<code>qnorm</code> for the <code class="reqn">h</code> statistic and <code>qf(probs, n, Inf)</code> for 
the <code class="reqn">k</code> statistic. Note that this corresponds to taking the robust estimates of 
location and scale as true values, so will be somewhat anticonservative.
</p>


<h3>Value</h3>

<p>barplot.mandel.kh returns a numeric vector of mid-points of the groups 
along the x-axis.
</p>


<h3>Author(s)</h3>

<p>S Ellison <a href="mailto:s.ellison@lgc.co.uk">s.ellison@lgc.co.uk</a>
</p>


<h3>References</h3>

<p>Accuracy (trueness and precision) of measurement methods and results â€“ Part 2: 
Basic method for the determination of repeatability and reproducibility of a 
standard measurement method. ISO, Geneva (1994).
</p>


<h3>See Also</h3>

<p><code>mandel.h</code>, <code>mandel.k</code>, <code>mandel.kh</code>,
<code>pmandelh</code>, <code>pmandelk</code>  for probabilities, quantiles etc.
</p>
<p>See <code>plot.mandel.kh</code> for the 'classic' Mandel plot.
</p>


<h3>Examples</h3>

<pre><code class="language-R">   data(RMstudy)

   h &lt;- with(RMstudy, mandel.h(RMstudy[2:9], g=Lab))
   barplot(h, las=2) # Lab 4 shows consistent low bias; 
                  # Lab 23 several extreme values.

   #Use colours to identify particular measurands:
   barplot(h, las=2, col=1:8)
   legend("bottomleft", legend=names(h), fill=1:8, cex=0.7, bg="white")
   
   #Example of Mandel's k:
   k &lt;- with(RMstudy, mandel.k(RMstudy[2:9], g=Lab))
   barplot(k, las=2) # Lab 8 looks unusually variable; 
                  # Lab 14 unusually precise
</code></pre>


</div>