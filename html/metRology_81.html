<div class="container">

<table style="width: 100%;"><tr>
<td>mle.1wre</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Vangel-Rukhin Maximum Likelihood Estimate
</h2>

<h3>Description</h3>

<p>Calculate a weighted mean, between-group standard deviation and
standard error on the weighted mean using the Maximum likelihood 
algorithm of Vangel-Rukhin.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mle.1wre(x, s2, n, init.mu = mean(x), init.sigma2 = var(x), labels = c(1:length(x)), 
         max.iter = 200, tol = .Machine$double.eps^0.5, trace = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>numeric vector of the sample mean values of each group
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s2</code></td>
<td>

<p>numeric vector of the sample variances of each group
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>integer vector of sample size of each group
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init.mu</code></td>
<td>

<p>numeric initial value for the mean
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init.sigma2</code></td>
<td>

<p>numeric initial value for the between-group component of variance
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>

<p>vector of group names. Coerced to character on use.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.iter</code></td>
<td>

<p>numeric maximum number of iterations
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>

<p>numeric tolerance; iteration stops when the relative step size drops 
below 'tol'
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>

<p>when TRUE shows the sequence of intermediate results
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Vangel-Rukhin MLE algorithm finds the between-method variance by
iteratively solving the equation relating the weighted mean to the
weighting factor applied. The weighting factor is the inverse of
the sum of the standard error in 'x' and the between-method
variance, scaled by the between-method variance.
</p>
<p>For the default method, 's2'  is interpreted as a vector of
sample variances. 'x' is interpreted as a vector of sample means
and the algorithm is applied to the corresponding group means,
variances, and sample sizes.
</p>
<p>The Vangel-Rukhin MLE algorithm shows an improvement in the number
of iterations required to converge over the classical MLE based on
the Score equations.
</p>
<p>The function mle.1wre implements the MLE for the one way random effects 
based on the Fisher scoring equations and is provided for comparison 
purpose only.
</p>


<h3>Value</h3>

<p><code>mle.1wre</code> returns an object of class "summary.mle.1wre" which contains
the following fields:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>the estimated mean
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.mu</code></td>
<td>
<p>the variance associated with the estimated mean
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2</code></td>
<td>
<p>the estimated between variance component
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>llh</code></td>
<td>
<p>the log likelihood of the estimates
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tot.iter</code></td>
<td>
<p>the total number of iterations ran
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cur.rel.abs.error</code></td>
<td>
<p>the current relative absolute error reached
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmai2</code></td>
<td>
<p>a vector with the estimates of the within variance components
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>H. Gasca-Aragon
</p>


<h3>References</h3>

<p>Vangel, M. G. and Rukhin, A. L. (1999), Biometrics, Vol 55, No. 1 pp 129-136
</p>
<p>Searle, S. R., Cassella, G., and McCulloch, C. E. (1992). Variance Components. New York: Wiley.
</p>


<h3>See Also</h3>

<p><code>vr.mle</code>, <code>loc.est-class</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
     ##===================================================================
     ## the dietary fiber in apples example in the Vangel and Rukhin paper
     ##===================================================================

     m1 &lt;- c(12.46, 13.035, 12.44, 12.87, 13.42, 12.08, 13.18, 14.335, 12.23)
     s1 &lt;- c(0.028, 0.233, 0.325, 0.071, 0.339, 0.325, 0.099, 0.064, 0.212)
     n1 &lt;- c(2, 2, 2, 2, 2, 2, 2, 2, 2)

     mle.1wre(m1, s1^2, n1, tol=1e-6)


     # output:
     # 12.90585
     # 0.2234490
     # 0.4262122
     # 12.46790 13.34380
     # 6
 
</code></pre>


</div>