<div class="container">

<table style="width: 100%;"><tr>
<td>Mandel-Paule</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mandel-Paule calculation</h2>

<h3>Description</h3>

<p>Calculate a weighted mean, between-group standard deviation and standard error on the
weighted mean using the Mandel-Paule algorithm. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">
mpaule(x, ..., tol=.Machine$double.eps^0.25, maxiter=25) 

## Default S3 method:
mpaule(x, u=NULL, n=NULL, groups=NULL, 
                   tol=.Machine$double.eps^0.25, maxiter=25, ...)

mandel.paule(x, ..., tol=.Machine$double.eps^0.25, maxiter=25) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numeric vector of mean values for groups, or (if <code>groups</code> 
is given) of individual observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>numeric vector of standard deviations or standard uncertainties 
associated with the values <code>x</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>integer vector of numbers in each group. If <code>NULL</code>, <code>u</code> are interpreted as 
standard uncertainties or standard errors. <code>n</code> is recycled to <code>length(x)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>factor, or vetor which can be coerced to factor, of groups. If present, <code>x</code> is 
interpreted as a vector of individual observations and <code>u</code> and <code>n</code> ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters passed to other functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>numeric tolerance; iteration stops when the variance step size drops below <code>tol*var(x)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>numeric maximum number of iterations</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Mandel-Paule algorithm finds the between-method variance by iteratively solving the
equation relating the weighted mean to the weighting factor applied. The weighting factor is
the inverse of the sum of the standard error in <code>x</code> and the between-group variance.
</p>
<p>If the iterative procedure produces a negative estimate for the between-group variance,
the between-group variance is set to zero.
</p>
<p>For the default method, if <code>u</code> is present and <code>n=NULL</code>, <code>u</code> is interpreted as 
a vector of standard uncertainties or standard errors. If <code>n</code> is not <code>NULL</code>, <code>u</code> 
is interpreted as a vector of standard deviations and standard errors are calculated as 
<code>u/sqrt(n)</code>.
If <code>groups</code> is not <code>NULL</code>, <code>x</code> is interpreted as a vector of individual 
observations grouped by <code>groups</code>, and the algorithm is applied to the corresponding 
group means and standard errors. 
</p>
<p>If <code>maxiter</code> is set less than 1, no iterations are performed and the consensus mean 
is returned as <code>NA</code>.
</p>
<p><code>mandel.paule</code> is an alias for <code>mpaule</code> retained for backward compatibility.
</p>


<h3>Value</h3>

<p>A loc.est object; see loc.est for details. In the returned object, <code>df</code> is
set to <code class="reqn">n-1</code> where <code class="reqn">n</code> is the number of non-<code>NA</code> observations or
group means as appropriate, and <code>method.details</code> is returned as :
</p>
<table>
<tr style="vertical-align: top;">
<td><code>var.between</code></td>
<td>
<p>the estimated between-group variance)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>the number of iterations taken</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>converged</code></td>
<td>
<p><code>converged</code> indicates the convergence status. <code>0L</code> indicates
failure to converge (<code>maxiter</code> reached before step size drops below tolerance); 
<code>1L</code> indicates normal convergence; <code>2L</code> indicates that the final step size resulted 
in a negative between-group variance, at which point the variance and step size are set to 0.0</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>S. Cowen <a href="mailto:simon.cowen@lgc.co.uk">simon.cowen@lgc.co.uk</a> with amendments by S. L. R. Ellison.
</p>


<h3>References</h3>

<p>Paule, R. C.  and Mandel, J. (1982), J Res Nat Bur Stand, <b>87</b>, (5) 377-385 
</p>


<h3>Examples</h3>

<pre><code class="language-R">## the second example in the paper cited above
x &lt;- c(201.533, 216.55)
s &lt;- c(0.154, 0.25)
n &lt;- c(6, 2)

mpaule(x, s/sqrt(n))

## Cd heat of vapourisation example from the paper cited above
x2&lt;-c(27.044, 26.022, 26.340, 26.787, 26.796)
v&lt;-c(3, 76, 464, 3, 14)*1e-3
mpaule(x2, sqrt(v))

</code></pre>


</div>