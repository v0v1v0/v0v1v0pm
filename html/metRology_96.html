<div class="container">

<table style="width: 100%;"><tr>
<td>plot.uncert</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Plot method for 'uncert' objects
</h2>

<h3>Description</h3>

<p>Plots for uncertainty budgets produced by <code>uncert</code> calls.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'uncert'
plot(x, which = c(1,2,4,5), main = paste(deparse(substitute(x))), 
    ask = prod(par("mfcol")) &lt; length(which) &amp;&amp; dev.interactive(), 
    caption = list("Variance and covariance contributions", 
    expression(sqrt(group("|", "Variance and covariance contributions", "|"))), 
    expression("Contribution " * u[i](y) == c[i] * u[i]), 
    "Combined contribution", "Correlation (x,y)", 
    "Covariances (x,y)"), cex.caption = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class <code>uncert</code> produced by a call to <code>uncert()</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>Integer in 1:6; the particular variant(s) of plot required. A 
vector is permitted, in which case plots are produced in ascending order.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>Main title for the plot
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ask</code></td>
<td>
<p>logical; if 'TRUE', the user is _ask_ed before each plot, see 'par("ask=")'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>caption</code></td>
<td>
<p>A list of captions for <em>all</em> the different plots. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.caption</code></td>
<td>
<p>Text size for captions. Note that if the number of figures per 
page is over 2, captions are further scaled by 0.8 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further parameters passed to <code>plot()</code> (mostly barplot).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For uncert objects created with methods other than MC, the plot types are:
</p>

<dl>
<dt><code>which=1</code></dt>
<dd>
<p>A barplot of all non-zero contributions to the combined 
uncertainty. These are derived from the covariance matrix and the coefficients <code class="reqn">c_i</code>. 
For terms on the diagonal of the covariance matrix, these are <code class="reqn">(c_i*u_i)^2</code>; for 
off-diagonal terms (the correlation terms), <code class="reqn">2*(c_i*u_i)*(c_j*u_j)*r_ij</code>. 
The threshold for deciding an off-diagonal term is nonzero is that its magnitude 
is greater than <code>2*.Machine$double.eps</code>. Note that off-diagonal contributions
may be negative.</p>
</dd>
<dt><code>which=2</code></dt>
<dd>
<p>As for <code>which=1</code> except that the square root of the 
absolute value is plotted. For the 'diagonal' terms, these are just eqnu_i(y) 
in the nomenclature used by the GUM.</p>
</dd>
<dt><code>which=3</code></dt>
<dd>
<p>A barplot of <code class="reqn">u_i(y)^2</code>, without the correlation terms.</p>
</dd>
<dt><code>which=4</code></dt>
<dd>
<p>A barplot of the sum of all (co)variance contributions 
associated with each <code class="reqn">x_i</code>, that is, 
</p>
<p style="text-align: center;"><code class="reqn">contrib(i)=(c_{i}u_{i})^2+\sum\nolimits _{j\neq{}i} 2(c_{i}u_{i})(c_{j}u_{j})r_{i,j}</code>
</p>
<p>. 
</p>
</dd>
<dt><code>which=5</code></dt>
<dd>
<p>A barplot of the theoretical correlations 
<code class="reqn">cov(x_i,y)/u(x_i)u_y</code>. 
</p>
</dd>
<dt><code>which=6</code></dt>
<dd>
<p>A barplot of the theoretical covariances <code class="reqn">cov(x_i,y)</code>. 
</p>
</dd>
</dl>
<p>Values of <code>which</code> outside this range are silently ignored.
</p>
<p>For the X-Y correlation and covariance plots, the covariances are calculated from the 
covariance matrix <code class="reqn">V</code> (supplied to <code>uncert()</code> as <code>cov</code> 
or calculated as <code>outer(u,u,"*")*cor</code>) and sensitivity coefficients <code class="reqn">c_i</code> 
as <code class="reqn">cov(x_i,y) = \sum\nolimits _{j} V_{j,i}c_j </code>. 
In fact the calculation used is simpler: <code>cov.xy &lt;- V %*% ci</code>. The correlations 
are calculated in turn from these using <code class="reqn">cov(x_i,y)/u(x_i)u_y</code>.
</p>
<p>Perhaps the most informative plots are for <code>which=1</code>, <code>which=2</code>,
<code>which=4</code> and <code>which=5</code>. The first of these includes all nonzero signed contributions, 
making the negative contributions visible; the second (<code>which=2</code>) makes direct
comparison of magnitudes easier. The combined contribution plot is the effect on
the total variance of removing all terms associated with a particular variable; it
shows how much <code class="reqn">u_y^2</code> would <em>reduce</em> if the uncertainty for <code class="reqn">x_i</code> were 
reduced to zero. Note that in some cases with negative correlation the combined uncertainty can <em>increase</em>,
on dropping a variable, shown by a negative reduction in the plot. (<code>which=5</code>) is among the most 
direct indications of the relative importance of individual parameters.
</p>
<p>Objects created with the MC method are passed to <code>plot.uncertMC</code>.
</p>


<h3>Value</h3>

<p>Invisibly returns the default return value for the last plot produced.</p>


<h3>Author(s)</h3>

<p>S. L. R. Ellison, <a href="mailto:s.ellison@lgc.co.uk">s.ellison@lgc.co.uk</a>
</p>


<h3>References</h3>

<p>None.
</p>


<h3>See Also</h3>

<p><code>uncert</code>, <code>barplot</code>, <code>plot.uncertMC</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  
  #An example with negative correlation
  x &lt;- list(a=1, b=3, c=2, d=11)
  u &lt;- lapply(x, function(x) x/10)
  u.cor&lt;-diag(1,4)
  u.cor[3,4]&lt;-u.cor[4,3]&lt;- -0.5
  u.form.c&lt;-uncert(~a+b*2+c*3+d/2, x, u, method="NUM", cor=u.cor)
  
  par(mfrow=c(3,2))
  plot(u.form.c, which=1:6, las=1, horiz=TRUE)  #Note use of barplot parameters

</code></pre>


</div>