<div class="container">

<table style="width: 100%;"><tr>
<td>Mandel-k</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Mandel's k statistic.
</h2>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random
generation for Mandel's k statistic, a measure of relative 
precision compared to a common variance.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dmandelk(x, g, n, log = FALSE)
pmandelk(q, g, n, lower.tail = TRUE, log.p = FALSE)
qmandelk(p, g, n, lower.tail = TRUE, log.p = FALSE)
rmandelk(B, g, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, q</code></td>
<td>
<p>vector of quantiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>vector of probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>number of groups for which k is calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations in each group of data for which k is calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p> Number of observations. If 'length(B) &gt; 1', the length is
taken to be the number required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>logical; if TRUE (default), probabilities are P[X &lt;= x];
otherwise, P[X &gt; x].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log, log.p</code></td>
<td>
<p>logical; if TRUE, probabilities p are given as log(p).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Mandel's k for one of a set of <code class="reqn">g</code> standard deviations <code class="reqn">s</code> is calculated as
</p>
<p style="text-align: center;"><code class="reqn">k=\frac{s_{ij}^2}{\sum_{i=1}^p{s_{ij}^2/p}}</code>
</p>

<p>Since the numerator is chi-squared(n-1), or Gamma((n-1)/2, 2),  and the denominator 
can be written as the sum of the same quantity and a pooled variance with distribution
Gamma((g-1)*(n-1)/2, 2), k is distributed as Beta((n-1)/2, (g-1)(n-1)/2).
Quantiles, probabilities, density and random numbers can therefore be generated
from the Beta distribution. For example, qmandelk is calculated as 
<code>sqrt( g * qbeta( (n-1)/2, (g-1)*(n-1)/2))</code>.
</p>


<h3>Value</h3>

<p>dmandelh returns the density at <code>x</code>, pmandelh the cumulative probability,  
qmandelh the quantiles for probability <code>p</code> and rmandelh returns <code>B</code> 
random values drawn from the distribution. 
</p>
<p>Vector values of x, p, q and g are permitted, in which case the functions return vectors.
</p>


<h3>Warning </h3>

<p>Note that <code>rmandelk</code> uses <code>B</code> and not <code>n</code> (as do most R random 
number functions) for number of random draws; this is because <code>n</code> is conventionally
used for the number of replicates per group. Be careful when using named parameters!
</p>


<h3>Author(s)</h3>

<p>S. L. R. Ellison, <a href="mailto:s.ellison@lgc.co.uk">s.ellison@lgc.co.uk</a>
</p>


<h3>References</h3>

<p>None.
</p>


<h3>See Also</h3>

<p><code>pmandelh</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">	#Generate the 95% and 99% quantiles for comparison with tables in 
	#ISO 5725:1996 Part 2:
	
	round(qmandelk(0.95, g=3:30, n=3), 2) #95% upper tail

	round(qmandelk(0.99, g=3:30, n=3), 2) #99% upper tail
	
</code></pre>


</div>