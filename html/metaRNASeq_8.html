<div class="container">

<table style="width: 100%;"><tr>
<td>invnorm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
P-value combination using the inverse normal method
</h2>

<h3>Description</h3>

<p>Combines one sided p-values using the inverse normal method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">invnorm(indpval, nrep, BHth = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>indpval</code></td>
<td>

<p>List of vectors of one sided p-values to be combined.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrep</code></td>
<td>

<p>Vector of numbers of replicates used in each study to calculate the previous one-sided p-values. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BHth</code></td>
<td>

<p>Benjamini Hochberg threshold. By default, the False Discovery Rate is controlled at 5%.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For each gene <em>g</em>, let
</p>
<p style="text-align: center;"><code class="reqn">N_g = \sum_{s=1}^S \omega_s \Phi^{-1}(1-p_{gs}),</code>
</p>

<p>where <code class="reqn">p_{gs}</code> corresponds to the raw <em>p</em>-value obtained for gene <em>g</em> in a differential
analysis for study <em>s</em> (assumed to be uniformly distributed under the null hypothesis), <code class="reqn">\Phi</code> the
cumulative distribution function of the standard normal distribution, and <code class="reqn">\omega_s</code> a set of weights.
We define the weights <code class="reqn">\omega_s</code> as in Marot and Mayer (2009):
</p>
<p style="text-align: center;"><code class="reqn">\omega_s = \sqrt{\frac{\sum_c R_{cs}}{\sum_\ell \sum_c R_{c\ell}}},</code>
</p>

<p>where <code class="reqn">\sum_c R_{cs}</code> is the total number of biological replicates in study <em>s</em>. This allows
studies with large numbers of biological replicates to be attributed a larger weight than smaller studies.
</p>
<p>Under the null hypothesis, the test statistic <code class="reqn">N_g</code> follows a N(0,1) distribution. A unilateral
test on the righthand tail of the distribution may then be performed, and classical procedures for the
correction of multiple testing, such as that of Benjamini and Hochberg (1995), may subsequently be applied to
the obtained <em>p</em>-values to control the false discovery rate at a desired level <code class="reqn">\alpha</code>.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>DEindices </code></td>
<td>
<p>Indices of differentially expressed genes at the chosen Benjamini Hochberg threshold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TestStatistic </code></td>
<td>
<p>Vector with test statistics for differential expression in the meta-analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rawpval </code></td>
<td>
<p>Vector with raw p-values for differential expression in the meta-analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjpval </code></td>
<td>
<p>Vector with adjusted p-values for differential expression in the meta-analysis.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>This function resembles the function <code>directpvalcombi</code> in the <em>metaMA</em> R package; there is, however, one 
important difference in the calculation of <em>p</em>-values. In particular, for microarray data, it is typically 
advised to separate under- and over-expressed genes prior to the meta-analysis. In the case of RNA-seq data, 
differential analyses from individual studies typically make use of negative binomial models and exact tests, 
which lead to one-sided, rather than two-sided, p-values. As such, we suggest performing a meta-analysis over 
the full set of genes, followed by an a posteriori check, and if necessary filter, of genes with conflicting 
results (over vs. under expression) among studies.
</p>


<h3>References</h3>

 
<p>Y. Benjamini and Y. Hochberg (1995). Controlling the false discovery rate: a pratical and powerful approach
to multiple testing. <em>JRSS B</em> (57): 289-300.
</p>
<p>Hedges, L. and Olkin, I. (1985). Statistical Methods for Meta-Analysis. Academic Press. 
</p>
<p>Marot, G. and Mayer, C.-D. (2009). Sequential analysis for microarray data based on sensitivity and meta-analysis.
<em>SAGMB</em> 8(1): 1-33.
</p>
<p>A. Rau, G. Marot and F. Jaffrezic (2014). Differential meta-analysis of RNA-seq data. <em>BMC Bioinformatics</em> <b>15</b>:91</p>


<h3>See Also</h3>

<p><code>metaRNASeq</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(rawpval)
## 8 replicates simulated in each study
invnormcomb &lt;- invnorm(rawpval,nrep=c(8,8), BHth = 0.05)       
DE &lt;- ifelse(invnormcomb$adjpval&lt;=0.05,1,0)
hist(invnormcomb$rawpval,nclass=100)

## A more detailed example is given in the vignette of the package:
## vignette("metaRNASeq")
</code></pre>


</div>