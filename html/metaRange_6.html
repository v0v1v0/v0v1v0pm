<div class="container">

<table style="width: 100%;"><tr>
<td>dispersal</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Dispersal process</h2>

<h3>Description</h3>

<p>Disperse a (abundance) matrix using a dispersal kernel and optional weights.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dispersal(dispersal_kernel, abundance, weights)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dispersal_kernel</code></td>
<td>
<p><code style="white-space: pre;">⁠&lt;numeric matrix&gt;⁠</code> dispersal kernel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abundance</code></td>
<td>
<p><code style="white-space: pre;">⁠&lt;numeric matrix&gt;⁠</code> abundance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p><code style="white-space: pre;">⁠&lt;numeric matrix&gt;⁠</code>  optional weights in form of a matrix
that has the same dimensions as the abundance and a range: between <code style="white-space: pre;">⁠0, 1⁠</code>.
Should not contain any <code>NA</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The abundance matrix is dispersed using the dispersal kernel.
If a matrix of weights is supplied, the individuals will redistribute
within the dispersal kernel according to the weights.
I.e. individuals will more likely move towards areas with a higher
weight, if they are within their dispersal distance.
Note:
</p>

<ul>
<li>
<p> the abundance is modified in place, to optimize performance.
</p>
</li>
<li>
<p> Any <code>NA</code> or <code>NaN</code> in abundance or weights will be (in-place) replaced by <code>0</code>.
</p>
</li>
</ul>
<h3>Value</h3>

<p><code style="white-space: pre;">⁠&lt;numeric matrix&gt;⁠</code> Dispersed abundance matrix.
</p>


<h3>Examples</h3>

<pre><code class="language-R">n &lt;- 10
n2 &lt;- n^2
abu &lt;- matrix(1:n2, nrow = n, ncol = n)
suitab &lt;- matrix(1, nrow = n, ncol = n)
kernel &lt;- calculate_dispersal_kernel(
    max_dispersal_dist = 4,
    kfun = negative_exponential_function,
    mean_dispersal_dist = 1.2
)
res1 &lt;- dispersal(
    dispersal_kernel = kernel,
    abundance = abu
)
res2 &lt;- dispersal(
    dispersal_kernel = kernel,
    abundance = abu,
    weights = suitab
)
stopifnot(sum(res1) - sum(res2) &lt; 0.01)
# Note that the abundance is modified in place, i.e:
stopifnot(sum(abu - res2) &lt; 0.01)
</code></pre>


</div>