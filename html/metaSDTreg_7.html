<div class="container">

<table style="width: 100%;"><tr>
<td>metaSDTreg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Meta-SDT regression</h2>

<h3>Description</h3>

<p>Fit the meta SDT regression model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">metaSDTreg(
  formula,
  data,
  subset,
  na.action = na.fail,
  control = metaSDTcontrol()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>Formula specifying the regression model. Presently, the left-hand side should be the ordinal variable A, while the right-hand side must contain the signal variable from the metaSDTdata object. Note that the variable 'signal' has a special interpretation in the model, see 'Details' below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data frame to fit the model on. Should be declared as metaSDTdata using the <code>metaSDTdata</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>Optional argument specifying a subset of the data to be used. A logical statement, which is evaluated in 'data'. Only rows with TRUE are used in the analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>Method for handling missing values, see na.action. Default is na.fail which stops the function with an error in the presence of missing values among variables entering 'formula'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>Optimisation control, see <code>metaSDTcontrol</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The input data frame should be of class 'metaSDTdata' as constructed by the function <code>metaSDTdata</code>. This will contain a variable, 'signal' which presently must be included on the right-hand side of the formula. The left hand side must be the ordinal variable 'A' also contained in the metaSDTdata object.
The 'signal' variable has a special interpretation as its coefficients are the signal sensitivities (type 1 d-prime and the two response specific type 2 sensitivities meta-d-prime). Presently all other variables, as determined by <code>all.vars(update(formula, . ~ . - signal ))</code>, enter proportionally in the model, i.e. they share cofficients across response scale levels. See Kristensen &amp; al. (2020) for details.
This can be written formally as follows (in the notation of Kristensen &amp; al. (2020)): 
</p>
<p style="text-align: center;"><code class="reqn">    V_{\mathcal{N}} = V_{\mathcal{S}} = V ,  </code>
</p>

<p>and <code class="reqn"> \beta_{\mathcal{N}} </code>, <code class="reqn"> \beta_{\mathcal{S}} </code> and <code class="reqn"> \beta </code> agree on all but the first entrance which is the signal sensitivities <code class="reqn"> d_{mathcal{N}} </code>, <code class="reqn"> d_{mathcal{S}} </code> and <code class="reqn"> d </code>, respectively.
Note that 'formula' specifies the mean of the latent variables and not the threshold model. Accordingly, attemps to remove the intercept in 'formula' will be ignored with a warning.
The function fails when the left-hand side of 'formula' is not the ordinal variable 'A' and when 'data' is not a 'metaSDTdata' object. Future versions may be less defensive and simply issue a warning in these cases.
Note that constrained optimisation is used to maximise the likelihood under ordinality of the thresholds. The variance-covariance matrix is not adjusted following the constrained estimation, cf. documentation of <code>maxLik</code>.
When interpreting results from <code>summary.metaSDTreg()</code> care should be taken regarding the z-testor and associated p-value for threshold parameters, as the distribution of the statistic depends on the null hypothesis which will only be reasonable under special circumstances as in other types of ordinal models.
</p>


<h3>Value</h3>

<p>An object of class 'metaSDTreg'. This is a list object containing,
</p>

<ul>
<li>
<p> logLik: The log likelihood after optimisation.
</p>
</li>
<li>
<p> coefficients: Estimated coefficients.
</p>
</li>
<li>
<p> vcov: Variance-covariance matrix of the maxLik object.
</p>
</li>
<li>
<p> call: The call issued to metaSDTreg.
</p>
</li>
<li>
<p> na.act: The NA action.
</p>
</li>
</ul>
<h3>References</h3>

<p>Kristensen, S. B., Sandberg, K., &amp; Bibby, B. M. (2020). Regression
methods for metacognitive sensitivity. Journal of Mathematical
Psychology, 94. &lt;doi:10.1016/j.jmp.2019.102297&gt;.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Declare simulated data as metaSDTdata
metadata &lt;- metaSDTdata(simMetaData, type1='resp', type2='conf', signal='S')

## Fit function to data of first 20 replications per subject
fit_sub &lt;- metaSDTreg(A ~ signal,
                      data=metadata,
                      subset = m &lt;= 20)
summary(fit_sub)


## Fit model to estimate thresholds and sensitivities
fit &lt;- metaSDTreg(A ~ signal,
            data=metadata)

## True values are
## c(tau.n.2=-0.5, tau.n.1=-0.2, theta=0,
##   tau.s.1=0.8, tau.s.2=1, d.n=0.5, d=1, d.s=0.75)
coef(fit)



</code></pre>


</div>