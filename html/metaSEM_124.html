<div class="container">

<table style="width: 100%;"><tr>
<td>reml</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate Variance Components with Restricted (Residual) Maximum
Likelihood Estimation
</h2>

<h3>Description</h3>

<p>It estimates the variance components of random-effects in univariate and
multivariate meta-analysis with restricted (residual) maximum likelihood
(REML) estimation method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">reml(y, v, x, data, RE.constraints = NULL, RE.startvalues = 0.1,
     RE.lbound = 1e-10, intervals.type = c("z", "LB"),
     model.name="Variance component with REML",
     suppressWarnings = TRUE, silent = TRUE, run = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A vector of effect size for univariate meta-analysis or a <code class="reqn">k</code> x
<code class="reqn">p</code> matrix of effect sizes for multivariate meta-analysis
where <code class="reqn">k</code> is the number of studies and <code class="reqn">p</code> is the
number of effect sizes. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>A vector of the sampling variance of the effect size for univariate
meta-analysis or a <code class="reqn">k</code> x <code class="reqn">p*</code> matrix of the sampling
covariance matrix of the effect sizes for multivariate meta-analysis
where <code class="reqn">p* = p(p+1)/2 </code>. It is arranged by column
major as used by <code>vech</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A predictor or a <code class="reqn">k</code> x <code class="reqn">m</code> matrix of predictors
where <code class="reqn">m</code> is the number of predictors.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>An optional data frame containing the variables in the model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RE.constraints</code></td>
<td>
<p>A <code class="reqn">p</code> x <code class="reqn">p</code> matrix
specifying the variance components of the random effects. If the input
is not a matrix, it is converted into a matrix by
<code>as.matrix()</code>. The default is that all
covariance/variance components are free. The format of this matrix
follows <code>as.mxMatrix</code>. Elements of the variance
components can be constrained equally by using the same labels. If a zero matrix is
specified, it becomes a fixed-effects meta-analysis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RE.startvalues</code></td>
<td>
<p>A vector of <code class="reqn">p</code> starting values on the
diagonals of the variance component of the random effects. If only one
scalar is given, it will be repeated across the diagonals. Starting values for the
off-diagonals of the variance component are all 0. A <code class="reqn">p</code> x
<code class="reqn">p</code> symmetric matrix of starting values is also accepted. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RE.lbound</code></td>
<td>
<p>A vector of <code class="reqn">p</code> lower bounds on the
diagonals of the variance component of the random effects. If only one
scalar is given, it will be repeated across the diagonals. Lower
bounds for the off-diagonals of the variance component are set at <code>NA</code>. A <code class="reqn">p</code> x
<code class="reqn">p</code> symmetric matrix of the lower bounds is also accepted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intervals.type</code></td>
<td>
<p>Either <code>z</code> (default if missing) or
<code>LB</code>. If it is <code>z</code>, it calculates the 95% Wald confidence
intervals (CIs) based on the z statistic. If it is <code>LB</code>, it
calculates the 95% likelihood-based CIs on the
parameter estimates. Note that the z values and their
associated p values are based on the z statistic. They are not
related to the likelihood-based CIs.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.name</code></td>
<td>
<p>A string for the model name in <code>mxModel</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>suppressWarnings</code></td>
<td>
<p>Logical. If <code>TRUE</code>, warnings are
suppressed. It is passed to <code>mxRun</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>Logical. An argument to be passed to <code>mxRun</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>run</code></td>
<td>
<p>Logical. If <code>FALSE</code>, only return the mx model without running the analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to <code>mxRun</code>
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Restricted (residual) maximum likelihood obtains the parameter estimates on the transformed data that do not include the fixed-effects parameters. A transformation matrix <code class="reqn">M=I-X(X'X)^{-1}X</code> is created based on the design matrix <code class="reqn">X</code> which is just a column vector when there is no predictor in <code>x</code>. The last <code class="reqn">N</code> redundant rows of <code class="reqn">M</code> is removed where <code class="reqn">N</code> is the rank of <code class="reqn">X</code>. After pre-multiplying by <code class="reqn">M</code> on <code>y</code>, the parameters of fixed-effects are removed from the model. Thus, only the parameters of random-effects are estimated.
</p>
<p>An alternative but equivalent approach is to minimize the
-2*log-likelihood function: </p>
<p style="text-align: center;"><code class="reqn">
	\log(\det|V+T^2|)+\log(\det|X'(V+T^2)^{-1}X|)+(y-X\hat{\alpha})'(V+T^2)^{-1}(y-X\hat{\alpha})</code>
</p>

<p>where <code class="reqn">V</code> is the known conditional sampling covariance matrix
of <code class="reqn">y</code>, <code class="reqn">T^2</code> is the variance component of the random
effects, and <code class="reqn">\hat{\alpha}=(X'(V+T^2)^{-1}X)^{-1}
  X'(V+T^2)^{-1}y</code>. <code>reml()</code>
minimizes the above likelihood function to obtain the parameter estimates.
</p>


<h3>Value</h3>

<p>An object of class <code>reml</code> with a list of
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>Object returned by <code>match.call</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data matrix of y, v and x  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no.y</code></td>
<td>
<p>No. of effect sizes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no.x</code></td>
<td>
<p>No. of predictors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>miss.vec</code></td>
<td>
<p>A vector indicating missing data. Studies will be removed before the analysis if they are <code>TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mx.fit</code></td>
<td>
<p>A fitted object returned from	<code>mxRun</code></p>
</td>
</tr>
</table>
<h3>Note</h3>

 <p><code>reml</code> is more computationally intensive than <code>meta</code>. Moreover, <code>reml</code> is more
likely to encounter errors during optimization. Since
a likelihood function is directly employed to obtain the parameter
estimates, there is no number of studies and number of observed statistics
returned by <code>mxRun</code>. Ad-hoc steps are used
to modify <code>mx.fit@runstate$objectives[[1]]@numObs</code> and <code>mx.fit@runstate$objectives[[1]]@numStats</code>.
</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;

</p>


<h3>References</h3>

<p>Cheung, M. W.-L. (2013). Implementing restricted maximum likelihood
estimation in structural equation models. <em>Structural Equation
Modeling</em>, <b>20(1)</b>, 157-167.
</p>
<p>Mehta, P. D., &amp; Neale, M. C. (2005). People Are Variables Too: Multilevel Structural Equations Modeling. <em>Psychological
Methods</em>, <b>10(3)</b>, 259-284.
</p>
<p>Searle, S. R., Casella, G., &amp; McCulloch, C. E. (1992). <em>Variance components</em>. New York: Wiley.
</p>
<p>Viechtbauer, W. (2005). Bias and efficiency of meta-analytic variance estimators in the random-effects model. <em>Journal of Educational and Behavioral Statistics</em>, <b>30(3)</b>, 261-293.  
</p>


<h3>See Also</h3>

 <p><code>meta</code>, <code>reml3</code>, <code>Hox02</code>, <code>Berkey98</code>

</p>


</div>