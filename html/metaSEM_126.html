<div class="container">

<table style="width: 100%;"><tr>
<td>reml3L</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate Variance Components in Three-Level Univariate
Meta-Analysis with Restricted (Residual) Maximum
Likelihood Estimation
</h2>

<h3>Description</h3>

<p>It estimates the variance components of random-effects in three-level
univariate meta-analysis with restricted (residual) maximum likelihood (REML) estimation method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## Depreciated in the future
reml3(y, v, cluster, x, data, RE2.startvalue=0.1, RE2.lbound=1e-10,
      RE3.startvalue=RE2.startvalue, RE3.lbound=RE2.lbound, RE.equal=FALSE,
      intervals.type=c("z", "LB"), model.name="Variance component with REML",
      suppressWarnings=TRUE, silent=TRUE, run=TRUE, ...)
reml3L(y, v, cluster, x, data, RE2.startvalue=0.1, RE2.lbound=1e-10,
      RE3.startvalue=RE2.startvalue, RE3.lbound=RE2.lbound, RE.equal=FALSE,
      intervals.type=c("z", "LB"), model.name="Variance component with REML",
      suppressWarnings=TRUE, silent=TRUE, run=TRUE, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A vector of <code class="reqn">k</code> studies of effect size. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>A vector of <code class="reqn">k</code> studies of sampling variance.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>A vector of <code class="reqn">k</code> characters or numbers indicating the
clusters. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A predictor or a <code class="reqn">k</code> x <code class="reqn">m</code> matrix of level-2
and level-3 predictors where <code class="reqn">m</code> is the number of predictors. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>An optional data frame containing the variables in the model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RE2.startvalue</code></td>
<td>
<p>Starting value for the level-2 variance.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RE2.lbound</code></td>
<td>
<p>Lower bound for the level-2 variance.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RE3.startvalue</code></td>
<td>
<p>Starting value for the level-3 variance.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RE3.lbound</code></td>
<td>
<p>Lower bound for the level-3 variance.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RE.equal</code></td>
<td>
<p>Logical. Whether the variance components at level-2
and level-3 are constrained equally.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intervals.type</code></td>
<td>
<p>Either <code>z</code> (default if missing) or
<code>LB</code>. If it is <code>z</code>, it calculates the 95% Wald confidence
intervals (CIs) based on the z statistic. If it is <code>LB</code>, it
calculates the 95% likelihood-based CIs on the
parameter estimates. Note that the z values and their
associated p values are based on the z statistic. They are not
related to the likelihood-based CIs.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.name</code></td>
<td>
<p>A string for the model name in <code>mxModel</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>suppressWarnings</code></td>
<td>
<p>Logical. If <code>TRUE</code>, warnings are
suppressed. It is passed to <code>mxRun</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>Logical. Argument to be passed to <code>mxRun</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>run</code></td>
<td>
<p>Logical. If <code>FALSE</code>, only return the mx model without running the analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to <code>mxRun</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Restricted (residual) maximum likelihood obtains the parameter estimates on the transformed data that do not include the fixed-effects parameters. A transformation matrix <code class="reqn">M=I-X(X'X)^{-1}X</code> is created based on the design matrix <code class="reqn">X</code> which is just a column vector when there is no predictor in <code>x</code>. The last <code class="reqn">N</code> redundant rows of <code class="reqn">M</code> is removed where <code class="reqn">N</code> is the rank of <code class="reqn">X</code>. After pre-multiplying by <code class="reqn">M</code> on <code>y</code>, the parameters of fixed-effects are removed from the model. Thus, only the parameters of random-effects are estimated.
</p>
<p>An alternative but the equivalent approach is to minimize the
-2*log-likelihood function: </p>
<p style="text-align: center;"><code class="reqn">
	\log(\det|V+T^2|)+\log(\det|X'(V+T^2)^{-1}X|)+(y-X\hat{\alpha})'(V+T^2)^{-1}(y-X\hat{\alpha})</code>
</p>

<p>where <code class="reqn">V</code> is the known conditional sampling covariance matrix
of <code class="reqn">y</code>, <code class="reqn">T^2</code> is the variance component combining
level-2 and level-3 random effects, and <code class="reqn">\hat{\alpha}=(X'(V+T^2)^{-1}X)^{-1}
  X'(V+T^2)^{-1}y</code>. <code>reml()</code>
minimizes the above likelihood function to obtain the parameter estimates.
</p>


<h3>Value</h3>

<p>An object of class <code>reml</code> with a list of
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>Object returned by <code>match.call</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data matrix of y, v, and x  </p>
</td>
</tr>
</table>
<table><tr style="vertical-align: top;">
<td><code>mx.fit</code></td>
<td>
<p>A fitted object returned from	<code>mxRun</code></p>
</td>
</tr></table>
<h3>Note</h3>

 <p><code>reml</code> is more computationally intensive than <code>meta</code>. Moreover, <code>reml</code> is more
likely to encounter errors during optimization. Since
a likelihood function is directly employed to obtain the parameter
estimates, there is no number of studies and number of observed statistics
returned by <code>mxRun</code>. Ad-hoc steps are used
to modify <code>mx.fit@runstate$objectives[[1]]@numObs</code> and <code>mx.fit@runstate$objectives[[1]]@numStats</code>.
</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;

</p>


<h3>References</h3>

<p>Cheung, M. W.-L. (2013). Implementing restricted maximum likelihood estimation in structural equation models. <em>Structural Equation Modeling</em>, <b>20(1)</b>, 157-167.
</p>
<p>Cheung, M. W.-L. (2014). Modeling dependent effect sizes with three-level meta-analyses: A structural equation modeling approach. <em>Psychological Methods</em>, <b>19</b>, 211-229.
</p>
<p>Mehta, P. D., &amp; Neale, M. C. (2005). People Are Variables Too: Multilevel Structural Equations Modeling. <em>Psychological
Methods</em>, <b>10(3)</b>, 259-284.
</p>
<p>Searle, S. R., Casella, G., &amp; McCulloch, C. E. (1992). <em>Variance components</em>. New York: Wiley.
</p>


<h3>See Also</h3>

 <p><code>meta3L</code>, <code>reml</code>, <code>Cooper03</code>, <code>Bornmann07</code>

</p>


</div>