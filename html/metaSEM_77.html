<div class="container">

<table style="width: 100%;"><tr>
<td>meta3L</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Three-Level Univariate Meta-Analysis with Maximum Likelihood Estimation
</h2>

<h3>Description</h3>

<p>It conducts three-level univariate meta-analysis with maximum
likelihood estimation method. Mixed-effects meta-analysis can be conducted by
including study characteristics as predictors. Equality constraints on
the intercepts, regression coefficients and variance components on the level-2
and on the level-3 can be easily imposed by setting the same labels on the parameter estimates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## Depreciated in the future
meta3(y, v, cluster, x, data, intercept.constraints = NULL,
      coef.constraints = NULL , RE2.constraints = NULL,
      RE2.lbound = 1e-10, RE3.constraints = NULL, RE3.lbound = 1e-10,
      intervals.type = c("z", "LB"), I2="I2q",
      R2=TRUE, model.name = "Meta analysis with ML",
      suppressWarnings = TRUE, silent = TRUE, run = TRUE, ...)
## Depreciated in the future
meta3X(y, v, cluster, x2, x3, av2, av3, data, intercept.constraints=NULL,
       coef.constraints=NULL, RE2.constraints=NULL, RE2.lbound=1e-10,
       RE3.constraints=NULL, RE3.lbound=1e-10, intervals.type=c("z", "LB"),
       R2=TRUE, model.name="Meta analysis with ML",
       suppressWarnings=TRUE, silent = TRUE, run = TRUE, ...)
meta3L(y, v, cluster, x, data, intercept.constraints = NULL,
      coef.constraints = NULL , RE2.constraints = NULL,
      RE2.lbound = 1e-10, RE3.constraints = NULL, RE3.lbound = 1e-10,
      intervals.type = c("z", "LB"), I2="I2q",
      R2=TRUE, model.name = "Meta analysis with ML",
      suppressWarnings = TRUE, silent = TRUE, run = TRUE, ...)
meta3LFIML(y, v, cluster, x2, x3, av2, av3, data, intercept.constraints=NULL,
       coef.constraints=NULL, RE2.constraints=NULL, RE2.lbound=1e-10,
       RE3.constraints=NULL, RE3.lbound=1e-10, intervals.type=c("z", "LB"),
       R2=TRUE, model.name="Meta analysis with ML",
       suppressWarnings=TRUE, silent = TRUE, run = TRUE, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A vector of <code class="reqn">k</code> studies of effect size. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>A vector of <code class="reqn">k</code> studies of sampling variance.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>A vector of <code class="reqn">k</code> string or number indicating the
clusters. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A predictor or a <code class="reqn">k</code> x <code class="reqn">m</code> matrix of level-2
and level-3 predictors where <code class="reqn">m</code> is the number of predictors. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x2</code></td>
<td>
<p>A predictor or a <code class="reqn">k</code> x <code class="reqn">m</code> matrix of level-2
predictors where <code class="reqn">m</code> is the number of predictors. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x3</code></td>
<td>
<p>A predictor or a <code class="reqn">k</code> x <code class="reqn">m</code> matrix of level-3
predictors where <code class="reqn">m</code> is the number of predictors. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>av2</code></td>
<td>
<p>A predictor or a <code class="reqn">k</code> x <code class="reqn">m</code> matrix of level-2
auxiliary variables where <code class="reqn">m</code> is the number of variables. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>av3</code></td>
<td>
<p>A predictor or a <code class="reqn">k</code> x <code class="reqn">m</code> matrix of level-3
auxiliary variables where <code class="reqn">m</code> is the number of variables. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>An optional data frame containing the variables in the model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept.constraints</code></td>
<td>
<p>A <code class="reqn">1</code> x <code class="reqn">1</code> matrix
specifying whether the intercept of the effect size is fixed or
constrained. The format of this matrix follows
<code>as.mxMatrix</code>. The intercept can be
constrained with other parameters by using the same label.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef.constraints</code></td>
<td>
<p>A <code class="reqn">1</code> x <code class="reqn">m</code> matrix
specifying how the level-2 and level-3 predictors predict the effect sizes. If the input
is not a matrix, it is converted into a matrix by
<code>as.matrix()</code>. The default
is that all <code class="reqn">m</code> predictors predict the effect size. The
format of this matrix follows
<code>as.mxMatrix</code>. The regression coefficients can be
constrained equally by using the same labels.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RE2.constraints</code></td>
<td>
<p>A scalar or a <code class="reqn">1</code> x <code class="reqn">1</code> matrix
specifying the variance components of the random effects. The default
is that the variance components are free. The format of this matrix
follows <code>as.mxMatrix</code>. Elements of the variance
components can be constrained equally by using the same label. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RE2.lbound</code></td>
<td>
<p>A scalar or a <code class="reqn">1</code> x <code class="reqn">1</code> matrix of lower bound on the level-2 variance component of the random effects. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RE3.constraints</code></td>
<td>
<p>A scalar of a <code class="reqn">1</code> x <code class="reqn">1</code> matrix
specifying the variance components of the random effects at
level-3. The default is that the variance components are free. The format of this matrix
follows <code>as.mxMatrix</code>. Elements of the variance
components can be constrained equally by using the same label. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RE3.lbound</code></td>
<td>
<p>A scalar or a <code class="reqn">1</code> x <code class="reqn">1</code> matrix of lower bound on the level-3 variance component of the random effects. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intervals.type</code></td>
<td>
<p>Either <code>z</code> (default if missing) or
<code>LB</code>. If it is <code>z</code>, it calculates the 95% Wald confidence
intervals (CIs) based on the z statistic. If it is <code>LB</code>, it
calculates the 95% likelihood-based CIs on the
parameter estimates. Note that the z values and their
associated p values are based on the z statistic. They are not
related to the likelihood-based CIs.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>I2</code></td>
<td>
<p>Possible options are <code>"I2q"</code>, <code>"I2hm"</code>,
<code>"I2am"</code> and <code>"ICC"</code>. They represent the <code>I2</code> calculated by using a
typical within-study sampling variance from the Q statistic, the
harmonic mean, the arithmetic mean of the within-study sampling
variances, and the intra-class correlation. More than one options are possible. If <code>intervals.type="LB"</code>, 95% confidence intervals on the heterogeneity indices will be constructed. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R2</code></td>
<td>
<p>Logical. If <code>TRUE</code> and there are predictors, R2 is
calculated. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.name</code></td>
<td>
<p>A string for the model name in <code>mxModel</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>suppressWarnings</code></td>
<td>
<p>Logical. If <code>TRUE</code>, warnings are
suppressed. It is passed to <code>mxRun</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>Logical. An argument to be passed to <code>mxRun</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>run</code></td>
<td>
<p>Logical. If <code>FALSE</code>, only return the mx model without running the analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to
<code>mxRun</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p style="text-align: center;"><code class="reqn">y_{ij} = \beta_0 + \mathbf{\beta'}*\mathbf{x}_{ij} + u_{(2)ij} + u_{(3)j} + e_{ij}
  </code>
</p>
<p> where <code class="reqn">y_{ij}</code> is the effect size for the ith study in the jth cluster,
<code class="reqn">\beta_0</code> is the intercept, <code class="reqn">\mathbf{\beta}</code> is the
regression coefficients, <code class="reqn">\mathbf{x}_{ij}</code> is a vector of predictors, <code class="reqn">u_{(2)ij} \sim N(0, \tau^2_2)</code> and <code class="reqn">u_{(3)j} \sim N(0, \tau^2_3)</code> are the level-2 and level-3 heterogeneity variances,
respectively, and <code class="reqn">e_{ij} \sim N(0, v_{ij})</code> is the conditional known sampling variance.
</p>
<p><code>meta3L()</code> does not differentiate between level-2 or level-3
variables in <code>x</code> since both variables are treated as a design
matrix. When there are missing values in <code>x</code>, the data will be
deleted. <code>meta3LFIML()</code> treats the predictors <code>x2</code> and <code>x3</code>
as level-2 and level-3 variables. Thus, their means and covariance
matrix will be estimated. Missing values in <code>x2</code> and <code>x3</code>
will be handled by (full information) maximum likelihood (FIML) in <code>meta3LFIML()</code>. Moreover,
auxiliary variables <code>av2</code> at level-2 and <code>av3</code> at level-3 may
be included to improve the estimation. Although <code>meta3LFIML()</code> is more
flexible in handling missing covariates, it is more likely to encounter
estimation problems. 	
</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;

</p>


<h3>References</h3>

<p>Cheung, M. W.-L. (2014). Modeling dependent effect sizes with three-level meta-analyses: A structural equation modeling approach. <em>Psychological Methods</em>, <b>19</b>, 211-229.
</p>
<p>Enders, C. K. (2010). <em>Applied missing data analysis</em>. New York: Guilford Press.
</p>
<p>Graham, J. (2003). Adding missing-data-relevant variables to
FIML-based structural equation models. <em>Structural Equation
Modeling: A Multidisciplinary Journal</em>, <b>10(1)</b>, 80-100.
</p>
<p>Konstantopoulos, S. (2011). Fixed effects and variance components
estimation in three-level meta-analysis. <em>Research Synthesis
Methods</em>, <b>2</b>, 61-76.
</p>


<h3>See Also</h3>

<p><code>reml3L</code>, <code>Cooper03</code>, <code>Bornmann07</code>
</p>


</div>