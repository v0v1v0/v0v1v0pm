<div class="container">

<table style="width: 100%;"><tr>
<td>metabup</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian meta-analysis using basic uncertain pooling.</h2>

<h3>Description</h3>

<p>Bayesian meta-analysis analysis  (1) with binomial data, counts(y) and total counts (n) or, (2) with user-supplied estimates and associated variances.  Case (1) provides an analysis based on the logit transformation of the sample proportion. This methodology is also appropriate for combining data from sample surveys and related sources.
</p>


<h3>Usage</h3>

<pre><code class="language-R">metabup(y, nv, type = NULL, d2max = NULL, ngrid2 = NULL, N = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>vector of counts or effect estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nv</code></td>
<td>
<p>vector of total counts n (if y's are counts) or variances associated with the estimates(if y's are estimates).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>assumes a single value: 1 (counts and total counts as inputs) or 2 (estimates and variances as inputs). Default is type 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d2max</code></td>
<td>
<p>maximum value of the prior variance delta^2  to be used in the grid sampling. Default is .Machine$double.xmin.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ngrid2</code></td>
<td>
<p>number of grid points for the prior variance. Default is 1000 if d2max &gt; .Machine$double.xmin.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>sample size to be drawn from the partition-delta^2 grid. Default is 1000.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>list consisting of the sample and posterior effect estimates and standard deviations, the partitions with the largest posterior probabilities, and the similarity matrix.
</p>


<h3>References</h3>

<p>Cahoy and Sedransk (2023). <em>Combining data from surveys and related sources.</em>  Surv. Methodol., To appear.
</p>
<p>Cahoy and Sedransk (2022). <em>Bayesian inference for asymptomatic COVID-19 infection rates.</em>  Stat Med, 41(16):3131-3148,
&lt;doi:10.1002/sim.9408&gt;
</p>
<p>Evans and Sedransk (2001). <em>Combining data from experiments that may be similar.</em> Biometrika, 88(3):643-656,
&lt;doi:10.1093/biomet/88.3.643&gt;
</p>
<p>Malec and Sedransk (1992). <em>Bayesian methodology for combining the results from different experiments when the specifications for pooling are uncertain</em>. Biometrika, 79(3):593-601,
&lt;doi:10.1093/biomet/79.3.593&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">

y=c(4, 18, 40, 130)
nv=c(13, 83, 60,166)
require(partitions)
out=metabup(y, nv, type=1)

#estimates
out[1]
#the partitions with the largest posterior p(g|y)
out[2:3]

#plotting similarity matrix
require(ggplot2)
L=length(y)
indmat=matrix(unlist(out[4]),ncol=L, byrow=FALSE)
psingle&lt;-rep(0,L)
sim_mat&lt;-indmat +t(indmat)
diag(sim_mat)&lt;-psingle #rep(1,L)
xy=expand.grid(x=1:L, y=1:L)
index=as.vector( sim_mat)
mat_data =  cbind(xy,index)
brlab&lt;-round(seq(0, max(sim_mat)+0.05, length.out=4),2)
p &lt;- ggplot(data = mat_data) +                        # Set data
geom_tile(aes(x = x, y = y, fill =index)) +
scale_fill_gradientn(colours=rev(heat.colors(5)),na.value = "transparent",
                      breaks=brlab,labels=brlab,
                      limits=c(0,max(sim_mat)+0.075))+
scale_x_continuous(name="Study Number", breaks=1:L,   limits=c(0.5,+L+0.5)) +
scale_y_continuous(name="", breaks=1:L,  limits=c(0.5,L+0.5))
p + theme(axis.title  = element_text() )



ph=c(31, 21.7, 66.7,78.3)/100
y=log(ph/(1-ph))
n=c(13, 83, 60,166)
nv=1/(ph*(1-ph)*n)  #variance
require(partitions)
out=metabup(y, nv)

#estimates
out[1]
#the partitions with the largest posterior p(g|y)
out[2:3]

#plotting similarity matrix
require(ggplot2)
L=length(y)
indmat=matrix(unlist(out[4]),ncol=L, byrow=FALSE)
psingle&lt;-rep(0,L)
sim_mat&lt;-indmat +t(indmat)
diag(sim_mat)&lt;-psingle #rep(1,L)
xy=expand.grid(x=1:L, y=1:L)
index=as.vector( sim_mat)
mat_data =  cbind(xy,index)
brlab&lt;-round(seq(0, max(sim_mat)+0.05, length.out=4),2)
p &lt;- ggplot(data = mat_data) +                        # Set data
geom_tile(aes(x = x, y = y, fill =index)) +
scale_fill_gradientn(colours=rev(heat.colors(5)),na.value = "transparent",
                      breaks=brlab,labels=brlab,
                      limits=c(0,max(sim_mat)+0.075))+
scale_x_continuous(name="Study Number", breaks=1:L,   limits=c(0.5,+L+0.5)) +
scale_y_continuous(name="", breaks=1:L,  limits=c(0.5,L+0.5))
p + theme(axis.title  = element_text() )



</code></pre>


</div>