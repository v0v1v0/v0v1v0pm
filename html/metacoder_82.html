<div class="container">

<table style="width: 100%;"><tr>
<td>heat_tree_matrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot a matrix of heat trees</h2>

<h3>Description</h3>

<p>Plot a matrix of heat trees for showing pairwise comparisons. A larger,
labelled tree serves as a key for the matrix of smaller unlabelled trees. The
data for this function is typically created with <code>compare_groups</code>,
</p>


<h3>Usage</h3>

<pre><code class="language-R">heat_tree_matrix(
  obj,
  data,
  label_small_trees = FALSE,
  key_size = 0.6,
  seed = 1,
  output_file = NULL,
  row_label_color = diverging_palette()[3],
  col_label_color = diverging_palette()[1],
  row_label_size = 12,
  col_label_size = 12,
  ...,
  dataset = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>A <code>taxmap</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The name of a table in <code>obj$data</code> that is the output of 
<code>compare_groups</code> or in the same format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label_small_trees</code></td>
<td>
<p>If <code>TRUE</code> add labels to small trees as well as 
the key tree. Otherwise, only the key tree will be labeled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>key_size</code></td>
<td>
<p>The size of the key tree relative to the whole graph. For
example, 0.5 means half the width/height of the graph.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>That random seed used to make the graphs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output_file</code></td>
<td>
<p>The path to one or more files to save the plot in using <code>ggsave</code>. 
The type of the file will be determined by the extension given.
Default: Do not save plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row_label_color</code></td>
<td>
<p>The color of the row labels on the right side of the matrix. Default:
based on the node_color_range.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_label_color</code></td>
<td>
<p>The color of the columns labels along the top of the matrix. Default:
based on the node_color_range.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row_label_size</code></td>
<td>
<p>The size of the row labels on the right side of the matrix. Default: 12.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_label_size</code></td>
<td>
<p>The size of the columns labels along the top of the matrix. Default: 12.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Passed to <code>heat_tree</code>. Some options will be overwritten.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataset</code></td>
<td>
<p>DEPRECIATED. use "data" instead.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Parse dataset for plotting
x &lt;- parse_tax_data(hmp_otus, class_cols = "lineage", class_sep = ";",
                    class_key = c(tax_rank = "taxon_rank", tax_name = "taxon_name"),
                    class_regex = "^(.+)__(.+)$")

# Convert counts to proportions
x$data$otu_table &lt;- calc_obs_props(x, data = "tax_data", cols = hmp_samples$sample_id)

# Get per-taxon counts
x$data$tax_table &lt;- calc_taxon_abund(x, data = "otu_table", cols = hmp_samples$sample_id)

# Calculate difference between treatments
x$data$diff_table &lt;- compare_groups(x, data = "tax_table",
                                    cols = hmp_samples$sample_id,
                                    groups = hmp_samples$body_site)

# Plot results (might take a few minutes)
heat_tree_matrix(x,
                 data = "diff_table",
                 node_size = n_obs,
                 node_label = taxon_names,
                 node_color = log2_median_ratio,
                 node_color_range = diverging_palette(),
                 node_color_trans = "linear",
                 node_color_interval = c(-3, 3),
                 edge_color_interval = c(-3, 3),
                 node_size_axis_label = "Number of OTUs",
                 node_color_axis_label = "Log2 ratio median proportions")


## End(Not run)

</code></pre>


</div>