<div class="container">

<table style="width: 100%;"><tr>
<td>BuildHeatmap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>BuildHeatmap</h2>

<h3>Description</h3>

<p>BuildHeatmap summarizes MetaDeconfound output in a heatmap or cuneiform plot
</p>


<h3>Usage</h3>

<pre><code class="language-R">BuildHeatmap(
  metaDeconfOutput,
  q_cutoff = 0.1,
  d_cutoff = 0.01,
  cuneiform = FALSE,
  coloring = 0,
  showConfounded = TRUE,
  intermedData = FALSE,
  featureNames = NULL,
  metaVariableNames = NULL,
  d_range = "fit",
  d_col = c("blue", "white", "red"),
  keepMeta = NULL,
  keepFeature = NULL,
  trusted = c("OK_sd", "OK_nc", "OK_d", "AD"),
  tileBordCol = "black",
  reOrder = "both"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>metaDeconfOutput</code></td>
<td>
<p>output of a metadeconfound run</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q_cutoff</code></td>
<td>
<p>optional FDR-value cutoff used to remove
low-significance entries from data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d_cutoff</code></td>
<td>
<p>optional effect size cutoff used to remove
low effect size entries from data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cuneiform</code></td>
<td>
<p>optional logical parameter,
plot cuneiform instead of heatmap when cuneiform = TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coloring</code></td>
<td>
<p>optional, can be 0,1,2;
0: color all tiles according to effectsize ;
1: don't color not significant tiles
2: like 1 but also don't color confounded signal tiles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showConfounded</code></td>
<td>
<p>optional logical parameter;
set to FALSE to remove significance markers from confounded signals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intermedData</code></td>
<td>
<p>only return intermediate data for plotting, default = FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>featureNames</code></td>
<td>
<p>optional two-column-dataframe containing corresponding
"human-readable" names to the "machine-readable" feature names used as
row.names in metaDeconfOutput. These human readable
names will be displayed in the final plot. First column: machine-readable,
second column: human-readable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metaVariableNames</code></td>
<td>
<p>optional two-column-dataframe containing
corresponding  "human-readable" names to the "machine-readable" metadata
names used as column names in metaDeconfOutput. These human readable
names will be displayed in the final plot. First column: machine-readable,
second column: human-readable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d_range</code></td>
<td>
<p>range of effect sizes shown; "full": (default) range from
-1 to +1;
"fit": range reduced according to maximum and minimum effect size
present in resulting plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d_col</code></td>
<td>
<p>set color range for effect size as c(minimum, middle, maximum),
default c("red", "white", "blue")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keepMeta</code></td>
<td>
<p>character vector of metavariable names
(corresponding to names in metaDeconfOutput), that should be shown in
resulting plot, even when they have no associations
passing d_cutoff and q_cutoff</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keepFeature</code></td>
<td>
<p>character vector of metavariable names
(corresponding to names in metaDeconfOutput), that should be shown in
resulting plot, even when they have no associations
passing d_cutoff and q_cutoff</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trusted</code></td>
<td>
<p>character vector of confounding status labels to be treated
as trustworthy, not-confounded signal. default = c("OK_sd", "OK_nc", "OK_d", "AD")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tileBordCol</code></td>
<td>
<p>tile border color of  heatmap tiles, default: "black"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reOrder</code></td>
<td>
<p>reorder features and/or metadata? possible options: c("both", "feat", "meta", "none"), default: "both"</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>for more details and explanations please see the package vignette.
</p>


<h3>Value</h3>

<p>ggplot2 object
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(reduced_feature)
data(metaMatMetformin)

example_output &lt;- MetaDeconfound(featureMat = reduced_feature,
                                  metaMat = metaMatMetformin,
                                  logLevel = "ERROR")

plotObject &lt;- BuildHeatmap(example_output)

alternativePlot &lt;- BuildHeatmap(example_output, coloring = 2, showConfounded = FALSE)


</code></pre>


</div>