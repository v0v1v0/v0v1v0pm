<div class="container">

<table style="width: 100%;"><tr>
<td>run_cons_plans</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Run conservation plans and return the portfolio mean and variance values</h2>

<h3>Description</h3>

<p>This function takes a set of weights representing different conservation
plans and gets the mean and variance in portfolio space. This function allows
a maximally complicated set of weights to accommodate all possible scenarios.
It can accommodate different spatial strategies of conservation, conserving
different numbers of populations, and a lack of knowledge. You can do this by
how you set your <code>w</code> weight object. See the example.
</p>


<h3>Usage</h3>

<pre><code class="language-R">run_cons_plans(
  w,
  env_type,
  env_params,
  show_progress = TRUE,
  burn = 1:30,
  assess_freq = 5,
  risk_fn = var,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>A (nested) list of weights. The first list level contains the
different plans. The next level contains repetitions for a given plan.
E.g. <code>cp[[2]][[1]]</code> contains the first iteration of the second
conservation plan. Each end element should be a matrix of weights with one
row and the number of columns equal to the number of subpopulations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>env_type</code></td>
<td>
<p>The environmental type to pass to
<code>generate_env_ts</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>env_params</code></td>
<td>
<p>The environmental parameters to pass to
<code>generate_env_ts</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_progress</code></td>
<td>
<p>Logical: show an indication of progress?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn</code></td>
<td>
<p>Cycles to throw out as burn in</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>assess_freq</code></td>
<td>
<p>How frequently (in years) to re-assess the Ricker a and b
values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>risk_fn</code></td>
<td>
<p>A risk function to use. Can be any function that takes a
numeric vector and returns a single value. Suggested values include
<code>var</code>, or <code>VaR</code>, or <code>CVaR</code>. Defaults to
variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other values to pass to <code>meta_sim</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with two high-level elements: the mean variance output
(<code>plans_mv</code>) and the raw simulation output (<code>plans_port</code>).
Within <code>plans_mv</code>, each element of the list contains a conservation
plan. Each row of the data frames represents a trial run. Within
<code>plans_port</code>, each first level of the list contains a weight element
and each second level of the list contains a replicate.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
set.seed(1)
w_plans &lt;- list()
w_plans[[1]] &lt;- c(5, 1000, 5, 1000, 5, 5, 1000, 5, 1000, 5)
w_plans[[2]] &lt;- c(5, 5, 5, 1000, 1000, 1000, 1000, 5, 5, 5)
w_plans[[3]] &lt;- c(rep(1000, 4), rep(5, 6))
w_plans[[4]] &lt;- rev(w_plans[[3]])
plans_name_sp &lt;- c("Full range of responses", "Most stable only",
"Lower half", "Upper half")
 n_trials &lt;- 50 # number of trials at each n conservation plan
 n_plans &lt;- 4 # number of plans
 num_pops &lt;- c(2, 4, 8, 16) # n pops to conserve
 w &lt;- list()
 for(i in 1:n_plans) { # loop over number conserved
  w[[i]] &lt;- list()
  for(j in 1:n_trials) { # loop over trials
    w[[i]][[j]] &lt;- matrix(rep(625, 16), nrow = 1)
    w[[i]][[j]][-sample(1:16, num_pops[i])] &lt;- 5
  }
 }
arma_env_params &lt;- list(mean_value = 16, ar = 0.1, sigma_env = 2, ma = 0)

x_arma_sp &lt;- run_cons_plans(w, env_type = "arma", env_params = arma_env_params)

plot_cons_plans(x_arma_sp$plans_mv, plans_name = plans_name_sp, cols =
  cols, add_all_efs = FALSE, xlim = c(0.02, 0.15), ylim = c(-0.017,
    0.017), add_legend = FALSE)

# In this version, the pops are wiped out; total abundance changes
n_trials &lt;- 50 # number of trials at each n conservation plan
num_pops &lt;- c(2, 4, 8, 16) # n pops to conserve
n_plans &lt;- length(num_pops) # number of plans
w &lt;- list()
for(i in 1:n_plans) { # loop over number conserved
 w[[i]] &lt;- list()
 for(j in 1:n_trials) { # loop over trials
   w[[i]][[j]] &lt;- matrix(rep(1000, 16), nrow = 1)
   w[[i]][[j]][-sample(1:16, num_pops[i])] &lt;- 5
 }
}
plans_name_n &lt;- paste(num_pops, "populations")
arma_env_params &lt;- list(mean_value = 16, ar = 0.1, sigma_env = 2, ma = 0)

x_arma_n &lt;- run_cons_plans(w, env_type = "arma", env_params =
  arma_env_params, max_a = thermal_integration(16))

plot_cons_plans(x_arma_n$plans_mv, plans_name = plans_name_n, cols =
  cols, add_all_efs = FALSE, xlim = c(0.02, 0.15), ylim = c(-0.017,
    0.017), add_legend = FALSE)

## End(Not run)
</code></pre>


</div>