<div class="container">

<table style="width: 100%;"><tr>
<td>conv.2x2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Reconstruct Cell Frequencies of \(2 \times 2\) Tables</h2>

<h3>Description</h3>

<p>Function to reconstruct the cell frequencies of \(2 \times 2\) tables based on other summary statistics. <script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></p>


<h3>Usage</h3>

<pre><code class="language-R">conv.2x2(ori, ri, x2i, ni, n1i, n2i, correct=TRUE, data, include,
         var.names=c("ai","bi","ci","di"), append=TRUE, replace="ifna")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ori</code></td>
<td>
<p>optional vector with the odds ratios corresponding to the tables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ri</code></td>
<td>
<p>optional vector with the phi coefficients corresponding to the tables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x2i</code></td>
<td>
<p>optional vector with the (signed) chi-square statistics corresponding to the tables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ni</code></td>
<td>
<p>vector with the total sample sizes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n1i</code></td>
<td>
<p>vector with the marginal counts for the outcome of interest on the first variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n2i</code></td>
<td>
<p>vector with the marginal counts for the outcome of interest on the second variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correct</code></td>
<td>
<p>optional logical (or vector thereof) to indicate whether chi-square statistics were computed using Yates's correction for continuity (the default is <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>optional data frame containing the variables given to the arguments above.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include</code></td>
<td>
<p>optional (logical or numeric) vector to specify the subset of studies for which the cell frequencies should be reconstructed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.names</code></td>
<td>
<p>character vector with four elements to specify the names of the variables for the reconstructed cell frequencies (the default is <code>c("ai","bi","ci","di")</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>append</code></td>
<td>
<p>logical to specify whether the data frame provided via the <code>data</code> argument should be returned together with the reconstructed values (the default is <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replace</code></td>
<td>
<p>character string or logical to specify how values in <code>var.names</code> should be replaced (only relevant when using the <code>data</code> argument and if variables in <code>var.names</code> already exist in the data frame). See the ‘Value’ section for more details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For meta-analyses based on \(2 \times 2\) table data, the problem often arises that some studies do not directly report the cell frequencies. The present function allows the reconstruction of such tables based on other summary statistics.
</p>
<p>In particular, assume that the data of interest for a particular study are of the form:
</p>

<table>
<tr>
<td style="text-align: left;">
                         </td>
<td style="text-align: center;">   </td>
<td style="text-align: center;"> variable 2, outcome + </td>
<td style="text-align: center;">   </td>
<td style="text-align: center;"> variable 2, outcome - </td>
<td style="text-align: center;">   </td>
<td style="text-align: center;"> total      </td>
</tr>
<tr>
<td style="text-align: left;">
   variable 1, outcome + </td>
<td style="text-align: center;">   </td>
<td style="text-align: center;"> <code>ai</code>             </td>
<td style="text-align: center;">   </td>
<td style="text-align: center;"> <code>bi</code>             </td>
<td style="text-align: center;">   </td>
<td style="text-align: center;"> <code>n1i</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   variable 1, outcome - </td>
<td style="text-align: center;">   </td>
<td style="text-align: center;"> <code>ci</code>             </td>
<td style="text-align: center;">   </td>
<td style="text-align: center;"> <code>di</code>             </td>
<td style="text-align: center;">   </td>
<td style="text-align: center;">            </td>
</tr>
<tr>
<td style="text-align: left;">
   total                 </td>
<td style="text-align: center;">   </td>
<td style="text-align: center;"> <code>n2i</code>            </td>
<td style="text-align: center;">   </td>
<td style="text-align: center;">                       </td>
<td style="text-align: center;">   </td>
<td style="text-align: center;"> <code>ni</code>
</td>
</tr>
</table>
<p>where <code>ai</code>, <code>bi</code>, <code>ci</code>, and <code>di</code> denote the cell frequencies (i.e., the number of individuals falling into a particular category), <code>n1i</code> (i.e., <code>ai+bi</code>) and <code>n2i</code> (i.e., <code>ai+ci</code>) are the marginal totals for the outcome of interest on the first and second variable, respectively, and <code>ni</code> is the total sample size (i.e., <code>ai+bi+ci+di</code>) of the study.
</p>
<p>For example, if variable 1 denotes two different groups (e.g., treated versus control) and variable 2 indicates whether a particular outcome of interest has occurred or not (e.g., death, complications, failure to improve under the treatment), then <code>n1i</code> denotes the number of individuals in the treatment group, but <code>n2i</code> is <em>not</em> the number of individuals in the control group, but the total number of individuals who experienced the outcome of interest on variable 2. <b>Note that the meaning of <code>n2i</code> is therefore different here compared to the <code>escalc</code> function (where <code>n2i</code> denotes <code>ci+di</code>)</b>.
</p>
<p>If a study does not report the cell frequencies, but it reports the total sample size (which can be specified via the <code>ni</code> argument), the two marginal counts (which can be specified via the <code>n1i</code> and <code>n2i</code> arguments), and some other statistic corresponding to the table, then it may be possible to reconstruct the cell frequencies. The present function currently allows this for three different cases:
</p>

<ol>
<li>
<p> If the odds ratio \[OR = \frac{a_i d_i}{b_i c_i}\] is known, then the cell frequencies can be reconstructed (Bonett, 2007). Odds ratios can be specified via the <code>ori</code> argument.
</p>
</li>
<li>
<p> If the phi coefficient \[\phi = \frac{a_i d_i - b_i c_i}{\sqrt{n_{1i}(n_i-n_{1i})n_{2i}(n_i-n_{2i})}}\] is known, then the cell frequencies can again be reconstructed (own derivation). Phi coefficients can be specified via the <code>ri</code> argument.
</p>
</li>
<li>
<p> If the chi-square statistic from Pearson's chi-square test of independence is known (which can be specified via the <code>x2i</code> argument), then it can be used to recalculate the phi coefficient and hence again the cell frequencies can be reconstructed. However, the chi-square statistic does not carry information about the sign of the phi coefficient. Therefore, values specified via the <code>x2i</code> argument can be positive or negative, which allows the specification of the correct sign. Also, when using a chi-square statistic as input, it is assumed that it was computed using Yates's correction for continuity (unless <code>correct=FALSE</code>). If the chi-square statistic is not known, but its p-value, one can first back-calculate the chi-square statistic using <code>qchisq(&lt;p-value&gt;, df=1, lower.tail=FALSE)</code>.
</p>
</li>
</ol>
<p>Typically, the odds ratio, phi coefficient, or chi-square statistic (or its p-value) that can be extracted from a study will be rounded to a certain degree. The calculations underlying the function are exact only for unrounded values. Rounding can therefore introduce some discrepancies.
</p>
<p>If a marginal total is unknown, then external information needs to be used to ‘guestimate’ the number of individuals that experienced the outcome of interest on this variable. Depending on the accuracy of such an estimate, the reconstructed cell frequencies will be more or less accurate and need to be treated with due caution.
</p>
<p>The true marginal counts also put constraints on the possible values for the odds ratio, phi coefficient, and chi-square statistic. If a marginal count is replaced by a guestimate which is not compatible with the given statistic, one or more reconstructed cell frequencies may be negative. The function issues a warning if this happens and sets the cell frequencies to <code>NA</code> for such a study.
</p>
<p>If only one of the two marginal counts is unknown but a 95% CI for the odds ratio is also available, then the <a href="https://cran.r-project.org/package=estimraw">estimraw</a> package can also be used to reconstruct the corresponding cell frequencies (Di Pietrantonj, 2006; but see Veroniki et al., 2013, for some cautions).
</p>


<h3>Value</h3>

<p>If the <code>data</code> argument was not specified or <code>append=FALSE</code>, a data frame with four variables called <code>var.names</code> with the reconstructed cell frequencies.
</p>
<p>If <code>data</code> was specified and <code>append=TRUE</code>, then the original data frame is returned. If <code>var.names[j]</code> (for \(\textrm{j} \in \{1, \ldots, 4\}\)) is a variable in <code>data</code> and <code>replace="ifna"</code> (or <code>replace=FALSE</code>), then only missing values in this variable are replaced with the estimated frequencies (where possible) and otherwise a new variable called <code>var.names[j]</code> is added to the data frame.
</p>
<p>If <code>replace="all"</code> (or <code>replace=TRUE</code>), then all values in <code>var.names[j]</code> where a reconstructed cell frequency can be computed are replaced, even for cases where the value in <code>var.names[j]</code> is not missing.
</p>


<h3>Author(s)</h3>

<p>Wolfgang Viechtbauer <a href="mailto:wvb@metafor-project.org">wvb@metafor-project.org</a> <a href="https://www.metafor-project.org">https://www.metafor-project.org</a>
</p>


<h3>References</h3>

<p>Bonett, D. G. (2007). Transforming odds ratios into correlations for meta-analytic research. <em>American Psychologist</em>, <b>62</b>(3), 254–255. <code style="white-space: pre;">⁠https://doi.org/10.1037/0003-066x.62.3.254⁠</code>
</p>
<p>Di Pietrantonj, C. (2006). Four-fold table cell frequencies imputation in meta analysis. <em>Statistics in Medicine</em>, <b>25</b>(13), 2299–2322. <code style="white-space: pre;">⁠https://doi.org/10.1002/sim.2287⁠</code>
</p>
<p>Veroniki, A. A., Pavlides, M., Patsopoulos, N. A., &amp; Salanti, G. (2013). Reconstructing 2 x 2 contingency tables from odds ratios using the Di Pietrantonj method: Difficulties, constraints and impact in meta-analysis results. <em>Research Synthesis Methods</em>, <b>4</b>(1), 78–94. <code style="white-space: pre;">⁠https://doi.org/10.1002/jrsm.1061⁠</code>
</p>
<p>Viechtbauer, W. (2010). Conducting meta-analyses in R with the metafor package. <em>Journal of Statistical Software</em>, <b>36</b>(3), 1–48. <code style="white-space: pre;">⁠https://doi.org/10.18637/jss.v036.i03⁠</code>
</p>


<h3>See Also</h3>

<p><code>escalc</code> for a function to compute various effect size measures based on \(2 \times 2\) table data.
</p>


<h3>Examples</h3>

<pre><code class="language-R">### demonstration that the reconstruction of the 2x2 table works
### (note: the values in rows 2, 3, and 4 correspond to those in row 1)
dat &lt;- data.frame(ai=c(36,NA,NA,NA), bi=c(86,NA,NA,NA), ci=c(20,NA,NA,NA), di=c(98,NA,NA,NA),
                  oddsratio=NA, phi=NA, chisq=NA, ni=NA, n1i=NA, n2i=NA)
dat$oddsratio[2] &lt;- round(exp(escalc(measure="OR", ai=ai, bi=bi, ci=ci, di=di, data=dat)$yi[1]), 2)
dat$phi[3] &lt;- round(escalc(measure="PHI", ai=ai, bi=bi, ci=ci, di=di, data=dat)$yi[1], 2)
dat$chisq[4] &lt;- round(chisq.test(matrix(c(t(dat[1,1:4])), nrow=2, byrow=TRUE))$statistic, 2)
dat$ni[2:4]  &lt;- with(dat, ai[1] + bi[1] + ci[1] + di[1])
dat$n1i[2:4] &lt;- with(dat, ai[1] + bi[1])
dat$n2i[2:4] &lt;- with(dat, ai[1] + ci[1])
dat

### reconstruct cell frequencies for rows 2, 3, and 4
dat &lt;- conv.2x2(ri=phi, ori=oddsratio, x2i=chisq, ni=ni, n1i=n1i, n2i=n2i, data=dat)
dat

### same example but with cell frequencies that are 10 times as large
dat &lt;- data.frame(ai=c(360,NA,NA,NA), bi=c(860,NA,NA,NA), ci=c(200,NA,NA,NA), di=c(980,NA,NA,NA),
                  oddsratio=NA, phi=NA, chisq=NA, ni=NA, n1i=NA, n2i=NA)
dat$oddsratio[2] &lt;- round(exp(escalc(measure="OR", ai=ai, bi=bi, ci=ci, di=di, data=dat)$yi[1]), 2)
dat$phi[3] &lt;- round(escalc(measure="PHI", ai=ai, bi=bi, ci=ci, di=di, data=dat)$yi[1], 2)
dat$chisq[4] &lt;- round(chisq.test(matrix(c(t(dat[1,1:4])), nrow=2, byrow=TRUE))$statistic, 2)
dat$ni[2:4]  &lt;- with(dat, ai[1] + bi[1] + ci[1] + di[1])
dat$n1i[2:4] &lt;- with(dat, ai[1] + bi[1])
dat$n2i[2:4] &lt;- with(dat, ai[1] + ci[1])
dat &lt;- conv.2x2(ri=phi, ori=oddsratio, x2i=chisq, ni=ni, n1i=n1i, n2i=n2i, data=dat)
dat # slight inaccuracy in row 3 due to rounding

### demonstrate what happens when a true marginal count is guestimated
escalc(measure="PHI", ai=176, bi=24, ci=72, di=128)
conv.2x2(ri=0.54, ni=400, n1i=200, n2i=248) # using the true marginal counts
conv.2x2(ri=0.54, ni=400, n1i=200, n2i=200) # marginal count for variable 2 is guestimated
conv.2x2(ri=0.54, ni=400, n1i=200, n2i=50)  # marginal count for variable 2 is incompatible

### demonstrate that using the correct sign for the chi-square statistic is important
chisq &lt;- round(chisq.test(matrix(c(40,60,60,40), nrow=2, byrow=TRUE))$statistic, 2)
conv.2x2(x2i=-chisq, ni=200, n1i=100, n2i=100) # correct reconstruction
conv.2x2(x2i=chisq, ni=200, n1i=100, n2i=100) # incorrect reconstruction

### demonstrate use of the 'correct' argument
tab &lt;- matrix(c(28,14,12,18), nrow=2, byrow=TRUE)
chisq &lt;- round(chisq.test(tab)$statistic, 2) # chi-square test with Yates' continuity correction
conv.2x2(x2i=chisq, ni=72, n1i=42, n2i=40) # correct reconstruction
chisq &lt;- round(chisq.test(tab, correct=FALSE)$statistic, 2) # without Yates' continuity correction
conv.2x2(x2i=chisq, ni=72, n1i=42, n2i=40) # incorrect reconstruction
conv.2x2(x2i=chisq, ni=72, n1i=42, n2i=40, correct=FALSE) # correct reconstruction

### recalculate chi-square statistic based on p-value
pval &lt;- round(chisq.test(tab)$p.value, 2)
chisq &lt;- qchisq(pval, df=1, lower.tail=FALSE)
conv.2x2(x2i=chisq, ni=72, n1i=42, n2i=40)
</code></pre>


</div>