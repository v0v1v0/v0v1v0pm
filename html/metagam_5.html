<div class="container">

<table style="width: 100%;"><tr>
<td>plot.metagam</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot estimated smooth terms</h2>

<h3>Description</h3>

<p>Plot the meta-analytic estimate of a smooth term along with the separate fits
in each cohort.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'metagam'
plot(x, term = NULL, ci = "none", legend = FALSE, only_meta = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Object returned by <code>metagam</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>term</code></td>
<td>
<p>The smooth term to plot. Defaults to <code>NULL</code>, which means
that the first term is plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>Type of confidence bands to plot around the meta-analytic fit.
Defaults to "none", which means the no bands are plotted. Other options are
"simultaneous", "pointwise", and "both". Simultaneous confidence bands
require that <code>metagam</code> was run with <code>nsim</code> not equal to
<code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>Logical specifying whether or not to plot a legend. Defaults to
<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>only_meta</code></td>
<td>
<p>Logical specifying whether to include the fits for each
study, or to only plot the meta-analytic fit. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments to plot.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function is called for its side effect of producing a plot.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(metagam)
library(mgcv)

## Create 5 datasets
set.seed(1234)
datasets &lt;- lapply(1:5, function(x) gamSim(scale = 5, verbose = FALSE))

## Fit a GAM in each dataset, then use strip_rawdata() to remove
## individual participant data
models &lt;- lapply(datasets, function(dat){
  ## This uses the gam() function from mgcv
  model &lt;- gam(y ~ s(x0, bs = "cr") + s(x1, bs = "cr") + s(x2, bs = "cr"), data = dat)
  ## This uses strip_rawdata() from metagam
  strip_rawdata(model)
})

## Next, we meta-analyze the models.
## It is often most convenient to analyze a single term at a time. We focus on s(x1).
meta_analysis &lt;- metagam(models, terms = "s(x1)", grid_size = 30)

## We can print some information
summary(meta_analysis)

## We can plot the meta-analytic fit together with the individual fits
plot(meta_analysis)
plot(meta_analysis, ci = "pointwise")

## We can also compute p-values and simultaneous confidence intervals, by setting the nsim argument.
## For details, see the separate vignette.
## Not run: 
  meta_analysis &lt;- metagam(models, terms = "s(x0)", grid_size = 30, nsim = 1000)
  summary(meta_analysis)
  plot(meta_analysis, ci = "both")
  plot(meta_analysis, ci = "simultaneous")

## End(Not run)
</code></pre>


</div>