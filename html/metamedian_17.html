<div class="container">

<table style="width: 100%;"><tr>
<td>qe.study.level</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Study-Level application of quantile estimation method</h2>

<h3>Description</h3>

<p>This function estimates the asymptotic sampling variance of either the (estimated) median or the (estimated) difference of medians for a primary study that reports one of the following summary measures: </p>

<ul>
<li>
<p> S1: median, minimum and maximum values, and sample size
</p>
</li>
<li>
<p> S2: median, first and third quartiles, and sample size
</p>
</li>
<li>
<p> S3: median, minimum and maximum values, first and third quartiles, and sample size
</p>
</li>
<li>
<p> S4: mean, standard deivation, and sample size.
</p>
</li>
</ul>
<p>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">qe.study.level(
  min.g1,
  q1.g1,
  med.g1,
  q3.g1,
  max.g1,
  n.g1,
  mean.g1,
  sd.g1,
  min.g2,
  q1.g2,
  med.g2,
  q3.g2,
  max.g2,
  n.g2,
  mean.g2,
  sd.g2,
  single.family = FALSE,
  loc.shift = FALSE,
  qe.fit.control.g1 = list(),
  qe.fit.control.g2 = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>min.g1</code></td>
<td>
<p>numeric value giving the sample minimum (first group for two-group studies).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q1.g1</code></td>
<td>
<p>numeric value giving the first quartile (first group for two-group studies).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>med.g1</code></td>
<td>
<p>numeric value giving the sample median (first group for two-group studies).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q3.g1</code></td>
<td>
<p>numeric value giving the sample third quartile (first group for two-group studies).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.g1</code></td>
<td>
<p>numeric value giving the sample maximum (first group for two-group studies).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.g1</code></td>
<td>
<p>numeric value giving the sample size (first group for two-group studies).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.g1</code></td>
<td>
<p>numeric value giving the sample mean (first group for two-group studies).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd.g1</code></td>
<td>
<p>numeric value giving the sample standard deviation (first group for two-group studies).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.g2</code></td>
<td>
<p>numeric value giving the sample minimum of the second group for two-group studies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q1.g2</code></td>
<td>
<p>numeric value giving the sample first quartile of the second group for two-group studies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>med.g2</code></td>
<td>
<p>numeric value giving the sample median of the second group for two-group studies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q3.g2</code></td>
<td>
<p>numeric value giving the sample third quartile of the second group for two-group studies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.g2</code></td>
<td>
<p>numeric value giving the sample maximum of the second group for two-group studies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.g2</code></td>
<td>
<p>numeric value giving the sample size of the second group for two-group studies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.g2</code></td>
<td>
<p>numeric value giving the sample mean of the second group for two-group studies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd.g2</code></td>
<td>
<p>numeric value giving the sample standard deviation of the second group for two-group studies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>single.family</code></td>
<td>
<p>logical scalar indicating that for two-group studies, the parametric family of distributions is assumed to be the same across both groups (the default is <code>FALSE</code>). See 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loc.shift</code></td>
<td>
<p>logical scalar indicating that for two-group studies, distributions are assumed to only differ by a location shift (the default is <code>FALSE</code>). See 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qe.fit.control.g1</code></td>
<td>
<p>optional list of control parameters for <code>qe.fit</code> (first group for two-group studies).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qe.fit.control.g2</code></td>
<td>
<p>optional list of control parameters for <code>qe.fit</code> of the second group for two-group studies.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In order to estimate the asymptotic sampling variance of the median (in S1, S2, or S3), one must have an estimate of the probability density function of the outcome evaluated at the population median. The <code>qe.fit</code> function is applied to estimate the outcome distribution.
</p>
<p>For two-group studies studies, one may assume that the outcome in both groups follows the same parametric family of distributions. In this case, distribution selection for the QE method is applied as follows. The <code>qe.fit</code> function is applied to fit the candidate distributions of each group separately. However, for each candidate distribution, the objective function evaluated at the fitting parameters are summed over the two groups. The parametric family of distributions with the smallest sum is used as the underlying distribution of the both groups. If <code>single.family</code> is <code>TRUE</code>, then <code>selected.dist</code> is a character string indicating the selected parametric family. If <code>single.family</code> is <code>FALSE</code>, then <code>selected.dist</code> is a vector of length 2 where elements 1 and 2 are character strings of the selected parametric families in groups 1 and 2, respectively.
</p>
<p>One may also assume for two-group studies that the outcome distributions in the two groups only differ by a location shfit. In this case, a weighted mean (weighted by sample size) of the estimated probability density functions evaluated at the population medians is used to estimate the asymptotic sampling variance of the difference of medians. See McGrath et al. (2020) for further details.
</p>
<p>When a study provides S4 summary measures, the outcome distribution is assumed to be normal. The sample median is estimated by the sample mean, and its variance is estimated by the sample variance divided by the sample size. In this case, the <code>single.family</code> and <code>loc.shift</code> arguments are not used.
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>Estimated sampling variance of the effect size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effect.size</code></td>
<td>
<p>Effect size of study.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selected.dist</code></td>
<td>
<p>Selected outcome distribution(s). See 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>study.type</code></td>
<td>
<p>Character string specifying whether one-group or two-group summary data was provided.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>McGrath S., Sohn H., Steele R., and Benedetti A. (2020). Meta-analysis of the difference of medians. <em>Biometrical Journal</em>, <strong>62</strong>, 69-98.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Generate S2 summary data
set.seed(1)
n &lt;- 100
x &lt;- stats::rlnorm(n, 2.5, 1)
quants &lt;- stats::quantile(x, probs = c(0.25, 0.5, 0.75))

## Estimate sampling variance of the median
qe.study.level(q1.g1 = quants[1], med.g1 = quants[2], q3.g1 = quants[3],
               n.g1 = n)

</code></pre>


</div>