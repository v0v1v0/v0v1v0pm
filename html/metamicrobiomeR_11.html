<div class="container">

<table style="width: 100%;"><tr>
<td>pathway.compare</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compare (kegg) pathway abundance</h2>

<h3>Description</h3>

<p>This is a slightly modified version of the taxa.compare function.
It compares pathway abundance generated from PICRUSt analysis between groups using different methods (apply to pathway summary tables already merged to mapping file and put in a list (e.g.level 1, 2 and 3)).
Specifically, it compares relative abundances of bacterial functional pathways at all levels using GAMLSS or LM/LMEM and compares of log(absolute abundances) of bacterial functional pathways at all levels using LM/LMEM.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pathway.compare(
  pathtab,
  mapfile,
  sampleid = "sampleid",
  pathsum = "rel",
  stat.med = "gamlss",
  transform = "none",
  comvar,
  adjustvar,
  personid = "personid",
  longitudinal = "yes",
  p.adjust.method = "fdr",
  percent.filter = 0.05,
  relabund.filter = 5e-05,
  pooldata = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pathtab</code></td>
<td>
<p>list of pathway abundance table of all levels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mapfile</code></td>
<td>
<p>mapping file or file containing covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampleid</code></td>
<td>
<p>variable containing sample id to be matched between pathway abundance table and mapping file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pathsum</code></td>
<td>
<p>type of abundance to be compared. Options are "rel" for relative abundance or "log" for log of absolute abundance. Default is "rel".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stat.med</code></td>
<td>
<p>statistical method for comparison. stat.med can be "lm" for LM/LMEM (usable for both pathsum="rel" or "log") or "gamlss" for GAMLSS with BEZI family (gamlss only make sense if pathsum="rel" ).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transform</code></td>
<td>
<p>transformation of relative abundance data. Options are "none" for no transformation, "asin.sqrt" for arcsine transformation, "logit" for logit transformation. Default is "none".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comvar</code></td>
<td>
<p>main variable for comparison.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjustvar</code></td>
<td>
<p>variables to be adjusted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>personid</code></td>
<td>
<p>name of variable for person id in mapping file (applicable for longitudinal data)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>longitudinal</code></td>
<td>
<p>whether the data is longitudinal. Default is "yes".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.adjust.method</code></td>
<td>
<p>method for multiple testing adjustment. Available options are those of the p.adjust function. Default is "fdr".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>percent.filter</code></td>
<td>
<p>prevalence threshold (the percentage of number of samples the taxa/pathway available). Default is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>relabund.filter</code></td>
<td>
<p>relative abundance threshold (the minimum of the average relative abundance for a taxa/pathway to be retained). Default is 0.00005.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pooldata</code></td>
<td>
<p>whether the data is pooled from multiple studies. Default is FALSE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>matrice of coefficients, standard errors, p-values and multiple testing adjusted p-values of all variables in the models.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Load Bangladesh pathway and metadata
data(kegg.12)
data(covar.rm)
# Comparison of pathway relative abundances for some first pathways of level 1 only
# and assuming crosssectional data (to save running time)
path1&lt;-pathway.compare(pathtab=list(kegg.12[[1]][, 1:2]),
mapfile=covar.rm,sampleid="sampleid",pathsum="rel", stat.med="gamlss",
comvar="gender",adjustvar=c("age.sample","bf"), longitudinal="no",
p.adjust.method="fdr", percent.filter=0.05,relabund.filter=0.00005)
taxcomtab.show(taxcomtab=path1$l1, sumvar="path",tax.lev="l2",
tax.select="none", showvar="genderMale", p.adjust.method="fdr",p.cutoff=1)
</code></pre>


</div>