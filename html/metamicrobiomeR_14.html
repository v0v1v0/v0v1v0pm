<div class="container">

<table style="width: 100%;"><tr>
<td>taxa.compare</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compare taxa relative abundance</h2>

<h3>Description</h3>

<p>This function compares taxa relative abundance summary tables at all levels between groups using GAMLSS with BEZI or Linear/Linear Mixed Effect models (LM/LMEM) after filtering (using prevalence and relative abundance thresholds).
</p>


<h3>Usage</h3>

<pre><code class="language-R">taxa.compare(
  taxtab,
  propmed.rel = "gamlss",
  transform = "none",
  zeroreplace.method = "none",
  comvar,
  adjustvar,
  personid = "personid",
  longitudinal = "yes",
  percent.filter = 0.05,
  relabund.filter = 5e-05,
  p.adjust.method = "fdr"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>taxtab</code></td>
<td>
<p>taxa relative abundance table (already merged to mapping file) from phylum to species or any preferred highest taxa level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>propmed.rel</code></td>
<td>
<p>statistical method for comparing relative abundance. Options are "lm" for LM/LMEM or "gamlss" for GAMLSS with BEZI family.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transform</code></td>
<td>
<p>transformation of relative abundance data. Options are "none" for no transformation, "gmpr" for Geometric Mean of Pairwise Ratios (GMPR) normalization, "asin.sqrt" for arcsine transformation, "logit" for logit transformation, "clr" for centered log ratio transformation. Default is "none".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zeroreplace.method</code></td>
<td>
<p>Method for zero replacement implemented in R package *zCompositions*. Options are "none" for no replacement, "multKM" for Multiplicative Kaplan-Meier smoothing spline (KMSS) replacement, "multLN" for Multiplicative lognormal replacement, "multRepl" for Multiplicative simple replacement, "lrEM" for Log-ratio EM algorithm, "lrDA" for Log-ratio DA algorithm. Default is "none".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comvar</code></td>
<td>
<p>main variable for comparison</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjustvar</code></td>
<td>
<p>variables to be adjusted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>personid</code></td>
<td>
<p>name of variable for person id (applicable for longitudinal data)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>longitudinal</code></td>
<td>
<p>whether data is longitudinal? Options are "yes" or "no". Default is "yes".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>percent.filter</code></td>
<td>
<p>prevalence threshold (the percentage of number of samples the taxa/pathway available). Default is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>relabund.filter</code></td>
<td>
<p>relative abundance threshold (the minimum of the average relative abundance for a taxa/pathway to be retained). Default is 0.00005.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.adjust.method</code></td>
<td>
<p>method for multiple testing adjustment. Options are those of the p.adjust.methods of stats:: p.adjust function. Default for this function is "fdr".</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>matrice of coefficients, standard errors, p-values and multiple testing adjusted p-values of all variables in the models.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Load summary tables of bacterial taxa relative abundance from Bangladesh data
data(taxtab6)
tab6&lt;-as.data.frame(taxtab6)
tl&lt;-colnames(taxtab6)[grep("k__bacteria.p__fusobacteria",colnames(taxtab6))]
taxacom.ex&lt;-taxa.compare(taxtab=tab6[,c("personid","x.sampleid","bf","age.sample",tl)],
propmed.rel="gamlss",comvar="bf",adjustvar="age.sample",
longitudinal="yes",p.adjust.method="fdr")
</code></pre>


</div>