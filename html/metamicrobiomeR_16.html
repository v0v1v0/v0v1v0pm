<div class="container">

<table style="width: 100%;"><tr>
<td>taxa.mean.plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot mean taxa abundance</h2>

<h3>Description</h3>

<p>This function visualize mean relative abundance by group as stacked plots.
</p>


<h3>Usage</h3>

<pre><code class="language-R">taxa.mean.plot(
  tabmean,
  sumvar = "taxa",
  tax.select = "none",
  tax.lev = "l2",
  comvar,
  groupvar,
  mean.filter = 0.005,
  pallete.by.phylum = FALSE,
  show.taxname = "full",
  legend.position = "right",
  xlab = "",
  ylab = "Relative abundance"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tabmean</code></td>
<td>
<p>table of mean abundance generated from taxa.meansdn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sumvar</code></td>
<td>
<p>variable to be plotted. Options are c("taxa","path"). Default is "taxa"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tax.select</code></td>
<td>
<p>list of selected taxa/pathways to be plotted. Default is "none" or plot all taxa/pathways.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tax.lev</code></td>
<td>
<p>taxa level to be visualized. Options are from "l2" (phylum) to "l7" (species). Default is "l2". If sumvar="path", all pathways will be visualized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comvar</code></td>
<td>
<p>main variable for comparison.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groupvar</code></td>
<td>
<p>variable for stratifying.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.filter</code></td>
<td>
<p>mean abundance filtering threshold (only plot those with mean abundance&gt;threshold and plot all those with mean abundance &lt;threshold as "other").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pallete.by.phylum</code></td>
<td>
<p>whether each pallete of color for each phylum. Default is FALSE (plot distinc colors).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.taxname</code></td>
<td>
<p>whether show "full" taxa name or "short" name. Default is "full".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.position</code></td>
<td>
<p>position of legend. Options are c("right", "left","bottom","top","none") as in ggplot2. Default is "right".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>label for x-axis. Default is "Chronological age (month)".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>label for y-axis. Default is "Relative abundance".</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list of ggplot2 object and list of taxa/pathways plotted (those with mean abundance &gt;mean.filter).
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Load summary tables of bacterial taxa relative abundance from Bangladesh data
data(taxtab6)
taxlist.rm&lt;-taxa.filter(taxtab=taxtab6, percent.filter = 0.05, relabund.filter = 0.00005)
taxa.meansdn.rm&lt;-taxa.meansdn(taxtab=taxtab6,sumvar="bf",groupvar="age.sample")
taxa.meansdn.rm&lt;-taxa.meansdn.rm[taxa.meansdn.rm$bf!="No_BF",]
taxa.meansdn.rm$bf&lt;-gdata::drop.levels(taxa.meansdn.rm$bf,reorder=FALSE)
#phylum
p.bf.l2&lt;-taxa.mean.plot(tabmean=taxa.meansdn.rm, tax.lev="l2",
comvar="bf", groupvar="age.sample",mean.filter=0.005, show.taxname="short")
p.bf.l2$p
</code></pre>


</div>