<div class="container">

<table style="width: 100%;"><tr>
<td>meta.niceplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Nice meta-analysis plots.</h2>

<h3>Description</h3>

<p>This function displays meta-analysis results of relative abundance as a nice combined heatmap and forest plot. More flexibility/options for plot will be added.
</p>


<h3>Usage</h3>

<pre><code class="language-R">meta.niceplot(
  metadat,
  sumtype = "taxa",
  level = "main",
  p,
  p.adjust,
  phyla.col = "rainbow",
  phyla.select = c("actinobacteria", "bacteroidetes", "cyanobacteria", "firmicutes",
    "fusobacteria", "proteobacteria", "verrucomicrobia", ".thermi."),
  col.select = c("#dd1c77", "#31a354", "#91003f", "#d95f0e", "#636363", "#2ef0e7",
    "#862ef0", "#000"),
  est.break = c(-Inf, -1, -0.5, -0.1, 0, 0.1, 0.5, 1, Inf),
  est.break.label = c("&lt;-1", "[-1,-0.5)", "[-0.5,-0.1)", "[-0.1,0)", "[0,0.1)",
    "[0.1,0.5)", "[0.5,1)", "&gt;=1"),
  neg.palette = "PuBu",
  pos.palette = "YlOrRd",
  p.sig.heat = "no",
  p.break = c(0, 1e-04, 0.05, 1),
  p.break.label = c("**", "*", ""),
  p.pool.break = c(0, 0.05, 1),
  p.pool.break.label = c("[0,0.05)", "[0.05,1]"),
  padjust.pool.break = c(0, 0.1, 1),
  padjust.pool.break.label = c("[0,0.1)", "[0.1,1]"),
  forest.est.shape = c("17", "16"),
  forest.est.col = c("red", "black"),
  forest.col = "by.pvalue",
  leg.key.size = 1,
  leg.text.size = 8,
  heat.text.x.size = 8,
  heat.text.x.angle = 0,
  forest.axis.text.y = 8,
  forest.axis.text.x = 8,
  heat.forest.width.ratio = c(1, 1),
  point.ratio = c(3, 1),
  line.ratio = c(2, 1)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>metadat</code></td>
<td>
<p>output data from metatab.show.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sumtype</code></td>
<td>
<p>Either "taxa" for taxa and "path" for pathway.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>"main" for main level such as phylum or "sub" for higher level such as species. Default is "main".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>name of variable for p-values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.adjust</code></td>
<td>
<p>name of variable for multiple testing adjusted p-values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phyla.col</code></td>
<td>
<p>type of color for main level (phylum). Options are "rainbow" (default) or "select".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phyla.select</code></td>
<td>
<p>selected phyla for selected colors (only when phyla.col="select"). Default are c("actinobacteria","bacteroidetes","cyanobacteria","firmicutes","fusobacteria","proteobacteria","verrucomicrobia",".thermi.").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.select</code></td>
<td>
<p>selected colors for selected phyla (only when phyla.col="select"). Corresponding default are c("#dd1c77","#31a354","#91003f","#d95f0e","#636363","#2ef0e7","#862ef0","#000").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est.break</code></td>
<td>
<p>breaks for estimates to generate color categories on heatmap. Default are c(-Inf, -1,-0.5,-0.1,0,0.1,0.5,1, Inf). For pathway, recommended breaks are c(-Inf, -0.5,-0.1,-0.05,0,0.05,0.1,0.5, Inf).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est.break.label</code></td>
<td>
<p>labels for corresponding color categories on heatmap generated by est.break. Default corresponding to default est.break are c("&lt;-1","[-1,-0.5)","[-0.5,-0.1)","[-0.1,0)", "[0,0.1)", "[01,0.5)", "[0.5,1)", "&gt;=1"). For pathway, corresponding recommended labels are c("&lt;-0.5)", "[-0.5,-0.1)","[-0.1,-0.05)","[-0.05,0)","[0,0.05)","[0.05,0.1)", "[0.1,0.5)", "&gt;=0.5").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>neg.palette</code></td>
<td>
<p>color palette for negative estimate values. Default is "PuBu". Use display.brewer.all() of RColorBrewer package for other options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos.palette</code></td>
<td>
<p>color palette for positive estimate values. Default is "YlOrRd". Use display.brewer.all() of RColorBrewer package for other options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.sig.heat</code></td>
<td>
<p>whether or not show significant p values on heatmap. Default is "yes".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.break</code></td>
<td>
<p>breaks for significant levels of p values. Default is c(0, 0.0001,0.05, 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.break.label</code></td>
<td>
<p>labels to be showed on heatmap for different levels of p-values from p.break. Default is c("**", "*","") for p breaks at c(0, 0.0001,0.05, 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.pool.break</code></td>
<td>
<p>breaks for pooled p-values to be distinguished in forest plot. Default are c(0,0.05,1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.pool.break.label</code></td>
<td>
<p>labels for pooled p-value breaks. Corresponding default are c("[0,0.05)","[0.05,1]").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>padjust.pool.break</code></td>
<td>
<p>breaks for multiple testing adjusted p-values to be distinguished in forest plot. Default are c(0,0.1,1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>padjust.pool.break.label</code></td>
<td>
<p>labels for  multiple testing adjusted p-value breaks. Corresponding default are c("[0,0.1)","[0.1,1]").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>forest.est.shape</code></td>
<td>
<p>point shape of pooled estimates in forest plot. Default are c("17","16") for corresponding significant and non-significant pooled estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>forest.est.col</code></td>
<td>
<p>colors of point (pooled estimates) and 95 CI bars in forest plot. Default are c("red", "black") for significant and non-significant estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>forest.col</code></td>
<td>
<p>Color of forest plot (point estimates and 95 CI). Options are "by.pvalue" (distinguished by signficant vs. non-significant p-value) or "by.estimate" (color scaled similarly to heatmap color).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leg.key.size</code></td>
<td>
<p>legdend key size for heatmap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leg.text.size</code></td>
<td>
<p>legend text size for heatmap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>heat.text.x.size</code></td>
<td>
<p>heatmap x label text size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>heat.text.x.angle</code></td>
<td>
<p>heatmap x label text angle.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>forest.axis.text.y</code></td>
<td>
<p>forest plot y label text size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>forest.axis.text.x</code></td>
<td>
<p>forest plot x label text size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>heat.forest.width.ratio</code></td>
<td>
<p>ratio of width between heatmap and forest plot to be used in grid.arrange. Dedault is c(1,1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>point.ratio</code></td>
<td>
<p>ratio of point size between significant pooled estimate and non-significant pooled estimate. Default is c(3,1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line.ratio</code></td>
<td>
<p>ratio of error bar line size between significant pooled estimate and non-significant pooled estimate. Default is=c(2,1).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>combined heatmap forest plot.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># load saved GAMLSS-BEZI results of four studies
# for the comparison of bacterial taxa relative abundance
# between genders adjusted for breastfeeding and
# infant age at sample collection
data(tabsex4)
#select only taxonomies of a small phylum for meta-analysis example
# (to save running time)
tlm&lt;-tabsex4$id[grep("k__bacteria.p__fusobacteria",tabsex4$id)]
# meta-analysis
metab.sex&lt;-meta.taxa(taxcomdat=tabsex4[tabsex4$id %in% tlm,],
summary.measure="RR", pool.var="id", studylab="study", backtransform=FALSE,
percent.meta=0.5, p.adjust.method="fdr")
#show results by table and plot
#phylum
#table
metatab.show(metatab=metab.sex$random,com.pooled.tab=tabsex4[tabsex4$id %in% tlm,],
tax.lev="l2",showvar="genderMale",p.cutoff.type="p", p.cutoff=1,display="table")
#plot
metadat&lt;-metatab.show(metatab=metab.sex$random, com.pooled.tab=tabsex4[tabsex4$id %in% tlm,],
tax.lev="l2", showvar="genderMale",p.cutoff.type="p", p.cutoff=1,display="data")
meta.niceplot(metadat=metadat,sumtype="taxa",level="main",
p="p",p.adjust="p.adjust", phyla.col="rainbow", p.sig.heat="yes",
heat.forest.width.ratio =c(1.5,1), leg.key.size=0.8, leg.text.size=10,
heat.text.x.size=10, heat.text.x.angle=0, forest.axis.text.y=8,
forest.axis.text.x=10, point.ratio = c(4,2),line.ratio = c(2,1))
</code></pre>


</div>