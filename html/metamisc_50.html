<div class="container">

<table style="width: 100%;"><tr>
<td>riley</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit the alternative model for bivariate random-effects meta-analysis</h2>

<h3>Description</h3>

<p>This function fits the alternative model for bivariate random-effects meta-analysis when the within-study correlations 
are unknown. This bivariate model was proposed by Riley et al. (2008) and is similar to the general bivariate 
random-effects model (van Houwelingen et al. 2002), but includes an overall correlation parameter rather than 
separating the (usually unknown) within- and between-study correlation. As a consequence, the alternative model 
is not fully hierarchical, and estimates of additional variation beyond sampling error (<code>psi</code>) are not 
directly equivalent to the between-study variation (<code>tau</code>) from the general model. This model is particularly 
useful when there is large within-study variability, few primary studies are available or the general model 
estimates the between-study correlation as 1 or -1.
</p>


<h3>Usage</h3>

<pre><code class="language-R">riley(X, slab, optimization = "Nelder-Mead", control = list(), pars, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>data frame containing integer variables <code>Y1</code>, <code>vars1</code>, <code>Y2</code> and <code>vars2</code>,
where the columns <code>Y1</code> and <code>Y2</code> represent the effect sizes of outcome 1 and, respectively, outcome 2. The columns 
<code>vars1</code> and <code>vars2</code> represent the error variances of <code>Y1</code> and, respectively, <code>Y2</code>. Alternatively, 
when considering a meta-analysis of diagnostic test accuracy data, the columns <code>TP</code>, <code>FN</code>, <code>FP</code> and 
<code>TN</code> may be specified. Corresponding values then represent the number of true positives, the number of false negatives,
the number of false positives and, respectively, the number of true negatives.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slab</code></td>
<td>
<p>Optional vector specifying the label for each study</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimization</code></td>
<td>
<p>The optimization method that should be used for minimizing the negative (restricted) 
log-likelihood function. The default method is an implementation of that of Nelder and Mead (1965), 
that uses only function values and is robust but relatively slow. Other methods are described in optim.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>A list of control parameters to pass to optim.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pars</code></td>
<td>
<p>List with additional arguments. The width of confidence, credibility and prediction intervals is 
defined by <code>level</code> (defaults to 0.95).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments to be passed on to other functions. See "Details" for more information.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Parameters are estimated by iteratively maximizing the restriced log-likelihood using the Newton-Raphson procedure. 
The results from a univariate random-effects meta-analysis with a method-of-moments estimator are used as starting 
values for <code>beta1</code>, <code>beta2</code>, <code>psi1</code> and <code>psi2</code> in the <code>optim</code> command. Standard errors for all parameters are obtained 
from the inverse Hessian matrix.
</p>


<h4>Meta-analysis of effect sizes</h4>

<p>The following parameters are estimated by iteratively maximizing the restriced log-likelihood using the Newton-Raphson 
procedure: pooled effect size for outcome 1 (<code>beta1</code>), pooled effect size for outcome 2 (<code>beta2</code>), 
additional variation of <code>beta1</code> beyond sampling error (<code>psi1</code>), additional variation of <code>beta2</code> 
beyond sampling error (<code>psi2</code>) and the correlation <code>rho</code> between <code>psi1</code> and <code>psi2</code>. 
</p>



<h4>Meta-analysis of diagnostic test accuracy</h4>

<p>Although the model can also be used for diagnostic test accuracy data when substantial within-study correlations 
are expected, assuming zero within-study correlations (i.e. applying Reitsma's approach) is usually justified 
(Reitsma et al. 2005, Daniels and Hughes 1997, Korn et al. 2005, Thompson et al. 2005, Van Houwelingen et al. 2002).
</p>
<p>A logit transformation is applied to the sensitivities ans false positive rates of each study, in order to meet the normality 
assumptions. When zero cell counts occur, continuity corrections may be required. The correction value can be specified using
<code>correction</code> (defaults to 0.5). Further, when the argument <code>correction.control</code> is set to <code>"all"</code> 
(the default) the continuity correction is added to the whole data if only one cell in one study is zero. 
If <code>correction.control="single"</code> the correction is only applied to rows of the data which have a zero.
</p>
<p>The following parameters are estimated: logit of sensitivity (<code>beta1</code>), logit of false positive rate (<code>beta2</code>), 
additional variation of <code>beta1</code> beyond sampling error (<code>psi1</code>), additional variation of <code>beta2</code> beyond 
sampling error (<code>psi2</code>) and the correlation (<code>rho</code>) between <code>psi1</code> and <code>psi2</code>. 
</p>



<h3>Value</h3>

<p>An object of the class <code>riley</code> for which many standard methods are available. A warning message is 
casted when the Hessian matrix contains negative eigenvalues, which implies that the identified solution is a 
saddle point and thus not optimal.
</p>


<h3>Note</h3>

<p>The overall correlation parameter <code>rho</code> is transformed during estimation to ensure that corresponding values
remain between -1 and 1. The transformed correlation <code>rhoT</code> is given as <code>logit((rho+1)/2)</code>. During optimization,
the starting value for <code>rhoT</code> is set to 0.  The standard error of <code>rho</code> is derived from <code>rhoT</code> using 
the Delta method. Similarly, the Delta methods is used to derive the standard error of the sensitivity and false 
positive rate from <code>beta1</code> and, respectively, <code>beta2</code>.
</p>
<p>Algorithms for dealing with missing data are currently not implemented, but Bayesian approaches will become 
available in later versions.
</p>


<h3>Author(s)</h3>

<p>Thomas Debray &lt;thomas.debray@gmail.com&gt;
</p>


<h3>References</h3>


<ul>
<li>
<p> Korn EL, Albert PS, McShane LM. Assessing surrogates as trial endpoints using mixed models. 
<em>Statistics in Medicine</em> 2005; <b>24</b>: 163–182.
</p>
</li>
<li>
<p> Nelder JA, Mead R. A simplex algorithm for function minimization. <em>Computer Journal</em> (1965); <b>7</b>: 308–313.
</p>
</li>
<li>
<p> Reitsma J, Glas A, Rutjes A, Scholten R, Bossuyt P, Zwinderman A. Bivariate analysis of sensitivity and 
specificity produces informative summary measures in diagnostic reviews. <em>Journal of Clinical Epidemiology</em> 2005; 
<b>58</b>: 982–990.
</p>
</li>
<li>
<p> Riley RD, Thompson JR, Abrams KR. An alternative model for bivariate random-effects meta-analysis when 
the within-study correlations are unknown. <em>Biostatistics</em> 2008; <b>9</b>: 172–186.
</p>
</li>
<li>
<p> Thompson JR, Minelli C, Abrams KR, Tobin MD, Riley RD. Meta-analysis of genetic studies using mendelian 
randomization–a multivariate approach. <em>Statistics in Medicine</em> 2005; <b>24</b>: 2241–2254.
</p>
</li>
<li>
<p> van Houwelingen HC, Arends LR, Stijnen T. Advanced methods in meta-analysis: multivariate approach and 
meta-regression. <em>Statistics in Medicine</em> 2002; <b>21</b>: 589–624.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">data(Scheidler)
data(Daniels)
data(Kertai)

# Meta-analysis of potential surrogate markers data
# The results obtained by Riley (2008) were as follows:
# beta1 = -0.042 (SE = 0.063),
# beta2 = 14.072 (SE = 4.871)
# rho   = -0.759
## Not run: 
fit1 &lt;- riley(Daniels) #maxit reached, try again with more iterations

## End(Not run)
fit1 &lt;- riley(Daniels, control=list(maxit=10000))
summary(fit1)

# Meta-analysis of prognostic test studies
fit2 &lt;- riley(Kertai)
fit2

# Meta-analysis of computed tomography data 
ds &lt;- Scheidler[which(Scheidler$modality==1),]
fit3 &lt;- riley(ds)
fit3

</code></pre>


</div>