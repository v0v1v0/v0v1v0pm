<div class="container">

<table style="width: 100%;"><tr>
<td>valmeta</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Meta-analysis of prediction model performance</h2>

<h3>Description</h3>

<p>This function provides summary estimates for the concordance statistic, 
the total observed-expected ratio or the calibration slope. Where 
appropriate, data transformations are applied and missing information 
is derived from available quantities. Unless specified otherwise, all 
meta-analysis models assume random effects and are fitted using restricted 
maximum likelihood estimation with the <span class="pkg">metafor</span> package 
(Viechtbauer 2010). Further, confidence intervals for the average 
performance are based on the Hartung-Knapp-Sidik-Jonkman method. 
When conducting a Bayesian meta-analysis, the R packages <span class="pkg">runjags</span> and 
<span class="pkg">rjags</span> must be installed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">valmeta(
  measure = "cstat",
  cstat,
  cstat.se,
  cstat.cilb,
  cstat.ciub,
  cstat.cilv,
  sd.LP,
  OE,
  OE.se,
  OE.cilb,
  OE.ciub,
  OE.cilv,
  citl,
  citl.se,
  N,
  O,
  E,
  Po,
  Po.se,
  Pe,
  data,
  method = "REML",
  test = "knha",
  verbose = FALSE,
  slab,
  n.chains = 4,
  pars,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>measure</code></td>
<td>
<p>A character string indicating which summary performance 
measure should be calculated. Options are
<code>"cstat"</code> (meta-analysis of the concordance statistic) and <code>"OE"</code> 
(meta-analysis of the total observed-expected ratio). See ‘Details’ for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cstat</code></td>
<td>
<p>Optional vector with the estimated c-statistic for each valiation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cstat.se</code></td>
<td>
<p>Optional vector with the standard error of the estimated c-statistics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cstat.cilb</code></td>
<td>
<p>Optional vector to specify the lower limits of the confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cstat.ciub</code></td>
<td>
<p>Optional vector to specify the upper limits of the confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cstat.cilv</code></td>
<td>
<p>Optional vector to specify the levels of aformentioned confidence interval limits. 
(default: 0.95, which corresponds to the 95% confidence interval).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd.LP</code></td>
<td>
<p>Optional vector with the standard deviation of the linear predictor (prognostic index)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>OE</code></td>
<td>
<p>Optional vector with the estimated ratio of total observed versus total expected events</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>OE.se</code></td>
<td>
<p>Optional vector with the standard errors of the estimated O:E ratios</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>OE.cilb</code></td>
<td>
<p>Optional vector to specify the lower limits of the confidence interval for <code>OE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>OE.ciub</code></td>
<td>
<p>Optional vector to specify the upper limits of the confidence interval for <code>OE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>OE.cilv</code></td>
<td>
<p>Optional vector to specify the levels of aformentioned confidence interval limits. 
(default: 0.95, which corresponds to the 95% confidence interval).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>citl</code></td>
<td>
<p>Optional vector with the estimated calibration-in-the-large for each valiation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>citl.se</code></td>
<td>
<p>Optional vector with the standard error of the estimated calibration-in-the-large statistics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Optional vector with the total number of participants for each valiation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>O</code></td>
<td>
<p>Optional vector with the total number of observed events for each valiation
(if specified, during time <code>t.val</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E</code></td>
<td>
<p>Optional vector with the total number of expected events for each valiation 
(if specified, during time <code>t.val</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Po</code></td>
<td>
<p>Optional vector with the (cumulative) observed event probability for each valiation
(if specified, during time <code>t.val</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Po.se</code></td>
<td>
<p>Optional vector with the standard errors of <code>Po</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pe</code></td>
<td>
<p>Optional vector with the (cumulative) expected event probability for each validation
(if specified, during time <code>t.val</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>optional data frame containing the variables given to the arguments above.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Character string specifying whether a fixed- or a random-effects model should be fitted. 
A fixed-effects model is fitted when using <code>method="FE"</code>. Random-effects models are fitted by setting method 
equal to one of the following: <code>"REML"</code> (Default), <code>"DL"</code>, <code>"HE"</code>, <code>"SJ"</code>, <code>"ML"</code>, 
<code>"EB"</code>, <code>"HS"</code>, <code>"GENQ"</code> or <code>"BAYES"</code>. See 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>Optional character string specifying how test statistics and confidence intervals for the fixed effects 
should be computed. By default (<code>test="knha"</code>), the method by Knapp and Hartung (2003) is used for 
adjusting test statistics and confidence intervals. Type '<code>?rma</code>' for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If TRUE then messages generated during the fitting process will be displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slab</code></td>
<td>
<p>Optional vector specifying the label for each study</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.chains</code></td>
<td>
<p>Optional numeric specifying the number of chains to use in the Gibbs sampler 
(if <code>method="BAYES"</code>). More chains will improve the sensitivity of the convergence diagnostic, but will 
cause the simulation to run more slowly. The default number of chains is 4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pars</code></td>
<td>
<p>A list with additional arguments.  See 'Details' for more information. The following parameters configure the MCMC sampling procedure:
<code>hp.mu.mean</code> (mean of the prior distribution of the random effects model, defaults to 0), 
<code>hp.mu.var</code> (variance of the prior distribution of the random effects model, defaults to 1000), 
<code>hp.tau.min</code> (minimum value for the between-study standard deviation, defaults to 0), 
<code>hp.tau.max</code> (maximum value for the between-study standard deviation, defaults to 2), 
<code>hp.tau.sigma</code> (standard deviation of the prior distribution for the between-study standard-deviation), 
<code>hp.tau.dist</code> (prior distribution for the between-study standard-deviation. Defaults to <code>"dunif"</code>), 
<code>hp.tau.df</code> (degrees of freedom for the prior distribution for the between-study standard-deviation. 
Defaults to 3). Other arguments are <code>method.restore.c.se</code> (method for restoring missing estimates for the standard error 
of the c-statistic. See <code>ccalc</code> for more information), 
<code>model.cstat</code> (The likelihood/link for modeling the c-statistic; see "Details"), 
<code>model.oe</code> (The likelihood/link for modeling the O:E ratio; see "Details"),
<code>seed</code> (an integer to indicate the random seed).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments that are passed to <span class="pkg">rma</span> or <span class="pkg">runjags</span> (if <code>method="BAYES"</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>



<h4>Meta-analysis of the concordance statistic</h4>

<p>A summary estimate for the concorcance (c-) statistic can be obtained by specifying <code>measure="cstat"</code>.
The c-statistic is a measure of discrimination, and indicates the ability of a prediction model to 
distinguish between patients developing and not developing the outcome. The c-statistic typically ranges 
from 0.5 (no discriminative ability) to 1 (perfect discriminative ability). When missing, the c-statistic 
and/or its standard error are derived from other reported information. 
See <code>ccalc</code> for more information.
</p>
<p>By default, it is assumed that the logit of the c-statistic is Normally distributed within and across studies
(<code>pars$model.cstat = "normal/logit"</code>). Alternatively, it is possible to assume that the raw c-statistic 
is Normally distributed across studies <code>pars$model.cstat = "normal/identity"</code>. 
</p>
 


<h4>Meta-analysis of the total observed versus expected ratio</h4>

<p>A summary estimate for the total observed versus expected (O:E) ratio can be 
obtained by specifying <code>measure="OE"</code>. The total O:E ratio provides a 
rough indication of the overall model calibration (across the entire range 
of predicted risks). When missing, the total O:E ratio and/or its standard 
error are derived from other reported information. See <code>oecalc</code> 
for more information.
</p>
<p>For frequentist meta-analysis, within-study variation can either be modeled 
using a Normal (<code>model.oe = "normal/log"</code> or 
<code>model.oe = "normal/identity"</code>) or a Poisson distribution 
(<code>model.oe = "poisson/log"</code>). 
</p>
<p>When performing a Bayesian meta-analysis, all data are modeled using a 
one-stage random effects (hierarchical related regression) model.
In particular, a binomial distribution (if <code>O</code>, <code>E</code> and 
<code>N</code> is known), a Poisson distribution (if only <code>O</code> and 
<code>E</code> are known) or a Normal distribution (if <code>OE</code> and 
<code>OE.se</code> or <code>OE.95CI</code> are known) is selected separately for 
each study.
</p>



<h4>Bayesian meta-analysis</h4>

<p>All Bayesian meta-analysis models assume the presence of random effects. 
Summary estimates are based on the posterior mean. Credibility and 
prediction intervals are directly obtained from the corresponding posterior 
quantiles.
</p>
<p>The prior distribution for the (transformed) performance estimate is modeled 
using a Normal distribution, with mean <code>hp.mu.mean</code> (defaults to 0) 
and variance <code>hp.mu.var</code> (defaults to 1000). 
For meta-analysis of the total O:E ratio, the maximum value for 
<code>hp.mu.var</code> is 100.
</p>
<p>By default, the prior distribution for the between-study standard deviation 
is modeled using a uniform distribution (<code>hp.tau.dist="dunif"</code>), 
with boundaries <code>hp.tau.min</code> and <code>hp.tau.max</code>. Alternative choices 
are a truncated Student-t distribution (<code>hp.tau.dist="dhalft"</code>) with a 
mean of <code>hp.tau.mean</code>, a standard deviation of <code>hp.tau.sigma</code> and 
<code>hp.tau.df</code> degrees of freedom. This distribution is again restricted 
to the range <code>hp.tau.min</code> to <code>hp.tau.max</code>.
</p>



<h3>Value</h3>

<p>An object of class <code>valmeta</code> with the following elements:
</p>

<dl>
<dt>"data"</dt>
<dd>
<p>array with (transformed) data used for meta-analysis, 
and method(s) used for restoring missing information. </p>
</dd>
<dt>"measure"</dt>
<dd>
<p>character string specifying the performance measure that 
has been meta-analysed.</p>
</dd>
<dt>"method"</dt>
<dd>
<p>character string specifying the meta-analysis method.</p>
</dd>
<dt>"model"</dt>
<dd>
<p>character string specifying the meta-analysis model 
(link function).</p>
</dd>
<dt>"est"</dt>
<dd>
<p>summary estimate for the performance statistic. For Bayesian 
meta-analysis, the posterior median is returned.</p>
</dd>
<dt>"ci.lb"</dt>
<dd>
<p>lower bound of the confidence (or credibility) interval of 
the summary performance estimate.</p>
</dd>
<dt>"ci.ub"</dt>
<dd>
<p>upper bound of the confidence (or credibility) interval of 
the summary performance estimate.</p>
</dd>
<dt>"pi.lb"</dt>
<dd>
<p>lower bound of the (approximate) prediction interval of the 
summary performance estimate.</p>
</dd>
<dt>"pi.ub"</dt>
<dd>
<p>upper bound of the (approximate) prediction interval of the 
summary performance estimate.</p>
</dd>
<dt>"fit"</dt>
<dd>
<p>the full results from the fitted model. </p>
</dd>
<dt>"slab"</dt>
<dd>
<p>vector specifying the label of each study.</p>
</dd>
</dl>
<h3>Note</h3>

<p>The width of calculated confidence, credibility and prediction 
intervals can be specified using <code>level</code> in the <code>pars</code> argument 
(defaults to 0.95).
</p>


<h3>References</h3>

<p>Debray TPA, Damen JAAG, Snell KIE, Ensor J, Hooft L, Reitsma JB, et al. 
A guide to systematic review and meta-analysis of prediction model 
performance. <em>BMJ</em>. 2017;<b>356</b>:i6460. <a href="https://doi.org/10.1136/bmj.i6460">doi:10.1136/bmj.i6460</a>
</p>
<p>Debray TPA, Damen JAAG, Riley R, Snell KIE, Reitsma JB, Hooft L, et al. 
A framework for meta-analysis of prediction model studies with binary and 
time-to-event outcomes. <em>Stat Methods Med Res</em>. 2019;<b>28</b>:2768–86. 
<a href="https://doi.org/10.1177/0962280218785504">doi:10.1177/0962280218785504</a>
</p>
<p>Riley RD, Tierney JF, Stewart LA. Individual participant data meta-analysis: 
a handbook for healthcare research. Hoboken, NJ: Wiley; 2021. 
ISBN: 978-1-119-33372-2.
</p>
<p>Steyerberg EW, Nieboer D, Debray TPA, van Houwelingen HC. Assessment of 
heterogeneity in an individual participant data meta-analysis of prediction 
models: An overview and illustration. <em>Stat Med</em>. 2019;
<b>38</b>:4290–309. <a href="https://doi.org/10.1002/sim.8296">doi:10.1002/sim.8296</a>
</p>
<p>Viechtbauer W. Conducting Meta-Analyses in R with the metafor Package. 
<em>Journal of Statistical Software</em>. 2010; <b>36</b>. 
<a href="https://doi.org/10.18637/jss.v036.i03">doi:10.18637/jss.v036.i03</a>
</p>


<h3>See Also</h3>

<p><code>ccalc</code> to calculate concordance statistics 
and corresponding standard errors, <code>oecalc</code> to calculate the 
total O:E ratio and corresponding standard errors, 
<code>plot.valmeta</code> to generate forest plots
</p>


<h3>Examples</h3>

<pre><code class="language-R">######### Validation of prediction models with a binary outcome #########
data(EuroSCORE)

# Meta-analysis of the c-statistic (random effects)
fit &lt;- valmeta(cstat=c.index, cstat.se=se.c.index, cstat.cilb=c.index.95CIl, 
               cstat.ciub=c.index.95CIu, cstat.cilv=0.95, N=n, O=n.events, 
               slab=Study, data=EuroSCORE)
plot(fit)

# Nearly identical results when we need to estimate the SE
valmeta(cstat=c.index,  N=n, O=n.events, slab=Study, data=EuroSCORE)

# Two-stage meta-analysis of the total O:E ratio (random effects)
valmeta(measure="OE", O=n.events, E=e.events, N=n, slab=Study, data=EuroSCORE)    
valmeta(measure="OE", O=n.events, E=e.events, data=EuroSCORE)       
valmeta(measure="OE", Po=Po, Pe=Pe, N=n, data=EuroSCORE)

## Not run: 
# One-stage meta-analysis of the total O:E ratio (random effects)
valmeta(measure="OE", O=n.events, E=e.events, data=EuroSCORE, method="ML", 
        pars=list(model.oe="poisson/log"))

# Bayesian random effects meta-analysis of the c-statistic
fit2 &lt;- valmeta(cstat=c.index, cstat.se=se.c.index, cstat.cilb=c.index.95CIl,
                cstat.ciub=c.index.95CIu, cstat.cilv=0.95, N=n, O=n.events, 
                data=EuroSCORE, method="BAYES", slab=Study)

# Bayesian one-stage random effects meta-analysis of the total O:E ratio
# Consider that some (but not all) studies do not provide information on N
# A Poisson distribution will be used for studies 1, 2, 5, 10 and 20
# A Binomial distribution will be used for the remaining studies
EuroSCORE.new &lt;- EuroSCORE
EuroSCORE.new$n[c(1, 2, 5, 10, 20)] &lt;-  NA
pars &lt;- list(hp.tau.dist="dhalft",   # Prior for the between-study standard deviation
             hp.tau.sigma=1.5,       # Standard deviation for 'hp.tau.dist'
             hp.tau.df=3,            # Degrees of freedom for 'hp.tau.dist'
             hp.tau.max=10,          # Maximum value for the between-study standard deviation
             seed=5)                 # Set random seed for the simulations
fit3 &lt;- valmeta(measure="OE", O=n.events, E=e.events, N=n, data=EuroSCORE.new,
        method="BAYES", slab=Study, pars=pars)
plot(fit3)
print(fit3$fit$model) # Inspect the JAGS model
print(fit3$fit$data)  # Inspect the JAGS data

## End(Not run) 

######### Validation of prediction models with a time-to-event outcome #########
data(Framingham)

# Meta-analysis of total O:E ratio after 10 years of follow-up
valmeta(measure="OE", Po=Po, Pe=Pe, N=n, data=Framingham)

</code></pre>


</div>