<div class="container">

<table style="width: 100%;"><tr>
<td>data_simula</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate genotype and genotype-environment data</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt="[Experimental]"></a>
</p>

<ul>
<li> <p><code>g_simula()</code> simulate replicated genotype data.
</p>
</li>
<li> <p><code>ge_simula()</code> simulate replicated genotype-environment data.
</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">ge_simula(
  ngen,
  nenv,
  nrep,
  nvars = 1,
  gen_eff = 20,
  env_eff = 15,
  rep_eff = 5,
  ge_eff = 10,
  res_eff = 5,
  intercept = 100,
  seed = NULL
)

g_simula(
  ngen,
  nrep,
  nvars = 1,
  gen_eff = 20,
  rep_eff = 5,
  res_eff = 5,
  intercept = 100,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ngen</code></td>
<td>
<p>The number of genotypes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nenv</code></td>
<td>
<p>The number of environments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrep</code></td>
<td>
<p>The number of replications.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nvars</code></td>
<td>
<p>The number of traits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gen_eff</code></td>
<td>
<p>The genotype effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>env_eff</code></td>
<td>
<p>The environment effect</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rep_eff</code></td>
<td>
<p>The replication effect</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ge_eff</code></td>
<td>
<p>The genotype-environment interaction effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res_eff</code></td>
<td>
<p>The residual effect. The effect is sampled from a normal
distribution with zero mean and standard deviation equal to <code>res_eff</code>.
Be sure to change <code>res_eff</code> when changin the <code>intercept</code> scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>The intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>The seed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The functions simulate genotype or genotype-environment data given a
desired number of genotypes, environments and effects. All effects are
sampled from an uniform distribution. For example, given 10 genotypes, and
<code>gen_eff = 30</code>, the genotype effects will be sampled as <code>runif(10, min = -30, max = 30)</code>. Use the argument <code>seed</code> to ensure reproducibility. If more
than one trait is used (<code>nvars &gt; 1</code>), the effects and seed can be passed as
a numeric vector. Single numeric values will be recycled with a warning
when more than one trait is used.
</p>


<h3>Value</h3>

<p>A data frame with the simulated traits
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(metan)
# Genotype data (5 genotypes and 3 replicates)
gen_data &lt;-
   g_simula(ngen = 5,
            nrep = 3,
            seed = 1)
gen_data
inspect(gen_data, plot = TRUE)

aov(V1 ~ GEN + REP, data = gen_data) %&gt;% anova()

# Genotype-environment data
# 5 genotypes, 3 environments, 4 replicates and 2 traits
df &lt;-
ge_simula(ngen = 5,
          nenv = 3,
          nrep = 4,
          nvars = 2,
          seed = 1)
ge_plot(df, ENV, GEN, V1)
aov(V1 ~ ENV*GEN + ENV/REP, data = df) %&gt;% anova()

# Change genotype effect (trait 1 with fewer differences among genotypes)
# Define different intercepts for the two traits
df2 &lt;-
ge_simula(ngen = 10,
          nenv = 3,
          nrep = 4,
          nvars = 2,
          gen_eff = c(1, 50),
          intercept = c(80, 1500),
          seed = 1)
ge_plot(df2, ENV, GEN, V2)

</code></pre>


</div>