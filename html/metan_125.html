<div class="container">

<table style="width: 100%;"><tr>
<td>gtb</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Genotype by trait biplot</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt="[Stable]"></a>
</p>
<p>Produces a genotype-by-trait biplot model. From a genotype by environment by
trait three-way table, genotype-by-trait tables in any single environment,
across all environments, or across a subset of the environments can be
generated and visually studied using biplots. The model for biplot analysis
of genotype by trait data is the singular value decomposition of
trait-standardized two-way table.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gtb(.data, gen, resp, centering = "trait", scaling = "sd", svp = "trait")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.data</code></td>
<td>
<p>The dataset containing the columns related to Genotypes and the
response variable(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resp</code></td>
<td>
<p>The response variables, i.e., <code>resp = c(var1, var2, var3)</code>.
Select helpers can also be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centering</code></td>
<td>
<p>The centering method. Must be one of the <code>'none | 0'</code>,
for no centering; <code>'global | 1'</code>, for global centered (T+G+GT);
<code>'trait | 2'</code> (default), for trait-centered (G+GT); or <code>'double | 3'</code>, for double centred (GT). A biplot cannot be produced with models
produced without centering.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaling</code></td>
<td>
<p>The scaling method. Must be one of the <code>'none | 0'</code>, for
no scaling; or <code>'sd | 1'</code> (default), where each value is divided by
the standard deviation of its corresponding trait (column). This will put
all traits roughly he same rang of values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>svp</code></td>
<td>
<p>The method for singular value partitioning. Must be one of the
<code>'genotype | 1'</code>, (The singular value is entirely partitioned into the
genotype eigenvectors, also called row metric preserving); <code>'trait | 2'</code>, default, (The singular value is entirely partitioned into the trait
eigenvectors, also called column metric preserving); or <code>'symmetrical | 3'</code> (The singular value is symmetrically partitioned into the genotype
and the trait eigenvectors This SVP is most often used in AMMI analysis and
other biplot analysis, but it is not ideal for visualizing either the
relationship among genotypes or that among the traits).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function returns a list of class <code>gge</code> that is compatible with the function <code>plot()</code> used in <code>gge()</code>.
</p>

<ul>
<li> <p><strong>coordgen</strong> The coordinates for genotypes for all components.
</p>
</li>
<li> <p><strong>coordenv</strong> The coordinates for traits for all components.
</p>
</li>
<li> <p><strong>eigenvalues</strong> The vector of eigenvalues.
</p>
</li>
<li> <p><strong>totalvar</strong> The overall variance.
</p>
</li>
<li> <p><strong>labelgen</strong> The name of the genotypes.
</p>
</li>
<li> <p><strong>labelenv</strong> The names of the traits.
</p>
</li>
<li> <p><strong>labelaxes</strong> The axes labels.
</p>
</li>
<li> <p><strong>gt_mat</strong> The data used to produce the model (scaled and centered).
</p>
</li>
<li> <p><strong>centering</strong> The centering method.
</p>
</li>
<li> <p><strong>scaling</strong> The scaling method.
</p>
</li>
<li> <p><strong>svp</strong> The singular value partitioning method.
</p>
</li>
<li> <p><strong>d</strong> The factor used to generate in which the ranges of genotypes
and traits are comparable when singular value partitioning is set to
'genotype' or 'trait'.
</p>
</li>
<li> <p><strong>grand_mean</strong> The grand mean of the trial.
</p>
</li>
<li> <p><strong>mean_gen</strong> A vector with the means of the genotypes.
</p>
</li>
<li> <p><strong>mean_env</strong> A vector with the means of the traits.
</p>
</li>
<li> <p><strong>scale_var</strong> The scaling vector when the scaling method is <code>'sd'</code>.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Yan, W., and M.S. Kang. 2003. GGE biplot analysis: a graphical tool for breeders,
geneticists, and agronomists. CRC Press.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(metan)
# GT biplot for all numeric variables
mod &lt;- gtb(data_ge2, GEN, resp = contains("E"))
plot(mod)


</code></pre>


</div>