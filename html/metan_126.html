<div class="container">

<table style="width: 100%;"><tr>
<td>gytb</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Genotype by yield*trait biplot</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt="[Stable]"></a>
</p>
<p>Produces a Genotype by Yield*Trait biplot (GTY) proposed by Yan and
Fregeau-Reid (2018).
</p>


<h3>Usage</h3>

<pre><code class="language-R">gytb(
  .data,
  gen,
  yield,
  traits = everything(),
  ideotype = NULL,
  weight = NULL,
  prefix = "Y",
  centering = "trait",
  scaling = "sd",
  svp = "trait"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.data</code></td>
<td>
<p>The dataset containing the columns related to Genotypes, Yield,
and Traits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yield</code></td>
<td>
<p>The column containing the yield values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>traits</code></td>
<td>
<p>The column(s) with the <em>traits</em> values. Defaults to
<em>NULL</em>. In this case, all numeric traits in <code>.data</code>, except that
in <code>yield</code> are selected. To select specific traits from <code>.data</code>,
use a list of unquoted comma-separated variable names (e.g. <em>traits =
c(var1, var2, var3)</em>), an specific range of variables, (e.g. <em>traits =
c(var1:var3)</em>), or even a select helper like <code>starts_with("N")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ideotype</code></td>
<td>
<p>A vector of <code>"h"</code> or <code>"l"</code> with the same length of
<code>traits</code> to define which trait is desired to increase or decrease. By
default (<code>ideotype = NULL</code>) for all numeric traits in <code>traits</code>
are assumed that high values is desirable. Following the order of the
traits selected in <code>traits</code>, use <code>"h"</code> to indicate the traits in
which higher values are desired or <code>"l"</code> to indicate the variables in
which lower values are desired. Then, <code>yield </code> will be multiplied by
traits with <code>"h"</code> and divided by traits with <code>"l"</code> to generate
the Genotype by yield*trait table. For example, <code>ideotype = c("h, h, l")</code> will assume that the ideotype has higher values for the first two
traits and lower values for the last trait.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>The weight assumed for each trait. Similar to <code>ideotype</code>
argument, provide a numeric vector of the same length of <code>traits</code>.
Suggested values are between 0 and 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prefix</code></td>
<td>
<p>The prefix used in the biplot for the yield*trait combinations.
Defaults to <code>"Y"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centering</code></td>
<td>
<p>The centering method. Must be one of the <code>'none | 0'</code>,
for no centering; <code>'global | 1'</code>, for global centered (T+G+GYT);
<code>'trait | 2'</code> (default), for trait-centered (G+GYT); or <code>'double | 3'</code>, for double centered (GYT). A biplot cannot be produced with models
produced without centering.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaling</code></td>
<td>
<p>The scaling method. Must be one of the <code>'none | 0'</code>, for
no scaling; or <code>'sd | 1'</code> (default), so that the mean for each trait
or yield-trait combination becomes 0 and the variance becomes unit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>svp</code></td>
<td>
<p>The method for singular value partitioning. Must be one of the
<code>'genotype | 1'</code>, (The singular value is entirely partitioned into the
genotype eigenvectors, also called row metric preserving); <code>'trait | 2'</code>, default, (The singular value is entirely partitioned into the trait
eigenvectors, also called column metric preserving); or <code>'symmetrical | 3'</code> (The singular value is symmetrically partitioned into the genotype
and the trait eigenvectors This SVP is most often used in AMMI analysis and
other biplot analysis, but it is not ideal for visualizing either the
relationship among genotypes or that among the traits).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function returns a list of class <code>gge</code> that is compatible with the function <code>plot()</code> used in <code>gge()</code>.
</p>

<ul>
<li> <p><strong>data</strong> The Genotype by yield\*trait (GYT) data.
</p>
</li>
<li> <p><strong>ge_mat</strong> The Genotype by yield\*trait (GYT) data  (scaled and centered).
</p>
</li>
<li> <p><strong>coordgen</strong> The coordinates for genotypes for all components.
</p>
</li>
<li> <p><strong>coordenv</strong> The coordinates for traits for all components.
</p>
</li>
<li> <p><strong>eigenvalues</strong> The vector of eigenvalues.
</p>
</li>
<li> <p><strong>totalvar</strong> The overall variance.
</p>
</li>
<li> <p><strong>labelgen</strong> The name of the genotypes.
</p>
</li>
<li> <p><strong>labelenv</strong> The names of the traits.
</p>
</li>
<li> <p><strong>labelaxes</strong> The axes labels.
</p>
</li>
<li> <p><strong>centering</strong> The centering method.
</p>
</li>
<li> <p><strong>scaling</strong> The scaling method.
</p>
</li>
<li> <p><strong>svp</strong> The singular value partitioning method.
</p>
</li>
<li> <p><strong>d</strong> The factor used to generate in which the ranges of genotypes
and traits are comparable when singular value partitioning is set to
'genotype' or 'trait'.
</p>
</li>
<li> <p><strong>grand_mean</strong> The grand mean of the trial.
</p>
</li>
<li> <p><strong>mean_gen</strong> A vector with the means of the genotypes.
</p>
</li>
<li> <p><strong>mean_env</strong> A vector with the means of the traits.
</p>
</li>
<li> <p><strong>scale_var</strong> The scaling vector when the scaling method is <code>'sd'</code>.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Yan, W., &amp; Fregeau-Reid, J. (2018). Genotype by Yield\*Trait (GYT) Biplot: a
Novel Approach for Genotype Selection based on Multiple Traits. Scientific
Reports, 8(1), 1-10. <a href="https://doi.org/10.1038/s41598-018-26688-8">doi:10.1038/s41598-018-26688-8</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(metan)
# GYT biplot for all numeric traits of 'data_g'
# KW (kernel weight) considered as 'yield',
mod &lt;- gytb(data_g, GEN, KW)
plot(mod)


</code></pre>


</div>