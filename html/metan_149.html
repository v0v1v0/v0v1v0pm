<div class="container">

<table style="width: 100%;"><tr>
<td>mahala_design</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mahalanobis distance from designed experiments</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt="[Stable]"></a>
</p>
<p>Compute the Mahalanobis distance using data from an experiment conducted in a
randomized complete block design or completely randomized design.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mahala_design(
  .data,
  gen,
  rep,
  resp,
  design = "RCBD",
  by = NULL,
  return = "distance"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.data</code></td>
<td>
<p>The dataset containing the columns related to Genotypes,
replication/block and response variables, possible with grouped data passed
from <code>dplyr::group_by()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rep</code></td>
<td>
<p>The name of the column that contains the levels of the
replications/blocks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resp</code></td>
<td>
<p>The response variables. For example <code>resp = c(var1, var2, var3)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>
<p>The experimental design. Must be RCBD or CRD.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by</code></td>
<td>
<p>One variable (factor) to compute the function by. It is a shortcut
to <code>dplyr::group_by()</code>. To compute the statistics by more than
one grouping variable use that function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return</code></td>
<td>
<p>What the function return? Default is 'distance', i.e., the
Mahalanobis distance. Alternatively, it is possible to return the matrix of
means <code>return = 'means'</code>, or the variance-covariance matrix of
residuals <code>return = 'covmat'</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A symmetric matrix with the Mahalanobis' distance. If <code>.data</code> is
a grouped data passed from <code>dplyr::group_by()</code> then the results
will be returned into a list-column of data frames.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(metan)
maha &lt;- mahala_design(data_g,
                      gen = GEN,
                      rep = REP,
                      resp = everything(),
                      return = "covmat")

# Compute one distance for each environment (all numeric variables)
maha_group &lt;- mahala_design(data_ge,
                           gen = GEN,
                           rep = REP,
                           resp = everything(),
                           by = ENV)

# Return the variance-covariance matrix of residuals
cov_mat &lt;- mahala_design(data_ge,
                        gen = GEN,
                        rep = REP,
                        resp = c(GY, HM),
                        return = 'covmat')

</code></pre>


</div>