<div class="container">

<table style="width: 100%;"><tr>
<td>mantel_test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mantel test
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt="[Stable]"></a>
</p>
<p>Performs a Mantel test between two correlation/distance matrices. The
function calculates the correlation between two matrices, the Z-score that is
is the sum of the products of the corresponding elements of the matrices and
a two-tailed p-value (null hypothesis: \[r = 0\]).
</p>


<h3>Usage</h3>

<pre><code class="language-R">mantel_test(mat1, mat2, nboot = 1000, plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mat1, mat2</code></td>
<td>
<p>A correlation matrix or an object of class <code>dist</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot</code></td>
<td>
<p>The number of permutations to be used. Defaults to <code>1000</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>if <code>plot = TRUE</code>, plots the density estimate of the
permutation distribution along with the observed Z-score as a vertical
line.</p>
</td>
</tr>
</table>
<h3>Value</h3>


<ul>
<li> <p><code>mantel_r</code> The correlation between the two matrices.
</p>
</li>
<li> <p><code>z_score</code> The Z-score.
</p>
</li>
<li> <p><code>p-value</code> The quantile of the observed Z-score. in the permutation
distribution.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code>pairs_mantel()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(metan)
# Test if the correlation of traits (data_ge2 dataset)
# changes between A1 and A2 levels of factor ENV
A1 &lt;- corr_coef(data_ge2 %&gt;% subset(ENV == "A1"))[["cor"]]
A2 &lt;- corr_coef(data_ge2 %&gt;% subset(ENV == "A2"))[["cor"]]
mantel_test(A1, A2, plot = TRUE)


</code></pre>


</div>