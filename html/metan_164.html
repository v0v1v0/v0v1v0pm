<div class="container">

<table style="width: 100%;"><tr>
<td>mps</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mean performance and stability in multi-environment trials</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt="[Experimental]"></a>
</p>
<p>This function implements the weighting method between mean performance and
stability (Olivoto et al., 2019) considering different parametric and
non-parametric stability indexes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mps(
  .data,
  env,
  gen,
  rep,
  resp,
  block = NULL,
  by = NULL,
  random = "gen",
  performance = c("blupg", "blueg"),
  stability = "waasb",
  ideotype_mper = NULL,
  ideotype_stab = NULL,
  wmper = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.data</code></td>
<td>
<p>The dataset containing the columns related to Environments,
Genotypes, replication/block and response variable(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>env</code></td>
<td>
<p>The name of the column that contains the levels of the
environments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rep</code></td>
<td>
<p>The name of the column that contains the levels of the
replications/blocks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resp</code></td>
<td>
<p>The response variable(s). To analyze multiple variables in a
single procedure a vector of variables may be used. For example <code>resp = c(var1, var2, var3)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>block</code></td>
<td>
<p>Defaults to <code>NULL</code>. In this case, a randomized complete
block design is considered. If block is informed, then an alpha-lattice
design is employed considering block as random to make use of inter-block
information, whereas the complete replicate effect is always taken as
fixed, as no inter-replicate information was to be recovered (Mohring et
al., 2015).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by</code></td>
<td>
<p>One variable (factor) to compute the function by. It is a shortcut
to <code>dplyr::group_by()</code>.This is especially useful, for example, when the
researcher want to analyze environments within mega-environments. In this
case, an object of class mps_grouped is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random</code></td>
<td>
<p>The effects of the model assumed to be random. Defaults to
<code>random = "gen"</code>. See <code>gamem_met()</code> to see the random effects assumed
depending on the experimental design of the trials.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>performance</code></td>
<td>
<p>Wich considers as mean performance. Either <code>blupg</code> (for
Best Linear Unbiased Prediction) or <code>blueg</code> (for Best Linear Unbiased
Estimation)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stability</code></td>
<td>
<p>The stability method. One of the following:
</p>

<ul>
<li> <p><code>"waasb"</code> The weighted average of absolute scores (Olivoto et al. 2019).
</p>
</li>
<li> <p><code>"ecovalence"</code> The Wricke's ecovalence (Wricke, 1965).
</p>
</li>
<li> <p><code>"Shukla"</code> The Shukla's stability variance parameter (Shukla, 1972).
</p>
</li>
<li> <p><code>"hmgv"</code> The harmonic mean of genotypic values (Resende, 2007).
</p>
</li>
<li> <p><code>"s2di"</code> The deviations from the Eberhart and Russell regression (Eberhart
and Russell, 1966).
</p>
</li>
<li> <p><code>"r2"</code> The determination coefficient of the Eberhart and Russell regression
(Eberhart and Russell, 1966)..
</p>
</li>
<li> <p><code>"rmse"</code> The root mean squared error of the Eberhart and Russell regression
(Eberhart and Russell, 1966).
</p>
</li>
<li> <p><code>"wi"</code> Annicchiarico's genotypic confidence index (Annicchiarico, 1992).
</p>
</li>
<li> <p><code>"polar"</code> Power Law Residuals as yield stability index (Doring et al.,
2015).
</p>
</li>
<li> <p><code>"acv"</code> Adjusted Coefficient of Variation (Doring and Reckling, 2018)
</p>
</li>
<li> <p><code>"pi"</code> Lin e Binns' superiority index (Lin and Binns, 1988).
</p>
</li>
<li> <p><code>"gai"</code> Geometric adaptability index (Mohammadi and Amri, 2008).
</p>
</li>
<li> <p><code style="white-space: pre;">⁠"s1", "s2", "s3", and "s6"⁠</code> Huehn's stability statistics (Huehn, 1979).
</p>
</li>
<li> <p><code style="white-space: pre;">⁠"n1", "n2", "n3", and "n4"⁠</code> Thennarasu's stability statistics (Thennarasu,
1995).
</p>
</li>
<li> <p><code style="white-space: pre;">⁠"asv", "ev", "za", and "waas"⁠</code> AMMI-based stability indexes (see
<code>ammi_indexes()</code>).
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ideotype_mper, ideotype_stab</code></td>
<td>
<p>The new maximum value after rescaling the
response variable/stability index. By default, all variables in <code>resp</code> are
rescaled so that de maximum value is 100 and the minimum value is 0 (i.e.,
<code>ideotype_mper = NULL</code> and <code>ideotype_stab = NULL</code>). It must be a character
vector of the same length of <code>resp</code> if rescaling is assumed to be different
across variables, e.g., if for the first variable smaller values are better
and for the second one, higher values are better, then <code>ideotype_mper = c("l, h")</code> must be used. For stability index in which lower values are
better, use <code>ideotype_stab = "l"</code>. Character value of length 1 will be
recycled with a warning message.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wmper</code></td>
<td>
<p>The weight for the mean performance. By default, all variables
in <code>resp</code> have equal weights for mean performance and stability (i.e.,
<code>wmper = 50</code>). It must be a numeric vector of the same length of <code>resp</code> to
assign different weights across variables, e.g., if for the first variable
equal weights for mean performance and stability are assumed and for the
second one, a higher weight for mean performance (e.g. 65) is assumed, then
<code>wmper = c(50, 65)</code> must be used. Numeric value of length 1 will be
recycled with a warning message.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical argument. If <code>verbose = FALSE</code> the code will run
silently.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>mps</code> with the following items.
</p>

<ul>
<li> <p><code>observed</code>: The observed value on a genotype-mean basis.
</p>
</li>
<li> <p><code>performance</code>: The performance for genotypes (BLUPs or BLUEs)
</p>
</li>
<li> <p><code>performance_res</code>: The rescaled values of genotype's performance,
considering <code>ideotype_mper</code>.
</p>
</li>
<li> <p><code>stability</code>: The stability for genotypes, chosen with argument <code>stability</code>.
</p>
</li>
<li> <p><code>stability_res</code>: The rescaled values of genotype's stability, considering
<code>ideotype_stab</code>.
</p>
</li>
<li> <p><code>mps_ind</code>: The mean performance and stability for the traits.
</p>
</li>
<li> <p><code>h2</code>: The broad-sense heritability for the traits.
</p>
</li>
<li> <p><code>perf_method</code>: The method for measuring genotype's performance.
</p>
</li>
<li> <p><code>wmper</code>: The weight for the mean performance.
</p>
</li>
<li> <p><code>sense_mper</code>: The goal for genotype's performance (<code>l</code> = lower, <code>h</code> = higher).
</p>
</li>
<li> <p><code>stab_method</code>: The method for measuring genotype's stability.
</p>
</li>
<li> <p><code>wstab</code>: The weight for the mean stability.
</p>
</li>
<li> <p><code>sense_stab</code>: The goal for genotype's stability (<code>l</code> = lower, <code>h</code> = higher).
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Annicchiarico, P. 1992. Cultivar adaptation and recommendation from alfalfa
trials in Northern Italy. J. Genet. Breed. 46:269-278.
</p>
<p>Doring, T.F., S. Knapp, and J.E. Cohen. 2015. Taylor's power law and the
stability of crop yields. F. Crop. Res. 183: 294-302.
<a href="https://doi.org/10.1016/j.fcr.2015.08.005">doi:10.1016/j.fcr.2015.08.005</a>
</p>
<p>Doring, T.F., and M. Reckling. 2018. Detecting global trends of cereal yield
stability by adjusting the coefficient of variation. Eur. J. Agron. 99:
30-36. <a href="https://doi.org/10.1016/j.eja.2018.06.007">doi:10.1016/j.eja.2018.06.007</a>
</p>
<p>Eberhart, S.A., and W.A. Russell. 1966. Stability parameters for comparing Varieties.
Crop Sci. 6:36-40. <a href="https://doi.org/10.2135/cropsci1966.0011183X000600010011x">doi:10.2135/cropsci1966.0011183X000600010011x</a>
</p>
<p>Huehn, V.M. 1979. Beitrage zur erfassung der phanotypischen stabilitat. EDV
Med. Biol. 10:112.
</p>
<p>Lin, C.S., and M.R. Binns. 1988. A superiority measure of cultivar
performance for cultivar x location data. Can. J. Plant Sci. 68:193-198.
<a href="https://doi.org/10.4141/cjps88-018">doi:10.4141/cjps88-018</a>
</p>
<p>Mohammadi, R., &amp; Amri, A. (2008). Comparison of parametric and non-parametric
methods for selecting stable and adapted durum wheat genotypes in variable
environments. Euphytica, 159(3), 419-432. <a href="https://doi.org/10.1007/s10681-007-9600-6">doi:10.1007/s10681-007-9600-6</a>
</p>
<p>Olivoto, T., A.D.C. L\'ucio, J.A.G. da silva, V.S. Marchioro, V.Q. de
Souza, and E. Jost. 2019. Mean performance and stability in multi-environment
trials I: Combining features of AMMI and BLUP techniques. Agron. J.
<a href="https://doi.org/10.2134/agronj2019.03.0220">doi:10.2134/agronj2019.03.0220</a>
</p>
<p>Resende MDV (2007) Matematica e estatistica na analise de experimentos e no
melhoramento genetico. Embrapa Florestas, Colombo
</p>
<p>Shukla, G.K. 1972. Some statistical aspects of partitioning
genotype-environmental components of variability. Heredity. 29:238-245.
<a href="https://doi.org/10.1038/hdy.1972.87">doi:10.1038/hdy.1972.87</a>
</p>
<p>Thennarasu, K. 1995. On certain nonparametric procedures for studying
genotype x environment interactions and yield stability. Ph.D. thesis. P.J.
School, IARI, New Delhi, India.
</p>
<p>Wricke, G. 1965. Zur berechnung der okovalenz bei sommerweizen und hafer. Z.
Pflanzenzuchtg 52:127-138.
</p>


<h3>See Also</h3>

<p><code>mtsi()</code>, <code>mtmps()</code>, <code>mgidi()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(metan)
# The same approach as mtsi()
# mean performance and stability for GY and HM
# mean performance: The genotype's BLUP
# stability: the WAASB index (lower is better)
# weights: equal for mean performance and stability

model &lt;-
mps(data_ge,
    env = ENV,
    gen = GEN,
    rep = REP,
    resp = everything())

# The mean performance and stability after rescaling
model$mps_ind

</code></pre>


</div>