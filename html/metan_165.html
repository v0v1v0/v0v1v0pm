<div class="container">

<table style="width: 100%;"><tr>
<td>mtmps</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multi-trait mean performance and stability index</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt="[Experimental]"></a>
</p>
<p>Computes the multi-trait stability index proposed by Olivoto et al. (2019)
considering different parametric and non-parametric stability indexes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mtmps(model, SI = 15, mineval = 1, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>An object of class <code>mtmps</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SI</code></td>
<td>
<p>An integer (0-100). The selection intensity in percentage of the
total number of genotypes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mineval</code></td>
<td>
<p>The minimum value so that an eigenvector is retained in the
factor analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If <code>verbose = TRUE</code> (Default), some results are shown in the
console.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>mtmps</code> with the following items:
</p>

<ul>
<li> <p><strong>data</strong> The data used to compute the factor analysis.
</p>
</li>
<li> <p><strong>cormat</strong> The correlation matrix among the environments.
</p>
</li>
<li> <p><strong>PCA</strong> The eigenvalues and explained variance.
</p>
</li>
<li> <p><strong>FA</strong> The factor analysis.
</p>
</li>
<li> <p><strong>KMO</strong> The result for the Kaiser-Meyer-Olkin test.
</p>
</li>
<li> <p><strong>MSA</strong> The measure of sampling adequacy for individual variable.
</p>
</li>
<li> <p><strong>communalities</strong> The communalities.
</p>
</li>
<li> <p><strong>communalities_mean</strong> The communalities' mean.
</p>
</li>
<li> <p><strong>initial_loadings</strong> The initial loadings.
</p>
</li>
<li> <p><strong>finish_loadings</strong> The final loadings after varimax rotation.
</p>
</li>
<li> <p><strong>canonical_loadings</strong> The canonical loadings.
</p>
</li>
<li> <p><strong>scores_gen</strong> The scores for genotypes in all retained factors.
</p>
</li>
<li> <p><strong>scores_ide</strong> The scores for the ideotype in all retained factors.
</p>
</li>
<li> <p><strong>MTSI</strong> The multi-trait mean performance and stability index.
</p>
</li>
<li> <p><strong>contri_fac</strong> The relative contribution of each factor on the MTSI
value. The lower the contribution of a factor, the close of the ideotype the
variables in such factor are.
</p>
</li>
<li> <p><strong>contri_fac_rank, contri_fac_rank_sel</strong> The rank for the contribution
of each factor for all genotypes and selected genotypes, respectively.
</p>
</li>
<li> <p><strong>sel_dif_trait, sel_dif_stab, sel_dif_mps</strong> A data frame containing the
selection differential (gains) for the mean performance, stability index, and
mean performance and stability index, respectively. The following variables
are shown.
</p>

<ul>
<li> <p><code>VAR</code>: the trait's name.
</p>
</li>
<li> <p><code>Factor</code>: The factor that traits where grouped into.
</p>
</li>
<li> <p><code>Xo</code>: The original population mean.
</p>
</li>
<li> <p><code>Xs</code>: The mean of selected genotypes.
</p>
</li>
<li> <p><code>SD</code> and <code>SDperc</code>: The selection differential and selection differential in
percentage, respectively.
</p>
</li>
<li> <p><code>h2</code>: The broad-sense heritability.
</p>
</li>
<li> <p><code>SG</code> and <code>SGperc</code>: The selection gains and selection gains in percentage,
respectively.
</p>
</li>
<li> <p><code>sense</code>: The desired selection sense.
</p>
</li>
<li> <p><code>goal</code>: selection gains match desired sense? 100 for yes and 0 for no.
</p>
</li>
</ul>
</li>
<li> <p><strong>stat_dif_trait, stat_dif_stab, stat_dif_mps</strong> A data frame with the
descriptive statistic for the selection gains for the mean performance,
stability index, and mean performance and stability index, respectively. The
following columns are shown by sense.
</p>

<ul>
<li> <p><code>sense</code>: The desired selection sense.
</p>
</li>
<li> <p><code>variable</code>: the trait's name.
</p>
</li>
<li> <p><code>min</code>: the minimum value for the selection gain.
</p>
</li>
<li> <p><code>mean</code>: the mean value for the selection gain.
</p>
</li>
<li> <p><code>ci</code>: the confidence interval for the selection gain.
</p>
</li>
<li> <p><code>sd.amo</code>: the standard deviation for the selection gain.
</p>
</li>
<li> <p><code>max</code>: the maximum value for the selection gain.
</p>
</li>
<li> <p><code>sum</code>: the sum of the selection gain.
</p>
</li>
</ul>
</li>
<li> <p><strong>sel_gen</strong> The selected genotypes.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Olivoto, T., A.D.C. L\'ucio, J.A.G. da silva, B.G. Sari, and
M.I. Diel. 2019. Mean performance and stability in multi-environment trials
II: Selection based on multiple traits. Agron. J. 111:2961-2969.
<a href="https://doi.org/10.2134/agronj2019.03.0220">doi:10.2134/agronj2019.03.0220</a>
</p>


<h3>See Also</h3>

<p><code>mgidi()</code>, <code>mps()</code>, <code>get_model_data()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(metan)
# The same approach as mtsi()
# mean performance and stability for GY and HM
# mean performance: The genotype's BLUP
# stability: the WAASB index (lower is better)
# weights: equal for mean performance and stability

model &lt;-
mps(data_ge,
    env = ENV,
    gen = GEN,
    rep = REP,
    resp = everything())
selection &lt;- mtmps(model)

# gains for stability
selection$sel_dif_stab

# gains for mean performance
selection$sel_dif_trait

</code></pre>


</div>