<div class="container">

<table style="width: 100%;"><tr>
<td>mtsi</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multi-trait stability index</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt="[Stable]"></a>
</p>
<p>Computes the multi-trait stability index proposed by Olivoto et al. (2019)
</p>


<h3>Usage</h3>

<pre><code class="language-R">mtsi(
  .data,
  index = "waasby",
  ideotype = NULL,
  SI = 15,
  mineval = 1,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.data</code></td>
<td>
<p>An object of class <code>waasb</code> or <code>waas</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p>If <code>index = 'waasby'</code> (default) both stability and mean
performance are considered. If <code>index = 'waasb'</code> the multi-trait index
will be computed considering the stability of genotypes only.  More details
can be seen in <code>waasb()</code> and <code>waas()</code> functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ideotype</code></td>
<td>
<p>A vector of length <code>nvar</code> where <code>nvar</code> is the
number of variables used to plan the ideotype. Use <code>'h'</code> to indicate
the traits in which higher values are desired or <code>'l'</code> to indicate the
variables in which lower values are desired. For example, <code>ideotype = c("h, h, h, h, l")</code> will consider that the ideotype has higher values for
the first four traits and lower values for the last trait.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SI</code></td>
<td>
<p>An integer (0-100). The selection intensity in percentage of the
total number of genotypes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mineval</code></td>
<td>
<p>The minimum value so that an eigenvector is retained in the
factor analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If <code>verbose = TRUE</code> (Default) then some results are
shown in the console.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>mtsi</code> with the following items:
</p>

<ul>
<li> <p><strong>data</strong> The data used to compute the factor analysis.
</p>
</li>
<li> <p><strong>cormat</strong> The correlation matrix among the environments.
</p>
</li>
<li> <p><strong>PCA</strong> The eigenvalues and explained variance.
</p>
</li>
<li> <p><strong>FA</strong> The factor analysis.
</p>
</li>
<li> <p><strong>KMO</strong> The result for the Kaiser-Meyer-Olkin test.
</p>
</li>
<li> <p><strong>MSA</strong> The measure of sampling adequacy for individual variable.
</p>
</li>
<li> <p><strong>communalities</strong> The communalities.
</p>
</li>
<li> <p><strong>communalities_mean</strong> The communalities' mean.
</p>
</li>
<li> <p><strong>initial_loadings</strong> The initial loadings.
</p>
</li>
<li> <p><strong>finish_loadings</strong> The final loadings after varimax rotation.
</p>
</li>
<li> <p><strong>canonical_loadings</strong> The canonical loadings.
</p>
</li>
<li> <p><strong>scores_gen</strong> The scores for genotypes in all retained factors.
</p>
</li>
<li> <p><strong>scores_ide</strong> The scores for the ideotype in all retained factors.
</p>
</li>
<li> <p><strong>MTSI</strong> The multi-trait stability index.
</p>
</li>
<li> <p><strong>contri_fac</strong> The relative contribution of each factor on the MTSI
value. The lower the contribution of a factor, the close of the ideotype the
variables in such factor are.
</p>
</li>
<li> <p><strong>contri_fac_rank, contri_fac_rank_sel</strong> The rank for the contribution
of each factor for all genotypes and selected genotypes, respectively.
</p>
</li>
<li> <p><strong>sel_dif_trait, sel_dif_stab, sel_dif_mps</strong> A data frame containing the
selection differential (gains) for the traits, for the stability (WAASB
index) WAASB, and for the mean performance and stability (WAASBY indexes).
The following variables are shown.
</p>

<ul>
<li> <p><code>VAR</code>: the trait's name.
</p>
</li>
<li> <p><code>Factor</code>: The factor that traits where grouped into.
</p>
</li>
<li> <p><code>Xo</code>: The original population mean.
</p>
</li>
<li> <p><code>Xs</code>: The mean of selected genotypes.
</p>
</li>
<li> <p><code>SD</code> and <code>SDperc</code>: The selection differential and selection differential in
percentage, respectively.
</p>
</li>
<li> <p><code>h2</code>: The broad-sense heritability.
</p>
</li>
<li> <p><code>SG</code> and <code>SGperc</code>: The selection gains and selection gains in percentage,
respectively.
</p>
</li>
<li> <p><code>sense</code>: The desired selection sense.
</p>
</li>
<li> <p><code>goal</code>: selection gains match desired sense? 100 for yes and 0 for no.
</p>
</li>
</ul>
</li>
<li> <p><strong>stat_dif_var, stat_dif_stab, stat_dif_mps</strong> A data frame with the
descriptive statistic for the selection gains for the traits, for the
stability (WAASB index) WAASB, and for the mean performance and stability
(WAASBY index).
The following variables are shown.
</p>

<ul>
<li> <p><code>sense</code>: The desired selection sense.
</p>
</li>
<li> <p><code>variable</code>: the trait's name.
</p>
</li>
<li> <p><code>min</code>: the minimum value for the selection gain.
</p>
</li>
<li> <p><code>mean</code>: the mean value for the selection gain.
</p>
</li>
<li> <p><code>ci</code>: the confidence interval for the selection gain.
</p>
</li>
<li> <p><code>sd.amo</code>: the standard deviation for the selection gain.
</p>
</li>
<li> <p><code>max</code>: the maximum value for the selection gain.
</p>
</li>
<li> <p><code>sum</code>: the sum of the selection gain.
</p>
</li>
</ul>
</li>
<li> <p><strong>sel_gen</strong> The selected genotypes.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Olivoto, T., A.D.C. L\'ucio, J.A.G. da silva, B.G. Sari, and
M.I. Diel. 2019. Mean performance and stability in multi-environment trials
II: Selection based on multiple traits. Agron. J. 111:2961-2969.
<a href="https://doi.org/10.2134/agronj2019.03.0220">doi:10.2134/agronj2019.03.0220</a>
</p>


<h3>See Also</h3>

<p><code>mgidi()</code>, <code>waasb()</code>, <code>get_model_data()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(metan)
# Based on stability only, for both GY and HM, higher is better
mtsi_model &lt;-
    waasb(data_ge,
    env = ENV,
    gen = GEN,
    rep = REP,
    resp = c(GY, HM))
mtsi_index &lt;-
    mtsi(mtsi_model, index = 'waasb')


# Based on mean performance and stability (using pipe operator %&gt;%)
# GY: higher is better
# HM: lower is better

mtsi_index2 &lt;-
 data_ge %&gt;%
 waasb(ENV, GEN, REP,
       resp = c(GY, HM),
       mresp = c("h, l")) %&gt;%
 mtsi()

</code></pre>


</div>