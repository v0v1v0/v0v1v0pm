<div class="container">

<table style="width: 100%;"><tr>
<td>performs_ammi</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Additive Main effects and Multiplicative Interaction</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt="[Stable]"></a>
</p>
<p>Compute the Additive Main effects and Multiplicative interaction (AMMI)
model. The estimate of the response variable for the <em>i</em>th genotype in the
<em>j</em>th environment (\(y_{ij}\)) using the AMMI model, is given as follows:
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
\[{y_{ij}} = \mu  + {\alpha_i} + {\tau_j} + \sum\limits_{k = 1}^p
{{\lambda_k}{a_{ik}}} {t_{jk}} + {\rho_{ij}} + {\varepsilon _{ij}}\]
</p>
<p>where \(\lambda_k\) is the singular value for the <em>k</em>-th interaction
principal component axis (IPCA); \(a_{ik}\) is the <em>i</em>-th element of the
<em>k</em>-th eigenvector; \(t_{jk}\) is the <em>j</em>th element of the <em>k</em>th
eigenvector. A residual \(\rho _{ij}\) remains, if not all <em>p</em> IPCA are
used, where \(p \le min(g - 1; e - 1)\).
</p>
<p>This function also serves as a helper function for other procedures performed
in the <span class="pkg">metan</span> package such as <code>waas()</code> and <code>wsmp()</code>
</p>


<h3>Usage</h3>

<pre><code class="language-R">performs_ammi(.data, env, gen, rep, resp, block = NULL, verbose = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.data</code></td>
<td>
<p>The dataset containing the columns related to Environments,
Genotypes, replication/block and response variable(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>env</code></td>
<td>
<p>The name of the column that contains the levels of the
environments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rep</code></td>
<td>
<p>The name of the column that contains the levels of the
replications/blocks</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resp</code></td>
<td>
<p>The response variable(s). To analyze multiple variables in a
single procedure, use comma-separated list of unquoted variable names,
i.e., <code>resp = c(var1, var2, var3)</code>, or any select helper like
<code>resp = contains("_PLA")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>block</code></td>
<td>
<p>Defaults to <code>NULL</code>. In this case, a randomized complete
block design is considered. If block is informed, then a resolvable
alpha-lattice design (Patterson and Williams, 1976) is employed.
<strong>All effects, except the error, are assumed to be fixed.</strong></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical argument. If <code>verbose = FALSE</code> the code will run
silently.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments passed to the function
<code>impute_missing_val()</code> for imputation of missing values in case
of unbalanced data.</p>
</td>
</tr>
</table>
<h3>Value</h3>


<ul>
<li> <p><strong>ANOVA</strong>: The analysis of variance for the AMMI model.
</p>
</li>
<li> <p><strong>PCA</strong>: The principal component analysis
</p>
</li>
<li> <p><strong>MeansGxE</strong>: The means of genotypes in the environments
</p>
</li>
<li> <p><strong>model</strong>: scores for genotypes and environments in all the possible
axes.
</p>
</li>
<li> <p><strong>augment:</strong> Information about each observation in the dataset. This
includes predicted values in the <code>fitted</code> column, residuals in the
<code>resid</code> column, standardized residuals in the <code>stdres</code> column,
the diagonal of the 'hat' matrix in the <code>hat</code>, and standard errors for
the fitted values in the <code>se.fit</code> column.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Patterson, H.D., and E.R. Williams. 1976. A new class of
resolvable incomplete block designs. Biometrika 63:83-92.
</p>


<h3>See Also</h3>

<p><code>impute_missing_val()</code>, <code>waas()</code>, <code>waas_means()</code>, <code>waasb()</code>, <code>get_model_data()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(metan)
model &lt;- performs_ammi(data_ge, ENV, GEN, REP, resp = c(GY, HM))

# PC1 x PC2 (variable GY)
p1 &lt;- plot_scores(model)
p1

# PC1 x PC2 (variable HM)
plot_scores(model,
            var = 2, # or "HM"
            type = 2)

# Nominal yield plot (variable GY)
# Draw a convex hull polygon
plot_scores(model, type = 4)

# Unbalanced data (GEN 2 in E1 missing)
mod &lt;-
  data_ge %&gt;%
   remove_rows(4:6) %&gt;%
   droplevels() %&gt;%
   performs_ammi(ENV, GEN, REP, GY)
p2 &lt;- plot_scores(mod)
arrange_ggplot(p1, p2, tag_levels = list(c("Balanced data", "Unbalanced data")))


</code></pre>


</div>