<div class="container">

<table style="width: 100%;"><tr>
<td>anova_ind</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Within-environment analysis of variance</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt="[Stable]"></a>
</p>
<p>Performs a within-environment analysis of variance in randomized complete
block or alpha-lattice designs and returns values such as Mean Squares,
p-values, coefficient of variation, heritability, and accuracy of selection.
</p>


<h3>Usage</h3>

<pre><code class="language-R">anova_ind(.data, env, gen, rep, resp, block = NULL, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.data</code></td>
<td>
<p>The dataset containing the columns related to Environments,
Genotypes, replication/block and response variable(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>env</code></td>
<td>
<p>The name of the column that contains the levels of the
environments. The analysis of variance is computed for each level of this
factor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rep</code></td>
<td>
<p>The name of the column that contains the levels of the
replications/blocks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resp</code></td>
<td>
<p>The response variable(s). To analyze multiple variables in a
single procedure a vector of variables may be used. For example <code>resp = c(var1, var2, var3)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>block</code></td>
<td>
<p>Defaults to <code>NULL</code>. In this case, a randomized complete
block design is considered. If block is informed, then a resolvable
alpha-lattice design (Patterson and Williams, 1976) is employed.
<strong>All effects, except the error, are assumed to be fixed.</strong></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical argument. If <code>verbose = FALSE</code> the code will run
silently.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list where each element is the result for one variable containing
(1) <strong>individual</strong>: A tidy tbl_df with the results of the individual
analysis of variance with the following column names, and (2) <strong>MSRatio</strong>:
The ratio between the higher and lower residual mean square. The following
columns are returned, depending on the experimental design
</p>

<ul>
<li> <p><strong>For analysis in alpha-lattice designs</strong>:
</p>

<ul>
<li> <p><code>MEAN</code>: The grand mean.
</p>
</li>
<li> <p><code style="white-space: pre;">⁠DFG, DFCR, and DFIB_R, and DFE⁠</code>: The degree of freedom for genotype,
complete replicates, incomplete blocks within replicates, and error,
respectively.
</p>
</li>
<li> <p><code style="white-space: pre;">⁠MSG, MSCR, MSIB_R⁠</code>: The mean squares for genotype, replicates, incomplete
blocks within replicates, and error, respectively.
</p>
</li>
<li> <p><code style="white-space: pre;">⁠FCG, FCR, FCIB_R⁠</code>: The F-calculated for genotype, replicates and
incomplete blocks within replicates, respectively.
</p>
</li>
<li> <p><code style="white-space: pre;">⁠PFG, PFCR, PFIB_R⁠</code>: The P-values for genotype, replicates and incomplete
blocks within replicates, respectively.
</p>
</li>
<li> <p><code>CV</code>: coefficient of variation.
</p>
</li>
<li> <p><code>h2</code>: broad-sense heritability.
</p>
</li>
<li> <p><code>AS</code>: accuracy of selection (square root of <code>h2</code>)
</p>
</li>
</ul>
</li>
<li> <p><strong>For analysis in randomized complete block design</strong>:
</p>

<ul>
<li> <p><code>MEAN</code>: The grand mean.
</p>
</li>
<li> <p><code style="white-space: pre;">⁠DFG, DFB, and DFE⁠</code>: The degree of freedom for genotype blocks, and error, respectively.
</p>
</li>
<li> <p><code style="white-space: pre;">⁠MSG, MSB, and MSE⁠</code>: The mean squares for genotype blocks, and error, respectively.
</p>
</li>
<li> <p><code style="white-space: pre;">⁠FCG and FCB⁠</code>: The F-calculated for genotype and blocks, respectively.
</p>
</li>
<li> <p><code style="white-space: pre;">⁠PFG and PFB⁠</code>: The P-values for genotype and blocks, respectively.
</p>
</li>
<li> <p><code>CV</code>: coefficient of variation.
</p>
</li>
<li> <p><code>h2</code>: broad-sense heritability.
</p>
</li>
<li> <p><code>AS</code>: accuracy of selection (square root of <code>h2</code>)
</p>
</li>
</ul>
</li>
</ul>
<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Patterson, H.D., and E.R. Williams. 1976. A new class of
resolvable incomplete block designs. Biometrika 63:83-92.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(metan)
# ANOVA for all variables in data
ind_an &lt;- anova_ind(data_ge,
                    env = ENV,
                    gen = GEN,
                    rep = REP,
                    resp = everything())
# mean for each environment
get_model_data(ind_an)

# P-value for genotype effect
get_model_data(ind_an, "PFG")


</code></pre>


</div>