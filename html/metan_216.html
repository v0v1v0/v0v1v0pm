<div class="container">

<table style="width: 100%;"><tr>
<td>plot_scores</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot scores in different graphical interpretations</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt="[Stable]"></a>
</p>
<p>Plot scores of genotypes and environments in different graphical
interpretations.
</p>
<p>Biplots type 1 and 2 are well known in AMMI analysis. In the plot type 3, the
scores of both genotypes and environments are plotted considering the
response variable and the WAASB, an stability index that considers all
significant principal component axis of traditional AMMI models or all
principal component axis estimated with BLUP-interaction effects (Olivoto et
al. 2019). Plot type 4 may be used to better understand the well known
'which-won-where' pattern, facilitating the recommendation of appropriate
genotypes targeted for specific environments, thus allowing the exploitation
of narrow adaptations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_scores(
  x,
  var = 1,
  type = 1,
  first = "PC1",
  second = "PC2",
  repel = TRUE,
  repulsion = 1,
  max_overlaps = 20,
  polygon = FALSE,
  title = TRUE,
  plot_theme = theme_metan(),
  axis.expand = 1.1,
  x.lim = NULL,
  y.lim = NULL,
  x.breaks = waiver(),
  y.breaks = waiver(),
  x.lab = NULL,
  y.lab = NULL,
  shape.gen = 21,
  shape.env = 23,
  size.shape.gen = 2.2,
  size.shape.env = 2.2,
  size.bor.tick = 0.1,
  size.tex.lab = 12,
  size.tex.gen = 3.5,
  size.tex.env = 3.5,
  size.line = 0.5,
  size.segm.line = 0.5,
  col.bor.gen = "black",
  col.bor.env = "black",
  col.line = "black",
  col.gen = "blue",
  col.env = "forestgreen",
  col.alpha.gen = 1,
  col.alpha.env = 1,
  col.segm.gen = transparent_color(),
  col.segm.env = "forestgreen",
  highlight = NULL,
  col.highlight = "red",
  col.alpha.highlight = 1,
  size.tex.highlight = 5.5,
  size.shape.highlight = 3.2,
  leg.lab = c("Env", "Gen"),
  line.type = "solid",
  line.alpha = 0.9,
  resolution = deprecated(),
  file.type = "png",
  export = FALSE,
  file.name = NULL,
  width = 8,
  height = 7,
  color = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object fitted with the functions <code>performs_ammi()</code>,
<code>waas()</code>, <code>waas_means()</code>, or <code>waasb()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>The variable to plot. Defaults to <code>var = 1</code> the first
variable of <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of biplot to produce
</p>

<ul>
<li> <p><code>type = 1</code> The default. Produces an AMMI1 biplot (Y x PC1) to make
inferences related to stability and productivity.
</p>
</li>
<li> <p><code>type = 2</code> Produces an AMMI2 biplot (PC1 x PC2) to make inferences
related to the interaction effects. Use the arguments <code>first</code> or
<code>second</code> to change the default IPCA shown in the plot.
</p>
</li>
<li> <p><code>type = 3</code> Valid for objects of class <code>waas</code> or <code>waasb</code>,
produces a biplot showing the GY x WAASB.
</p>
</li>
<li> <p><code>type = 4</code> Produces a plot with the Nominal yield x Environment PC.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>first, second</code></td>
<td>
<p>The IPCA to be shown in the first (x) and second (y)
axis. By default, IPCA1 is shown in the <code>x</code> axis and IPCA2 in the
<code>y</code> axis. For example, use <code>second = "PC3"</code> to shown the IPCA3 in
the <code>y</code> axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>repel</code></td>
<td>
<p>If <code>TRUE</code> (default), the text labels repel away from each
other and away from the data points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>repulsion</code></td>
<td>
<p>Force of repulsion between overlapping text labels. Defaults
to <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_overlaps</code></td>
<td>
<p>Exclude text labels that overlap too many things. Defaults to 20.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>polygon</code></td>
<td>
<p>Logical argument. If <code>TRUE</code>, a polygon is drawn when
<code>type = 2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>Logical values (Defaults to <code>TRUE</code>) to include
automatically generated titles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_theme</code></td>
<td>
<p>The graphical theme of the plot. Default is
<code>plot_theme = theme_metan()</code>. For more details, see
<code>ggplot2::theme()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis.expand</code></td>
<td>
<p>Multiplication factor to expand the axis limits by to
enable fitting of labels. Default is <code>1.1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.lim, y.lim</code></td>
<td>
<p>The range of x and y axes, respectively. Default is
<code>NULL</code> (maximum and minimum values of the data set). New values can be
inserted as <code>x.lim = c(x.min, x.max)</code> or <code>y.lim = c(y.min, y.max)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.breaks, y.breaks</code></td>
<td>
<p>The breaks to be plotted in the x and y axes,
respectively. Defaults to <code>waiver()</code> (automatic breaks). New values
can be inserted, for example, as <code>x.breaks = c(0.1, 0.2, 0.3)</code> or
<code>x.breaks = seq(0, 1, by = 0.2)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.lab, y.lab</code></td>
<td>
<p>The label of x and y axes, respectively. Defaults to
<code>NULL</code>, i.e., each plot has a default axis label. New values can be
inserted as <code>x.lab = 'my label'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape.gen, shape.env</code></td>
<td>
<p>The shape for genotypes and environments
indication in the biplot. Default is <code>21</code> (circle) for genotypes and
<code>23</code> (diamond) for environments. Values must be between <code>21-25</code>:
<code>21</code> (circle), <code>22</code> (square), <code>23</code> (diamond), <code>24</code> (up
triangle), and <code>25</code> (low triangle).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size.shape.gen, size.shape.env</code></td>
<td>
<p>The size of the shapes for genotypes and
environments respectively. Defaults to <code>2.2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size.bor.tick</code></td>
<td>
<p>The size of tick of shape. Default is <code>0.1</code>. The
size of the shape will be <code>max(size.shape.gen, size.shape.env) + size.bor.tick</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size.tex.lab, size.tex.gen, size.tex.env</code></td>
<td>
<p>The size of the text for axis
labels (Defaults to 12), genotypes labels, and environments labels
(Defaults to 3.5).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size.line</code></td>
<td>
<p>The size of the line that indicate the means in the biplot.
Default is <code>0.5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size.segm.line</code></td>
<td>
<p>The size of the segment that start in the origin of the
biplot and end in the scores values. Default is <code>0.5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.bor.gen, col.bor.env</code></td>
<td>
<p>The color of the shape's border for genotypes
and environments, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.line</code></td>
<td>
<p>The color of the line that indicate the means in the biplot.
Default is <code>'gray'</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.gen, col.env</code></td>
<td>
<p>The shape color for genotypes (Defaults to
<code>'blue'</code>) and environments (<code>'forestgreen'</code>). Must be length
one or a vector of colors with the same length of the number of
genotypes/environments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.alpha.gen, col.alpha.env</code></td>
<td>
<p>The alpha value for the color for
genotypes and environments, respectively. Defaults to <code>NA</code>. Values must be
between <code>0</code> (full transparency) to <code>1</code> (full color).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.segm.gen, col.segm.env</code></td>
<td>
<p>The color of segment for genotypes (Defaults
to <code>transparent_color()</code>) and environments (Defaults to 'forestgreen'),
respectively. Valid arguments for plots with <code>type = 1</code> or <code>type = 2</code> graphics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>highlight</code></td>
<td>
<p>Genotypes/environments to be highlight in the plot. Defaults
to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.highlight</code></td>
<td>
<p>The color for shape/labels when a value is provided in
<code>highlight.</code> Defaults to <code>"red"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.alpha.highlight</code></td>
<td>
<p>The alpha value for the color of the highlighted
genotypes. Defaults to <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size.tex.highlight</code></td>
<td>
<p>The size of the text for the highlighted genotypes.
Defaults to <code>5.5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size.shape.highlight</code></td>
<td>
<p>The size of the shape for the highlighted
genotypes. Defaults to <code>3.2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leg.lab</code></td>
<td>
<p>The labs of legend. Default is <code>Gen</code> and <code>Env</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line.type</code></td>
<td>
<p>The type of the line that indicate the means in the biplot.
Default is <code>'solid'</code>. Other values that can be attributed are:
<code>'blank'</code>, no lines in the biplot, <code style="white-space: pre;">⁠'dashed', 'dotted', 'dotdash', 'longdash', and 'twodash'⁠</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line.alpha</code></td>
<td>
<p>The alpha value that combine the line with the background
to create the appearance of partial or full transparency. Default is
<code>0.4</code>. Values must be between '0' (full transparency) to '1' (full
color).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resolution</code></td>
<td>
<p>deprecated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file.type</code></td>
<td>
<p>The type of file to be exported. Currently recognises the extensions
eps/ps, tex, pdf, jpeg, tiff, png (default), bmp, svg and wmf (windows only).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>export</code></td>
<td>
<p>Export (or not) the plot. Default is <code>FALSE</code>. If <code>TRUE</code>, calls the
<code>ggplot2::ggsave()</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file.name</code></td>
<td>
<p>The name of the file for exportation, default is
<code>NULL</code>, i.e. the files are automatically named.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>The width 'inch' of the plot. Default is <code>8</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>height</code></td>
<td>
<p>The height 'inch' of the plot. Default is <code>7</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color</code></td>
<td>
<p>Should type 4 plot have colors? Default to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Currently not used.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code style="white-space: pre;">⁠gg, ggplot⁠</code>.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Olivoto, T., A.D.C. L\'ucio, J.A.G. da silva, V.S. Marchioro, V.Q. de
Souza, and E. Jost. 2019. Mean performance and stability in multi-environment
trials I: Combining features of AMMI and BLUP techniques. Agron. J.
111:2949-2960. <a href="https://doi.org/10.2134/agronj2019.03.0220">doi:10.2134/agronj2019.03.0220</a>
</p>


<h3>See Also</h3>

<p><code>plot_eigen()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(metan)
# AMMI model
model &lt;- waas(data_ge,
             env = ENV,
             gen = GEN,
             rep = REP,
             resp = everything())

# GY x PC1 for variable GY (default plot)
plot_scores(model)

# PC1 x PC2 (variable HM)
#
plot_scores(model,
            polygon = TRUE,            # Draw a convex hull polygon
            var = "HM",                # or var = 2 to select variable
            highlight = c("G1", "G2"), # Highlight genotypes 2 and 3
            type = 2)                  # type of biplot

# PC3 x PC4 (variable HM)
# Change size of plot fonts and colors
# Minimal theme
plot_scores(model,
           var = "HM",
           type = 2,
           first = "PC3",
           second = "PC4",
           col.gen = "black",
           col.env = "gray",
           col.segm.env = "gray",
           size.tex.gen = 5,
           size.tex.env = 2,
           size.tex.lab = 16,
           plot_theme = theme_metan_minimal())

# WAASB index
waasb_model &lt;- waasb(data_ge, ENV, GEN, REP, GY)

# GY x WAASB
# Highlight genotypes 2 and 8
plot_scores(waasb_model,
            type = 3,
            highlight = c("G2", "G8"))

</code></pre>


</div>