<div class="container">

<table style="width: 100%;"><tr>
<td>Smith_Hazel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Smith-Hazel index</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt="[Stable]"></a>
</p>
<p>Computes the Smith (1936) and Hazel (1943) index given economic weights and
phenotypic and genotypic variance-covariance matrices. The Smith-Hazel index
is computed as follows:
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
\[\bf{b = P^{-1}Aw}\]
</p>
<p>where \(\bf{P}\) and \(\bf{G}\) are phenotypic and genetic
covariance matrices, respectively, and \(\bf{b}\) and \(\bf{w}\)
are vectors of index coefficients and economic weightings, respectively.
</p>
<p>The genetic worth \(I\) of an individual
genotype based on traits <em>x</em>, <em>y</em>, ..., <em>n</em>, is calculated as:
</p>
\[I = b_xG_x + b_yG_y + ... + b_nG_n\]
<p>where <em>b</em> the index coefficient for the traits <em>x</em>, <em>y</em>, ...,
<em>n</em>, respectively, and <em>G</em> is the individual genotype BLUPs for the
traits <em>x</em>, <em>y</em>, ..., <em>n</em>, respectively.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Smith_Hazel(
  .data,
  use_data = "blup",
  pcov = NULL,
  gcov = NULL,
  SI = 15,
  weights = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.data</code></td>
<td>
<p>The input data. It can be either a two-way table with genotypes
in rows and traits in columns, or an object fitted with the function
<code>gamem()</code>. Please, see <strong>Details</strong> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_data</code></td>
<td>
<p>Define which data to use If <code>.data</code> is an object of
class <code>gamem</code>. Defaults to <code>"blup"</code> (the BLUPs for genotypes).
Use <code>"pheno"</code> to use phenotypic means instead BLUPs for computing the
index.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pcov, gcov</code></td>
<td>
<p>The phenotypic and genotypic variance-covariance matrix,
respectively. Defaults to <code>NULL</code>. If a two-way table is informed in
<code>.data</code> these matrices are mandatory.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SI</code></td>
<td>
<p>The selection intensity (percentage). Defaults to <code>20</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>The vector of economic weights. Defaults to a vector of 1s
with the same length of the number of traits.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When using the phenotypic means in <code>.data</code>, be sure the genotype's code
are in rownames. If <code>.data</code> is an object of class <code>gamem</code> them the
BLUPs for each genotype are used to compute the index. In this case, the
genetic covariance components are estimated by mean cross products.
</p>


<h3>Value</h3>

<p>An object of class <code>hz</code> containing:
</p>

<ul>
<li> <p><strong>b</strong>: the vector of index coefficient.
</p>
</li>
<li> <p><strong>index</strong>: The genetic worth.
</p>
</li>
<li> <p><strong>sel_dif_trait</strong>: The selection differencial.
</p>
</li>
<li> <p><strong>sel_gen</strong>: The selected genotypes.
</p>
</li>
<li> <p><strong>gcov</strong>: The genotypic variance-covariance matrix
</p>
</li>
<li> <p><strong>pcov</strong>: The phenotypic variance-covariance matrix
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Smith, H.F. 1936. A discriminant function for plant selection. Ann. Eugen.
7:240-250.
<a href="https://doi.org/10.1111/j.1469-1809.1936.tb02143.x">doi:10.1111/j.1469-1809.1936.tb02143.x</a>
</p>
<p>Hazel, L.N. 1943. The genetic basis for constructing selection indexes.
Genetics 28:476-90. https://www.genetics.org/content/28/6/476.short
</p>


<h3>See Also</h3>

<p><code>mtsi()</code>, <code>mgidi()</code>, <code>fai_blup()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
vcov &lt;- covcor_design(data_g, GEN, REP, everything())
means &lt;- as.matrix(vcov$means)
pcov &lt;- vcov$phen_cov
gcov &lt;- vcov$geno_cov

index &lt;- Smith_Hazel(means, pcov = pcov, gcov = gcov, weights = rep(1, 15))

</code></pre>


</div>