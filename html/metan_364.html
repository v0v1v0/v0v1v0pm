<div class="container">

<table style="width: 100%;"><tr>
<td>waas_means</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Weighted Average of Absolute Scores</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt="[Stable]"></a>
</p>
<p>Compute the Weighted Average of Absolute Scores (Olivoto et al., 2019) based
on means for genotype-environment data as follows:
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
\[WAAS_i = \sum_{k = 1}^{p} |IPCA_{ik} \times EP_k|/ \sum_{k =
1}^{p}EP_k\]
</p>
<p>where \(WAAS_i\) is the weighted average of absolute scores of the
<em>i</em>th genotype; \(PCA_{ik}\) is the score of the <em>i</em>th genotype
in the <em>k</em>th IPCA; and \(EP_k\) is the explained variance of the <em>k</em>th
IPCA for <em>k = 1,2,..,p</em>, where <em>p</em> is the number of IPCAs that
explain at least an amount of the genotype-interaction variance declared in
the argument <code>min_expl_var</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">waas_means(
  .data,
  env,
  gen,
  resp,
  mresp = NULL,
  wresp = NULL,
  min_expl_var = 85,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.data</code></td>
<td>
<p>The dataset containing the columns related to Environments,
Genotypes, replication/block and response variable(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>env</code></td>
<td>
<p>The name of the column that contains the levels of the
environments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resp</code></td>
<td>
<p>The response variable(s). To analyze multiple variables in a
single procedure a vector of variables may be used. For example <code>resp = c(var1, var2, var3)</code>. Select helpers are also allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mresp</code></td>
<td>
<p>The new maximum value after rescaling the response variable. By
default, all variables in <code>resp</code> are rescaled so that de maximum value
is 100 and the minimum value is 0 (i.e., <code>mresp = NULL</code>). It must be a
character vector of the same length of <code>resp</code> if rescaling is assumed
to be different across variables, e.g., if for the first variable smaller
values are better and for the second one, higher values are better, then
<code>mresp = c("l, h")</code> must be used. Character value of length 1 will be
recycled with a warning message.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wresp</code></td>
<td>
<p>The weight for the response variable(s) for computing the WAASBY
index. Must be a numeric vector of the same length of <code>resp</code>. Defaults
to 50, i.e., equal weights for stability and mean performance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_expl_var</code></td>
<td>
<p>The minimum explained variance. Defaults to 85.
Interaction Principal Compoment Axis are iteractively retained up to the
explained variance (eigenvalues in the singular value decomposition of the
matrix with the interaction effects) be greather than or equal to
<code>min_expl_var</code>. For example, if the explained variance (in percentage)
in seven possible IPCAs are <code style="white-space: pre;">⁠56, 21, 9, 6, 4, 3, 1⁠</code>, resulting in a
cumulative proportion of <code style="white-space: pre;">⁠56,  77,  86,  92,  96, 99, 100⁠</code>, then
<code>p = 3</code>, i.e., three IPCAs will be used to compute the index WAAS.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical argument. If <code>verbose = FALSE</code> the code is run
silently.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments passed to the function
<code>impute_missing_val()</code> for imputation of missing values in case
of unbalanced data.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>waas_means</code> with the following items for each
variable:
</p>

<ul>
<li> <p><strong>model</strong> A data frame with the response variable, the scores of all
Principal Components, the estimates of Weighted Average of Absolute Scores,
and WAASY (the index that consider the weights for stability and productivity
in the genotype ranking.
</p>
</li>
<li> <p><strong>ge_means</strong> A tbl_df containing the genotype-environment means.
</p>
</li>
<li> <p><strong>ge_eff</strong> A <em>gxe</em> matrix containing the genotype-environment effects.
</p>
</li>
<li> <p><strong>eigenvalues</strong> The eigenvalues from the singular value decomposition
of the matrix withe the genotype-environment interaction effects.
</p>
</li>
<li> <p><strong>proportion</strong> The proportion of the variance explained by each IPCA.
</p>
</li>
<li> <p><strong>cum_proportion</strong> The cumulative proportion of the variance explained.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Olivoto, T., A.D.C. L\'ucio, J.A.G. da silva, V.S. Marchioro, V.Q. de
Souza, and E. Jost. 2019a. Mean performance and stability in
multi-environment trials I: Combining features of AMMI and BLUP techniques.
Agron. J. 111:2949-2960. <a href="https://doi.org/10.2134/agronj2019.03.0220">doi:10.2134/agronj2019.03.0220</a>
</p>


<h3>See Also</h3>

<p><code>waas()</code> <code>waasb()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(metan)
# Data with replicates
model &lt;- waas(data_ge,
              env = ENV,
              gen = GEN,
              rep = REP,
              resp = everything())

# Based on means of genotype-environment data
data_means &lt;- mean_by(data_ge, ENV, GEN)
model2 &lt;- waas_means(data_ge,
                     env = ENV,
                     gen = GEN,
                     resp = everything())
# The index WAAS
get_model_data(model, what = "OrWAAS")
get_model_data(model2, what = "OrWAAS")



</code></pre>


</div>