<div class="container">

<table style="width: 100%;"><tr>
<td>covcor_design</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Variance-covariance matrices for designed experiments</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt="[Stable]"></a>
</p>
<p>Compute variance-covariance and correlation matrices using data from a
designed (RCBD or CRD) experiment.
</p>


<h3>Usage</h3>

<pre><code class="language-R">covcor_design(.data, gen, rep, resp, design = "RCBD", by = NULL, type = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.data</code></td>
<td>
<p>The data to be analyzed. It can be a data frame, possible with
grouped data passed from <code>dplyr::group_by()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rep</code></td>
<td>
<p>The name of the column that contains the levels of the
replications/blocks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resp</code></td>
<td>
<p>The response variables. For example <code>resp = c(var1, var2, var3)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>
<p>The experimental design. Must be RCBD or CRD.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by</code></td>
<td>
<p>One variable (factor) to compute the function by. It is a shortcut
to <code>dplyr::group_by()</code>. To compute the statistics by more than
one grouping variable use that function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>What the matrices should return? Set to <code>NULL</code>, i.e., a list
of matrices is returned. The argument type allow the following values
<code style="white-space: pre;">⁠'pcor', 'gcor', 'rcor'⁠</code>, (which will return the phenotypic, genotypic
and residual correlation matrices, respectively) or <code style="white-space: pre;">⁠'pcov', 'gcov', 'rcov'⁠</code> (which will return the phenotypic, genotypic and residual
variance-covariance matrices, respectively). Alternatively, it is possible
to get a matrix with the means of each genotype in each trait, by using
<code>type = 'means'</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>covcor_design</code> containing the following
items:
</p>

<ul>
<li> <p><strong>geno_cov</strong> The genotypic covariance.
</p>
</li>
<li> <p><strong>phen_cov</strong> The phenotypic covariance.
</p>
</li>
<li> <p><strong>resi_cov</strong> The residual covariance.
</p>
</li>
<li> <p><strong>geno_cor</strong> The phenotypic correlation.
</p>
</li>
<li> <p><strong>phen_cor</strong> The phenotypic correlation.
</p>
</li>
<li> <p><strong>resi_cor</strong> The residual correlation.
</p>
</li>
</ul>
<p>If <code>.data</code> is a grouped data passed from <code>dplyr::group_by()</code>
then the results will be returned into a list-column of data frames.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(metan)
# List of matrices
data &lt;- subset(data_ge2, ENV == 'A1')
matrices &lt;- covcor_design(data,
                          gen = GEN,
                          rep = REP,
                          resp = c(PH, EH, NKE, TKW))

# Genetic correlations
gcor &lt;- covcor_design(data,
                      gen = GEN,
                      rep = REP,
                      resp = c(PH, EH, NKE, TKW),
                      type = 'gcor')

# Residual (co)variance matrix for each environment
rcov &lt;- covcor_design(data_ge2,
                      gen = GEN,
                      rep = REP,
                      resp = c(PH, EH, CD, CL),
                      by = ENV,
                      type = "rcov")


</code></pre>


</div>