<div class="container">

<table style="width: 100%;"><tr>
<td>cv_ammif</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cross-validation procedure</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt="[Stable]"></a>
</p>
<p>Cross-validation for estimation of all AMMI-family models
</p>
<p><code>cv_ammif</code> provides a complete cross-validation of replicate-based data
using AMMI-family models. By default, the first validation is carried out
considering the AMMIF (all possible axis used). Considering this model, the
original dataset is split up into two datasets: training set and validation
set. The 'training' set has all combinations (genotype x environment) with
N-1 replications. The 'validation' set has the remaining replication. The
splitting of the dataset into modeling and validation sets depends on the
design informed. For Completely Randomized Block Design (default), and
alpha-lattice design (declaring <code>block</code> arguments), complete replicates
are selected within environments. The remained replicate serves as validation
data. If <code>design = 'RCD'</code> is informed, completely randomly samples are
made for each genotype-by-environment combination (Olivoto et al. 2019). The
estimated values for each member of the AMMI-family model are compared with
the 'validation' data. The Root Mean Square Prediction Difference (RMSPD) is
computed. At the end of boots, a list is returned.
</p>
<p><strong>IMPORTANT:</strong> If the data set is unbalanced (i.e., any genotype missing
in any environment) the function will return an error. An error is also
observed if any combination of genotype-environment has a different number of
replications than observed in the trial.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cv_ammif(
  .data,
  env,
  gen,
  rep,
  resp,
  nboot = 200,
  block,
  design = "RCBD",
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.data</code></td>
<td>
<p>The dataset containing the columns related to Environments,
Genotypes, replication/block and response variable(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>env</code></td>
<td>
<p>The name of the column that contains the levels of the
environments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rep</code></td>
<td>
<p>The name of the column that contains the levels of the
replications/blocks. <strong>AT LEAST THREE REPLICATES ARE REQUIRED TO
PERFORM THE CROSS-VALIDATION</strong>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resp</code></td>
<td>
<p>The response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot</code></td>
<td>
<p>The number of resamples to be used in the cross-validation.
Defaults to 200.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>block</code></td>
<td>
<p>Defaults to <code>NULL</code>. In this case, a randomized complete
block design is considered. If block is informed, then a resolvable
alpha-lattice design (Patterson and Williams, 1976) is employed.
<strong>All effects, except the error, are assumed to be fixed.</strong></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>
<p>The experimental design used in each environment. Defaults to
<code>RCBD</code> (Randomized complete Block Design). For Completely Randomized
Designs inform <code>design = 'CRD'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A logical argument to define if a progress bar is shown.
Default is <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>cv_ammif</code> with the following items:
</p>

<ul>
<li> <p><strong>RMSPD</strong>: A vector with nboot-estimates of the Root Mean Squared
Prediction Difference between predicted and validating data.
</p>
</li>
<li> <p><strong>RMSPDmean</strong>: The mean of RMSPDmean estimates.
</p>
</li>
<li> <p><strong>Estimated</strong>: A data frame that contain the values (predicted, observed,
validation) of the last loop.
</p>
</li>
<li> <p><strong>Modeling</strong>: The dataset used as modeling data in the last loop
</p>
</li>
<li> <p><strong>Testing</strong>: The dataset used as testing data in the last loop.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Patterson, H.D., and E.R. Williams. 1976. A new class of
resolvable incomplete block designs. Biometrika 63:83-92.
</p>


<h3>See Also</h3>

<p><code>cv_ammi()</code>, <code>cv_blup()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

library(metan)
model &lt;- cv_ammif(data_ge2,
                  env = ENV,
                  gen = GEN,
                  rep = REP,
                  resp = EH,
                  nboot = 5)
plot(model)


</code></pre>


</div>