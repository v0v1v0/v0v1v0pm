<div class="container">

<table style="width: 100%;"><tr>
<td>env_stratification</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Environment stratification</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt="[Stable]"></a>
</p>
<p>Computes environment stratification based on factor analysis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">env_stratification(
  .data,
  env,
  gen,
  resp,
  use = "complete.obs",
  mineval = 1,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.data</code></td>
<td>
<p>The dataset containing the columns related to Environments,
Genotypes, replication/block and response variable(s)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>env</code></td>
<td>
<p>The name of the column that contains the levels of the
environments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resp</code></td>
<td>
<p>The response variable(s). To analyze multiple variables in a
single procedure use, for example, <code>resp = c(var1, var2, var3)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use</code></td>
<td>
<p>The method for computing covariances in the presence of missing
values. Defaults to <code>complete.obs</code>, i.e., missing values are handled
by casewise deletion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mineval</code></td>
<td>
<p>The minimum value so that an eigenvector is retained in the
factor analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical argument. If <code>verbose = FALSE</code> the code will run
silently.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>env_stratification</code> which is a list with one
element per analyzed trait. For each trait, the following values are given.
</p>

<ul>
<li> <p><code>data</code> The genotype-environment means.
</p>
</li>
<li> <p><code>cormat</code>: The correlation matrix among the environments.
</p>
</li>
<li> <p><code>PCA</code>: The eigenvalues and explained variance.
</p>
</li>
<li> <p><code>FA</code>: The factor analysis.
</p>
</li>
<li> <p><code>env_strat</code>: The environmental stratification.
</p>
</li>
<li> <p><code>mega_env_code</code>: The environments within each mega-environment.
</p>
</li>
<li> <p><code>mega_env_stat</code>: The statistics for each mega-environment.
</p>
</li>
<li> <p><code>KMO</code>: The result for the Kaiser-Meyer-Olkin test.
</p>
</li>
<li> <p><code>MSA</code>: The measure of sampling adequacy for individual variable.
</p>
</li>
<li> <p><code>communalities_mean</code>: The communalities' mean.
</p>
</li>
<li> <p><code>initial_loadings</code>: The initial loadings.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Tiago Olivoto, <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Murakami, D.M.D., and C.D.C. Cruz. 2004. Proposal of
methodologies for environment stratification and analysis of genotype
adaptability. Crop Breed. Appl. Biotechnol. 4:7-11.
</p>


<h3>See Also</h3>

<p><code>env_dissimilarity()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(metan)
model &lt;-
env_stratification(data_ge,
                   env = ENV,
                   gen = GEN,
                   resp = everything())
gmd(model)


</code></pre>


</div>