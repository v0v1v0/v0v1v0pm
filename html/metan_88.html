<div class="container">

<table style="width: 100%;"><tr>
<td>fai_blup</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multi-trait selection index</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt="[Stable]"></a>
</p>
<p>Multitrait index based on factor analysis and ideotype-design proposed by
Rocha et al. (2018).
</p>


<h3>Usage</h3>

<pre><code class="language-R">fai_blup(
  .data,
  use_data = "blup",
  DI = NULL,
  UI = NULL,
  SI = 15,
  mineval = 1,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.data</code></td>
<td>
<p>An object of class <code>waasb</code> or a two-way table with
genotypes in the rows and traits in columns. In the last case the row names
must contain the genotypes names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_data</code></td>
<td>
<p>Define which data to use If <code>.data</code> is an object of
class <code>gamem</code>. Defaults to <code>"blup"</code> (the BLUPs for genotypes).
Use <code>"pheno"</code> to use phenotypic means instead BLUPs for computing the
index.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DI, UI</code></td>
<td>
<p>A vector of the same length of <code>.data</code> to construct the
desirable (DI) and undesirable (UI) ideotypes. For each element of the
vector, allowed values are <code>'max'</code>, <code>'min'</code>, <code>'mean'</code>, or a
numeric value. Use a comma-separated vector of text. For example, <code>DI = c("max, max, min, min")</code>. By default, DI is set to <code>"max"</code> for all
traits and UI is set to <code>"min"</code> for all traits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SI</code></td>
<td>
<p>An integer (0-100). The selection intensity in percentage of the
total number of genotypes. Defaults to 15.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mineval</code></td>
<td>
<p>The minimum value so that an eigenvector is retained in the
factor analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical value. If <code>TRUE</code> some results are shown in
console.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>fai_blup</code> with the following items:
</p>

<ul>
<li> <p><strong>data</strong> The data (BLUPS) used to compute the index.
</p>
</li>
<li> <p><strong>eigen</strong> The eigenvalues and explained variance for each axis.
</p>
</li>
<li> <p><strong>FA</strong> The results of the factor analysis.
</p>
</li>
<li> <p><strong>canonical_loadings</strong> The canonical loadings for each factor retained.
</p>
</li>
<li> <p><strong>FAI</strong> A list with the FAI-BLUP index for each ideotype design.
</p>
</li>
<li> <p><strong>sel_dif_trait</strong> A list with the selection differential for each ideotype design.
</p>
</li>
<li> <p><strong>sel_gen</strong> The selected genotypes.
</p>
</li>
<li> <p><strong>ideotype_construction</strong> A list with the construction of the ideotypes.
</p>
</li>
<li> <p><strong>total_gain</strong> A list with the total gain for variables to be increased or decreased.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Rocha, J.R.A.S.C.R, J.C. Machado, and P.C.S. Carneiro. 2018. Multitrait index
based on factor analysis and ideotype-design: proposal and application on
elephant grass breeding for bioenergy. GCB Bioenergy 10:52-60.
<a href="https://doi.org/10.1111/gcbb.12443">doi:10.1111/gcbb.12443</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(metan)

mod &lt;- waasb(data_ge,
             env = ENV,
             gen = GEN,
             rep = REP,
             resp = c(GY, HM))

FAI &lt;- fai_blup(mod,
                SI = 15,
                DI = c('max, max'),
                UI = c('min, min'))

</code></pre>


</div>