<div class="container">

<table style="width: 100%;"><tr>
<td>gafem</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Genotype analysis by fixed-effect models</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt="[Stable]"></a>
</p>
<p>One-way analysis of variance of genotypes conducted in both randomized
complete block and alpha-lattice designs.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gafem(
  .data,
  gen,
  rep,
  resp,
  block = NULL,
  by = NULL,
  prob = 0.05,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.data</code></td>
<td>
<p>The dataset containing the columns related to, Genotypes,
replication/block and response variable(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes, that will
be treated as random effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rep</code></td>
<td>
<p>The name of the column that contains the levels of the replications
(assumed to be fixed).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resp</code></td>
<td>
<p>The response variable(s). To analyze multiple variables in a
single procedure a vector of variables may be used. For example <code>resp = c(var1, var2, var3)</code>. Select helpers are also allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>block</code></td>
<td>
<p>Defaults to <code>NULL</code>. In this case, a randomized complete
block design is considered. If block is informed, then a resolvable
alpha-lattice design (Patterson and Williams, 1976) is employed.
<strong>All effects, except the error, are assumed to be fixed.</strong> Use the
function <code>gamem()</code> to analyze a one-way trial with mixed-effect
models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by</code></td>
<td>
<p>One variable (factor) to compute the function by. It is a shortcut
to <code>dplyr::group_by()</code>.This is especially useful, for example,
when the researcher want to fit a fixed-effect model for each environment.
In this case, an object of class gafem_grouped is returned.
<code>mgidi()</code> can then be used to compute the mgidi index within each
environment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>The error probability. Defaults to 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical argument. If <code>verbose = FALSE</code> the code are run
silently.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>gafem</code> analyses data from a one-way genotype testing
experiment. By default, a randomized complete block design is used
according to the following model:
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
\[Y_{ij} = m + g_i + r_j + e_{ij}\]
where \(Y_{ij}\) is the response variable of the ith genotype in the
<em>j</em>th block; <em>m</em> is the grand mean (fixed); \(g_i\) is the effect
of the <em>i</em>th genotype; \(r_j\) is the effect of the <em>j</em>th
replicate; and \(e_{ij}\) is the random error.
</p>
<p>When <code>block</code> is informed, then a resolvable alpha design is implemented,
according to the following model:
</p>
\[Y_{ijk} = m + g_i + r_j + b_{jk} + e_{ijk}\]
<p>where where \(y_{ijk}\)
is the response variable of the <em>i</em>th genotype in the <em>k</em>th block
of the <em>j</em>th replicate; <em>m</em> is the intercept, \(t_i\) is the
effect for the <em>i</em>th genotype \(r_j\) is the effect of the <em>j</em>th
replicate, \(b_{jk}\) is the effect of the <em>k</em>th incomplete block of
the <em>j</em>th replicate, and \(e_{ijk}\) is the plot error effect
corresponding to \(y_{ijk}\). All effects, except the random error are
assumed to be fixed.
</p>


<h3>Value</h3>

<p>A list where each element is the result for one variable containing
the following objects:
</p>

<ul>
<li> <p><strong>anova:</strong> The one-way ANOVA table.
</p>
</li>
<li> <p><strong>model:</strong> The model with of <code>lm</code>.
</p>
</li>
<li> <p><strong>augment:</strong> Information about each observation in the dataset. This
includes predicted values in the <code>fitted</code> column, residuals in the
<code>resid</code> column, standardized residuals in the <code>stdres</code> column,
the diagonal of the 'hat' matrix in the <code>hat</code>, and standard errors for
the fitted values in the <code>se.fit</code> column.
</p>
</li>
<li> <p><strong>hsd:</strong> The Tukey's 'Honest Significant Difference' for genotype
effect.
</p>
</li>
<li> <p><strong>details:</strong> A tibble with the following data: <code>Ngen</code>, the
number of genotypes; <code>OVmean</code>, the grand mean; <code>Min</code>, the minimum
observed (returning the genotype and replication/block); <code>Max</code> the
maximum observed, <code>MinGEN</code> the loser winner genotype, <code>MaxGEN</code>,
the winner genotype.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Patterson, H.D., and E.R. Williams. 1976. A new class of
resolvable incomplete block designs. Biometrika 63:83-92.
</p>


<h3>See Also</h3>

<p><code>get_model_data()</code> <code>gamem()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(metan)
# RCBD
rcbd &lt;- gafem(data_g,
             gen = GEN,
             rep = REP,
             resp = c(PH, ED, EL, CL, CW))

# Fitted values
get_model_data(rcbd)

# ALPHA-LATTICE DESIGN
alpha &lt;- gafem(data_alpha,
              gen = GEN,
              rep = REP,
              block = BLOCK,
              resp = YIELD)

# Fitted values
get_model_data(alpha)



</code></pre>


</div>