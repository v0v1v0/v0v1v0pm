<div class="container">

<table style="width: 100%;"><tr>
<td>compute_TL</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>compute trophic levels</h2>

<h3>Description</h3>

<p>Method to compute trophic levels using graph Laplacian using the method described in MacKay et al 2020.
</p>


<h3>Usage</h3>

<pre><code class="language-R">compute_TL(metanetwork)

## S3 method for class 'metanetwork'
compute_TL(metanetwork)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>metanetwork</code></td>
<td>
<p>object of class 'metanetwork'</p>
</td>
</tr></table>
<h3>Details</h3>

<p>Let <code class="reqn">A</code> be the adjacency matrix of the considered network and <code class="reqn">D</code> its degree diagonal matrix.
The Laplacian matrix of the symmetrised network is defined by:
</p>
<p style="text-align: center;"><code class="reqn">L = D - A - t(A)</code>
</p>

<p>With <code class="reqn">v = indegree(G) - outdegree(G)</code> the imbalance degree vector, the trophic level <code class="reqn">x</code> is defined as the solution of:
</p>
<p style="text-align: center;"><code class="reqn">Lx = v</code>
</p>

<p>For a connected network, the solution is unique up to a translation.
We then fix the minimum trophic level value at 0 thus fixing trophic levels of all others species.
Local networks may be disconnected due to sampling effect. In that case, we fix the minimum value on each connected component.
</p>


<h3>Value</h3>

<p>an object of class 'metanetwork', with computed trophic levels stored as node attribute <code>TL</code>
</p>
<p><code>NULL</code>
</p>


<h3>References</h3>

<p>MacKay, R. S., Johnson, S., &amp; Sansom, B. (2020). How directed is a directed network?. Royal Society open science, 7(9), 201138.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(metanetwork)
library(igraph)

#on angola dataset
data(meta_angola)
meta_angola  = compute_TL(meta_angola)
V(meta_angola$metaweb)$TL

</code></pre>


</div>