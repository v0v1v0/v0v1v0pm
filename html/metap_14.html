<div class="container">

<table style="width: 100%;"><tr>
<td>invchisq</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Combine p values using the inverse chi squared method</h2>

<h3>Description</h3>

<p>Combine \(p\)-values by the
inverse chi-squared method,
also known as Lancaster's method<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></p>


<h3>Usage</h3>

<pre><code class="language-R">invchisq(p, k, data = NULL, subset = NULL, na.action = na.fail, log.p = FALSE)
## S3 method for class 'invchisq'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>A vector of significance values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>A vector of degrees of freedom to use, see details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Optional data frame containing variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>Optional vector of logicals to specify a subset of the \(p\)-values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>A function indicating what should happen when data
contains NAs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.p</code></td>
<td>
<p>Logical, if TRUE result is returned as log(p)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class ‘<code>invchisq</code>’</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments to be passed through</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Defined as
\[\sum_{i=1}^n \chi^2_{k_i}(p_i) &gt; \chi^2_{\sum{k_i}}(\alpha)\]
</p>
<p>If <code>k</code> is a single value it is used for all the <code>p</code>
of which there are <code>n</code>.
If any value of \(k_i\le0\) then the corresponding \(p_i\)
is not included.
</p>
<p>The values of \(p_i\) should be such that \(0 &lt; p_i\le 1\) and a warning is given if that is not true. A warning is given if, possibly as a result of removing illegal values, fewer than two values remain and the return values are set to NA.
</p>
<p>The plot method for class ‘<code>metap</code>’ calls <code>plotp</code> on the valid <i>p</i>-values.
Inspection of the distribution of \(p\)-values is highly recommended as extreme values in opposite directions do not cancel out. See last example. This may not be what you want.
</p>


<h3>Value</h3>

<p>An object of class ‘<code>invchisq</code>’ and ‘<code>metap</code>’,
a list with entries
</p>
<table>
<tr style="vertical-align: top;">
<td><code>chisq</code></td>
<td>
<p>Value of chi-squared statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>Associated degrees of freedom</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Associated p-value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>validp</code></td>
<td>
<p>The input vector with the illegal values removed</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Michael Dewey
</p>


<h3>References</h3>

<p>Becker BJ (1994).
“Combining significance levels.”
In Cooper H, Hedges LV (eds.), <em>A handbook of research synthesis</em>, 215–230.
Russell Sage, New York.
</p>
<p>Lancaster HO (1949).
“Combination of probabilities arising from data in discrete distributions.”
<em>Biometrika</em>, <b>36</b>, 370–382.
</p>


<h3>See Also</h3>

<p>See also <code>sumlog</code> and <code>plotp</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(dat.metap)
beckerp &lt;- dat.metap$beckerp
invchisq(beckerp, 2) # same as sumlog
invchisq(c(0.999, 0.999, 0.001, 0.001), 4)
all.equal(exp(invchisq(beckerp, 2, log.p = TRUE)$p), invchisq(beckerp, 2)$p)
</code></pre>


</div>