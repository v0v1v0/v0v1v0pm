<div class="container">

<table style="width: 100%;"><tr>
<td>sumlog</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Combine p-values by the sum of logs (Fisher's) method
</h2>

<h3>Description</h3>

<p>Combine \(p\)-values by the sum of logs method,
also known as Fisher's method, and sometimes as the
chi-square (2) method<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></p>


<h3>Usage</h3>

<pre><code class="language-R">sumlog(p, log.p = FALSE, log.input = FALSE)
## S3 method for class 'sumlog'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>A vector of significance values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.p</code></td>
<td>
<p>Logical, if TRUE result is returned as log(p)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.input</code></td>
<td>
<p>Logical, if TRUE the input \(p\) values are assumed to be logged</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class ‘<code>sumlog</code>’</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments to be passed through</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The method relies on the fact that
\[\sum_{i=1}^k - 2 \log p_i\]
is a chi-squared with \(2 k\) df where \(k\) is the number
of studies (Fisher 1925).



</p>
<p>The values of \(p_i\) should be such that \(0 &lt; p_i\le 1\) and a warning is given if that is not true. A warning is given if, possibly as a result of removing illegal values, fewer than two values remain and the return values are set to NA.
</p>
<p>The <code>log.input</code> parameter may be beneficial
when the input values are already logged and would be
small if exponentiated since it avoids a
conversion.
</p>
<p>The plot method for class ‘<code>metap</code>’ calls <code>plotp</code> on the valid <i>p</i>-values.
Inspection of the distribution of \(p\)-values is highly recommended as extreme values in opposite directions do not cancel out. See last example. This may not be what you want.
</p>


<h3>Value</h3>

<p>An object of class ‘<code>sumlog</code>’ and ‘<code>metap</code>’,
a list with entries
</p>
<table>
<tr style="vertical-align: top;">
<td><code>chisq</code></td>
<td>
<p>Value of chi-squared statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>Associated degrees of freedom</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Associated \(p\)-value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>validp</code></td>
<td>
<p>The input vector with the illegal values removed</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Michael Dewey</p>


<h3>References</h3>

<p>Becker BJ (1994).
“Combining significance levels.”
In Cooper H, Hedges LV (eds.), <em>A handbook of research synthesis</em>, 215–230.
Russell Sage, New York.<br><br> Fisher RA (1925).
<em>Statistical methods for research workers</em>.
Oliver and Boyd, Edinburgh.<br><br> Rosenthal R (1978).
“Combining results of independent studies.”
<em>Psychological Bulletin</em>, <b>85</b>, 185–193.<br><br> Sutton AJ, Abrams KR, Jones DR, Sheldon TA, Song F (2000).
<em>Methods for meta-analysis in medical research</em>.
Wiley, Chichester.
</p>


<h3>See Also</h3>

<p>See also <code>plotp</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(dat.metap)
teachexpect &lt;- dat.metap$teachexpect
sumlog(teachexpect) # chisq = 69.473, df = 38, p = 0.0014, from Becker
beckerp &lt;- dat.metap$beckerp
sumlog(beckerp) # chisq = 18.533, df = 10, sig
rosenthal &lt;- dat.metap$rosenthal
sumlog(rosenthal$p) # chisq = 22.97, df = 10, p = 0.006 one sided
cholest &lt;- dat.metap$cholest$p
sumlog(cholest) # chisq = 58.62, df = 68, p = 0.78
validity &lt;- dat.metap$validity$p
sumlog(validity) # chisq = 159.82, df = 40, p = 2.91 * 10^{-16}
sumlog(c(0.0001, 0.0001, 0.9999, 0.9999)) # is significant
all.equal(exp(sumlog(validity, log.p = TRUE)$p), sumlog(validity)$p)
all.equal(sumlog(log(validity), log.input = TRUE)$p, sumlog(validity)$p)
</code></pre>


</div>