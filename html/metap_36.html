<div class="container">

<table style="width: 100%;"><tr>
<td>sumz</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Combine p-values using the sum of z (Stouffer's) method</h2>

<h3>Description</h3>

<p>Combine \(p\)-values using the sum of z method<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></p>


<h3>Usage</h3>

<pre><code class="language-R">sumz(p, weights = NULL, data = NULL, subset = NULL, na.action = na.fail,
   log.p = FALSE, log.input = FALSE)
## S3 method for class 'sumz'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>A vector of significance values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>A vector of weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Optional data frame containing variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>Optional vector of logicals to specify
a subset of the \(p\)-values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>A function indicating what should happen when data
contains NAs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.p</code></td>
<td>
<p>Logical, if TRUE result is returned as log(p)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.input</code></td>
<td>
<p>Logical, if TRUE the input \(p\) values are assumed to be logged</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class ‘<code>sumz</code>’</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments to be passed through</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Defined as \[\frac{\sum_{i=1}^k  w_i z(p_i)}{\sqrt {\sum_{i=1}^k  w_i ^ 2}}\]
is a \(z\) where \(k\) is the number of studies
and \(w\) are the weights (Stouffer et al. 1949).
By default the weights are equal.
In the absence of effect sizes (in which case a method for
combining effect sizes would be more appropriate anyway)
best results are believed to be obtained with weights
proportional to the square root of the sample sizes
(Zaykin 2011)
</p>


<p>The values of \(p_i\) should be such that \(0 &lt; p_i &lt; 1\) and a warning is given if that is not true. A warning is given if, possibly as a result of removing illegal values, fewer than two values remain and the return values are set to NA. If the omitted \(p\) values had supplied weights
a further warning is issued.
</p>
<p>The <code>log.input</code> parameter may be beneficial
when the input values are already logged and would be
small if exponentiated since it avoids a
conversion.
</p>
<p>The plot method for class ‘<code>metap</code>’ calls <code>plotp</code> on the valid <i>p</i>-values.
</p>


<h3>Value</h3>

<p>An object of class ‘<code>sumz</code>’ and
‘<code>metap</code>’, a list with entries
</p>
<table>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>Transformed sum of \(z\) values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Associated \(p\)-value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>validp</code></td>
<td>
<p>The input vector with illegal values removed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>The weight vector corresponding to <code>validp</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Michael Dewey</p>


<h3>References</h3>

<p>Becker BJ (1994).
“Combining significance levels.”
In Cooper H, Hedges LV (eds.), <em>A handbook of research synthesis</em>, 215–230.
Russell Sage, New York.<br><br> Rosenthal R (1978).
“Combining results of independent studies.”
<em>Psychological Bulletin</em>, <b>85</b>, 185–193.<br><br> Stouffer SA, Suchman EA, DeVinney LC, Star SA, Williams RMJ (1949).
<em>The American soldier, vol 1: Adjustment during army life</em>.
Princeton University Press, Princeton.<br><br> Zaykin DV (2011).
“Optimally weighted <i>Z</i>–test is a powerful method for combining probabilities in meta–analysis.”
<em>Journal of Evolutionary Biology</em>, <b>24</b>, 1836–1841.
</p>


<h3>See Also</h3>

<p>See also <code>plotp</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(dat.metap)
teachexpect &lt;- dat.metap$teachexpect
sumz(teachexpect) # z = 2.435, p = 0.0074, from Becker
beckerp &lt;- dat.metap$beckerp
sumz(beckerp) # z = 1.53, NS, from Beckerp
rosenthal &lt;- dat.metap$rosenthal
sumz(rosenthal$p) # 2.39, p = 0.009
sumz(p, df, rosenthal) # 3.01, p = 0.0013
validity &lt;- dat.metap$validity$p
sumz(validity) # z = 8.191, p = 1.25 * 10^{-16}
all.equal(exp(sumz(validity, log.p = TRUE)$p), sumz(validity)$p)
all.equal(sumz(log(validity), log.input = TRUE)$p, sumz(validity)$p)
</code></pre>


</div>