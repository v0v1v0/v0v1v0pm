<div class="container">

<table style="width: 100%;"><tr>
<td>truncated</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Truncated product methods</h2>

<h3>Description</h3>

<p>Implements two procedures for truncated versions
of Fisher's method<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></p>


<h3>Usage</h3>

<pre><code class="language-R">truncated(p, ptrunc = NULL, rtrunc = NULL, ...)
## S3 method for class 'truncated'
print(x, ...)
## S3 method for class 'truncated'
summary(object, ...)
## S3 method for class 'truncated'
plot(x, pparams = list(pchs = c(16, 1),
   pcols = c("black", "black")), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>A vector of significance values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ptrunc</code></td>
<td>
<p>Value of \(p\) to truncate at. See Details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rtrunc</code></td>
<td>
<p>Which rank \(p\) to truncate at. See Details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class ‘<code>truncated</code>’</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class ‘<code>truncated</code>’</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments to be passed through</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pparams</code></td>
<td>
<p>A list containing a vector <code>pchs</code> of plotting
symbols and a vector <code>pcols</code> of colours</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Uses routines from TFisher to implement
truncated Fisher (Zaykin et al. 2007; Zhang et al. 2018)
and from mutoss to implement
rank-truncated Fisher (Dudbridge and Koeleman 2003)
</p>
<p>The print method prints the statistic and its associated
\(p\)-value. The summary method also prints how many
of the input values were actually used. The plot method
provides an index plot of the \(p\)-values.
By default used \(p\)-values are plotted
with a black filled circle and those not used with a black
unfilled circle. The colours and plotting symbols can be changed
in <code>pparams</code>. The first element of each vector is for the
used \(p\)-values and the second for the unused ones.
</p>


<h3>Value</h3>

<p>An object of class ‘<code>truncated</code>’
a list with entries
</p>
<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>The resultant overall \(p\)-value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stat</code></td>
<td>
<p>The test statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>validp</code></td>
<td>
<p>The input vector with illegal values removed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ptrunc</code></td>
<td>
<p>The \(p\)-value used for truncation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trunc</code></td>
<td>
<p>The  rank value used for truncation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>A vector containing <code>incl</code>, the number
of valid values included, <code>excl</code>, the number of valid
values not used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The method used</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Only one of <code>ptrunc</code> or <code>rtrunc</code> is returned
as appropriate. If the function encounters an error
it returns NA for the value of <code>p</code> and gives
a warning message.
The effect of specifying both <code>ptrunc</code>
and <code>rtrunc</code> is undefined.
</p>


<h3>Author(s)</h3>

<p>Michael Dewey
</p>


<h3>References</h3>

<p>Dudbridge F, Koeleman BPC (2003).
“Rank truncated product of <i>P</i>–values, with application to genomewide association scans.”
<em>Genetic Epidemiology</em>, <b>25</b>, 360–366.<br><br> Zaykin DV, Zhivotovsky LA, Czika W, Shao S, Wolfinger RD (2007).
“Combining p–values in large–scale genomics experiments.”
<em>Pharmaceutical Statistics</em>, <b>6</b>, 217–236.<br><br> Zhang H, Tong T, Landers J, Wu Z (2018).
“TFisher tests: optimal and adaptive thresholding for combining <i>p</i>–values.”
<em>arXiv</em>.
<a href="https://arxiv.org/abs/1801.04309">https://arxiv.org/abs/1801.04309</a>.
</p>


<h3>See Also</h3>

<p><code>ranktruncated</code>, <code>stat.tpm</code>,
and <code>p.tpm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(dat.metap)
validity &lt;- dat.metap$validity
truncated(validity, ptrunc = 0.5)
truncated(validity, rtrunc = 5)
</code></pre>


</div>