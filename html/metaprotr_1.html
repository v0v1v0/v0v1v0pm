<div class="container">

<table style="width: 100%;"><tr>
<td>add_kegg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>add_kegg</h2>

<h3>Description</h3>

<p>Integrates a database containing the functional annotation of the identified 
metaproteins into a list defined as "spectral_count_object". The proteins 
from the “spectral_count_object” must contain taxonomic information. 
The functional annotation was obtained from the Kyoto Encyclopedia of 
Genes and Genomes (KEGG) Orthology database. This database contains 
the molecular functions represented in terms of functional orthologs (KO terms).
Check <a href="https://www.genome.jp/kegg/">KEGG</a> for more details.
</p>


<h3>Usage</h3>

<pre><code class="language-R">add_kegg(
  spectral_count_object,
  annotation_db,
  taxonomic_db,
  metaproteome_origin,
  protein_file,
  peptide_file,
  text_to_filter = "HUMAN",
  taxonomic_levels_allowed = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>spectral_count_object</code></td>
<td>
<p>List defined as "spectral_count_object" 
containing the abundance of the elements (groups, subgroups 
or peptides) expressed as spectral counts and organized by 
taxonomic levels. The format of this object is similar to 
that generated from the function "crumble_taxonomy".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>annotation_db</code></td>
<td>
<p>Dataframe containing the functional annotation 
of the proteins. This dataframe must contain two variables: 
i) "gene_name": indicating the same protein names to those present in 
the variable  "Accession" from the "peptides_proteins", third dataframe in the 
list defined as "spectral_count_object"; and, ii) "ko": indicating the 
KEGG Orthology code assigned to a given protein. An example can be found in
this <a href="https://zenodo.org/record/3997093">repository</a>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taxonomic_db</code></td>
<td>
<p>Dataframe containing the taxonomic information 
for each protein. The first column must contain the same identifiers 
of those present in the column "Accession" from the dataframe 
"peptides_proteins" of the "metaproteome_object". Two additional columns 
have to be present: i) one named "organism" containing the name of the strain
assigned to a given protein; and ii) the other named 
"species.genus.family.order.class.phylum.superkingdom". 
The taxonomic classification can be obtained from a tool of 
sequences aligment and must be ordered as follows: species, genus, 
family, order, class, phylum and superkingdom. The characters inside must 
be concatenated by a comma without spaces 
(ex. "Streptococcus anginosus,Streptococcus,Streptococcaceae,Lactobacillales,Bacilli,Firmicutes,Bacteria").
An example can be found in this <a href="https://zenodo.org/record/3997093">repository</a>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metaproteome_origin</code></td>
<td>
<p>List defined as "metaproteome_object" generated
from the function 'load_protspeps'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>protein_file</code></td>
<td>
<p>Character indicating the location of a txt 
file containing the list of proteins generated in 
<a href="http://pappso.inrae.fr/bioinfo/xtandempipeline/">X!TandemPipeline</a> 
using an adapted iterative approach described by 
<a href="https://www.theses.fr/2019SORUS043">Bassignani, 2019</a>. 
Separation between columns should be indicated by tabulation. 
For more details regarding data input check 
<a href="https://forgemia.inra.fr/pappso/metaprotr#data-inputs">format examples</a>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>peptide_file</code></td>
<td>
<p>Character indicating the location of a txt 
file containing peptides abundances expressed as spectral counts.
This file is generated from 
<a href="http://pappso.inrae.fr/bioinfo/xtandempipeline/">X!TandemPipeline</a> 
using an adapted iterative approach described by 
<a href="https://www.theses.fr/2019SORUS043">Bassignani, 2019</a>. 
Separation between columns should be indicated by tabulation. 
For more details regarding data input check 
<a href="https://forgemia.inra.fr/pappso/metaprotr#data-inputs">format examples</a>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text_to_filter</code></td>
<td>
<p>Character containig a part of text to be searched in 
the "Description" of the protein file. All the elements containing this 
character will be removed. The default value was set to "HUMAN".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taxonomic_levels_allowed</code></td>
<td>
<p>Numeric value indicating the maximal
number of taxonomic levels allowed per spectral group or subgroup (in function
of the type of spectral data). The default value is set to 1.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list defined as "spectral_count_object" with the functional 
annotation added to the identified proteins. A new column is added to 
the dataframe "peptides_proteins". Two quality control plot are also generated,
one with the number of taxonomic entities per spectral level and another with
the number of KO terms per spectral level.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 

# Download functional and taxonmical annotation db: https://zenodo.org/record/3997093#.X0UYI6Zb_mE 
meta99_full_taxo &lt;- read.csv2("full_taxonomy_MetaHIT99.tsv", header= TRUE, sep="\t")
kegg_db &lt;- read.csv2("hs_9_9_igc_vs_kegg89.table", header = TRUE, sep = "\t")

# Files with spectral abundance and proteins list from X!Tandempipeline
protein_file &lt;- "your/specific/location/protein_list.txt"
peptide_file &lt;- "your/specific/location/peptide_counting.txt"
metadata_file &lt;- "your/location/metadata.csv"

metaproteome_origin &lt;- load_protspeps(protein_file, peptide_file, metadata_file)

SCsgp_species &lt;- crumble_taxonomy(SC_subgroups, "species")

SCsgp_species_annot &lt;- add_kegg(
  SCsgp_species, 
  kegg_db, 
  meta99_full_taxo, 
  metaproteome_origin, 
  protein_file, 
  peptide_file, 
  text_to_filter = "HUMAN"
)


## End(Not run)
</code></pre>


</div>