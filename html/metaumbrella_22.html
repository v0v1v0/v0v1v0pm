<div class="container">

<table style="width: 100%;"><tr>
<td>umbrella</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Conduct the calculations for an umbrella review</h2>

<h3>Description</h3>

<p>This function performs various calculations needed for an umbrella review.
</p>


<h3>Usage</h3>

<pre><code class="language-R">umbrella(
  x,
  method.var = "REML",
  mult.level = FALSE,
  r = 0.5,
  method.esb = "TESSPSST",
  true_effect = "UWLS",
  pre_post_cor = NA,
  seed = NA,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a well-formatted dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method.var</code></td>
<td>
<p>the estimator used to quantify the between-study variance in the random-effects meta-analysis. Default is the Restricted Likelihood Maximum ("REML") estimator. Alternatively, DerSimonian and Laird <code>"DL"</code>, Hartung-Knapp-Sidik-Jonkman <code>"hksj"</code> (applies a Hartung-Knapp-Sidik-Jonkman adjustment on the results of a <code>"DL"</code> estimator), maximum-likelihood <code>"ML"</code> or Paule-Mandel <code>"PM"</code> estimators can be used. A fixed-effect meta-analysis can be obtained by indicated the <code>method.var = "FE"</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mult.level</code></td>
<td>
<p>a logical variable indicating the presence of multiple effect sizes per study in at least one factor of the umbrella review. Default is <code>FALSE</code> (i.e., each study of all factors include only one effect size). If <code>mult.level = TRUE</code> is specified, the Borenstein's methods are used to generate only one effect size per study. See <code>metaumbrella-package</code> for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>a correlation coefficient indicating the strength of the association between multiple outcomes (or time-points) within the same study. The <code>r</code> value is applied to all studies with a <code>"outcomes"</code> value in the <code>reverse_es</code> column that have no indication of correlation in the well-formatted dataset. Default is 0.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method.esb</code></td>
<td>
<p>the method used to conduct the excess of statistical significance test. It must be <code>"IT.binom"</code>, <code>"IT.chisq"</code>, <code>"PSST"</code>, <code>"TESS"</code> or <code>"TESSPSST"</code>  (see details). Default is <code>TESSPSST</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>true_effect</code></td>
<td>
<p>the method to estimate the true effect in the test for excess significance. It must be <code>"largest"</code>, <code>"UWLS"</code>, <code>"pooled"</code> or a numeric value (see details). Default is <code>"UWLS"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pre_post_cor</code></td>
<td>
<p>The value of the correlation coefficient between baseline and follow-up scores in pre-post studies. If your umbrella review includes pre-post controlled studies, you should indicate the mean pre-post correlation across groups. Only needed when using the SMC measure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>an integer value used as an argument by the set.seed() function. Only used for the <code>"IT.binom"</code> and <code>"IT.chisq"</code> tests for excess significance with ratios (i.e., “OR”, “RR”, “IRR” or their logarithm) as effect size measures.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>a logical variable indicating whether text outputs and messages should be generated. We recommend turning this option to FALSE only after having carefully read all the generated messages.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function automatically performs calculations allowing to stratify evidence according to various criteria.
For each factor included in a well-formatted dataset, this function automatically:
</p>

<ul>
<li>
<p> performs fixed- or random-effects meta-analyses.
</p>
</li>
<li>
<p> provides an estimation of the between-study variance and heterogeneity using three indicators (<code class="reqn">tau^2</code>, Q-statistic and <code class="reqn">I^2</code> statistic).
</p>
</li>
<li>
<p> estimates the 95% prediction interval (if the number of studies is equal or larger to 3).
</p>
</li>
<li>
<p> provides an identification of the statistical significance of the largest study included in the meta-analysis.
</p>
</li>
<li>
<p> provides an assessment of publication bias using the Egger's test (if the number of studies is equal or larger to 3).
</p>
</li>
<li>
<p> provides an assessment of excess significance using various methods.
</p>
</li>
<li>
<p> performs a jackknife leave-one-out meta-analysis (if the number of studies is equal or larger to 2).
</p>
</li>
<li>
<p> calculates the proportion of participants included in studies at low risk of bias (if study quality is indicated in the dataset).
</p>
</li>
</ul>
<p>A specificity of the <code>umbrella()</code> function is that it does not include arguments to specify the name of the columns of the dataset used as input.
Instead, the function requires users to prepare a dataset that meets fixed rules.
Details on how building this <code>well-formatted dataset</code> are given in the <code>metaumbrella-package</code> section of this manual. A vignette also provides a step-by-step tutorial.
Moreover, examples of <code>well-formatted datasets</code> are available as data distributed along with the package (see df.OR, df.OR.multi, df.R, df.SMC,df.SMD, df.RR, df.HR, df.IRR).
</p>
<p>When estimating the test for excess significance, the <code>umbrella()</code> function must assume a best approximation of the true effect.
The <code>true_effect</code> argument can be used to select the method that will be applied to estimate the true effect.
</p>

<ul>
<li>
<p> If <code>"largest"</code> is entered, the true effect size is assumed to be equal to the effect size of the largest study included in the meta-analysis.
</p>
</li>
<li>
<p> If <code>"pooled"</code> is entered, the true effect size is assumed to be equal to the meta-analytic pooled effect size.
</p>
</li>
<li>
<p> If <code>"UWLS"</code> is entered, the true effect size is assumed to be equal to unrestricted weighted least squares weighted average.
</p>
</li>
<li>
<p> If a <code>numeric</code> value is entered, the true effect size is assumed to be equal to the value entered by the user (note that the value of ratios must be in their natural scale).
</p>
</li>
</ul>
<p>Last, this function performs a statistical test to determine whether the observed number of statistically significant studies is higher than expected given the mean statistical power. The <code>method.esb</code> argument can be used to select the test. Details on each method can be found in the <code>esb.test</code> section.
</p>


<h3>Value</h3>

<p>The <code>umbrella()</code> function returns an object of class “umbrella”, which is a list containing information required for stratifying the evidence.
This list contains, for each factor included in the umbrella review:
</p>

<table>
<tr>
<td style="text-align: left;">
<code>factor</code> </td>
<td style="text-align: left;"> the name of the factor analyzed.</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>measure</code> </td>
<td style="text-align: left;"> the measure of the effect used to perform the calculations.</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>x</code> </td>
<td style="text-align: left;"> the data used to conduct the meta-analysis. Note that these data may be</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> slightly different from the raw data introduced.</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>x_multi</code> </td>
<td style="text-align: left;"> the original data when there is a multivariate structure.</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> Note that these data may be slightly different from the raw data introduced.</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>x_shared</code> </td>
<td style="text-align: left;"> a dataframe allowing to visualize adjustments made when a shared_nexp</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> or shared_controls correction is requested</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> (see <code>metaumbrella-package</code> for more information).</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>n</code> </td>
<td style="text-align: left;"> the overall number of studies, cases and controls.</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>method.var</code> </td>
<td style="text-align: left;"> the estimator used for fitting the random effects meta-analyses</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>ma_results</code> </td>
<td style="text-align: left;"> pooled effect size, p-value and 95% confidence interval and prediction</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;">  interval of the meta-analysis.</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>largest</code> </td>
<td style="text-align: left;"> 95% confidence interval of the largest study.</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>heterogeneity</code> </td>
<td style="text-align: left;"> <code class="reqn">tau^2</code>, <code class="reqn">I^2</code> and results of the Q-test.</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>egger</code> </td>
<td style="text-align: left;"> estimate and p-value of the Egger's test for publication bias.</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>esb</code> </td>
<td style="text-align: left;"> results of the test for excess significance bias. See</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> <code>esb.test()</code> for more information.</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>riskofbias</code> </td>
<td style="text-align: left;"> percentage of participants in studies at low risk of bias.</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>amstar</code> </td>
<td style="text-align: left;"> AMSTAR score obtained by the meta-analysis.</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>evidence</code> </td>
<td style="text-align: left;"> evidence class according to some criteria.
</td>
</tr>
</table>
<p>The functions <code>print</code> and <code>summary</code> may be used to print the details or a summary of the results.
</p>


<h3>References</h3>

<p>Fusar-Poli, P., Radua, J. (2018).  Ten simple rules for conducting umbrella reviews.
<em>Evidence-Based Mental Health</em>, <b>21</b>, 95–100.<br>
Radua, J., Ramella-Cravaro, V., Ioannidis, J.P.A., Reichenberg, A., Phiphopthatsanee, N., Amir, T., Yenn Thoo, H., Oliver, D., Davies, C., Morgan, C., McGuire, P., Murray, R.M., Fusar-Poli, P. (2018)
What causes psychosis? An umbrella review of risk and protective factors.
<em>World Psychiatry</em>, <b>17</b>, 49–66.
</p>


<h3>See Also</h3>

<p><code>metaumbrella-package</code> for the formatting of well-formatted datasets<br><code>add.evidence()</code> for stratifying the evidence in an umbrella review<br><code>forest()</code> for drawing a forest plot of the factors included in an umbrella review<br><code>subset.umbrella()</code> for retrieving a subset of the factors included in an umbrella review<br><code>union.umbrella()</code> for combining the factors included in two umbrella reviews
</p>


<h3>Examples</h3>

<pre><code class="language-R">
### Perform an umbrella review with random-effects meta-analyses
### with a Hartung-Knapp-Sidik-Jonkman estimator
umb &lt;- umbrella(df.IRR, method.var = "hksj")

### obtain the results of the calculations in a dataframe
summary(umb)

### manually inspect the results of the umbrella review calculations for the 'Smoking' factor
### included in the dataset.
umb$Smoking

### Perform a meta-analysis with multilevel data, assuming a correlation of 0.8
### between all outcomes of the same study
umb.multi &lt;- umbrella(df.OR.multi, mult.level = TRUE, r = 0.8)

### obtain a stratification of the evidence according to the Ioannidis classification
add.evidence(umb.multi, criteria = "Ioannidis")

</code></pre>


</div>