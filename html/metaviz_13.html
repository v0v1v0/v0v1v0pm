<div class="container">

<table style="width: 100%;"><tr>
<td>viz_funnel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Funnel plot variants for meta-analysis</h2>

<h3>Description</h3>

<p>Creates a funnel plot. Many options regarding the appearance and
statistical information displayed are provided (e.g., significance contours, additional evidence contours, and
trim-and-fill analysis).
</p>


<h3>Usage</h3>

<pre><code class="language-R">viz_funnel(
  x,
  group = NULL,
  y_axis = "se",
  method = "FE",
  contours = TRUE,
  sig_contours = TRUE,
  addev_contours = FALSE,
  contours_col = "Blues",
  contours_type = "FEM",
  detail_level = 1,
  egger = FALSE,
  trim_and_fill = FALSE,
  trim_and_fill_side = "left",
  text_size = 3,
  point_size = 2,
  xlab = "Effect",
  ylab = NULL,
  group_legend = FALSE,
  group_legend_title = "",
  x_trans_function = NULL,
  x_breaks = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>data.frame or matrix with the effect sizes of all studies (e.g.,
correlations, log odds ratios, or Cohen <em>d</em>) in the first column and their
respective standard errors in the second column. Alternatively, x can be the
output object of function <code>rma.uni</code> from package
<span class="pkg">metafor</span>; then effect sizes and standard errors are extracted from <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>factor indicating the subgroup of each study to show in the funnel plot. Has to be in the same order than <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_axis</code></td>
<td>
<p>character string indicating which y axis should be used in the funnel plot. Available options are "se" (default) for
standard error and "precision" for the reciprocal of the standard error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>character string indicating the method used to compute the meta-analytic summary effect and, for a random effects model,
the between-study variance <code class="reqn">\tau^2</code>. Can be any method argument from <code>rma.uni</code>
(e.g., "FE" for the fixed effect model, or "DL" for the random effects model using the DerSimonian-Laird method to estimate <code class="reqn">\tau^2</code>).
If input <code>x</code> is an output object of function <code>rma.uni</code> from package <span class="pkg">metafor</span>, then the method is extracted from <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contours</code></td>
<td>
<p>logical scalar indicating if classic funnel plot confidence contours and the summary effect
should be displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig_contours</code></td>
<td>
<p>logical scalar. Should significance contours be drawn (at the 0.05 or 0.01 level using a Wald test)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>addev_contours</code></td>
<td>
<p>logical scalar. Should approximate additional evidence contours be drawn, showing the significance of the updated summary effect? See Details.
Note: For <code>method</code> other than "FE" or "DL" runtime is increased significantly. Consider reducing <code>detail_level</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contours_col</code></td>
<td>
<p>character string indicating the color palette used from package <span class="pkg">RColorBrewer</span> for
<code>sig_contours</code>, and <code>addev_contours</code>. Can be any of "Blues", "Greys", "Oranges", "Greens", "Reds", and "Purples".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contours_type</code></td>
<td>
<p>character string indicating how confidence contours are computed.
Must be either "FEM" or "REM". If contours_type is set to "FEM" (default), contours are given as M +/- qnorm(0.975)*SE,
with M the meta-analytic summary effect and SE the study standard error. If contours_type is set to "REM", contours are given as
M +/- qnorm(0.975)*sqrt(SE^2 + <code class="reqn">\tau^2</code>), with M again the meta-analytic summary effect, SE the study standard error
and <code class="reqn">\tau^2</code> the esimated between study heterogeneity from a random effects model. The argument of contours_type has no effect if <code class="reqn">\tau^2</code> is zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>detail_level</code></td>
<td>
<p>numeric scalar. Allows to increase or decrease the plotting detail of contours. Values can be chosen between 0.1 and 10. Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>egger</code></td>
<td>
<p>logical scalar. Should Egger's regression line be drawn? Only available if <code>y_axis</code> is <code>"se"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trim_and_fill</code></td>
<td>
<p>logical scalar. Should studies imputed by the trim and fill method be displayed? Also shows the adjusted summary
effect if <code>contours</code> is <code>TRUE</code> as well.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trim_and_fill_side</code></td>
<td>
<p>character string indicating on which side of the funnel plot studies should be imputed by the trim and fill method (i.e., on which side are studies presumably missing due to publication bias).
Must be either "right" or "left" (default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text_size</code></td>
<td>
<p>numeric value. Size of text in the funnel plot. Default is 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>point_size</code></td>
<td>
<p>numeric value. Size of the study points in the funnel plot. Default is 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>character string specifying the label of the x axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>character string specifying the label of the y axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group_legend</code></td>
<td>
<p>logical scalar. Should there be a legend shown at the bottom of the graph if <code>group</code> was supplied?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group_legend_title</code></td>
<td>
<p>a character string specifying the title of the legend if <code>group</code> was supplied and <code>group_legend</code> is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_trans_function</code></td>
<td>
<p>function to transform the labels of the x axis. Common uses are to transform
log-odds-ratios or log-risk-ratios with <code>exp</code> to their original scale (odds ratios and risk ratios), or Fisher's z values
back to correlation coefficients using <code>tanh</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_breaks</code></td>
<td>
<p>numeric vector of values for the breaks on the x-axis. When used in tandem with <code>x_trans_function</code>
the supplied values should be not yet transformed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The funnel plot is a widely used diagnostic plot in meta-analysis to assess small study effects
and in particular publication bias. The function <code>viz_funnel</code> is capable to create a large set of different funnel plot variants.
Options for several graphical augmentations (e.g., confidence, significance, and additional evidence contours; choice of the ordinate; study subgroups), and
different statistical information displayed are provided (Egger's regression line, and imputed studies by, as well as the adjusted summary effect from,
the trim-and-fill method).
</p>
<p><b>Contours</b>
</p>
<p>Three different contours are available in <code>viz_funnel</code>:
</p>

<ol>
<li> <p><b>confidence contours</b> (argument <code>contours</code>) show the region where one expects 95% of all studies to fall (assuming the meta-analytic model
applied is true and all estimates are identical to the parameters of interest).
Confidence contours can help to assess the plausibility of observations given the meta-analytic model specified (fixed effect or random effects model).
</p>
</li>
<li> <p><b>significance contours</b> (argument <code>sig_contours</code>) show shaded regions of individual study significance at the 5% and 1% level
(using the standard errors supplied and a Wald test). Significance contours were proposed to help distinguish publication bias from other sources of
funnel plot asymmetry (Peters, Sutton, Jones, Abrams, &amp; Rushton, 2008).
</p>
</li>
<li> <p><b>additional evidence contours: Significance of the summary effect</b> (argument <code>addev_contours</code>). These contours define regions
where a new study has to fall such that the updated meta-analytic summary effect is significantly different from zero or not
(using a two-sided test and an alpha level of 5%). Additional evidence contours allow to assess the robustness of the meta-analysis with respect to
the effect of potentially new published evidence on the significance of the meta-analytic summary effect (Langan, Higgins, Gregory, &amp; Sutton, 2012).
</p>
</li>
</ol>
<p><b>Measure on the y-axis</b>
</p>
<p>Two different options for the y-axis choice are available. First, to plot the standard errors on a reversed axis
(i.e., studies with small standard errors are at the top). Second, precision (i.e., 1 divided by the standard error) can be used.
Standard errors on the y-axis should be preferred in most situations but precision might have advantages if one or few large studies
(with high precision) should be compared to the results of smaller studies condensed at the bottom of the funnel plot (Sterne &amp; Egger, 2001).
</p>
<p><b>Egger's regression line</b>
</p>
<p>Egger's regression line (Egger, Smith, Schneider &amp; Minder, 1997) can be displayed if the standard error is used on the y axis.
Classic Egger's regression can be computed as the OLS estimator of regressing the standardized effect size (effect size divided by its standard error)
on precision (1 divided by the standard error). Showing this line in the funnel plot can further help to visually assess funnel plot asymmetry.
</p>
<p><b>Trim and fill analysis</b>
</p>
<p>Imputed studies by the trim-and fill method, as well as the adjusted summary effect (Duval &amp; Tweedie, 2000) can be displayed.
The trim-and fill algorithm basically estimates the number of (extreme) studies responsible for funnel plot asymmetry.
It then trims this number of (extreme) studies and computes the adjusted summary effect only considering the remaining studies.
Finally, it imputes studies - presumably missing due to publication bias - by mirroring the trimmed (extreme) studies (driving the funnel plot asymmetry)
around the (adjusted) summary effect. The user has to specify on which side of the funnel plot the trim-and fill method should impute missing studies
(i.e., the direction were studies are presumably missing due to publication bias). To estimate the number of (extreme) studies responsible for funnel plot
asymmetry the L estimator defined in Duval and Tweedie (2000) is used.
</p>


<h3>Value</h3>

<p>A funnel plot is created using ggplot2.
</p>


<h3>Author(s)</h3>

<p>Michael Kossmeier* &lt;michael.kossmeier@univie.ac.at&gt;
</p>
<p>Ulrich S. Tran* &lt;ulrich.tran@univie.ac.at&gt;
</p>
<p>Martin Voracek* &lt;martin.voracek@univie.ac.at&gt;
</p>
<p>*Department of Basic Psychological Research and Research Methods, School of Psychology, University of Vienna
</p>


<h3>References</h3>

<p>Duval, S., &amp; Tweedie, R. (2000). Trim and fill: a simple funnel-plot-based method of testing and adjusting for publication bias
in meta-analysis. <em>Biometrics</em>, <em>56</em>, 455-463.
</p>
<p>Egger, M., Smith, G. D., Schneider, M., &amp; Minder, C. (1997). Bias in meta-analysis detected by a simple, graphical test. <em>Bmj</em>, <em>315</em>, 629-634.
</p>
<p>Langan, D., Higgins, J. P., Gregory, W., &amp; Sutton, A. J. (2012). Graphical augmentations to the funnel plot assess the impact of
additional evidence on a meta-analysis. <em>Journal of clinical epidemiology</em>, <em>65</em>, 511-519.
</p>
<p>Peters, J. L., Sutton, A. J., Jones, D. R., Abrams, K. R., &amp; Rushton, L. (2008). Contour-enhanced meta-analysis
funnel plots help distinguish publication bias from other causes of asymmetry. <em>Journal of clinical epidemiology</em>, <em>61</em>,
991-996.
</p>
<p>Sterne, J. A., &amp; Egger, M. (2001). Funnel plots for detecting bias in meta-analysis: guidelines on choice of axis.
<em>Journal of clinical epidemiology</em>, <em>54</em>, 1046-1055
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(metaviz)
# Create a funnel plot using confidence and significance contours
viz_funnel(x = mozart[, c("d", "se")])

# Show a trim-and-fill analysis and Egger's regression line:
viz_funnel(x = mozart[, c("d", "se")], contours = TRUE,
trim_and_fill = TRUE, trim_and_fill_side = "left", egger = TRUE)

# Plot log-odds-ratios on the original OR scale and show additional evidence contours:
viz_funnel(x = exrehab[, c("logor", "logor_se")], sig_contours = FALSE,
addev_contours = TRUE, contours_col = "Greys", xlab = "Odds Ratio",
x_trans_function = exp, x_breaks = log(c(0.125, 0.25, 0.5, 1, 2, 4, 8)))

# Show study subgroups
viz_funnel(x = mozart[, c("d", "se")], group = mozart[, "unpublished"],
group_legend_title = "unpublished?")
</code></pre>


</div>