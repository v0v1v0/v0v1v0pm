<div class="container">

<table style="width: 100%;"><tr>
<td>funnelinf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Visual funnel plot inference for meta-analysis</h2>

<h3>Description</h3>

<p>Creates a lineup of funnel plots to conduct visual funnel plot inference (Kossmeier, Tran, &amp; Voracek, 2019). The funnel plot showing the actually supplied data is
presented alongside null plots showing simulated data under the null hypothesis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">funnelinf(
  x,
  group = NULL,
  group_permut = FALSE,
  n = 20,
  null_model = "REM",
  y_axis = "se",
  contours = TRUE,
  sig_contours = TRUE,
  contours_col = "Blues",
  trim_and_fill = FALSE,
  trim_and_fill_side = "left",
  egger = FALSE,
  show_solution = FALSE,
  rorschach = FALSE,
  point_size = 1.5,
  text_size = 3,
  xlab = "Effect",
  ylab = NULL,
  x_trans_function = NULL,
  x_breaks = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>data.frame or matrix with the effect sizes of all studies (e.g.,
correlations, log odds ratios, or Cohen <em>d</em>) in the first column and their
respective standard errors in the second column. Alternatively, x can be the
output object of function <code>rma.uni</code> from package
<span class="pkg">metafor</span>; then effect sizes and standard errors are extracted from <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>factor indicating the subgroup of each study to show in the funnel plot. Has to be in the same order than <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group_permut</code></td>
<td>
<p>logical scalar indicating if subgroup membership should be permuted
in the null plots. Ignored if no group is supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>integer specifying the absolute number of plots in the lineup.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null_model</code></td>
<td>
<p>character string indicating which meta-analytic model should be used to simulate the effect sizes for the null plots.
Available options are "FEM" for the fixed effect model and "REM" (default) for the random-effects model (using the
DerSimonian-Laird method to estimate the between-study variance <code class="reqn">\tau^2</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_axis</code></td>
<td>
<p>character string indicating which y axis should be used in the funnel plot. Available options are "se" (default) for
standard error and "precision" for the reciprocal of the standard error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contours</code></td>
<td>
<p>logical scalar indicating if classic funnel plot confidence contours and the summary effect should be displayed (i.e., summary effect +/-
qnorm(0.975) * SE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig_contours</code></td>
<td>
<p>logical scalar. Should significance contours be drawn? Significance contours show which combination of
effect size and standard error lead to study p-values smaller than 0.05 or 0.01 (using a Wald test).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contours_col</code></td>
<td>
<p>character string indicating the color palette used from package <span class="pkg">RColorBrewer</span> for
<code>sig_contours</code>. Can be any of "Blues", "Greys", "Oranges", "Greens", "Reds", and "Purples".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trim_and_fill</code></td>
<td>
<p>logical scalar. Should studies imputed by the trim and fill method be displayed? Also shows the adjusted summary
effect if <code>contours</code> is <code>TRUE</code> as well.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trim_and_fill_side</code></td>
<td>
<p>character string indicating on which side of the funnel plot studies should be imputed by the trim and fill method (i.e., on which side studies are presumably missing due to publication bias).
Must be either "right" or "left" (default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>egger</code></td>
<td>
<p>logical scalar. Should Egger's regression line be drawn? Only available if <code>y_axis</code> is <code>"se"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_solution</code></td>
<td>
<p>logical scalar. Should the real-data plot be highlighted?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rorschach</code></td>
<td>
<p>logical scalar. Should the lineup only consist of null plots?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>point_size</code></td>
<td>
<p>numeric value. Size of the study points in the funnel plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text_size</code></td>
<td>
<p>numeric value. Size of text in the lineup.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>character string specifying the label of the x axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>character string specifying the label of the y axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_trans_function</code></td>
<td>
<p>function to transform the labels of the x axis. Common uses are to transform
log-odds-ratios or log-risk-ratios with <code>exp</code> to their original scale (odds ratios and risk ratios), or Fisher's z values
back to correlation coefficients using <code>tanh</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_breaks</code></td>
<td>
<p>numeric vector of values for the breaks on the x-axis. When used in tandem with <code>x_trans_function</code>
the supplied values should be not yet transformed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Funnel plots are widely used in meta-analysis to assess small study effects as potential indicator for publication bias.
However, interpretations of funnel plots often lead to false conclusions about the presence and severity of bias (e.g., Terrin, Schmid, and Lau, 2005).
Visual inference (Buja et al. 2009; Majumder, Hofmann, and Cook 2013) can help to improve the validity of conclusions based on the visual inspection of a
funnel plot by saving investigators from interpreting funnel-plot patterns which might be perfectly plausible by chance.
Only if the real-data funnel plot is distinguishable from null-plots, the null hypothesis is formally rejected and
conclusions based on the visual inspection of the real-data funnel plot might be warranted (for further details, see Kossmeier, Tran, &amp; Voracek, 2019).
</p>
<p>Function <code>funnelinf</code> utilizes package <span class="pkg">nullabor</span> for null plot simulation and <span class="pkg">ggplot2</span> for
plotting the lineup. Several tailored features for visual inference with funnel plots are provided which currently include:
</p>

<ol>
<li>
<p> options for null-plot simulation under both FEM and REM meta-analysis (see below).
</p>
</li>
<li>
<p> subgroup analysis.
</p>
</li>
<li>
<p> graphical options specific to the funnel plot (significance and confidence contours, and choice of the ordinate).
</p>
</li>
<li>
<p> additional options to display various statistical information (Egger's regression line, and imputed studies by, as well as the adjusted summary effect from, the trim-and-fill method).
</p>
</li>
</ol>
<p>Null plots are simulated assuming normally distributed effect sizes with expected value equal to the observed summary effect and variance
either equal to the observed study variances (<code>null_model = "FEM"</code>) or the sum of the observed study variances and the estimated
between study variance <code class="reqn">\tau^2</code> (<code>null_model = "REM"</code>).
</p>


<h3>Value</h3>

<p>A lineup of n (20 by default) funnel plots; one showing the real data and n-1 showing
simulated data under the null hypothesis
</p>


<h3>Author(s)</h3>

<p>Michael Kossmeier* &lt;michael.kossmeier@univie.ac.at&gt;
</p>
<p>Ulrich S. Tran* &lt;ulrich.tran@univie.ac.at&gt;
</p>
<p>Martin Voracek* &lt;martin.voracek@univie.ac.at&gt;
</p>
<p>*Department of Basic Psychological Research and Research Methods, School of Psychology, University of Vienna
</p>


<h3>References</h3>

<p>Buja, A., Cook, D., Hofmann, H., Lawrence, M., Lee, E. K., Swayne, D. F., &amp; Wickham, H. (2009).
Statistical inference for exploratory data analysis and model diagnostics.
<em>Philosophical Transactions of the Royal Society of London A: Mathematical, Physical and Engineering Sciences</em>,
<em>367</em>, 4361-4383.
</p>
<p>Kossmeier, M., Tran, U. &amp; Voracek, M. (2019) Visual inference for the funnel plot in meta-analysis. <em>Zeitschrift f√ºr Psychologie - Journal of Psychology</em>, <em>227</em>.
</p>
<p>Majumder, M., Hofmann, H., &amp; Cook, D. (2013). Validation of visual statistical inference, applied to linear models.
<em>Journal of the American Statistical Association</em>, <em>108</em>, 942-956.
</p>
<p>Terrin, N., Schmid, C. H., &amp; Lau, J. (2005). In an empirical evaluation of the funnel plot, researchers could not
visually identify publication bias. <em>Journal of clinical epidemiology</em>, <em>58</em>, 894-901.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Plotting a funnel plot lineup with the exrehab data to conduct visual funnel plot inference
funnelinf(x = exrehab[, c("logrr", "logrr_se")])

# Plotting a funnel plot lineup with the mozart data to conduct visual funnel plot inference
# considering subgroups
funnelinf(x = mozart[, c("d", "se")],
group = mozart[, "rr_lab"],
group_permut = TRUE, null_model = "REM")

# Plotting a funnel plot lineup with the brainvolume data to conduct visual funnel plot inference
# considering heterogeneity by using the fixed effect model for null plot simulation
funnelinf(x = brainvol[, c("z", "z_se")],
null_model = "FEM")

## End(Not run)
</code></pre>


</div>