<div class="container">

<table style="width: 100%;"><tr>
<td>logLikZ</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute log-likelihood z-score</h2>

<h3>Description</h3>

<p><code>logLikZ.meteDist</code> computes a log-likelihood z-score by simulation from a
fitted METE distribution
</p>


<h3>Usage</h3>

<pre><code class="language-R">logLikZ(x, ...)

## S3 method for class 'meteDist'
logLikZ(x, nrep = 999, return.sim = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a <code>meteDist</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments to be passed to methods</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrep</code></td>
<td>
<p>number of simulations from the fitted METE distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.sim</code></td>
<td>
<p>logical; return the simulated liklihood values</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>logLikZ.meteDist</code> simulates from a fitted METE distribution (e.g. a species
abundance distribution or individual power distribution) and calculates the
likelihood of these simulated data sets. The distribution of these values is compared
against the likelihood of the data to obtain a z-score, specifically
z = ((logLik_obs - mean(logLik_sim)) / sd(logLik_sim))^2.
This value is squared so that it will be approximately Chi-squared distributed and a
goodness of fit test naturally arrises as <code>1 - pchisq(z, df=1)</code>.
</p>


<h3>Value</h3>

<p>list with elements
</p>

<dl>
<dt>z</dt>
<dd>
<p>The z-score</p>
</dd>
<dt>sim</dt>
<dd>
<p><code>nrep</code> Simulated values (scaled by mean and sd as is the z-score) if return.sim=TRUE, NULL otherwise</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Andy Rominger &lt;ajrominger@gmail.com&gt;, Cory Merow
</p>


<h3>References</h3>

<p>Harte, J. 2011. Maximum entropy and ecology: a theory of abundance, distribution, and energetics. Oxford University Press.
</p>


<h3>See Also</h3>

<p>mseZ.meteDist
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(arth)
## object holding ecosystem structure function
esf1 &lt;- meteESF(spp=arth$spp,
                abund=arth$count,
                power=arth$mass^(.75),
                minE=min(arth$mass^(.75)))
## calculate individual power distribution
ipd1 &lt;- ipd(esf1)
## calculate z-score, keeping all simulated log likelihoods for plotting
llz &lt;- logLikZ(ipd1, nrep=100, return.sim=TRUE)

plot(density(llz$sim),xlim=range(c(llz$sim,llz$obs)),
     xlab='scaled log(likelihood)^2',col='red')
abline(v=llz$z,lty=2)
legend('top',legend=c('data','simulated'),col=c('black','red'),
      lty=c(1,1),bty='n')
</code></pre>


</div>