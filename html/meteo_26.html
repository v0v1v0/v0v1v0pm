<div class="container">

<table style="width: 100%;"><tr>
<td>rfilltimegaps</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Disaggregation in the time dimension through the use of splines for each pixel</h2>

<h3>Description</h3>

<p>The function creates an object of STFDF-class class, spatio-temporal data with full space-time grid, from another STFDF-class and fills attribute data for missing values in time using splines.</p>


<h3>Usage</h3>

<pre><code class="language-R">rfilltimegaps(stfdf,
              tunits="day",
              attrname=1,
              ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>stfdf</code></td>
<td>
<p>STFDF-class; object with time information of minimum length 2, and gap in time dimension.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tunits</code></td>
<td>
<p><code>character</code>; increment of the sequence used to generete time infromation for temporal gap. See 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>attrname</code></td>
<td>
<p><code>integer</code> or <code>character</code>; varible from STFDF-class to be splined in time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to splinefun, function spline.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>tunits</code> can be specified in several ways:
</p>

<ul>
<li>
<p>A number, taken to be in seconds
</p>
</li>
<li>
<p>A object of class difftime
</p>
</li>
<li>
<p>A character string, containing one of <code>"sec"</code>, <code>"min"</code>, <code>"hour"</code>, <code>"day"</code>, <code>"DSTday"</code>, <code>"week"</code>, <code>"month"</code>, <code>"quarter"</code> or <code>"year"</code>. This can optionally be preceded by a (positive or negative) integer and a space, or followed by <code>"s"</code>
</p>
</li>
</ul>
<p>The difference between <code>"day"</code> and <code>"DSTday"</code> is that the former ignores changes to/from daylight savings time and the latter takes the same clock time each day. (<code>"week"</code> ignores DST (it is a period of 144 hours), but <code>"7 DSTdays"</code>) can be used as an alternative. <code>"month"</code> and <code>"year"</code> allow for DST.)
</p>


<h3>Value</h3>

<p>STFDF-class object with filled temporal gaps.</p>


<h3>Author(s)</h3>

<p>Milan Kilibarda <a href="mailto:kili@grf.bg.ac.rs">kili@grf.bg.ac.rs</a></p>


<h3>References</h3>

<p>Kilibarda, M., T. Hengl, G. B. M. Heuvelink, B. Graeler, E. Pebesma, M. Percec Tadic, and B. Bajat (2014), Spatio-temporal interpolation of daily temperatures for global land areas at 1 km resolution, J. Geophys. Res. Atmos., 119, 2294-2313, doi:10.1002/2013JD020803;
</p>
<p>Kilibarda M., M. Percec Tadic, T. Hengl, J. Lukovic, B. Bajat - Spatial Statistics (2015), Global geographic and feature space coverage of temperature data in the context of spatio-temporal interpolation, doi:10.1016/j.spasta.2015.04.005.
</p>


<h3>See Also</h3>

<p><code>rfillspgaps</code>
<code>pred.strk</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  data(nlmodis20110704)
  data(nlmodis20110712)
  data(NLpol)

  # fill spatial gaps
  library(raster)
  NLpol@proj4string &lt;- nlmodis20110704@proj4string
  
  
  nlmodis20110704 &lt;- rfillspgaps(nlmodis20110704,NLpol)
  nlmodis20110712 &lt;- rfillspgaps(nlmodis20110712,NLpol)
  
  nlmodis20110704 &lt;- as(nlmodis20110704,"SpatialPixelsDataFrame")
  names(nlmodis20110704)='m1'
  nlmodis20110712 &lt;- as(nlmodis20110712,"SpatialPixelsDataFrame")
  names(nlmodis20110712)='m2'
  
  nlmodis20110704@data &lt;- cbind(nlmodis20110704@data, nlmodis20110712@data)
  
  df&lt;-reshape(nlmodis20110704@data , varying=list(1:2), v.names="modis",direction="long", 
            times=as.Date(c('2011-07-04','2011-07-12')), ids=1:dim(nlmodis20110704)[1])
  
  library(spacetime)
  stMODIS&lt;- STFDF(as( nlmodis20110704, "SpatialPixels"), 
                  time= as.Date(c('2011-07-04','2011-07-12')), 
                  data.frame(modis=df[,'modis']))
  
  stplot(stMODIS, col.regions=bpy.colors())
  stMODIS &lt;- rfilltimegaps(stMODIS)
  stplot(stMODIS, col.regions=bpy.colors())
  
</code></pre>


</div>