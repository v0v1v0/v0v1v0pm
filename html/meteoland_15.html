<div class="container">

<table style="width: 100%;"><tr>
<td>interpolation_precipitation</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Low-level interpolation functions</h2>

<h3>Description</h3>

<p>Low-level functions to interpolate meteorology (one day) on a set of points.
</p>


<h3>Usage</h3>

<pre><code class="language-R">interpolation_precipitation(
  Xp,
  Yp,
  Zp,
  X,
  Y,
  Z,
  P,
  Psmooth,
  iniRp = 140000,
  alpha_event = 6.25,
  alpha_amount = 6.25,
  N_event = 20L,
  N_amount = 20L,
  iterations = 3L,
  popcrit = 0.5,
  fmax = 0.95,
  debug = FALSE
)

interpolation_dewtemperature(
  Xp,
  Yp,
  Zp,
  X,
  Y,
  Z,
  T,
  iniRp = 140000,
  alpha = 3,
  N = 30L,
  iterations = 3L,
  debug = FALSE
)

interpolation_temperature(
  Xp,
  Yp,
  Zp,
  X,
  Y,
  Z,
  T,
  iniRp = 140000,
  alpha = 3,
  N = 30L,
  iterations = 3L,
  debug = FALSE
)

interpolation_wind(
  Xp,
  Yp,
  WS,
  WD,
  X,
  Y,
  iniRp = 140000,
  alpha = 2,
  N = 1L,
  iterations = 3L,
  directionsAvailable = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Xp, Yp, Zp</code></td>
<td>
<p>Spatial coordinates and elevation (Zp; in m.a.s.l) of target
points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X, Y, Z</code></td>
<td>
<p>Spatial coordinates and elevation (Zp; in m.a.s.l) of reference
locations (e.g. meteorological stations).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>Precipitation at the reference locations (in mm).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Psmooth</code></td>
<td>
<p>Temporally-smoothed precipitation at the reference locations
(in mm).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iniRp</code></td>
<td>
<p>Initial truncation radius.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p>Number of station density iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>popcrit</code></td>
<td>
<p>Critical precipitation occurrence parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fmax</code></td>
<td>
<p>Maximum value for precipitation regression extrapolations (0.6
equals to a maximum of 4 times extrapolation).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debug</code></td>
<td>
<p>Boolean flag to show extra console output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T</code></td>
<td>
<p>Temperature (e.g., minimum, maximum or dew temperature) at the
reference locations (in degrees).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha, alpha_amount, alpha_event</code></td>
<td>
<p>Gaussian shape parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N, N_event, N_amount</code></td>
<td>
<p>Average number of stations with non-zero weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>WS, WD</code></td>
<td>
<p>Wind speed (in m/s) and wind direction (in degrees from north
clock-wise) at the reference locations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>directionsAvailable</code></td>
<td>
<p>A flag to indicate that wind directions are
available (i.e. non-missing) at the reference locations.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This functions exposes internal low-level interpolation functions written in C++
not intended to be used directly in any script or function. The are maintained for
compatibility with older versions of the package and future versions of meteoland
will remove this functions (they will be still accessible through the triple colon
notation (<code>:::</code>), but their use is not recommended)
</p>


<h3>Value</h3>

<p>All functions return a vector with interpolated values for the
target points.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>interpolation_precipitation()</code>: Precipitation
</p>
</li>
<li> <p><code>interpolation_dewtemperature()</code>: Dew temperature
</p>
</li>
<li> <p><code>interpolation_wind()</code>: Wind
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Miquel De Cáceres Ainsa, CREAF
</p>


<h3>References</h3>

<p>Thornton, P.E., Running, S.W., White, M. A., 1997. Generating
surfaces of daily meteorological variables over large regions of complex
terrain. J. Hydrol. 190, 214–251. doi:10.1016/S0022-1694(96)03128-9.
</p>
<p>De Caceres M, Martin-StPaul N, Turco M, Cabon A, Granda V (2018) Estimating
daily meteorological data and downscaling climate models over landscapes.
Environmental Modelling and Software 108: 186-196.
</p>


<h3>See Also</h3>

<p><code>defaultInterpolationParams</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
Xp &lt;- as.numeric(sf::st_coordinates(points_to_interpolate_example)[,1])
Yp &lt;- as.numeric(sf::st_coordinates(points_to_interpolate_example)[,2])
Zp &lt;- points_to_interpolate_example$elevation
X &lt;- as.numeric(
  sf::st_coordinates(stars::st_get_dimension_values(meteoland_interpolator_example, "station"))[,1]
)
Y &lt;- as.numeric(
  sf::st_coordinates(stars::st_get_dimension_values(meteoland_interpolator_example, "station"))[,2]
)
Z &lt;- as.numeric(meteoland_interpolator_example[["elevation"]][1,])
Temp &lt;- as.numeric(meteoland_interpolator_example[["MinTemperature"]][1,])
P &lt;- as.numeric(meteoland_interpolator_example[["Precipitation"]][1,])
Psmooth &lt;- as.numeric(meteoland_interpolator_example[["SmoothedPrecipitation"]][1,])
WS &lt;- as.numeric(meteoland_interpolator_example[["WindSpeed"]][1,])
WD &lt;- as.numeric(meteoland_interpolator_example[["WindDirection"]][1,])
iniRp &lt;- get_interpolation_params(meteoland_interpolator_example)$initial_Rp
alpha &lt;- get_interpolation_params(meteoland_interpolator_example)$alpha_MinTemperature
N &lt;- get_interpolation_params(meteoland_interpolator_example)$N_MinTemperature
alpha_event &lt;- get_interpolation_params(meteoland_interpolator_example)$alpha_PrecipitationEvent
N_event &lt;- get_interpolation_params(meteoland_interpolator_example)$N_PrecipitationEvent
alpha_amount &lt;- get_interpolation_params(meteoland_interpolator_example)$alpha_PrecipitationAmount
N_amount &lt;- get_interpolation_params(meteoland_interpolator_example)$N_PrecipitationAmount
alpha_wind &lt;- get_interpolation_params(meteoland_interpolator_example)$alpha_Wind
N_wind &lt;- get_interpolation_params(meteoland_interpolator_example)$N_Wind
iterations &lt;- get_interpolation_params(meteoland_interpolator_example)$iterations
popcrit &lt;- get_interpolation_params(meteoland_interpolator_example)$pop_crit
fmax &lt;- get_interpolation_params(meteoland_interpolator_example)$f_max
debug &lt;- get_interpolation_params(meteoland_interpolator_example)$debug

interpolation_temperature(
  Xp, Yp, Zp,
  X[!is.na(Temp)], Y[!is.na(Temp)], Z[!is.na(Temp)],
  Temp[!is.na(Temp)],
  iniRp, alpha, N, iterations, debug
)

interpolation_wind(
  Xp, Yp,
  WS[!is.na(WD)], WD[!is.na(WD)],
  X[!is.na(WD)], Y[!is.na(WD)],
  iniRp, alpha_wind, N_wind, iterations, directionsAvailable = FALSE
)

interpolation_precipitation(
  Xp, Yp, Zp,
  X[!is.na(P)], Y[!is.na(P)], Z[!is.na(P)],
  P[!is.na(P)], Psmooth[!is.na(P)],
  iniRp, alpha_event, alpha_amount, N_event, N_amount,
  iterations, popcrit, fmax, debug
)

</code></pre>


</div>