<div class="container">

<table style="width: 100%;"><tr>
<td>sampleUnivTMoE</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Draw a sample from a univariate t mixture of experts (TMoE).</h2>

<h3>Description</h3>

<p>Draw a sample from a univariate t mixture of experts (TMoE).
</p>


<h3>Usage</h3>

<pre><code class="language-R">sampleUnivTMoE(alphak, betak, sigmak, nuk, x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>alphak</code></td>
<td>
<p>The parameters of the gating network. <code>alphak</code> is a matrix of
size <em>(q + 1, K - 1)</em>, with <em>K - 1</em>, the number of regressors
(experts) and <em>q</em> the order of the logistic regression</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betak</code></td>
<td>
<p>Matrix of size <em>(p + 1, K)</em> representing the regression
coefficients of the experts network.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmak</code></td>
<td>
<p>Vector of length <em>K</em> giving the standard deviations of
the experts network.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nuk</code></td>
<td>
<p>Vector of length <em>K</em> giving the degrees of freedom of the
experts network t densities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A vector of length <em>n</em> representing the inputs (predictors).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the output variable <code>y</code> and statistics.
</p>

<ul>
<li> <p><code>y</code> Vector of length <em>n</em> giving the output variable.
</p>
</li>
<li> <p><code>zi</code> A vector of size <em>n</em> giving the hidden label of the
expert component generating the i-th observation. Its elements are
<code class="reqn">zi[i] = k</code>, if the i-th observation has been generated by the
k-th expert.
</p>
</li>
<li> <p><code>z</code> A matrix of size <em>(n, K)</em> giving the values of the binary
latent component indicators <code class="reqn">Z_{ik}</code> such that
<code class="reqn">Z_{ik} = 1</code> iff <code class="reqn">Z_{i} = k</code>.
</p>
</li>
<li> <p><code>stats</code> A list whose elements are:
</p>

<ul>
<li> <p><code>Ey_k</code> Matrix of size <em>(n, K)</em> giving the conditional
expectation of Yi the output variable given the value of the
hidden label of the expert component generating the ith observation
<em>zi = k</em>, and the value of predictor <em>X = xi</em>.
</p>
</li>
<li> <p><code>Ey</code> Vector of length <em>n</em> giving the conditional expectation
of Yi given the value of predictor <em>X = xi</em>.
</p>
</li>
<li> <p><code>Vary_k</code> Vector of length <em>k</em> representing the conditional
variance of Yi given <em>zi = k</em>, and <em>X = xi</em>.
</p>
</li>
<li> <p><code>Vary</code> Vector of length <em>n</em> giving the conditional expectation
of Yi given <em>X = xi</em>.
</p>
</li>
</ul>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">n &lt;- 500 # Size of the sample
alphak &lt;- matrix(c(0, 8), ncol = 1) # Parameters of the gating network
betak &lt;- matrix(c(0, -2.5, 0, 2.5), ncol = 2) # Regression coefficients of the experts
sigmak &lt;- c(0.5, 0.5) # Standard deviations of the experts
nuk &lt;- c(5, 7) # Degrees of freedom of the experts network t densities
x &lt;- seq.int(from = -1, to = 1, length.out = n) # Inputs (predictors)

# Generate sample of size n
sample &lt;- sampleUnivTMoE(alphak = alphak, betak = betak, sigmak = sigmak,
                         nuk = nuk, x = x)

# Plot points and estimated means
plot(x, sample$y, pch = 4)
lines(x, sample$stats$Ey_k[, 1], col = "blue", lty = "dotted", lwd = 1.5)
lines(x, sample$stats$Ey_k[, 2], col = "blue", lty = "dotted", lwd = 1.5)
lines(x, sample$stats$Ey, col = "red", lwd = 1.5)
</code></pre>


</div>