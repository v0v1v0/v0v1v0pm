<div class="container">

<table style="width: 100%;"><tr>
<td>metropolis_glm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Use the Metropolis Hastings algorithm to estimate Bayesian glm parameters</h2>

<h3>Description</h3>

<p>This function carries out the Metropolis algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">metropolis_glm(
  f,
  data,
  family = binomial(),
  iter = 100,
  burnin = round(iter/2),
  pm = NULL,
  pv = NULL,
  chain = 1,
  prop.sigma.start = 0.1,
  inits = NULL,
  adaptive = TRUE,
  guided = FALSE,
  block = TRUE,
  saveproposal = FALSE,
  control = metropolis.control()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>an R style formula (e.g. y ~ x1 + x2)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an R data frame containing the variables in f</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>R glm style family that determines model form: gaussian() or binomial()</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>number of iterations after burnin to keep</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>number of iterations at the beginning to throw out (also used for adaptive phase)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pm</code></td>
<td>
<p>vector of prior means for normal prior on log(scale) (if applicable) and
regression coefficients (set to NULL to use uniform priors)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pv</code></td>
<td>
<p>vector of prior variances for normal prior on log(scale) (if applicable) and
regression coefficients (set to NULL to use uniform priors)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chain</code></td>
<td>
<p>chain id (plan to deprecate)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prop.sigma.start</code></td>
<td>
<p>proposal distribution standard deviation (starting point if adapt=TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inits</code></td>
<td>
<p>NULL, a vector with length equal to number of parameters (intercept + x + scale
;gaussian() family only model only), or "glm" to set priors based on an MLE fit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adaptive</code></td>
<td>
<p>logical, should proposal distribution be adaptive? (TRUE usually gives better answers)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>guided</code></td>
<td>
<p>logical, should the "guided" algorithm be used (TRUE usually gives better answers)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>block</code></td>
<td>
<p>logical or a vector that sums to total number of parameters (e.g. if there are 4
random variables in the model, including intercept, then block=c(1,3) will update the
intercept separately from the other three parameters.) If TRUE, then updates each parameter
1 by 1. Using <code>guide</code>=TRUE with <code>block</code> as a vector is not advised</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>saveproposal</code></td>
<td>
<p>(logical, default=FALSE) save the rejected proposals (block=TRUE only)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>parameters that control fitting algorithm. See metropolis.control()</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Implements the Metropolis algorithm, which allows user specified proposal distributions
or implements an adaptive algorithm as described by
Gelman et al. (2014, ISBN: 9781584883883).
This function also allows the "Guided" Metropolis algorithm of
Gustafson (1998) doi: <a href="https://doi.org/10.1023/A:1008880707168">10.1023/A:1008880707168</a>. Note that by default all
parameters are estimated simulataneously via "block" sampling, but this
default behavior can be changed with the "block" parameter. When using
guided=TRUE, block should be set to FALSE.
</p>


<h3>Value</h3>

<p>An object of type "metropolis.samples" which is a named list containing posterior
MCMC samples as well as some fitting information.
</p>


<h3>Examples</h3>

<pre><code class="language-R">dat = data.frame(y = rbinom(100, 1, 0.5), x1=runif(100), x2 = runif(100))

res = metropolis_glm(y ~ x1 + x2, data=dat, family=binomial(), iter=1000, burnin=3000, 
adapt=TRUE, guided=TRUE, block=FALSE)
res
summary(res)
apply(res$parms, 2, mean)
glm(y ~ x1 + x2, family=binomial(), data=dat)
dat = data.frame(y = rnorm(100, 1, 0.5), x1=runif(100), x2 = runif(100), x3 = rpois(100, .2))

res = metropolis_glm(y ~ x1 + x2 + factor(x3), data=dat, family=gaussian(), inits="glm", 
iter=10000, burnin=3000, adapt=TRUE, guide=TRUE, block=FALSE)
apply(res$parms, 2, mean)
glm(y ~ x1 + x2+ factor(x3), family=gaussian(), data=dat)
</code></pre>


</div>