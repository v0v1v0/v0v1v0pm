<div class="container">

<table style="width: 100%;"><tr>
<td>gpd.pll</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Profile log-likelihood for the generalized Pareto distribution</h2>

<h3>Description</h3>

<p>This function calculates the (modified) profile likelihood based on the <code class="reqn">p^*</code> formula.
There are two small-sample corrections that use a proxy for
<code class="reqn">\ell_{\lambda; \hat{\lambda}}</code>,
which are based on Severini's (1999) empirical covariance
and the Fraser and Reid tangent exponential model approximation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gpd.pll(
  psi,
  param = c("scale", "shape", "quant", "VaR", "ES", "Nmean", "Nquant"),
  mod = "profile",
  mle = NULL,
  dat,
  m = NULL,
  N = NULL,
  p = NULL,
  q = NULL,
  correction = TRUE,
  threshold = NULL,
  plot = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>psi</code></td>
<td>
<p>parameter vector over which to profile (unidimensional)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>string indicating the parameter to profile over</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mod</code></td>
<td>
<p>string indicating the model. See <b>Details</b>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mle</code></td>
<td>
<p>maximum likelihood estimate in <code class="reqn">(\psi, \xi)</code> parametrization if <code class="reqn">\psi \neq \xi</code> and <code class="reqn">(\sigma, \xi)</code> otherwise (optional).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>sample vector of excesses, unless <code>threshold</code> is provided (in which case user provides original data)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>number of observations of interest for return levels. Required only for <code>args</code> values <code>'VaR'</code> or <code>'ES'</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>size of block over which to take maxima. Required only for <code>args</code> <code>Nmean</code> and <code>Nquant</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>tail probability, equivalent to <code class="reqn">1/m</code>. Required only for <code>args</code> <code>quant</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>level of quantile for N-block maxima. Required only for <code>args</code> <code>Nquant</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correction</code></td>
<td>
<p>logical indicating whether to use <code>spline.corr</code> to smooth the tem approximation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>numerical threshold above which to fit the generalized Pareto distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical; should the profile likelihood be displayed? Default to <code>TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments such as output from call to <code>Vfun</code> if <code>mode='tem'</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The three <code>mod</code> available are <code>profile</code> (the default), <code>tem</code>, the tangent exponential model (TEM) approximation and
<code>modif</code> for the penalized profile likelihood based on <code class="reqn">p^*</code> approximation proposed by Severini.
For the latter, the penalization is based on the TEM or an empirical covariance adjustment term.
</p>


<h3>Value</h3>

<p>a list with components
</p>

<ul>
<li> <p><code>mle</code>: maximum likelihood estimate
</p>
</li>
<li> <p><code>psi.max</code>: maximum profile likelihood estimate
</p>
</li>
<li> <p><code>param</code>: string indicating the parameter to profile over
</p>
</li>
<li> <p><code>std.error</code>: standard error of <code>psi.max</code>
</p>
</li>
<li> <p><code>psi</code>: vector of parameter <code class="reqn">\psi</code> given in <code>psi</code>
</p>
</li>
<li> <p><code>pll</code>: values of the profile log likelihood at <code>psi</code>
</p>
</li>
<li> <p><code>maxpll</code>: value of maximum profile log likelihood
</p>
</li>
<li> <p><code>family</code>: a string indicating "gpd"
</p>
</li>
<li> <p><code>threshold</code>: value of the threshold, by default zero
</p>
</li>
</ul>
<p>In addition, if <code>mod</code> includes <code>tem</code>
</p>

<ul>
<li> <p><code>normal</code>: maximum likelihood estimate and standard error of the interest parameter <code class="reqn">\psi</code>
</p>
</li>
<li> <p><code>r</code>: values of likelihood root corresponding to <code class="reqn">\psi</code>
</p>
</li>
<li> <p><code>q</code>: vector of likelihood modifications
</p>
</li>
<li> <p><code>rstar</code>: modified likelihood root vector
</p>
</li>
<li> <p><code>rstar.old</code>: uncorrected modified likelihood root vector
</p>
</li>
<li> <p><code>tem.psimax</code>: maximum of the tangent exponential model likelihood
</p>
</li>
</ul>
<p>In addition, if <code>mod</code> includes <code>modif</code>
</p>

<ul>
<li> <p><code>tem.mle</code>: maximum of tangent exponential modified profile log likelihood
</p>
</li>
<li> <p><code>tem.profll</code>: values of the modified profile log likelihood at <code>psi</code>
</p>
</li>
<li> <p><code>tem.maxpll</code>: value of maximum modified profile log likelihood
</p>
</li>
<li> <p><code>empcov.mle</code>: maximum of Severini's empirical covariance modified profile log likelihood
</p>
</li>
<li> <p><code>empcov.profll</code>: values of the modified profile log likelihood at <code>psi</code>
</p>
</li>
<li> <p><code>empcov.maxpll</code>: value of maximum modified profile log likelihood
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
dat &lt;- rgp(n = 100, scale = 2, shape = 0.3)
gpd.pll(psi = seq(-0.5, 1, by=0.01), param = 'shape', dat = dat)
gpd.pll(psi = seq(0.1, 5, by=0.1), param = 'scale', dat = dat)
gpd.pll(psi = seq(20, 35, by=0.1), param = 'quant', dat = dat, p = 0.01)
gpd.pll(psi = seq(20, 80, by=0.1), param = 'ES', dat = dat, m = 100)
gpd.pll(psi = seq(15, 100, by=1), param = 'Nmean', N = 100, dat = dat)
gpd.pll(psi = seq(15, 90, by=1), param = 'Nquant', N = 100, dat = dat, q = 0.5)

## End(Not run)
</code></pre>


</div>