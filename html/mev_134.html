<div class="container">

<table style="width: 100%;"><tr>
<td>gpde</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generalized Pareto distribution (expected shortfall parametrization)</h2>

<h3>Description</h3>

<p>Likelihood, score function and information matrix,
approximate ancillary statistics and sample space derivative
for the generalized Pareto distribution parametrized in terms of expected shortfall.
</p>
<p>The parameter <code>m</code> corresponds to <code class="reqn">\zeta_u</code>/(1-<code class="reqn">\alpha</code>), where <code class="reqn">\zeta_u</code> is the rate of exceedance over the threshold
<code>u</code> and <code class="reqn">\alpha</code> is the percentile of the expected shortfall.
Note that the actual parametrization is in terms of excess expected shortfall, meaning expected shortfall minus threshold.
</p>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>vector of length 2 containing <code class="reqn">e_m</code> and <code class="reqn">\xi</code>, respectively the expected shortfall at probability 1/(1-<code class="reqn">\alpha</code>) and the shape parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>sample vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>number of observations of interest for return levels. See <strong>Details</strong></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>numerical tolerance for the exponential model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>string indicating whether to use the expected  (<code>'exp'</code>) or the observed (<code>'obs'</code> - the default) information matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nobs</code></td>
<td>
<p>number of observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>vector calculated by <code>gpde.Vfun</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The observed information matrix was calculated from the Hessian using symbolic calculus in Sage.
</p>


<h3>Usage</h3>

<pre>gpde.ll(par, dat, m, tol=1e-5)
gpde.ll.optim(par, dat, m, tol=1e-5)
gpde.score(par, dat, m)
gpde.infomat(par, dat, m, method = c('obs', 'exp'), nobs = length(dat))
gpde.Vfun(par, dat, m)
gpde.phi(par, dat, V, m)
gpde.dphi(par, dat, V, m)</pre>


<h3>Functions</h3>


<ul>
<li> <p><code>gpde.ll</code>: log likelihood
</p>
</li>
<li> <p><code>gpde.ll.optim</code>: negative log likelihood parametrized in terms of log expected
shortfall and shape in order to perform unconstrained optimization
</p>
</li>
<li> <p><code>gpde.score</code>: score vector
</p>
</li>
<li> <p><code>gpde.infomat</code>: observed information matrix for GPD parametrized in terms of rate of expected shortfall and shape
</p>
</li>
<li> <p><code>gpde.Vfun</code>: vector implementing conditioning on approximate ancillary statistics for the TEM
</p>
</li>
<li> <p><code>gpde.phi</code>: canonical parameter in the local exponential family approximation
</p>
</li>
<li> <p><code>gpde.dphi</code>: derivative matrix of the canonical parameter in the local exponential family approximation
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Leo Belzile
</p>


</div>