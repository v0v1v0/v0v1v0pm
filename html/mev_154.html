<div class="container">

<table style="width: 100%;"><tr>
<td>gpdr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generalized Pareto distribution (return level parametrization)</h2>

<h3>Description</h3>

<p>Likelihood, score function and information matrix,
approximate ancillary statistics and sample space derivative
for the generalized Pareto distribution parametrized in terms of return levels.
</p>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>vector of length 2 containing <code class="reqn">y_m</code> and <code class="reqn">\xi</code>, respectively the <code class="reqn">m</code>-year return level and the shape parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>sample vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>number of observations of interest for return levels. See <strong>Details</strong></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>numerical tolerance for the exponential model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>string indicating whether to use the expected  (<code>'exp'</code>) or the observed (<code>'obs'</code> - the default) information matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nobs</code></td>
<td>
<p>number of observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>vector calculated by <code>gpdr.Vfun</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The observed information matrix was calculated from the Hessian using symbolic calculus in Sage.
</p>
<p>The interpretation for <code>m</code> is as follows: if there are on average <code class="reqn">m_y</code> observations per year above the threshold, then  <code class="reqn">m=Tm_y</code> corresponds to <code class="reqn">T</code>-year return level.
</p>


<h3>Usage</h3>

<pre>gpdr.ll(par, dat, m, tol=1e-5)
gpdr.ll.optim(par, dat, m, tol=1e-5)
gpdr.score(par, dat, m)
gpdr.infomat(par, dat, m, method = c('obs', 'exp'), nobs = length(dat))
gpdr.Vfun(par, dat, m)
gpdr.phi(par, V, dat, m)
gpdr.dphi(par, V, dat, m)</pre>


<h3>Functions</h3>


<ul>
<li> <p><code>gpdr.ll</code>: log likelihood
</p>
</li>
<li> <p><code>gpdr.ll.optim</code>: negative log likelihood parametrized in terms of <code>log(scale)</code> and shape
in order to perform unconstrained optimization
</p>
</li>
<li> <p><code>gpdr.score</code>: score vector
</p>
</li>
<li> <p><code>gpdr.infomat</code>: observed information matrix for GPD parametrized in terms of rate of <code class="reqn">m</code>-year return level and shape
</p>
</li>
<li> <p><code>gpdr.Vfun</code>: vector implementing conditioning on approximate ancillary statistics for the TEM
</p>
</li>
<li> <p><code>gpdr.phi</code>: canonical parameter in the local exponential family approximation
</p>
</li>
<li> <p><code>gpdr.dphi</code>: derivative matrix of the canonical parameter in the local exponential family approximation
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Leo Belzile
</p>


</div>