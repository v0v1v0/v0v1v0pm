<div class="container">

<table style="width: 100%;"><tr>
<td>infomat.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Information matrix test statistic and MLE for the extremal index</h2>

<h3>Description</h3>

<p>The Information Matrix Test (IMT), proposed by Suveges and Davison (2010), is based
on the difference between the expected quadratic score and the second derivative of
the log-likelihood. The asymptotic distribution for each threshold <code>u</code> and gap <code>K</code>
is asymptotically <code class="reqn">\chi^2</code> with one degree of freedom. The approximation is good for
<code class="reqn">N&gt;80</code> and conservative for smaller sample sizes. The test assumes independence between gaps.
</p>


<h3>Usage</h3>

<pre><code class="language-R">infomat.test(xdat, thresh, q, K, plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xdat</code></td>
<td>
<p>data vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh</code></td>
<td>
<p>threshold vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>vector of probability levels to define threshold if <code>thresh</code> is missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>int specifying the largest K-gap</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical: should the graphical diagnostic be plotted?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments, currently ignored</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The procedure proposed in Suveges &amp; Davison (2010) was corrected for erratas.
The maximum likelihood is based on the limiting mixture distribution of
the intervals between exceedances (an exponential with a point mass at zero).
The condition <code class="reqn">D^{(K)}(u_n)</code> should be checked by the user.
</p>
<p>Fukutome et al. (2015) propose an ad hoc automated procedure
</p>

<ol>
<li>
<p> Calculate the interexceedance times for each K-gap and each threshold, along with the number of clusters
</p>
</li>
<li>
<p>  Select the (<code>u</code>, <code>K</code>) pairs for which IMT &lt; 0.05 (corresponding to a P-value of 0.82)
</p>
</li>
<li>
<p> Among those, select the pair (<code>u</code>, <code>K</code>) for which the number of clusters is the largest
</p>
</li>
</ol>
<h3>Value</h3>

<p>an invisible list of matrices containing
</p>

<ul>
<li> <p><code>IMT</code> a matrix of test statistics
</p>
</li>
<li> <p><code>pvals</code> a matrix of approximate p-values (corresponding to probabilities under a <code class="reqn">\chi^2_1</code> distribution)
</p>
</li>
<li> <p><code>mle</code> a matrix of maximum likelihood estimates for each given pair (<code>u</code>, <code>K</code>)
</p>
</li>
<li> <p><code>loglik</code> a matrix of log-likelihood values at MLE for each given pair (<code>u</code>, <code>K</code>)
</p>
</li>
<li> <p><code>threshold</code> a vector of thresholds based on empirical quantiles at supplied levels.
</p>
</li>
<li> <p><code>q</code> the vector <code>q</code> supplied by the user
</p>
</li>
<li> <p><code>K</code> the largest gap number, supplied by the user
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Leo Belzile
</p>


<h3>References</h3>

<p>Fukutome, Liniger and Suveges (2015), Automatic threshold and run parameter selection: a climatology for extreme hourly precipitation in Switzerland. <em>Theoretical and Applied Climatology</em>, <strong>120</strong>(3), 403-416.
</p>
<p>Suveges and Davison (2010), Model misspecification in peaks over threshold analysis. <em>Annals of Applied Statistics</em>, <strong>4</strong>(1), 203-221.
</p>
<p>White (1982), Maximum Likelihood Estimation of Misspecified Models. <em>Econometrica</em>, <strong>50</strong>(1), 1-25.
</p>


<h3>Examples</h3>

<pre><code class="language-R">infomat.test(xdat = rgp(n = 10000),
             q = seq(0.1, 0.9, length = 10),
             K = 3)
</code></pre>


</div>