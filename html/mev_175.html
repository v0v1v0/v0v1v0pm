<div class="container">

<table style="width: 100%;"><tr>
<td>NC.diag</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Score and likelihood ratio tests fit of equality of shape over multiple thresholds</h2>

<h3>Description</h3>

<p>The function returns a P-value path for the score testand/or likelihood ratio
test for equality of the shape parameters over
multiple thresholds under the generalized Pareto model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">NC.diag(
  xdat,
  u,
  GP.fit = c("Grimshaw", "nlm", "optim", "ismev"),
  do.LRT = FALSE,
  size = NULL,
  plot = TRUE,
  ...,
  xi.tol = 0.001
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xdat</code></td>
<td>
<p>numeric vector of raw data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p><code>m</code>-vector of thresholds (sorted from smallest to largest)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GP.fit</code></td>
<td>
<p>function used to optimize the generalized Pareto model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.LRT</code></td>
<td>
<p>boolean indicating whether to perform the likelihood ratio test (in addition to the score test)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>level at which a horizontal line is drawn on multiple threshold plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical; if <code>TRUE</code>, return a plot of p-values against threshold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters passed to <code>plot</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xi.tol</code></td>
<td>
<p>numerical tolerance for threshold distance; if the absolute value of <code>xi1.hat</code> is less than <code>xi.tol</code> use linear interpolation
to evaluate score vectors, expected Fisher information matrices, Hessians</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The default method is <code>'Grimshaw'</code> using the reduction of the parameters to a one-dimensional
maximization. Other options are one-dimensional maximization of the profile the <code>nlm</code> function or <code>optim</code>.
Two-dimensional optimisation using 2D-optimization <code>ismev</code> using the routine
from <code>gpd.fit</code> from the <code>ismev</code> library, with the addition of the algebraic gradient.
The choice of <code>GP.fit</code> should make no difference but the options were kept.
<b>Warning</b>: the function will not recover from failure of the maximization routine, returning various error messages.
</p>


<h3>Value</h3>

<p>a plot of P-values for the test at the different thresholds <code>u</code>
</p>


<h3>Author(s)</h3>

<p>Paul J. Northrop and Claire L. Coleman
</p>


<h3>References</h3>

<p>Grimshaw (1993). Computing Maximum Likelihood Estimates for the Generalized
Pareto Distribution, <em>Technometrics</em>, <b>35</b>(2), 185–191.
</p>
<p>Northrop &amp; Coleman (2014). Improved threshold diagnostic plots for extreme value
analyses, <em>Extremes</em>, <b>17</b>(2), 289–303.
</p>
<p>Wadsworth &amp; Tawn (2012). Likelihood-based procedures for threshold
diagnostics and uncertainty in extreme value modelling, <em>J. R. Statist. Soc. B</em>, <b>74</b>(3), 543–567.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(nidd)
u &lt;- seq(65,90, by = 1L)
NC.diag(nidd, u, size = 0.05)

## End(Not run)
</code></pre>


</div>