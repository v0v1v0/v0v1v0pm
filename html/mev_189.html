<div class="container">

<table style="width: 100%;"><tr>
<td>pp.infomat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Information matrix for the Poisson process likelihood</h2>

<h3>Description</h3>

<p>The function returns the expected or observed information matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pp.infomat(par, dat, method = c("obs", "exp"), u, np = 1, nobs = length(dat))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>vector of <code>loc</code>, <code>scale</code> and <code>shape</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>sample vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>string indicating whether to use the expected  (<code>'exp'</code>) or the observed (<code>'obs'</code> - the default) information matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>threshold</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>np</code></td>
<td>
<p>number of periods of observations. This is a <em>post hoc</em> adjustment for the intensity so that the parameters of the model coincide with those of a generalized extreme value distribution with block size <code>length(dat)/np</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nobs</code></td>
<td>
<p>number of observations for the expected information matrix. Default to <code>length(dat)</code> if <code>dat</code> is provided.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>information matrix of the NHPP
</p>


<h3>Note</h3>

<p>For the expected information matrix, the number of points above the threshold is random, but should correspond to
<code>np</code><code class="reqn">\Lambda</code>. The parametrization for <code>np</code> is shared between <code>fit.pp</code>, <code>pp.ll</code>, etc.
The entries for the information matrix are given in Sharkey and Tawn (2017), but contains some typos which were corrected.
</p>


<h3>References</h3>

<p>Sharkey, P. and J.A. Tawn (2017). A Poisson process reparameterisation for Bayesian inference for extremes, <em>Extremes</em>, <b>20</b>(2), 239-263, <code>http://dx.doi.org/10.1007/s10687-016-0280-2</code>.
</p>


<h3>See Also</h3>

<p><code>pp</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
dat &lt;- rgp(n &lt;- 1e3, 0.1, 2, -0.1)
np &lt;- 10
mle &lt;- fit.pp(dat, threshold = 0, np =  np)$par
info_obs &lt;- pp.infomat(par = mle, dat = dat, method = "obs", u = 0, np = np)
info_exp &lt;- pp.infomat(par = mle, dat = dat, method = "exp", u = 0, np = np)
info_obs/info_exp

## End(Not run)
</code></pre>


</div>