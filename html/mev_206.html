<div class="container">

<table style="width: 100%;"><tr>
<td>rmev</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Exact simulations of multivariate extreme value distributions</h2>

<h3>Description</h3>

<p>Implementation of the random number generators for multivariate extreme-value distributions
and max-stable processes based on the two algorithms described in Dombry, Engelke and Oesting (2016).
</p>


<h3>Usage</h3>

<pre><code class="language-R">rmev(
  n,
  d,
  param,
  asy,
  sigma,
  model = c("log", "alog", "neglog", "aneglog", "bilog", "negbilog", "hr", "br", "xstud",
    "smith", "schlather", "ct", "sdir", "dirmix", "pairbeta", "pairexp", "wdirbs",
    "wexpbs", "maxlin"),
  alg = c("ef", "sm"),
  weights = NULL,
  vario = NULL,
  coord = NULL,
  grid = FALSE,
  dist = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>dimension of sample</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>parameter vector for the logistic, bilogistic, negative bilogistic and extremal Dirichlet (Coles and Tawn) model.
Parameter matrix for the Dirichlet mixture. Degree of freedoms for extremal student model. See <b>Details</b>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asy</code></td>
<td>
<p>list of asymmetry parameters, as in function <code>rmvevd</code> from package <code>evd</code>, of <code class="reqn">2^d-1</code> vectors of size corresponding to the power set of <code>d</code>, with sum to one constraints.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>covariance matrix for Brown-Resnick and extremal Student-t distributions. Symmetric matrix of squared  coefficients <code class="reqn">\lambda^2</code> for the Husler-Reiss model, with zero diagonal elements.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>for multivariate extreme value distributions, users can choose between 1-parameter logistic and negative logistic, asymmetric logistic and negative logistic, bilogistic, Husler-Reiss, extremal Dirichlet model (Coles and Tawn) or the Dirichlet mixture. Spatial models include
the Brown-Resnick, Smith, Schlather and extremal Student max-stable processes. Max linear models are also supported</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alg</code></td>
<td>
<p>algorithm, either simulation via extremal function (<code>'ef'</code>) or via the spectral measure (<code>'sm'</code>). Default to <code>ef</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>vector of length <code>m</code> for the <code>m</code> mixture components that sum to one. For the <code>"maxlin"</code> model, weights should be a matrix with <code>d</code> columns that represent the weight of the components and whose column sum to one (if provided, this argument overrides <code>asy</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vario</code></td>
<td>
<p>semivariogram function whose first argument must be distance. Used only if provided in conjunction with <code>coord</code> and if <code>sigma</code> is missing</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coord</code></td>
<td>
<p><code>d</code> by <code>k</code> matrix of coordinates, used as input in the variogram <code>vario</code> or as parameter for the Smith model. If <code>grid</code> is <code>TRUE</code>, unique entries should be supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>Logical. <code>TRUE</code> if the coordinates are two-dimensional grid points (spatial models).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>symmetric matrix of pairwise distances. Default to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments for the <code>vario</code> function</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The vector param differs depending on the model
</p>

<ul>
<li> <p><code>log</code>: one dimensional parameter greater than 1
</p>
</li>
<li> <p><code>alog</code>: <code class="reqn">2^d-d-1</code> dimensional parameter for <code>dep</code>. Values are recycled if needed.
</p>
</li>
<li> <p><code>neglog</code>: one dimensional positive parameter
</p>
</li>
<li> <p><code>aneglog</code>: <code class="reqn">2^d-d-1</code> dimensional parameter for <code>dep</code>. Values are recycled if needed.
</p>
</li>
<li> <p><code>bilog</code>: <code>d</code>-dimensional vector of parameters in <code class="reqn">[0,1]</code>
</p>
</li>
<li> <p><code>negbilog</code>: <code>d</code>-dimensional vector of negative parameters
</p>
</li>
<li> <p><code>ct, dir, negdir, sdir</code>: <code>d</code>-dimensional vector of positive (a)symmetry parameters. For <code>dir</code> and <code>negdir</code>, a <code class="reqn">d+1</code>
vector consisting of the <code>d</code> Dirichlet parameters and the last entry is an index of regular variation in <code class="reqn">(-\min(\alpha_1, \ldots, \alpha_d), 1]</code> treated as shape parameter
</p>
</li>
<li> <p><code>xstud</code>: one dimensional parameter corresponding to degrees of freedom <code>alpha</code>
</p>
</li>
<li> <p><code>dirmix</code>: <code>d</code> by <code>m</code>-dimensional matrix of positive (a)symmetry parameters
</p>
</li>
<li> <p><code>pairbeta, pairexp</code>: <code>d(d-1)/2+1</code> vector of parameters, containing the concentration parameter and the coefficients of the pairwise beta, in lexicographical order e.g., <code class="reqn">\beta_{12}, \beta_{13}, \ldots</code>
</p>
</li>
<li> <p><code>wdirbs, wexpbs</code>: <code>2d</code> vector of <code>d</code> concentration parameters followed by the <code>d</code> Dirichlet parameters
</p>
</li>
</ul>
<p>Stephenson points out that the multivariate asymmetric negative logistic model given in e.g. Coles and Tawn (1991) is not a valid distribution function in dimension <code class="reqn">d&gt;3</code> unless additional constraints are imposed on the parameter values.
The implementation in <code>mev</code> uses the same construction as the asymmetric logistic distribution (see the vignette). As such it does not match the bivariate implementation of rbvevd.
</p>
<p>The dependence parameter of the <code>evd</code> package for the Husler-Reiss distribution can be recovered taking
for the Brown–Resnick model  <code class="reqn">2/r=\sqrt(2\gamma(h))</code> where <code class="reqn">h</code> is the lag vector between sites and <code class="reqn">r=1/\lambda</code> for the Husler–Reiss.
</p>


<h3>Value</h3>

<p>an <code>n</code> by <code>d</code> exact sample from the corresponding multivariate extreme value model
</p>


<h3>Warning</h3>

<p>As of version 1.8 (August 16, 2016), there is a distinction between models <code>hr</code> and <code>br</code>. The latter is meant to be used in conjunction with variograms. The parametrization differs between the two models.
</p>
<p>The family of scaled Dirichlet is now parametrized by a parameter in <code class="reqn">-\min(\alpha)</code> appended to the the <code>d</code> vector <code>param</code> containing the parameter <code>alpha</code>
of the Dirichlet model. Arguments <code>model='dir'</code> and <code>model='negdir'</code> are still supported internally, but not listed in the options.
</p>


<h3>Author(s)</h3>

<p>Leo Belzile
</p>


<h3>References</h3>

<p>Dombry, Engelke and Oesting (2016). Exact simulation of max-stable processes, <em>Biometrika</em>, <b>103</b>(2), 303–317.
</p>


<h3>See Also</h3>

<p>rmevspec, rmvevd, rbvevd
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
rmev(n=100, d=3, param=2.5, model='log', alg='ef')
rmev(n=100, d=4, param=c(0.2,0.1,0.9,0.5), model='bilog', alg='sm')
## Spatial example using power variogram
#NEW: Semi-variogram must take distance as argument
semivario &lt;- function(x, scale, alpha){ scale*x^alpha }
#grid specification
grid.coord &lt;- as.matrix(expand.grid(runif(4), runif(4)))
rmev(n=100, vario=semivario, coord=grid.coord, model='br', scale = 0.5, alpha = 1)
#using the Brown-Resnick model with a covariance matrix
vario2cov &lt;- function(coord, semivario,...){
 sapply(1:nrow(coord), function(i) sapply(1:nrow(coord), function(j)
  semivario(sqrt(sum((coord[i,])^2)), ...) +
  semivario(sqrt(sum((coord[j,])^2)), ...) -
  semivario(sqrt(sum((coord[i,]-coord[j,])^2)), ...)))
}
rmev(n=100, sigma=vario2cov(grid.coord, semivario = semivario, scale = 0.5, alpha = 1), model='br')
# asymmetric logistic model - see function 'rmvevd' from package 'evd '
asy &lt;- list(0, 0, 0, 0, c(0,0), c(0,0), c(0,0), c(0,0), c(0,0), c(0,0),
  c(.2,.1,.2), c(.1,.1,.2), c(.3,.4,.1), c(.2,.2,.2), c(.4,.6,.2,.5))
rmev(n=1, d=4, param=0.3, asy=asy, model="alog")
#Example with a grid (generating an array)
rmev(n=10, sigma=cbind(c(2,1), c(1,3)), coord=cbind(runif(4), runif(4)), model='smith', grid=TRUE)
## Example with Dirichlet mixture
alpha.mat &lt;- cbind(c(2,1,1),c(1,2,1),c(1,1,2))
rmev(n=100, param=alpha.mat, weights=rep(1/3,3), model='dirmix')
rmev(n=10, param=c(0.1,1,2,3), d=3, model='pairbeta')
</code></pre>


</div>