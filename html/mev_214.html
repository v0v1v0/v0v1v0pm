<div class="container">

<table style="width: 100%;"><tr>
<td>smith.penult</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Smith's penultimate approximations</h2>

<h3>Description</h3>

<p>The function takes as arguments the distribution and density functions. There are two options:
<code>method='bm'</code> yields block maxima and <code>method='pot'</code> threshold exceedances.
For <code>method='bm'</code>, the user should provide in such case the block sizes via the
argument <code>m</code>, whereas if <code>method='pot'</code>, a vector of threshold values should be
provided. The other argument (<code>u</code> or <code>m</code> depending on the method) is ignored.
</p>


<h3>Usage</h3>

<pre><code class="language-R">smith.penult(family, method = c("bm", "pot"), u, qu, m, returnList = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>the name of the parametric family. Will be used to obtain <code>dfamily</code>, <code>pfamily</code>, <code>qfamily</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>either block maxima (<code>'bm'</code>) or peaks-over-threshold (<code>'pot'</code>) are supported</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>vector of thresholds for method <code>'pot'</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qu</code></td>
<td>
<p>vector of quantiles for method <code>'pot'</code>. Ignored if argument <code>u</code> is provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>vector of block sizes for method <code>'bm'</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnList</code></td>
<td>
<p>logical; should the arguments be returned as a list or as a matrix of parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments passed to <code>densF</code> and <code>distF</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Alternatively, the user can provide functions <code>densF</code>, <code>quantF</code> and <code>distF</code> for the density,
quantile function and distribution functions, respectively. The user can also supply the derivative
of the density function, <code>ddensF</code>. If the latter is missing, it will be approximated using finite-differences.
</p>
<p>For <code>method = "pot"</code>, the function computes the reciprocal hazard and its derivative on the log scale to avoid numerical overflow. Thus, the density function should have argument <code>log</code> and the distribution function arguments <code>log.p</code> and <code>lower.tail</code>, respectively.
</p>


<h3>Value</h3>

<p>either a vector, a matrix if either <code>length(m)&gt;1</code> or <code>length(u)&gt;1</code> or a list (if <code>returnList</code>) containing
</p>

<ul>
<li> <p><code>loc</code>: location parameters (<code>method='bm'</code>)
</p>
</li>
<li> <p><code>scale</code>: scale parameters
</p>
</li>
<li> <p><code>shape</code>: shape parameters
</p>
</li>
<li> <p><code>u</code>: thresholds (if <code>method='pot'</code>), percentile corresponding to threshold (if <code>method='pot'</code>)
</p>
</li>
<li> <p><code>m</code>: block sizes (if <code>method='bm'</code>)
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Leo Belzile
</p>


<h3>References</h3>

<p>Smith, R.L. (1987). Approximations in extreme value theory. <em>Technical report 205</em>, Center for Stochastic Process, University of North Carolina, 1â€“34.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Threshold exceedance for Normal variables
qu &lt;- seq(1,5,by=0.02)
penult &lt;- smith.penult(family = "norm", ddensF=function(x){-x*dnorm(x)},
   method = 'pot', u = qu)
plot(qu, penult$shape, type='l', xlab='Quantile',
   ylab='Penultimate shape', ylim=c(-0.5,0))
#Block maxima for Gamma variables -
#User must provide arguments for shape (or rate)
m &lt;- seq(30, 3650, by=30)
penult &lt;- smith.penult(family = 'gamma', method = 'bm', m=m, shape=0.1)
plot(m, penult$shape, type='l', xlab='Quantile', ylab='Penultimate shape')

#Comparing density of GEV approximation with true density of maxima
m &lt;- 100 #block of size 100
p &lt;- smith.penult(family='norm',
   ddensF=function(x){-x*dnorm(x)}, method='bm', m=m, returnList=FALSE)
x &lt;- seq(1, 5, by = 0.01)
plot(x, m*dnorm(x)*exp((m-1)*pnorm(x,log.p=TRUE)),type='l', ylab='Density',
main='Distribution of the maxima of\n 100 standard normal variates')
lines(x, mev::dgev(x,loc=p[1], scale=p[2], shape=0),col=2)
lines(x, mev::dgev(x,loc=p[1], scale=p[2], shape=p[3]),col=3)
legend(x = 'topright',lty = c(1,1,1,1), col = c(1,2,3,4),
   legend = c('exact', 'ultimate', 'penultimate'), bty = 'n')
</code></pre>


</div>