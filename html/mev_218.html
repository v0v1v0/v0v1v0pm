<div class="container">

<table style="width: 100%;"><tr>
<td>taildep</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Coefficient of tail correlation and tail dependence</h2>

<h3>Description</h3>

<p>For data with unit Pareto margins, the coefficient of tail dependence <code class="reqn">\eta</code> is defined  via </p>
<p style="text-align: center;"><code class="reqn">\Pr(\min(X) &gt; x) = L(x)x^{-1/\eta},</code>
</p>

<p>where <code class="reqn">L(x)</code> is a slowly varying function. Ignoring the latter, several estimators of <code class="reqn">\eta</code> can be defined. In unit Pareto margins, <code class="reqn">\eta</code> is a nonnegative shape parameter that can be estimated by fitting a generalized Pareto distribution above a high threshold. In exponential margins, <code class="reqn">\eta</code> is a scale parameter and the maximum likelihood estimator of the latter is the Hill estimator. Both methods are based on peaks-over-threshold and the user can choose between pointwise confidence confint obtained through a likelihood ratio test statistic (<code>"lrt"</code>) or the Wald statistic (<code>"wald"</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">taildep(
  data,
  u = NULL,
  nq = 40,
  qlim = c(0.8, 0.99),
  depmeas = c("eta", "chi"),
  method = list(eta = c("emp", "betacop", "gpd", "hill"), chi = c("emp", "betacop")),
  confint = c("wald", "lrt"),
  level = 0.95,
  trunc = TRUE,
  empirical.transformation = TRUE,
  ties.method = "random",
  plot = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an <code class="reqn">n</code> by <code class="reqn">d</code> matrix of multivariate observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>vector of percentiles between 0 and 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nq</code></td>
<td>
<p>number of quantiles of the structural variable at which to form a grid; only used if <code>u = NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qlim</code></td>
<td>
<p>limits for the sequence <code>u</code> of the structural variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>depmeas</code></td>
<td>
<p>dependence measure, either of <code>"eta"</code> or <code>"chi"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>named list giving the estimation method for <code>eta</code> and <code>chi</code>. Default to <code>"emp"</code> for both.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>confint</code></td>
<td>
<p>string indicating the type of confidence interval for <code class="reqn">\eta</code>, one of <code>"wald"</code> or <code>"lrt"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>the confidence level required (default to 0.95).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trunc</code></td>
<td>
<p>logical indicating whether the estimates and confidence intervals should be truncated in <code class="reqn">[0,1]</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>empirical.transformation</code></td>
<td>
<p>logical indicating whether observations should be transformed to pseudo-uniform scale (default to <code>TRUE</code>); otherwise, they are assumed to be uniform</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ties.method</code></td>
<td>
<p>string indicating the type of method for <code>rank</code>; see <code>rank</code> for a list of options. Default to <code>"random"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical; should graphs be plotted?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments passed to <code>plot</code>; current support for <code>main</code>, <code>xlab</code>, <code>ylab</code>, <code>add</code> and further <code>pch</code>, <code>lty</code>, <code>type</code>, <code>col</code> for points; additional arguments for confidence intervals are handled via <code>cipch</code>, <code>cilty</code>, <code>citype</code>, <code>cicol</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The most common approach for estimation is the empirical survival copula, by evaluating the proportion of sample minima with uniform margins that exceed a given <code class="reqn">x</code>. An alternative estimator uses a smoothed estimator of the survival copula using Bernstein polynomial, resulting in the so-called <code>betacop</code> estimator. Approximate pointwise confidence confint for the latter are obtained by assuming the proportion of points is binomial.
</p>
<p>The coefficient of tail correlation <code class="reqn">\chi</code> is
</p>
<p style="text-align: center;"><code class="reqn">\chi = \lim_{u \to 1} \frac{\Pr(F_1(X_1)&gt;u, \ldots, F_D(X_D)&gt;u)}{1-u}.</code>
</p>

<p>Asymptotically independent vectors have <code class="reqn">\chi = 0</code>. The estimator uses an estimator of the survival copula
</p>


<h3>Value</h3>

<p>a named list with elements
</p>

<ul>
<li> <p><code>u</code>: a <code>K</code> vector of percentile levels
</p>
</li>
<li> <p><code>eta</code>: a <code>K</code> by 3 matrix with point estimates, lower and upper confidence intervals
</p>
</li>
<li> <p><code>chi</code>: a <code>K</code> by 3 matrix with point estimates, lower and upper confidence intervals
</p>
</li>
</ul>
<h3>Note</h3>

<p>As of version 1.15, the percentiles used are from the minimum variable. This ensures that, regardless of the number of variables,
there is no error message returned because the quantile levels are too low for there to be observations
</p>


<h3>See Also</h3>

<p><code>chiplot</code> for bivariate empirical estimates of <code class="reqn">\chi</code> and <code class="reqn">\bar{\chi}</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
set.seed(765)
# Max-stable model
dat &lt;- rmev(n = 1000, d = 4, param = 0.7, model = "log")
taildep(dat, confint = 'wald')

## End(Not run)
</code></pre>


</div>