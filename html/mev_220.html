<div class="container">

<table style="width: 100%;"><tr>
<td>fit.egp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Parameter stability plot and maximum likelihood routine for extended GP models</h2>

<h3>Description</h3>

<p>The function <code>tstab.egp</code> provides classical threshold stability plot for (<code class="reqn">\kappa</code>, <code class="reqn">\sigma</code>, <code class="reqn">\xi</code>).
The fitted parameter values are displayed with pointwise normal 95% confidence intervals.
The function returns an invisible list with parameter estimates and standard errors, and p-values for the Wald test that <code class="reqn">\kappa=1</code>.
The plot is for the modified scale (as in the generalised Pareto model) and as such it is possible that the modified scale be negative.
<code>tstab.egp</code> can also be used to fit the model to multiple thresholds.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit.egp(xdat, thresh, model = c("egp1", "egp2", "egp3"), init, show = FALSE)

tstab.egp(
  xdat,
  thresh,
  model = c("egp1", "egp2", "egp3"),
  plots = 1:3,
  umin,
  umax,
  nint,
  changepar = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xdat</code></td>
<td>
<p>vector of observations, greater than the threshold</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh</code></td>
<td>
<p>threshold value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a string indicating which extended family to fit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>vector of initial values, with <code class="reqn">\log(\kappa)</code> and <code class="reqn">\log(\sigma)</code>; can be omitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show</code></td>
<td>
<p>logical; if <code>TRUE</code>, print the results of the optimization</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plots</code></td>
<td>
<p>vector of integers specifying which parameter stability to plot (if any); passing <code>NA</code> results in no plots</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>umin</code></td>
<td>
<p>optional minimum value considered for threshold (if <code>thresh</code> is not provided)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>umax</code></td>
<td>
<p>optional maximum value considered for threshold (if <code>thresh</code> is not provided)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nint</code></td>
<td>
<p>optional integer number specifying the number of thresholds to test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>changepar</code></td>
<td>
<p>logical; if <code>TRUE</code>, the graphical parameters (via a call to <code>par</code>) are modified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments for the plot function, currently ignored</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>fit.egp</code> is a numerical optimization routine to fit the extended generalised Pareto models of Papastathopoulos and Tawn (2013),
using maximum likelihood estimation.
</p>


<h3>Value</h3>

<p><code>fit.egp</code> outputs the list returned by optim, which contains the parameter values, the hessian and in addition the standard errors
</p>
<p><code>tstab.egp</code> returns a plot(s) of the parameters fit over the range of provided thresholds, with pointwise normal confidence intervals; the function also returns an invisible list containing notably the matrix of point estimates (<code>par</code>) and standard errors (<code>se</code>).
</p>


<h3>Author(s)</h3>

<p>Leo Belzile
</p>


<h3>References</h3>

<p>Papastathopoulos, I. and J. Tawn (2013). Extended generalised Pareto models for tail estimation, <em>Journal of Statistical Planning and Inference</em> <b>143</b>(3), 131â€“143.
</p>


<h3>Examples</h3>

<pre><code class="language-R">xdat &lt;- mev::rgp(
  n = 100,
  loc = 0,
  scale = 1,
  shape = 0.5)
fitted &lt;- fit.egp(
  xdat = xdat,
  thresh = 1,
  model = "egp2",
  show = TRUE)
thresh &lt;- mev::qgp(seq(0.1, 0.5, by = 0.05), 0, 1, 0.5)
tstab.egp(
   xdat = xdat,
   thresh = thresh,
   model = "egp2",
   plots = 1:3)
</code></pre>


</div>