<div class="container">

<table style="width: 100%;"><tr>
<td>tstab.gpd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Parameter stability plots for peaks-over-threshold</h2>

<h3>Description</h3>

<p>This function computes the maximum likelihood estimate
at each provided threshold and plots the estimates (pointwise),
along with 95
or else from 1000 independent draws from the posterior distribution under
vague independent normal prior on the log-scale and shape.
The latter two methods better reflect the asymmetry of the estimates than the Wald confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tstab.gpd(
  xdat,
  thresh,
  method = c("wald", "profile", "post"),
  level = 0.95,
  plot = TRUE,
  which = c("scale", "shape"),
  changepar = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xdat</code></td>
<td>
<p>a vector of observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh</code></td>
<td>
<p>a vector of candidate thresholds at which to compute the estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>string indicating the method for computing confidence or credible intervals.
Must be one of <code>"wald"</code>, <code>"profile"</code> or <code>"post"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>confidence level of the intervals. Default to 0.95.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical; should parameter stability plots be displayed? Default to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>character vector with elements <code>scale</code> or <code>shape</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>changepar</code></td>
<td>
<p>logical; if <code>TRUE</code>, changes the graphical parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments passed to <code>plot</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list with components
</p>

<ul>
<li>
<p><code>threshold</code>: vector of numerical threshold values.
</p>
</li>
<li>
<p><code>mle</code>: matrix of modified scale and shape maximum likelihood estimates.
</p>
</li>
<li>
<p><code>lower</code>: matrix of lower bounds for the confidence or credible intervals.
</p>
</li>
<li>
<p><code>upper</code>: matrix of lower bounds for the confidence or credible intervals.
</p>
</li>
<li>
<p><code>method</code>: method for the confidence or coverage intervals.
</p>
</li>
</ul>
<p>plots of the modified scale and shape parameters, with pointwise confidence/credible intervals
and an invisible data frame containing the threshold <code>thresh</code> and the modified scale and shape parameters.
</p>


<h3>Note</h3>

<p>The function is hard coded to prevent fitting a generalized Pareto distribution to samples of size less than 10. If the estimated shape parameters are all on the boundary of the parameter space (meaning <code class="reqn">\hat{\xi}=-1</code>), then the plots return one-sided confidence intervals for both the modified scale and shape parameters: these typically suggest that the chosen thresholds are too high for estimation to be reliable.
</p>


<h3>Author(s)</h3>

<p>Leo Belzile
</p>


<h3>See Also</h3>

<p><code>gpd.fitrange</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">dat &lt;- abs(rnorm(10000))
u &lt;- qnorm(seq(0.9,0.99, by= 0.01))
par(mfrow = c(1,2))
tstab.gpd(xdat = dat, thresh = u, changepar = FALSE)
## Not run: 
tstab.gpd(xdat = dat, thresh = u, method = "profile")
tstab.gpd(xdat = dat, thresh = u, method = "post")

## End(Not run)
</code></pre>


</div>