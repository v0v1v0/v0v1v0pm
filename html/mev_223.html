<div class="container">

<table style="width: 100%;"><tr>
<td>vmetric.diag</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Metric-based threshold selection</h2>

<h3>Description</h3>

<p>Adaptation of Varty et al.'s metric-based threshold
automated diagnostic for the  independent and identically distributed case with no rounding.
</p>


<h3>Usage</h3>

<pre><code class="language-R">vmetric.diag(
  xdat,
  thresh,
  B = 199L,
  type = c("qq", "pp"),
  dist = c("l1", "l2"),
  neval = 1000L,
  ci = 0.95
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xdat</code></td>
<td>
<p>vector of observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh</code></td>
<td>
<p>vector of thresholds</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>number of bootstrap replications</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>string indicating scale, either <code>qq</code> for exponential quantile-quantile plot or <code>pp</code> for probability-probability plot (uniform)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>string indicating norm, either <code>l1</code> for absolute error or <code>l2</code> for quadratic error</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>neval</code></td>
<td>
<p>number of points at which to estimate the metric. Default to 1000L</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>level of symmetric confidence interval. Default to 0.95</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The algorithm proceeds by first computing the maximum
likelihood algorithm and then simulating datasets from
replication with parameters drawn from a bivariate normal
approximation to the maximum likelihood estimator distribution.
</p>
<p>For each bootstrap sample, we refit the
model and convert the quantiles to
exponential or uniform variates.
The mean absolute or mean squared distance
is calculated on these. The threshold
returned is the one with the lowest value
of the metric.
</p>


<h3>Value</h3>

<p>an invisible list with components
</p>

<ul>
<li> <p><code>thresh</code>: scalar threshold minimizing criterion
</p>
</li>
<li> <p><code>cthresh</code>: vector of candidate thresholds
</p>
</li>
<li> <p><code>metric</code>: value of the metric criterion evaluated at each threshold
</p>
</li>
<li> <p><code>type</code>: argument <code>type</code>
</p>
</li>
<li> <p><code>dist</code>: argument <code>dist</code>
</p>
</li>
</ul>
<h3>References</h3>

<p>Varty, Z. and J.A. Tawn and P.M. Atkinson and S. Bierman (2021+), Inference for extreme earthquake magnitudes accounting for a time-varying measurement process
</p>


</div>