<div class="container">

<table style="width: 100%;"><tr>
<td>angmeasdir</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Dirichlet mixture smoothing of the angular measure</h2>

<h3>Description</h3>

<p>This function computes the empirical or Euclidean likelihood
estimates of the spectral measure and uses the points returned from a call to <code>angmeas</code> to compute the Dirichlet
mixture smoothing of de Carvalho, Warchol and Segers (2012), placing a Dirichlet kernel at each observation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">angmeasdir(
  x,
  th,
  Rnorm = c("l1", "l2", "linf"),
  Anorm = c("l1", "l2", "linf", "arctan"),
  marg = c("Frechet", "Pareto"),
  wgt = c("Empirical", "Euclidean"),
  region = c("sum", "min", "max"),
  is.angle = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an <code>n</code> by <code>d</code> sample matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>th</code></td>
<td>
<p>threshold of length 1 for <code>'sum'</code>, or <code>d</code> marginal thresholds otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rnorm</code></td>
<td>
<p>character string indicating the norm for the radial component.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Anorm</code></td>
<td>
<p>character string indicating the norm for the angular component. <code>arctan</code> is only implemented for <code class="reqn">d=2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marg</code></td>
<td>
<p>character string indicating choice of marginal transformation, either to Frechet or Pareto scale</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wgt</code></td>
<td>
<p>character string indicating weighting function for the equation. Can be based on Euclidean or empirical likelihood for the mean</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>region</code></td>
<td>
<p>character string specifying which observations to consider (and weight). <code>'sum'</code> corresponds to a radial threshold
<code class="reqn">\sum x_i &gt; </code><code>th</code>, <code>'min'</code> to <code class="reqn">\min x_i &gt;</code><code>th</code> and <code>'max'</code> to <code class="reqn">\max x_i &gt;</code><code>th</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>is.angle</code></td>
<td>
<p>logical indicating whether observations are already angle with respect to <code>region</code>. Default to <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The cross-validation
bandwidth is the solution of
</p>
<p style="text-align: center;"><code class="reqn">\max_{\nu} \sum_{i=1}^n \log \left\{ \sum_{k=1,k \neq i}^n p_{k, -i} f(\mathbf{w}_i; \nu \mathbf{w}_k)\right\},</code>
</p>

<p>where <code class="reqn">f</code> is the density of the Dirichlet distribution, <code class="reqn">p_{k, -i}</code> is the Euclidean weight
obtained from estimating the Euclidean likelihood problem without observation <code class="reqn">i</code>.
</p>


<h3>Value</h3>

<p>an invisible list with components
</p>

<ul>
<li> <p><code>nu</code> bandwidth parameter obtained by cross-validation;
</p>
</li>
<li> <p><code>dirparmat</code> <code>n</code> by <code>d</code> matrix of Dirichlet parameters for the mixtures;
</p>
</li>
<li> <p><code>wts</code> mixture weights.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)
x &lt;- rmev(n=100, d=2, param=0.5, model='log')
out &lt;- angmeasdir(x=x, th=0, Rnorm='l1', Anorm='l1', marg='Frechet', wgt='Empirical')
</code></pre>


</div>