<div class="container">

<table style="width: 100%;"><tr>
<td>egp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extended generalised Pareto families</h2>

<h3>Description</h3>

<p>This function provides the log-likelihood and quantiles for the three different families presented
in Papastathopoulos and Tawn (2013). The latter include an additional parameter, <code class="reqn">\kappa</code>.
All three families share the same tail index as the generalized Pareto distribution, while allowing for lower thresholds.
In the case <code class="reqn">\kappa=1</code>, the models reduce to the generalised Pareto.
</p>
<p><code>egp.retlev</code> gives the return levels for the extended generalised Pareto distributions
</p>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xdat</code></td>
<td>
<p>vector of observations, greater than the threshold</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh</code></td>
<td>
<p>threshold value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>parameter vector (<code class="reqn">\kappa</code>, <code class="reqn">\sigma</code>,<code class="reqn">\xi</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a string indicating which extended family to fit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show</code></td>
<td>
<p>logical; if <code>TRUE</code>, print the results of the optimization</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>extreme event probability; <code>p</code> must be greater than the rate of exceedance for the calculation to make sense. See <b>Details</b>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>boolean indicating whether or not to plot the return levels</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For return levels, the <code>p</code> argument can be related to <code class="reqn">T</code> year exceedances as follows:
if there are <code class="reqn">n_y</code> observations per year, than take <code>p</code>
to equal <code class="reqn">1/(Tn_y)</code> to obtain the <code class="reqn">T</code>-years return level.
</p>


<h3>Value</h3>

<p><code>egp.ll</code> returns the log-likelihood value.
</p>
<p><code>egp.retlev</code> returns a plot of the return levels if <code>plot=TRUE</code> and a matrix of return levels.
</p>


<h3>Usage</h3>

<p><code>egp.ll(xdat, thresh, par, model=c('egp1','egp2','egp3'))</code>
</p>
<p><code>egp.retlev(xdat, thresh, par, model=c('egp1','egp2','egp3'), p, plot=TRUE)</code>
</p>


<h3>Author(s)</h3>

<p>Leo Belzile
</p>


<h3>References</h3>

<p>Papastathopoulos, I. and J. Tawn (2013). Extended generalised Pareto models for tail estimation, <em>Journal of Statistical Planning and Inference</em> <b>143</b>(3), 131â€“143.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)
xdat &lt;- mev::rgp(1000, loc = 0, scale = 2, shape = 0.5)
par &lt;- fit.egp(xdat, thresh = 0, model = 'egp3')$par
p &lt;- c(1/1000, 1/1500, 1/2000)
#With multiple thresholds
th &lt;- c(0, 0.1, 0.2, 1)
opt &lt;- tstab.egp(xdat, th, model = 'egp1')
egp.retlev(xdat, opt$thresh, opt$par, 'egp1', p = p)
opt &lt;- tstab.egp(xdat, th, model = 'egp2', plots = NA)
egp.retlev(xdat, opt$thresh, opt$par, 'egp2', p = p)
opt &lt;- tstab.egp(xdat, th, model = 'egp3', plots = NA)
egp.retlev(xdat, opt$thresh, opt$par, 'egp3', p = p)
</code></pre>


</div>