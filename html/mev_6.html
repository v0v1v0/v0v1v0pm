<div class="container">

<table style="width: 100%;"><tr>
<td>.gpd_2D_fit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Maximum likelihood method for the generalized Pareto Model</h2>

<h3>Description</h3>

<p>Maximum-likelihood estimation for the generalized Pareto model, including generalized linear modelling of each parameter. This function was adapted by Paul Northrop to include the gradient in the <code>gpd.fit</code> routine from <code>ismev</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">.gpd_2D_fit(
  xdat,
  threshold,
  npy = 365,
  ydat = NULL,
  sigl = NULL,
  shl = NULL,
  siglink = identity,
  shlink = identity,
  siginit = NULL,
  shinit = NULL,
  show = TRUE,
  method = "Nelder-Mead",
  maxit = 10000,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xdat</code></td>
<td>
<p>numeric vector of data to be fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>a scalar or a numeric   vector of the same length as <code>xdat</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npy</code></td>
<td>
<p>number of observations per year/block.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ydat</code></td>
<td>
<p>matrix of covariates for generalized linear modelling of the parameters (or <code>NULL</code> (the default) for stationary fitting). The number of rows should be the same as the length of <code>xdat</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigl</code></td>
<td>
<p>numeric vector of integers, giving the columns of <code>ydat</code> that contain covariates for generalized linear modelling of the scale parameter (or <code>NULL</code> (the default) if the corresponding parameter is stationary).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shl</code></td>
<td>
<p>numeric vector of integers, giving the columns of <code>ydat</code> that contain covariates for generalized linear modelling of the shape parameter (or <code>NULL</code> (the default) if the corresponding parameter is stationary).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>siglink</code></td>
<td>
<p>inverse link functions for generalized linear modelling of the scale parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shlink</code></td>
<td>
<p>inverse link functions for generalized linear modelling of the shape parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>siginit</code></td>
<td>
<p>numeric giving initial value(s) for parameter estimates. If <code>NULL</code> the default is <code>sqrt(6 * var(xdat))/pi</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shinit</code></td>
<td>
<p>numeric giving initial value(s) for the shape parameter estimate; if <code>NULL</code>, this is 0.1.  If using parameter covariates, then these values are used for the constant term, and zeros for all other terms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), print details of the fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>optimization method (see <code>optim</code> for details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>maximum number of iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other control parameters for the optimization. These are passed to components of the <code>control</code> argument of <code>optim</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For non-stationary fitting it is recommended that the covariates within the generalized linear models are (at least approximately) centered and scaled (i.e. the columns of <code>ydat</code> should be approximately centered and scaled).
</p>
<p>The form of the GP model used follows Coles (2001) Eq (4.7).  In particular, the shape parameter is defined so that positive values imply a heavy tail and negative values imply a bounded upper value.
</p>


<h3>Value</h3>

<p>a list with components
</p>

<dl>
<dt>nexc</dt>
<dd>
<p>scalar giving the number of threshold exceedances.</p>
</dd>
<dt>nllh</dt>
<dd>
<p>scalar giving the negative log-likelihood value.</p>
</dd>
<dt>mle</dt>
<dd>
<p>numeric vector giving the MLE's for the scale and shape parameters, resp.</p>
</dd>
<dt>rate</dt>
<dd>
<p>scalar giving the estimated probability of exceeding the threshold.</p>
</dd>
<dt>se</dt>
<dd>
<p>numeric vector giving the standard error estimates for the scale and shape parameter estimates, resp.</p>
</dd>
<dt>trans</dt>
<dd>
<p>logical indicator for a non-stationary fit.</p>
</dd>
<dt>model</dt>
<dd>
<p>list with components <code>sigl</code> and <code>shl</code>.</p>
</dd>
<dt>link</dt>
<dd>
<p>character vector giving inverse link functions.</p>
</dd>
<dt>threshold</dt>
<dd>
<p>threshold, or vector of thresholds.</p>
</dd>
<dt>nexc</dt>
<dd>
<p>number of data points above the threshold.</p>
</dd>
<dt>data</dt>
<dd>
<p>data that lie above the threshold. For non-stationary models, the data are standardized.</p>
</dd>
<dt>conv</dt>
<dd>
<p>convergence code, taken from the list returned by <code>optim</code>. A zero indicates successful convergence.</p>
</dd>
<dt>nllh</dt>
<dd>
<p>negative log likelihood evaluated at the maximum likelihood estimates.</p>
</dd>
<dt>vals</dt>
<dd>
<p>matrix with three columns containing the maximum likelihood estimates of the scale and shape parameters, and the threshold, at each data point.</p>
</dd>
<dt>mle</dt>
<dd>
<p>vector containing the maximum likelihood estimates.</p>
</dd>
<dt>rate</dt>
<dd>
<p>proportion of data points that lie above the threshold.</p>
</dd>
<dt>cov</dt>
<dd>
<p>covariance matrix.</p>
</dd>
<dt>se</dt>
<dd>
<p>numeric vector containing the standard errors.</p>
</dd>
<dt>n</dt>
<dd>
<p>number of data points (i.e., the length of <code>xdat</code>).</p>
</dd>
<dt>npy</dt>
<dd>
<p>number of observations per year/block.</p>
</dd>
<dt>xdata</dt>
<dd>
<p>data that has been fitted.</p>
</dd>
</dl>
<h3>References</h3>

<p>Coles, S., 2001.  An Introduction to Statistical Modeling of Extreme Values.  Springer-Verlag, London.
</p>


</div>