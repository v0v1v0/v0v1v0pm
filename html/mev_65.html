<div class="container">

<table style="width: 100%;"><tr>
<td>ext.index</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extremal index estimators based on interexceedance time and gap of exceedances</h2>

<h3>Description</h3>

<p>The function implements the maximum likelihood estimator and iteratively reweighted least
square estimators of Suveges (2007)  as well as the intervals estimator. The implementation
differs from the presentation of the paper in that an iteration limit is enforced to make sure
the iterative procedure terminates. Multiple thresholds can be supplied.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ext.index(
  xdat,
  q = 0.95,
  method = c("wls", "mle", "intervals"),
  plot = FALSE,
  warn = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xdat</code></td>
<td>
<p>numeric vector of observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>a vector of quantile levels in (0,1). Defaults to 0.95</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a string specifying the chosen method. Must be either <code>wls</code>
for weighted least squares, <code>mle</code> for maximum likelihood estimation or <code>intervals</code>
for the intervals estimator of Ferro and Segers (2003). Partial match is allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical; if <code>TRUE</code>, plot the extremal index as a function of <code>q</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warn</code></td>
<td>
<p>logical; if <code>TRUE</code>, receive a warning when the sample size is too small</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The iteratively reweighted least square is a procedure based on the gaps of exceedances <code class="reqn">S_n=T_n-1</code>
The model is first fitted to non-zero gaps, which are rescaled to have unit exponential scale. The slope
between the theoretical quantiles and the normalized gap of exceedances is <code class="reqn">b=1/\theta</code>,
with intercept <code class="reqn">a=\log(\theta)/\theta</code>.
As such, the estimate of the extremal index is based on <code class="reqn">\hat{\theta}=\exp(\hat{a}/\hat{b})</code>.
The weights are chosen in such a way as to reduce the influence of the smallest values.
The estimator exploits the dual role of <code class="reqn">\theta</code> as the parameter of the mean for
the interexceedance time as well as the mixture proportion for the non-zero component.
</p>
<p>The maximum likelihood is based on an independence likelihood for the rescaled gap of exceedances,
namely <code class="reqn">\bar{F}(u_n)S(u_n)</code>. The score equation is equivalent to a quadratic equation in
<code class="reqn">\theta</code> and the maximum likelihood estimate is available in closed form.
Its validity requires however condition <code class="reqn">D^{(2)}(u_n)</code> to apply;
this should be checked by the user beforehand.
</p>
<p>A warning is emitted if the effective sample size is less than 50 observations.
</p>


<h3>Value</h3>

<p>a vector or matrix of estimated extremal index of dimension <code>length(method)</code> by <code>length(q)</code>.
</p>


<h3>Author(s)</h3>

<p>Leo Belzile
</p>


<h3>References</h3>

<p>Ferro and Segers (2003). Inference for clusters of extreme values,
JRSS: Series B, <strong>65</strong>(2), 545-556.
</p>
<p>Suveges (2007) Likelihood estimation of the extremal index. <em>Extremes</em>,
<strong>10</strong>(1), 41-55.
</p>
<p>Suveges and Davison (2010), Model misspecification in peaks over threshold analysis. <em>Annals of Applied Statistics</em>, <strong>4</strong>(1), 203-221.
</p>
<p>Fukutome, Liniger and Suveges (2015), Automatic threshold and run parameter selection: a climatology
for extreme hourly precipitation in Switzerland. <em>Theoretical and Applied Climatology</em>,
<strong>120</strong>(3), 403-416.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(234)
#Moving maxima model with theta=0.5
a &lt;- 1; theta &lt;-  1/(1+a)
sim &lt;- rgev(10001, loc=1/(1+a),scale=1/(1+a),shape=1)
x &lt;- pmax(sim[-length(sim)]*a,sim[-1])
q &lt;- seq(0.9,0.99,by=0.01)
ext.index(xdat=x,q=q,method=c('wls','mle'))
</code></pre>


</div>