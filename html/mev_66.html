<div class="container">

<table style="width: 100%;"><tr>
<td>extcoef</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimators of the extremal coefficient</h2>

<h3>Description</h3>

<p>These functions estimate the extremal coefficient using an approximate sample
from the Frechet distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">extcoef(
  dat,
  coord = NULL,
  thresh = NULL,
  estimator = c("schlather", "smith", "fmado"),
  standardize = TRUE,
  method = c("nonparametric", "parametric"),
  prob = 0,
  plot = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>an <code>n</code> by <code>D</code> matrix of unit Frechet observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coord</code></td>
<td>
<p>an optional <code>d</code> by <code>D</code> matrix of location coordinates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh</code></td>
<td>
<p>threshold parameter (default is to keep all data if <code>prob = 0</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimator</code></td>
<td>
<p>string indicating which model estimates to compute, one of <code>smith</code>, <code>schlather</code> or <code>fmado</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standardize</code></td>
<td>
<p>logical; should observations be transformed to unit Frechet scale? Default is to transform</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>string indicating which method to use to transform the margins. See <b>Details</b></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>probability of not exceeding threshold <code>thresh</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical; should cloud of pairwise empirical estimates be plotted? Default to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters passed to the function, currently ignored.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <b>Smith</b> estimator: suppose <code class="reqn">Z(x)</code> is simple max-stable vector
(i.e., with unit Frechet marginals). Then
<code class="reqn">1/Z</code> is unit exponential and <code class="reqn">1/\max(Z(s_1), Z(s_2))</code> is exponential
with rate <code class="reqn">\theta = \max\{Z(s_1), Z(s_2)\}</code>.
The extremal index for the pair can therefore be calculated using the reciprocal mean.
</p>
<p>The <b>Schlather and Tawn</b> estimator: the likelihood of the naive estimator for a pair
of two sites <code class="reqn">A</code> is
</p>
<p style="text-align: center;"><code class="reqn"> \mathrm{card}\left\{ j: \max_{i \in A} X_i^{(j)}\bar{X}_i)&gt;z \right\}
\log(\theta_A) - \theta_A \sum_{j=1}^n \left[ \max \left\{z, \max_{i \in A}
(X_i^{(j)}\bar{X}_i)\right\}\right]^{-1},</code>
</p>

<p>where <code class="reqn">\bar{X}_i = n^{-1} \sum_{j=1}^n 1/X_i^{(j)}</code> is the harmonic mean and <code class="reqn">z</code>
is a threshold on the unit Frechet scale.
The search for the maximum likelihood estimate for every pair <code class="reqn">A</code>
is restricted to the interval <code class="reqn">[1,3]</code>. A binned version of the extremal coefficient cloud is also returned.
The Schlather estimator is not self-consistent. The Schlather and Tawn estimator includes as special case
the Smith estimator if we do not censor the data (<code>p = 0</code>) and do not standardize observations by their harmonic mean.
</p>
<p>The <b>F-madogram</b> estimator is a non-parametric estimate based on a stationary process
<code class="reqn">Z</code>; the extremal coefficient satisfies
</p>
<p style="text-align: center;"><code class="reqn">\theta(h)=\frac{1+2\nu(h)}{1-2\nu(h)},</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\nu(h) = \frac{1}{2} \mathsf{E}[|F(Z(s+h)-F(Z(s))|]</code>
</p>

<p>The implementation only uses complete pairs to calculate the relative ranks.
</p>
<p>All estimators are coded in plain R and computations are not optimized. The estimation
time can therefore be significant for large data sets. If there are no missing observations,
the routine <code>fmadogram</code> from the <code>SpatialExtremes</code> package should be prefered as it is
noticeably faster.
</p>
<p>The data will typically consist of max-stable vectors or block maxima.
Both of the Smith and the Schlather–Tawn estimators require unit Frechet margins; the margins will be standardized
to the unit Frechet scale, either parametrically or nonparametrically unless <code>standardize = FALSE</code>.
If <code>method = "parametric"</code>, a parametric GEV model is fitted to each column of <code>dat</code> using maximum likelihood
estimation and transformed back using the probability integral transform. If <code>method = "nonparametric"</code>,
using the empirical distribution function. The latter is the default, as it is appreciably faster.
</p>


<h3>Value</h3>

<p>an invisible list with vectors <code>dist</code> if <code>coord</code> is non-null or else a matrix of pairwise indices <code>ind</code>,
<code>extcoef</code> and the supplied <code>estimator</code>, <code>fmado</code> and <code>binned</code>. If <code>estimator == "schlather"</code>, an additional matrix with 2 columns containing the binned distance <code>binned</code> with the <code>h</code> and the binned extremal coefficient.
</p>


<h3>References</h3>

<p>Schlather, M. and J. Tawn (2003). A dependence measure for multivariate and spatial extremes, <em>Biometrika</em>, <b>90</b>(1), pp.139–156.
</p>
<p>Cooley, D., P. Naveau and P. Poncet (2006). Variograms for spatial max-stable random fields,  In: Bertail P., Soulier P., Doukhan P. (eds) <em>Dependence in Probability and Statistics</em>. Lecture Notes in Statistics, vol. 187. Springer, New York, NY
</p>
<p>R. J. Erhardt, R. L. Smith (2012), Approximate Bayesian computing for spatial extremes, <em>Computational Statistics and Data Analysis</em>, <b>56</b>, pp.1468–1481.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
coord &lt;- 10*cbind(runif(50), runif(50))
di &lt;- as.matrix(dist(coord))
dat &lt;- rmev(n = 1000, d = 100, param = 3, sigma = exp(-di/2), model = 'xstud')
res &lt;- extcoef(dat = dat, coord = coord)
# Extremal Student extremal coefficient function

XT.extcoeffun &lt;- function(h, nu, corrfun, ...){
  if(!is.function(corrfun)){
    stop('Invalid function \"corrfun\".')
  }
  h &lt;- unique(as.vector(h))
  rhoh &lt;- sapply(h, corrfun, ...)
  cbind(h = h, extcoef = 2*pt(sqrt((nu+1)*(1-rhoh)/(1+rhoh)), nu+1))
}
#This time, only one graph with theoretical extremal coef
plot(res$dist, res$extcoef, ylim = c(1,2), pch = 20); abline(v = 2, col = 'gray')
extcoefxt &lt;- XT.extcoeffun(seq(0, 10, by = 0.1), nu = 3,
                            corrfun = function(x){exp(-x/2)})
lines(extcoefxt[,'h'], extcoefxt[,'extcoef'], type = 'l', col = 'blue', lwd = 2)
# Brown--Resnick extremal coefficient function
BR.extcoeffun &lt;- function(h, vario, ...){
  if(!is.function(vario)){
    stop('Invalid function \"vario\".')
  }
  h &lt;- unique(as.vector(h))
  gammah &lt;- sapply(h, vario, ...)
  cbind(h = h, extcoef = 2*pnorm(sqrt(gammah/4)))
}
extcoefbr&lt;- BR.extcoeffun(seq(0, 20, by = 0.25), vario = function(x){2*x^0.7})
lines(extcoefbr[,'h'], extcoefbr[,'extcoef'], type = 'l', col = 'orange', lwd = 2)

coord &lt;- 10*cbind(runif(20), runif(20))
di &lt;- as.matrix(dist(coord))
dat &lt;- rmev(n = 1000, d = 20, param = 3, sigma = exp(-di/2), model = 'xstud')
res &lt;- extcoef(dat = dat, coord = coord, estimator = "smith")

## End(Not run)
</code></pre>


</div>