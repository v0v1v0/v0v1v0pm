<div class="container">

<table style="width: 100%;"><tr>
<td>extremo</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pairwise extremogram for max-risk functional</h2>

<h3>Description</h3>

<p>The function computes the pairwise <code class="reqn">chi</code> estimates and plots them as a function of the distance between sites.
</p>


<h3>Usage</h3>

<pre><code class="language-R">extremo(dat, margp, coord, scale = 1, rho = 0, plot = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>data matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margp</code></td>
<td>
<p>marginal probability above which to threshold observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coord</code></td>
<td>
<p>matrix of coordinates (one site per row)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>geometric anisotropy scale parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>geometric anisotropy angle parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical; should a graph of the pairwise estimates against distance? Default to <code>FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments passed to plot</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an invisible matrix with pairwise estimates of chi along with distance (unsorted)
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
lon &lt;- seq(650, 720, length = 10)
lat &lt;- seq(215, 290, length = 10)
# Create a grid
grid &lt;- expand.grid(lon,lat)
coord &lt;- as.matrix(grid)
dianiso &lt;- distg(coord, 1.5, 0.5)
sgrid &lt;- scale(grid, scale = FALSE)
# Specify marginal parameters `loc` and `scale` over grid
eta &lt;- 26 + 0.05*sgrid[,1] - 0.16*sgrid[,2]
tau &lt;- 9 + 0.05*sgrid[,1] - 0.04*sgrid[,2]
# Parameter matrix of Huesler--Reiss
# associated to power variogram
Lambda &lt;- ((dianiso/30)^0.7)/4
# Regular Euclidean distance between sites
di &lt;- distg(coord, 1, 0)
# Simulate generalized max-Pareto field
set.seed(345)
simu1 &lt;- rgparp(n = 1000, thresh = 50, shape = 0.1, riskf = "max",
                scale = tau, loc = eta, sigma = Lambda, model = "hr")
extdat &lt;- extremo(dat = simu1, margp = 0.98, coord = coord,
                  scale = 1.5, rho = 0.5, plot = TRUE)

# Constrained optimization
# Minimize distance between extremal coefficient from fitted variogram
mindistpvario &lt;- function(par, emp, coord){
alpha &lt;- par[1]; if(!isTRUE(all(alpha &gt; 0, alpha &lt; 2))){return(1e10)}
scale &lt;- par[2]; if(scale &lt;= 0){return(1e10)}
a &lt;- par[3]; if(a&lt;1){return(1e10)}
rho &lt;- par[4]; if(abs(rho) &gt;= pi/2){return(1e10)}
semivariomat &lt;- power.vario(distg(coord, a, rho), alpha = alpha, scale = scale)
  sum((2*(1-pnorm(sqrt(semivariomat[lower.tri(semivariomat)]/2))) - emp)^2)
}

hin &lt;- function(par, ...){
  c(1.99-par[1], -1e-5 + par[1],
    -1e-5 + par[2],
    par[3]-1,
    pi/2 - par[4],
    par[4]+pi/2)
  }
opt &lt;- alabama::auglag(par = c(0.7, 30, 1, 0),
                       hin = hin,
                        fn = function(par){
                          mindistpvario(par, emp = extdat[,'prob'], coord = coord)})
stopifnot(opt$kkt1, opt$kkt2)
# Plotting the extremogram in the deformed space
distfa &lt;- distg(loc = coord, opt$par[3], opt$par[4])
plot(
 x = c(distfa[lower.tri(distfa)]), 
 y = extdat[,2], 
 pch = 20,
 yaxs = "i", 
 xaxs = "i", 
 bty = 'l',
 xlab = "distance", 
 ylab= "cond. prob. of exceedance", 
 ylim = c(0,1))
lines(
  x = (distvec &lt;- seq(0,200, length = 1000)), 
  col = 2, lwd = 2,
  y = 2*(1-pnorm(sqrt(power.vario(distvec, alpha = opt$par[1],
                               scale = opt$par[2])/2))))

## End(Not run)
</code></pre>


</div>