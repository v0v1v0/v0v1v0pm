<div class="container">

<table style="width: 100%;"><tr>
<td>fit.extgp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit an extended generalized Pareto distribution of Naveau et al.</h2>

<h3>Description</h3>

<p>This is a wrapper function to obtain PWM or MLE estimates for
the extended GP models of Naveau et al. (2016) for rainfall intensities. The function calculates confidence intervals
by means of nonparametric percentile bootstrap and returns histograms and QQ plots of
the fitted distributions. The function handles both censoring and rounding.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit.extgp(
  data,
  model = 1,
  method = c("mle", "pwm"),
  init,
  censoring = c(0, Inf),
  rounded = 0,
  confint = FALSE,
  R = 1000,
  ncpus = 1,
  plots = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>integer ranging from 0 to 4 indicating the model to select (see <code>extgp</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>string; either <code>'mle'</code> for maximum likelihood, or <code>'pwm'</code> for probability weighted moments, or both.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>vector of initial values, comprising of <code class="reqn">p</code>, <code class="reqn">\kappa</code>, <code class="reqn">\delta</code>, <code class="reqn">\sigma</code>, <code class="reqn">\xi</code> (in that order) for the optimization. All parameters may not appear depending on <code>model</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>censoring</code></td>
<td>
<p>numeric vector of length 2 containing the lower and upper bound for censoring; <code>censoring=c(0,Inf)</code> is equivalent to no censoring.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rounded</code></td>
<td>
<p>numeric giving the instrumental precision (and rounding of the data), with default of 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>confint</code></td>
<td>
<p>logical; should confidence interval be returned (percentile bootstrap).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>integer; number of bootstrap replications.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncpus</code></td>
<td>
<p>integer; number of CPUs for parallel calculations (default: 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plots</code></td>
<td>
<p>logical; whether to produce histogram and density plots.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The different models include the following transformations:
</p>

<ul>
<li> <p><code>model</code> 0 corresponds to uniform carrier, <code class="reqn">G(u)=u</code>.
</p>
</li>
<li> <p><code>model</code> 1 corresponds to a three parameters family, with carrier <code class="reqn">G(u)=u^\kappa</code>.
</p>
</li>
<li> <p><code>model</code> 2 corresponds to a three parameters family, with carrier <code class="reqn">G(u)=1-V_\delta((1-u)^\delta)</code>.
</p>
</li>
<li> <p><code>model</code> 3 corresponds to a four parameters family, with carrier </p>
<p style="text-align: center;"><code class="reqn">G(u)=1-V_\delta((1-u)^\delta))^{\kappa/2}</code>
</p>
<p>.
</p>
</li>
<li> <p><code>model</code> 4 corresponds to a five parameter model (a mixture of <code>type</code> 2, with <code class="reqn">G(u)=pu^\kappa + (1-p)*u^\delta</code>
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Raphael Huser and Philippe Naveau
</p>


<h3>References</h3>

<p>Naveau, P., R. Huser, P. Ribereau, and A. Hannart (2016), Modeling jointly low, moderate, and heavy rainfall intensities without a threshold selection, <em>Water Resour. Res.</em>, 52, 2753-2769, <code>doi:10.1002/2015WR018552</code>.
</p>


<h3>See Also</h3>

<p><code>egp.fit</code>, <code>egp</code>, <code>extgp</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(rain, package = "ismev")
fit.extgp(rain[rain&gt;0], model=1, method = 'mle', init = c(0.9, gp.fit(rain, 0)$est),
 rounded = 0.1, confint = TRUE, R = 20)

## End(Not run)
</code></pre>


</div>