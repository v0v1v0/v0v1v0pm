<div class="container">

<table style="width: 100%;"><tr>
<td>fit.gpd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Maximum likelihood estimation for the generalized Pareto distribution</h2>

<h3>Description</h3>

<p>Numerical optimization of the generalized Pareto distribution for
data exceeding <code>threshold</code>.
This function returns an object of class <code>mev_gpd</code>, with default methods for printing and quantile-quantile plots.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit.gpd(
  xdat,
  threshold = 0,
  method = "Grimshaw",
  show = FALSE,
  MCMC = NULL,
  k = 4,
  tol = 1e-08,
  fpar = NULL,
  warnSE = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xdat</code></td>
<td>
<p>a numeric vector of data to be fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>the chosen threshold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the method to be used. See <b>Details</b>. Can be abbreviated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show</code></td>
<td>
<p>logical; if <code>TRUE</code> (the default), print details of the fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MCMC</code></td>
<td>
<p><code>NULL</code> for frequentist estimates, otherwise a boolean or a list with parameters passed. If <code>TRUE</code>, runs a Metropolis-Hastings sampler to get posterior mean estimates. Can be used to pass arguments <code>niter</code>, <code>burnin</code> and <code>thin</code> to the sampler as a list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>bound on the influence function (<code>method = "obre"</code>); the constant <code>k</code> is a robustness parameter
(higher bounds are more efficient, low bounds are more robust). Default to 4, must be larger than <code class="reqn">\sqrt{2}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>numerical tolerance for OBRE weights iterations (<code>method = "obre"</code>). Default to <code>1e-8</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fpar</code></td>
<td>
<p>a named list with fixed parameters, either <code>scale</code> or <code>shape</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warnSE</code></td>
<td>
<p>logical; if <code>TRUE</code>, a warning is printed if the standard errors cannot be returned from the observed information matrix when the shape is less than -0.5.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The default method is <code>'Grimshaw'</code>, which maximizes the profile likelihood for the ratio scale/shape.  Other options include <code>'obre'</code> for optimal <code class="reqn">B</code>-robust estimator of the parameter of Dupuis (1998), vanilla maximization of the log-likelihood using constrained optimization routine <code>'auglag'</code>, 1-dimensional optimization of the profile likelihood using <code>nlm</code> and <code>optim</code>. Method <code>'ismev'</code> performs the two-dimensional optimization routine <code>gpd.fit</code> from the <code>ismev</code> library, with in addition the algebraic gradient.
The approximate Bayesian methods (<code>'zs'</code> and <code>'zhang'</code>) are extracted respectively from Zhang and Stephens (2009) and Zhang (2010) and consists of a approximate posterior mean calculated via importance
sampling assuming a GPD prior is placed on the parameter of the profile likelihood.
</p>


<h3>Value</h3>

<p>If <code>method</code> is neither <code>'zs'</code> nor <code>'zhang'</code>, a list containing the following components:
</p>

<ul>
<li> <p><code>estimate</code> a vector containing the <code>scale</code> and <code>shape</code> parameters (optimized and fixed).
</p>
</li>
<li> <p><code>std.err</code> a vector containing the standard errors. For <code>method = "obre"</code>, these are Huber's robust standard errors.
</p>
</li>
<li> <p><code>vcov</code> the variance covariance matrix, obtained as the numerical inverse of the observed information matrix. For <code>method = "obre"</code>,
this is the sandwich Godambe matrix inverse.
</p>
</li>
<li> <p><code>threshold</code> the threshold.
</p>
</li>
<li> <p><code>method</code> the method used to fit the parameter. See details.
</p>
</li>
<li> <p><code>nllh</code> the negative log-likelihood evaluated at the parameter <code>estimate</code>.
</p>
</li>
<li> <p><code>nat</code> number of points lying above the threshold.
</p>
</li>
<li> <p><code>pat</code> proportion of points lying above the threshold.
</p>
</li>
<li> <p><code>convergence</code> components taken from the list returned by <code>optim</code>.
Values other than <code>0</code> indicate that the algorithm likely did not converge (in particular 1 and 50).
</p>
</li>
<li> <p><code>counts</code> components taken from the list returned by <code>optim</code>.
</p>
</li>
<li> <p><code>exceedances</code> excess over the threshold.
</p>
</li>
</ul>
<p>Additionally, if <code>method = "obre"</code>, a vector of OBRE <code>weights</code>.
</p>
<p>Otherwise, a list containing
</p>

<ul>
<li> <p><code>threshold</code> the threshold.
</p>
</li>
<li> <p><code>method</code> the method used to fit the parameter. See <b>Details</b>.
</p>
</li>
<li> <p><code>nat</code> number of points lying above the threshold.
</p>
</li>
<li> <p><code>pat</code> proportion of points lying above the threshold.
</p>
</li>
<li> <p><code>approx.mean</code> a vector containing containing the approximate posterior mean estimates.
</p>
</li>
</ul>
<p>and in addition if MCMC is neither <code>FALSE</code>, nor <code>NULL</code>
</p>

<ul>
<li> <p><code>post.mean</code> a vector containing the posterior mean estimates.
</p>
</li>
<li> <p><code>post.se</code> a vector containing the posterior standard error estimates.
</p>
</li>
<li> <p><code>accept.rate</code> proportion of points lying above the threshold.
</p>
</li>
<li> <p><code>niter</code> length of resulting Markov Chain
</p>
</li>
<li> <p><code>burnin</code> amount of discarded iterations at start, capped at 10000.
</p>
</li>
<li> <p><code>thin</code> thinning integer parameter describing
</p>
</li>
</ul>
<h3>Note</h3>

<p>Some of the internal functions (which are hidden from the user) allow for modelling of the parameters using covariates. This is not currently implemented within <code>gp.fit</code>, but users can call internal functions should they wish to use these features.
</p>


<h3>Author(s)</h3>

<p>Scott D. Grimshaw for the <code>Grimshaw</code> option. Paul J. Northrop and Claire L. Coleman for the methods <code>optim</code>, <code>nlm</code> and <code>ismev</code>.
J. Zhang and Michael A. Stephens (2009) and Zhang (2010) for the <code>zs</code> and <code>zhang</code> approximate methods and L. Belzile for methods <code>auglag</code> and <code>obre</code>, the wrapper and MCMC samplers.
</p>
<p>If <code>show = TRUE</code>, the optimal <code class="reqn">B</code> robust estimated weights for the largest observations are printed alongside with the
<code class="reqn">p</code>-value of the latter, obtained from the empirical distribution of the weights. This diagnostic can be used to guide threshold selection:
small weights for the <code class="reqn">r</code>-largest order statistics indicate that the robust fit is driven by the lower tail
and that the threshold should perhaps be increased.
</p>


<h3>References</h3>

<p>Davison, A.C. (1984). Modelling excesses over high thresholds, with an application, in
<em>Statistical extremes and applications</em>, J. Tiago de Oliveira (editor), D. Reidel Publishing Co., 461–482.
</p>
<p>Grimshaw, S.D. (1993). Computing Maximum Likelihood Estimates for the Generalized
Pareto Distribution, <em>Technometrics</em>, <b>35</b>(2), 185–191.
</p>
<p>Northrop, P.J. and C. L. Coleman (2014). Improved threshold diagnostic plots for extreme value
analyses, <em>Extremes</em>, <b>17</b>(2), 289–303.
</p>
<p>Zhang, J. (2010). Improving on estimation for the generalized Pareto distribution, <em>Technometrics</em> <b>52</b>(3), 335–339.
</p>
<p>Zhang, J.  and M. A. Stephens (2009). A new and efficient estimation method for the generalized Pareto distribution.
<em>Technometrics</em> <b>51</b>(3), 316–325.
</p>
<p>Dupuis, D.J. (1998). Exceedances over High Thresholds: A Guide to Threshold Selection,
<em>Extremes</em>, <b>1</b>(3), 251–261.
</p>


<h3>See Also</h3>

<p><code>fpot</code> and <code>gpd.fit</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(eskrain)
fit.gpd(eskrain, threshold = 35, method = 'Grimshaw', show = TRUE)
fit.gpd(eskrain, threshold = 30, method = 'zs', show = TRUE)
</code></pre>


</div>