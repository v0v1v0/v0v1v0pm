<div class="container">

<table style="width: 100%;"><tr>
<td>fmev</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting the Metastatistical Extreme Value Distribution (MEVD)</h2>

<h3>Description</h3>

<p>Fit the MEVD distribution to rainfall observations with different estimation methods.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fmev(data, threshold = 0, method = c("pwm", "mle", "ls"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The data to which the MEVD should be fitted to. <code>data</code> must be a data.frame with two columns. 
The first column must contain dates of class  <code>Date</code>, the second or last column must contain the rainfall 
values corresponding to datums in the rows. No negative values are allowed. NA values are removed with a warning.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>A numeric that is used to define wet days as values &gt; threshold. 
<code class="reqn">data &lt;= threshold</code> is set to NA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Character string describing the method that is used to estimate the 
Weibull parameters c and w. Possible options are probability weighted moments (<code>method='pwm'</code>), 
maximum likelihood (<code>method='mle'</code>) or least squares (<code>method='ls'</code>). 
The <code>default</code> is <code>pwm</code>. (see details).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>With the aim of weakening the requirement of an asymptotic assumption for the GEV distribution, 
a metastatistical approach was proposed by Marani and Ignaccolo (2015). The MEVD is defined 
in terms of the distribution of the statistical parameters describing "ordinary" daily rainfall 
occurrence and intensity. The MEVD accounts for the random process of event occurrence in each 
block and the possibly changing probability distribution of event magnitudes across different blocks, 
by recognizing the number of events in each block, n, and the values of the shape and scale 
parameters w and C of the parent Weibull distribution to be realisations of stochastic variables. 
The MEVD can then be written as
</p>
<p style="text-align: center;"><code class="reqn">F = \frac{1}{T} \sum_{j=1}^T \prod_{k \in A_j} \left( 1-e^{-\left(\frac{x}{C(j,k)}\right)^{w(j,k)}} \right)</code>
</p>

<p>for <code class="reqn">w &gt; 0</code> and <code class="reqn">C &gt; 0</code>. With T fully recorded years, yearly C and w can be estimated 
by fitting a Weibull distribution to the values x of this year, and n is the number of ordinary 
events per year, i.e. all rainfall events larger than a threshold. 
</p>
<p>If the probability distribution of daily rainfall is assumed to be time-invariant, the MEVD can be simplified to 
</p>
<p style="text-align: center;"><code class="reqn">F = [1 - exp(-x/C)^w]^n</code>
</p>

<p>with single values for the shape and scale parameters w and C. n is then the mean number of wet 
days at this location (Marra et al., 2019; Schellander et al., 2019).
</p>
<p>As is shown e.g. Schellander et al., 2019, probability weighted moments should be preferred 
over maximum likelihood for the estimation of the Weibull parameters w and C. 
Therefore <code>method = 'pwm'</code> is the default.
</p>
<p>The MEVD can also be used for sub-daily precipitation (Marra et al., 2019). 
In that case n has to be adapted accordingly to the 'mean number of wet events' per year.
</p>
<p>This function returns the parameters of the fitted MEVD distribution as well as some 
additional fitting results and input parameters useful for further analysis.
</p>


<h3>Value</h3>

<p>A list of class <code>mevr</code> with the fitted Weibull parameters and other helpful ingredients.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p> vector of Weibull scale parameters of the MEVD, each component refers to one year.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p> vector of Weibull shape parameters of the MEVD, each component refers to one year.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p> Number of wet events per year. Wet events are defined as rainfall &gt; <code>threshold</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p> A named vector of the fitted parameters. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxima</code></td>
<td>
<p> Maximum values corresponding to each year.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
 <p><code class="reqn">data &gt;= threshold</code> used to fit the MEVD and additional components which may be useful for further analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>years</code></td>
<td>
<p> Vector of years as YYYY.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p> The chosen threshold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p> Method used to fit the MEVD.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p> The type of distribution ("MEVD")</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Harald Schellander, Alexander Lieb
</p>


<h3>References</h3>

<p>Marani, M. and Ignaccolo, M. (2015) 'A metastatistical approach to rainfall extremes', Advances in Water Resources. Elsevier Ltd, 79(Supplement C), pp. 121-126. doi: 10.1016/j.advwatres.2015.03.001.
</p>
<p>Schellander, H., Lieb, A. and Hell, T. (2019) 'Error Structure of Metastatistical and Generalized Extreme Value Distributions for Modeling Extreme Rainfall in Austria', Earth and Space Science, 6, pp. 1616-1632. doi: 10.1029/2019ea000557.
</p>


<h3>See Also</h3>

<p><code>fsmev</code>, <code>ftmev</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(dailyrainfall)
fit &lt;- fmev(dailyrainfall, method = "mle")
fit
plot(fit)

</code></pre>


</div>