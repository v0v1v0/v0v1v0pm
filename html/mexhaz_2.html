<div class="container">

<table style="width: 100%;"><tr>
<td>adjsurv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Computation of direct adjusted survival estimates based on a mexhaz
model</h2>

<h3>Description</h3>

<p>Function for computing direct adjusted survival estimates
from a model fitted with the <code>mexhaz</code>. It can be used to obtain
direct adjusted survival estimates for one or two populations. In the
latter case, survival difference estimates are also
computed. Corresponding variance estimates are based on the Delta Method
(based on the assumption of multivariate normality of the model
parameter estimates). When the model includes a random effect, three types of
predictions can be made: (i) marginal predictions (obtained by
integration over the random effect distribution), (ii) cluster-specific
posterior predictions for an existing cluster, or (iii) conditional
predictions for a given quantile of the random effect distribution (by
default, for the median value, that is, 0).</p>


<h3>Usage</h3>

<pre><code class="language-R">adjsurv(object, time.pts, data, data.0 = NULL, weights = NULL,
marginal = TRUE, quant.rdm = 0.5, cluster = NULL, quant.rdm.0 = 0.5,
cluster.0 = NULL, level = 0.95, dataset = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of class <code>mexhaz</code>, corresponding to a
hazard-based regression model fitted with the <code>mexhaz</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.pts</code></td>
<td>
<p>a vector of numerical values representing the time
points at which predictions are requested. Time values greater than
the maximum follow-up time on which the model estimation was based
are discarded.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a <code>data.frame</code> containing the values of the
covariates of the population for which direct adjusted estimates
are to be calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.0</code></td>
<td>
<p>an optional <code>data.frame</code> containing the values of
the covariates of a second population for which direct adjusted
estimates can also be calculated (and compared with those of the
first population). The default value is set to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>optional argument specifying the weights to be
associated with each row of <code>data</code> (and <code>data.0</code>). the
default value is set to <code>NULL</code> which corresponds to attributing
to each row of the dataset(s) a weight equal to one over the total
number of rows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marginal</code></td>
<td>
<p>logical value controlling the type of predictions
returned by the function when the model includes a random
intercept. When <code>TRUE</code>, marginal predictions are computed. The
marginal survival is obtained by integrating the predicted survival over the
distribution of the random effect. The marginal hazard rate is
obtained as the opposite of the marginal time
derivative of the survival divided by the marginal survival. When
<code>FALSE</code> (default value), cluster-specific posterior predictions
or conditional predictions are calculated depending on the
value of the <code>cluster</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quant.rdm</code></td>
<td>
<p>numerical value (between 0 and 1) specifying the
quantile of the random effect distribution that should be used when
requesting conditional predictions. The default value is set to 0.5
(corresponding to the median, that is a value of the random effect
of 0). This argument is ignored if the model is a fixed effect
model, when the <code>marginal</code> argument is set to <code>TRUE</code>, or
the <code>cluster</code> argument is not <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>a single value corresponding to the name of the cluster for
which posterior predictions should be calculated. These predictions
are obtained by integrating over the cluster-specific posterior
distribution of the random effect and thus require the original
dataset. The dataset can either be provided as part of the
<code>mexhaz</code> object given as argument or by specifying the name of
the dataset in the <code>dataset</code> argument (see below). The <code>cluster</code> argument is not used if the model is a fixed effect
model. The default value is <code>NULL</code>: this corresponds to
marginal predictions (if <code>marginal</code> is set to <code>TRUE</code>, the preferred
option), or to conditional predictions for a given quantile (by
default, the median) of the distribution of the random
effect (if <code>marginal</code> is set to <code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quant.rdm.0</code></td>
<td>
<p>random effect distribution quantile value to be used with <code>data.0</code> (see
argument <code>quant.rdm</code> for details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster.0</code></td>
<td>
<p>cluster value to be used with <code>data.0</code> (see
argument <code>cluster</code> for details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>a number in (0,1) specifying the level of confidence for
computing the confidence intervals of the hazard and the
survival. By default, <code>level=0.95</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataset</code></td>
<td>
<p>original dataset used to fit the <code>mexhaz</code> object
given as argument to the function. This argument is only necessary
if cluster-specific posterior predictions are requested (and if the
dataset is not already provided in the <code>mexhaz</code> object). The
default value is set to <code>NULL</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>resMexhaz</code> that can be used by the function
<code>plot.resMexhaz</code> to produce graphics
of the direct adjusted survival curve. It contains the following
elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>results</code></td>
<td>
<p>a <code>data.frame</code> consisting of: the time points at
which the direct adjusted survival values have been calculated; the
direct ajusted survival values with their confidence limits for
population <code>data</code>; the direct ajusted survival values with their
confidence limits for population <code>data.0</code>; the direct adjusted
survival difference estimates with their confidence limits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of results returned by the function. The value is
used by <code>plot.resMexhaz</code> and <code>lines.resMexhaz</code>, and set to
<code>"as"</code> (adjusted survival).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>multiobs</code></td>
<td>
<p>value used by
<code>plot.resMexhaz</code> and <code>lines.resMexhaz</code>, and set to
<code>FALSE</code> (computation of the adjusted survival at several time
points for one vector of covariates).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.method</code></td>
<td>
<p>method used to compute confidence limits. Currently set
to <code>"delta"</code> as only the Delta Method is implemented.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>level of confidence used to compute confidence limits.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Hadrien Charvat, Aurelien Belot
</p>


<h3>References</h3>

<p>Charvat H, Remontet L, Bossard N, Roche L, Dejardin O,
Rachet B, Launoy G, Belot A; CENSUR Working Survival Group. A
multilevel excess hazard model to estimate net survival on
hierarchical data allowing for non-linear and non-proportional effects
of covariates. Stat Med 2016;35:3066-3084 (doi: 10.1002/sim.6881)
</p>
<p>Skrondal A, Rabe-Hesketh S. Prediction in multilevel generalized
linear models. J R Stat Soc A Stat Soc 2009;172(3):659-687 (doi: 10.1111/j.1467-985X.2009.00587.x).
</p>


<h3>See Also</h3>

<p><code>plot.resMexhaz</code>, <code>lines.resMexhaz</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(simdatn1)

## Fit of a fixed-effect hazard model, with the baseline hazard
## described by a linear B-spline with two knots at 1 and 5 year and with
## effects of age (agecr), deprivation index (depindex) and sex (IsexH)

Mod_bs1_2 &lt;- mexhaz(formula=Surv(time=timesurv,
event=vstat)~agecr+depindex+IsexH, data=simdatn1, base="exp.bs",
degree=1, knots=c(1,5), verbose=0)

## Direct adjusted survival for the simdatn1 population
DAS_Modbs1_2 &lt;- adjsurv(Mod_bs1_2, time.pts=seq(1,10),
data=simdatn1)

</code></pre>


</div>