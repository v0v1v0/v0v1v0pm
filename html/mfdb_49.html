<div class="container">

<table style="width: 100%;"><tr>
<td>mfdb_import_data</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MareFrame Data Import functions</h2>

<h3>Description</h3>

<p>Functions to import data into MareFrame DB
</p>


<h3>Usage</h3>

<pre><code class="language-R">    mfdb_import_temperature(mdb, data_in)
    mfdb_import_survey(mdb, data_in, data_source = 'default_sample')
    mfdb_import_survey_index(mdb, data_in, data_source = 'default_index')
    mfdb_import_stomach(mdb, predator_data, prey_data, data_source = "default_stomach")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mdb</code></td>
<td>

<p>Database connection created by <code>mfdb()</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data_in, predator_data, prey_data</code></td>
<td>

<p>A <code>data.frame</code> of survey data to import, see details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data_source</code></td>
<td>

<p>A name for this data, e.g. the filename it came from. Used so you can replace it later without disturbing other data.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>All functions will replace existing data in the case study with new data, unless you specify a <code>data_source</code>,
in which case then only existing data with the same <code>data_source</code> will be replaced.
</p>
<p>If you want to remove the data, import empty data.frames with the same <code>data_source</code>.
</p>
<p><code>mfdb_import_temperature</code> imports temperature time-series data for
areacells. The <code>data_in</code> should be a data.frame with the following columns:
</p>

<dl>
<dt>id</dt>
<dd>
<p>A numeric ID for this areacell (will be combined with the case study number internally)</p>
</dd>
<dt>year</dt>
<dd>
<p>Required. Year each sample was taken, e.g. <code>c(2000,2001)</code></p>
</dd>
<dt>month</dt>
<dd>
<p>Required. Month (1–12) each sample was taken, e.g. <code>c(1,12)</code></p>
</dd>
<dt>areacell</dt>
<dd>
<p>Required. Areacell sample was taken within</p>
</dd>
<dt>temperature</dt>
<dd>
<p>The temperature at given location/time</p>
</dd>
</dl>
<p><code>mfdb_import_survey</code> imports institution surveys and commercial sampling for your case study. The
<code>data_in</code> should be a data.frame with the following columns:
</p>

<dl>
<dt>institute</dt>
<dd>
<p>Optional. An institute name, see mfdb::institute for possible values</p>
</dd>
<dt>gear</dt>
<dd>
<p>Optional. Gear name, see mfdb::gear for possible values</p>
</dd>
<dt>vessel</dt>
<dd>
<p>Optional. Vessel defined previously with <code>mfdb_import_vessel_taxonomy(...)</code></p>
</dd>
<dt>tow</dt>
<dd>
<p>Optional. Tow defined previously with <code>mfdb_import_tow_taxonomy(...)</code></p>
</dd>
<dt>sampling_type</dt>
<dd>
<p>Optional. A sampling_type, see mfdb::sampling_type for possible values</p>
</dd>
<dt>year</dt>
<dd>
<p>Required. Year each sample was taken, e.g. <code>c(2000,2001)</code></p>
</dd>
<dt>month</dt>
<dd>
<p>Required. Month (1–12) each sample was taken, e.g. <code>c(1,12)</code></p>
</dd>
<dt>areacell</dt>
<dd>
<p>Required. Areacell sample was taken within</p>
</dd>
<dt>species</dt>
<dd>
<p>Optional, default <code>c(NA)</code>. Species of sample, see mfdb::species for possible values</p>
</dd>
<dt>age</dt>
<dd>
<p>Optional, default <code>c(NA)</code>. Age of sample, or mean age</p>
</dd>
<dt>sex</dt>
<dd>
<p>Optional, default <code>c(NA)</code>. Sex of sample, see mfdb::sex for possible values</p>
</dd>
<dt>length</dt>
<dd>
<p>Optional, default <code>c(NA)</code>. Length of sample / mean length of all samples</p>
</dd>
<dt>length_var</dt>
<dd>
<p>Optional, default <code>c(NA)</code>. Sample variance, if data is already aggregated</p>
</dd>
<dt>length_min</dt>
<dd>
<p>Optional, default <code>c(NA)</code>. Minimum theoretical length, if data is already aggregated</p>
</dd>
<dt>weight</dt>
<dd>
<p>Optional, default <code>c(NA)</code>. Weight of sample / mean weight of all samples</p>
</dd>
<dt>weight_var</dt>
<dd>
<p>Optional, default <code>c(NA)</code>. Sample variance, if data is already aggregated</p>
</dd>
<dt>weight_total</dt>
<dd>
<p>Optional, default <code>c(NA)</code>. Total weight of all samples, can be used with count = NA to represent an unknown number of samples</p>
</dd>
<dt>liver_weight</dt>
<dd>
<p>Optional, default <code>c(NA)</code>. Weight of sample / mean liver weight of all samples</p>
</dd>
<dt>liver_weight_var</dt>
<dd>
<p>Optional, default <code>c(NA)</code>. Sample variance, if data is already aggregated</p>
</dd>
<dt>gonad_weight</dt>
<dd>
<p>Optional, default <code>c(NA)</code>. Weight of sample / mean gonad weight of all samples</p>
</dd>
<dt>gonad_weight_var</dt>
<dd>
<p>Optional, default <code>c(NA)</code>. Sample variance, if data is already aggregated</p>
</dd>
<dt>stomach_weight</dt>
<dd>
<p>Optional, default <code>c(NA)</code>. Weight of sample / mean stomach weight of all samples</p>
</dd>
<dt>stomach_weight_var</dt>
<dd>
<p>Optional, default <code>c(NA)</code>. Sample variance, if data is already aggregated</p>
</dd>
<dt>count</dt>
<dd>
<p>Optional, default <code>c(1)</code>. Number of samples this row represents (i.e. if the data is aggregated)</p>
</dd>
</dl>
<p><code>mfdb_import_survey_index</code> adds indicies that can be used as abundance information, for example.
Before using <code>mfdb_import_survey_index</code>, make sure that the <code>index_type</code> you intend to use
exists by using mfdb_import_cs_taxonomy. The <code>data_in</code> should be a data.frame with the
following columns:
</p>

<dl>
<dt>index_type</dt>
<dd>
<p>Required. the name of the index data you are storing, e.g. 'acoustic'</p>
</dd>
<dt>year</dt>
<dd>
<p>Required. Year each sample was taken, e.g. <code>c(2000,2001)</code></p>
</dd>
<dt>month</dt>
<dd>
<p>Required. Month (1–12) each sample was taken, e.g. <code>c(1,12)</code></p>
</dd>
<dt>areacell</dt>
<dd>
<p>Required. Areacell sample was taken within</p>
</dd>
<dt>value</dt>
<dd>
<p>Value of the index at this point in space/time</p>
</dd>
</dl>
<p><code>mfdb_import_stomach</code> imports data on predators and prey. The predator and prey
data are stored separately, however they should be linked by the <code>stomach_name</code> column.
If a prey has a stomach name that doesn't match a predator, then an error will be returned.
</p>
<p>The <code>predator_data</code> should be a data.frame with the following columns:
</p>

<dl>
<dt>stomach_name</dt>
<dd>
<p>Required. An arbitary name that provides a link between the predator and prey tables</p>
</dd>
<dt>institute</dt>
<dd>
<p>Optional. An institute name, see mfdb::institute for possible values</p>
</dd>
<dt>gear</dt>
<dd>
<p>Optional. Gear name, see mfdb::gear for possible values</p>
</dd>
<dt>vessel</dt>
<dd>
<p>Optional. Vessel defined previously with <code>mfdb_import_vessel_taxonomy(mdb, ...)</code></p>
</dd>
<dt>tow</dt>
<dd>
<p>Optional. Tow defined previously with <code>mfdb_import_tow_taxonomy(...)</code></p>
</dd>
<dt>sampling_type</dt>
<dd>
<p>Optional. A sampling_type, see mfdb::sampling_type for possible values</p>
</dd>
<dt>year</dt>
<dd>
<p>Required. Year each sample was taken, e.g. <code>c(2000,2001)</code></p>
</dd>
<dt>month</dt>
<dd>
<p>Required. Month (1–12) each sample was taken, e.g. <code>c(1,12)</code></p>
</dd>
<dt>areacell</dt>
<dd>
<p>Required. Areacell sample was taken within</p>
</dd>
<dt>species</dt>
<dd>
<p>Optional, default <code>c(NA)</code>. Species of sample, see mfdb::species for possible values</p>
</dd>
<dt>age</dt>
<dd>
<p>Optional, default <code>c(NA)</code>. Age of sample, or mean age</p>
</dd>
<dt>sex</dt>
<dd>
<p>Optional, default <code>c(NA)</code>. Sex of sample, see mfdb::sex for possible values</p>
</dd>
<dt>maturity_stage</dt>
<dd>
<p>Optional, default <code>c(NA)</code>. Maturity stage of sample, see mfdb::maturity_stage for possible values</p>
</dd>
<dt>stomach_state</dt>
<dd>
<p>Optional, default <code>c(NA)</code>. Stomach state of sample, see mfdb::stomach_state for possible values</p>
</dd>
<dt>length</dt>
<dd>
<p>Optional, default <code>c(NA)</code>. Length of sample</p>
</dd>
<dt>weight</dt>
<dd>
<p>Optional, default <code>c(NA)</code>. Weight of sample</p>
</dd>
</dl>
<p>The <code>prey_data</code> should be a data.frame with the following columns:
</p>

<dl>
<dt>stomach_name</dt>
<dd>
<p>Required. The stomach name of the predator this was found in</p>
</dd>
<dt>species</dt>
<dd>
<p>Optional, default <code>c(NA)</code>. Species of sample, see mfdb::species for possible values</p>
</dd>
<dt>digestion_stage</dt>
<dd>
<p>Optional, default <code>c(NA)</code>. Stage of digestion of the sample, see mfdb::digestion_stage for possible values</p>
</dd>
<dt>length</dt>
<dd>
<p>Optional, default <code>c(NA)</code>. Length of sample / mean length of all samples</p>
</dd>
<dt>weight</dt>
<dd>
<p>Optional, default <code>c(NA)</code>. Weight of sample / mean weight of all samples</p>
</dd>
<dt>weight_total</dt>
<dd>
<p>Optional, default <code>c(NA)</code>. Total weight of all samples</p>
</dd>
<dt>count</dt>
<dd>
<p>Optional, default <code>c(NA)</code>. Number of samples this row represents (i.e. if the data is aggregated), count = NA represents an unknown number of samples</p>
</dd>
</dl>
<h3>Value</h3>

<p>NULL</p>


<h3>Examples</h3>

<pre><code class="language-R">mdb &lt;- mfdb(tempfile(fileext = '.duckdb'))

# We need to set-up vocabularies first
mfdb_import_area(mdb, data.frame(
    id = c(1,2,3),
    name = c('35F1', '35F2', '35F3'),
    size = c(5)))
mfdb_import_vessel_taxonomy(mdb, data.frame(
    name = c('1.RSH', '2.COM'),
    stringsAsFactors = FALSE))
mfdb_import_sampling_type(mdb, data.frame(
    name = c("RES", "LND"),
    description = c("Research", "Landings"),
    stringsAsFactors = FALSE))

data_in &lt;- read.csv(text = '
year,month,areacell,species,age,sex,length
1998,1,35F1,COD,3,M,140
1998,1,35F1,COD,3,M,150
1998,1,35F1,COD,3,F,150
')

data_in$institute &lt;- 'MRI'
data_in$gear &lt;- 'GIL'
data_in$vessel &lt;- '1.RSH'
data_in$sampling_type &lt;- 'RES'
mfdb_import_survey(mdb, data_in, data_source = 'cod-1998')

mfdb_disconnect(mdb)
</code></pre>


</div>