<div class="container">

<table style="width: 100%;"><tr>
<td>find_best_fpm_step</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function to find the best FP functions of given degree for a single variable</h2>

<h3>Description</h3>

<p>Handles the FP1 and the higher order FP cases. For parameter definitions, see
<code>find_best_fp_step()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">find_best_fpm_step(x, xi, degree, y, powers_current, powers, acdx, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an input matrix of dimensions nobs x nvars. Does not contain
intercept, but columns are already expanded into dummy variables as
necessary. Data are assumed to be shifted and scaled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xi</code></td>
<td>
<p>a character string indicating the name of the current variable
of interest, for which the best fractional polynomial transformation is
to be estimated in the current step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>
<p>degrees of freedom for fp transformation of <code>xi</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector for the response variable or a <code>Surv</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>powers_current</code></td>
<td>
<p>a list of length equal to the number of variables,
indicating the fp powers to be used in the current step for all variables
(except <code>xi</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>powers</code></td>
<td>
<p>a named list of numeric values that sets the permitted FP
powers for each covariate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acdx</code></td>
<td>
<p>a logical vector of length nvars indicating continuous variables
to undergo the approximate cumulative distribution (ACD) transformation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>passed to <code>fit_model()</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The "best" model is determined by the highest likelihood (or smallest
deviance by our definition as minus twice the log-likelihood). This is also
the case for the use of information criteria, as all models investigated in
this function have the same df, so the penalization term is equal for all
models and only their likelihoods differ.
</p>
<p>Note that the estimation of each fp power adds a degree of freedom. Thus,
all fp1s have 2 df, all fp2s have 4 df and so on.
</p>
<p>In the case that <code>degree = 1</code>, the linear model (fp power of 1) is NOT
returned, as it is not considered to be a fractional polynomial in this
algorithm.
A linear model has only one df, whereas the same function regarded as fp
would have 2 fp.
</p>


<h3>Value</h3>

<p>A list with several components:
</p>

<ul>
<li> <p><code>acd</code>: logical indicating if an ACD transformation was applied for <code>xi</code>.
</p>
</li>
<li> <p><code>powers</code>: fp powers investigated in step.
</p>
</li>
<li> <p><code>power_best</code>: the best power found. <code>power_best</code> will always be a
two-column matrix when an ACD transformation is used, otherwise the number
of columns will depend on <code>degree</code>.
</p>
</li>
<li> <p><code>metrics</code>: a matrix with performance indices for all models investigated.
Same number of rows as, and indexed by, <code>powers</code>.
</p>
</li>
<li> <p><code>model_best</code>: row index of best model in <code>metrics</code>.
</p>
</li>
</ul>
<h3>ACD transformation</h3>

<p>This function also handles the case of ACD transformations if <code>acdx</code> is set
to <code>TRUE</code> for <code>xi</code>. In this case, if <code>degree = 1</code>, then 7 models are
assessed (like for the non-acd case it excludes the linear case),
and if <code>degree = 2</code>, then 64 models are assessed (unlike the 36 models
for non-acd transformation). Other settings for <code>degree</code> are currently not
supported when used with ACD transformations.
</p>


</div>