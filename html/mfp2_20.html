<div class="container">

<table style="width: 100%;"><tr>
<td>find_best_fp_cycle</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Helper to run cycles of the mfp algorithm</h2>

<h3>Description</h3>

<p>This function estimates the best FP functions for all predictors in the
current cycle. To be used in <code>fit_mfp()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">find_best_fp_cycle(
  x,
  y,
  powers_current,
  df,
  weights,
  offset,
  family,
  criterion,
  select,
  alpha,
  keep,
  powers,
  method,
  strata,
  verbose,
  ftest,
  control,
  rownames,
  nocenter,
  acdx
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an input matrix of dimensions nobs x nvars. Does not contain
intercept, but columns are already expanded into dummy variables as
necessary. Data are assumed to be shifted and scaled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector for the response variable or a <code>Surv</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>powers_current</code></td>
<td>
<p>a list of length equal to the number of variables,
indicating the fp powers to be used in the current step for all variables
(except <code>xi</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>a numeric vector of length nvars of degrees of freedom.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>a vector of observation weights of length nobs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>a vector of length nobs of offsets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>a character string representing a family object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>a character string defining the criterion used to select
variables and FP models of different degrees.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>select</code></td>
<td>
<p>a numeric vector of length nvars indicating significance levels
for backward elimination.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>a numeric vector of length nvars indicating significance levels
for tests between FP models of different degrees.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep</code></td>
<td>
<p>a character vector with names of variables to be kept
in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>powers</code></td>
<td>
<p>a named list of numeric values that sets the permitted FP
powers for each covariate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string specifying the method for tie handling in
Cox regression model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strata</code></td>
<td>
<p>a factor of all possible combinations of stratification
variables. Returned from <code>survival::strata()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>a logical; run in verbose mode.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ftest</code></td>
<td>
<p>a logical indicating the use of the F-test for Gaussian models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list with parameters for model fit. See <code>survival::coxph()</code>
or <code>stats::glm()</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rownames</code></td>
<td>
<p>passed to <code>survival::coxph.fit()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nocenter</code></td>
<td>
<p>a numeric vector with a list of values for fitting Cox
models. See <code>survival::coxph()</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acdx</code></td>
<td>
<p>a logical vector of length nvars indicating which continuous
variables should undergo the approximate cumulative distribution (ACD)
transformation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A cycle is defined as a complete pass through all the predictors in the input
matrix <code>x</code>, while a step is defined as the assessment of a single predictor.
This algorithm is described in Sauerbrei et al. (2006) and given in detail
in Royston and Sauerbrei (2008), in particular chapter 6.
</p>
<p>Briefly, a cycle works as follows: it takes as input the data matrix along with
a set of current best fp powers for each variable. In each step, the fp
powers of a single covariate are assessed, while adjusting for other
covariates. Adjustment variables are transformed using their current
fp powers (this is done in <code>transform_data_step()</code>) and the fp powers
of the variable of interest are tested using the closed test procedure
(conducted in <code>find_best_fp_step()</code>).
Some of the adjustment variables may have their fp power set to <code>NA</code>,
which means they were not selected from the working model and are not used
in that step. The results from all steps are returned, completing a cycle.
</p>
<p>Note that in each cycle every variable is evaluated.This includes variables
that may have been eliminated in previous cycles. They will re-enter each
new cycle for potential inclusion in the working model or to be re-evaluated
for elimination.
</p>
<p>The current adjustment set is always given through the current fp powers,
which are updated in each step (denoted as <code>powers_current</code>).
</p>


<h3>Value</h3>

<p>current FP powers
</p>


<h3>References</h3>

<p>Royston, P. and Sauerbrei, W., 2008. <em>Multivariable Model - Building:
A Pragmatic Approach to Regression Anaylsis based on Fractional Polynomials
for Modelling Continuous Variables. John Wiley &amp; Sons.</em><br>
Sauerbrei, W., Meier-Hirmer, C., Benner, A. and Royston, P., 2006.
<em>Multivariable regression model building by using fractional
polynomials: Description of SAS, STATA and R programs.
Comput Stat Data Anal, 50(12): 3464-85.</em>
Sauerbrei, W. and Royston, P., 1999. <em>Building multivariable prognostic
and diagnostic models: transformation of the predictors by using fractional
polynomials. J Roy Stat Soc a Sta, 162:71-94.</em>
</p>


</div>