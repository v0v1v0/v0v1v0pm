<div class="container">

<table style="width: 100%;"><tr>
<td>fit_acd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function to estimate approximate cumulative distribution (ACD)</h2>

<h3>Description</h3>

<p>Fits ACD transformation as outlined in Royston (2014). The ACD transformation
smoothly maps the observed distribution of a continuous covariate x onto one scale,
namely, that of an approximate uniform distribution on the interval (0, 1).
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit_acd(x, powers = NULL, shift = 0, scale = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>powers</code></td>
<td>
<p>a vector of allowed FP powers. The default value is <code>NULL</code>,
meaning that the set <code class="reqn">S = (-2, -1, -0.5, 0, 0.5, 1, 2, 3)</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shift</code></td>
<td>
<p>a numeric that is used to shift the values of <code>x</code> to positive
values. The default value is 0, meaning no shifting is conducted.
If <code>NULL</code>, then the program will estimate an appropriate shift automatically
(see <code>find_shift_factor()</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>a numeric used to scale <code>x</code>. The default value is 1, meaning
no scaling is conducted. If <code>NULL</code>, then the program will estimate
an appropriate scaling factor automatically (see <code>find_scale_factor()</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Briefly, the estimation works as follows. First, the input data are shifted
to positive values and scaled as requested. Then
</p>
<p style="text-align: center;"><code class="reqn">z = \Phi^{-1}(\frac{rank(x) - 0.5}{n}) </code>
</p>

<p>is computed, where <code class="reqn">n</code> is the number of elements in <code>x</code>,
with ties in the ranks handled as averages. To approximate <code class="reqn">z</code>,
an FP1 model (least squares) is used, i.e.
<code class="reqn">E(z) = \beta_0 + \beta_1 (x)^p</code>, where <code class="reqn">p</code> is chosen such that it
provides the best fitting model among all possible FP1 models.
The ACD transformation is then given as
</p>
<p style="text-align: center;"><code class="reqn">acd(x) = \Phi(\hat{z}),</code>
</p>

<p>where the fitted values of the estimated model are used.
If the relationship between a response Y and acd(x) is linear,
say, <code class="reqn">E(Y) = \beta_0 + \beta_1 acd(x)</code>, the relationship between Y
and x is nonlinear and is typically sigmoid in shape.
The parameters <code class="reqn">\beta_0</code> and <code class="reqn">\beta_0 + \beta_1</code> in such a model are
interpreted as the expected values of Y at the minimum and maximum of x,
that is, at acd(x) = 0 and 1, respectively.
The parameter <code class="reqn">\beta_1</code> represents the range of predictions of <code class="reqn">E(Y)</code>
across the whole observed distribution of x (Royston 2014).
</p>


<h3>Value</h3>

<p>A list is returned with components
</p>

<ul>
<li> <p><code>acd</code>: the acd transformed input data.
</p>
</li>
<li> <p><code>beta0</code>: intercept of estimated model.
</p>
</li>
<li> <p><code>beta1</code>: coefficient of estimated model.
</p>
</li>
<li> <p><code>power</code>: estimated power.
</p>
</li>
<li> <p><code>shift</code>: shift value used for computations.
</p>
</li>
<li> <p><code>scale</code>: scaling factor used for computations.
</p>
</li>
</ul>
<h3>References</h3>

<p>Royston, P. and Sauerbrei, W. (2016). <em>mfpa: Extension of mfp using the
ACD covariate transformation for enhanced parametric multivariable modeling.
The Stata Journal, 16(1), pp.72-87.</em>
</p>
<p>Royston, P. (2014). <em>A smooth covariate rank transformation for use in
regression models with a sigmoid doseâ€“response function. The Stata Journal,
14(2), 329-341</em>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
set.seed(42)
x = apply_shift_scale(rnorm(100))
y = rnorm(100)
fit_acd(x, y)

</code></pre>


</div>