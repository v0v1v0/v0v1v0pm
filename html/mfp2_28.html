<div class="container">

<table style="width: 100%;"><tr>
<td>fit_mfp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function for fitting a model using the MFP or MFPA algorithm</h2>

<h3>Description</h3>

<p>This function is not exported and is intended to be called from
the <code>mfp2()</code> function. While most parameters are explained in
the documentation of <code>mfp2()</code>, their form may differ in this
function. Note that this function does not check its arguments
and expects that its input has been prepared in <code>mfp2()</code> function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit_mfp(
  x,
  y,
  weights,
  offset,
  cycles,
  scale,
  shift,
  df,
  center,
  family,
  criterion,
  select,
  alpha,
  keep,
  xorder,
  powers,
  method,
  strata,
  nocenter,
  acdx,
  ftest,
  control,
  verbose
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an input matrix of dimensions nobs x nvars. Does not contain
intercept, but columns are already expanded into dummy variables as
necessary. Data are assumed to be shifted and scaled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector for the response variable or a <code>Surv</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>a vector of observation weights of length nobs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>a vector of length nobs of offsets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cycles</code></td>
<td>
<p>an integer representing the maximum number of
iteration cycles during which FP powers for all predictor are updated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>a numeric vector of length nvars of scaling factors. Not applied,
but re-ordered to conform to <code>xorder</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shift</code></td>
<td>
<p>a numeric vector of length nvars of shifts. Not applied,
but re-ordered to conform to <code>xorder</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>a numeric vector of length nvars of degrees of freedom.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>a logical vector of length nvars indicating if variables are
to be centered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>a character string representing a family object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>a character string defining the criterion used to select
variables and FP models of different degrees.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>select</code></td>
<td>
<p>a numeric vector of length nvars indicating significance levels
for backward elimination.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>a numeric vector of length nvars indicating significance levels
for tests between FP models of different degrees.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep</code></td>
<td>
<p>a character vector with names of variables to be kept
in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xorder</code></td>
<td>
<p>a string determining the order of entry of the covariates
into the model-selection algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>powers</code></td>
<td>
<p>a named list of numeric values that sets the permitted FP
powers for each covariate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string specifying the method for tie handling in
Cox regression model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strata</code></td>
<td>
<p>a factor of all possible combinations of stratification
variables. Returned from <code>survival::strata()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nocenter</code></td>
<td>
<p>a numeric vector with a list of values for fitting Cox
models. See <code>survival::coxph()</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acdx</code></td>
<td>
<p>a logical vector of length nvars indicating which continuous
variables should undergo the approximate cumulative distribution (ACD)
transformation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ftest</code></td>
<td>
<p>a logical indicating the use of the F-test for Gaussian models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list with parameters for model fit. See <code>survival::coxph()</code>
or <code>stats::glm()</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>a logical; run in verbose mode.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>See <code>mfp2()</code> for details on the returned object.
</p>


<h3>Algorithm</h3>


<ul>
<li>
<p> Step 1: order variables according to <code>xorder</code>. This step may involve
fitting a regression model to determine order of significance.
</p>
</li>
<li>
<p> Step 2: input data pre-processing. Setting initial powers for fractional
polynomial terms, checking if acd transformation is required and allowed.
Note that the initial powers of all variables are always set to 1, and higher
FPs are only evaluated in turn for each variables in the first cycle of the
algorithm. See e.g. Sauerbrei and Royston (1999).
</p>
</li>
<li>
<p> Step 3: run mfp algorithm cycles. See <code>find_best_fp_cycle()</code> for more
details.
</p>
</li>
<li>
<p> Step 4: fit final model using estimated powers.
</p>
</li>
</ul>
<h3>References</h3>

<p>Sauerbrei, W. and Royston, P., 1999. <em>Building multivariable prognostic
and diagnostic models: transformation of the predictors by using fractional
polynomials. J Roy Stat Soc a Sta, 162:71-94.</em>
</p>


<h3>See Also</h3>

<p><code>mfp2()</code>, <code>find_best_fp_cycle()</code>
</p>


</div>