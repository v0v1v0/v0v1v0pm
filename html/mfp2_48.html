<div class="container">

<table style="width: 100%;"><tr>
<td>fracplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot response functions from a fitted <code>mfp2</code> object</h2>

<h3>Description</h3>

<p>Plots the partial linear predictors with confidence limits
against the selected covariate(s) of interest.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fracplot(
  model,
  terms = NULL,
  partial_only = FALSE,
  type = c("terms", "contrasts"),
  ref = NULL,
  terms_seq = c("data", "equidistant"),
  alpha = 0.05,
  color_points = "#AAAAAA",
  color_line = "#000000",
  color_fill = "#000000",
  shape = 1,
  size_points = 1,
  linetype = "solid",
  linewidth = 1,
  alpha_fill = 0.1
)

plot_mfp(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>fitted <code>mfp2</code> model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms</code></td>
<td>
<p>character vector with variable names to be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>partial_only</code></td>
<td>
<p>a logical value indicating whether only the partial
predictor (component) is drawn (<code>TRUE</code>), or also component-plus-residual
(<code>FALSE</code>, the default). Only used if <code>type = "terms"</code>. See below for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type, ref, terms_seq</code></td>
<td>
<p>arguments of <code>predict.mfp2()</code>. Only
<code>type = "terms"</code> and <code>type = "contrasts"</code> are supported by this function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p><code>alpha</code> argument of <code>predict.mfp2()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color_line, linetype, linewidth</code></td>
<td>
<p><code>ggplot2</code> properties of line for
partial predictor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color_fill, alpha_fill</code></td>
<td>
<p><code>ggplot2</code> properties of ribbon for confidence
interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape, size_points, color_points</code></td>
<td>
<p><code>ggplot2</code> properties of drawn
data points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>used in alias <code>plot_mfp</code> to pass arguments.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The confidence limits of the partial linear predictors or contrasts are
obtained from the varianceâ€“covariance matrix of the final fitted model,
which takes into account the uncertainty in estimating the model parameters
but not the FP powers. This can lead to narrow confidence intervals. A simple
way to obtain more realistic confidence intervals within the FP is by using
bootstrap, which is not currently implemented. See Royston and Sauerbrei (2008)
chapter 4.9.2 for guidance on conducting bootstrapping within
the FP class.
</p>
<p>The component-plus-residual, is the partial linear predictor plus residuals,
where deviance residuals are used in generalized linear regression models,
while martingale residuals are used in Cox models, as done in Stata mfp program.
This kind of plot is only available if <code>type = "terms"</code>.
</p>


<h3>Value</h3>

<p>A list of <code>ggplot2</code> plot objects, one for each term requested. Can be
drawn as individual plots or facetted / combined easily using e.g.
<code>patchwork::wrap_plots</code> and further customized.
</p>


<h3>Functions</h3>


<ul><li> <p><code>plot_mfp()</code>: Alias for fracplot.
</p>
</li></ul>
<h3>See Also</h3>

<p><code>predict.mfp2()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Gaussian
data("prostate")
x = as.matrix(prostate[,2:8])
y = as.numeric(prostate$lpsa)
# default interface
fit = mfp2(x, y, verbose = FALSE)
fracplot(fit) # generate plots

</code></pre>


</div>