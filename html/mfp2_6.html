<div class="container">

<table style="width: 100%;"><tr>
<td>calculate_f_test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function to compute F-statistic and p-value from deviances</h2>

<h3>Description</h3>

<p>Alternative to likelihood ratio tests in normal / Gaussian error models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calculate_f_test(deviances, dfs_resid, n_obs, d1 = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>deviances</code></td>
<td>
<p>a numeric vector of length 2 with deviances. Typically
ordered in increasing order (i.e. null model first, then full model) and
used to test the difference <code>deviances[1] - deviances[2]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dfs_resid</code></td>
<td>
<p>a numeric vector with residual degrees of freedom.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_obs</code></td>
<td>
<p>a numeric value with the number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d1</code></td>
<td>
<p>a numeric value giving <code>d1</code> in the formula below directly as
the number of additional degrees of freedom in model 2 compared to model 1.
In this case <code>dfs_resid</code> must be a single numeric value giving the residual
df for model 2. This interface is sometimes more convenient than to specify
both residual dfs.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Uses formula on page 23 from here: https://www.stata.com/manuals/rfp.pdf:
</p>
<p style="text-align: center;"><code class="reqn">F = \frac{d_2}{d_1} (exp(\frac{D_2 - D_1}{n}) - 1),</code>
</p>

<p>where <code class="reqn">D</code> refers to deviances of two models 1 and 2.
<code class="reqn">d1</code> is the number of additional parameters used in in model 2 as
compared to model 1, i.e. <code>dfs_resid[1] - dfs_resid[2]</code>.
<code class="reqn">d2</code> is the number of residual degrees of freedom minus the number of
estimated powers for model 2, i.e. <code>dfs_resid[2]</code>.
#' The p-value then results from the use of a F-distribution with
(d1, d2) degrees of freedom.
</p>
<p>Note that this computation is completely equivalent to the computation
of a F-test using sum of squared errors as in e.g. Kutner at al. (2004),
p 263. The formula there is given as
</p>
<p style="text-align: center;"><code class="reqn">F = \frac{SSE(R) - SSE(F)}{df_R - df_F} / \frac{SSE(F)}{df_F},</code>
</p>

<p>where the <code class="reqn">df</code> terms refer to residual degrees of freedom, and <code class="reqn">R</code>
and <code class="reqn">F</code> to the reduced (model 1) and full model (model 2), respectively.
</p>


<h3>Value</h3>

<p>A list with three entries giving the test statistic and p-value for the F-test
for the comparison of <code>deviance[1]</code> to <code>deviance[2]</code>.
</p>

<ul>
<li> <p><code>statistic</code>: test statistic.
</p>
</li>
<li> <p><code>pvalue</code>: p-value.
</p>
</li>
<li> <p><code>dev_diff</code>: difference in deviances tested.
</p>
</li>
</ul>
<h3>References</h3>

<p>Kutner, M.H., et al., 2004. <em>Applied linear statistical models.
McGraw-Hill Irwin.</em>
</p>


</div>