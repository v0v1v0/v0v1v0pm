<div class="container">

<table style="width: 100%;"><tr>
<td>select_ra2_acd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function selection procedure for ACD based on closed testing procedure</h2>

<h3>Description</h3>

<p>Used in <code>find_best_fp_step()</code> when <code>criterion = "pvalue"</code> and an
ACD transformation is requested for <code>xi</code>.
For parameter explanations, see <code>find_best_fp_step()</code>. All parameters
captured by <code>...</code> are passed on to <code>fit_model()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">select_ra2_acd(
  x,
  xi,
  keep,
  degree,
  acdx,
  y,
  powers_current,
  powers,
  criterion,
  ftest,
  select,
  alpha,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an input matrix of dimensions nobs x nvars. Does not contain
intercept, but columns are already expanded into dummy variables as
necessary. Data are assumed to be shifted and scaled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xi</code></td>
<td>
<p>a character string indicating the name of the current variable
of interest, for which the best fractional polynomial transformation is
to be estimated in the current step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep</code></td>
<td>
<p>a character vector with names of variables to be kept
in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>
<p>integer &gt; 0 giving the degree for the FP transformation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acdx</code></td>
<td>
<p>a logical vector of length nvars indicating continuous variables
to undergo the approximate cumulative distribution (ACD) transformation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector for the response variable or a <code>Surv</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>powers_current</code></td>
<td>
<p>a list of length equal to the number of variables,
indicating the fp powers to be used in the current step for all variables
(except <code>xi</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>powers</code></td>
<td>
<p>a named list of numeric values that sets the permitted FP
powers for each covariate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>a character string defining the criterion used to select
variables and FP models of different degrees.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ftest</code></td>
<td>
<p>a logical indicating the use of the F-test for Gaussian models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>select</code></td>
<td>
<p>a numeric value indicating the significance level
for backward elimination of <code>xi</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>a numeric value indicating the significance level
for tests between FP models of different degrees for <code>xi</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>passed to fitting functions.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function extends the algorithm used in <code>select_ra2()</code> to allow the
usage of ACD transformations. The implementation follows the description
in Royston and Sauerbrei (2016). The procedure is outlined in detail in
the corresponding section in the documentation of <code>mfp2()</code>.
</p>
<p>When a variable is forced into the model by including it in <code>keep</code>, then
this function will not exclude it from the model (by setting its power to
<code>NA</code>), but will only choose its functional form.
</p>


<h3>Value</h3>

<p>A list with several components:
</p>

<ul>
<li> <p><code>keep</code>: logical indicating if <code>xi</code> is forced into model.
</p>
</li>
<li> <p><code>acd</code>: logical indicating if an ACD transformation was applied for <code>xi</code>,
i.e. <code>FALSE</code> in this case.
</p>
</li>
<li> <p><code>powers</code>: (best) fp powers investigated in step, indexing <code>metrics</code>.
Ordering: FP1(x, A(x)), null, linear, FP1(x, .), linear(., A(x)),
FP1(., A(x)).
</p>
</li>
<li> <p><code>power_best</code>: a numeric vector with the best power found. The returned
best power may be <code>NA</code>, indicating the variable has been removed from the
model.
</p>
</li>
<li> <p><code>metrics</code>: a matrix with performance indices for all models investigated.
Same number of rows as, and indexed by, <code>powers</code>.
</p>
</li>
<li> <p><code>model_best</code>: row index of best model in <code>metrics</code>.
</p>
</li>
<li> <p><code>pvalue</code>: p-value for comparison of linear and null model.
</p>
</li>
<li> <p><code>statistic</code>: test statistic used, depends on <code>ftest</code>.
</p>
</li>
</ul>
<h3>References</h3>

<p>Royston, P. and Sauerbrei, W., 2016. <em>mfpa: Extension of mfp using the
ACD covariate transformation for enhanced parametric multivariable modeling.
The Stata Journal, 16(1), pp.72-87.</em>
</p>


<h3>See Also</h3>

<p><code>select_ra2()</code>
</p>


</div>