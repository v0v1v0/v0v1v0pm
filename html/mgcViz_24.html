<div class="container">

<table style="width: 100%;"><tr>
<td>l_dens2D</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Adding density estimate heatmap</h2>

<h3>Description</h3>

<p>This layer adds a 2D density estimate heat-map to a plot.
For 1D effect plots, it adds either the conditional density of the partial
residuals, <code>p(r|x)</code>, or the joint density <code>p(r, x)</code>. For 2D
effect plots it adds either <code>p(x1|x2)</code> or <code>p(x1, x2)</code>, where
<code>x1</code> and <code>x2</code> are the relevant covariates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">l_dens2D(type, n = c(50, 50), bw = NULL, tol = 1e-06, trans = sqrt, ...)

l_dens(type, n = c(50, 50), bw = NULL, tol = 1e-06, trans = sqrt, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>for 1D effect plots, if set to "cond" then the conditional residual
density <code>p(r|x)</code> is plotted. If set to "joint" the
joint density of residuals, <code>p(r, x)</code>, is plotted.
The behaviour is similar for 2D effect plots, but <code>r</code> indicates
the second covariate, not the residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>vector of two positive integers, indicating the number of grid points
at which the density is evaluated on the x and y axes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p>vector with two positive entries, indicating the bandwidth to be used
by the kernel density estimator of <code>p(x1, x2)</code> along x1 and x2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>small positive numerical tolerance. The estimated density at a certain
location is set to <code>NA</code> (hence it will appear white) when it falls
below <code>tol/sqrt(2*pi*sig)</code>, where <code>sig</code> is the standard
deviation of the residuals. Set <code>tol</code> to -1 plot the density on
the whole x-y plane, no matter how low it is.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trans</code></td>
<td>
<p>the density on x-y is transformed using this function before being plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>graphical arguments to be passed to <code>ggplot2::geom_raster</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The density function is estimated using the fast binned kernel density estimation
methods provided by the <code>KernSmooth</code> package, hence this function should be
able to handle relatively large datasets (~ 10^6 observations).
</p>


<h3>Value</h3>

<p>An object of class <code>gamLayer</code>.
</p>


<h3>See Also</h3>

<p>See plot.mgcv.smooth.1D, plot.mgcv.smooth.2D and check1D for examples.
</p>


</div>