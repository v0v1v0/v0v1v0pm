<div class="container">

<table style="width: 100%;"><tr>
<td>l_fitDens</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Adding density strip of fitted effect</h2>

<h3>Description</h3>

<p>This layer adds a conditional posterior density strip to 1D smooth effects plots.
With the default colour scale, the opacity is proportional to the conditional density of the fitted
effects, under the usual Gaussian approximation the posterior.
</p>


<h3>Usage</h3>

<pre><code class="language-R">l_fitDens(n = 50, level = 0.95, trans = identity, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>sqrt of the number of grid points used to compute the effect plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>confidence level. By default the conditional density of the fit will be plotted
between the Gaussian quantiles 0.025 and 0.975, hence the <code>level</code> determines the
width of the y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trans</code></td>
<td>
<p>monotonic function to be applied to the density of the fit, which determines colour of
the plot. Monotonicity is not checked.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to <code>ggplot2::geom_raster</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See Bowman (2018) for explanations about the advantages of density strips, relative
to plots including the mean fit + confidence intervals.
</p>


<h3>Value</h3>

<p>An object of class gamLayer.
</p>


<h3>References</h3>

<p>Bowman, D. W (2018). Graphics for uncertainty. Journal of the Royal Statistical Society: Series A.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(mgcViz)
set.seed(44)
dat &lt;- gamSim(1,n=400,dist="normal",scale=2)
b &lt;- gamV(y~s(x0)+x1+s(x2)+s(x3),data=dat)

plot(sm(b, 1)) + l_fitDens() + l_fitLine()
plot(pterm(b, 1)) + l_fitDens(trans = function(x) x^0.25) + l_fitLine()
               
</code></pre>


</div>