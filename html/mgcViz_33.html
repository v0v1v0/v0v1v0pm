<div class="container">

<table style="width: 100%;"><tr>
<td>l_gridCheck1D</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Binning and checking GAM residuals</h2>

<h3>Description</h3>

<p>This layer bins the residuals, r, according to the value of the corresponding
covariate, x. Then the residuals in each bin are summarized using a
scalar-valued statistic. Confidence intervals for the statistic corresponding
to each bin can be obtained by simulating residuals from the fitted GAM
model, binning and summarizing them. Mainly useful in conjuction with check1D.
</p>


<h3>Usage</h3>

<pre><code class="language-R">l_gridCheck1D(
  gridFun = NULL,
  n = 20,
  level = 0.8,
  stand = "none",
  showReps = TRUE,
  showObs = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>gridFun</code></td>
<td>
<p>scalar-valued function used to summarize the residuals in each bin.
It takes a vector as input. By default it is
<code>mean(r)*sqrt(length(r))</code>, where <code>r</code> is the vector of
residuals in that bin.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of grid intervals along the relevant covariate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>the level of the confidence intervals (e.g. 0.9 means 90% intervals).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stand</code></td>
<td>
<p>if "none" the residuals in each bin are transformed by <code>gridFun</code> and
the result statistics are plotted directly. If "sc" the statistics
in each bin are scaled and centered using the mean and standard
deviation of the simulated stats in that bin.
If "s" we do only scaling, if "c" only centering.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showReps</code></td>
<td>
<p>if <code>TRUE</code> the individuals simulated statistics are also plotted using small points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showObs</code></td>
<td>
<p>if <code>TRUE</code> the observed statistics are plotted using large points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>graphical arguments to be passed to <code>ggplot2::geom_point</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>gamLayer</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(mgcViz);
set.seed(4124)
n &lt;- 1e4
x &lt;- rnorm(n); y &lt;- rnorm(n);

# Residuals are heteroscedastic w.r.t. x
ob &lt;- (x)^2 + (y)^2 + (0.2*abs(x) + 1)  * rnorm(n)
b &lt;- bam(ob ~ s(x,k=30) + s(y, k=30), discrete = TRUE)
b &lt;- getViz(b, nsim = 50)

# Don't see much by looking at mean
check1D(b, "x") + l_gridCheck1D()

# Heteroscedasticity clearly visible here
check1D(b, "x") + l_gridCheck1D(gridFun = sd, stand = "sc") # &lt;- we are scaling and centering
# Last point on the right of the rug seems to indicate that a bin is missing.
# It is not an error, only on observation falls in that bin, hence the
# standard deviation is not defined there.

</code></pre>


</div>