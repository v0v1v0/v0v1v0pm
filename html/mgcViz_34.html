<div class="container">

<table style="width: 100%;"><tr>
<td>l_gridCheck2D</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Binning and checking GAM residuals</h2>

<h3>Description</h3>

<p>This layer bins the residuals, r, according to the value of the corresponding
covariates, x1 and x2. Then the residuals in each bin are summarized using a
scalar-valued statistic. Confidence intervals for the statistic corresponding
to each bin can be obtained by simulating residuals from the fitted GAM
model, which are then binned and summarized. Mainly useful in conjuction with check2D.
</p>


<h3>Usage</h3>

<pre><code class="language-R">l_gridCheck2D(gridFun = mean, bw = c(NA, NA), stand = TRUE, binFun = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>gridFun</code></td>
<td>
<p>scalar-valued function used to summarize the residuals in each bin.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p>numeric vector giving bin width in the vertical and horizontal directions. See the <code>binwidth</code>
arguments in <code>?ggplot2::stat_summary_hex</code>. If left to <code>NA</code>, it will be set to 1/20
of the ranges of x1 and x2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stand</code></td>
<td>
<p>if left to <code>TRUE</code> then the observed statistic in the i-th cell is normalized using
the simulated statistics in that same cell. That is, we will actually plot
<code>std_stat = (obs_stat-mean(sim_stat))/sd(sim_stat)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binFun</code></td>
<td>
<p>the <code>ggplot2</code> function used to perform the binning. By default it
is either ggplot2::stat_summary_2d or ggplot2::stat_summary_hex, depending
on the class of the covariates x1 and x2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>graphical arguments to be passed to <code>ggplot2::stat_summary_hex</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>gamLayer</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(mgcViz);
set.seed(4124)
n &lt;- 1e4
x &lt;- rnorm(n); y &lt;- rnorm(n);

# Residuals are heteroscedastic w.r.t. x
ob &lt;- (x)^2 + (y)^2 + (1*abs(x) + 1)  * rnorm(n)
b &lt;- bam(ob ~ s(x,k=30) + s(y, k=30), discrete = TRUE)
b &lt;- getViz(b, nsim = 50)

# Don't see much by looking at mean
check2D(b, "x", "y") + l_gridCheck2D(gridFun = mean, bw = c(0.4, 0.4))

# Variance pattern along x-axis clearer now
check2D(b, "x", "y") + l_gridCheck2D(gridFun = sd, bw = c(0.4, 0.4))
 
</code></pre>


</div>