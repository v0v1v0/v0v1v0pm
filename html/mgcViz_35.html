<div class="container">

<table style="width: 100%;"><tr>
<td>l_gridQCheck1D</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Checking sign of residuals along one covariate</h2>

<h3>Description</h3>

<p>This layer is mainly useful when checking quantile GAMs fitted using the <code>qgam</code>
package. The residuals, r, are binned according to the corresponding value of a
covariate, x. Then the proportions of negative residuals within each bin are calculated, and
compared with the theoretical value, <code>qu</code>. Confidence intervals for the proportion
of negative residuals can be derived using binomial quantiles (under an independence
assumption). To be used in conjuction with check1D.
</p>


<h3>Usage</h3>

<pre><code class="language-R">l_gridQCheck1D(qu = NULL, n = 20, level = 0.8, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>qu</code></td>
<td>
<p>the quantile of interest. Should be in (0, 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of grid intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>the level of the confidence intervals plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>graphical arguments to be passed to <code>ggplot2::geom_point</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>gamLayer</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Simulate some data
library(mgcViz)
set.seed(3841)
dat &lt;- gamSim(1,n=400,dist="normal",scale=2)
dat$fac &lt;- as.factor( sample(letters[1:8], nrow(dat), replace = TRUE) ) 
fit &lt;- qgam(y~s(x1)+s(x2)+s(x3)+fac, data=dat, err = 0.05, qu = 0.4)
fit &lt;- getViz(fit)

# "x0" effect is missing, but should be there. l_gridQCheck1D shows
# that fraction of negative residuals is quite different from the theoretical 0.4
# in several places along "x0".
check1D(fit, dat$x0) + l_gridQCheck1D(qu = 0.4, n = 20)
# The problem gets better if s(x0) is added to the model.

# Works also with factor variables
check1D(fit, "fac") + l_gridQCheck1D(qu = 0.4)
</code></pre>


</div>