<div class="container">

<table style="width: 100%;"><tr>
<td>plot.fs.interaction.1D</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plotting one dimensional smooth factor interactions</h2>

<h3>Description</h3>

<p>This method should be used to plot smooth effects
of class <code>"fs.interaction.1D"</code>, that is smooth constructed
using the basis <code>bs="tp"</code>. See mgcv::s.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'fs.interaction.1D'
plot(x, n = 100, xlim = NULL, trans = identity, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a smooth effect object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of grid points used to compute main effect and c.i. lines.
For a nice smooth plot this needs to be several times the estimated degrees of
freedom for the smooth.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>if supplied then this pair of numbers are used as the x limits for the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trans</code></td>
<td>
<p>monotonic function to apply to the smooth and residuals, before plotting.
Monotonicity is not checked.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>currently unused.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>c("plotSmooth", "gg")</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(mgcViz)
set.seed(0)
## simulate data...
f0 &lt;- function(x) 2 * sin(pi * x)
f1 &lt;- function(x, a = 2, b = -1) exp(a * x) + b
f2 &lt;- function(x) 0.2 * x^11 * (10 * (1 - x))^6 + 10 *
  (10 * x)^3 * (1 - x)^10
n &lt;- 500; nf &lt;- 25
fac &lt;- sample(1:nf, n, replace = TRUE)
x0 &lt;- runif(n); x1 &lt;- runif(n); x2 &lt;- runif(n)
a &lt;- rnorm(nf) * .2 + 2; b &lt;- rnorm(nf) * .5
f &lt;- f0(x0) + f1(x1, a[fac], b[fac]) + f2(x2)
fac &lt;- factor(fac)
y &lt;- f + rnorm(n) * 2
## so response depends on global smooths of x0 and
## x2, and a smooth of x1 for each level of fac.

## fit model (note p-values not available when fit
## using gamm)...
bm &lt;- gamm(y ~ s(x0)+ s(x1, fac, bs = "fs", k = 5) + s(x2, k = 20))
v &lt;- getViz(bm$gam)

# Plot with fitted effects and changing title 
plot(sm(v, 2)) + l_fitLine(alpha = 0.6) + labs(title = "Smooth factor interactions")

# Changing plotting limits
plot(sm(v, 2)) + l_fitLine() + ylim(-0.5, 0.5) + xlim(0.25, 0.75)

# Change line type and remove legend
plot(sm(v, 2)) + l_fitLine(size = 1.3, linetype="dotted") + 
                 theme(legend.position="none")
                 
# Clustering smooth effects in 3 groups
plot(sm(v, 2)) + l_fitLine(colour = "grey") + 
                 l_clusterLine(centers = 3, a.clu = list(nstart = 100))
</code></pre>


</div>