<div class="container">

<table style="width: 100%;"><tr>
<td>check0D</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Checking GAM simulated residuals or responses</h2>

<h3>Description</h3>

<p>This function extracts the residuals or responses of a fitted GAM model, then it compares
their distribution with that of model-based simulations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">check0D(
  o,
  type = "auto",
  maxpo = 10000,
  na.rm = TRUE,
  trans = NULL,
  useSim = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>o</code></td>
<td>
<p>an object of class <code>gamViz</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>the type of residuals to be used. See residuals.gamViz.
If <code>"type == y"</code> then the raw observations will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxpo</code></td>
<td>
<p>maximum number of residuals points that will be used by layers such as
<code>l_rug()</code>. If number of datapoints &gt; <code>maxpo</code>, then a subsample of <code>maxpo</code> points
will be taken.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>if <code>TRUE</code> missing cases in <code>x</code> or <code>y</code> will be dropped out.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trans</code></td>
<td>
<p>function used to transform the observed and simulated residuals or responses.
It must take a vector of as input, and it must either a vector of the same length or a scalar.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useSim</code></td>
<td>
<p>if <code>FALSE</code> then the simulated responses contained in object <code>o</code> will not be used
by this function or by any of the layers that can be used with its output.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>c("plotSmooth", "gg")</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># The variance of the response distribution changes along x2 
library(mgcViz)
n  &lt;- 400
x1 &lt;- runif(n, -1, 1)
x2 &lt;- runif(n, -1, 1)
dat &lt;- data.frame("x1" = x1, "x2" = x2,
                  "y" = sin(3*x1) + 0.5 * x2^2 + pmax(x2, 0.2) * rnorm(n))

# Fit model with constant variance and perform posterior simulations (post = TRUE) 
# which take into account smoothing parameter uncertainty (unconditional = TRUE)
b &lt;- gamV(y ~ s(x1)+s(x2), data = dat, 
          aViz = list(nsim = 50, post = TRUE, unconditional = TRUE))

# Histogram of simulated vs observed residuals: the latter are fat tailed
check0D(b) + l_hist() + l_rug()

# Histogram of simulated 4th central moment (~ kurtosis) of simulated residuals.
# The vertical line is the 4th moment of the observed residuals
check0D(b, trans = function(.y) mean((.y - mean(.y))^4)) + l_dens1D() + l_vline() + l_rug()
# Residuals look very fat tails, but the real problem here is the heteroscedasticity 
# which can be diagnosted using check1D(b, "x2") + l_gridCheck1D(sd)
</code></pre>


</div>