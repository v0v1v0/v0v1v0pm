<div class="container">

<table style="width: 100%;"><tr>
<td>plot.mgcv.smooth.MD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plotting slice of higher-dimensional smooth effects</h2>

<h3>Description</h3>

<p>This function plots a 2D slice of a higher-dimensional smooth effects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'mgcv.smooth.MD'
plot(
  x,
  fix,
  n = 40,
  xlim = NULL,
  ylim = NULL,
  maxpo = 10000,
  too.far = c(0.1, NA),
  trans = identity,
  seWithMean = FALSE,
  unconditional = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a smooth effect object, extracted using sm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix</code></td>
<td>
<p>a named vector indicating which variables must be kept fixed and to what values.
When plotting a smooth in (d+2) dimensions, then d variables must be fixed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>sqrt of the number of grid points used to compute the effect plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>if supplied then this pair of numbers are used as the x limits for the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>if supplied then this pair of numbers are used as the y limits for the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxpo</code></td>
<td>
<p>maximum number of residuals points that will be used by layers such as
<code>resRug()</code> and <code>resPoints()</code>. If number of datapoints &gt; <code>maxpo</code>,
then a subsample of <code>maxpo</code> points will be taken.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>too.far</code></td>
<td>
<p>a numeric vector with two entries. The first has the same interpretation
as in plot.mgcv.smooth.2D and it avoids plotting the smooth effect
in areas that are too far form any observation. The distance will be calculated only
using the variables which are not in <code>fix</code> (see above). Hence in two dimensions,
not in the full d+2 dimensions. Set it to -1 to plot the whole
smooth. The second entry determines which residuals and covariates pairs are closed
enough to the selected slice. If left to <code>NA</code> on the 10\
closest (in terms of scaled Euclidean distance) to the current slice will be plotted.
Set it to -1 to plot all the residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trans</code></td>
<td>
<p>monotonic function to apply to the smooth and residuals, before plotting.
Monotonicity is not checked.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seWithMean</code></td>
<td>
<p>if TRUE the component smooths are shown with confidence intervals that
include the uncertainty about the overall mean. If FALSE then the uncertainty
relates purely to the centred smooth itself. Marra and Wood (2012) suggests
that TRUE results in better coverage performance, and this is also suggested
by simulation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unconditional</code></td>
<td>
<p>if <code>TRUE</code> then the smoothing parameter uncertainty corrected covariance
matrix is used to compute uncertainty bands, if available.
Otherwise the bands treat the smoothing parameters as fixed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>currently unused.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An objects of class <code>plotSmooth</code>.
</p>


<h3>References</h3>

<p>Marra, G and S.N. Wood (2012) Coverage Properties of Confidence Intervals for
Generalized Additive Model Components. Scandinavian Journal of Statistics.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## 3D example
library(mgcViz)
n &lt;- 1e3
x &lt;- rnorm(n); y &lt;- rnorm(n); z &lt;- rnorm(n)

ob &lt;- (x-z)^2 + (y-z)^2 + rnorm(n)
b &lt;- gam(ob ~ s(x, y, z))
b &lt;- getViz(b)

# Plot one 2D slice
plot( sm(b, 1), fix = c("z"=0) ) + l_fitRaster(noiseup = TRUE, mul = 3) + 
  l_fitContour(linetype = 2) + l_points(shape =  2)

## 4D
n &lt;- 5e3
x &lt;- rnorm(n); y &lt;- rnorm(n); z &lt;- rnorm(n); z2 &lt;- rnorm(n)

ob &lt;- (x-z)^2 + (y-z)^2 + z2^3 + rnorm(n)
b1 &lt;- bam(ob ~ s(x, y, z, z2), discrete = TRUE)
b1 &lt;- getViz(b1)

# Plot one 2D slice
plot(sm(b1, 1), fix = c("z"=0, "z2"=1)) + l_fitRaster() + l_fitContour()

## End(Not run)

</code></pre>


</div>