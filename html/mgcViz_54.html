<div class="container">

<table style="width: 100%;"><tr>
<td>plot.mgcv.smooth.1D</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plotting one dimensional smooth effects</h2>

<h3>Description</h3>

<p>Plotting method for one dimensional smooth effects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'mgcv.smooth.1D'
plot(
  x,
  n = 100,
  xlim = NULL,
  maxpo = 10000,
  trans = identity,
  unconditional = FALSE,
  seWithMean = FALSE,
  nsim = 0,
  ...
)

## S3 method for class 'multi.mgcv.smooth.1D'
plot(
  x,
  n = 100,
  xlim = NULL,
  maxpo = 10000,
  trans = identity,
  unconditional = FALSE,
  seWithMean = FALSE,
  asFact = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a smooth effect object, extracted using sm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of grid points used to compute main effect and c.i. lines.
For a nice smooth plot this needs to be several times the estimated degrees of
freedom for the smooth.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>if supplied then this pair of numbers are used as the x limits for the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxpo</code></td>
<td>
<p>maximum number of residuals points that will be used by layers such as
<code>resRug()</code> and <code>resPoints()</code>. If number of datapoints &gt; <code>maxpo</code>,
then a subsample of <code>maxpo</code> points will be taken.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trans</code></td>
<td>
<p>monotonic function to apply to the smooth and residuals, before plotting.
Monotonicity is not checked.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unconditional</code></td>
<td>
<p>if <code>TRUE</code> then the smoothing parameter uncertainty corrected covariance
matrix is used to compute uncertainty bands, if available.
Otherwise the bands treat the smoothing parameters as fixed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seWithMean</code></td>
<td>
<p>if TRUE the component smooths are shown with confidence intervals that
include the uncertainty about the overall mean. If FALSE then the uncertainty
relates purely to the centred smooth itself. Marra and Wood (2012) suggests
that TRUE results in better coverage performance, and this is also suggested
by simulation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>number of smooth effect curves to be simulated from the posterior distribution.
These can be plotted using the l_simLine layer. See Examples section below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>currently unused.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asFact</code></td>
<td>
<p>determines whether to use a factor or colour bar legend for plot.multi.mgcv.smooth.1D.
For most models the default is <code>TRUE</code>. When working with QGAM models fitted with
mqgamV, the default is <code>FALSE</code> for less than 10 quantiles,
<code>TRUE</code> otherwise. For QGAM models there a third option, <code>asFact = "force"</code>,
which forces the use of a discrete colour scale.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An objects of class <code>plotSmooth</code>.
</p>


<h3>References</h3>

<p>Marra, G and S.N. Wood (2012) Coverage Properties of Confidence Intervals for
Generalized Additive Model Components. Scandinavian Journal of Statistics.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(mgcViz)
n  &lt;- 1e3
x1 &lt;- rnorm(n)
x2 &lt;- rnorm(n)
dat &lt;- data.frame("x1" = x1, "x2" = x2,
                  "y" = sin(x1) + 0.5 * x2^2 + pmax(x2, 0.2) * rnorm(n))
b &lt;- bamV(y ~ s(x1)+s(x2), data = dat, method = "fREML", aGam = list(discrete = TRUE))

o &lt;- plot(sm(b, 1), nsim = 50) # 50 posterior simulations 

## Not run: 
# Plot with fitted effect + posterior simulations + rug on x axis
( o &lt;- o + l_simLine() + l_fitLine(colour = "red") + 
       l_rug(alpha = 0.8) )

# Add CI lines at 1*sigma and 5*sigma
( o &lt;- o + l_ciLine(mul = 1) + l_ciLine(mul = 5, colour = "blue", linetype = 2) )

# Add partial residuals and change theme
( o + l_points(shape = 19, size = 1, alpha = 0.2) + theme_classic() )

# Get second effect plot
o2 &lt;- plot( sm(b, 2) )

# Plot it with polygon for partial residuals
o2 + l_ciPoly(mul = 5, fill = "light blue") + 
  l_fitLine(linetype = 2, colour = "red")

# Plot is with conditional density of partial residuals
o2 + l_dens(type = "cond", alpha = 0.9)  + 
  l_fitLine(linetype = 2, colour = "red")
  
########
# Quantile GAM example
########
# Fit model
b &lt;- mqgamV(y ~ s(x1) + s(x2), qu = c(0.2, 0.5, 0.8), data = dat)

plot(sm(b, 1)) + l_fitLine(linetype = 2) + l_rug(colour = "blue")

## End(Not run)

</code></pre>


</div>