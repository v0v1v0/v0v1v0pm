<div class="container">

<table style="width: 100%;"><tr>
<td>check1D</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Checking GAM residuals or responses along one covariate</h2>

<h3>Description</h3>

<p>This function extracts the residuals of a fitted GAM model, and orders
them according to the value of a single covariate. Then several visual residuals diagnostics
can be plotted by adding layers.
</p>


<h3>Usage</h3>

<pre><code class="language-R">check1D(
  o,
  x,
  type = "auto",
  maxpo = 10000,
  na.rm = TRUE,
  trans = NULL,
  useSim = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>o</code></td>
<td>
<p>an object of class <code>gamViz</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>it can be either a) a single character, b) a numeric vector or c) a list of characters.
In case a) it should be the name of one of the variables in the dataframe used to fit <code>o</code>.
In case b) its length should be equal to the length of <code>o$y</code>.
In case c) it should be a list of names variables in the dataframe used to fit <code>o</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>the type of residuals to be used. See residuals.gamViz.
If <code>"type == y"</code> then the raw observations will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxpo</code></td>
<td>
<p>maximum number of residuals points that will be used by layers such as
<code>l_rug()</code>. If number of datapoints &gt; <code>maxpo</code>,
then a subsample of <code>maxpo</code> points will be taken.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>if <code>TRUE</code> missing cases in <code>x</code> or <code>y</code> will be dropped out.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trans</code></td>
<td>
<p>function used to transform the observed and simulated residuals or responses. It must take a vector of
as input, and must return a vector of the same length.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useSim</code></td>
<td>
<p>if <code>FALSE</code> then the simulated responses contained in object <code>o</code> will not be used
by this function or by any of the layers that can be used with its output.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function will return an object of class <code>c("plotSmooth", "gg")</code>, unless argument <code>x</code> is a
list. In that case the function will return an object of class <code>c("plotGam", "gg")</code> containing
a checking plot for each variable.
</p>


<h3>Examples</h3>

<pre><code class="language-R">### Example 1: diagnosing heteroscedasticity
library(mgcViz);
set.seed(4124)
n &lt;- 1e4
x &lt;- rnorm(n); y &lt;- rnorm(n);

# Residuals are heteroscedastic w.r.t. x
ob &lt;- (x)^2 + (y)^2 + (0.2*abs(x) + 1)  * rnorm(n)
b &lt;- bam(ob ~ s(x,k=30) + s(y, k=30), discrete = TRUE)
b &lt;- getViz(b)

# Look at residuals along "x"
ck &lt;- check1D(b, "x", type = "tnormal")

# Can't see that much
ck + l_dens(type = "cond", alpha = 0.8) + l_points() + l_rug(alpha = 0.2)

# Some evidence of heteroscedasticity
ck + l_densCheck()

# Compare observed residuals std dev with that of simulated data,
# heteroscedasticity is clearly visible
b &lt;- getViz(b, nsim = 50)
check1D(b, "x") + l_gridCheck1D(gridFun = sd, showReps = TRUE)

# This also works with factor or logical data
fac &lt;- sample(letters, n, replace = TRUE)
logi &lt;- sample(c(TRUE, FALSE), n, replace = TRUE)
b &lt;- bam(ob ~ s(x,k=30) + s(y, k=30) + fac + logi, discrete = TRUE)
b &lt;- getViz(b, nsim = 50)

# Look along "fac"
ck &lt;- check1D(b, "fac") 
ck + l_points() + l_rug() 
ck + l_gridCheck1D(gridFun = sd)

# Look along "logi"
ck &lt;- check1D(b, "logi") 
ck + l_points() + l_rug() 
ck + l_gridCheck1D(gridFun = sd)

</code></pre>


</div>