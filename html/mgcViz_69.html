<div class="container">

<table style="width: 100%;"><tr>
<td>plotDiff.mgcv.smooth.1D</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plotting differences between two 1D smooth effects</h2>

<h3>Description</h3>

<p>This method can be used to plot the difference between two 1D
smooth effects. Mainly meant to be used with by-factor smooths.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'mgcv.smooth.1D'
plotDiff(s1, s2, n = 100, trans = identity, unconditional = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>s1</code></td>
<td>
<p>a smooth effect object, extracted using sm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s2</code></td>
<td>
<p>another smooth effect object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of grid points used to compute main effects and c.i. lines.
For a nice smooth plot this needs to be several times the estimated degrees of
freedom for the smooth.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trans</code></td>
<td>
<p>monotonic function to apply to the smooth and residuals, before plotting.
Monotonicity is not checked.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unconditional</code></td>
<td>
<p>if <code>TRUE</code> then the smoothing parameter uncertainty corrected covariance
matrix is used to compute uncertainty bands, if available.
Otherwise the bands treat the smoothing parameters as fixed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>currently unused.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Let sd be the difference between the fitted smooths, that is: sd = s1 - s2.
sd is a vector of length n, and its covariance matrix is
Cov(sd) = X1\
where: X1 (X2) and Sig11 (Sig22) are the design matrix and the covariance matrix
of the coefficients of s1 (s2), while Sig12 is the cross-covariance matrix between
the coefficients of s1 and s2. To get the confidence intervals we need only diag(Cov(sd)),
which here is calculated efficiently (without computing the whole of Cov(sd)).
</p>


<h3>Value</h3>

<p>An objects of class <code>plotSmooth</code>.
</p>


<h3>References</h3>

<p>Marra, G and S.N. Wood (2012) Coverage Properties of Confidence Intervals for
Generalized Additive Model Components. Scandinavian Journal of Statistics.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Simulate data and add factors uncorrelated to the response
library(mgcViz)
set.seed(6898)
dat &lt;- gamSim(1,n=1500,dist="normal",scale=20)
dat$fac &lt;- as.factor( sample(c("A1", "A2", "A3"), nrow(dat), replace = TRUE) ) 
dat$logi &lt;- as.logical( sample(c(TRUE, FALSE), nrow(dat), replace = TRUE) ) 
bs &lt;- "cr"; k &lt;- 12
b &lt;- gam(y ~ s(x2,bs=bs,by = fac), data=dat)
o &lt;- getViz(b, nsim = 0)

# Extract the smooths correspoding to "A1" and "A2" and plot their differences
# with credible intervals
plotDiff(s1 = sm(o, 1), s2 = sm(o, 2)) + l_ciPoly() + 
  l_fitLine() + geom_hline(yintercept = 0, linetype = 2)
  
</code></pre>


</div>