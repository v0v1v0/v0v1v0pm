<div class="container">

<table style="width: 100%;"><tr>
<td>plotRGL.mgcv.smooth.2D</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Visualizing 2D smooth effects in 3D</h2>

<h3>Description</h3>

<p>This method plots an interactive 3D representation of a 2D smooth effect, using
the rgl package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'mgcv.smooth.2D'
plotRGL(
  x,
  se = TRUE,
  n = 40,
  residuals = FALSE,
  type = "auto",
  maxpo = 1000,
  too.far = 0,
  xlab = NULL,
  ylab = NULL,
  main = NULL,
  xlim = NULL,
  ylim = NULL,
  se.mult = 1,
  trans = identity,
  seWithMean = FALSE,
  unconditional = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a smooth effect object, extracted using sm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>when TRUE (default) upper and lower surfaces are added to the plot at <code>se.mult</code>
(see below) standard deviations for the fitted surface.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>sqrt of the number of grid points used to compute the effect plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>if TRUE, then the partial residuals will be added.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>the type of residuals that should be plotted. See residuals.gamViz.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxpo</code></td>
<td>
<p>maximum number of residuals points that will be plotted.
If number of datapoints &gt; <code>maxpo</code>, then a subsample of <code>maxpo</code> points will be taken.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>too.far</code></td>
<td>
<p>if greater than 0 then this is used to determine when a location is too far
from data to be plotted. This is useful since smooths tend to go wild
away from data. The data are scaled into the unit square before deciding
what to exclude, and too.far is a distance within the unit square.
Setting to zero can make plotting faster for large datasets, but care
is then needed when interpreting the plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>if supplied then this will be used as the x label of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>if supplied then this will be used as the y label of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>used as title for the plot if supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>if supplied then this pair of numbers are used as the x limits for the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>if supplied then this pair of numbers are used as the y limits for the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.mult</code></td>
<td>
<p>a positive number which will be the multiplier of the standard errors
when calculating standard error surfaces.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trans</code></td>
<td>
<p>monotonic function to apply to the smooth and residuals, before plotting.
Monotonicity is not checked.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seWithMean</code></td>
<td>
<p>if TRUE the component smooths are shown with confidence intervals that
include the uncertainty about the overall mean. If FALSE then the uncertainty
relates purely to the centred smooth itself. Marra and Wood (2012) suggests
that TRUE results in better coverage performance, and this is also suggested
by simulation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unconditional</code></td>
<td>
<p>if <code>TRUE</code> then the smoothing parameter uncertainty corrected covariance
matrix is used to compute uncertainty bands, if available.
Otherwise the bands treat the smoothing parameters as fixed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>currently unused.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns <code>NULL</code> invisibly.
</p>


<h3>References</h3>

<p>Marra, G and S.N. Wood (2012) Coverage Properties of Confidence Intervals for
Generalized Additive Model Components. Scandinavian Journal of Statistics.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Example 1: taken from ?mgcv::te, shows how tensor pruduct deals nicely with 
# badly scaled covariates (range of x 5% of range of z )
library(mgcViz)

# Simulate some data
test1 &lt;- function(x,z,sx=0.3,sz=0.4) { 
  x &lt;- x*20
  (pi**sx*sz)*(1.2*exp(-(x-0.2)^2/sx^2-(z-0.3)^2/sz^2)+
                 0.8*exp(-(x-0.7)^2/sx^2-(z-0.8)^2/sz^2))
}
n &lt;- 500
old.par &lt;- par(mfrow=c(2,2))
x &lt;- runif(n)/20;z &lt;- runif(n);
xs &lt;- seq(0,1,length=30)/20;zs &lt;- seq(0,1,length=30)
pr &lt;- data.frame(x=rep(xs,30),z=rep(zs,rep(30,30)))
truth &lt;- matrix(test1(pr$x,pr$z),30,30)
f &lt;- test1(x,z)
y &lt;- f + rnorm(n)*0.2

# Fit with t.p.r.s. basis and plot
b1 &lt;- gam(y~s(x,z))
plotRGL(sm(getViz(b1), 1))

# Need to load rgl at this point
## Not run: 
library(rgl)
rgl.close() # Close

# Fit with tensor products basis and plot (with residuals)
b2 &lt;- gam(y~te(x,z))
plotRGL(sm(getViz(b2), 1), residuals = TRUE)

# We can still work on the plot, for instance change the aspect ratio
aspect3d(1, 2, 1)

rgl.close() # Close

## End(Not run)
</code></pre>


</div>