<div class="container">

<table style="width: 100%;"><tr>
<td>postSim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Posterior simulation from a GAM object</h2>

<h3>Description</h3>

<p>This method can be used to simulate vectors of responses from the
Gaussian posterior approximation of a gamObject.
</p>


<h3>Usage</h3>

<pre><code class="language-R">postSim(
  o,
  nsim,
  newdata,
  trans = NULL,
  method = "auto",
  w = NULL,
  offset = NULL,
  savePar = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>o</code></td>
<td>
<p>the output of a <code>gam()</code> or <code>bam()</code> call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>the number of simulated vectors of responses. A positive integer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>Optional new data frame used to perform the simulations. To be passed to predict.gam.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trans</code></td>
<td>
<p>function used to transform or summarize each vector of simulated responses.
It must take a vector as argument, but it can output a vector or a scalar.
Potentially useful for saving storage (e.g. by transforming each simulated vector
to a scalar). If left to <code>NULL</code> then <code>trans = identity</code> will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the method used for the simulation of responses. See simulate.gam.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>vector of prior weights of each response. See simulate.gam.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>numeric vector of offsets. For GAMs with multiple linear predictor (see eg gaulss) it
must be a list of vectors. If <code>newdata!=NULL</code> the offsets will be assumed to be zero,
unless their are explicitly provided. If <code>newdata==NULL</code> the simulations will use the
offsets used during model fitting, unless offset is explicitly provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>savePar</code></td>
<td>
<p>if <code>TRUE</code> than also the simulated parameters will be returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments to be passed to vcov.gam.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If <code>savePar == FALSE</code> the function will return a matrix where each column is a vector of
simulated responses or a transformed version of it. If <code>savePar == TRUE</code> it will return
a list where the <code>$simY</code> entry will contain the simulated responses and <code>$simBeta</code>
the simulated parameters.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(mgcViz)
library(MASS)
b &lt;- gam(accel~s(times, k=20), data=mcycle)

# Simulate list of 10 vectors of responses from posterior, taking into
# account smoothing parameters uncertainty (see ?vcov.gam)
n &lt;- 10
sim &lt;- postSim(o = b, nsim = n, unconditional = TRUE)

# Posterior simulations in grey and data in red
plot(rep(mcycle$times, n), as.vector(sim), col = "grey", 
     ylab = "Acceleration", xlab = "Times")
points(mcycle$times, mcycle$accel, col = 2)

# There is clear disagreement between simulations' and data's 
# conditional variance, which can be solved using flexible GAMLSS model:
b &lt;- gam(list(accel~s(times, k=20), ~s(times)), data=mcycle, family = gaulss)
sim &lt;- postSim(o = b, nsim = n)
plot(rep(mcycle$times, n), as.vector(sim), col = "grey", 
     ylab = "Acceleration", xlab = "Times")
points(mcycle$times, mcycle$accel, col = 2)

</code></pre>


</div>