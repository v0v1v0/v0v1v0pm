<div class="container">

<table style="width: 100%;"><tr>
<td>pterm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extracting parametric effects from a GAM model</h2>

<h3>Description</h3>

<p>This function can be used to extract a parametric effect from an object of
class <code>gamViz</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pterm(o, select)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>o</code></td>
<td>
<p>an object of class <code>gamViz</code>, the output of a <code>getViz()</code> call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>select</code></td>
<td>
<p>index of the selected parametric effect.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class "pTermSomething" where "Something" is substituted with
the class of the variable of interest. For instance if this "numeric", the <code>pterm</code>
will return an object of class "ptermNumeric".
</p>


<h3>Examples</h3>

<pre><code class="language-R">####### 1. Gaussian GAM 
library(mgcViz)
set.seed(3)
dat &lt;- gamSim(1,n=1500,dist="normal",scale=20)
dat$fac &lt;- as.factor( sample(c("A1", "A2", "A3"), nrow(dat), replace = TRUE) ) 
dat$logi &lt;- as.logical( sample(c(TRUE, FALSE), nrow(dat), replace = TRUE) ) 
bs &lt;- "cr"; k &lt;- 12
b &lt;- gam(y ~ x0 + x1 + I(x1^2) + s(x2,bs=bs,k=k) + fac + x3:fac + I(x1*x2) + logi,data=dat)
o &lt;- getViz(b)

# Plot effect of 'x0'
pt &lt;- pterm(o, 1)
plot(pt, n = 60) + l_ciPoly() + l_fitLine() + l_ciLine() + l_points()

# Plot effect of 'x3'
pt &lt;- pterm(o, 1)
plot(pt, n = 60) + l_fitLine() + l_ciLine(colour = 2)

# Plot effect of 'fac'
pt &lt;- pterm(o, 4)
plot(pt) + l_ciBar(colour = "blue") + l_fitPoints(colour = "red") + 
           l_rug(alpha = 0.3)

# Plot effect of 'logi'
pt &lt;- pterm(o, 6)
plot(pt) + l_fitBar(a.aes = list(fill = I("light blue"))) + l_ciBar(colour = "blue")

# Plot effect of 'x3:fac': no method available yet available for second order terms
pt &lt;- pterm(o, 7)
plot(pt)

## Not run: 
####### 1. Continued: Quantile GAMs
b &lt;- mqgamV(y ~ x0 + x1 + I(x1^2) + s(x2,bs=bs,k=k) + x3:fac + 
              I(x1*x2) + logi, data=dat, qu = c(0.3, 0.5, 0.8))

plot(pterm(b, 3)) + l_ciBar(colour = 2) + l_fitPoints()

plot(pterm(b, 4)) + l_fitBar(colour = "blue", fill = 3) + l_ciBar(colour = 2) 

# Don't know how to plot this interaction
plot(pterm(b, 6))
 
####### 2. Gaussian GAMLSS model
library(MASS)
mcycle$fac &lt;- as.factor( sample(c("z", "k", "a", "f"), nrow(mcycle), replace = TRUE) ) 
b &lt;- gam(list(accel~times + I(times^2) + s(times,k=10), ~ times + fac + s(times)),
          data=mcycle,family=gaulss(), optimizer = "efs")
o &lt;- getViz(b)

# Plot effect of 'I(times^2)' on mean: notice that partial residuals
# are unavailable for GAMLSS models, hence l_point does not do anything here.
pt &lt;- pterm(o, 2)
plot(pt) + l_ciPoly() + l_fitLine() + l_ciLine() + l_points()

# Plot effect of 'times' in second linear predictor.
# Notice that partial residuals are unavailable.
pt &lt;- pterm(o, 3)
plot(pt) + l_ciPoly() + l_fitLine() + l_ciLine(linetype = 3) + l_rug()

# Plot effect of 'fac' in second linear predictor.
pt &lt;- pterm(o, 4)
plot(pt) + l_ciBar(colour = "blue") + l_fitPoints(colour = "red") + 
           l_rug() 

## End(Not run)

</code></pre>


</div>