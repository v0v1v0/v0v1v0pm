<div class="container">

<table style="width: 100%;"><tr>
<td>simulate.gam</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulating responses from a GAM object</h2>

<h3>Description</h3>

<p>This method can be used to simulate vectors of responses from a gamObject.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'gam'
simulate(
  object,
  nsim = 1,
  seed = NULL,
  method = "auto",
  newdata,
  u = NULL,
  w = NULL,
  offset = NULL,
  trans = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>the output of a <code>gam()</code> or <code>bam()</code> call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>the number of simulated vectors of responses. A positive integer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>currently not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the method used for the simulation. If set to "rd" then <code>o$family$rd()</code>
will be used, if available. If set to "qf" then <code>o$family$qf()</code> (which is
the inverse cdf of the response distribution) will be used to transform some
uniform variates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>Optional new data frame or list to be passed to predict.gam.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>a matrix where each row is a vector of uniform random variables in (0, 1).
This will be used to simulate responses only if <code>method = "qf"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>vector of prior weights to be used in the simulations. If <code>newdata==NULL</code> then
<code>w</code> is set to <code>object$prior.weights</code> otherwise it is a vector of ones.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>numeric vector of offsets. For GAMs with multiple linear predictor (see eg gaulss) it
must be a list of vectors. NB: if <code>newdata!=NULL</code> the offsets will be assumed to be zero,
unless their are explicitly provided. If <code>newdata==NULL</code> then simulations will use the
offsets used during model fitting, and <code>offset</code> argument will be ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trans</code></td>
<td>
<p>function used to transform or summarize each vector of simulated responses.
It must take a vector as argument, but it can output a vector or a scalar.
Potentially useful for saving storage (e.g. by transforming each simulated vector
to a scalar). If left to <code>NULL</code> then <code>trans = identity</code> will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>extra arguments passed to <code>predict.gam</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A matrix where each column is a vector of simulated responses. The number of rows
is equal to the number of responses in the fitted object.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(mgcViz)

set.seed(2) ## simulate some data... 
dat &lt;- gamSim(1,n=400,dist="normal",scale=2)
b &lt;- gam(y~s(x0)+s(x1)+s(x2)+s(x3),data=dat)

# Simulate three vectors of responses
matplot(simulate(b, nsim = 3), pch = 19, col = c(1, 3, 4)) 

</code></pre>


</div>