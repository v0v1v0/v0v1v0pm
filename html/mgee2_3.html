<div class="container">

<table style="width: 100%;"><tr>
<td>mgee2v</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>mgee2v</h2>

<h3>Description</h3>

<p>Corrected GEE2 for ordinal data, with validation subsample
</p>


<h3>Usage</h3>

<pre><code class="language-R">mgee2v(
  formula,
  id,
  data,
  corstr = "exchangeable",
  misvariable = "W",
  valid.sample.ind = "delta",
  y.mcformula,
  x.mcformula,
  maxit = 50,
  tol = 0.001
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula object which specifies the relationship between 
the response and covariates for the observed data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>a character object which records individual id in the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a dataframe or matrix object for the observed data set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corstr</code></td>
<td>
<p>a character object. The default value is "exchangeable", 
corresponding to the structure where the association between two paired 
responses is considered to be a constant. The other option is "log-linear" 
which  indicates the log-linear association between two paired responses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>misvariable</code></td>
<td>
<p>a character object which names the error-prone covariate W.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>valid.sample.ind</code></td>
<td>
<p>a string object which names the indicator variable delta. 
When a data point belongs to the validation set, delta = 1; otherwise 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.mcformula</code></td>
<td>
<p>a string object which indicates the misclassification formula
between true response Y and surrogate(observed) response S.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.mcformula</code></td>
<td>
<p>a string object which indicates the  misclassification formula
between true error-prone covariate X and surrogate W.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>an integer which specifies the maximum number of iterations. The default is 50.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>a numeric object which indicates the tolerance threshold. The default is 1e-3.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <em>mgee2v</em> does not require the misclassification parameters to be known, 
but require the availability  of validation data.
Similar to <em>mgee2k</em>, the function <em>mgee2v</em> needs the data set to be structured by individual id, i=1,...,n, and visit time, j_i=1,...,m_i. 
The data set should contain the observed response and covariates S and W. 
To indicate whether or not a subject is in the validation set, an indicator variable 
<em>delta</em> should be added in the data set, and we use a column named <em>valid.sample.ind</em> for this purpose. 
The column name of the error-prone covariate W should also be specified in <em>misvariable</em>.
</p>


<h3>Value</h3>

<p>A list with component
</p>
<table>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>the coefficients in the order of 1) all non-baseline levels for response,
2) covariates - same order as specified in the formula</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>the coefficients for paired responses global odds ratios. Number of alpha
coefficients corresponds to the paired responses odds ratio structure selected in "corstr";
when corstr="exchangeable", only one baseline alpha is fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variance</code></td>
<td>
<p>variance-covariance matrix of all fitted parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>a logical variable, TRUE if the model converges</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iteration</code></td>
<td>
<p>number of iterations for the model to converge</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>Function called</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Z. Chen, G. Y. Yi, and C. Wu. Marginal analysis of longitudinal ordinal data with misclassification inboth response and covariates. <em>Biometrical Journal</em>, 56(1):69-85, Oct. 2014
</p>
<p>Xu, Yuliang, Shuo Shuo Liu, and Y. Yi Grace. 2021. “mgee2: An R Package for Marginal Analysis of Longitudinal Ordinal Data with Misclassified Responses and Covariates.” <em>The R Journal</em> 13 (2): 419.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  if(0){
  data(obs1)
  obs1$Y &lt;- as.factor(obs1$Y)
  obs1$X &lt;- as.factor(obs1$X)
  obs1$visit &lt;- as.factor(obs1$visit)
  obs1$treatment &lt;- as.factor(obs1$treatment)
  obs1$S &lt;- as.factor(obs1$S)
  obs1$W &lt;- as.factor(obs1$W)
  mgee2v.fit = mgee2v(formula = S~W+treatment+visit, id = "ID", data = obs1,
                      y.mcformula = "S~1", x.mcformula = "W~1", misvariable = "W",
                      valid.sample.ind = "delta",
                      corstr = "exchangeable")
  }
</code></pre>


</div>