<div class="container">

<table style="width: 100%;"><tr>
<td>FactorGraph</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Draws a factor graph of a (time-varying) MGM
</h2>

<h3>Description</h3>

<p>Wrapper function around qgraph() that draws factor graphs for (time-varying) MGMs
</p>


<h3>Usage</h3>

<pre><code class="language-R">FactorGraph(object, labels, PairwiseAsEdge = FALSE, 
            Nodewise = FALSE, DoNotPlot = FALSE, 
            FactorLabels = TRUE, colors, shapes,
            shapeSizes = c(8, 4), estpoint = NULL, 
            negDashed = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>The output object of <code>mgm()</code> or <code>tvmgm()</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>

<p>A character vector of (variable) node labels.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PairwiseAsEdge</code></td>
<td>

<p>If <code>TRUE</code>, pairwise interactions are not displayed as factors but as simple edges between nodes. Defaults to <code>PairwiseAsEdge = FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nodewise</code></td>
<td>

<p>If <code>TRUE</code>, the estimates from the individual nodewise regressions are displayed as a directed edge towards the node on which the respective nodewise regression was performed. This is useful to identify model misspecification (e.g. moderation effects / interaction parameters with largely different values across nodewise regressions). Defaults to <code>Nodewise = FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DoNotPlot</code></td>
<td>

<p>If <code>DoNotPlot = TRUE</code> no factorgraph is plotted. This way the computed factor graph can be obtained without plotting. Defaults to <code>DoNotPlot = FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FactorLabels</code></td>
<td>

<p>If <code>FactorLabels = TRUE</code> the factors are labeled by their order. If <code>FactorLabels = FALSE</code> no label is shown. Defaults to <code>FactorLabels = TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colors</code></td>
<td>

<p>A character vector of colors for nodes and factors. The first color is for variable-nodes, the second for 2-way interactions, the third for 3-way interactions, etc. Defaults to <code>colors = c("white", "tomato", "lightblue", "orange")</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shapes</code></td>
<td>

<p>A character vector of shapes for for nodes and factors. The first shape is for variable-nodes, the second for 2-way interactions, the third for 3-way interactions, etc. Defaults to <code>shapes = c("circle", "square", "triangle", "diamond")</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shapeSizes</code></td>
<td>

<p>A numeric vector of length two indicating the size of shapes for nodes and factors. Defaults to <code>shapeSizes = c(8, 4)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estpoint</code></td>
<td>

<p>An integer indicating the estimation point to display if the output object of a time-varying MGM is provided. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>negDashed</code></td>
<td>

<p>If <code>negDashed = TRUE</code>, edges with negative sign are dashed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Arguments passed to qgraph.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>FactorGraph()</code> is a wrapper around <code>qgraph()</code> from the qgraph package. Therefore all arguments of <code>qgraph()</code> are available and can be provided as additional arguments.
</p>
<p>To make time-varying factor graphs comparable across estimation points, the factor graph of each estimation point includes all factors that are estimated nonzero at least at one estimation point.
</p>


<h3>Value</h3>

<p>Plots the factor graph and returns a list including the arguments used to plot the factor graph using qgraph().
</p>
<p>Specifically, a list is returned including:  <code>graph</code> contains a weighted adjacency matrix of a (bipartide) factor graph. If p is the number of variables and E the number of interactions (factors) in the model, this matrix has dimensions (p+E) x (p+E). The factor graph is furter specified by the following objects: <code>signs</code> is a matrix of the same dimensions as <code>graph</code> that indicates the sign of each interaction, if defined (see <code>pairwise</code> above). <code>edgecolor</code> is a matrix with the same dimension as <code>graph</code> that provides edge colors depending on the sign as above. <code>order</code> is a (p+E) vector indicating the order of interaction. The first p entries are set to zero. <code>qgraph</code> contains the qgraph object created while plotting.
</p>


<h3>Author(s)</h3>

<p>Jonas Haslbeck &lt;jonashaslbeck@gmail.com&gt;
</p>


<h3>See Also</h3>

<p><code>mgm()</code>, <code>tvmgm()</code>, <code>qgraph()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

## Not run: 

# Fit MGM with pairwise &amp; threeway interactions to Autism Dataset
fit_k3 &lt;- mgm(data = autism_data$data,
              type = autism_data$type,
              level = autism_data$lev,
              k = 3, 
              overparameterize = TRUE,
              lambdaSel = "EBIC", 
              lambdaGam = .5) 

# List of estimated interactions
fit_k3$interactions$indicator

FactorGraph(object = fit_k3, 
            PairwiseAsEdge = FALSE, 
            DoNotPlot = FALSE, 
            labels = 1:7, 
            layout="circle")

# For more examples see https://github.com/jmbh/mgmDocumentation

## End(Not run)

</code></pre>


</div>