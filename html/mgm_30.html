<div class="container">

<table style="width: 100%;"><tr>
<td>mvarsampler</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Sampling from a mixed VAR model
</h2>

<h3>Description</h3>

<p>Function to sample from a mixed VAR (mVAR) model
</p>


<h3>Usage</h3>

<pre><code class="language-R">mvarsampler(coefarray, lags, thresholds, 
            sds, type, level, N, pbar)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>coefarray</code></td>
<td>

<p>A p x p x max(level) x max(level) x n_lags array, where p are the number of variables, level is the input argument <code>level</code> and n_lags is the number of specified lags in <code>lags</code>, so n_lags = length(n_lags). The first four dimensions specify the parameters involved in the cross-lagged effects of the lag specified in the 5th dimension. I.e. coefarray[5, 6, 1, 1, 3] indicates the cross-lagged effect of variable 6 on variable 5 (if both are continuous), for the third lag specified in <code>lags</code>. If variable 1 and 3 are categorical with m = 2 and  = 4 categories, respectively, then coefarray[1, 3, 1:2, 1:4, 1] indicates the m*s=8 parameters specifying this interaction for the first lag specified in <code>lags</code>. See the examples below for an illustration.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lags</code></td>
<td>

<p>A vector indicating the lags in the mVAR model. E.g. <code>lags = c(1, 4, 9)</code> specifies lags of order 1, 3, 9. The number of specified lags has to match the 5th dimension in <code>coefarray</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresholds</code></td>
<td>

<p>A list with p entries, each consisting of a vector indicating a threshold for each category of the given variable. For continuous variable, the vector has length 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sds</code></td>
<td>

<p>A vector of length p indicating the standard deviations of the included Gaussian nodes. If non-Gaussian variables are included in the mVAR model, the corresponding entries are ignored.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>p vector indicating the type of variable for each column in <code>data</code>. "g" for Gaussian, "p" for Poisson, "c" for categorical.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>

<p>p vector indicating the number of categories of each variable. For continuous variables set to 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>

<p>The number of samples to be drawn from the specified mVAR model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pbar</code></td>
<td>

<p>If <code>pbar = TRUE</code>, a progress bar is shown.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>We sample from the mVAR model by separately sampling from its corresponding p conditional distributions.
</p>


<h3>Value</h3>

<p>A list with two entries:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The function call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The sampled n x p data matrix</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jonas Haslbeck &lt;jonashaslbeck@gmail.com&gt;
</p>


<h3>References</h3>

<p>Haslbeck, J. M. B., &amp; Waldorp, L. J. (2020). mgm: Estimating time-varying Mixed Graphical Models in high-dimensional Data. Journal of Statistical Software, 93(8), pp. 1-46. DOI: 10.18637/jss.v093.i08
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 


## Generate data from mixed VAR model using mvarsampler() and recover model using mvar()

# 1) Define mVAR model

p &lt;- 6 # Six variables
type &lt;- c("c", "c", "c", "c", "g", "g") # 4 categorical, 2 gaussians
level &lt;- c(2, 2, 4, 4, 1, 1) # 2 categoricals with m=2, 2 categoricals with m=4, two continuous
max_level &lt;- max(level)

lags &lt;- c(1, 3, 9) # include lagged effects of order 1, 3, 9
n_lags &lt;- length(lags)

# Specify thresholds
thresholds &lt;- list()
thresholds[[1]] &lt;- rep(0, level[1])
thresholds[[2]] &lt;- rep(0, level[2])
thresholds[[3]] &lt;- rep(0, level[3])
thresholds[[4]] &lt;- rep(0, level[4])
thresholds[[5]] &lt;- rep(0, level[5])
thresholds[[6]] &lt;- rep(0, level[6])

# Specify standard deviations for the Gaussians
sds &lt;- rep(NULL, p)
sds[5:6] &lt;- 1

# Create coefficient array
coefarray &lt;- array(0, dim=c(p, p, max_level, max_level, n_lags))

# a.1) interaction between continuous 5&lt;-6, lag=3
coefarray[5, 6, 1, 1, 2] &lt;- .4
# a.2) interaction between 1&lt;-3, lag=1
m1 &lt;- matrix(0, nrow=level[2], ncol=level[4])
m1[1,1:2] &lt;- 1
m1[2,3:4] &lt;- 1
coefarray[1, 3, 1:level[2], 1:level[4], 1] &lt;- m1
# a.3) interaction between 1&lt;-5, lag=9
coefarray[1, 5, 1:level[1], 1:level[5], 3] &lt;- c(0, 1)


# 2) Sample
set.seed(1)
dlist &lt;- mvarsampler(coefarray = coefarray,
                     lags = lags,
                     thresholds = thresholds,
                     sds = sds,
                     type = type,
                     level = level,
                     N = 200,
                     pbar = TRUE)

# 3) Recover
set.seed(1)
mvar_obj &lt;- mvar(data = dlist$data,
                 type = type,
                 level = level,
                 lambdaSel = "CV",
                 lags = c(1, 3, 9),
                 signInfo = FALSE,
                 overparameterize = F)

# Did we recover the true parameters?
mvar_obj$wadj[5, 6, 2] # cross-lagged effect of 6 on 5 over lag lags[2]
mvar_obj$wadj[1, 3, 1] # cross-lagged effect of 3 on 1 over lag lags[1]
mvar_obj$wadj[1, 5, 3] # cross-lagged effect of 1 on 5 over lag lags[3]


# For more examples see https://github.com/jmbh/mgmDocumentation



## End(Not run)

</code></pre>


</div>