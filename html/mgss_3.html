<div class="container">

<table style="width: 100%;"><tr>
<td>estimate_trace</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Trace estimation of the hat matrix.</h2>

<h3>Description</h3>

<p>Estimates the trace of the (unknown) hat-matrix by stochastic estimation in a matrix-free manner.
</p>


<h3>Usage</h3>

<pre><code class="language-R">estimate_trace(m, q, lambda, X, pen_type = "curve", l = NULL, n_random = 5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>Vector of non-negative integers. Each entry gives the number of inner knots for the respective covariate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>Vector of positive integers. Each entry gives the spline degree for the respective covariate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Positive number as weight for the penalty term.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Matrix containing the covariates as columns and the units as rows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pen_type</code></td>
<td>
<p>Utilized penalization method. Either <code>"curve"</code> for the curvature penalty or <code>"diff"</code> for the difference penalty. Defaults to <code>"curve"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l</code></td>
<td>
<p>Positive integer vector of length <code>P</code> indicating for the penalty degree. Only required if <code>pen_type = "diff"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_random</code></td>
<td>
<p>Positive integer for the number of random vectors in the trace estimate. Defaults to <code>5</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An estimate of the trace of the hat-matrix.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data &lt;- generate_test_data(100, 2)
X &lt;- data$X_train
estimate_trace(m = c(7,7), q = c(2,2), lambda = 0.1, X = X)

</code></pre>


</div>