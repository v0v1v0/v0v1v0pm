<div class="container">

<table style="width: 100%;"><tr>
<td>MGCG_smooth</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>High-dimensional spline smoothing using a matrix-free multigrid preconditioned CG-method.</h2>

<h3>Description</h3>

<p>Fits a smooth spline to a set of given observations using penalized splines with curvature penalty and multiple covariates. The underlying linear system is solved with a matrix-free preconditioned conjugated gradient method using a geometric multigrid method as preconditioner.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MGCG_smooth(
  G,
  q,
  lambda,
  X,
  y,
  w = 0.1,
  nu = c(3, 1),
  alpha_start = NULL,
  K_max = NULL,
  tolerance = 1e-06,
  print_error = TRUE,
  coarse_grid_solver = "Cholesky"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>Positive integer greater than one for the maximum number of grids.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>Vector of positive integers. Each entry gives the spline degree for the respective covariate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Positive number as weight for the penalty term.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Matrix containing the covariates as columns and the units as rows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Vector of length <code>nrow(X)</code> as the variable of interest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>Damping factor of the Jacobi smoother. Defaults to <code>0.1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>Two-dimensional vector of non-negative integers. Gives the number of pre- and post-smoothing steps in the multigrid algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_start</code></td>
<td>
<p>Vector of length <code>prod(m+q+1)</code> as starting value for the MGCG-method. Defaults to zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K_max</code></td>
<td>
<p>Positive integer as upper bound for the number of MGCG-iterations. Defaults to <code>prod(m+q+1)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolerance</code></td>
<td>
<p>Positive number as error tolerance for the stopping criterion of the MGCG-method. Defaults to <code>1e-6</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print_error</code></td>
<td>
<p>Logical, indicating if the iteration error should be printed or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coarse_grid_solver</code></td>
<td>
<p>Utilized coarse grid solver. Either <code>"PCG"</code> for diagonal preconditioned CG or <code>"Cholesky"</code> for Cholesky decomposition. Defaults to <code>"Cholesky"</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list containing the input <code>m = 2^G-1</code>, <code>q</code>, and <code>Omega</code>. Further gives the fitted spline coefficients <code>alpha</code>, the fitted values <code>fitted_values</code>, the residuals <code>residuals</code>, the root mean squared error <code>rmse</code> and the R-squared value <code>R_squared</code>.
</p>


<h3>References</h3>

<p>Siebenborn, M. and Wagner, J. (2019) A Multigrid Preconditioner for Tensor Product Spline Smoothing. arXiv:1901.00654
</p>


<h3>Examples</h3>

<pre><code class="language-R">data &lt;- generate_test_data(100, 2)
X &lt;- data$X_train
y &lt;- data$y_train
MGCG_smooth(G = 3, q = c(3,3), lambda = 0.1, w = 0.8, X = X, y = y)

</code></pre>


</div>