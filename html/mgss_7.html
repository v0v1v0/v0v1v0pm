<div class="container">

<table style="width: 100%;"><tr>
<td>PCG_smooth</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>High-dimensional spline smoothing using a matrix-free PCG-method.</h2>

<h3>Description</h3>

<p>Fits a smooth spline to a set of given observations using penalized splines with curvature or difference penalty and multiple covariates. The underlying linear system is solved with a matrix-free preconditioned conjugated gradient (PCG) method using a diagonal preconditioner.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PCG_smooth(
  m,
  q,
  lambda,
  X,
  y,
  pen_type = "curve",
  l = NULL,
  alpha_start = NULL,
  K_max = NULL,
  tolerance = 1e-06,
  print_error = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>Vector of non-negative integers. Each entry gives the number of inner knots for the respective covariate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>Vector of positive integers. Each entry gives the spline degree for the respective covariate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Positive number as weight for the penalty term.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Matrix containing the covariates as columns and the units as rows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Vector of length <code>nrow(X)</code> as the variable of interest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pen_type</code></td>
<td>
<p>Utilized penalization method. Either <code>"curve"</code> for the curvature penalty or <code>"diff"</code> for the difference penalty. Defaults to <code>"curve"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l</code></td>
<td>
<p>Positive integer vector of length <code>P</code> indicating for the penalty degree. Only required if <code>pen_type = "diff"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_start</code></td>
<td>
<p>Vector of length <code>prod(m+q+1)</code> as starting value for the PCG-method. Defaults to zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K_max</code></td>
<td>
<p>Positive integer as upper bound for the number of PCG-iterations. Defaults to <code>prod(m+q+1)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolerance</code></td>
<td>
<p>Positive number as error tolerance for the stopping criterion of the PCG-method. Defaults to <code>1e-6</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print_error</code></td>
<td>
<p>Logical, indicating if the iteration error should be printed or not.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list containing the input <code>m</code>, <code>q</code>, and <code>Omega</code>. Further gives the fitted spline coefficients <code>alpha</code>, the fitted values <code>fitted_values</code>, the residuals <code>residuals</code>, the root mean squared error <code>rmse</code> and the R-squared value <code>R_squared</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data &lt;- generate_test_data(100, 2)
X &lt;- data$X_train
y &lt;- data$y_train
PCG_smooth(m = c(7,7), q = c(3,3), lambda = 0.1, X = X, y = y)

</code></pre>


</div>