<div class="container">

<table style="width: 100%;"><tr>
<td>mgwnbr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multiscale Geographically Weighted Negative Binomial Regression</h2>

<h3>Description</h3>

<p>Fits a geographically weighted regression model with different scales for each covariate. Uses the negative binomial distribution as default, but also accepts the normal, Poisson, or logistic distributions. Can fit the global versions of each regression and also the geographically weighted alternatives with only one scale, since they are all particular cases of the multiscale approach.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mgwnbr(
  data,
  formula,
  weight = NULL,
  lat,
  long,
  globalmin = TRUE,
  method,
  model = "negbin",
  mgwr = TRUE,
  bandwidth = "cv",
  offset = NULL,
  distancekm = FALSE,
  int = 50,
  h = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>name of the dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>regression model formula as in <code>lm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>name of the variable containing the sample weights, default value is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat</code></td>
<td>
<p>name of the variable containing the latitudes in the dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>long</code></td>
<td>
<p>name of the variable containing the longitudes in the dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>globalmin</code></td>
<td>
<p>logical value indicating whether to find a global minimum in the optimization process, default value is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>indicates the method to be used for the bandwidth calculation (<code>adaptive_bsq</code>, <code>fixed_bsq</code>, <code>fixed_g</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>indicates the model to be used for the regression (<code>gaussian</code>, <code>poisson</code>, <code>negbin</code>, <code>logistic</code>), default value is<code>"negbin"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mgwr</code></td>
<td>
<p>logical value indicating if multiscale should be used (<code>TRUE</code>, <code>FALSE</code>), default value is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandwidth</code></td>
<td>
<p>indicates the criterion to be used for the bandwidth calculation (<code>cv</code>, <code>aic</code>), default value is <code>"cv"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>name of the variable containing the offset values, if null then is set to a vector of zeros, default value is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distancekm</code></td>
<td>
<p>logical value indicating whether to calculate the distances in km, default value is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>int</code></td>
<td>
<p>integer indicating the number of iterations, default value is <code>50</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>integer indicating a predetermined bandwidth value, default value is <code>NULL</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list that contains:
</p>

<ul>
<li> <p><code>general_bandwidth</code> - General bandwidth value.
</p>
</li>
<li> <p><code>band</code> - Bandwidth values for each covariate.
</p>
</li>
<li> <p><code>measures</code> - Goodness of fit statistics.
</p>
</li>
<li> <p><code>ENP</code> - Effective number of parameters.
</p>
</li>
<li> <p><code>mgwr_param_estimates</code> - MGWR parameter estimates.
</p>
</li>
<li> <p><code>qntls_mgwr_param_estimates</code> - Quantiles of MGWR parameter estimates.
</p>
</li>
<li> <p><code>descript_stats_mgwr_param_estimates</code> - Descriptive statistics of MGWR parameter estimates.
</p>
</li>
<li> <p><code>p_values</code> - P-values for the t tests on parameter significance.
</p>
</li>
<li> <p><code>t_critical</code> - Critical values for the t tests on parameter significance.
</p>
</li>
<li> <p><code>mgwr_se</code> - MGWR standard errors.
</p>
</li>
<li> <p><code>qntls_mgwr_se</code> - Quantiles of MGWR standard errors.
</p>
</li>
<li> <p><code>descript_stats_se</code> - Descriptive statistics of MGWR standard errors.
</p>
</li>
<li> <p><code>global_param_estimates</code> - Parameter estimates for the global model.
</p>
</li>
<li> <p><code>t_test_dfs</code> - Denominator degrees of freedom for the t tests.
</p>
</li>
<li> <p><code>global_measures</code> - Goodness of fit statistics for the global model.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">## Data


data(georgia)

for (var in c("PctFB", "PctBlack")){
  georgia[, var] &lt;- as.data.frame(scale(georgia[, var]))
}


## Model

mod &lt;- mgwnbr(data=georgia, formula=PctBach~PctBlack+PctFB,
 lat="Y", long="X", globalmin=FALSE, method="adaptive_bsq", bandwidth="cv",
  model="gaussian", mgwr=FALSE, h=136)

## Bandwidths
mod$general_bandwidth

## Goodness of fit measures
mod$measures

</code></pre>


</div>