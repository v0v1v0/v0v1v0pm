<div class="container">

<table style="width: 100%;"><tr>
<td>predict_mgwrsar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>mgwrsar Model Predictions
predict_mgwrsar is a function for computing predictions of a mgwrsar models. It uses Best Linear Unbiased Predictor for mgwrsar models with spatial autocorrelation.</h2>

<h3>Description</h3>

<p>mgwrsar Model Predictions
predict_mgwrsar is a function for computing predictions of a mgwrsar models. It uses Best Linear Unbiased Predictor for mgwrsar models with spatial autocorrelation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">predict_mgwrsar(model, newdata, newdata_coords, W = NULL, type = "BPN",
h_w = 100,kernel_w = "rectangle",maxobs=4000,beta_proj=FALSE,
method_pred='TP', k_extra = 8)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a model of mgwrsar class.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>a matrix or data.frame of new data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata_coords</code></td>
<td>
<p>a matrix of new coordinates, and eventually other variables if a General Kernel Product is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>the spatial weight matrix for models with  spatial autocorrelation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type for BLUP estimator, default "BPN". If NULL use predictions without spatial bias correction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h_w</code></td>
<td>
<p>A bandwidth value for the spatial weight matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel_w</code></td>
<td>
<p>kernel type for the spatial weight matrix. Possible types:
rectangle ("rectangle"), bisquare ("bisq"), tricube ("tcub"),
epanechnikov ("epane"), gaussian ("gauss")) .</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxobs</code></td>
<td>
<p>maximum number of observations for exact calculation of solve(I- rho*W), default maxobs=4000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_proj</code></td>
<td>
<p>A boolean, if TRUE the function then return a two elements list(Y_predicted,Beta_proj_out)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method_pred</code></td>
<td>
<p>If method_pred = 'TP' (default) prediction is done by recomputing a MGWRSAR model
with new-data as target points, else if method_pred in ('tWtp_model','model','sheppard') a matrix
for projecting estimated betas is used (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k_extra</code></td>
<td>
<p>number of neighboors for local parameter extrapolation if sheppard kernel is used, default 8.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>if method_pred ='tWtp_model',  the weighting matrix for prediction is
based on the expected weights of outsample data if they were had been added to
insample data to estimate the corresponding MGWRSAR (see Geniaux 2022 for
further detail), if method_pred ='sheppard'a sheppard kernel with k_extra neighbours (default 8) is used and if method_pred='kernel_model' the same kernel
and number of neighbors as for computing the MGWRSAR model is used.
</p>


<h3>Value</h3>

<p>A vector of predictions if beta_proj is FALSE or a list with a vector named Y_predicted and a matrix named Beta_proj_out.
</p>


<h3>See Also</h3>

<p>MGWRSAR, bandwidths_mgwrsar, summary_mgwrsar, plot_mgwrsar, kernel_matW
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(mgwrsar)
 data(mydata)
 coords=as.matrix(mydata[,c("x","y")])
length_out=800
index_in=sample(1:1000,length_out)
index_out=(1:1000)[-index_in]

model_GWR_insample&lt;-MGWRSAR(formula = 'Y_gwr~X1+X2+X3', data = mydata[index_in,],
coords=coords[index_in,],fixed_vars=NULL,kernels=c ('gauss'),H=8, Model = 'GWR',
control=list(adaptive=TRUE))
summary_mgwrsar(model_GWR_insample)

newdata=mydata[index_out,]
newdata_coords=coords[index_out,]
newdata$Y_mgwrsar_1_0_kv=0

Y_pred=predict_mgwrsar(model_GWR_insample, newdata=newdata,
newdata_coords=newdata_coords)
head(Y_pred)
head(mydata$Y_gwr[index_out])
sqrt(mean((mydata$Y_gwr[index_out]-Y_pred)^2)) # RMSE

</code></pre>


</div>