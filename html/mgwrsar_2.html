<div class="container">

<table style="width: 100%;"><tr>
<td>find_TP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Search of a suitable set of target points.
find_TP is a wrapper function that identifies  a set of target points based on spatial smoothed OLS residuals.</h2>

<h3>Description</h3>

<p>Search of a suitable set of target points.
find_TP is a wrapper function that identifies  a set of target points based on spatial smoothed OLS residuals.
</p>


<h3>Usage</h3>

<pre><code class="language-R">find_TP(formula, data,coords,K,kWtp=16,Wtp=NULL,type='residuals',
model_residuals=NULL,verbose=0,prev_TP=NULL,nTP=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a dataframe or a spatial dataframe (SP package)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>a dataframe or a matrix with coordinates, not required if data is a spatial dataframe</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>the minimum number of first neighbors with lower (resp.higer) absolute value of the smoothed residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kWtp</code></td>
<td>
<p>the number of first neighbors for computing  the smoothed residuals, default 16.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Wtp</code></td>
<td>
<p>a precomputed matrix of weights, default NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>method for choosing TP, could be 'residuals', 'equidistantGrid','random',  default 'residuals'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model_residuals</code></td>
<td>
<p>(optional) a vector of residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>verbose mode, default FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prev_TP</code></td>
<td>
<p>index of already used TP (version length(K)&gt;1), default NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nTP</code></td>
<td>
<p>numbeer of target points for random choice of target points, default NULL.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>find_TP is a wrapper function that identifies a set of target points, based on spatial smoothed residuals by default.
If no vector of residuals are provided, OLS residuals are computed.
The function first computes the smooth of model residuals using a Sheppard's kernel with kWtp neighbors (default 16).
Then it identifies local maxima (resp. minima) that fits the requirement of having at least K neighbors with lower (resp.higer) absolute value of the smoothed residuals. As K increases the number of target points decreases.
</p>


<h3>Value</h3>

<p>find_TP returns an index vector of Target Points set.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
 library(mgwrsar)
 ## loading data example
 data(mydata)
 coords=as.matrix(mydata[,c("x","y")])
 TP=find_TP(formula = 'Y_gwr~X1+X2+X3', data =mydata,coords=coords,K=6,type='residuals')
 # only 60 targets points are used
 length(TP)

 model_GWR_tp&lt;-MGWRSAR(formula = 'Y_gwr~X1+X2+X3', data = mydata,coords=coords,
 fixed_vars=NULL,kernels=c('gauss'),  H=0.03, Model = 'GWR',
 control=list(SE=TRUE,TP=TP,kWtp=12))
 summary(model_GWR_tp$Betav)
 
</code></pre>


</div>