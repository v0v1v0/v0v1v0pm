<div class="container">

<table style="width: 100%;"><tr>
<td>multiscale_gwr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>multiscale_gwr
This function adapts the multiscale Geographically Weighted Regression (GWR) methodology
proposed by Fotheringam et al. in 2017, employing a backward fitting procedure within
the MGWRSAR subroutines. The consecutive bandwidth optimizations are performed by
minimizing the corrected Akaike criteria.</h2>

<h3>Description</h3>

<p>multiscale_gwr
This function adapts the multiscale Geographically Weighted Regression (GWR) methodology
proposed by Fotheringam et al. in 2017, employing a backward fitting procedure within
the MGWRSAR subroutines. The consecutive bandwidth optimizations are performed by
minimizing the corrected Akaike criteria.
</p>


<h3>Usage</h3>

<pre><code class="language-R">multiscale_gwr(formula,data,coords,Model = 'GWR',kernels='bisq',
control=list(SE=FALSE,adaptive=TRUE,NN=800,isgcv=FALSE),init='GWR',maxiter=100,
nstable=6,crit=0.000001,doMC=FALSE,ncore=1,HF=NULL,H0=NULL,model=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A dataframe.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>default NULL, a dataframe or a matrix with coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Model</code></td>
<td>
<p>The type of model: Possible values are "GWR" (default),
and "MGWRSAR_1_0_kv". See Details for more explanation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernels</code></td>
<td>
<p>A vector containing the kernel types. Possible types:
rectangle ("rectangle"), bisquare ("bisq"), tricube ("tcub"), epanechnikov ("epane"),
gaussian("gauss")).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of extra control arguments, see MGWRSAR help.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>starting model (lm or GWR)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>maximum number of iterations in the back-fitting procedure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nstable</code></td>
<td>
<p>required number of consecutive unchanged optimal bandwidth (by covariate)
before leaving optimisation of bandwidth size, default 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crit</code></td>
<td>
<p>value to terminate the back-fitting iterations (ratio of change in RMSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>doMC</code></td>
<td>
<p>A boolean for Parallel computation, default FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncore</code></td>
<td>
<p>number of CPU cores for parallel computation, default 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HF</code></td>
<td>
<p>if available, a vector containing the optimal bandwidth parameters for each
covariate, default NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H0</code></td>
<td>
<p>A bandwidth value for the starting GWR model, default NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>A previous model estimated using multiscale_gwr function, default NULL.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Return an object of class mgwrsar with at least the following components:
</p>

<dl>
<dt>Betav</dt>
<dd>
<p> matrix of coefficients of dim(n,kv) x kv.</p>
</dd>
<dt>Betac</dt>
<dd>
<p> vector of coefficients of length kc.</p>
</dd>
<dt>Model</dt>
<dd>
<p> The sum of square residuals.</p>
</dd>
<dt>Y</dt>
<dd>
<p> The dependent variable.</p>
</dd>
<dt>XC</dt>
<dd>
<p> The explanatory variables with constant coefficients.</p>
</dd>
<dt>XV</dt>
<dd>
<p> The explanatory variables with varying coefficients.</p>
</dd>
<dt>X</dt>
<dd>
<p> The explanatory variables.</p>
</dd>
<dt>W</dt>
<dd>
<p> The spatial weight matrix for spatial dependence.</p>
</dd>
<dt>isgcv</dt>
<dd>
<p> if gcv has been computed.</p>
</dd>
<dt>edf</dt>
<dd>
<p> The estimated degrees of freedom.</p>
</dd>
<dt>formula</dt>
<dd>
<p>The formula.</p>
</dd>
<dt>data</dt>
<dd>
<p> The dataframe used for computation.</p>
</dd>
<dt>Method</dt>
<dd>
<p> The type of model.</p>
</dd>
<dt>coords</dt>
<dd>
<p> The spatial coordinates of observations.</p>
</dd>
<dt>H</dt>
<dd>
<p> A vector of bandwidths.</p>
</dd>
<dt>fixed_vars</dt>
<dd>
<p> The names of constant coefficients.</p>
</dd>
<dt>kernels</dt>
<dd>
<p> The kernel vector.</p>
</dd>
<dt>SSR</dt>
<dd>
<p> The sum of square residuals.</p>
</dd>
<dt>residuals</dt>
<dd>
<p> The vector of residuals.</p>
</dd>
<dt>fit</dt>
<dd>
<p> the vector of fitted values.</p>
</dd>
<dt>sev</dt>
<dd>
<p> local standard error of parameters.</p>
</dd>
<dt>get_ts</dt>
<dd>
<p>Boolean, if trace of hat matrix Tr(S) should be stored.</p>
</dd>
<dt>NN</dt>
<dd>
<p> Maximum number of neighbors for weights computation</p>
</dd>
</dl>
<h3>See Also</h3>

<p>tds_mgwr, bandwidths_mgwrsar, summary_mgwrsar, plot_mgwrsar, predict_mgwrsar
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(mgwrsar)
mysimu&lt;-simu_multiscale(n=1000)
mydata=mysimu$mydata
coords=mysimu$coords
model_multiscale&lt;-multiscale_gwr(formula=as.formula('Y~X1+X2+X3'),data=mydata,
coords=coords,Model = 'GWR',kernels='bisq',control=list(SE=FALSE,
adaptive=TRUE,NN=900,isgcv=FALSE),init='GWR',nstable=6,crit=0.000001)
summary_mgwrsar(model_multiscale)

</code></pre>


</div>