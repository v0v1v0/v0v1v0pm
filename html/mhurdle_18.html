<div class="container">

<table style="width: 100%;"><tr>
<td>mhurdle</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimation of limited dependent variable models</h2>

<h3>Description</h3>

<p>mhurdle fits a large set of models relevant when the dependent variable is 0
for a part of the sample.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mhurdle(
  formula,
  data,
  subset,
  weights,
  na.action,
  start = NULL,
  dist = c("ln", "n", "bc", "ihs"),
  h2 = FALSE,
  scaled = TRUE,
  corr = FALSE,
  robust = TRUE,
  check_gradient = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a symbolic description of the model to be fitted,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a <code>data.frame</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>see <code>stats::lm()</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>see <code>stats::lm()</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>see <code>stats::lm()</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>starting values,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>the distribution of the error of the consumption
equation: one of <code>"n"</code> (normal), <code>"ln"</code> (log-normal) <code>"bc"</code>
(box-cox normal) and <code>"ihs"</code> (inverse hyperbolic sinus
transformation),</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h2</code></td>
<td>
<p>if <code>TRUE</code> the second hurdle is effective, it is not
otherwise,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaled</code></td>
<td>
<p>if <code>TRUE</code>, the dependent variable is divided by its
geometric mean,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corr</code></td>
<td>
<p>a boolean indicating whether the errors of the
different equations are correlated or not,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>
<p>transformation of the structural parameters in order
to avoid numerical problems,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check_gradient</code></td>
<td>
<p>if <code>TRUE</code>, a matrix containing the analytical and
the numerical gradient for the starting values are returned,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>mhurdle</code> fits models for which the dependent variable is zero for
a part of the sample. Null values of the dependent variable may
occurs because of one or several mechanisms : good rejection, lack
of ressources and purchase infrequency. The model is described
using a three-parts formula : the first part describes the
selection process if any, the second part the regression equation
and the third part the purchase infrequency process.  <code>y ~ 0 | x1 + x2 | z1 + z2</code> means that there is no selection process.  <code>y ~ w1 + w2 | x1 + x2 | 0</code> and <code>y ~ w1 + w2 | x1 + x2</code> describe the same
model with no purchase infrequency process. The second part is
mandatory, it explains the positive values of the dependant
variable. The <code>dist</code> argument indicates the distribution of the
error term. If <code>dist = "n"</code>, the error term is normal and (at least
part of) the zero observations are also explained by the second
part as the result of a corner solution. Several models described
in the litterature are obtained as special cases :
</p>
<p>A model with a formula like <code>y~0|x1+x2</code> and <code>dist="n"</code> is the Tobit
model proposed by (Tobin 1958).
</p>
<p><code>y~w1+w2|x1+x2</code> and <code>dist="l"</code> or <code>dist="t"</code> is the single hurdle
model proposed by (Cragg 1971). With <code>dist="n"</code>,
the double hurdle model also proposed by
(Cragg 1971) is obtained. With <code>corr="h1"</code> we get
the correlated version of this model described by
(Blundell and Meghir 1987).
</p>
<p><code>y~0|x1+x2|z1+z2</code> is the P-Tobit model of
(Deaton and Irish 1984), which can be a single hurdle
model if <code>dist="t"</code> or <code>dist="l"</code> or a double hurdle model if
<code>dist="n"</code>.
</p>


<h3>Value</h3>

<p>#' an object of class <code>c("mhurdle", "maxLik")</code>.
</p>
<p>A <code>mhurdle</code> object has the following elements :
</p>

<ul>
<li>
<p> coefficients: the vector of coefficients,
</p>
</li>
<li>
<p> vcov: the covariance matrix of the coefficients,
</p>
</li>
<li>
<p> fitted.values: a matrix of fitted.values, the first column being
the probability of 0 and the second one the mean values for the
positive observations,
</p>
</li>
<li>
<p> logLik: the log-likelihood,
</p>
</li>
<li>
<p> gradient: the gradient at convergence,
</p>
</li>
<li>
<p> model: a data.frame containing the variables used for the estimation,
</p>
</li>
<li>
<p> coef.names: a list containing the names of the coefficients in the
selection equation, the regression equation, the infrequency of purchase
equation and the other coefficients (the standard deviation of the error
term and the coefficient of correlation if <code>corr = TRUE</code>,
</p>
</li>
<li>
<p> formula: the model formula, an object of class <code>Formula</code>
</p>
</li>
<li>
<p> call: the call,
</p>
</li>
<li>
<p> rho: the lagrange multiplier test of no correlation.
</p>
</li>
</ul>
<h3>References</h3>

<p>Blundell R, Meghir C (1987).
“Bivariate Alternatives to the Tobit Model.”
<em>Journal of Econometrics</em>, <b>34</b>, 179-200.
</p>
<p>Cragg JG (1971).
“Some Statistical Models for Limited Dependent Variables with Applications for the Demand for Durable Goods.”
<em>Econometrica</em>, <b>39</b>(5), 829-44.
</p>
<p>Deaton AS, Irish M (1984).
“A Statistical Model for Zero Expenditures in Household Budgets.”
<em>Journal of Public Economics</em>, <b>23</b>, 59-80.
</p>
<p>Tobin J (1958).
“Estimation of Relationships for Limited Dependent Variables.”
<em>Econometrica</em>, <b>26</b>(1), 24-36.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data("Interview", package = "mhurdle")

# independent double hurdle model
idhm &lt;- mhurdle(vacations ~ car + size | linc + linc2 | 0, Interview,
              dist = "ln", h2 = TRUE, method = "bfgs")

# dependent double hurdle model
ddhm &lt;- mhurdle(vacations ~ car + size | linc + linc2  | 0, Interview,
              dist = "ln", h2 = TRUE, method = "bfgs", corr = TRUE)

# a double hurdle p-tobit model
ptm &lt;- mhurdle(vacations ~ 0 | linc + linc2 | car + size, Interview,
              dist = "ln", h2 = TRUE, method = "bfgs", corr = TRUE)
</code></pre>


</div>