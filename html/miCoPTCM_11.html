<div class="container">

<table style="width: 100%;"><tr>
<td>PTCMestimSIMEX</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
SIMEX approach
</h2>

<h3>Description</h3>

<p>Fits a Semiparametric Promotion Time Cure Model with mismeasured covariates, using the SIMEX algorithm based on a backfitting procedure. This approach is introduced in Bertrand et al. (2015).
</p>


<h3>Usage</h3>

<pre><code class="language-R">## Default S3 method:
PTCMestimSIMEX(x, y, errorDistEstim=c("normal","student","chiSquare","laplace"), 
paramDistEstim=NA, varCov=NA,  nBack=10000, eps=1e-8, Nu=c(0,.5,1,1.5,2), B=50, init, 
orderExtrap=2, multMaxTime=2,...)
## S3 method for class 'formula'
PTCMestimSIMEX(formula, data=list(),...)
## S3 method for class 'PTCMestimSIMEX'
print(x,...)
## S3 method for class 'PTCMestimSIMEX'
summary(object,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> a numerical matrix containing the explanatory variables as columns (without a column of 1s for the intercept).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p> the response, a survival object returned by the <code>Surv</code> function. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>errorDistEstim</code></td>
<td>
<p> the distribution of the measurement error. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>paramDistEstim</code></td>
<td>
<p> a scalar or a vector of length 2 containing the parameter(s) of the measurement error distribution, for non-Gaussian distributions. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varCov</code></td>
<td>
<p> the square variance-covariance matrix of measurement error, with as many rows as regression parameters (including the intercept), for Gaussian errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nBack</code></td>
<td>
<p> an integer specifying the maximal number of iterations in the backfitting procedure. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p> convergence criterion.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nu</code></td>
<td>
<p> a numerical vector containing the grid of lambda values, corresponding to the level of added noise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p> the number of replications for each value in <code>Nu</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>a numerical vector of initial values for the regression parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>orderExtrap</code></td>
<td>
<p> a scalar or a numerical vector containing the degrees of the polynomials used in the extrapolation step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>multMaxTime</code></td>
<td>
<p> a positive number controlling the time allowed, in one iteration of the backfitting procedure, to function <code>nleqslv</code> (used to solve the score equations) to converge.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula object, in which the response is a survival object returned by the <code>Surv</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a dataframe containing the variables appearing in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p> an object of class <code>"PTCMestimBF"</code>, i.e., a fitted model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> not used. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>More than one covariate can be subject to measurement error. However, in this implementation, all the errors must belong to the same family of distribution (specified with the argument <code>errorDistEstim</code>). Non-zero covariances are allowed between errors following a normal distribution. For the student, chi-squared and Laplace distributions, all variances are assumed to be equal (determined from <code>paramDistEstim</code>) and all covariances are assumed to be 0, even if the off-diagonal elements of <code>vcov</code> are not 0.
</p>
<p>When using the <code>laplace</code> distribution, only one element in <code>paramDistEstim</code> is needed (if a vector of two elements is given, only the first element will be considered). With the <code>student</code> and <code>chiSquare</code> distributions, two parameters are required, while none is required with the <code>normal</code> distribution. 
For the <code>laplace</code> distribution, the parameter is the inverse of the rate <code class="reqn">\gamma</code>, where <code class="reqn">\gamma</code> is such that <code class="reqn">f(x)=\frac{1}{2}\gamma e^{-\gamma |x|}</code>. The first parameter of the Student distribution corresponds to the degrees of freedom, while the second parameter is a multiplicative factor such that the variance is <code class="reqn">parameter_2^2*\frac{parameter_1}{parameter_1-2}</code>. Similarly, for the chi-squared distribution, the first parameter gives the degrees of freedom, and the second one is a multiplicative factor yielding a variance of <code class="reqn">2\cdot param_2^2 \cdot param_1</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>PTCMestimBF</code>, i.e. a list including the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients </code></td>
<td>
<p>The estimated values of the regression parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>The estimated variances of the estimated regression parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>classObs</code></td>
<td>
<p>An integer vector of length 3: the number of censored individuals not considered as cured for the estimation, the number of events, and the number of individuals considered as cured for the estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimNuBF</code></td>
<td>
<p>A matrix with as many rows as elements in <code>Nu</code>, containing, in each row, the average of the <code>B</code> estimates, for each regression parameter (columns).</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Bertrand A., Legrand C., Carroll R.J., De Meester C., Van Keilegom I. (2015) Inference in a Survival Cure Model with Mismeasured Covariates using a SIMEX Approach. Submitted.
</p>
<p>Cook J.R., Stefanski L.A. (1994) Simulation-Extrapolation Estimation in Parametric Measurement Error Models. Journal of the American Statistical Association, 89, 1314-1328. DOI: 10.2307/2290994
</p>
<p>Ma, Y., Yin, G. (2008) Cure rate models with mismeasured covariates under transformation. Journal of the American Statistical Association, 103, 743-756. DOI: 10.1198/016214508000000319
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library("survival")
## Data generation
set.seed(123)
n &lt;- 200
varCov &lt;- matrix(nrow=3,ncol=3,0)
varCov[2,2] &lt;- 0.1^1
X1 &lt;- (runif(n)-.5)/sqrt(1/12) 
V &lt;- round(X1 + rnorm(n,rep(0,3),varCov[2,2]),7)# covariate with measurement error
Xc &lt;- round(as.numeric(runif(n)&lt;0.5),7) # covariate without measurement error

 # censoring times: truncated exponential distribution
C &lt;- round(rexp(n,1/5),5) 
Cbin &lt;- (C&gt;30)
while(sum(Cbin)&gt;0)
{
	C[Cbin] &lt;- round(rexp(sum(Cbin),1/5),5)
	Cbin &lt;- (C&gt;30)
}

expb &lt;- exp(0.5+X1-0.5*Xc) 
cure &lt;- exp(-expb) # cure probabilities

 # event times with baseline cdf of a truncated exponential 
U &lt;- runif(n)
d &lt;- rep(NA,n)
T &lt;- round(-6*log( 1+ (1-exp(-20/6))*log(1-(1-cure)*U)/expb ),5) 
T[(runif(n)&lt;cure)] &lt;- 99999 # cured subjects

Tobs &lt;- rep(NA,n)
Tobs &lt;- pmin(C,T) # observed times
Tmax &lt;- max(Tobs[Tobs==T])
d &lt;- (Tobs==T) # censoring indicator
	
Dat &lt;- data.frame(Tobs,d,V,Xc)

## Model estimation
fm &lt;- formula(Surv(Tobs,d) ~ V + Xc)
resSimex &lt;- PTCMestimSIMEX(fm, Dat, errorDistEstim="normal", 
varCov=varCov,  nBack=10000, eps=1e-8, 
Nu=c(0,.5,1,1.5,2), B=50, init=rnorm(3), orderExtrap=1:3, multMaxTime=2)
resSimex
summary(resSimex)
## End(Not run)
</code></pre>


</div>