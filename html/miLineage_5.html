<div class="container">

<table style="width: 100%;"><tr>
<td>QCAT</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Quasi-Conditional Association Test (QCAT)
</h2>

<h3>Description</h3>

<p>This function allows users to (a) perform QCAT on multivariate taxon counts; (b) perform QCAT on the taxonomic tree to localize the covariate-associated lineages; and (c) assess the overall association of the microbial community with the covariate of interest.
</p>


<h3>Usage</h3>

<pre><code class="language-R">QCAT(OTU, X, X.index, Tax = NULL, 
min.depth = 0, n.resample = NULL, fdr.alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>OTU</code></td>
<td>

<p>a numeric matrix contains counts with each row corresponds to a sample and each column corresponds to an OTU or a taxon. Column name is mandatory. No missing values are allowed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>a numeric matrix contains covariates with each column pertains to one variable. Samples in the OTU and X matrices should be identical and in the same order. No missing values are allowed. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X.index</code></td>
<td>

<p>a vector indicates the columns in X for the covariate(s) of interest. The remaining columns in X will be treated as confounders.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tax</code></td>
<td>

<p>a matrix define the taxonomic ranks with each row corresponds to an OTU or a taxon and each column corresponds to a rank (start from the higher taxonomic level, e.g., from kingdom to genus). Row name is mandatory and should be consistent with the column name of the OTU table,  Column name should be formatted as "Rank1", "Rank2", etc, representing the taxonomic levels from highest to lowest. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.depth</code></td>
<td>

<p>lower bound for sample read depth. Samples with read depth less than min.depth will be removed before the analysis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.resample</code></td>
<td>

<p>number of reamplings/permutations
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fdr.alpha</code></td>
<td>

<p>desired false discovery rate for multiple tests on the lineages.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If Tax=NULL (Default), a test is performed using all the OTUs/taxa.
</p>
<p>If Tax is provided, tests are performed for lineages derived from the taxonomic hierarchy. The output is a list that contains 3 components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>lineage.pval</code></td>
<td>
<p>p-values for all lineages. By default (n.resample=NULL), only the asymptotic test will be performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig.lineage</code></td>
<td>
<p>a vector of significant lineages</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>global.pval</code></td>
<td>
<p>p-values of the global tests</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Zheng-Zheng Tang
</p>


<h3>References</h3>

<p>Tang, Z.-Z., Chen, G., Alekseyenko, A. V., and Li, H. (2017). A General Framework for Association Analysis of Microbial Communities on a Taxonomic Tree. Bioinformatics, 33(9), 1278-1285.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(data.toy)
OTU.toy = data.toy$OTU.toy
Tax.toy = data.toy$Tax.toy
case = data.toy$covariate.toy
# the OTUs should be consistent between the OTU table and the taxonomy table
OTU.toy.reorder = OTU.toy[,match(rownames(Tax.toy), colnames(OTU.toy))]
# perform QCAT
QCAT(OTU.toy.reorder, case, 1, Tax.toy, fdr.alpha=0.05)
</code></pre>


</div>