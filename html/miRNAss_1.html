<div class="container">

<table style="width: 100%;"><tr>
<td>adjacencyMatrixKNN</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MiRNAss: Genome-wide pre-miRNA discovery from few labeled examples</h2>

<h3>Description</h3>

<p>This funtions builds the adjacency matrix (the graph) given a data frame
of numerical features.
</p>


<h3>Usage</h3>

<pre><code class="language-R">adjacencyMatrixKNN(sequenceFeatures, sequenceLabels = rep(0,
  nrow(sequenceFeatures)), nNearestNeighbor = 10, threadNumber = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sequenceFeatures</code></td>
<td>
<p>Data frame with features extracted from stem-loop
sequences.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sequenceLabels</code></td>
<td>
<p>Vector of labels of the stem-loop sequences. It must
have -1 for negative examples, 1 for known miRNAs and zero for the unknown
sequences (the ones that would be classificated).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nNearestNeighbor</code></td>
<td>
<p>Number of nearest neighbors in the KNN graph. The
default value is 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threadNumber</code></td>
<td>
<p>Number of threads used for the calculations. If it is NA
leave OpenMP decide the number (may vary across different platforms).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns the eigen descomposition as a list with two elements:
The eigen vectors matrix 'U' and the eigen values vector 'D'.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># First construct the label vector with the CLASS column
y = as.numeric(celegans$CLASS)*2 - 1

# Remove some labels to make a test
y[sample(which(y&gt;0),200)] = 0
y[sample(which(y&lt;0),700)] = 0

# Take all the features but remove the label column
x = subset(celegans, select = -CLASS)

A = adjacencyMatrixKNN(x, y, 10, 8)

for (nev in seq(50,200, 50)) {
    # the data frame of features 'x' should not be pass as parameter
    p = miRNAss(sequenceLabels = y, AdjMatrix = A,
                nEigenVectors = nev)
    # Calculate some performance measures
    SE = mean(p[ celegans$CLASS &amp; y==0] &gt; 0)
    SP = mean(p[!celegans$CLASS &amp; y==0] &lt; 0)
    cat("N: ", nev, "\n  SE: ", SE, "\n  SP:   ", SP, "\n")
}
</code></pre>


</div>