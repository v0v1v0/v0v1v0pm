<div class="container">

<table style="width: 100%;"><tr>
<td>analyze.individually</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Performing Individual Chemical Analysis</h2>

<h3>Description</h3>

<p>An accessory function for <code>estimate.wqs()</code>. Performs individual chemical analyses to determine the constraint for the overall mixture effect on the outcome (<code class="reqn">\beta_1</code>) in WQS regression. After adjusting for any covariates, the outcome regresses on each chemical <em>individually</em>. Returns a data-frame of statistics from these analyses.
</p>


<h3>Usage</h3>

<pre><code class="language-R">analyze.individually(
  y,
  X,
  Z = NULL,
  family = c("gaussian", "binomial", "poisson"),
  offset = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Outcome: numeric vector or factor. Assumed to be complete, and missing outcomes are ignored. Assumed to follow an exponential family distribution given in <code>family</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Components/chemicals to be combined into an index; a numeric matrix or data-frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>Any covariates used. Ideally, a numeric matrix, but Z can be a factor, vector or data-frame. Assumed to be complete; observations with missing covariate values are ignored with a warning printed. If none, enter NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>The distribution of outcome y. A character value:
if equal to "gaussian" a linear model is implemented;
if equal to "binomial" a logistic model is implemented;
if equal to "poisson", a log-link (rate or count) model is implemented.
See <code>family</code> in the <span class="pkg">stats</span> package. Passed to <span class="pkg">glm2</span>. Default: "gaussian".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>The at-risk population used as a numeric vector of length equal to the number of subjects when modeling rates in Poisson regression. Passed to <span class="pkg">glm2</span>.  Default: If there is no offset, enter NULL.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Individual chemical analyses with the outcome can be used to determine whether the mixture of chemicals is positively or negatively related to the outcome. The constraint whether the overall mixture effect,  <code class="reqn">\beta_1</code>, is positive or negative is controlled by b1.pos argument in <code>estimate.wqs</code>.  The b1.pos argument is TRUE if the overall chemical mixture effect is positively related to the outcome; otherwise, it is negatively related to the outcome.
For each analysis, the outcome is regressed on the log of the observed values for each chemical and any other covariates Z, if they exist. This was accomplished using <code>glm2</code>.  We summarized the results by recording the chemical name, estimating the log chemical effect and its standard error on the outcome, and using the Akaike Information Criterion (AIC) to indicate model fit.
</p>
<p>By looking at the output, one can decide whether the chemical mixture is positive or negative. Generally, if the sign of estimates is mainly positive, we would decide to make b1.pos in <code>estimate.wqs</code> to be TRUE. This is just one approach to determine the direction of this constraint. Alternatively, one can conduct a WQS analysis for the positively related chemicals and another WQS analysis for the negatively related chemicals.
</p>


<h3>Value</h3>

<p>A data-frame from statistics of individual chemical analyses is returned: </p>

<dl>
<dt>chemical.name</dt>
<dd>
<p>name of the component</p>
</dd>
<dt>estimate</dt>
<dd>
<p>the estimate of log chemical effect</p>
</dd>
<dt>Std.Error</dt>
<dd>
<p>the standard error of log chemical effect</p>
</dd>
<dt>AIC</dt>
<dd>
<p>Model Fit. See <code>stats::AIC</code>.</p>
</dd>
</dl>
<h3>See Also</h3>

<p>Other wqs: 
<code>coef.wqs()</code>,
<code>do.many.wqs()</code>,
<code>estimate.wqs.formula()</code>,
<code>estimate.wqs()</code>,
<code>make.quantile.matrix()</code>,
<code>plot.wqs()</code>,
<code>print.wqs()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Binomial Example
data("simdata87")
analyze.individually(
  y = simdata87$y.scenario, X = simdata87$X.true, Z = simdata87$Z.sim,
  family = "binomial"
)
# The "Estimate" column contains the log_odds of each log of the
# chemical on the outcome. Most are positive, which indicates a possible
# positive relationship between mixture of chemicals and the outcome.
</code></pre>


</div>