<div class="container">

<table style="width: 100%;"><tr>
<td>02missing_data.frame</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Class "missing_data.frame"</h2>

<h3>Description</h3>

<p>This class is similar to a <code>data.frame</code> but is customized for the situation in 
which variables with missing data are being modeled for multiple imputation. This class primarily 
consists of a list of <code>missing_variable</code>s plus slots containing metadata indicating how the
<code>missing_variable</code>s relate to each other. Most operations that work for a
<code>data.frame</code> also work for a missing_data.frame.
</p>


<h3>Usage</h3>

<pre><code class="language-R">missing_data.frame(y, ...)
## Hidden arguments not included in the signature
## favor_ordered = TRUE, favor_positive = FALSE, 
## subclass = NA_character_,
## include_missingness = TRUE, skip_correlation_check = FALSE
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Usually a <code>data.frame</code>, possibly a numeric matrix, 
possibly a list of <code>missing_variable</code>s.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Hidden arguments. The <code>favor_ordered</code> and <code>favor_positive</code>
arguments are passed to the <code>missing_variable</code> function and are 
documented under the <code>type</code> argument. Briefly, they affect the heuristics
that are used to guess what class a variable should be coerced to. The 
<code>subclass</code> argument defaults to <code>NA</code> and can be used to specify
that the resulting object should inherit from the missing_data.frame class
rather than be an object of <code>missing_data.frame</code> class.
</p>
<p>Any further arguments are passed to the <code>initialize-methods</code> for
a missing_data.frame. They currently are <code>include_missingness</code>, which 
defaults to <code>TRUE</code> and indicates that the missingness pattern of the other
variables should be included when modeling a particular <code>missing_variable</code>, 
and <code>skip_correlation_check</code>, which defaults to FALSE and indicates whether
to skip the default check for whether the observed values of each pair of <code>missing_variable</code>s 
has a perfect absolute Spearman <code>cor</code>relation.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In most cases, the first step of an analysis is for a useR to call the 
<code>missing_data.frame</code> function on a <code>data.frame</code> whose variables
have some <code>NA</code> values, which will call the <code>missing_variable</code>
function on each column of the <code>data.frame</code> and return the <code>list</code>
that fills the <b>variable</b> slot. The classes of the list elements will depend on the
nature of the column of the <code>data.frame</code> and various fallible heuristics. The
success rate can be enhanced by making sure that columns of the original 
<code>data.frame</code> that are intended to be categorical variables are 
(ordered if appropriate) <code>factor</code>s with labels. Even in the best case
scenario, it will often be necessary to utlize the <code>change</code> function to 
modify various discretionary aspects of the <code>missing_variable</code>s in the 
<b>variables</b> slot of the missing_data.frame. The <code>show</code> method for
a missing_data.frame should be utilized to get a quick overview of the 
<code>missing_variable</code>s in a missing_data.frame and recognized what needs
to be <code>change</code>d.
</p>


<h3>Value</h3>

<p>The <code>missing_data.frame</code> constructor function returns an object of class <code>missing_data.frame</code> 
or that inherits from the <code>missing_data.frame</code> class.
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("missing_data.frame", ...)</code>.
However, useRs almost always will pass a <code>data.frame</code> to the 
missing_data.frame constructor function to produce an object of missing_data.frame class.
</p>


<h3>Slots</h3>

<p>This section is primarily aimed at developeRs. A missing_data.frame inherits from
<code>data.frame</code> but has the following additional slots:
</p>

<dl>
<dt>
<code>variables</code>:</dt>
<dd>
<p>Object of class <code>"list"</code> and each list element
is an object that inherits from the <code>missing_variable-class</code> </p>
</dd>
<dt>
<code>no_missing</code>:</dt>
<dd>
<p>Object of class <code>"logical"</code>, which is a vector
whose length is the same as the length of the <b>variables</b> slot indicating 
whether the corresponding <code>missing_variable</code> is fully observed </p>
</dd>
<dt>
<code>patterns</code>:</dt>
<dd>
<p>Object of class <code>factor</code> whose length is equal
to the number of observation and whose elements indicate the missingness pattern
for that observation</p>
</dd>
<dt>
<code>DIM</code>:</dt>
<dd>
<p>Object of class <code>"integer"</code> of length two indicating
first the number of observations and second the length of the <b>variables</b>
slot </p>
</dd>
<dt>
<code>DIMNAMES</code>:</dt>
<dd>
<p>Object of class <code>"list"</code> of length two providing
the appropriate number rownames and column names </p>
</dd>
<dt>
<code>postprocess</code>:</dt>
<dd>
<p>Object of class <code>"function"</code> used to create
additional variables from existing variables, such as interactions between
two <code>missing_variable</code>s once their missing values have been
imputed. Does not work at the moment</p>
</dd>
<dt>
<code>index</code>:</dt>
<dd>
<p>Object of class <code>"list"</code> whose length is equal to 
the number of <code>missing_variable</code>s with some missing values. Each
list element is an integer vector indicating which columns of the <b>X</b>
slot must be dropped when modeling the corresponding <code>missing_variable</code> </p>
</dd>
<dt>
<code>X</code>:</dt>
<dd>
<p>Object of <code>MatrixTypeThing-class</code> with rows equal to the
number of observations and is loosely related to a <code>model.matrix</code>. Rather 
than repeatedly parsing a <code>formula</code> during the multiple imputation process,
this <b>X</b> matrix is created once and some of its columns are dropped when
modeling a <code>missing_variable</code> utilizing the <b>index</b> slot.
The columns of the <b>X</b> matrix consists of numeric representations of the 
<code>missing_variable</code>s plus (by default) the unique missingness patterns </p>
</dd>
<dt>
<code>weights</code>:</dt>
<dd>
<p>Object of class <code>"list"</code> whose length is equal to one
or the number of <code>missing_variable</code>s with some missing values. Each 
list element is passed to the corresponding argument of <code>bayesglm</code> 
and similar functions. In particular, some observations can be given a weight
of zero, which should drop them when modeling some <code>missing_variable</code>s</p>
</dd>
<dt>
<code>priors</code>:</dt>
<dd>
<p>Object of class <code>"list"</code> whose length is equal to the number
of <code>missing_variable</code>s and whose elements give appropriate values for
the priors used by the model fitting function wraped by the <code>fit_model-methods</code>; 
see, e.g., <code>bayesglm</code></p>
</dd>
<dt>
<code>correlations</code>:</dt>
<dd>
<p>Object of class <code>"matrix"</code> with rows and
columns equal to the length of the <b>variables</b> slot. Its strict upper
triangle contains Spearman <code>cor</code>relations between pairs of
variables (ignoring missing values), and its strict lower triangle contains
Squared Multiple Correlations (SMCs) between a variable and all other
variables (ignoring missing values). If either a Spearman correlation or
a SMC is very close to unity, there may be difficulty or error messages
during the multiple imputation process.</p>
</dd>
<dt>
<code>done</code>:</dt>
<dd>
<p>Object of class <code>"logical"</code> of length one indicating
whether the missing values have been imputed</p>
</dd>
<dt>
<code>workpath</code>:</dt>
<dd>
<p>Object of class <code>character</code> of length one indicating
the path to a working directory that is used to store some objects</p>
</dd>
</dl>
<h3>Methods</h3>

<p>There are many methods that are defined for a missing_data.frame, although some
are primarily intended for developers. The most relevant ones for users are:
</p>

<dl>
<dt>change</dt>
<dd>
<p><code>signature(data = "missing_data.frame", y = "ANY", what = "character", to = "ANY")</code>
which is used to change discretionary aspects of the <code>missing_variable</code>s
in the <b>variables</b> slot of a missing_data.frame</p>
</dd>
<dt>hist</dt>
<dd>
<p><code>signature(x = "missing_data.frame")</code> which shows histograms
of the observed variables that have missingness</p>
</dd>
<dt>image</dt>
<dd>
<p><code>signature(x = "missing_data.frame")</code> which plots 
an image of the <b>missingness</b> slot to visualize the pattern of missingness
when <code>grayscale = FALSE</code> or the pattern of missingness in light of the
observed values (<code>grayscale = TRUE</code>, the default)</p>
</dd>
<dt>mi</dt>
<dd>
<p><code>signature(y = "missing_data.frame", model = "missing")</code> which 
multiply imputes the missing values</p>
</dd>
<dt>show</dt>
<dd>
<p><code>signature(object = "missing_data.frame")</code> which gives an overview
of the salient characteristics of the <code>missing_variable</code>s in the 
<b>variables</b> slot of a missing_data.frame </p>
</dd>
<dt>summary</dt>
<dd>
<p><code>signature(object = "missing_data.frame")</code> which produces the same
result as the <code>summary</code> method for a <code>data.frame</code></p>
</dd>
</dl>
<p>There are also S3 methods for the <code>dim</code>, <code>dimnames</code>, and <code>names</code>
generics, which allow functions like <code>nrow</code>, <code>ncol</code>, <code>rownames</code>,
<code>colnames</code>, etc. to work as expected on <code>missing_data.frame</code>s. Also, accessing
and changing elements for a <code>missing_data.frame</code> mostly works the same way as for a
<code>data.frame</code>
</p>


<h3>Author(s)</h3>

<p>Ben Goodrich and Jonathan Kropko, for this version, based on earlier versions written by Yu-Sung Su, Masanao Yajima,
Maria Grazia Pittau, Jennifer Hill, and Andrew Gelman.
</p>


<h3>See Also</h3>

<p><code>change</code>, <code>missing_variable</code>, <code>mi</code>,
<code>experiment_missing_data.frame</code>, <code>multilevel_missing_data.frame</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># STEP 0: Get data
data(CHAIN, package = "mi")

# STEP 1: Convert to a missing_data.frame
mdf &lt;- missing_data.frame(CHAIN) # warnings about missingness patterns
show(mdf)

# STEP 2: change things
mdf &lt;- change(mdf, y = "log_virus", what = "transformation", to = "identity")

# STEP 3: look deeper
summary(mdf)
hist(mdf)
image(mdf)

# STEP 4: impute
## Not run: 
imputations &lt;- mi(mdf)

## End(Not run)

## An example with subsetting on a fully observed variable
data(nlsyV, package = "mi")
mdfs &lt;- missing_data.frame(nlsyV, favor_positive = TRUE, favor_ordered = FALSE, by = "first")
mdfs &lt;- change(mdfs, y = "momed", what = "type", to = "ord")
show(mdfs)

</code></pre>


</div>