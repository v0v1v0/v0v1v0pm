<div class="container">

<table style="width: 100%;"><tr>
<td>aidsEst</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimating the Almost Ideal Demand System (AIDS) </h2>

<h3>Description</h3>

<p><code>aidsEst</code> does an econometric estimation
of the Almost Ideal Demand System (AIDS)
</p>


<h3>Usage</h3>

<pre><code class="language-R">aidsEst( priceNames, shareNames, totExpName, data,
      method = "LA", priceIndex = "Ls", pxBase = 1,
      hom = TRUE, sym = TRUE,
      shifterNames = NULL, instNames = NULL,
      estMethod = ifelse( is.null( instNames ), "SUR", "3SLS" ),
      ILmaxiter = 50, ILtol = 1e-5, alpha0 = 0, restrict.regMat = FALSE, ... )

## S3 method for class 'aidsEst'
print( x, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>priceNames</code></td>
<td>
<p>a vector of strings containing the names of the prices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shareNames</code></td>
<td>
<p>a vector of strings containing the names of the expenditure
shares.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>totExpName</code></td>
<td>
<p>a string containing the variable name of total expenditure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame containing all required variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>character string specifying the method to estimate the AIDS:
either 'LA' or 'IL' (see deatils).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priceIndex</code></td>
<td>
<p>character string specifying the price index
for the 'Linear Approximation':
either 'S', 'SL', 'P', 'L', 'Ls', or 'T' (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pxBase</code></td>
<td>
<p>The base to calculate the LA-AIDS price indices
(see <code>aidsPx</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hom</code></td>
<td>
<p>logical. Should the homogeneity condition be imposed?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sym</code></td>
<td>
<p>logical. Should the symmetry condition be imposed?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shifterNames</code></td>
<td>
<p>an optional vector of strings containing the names of
the demand shifters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>instNames</code></td>
<td>
<p>a vector of strings containing the names of instrumental
variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estMethod</code></td>
<td>
<p>estimation method (e.g. 'SUR' or '3SLS',
see <code>systemfit</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ILmaxiter</code></td>
<td>
<p>maximum number of iterations of the
'Iterated Linear Least Squares Estimation'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ILtol</code></td>
<td>
<p>tolerance level of the 'Iterated Linear Least Squares
Estimation'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha0</code></td>
<td>
<p>the intercept of the translog price index (<code class="reqn">\alpha_0</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>restrict.regMat</code></td>
<td>
<p>logical. Method to impose homogeneity and symmetry restrictions:
either via restrict.matrix (default) or via restrict.regMat
(see <code>systemfit</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class <code>aidsEst</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments of <code>aidsEst</code> are passed to
<code>systemfit</code>;
additional arguments of <code>print.aidsEst</code> are currently ignored.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Argument <code>method</code> can specify two different estimation methods:
The 'Linear Approximate AIDS' (LA) and the 'Iterative Linear Least Squares
Estimator' (IL) proposed by Blundell and Robin (1999).<br>
Argument <code>priceIndex</code> can specify six different price indices
for the LA-AIDS:
</p>

<ul>
<li>
<p> Stone price index ('S'),
</p>
</li>
<li>
<p> Stone price index with lagged shares ('SL'),
</p>
</li>
<li>
<p> loglinear analogue to the Paasche price index ('P'),
</p>
</li>
<li>
<p> loglinear analogue of the Laspeyres price index ('L'),
</p>
</li>
<li>
<p> simplified loglinear analogue of the Laspeyres price index ('Ls'), and
</p>
</li>
<li>
<p> Tornqvist price index ('T').
</p>
</li>
</ul>
<p>The 'Iterative Linear Least Squares Estimator' (IL) needs starting
values for the (translog) price index.
Starting values are taken from an initial estimation
of the 'Linear Approximate AIDS' (LA) with the price index
specified by argument <code>priceIndex</code>.
</p>


<h3>Value</h3>

<p>a list of class <code>aidsEst</code> containing following objects:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>
<p>a list containing the vectors/matrix of the estimated
coefficients (alpha, beta, and gamma).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r2</code></td>
<td>
<p><code class="reqn">R^2</code>-values of all share equations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r2q</code></td>
<td>
<p><code class="reqn">R^2</code>-values of the estimated quantities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wFitted</code></td>
<td>
<p>fitted expenditure shares.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wResid</code></td>
<td>
<p>residuals of the expenditure shares.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qObs</code></td>
<td>
<p>observed quantities / quantitiy indices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qFitted</code></td>
<td>
<p>fitted quantities / quantitiy indices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qResid</code></td>
<td>
<p>residuals of the estimated quantities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>
<p>estimation result, i.e. the object returned
by <code>systemfit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>iterations of SUR/3SLS estimation(s).
If the AIDS is estimated by the 'Iterated Linear Least Squares
Estimator' (ILLE):
a vector containing the SUR/3SLS iterations at each iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ILiter</code></td>
<td>
<p>number of iterations of the 'Iterated Linear Least Squares
Estimation'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the method used to estimate the aids (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priceIndex</code></td>
<td>
<p>the name of the price index (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lnp</code></td>
<td>
<p>log of the price index used for estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pMeans</code></td>
<td>
<p>means of the prices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wMeans</code></td>
<td>
<p>means of the expenditure shares.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xtMean</code></td>
<td>
<p>mean of total expenditure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sMeans</code></td>
<td>
<p>means of shifter variables (only if shifter variables are used).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the call of <code>aidsEst</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priceNames</code></td>
<td>
<p>names of the prices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shareNames</code></td>
<td>
<p>names of the expenditure shares.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>totExpName</code></td>
<td>
<p>name of the variable for total expenditure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basePrices</code></td>
<td>
<p>the base prices of the Paasche, Laspeyres,
or Tornqvist price index.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>baseShares</code></td>
<td>
<p>the base shares of the Laspeyres, simplified Laspeyres,
or Tornqvist price index.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Arne Henningsen</p>


<h3>References</h3>

<p>Deaton, A.S. and J. Muellbauer (1980)
An Almost Ideal Demand System.
<em>American Economic Review</em>, 70, p. 312-326.
</p>
<p>Blundell, R. and J.M. Robin (1999)
Estimationin Large and Disaggregated Demand Systems:
An Estimator for Conditionally Linear Systems.
<em>Journal of Applied Econometrics</em>, 14, p. 209-232.
</p>


<h3>See Also</h3>

<p><code>summary.aidsEst</code>, <code>aidsElas</code>,
<code>aidsCalc</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R">   # Using data published in Blanciforti, Green &amp; King (1986)
   data( Blanciforti86 )
   # Data on food consumption are available only for the first 32 years
   Blanciforti86 &lt;- Blanciforti86[ 1:32, ]

   ## Repeating the demand analysis of Blanciforti, Green &amp; King (1986)
   ## Note: Blanciforti, Green &amp; King (1986) use scaled data,
   ##       which leads to slightly different results
   estResult &lt;- aidsEst( c( "pFood1", "pFood2", "pFood3", "pFood4" ),
      c( "wFood1", "wFood2", "wFood3", "wFood4" ), "xFood",
      data = Blanciforti86, priceIndex = "SL", maxiter = 100 )
   print( estResult )
   elas( estResult )

   ## Estimations with a demand shifter: linear trend
   priceNames &lt;- c( "pFood1", "pFood2", "pFood3", "pFood4" )
   shareNames &lt;- c( "wFood1", "wFood2", "wFood3", "wFood4" )
   Blanciforti86$trend &lt;- c( 0:( nrow( Blanciforti86 ) - 1 ) )
   estResult &lt;- aidsEst( priceNames, shareNames, "xFood",
      data = Blanciforti86, shifterNames = "trend" )
   print( estResult )

   # Estimations with two demand shifters: linear + quadratic trend
   Blanciforti86$trend2 &lt;- c( 0:( nrow( Blanciforti86 ) - 1 ) )^2
   estResult &lt;- aidsEst( priceNames, shareNames, "xFood",
      data = Blanciforti86, shifterNames = c( "trend", "trend2" ) )
   print( estResult )
</code></pre>


</div>