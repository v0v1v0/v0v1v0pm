<div class="container">

<table style="width: 100%;"><tr>
<td>cesCalc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate CES function</h2>

<h3>Description</h3>

<p>Calculate the endogenous variable
of a ‘Constant Elasticity of Substitution’ (CES)
function.
</p>
<p>The original CES function with two explanatory variables is
</p>
<p style="text-align: center;"><code class="reqn">y = \gamma \: \exp ( \lambda \: t ) \: 
      ( \delta \: x_1^{-\rho} + ( 1 - \delta ) \: x_2^{-\rho} )
      ^{-\frac{\nu}{\rho}}</code>
</p>

<p>and the non-nested CES function with <code class="reqn">N</code> explanatory variables is
</p>
<p style="text-align: center;"><code class="reqn">y = \gamma \: \exp ( \lambda \: t ) \: 
      \left( \sum_{i=1}^N \delta_i \: x_i^{-\rho} \right)
      ^{-\frac{\nu}{\rho}}</code>
</p>

<p>where in the latter case
<code class="reqn">\sum_{i=1}^N \delta_i = 1</code>.
</p>
<p>In both cases, the elesticity of substitution is
<code class="reqn">s = \frac{1}{ 1 + \rho }</code>.
</p>
<p>The <em>nested</em> CES function with 3 explanatory variables 
proposed by Sato (1967) is
</p>
<p style="text-align: center;"><code class="reqn">y = \gamma \: \exp ( \lambda \: t ) \: \left[
      \delta \:
      \left( \delta_1 \: x_1^{-\rho_1} +
      ( 1 - \delta_1 ) x_2^{-\rho_1} \right)^{\frac{\rho}{\rho_1}} +
      ( 1 - \delta ) x_3^{-\rho}
      \right]^{-\frac{\nu}{\rho}}</code>
</p>

<p>and the <em>nested</em> CES function with 4 explanatory variables 
(a generalisation of the version proposed by Sato, 1967) is
</p>
<p style="text-align: center;"><code class="reqn">y = \gamma \: \exp ( \lambda \: t ) \: \left[ \delta \cdot
      \left( \delta_1 \: x_1^{-\rho_1} +
      ( 1 - \delta_1 ) x_2^{-\rho_1} \right)^{\frac{\rho}{\rho_1}} +
      ( 1 - \delta ) \cdot
      \left( \delta_2 \: x_3^{-\rho_2} +
      ( 1 - \delta_2 ) x_4^{-\rho_2} \right)^{\frac{\rho}{\rho_2}}
      \right]^{-\frac{\nu}{\rho}}</code>
</p>



<h3>Usage</h3>

<pre><code class="language-R">cesCalc( xNames, data, coef, tName = NULL, nested = FALSE, rhoApprox = 5e-6 )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xNames</code></td>
<td>
<p>a vector of strings containing the names of the
explanatory variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data frame containing the explanatory variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>
<p>numeric vector containing the coefficients of the CES:
if the vector is unnamed,
the order of the coefficients must be
<code class="reqn">\gamma</code>, eventuelly <code class="reqn">\lambda</code>, 
<code class="reqn">\delta</code>, <code class="reqn">\rho</code>, 
and eventually <code class="reqn">\nu</code>
in case of two expanatory variables,
<code class="reqn">\gamma</code>, eventuelly <code class="reqn">\lambda</code>, 
<code class="reqn">\delta_1</code>, ...,
<code class="reqn">\delta_N</code>, <code class="reqn">\rho</code>, and eventually <code class="reqn">\nu</code>
in case of the non-nested CES with <code class="reqn">N&gt;2</code> explanatory variables,
<code class="reqn">\gamma</code>, eventuelly <code class="reqn">\lambda</code>, 
<code class="reqn">\delta_1</code>, <code class="reqn">\delta</code>, 
<code class="reqn">\rho_1</code>, <code class="reqn">\rho</code>, and eventually <code class="reqn">\nu</code>
in case of the nested CES with 3 explanatory variables,
and <code class="reqn">\gamma</code>, eventuelly <code class="reqn">\lambda</code>, 
<code class="reqn">\delta_1</code>, <code class="reqn">\delta_2</code>, 
<code class="reqn">\delta</code>, <code class="reqn">\rho_1</code>, <code class="reqn">\rho_2</code>, 
<code class="reqn">\rho</code>, and eventually <code class="reqn">\nu</code>
in case of the nested CES with 4 explanatory variables,
where in all cases the <code class="reqn">\nu</code> is only required if the model
has variable returns to scale.
If the vector is named, the names must be <code>"gamma"</code>,
<code>"delta"</code>, <code>"rho"</code>, and eventually <code>"nu"</code>
in case of two expanatory variables,
<code>"gamma"</code>, <code>"delta_1"</code>, ..., <code>"delta_N"</code>,
<code>"rho"</code>, and eventually <code>"nu"</code>
in case of the non-nested CES with <code class="reqn">N&gt;2</code> explanatory variables,
and <code>"gamma"</code>, <code>"delta_1"</code>, <code>"delta_2"</code>,
<code>"rho_1"</code>, <code>"rho_2"</code>, <code>"rho"</code>, and eventually <code>"nu"</code>
in case of the nested CES with 4 explanatory variables,
where the order is irrelevant in all cases.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tName</code></td>
<td>
<p>optional character string specifying the name of the 
time variable (<code class="reqn">t</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nested</code></td>
<td>
<p>logical. ;
if <code>FALSE</code> (the default), the original CES for <code class="reqn">n</code> inputs 
proposed by Kmenta (1967) is used;
if <code>TRUE</code>, the nested version of the CES
for 3 or 4 inputs proposed by Sato (1967) is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rhoApprox</code></td>
<td>
<p>if the absolute value of the coefficient <code class="reqn">\rho</code>,
<code class="reqn">\rho_1</code>, or <code class="reqn">\rho_2</code> 
is smaller than or equal to this argument,
the endogenous variable is calculated
using a first-order Taylor series approximation 
at the point <code class="reqn">\rho</code> = 0 (for non-nested CES functions)
or a linear interpolation (for nested CES functions),
because this avoids large numerical inaccuracies
that frequently occur in calculations with non-linear CES functions
if <code class="reqn">\rho</code>, <code class="reqn">\rho_1</code>, or <code class="reqn">\rho_2</code>
have very small values (in absolute terms).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A numeric vector with length equal to the number of rows of the data set
specified in argument <code>data</code>.
</p>


<h3>Author(s)</h3>

<p>Arne Henningsen and Geraldine Henningsen</p>


<h3>References</h3>

<p>Kmenta, J. (1967):
On Estimation of the CES Production Function.
International Economic Review 8, p. 180-189.
</p>
<p>Sato, K. (1967): 
A Two-Level Constant-Elasticity-of-Substitution Production Function.
Review of Economic Studies 43, p. 201-218.
</p>


<h3>See Also</h3>

<p><code>cesEst</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R">   data( germanFarms, package = "micEcon" )
   # output quantity:
   germanFarms$qOutput &lt;- germanFarms$vOutput / germanFarms$pOutput
   # quantity of intermediate inputs
   germanFarms$qVarInput &lt;- germanFarms$vVarInput / germanFarms$pVarInput


   ## Estimate CES: Land &amp; Labor with fixed returns to scale
   cesLandLabor &lt;- cesEst( "qOutput", c( "land", "qLabor" ), germanFarms )

   ## Calculate fitted values
   cesCalc( c( "land", "qLabor" ), germanFarms, coef( cesLandLabor ) )


   # variable returns to scale
   cesLandLaborVrs &lt;- cesEst( "qOutput", c( "land", "qLabor" ), germanFarms,
      vrs = TRUE )

   ## Calculate fitted values
   cesCalc( c( "land", "qLabor" ), germanFarms, coef( cesLandLaborVrs ) )
</code></pre>


</div>