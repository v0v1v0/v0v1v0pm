<div class="container">

<table style="width: 100%;"><tr>
<td>with_graph</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Evaluate Causal Graph Discovery Algorithm in Multiple Imputed Data sets</h2>

<h3>Description</h3>

<p>Evaluate Causal Graph Discovery Algorithm in Multiple Imputed Data sets
</p>


<h3>Usage</h3>

<pre><code class="language-R">with_graph(data, algo = c("pc", "fci", "fciPlus", "ges"), args, score = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>An object of type mids, which stands for 'multiply imputed
data set', typically created by a call to function mice()</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>algo</code></td>
<td>
<p>An algorithm for causal discovery from the package 'pcalg'
(see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args</code></td>
<td>
<p>Additional arguments passed to the algo. Must be a string
vector starting with comma, i.e. ", ..."</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>score</code></td>
<td>
<p>Logical indicating whether a score-based or a constrained-based
algorithm is applied.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list object of S3 class <code>mice::mira-class</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(windspeed)
dat &lt;- as.matrix(windspeed)

## delete some observations
set.seed(123)
dat[sample(1:length(dat), 260)] &lt;- NA

## Impute missing values under normal model
imp &lt;- mice(dat, method = "norm", printFlag = FALSE)
mylabels &lt;- names(imp$imp)
out.fci &lt;- with_graph(data = imp, 
                      algo = "fciPlus", 
                      args = ", indepTest = gaussCItest, verbose = FALSE,
                      labels = mylabels, alpha = 0.01")
                          
 out.ges &lt;- with_graph(data = imp, algo = "ges", arg = NULL, score = TRUE)
 
if (requireNamespace("Rgraphviz", quietly = TRUE)){
 oldpar &lt;- par(mfrow = c(1,2)) 
   plot(out.fci$res[[1]])
   plot(out.ges$res[[1]]$essgraph)
 par(oldpar)
 }
                                     
</code></pre>


</div>