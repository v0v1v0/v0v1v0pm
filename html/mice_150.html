<div class="container">

<table style="width: 100%;"><tr>
<td>mice.impute.norm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Imputation by Bayesian linear regression</h2>

<h3>Description</h3>

<p>Calculates imputations for univariate missing data by Bayesian linear
regression, also known as the normal model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mice.impute.norm(y, ry, x, wy = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Vector to be imputed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ry</code></td>
<td>
<p>Logical vector of length <code>length(y)</code> indicating the
the subset <code>y[ry]</code> of elements in <code>y</code> to which the imputation
model is fitted. The <code>ry</code> generally distinguishes the observed
(<code>TRUE</code>) and missing values (<code>FALSE</code>) in <code>y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Numeric design matrix with <code>length(y)</code> rows with predictors for
<code>y</code>. Matrix <code>x</code> may have no missing values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wy</code></td>
<td>
<p>Logical vector of length <code>length(y)</code>. A <code>TRUE</code> value
indicates locations in <code>y</code> for which imputations are created.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other named arguments.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Imputation of <code>y</code> by the normal model by the method defined by
Rubin (1987, p. 167). The procedure is as follows:
</p>

<ol>
<li>
<p>Calculate the cross-product matrix <code class="reqn">S=X_{obs}'X_{obs}</code>.
</p>
</li>
<li>
<p>Calculate <code class="reqn">V = (S+{diag}(S)\kappa)^{-1}</code>, with some small ridge
parameter <code class="reqn">\kappa</code>.
</p>
</li>
<li>
<p>Calculate regression weights <code class="reqn">\hat\beta = VX_{obs}'y_{obs}.</code>
</p>
</li>
<li>
<p>Draw a random variable <code class="reqn">\dot g \sim \chi^2_\nu</code> with <code class="reqn">\nu=n_1 - q</code>.
</p>
</li>
<li>
<p>Calculate <code class="reqn">\dot\sigma^2 = (y_{obs} - X_{obs}\hat\beta)'(y_{obs} - X_{obs}\hat\beta)/\dot g.</code>
</p>
</li>
<li>
<p>Draw <code class="reqn">q</code> independent <code class="reqn">N(0,1)</code> variates in vector <code class="reqn">\dot z_1</code>.
</p>
</li>
<li>
<p>Calculate <code class="reqn">V^{1/2}</code> by Cholesky decomposition.
</p>
</li>
<li>
<p>Calculate <code class="reqn">\dot\beta = \hat\beta + \dot\sigma\dot z_1 V^{1/2}</code>.
</p>
</li>
<li>
<p>Draw <code class="reqn">n_0</code> independent <code class="reqn">N(0,1)</code> variates in vector <code class="reqn">\dot z_2</code>.
</p>
</li>
<li>
<p>Calculate the <code class="reqn">n_0</code> values <code class="reqn">y_{imp} = X_{mis}\dot\beta + \dot z_2\dot\sigma</code>.
</p>
</li>
</ol>
<p>Using <code>mice.impute.norm</code> for all columns emulates Schafer's NORM method (Schafer, 1997).
</p>


<h3>Value</h3>

<p>Vector with imputed data, same type as <code>y</code>, and of length
<code>sum(wy)</code>
</p>


<h3>Author(s)</h3>

<p>Stef van Buuren, Karin Groothuis-Oudshoorn
</p>


<h3>References</h3>

<p>Rubin, D.B (1987). Multiple Imputation for Nonresponse in Surveys. New York: John Wiley &amp; Sons.
</p>
<p>Schafer, J.L. (1997). Analysis of incomplete multivariate data. London: Chapman &amp; Hall.
</p>


<h3>See Also</h3>

<p>Other univariate imputation functions: 
<code>mice.impute.cart()</code>,
<code>mice.impute.lasso.logreg()</code>,
<code>mice.impute.lasso.norm()</code>,
<code>mice.impute.lasso.select.logreg()</code>,
<code>mice.impute.lasso.select.norm()</code>,
<code>mice.impute.lda()</code>,
<code>mice.impute.logreg.boot()</code>,
<code>mice.impute.logreg()</code>,
<code>mice.impute.mean()</code>,
<code>mice.impute.midastouch()</code>,
<code>mice.impute.mnar.logreg()</code>,
<code>mice.impute.mpmm()</code>,
<code>mice.impute.norm.boot()</code>,
<code>mice.impute.norm.nob()</code>,
<code>mice.impute.norm.predict()</code>,
<code>mice.impute.pmm()</code>,
<code>mice.impute.polr()</code>,
<code>mice.impute.polyreg()</code>,
<code>mice.impute.quadratic()</code>,
<code>mice.impute.rf()</code>,
<code>mice.impute.ri()</code>
</p>


</div>