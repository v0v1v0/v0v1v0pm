<div class="container">

<table style="width: 100%;"><tr>
<td>mice.impute.2l.lmer</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Imputation by a two-level normal model using <code>lmer</code>
</h2>

<h3>Description</h3>

<p>Imputes univariate systematically and sporadically missing data using a
two-level normal model using <code>lme4::lmer()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mice.impute.2l.lmer(y, ry, x, type, wy = NULL, intercept = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Vector to be imputed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ry</code></td>
<td>
<p>Logical vector of length <code>length(y)</code> indicating the
the subset <code>y[ry]</code> of elements in <code>y</code> to which the imputation
model is fitted. The <code>ry</code> generally distinguishes the observed
(<code>TRUE</code>) and missing values (<code>FALSE</code>) in <code>y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Numeric design matrix with <code>length(y)</code> rows with predictors for
<code>y</code>. Matrix <code>x</code> may have no missing values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Vector of length <code>ncol(x)</code> identifying random and class
variables.  Random variables are identified by a '2'. The class variable
(only one is allowed) is coded as '-2'. Fixed effects are indicated by
a '1'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wy</code></td>
<td>
<p>Logical vector of length <code>length(y)</code>. A <code>TRUE</code> value
indicates locations in <code>y</code> for which imputations are created.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>Logical determining whether the intercept is automatically
added.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments passed down to <code>lmer</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Data are missing systematically if they have not been measured, e.g., in the
case where we combine data from different sources. Data are missing sporadically
if they have been partially observed.
</p>
<p>While the method is fully Bayesian, it may fix parameters of the
variance-covariance matrix or the random effects to their estimated
value in cases where creating draws from the posterior is not
possible. The procedure throws a warning when this happens.
</p>
<p>If <code>lme4::lmer()</code> fails, the procedure prints the warning
<code>"lmer does not run. Simplify imputation model"</code> and returns the
current imputation.  If that happens we see flat lines in the
trace line plots. Thus, the appearance of flat trace lines should be taken
as an additional alert to a problem with imputation model fitting.
</p>


<h3>Value</h3>

<p>Vector with imputed data, same type as <code>y</code>, and of length
<code>sum(wy)</code>
</p>


<h3>Author(s)</h3>

<p>Shahab Jolani, 2017
</p>


<h3>References</h3>

<p>Jolani S. (2017) Hierarchical imputation of systematically and
sporadically missing data: An approximate Bayesian approach using
chained equations. Forthcoming.
</p>
<p>Jolani S., Debray T.P.A., Koffijberg H., van Buuren S., Moons K.G.M. (2015).
Imputation of systematically missing predictors in an individual
participant data meta-analysis: a generalized approach using MICE.
<em>Statistics in Medicine</em>, 34:1841-1863.
</p>
<p>Van Buuren, S. (2011) Multiple imputation of multilevel data. In Hox, J.J.
and and Roberts, J.K. (Eds.), <em>The Handbook of Advanced Multilevel
Analysis</em>, Chapter 10, pp. 173â€“196. Milton Park, UK: Routledge.
</p>


<h3>See Also</h3>

<p>Other univariate-2l: 
<code>mice.impute.2l.bin()</code>,
<code>mice.impute.2l.norm()</code>,
<code>mice.impute.2l.pan()</code>
</p>


</div>