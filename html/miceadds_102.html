<div class="container">

<table style="width: 100%;"><tr>
<td>mice.impute.2l.latentgroupmean.ml</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Imputation of Latent and Manifest Group Means for Multilevel Data
</h2>

<h3>Description</h3>

<p>The imputation method <code>2l.latentgroupmean</code> imputes a latent group mean
assuming an infinite population of subjects within a group
(Grund, Luedtke &amp; Robitzsch, 2018; see also
Luedtke, Marsh, Robitzsch, Trautwein, Asparouhov &amp; Muthen, 2008
or Croon &amp; van Veldhoven, 2007).
Therefore, unreliability of group means when treating subjects as
indicators is taken into account.
</p>
<p>The imputation method <code>mice.impute.2l.groupmean</code> just imputes (i.e. computes)
the manifest group mean. See also
<code>mice::mice.impute.2lonly.mean</code>.
</p>
<p>The imputation method <code>mice.impute.2l.groupmean.elim</code> computes the
group mean eliminating the subject under study from the calculation.
Therefore, this imputation method will lead to different values of
individuals within the same group.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mice.impute.2l.latentgroupmean.ml(y, ry, x, type, pls.facs=NULL,
    imputationWeights=NULL, interactions=NULL, quadratics=NULL,
    EAP=FALSE, ...)

mice.impute.2l.latentgroupmean.mcmc(y, ry, x, type, pls.facs=NULL,
    imputationWeights=NULL, interactions=NULL, quadratics=NULL,
    mcmc.burnin=100, mcmc.adapt=100, mcmc.iter=1000, draw.fixed=TRUE, EAP=FALSE, ...)

mice.impute.2l.groupmean(y, ry, x, type, grmeanwarning=TRUE, ...)

mice.impute.2l.groupmean.elim(y, ry, x, type, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>Incomplete data vector of length <code>n</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ry</code></td>
<td>

<p>Vector of missing data pattern (<code>FALSE</code> – missing,
<code>TRUE</code> – observed)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>Matrix (<code>n</code> x <code>p</code>) of complete covariates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>Type of predictor variables. <code>type=-2</code> refers to the cluster variable,
<code>type=2</code> denotes a variable for which also a (latent) group mean
should be calculated. Predictors with <code>type=1</code> denote all other variables.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pls.facs</code></td>
<td>

<p>Number of factors used for PLS regression (optional).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>imputationWeights</code></td>
<td>

<p>Optional vector of sample weights.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interactions</code></td>
<td>

<p>Vector of variable names used for creating interactions
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quadratics</code></td>
<td>

<p>Vector of variable names used for creating quadratic terms
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>draw.fixed</code></td>
<td>
<p>Optional logical indicating whether parameters for fixed
effects should be sampled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EAP</code></td>
<td>
<p>Logical indicating whether EAPs should be used for imputation.
The default <code>FALSE</code> corresponds to sampling from the posterior
distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcmc.burnin</code></td>
<td>
<p>Number of MCMC burn-in iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcmc.adapt</code></td>
<td>
<p>Number of MCMC iterations in adaptation phase.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcmc.iter</code></td>
<td>
<p>Total number of MCMC iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grmeanwarning</code></td>
<td>

<p>An optional logical indicating whether some group means cannot be calculated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Further arguments to be passed.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The imputation of the latent group mean uses the
<code>lme4::lmer</code> function of the <span class="pkg">lme4</span> package
for <code>mice.impute.2l.latentgroupmean.ml</code> and the
<code>MCMCglmm::MCMCglmm</code> function
of the <span class="pkg">MCMCglmm</span> package for <code>mice.impute.2l.latentgroupmean.ml</code>.
Latent group mean imputation also follows
Mislevy (1991).
</p>


<h3>Value</h3>

<p>A vector of length <code>y</code> containing imputed group means.
</p>


<h3>References</h3>

<p>Croon, M. A., &amp; van Veldhoven, M. J. (2007). Predicting group-level outcome
variables from variables measured at the individual level: a latent variable
multilevel model. <em>Psychological Methods, 12</em>(1), 45-57.
<a href="https://doi.org/10.1037/1082-989X.12.1.45">doi:10.1037/1082-989X.12.1.45</a>
</p>
<p>Grund, S., Luedtke, O., &amp; Robitzsch, A. (2018). Multiple imputation of missing data at
level 2: A comparison of fully conditional and joint modeling in multilevel designs.
<em>Journal of Educational and Behavioral Statistics, 43</em>(3), 316-353.
<a href="https://doi.org/10.3102/1076998617738087">doi:10.3102/1076998617738087</a>
</p>
<p>Luedtke, O., Marsh, H. W., Robitzsch, A., Trautwein, U., Asparouhov, T., &amp;
Muthen, B. (2008). The multilevel latent covariate model: a new, more
reliable approach to group-level effects in contextual studies.
<em>Psychological Methods, 13</em>(3), 203-229.
<a href="https://doi.org/10.1037/a0012869">doi:10.1037/a0012869</a>
</p>
<p>Mislevy, R. J. (1991). Randomization-based inference about latent variables
from complex samples. <em>Psychometrika, 56</em>(2), 177-196.
<a href="https://doi.org/10.1007/BF02294457">doi:10.1007/BF02294457</a>
</p>


<h3>See Also</h3>

<p><code>mice::mice.impute.2lonly.mean</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
#############################################################################
# EXAMPLE 1: Two-level imputation data.ma05 dataset with imputation
#            of a latent group mean
#############################################################################

data(data.ma05)
dat &lt;- data.ma05

# include manifest group mean for 'Mscore'
dat$M.Mscore &lt;- NA
# include latent group group for 'Mscore'
dat$LM.Mscore &lt;- NA    #=&gt; LM: latent group mean

# define predictor matrix
predM &lt;- mice::make.predictorMatrix(data=dat)
# exclude student ISs
predM[, "idstud"] &lt;- 0
# idclass is the cluster identifier
predM[, "idclass" ] &lt;- -2

# define imputation methods
impMethod &lt;- mice::make.method(data=dat)
# initialize with norm
impMethod &lt;- rep( "norm", length(impMethod) )
names(impMethod) &lt;- names( imp$method )
impMethod[ c("idstud","idclass")] &lt;- ""

#*****
# STUDENT LEVEL (Level 1)

# Use a random slope model for Dscore and Mscore as the imputation method.
# Here, variance homogeneity of residuals is assumed (contrary to
# the 2l.norm imputation method in the mice package).
impMethod[ c("Dscore", "Mscore") ] &lt;- "2l.pan"
predM[ c("Dscore","Mscore"), "misei" ] &lt;- 2    # random slopes on 'misei'
predM[, "idclass" ] &lt;- -2

# For imputing 'manote' and 'denote' use contextual effects (i.e. cluster means)
# of variables 'misei' and 'migrant'
impMethod[ c("denote", "manote") ] &lt;- "2l.contextual.pmm"
predM[ c("denote", "manote"), c("misei","migrant")] &lt;- 2

# Use no cluster variable 'idclass' for imputation of 'misei'
impMethod[ "misei"] &lt;- "norm"
predM[ "misei", "idclass"] &lt;- 0 # use no multilevel imputation model

# Variable migrant: contextual effects of Dscore and misei
impMethod[ "migrant"] &lt;- "2l.contextual.pmm"
predM[ "migrant", c("Dscore",  "misei" ) ] &lt;- 2
predM[ "migrant", "idclass" ] &lt;- -2

#****
# CLASS LEVEL (Level 2)
# impute 'sprengel' and 'groesse' at the level of classes
impMethod[ "sprengel"] &lt;- "2lonly.pmm2"
impMethod[ "groesse"] &lt;- "2lonly.norm2"
predM[ c("sprengel","groesse"), "idclass" ] &lt;- -2

# manifest group mean for Mscore
impMethod[ "M.Mscore" ] &lt;- "2l.groupmean"
# latent group mean for Mscore
impMethod[ "LM.Mscore" ] &lt;- "2l.latentgroupmean.ml"
predM[ "M.Mscore", "Mscore" ] &lt;- 2

# covariates for latent group mean of 'Mscore'
predM[ "LM.Mscore", "Mscore" ] &lt;- 2
predM[ "LM.Mscore", c( "Dscore", "sprengel" ) ] &lt;- 1

# do imputations
imp &lt;- mice::mice( dat, predictorMatrix=predM, m=3,  maxit=4,
         method=impMethod, allow.na=TRUE, pan.iter=100)

## End(Not run)
</code></pre>


</div>