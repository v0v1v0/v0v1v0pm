<div class="container">

<table style="width: 100%;"><tr>
<td>mice.impute.pls</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Imputation using Partial Least Squares for Dimension Reduction
</h2>

<h3>Description</h3>

<p>This function imputes a variable with missing values using
PLS regression (Mevik &amp; Wehrens, 2007) for a dimension
reduction of the predictor space.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mice.impute.pls(y, ry, x, type, pls.facs=NULL,
   pls.impMethod="pmm", donors=5, pls.impMethodArgs=NULL, pls.print.progress=TRUE,
   imputationWeights=rep(1, length(y)), pcamaxcols=1E+09,
   min.int.cor=0, min.all.cor=0, N.largest=0, pls.title=NULL, print.dims=TRUE,
   pls.maxcols=5000, use_boot=FALSE, envir_pos=NULL, extract_data=TRUE,
   remove_lindep=TRUE, derived_vars=NULL, ...)

mice.impute.2l.pls2(y, ry, x, type, pls.facs=NULL, pls.impMethod="pmm",
   pls.print.progress=TRUE, imputationWeights=rep(1, length(y)), pcamaxcols=1E+09,
   tricube.pmm.scale=NULL, min.int.cor=0, min.all.cor=0, N.largest=0,
   pls.title=NULL, print.dims=TRUE, pls.maxcols=5000, envir_pos=parent.frame(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Incomplete data vector of length <code>n</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ry</code></td>
<td>

<p>Vector of missing data pattern (<code>FALSE</code> – missing,
<code>TRUE</code> – observed)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Matrix (<code>n</code> x <code>p</code>) of complete
covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p><code>type=1</code> – variable is used as a predictor,
</p>
<p><code>type=4</code> – create interactions with the specified
variable with all other predictors,
</p>
<p><code>type=5</code> – create a quadratic term of the specified variable
</p>
<p><code>type=6</code> – if some interactions are specified, ignore
the variables with entry <code>6</code> when creating interactions
</p>
<p><code>type=-2</code> – specification of a cluster variable. The cluster mean
of the outcome <code>y</code> (when eliminating the subject under study)
is included as a further predictor in the imputation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pls.facs</code></td>
<td>

<p>Number of factors used in PLS regression. This argument can also
be specified as a list defining different numbers of factors
for all variables to be imputed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pls.impMethod</code></td>
<td>
<p>Imputation method used for in PLS estimation.
Any imputation method can be used except if <code>imputationWeights</code>
is provided. Imputation weights are available for <code>norm</code> and <code>pmm</code>.
Categorical variables can be imputed with the method <code>catpmm</code>
(see <code>mice.impute.catpmm</code>). For the method <code>catpmm</code>,
multivariate PLS regression is employed for dummy-coded categories of
the outcome variable. The method <code>xplsfacs</code> creates only PLS factors
of the regression model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>donors</code></td>
<td>
<p>Number of donors if predictive mean matching is used
(<code>pls.impMethod="pmm"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pls.impMethodArgs</code></td>
<td>
<p>Arguments for imputation method
<code>pls.impMethod</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pls.print.progress</code></td>
<td>

<p>Print progress during PLS regression.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>imputationWeights</code></td>
<td>

<p>Vector of sample weights to be used in imputation models.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pcamaxcols</code></td>
<td>

<p>Amount of variance explained by principal components (must be a number between
0 and 1) or number of factors used in PCA (an integer larger than 1).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.int.cor</code></td>
<td>

<p>Minimum absolute correlation for an interaction of two predictors
to be included in the PLS regression model
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.all.cor</code></td>
<td>

<p>Minimum absolute correlation for inclusion in the PLS regression
model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N.largest</code></td>
<td>

<p>Number of variable to be included which do have the largest
absolute correlations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pls.title</code></td>
<td>

<p>Title for progress print in console output.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.dims</code></td>
<td>

<p>An optional logical indicating whether dimensions of
inputs should be printed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pls.maxcols</code></td>
<td>

<p>Maximum number of interactions to be created.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_boot</code></td>
<td>
<p>Logical whether Bayesian bootstrap should be used for
drawing regression parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>envir_pos</code></td>
<td>
<p>Position of the environment from which the data should
be extracted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extract_data</code></td>
<td>
<p>Logical indicating whether input data should be extracted
from parent environment within <code>mice::mice</code>  routine</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove_lindep</code></td>
<td>
<p>Logical indicating whether linear dependencies should
be automatically detected and some predictors are removed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>derived_vars</code></td>
<td>
<p>Optional list containing formulas with derived variables for
inclusion in PLS dimension reduction</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Further arguments to be passed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tricube.pmm.scale</code></td>
<td>
<p>Scale factor for tricube PMM imputation.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A vector of length <code>nmis=sum(!ry)</code> with imputations
if <code>pls.impMethod !="xplsfacs"</code>. In case of
<code>pls.impMethod=="xplsfacs"</code> a matrix with PLS factors
is computed.
</p>


<h3>Note</h3>

<p>The <code>mice.impute.2l.pls2</code> function is just included for reasons of
backward compatibility to former <span class="pkg">miceadds</span> versions.
</p>


<h3>References</h3>

<p>Mevik, B. H., &amp; Wehrens, R. (2007). The <span class="pkg">pls</span> package:
Principal component and partial least squares regression in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>.
<em>Journal of Statistical Software, 18</em>, 1-24.
<a href="https://doi.org/10.18637/jss.v018.i02">doi:10.18637/jss.v018.i02</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
#############################################################################
# EXAMPLE 1: PLS imputation method for internet data
#############################################################################

data(data.internet)
dat &lt;- data.internet

# specify predictor matrix
predictorMatrix &lt;- matrix( 1, ncol(dat), ncol(dat) )
rownames(predictorMatrix) &lt;- colnames(predictorMatrix) &lt;- colnames(dat)
diag( predictorMatrix) &lt;- 0

# use PLS imputation method for all variables
impMethod &lt;- rep( "pls", ncol(dat) )
names(impMethod) &lt;- colnames(dat)

# define predictors for interactions (entries with type 4 in predictorMatrix)
predictorMatrix[c("IN1","IN15","IN16"),c("IN1","IN3","IN10","IN13")] &lt;- 4
# define predictors which should appear as linear and quadratic terms (type 5)
predictorMatrix[c("IN1","IN8","IN9","IN10","IN11"),c("IN1","IN2","IN7","IN5")] &lt;- 5

# use 9 PLS factors for all variables
pls.facs &lt;- as.list( rep( 9, length(impMethod) ) )
names(pls.facs) &lt;- names(impMethod)
pls.facs$IN1 &lt;- 15   # use 15 PLS factors for variable IN1

# choose norm or pmm imputation method
pls.impMethod &lt;- as.list( rep("norm", length(impMethod) ) )
names(pls.impMethod) &lt;- names(impMethod)
pls.impMethod[ c("IN1","IN6")] &lt;- "pmm"

# some arguments for imputation method
pls.impMethodArgs &lt;- list( "IN1"=list( "donors"=10 ),
                           "IN2"=list( "ridge2"=1E-4 ) )

# Model 1: Three parallel chains
imp1 &lt;- mice::mice(data=dat, method=impMethod,
     m=3, maxit=5, predictorMatrix=predictorMatrix,
     pls.facs=pls.facs, # number of PLS factors
     pls.impMethod=pls.impMethod,  # Imputation Method in PLS imputation
     pls.impMethodArgs=pls.impMethodArgs, # arguments for imputation method
     pls.print.progress=TRUE, ls.meth="ridge" )
summary(imp1)

# Model 2: One long chain
imp2 &lt;- miceadds::mice.1chain(data=dat, method=impMethod,
     burnin=10, iter=21, Nimp=3, predictorMatrix=predictorMatrix,
     pls.facs=pls.facs, pls.impMethod=pls.impMethod,
     pls.impMethodArgs=pls.impMethodArgs, ls.meth="ridge" )
summary(imp2)

# Model 3: inclusion of additional derived variables

# define derived variables for IN1
derived_vars &lt;- list( "IN1"=~I( ifelse( IN2&gt;IN3, IN2, IN3 ) ) + I( sin(IN2) ) )

imp3 &lt;- miceadds::mice.1chain(data=dat, method=impMethod, derived_vars=derived_vars,
     burnin=10, iter=21, Nimp=3, predictorMatrix=predictorMatrix,
     pls.facs=pls.facs, pls.impMethod=pls.impMethod,
     pls.impMethodArgs=pls.impMethodArgs, ls.meth="ridge" )
summary(imp3)

#*** example for using imputation function at the level of a variable

# extract first imputed dataset
imp1 &lt;- mice::complete(imp1, action=1)
data_imp1[ is.na(dat$IN1), "IN1" ] &lt;- NA

# define variables
y &lt;- data_imp1$IN1
x &lt;- data_imp1[, -1 ]
ry &lt;- ! is.na(y)
cn &lt;- colnames(dat)
p &lt;- ncol(dat)
type &lt;- rep(1,p)
names(type) &lt;- cn
type["IN1"] &lt;- 0

# imputation of variable 'IN1'
imp0 &lt;- miceadds::mice.impute.pls(y=y, x=x, ry=ry, type=type, pls.facs=10, pls.impMethod="norm",
             ls.meth="ridge", extract_data=FALSE )

## End(Not run)
</code></pre>


</div>