<div class="container">

<table style="width: 100%;"><tr>
<td>mice.impute.plausible.values</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Plausible Value Imputation using Classical Test Theory and
Based on Individual Likelihood
</h2>

<h3>Description</h3>

<p>This imputation function performs unidimensional plausible value
imputation if (subject-wise) measurement errors or the reliability
of the scale is known (Mislevy, 1991; see also Asparouhov &amp; Muthen, 2010;
Blackwell, Honaker &amp; King, 2011, 2017a, 2017b).
The function also allows the input of an individual likelihood
obtained by fitting an item response model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mice.impute.plausible.values(y, ry, x, type, alpha=NULL,
    alpha.se=0, scale.values=NULL, sig.e.miss=1e+06,
    like=NULL, theta=NULL, normal.approx=NULL,
    pviter=15, imputationWeights=rep(1, length(y)), plausible.value.print=TRUE,
    pls.facs=NULL, interactions=NULL, quadratics=NULL, extract_data=TRUE,
    control_latreg=list( progress=FALSE, ridge=1e-5 ),  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>Incomplete data vector of length <code>n</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ry</code></td>
<td>

<p>Vector of missing data pattern (<code>FALSE</code> – missing,
<code>TRUE</code> – observed)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>Matrix (<code>n</code> <code class="reqn">\times</code> <code>p</code>) of complete covariates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>Type of predictor variables. <code>type=3</code> refers to items belonging to
a scale to be imputed. A cluster (grouping) variable is defined by
<code>type=-2</code>. If for some predictors, the cluster means should also
be included as predictors, then specify <code>type=2</code> (see Imputation
Model 3 of Example 1).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>A known reliability estimate. An optional standard error of the estimate
can be provided in <code>alpha.se</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha.se</code></td>
<td>

<p>Optional numeric value of the standard error of the <code>alpha</code>
reliability estimate if in every iteration a new reliability
should be sampled.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.values</code></td>
<td>

<p>A list consisting of scale values of scale values and its
corresponding standard errors (see Example 1).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig.e.miss</code></td>
<td>

<p>A standard error of measurement for cases with missing values on a scale
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>like</code></td>
<td>
<p>Individual likelihood evaluated at <code>theta</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>Grid of unidimensional latent variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normal.approx</code></td>
<td>
<p>Logical indicating whether the
individual posterior should be approximated by a normal distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pviter</code></td>
<td>

<p>Number of iterations in each imputation which should be run until the
plausible values are drawn
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>imputationWeights</code></td>
<td>

<p>Optional vector of sample weights
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plausible.value.print</code></td>
<td>

<p>An optional logical indicating whether some information about the
plausible value imputation should be printed at the console
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pls.facs</code></td>
<td>

<p>Number of PLS factors if PLS dimension reduction is used
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interactions</code></td>
<td>

<p>Vector of variable names used for creating interactions
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quadratics</code></td>
<td>

<p>Vector of variable names used for creating quadratic terms
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extract_data</code></td>
<td>
<p>Logical indicating whether input data should be extracted
from parent environment within <code>mice::mice</code> routine</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control_latreg</code></td>
<td>
<p>Control arguments for <code>TAM::tam.latreg</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Further objects to be passed
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The linear model is assumed for drawing plausible values of a variable
<code class="reqn">Y</code> contaminated by measurement error. Assuming <code class="reqn">Y=\theta + e</code>
and a linear regression model for <code class="reqn">\theta</code>
</p>
<p style="text-align: center;"><code class="reqn"> \theta=\bold{X} \beta + \epsilon</code>
</p>

<p>(plausible value) imputations from the posterior distribution
<code class="reqn">P( \theta | Y, \bold{X} )</code> are drawn. See Mislevy (1991) for details.
</p>


<h3>Value</h3>

<p>A vector of length <code>nrow(x)</code> containing imputed plausible values.
</p>


<h3>Note</h3>

<p>Plausible value imputation is also known as multiple overimputation
(Blackwell, Honaker &amp; King, 2016a, 2016b) which is implemented
in the <span class="pkg">Amelia</span> package, see <code>Amelia::moPrep</code>
and <code>Amelia::amelia</code>.
</p>


<h3>References</h3>

<p>Asparouhov, T., &amp; Muthen, B. (2010). <em>Plausible values for latent variables
using Mplus</em>. Technical Report. <a href="https://www.statmodel.com/papers.shtml">https://www.statmodel.com/papers.shtml</a>
</p>
<p>Blackwell, M., Honaker, J., &amp; King, G. (2011).
<em>Multiple overimputation: A unified approach to measurement error and
missing data</em>. Technical Report.
</p>
<p>Blackwell, M., Honaker, J., &amp; King, G. (2017a).
A unified approach to measurement error and missing data: Overview and
applications. <em>Sociological Methods &amp; Research, 46</em>(3), 303-341.
</p>
<p>Blackwell, M., Honaker, J., &amp; King, G. (2017b).
A unified approach to measurement error and missing data: Details and
extensions. <em>Sociological Methods &amp; Research, 46</em>(3), 342-369.
</p>
<p>Mislevy, R. J. (1991). Randomization-based inference about latent variables
from complex samples. <em>Psychometrika, 56</em>, 177-196.
</p>


<h3>See Also</h3>

<p>See <code>TAM::tam.latreg</code> for fitting latent regression
models.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
#############################################################################
# EXAMPLE 1: Plausible value imputation for data.ma04 | 2 scales
#############################################################################

data(data.ma04, package="miceadds")
dat &lt;- data.ma04

# Scale 1 consists of items A1,...,A4
# Scale 2 consists of items B1,...,B5
dat$scale1 &lt;- NA
dat$scale2 &lt;- NA

#** inits imputation method and predictor matrix
res &lt;- miceadds::mice_inits(dat, ignore=c("group") )
predM &lt;- res$predictorMatrix
impMethod &lt;- res$method
impMethod &lt;- gsub("pmm", "norm", impMethod )

# look at missing proportions
colSums( is.na(dat) )

# redefine imputation methods for plausible value imputation
impMethod[ "scale1" ] &lt;- "plausible.values"
predM[ "scale1",  ] &lt;- 1
predM[ "scale1", c("A1", "A2",  "A3", "A4" ) ] &lt;- 3
    # items corresponding to a scale should be declared by a 3 in the predictor matrix
impMethod[ "scale2" ] &lt;- "plausible.values"
predM[,"scale2"  ] &lt;- 0
predM[ "scale2",  c("A2","A3","A4","V6","V7") ] &lt;- 1
diag(predM) &lt;- 0

# use imputed scale values as predictors for V5, V6 and V7
predM[ c("V5","V6","V7"), c("scale1","scale2" ) ] &lt;- 1
# exclude for V5, V6 and V7 the items of scales A and B as predictors
predM[ c("V5","V6","V7"), c( paste0("A",2:4), paste0("B",1:5) ) ] &lt;- 0
# exclude 'group' as a predictor
predM[,"group"] &lt;- 0

# look at imputation method and predictor matrix
impMethod
predM

#-------------------------------
# Parameter for imputation
#***
# scale 1 (A1,...,A4)
# known Cronbach's Alpha
alpha &lt;- NULL
alpha &lt;- list( "scale1"=.8 )
alpha.se &lt;- list( "scale1"=.05 )  # sample alpha with a standard deviation of .05

#***
# scale 2 (B1,...,B5)
# means and SE's of scale scores are assumed to be known
M.scale2 &lt;- rowMeans( dat[, paste("B",1:5,sep="")  ] )
# M.scale2[ is.na( m1) ] &lt;- mean( M.scale2, na.rm=TRUE )
SE.scale2 &lt;- rep( sqrt( stats::var(M.scale2,na.rm=T)*(1-.8) ), nrow(dat) )
#=&gt; heterogeneous measurement errors are allowed
scale.values &lt;- list( "scale2"=list( "M"=M.scale2, "SE"=SE.scale2 ) )

#*** Imputation Model 1: Imputation four using parallel chains
imp1 &lt;- mice::mice( dat, predictorMatrix=predM, m=4, maxit=5,
          alpha.se=alpha.se, method=impMethod,  allow.na=TRUE, alpha=alpha,
          scale.values=scale.values  )
summary(imp1)

# extract first imputed dataset
dat11 &lt;- mice::complete( imp, 1 )

#*** Imputation Model 2: Imputation using one long chain
imp2 &lt;- miceadds::mice.1chain( dat, predictorMatrix=predM, burnin=10, iter=20, Nimp=4,
          alpha.se=alpha.se, method=impMethod,  allow.na=TRUE, alpha=alpha,
          scale.values=scale.values )
summary(imp2)

#-------------
#*** Imputation Model 3: Imputation including  group level variables

# use group indicator for plausible value estimation
predM[ "scale1", "group" ] &lt;- -2
# V7 and B1 should be aggregated at the group level
predM[ "scale1", c("V7","B1") ] &lt;- 2
predM[ "scale2", "group" ] &lt;- -2
predM[ "scale2", c("V7","A1") ] &lt;- 2

# perform single imputation (m=1)
imp &lt;- mice::mice( dat, predictorMatrix=predM, m=1, maxit=10,
            method=impMethod,  allow.na=TRUE, alpha=alpha,
            scale.values=scale.values )
dat10 &lt;- mice::complete(imp)

# multilevel model
library(lme4)
mod &lt;- lme4::lmer( scale1 ~ ( 1 | group), data=dat11 )
summary(mod)

mod &lt;- lme4::lmer( scale1 ~ ( 1 | group), data=dat10)
summary(mod)

#############################################################################
# EXAMPLE 2: Plausible value imputation with chained equations
#############################################################################

# - simulate a latent variable theta and dichotomous item responses
# - two covariates X in which the second covariate has measurement error

library(sirt)
library(TAM)
library(lavaan)

set.seed(7756)
N &lt;- 2000    # number of persons
I &lt;- 10     # number of items

# simulate covariates
X &lt;- MASS::mvrnorm( N, mu=c(0,0), Sigma=matrix( c(1,.5,.5,1),2,2 ) )
colnames(X) &lt;- paste0("X",1:2)
# second covariate with measurement error with variance var.err
var.err &lt;- .3
X.err &lt;- X
X.err[,2] &lt;- X[,2] + stats::rnorm(N, sd=sqrt(var.err) )
# simulate theta
theta &lt;- .5*X[,1] + .4*X[,2] + stats::rnorm( N, sd=.5 )
# simulate item responses
itemdiff &lt;- seq( -2, 2, length=I)  # item difficulties
dat &lt;- sirt::sim.raschtype( theta, b=itemdiff )

#***********************
#*** Model 0: Regression model with true variables
mod0 &lt;- stats::lm( theta ~ X )
summary(mod0)

#**********************
# plausible value imputation for abilities and error-prone
# covariates using the mice package

# creating the likelihood for plausible value for abilities
mod11 &lt;- TAM::tam.mml( dat )
likePV &lt;- IRT.likelihood(mod11)
# creating the likelihood for error-prone covariate X2
# The known measurement error variance is 0.3.
lavmodel &lt;- "
  X2true=~ 1*X2
  X2 ~~ 0.3*X2
    "
mod12 &lt;- lavaan::cfa( lavmodel, data=as.data.frame(X.err) )
summary(mod12)
likeX2 &lt;- IRTLikelihood.cfa( data=X.err, cfaobj=mod12)
str(likeX2)

#-- create data input for mice package
data &lt;- data.frame( "PVA"=NA, "X1"=X[,1], "X2"=NA  )
vars &lt;- colnames(data)
V &lt;- length(vars)
predictorMatrix &lt;- 1 - diag(V)
rownames(predictorMatrix) &lt;- colnames(predictorMatrix) &lt;- vars
method &lt;- rep("norm", V )
names(method) &lt;- vars
method[c("PVA","X2")] &lt;- "plausible.values"

#-- create argument lists for plausible value imputation
# likelihood and theta grid of plausible value derived from IRT model
like &lt;- list( "PVA"=likePV, "X2"=likeX2 )
theta &lt;- list( "PVA"=attr(likePV,"theta"),
                "X2"=attr(likeX2, "theta") )
#-- initial imputations
data.init &lt;- data
data.init$PVA &lt;- mod11$person$EAP
data.init$X2 &lt;- X.err[,"X2"]

#-- imputation using the mice and miceadds package
imp1 &lt;- mice::mice( as.matrix(data), predictorMatrix=predictorMatrix, m=4,
            maxit=6, method=method,  allow.na=TRUE,
            theta=theta, like=like, data.init=data.init )
summary(imp1)

# compute linear regression
mod4a &lt;- with( imp1, stats::lm( PVA ~ X1 + X2 ) )
summary( mice::pool(mod4a) )

#############################################################################
# EXAMPLE 3: Plausible value imputation with known error variance
#############################################################################

#---- simulate data
set.seed(987)
N &lt;- 1000         # number of persons
var_err &lt;- .4     # error variance
dat &lt;- data.frame( x1=stats::rnorm(N), x2=stats::rnorm(N) )
dat$theta &lt;- .3 * dat$x1 - .5*dat$x2 + stats::rnorm(N)
dat$y &lt;- dat$theta + stats::rnorm( N, sd=sqrt(var_err) )

#-- linear regression for measurement-error-free data
mod0a &lt;- stats::lm( theta ~ x1 + x2, data=dat )
summary(mod0a)
#-- linear regression for data with measurement error
mod0b &lt;- stats::lm( y ~ x1 + x2, data=dat )
summary(mod0b)

#-- process data for imputation

dat1 &lt;- dat
dat1$theta &lt;- NA
scale.values &lt;- list( "theta"=list( "M"=dat$y, "SE"=rep(sqrt(var_err),N )))
dat1$y &lt;- NULL

cn &lt;- colnames(dat1)
V &lt;- length(cn)
method &lt;- rep("", length(cn) )
names(method) &lt;- cn
method["theta"] &lt;- "plausible.values"

#-- imputation in mice
imp &lt;- mice::mice( dat1, maxit=1, m=5, allow.na=TRUE, method=method,
            scale.values=scale.values )
summary(imp)

#-- inspect first dataset
summary( mice::complete(imp, action=1) )

#-- linear regression based on imputed datasets
mod1 &lt;- with(imp, stats::lm( theta ~ x1 + x2 ) )
summary( mice::pool(mod1) )

## End(Not run)
</code></pre>


</div>