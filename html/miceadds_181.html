<div class="container">

<table style="width: 100%;"><tr>
<td>nnig_sim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simulation of Multivariate Linearly Related Non-Normal Variables
</h2>

<h3>Description</h3>

<p>Simulates multivariate linearly related non-normally distributed variables
(Foldnes &amp; Olsson, 2016). For marginal distributions, skewness and (excess) kurtosis
values are provided and the values are simulated according to the Fleishman
power transformation (Fleishman, 1978; see <code>fleishman_sim</code>).
</p>
<p>The function <code>nnig_sim</code> simulates data from a multivariate random variable
<code class="reqn">\bold{Y}</code> which is related to a number of independent variables <code class="reqn">\bold{X}</code>
(independent generators; Foldnes &amp; Olsson, 2016)
which are Fleishman power normally distributed. In detail, it holds that
<code class="reqn">\bold{Y}=\bold{\mu} + \bold{A} \bold{X}</code> where the covariance matrix
<code class="reqn">\bold{\Sigma}</code> is decomposed according to a Cholesky decomposition
<code class="reqn">\bold{\Sigma}=\bold{A} \bold{A}^T</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R"># determine coefficients
nnig_coef(mean=NULL, Sigma, skew, kurt)

# simulate values
nnig_sim(N, coef)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>

<p>Vector of means. The default is a vector containing zero means.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>

<p>Covariance matrix
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skew</code></td>
<td>

<p>Vector of skewness values
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kurt</code></td>
<td>

<p>Vector of (excess) kurtosis values
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Number of cases</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>
<p>List of parameters generated by <code>nnig_coef</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of parameter values (<code>nnig_coef</code>) or a data frame with
simulated values (<code>nnig_sim</code>).
</p>


<h3>References</h3>

<p>Fleishman, A. I. (1978). A method for simulating non-normal distributions.
<em>Psychometrika, 43</em>(4), 521-532.
<a href="https://doi.org/10.1007/BF02293811">doi:10.1007/BF02293811</a>
</p>
<p>Foldnes, N., &amp; Olsson, U. H. (2016). A simple simulation technique for nonnormal data
with prespecified skewness, kurtosis, and covariance matrix.
<em>Multivariate Behavioral Research, 51</em>(2-3), 207-219.
<a href="https://doi.org/10.1080/00273171.2015.1133274">doi:10.1080/00273171.2015.1133274</a>
</p>
<p>Vale, D. C., &amp; Maurelli, V. A. (1983). Simulating multivariate nonnormal distributions.
<em>Psychometrika, 48</em>(3), 465-471.
<a href="https://doi.org/10.1007/BF02293687">doi:10.1007/BF02293687</a>
</p>


<h3>See Also</h3>

<p>See <code>fungible::monte1</code> for simulating multivariate linearly related
non-normally distributed variables generated by the method of Vale and Morelli (1983).
See also the <code>MultiVarMI::MVNcorr</code> function in the <b>MultiVarMI</b> package
and the <b>SimMultiCorrData</b> package.
</p>
<p>The <b>MultiVarMI</b> also includes an imputation function <code>MultiVarMI::MI</code>
for non-normally distributed variables.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
#############################################################################
# EXAMPLE 1: Simulating data with nnig_sim function
#############################################################################

#* define input parameters
Sigma &lt;- matrix( c(1,.5, .2,
                  .5, 1,.7,
                  .2, .7, 1), 3, 3 )
skew &lt;- c(0,1,1)
kurt &lt;- c(1,3,3)

#* determine coefficients
coeff &lt;- miceadds::nnig_coef( Sigma=Sigma, skew=skew, kurt=kurt )
print(coeff)

#* simulate data
set.seed(2018)
Y &lt;- miceadds::nnig_sim( N=2000, coef=coeff)

#* check descriptive statistics
apply(Y, 2, TAM::weighted_skewness )
apply(Y, 2, TAM::weighted_kurtosis )

## End(Not run)
</code></pre>


</div>