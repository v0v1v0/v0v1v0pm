<div class="container">

<table style="width: 100%;"><tr>
<td>mice.1chain</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Multiple Imputation by Chained Equations using One Chain
</h2>

<h3>Description</h3>

<p>This function modifies the <code>mice::mice</code> function to
multiply impute a dataset using a long chain instead of multiple parallel chains
which is the approach employed in <code>mice::mice</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mice.1chain(data, burnin=10, iter=20, Nimp=10, method=NULL,
     where=NULL, visitSequence=NULL, blots=NULL, post=NULL,
     defaultMethod=c("pmm", "logreg", "polyreg", "polr"),
     printFlag=TRUE, seed=NA, data.init=NULL, ...)

## S3 method for class 'mids.1chain'
summary(object,...)

## S3 method for class 'mids.1chain'
print(x, ...)

## S3 method for class 'mids.1chain'
plot(x, plot.burnin=FALSE, ask=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>Numeric matrix
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>

<p>Number of burn-in iterations
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>

<p>Total number of imputations (larger than <code>burnin</code>)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nimp</code></td>
<td>

<p>Number of imputations
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>See <code>mice::mice</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>where</code></td>
<td>

<p>See <code>mice::mice</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>visitSequence</code></td>
<td>

<p>See <code>mice::mice</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blots</code></td>
<td>

<p>See <code>mice::mice</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>post</code></td>
<td>

<p>See <code>mice::mice</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>defaultMethod</code></td>
<td>

<p>See <code>mice::mice</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>printFlag</code></td>
<td>

<p>See <code>mice::mice</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>

<p>See <code>mice::mice</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.init</code></td>
<td>

<p>See <code>mice::mice</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>Object of class <code>mids.1chain</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Object of class <code>mids.1chain</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.burnin</code></td>
<td>
<p>An optional logical indicating whether burnin iterations
should be included in the traceplot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ask</code></td>
<td>
<p>An optional logical indicating a user request for viewing next plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>See <code>mice::mice</code>
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with following entries
</p>
<table>
<tr style="vertical-align: top;">
<td><code>midsobj</code></td>
<td>
<p>Objects of class <code>mids</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datlist</code></td>
<td>
<p>List of multiply imputed datasets</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datalong</code></td>
<td>
<p>Original and imputed dataset in the long format</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>implist</code></td>
<td>
<p>List of <code>mids</code> objects for every imputation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chainMpar</code></td>
<td>
<p>Trace of means for all imputed variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chainVarpar</code></td>
<td>
<p>Trace of variances for all imputed variables</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Multiple imputation can also be used for determining causal effects
(see Example 3; Schafer &amp; Kang, 2008).
</p>


<h3>See Also</h3>

<p><code>mice::mice</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 

#############################################################################
# EXAMPLE 1: One chain nhanes data
#############################################################################

library(mice)
data(nhanes, package="mice")
set.seed(9090)

# nhanes data in one chain
imp.mi1 &lt;- miceadds::mice.1chain( nhanes, burnin=5, iter=40, Nimp=4,
                 method=rep("norm", 4 ) )
summary(imp.mi1)       # summary of mids.1chain
plot( imp.mi1 ) # trace plot excluding burnin iterations
plot( imp.mi1, plot.burnin=TRUE ) # trace plot including burnin iterations

# select mids object
imp.mi2 &lt;- imp.mi1$midsobj
summary(imp.mi2)    # summary of mids

# apply mice functionality lm.mids
mod &lt;- with( imp.mi2, stats::lm( bmi ~ age ) )
summary( mice::pool( mod ) )

#############################################################################
# EXAMPLE 2: One chain (mixed data: numeric and factor)
#############################################################################

library(mice)
data(nhanes2, package="mice")
set.seed(9090)

# nhanes2 data in one chain
imp.mi1 &lt;- miceadds::mice.1chain( nhanes2, burnin=5, iter=25, Nimp=5 )
# summary
summary( imp.mi1$midsobj )

#############################################################################
# EXAMPLE 3: Multiple imputation with counterfactuals for estimating
#            causal effects (average treatment effects)
# Schafer, J. L., &amp; Kang, J. (2008). Average causal effects from nonrandomized
#    studies: a practical guide and simulated example.
#    Psychological Methods, 13, 279-313.
#############################################################################

data(data.ma01)
dat &lt;- data.ma01[, 4:11]

# define counterfactuals for reading score for students with and
# without migrational background
dat$read.migrant1 &lt;- ifelse( paste(dat$migrant)==1, dat$read, NA )
dat$read.migrant0 &lt;- ifelse( paste(dat$migrant)==0, dat$read, NA )

# define imputation method
impmethod &lt;- rep("pls", ncol(dat) )
names(impmethod) &lt;- colnames(dat)

# define predictor matrix
pm &lt;- 4*(1 - diag( ncol(dat) ) )    # 4 - use all interactions
rownames(pm) &lt;- colnames(pm) &lt;- colnames(dat)
pm[ c( "read.migrant0", "read.migrant1"), ] &lt;- 0
# do not use counterfactuals for 'read' as a predictor
pm[, "read.migrant0"] &lt;- 0
pm[, "read.migrant1"] &lt;- 0
# define control variables for creation of counterfactuals
pm[ c( "read.migrant0", "read.migrant1"), c("hisei","paredu","female","books") ] &lt;- 4
  ##   &gt; pm
  ##                 math read migrant books hisei paredu female urban read.migrant1 read.migrant0
  ##   math             0    4       4     4     4      4      4     4             0             0
  ##   read             4    0       4     4     4      4      4     4             0             0
  ##   migrant          4    4       0     4     4      4      4     4             0             0
  ##   books            4    4       4     0     4      4      4     4             0             0
  ##   hisei            4    4       4     4     0      4      4     4             0             0
  ##   paredu           4    4       4     4     4      0      4     4             0             0
  ##   female           4    4       4     4     4      4      0     4             0             0
  ##   urban            4    4       4     4     4      4      4     0             0             0
  ##   read.migrant1    0    0       0     4     4      4      4     0             0             0
  ##   read.migrant0    0    0       0     4     4      4      4     0             0             0

# imputation using mice function and PLS imputation with
# predictive mean matching method 'pmm6'
imp &lt;- mice::mice( dat, method=impmethod, predictorMatrix=pm,
            maxit=4, m=5, pls.impMethod="pmm5" )

#*** Model 1: Raw score difference
mod1 &lt;- with( imp, stats::lm( read ~ migrant ) )
smod1 &lt;- summary( mice::pool(mod1) )
  ##   &gt; smod1
  ##                  est    se      t     df Pr(&gt;|t|)  lo 95  hi 95 nmis    fmi lambda
  ##   (Intercept) 510.21 1.460 349.37 358.26        0 507.34 513.09   NA 0.1053 0.1004
  ##   migrant     -43.38 3.757 -11.55  62.78        0 -50.89 -35.87  404 0.2726 0.2498

#*** Model 2: ANCOVA - regression adjustment
mod2 &lt;- with( imp, stats::lm( read ~ migrant + hisei + paredu + female + books) )
smod2 &lt;- summary( mice::pool(mod2) )
  ##   &gt; smod2
  ##                    est      se      t      df  Pr(&gt;|t|)    lo 95   hi 95 nmis      fmi   lambda
  ##   (Intercept) 385.1506 4.12027 93.477 3778.66 0.000e+00 377.0725 393.229   NA 0.008678 0.008153
  ##   migrant     -29.1899 3.30263 -8.838   87.46 9.237e-14 -35.7537 -22.626  404 0.228363 0.210917
  ##   hisei         0.9401 0.08749 10.745  160.51 0.000e+00   0.7673   1.113  733 0.164478 0.154132
  ##   paredu        2.9305 0.79081  3.706   41.34 6.190e-04   1.3338   4.527  672 0.339961 0.308780
  ##   female       38.1719 2.26499 16.853 1531.31 0.000e+00  33.7291  42.615    0 0.041093 0.039841
  ##   books        14.0113 0.88953 15.751  154.71 0.000e+00  12.2541  15.768  423 0.167812 0.157123

#*** Model 3a: Estimation using counterfactuals
mod3a &lt;- with( imp, stats::lm( I( read.migrant1 - read.migrant0) ~ 1 ) )
smod3a &lt;- summary( mice::pool(mod3a) )
  ##   &gt; smod3a
  ##                  est    se      t    df Pr(&gt;|t|)  lo 95  hi 95 nmis    fmi lambda
  ##   (Intercept) -22.54 7.498 -3.007 4.315  0.03602 -42.77 -2.311   NA 0.9652 0.9521

#*** Model 3b: Like Model 3a but using student weights
mod3b &lt;- with( imp, stats::lm( I( read.migrant1 - read.migrant0) ~ 1,
                        weights=data.ma01$studwgt ) )
smod3b &lt;- summary( mice::pool(mod3b) )
  ##   &gt; smod3b
  ##                  est    se      t  df Pr(&gt;|t|)  lo 95  hi 95 nmis    fmi lambda
  ##   (Intercept) -21.88 7.605 -2.877 4.3  0.04142 -42.43 -1.336   NA 0.9662 0.9535

#*** Model 4: Average treatment effect on the treated (ATT, migrants)
#             and non-treated (ATN, non-migrants)
mod4 &lt;- with( imp, stats::lm( I( read.migrant1 - read.migrant0) ~ 0 + as.factor( migrant) )   )
smod4 &lt;- summary( mice::pool(mod4) )
  ##   &gt; smod4
  ##                          est    se      t    df Pr(&gt;|t|)  lo 95   hi 95 nmis    fmi lambda
  ##   as.factor(migrant)0 -23.13 8.664 -2.669  4.27 0.052182 -46.59  0.3416   NA 0.9682 0.9562
  ##   as.factor(migrant)1 -19.95 5.198 -3.837 19.57 0.001063 -30.81 -9.0884   NA 0.4988 0.4501
# ATN=-23.13 and ATT=-19.95

## End(Not run)
</code></pre>


</div>