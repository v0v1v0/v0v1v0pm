<div class="container">

<table style="width: 100%;"><tr>
<td>write.pspp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Writing a Data Frame into SPSS Format Using PSPP Software
</h2>

<h3>Description</h3>

<p>Writes a data frame into SPSS format using the <em>PSPP</em> software.
To use this function, download and install PSPP at first:
<a href="http://www.gnu.org/software/pspp/pspp.html">http://www.gnu.org/software/pspp/pspp.html</a>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">write.pspp(data, datafile, pspp.path, decmax=6,
   as.factors=TRUE, use.bat=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>Data frame
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datafile</code></td>
<td>

<p>Name of the output file (without file ending)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pspp.path</code></td>
<td>

<p>Path where the PSPP executable is located, e.g.
<code>"C:/Program Files (x86)/PSPP/bin/"</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>decmax</code></td>
<td>

<p>Maximum number of digits after decimal
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as.factors</code></td>
<td>
<p>A logical indicating whether all factors and string entries
should be treated as factors in the output file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.bat</code></td>
<td>
<p>A logical indicating whether PSPP executed via a batch file in
the DOS mode (<code>TRUE</code>) or directly invoked via the <code>system</code> command
from within <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> (<code>FALSE</code>).
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A dataset in <em>sav</em> format (SPSS format).
</p>


<h3>Author(s)</h3>

<p>The code was adapted from
<a href="https://stat.ethz.ch/pipermail/r-help/2006-January/085941.html">https://stat.ethz.ch/pipermail/r-help/2006-January/085941.html</a>
</p>


<h3>See Also</h3>

<p>See also <code>foreign::write.foreign</code>.
</p>
<p>For writing sav files see also <code>haven::write_sav</code>
and  <code>sjlabelled::write_spss</code>.
</p>
<p>For convenient viewing <em>sav</em> files we recommend the freeware
program <em>ViewSav</em>, see <a href="http://www.asselberghs.dds.nl/stuff.htm">http://www.asselberghs.dds.nl/stuff.htm</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
#############################################################################
# EXAMPLE 1: Write a data frame into SPSS format
#############################################################################

#****
# (1) define data frame
data &lt;- data.frame( "pid"=1000+1:5, "height"=round(rnorm( 5 ),4),
                "y"=10*c(1,1,1,2,2), "r2"=round( rnorm(5),2),
                "land"=as.factor( c( rep("A",1), rep("B", 4 ) ) ) )
#****
# (2) define variable labels
v1 &lt;- rep( "", ncol(data) )
names(v1) &lt;-  colnames(data)
attr( data, "variable.labels" ) &lt;- v1
attr(data,"variable.labels")["pid"] &lt;- "Person ID"
attr(data,"variable.labels")["height"] &lt;- "Height of a person"
attr(data,"variable.labels")["y"] &lt;- "Gender"

#****
# (3) define some value labels
v1 &lt;- c(10,20)
names(v1) &lt;- c("male", "female" )
attr( data$y, "value.labels" ) &lt;- v1

#****
# (4a) run PSPP to produce a sav file
write.pspp( data, datafile="example_data1",
        pspp.path="C:/Program Files (x86)/PSPP/bin/" )

#****
# (4b) produce strings instead of factors
write.pspp( data, datafile="example_data2",
        pspp.path="C:/Program Files (x86)/PSPP/bin/", as.factors=FALSE )

#****
# write sav file using haven package
library(haven)
haven::write_sav( data, "example_data1a.sav" )

#****
# write sav file using sjlabelled package
library(sjlabelled)
data &lt;- sjlabelled::set_label( data, attr(data, "variable.labels") )
sjlabelled::write_spss( data, "example_data1b.sav" )

## End(Not run)
</code></pre>


</div>