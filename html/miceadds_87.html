<div class="container">

<table style="width: 100%;"><tr>
<td>ma.wtd.statNA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Some Multivariate Descriptive Statistics for Weighted Data in <span class="pkg">miceadds</span>
</h2>

<h3>Description</h3>

<p>Some multivariate descriptive statistics for weighted datasets in <span class="pkg">miceadds</span>.
A list of (nested) multiply imputed data sets is also allowed as input.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ma.wtd.meanNA(data, weights=NULL, vars=NULL )

ma.wtd.sdNA(data, weights=NULL, vars=NULL, method="unbiased" )

ma.wtd.covNA(data, weights=NULL, vars=NULL, method="unbiased" )

ma.wtd.corNA(data, weights=NULL, vars=NULL, method="unbiased" )

ma.wtd.skewnessNA(data, weights=NULL, vars=NULL, method="unbiased" )

ma.wtd.kurtosisNA(data, weights=NULL, vars=NULL, method="unbiased" )

ma.wtd.quantileNA( data, weights=NULL, vars=NULL, type=7,
          probs=seq(0,1,.25) )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>Numeric data vector or data frame or objects of one of the
classes <code>datlist</code>,
<code>imputationList</code>, <code>mids</code>, <code>mids.1chain</code>,
<code>nested.datlist</code>,
<code>NestedImputationList</code> or <code>BIFIEdata</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>

<p>Optional vector of sampling weights
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vars</code></td>
<td>
<p>Optional vector of variable names</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Computation method for covariances. These amount to
choosing the divisor <code class="reqn">(n-1)</code> (<code>method="unbiased"</code>)
instead of <code class="reqn">n</code> (<code>method="ML"</code>). See
<code>stats::cov.wt</code> for further details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Quantile type. This specification follows
<code>TAM::weighted_quantile</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>
<p>Vector of probabilities used for calculation of quantiles.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Contrary to ordinary <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> practice, missing values are ignored in the
calculation of descriptive statistics.
</p>

<table>
<tr>
<td style="text-align: left;">
<code>ma.wtd.meanNA</code> </td>
<td style="text-align: left;"> weighted means </td>
</tr>
<tr>
<td style="text-align: left;">
<code>ma.wtd.sdNA</code> </td>
<td style="text-align: left;"> weighted standard deviations </td>
</tr>
<tr>
<td style="text-align: left;">
<code>ma.wtd.covNA</code> </td>
<td style="text-align: left;"> weighted covariance matrix </td>
</tr>
<tr>
<td style="text-align: left;">
<code>ma.wtd.corNA</code> </td>
<td style="text-align: left;"> weighted correlation matrix </td>
</tr>
<tr>
<td style="text-align: left;">
<code>ma.wtd.skewnessNA</code> </td>
<td style="text-align: left;"> weighted skewness </td>
</tr>
<tr>
<td style="text-align: left;">
<code>ma.wtd.kurtosisNA</code> </td>
<td style="text-align: left;"> weighted (excess) kurtosis </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>Value</h3>

<p>A vector or a matrix depending on the requested statistic.
</p>


<h3>Note</h3>

<p>If <code>data</code> is of class <code>BIFIEdata</code> and no weights are
specified, sample weights are extracted from the <code>BIFIEdata</code>
object.
</p>


<h3>See Also</h3>

<p>Some functions for weighted statistics:
<code>stats::weighted.mean</code>,
<code>stats::cov.wt</code>,
<code>{Hmisc::wtd.var}</code>,
<code>TAM::weighted_quantile</code>, ...
</p>
<p>See <code>micombine.cor</code> for statistical inference of correlation
coefficients.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#############################################################################
# EXAMPLE 1: Weighted statistics for a single dataset data.ma01
#############################################################################

data(data.ma01)
dat &lt;- as.matrix(data.ma01[,-c(1:3)])

# weighted mean
ma.wtd.meanNA( dat, weights=data.ma01$studwgt )

# weighted SD
ma.wtd.sdNA( dat, weights=data.ma01$studwgt )

# weighted covariance for selected variables
ma.wtd.covNA( dat, weights=data.ma01$studwgt, vars=c("books","hisei") )

# weighted correlation
ma.wtd.corNA( dat, weights=data.ma01$studwgt )

## Not run: 
# weighted skewness
ma.wtd.skewnessNA( dat[,"books"], weights=data.ma01$studwgt )
# compare with result in TAM
TAM::weighted_skewness( x=dat[,"books"], w=data.ma01$studwgt )

# weighted kurtosis
ma.wtd.kurtosisNA( dat, weights=data.ma01$studwgt, vars=c("books","hisei") )
# compare with TAM
TAM::weighted_kurtosis( dat[,"books"], w=data.ma01$studwgt )
TAM::weighted_kurtosis( dat[,"hisei"], w=data.ma01$studwgt )

#############################################################################
# EXAMPLE 2: Weighted statistics multiply imputed dataset
#############################################################################

library(mitools)
data(data.ma05)
dat &lt;- data.ma05

# do imputations
resp &lt;- dat[, - c(1:2) ]
# object of class mids
imp &lt;- mice::mice( resp, method="norm", maxit=3, m=5 )
# object of class datlist
datlist &lt;- miceadds::mids2datlist( imp )
# object of class imputationList
implist &lt;- mitools::imputationList(datlist)

# weighted means
ma.wtd.meanNA(datlist)
ma.wtd.meanNA(implist)
ma.wtd.meanNA(imp)

# weighted quantiles
ma.wtd.quantileNA( implist, weights=data.ma05$studwgt, vars=c("manote","Dscore"))

#############################################################################
# EXAMPLE 3: Weighted statistics nested multiply imputed dataset
#############################################################################

library(BIFIEsurvey)
data(data.timss2, package="BIFIEsurvey" )
datlist &lt;- data.timss2   # list of 5 datasets containing 5 plausible values

#** define imputation method and predictor matrix
data &lt;- datlist[[1]]
V &lt;- ncol(data)
# variables
vars &lt;- colnames(data)
# variables not used for imputation
vars_unused &lt;- miceadds::scan.vec("IDSTUD TOTWGT  JKZONE  JKREP" )
#- define imputation method
impMethod &lt;- rep("norm", V )
names(impMethod) &lt;- vars
impMethod[ vars_unused ] &lt;- ""
#- define predictor matrix
predM &lt;- matrix( 1, V, V )
colnames(predM) &lt;- rownames(predM) &lt;- vars
diag(predM) &lt;- 0
predM[, vars_unused ] &lt;- 0

# object of class mids.nmi
imp1 &lt;- miceadds::mice.nmi( datlist, method=impMethod, predictorMatrix=predM,
                m=4, maxit=3 )
# object of class nested.datlist
datlist &lt;- miceadds::mids2datlist(imp1)
# object of class NestedImputationList
imp2 &lt;- miceadds::NestedImputationList(datlist)

# weighted correlations
vars &lt;- c("books","ASMMAT","likesc")
ma.wtd.corNA( datlist,  vars=vars )
ma.wtd.corNA( imp2,  vars=vars )
ma.wtd.corNA( imp1,  vars=vars )

#############################################################################
# EXAMPLE 4: Multiply imputed datasets in BIFIEdata format
#############################################################################

library(BIFIEsurvey)
data(data.timss1, package="BIFIEsurvey")
data(data.timssrep, package="BIFIEsurvey")

# create BIFIEdata object
bdat &lt;- BIFIEsurvey::BIFIE.data( data.list=data.timss1, wgt=data.timss1[[1]]$TOTWGT,
            wgtrep=data.timssrep[, -1 ] )
summary(bdat)
# create BIFIEdata object in a compact way
bdat2 &lt;- BIFIEsurvey::BIFIE.data( data.list=data.timss1, wgt=data.timss1[[1]]$TOTWGT,
            wgtrep=data.timssrep[, -1 ], cdata=TRUE)
summary(bdat2)

# compute skewness
ma.wtd.skewnessNA( bdat, vars=c("ASMMAT", "books" ) )
ma.wtd.skewnessNA( bdat2, vars=c("ASMMAT", "books" ) )

#############################################################################
# EXAMPLE 5: Nested multiply imputed datasets in BIFIEdata format
#############################################################################

data(data.timss4, package="BIFIEsurvey")
data(data.timssrep, package="BIFIEsurvey")

# nested imputed dataset, save it in compact format
bdat &lt;- BIFIE.data( data.list=data.timss4, wgt=data.timss4[[1]][[1]]$TOTWGT,
            wgtrep=data.timssrep[, -1 ], NMI=TRUE, cdata=TRUE )
summary(bdat)
# skewness
ma.wtd.skewnessNA( bdat, vars=c("ASMMAT", "books" ) )

## End(Not run)
</code></pre>


</div>