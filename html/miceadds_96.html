<div class="container">

<table style="width: 100%;"><tr>
<td>mi.anova</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Analysis of Variance for Multiply Imputed Data Sets (Using the <code class="reqn">D_2</code> Statistic)
</h2>

<h3>Description</h3>

<p>This function combines <code class="reqn">F</code> values from analysis of variance using
the <code class="reqn">D_2</code> statistic which is based on combining <code class="reqn">\chi^2</code> statistics
(see Allison, 2001, Grund, Luedtke &amp; Robitzsch, 2016;
<code>micombine.F</code>, <code>micombine.chisquare</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">mi.anova(mi.res, formula, type=2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mi.res</code></td>
<td>

<p>Object of class <code>mids</code> or <code>mids.1chain</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>

<p>Formula for <code>lm</code> function. Note that this can be also a string.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>Type for ANOVA calculations. For <code>type=3</code>, the
<code>car::Anova</code> function
from the <span class="pkg">car</span> package is used.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the following entries:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>r.squared</code></td>
<td>
<p>Explained variance <code class="reqn">R^2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>anova.table</code></td>
<td>
<p>ANOVA table</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Allison, P. D. (2002). <em>Missing data</em>. Newbury Park, CA: Sage.
</p>
<p>Grund, S., Luedtke, O., &amp; Robitzsch, A. (2016). Pooling ANOVA results from
multiply imputed datasets: A simulation study.
<em>Methodology, 12</em>(3), 75-88.
<a href="https://doi.org/10.1027/1614-2241/a000111">doi:10.1027/1614-2241/a000111</a>
</p>


<h3>See Also</h3>

<p>This function uses <code>micombine.F</code> and
<code>micombine.chisquare</code>.
</p>
<p>See <code>mice::pool.compare</code> and
<code>mitml::testModels</code> for model
comparisons based on the <code class="reqn">D_1</code> statistic. The <code class="reqn">D_2</code> statistic
is also included in <code>mitml::testConstraints</code>.
</p>
<p>The <code class="reqn">D_1</code>, <code class="reqn">D_2</code> and <code class="reqn">D_3</code> statistics are also included in the
<span class="pkg">mice</span> package in functions <code>mice::D1</code>,
<code>mice::D2</code> and <code>mice::D3</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
#############################################################################
# EXAMPLE 1: nhanes2 data | two-way ANOVA
#############################################################################

library(mice)
library(car)
data(nhanes2, package="mice")
set.seed(9090)

# nhanes data in one chain and 8 imputed datasets
mi.res &lt;- miceadds::mice.1chain( nhanes2, burnin=4, iter=20, Nimp=8 )
# 2-way analysis of variance (type 2)
an2a &lt;- miceadds::mi.anova(mi.res=mi.res, formula="bmi ~ age * chl" )

# test of interaction effects using mitml::testModels()
mod1 &lt;- with( mi.res, stats::lm( bmi ~ age*chl ) )
mod0 &lt;- with( mi.res, stats::lm( bmi ~ age+chl ) )

mitml::testModels(model=mod1$analyses, null.model=mod0$analyses, method="D1")
mitml::testModels(model=mod1$analyses, null.model=mod0$analyses, method="D2")

# 2-way analysis of variance (type 3)
an2b &lt;- miceadds::mi.anova(mi.res=mi.res, formula="bmi ~ age * chl", type=3)

#****** analysis based on first imputed dataset

# extract first dataset
dat1 &lt;- mice::complete( mi.res$mids )

# type 2 ANOVA
lm1 &lt;- stats::lm( bmi ~ age * chl, data=dat1 )
summary( stats::aov( lm1 ) )
# type 3 ANOVA
lm2 &lt;- stats::lm( bmi ~ age * chl, data=dat1, contrasts=list(age=contr.sum))
car::Anova(mod=lm2, type=3)

## End(Not run)
</code></pre>


</div>