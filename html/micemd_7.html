<div class="container">

<table style="width: 100%;"><tr>
<td>mice.impute.2l.2stage.norm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Imputation by a two-level heteroscedastic normal model based on a two-stage estimator
</h2>

<h3>Description</h3>

<p>Imputes univariate two-level continuous variable from a heteroscedastic normal model. The imputation method is based on a two-stage estimator: at step 1, a linear regression model is fitted to each observed cluster; at step 2, estimates obtained from each cluster are combined according to a linear random effect model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mice.impute.2l.2stage.norm(y, ry, x, type, method_est = "mm", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>Incomplete data vector of length <code>n</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ry</code></td>
<td>

<p>Vector of missing data pattern <code>(FALSE=missing, TRUE=observed)</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>Matrix <code>(n x p)</code> of complete covariates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>Vector of length <code>ncol(x)</code> identifying random and class variables. Random variables are identified by a '2'. The class variable (only one is allowed) is coded as '-2'. Random variables also include the fixed effect.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method_est</code></td>
<td>

<p>Vector of string given the version of the estimator to used. Choose <code>method_est="reml"</code> for restricted maximum likelihood estimator or <code>method_est="mm"</code> for the method of moments. By default <code>method_est="mm"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Other named arguments.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Imputes univariate two-level continuous variable from a heteroscedastic normal model. The imputation method is based on a two-stage estimator: at step 1, a linear regression model is fitted to each observed cluster; at step 2, estimates obtained from each cluster are combined according to a linear random effect model. Two possibilities are available to combine estimates at stage 2: by default, parameters of the linear random effect model are estimated according to the method of moments (MM), otherwise, parameters of the linear random effect model can be estimated according to the restricted maximum likelihood estimator (REML). The variability on the parameters of the imputation is propagated according to an asymptotic strategy requiring a large number of clusters. Compared to the REML version, the MM version is quicker to perform, but it provides less theoretical garanties. Nevertheless, simulation studies show that both versions lead to similar inferences (Resche-Rigon, M. and White, I. R. (2016)).
</p>


<h3>Value</h3>

<p>A vector of length <code>nmis</code> with imputations.
</p>


<h3>Author(s)</h3>

<p>Vincent Audigier <a href="mailto:vincent.audigier@cnam.fr">vincent.audigier@cnam.fr</a>
</p>


<h3>References</h3>

<p>Resche-Rigon, M. and White, I. R. (2016). Multiple imputation by chained equations for systematically
and sporadically missing multilevel data. Statistical Methods in Medical Research.
To appear. &lt;doi:10.1177/0962280216666564&gt;
</p>
<p>Audigier, V., White, I. ,  Jolani ,S.  Debray, T.,  Quartagno, M., Carpenter, J., van Buuren, S. and Resche-Rigon, M.
Multiple imputation for multilevel data with continuous and binary variables (2018). Statistical Science. &lt;doi:10.1214/18-STS646&gt;.
</p>


<h3>See Also</h3>

<p><code>mice,mice.impute.2l.2stage.pmm,mice.impute.2l.glm.norm,mice.impute.2l.jomo</code>
</p>


</div>