<div class="container">

<table style="width: 100%;"><tr>
<td>miclust</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cluster analysis in multiple imputed data sets with optional variable
selection.</h2>

<h3>Description</h3>

<p>Performs cluster analysis in multiple imputed data sets with optional variable
selection. Results can be summarized and visualized with the <code>summary</code>
and <code>plot</code> methods.
</p>


<h3>Usage</h3>

<pre><code class="language-R">miclust(
  data,
  method = "kmeans",
  search = c("none", "backward", "forward"),
  ks = 2:3,
  maxvars = NULL,
  usedimp = NULL,
  distance = c("manhattan", "euclidean"),
  centpos = c("means", "medians"),
  initcl = c("hc", "rand"),
  verbose = TRUE,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>object of class <code>midata</code> obtained with the function <code>getdata</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>clustering method. Currently, only <code>"kmeans"</code> is accepted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>search</code></td>
<td>
<p>search algorithm for the selection variable procedure: <code>"backward"</code>,
<code>"forward"</code> or <code>"none"</code>. If <code>"none"</code> (default), no variable selection
is performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ks</code></td>
<td>
<p>the values of the explored number of clusters. Default is exploring 2 and 3
clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxvars</code></td>
<td>
<p>if <code>method = "forward"</code>, the maximum number of variables to be
selected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>usedimp</code></td>
<td>
<p>numeric. Which imputed data sets must be included in the cluster
analysis. If <code>NULL</code> (default), all available imputed data sets are included.
If <code>usedimp</code> is numeric (or a numeric vector), its values indicate which imputed
data sets are included.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>two metrics are allowed to compute distances: <code>"manhattan"</code>
(default) and <code>"euclidean"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centpos</code></td>
<td>
<p>position computation of the cluster centroid. If <code>"means"</code>
(default) the position of the centroid is computed by the mean. If <code>"medians"</code>,
by the median.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initcl</code></td>
<td>
<p>starting values for the clustering algorithm. If <code>"rand"</code>, they are
randomly selected; if <code>"hc"</code>, they are computed via hierarchical clustering. See
Details below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>a logical value indicating output status messages. Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>a number. Seed for reproducibility of results. Default is <code>NULL</code> (no
seed).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The optimal number of clusters and the final set of variables are selected
according to CritCF. CritCF is defined as
</p>
<p style="text-align: center;"><code class="reqn">CritCF = \left(\frac{2m}{2m + 1} \cdot \frac{1}{1 + W / B}\right)^{\frac{1 + \log_2(k + 1)}{1 + \log_2(m + 1)}},</code>
</p>

<p>where <code class="reqn">m</code> is the number of variables, <code class="reqn">k</code> is the number of clusters,
and <code class="reqn">W</code> and <code class="reqn">B</code> are the within- and between-cluster inertias. Higher
values of CritCF are preferred (Breaban, 2011). See References below for further
details about the clustering algorithm.
</p>
<p>For computational reasons, option <code>"rand"</code> is suggested instead of <code>"hc"</code>
for high dimensional <code>data</code>.
</p>


<h3>Value</h3>

<p>A list with class "miclust" including the following items:
</p>

<dl>
<dt>clustering</dt>
<dd>
<p>a list of lists containing the results of the clustering algorithm
for each analyzed data set and for each analyzed number of clusters. Includes
information about selected variables and the cluster vector.</p>
</dd>
<dt>completecasesperc</dt>
<dd>
<p>if <code>data</code> contains a single data frame, percentage
of complete cases in <code>data</code>.</p>
</dd>
<dt>data</dt>
<dd>
<p>input <code>data</code>.</p>
</dd>
<dt>ks</dt>
<dd>
<p>the values of the explored number of clusters.</p>
</dd>
<dt>usedimp</dt>
<dd>
<p>indicator of the imputed data sets used.</p>
</dd>
<dt>kfin</dt>
<dd>
<p>optimal number of clusters.</p>
</dd>
<dt>critcf</dt>
<dd>
<p>if <code>data</code> contains a single data frame, <code>critcf</code> contains
the optimal (maximum) value of CritCF (see Details) and the number of selected
variables in the reduction procedure for each explored number of clusters. If
<code>data</code> is a list, <code>critcf</code> contains the optimal value of CritCF for
each imputed data set and for each explored value of the number of clusters.</p>
</dd>
<dt>numberofselectedvars</dt>
<dd>
<p>number of selected variables.</p>
</dd>
<dt>selectedkdistribution</dt>
<dd>
<p>if <code>data</code> is a list, frequency of selection of
each analyzed number of clusters.</p>
</dd>
<dt>method</dt>
<dd>
<p>input <code>method</code>.</p>
</dd>
<dt>search</dt>
<dd>
<p>input <code>search</code>.</p>
</dd>
<dt>maxvars</dt>
<dd>
<p>input <code>maxvars</code>.</p>
</dd>
<dt>distance</dt>
<dd>
<p>input <code>distance</code>.</p>
</dd>
<dt>centpos</dt>
<dd>
<p>input <code>centpos</code>.</p>
</dd>
<dt>selmetriccent</dt>
<dd>
<p>an object of class <code>kccaFamily</code> needed by the specific
<code>summary</code> method.</p>
</dd>
<dt>initcl</dt>
<dd>
<p>input <code>initcl</code>.</p>
</dd>
</dl>
<h3>References</h3>


<ul>
<li>
<p> Basagana X, Barrera-Gomez J, Benet M, Anto JM, Garcia-Aymerich J. A
framework for multiple imputation in cluster analysis. American Journal of
Epidemiology. 2013;177(7):718-25.
</p>
</li>
<li>
<p> Breaban M, Luchian H. A unifying criterion for unsupervised clustering
and feature selection. Pattern Recognition 2001;44(4):854-65.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>getdata</code> for data preparation before using <code>miclust</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">### data preparation:
minhanes1 &lt;- getdata(data = minhanes)

##################
###
### Example 1:
###
### Multiple imputation clustering process with backward variable selection
###
##################

### using only the imputations 1 to 10 for the clustering process and exploring
### 2 vs. 3 clusters:
minhanes1clust &lt;- miclust(data = minhanes1, search = "backward", ks = 2:3,
                          usedimp = 1:10, seed = 4321)
minhanes1clust
minhanes1clust$kfin  ### optimal number of clusters

### graphical summary:
plot(minhanes1clust)

### selection frequency of the variables for the optimal number of clusters:
y &lt;- getvariablesfrequency(minhanes1clust)
y
plot(y$percfreq, type = "h", main = "", xlab = "Variable",
     ylab = "Percentage of times selected", xlim = 0.5 + c(0, length(y$varnames)),
     lwd = 15, col = "blue", xaxt = "n")
axis(1, at = 1:length(y$varnames), labels = y$varnames)

### default summary for the optimal number of clusters:
summary(minhanes1clust)

## summary forcing 3 clusters:
summary(minhanes1clust, k = 3)

##################
###
### Example 2:
###
### Same analysis but without variable selection
###
##################

minhanes2clust &lt;- miclust(data = minhanes1, ks = 2:3, usedimp = 1:10, seed = 4321)
minhanes2clust
plot(minhanes2clust)
summary(minhanes2clust)


##################
###
### Example 3:
###
### Complete case clustering process with backward variable selection
###
##################

nhanes0 &lt;- getdata(data = minhanes[[1]])
nhanes2clust &lt;- miclust(data = nhanes0, search = "backward", ks = 2:3, seed = 4321)
nhanes2clust

summary(nhanes2clust)

### nothing to plot for a single data set analysis
# plot(nhanes2clust)

##################
###
### Example 4:
###
### Complete case clustering process without variable selection
###
##################

nhanes3clust &lt;- miclust(data = nhanes0, ks = 2:3, seed = 4321)
nhanes3clust
summary(nhanes3clust)

</code></pre>


</div>