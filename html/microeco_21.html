<div class="container">

<table style="width: 100%;"><tr>
<td>trans_alpha</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create <code>trans_alpha</code> object for alpha diversity statistics and visualization.</h2>

<h3>Description</h3>

<p>This class is a wrapper for a series of alpha diversity analysis, including the statistics and visualization.
</p>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-trans_alpha-new"><code>trans_alpha$new()</code></a>
</p>
</li>
<li> <p><a href="#method-trans_alpha-cal_diff"><code>trans_alpha$cal_diff()</code></a>
</p>
</li>
<li> <p><a href="#method-trans_alpha-plot_alpha"><code>trans_alpha$plot_alpha()</code></a>
</p>
</li>
<li> <p><a href="#method-trans_alpha-print"><code>trans_alpha$print()</code></a>
</p>
</li>
<li> <p><a href="#method-trans_alpha-clone"><code>trans_alpha$clone()</code></a>
</p>
</li>
</ul>
<hr>
<a id="method-trans_alpha-new"></a>



<h4>Method <code>new()</code>
</h4>



<h5>Usage</h5>

<div class="r"><pre>trans_alpha$new(
  dataset = NULL,
  group = NULL,
  by_group = NULL,
  by_ID = NULL,
  order_x = NULL
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>dataset</code></dt>
<dd>
<p><code>microtable</code> object.</p>
</dd>
<dt><code>group</code></dt>
<dd>
<p>default NULL; a column name of <code>sample_table</code> in the input microtable object used for the statistics across groups.</p>
</dd>
<dt><code>by_group</code></dt>
<dd>
<p>default NULL; a column name of <code>sample_table</code> used to perform the differential test 
among groups (from <code>group</code> parameter) for each group (from <code>by_group</code> parameter) separately.</p>
</dd>
<dt><code>by_ID</code></dt>
<dd>
<p>default NULL; a column name of <code>sample_table</code> used to perform paired t test or paired wilcox test for the paired data,
such as the data of plant compartments for different plant species (ID). 
So <code>by_ID</code> in sample_table should be the smallest unit of sample collection without any repetition in it.</p>
</dd>
<dt><code>order_x</code></dt>
<dd>
<p>default NULL; a column name of <code>sample_table</code> or a vector with sample names. If provided, sort samples using <code>factor</code>.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p><code>data_alpha</code> and <code>data_stat</code> stored in the object.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>\donttest{
data(dataset)
t1 &lt;- trans_alpha$new(dataset = dataset, group = "Group")
}
</pre>
</div>


<hr>
<a id="method-trans_alpha-cal_diff"></a>



<h4>Method <code>cal_diff()</code>
</h4>

<p>Differential test on alpha diversity.
</p>


<h5>Usage</h5>

<div class="r"><pre>trans_alpha$cal_diff(
  measure = NULL,
  method = c("KW", "KW_dunn", "wilcox", "t.test", "anova", "scheirerRayHare", "lm",
    "lme", "betareg", "glmm", "glmm_beta")[1],
  formula = NULL,
  p_adjust_method = "fdr",
  KW_dunn_letter = TRUE,
  alpha = 0.05,
  anova_post_test = "duncan.test",
  return_model = FALSE,
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>measure</code></dt>
<dd>
<p>default NULL; character vector; If NULL, all indexes will be used; see names of <code>microtable$alpha_diversity</code>, 
e.g. <code>c("Observed", "Chao1", "Shannon")</code>.</p>
</dd>
<dt><code>method</code></dt>
<dd>
<p>default "KW"; see the following available options:
</p>

<dl>
<dt><strong>'KW'</strong></dt>
<dd>
<p>Kruskal-Wallis Rank Sum Test for all groups (&gt;= 2)</p>
</dd>
<dt><strong>'KW_dunn'</strong></dt>
<dd>
<p>Dunn's Kruskal-Wallis Multiple Comparisons &lt;10.1080/00401706.1964.10490181&gt; based on <code>dunnTest</code> function in <code>FSA</code> package</p>
</dd>
<dt><strong>'wilcox'</strong></dt>
<dd>
<p>Wilcoxon Rank Sum Test for all paired groups</p>
</dd>
<dt><strong>'t.test'</strong></dt>
<dd>
<p>Student's t-Test for all paired groups</p>
</dd>
<dt><strong>'anova'</strong></dt>
<dd>
<p>Variance analysis. For one-way anova, the default post hoc test is Duncan's new multiple range test.
Please use <code>anova_post_test</code> parameter to change the post hoc method.
For multi-way anova, Please use <code>formula</code> parameter to specify the model and see <code>aov</code> for more details</p>
</dd>
<dt><strong>'scheirerRayHare'</strong></dt>
<dd>
<p>Scheirer-Ray-Hare test (nonparametric test) for a two-way factorial experiment; 
see <code>scheirerRayHare</code> function of <code>rcompanion</code> package</p>
</dd>
<dt><strong>'lm'</strong></dt>
<dd>
<p>Linear Model based on the <code>lm</code> function</p>
</dd>
<dt><strong>'lme'</strong></dt>
<dd>
<p>Linear Mixed Effect Model based on the <code>lmerTest</code> package</p>
</dd>
<dt><strong>'betareg'</strong></dt>
<dd>
<p>Beta Regression for Rates and Proportions based on the <code>betareg</code> package</p>
</dd>
<dt><strong>'glmm'</strong></dt>
<dd>
<p>Generalized linear mixed model (GLMM) based on the <code>glmmTMB</code> package.
A family function can be provided using parameter passing, such as: <code>family = glmmTMB::lognormal(link = "log")</code></p>
</dd>
<dt><strong>'glmm_beta'</strong></dt>
<dd>
<p>Generalized linear mixed model (GLMM) with a family function of beta distribution. 
This is an extension of the GLMM model in <code>'glmm'</code> option. 
The only difference is in <code>glmm_beta</code> the family function is fixed with the beta distribution function, 
facilitating the fitting for proportional data (ranging from 0 to 1). The link function is fixed with <code>"logit"</code>.</p>
</dd>
</dl>
</dd>
<dt><code>formula</code></dt>
<dd>
<p>default NULL; applied to two-way or multi-factor analysis when 
method is <code>"anova"</code>, <code>"scheirerRayHare"</code>, <code>"lm"</code>, <code>"lme"</code>, <code>"betareg"</code> or <code>"glmm"</code>; 
specified set for independent variables, i.e. the latter part of a general formula, 
such as <code>'block + N*P*K'</code>.</p>
</dd>
<dt><code>p_adjust_method</code></dt>
<dd>
<p>default "fdr" (for "KW", "wilcox", "t.test" methods) or "holm" (for "KW_dunn"); P value adjustment method; 
For <code>method = 'KW', 'wilcox' or 't.test'</code>, please see <code>method</code> parameter of <code>p.adjust</code> function for available options;
For <code>method = 'KW_dunn'</code>, please see <code>dunn.test::p.adjustment.methods</code> for available options.</p>
</dd>
<dt><code>KW_dunn_letter</code></dt>
<dd>
<p>default TRUE; For <code>method = 'KW_dunn'</code>, <code>TRUE</code> denotes significances are presented by letters;
<code>FALSE</code> means significances are shown by asterisk for paired comparison.</p>
</dd>
<dt><code>alpha</code></dt>
<dd>
<p>default 0.05; Significant level; used for generating significance letters when method is 'anova' or 'KW_dunn'.</p>
</dd>
<dt><code>anova_post_test</code></dt>
<dd>
<p>default "duncan.test". The post hoc test method for one-way anova. Other available options include "LSD.test" and "HSD.test". 
All those are the function names in <code>agricolae</code> package.</p>
</dd>
<dt><code>return_model</code></dt>
<dd>
<p>default FALSE; whether return the original "lm", "lmer" or "glmm" model list in the object.</p>
</dd>
<dt><code>...</code></dt>
<dd>
<p>parameters passed to <code>kruskal.test</code> (when <code>method = "KW"</code>) or <code>wilcox.test</code> function (when <code>method = "wilcox"</code>) or 
<code>dunnTest</code> function of <code>FSA</code> package (when <code>method = "KW_dunn"</code>) or 
<code>agricolae::duncan.test</code>/<code>agricolae::LSD.test</code>/<code>agricolae::HSD.test</code> (when <code>method = "anova"</code>, one-way anova) or 
<code>rcompanion::scheirerRayHare</code> (when <code>method = "scheirerRayHare"</code>) or 
<code>stats::lm</code> (when <code>method = "lm"</code>) or 
<code>lmerTest::lmer</code> (when <code>method = "lme"</code>) or 
<code>betareg::betareg</code> (when <code>method = "betareg"</code>) or 
<code>glmmTMB::glmmTMB</code> (when <code>method = "glmm"</code>).</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p><code>res_diff</code>, stored in object with the format <code>data.frame</code>.<br>
When method is "betareg", "lm", "lme" or "glmm", 
"Estimate" and "Std.Error" columns represent the fitted coefficient and its standard error, respectively.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>\donttest{
t1$cal_diff(method = "KW")
t1$cal_diff(method = "anova")
t1 &lt;- trans_alpha$new(dataset = dataset, group = "Type", by_group = "Group")
t1$cal_diff(method = "anova")
}
</pre>
</div>


<hr>
<a id="method-trans_alpha-plot_alpha"></a>



<h4>Method <code>plot_alpha()</code>
</h4>

<p>Plot the alpha diversity. 
Box plot (and others for visualizing data in groups of single factor) is used for the visualization of alpha diversity when the <code>group</code> is found in the object.
When the formula is found in the <code>res_diff</code> table in the object, 
heatmap is employed automatically to show the significances of differential test for multiple indexes, 
and errorbar (coefficient and standard errors) can be used for single index.
</p>


<h5>Usage</h5>

<div class="r"><pre>trans_alpha$plot_alpha(
  plot_type = "ggboxplot",
  color_values = RColorBrewer::brewer.pal(8, "Dark2"),
  measure = "Shannon",
  group = NULL,
  add = NULL,
  add_sig = TRUE,
  add_sig_label = "Significance",
  add_sig_text_size = 3.88,
  add_sig_label_num_dec = 4,
  order_x_mean = FALSE,
  y_start = 0.1,
  y_increase = 0.05,
  xtext_angle = 30,
  xtext_size = 13,
  ytitle_size = 17,
  barwidth = 0.9,
  plot_SE = TRUE,
  errorbar_size = 1,
  errorbar_width = 0.2,
  point_size = 3,
  point_alpha = 0.8,
  add_line = FALSE,
  line_size = 0.8,
  line_type = 2,
  line_color = "grey50",
  line_alpha = 0.5,
  heatmap_cell = "P.unadj",
  heatmap_sig = "Significance",
  heatmap_x = "Factors",
  heatmap_y = "Measure",
  heatmap_lab_fill = "P value",
  coefplot_sig_pos = 2,
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>plot_type</code></dt>
<dd>
<p>default "ggboxplot"; plot type; available options include "ggboxplot", "ggdotplot", "ggviolin", "ggstripchart", "ggerrorplot", and "errorbar".
The options starting with "gg" are function names coming from <code>ggpubr</code> package.
All those methods with <code>ggpubr</code> package use the <code>data_alpha</code> table in the object. 
"errorbar" represents mean-sd or mean-se plot based on <code>ggplot2</code> package by invoking the <code>data_stat</code> table in the object.</p>
</dd>
<dt><code>color_values</code></dt>
<dd>
<p>default <code>RColorBrewer::brewer.pal</code>(8, "Dark2"); color pallete for groups.</p>
</dd>
<dt><code>measure</code></dt>
<dd>
<p>default "Shannon"; one alpha diversity index in the object.</p>
</dd>
<dt><code>group</code></dt>
<dd>
<p>default NULL; group name used for the plot.</p>
</dd>
<dt><code>add</code></dt>
<dd>
<p>default NULL; add another plot element; passed to the <code>add</code> parameter of the function (e.g., <code>ggboxplot</code>) from <code>ggpubr</code> package 
when <code>plot_type</code> starts with "gg" (functions coming from ggpubr package).</p>
</dd>
<dt><code>add_sig</code></dt>
<dd>
<p>default TRUE; wheter add significance label using the result of <code>cal_diff</code> function, i.e. <code>object$res_diff</code>;
This is manily designed to add post hoc test of anova or other significances to make the label mapping easy.</p>
</dd>
<dt><code>add_sig_label</code></dt>
<dd>
<p>default "Significance"; select a colname of <code>object$res_diff</code> for the label text when 'Letter' is not in the table, 
such as 'P.adj' or 'Significance'.</p>
</dd>
<dt><code>add_sig_text_size</code></dt>
<dd>
<p>default 3.88; the size of text in added label.</p>
</dd>
<dt><code>add_sig_label_num_dec</code></dt>
<dd>
<p>default 4; reserved decimal places when the parameter <code>add_sig_label</code> use numeric column, like 'P.adj'.</p>
</dd>
<dt><code>order_x_mean</code></dt>
<dd>
<p>default FALSE; whether order x axis by the means of groups from large to small.</p>
</dd>
<dt><code>y_start</code></dt>
<dd>
<p>default 0.1; the y axis value from which to add the significance asterisk label; 
the default 0.1 means <code>max(values) + 0.1 * (max(values) - min(values))</code>.</p>
</dd>
<dt><code>y_increase</code></dt>
<dd>
<p>default 0.05; the increasing y axia space to add the label (asterisk or letter); the default 0.05 means <code>0.05 * (max(values) - min(values))</code>; 
this parameter is also used to label the letters of anova result with the fixed space.</p>
</dd>
<dt><code>xtext_angle</code></dt>
<dd>
<p>default 30; number (e.g. 30) used to make x axis text generate angle.</p>
</dd>
<dt><code>xtext_size</code></dt>
<dd>
<p>default 13; x axis text size. NULL means the default size in ggplot2.</p>
</dd>
<dt><code>ytitle_size</code></dt>
<dd>
<p>default 17; y axis title size.</p>
</dd>
<dt><code>barwidth</code></dt>
<dd>
<p>default 0.9; the bar width in plot; applied when by_group is not NULL.</p>
</dd>
<dt><code>plot_SE</code></dt>
<dd>
<p>default TRUE; TRUE: the errorbar is <code class="reqn">mean±se</code>; FALSE: the errorbar is <code class="reqn">mean±sd</code>. Available when <code>plot_type = "errorbar"</code>.</p>
</dd>
<dt><code>errorbar_size</code></dt>
<dd>
<p>default 1; errorbar size. Available when <code>plot_type = "errorbar"</code>.</p>
</dd>
<dt><code>errorbar_width</code></dt>
<dd>
<p>default 0.2; errorbar width. Available when <code>plot_type = "errorbar"</code> and <code>by_group</code> is NULL.</p>
</dd>
<dt><code>point_size</code></dt>
<dd>
<p>default 3; point size for taxa. Available when <code>plot_type = "errorbar"</code>.</p>
</dd>
<dt><code>point_alpha</code></dt>
<dd>
<p>default 0.8; point transparency. Available when <code>plot_type = "errorbar"</code>.</p>
</dd>
<dt><code>add_line</code></dt>
<dd>
<p>default FALSE; whether add line. Available when <code>plot_type = "errorbar"</code>.</p>
</dd>
<dt><code>line_size</code></dt>
<dd>
<p>default 0.8; line size when <code>add_line = TRUE</code>. Available when <code>plot_type = "errorbar"</code>.</p>
</dd>
<dt><code>line_type</code></dt>
<dd>
<p>default 2; an integer; line type when <code>add_line = TRUE</code>. Available when <code>plot_type = "errorbar"</code>.</p>
</dd>
<dt><code>line_color</code></dt>
<dd>
<p>default "grey50"; line color when <code>add_line = TRUE</code>. Available when <code>plot_type = "errorbar"</code> and <code>by_group</code> is NULL.</p>
</dd>
<dt><code>line_alpha</code></dt>
<dd>
<p>default 0.5; line transparency when <code>add_line = TRUE</code>. Available when <code>plot_type = "errorbar"</code>.</p>
</dd>
<dt><code>heatmap_cell</code></dt>
<dd>
<p>default "P.unadj"; the column of <code>res_diff</code> table for the cell of heatmap when formula with multiple factors is found in the method.</p>
</dd>
<dt><code>heatmap_sig</code></dt>
<dd>
<p>default "Significance"; the column of <code>res_diff</code> for the significance label of heatmap.</p>
</dd>
<dt><code>heatmap_x</code></dt>
<dd>
<p>default "Factors"; the column of <code>res_diff</code> for the x axis of heatmap.</p>
</dd>
<dt><code>heatmap_y</code></dt>
<dd>
<p>default "Taxa"; the column of <code>res_diff</code> for the y axis of heatmap.</p>
</dd>
<dt><code>heatmap_lab_fill</code></dt>
<dd>
<p>default "P value"; legend title of heatmap.</p>
</dd>
<dt><code>coefplot_sig_pos</code></dt>
<dd>
<p>default 2; Significance label position in the coefficient point and errorbar plot. 
The formula is <code>Estimate + coefplot_sig_pos * Std.Error</code>.
This plot is used when there is only one measure found in the table, 
and 'Estimate' and 'Std.Error' are both in the column names (such as for <code>lm</code> and <code>lme methods</code>).
The x axis is 'Estimate', and y axis denotes 'Factors'.
When coefplot_sig_pos is a negative value, the label is in the left of the errorbar.
Errorbar size and width in the coefficient point plot can be adjusted with the parameters <code>errorbar_size</code> and <code>errorbar_width</code>. 
Point size and alpha can be adjusted with parameters <code>point_size</code> and <code>point_alpha</code>. 
The significance label size can be adjusted with parameter <code>add_sig_text_size</code>.
Furthermore, the vertical line around 0 can be adjusted with parameters <code>line_size</code>, <code>line_type</code>, <code>line_color</code> and <code>line_alpha</code>.</p>
</dd>
<dt><code>...</code></dt>
<dd>
<p>parameters passing to <code>ggpubr::ggboxplot</code> function (or other functions shown by <code>plot_type</code> parameter when it starts with "gg") or 
<code>plot_cor</code> function in <code>trans_env</code> class for the heatmap of multiple factors when formula is found in the <code>res_diff</code> of the object.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>ggplot.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>\donttest{
t1 &lt;- trans_alpha$new(dataset = dataset, group = "Group")
t1$cal_diff(method = "wilcox")
t1$plot_alpha(measure = "Shannon", add_sig = TRUE)
t1 &lt;- trans_alpha$new(dataset = dataset, group = "Type", by_group = "Group")
t1$cal_diff(method = "wilcox")
t1$plot_alpha(measure = "Shannon", add_sig = TRUE)
}
</pre>
</div>


<hr>
<a id="method-trans_alpha-print"></a>



<h4>Method <code>print()</code>
</h4>

<p>Print the trans_alpha object.
</p>


<h5>Usage</h5>

<div class="r"><pre>trans_alpha$print()</pre></div>


<hr>
<a id="method-trans_alpha-clone"></a>



<h4>Method <code>clone()</code>
</h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>trans_alpha$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt>
<dd>
<p>Whether to make a deep clone.</p>
</dd>
</dl>
</div>




<h3>Examples</h3>

<pre><code class="language-R">
## ------------------------------------------------
## Method `trans_alpha$new`
## ------------------------------------------------


data(dataset)
t1 &lt;- trans_alpha$new(dataset = dataset, group = "Group")


## ------------------------------------------------
## Method `trans_alpha$cal_diff`
## ------------------------------------------------


t1$cal_diff(method = "KW")
t1$cal_diff(method = "anova")
t1 &lt;- trans_alpha$new(dataset = dataset, group = "Type", by_group = "Group")
t1$cal_diff(method = "anova")


## ------------------------------------------------
## Method `trans_alpha$plot_alpha`
## ------------------------------------------------


t1 &lt;- trans_alpha$new(dataset = dataset, group = "Group")
t1$cal_diff(method = "wilcox")
t1$plot_alpha(measure = "Shannon", add_sig = TRUE)
t1 &lt;- trans_alpha$new(dataset = dataset, group = "Type", by_group = "Group")
t1$cal_diff(method = "wilcox")
t1$plot_alpha(measure = "Shannon", add_sig = TRUE)

</code></pre>


</div>