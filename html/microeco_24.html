<div class="container">

<table style="width: 100%;"><tr>
<td>trans_diff</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create <code>trans_diff</code> object for the differential analysis on the taxonomic abundance</h2>

<h3>Description</h3>

<p>This class is a wrapper for a series of differential abundance test and indicator analysis methods, including 
LEfSe based on the Segata et al. (2011) &lt;doi:10.1186/gb-2011-12-6-r60&gt;,
random forest &lt;doi:10.1016/j.geoderma.2018.09.035&gt;, metastat based on White et al. (2009) &lt;doi:10.1371/journal.pcbi.1000352&gt;,
non-parametric Kruskal-Wallis Rank Sum Test,
Dunn's Kruskal-Wallis Multiple Comparisons based on the <code>FSA</code> package, Wilcoxon Rank Sum and Signed Rank Tests, t-test, anova, 
Scheirer Ray Hare test, 
R package <code>metagenomeSeq</code> Paulson et al. (2013) &lt;doi:10.1038/nmeth.2658&gt;, 
R package <code>ANCOMBC</code> &lt;doi:10.1038/s41467-020-17041-7&gt;, R package <code>ALDEx2</code> &lt;doi:10.1371/journal.pone.0067019; 10.1186/2049-2618-2-15&gt;, 
R package <code>MicrobiomeStat</code> &lt;doi:10.1186/s13059-022-02655-5&gt;, beta regression &lt;doi:10.18637/jss.v034.i02&gt;, R package <code>maaslin2</code>,
linear mixed-effects model and generalized linear mixed model.
</p>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-trans_diff-new"><code>trans_diff$new()</code></a>
</p>
</li>
<li> <p><a href="#method-trans_diff-plot_diff_abund"><code>trans_diff$plot_diff_abund()</code></a>
</p>
</li>
<li> <p><a href="#method-trans_diff-plot_diff_bar"><code>trans_diff$plot_diff_bar()</code></a>
</p>
</li>
<li> <p><a href="#method-trans_diff-plot_diff_cladogram"><code>trans_diff$plot_diff_cladogram()</code></a>
</p>
</li>
<li> <p><a href="#method-trans_diff-print"><code>trans_diff$print()</code></a>
</p>
</li>
<li> <p><a href="#method-trans_diff-clone"><code>trans_diff$clone()</code></a>
</p>
</li>
</ul>
<hr>
<a id="method-trans_diff-new"></a>



<h4>Method <code>new()</code>
</h4>



<h5>Usage</h5>

<div class="r"><pre>trans_diff$new(
  dataset = NULL,
  method = c("lefse", "rf", "metastat", "metagenomeSeq", "KW", "KW_dunn", "wilcox",
    "t.test", "anova", "scheirerRayHare", "lm", "ancombc2", "ALDEx2_t", "ALDEx2_kw",
    "DESeq2", "edgeR", "linda", "maaslin2", "betareg", "lme", "glmm", "glmm_beta")[1],
  group = NULL,
  taxa_level = "all",
  filter_thres = 0,
  alpha = 0.05,
  p_adjust_method = "fdr",
  transformation = NULL,
  remove_unknown = TRUE,
  lefse_subgroup = NULL,
  lefse_min_subsam = 10,
  lefse_norm = 1e+06,
  nresam = 0.6667,
  boots = 30,
  rf_imp_type = 2,
  group_choose_paired = NULL,
  metagenomeSeq_count = 1,
  ALDEx2_sig = c("wi.eBH", "kw.eBH"),
  by_group = NULL,
  by_ID = NULL,
  beta_pseudo = .Machine$double.eps,
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>dataset</code></dt>
<dd>
<p>default NULL; <code>microtable</code> object.</p>
</dd>
<dt><code>method</code></dt>
<dd>
<p>default "lefse"; see the following available options:
</p>

<dl>
<dt><strong>'lefse'</strong></dt>
<dd>
<p>LEfSe method based on Segata et al. (2011) &lt;doi:10.1186/gb-2011-12-6-r60&gt;</p>
</dd>
<dt><strong>'rf'</strong></dt>
<dd>
<p>random forest and non-parametric test method based on An et al. (2019) &lt;doi:10.1016/j.geoderma.2018.09.035&gt;</p>
</dd>
<dt><strong>'metastat'</strong></dt>
<dd>
<p>Metastat method for all paired groups based on White et al. (2009) &lt;doi:10.1371/journal.pcbi.1000352&gt;</p>
</dd>
<dt><strong>'metagenomeSeq'</strong></dt>
<dd>
<p>zero-inflated log-normal model-based differential test method from <code>metagenomeSeq</code> package.</p>
</dd>
<dt><strong>'KW'</strong></dt>
<dd>
<p>KW: Kruskal-Wallis Rank Sum Test for all groups (&gt;= 2)</p>
</dd>
<dt><strong>'KW_dunn'</strong></dt>
<dd>
<p>Dunn's Kruskal-Wallis Multiple Comparisons when group number &gt; 2; see dunnTest function in <code>FSA</code> package</p>
</dd>
<dt><strong>'wilcox'</strong></dt>
<dd>
<p>Wilcoxon Rank Sum and Signed Rank Tests for all paired groups </p>
</dd>
<dt><strong>'t.test'</strong></dt>
<dd>
<p>Student's t-Test for all paired groups</p>
</dd>
<dt><strong>'anova'</strong></dt>
<dd>
<p>ANOVA for one-way or multi-factor analysis; see <code>cal_diff</code> function of <code>trans_alpha</code> class</p>
</dd>
<dt><strong>'scheirerRayHare'</strong></dt>
<dd>
<p>Scheirer Ray Hare test for nonparametric test used for a two-way factorial experiment; 
see <code>scheirerRayHare</code> function of <code>rcompanion</code> package</p>
</dd>
<dt><strong>'lm'</strong></dt>
<dd>
<p>Linear Model based on the <code>lm</code> function</p>
</dd>
<dt><strong>'ALDEx2_t'</strong></dt>
<dd>
<p>runs Welch's t and Wilcoxon tests with <code>ALDEx2</code> package; see also the test parameter in <code>ALDEx2::aldex</code> function;
ALDEx2 uses the centred log-ratio (clr) transformation and estimates per-feature technical variation within each sample using Monte-Carlo instances 
drawn from the Dirichlet distribution; Reference: &lt;doi:10.1371/journal.pone.0067019&gt; and &lt;doi:10.1186/2049-2618-2-15&gt;; 
require <code>ALDEx2</code> package to be installed 
(<a href="https://bioconductor.org/packages/release/bioc/html/ALDEx2.html">https://bioconductor.org/packages/release/bioc/html/ALDEx2.html</a>)</p>
</dd>
<dt><strong>'ALDEx2_kw'</strong></dt>
<dd>
<p>runs Kruskal-Wallace and generalized linear model (glm) test with <code>ALDEx2</code> package; 
see also the <code>test</code> parameter in <code>ALDEx2::aldex</code> function.</p>
</dd>
<dt><strong>'DESeq2'</strong></dt>
<dd>
<p>Differential expression analysis based on the Negative Binomial (a.k.a. Gamma-Poisson) distribution based on the <code>DESeq2</code> package.</p>
</dd>
<dt><strong>'edgeR'</strong></dt>
<dd>
<p>The <code>exactTest</code> method of <code>edgeR</code> package is implemented.</p>
</dd>
<dt><strong>'ancombc2'</strong></dt>
<dd>
<p>Analysis of Compositions of Microbiomes with Bias Correction (ANCOM-BC) 
based on the <code>ancombc2</code> function from <code>ANCOMBC</code> package.
If the <code>fix_formula</code> parameter is not provided, the function can automatically assign it by using group parameter.
For this method, the <code>group</code> parameter is directly passed to the group parameter of <code>ancombc2</code> function.
Reference: &lt;doi:10.1038/s41467-020-17041-7&gt;&lt;10.1038/s41592-023-02092-7&gt;; Require <code>ANCOMBC</code> package to be installed 
(<a href="https://bioconductor.org/packages/release/bioc/html/ANCOMBC.html">https://bioconductor.org/packages/release/bioc/html/ANCOMBC.html</a>)</p>
</dd>
<dt><strong>'linda'</strong></dt>
<dd>
<p>Linear Model for Differential Abundance Analysis of High-dimensional Compositional Data 
based on the <code>linda</code> function of <code>MicrobiomeStat</code> package. 
For linda method, please provide either the group parameter or the formula parameter.
When the formula parameter is provided, it should start with '~' as it is directly used by the linda function.
If the group parameter is used, the prefix '~' is not necessary as the function can automatically add it.
The parameter <code>feature.dat.type = 'count'</code> has been fixed. Other parameters can be passed to the <code>linda</code> function.
Reference: &lt;doi:10.1186/s13059-022-02655-5&gt;</p>
</dd>
<dt><strong>'maaslin2'</strong></dt>
<dd>
<p>finding associations between metadata and potentially high-dimensional microbial multi-omics data based on the Maaslin2 package.
Using this option can invoke the <code>trans_env$cal_cor</code> function with <code>cor_method = "maaslin2"</code>.</p>
</dd>
<dt><strong>'betareg'</strong></dt>
<dd>
<p>Beta Regression based on the <code>betareg</code> package. 
Please see the <code>beta_pseudo</code> parameter for the use of pseudo value when there is 0 or 1 in the data</p>
</dd>
<dt><strong>'lme'</strong></dt>
<dd>
<p>Linear Mixed Effect Model based on the <code>lmerTest</code> package.
In the return table, the significance of fixed factors are tested by function <code>anova</code>.
The significance of 'Estimate' in each term of fixed factors comes from the model.</p>
</dd>
<dt><strong>'glmm'</strong></dt>
<dd>
<p>Generalized linear mixed model (GLMM) based on the <code>glmmTMB</code> package.
The <code>formula</code> and <code>family</code> parameters are needed. 
Please refer to glmmTMB package to select the family function, e.g. <code>family = glmmTMB::lognormal(link = "log")</code>.
The usage of formula is similar with that in 'lme' method.
For more available parameters, please see <code>glmmTMB::glmmTMB</code> function and use parameter passing.
In the result, Conditional R2 and Marginal R2 represent the variance explained by both fixed and random effects and the variance explained by 
fixed effects, respectively. For more details on R2 calculation, please refer to the article &lt;doi: 10.1098/rsif.2017.0213&gt;.
The significance of fixed factors are tested by Chi-square test from function <code>car::Anova</code>.
The significance of 'Estimate' in each term of fixed factors comes from the model.</p>
</dd>
<dt><strong>'glmm_beta'</strong></dt>
<dd>
<p>Generalized linear mixed model with a family function of beta distribution, 
developed for the relative abundance (ranging from 0 to 1) of taxa specifically. 
This is an extension of the GLMM model in <code>'glmm'</code> option.
The only difference is in <code>glmm_beta</code> the family function is fixed with the beta distribution function, 
i.e. <code>family = glmmTMB::beta_family(link = "logit")</code>.
Please see the <code>beta_pseudo</code> parameter for the use of pseudo value when there is 0 or 1 in the data</p>
</dd>
</dl>
</dd>
<dt><code>group</code></dt>
<dd>
<p>default NULL; sample group used for the comparision; a colname of input <code>microtable$sample_table</code>;
It is necessary when method is not "anova" or method is "anova" but formula is not provided.
Once group is provided, the return res_abund will have mean and sd values for group.</p>
</dd>
<dt><code>taxa_level</code></dt>
<dd>
<p>default "all"; 'all' represents using abundance data at all taxonomic ranks; 
For testing at a specific rank, provide taxonomic rank name, such as "Genus".
If the provided taxonomic name is neither 'all' nor a colname in tax_table of input dataset, 
the function will use the features in input <code>microtable$otu_table</code> automatically.</p>
</dd>
<dt><code>filter_thres</code></dt>
<dd>
<p>default 0; the abundance threshold, such as 0.0005 when the input is relative abundance; only available when method != "metastat".
The features with abundances lower than filter_thres will be filtered.</p>
</dd>
<dt><code>alpha</code></dt>
<dd>
<p>default 0.05; significance threshold to select taxa when method is "lefse" or "rf"; 
or used to generate significance letters when method is 'anova' or 'KW_dunn' like the alpha parameter in <code>cal_diff</code> of <code>trans_alpha</code> class.</p>
</dd>
<dt><code>p_adjust_method</code></dt>
<dd>
<p>default "fdr"; p.adjust method; see method parameter of <code>p.adjust</code> function for other available options; 
"none" means disable p value adjustment; So when <code>p_adjust_method = "none"</code>, P.adj is same with P.unadj.</p>
</dd>
<dt><code>transformation</code></dt>
<dd>
<p>default NULL; feature abundance transformation method in the class <code>trans_norm</code>,
such as 'AST' for the arc sine square root transformation.
Only available when <code>method</code> is one of "KW", "KW_dunn", "wilcox", "t.test", "anova", "scheirerRayHare", "betareg" and "lme".</p>
</dd>
<dt><code>remove_unknown</code></dt>
<dd>
<p>default TRUE; whether remove unknown features that donot have clear classification information.</p>
</dd>
<dt><code>lefse_subgroup</code></dt>
<dd>
<p>default NULL; sample sub group used for sub-comparision in lefse; Segata et al. (2011) &lt;doi:10.1186/gb-2011-12-6-r60&gt;.</p>
</dd>
<dt><code>lefse_min_subsam</code></dt>
<dd>
<p>default 10; sample numbers required in the subgroup test.</p>
</dd>
<dt><code>lefse_norm</code></dt>
<dd>
<p>default 1000000; normalization value used in lefse to scale abundances for each level. 
A <code>lefse_norm</code> value &lt; 0 (e.g., -1) means no normalization same with the LEfSe python version.</p>
</dd>
<dt><code>nresam</code></dt>
<dd>
<p>default 0.6667; sample number ratio used in each bootstrap for method = "lefse" or "rf".</p>
</dd>
<dt><code>boots</code></dt>
<dd>
<p>default 30; bootstrap test number for method = "lefse" or "rf".</p>
</dd>
<dt><code>rf_imp_type</code></dt>
<dd>
<p>default 2; the type of feature importance in random forest when <code>method = "rf"</code>. 
Same with <code>type</code> parameter in <code>importance</code> function of <code>randomForest</code> package.
1=mean decrease in accuracy (MeanDecreaseAccuracy), 2=mean decrease in node impurity (MeanDecreaseGini).</p>
</dd>
<dt><code>group_choose_paired</code></dt>
<dd>
<p>default NULL; a vector used for selecting the required groups for paired testing instead of all paired combinations across groups;
Available when method is "metastat", "metagenomeSeq", "ALDEx2_t" or "edgeR".</p>
</dd>
<dt><code>metagenomeSeq_count</code></dt>
<dd>
<p>default 1; Filter features to have at least 'counts' counts.; see the count parameter in MRcoefs function of <code>metagenomeSeq</code> package.</p>
</dd>
<dt><code>ALDEx2_sig</code></dt>
<dd>
<p>default c("wi.eBH", "kw.eBH"); which column of the final result is used as the significance asterisk assignment;
applied to method = "ALDEx2_t" or "ALDEx2_kw"; the first element is provided to "ALDEx2_t"; the second is provided to "ALDEx2_kw";
for "ALDEx2_t", the available choice is "wi.eBH" (Expected Benjamini-Hochberg corrected P value of Wilcoxon test)
and "we.eBH" (Expected BH corrected P value of Welch's t test); for "ALDEx2_kw"; for "ALDEx2_t",
the available choice is "kw.eBH" (Expected BH corrected P value of Kruskal-Wallace test) and "glm.eBH" (Expected BH corrected P value of glm test).</p>
</dd>
<dt><code>by_group</code></dt>
<dd>
<p>default NULL; a column of sample_table used to perform the differential test 
among groups (<code>group</code> parameter) for each group (<code>by_group</code> parameter). So <code>by_group</code> has a higher level than <code>group</code> parameter.
Same with the <code>by_group</code> parameter in <code>trans_alpha</code> class. 
Only available when method is one of <code>c("KW", "KW_dunn", "wilcox", "t.test", "anova", "scheirerRayHare")</code>.</p>
</dd>
<dt><code>by_ID</code></dt>
<dd>
<p>default NULL; a column of sample_table used to perform paired t test or paired wilcox test for the paired data,
such as the data of plant compartments for different plant species (ID). 
So <code>by_ID</code> in sample_table should be the smallest unit of sample collection without any repetition in it.
Same with the <code>by_ID</code> parameter in trans_alpha class.</p>
</dd>
<dt><code>beta_pseudo</code></dt>
<dd>
<p>default .Machine$double.eps; the pseudo value used when the parameter <code>method</code> is <code>'betareg'</code> or <code>'glmm_beta'</code>.
As the beta distribution function limits 0 &lt; response value &lt; 1, a pseudo value will be added for the data that equal to 0.
The data that equal to 1 will be replaced by <code>1/(1 + beta_pseudo)</code>.</p>
</dd>
<dt><code>...</code></dt>
<dd>
<p>parameters passed to <code>cal_diff</code> function of <code>trans_alpha</code> class when method is one of 
"KW", "KW_dunn", "wilcox", "t.test", "anova", "betareg", "lme", "glmm" or "glmm_beta";
passed to <code>randomForest::randomForest</code> function when method = "rf";
passed to <code>ANCOMBC::ancombc2</code> function when method is "ancombc2" (except tax_level, global and fix_formula parameters);
passed to <code>ALDEx2::aldex</code> function when method = "ALDEx2_t" or "ALDEx2_kw";
passed to <code>DESeq2::DESeq</code> function when method = "DESeq2";
passed to <code>MicrobiomeStat::linda</code> function when method = "linda";
passed to <code>trans_env$cal_cor</code> function when method = "maaslin2".</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>res_diff and res_abund.<br><strong>res_abund</strong> includes mean abundance of each taxa (Mean), standard deviation (SD), standard error (SE) and sample number (N) in the group (Group).<br><strong>res_diff</strong> is the detailed differential test result depending on the method choice, may containing:<br><strong>"Comparison"</strong>: The groups for the comparision, maybe all groups or paired groups. If this column is not found, all groups are used;<br><strong>"Group"</strong>: Which group has the maximum median or mean value across the test groups; 
For non-parametric methods, median value; For t.test, mean value;<br><strong>"Taxa"</strong>: which taxa is used in this comparision;<br><strong>"Method"</strong>: Test method used in the analysis depending on the method input;<br><strong>"LDA" or others</strong>: LDA: linear discriminant score in LEfSe; 
MeanDecreaseAccuracy and MeanDecreaseGini: mean decreasing in accuracy or in node impurity (gini index) in random forest;<br><strong>"P.unadj"</strong>: original p value;<br><strong>"P.adj"</strong>: adjusted p value;<br><strong>"Estimate" and "Std.Error"</strong>: When method is "betareg", "lm", "lme" or "glmm", 
"Estimate" and "Std.Error" represent fitted coefficient and its standard error, respectively;<br><strong>Others</strong>: qvalue: qvalue in metastat analysis.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>\donttest{
data(dataset)
t1 &lt;- trans_diff$new(dataset = dataset, method = "lefse", group = "Group")
t1 &lt;- trans_diff$new(dataset = dataset, method = "rf", group = "Group")
t1 &lt;- trans_diff$new(dataset = dataset, method = "metastat", group = "Group", taxa_level = "Genus")
t1 &lt;- trans_diff$new(dataset = dataset, method = "wilcox", group = "Group")
}
</pre>
</div>


<hr>
<a id="method-trans_diff-plot_diff_abund"></a>



<h4>Method <code>plot_diff_abund()</code>
</h4>

<p>Plot the abundance of differential taxa
</p>


<h5>Usage</h5>

<div class="r"><pre>trans_diff$plot_diff_abund(
  use_number = 1:20,
  color_values = RColorBrewer::brewer.pal(8, "Dark2"),
  select_group = NULL,
  select_taxa = NULL,
  simplify_names = TRUE,
  keep_prefix = TRUE,
  group_order = NULL,
  barwidth = 0.9,
  use_se = TRUE,
  add_sig = FALSE,
  add_sig_label = "Significance",
  add_sig_label_color = "black",
  add_sig_text_size = 3.88,
  add_sig_tip_length = 0.01,
  y_start = 1.01,
  y_increase = 0.05,
  text_y_size = 10,
  coord_flip = TRUE,
  xtext_angle = 45,
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>use_number</code></dt>
<dd>
<p>default 1:20; numeric vector; the taxa numbers (1:n) selected in the plot; 
If the n is larger than the number of total significant taxa, automatically use all the taxa.</p>
</dd>
<dt><code>color_values</code></dt>
<dd>
<p>default <code>RColorBrewer::brewer.pal</code>(8, "Dark2"); colors palette.</p>
</dd>
<dt><code>select_group</code></dt>
<dd>
<p>default NULL; this is used to select the paired groups. 
This parameter is especially useful when the comparision methods is applied to paired groups;
The input select_group must be one of <code>object$res_diff$Comparison</code>.</p>
</dd>
<dt><code>select_taxa</code></dt>
<dd>
<p>default NULL; character vector to provide taxa names. 
The taxa names should be same with the names shown in the plot, not the 'Taxa' column names in <code>object$res_diff$Taxa</code>.</p>
</dd>
<dt><code>simplify_names</code></dt>
<dd>
<p>default TRUE; whether use the simplified taxonomic name.</p>
</dd>
<dt><code>keep_prefix</code></dt>
<dd>
<p>default TRUE; whether retain the taxonomic prefix.</p>
</dd>
<dt><code>group_order</code></dt>
<dd>
<p>default NULL; a vector to order groups, i.e. reorder the legend and colors in plot; 
If NULL, the function can first check whether the group column of sample_table is factor. If yes, use the levels in it.
If provided, overlook the levels in the group of sample_table.</p>
</dd>
<dt><code>barwidth</code></dt>
<dd>
<p>default 0.9; the bar width in plot.</p>
</dd>
<dt><code>use_se</code></dt>
<dd>
<p>default TRUE; whether use SE in plot, if FALSE, use SD.</p>
</dd>
<dt><code>add_sig</code></dt>
<dd>
<p>default FALSE; whether add the significance label to the plot.</p>
</dd>
<dt><code>add_sig_label</code></dt>
<dd>
<p>default "Significance"; select a colname of object$res_diff for the label text, such as 'P.adj' or 'Significance'.</p>
</dd>
<dt><code>add_sig_label_color</code></dt>
<dd>
<p>default "black"; the color for the label text when add_sig = TRUE.</p>
</dd>
<dt><code>add_sig_text_size</code></dt>
<dd>
<p>default 3.88; the size of text in added label.</p>
</dd>
<dt><code>add_sig_tip_length</code></dt>
<dd>
<p>default 0.01; the tip length for the added line when add_sig = TRUE.</p>
</dd>
<dt><code>y_start</code></dt>
<dd>
<p>default 1.01; the y axis position from which to add the label; the default 1.01 means 1.01 * Value;
For method != "anova", all the start positions are same, i.e. Value = max(Mean+SD or Mean+SE); 
For method = "anova"; the stat position is calculated for each point, i.e. Value = Mean+SD or Mean+SE.</p>
</dd>
<dt><code>y_increase</code></dt>
<dd>
<p>default 0.05; the increasing y axia space to add label for paired groups; the default 0.05 means 0.05 * y_start * Value; 
In addition, this parameter is also used to label the letters of anova result with the fixed (1 + y_increase) * y_start * Value.</p>
</dd>
<dt><code>text_y_size</code></dt>
<dd>
<p>default 10; the size for the y axis text, i.e. feature text.</p>
</dd>
<dt><code>coord_flip</code></dt>
<dd>
<p>default TRUE; whether flip cartesian coordinates so that horizontal becomes vertical, and vertical becomes horizontal.</p>
</dd>
<dt><code>xtext_angle</code></dt>
<dd>
<p>default 45; number ranging from 0 to 90; used to make x axis text generate angle to reduce text overlap; 
only available when coord_flip = FALSE.</p>
</dd>
<dt><code>...</code></dt>
<dd>
<p>parameters passed to <code>ggsignif::stat_signif</code> when add_sig = TRUE.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>ggplot.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>\donttest{
t1 &lt;- trans_diff$new(dataset = dataset, method = "anova", group = "Group", taxa_level = "Genus")
t1$plot_diff_abund(use_number = 1:10)
t1$plot_diff_abund(use_number = 1:10, add_sig = TRUE)
t1 &lt;- trans_diff$new(dataset = dataset, method = "wilcox", group = "Group")
t1$plot_diff_abund(use_number = 1:20)
t1$plot_diff_abund(use_number = 1:20, add_sig = TRUE)
t1 &lt;- trans_diff$new(dataset = dataset, method = "lefse", group = "Group")
t1$plot_diff_abund(use_number = 1:20)
t1$plot_diff_abund(use_number = 1:20, add_sig = TRUE)
}
</pre>
</div>


<hr>
<a id="method-trans_diff-plot_diff_bar"></a>



<h4>Method <code>plot_diff_bar()</code>
</h4>

<p>Bar plot for indicator index, such as LDA score and P value.
</p>


<h5>Usage</h5>

<div class="r"><pre>trans_diff$plot_diff_bar(
  color_values = RColorBrewer::brewer.pal(8, "Dark2"),
  color_group_map = FALSE,
  use_number = 1:10,
  threshold = NULL,
  select_group = NULL,
  keep_full_name = FALSE,
  keep_prefix = TRUE,
  group_order = NULL,
  group_aggre = TRUE,
  group_two_sep = TRUE,
  coord_flip = TRUE,
  add_sig = FALSE,
  add_sig_increase = 0.1,
  add_sig_text_size = 5,
  xtext_angle = 45,
  xtext_size = 10,
  axis_text_y = 12,
  heatmap_cell = "P.unadj",
  heatmap_sig = "Significance",
  heatmap_x = "Factors",
  heatmap_y = "Taxa",
  heatmap_lab_fill = "P value",
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>color_values</code></dt>
<dd>
<p>default <code>RColorBrewer::brewer.pal</code>(8, "Dark2"); colors palette for different groups.</p>
</dd>
<dt><code>color_group_map</code></dt>
<dd>
<p>default FALSE; whether match the colors to groups in order to fix the color in each group when part of groups are not shown in the plot.
When <code>color_group_map = TRUE</code>, the group_order inside the object will be used as full groups set to guide the color extraction.</p>
</dd>
<dt><code>use_number</code></dt>
<dd>
<p>default 1:10; numeric vector; the taxa numbers used in the plot, i.e. 1:n.</p>
</dd>
<dt><code>threshold</code></dt>
<dd>
<p>default NULL; threshold value of indicators for selecting taxa, such as 3 for LDA score of LEfSe.</p>
</dd>
<dt><code>select_group</code></dt>
<dd>
<p>default NULL; this is used to select the paired group when multiple comparisions are generated;
The input select_group must be one of <code>object$res_diff$Comparison</code>.</p>
</dd>
<dt><code>keep_full_name</code></dt>
<dd>
<p>default FALSE; whether keep the taxonomic full lineage names.</p>
</dd>
<dt><code>keep_prefix</code></dt>
<dd>
<p>default TRUE; whether retain the taxonomic prefix, such as "g__".</p>
</dd>
<dt><code>group_order</code></dt>
<dd>
<p>default NULL; a vector to order the legend and colors in plot; 
If NULL, the function can first determine whether the group column of <code>microtable$sample_table</code> is factor. If yes, use the levels in it.
If provided, this parameter can overwrite the levels in the group of <code>microtable$sample_table</code>.</p>
</dd>
<dt><code>group_aggre</code></dt>
<dd>
<p>default TRUE; whether aggregate the features for each group.</p>
</dd>
<dt><code>group_two_sep</code></dt>
<dd>
<p>default TRUE; whether display the features of two groups on opposite sides of the coordinate axes when there are only two groups in total.</p>
</dd>
<dt><code>coord_flip</code></dt>
<dd>
<p>default TRUE; whether flip cartesian coordinates so that horizontal becomes vertical, and vertical becomes horizontal.</p>
</dd>
<dt><code>add_sig</code></dt>
<dd>
<p>default FALSE; whether add significance label (asterisk) above the bar.</p>
</dd>
<dt><code>add_sig_increase</code></dt>
<dd>
<p>default 0.1; the axis position (<code>Value + add_sig_increase * max(Value)</code>) from which to add the significance label; 
only available when <code>add_sig = TRUE</code>.</p>
</dd>
<dt><code>add_sig_text_size</code></dt>
<dd>
<p>default 5; the size of added significance label; only available when <code>add_sig = TRUE</code>.</p>
</dd>
<dt><code>xtext_angle</code></dt>
<dd>
<p>default 45; number ranging from 0 to 90; used to make x axis text generate angle to reduce text overlap; 
only available when coord_flip = FALSE.</p>
</dd>
<dt><code>xtext_size</code></dt>
<dd>
<p>default 10; the text size of x axis.</p>
</dd>
<dt><code>axis_text_y</code></dt>
<dd>
<p>default 12; the size for the y axis text.</p>
</dd>
<dt><code>heatmap_cell</code></dt>
<dd>
<p>default "P.unadj"; the column of data for the cell of heatmap when formula with multiple factors is found in the method.</p>
</dd>
<dt><code>heatmap_sig</code></dt>
<dd>
<p>default "Significance"; the column of data for the significance label of heatmap.</p>
</dd>
<dt><code>heatmap_x</code></dt>
<dd>
<p>default "Factors"; the column of data for the x axis of heatmap.</p>
</dd>
<dt><code>heatmap_y</code></dt>
<dd>
<p>default "Taxa"; the column of data for the y axis of heatmap.</p>
</dd>
<dt><code>heatmap_lab_fill</code></dt>
<dd>
<p>default "P value"; legend title of heatmap.</p>
</dd>
<dt><code>...</code></dt>
<dd>
<p>parameters passing to <code>geom_bar</code> for the bar plot or 
<code>plot_cor</code> function in <code>trans_env</code> class for the heatmap of multiple factors when formula is found in the method.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>ggplot.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>\donttest{
t1$plot_diff_bar(use_number = 1:20)
}
</pre>
</div>


<hr>
<a id="method-trans_diff-plot_diff_cladogram"></a>



<h4>Method <code>plot_diff_cladogram()</code>
</h4>

<p>Plot the cladogram using taxa with significant difference.
</p>


<h5>Usage</h5>

<div class="r"><pre>trans_diff$plot_diff_cladogram(
  color = RColorBrewer::brewer.pal(8, "Dark2"),
  group_order = NULL,
  use_taxa_num = 200,
  filter_taxa = NULL,
  use_feature_num = NULL,
  clade_label_level = 4,
  select_show_labels = NULL,
  only_select_show = FALSE,
  sep = "|",
  branch_size = 0.2,
  alpha = 0.2,
  clade_label_size = 2,
  clade_label_size_add = 5,
  clade_label_size_log = exp(1),
  node_size_scale = 1,
  node_size_offset = 1,
  annotation_shape = 22,
  annotation_shape_size = 5
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>color</code></dt>
<dd>
<p>default <code>RColorBrewer::brewer.pal</code>(8, "Dark2"); color palette used in the plot.</p>
</dd>
<dt><code>group_order</code></dt>
<dd>
<p>default NULL; a vector to order the legend in plot; 
If NULL, the function can first check whether the group column of sample_table is factor. If yes, use the levels in it.
If provided, this parameter can overwrite the levels in the group of sample_table. 
If the number of provided group_order is less than the number of groups in <code>res_diff$Group</code>, the function will select the groups of group_order automatically.</p>
</dd>
<dt><code>use_taxa_num</code></dt>
<dd>
<p>default 200; integer; The taxa number used in the background tree plot; select the taxa according to the mean abundance .</p>
</dd>
<dt><code>filter_taxa</code></dt>
<dd>
<p>default NULL; The mean relative abundance used to filter the taxa with low abundance.</p>
</dd>
<dt><code>use_feature_num</code></dt>
<dd>
<p>default NULL; integer; The feature number used in the plot; 
select the features according to the metric (method = "lefse" or "rf") from high to low.</p>
</dd>
<dt><code>clade_label_level</code></dt>
<dd>
<p>default 4; the taxonomic level for marking the label with letters, root is the largest.</p>
</dd>
<dt><code>select_show_labels</code></dt>
<dd>
<p>default NULL; character vector; The features to show in the plot with full label names, not the letters.</p>
</dd>
<dt><code>only_select_show</code></dt>
<dd>
<p>default FALSE; whether only use the the select features in the parameter <code>select_show_labels</code>.</p>
</dd>
<dt><code>sep</code></dt>
<dd>
<p>default "|"; the seperate character in the taxonomic information.</p>
</dd>
<dt><code>branch_size</code></dt>
<dd>
<p>default 0.2; numberic, size of branch.</p>
</dd>
<dt><code>alpha</code></dt>
<dd>
<p>default 0.2; shading of the color.</p>
</dd>
<dt><code>clade_label_size</code></dt>
<dd>
<p>default 2; basic size for the clade label; please also see <code>clade_label_size_add</code> and <code>clade_label_size_log</code>.</p>
</dd>
<dt><code>clade_label_size_add</code></dt>
<dd>
<p>default 5; added basic size for the clade label; see the formula in <code>clade_label_size_log</code> parameter.</p>
</dd>
<dt><code>clade_label_size_log</code></dt>
<dd>
<p>default <code>exp(1)</code>; the base of <code>log</code> function for added size of the clade label; the size formula: 
<code>clade_label_size + log(clade_label_level + clade_label_size_add, base = clade_label_size_log)</code>; 
so use <code>clade_label_size_log</code>, <code>clade_label_size_add</code> and <code>clade_label_size</code>
can totally control the label size for different taxonomic levels.</p>
</dd>
<dt><code>node_size_scale</code></dt>
<dd>
<p>default 1; scale for the node size.</p>
</dd>
<dt><code>node_size_offset</code></dt>
<dd>
<p>default 1; offset for the node size.</p>
</dd>
<dt><code>annotation_shape</code></dt>
<dd>
<p>default 22; shape used in the annotation legend.</p>
</dd>
<dt><code>annotation_shape_size</code></dt>
<dd>
<p>default 5; size used in the annotation legend.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>ggplot.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>\dontrun{
t1$plot_diff_cladogram(use_taxa_num = 100, use_feature_num = 30, select_show_labels = NULL)
}
</pre>
</div>


<hr>
<a id="method-trans_diff-print"></a>



<h4>Method <code>print()</code>
</h4>

<p>Print the trans_alpha object.
</p>


<h5>Usage</h5>

<div class="r"><pre>trans_diff$print()</pre></div>


<hr>
<a id="method-trans_diff-clone"></a>



<h4>Method <code>clone()</code>
</h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>trans_diff$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt>
<dd>
<p>Whether to make a deep clone.</p>
</dd>
</dl>
</div>




<h3>Examples</h3>

<pre><code class="language-R">
## ------------------------------------------------
## Method `trans_diff$new`
## ------------------------------------------------


data(dataset)
t1 &lt;- trans_diff$new(dataset = dataset, method = "lefse", group = "Group")
t1 &lt;- trans_diff$new(dataset = dataset, method = "rf", group = "Group")
t1 &lt;- trans_diff$new(dataset = dataset, method = "metastat", group = "Group", taxa_level = "Genus")
t1 &lt;- trans_diff$new(dataset = dataset, method = "wilcox", group = "Group")


## ------------------------------------------------
## Method `trans_diff$plot_diff_abund`
## ------------------------------------------------


t1 &lt;- trans_diff$new(dataset = dataset, method = "anova", group = "Group", taxa_level = "Genus")
t1$plot_diff_abund(use_number = 1:10)
t1$plot_diff_abund(use_number = 1:10, add_sig = TRUE)
t1 &lt;- trans_diff$new(dataset = dataset, method = "wilcox", group = "Group")
t1$plot_diff_abund(use_number = 1:20)
t1$plot_diff_abund(use_number = 1:20, add_sig = TRUE)
t1 &lt;- trans_diff$new(dataset = dataset, method = "lefse", group = "Group")
t1$plot_diff_abund(use_number = 1:20)
t1$plot_diff_abund(use_number = 1:20, add_sig = TRUE)


## ------------------------------------------------
## Method `trans_diff$plot_diff_bar`
## ------------------------------------------------


t1$plot_diff_bar(use_number = 1:20)


## ------------------------------------------------
## Method `trans_diff$plot_diff_cladogram`
## ------------------------------------------------

## Not run: 
t1$plot_diff_cladogram(use_taxa_num = 100, use_feature_num = 30, select_show_labels = NULL)

## End(Not run)
</code></pre>


</div>