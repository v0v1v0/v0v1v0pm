<div class="container">

<table style="width: 100%;"><tr>
<td>trans_func</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create <code>trans_func</code> object for functional prediction.</h2>

<h3>Description</h3>

<p>This class is a wrapper for a series of functional prediction analysis on species and communities, including the prokaryotic trait prediction based on 
Louca et al. (2016) &lt;doi:10.1126/science.aaf4507&gt; and Lim et al. (2020) &lt;10.1038/s41597-020-0516-5&gt;, 
or fungal trait prediction based on Nguyen et al. (2016) &lt;10.1016/j.funeco.2015.06.006&gt; and Polme et al. (2020) &lt;doi:10.1007/s13225-020-00466-2&gt;; 
functional redundancy calculation and metabolic pathway abundance prediction Abhauer et al. (2015) &lt;10.1093/bioinformatics/btv287&gt;.
</p>


<h3>Active bindings</h3>

<div class="r6-active-bindings">

<dl>
<dt><code>func_group_list</code></dt>
<dd>
<p>store and show the function group list</p>
</dd>
</dl>
</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-trans_func-new"><code>trans_func$new()</code></a>
</p>
</li>
<li> <p><a href="#method-trans_func-cal_spe_func"><code>trans_func$cal_spe_func()</code></a>
</p>
</li>
<li> <p><a href="#method-trans_func-cal_spe_func_perc"><code>trans_func$cal_spe_func_perc()</code></a>
</p>
</li>
<li> <p><a href="#method-trans_func-show_prok_func"><code>trans_func$show_prok_func()</code></a>
</p>
</li>
<li> <p><a href="#method-trans_func-trans_spe_func_perc"><code>trans_func$trans_spe_func_perc()</code></a>
</p>
</li>
<li> <p><a href="#method-trans_func-plot_spe_func_perc"><code>trans_func$plot_spe_func_perc()</code></a>
</p>
</li>
<li> <p><a href="#method-trans_func-cal_tax4fun"><code>trans_func$cal_tax4fun()</code></a>
</p>
</li>
<li> <p><a href="#method-trans_func-cal_tax4fun2"><code>trans_func$cal_tax4fun2()</code></a>
</p>
</li>
<li> <p><a href="#method-trans_func-cal_tax4fun2_FRI"><code>trans_func$cal_tax4fun2_FRI()</code></a>
</p>
</li>
<li> <p><a href="#method-trans_func-print"><code>trans_func$print()</code></a>
</p>
</li>
<li> <p><a href="#method-trans_func-clone"><code>trans_func$clone()</code></a>
</p>
</li>
</ul>
<hr>
<a id="method-trans_func-new"></a>



<h4>Method <code>new()</code>
</h4>

<p>Create the <code>trans_func</code> object. This function can identify the data type for Prokaryotes or Fungi automatically.
</p>


<h5>Usage</h5>

<div class="r"><pre>trans_func$new(dataset = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>dataset</code></dt>
<dd>
<p>the object of <code>microtable</code> Class.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p><code>for_what</code>: "prok" or "fungi" or NA, "prok" represent prokaryotes. "fungi" represent fungi. NA stand for unknown according to the Kingdom information. 
In this case, if the user still want to use the function to identify species traits, please provide "prok" or "fungi" manually, 
e.g. <code>t1$for_what &lt;- "prok"</code>.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>data(dataset)
t1 &lt;- trans_func$new(dataset = dataset)
</pre>
</div>


<hr>
<a id="method-trans_func-cal_spe_func"></a>



<h4>Method <code>cal_spe_func()</code>
</h4>

<p>Identify traits of each feature by matching taxonomic assignments to functional database.
</p>


<h5>Usage</h5>

<div class="r"><pre>trans_func$cal_spe_func(
  prok_database = c("FAPROTAX", "NJC19")[1],
  fungi_database = c("FUNGuild", "FungalTraits")[1],
  FUNGuild_confidence = c("Highly Probable", "Probable", "Possible")
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>prok_database</code></dt>
<dd>
<p>default "FAPROTAX"; <code>"FAPROTAX"</code> or <code>"NJC19"</code>; select a prokaryotic trait database:
</p>

<dl>
<dt><strong>'FAPROTAX'</strong></dt>
<dd>
<p>FAPROTAX; Reference: Louca et al. (2016). Decoupling function and taxonomy in the global ocean microbiome. 
Science, 353(6305), 1272. &lt;doi:10.1126/science.aaf4507&gt;</p>
</dd>
<dt><strong>'NJC19'</strong></dt>
<dd>
<p>NJC19: Lim et al. (2020). Large-scale metabolic interaction networkÂ of the mouse and human gut microbiota. 
Scientific Data, 7(1). &lt;10.1038/s41597-020-0516-5&gt;. 
Note that the matching in this database is performed at the species level, 
hence utilizing it demands a higher level of precision in regards to the assignments of species in the taxonomic information table.</p>
</dd>
</dl>
</dd>
<dt><code>fungi_database</code></dt>
<dd>
<p>default "FUNGuild"; <code>"FUNGuild"</code> or <code>"FungalTraits"</code>; select a fungal trait database:
</p>

<dl>
<dt><strong>'FUNGuild'</strong></dt>
<dd>
<p>Nguyen et al. (2016) FUNGuild: An open annotation tool for parsing fungal community datasets by ecological guild.
Fungal Ecology, 20(1), 241-248, &lt;doi:10.1016/j.funeco.2015.06.006&gt;</p>
</dd>
<dt><strong>'FungalTraits'</strong></dt>
<dd>
<p>version: FungalTraits_1.2_ver_16Dec_2020V.1.2; Polme et al. 
FungalTraits: a user-friendly traits database of fungi and fungus-like stramenopiles.  
Fungal Diversity 105, 1-16 (2020). &lt;doi:10.1007/s13225-020-00466-2&gt;</p>
</dd>
</dl>
</dd>
<dt><code>FUNGuild_confidence</code></dt>
<dd>
<p>default c("Highly Probable", "Probable", "Possible"). 
Selected 'confidenceRanking' when <code>fungi_database = "FUNGuild"</code>.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p><code>res_spe_func</code> stored in object.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>\donttest{
t1$cal_spe_func(prok_database = "FAPROTAX")
}
</pre>
</div>


<hr>
<a id="method-trans_func-cal_spe_func_perc"></a>



<h4>Method <code>cal_spe_func_perc()</code>
</h4>

<p>Calculating the percentages of species with specific trait in communities.
The percentages of the taxa with specific trait can reflect corresponding functional potential in the community.
So this method is one representation of functional redundancy (FR) without the consideration of phylogenetic distance among taxa.
The FR is defined:
</p>
<p style="text-align: center;"><code class="reqn">FR_{kj}^{unweighted} = \frac{N_{j}}{N_{k}}</code>
</p>

<p style="text-align: center;"><code class="reqn">FR_{kj}^{weighted} = \frac{\sum_{i=1}^{N_{j}} A_{i}}{\sum_{i=1}^{N_{k}} A_{i}}</code>
</p>

<p>where <code class="reqn">FR_{kj}</code> denotes the FR for sample k and function j. <code class="reqn">N_{k}</code> is the species number in sample k.
<code class="reqn">N_{j}</code> is the number of species with function j in sample k.
<code class="reqn">A_{i}</code> is the abundance (counts) of species i in sample k.
</p>


<h5>Usage</h5>

<div class="r"><pre>trans_func$cal_spe_func_perc(abundance_weighted = FALSE, perc = TRUE, dec = 2)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>abundance_weighted</code></dt>
<dd>
<p>default FALSE; whether use abundance of taxa. If FALSE, calculate the functional population percentage. 
If TRUE, calculate the functional individual percentage.</p>
</dd>
<dt><code>perc</code></dt>
<dd>
<p>default TRUE; whether to use percentages in the result. If TRUE, value is bounded between 0 and 100.
If FALSE, the result is relative proportion ('abundance_weighted = FALSE') or relative abundance ('abundance_weighted = TRUE') bounded between 0 and 1.</p>
</dd>
<dt><code>dec</code></dt>
<dd>
<p>default 2; remained decimal places.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p><code>res_spe_func_perc</code> stored in the object.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>\donttest{
t1$cal_spe_func_perc(abundance_weighted = TRUE)
}
</pre>
</div>


<hr>
<a id="method-trans_func-show_prok_func"></a>



<h4>Method <code>show_prok_func()</code>
</h4>

<p>Show the annotation information for a function of prokaryotes from FAPROTAX database.
</p>


<h5>Usage</h5>

<div class="r"><pre>trans_func$show_prok_func(use_func = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>use_func</code></dt>
<dd>
<p>default NULL; the function name.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>None.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>\donttest{
t1$show_prok_func(use_func = "methanotrophy")
}
</pre>
</div>


<hr>
<a id="method-trans_func-trans_spe_func_perc"></a>



<h4>Method <code>trans_spe_func_perc()</code>
</h4>

<p>Transform the <code>res_spe_func_perc</code> table to the long table format for the following visualization.
Also add the group information if the database has hierarchical groups.
</p>


<h5>Usage</h5>

<div class="r"><pre>trans_func$trans_spe_func_perc()</pre></div>



<h5>Returns</h5>

<p><code>res_spe_func_perc_trans</code> stored in the object.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>\donttest{
t1$trans_spe_func_perc()
}
</pre>
</div>


<hr>
<a id="method-trans_func-plot_spe_func_perc"></a>



<h4>Method <code>plot_spe_func_perc()</code>
</h4>

<p>Plot the percentages of species with specific trait in communities.
</p>


<h5>Usage</h5>

<div class="r"><pre>trans_func$plot_spe_func_perc(
  add_facet = TRUE,
  order_x = NULL,
  color_gradient_low = "#00008B",
  color_gradient_high = "#9E0142"
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>add_facet</code></dt>
<dd>
<p>default TRUE; whether use group names as the facets in the plot, see <code>trans_func$func_group_list</code> object.</p>
</dd>
<dt><code>order_x</code></dt>
<dd>
<p>default NULL; character vector; to sort the x axis text; can be also used to select partial samples to show.</p>
</dd>
<dt><code>color_gradient_low</code></dt>
<dd>
<p>default "#00008B"; the color used as the low end in the color gradient.</p>
</dd>
<dt><code>color_gradient_high</code></dt>
<dd>
<p>default "#9E0142"; the color used as the high end in the color gradient.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>ggplot2.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>\donttest{
t1$plot_spe_func_perc()
}
</pre>
</div>


<hr>
<a id="method-trans_func-cal_tax4fun"></a>



<h4>Method <code>cal_tax4fun()</code>
</h4>

<p>Predict functional potential of communities using <code>Tax4Fun</code> package.
please cite: Tax4Fun: Predicting functional profiles from metagenomic 16S rRNA data. Bioinformatics, 31(17), 2882-2884, &lt;doi:10.1093/bioinformatics/btv287&gt;.
Note that this function requires a standard prefix in taxonomic table with double underlines (e.g. 'g__') .
</p>


<h5>Usage</h5>

<div class="r"><pre>trans_func$cal_tax4fun(keep_tem = FALSE, folderReferenceData = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>keep_tem</code></dt>
<dd>
<p>default FALSE; whether keep the intermediate file, that is, the feature table in local place.</p>
</dd>
<dt><code>folderReferenceData</code></dt>
<dd>
<p>default NULL; the folder, see Tax4Fun function in Tax4Fun package.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p><code>tax4fun_KO</code> and <code>tax4fun_path</code> in object.
</p>


<hr>
<a id="method-trans_func-cal_tax4fun2"></a>



<h4>Method <code>cal_tax4fun2()</code>
</h4>

<p>Predict functional potential of communities with Tax4Fun2 method. 
The function was adapted from the raw Tax4Fun2 package to make it compatible with the microtable object.
Pleas cite: 
Tax4Fun2: prediction of habitat-specific functional profiles and functional redundancy based on 16S rRNA gene sequences. Environmental Microbiome 15, 11 (2020).
&lt;doi:10.1186/s40793-020-00358-7&gt;
</p>


<h5>Usage</h5>

<div class="r"><pre>trans_func$cal_tax4fun2(
  blast_tool_path = NULL,
  path_to_reference_data = "Tax4Fun2_ReferenceData_v2",
  path_to_temp_folder = NULL,
  database_mode = "Ref99NR",
  normalize_by_copy_number = T,
  min_identity_to_reference = 97,
  use_uproc = T,
  num_threads = 1,
  normalize_pathways = F
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>blast_tool_path</code></dt>
<dd>
<p>default NULL; the folder path, e.g., ncbi-blast-2.5.0+/bin ; blast tools folder downloaded from 
"ftp://ftp.ncbi.nlm.nih.gov/blast/executables/blast+"  ; e.g., ncbi-blast-2.5.0+-x64-win64.tar.gz  for windows system; 
if blast_tool_path is NULL, search the tools in the environmental path variable.</p>
</dd>
<dt><code>path_to_reference_data</code></dt>
<dd>
<p>default "Tax4Fun2_ReferenceData_v2"; the path that points to files used in the prediction; 
The directory must contain the Ref99NR or Ref100NR folder; 
download Ref99NR.zip from "https://cloudstor.aarnet.edu.au/plus/s/DkoZIyZpMNbrzSw/download" or 
Ref100NR.zip from "https://cloudstor.aarnet.edu.au/plus/s/jIByczak9ZAFUB4/download".</p>
</dd>
<dt><code>path_to_temp_folder</code></dt>
<dd>
<p>default NULL; The temporary folder to store the logfile, intermediate file and result files; if NULL, 
use the default temporary in the computer system.</p>
</dd>
<dt><code>database_mode</code></dt>
<dd>
<p>default 'Ref99NR'; "Ref99NR" or "Ref100NR"; Ref99NR: 99% clustering reference database; Ref100NR: no clustering.</p>
</dd>
<dt><code>normalize_by_copy_number</code></dt>
<dd>
<p>default TRUE; whether normalize the result by the 16S rRNA copy number in the genomes.</p>
</dd>
<dt><code>min_identity_to_reference</code></dt>
<dd>
<p>default 97; the sequences identity threshold used for finding the nearest species.</p>
</dd>
<dt><code>use_uproc</code></dt>
<dd>
<p>default TRUE; whether use UProC to functionally anotate the genomes in the reference data.</p>
</dd>
<dt><code>num_threads</code></dt>
<dd>
<p>default 1; the threads used in the blastn.</p>
</dd>
<dt><code>normalize_pathways</code></dt>
<dd>
<p>default FALSE; Different to Tax4Fun, when converting from KEGG functions to KEGG pathways, 
Tax4Fun2 does not equally split KO gene abundances between pathways a functions is affiliated to. The full predicted abundance is affiliated to each pathway. 
Use TRUE to split the abundances (default is FALSE).</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p><code>res_tax4fun2_KO</code> and <code>res_tax4fun2_pathway</code> in object.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>\dontrun{
t1$cal_tax4fun2(blast_tool_path = "ncbi-blast-2.5.0+/bin", 
    path_to_reference_data = "Tax4Fun2_ReferenceData_v2")
}
</pre>
</div>


<hr>
<a id="method-trans_func-cal_tax4fun2_FRI"></a>



<h4>Method <code>cal_tax4fun2_FRI()</code>
</h4>

<p>Calculate (multi-) functional redundancy index (FRI) of prokaryotic community with Tax4Fun2 method.
This function is used to calculating aFRI and rFRI use the intermediate files generated by the function cal_tax4fun2().
please also cite: 
Tax4Fun2: prediction of habitat-specific functional profiles and functional redundancy based on 16S rRNA gene sequences. 
Environmental Microbiome 15, 11 (2020). &lt;doi:10.1186/s40793-020-00358-7&gt;
</p>


<h5>Usage</h5>

<div class="r"><pre>trans_func$cal_tax4fun2_FRI()</pre></div>



<h5>Returns</h5>

<p>res_tax4fun2_aFRI and res_tax4fun2_rFRI in object.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>\dontrun{
t1$cal_tax4fun2_FRI()
}
</pre>
</div>


<hr>
<a id="method-trans_func-print"></a>



<h4>Method <code>print()</code>
</h4>

<p>Print the trans_func object.
</p>


<h5>Usage</h5>

<div class="r"><pre>trans_func$print()</pre></div>


<hr>
<a id="method-trans_func-clone"></a>



<h4>Method <code>clone()</code>
</h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>trans_func$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt>
<dd>
<p>Whether to make a deep clone.</p>
</dd>
</dl>
</div>




<h3>Examples</h3>

<pre><code class="language-R">
## ------------------------------------------------
## Method `trans_func$new`
## ------------------------------------------------

data(dataset)
t1 &lt;- trans_func$new(dataset = dataset)

## ------------------------------------------------
## Method `trans_func$cal_spe_func`
## ------------------------------------------------


t1$cal_spe_func(prok_database = "FAPROTAX")


## ------------------------------------------------
## Method `trans_func$cal_spe_func_perc`
## ------------------------------------------------


t1$cal_spe_func_perc(abundance_weighted = TRUE)


## ------------------------------------------------
## Method `trans_func$show_prok_func`
## ------------------------------------------------


t1$show_prok_func(use_func = "methanotrophy")


## ------------------------------------------------
## Method `trans_func$trans_spe_func_perc`
## ------------------------------------------------


t1$trans_spe_func_perc()


## ------------------------------------------------
## Method `trans_func$plot_spe_func_perc`
## ------------------------------------------------


t1$plot_spe_func_perc()


## ------------------------------------------------
## Method `trans_func$cal_tax4fun2`
## ------------------------------------------------

## Not run: 
t1$cal_tax4fun2(blast_tool_path = "ncbi-blast-2.5.0+/bin", 
    path_to_reference_data = "Tax4Fun2_ReferenceData_v2")

## End(Not run)

## ------------------------------------------------
## Method `trans_func$cal_tax4fun2_FRI`
## ------------------------------------------------

## Not run: 
t1$cal_tax4fun2_FRI()

## End(Not run)
</code></pre>


</div>