<div class="container">

<table style="width: 100%;"><tr>
<td>microtable</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create <code>microtable</code> object to store and manage all the basic files.</h2>

<h3>Description</h3>

<p>This class is a wrapper for a series of operations on the input files and basic manipulations,
including microtable object creation, data trimming, data filtering, rarefaction based on Paul et al. (2013) &lt;doi:10.1371/journal.pone.0061217&gt;, taxonomic abundance calculation, 
alpha and beta diversity calculation based on the An et al. (2019) &lt;doi:10.1016/j.geoderma.2018.09.035&gt; and 
Lozupone et al. (2005) &lt;doi:10.1128/AEM.71.12.8228-8235.2005&gt; and other basic operations.<br><br>
Online tutorial: <a href="https://chiliubio.github.io/microeco_tutorial/">https://chiliubio.github.io/microeco_tutorial/</a> <br>
Download tutorial: <a href="https://github.com/ChiLiubio/microeco_tutorial/releases">https://github.com/ChiLiubio/microeco_tutorial/releases</a>
</p>


<h3>Format</h3>

<p>microtable.
</p>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-microtable-new"><code>microtable$new()</code></a>
</p>
</li>
<li> <p><a href="#method-microtable-filter_pollution"><code>microtable$filter_pollution()</code></a>
</p>
</li>
<li> <p><a href="#method-microtable-filter_taxa"><code>microtable$filter_taxa()</code></a>
</p>
</li>
<li> <p><a href="#method-microtable-rarefy_samples"><code>microtable$rarefy_samples()</code></a>
</p>
</li>
<li> <p><a href="#method-microtable-tidy_dataset"><code>microtable$tidy_dataset()</code></a>
</p>
</li>
<li> <p><a href="#method-microtable-add_rownames2taxonomy"><code>microtable$add_rownames2taxonomy()</code></a>
</p>
</li>
<li> <p><a href="#method-microtable-sample_sums"><code>microtable$sample_sums()</code></a>
</p>
</li>
<li> <p><a href="#method-microtable-taxa_sums"><code>microtable$taxa_sums()</code></a>
</p>
</li>
<li> <p><a href="#method-microtable-sample_names"><code>microtable$sample_names()</code></a>
</p>
</li>
<li> <p><a href="#method-microtable-taxa_names"><code>microtable$taxa_names()</code></a>
</p>
</li>
<li> <p><a href="#method-microtable-rename_taxa"><code>microtable$rename_taxa()</code></a>
</p>
</li>
<li> <p><a href="#method-microtable-merge_samples"><code>microtable$merge_samples()</code></a>
</p>
</li>
<li> <p><a href="#method-microtable-merge_taxa"><code>microtable$merge_taxa()</code></a>
</p>
</li>
<li> <p><a href="#method-microtable-save_table"><code>microtable$save_table()</code></a>
</p>
</li>
<li> <p><a href="#method-microtable-cal_abund"><code>microtable$cal_abund()</code></a>
</p>
</li>
<li> <p><a href="#method-microtable-save_abund"><code>microtable$save_abund()</code></a>
</p>
</li>
<li> <p><a href="#method-microtable-cal_alphadiv"><code>microtable$cal_alphadiv()</code></a>
</p>
</li>
<li> <p><a href="#method-microtable-save_alphadiv"><code>microtable$save_alphadiv()</code></a>
</p>
</li>
<li> <p><a href="#method-microtable-cal_betadiv"><code>microtable$cal_betadiv()</code></a>
</p>
</li>
<li> <p><a href="#method-microtable-save_betadiv"><code>microtable$save_betadiv()</code></a>
</p>
</li>
<li> <p><a href="#method-microtable-print"><code>microtable$print()</code></a>
</p>
</li>
<li> <p><a href="#method-microtable-clone"><code>microtable$clone()</code></a>
</p>
</li>
</ul>
<hr>
<a id="method-microtable-new"></a>



<h4>Method <code>new()</code>
</h4>



<h5>Usage</h5>

<div class="r"><pre>microtable$new(
  otu_table,
  sample_table = NULL,
  tax_table = NULL,
  phylo_tree = NULL,
  rep_fasta = NULL,
  auto_tidy = FALSE
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>otu_table</code></dt>
<dd>
<p>data.frame; The feature abundance table; rownames are features (e.g. OTUs/ASVs/species/genes); column names are samples.</p>
</dd>
<dt><code>sample_table</code></dt>
<dd>
<p>data.frame; default NULL; The sample information table; rownames are samples; columns are sample metadata; 
If not provided, the function can generate a table automatically according to the sample names in otu_table.</p>
</dd>
<dt><code>tax_table</code></dt>
<dd>
<p>data.frame; default NULL; The taxonomic information table; rownames are features; column names are taxonomic classes.</p>
</dd>
<dt><code>phylo_tree</code></dt>
<dd>
<p>phylo; default NULL; The phylogenetic tree; use <code>read.tree</code> function in ape package for input.</p>
</dd>
<dt><code>rep_fasta</code></dt>
<dd>
<p><code>DNAStringSet</code> or <code>list</code> format; default NULL; The representative sequences; 
use <code>read.fasta</code> function in <code>seqinr</code> package or <code>readDNAStringSet</code> function in <code>Biostrings</code> package for input.</p>
</dd>
<dt><code>auto_tidy</code></dt>
<dd>
<p>default FALSE; Whether trim the files in the <code>microtable</code> object automatically;
If TRUE, running the functions in <code>microtable</code> class can invoke the <code>tidy_dataset</code> function automatically.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>an object of class <code>microtable</code> with the following components:
</p>

<dl>
<dt><code>sample_table</code></dt>
<dd>
<p>The sample information table.</p>
</dd>
<dt><code>otu_table</code></dt>
<dd>
<p>The feature table.</p>
</dd>
<dt><code>tax_table</code></dt>
<dd>
<p>The taxonomic table.</p>
</dd>
<dt><code>phylo_tree</code></dt>
<dd>
<p>The phylogenetic tree.</p>
</dd>
<dt><code>rep_fasta</code></dt>
<dd>
<p>The representative sequence.</p>
</dd>
<dt><code>taxa_abund</code></dt>
<dd>
<p>default NULL; use <code>cal_abund</code> function to calculate.</p>
</dd>
<dt><code>alpha_diversity</code></dt>
<dd>
<p>default NULL; use <code>cal_alphadiv</code> function to calculate.</p>
</dd>
<dt><code>beta_diversity</code></dt>
<dd>
<p>default NULL; use <code>cal_betadiv</code> function to calculate.</p>
</dd>
</dl>
<h5>Examples</h5>

<div class="r example copy">
<pre>data(otu_table_16S)
data(taxonomy_table_16S)
data(sample_info_16S)
data(phylo_tree_16S)
m1 &lt;- microtable$new(otu_table = otu_table_16S)
m1 &lt;- microtable$new(sample_table = sample_info_16S, otu_table = otu_table_16S, 
  tax_table = taxonomy_table_16S, phylo_tree = phylo_tree_16S)
# trim the files in the dataset
m1$tidy_dataset()
</pre>
</div>


<hr>
<a id="method-microtable-filter_pollution"></a>



<h4>Method <code>filter_pollution()</code>
</h4>

<p>Filter the features considered pollution in <code>microtable$tax_table</code>.
This operation will remove any line of the <code>microtable$tax_table</code> containing any the word in taxa parameter regardless of word case.
</p>


<h5>Usage</h5>

<div class="r"><pre>microtable$filter_pollution(taxa = c("mitochondria", "chloroplast"))</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>taxa</code></dt>
<dd>
<p>default <code>c("mitochondria", "chloroplast")</code>; filter mitochondria and chloroplast, or others as needed.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>None
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>m1$filter_pollution(taxa = c("mitochondria", "chloroplast"))
</pre>
</div>


<hr>
<a id="method-microtable-filter_taxa"></a>



<h4>Method <code>filter_taxa()</code>
</h4>

<p>Filter the feature with low abundance and/or low occurrence frequency.
</p>


<h5>Usage</h5>

<div class="r"><pre>microtable$filter_taxa(rel_abund = 0, freq = 1, include_lowest = TRUE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>rel_abund</code></dt>
<dd>
<p>default 0; the relative abundance threshold, such as 0.0001.</p>
</dd>
<dt><code>freq</code></dt>
<dd>
<p>default 1; the occurrence frequency threshold. 
For example, the number 2 represents filtering the feature that occurs less than 2 times.
A number smaller than 1 is also allowable. 
For instance, the number 0.1 represents filtering the feature that occurs in less than 10% samples.</p>
</dd>
<dt><code>include_lowest</code></dt>
<dd>
<p>default TRUE; whether include the feature with the threshold.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>None
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>\donttest{
d1 &lt;- clone(m1)
d1$filter_taxa(rel_abund = 0.0001, freq = 0.2)
}
</pre>
</div>


<hr>
<a id="method-microtable-rarefy_samples"></a>



<h4>Method <code>rarefy_samples()</code>
</h4>

<p>Rarefy communities to make all samples have same count number.
</p>


<h5>Usage</h5>

<div class="r"><pre>microtable$rarefy_samples(method = c("rarefy", "SRS")[1], sample.size, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>method</code></dt>
<dd>
<p>default c("rarefy", "SRS")[1]; "rarefy" represents the classical resampling like <code>rrarefy</code> function of <code>vegan</code> package.
"SRS" is scaling with ranked subsampling method based on the SRS package provided by Lukas Beule and Petr Karlovsky (2020) &lt;DOI:10.7717/peerj.9593&gt;.</p>
</dd>
<dt><code>sample.size</code></dt>
<dd>
<p>default NULL; libray size. If not provided, use the minimum number across all samples. 
For "SRS" method, this parameter is passed to <code>Cmin</code> parameter of <code>SRS</code> function of SRS package.</p>
</dd>
<dt><code>...</code></dt>
<dd>
<p>parameters pass to <code>norm</code> function of <code>trans_norm</code> class.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>None; rarefied dataset.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>\donttest{
m1$rarefy_samples(sample.size = min(m1$sample_sums()))
}
</pre>
</div>


<hr>
<a id="method-microtable-tidy_dataset"></a>



<h4>Method <code>tidy_dataset()</code>
</h4>

<p>Trim all the data in the <code>microtable</code> object to make taxa and samples consistent. The results are intersections across data.
</p>


<h5>Usage</h5>

<div class="r"><pre>microtable$tidy_dataset(main_data = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>main_data</code></dt>
<dd>
<p>default FALSE; if TRUE, only basic data in <code>microtable</code> object is trimmed. Otherwise, all data, 
including <code>taxa_abund</code>, <code>alpha_diversity</code> and <code>beta_diversity</code>, are all trimed.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>None. The data in the object are tidied up. 
If <code>tax_table</code> is in object, its row names are totally same with the row names of <code>otu_table</code>.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>m1$tidy_dataset(main_data = TRUE)
</pre>
</div>


<hr>
<a id="method-microtable-add_rownames2taxonomy"></a>



<h4>Method <code>add_rownames2taxonomy()</code>
</h4>

<p>Add the rownames of <code>microtable$tax_table</code> as its last column. 
This is especially useful when the rownames of <code>microtable$tax_table</code> are required as a taxonomic level 
for the taxonomic abundance calculation and biomarker idenfification.
</p>


<h5>Usage</h5>

<div class="r"><pre>microtable$add_rownames2taxonomy(use_name = "OTU")</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>use_name</code></dt>
<dd>
<p>default "OTU"; The column name used in the <code>tax_table</code>.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>NULL, a new tax_table stored in the object.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>\donttest{
m1$add_rownames2taxonomy()
}
</pre>
</div>


<hr>
<a id="method-microtable-sample_sums"></a>



<h4>Method <code>sample_sums()</code>
</h4>

<p>Sum the species number for each sample.
</p>


<h5>Usage</h5>

<div class="r"><pre>microtable$sample_sums()</pre></div>



<h5>Returns</h5>

<p>species number of samples.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>\donttest{
m1$sample_sums()
}
</pre>
</div>


<hr>
<a id="method-microtable-taxa_sums"></a>



<h4>Method <code>taxa_sums()</code>
</h4>

<p>Sum the species number for each taxa.
</p>


<h5>Usage</h5>

<div class="r"><pre>microtable$taxa_sums()</pre></div>



<h5>Returns</h5>

<p>species number of taxa.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>\donttest{
m1$taxa_sums()
}
</pre>
</div>


<hr>
<a id="method-microtable-sample_names"></a>



<h4>Method <code>sample_names()</code>
</h4>

<p>Show sample names.
</p>


<h5>Usage</h5>

<div class="r"><pre>microtable$sample_names()</pre></div>



<h5>Returns</h5>

<p>sample names.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>\donttest{
m1$sample_names()
}
</pre>
</div>


<hr>
<a id="method-microtable-taxa_names"></a>



<h4>Method <code>taxa_names()</code>
</h4>

<p>Show taxa names of tax_table.
</p>


<h5>Usage</h5>

<div class="r"><pre>microtable$taxa_names()</pre></div>



<h5>Returns</h5>

<p>taxa names.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>\donttest{
m1$taxa_names()
}
</pre>
</div>


<hr>
<a id="method-microtable-rename_taxa"></a>



<h4>Method <code>rename_taxa()</code>
</h4>

<p>Rename the features, including the rownames of <code>otu_table</code>, rownames of <code>tax_table</code>, tip labels of <code>phylo_tree</code> and <code>rep_fasta</code>.
</p>


<h5>Usage</h5>

<div class="r"><pre>microtable$rename_taxa(newname_prefix = "ASV_")</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>newname_prefix</code></dt>
<dd>
<p>default "ASV_"; the prefix of new names; new names will be newname_prefix + numbers according to the rownames order of <code>otu_table</code>.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>None; renamed dataset.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>\donttest{
m1$rename_taxa()
}
</pre>
</div>


<hr>
<a id="method-microtable-merge_samples"></a>



<h4>Method <code>merge_samples()</code>
</h4>

<p>Merge samples according to specific group to generate a new <code>microtable</code>.
</p>


<h5>Usage</h5>

<div class="r"><pre>microtable$merge_samples(group)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>group</code></dt>
<dd>
<p>a column name in <code>sample_table</code> of <code>microtable</code> object.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>a new merged microtable object.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>\donttest{
m1$merge_samples("Group")
}
</pre>
</div>


<hr>
<a id="method-microtable-merge_taxa"></a>



<h4>Method <code>merge_taxa()</code>
</h4>

<p>Merge taxa according to specific taxonomic rank to generate a new <code>microtable</code>.
</p>


<h5>Usage</h5>

<div class="r"><pre>microtable$merge_taxa(taxa = "Genus")</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>taxa</code></dt>
<dd>
<p>default "Genus"; the specific rank in <code>tax_table</code>.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>a new merged <code>microtable</code> object.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>\donttest{
m1$merge_taxa(taxa = "Genus")
}
</pre>
</div>


<hr>
<a id="method-microtable-save_table"></a>



<h4>Method <code>save_table()</code>
</h4>

<p>Save each basic data in microtable object as local file.
</p>


<h5>Usage</h5>

<div class="r"><pre>microtable$save_table(dirpath = "basic_files", sep = ",", ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>dirpath</code></dt>
<dd>
<p>default "basic_files"; directory to save the tables, phylogenetic tree and sequences in microtable object. It will be created if not found.</p>
</dd>
<dt><code>sep</code></dt>
<dd>
<p>default ","; the field separator string, used to save tables. Same with <code>sep</code> parameter in <code>write.table</code> function.
default <code>','</code> correspond to the file name suffix 'csv'. The option <code>'\t'</code> correspond to the file name suffix 'tsv'. For other options, suffix are all 'txt'.</p>
</dd>
<dt><code>...</code></dt>
<dd>
<p>parameters passed to <code>write.table</code>.</p>
</dd>
</dl>
</div>



<h5>Examples</h5>

<div class="r example copy">
<pre>\dontrun{
m1$save_table()
}
</pre>
</div>


<hr>
<a id="method-microtable-cal_abund"></a>



<h4>Method <code>cal_abund()</code>
</h4>

<p>Calculate the taxonomic abundance at each taxonomic level or selected levels.
</p>


<h5>Usage</h5>

<div class="r"><pre>microtable$cal_abund(
  select_cols = NULL,
  rel = TRUE,
  merge_by = "|",
  split_group = FALSE,
  split_by = "&amp;&amp;",
  split_column = NULL
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>select_cols</code></dt>
<dd>
<p>default NULL; numeric vector or character vector of colnames of <code>microtable$tax_table</code>; 
applied to select columns to merge and calculate abundances according to ordered hierarchical levels.
This is very useful if there are commented columns or some columns with multiple structure that cannot be used directly.</p>
</dd>
<dt><code>rel</code></dt>
<dd>
<p>default TRUE; if TRUE, relative abundance is used; if FALSE, absolute abundance (i.e. raw values) will be summed.</p>
</dd>
<dt><code>merge_by</code></dt>
<dd>
<p>default "|"; the symbol to merge and concatenate taxonomic names of different levels.</p>
</dd>
<dt><code>split_group</code></dt>
<dd>
<p>default FALSE; if TRUE, split the rows to multiple rows according to one or more columns in <code>tax_table</code>. 
Very useful when multiple mapping information exist.</p>
</dd>
<dt><code>split_by</code></dt>
<dd>
<p>default "&amp;&amp;"; Separator delimiting collapsed values; only useful when <code>split_group = TRUE</code>; 
see <code>sep</code> parameter in <code>separate_rows</code> function of tidyr package.</p>
</dd>
<dt><code>split_column</code></dt>
<dd>
<p>default NULL; character vector or list; only useful when <code>split_group = TRUE</code>; character vector: 
fixed column or columns used for the splitting in tax_table for each abundance calculation; 
list: containing more character vectors to assign the column names to each calculation, such as list(c("Phylum"), c("Phylum", "Class")).</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>taxa_abund list in object.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>\donttest{
m1$cal_abund()
}
</pre>
</div>


<hr>
<a id="method-microtable-save_abund"></a>



<h4>Method <code>save_abund()</code>
</h4>

<p>Save taxonomic abundance as local file.
</p>


<h5>Usage</h5>

<div class="r"><pre>microtable$save_abund(
  dirpath = "taxa_abund",
  merge_all = FALSE,
  rm_un = FALSE,
  rm_pattern = "__$",
  sep = ",",
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>dirpath</code></dt>
<dd>
<p>default "taxa_abund"; directory to save the taxonomic abundance files. It will be created if not found.</p>
</dd>
<dt><code>merge_all</code></dt>
<dd>
<p>default FALSE; Whether merge all tables into one. The merged file format is generally called 'mpa' style.</p>
</dd>
<dt><code>rm_un</code></dt>
<dd>
<p>default FALSE; Whether remove unclassified taxa in which the name ends with '__' generally.</p>
</dd>
<dt><code>rm_pattern</code></dt>
<dd>
<p>default "__$"; The pattern searched through the merged taxonomic names. See also <code>pattern</code> parameter in <code>grepl</code> function. 
Only available when <code>rm_un = TRUE</code>. The default "__$" means removing the names end with '__'.</p>
</dd>
<dt><code>sep</code></dt>
<dd>
<p>default ","; the field separator string. Same with <code>sep</code> parameter in <code>write.table</code> function.
default <code>','</code> correspond to the file name suffix 'csv'. The option <code>'\t'</code> correspond to the file name suffix 'tsv'. For other options, suffix are all 'txt'.</p>
</dd>
<dt><code>...</code></dt>
<dd>
<p>parameters passed to <code>write.table</code>.</p>
</dd>
</dl>
</div>



<h5>Examples</h5>

<div class="r example copy">
<pre>\dontrun{
m1$save_abund(dirpath = "taxa_abund")
m1$save_abund(merge_all = TRUE, rm_un = TRUE, sep = "\t")
}
</pre>
</div>


<hr>
<a id="method-microtable-cal_alphadiv"></a>



<h4>Method <code>cal_alphadiv()</code>
</h4>

<p>Calculate alpha diversity.
</p>


<h5>Usage</h5>

<div class="r"><pre>microtable$cal_alphadiv(measures = NULL, PD = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>measures</code></dt>
<dd>
<p>default NULL; one or more indexes in <code>c("Observed", "Coverage", "Chao1", "ACE", "Shannon", "Simpson", "InvSimpson", "Fisher", "Pielou")</code>; 
The default NULL represents that all the measures are calculated. 'Shannon', 'Simpson' and 'InvSimpson' are calculated based on <code>vegan::diversity</code> function;
'Chao1' and 'ACE' depend on the function <code>vegan::estimateR</code>.
'Fisher' index relies on the function <code>vegan::fisher.alpha</code>.
"Observed" means the observed species number in a community, i.e. richness.
"Coverage" represents good's coverage. It is defined:
</p>
<p style="text-align: center;"><code class="reqn">Coverage = 1 - \frac{f1}{n}</code>
</p>
 
<p>where <em>n</em> is the total abundance of a sample, and <em>f1</em> is the number of singleton (species with abundance 1) in the sample.
"Pielou" denotes the Pielou evenness index. It is defined:
</p>
<p style="text-align: center;"><code class="reqn">J = \frac{H'}{\ln(S)}</code>
</p>

<p>where <em>H'</em> is Shannon index, and <em>S</em> is the species number.</p>
</dd>
<dt><code>PD</code></dt>
<dd>
<p>default FALSE; whether Faith's phylogenetic diversity is calculated. The calculation depends on the function <code>picante::pd</code>.
Note that the phylogenetic tree (<code>phylo_tree</code> object in the data) is required for PD.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>alpha_diversity stored in the object. The se.chao1 and se.ACE are the standard erros of Chao1 and ACE, respectively.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>\donttest{
m1$cal_alphadiv(measures = NULL, PD = FALSE)
class(m1$alpha_diversity)
}
</pre>
</div>


<hr>
<a id="method-microtable-save_alphadiv"></a>



<h4>Method <code>save_alphadiv()</code>
</h4>

<p>Save alpha diversity table to the computer.
</p>


<h5>Usage</h5>

<div class="r"><pre>microtable$save_alphadiv(dirpath = "alpha_diversity")</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>dirpath</code></dt>
<dd>
<p>default "alpha_diversity"; directory name to save the alpha_diversity.csv file.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-microtable-cal_betadiv"></a>



<h4>Method <code>cal_betadiv()</code>
</h4>

<p>Calculate beta diversity dissimilarity matrix, such as Bray-Curtis, Jaccard, and UniFrac.
See An et al. (2019) &lt;doi:10.1016/j.geoderma.2018.09.035&gt; and Lozupone et al. (2005) &lt;doi:10.1128/AEM.71.12.8228–8235.2005&gt;.
</p>


<h5>Usage</h5>

<div class="r"><pre>microtable$cal_betadiv(method = NULL, unifrac = FALSE, binary = FALSE, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>method</code></dt>
<dd>
<p>default NULL; a character vector with one or more elements; <code>c("bray", "jaccard")</code> is used when <code>method = NULL</code>; 
See the <code>method</code> parameter in <code>vegdist</code> function for more available options, such as 'aitchison' and 'robust.aitchison'.</p>
</dd>
<dt><code>unifrac</code></dt>
<dd>
<p>default FALSE; whether UniFrac indexes (weighted and unweighted) are calculated. Phylogenetic tree is necessary when <code>unifrac = TRUE</code>.</p>
</dd>
<dt><code>binary</code></dt>
<dd>
<p>default FALSE; Whether convert abundance to binary data (presence/absence) when <code>method</code> is not "jaccard". 
TRUE is used for "jaccard" automatically.</p>
</dd>
<dt><code>...</code></dt>
<dd>
<p>parameters passed to <code>vegdist</code> function of vegan package.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>beta_diversity list stored in the object.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>\donttest{
m1$cal_betadiv(unifrac = FALSE)
class(m1$beta_diversity)
}
</pre>
</div>


<hr>
<a id="method-microtable-save_betadiv"></a>



<h4>Method <code>save_betadiv()</code>
</h4>

<p>Save beta diversity matrix to the computer.
</p>


<h5>Usage</h5>

<div class="r"><pre>microtable$save_betadiv(dirpath = "beta_diversity")</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>dirpath</code></dt>
<dd>
<p>default "beta_diversity"; directory name to save the beta diversity matrix files.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-microtable-print"></a>



<h4>Method <code>print()</code>
</h4>

<p>Print the microtable object.
</p>


<h5>Usage</h5>

<div class="r"><pre>microtable$print()</pre></div>


<hr>
<a id="method-microtable-clone"></a>



<h4>Method <code>clone()</code>
</h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>microtable$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt>
<dd>
<p>Whether to make a deep clone.</p>
</dd>
</dl>
</div>




<h3>Examples</h3>

<pre><code class="language-R">
## ------------------------------------------------
## Method `microtable$new`
## ------------------------------------------------

data(otu_table_16S)
data(taxonomy_table_16S)
data(sample_info_16S)
data(phylo_tree_16S)
m1 &lt;- microtable$new(otu_table = otu_table_16S)
m1 &lt;- microtable$new(sample_table = sample_info_16S, otu_table = otu_table_16S, 
  tax_table = taxonomy_table_16S, phylo_tree = phylo_tree_16S)
# trim the files in the dataset
m1$tidy_dataset()

## ------------------------------------------------
## Method `microtable$filter_pollution`
## ------------------------------------------------

m1$filter_pollution(taxa = c("mitochondria", "chloroplast"))

## ------------------------------------------------
## Method `microtable$filter_taxa`
## ------------------------------------------------


d1 &lt;- clone(m1)
d1$filter_taxa(rel_abund = 0.0001, freq = 0.2)


## ------------------------------------------------
## Method `microtable$rarefy_samples`
## ------------------------------------------------


m1$rarefy_samples(sample.size = min(m1$sample_sums()))


## ------------------------------------------------
## Method `microtable$tidy_dataset`
## ------------------------------------------------

m1$tidy_dataset(main_data = TRUE)

## ------------------------------------------------
## Method `microtable$add_rownames2taxonomy`
## ------------------------------------------------


m1$add_rownames2taxonomy()


## ------------------------------------------------
## Method `microtable$sample_sums`
## ------------------------------------------------


m1$sample_sums()


## ------------------------------------------------
## Method `microtable$taxa_sums`
## ------------------------------------------------


m1$taxa_sums()


## ------------------------------------------------
## Method `microtable$sample_names`
## ------------------------------------------------


m1$sample_names()


## ------------------------------------------------
## Method `microtable$taxa_names`
## ------------------------------------------------


m1$taxa_names()


## ------------------------------------------------
## Method `microtable$rename_taxa`
## ------------------------------------------------


m1$rename_taxa()


## ------------------------------------------------
## Method `microtable$merge_samples`
## ------------------------------------------------


m1$merge_samples("Group")


## ------------------------------------------------
## Method `microtable$merge_taxa`
## ------------------------------------------------


m1$merge_taxa(taxa = "Genus")


## ------------------------------------------------
## Method `microtable$save_table`
## ------------------------------------------------

## Not run: 
m1$save_table()

## End(Not run)

## ------------------------------------------------
## Method `microtable$cal_abund`
## ------------------------------------------------


m1$cal_abund()


## ------------------------------------------------
## Method `microtable$save_abund`
## ------------------------------------------------

## Not run: 
m1$save_abund(dirpath = "taxa_abund")
m1$save_abund(merge_all = TRUE, rm_un = TRUE, sep = "\t")

## End(Not run)

## ------------------------------------------------
## Method `microtable$cal_alphadiv`
## ------------------------------------------------


m1$cal_alphadiv(measures = NULL, PD = FALSE)
class(m1$alpha_diversity)


## ------------------------------------------------
## Method `microtable$cal_betadiv`
## ------------------------------------------------


m1$cal_betadiv(unifrac = FALSE)
class(m1$beta_diversity)

</code></pre>


</div>