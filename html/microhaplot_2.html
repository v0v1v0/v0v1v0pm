<div class="container">

<table style="width: 100%;"><tr>
<td>prepHaplotFiles</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extracts haplotype from alignment reads.</h2>

<h3>Description</h3>

<p>The function <code>microhaplot</code> extracts haplotype from sequence alignment files through perl script <code>hapture</code> and returns a summary table of the read depth and read quality associate with haplotype.
</p>


<h3>Usage</h3>

<pre><code class="language-R">prepHaplotFiles(run.label, sam.path, label.path, vcf.path,
  out.path = tempdir(), add.filter = FALSE, app.path = tempdir(),
  n.jobs = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>run.label</code></td>
<td>
<p>character vector. Run label to be used to display in haPLOType. Required</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sam.path</code></td>
<td>
<p>string. Directory path folder containing all sequence alignment files (SAM). Required</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label.path</code></td>
<td>
<p>string. Label file path. This customized label file is a tab-separate file that contains entries of SAM file name, individual ID, and group label. Required</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcf.path</code></td>
<td>
<p>string. VCF file path. Required</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out.path</code></td>
<td>
<p>string. Optional. If not specified, the intermediate files are created under <code>TEMPDIR</code>, with the assumption that directory is granted for written permission.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.filter</code></td>
<td>
<p>boolean. Optional. If true, this removes any haplotype with unknown and deletion alignment characters i.e. "*" and "_", removes any locus with large number of haplotypes ( # &gt; 40) , and remove any locus with fewer than half of the total individuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>app.path</code></td>
<td>
<p>string. Path to shiny haPLOType app. Optional. If not specified, the path is default to <code>TEMPDIR</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.jobs</code></td>
<td>
<p>positive integer. Number of SAM files to be parallel processed. Optional. This multithread is only available for non Window OS. Recommend two times the number of processors/core.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>This function returns a dataframe of 9 columns i.e group, id, locus, haplotype, depth, sum of Phred score, max of Phred score, allele balance and haplotype rank from highest to lowest read depth. This dataframe will also be saved in <code>out.path</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
run.label &lt;- "sebastes"

sam.path &lt;- tempdir()
untar(system.file("extdata",
                  "sebastes_sam.tar.gz",
                  package="microhaplot"),
      exdir = sam.path)


label.path &lt;- file.path(sam.path, "label.txt")
vcf.path &lt;- file.path(sam.path, "sebastes.vcf")

mvShinyHaplot(tempdir())
app.path &lt;- file.path(tempdir(), "microhaplot")

# retrieve system Perl version number
perl.version &lt;- as.numeric(system('perl -e "print $];"', intern=TRUE))

if (perl.version &gt;= 5.014) {
haplo.read.tbl &lt;- prepHaplotFiles(run.label = run.label,
                            sam.path = sam.path,
                            out.path = tempdir(),
                            label.path = label.path,
                            vcf.path = vcf.path,
                            app.path = app.path)
}else {
message("Perl version is outdated. Must &gt;= 5.014.")}

</code></pre>


</div>