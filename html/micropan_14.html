<div class="container">

<table style="width: 100%;"><tr>
<td>heaps</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Heaps law estimate</h2>

<h3>Description</h3>

<p>Estimating if a pan-genome is open or closed based on a Heaps law model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">heaps(pan.matrix, n.perm = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pan.matrix</code></td>
<td>
<p>A pan-matrix, see <code>panMatrix</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.perm</code></td>
<td>
<p>The number of random permutations of genome ordering.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>An open pan-genome means there will always be new gene clusters observed as long as new genomes
are being sequenced. This may sound controversial, but in a pragmatic view, an open pan-genome indicates
that the number of new gene clusters to be observed in future genomes is ‘large’ (but not literally
infinite). Opposite, a closed pan-genome indicates we are approaching the end of new gene clusters. 
</p>
<p>This function is based on a Heaps law approach suggested by Tettelin et al (2008). The Heaps law model
is fitted to the number of new gene clusters observed when genomes are ordered in a random way. The model
has two parameters, an intercept and a decay parameter called ‘<span class="samp">⁠alpha⁠</span>’. If ‘<span class="samp">⁠alpha&gt;1.0⁠</span>’ the
pan-genome is closed, if ‘<span class="samp">⁠alpha&lt;1.0⁠</span>’ it is open.
</p>
<p>The number of permutations, ‘<span class="samp">⁠n.perm⁠</span>’, should be as large as possible, limited by computation time.
The default value of 100 is certainly a minimum.
</p>
<p>Word of caution: The Heaps law assumes independent sampling. If some of the genomes in the data set
form distinct sub-groups in the population, this may affect the results of this analysis severely.
</p>


<h3>Value</h3>

<p>A vector of two estimated parameters: The ‘<span class="samp">⁠Intercept⁠</span>’ and the decay parameter ‘<span class="samp">⁠alpha⁠</span>’.
If ‘<span class="samp">⁠alpha&lt;1.0⁠</span>’ the pan-genome is open, if ‘<span class="samp">⁠alpha&gt;1.0⁠</span>’ it is closed.
</p>


<h3>Author(s)</h3>

<p>Lars Snipen and Kristian Hovde Liland.
</p>


<h3>References</h3>

<p>Tettelin, H., Riley, D., Cattuto, C., Medini, D. (2008). Comparative genomics: the
bacterial pan-genome. Current Opinions in Microbiology, 12:472-477.
</p>


<h3>See Also</h3>

<p><code>binomixEstimate</code>, <code>chao</code>, <code>rarefaction</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Loading a pan-matrix in this package 
data(xmpl.panmat)

# Estimating population openness
h.est &lt;- heaps(xmpl.panmat, n.perm = 500)
print(h.est)
# If alpha &lt; 1 it indicates an open pan-genome

</code></pre>


</div>