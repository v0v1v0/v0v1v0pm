<div class="container">

<table style="width: 100%;"><tr>
<td>bClust</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Clustering sequences based on pairwise distances</h2>

<h3>Description</h3>

<p>Sequences are clustered by hierarchical clustering based on a set of pariwise distances.
The distances must take values between 0.0 and 1.0, and all pairs <em>not</em> listed are assumed to
have distance 1.0.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bClust(dist.tbl, linkage = "complete", threshold = 0.75, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dist.tbl</code></td>
<td>
<p>A <code>tibble</code> with pairwise distances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linkage</code></td>
<td>
<p>A text indicating what type of clustering to perform, either ‘<span class="samp">⁠complete⁠</span>’ (default),
‘<span class="samp">⁠average⁠</span>’ or ‘<span class="samp">⁠single⁠</span>’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>Specifies the maximum size of a cluster. Must be a distance, i.e. a number between
0.0 and 1.0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical, turns on/off text output during computations.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Computing clusters (gene families) is an essential step in many comparative studies.
<code>bClust</code> will assign sequences into gene families by a hierarchical clustering approach.
Since the number of sequences may be huge, a full all-against-all distance matrix will be impossible
to handle in memory. However, most sequence pairs will have an ‘infinite’ distance between them,
and only the pairs with a finite (smallish) distance need to be considered.
</p>
<p>This function takes as input the distances in <code>dist.tbl</code> where only the relevant distances are
listed. The columns ‘<span class="samp">⁠Query⁠</span>’ and ‘<span class="samp">⁠Hit⁠</span>’ contain tags identifying pairs of sequences. The column
‘<span class="samp">⁠Distance⁠</span>’ contains the distances, always a number from 0.0 to 1.0. Typically, this is the output
from <code>bDist</code>. All pairs of sequences <em>not</em> listed are assumed to have distance 1.0,
which is considered the ‘infinite’ distance.
All sequences must be listed at least once in ceither column ‘<span class="samp">⁠Query⁠</span>’ or ‘<span class="samp">⁠Hit⁠</span>’ of the <code>dist.tbl</code>.
This should pose no problem, since all sequences must have distance 0.0 to themselves, and should be listed
with this distance once (‘<span class="samp">⁠Query⁠</span>’ and ‘<span class="samp">⁠Hit⁠</span>’ containing the same tag). 
</p>
<p>The ‘<span class="samp">⁠linkage⁠</span>’ defines the type of clusters produced. The ‘<span class="samp">⁠threshold⁠</span>’ indicates the size of
the clusters. A ‘<span class="samp">⁠single⁠</span>’ linkage clustering means all members of a cluster have at least one other
member of the same cluster within distance ‘<span class="samp">⁠threshold⁠</span>’ from itself. An ‘<span class="samp">⁠average⁠</span>’ linkage means
all members of a cluster are within the distance ‘<span class="samp">⁠threshold⁠</span>’ from the center of the cluster. A
‘<span class="samp">⁠complete⁠</span>’ linkage means all members of a cluster are no more than the distance ‘<span class="samp">⁠threshold⁠</span>’
away from any other member of the same cluster. 
</p>
<p>Typically, ‘<span class="samp">⁠single⁠</span>’ linkage produces big clusters where members may differ a lot, since they are
only required to be close to something, which is close to something,...,which is close to some other
member. On the other extreme, ‘<span class="samp">⁠complete⁠</span>’ linkage will produce small and tight clusters, since all
must be similar to all. The ‘<span class="samp">⁠average⁠</span>’ linkage is between, but closer to ‘<span class="samp">⁠complete⁠</span>’ linkage. If
you want the ‘<span class="samp">⁠threshold⁠</span>’ to specify directly the maximum distance tolerated between two members of
the same gene family, you must use ‘<span class="samp">⁠complete⁠</span>’ linkage. The ‘<span class="samp">⁠single⁠</span>’ linkage is the fastest
alternative to compute. Using the default setting of ‘<span class="samp">⁠single⁠</span>’ linkage and maximum ‘<span class="samp">⁠threshold⁠</span>’
(1.0) will produce the largest and fewest clusters possible.
</p>


<h3>Value</h3>

<p>The function returns a vector of integers, indicating the cluster membership of every unique
sequence from the ‘<span class="samp">⁠Query⁠</span>’ or ‘<span class="samp">⁠Hit⁠</span>’ columns of the input ‘<span class="samp">⁠dist.tbl⁠</span>’. The name
of each element indicates the sequence. The numerical values have no meaning as such, they are simply
categorical indicators of cluster membership.
</p>


<h3>Author(s)</h3>

<p>Lars Snipen and Kristian Hovde Liland.
</p>


<h3>See Also</h3>

<p><code>bDist</code>, <code>hclust</code>, <code>dClust</code>, <code>isOrtholog</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Loading example BLAST distances
data(xmpl.bdist)

# Clustering with default settings
clst &lt;- bClust(xmpl.bdist)
# Other settings, and verbose
clst &lt;- bClust(xmpl.bdist, linkage = "average", threshold = 0.5, verbose = TRUE)

</code></pre>


</div>