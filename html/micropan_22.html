<div class="container">

<table style="width: 100%;"><tr>
<td>rarefaction</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Rarefaction curves for a pan-genome</h2>

<h3>Description</h3>

<p>Computes rarefaction curves for a number of random permutations of genomes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rarefaction(pan.matrix, n.perm = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pan.matrix</code></td>
<td>
<p>A pan-matrix, see <code>panMatrix</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.perm</code></td>
<td>
<p>The number of random genome orderings to use. If ‘<span class="samp">⁠n.perm=1⁠</span>’ the fixed order of
the genomes in ‘<span class="samp">⁠pan.matrix⁠</span>’ is used.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A rarefaction curve is simply the cumulative number of unique gene clusters we observe as
more and more genomes are being considered. The shape of this curve will depend on the order of the
genomes. This function will typically compute rarefaction curves for a number of (‘<span class="samp">⁠n.perm⁠</span>’)
orderings. By using a large number of permutations, and then averaging over the results, the effect
of any particular ordering is smoothed.
</p>
<p>The averaged curve illustrates how many new gene clusters we observe for each new genome. If this
levels out and becomes flat, it means we expect few, if any, new gene clusters by sequencing more
genomes. The function <code>heaps</code> can be used to estimate population openness based on this
principle.
</p>


<h3>Value</h3>

<p>A table with the curves in the columns. The first column is the number of genomes, while 
all other columns are the cumulative number of clusters, one column for each permutation.
</p>


<h3>Author(s)</h3>

<p>Lars Snipen and Kristian Hovde Liland.
</p>


<h3>See Also</h3>

<p><code>heaps</code>, <code>panMatrix</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Loading a pan-matrix in this package 
data(xmpl.panmat)

# Rarefaction
rar.tbl &lt;- rarefaction(xmpl.panmat, n.perm = 1000)

## Not run: 
# Plotting
library(ggplot2)
library(tidyr)
rar.tbl %&gt;% 
  gather(key = "Permutation", value = "Clusters", -Genome) %&gt;% 
  ggplot(aes(x = Genome, y = Clusters, group = Permutation)) +
    geom_line()

## End(Not run)

</code></pre>


</div>