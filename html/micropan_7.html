<div class="container">

<table style="width: 100%;"><tr>
<td>dClust</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Clustering sequences based on domain sequence</h2>

<h3>Description</h3>

<p>Proteins are clustered by their sequence of protein domains. A domain sequence is the
ordered sequence of domains in the protein. All proteins having identical domain sequence are assigned
to the same cluster.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dClust(hmmer.tbl)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>hmmer.tbl</code></td>
<td>
<p>A <code>tibble</code> of results from a <code>hmmerScan</code> against a domain database.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>A domain sequence is simply the ordered list of domains occurring in a protein. Not all proteins
contain known domains, but those who do will have from one to several domains, and these can be ordered
forming a sequence. Since domains can be more or less conserved, two proteins can be quite different in
their amino acid sequence, and still share the same domains. Describing, and grouping, proteins by their
domain sequence was proposed by Snipen &amp; Ussery (2012) as an alternative to clusters based on pairwise
alignments, see <code>bClust</code>. Domain sequence clusters are less influenced by gene prediction errors.
</p>
<p>The input is a <code>tibble</code> of the type produced by <code>readHmmer</code>. Typically, it is the
result of scanning proteins (using <code>hmmerScan</code>) against Pfam-A or any other HMMER3 database
of protein domains. It is highly reccomended that you remove overlapping hits in ‘<span class="samp">⁠hmmer.tbl⁠</span>’ before
you pass it as input to <code>dClust</code>. Use the function <code>hmmerCleanOverlap</code> for this.
Overlapping hits are in some cases real hits, but often the poorest of them are artifacts.
</p>


<h3>Value</h3>

<p>The output is a numeric vector with one element for each unique sequence in the ‘<span class="samp">⁠Query⁠</span>’
column of the input ‘<span class="samp">⁠hmmer.tbl⁠</span>’. Sequences with identical number belong to the same cluster. The
name of each element identifies the sequence.
</p>
<p>This vector also has an attribute called ‘<span class="samp">⁠cluster.info⁠</span>’ which is a character vector containing the
domain sequences. The first element is the domain sequence for cluster 1, the second for cluster 2, etc.
In this way you can, in addition to clustering the sequences, also see which domains the sequences of a
particular cluster share.
</p>


<h3>Author(s)</h3>

<p>Lars Snipen and Kristian Hovde Liland.
</p>


<h3>References</h3>

<p>Snipen, L. Ussery, D.W. (2012). A domain sequence approach to pangenomics: Applications
to Escherichia coli. F1000 Research, 1:19.
</p>


<h3>See Also</h3>

<p><code>panPrep</code>, <code>hmmerScan</code>, <code>readHmmer</code>,
<code>hmmerCleanOverlap</code>, <code>bClust</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># HMMER3 result files in this package
hf &lt;- file.path(path.package("micropan"), "extdata", 
                str_c("GID", 1:3, "_vs_microfam.hmm.txt.xz"))

# We need to uncompress them first...
hmm.files &lt;- tempfile(fileext = rep(".xz", length(hf)))
ok &lt;- file.copy(from = hf, to = hmm.files)
hmm.files &lt;- unlist(lapply(hmm.files, xzuncompress))

# Reading the HMMER3 results, cleaning overlaps...
hmmer.tbl &lt;- NULL
for(i in 1:3){
  readHmmer(hmm.files[i]) %&gt;% 
    hmmerCleanOverlap() %&gt;% 
    bind_rows(hmmer.tbl) -&gt; hmmer.tbl
}

# The clustering
clst &lt;- dClust(hmmer.tbl)

# ...and cleaning...
ok &lt;- file.remove(hmm.files)

</code></pre>


</div>