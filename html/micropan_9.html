<div class="container">

<table style="width: 100%;"><tr>
<td>distManhattan</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Computing Manhattan distances between genomes</h2>

<h3>Description</h3>

<p>Computes the (weighted) Manhattan distances beween all pairs of genomes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">distManhattan(pan.matrix, scale = 0, weights = rep(1, ncol(pan.matrix)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pan.matrix</code></td>
<td>
<p>A pan-matrix, see <code>panMatrix</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>An optional scale to control how copy numbers should affect the distances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Vector of optional weights of gene clusters.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Manhattan distance is defined as the sum of absolute elementwise differences between
two vectors. Each genome is represented as a vector (row) of integers in ‘<span class="samp">⁠pan.matrix⁠</span>’. The
Manhattan distance between two genomes is the sum of absolute difference between these rows. If
two rows (genomes) of the ‘<span class="samp">⁠pan.matrix⁠</span>’ are identical, the corresponding Manhattan distance
is ‘<span class="samp">⁠0.0⁠</span>’.
</p>
<p>The ‘<span class="samp">⁠scale⁠</span>’ can be used to control how copy number differences play a role in the distances
computed. Usually we assume that going from 0 to 1 copy of a gene is the big change of the genome,
and going from 1 to 2 (or more) copies is less. Prior to computing the Manhattan distance, the
‘<span class="samp">⁠pan.matrix⁠</span>’ is transformed according to the following affine mapping: If the original value in
‘<span class="samp">⁠pan.matrix⁠</span>’ is ‘<span class="samp">⁠x⁠</span>’, and ‘<span class="samp">⁠x⁠</span>’ is not 0, then the transformed value is ‘<span class="samp">⁠1 + (x-1)*scale⁠</span>’.
Note that with ‘<span class="samp">⁠scale=0.0⁠</span>’ (default) this will result in 1 regardless of how large ‘<span class="samp">⁠x⁠</span>’ was.
In this case the Manhattan distance only distinguish between presence and absence of gene clusters.
If ‘<span class="samp">⁠scale=1.0⁠</span>’ the value ‘<span class="samp">⁠x⁠</span>’ is left untransformed. In this case the difference between 1
copy and 2 copies is just as big as between 1 copy and 0 copies. For any ‘<span class="samp">⁠scale⁠</span>’ between 0.0 and
1.0 the transformed value is shrunk towards 1, but a certain effect of larger copy numbers is still
present. In this way you can decide if the distances between genomes should be affected, and to what
degree, by differences in copy numbers beyond 1. Notice that as long as ‘<span class="samp">⁠scale=0.0⁠</span>’ (and no
weighting) the Manhattan distance has a nice interpretation, namely the number of gene clusters that
differ in present/absent status between two genomes.
</p>
<p>When summing the difference across gene clusters we can also up- or downweight some clusters compared
to others. The vector ‘<span class="samp">⁠weights⁠</span>’ must contain one value for each column in ‘<span class="samp">⁠pan.matrix⁠</span>’. The
default is to use flat weights, i.e. all clusters count equal. See <code>geneWeights</code> for
alternative weighting strategies.
</p>


<h3>Value</h3>

<p>A <code>dist</code> object (see <code>dist</code>) containing all pairwise Manhattan distances
between genomes.
</p>


<h3>Author(s)</h3>

<p>Lars Snipen and Kristian Hovde Liland.
</p>


<h3>See Also</h3>

<p><code>panMatrix</code>, <code>distJaccard</code>, <code>geneWeights</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Loading a pan-matrix in this package
data(xmpl.panmat)

# Manhattan distances between genomes
Mdist &lt;- distManhattan(xmpl.panmat)

## Not run: 
# Making a dendrogram based on shell-weighted distances
library(ggdendro)
weights &lt;- geneWeights(xmpl.panmat, type = "shell")
Mdist &lt;- distManhattan(xmpl.panmat, weights = weights)
ggdendrogram(dendro_data(hclust(Mdist, method = "average")),
  rotate = TRUE, theme_dendro = FALSE) +
  labs(x = "Genomes", y = "Shell-weighted Manhattan distance", title = "Pan-genome dendrogram")

## End(Not run)

</code></pre>


</div>