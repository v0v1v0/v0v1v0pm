<div class="container">

<table style="width: 100%;"><tr>
<td>msWord</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Display a table in 'MS Word' containing panels from <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> graphs in
its cells.
</h2>

<h3>Description</h3>

<p>Display a table in 'MS Word' containing panels from <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> graphs in
its cells.
msWord methods for "trellis", "ggplot", "graphicsList",
"microplotMatrix", and "includegraphicsMatrix" objects.
The output file can be a <code>.docx</code> or <code>.html</code> file.
</p>


<h3>Usage</h3>

<pre><code class="language-R">msWord(object, ...)

## S3 method for class 'microplotMatrix'
msWord( ## calls msWord.graphicsClass
       object, ## microplotMatrix
       ## (matrix of filenames containing individual panels)
       ## (0 columns permitted)
       filetype=c("docx","html"),
       dataobject=matrix(, nrow(object), 0), ## numeric or character matrix
       data.first=TRUE,
       title=first.word(deparse(substitute(object))),
       rowlabel=title,
       rowname=rownames(object),
       data.header="data",
       graph.header="graph",
       graph.file.directory="./",
       axis.files=attr(object,"axis.names"),
       lab.files=attr(object,"lab.names"),
       key.file=attr(object,"key.name"),
       x.axis=(!is.null(axis.files) &amp;&amp; !is.null(axis.files["x"])),
       y.axis=(!is.null(axis.files) &amp;&amp; !is.null(axis.files["y"])),
       xlab=FALSE,
       ylab=FALSE,
       label.x.axis="",  ## empty, nchar=0
       label.y.axis=" ", ## one space, nchar=1
       height.panel=1, ## inches
       width.panel=1, ## inches
       height.x.axis=height.panel[1], ## inches ## [1] is defensive for lazy evaluation
       width.y.axis=width.panel[1], ## inches
       height.xlab=height.panel[1], ## inches
       width.ylab=width.panel[1], ## inches
       height.key=height.panel[1], ## inches
       width.key=width.panel[1], ## inches
       FlexTableWidths=NULL, ## inches ## value used will be an attribute of result
       rmh.borders=TRUE,
       caption=NULL,
       file=paste0(title, ".", filetype),
       doc.title="Microplot",
       width.rowname=.4,
       width.dataobject=1,
       width.between=.1,
       landscape=FALSE,
       rgroup=NULL,
       n.rgroup=NULL,
       rgroup.exclude.borders=NULL,
       key.align="center",  ## flextable::align
       ...)

## S3 method for class 'graphicsClass'
msWord( ## calls msWord.graphicsClass
           object, ## called by trellis, ggplot, graphicsList methods
           ## microplot arguments
           figPrefix=first.word(deparse(substitute(object))),
           device="png",
           key=FALSE,
           title=figPrefix, ## subject to lazy evaluation
           ... ## can include arguments to
           ## microplot,
           ## msWord.microplotMatrix
           )

## S3 method for class 'trellis'
msWord( ## calls msWord.graphicsClass
           object=stop("trellis object is required", call. = FALSE),
           figPrefix=first.word(deparse(substitute(object))),
           title=figPrefix,
           ... ## can include arguments to
           ## msWord.graphicsClass,
           ## microplot,
           ## msWord.microplotMatrix
           )

## S3 method for class 'ggplot'
msWord(object=stop("ggplot object is required", call. = FALSE),
           figPrefix=first.word(deparse(substitute(object))),
           title=figPrefix,
           ... ## can include arguments to
           ## msWord.graphicsClass,
           ## microplot,
           ## msWord.microplotMatrix
           )

## S3 method for class 'graphicsList'
msWord(object=stop("graphicsList object is required", call. = FALSE),
           ## matrix or vector of trellis objects or ggplot objects,
           ## with dim and dimnames,
           ## normally each containing one panel.
           ## The axes and key will be taken from object[[1]].
           figPrefix=first.word(deparse(substitute(object))),
           title=figPrefix,
           ... ## can include arguments to
           ## msWord.graphicsClass,
           ## microplot,
           ## msWord.microplotMatrix
           )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p><code>"microplotMatrix"</code> (Matrix of filenames containing individual panels) (0 columns permitted).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filetype</code></td>
<td>

<p>File extension of generated file.  Character, either <code>"docx"</code> or
<code>"html"</code>.
For <code>filetype="docx"</code> the result is a variable containing the
filename of a generated <code>MS Word</code> file.  See the discussion of
<code>value</code>
below for additional information on the value.
For <code>filetype="html"</code> the result is a variable containing a
<code>flextable</code> object.  See the discussion of <code>value</code> below to learn
how to save the <code>html</code> file.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataobject</code></td>
<td>

<p>Numeric or character matrix (or data.frame).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.first</code></td>
<td>

<p>Logical.  If <code>TRUE</code>, then output file will have <code>dataobject</code> columns
first, then graphics <code>object</code> columns.
If <code>FALSE</code>, then output file will have graphics <code>object</code> columns
first, then <code>dataobject</code> columns.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>

<p>Basename of generated file.  We replace all <code>"."</code> in
the <code>title</code> by <code>"-"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>figPrefix</code></td>
<td>
<p>See <code>microplot.trellis</code>.
The 'latex' macro <code>\includegraphics</code> requires that there be no
<code>"."</code> in the filename basename.  We also enforce this
requirement for
<code>msWord</code>.  We replace all <code>"."</code> in
the <code>figPrefix</code> by <code>"-"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rowlabel</code></td>
<td>

<p>Header name for column of rownames in the generated file.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rowname</code></td>
<td>
<p>Rownames of constructed table. Default is rownames of
<code>object</code>.  Specify <code>rowname=NULL</code> to suppress the
use of row names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.header, graph.header</code></td>
<td>

<p>Header names for groupings of data columns and graph columns.  Used
when both <code>dataobject</code> and <code>object</code> are present, one of them is not missing.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>graph.file.directory</code></td>
<td>

<p>Directory containing files named in <code>object</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis.files, lab.files, key.file</code></td>
<td>
<p>Filenames for graphics files containing
axes, axis labels, and key (legend).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.axis, xlab</code></td>
<td>
<p>Logical.  If <code>x.axis==TRUE</code> each column of
graphs will have the <code>x.axis</code> file placed as the last item in that column.
If both are <code>TRUE</code> then the <code>xlab</code> file will be placed in the row
following the <code>x.axis</code> file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.axis, ylab</code></td>
<td>
<p>Logical.  If <code>y.axis==TRUE</code> each row of graphs
will have the <code>y.axis</code> file placed as the first item in that row.
If both are <code>TRUE</code>, then the <code>ylab</code> file will be placed on each
row immediately before the <code>y.axis</code> file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label.x.axis, label.y.axis</code></td>
<td>
<p>Labels that will used in the column
name of the <code>y.axis</code> and the <code>y.axis</code> position for the
<code>x.axis</code> in the 'latex' display of the graphic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>height.panel, width.panel, height.x.axis, width.y.axis,
height.xlab, width.ylab</code></td>
<td>
<p>See <code>microplot</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>height.key, width.key, device, key</code></td>
<td>
<p>See <code>microplot</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FlexTableWidths</code></td>
<td>

<p>Widths of all columns, including header and between columns, in inches.
The default is to base the widths on the widths of individual columns
above.
The actual widths used are returned as an attribute of the returned
filename.
You may wish to examine these values from the first run, and then modify
them on second and later runs.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rmh.borders</code></td>
<td>

<p>My preferences for borders on cells based on the American Statistical
Association (<a href="https://academic.oup.com/DocumentLibrary/JSSMET/ASASTYLE_GUIDE.pdf">https://academic.oup.com/DocumentLibrary/JSSMET/ASASTYLE_GUIDE.pdf</a>)
style sheet.  The <span class="pkg">flextable</span> default, with full
borders between rows, does not conform.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>caption</code></td>
<td>

<p>The table will be rendered with a numbered caption containing this
string as the caption value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>

<p>Name of generated file.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>doc.title</code></td>
<td>

<p>Title that appears in the MS Word Properties list.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width.rowname</code></td>
<td>

<p>Number of inches for the rowname column.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width.dataobject</code></td>
<td>

<p>Number of inches for each column In the <code>data.object</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width.between</code></td>
<td>

<p>Number of inches for the column between the object (graphs) and the
dataobject (numbers or text).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>landscape</code></td>
<td>

<p>Logical.  If <code>TRUE</code> then the table is produced in a landscape
orientation.  If <code>FALSE</code>, then in a portrait orientation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rgroup, n.rgroup, rgroup.exclude.borders</code></td>
<td>

<p>Argument names borrowed from <code>latex</code>.
<code>rgroup</code> gives the names of groupings of rows in the table.
<code>n.rgroup</code> gives the number of rows within each group.
<code>rgroup.exclude.borders</code> is not borrowed. It gives the row
numbers of rows which are not to have a border between the rowname and
the body of the table.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>key.align</code></td>
<td>
<p><code>flextable::align</code> one of <code>left</code>, <code>right</code>, <code>center</code>.</p>
</td>
</tr>
</table>
<table><tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Additional arguments are currently ignored by
<code>msWord.microplotMatrix</code>.
They are forwarded to other methods by the other functions documented here.
</p>
</td>
</tr></table>
<h3>Value</h3>

<p>The returned value depends on the <code>filetype</code> argument.
</p>
<p>For <code>filetype="docx"</code>, the value is the name of a generated file
<code>docx</code> file with class <code>"msWordFilename"</code>.  Printing the
returned value will display the generated file on screen.  The result
has an attribute <code>"microplotMatrix"</code> containing its argument
<code>object</code>, which contains the names of the generated microplots.
The result has an attribute showing the actual <code>FlexTableWidths</code>
used.  The user may wish to use the <code>FlexTableWidths</code> argument on
a following run to modify these values.
</p>
<p>For <code>filetype="html"</code>, the value is a <code>flextable</code> object.
Printing the returned value will display the generated table in a
browser window.
If you wish to keep the html object, you MUST save it manually!
The original file is in a temporary directory and will vanish when R is closed.
Switch to the browser window and save the displayed table as a 'Web Archive'
in a directory of your choice.  Choose an appropriate basename for the saved file,
as the default basename of the file is the noninformative <code>"index"</code>.
</p>


<h3>Note</h3>

<p>The <code>msWord</code> function uses facilities provided by the
<span class="pkg">flextable</span> and <span class="pkg">officer</span> packages.
</p>


<h3>Author(s)</h3>

<p> Richard M. Heiberger &lt;rmh@temple.edu&gt; </p>


<h3>Examples</h3>

<pre><code class="language-R">## See demos.
</code></pre>


</div>