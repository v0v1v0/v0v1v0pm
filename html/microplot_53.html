<div class="container">

<table style="width: 100%;"><tr>
<td>microplot-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Display microplots (sparklines) from R graphics panels in tables in
'LaTeX', 'Word', 'HTML', 'Excel'.
</h2>

<h3>Description</h3>

<p>The microplot function writes a set of R graphics files to be used as
  microplots (sparklines) in tables in either 'LaTeX', 'HTML', 'Word',
  or 'Excel' files.  For 'LaTeX', we provide methods for the
  Hmisc::latex() generic function to construct 'latex' tabular
  environments which include the graphs.  These can be used directly
  with the operating system 'pdflatex' or 'latex' command, or by using
  one of 'Sweave', 'knitr', 'rmarkdown', or 'Emacs org-mode' as an
  intermediary.  For 'MS Word', the msWord() function uses the
  'flextable' package to construct 'Word' tables which include the
  graphs.  There are several distinct approaches for constructing HTML
  files.  The simplest is to use the msWord() function with argument
  filetype="html".  Alternatively, use either 'Emacs org-mode' or the
  htmlTable::htmlTable() function to construct an 'HTML' file
  containing tables which include the graphs.  See the documentation
  for our as.htmlimg() function.  For 'Excel' use on 'Windows', the
  file examples/irisExcel.xls includes 'VBA' code which brings the
  individual panels into individual cells in the spreadsheet.
  Examples in the examples and demo subdirectories are shown with
  'lattice' graphics, 'ggplot2' graphics, and 'base' graphics.
  Examples for 'LaTeX' include 'Sweave' (both 'LaTeX'-style and
  'Noweb'-style), 'knitr', 'emacs org-mode', and 'rmarkdown' input
  files and their 'pdf' output files.  Examples for 'HTML' include
  'org-mode' and 'Rmd' input files and their webarchive 'HTML' output
  files.  In addition, the as.orgtable() function can display a
  data.frame in an 'org-mode' document.  The examples for 'MS Word'
  (with either filetype="docx" or filetype="html") work with all
  operating systems.  The package does not require the installation of
  'LaTeX' or 'MS Word' to be able to write '.tex' or '.docx' files.
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
<td style="text-align: left;">
Package: </td>
<td style="text-align: left;"> microplot</td>
</tr>
<tr>
<td style="text-align: left;">
Type: </td>
<td style="text-align: left;"> Package</td>
</tr>
<tr>
<td style="text-align: left;">
Title: </td>
<td style="text-align: left;"> Microplots (Sparklines) in 'LaTeX', 'Word', 'HTML', 'Excel'</td>
</tr>
<tr>
<td style="text-align: left;">
Version: </td>
<td style="text-align: left;"> 1.0-45</td>
</tr>
<tr>
<td style="text-align: left;">
Date: </td>
<td style="text-align: left;"> 2022-01-26</td>
</tr>
<tr>
<td style="text-align: left;">
Author: </td>
<td style="text-align: left;"> Richard M. Heiberger, with contributions from Karen Byron and Nooreen Dabbish.</td>
</tr>
<tr>
<td style="text-align: left;">
Maintainer: </td>
<td style="text-align: left;"> Richard M. Heiberger &lt;rmh@temple.edu&gt;</td>
</tr>
<tr>
<td style="text-align: left;">
Description: </td>
<td style="text-align: left;"> The microplot function writes a set of R graphics files to be used as
  microplots (sparklines) in tables in either 'LaTeX', 'HTML', 'Word',
  or 'Excel' files.  For 'LaTeX', we provide methods for the
  Hmisc::latex() generic function to construct 'latex' tabular
  environments which include the graphs.  These can be used directly
  with the operating system 'pdflatex' or 'latex' command, or by using
  one of 'Sweave', 'knitr', 'rmarkdown', or 'Emacs org-mode' as an
  intermediary.  For 'MS Word', the msWord() function uses the
  'flextable' package to construct 'Word' tables which include the
  graphs.  There are several distinct approaches for constructing HTML
  files.  The simplest is to use the msWord() function with argument
  filetype="html".  Alternatively, use either 'Emacs org-mode' or the
  htmlTable::htmlTable() function to construct an 'HTML' file
  containing tables which include the graphs.  See the documentation
  for our as.htmlimg() function.  For 'Excel' use on 'Windows', the
  file examples/irisExcel.xls includes 'VBA' code which brings the
  individual panels into individual cells in the spreadsheet.
  Examples in the examples and demo subdirectories are shown with
  'lattice' graphics, 'ggplot2' graphics, and 'base' graphics.
  Examples for 'LaTeX' include 'Sweave' (both 'LaTeX'-style and
  'Noweb'-style), 'knitr', 'emacs org-mode', and 'rmarkdown' input
  files and their 'pdf' output files.  Examples for 'HTML' include
  'org-mode' and 'Rmd' input files and their webarchive 'HTML' output
  files.  In addition, the as.orgtable() function can display a
  data.frame in an 'org-mode' document.  The examples for 'MS Word'
  (with either filetype="docx" or filetype="html") work with all
  operating systems.  The package does not require the installation of
  'LaTeX' or 'MS Word' to be able to write '.tex' or '.docx' files.</td>
</tr>
<tr>
<td style="text-align: left;">
Imports: </td>
<td style="text-align: left;"> Hmisc (&gt;= 4.1-1), HH, lattice, grid, flextable (&gt;= 0.5-11), officer, ggplot2, htmltools, cowplot</td>
</tr>
<tr>
<td style="text-align: left;">
Suggests: </td>
<td style="text-align: left;"> reshape2, latticeExtra,
xtable, markdown, rmarkdown, knitr, htmlTable</td>
</tr>
<tr>
<td style="text-align: left;">
License: </td>
<td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>Index of help topics:
</p>
<pre>
LegendrePolyMatrices    Legendre Orthogonal Polynomials for various
                        values of alpha and beta. The dataset is used
                        in the demo("LegendrePolynomials").
as.htmlimg              Place a filename or filepath in the format used
                        by HTML
as.includegraphics      Convert a filename into a complete 'LaTeX'
                        '\includegraphics' expression for use with
                        'LaTeX' '\includegraphics' macro in the
                        'graphicx' package.  This is used for 'pdf' and
                        'png' files with the system 'pdflatex' command.
                        This is used for 'ps' files with the system
                        'latex' command.
as.orgfile              Place a filename or filepath in the format used
                        by org-mode
as.orgtable             Prepare a matrix or data.frame to be used as an
                        org-mode table
cc176.y.adj             Adjusted response values and their five number
                        summaries by treatment level for one model
                        using the cc176 dataset. This dataset is used
                        in two demos: "bwplot" and "boxplot-ggplot".
dir.verify              Verifies existence of, or creates, a directory.
formatDF                Format a Data Frame or Matrix for LaTeX or
                        HTML.
graphicsList            Convert a list of "trellis" objects or list of
                        "ggplot" objects into a "graphicslist" object.
latex.AEdotplot         Display the AE (Adverse Events) dotplot of
                        incidence and relative risk from the HH package
                        in a 'LaTeX' tabular environment or in an 'MS
                        Word' or an 'HTML' table.
latex.trellis           Display a table in 'latex' containing panels
                        from R graphs in its cells.
latexSetOptions         Set the options for use of latex; check whether
                        the options for latex functions have been
                        specified.
layoutCollapse          Set the lattice 'par.settings' to remove all
                        marginal space.
microplot               Take a trellis or ggplot object, or
                        graphicsList object (list of trellis or ggplot
                        objects), and generate a set of graphics files,
                        one per panel of a multi-panel display.
microplot-package       Display microplots (sparklines) from R graphics
                        panels in tables in 'LaTeX', 'Word', 'HTML',
                        'Excel'.
microplotAttrDisplay    Specify how to display the microplots for
                        x.axis, y.axis, xlab, ylab, and key.
msWord                  Display a table in 'MS Word' containing panels
                        from R graphs in its cells.
show.latexConsole       Revisions of Hmisc latex and dvi functions that
                        display the generated latex file on screen and
                        divert the console log to a file.  New print
                        methods that display Operating System files
                        (ps, docx, html) on screen.
theme_collapse          Set the 'ggplot2' theme to remove all marginal
                        space.
toxicity                Simulated toxicity data.  Dataset is used in
                        demo("tablesPlusGraphicColumn").
</pre>
<p>Microplots are small plots that fit into the cells of a table that
otherwise consists of text and numbers.  A special case of a microplot
is known as a sparkline.
</p>
<p>The examples in this package show tables of simple or complex graphs
placed into one or more columns of a table.  The graphs can be produced
by any graphical system in 'R'.  We show <span class="pkg">lattice</span>, <span class="pkg">ggplot2</span>, and <span class="pkg">base</span>
graphics.  The tables can be targeted for display in 'LaTeX', 'MS Word'
on any operating system, 'MS Excel' on 'Windows', or 'HTML'.  We show examples of each.
</p>
<p>The functions produce valid 'LaTeX' <code>.tex</code> files or 'Word'
<code>.docx</code> files in the working directory.  If 'LaTeX' or 'Word' are
installed, then the generated files can be displayed on screen as
illustrated in the help file examples and the <code>demo</code> directory.  The
<code>.tex</code> files can be <code>\include</code>d in a larger <code>.tex</code> file.
Or the generated <code>.pdf</code> file can be displayed in ‘LaTeX’ with
an <code>\includegraphics</code> statement.
The images in the displayed <code>.docx</code> file can be copied and pasted
into a larger 'Word' file.
</p>
<p>The best way to learn this package is to read the examples and <code>demo</code> files.
The primary function <code>microplot</code> takes a <code>trellis</code> or <code>ggplot</code>
object and generates a set of graphics files, one per panel of a
multi-panel display.  The <code>latex</code> and <code>msWprd</code> functions place
the graphics files into a table.
</p>
<p>The <code>latex</code> examples (in the help file <code>examples</code>) and <code>demo</code>
files use the operating system <code>pdflatex</code> command with the 'R'
<code>pdf()</code> or <code>png()</code> graphics device.  Or they could use the
operating system <code>latex</code> command with the 'R'
<code>ps()</code> graphics device.  They therefore require that the
three options<br><code>options()[c("latexcmd","dviExtension","xdvicmd")]</code><br>
all be set consistently.
The recommended settings for <code>pdflatex</code> with <code>pdf</code> graphics files
are included as the defaults in the function call<br><code>latexSetOptions()</code><br>
The recommended settings for <code>latex</code> with <code>ps</code> graphics files
may be specified with the function call<br><code>latexSetOptions("latex")</code><br></p>
<p>Please see <code>latexSetOptions</code> for details on the recommended
settings
for use with the <span class="pkg">microplot</span> package.  See the "System options"
section in the "Details" section of
<code>latex</code> for discussion of the options themselves.
</p>
<p>The examples in this <code>help</code> file are inside <code>dontrun</code> environments
because they depend on <code>options</code> and they write files.  You must set the
<code>options</code> for your system before running the example manually.
</p>
<p>Most of the 'LaTeX' examples are shown using the <code>Hmisc::latex</code> function
<code>latex</code>
(I am coauthor of that function).
The <span class="pkg">microplot</span> package also works with the <code>xtable::xtable</code>
function <code>xtable</code>.
An example in the <code>demo</code> directory shows a simple use of <code>xtable</code>.
</p>
<p>The demos in the <code>demo</code> directory are not inside a <code>dontrun</code>
environment.  You must set the options for your system before running
them.  Each demo sets the options for <code>pdfltex</code>.  Should you prefer
<code>latex</code> you will need to run the demos manually.
I recommend that you run the demos with <code>ask=TRUE</code> because
will need to read them closely to see what they are doing.
</p>
<p>To run the demos manually (with a stop at each graph), use
</p>
<pre>
     demo("HowToUseMicroplot"         , package="microplot", ask=TRUE)
     demo("latex"                     , package="microplot", ask=TRUE)
     demo("latex-ggplot"              , package="microplot", ask=TRUE)
     demo("msWord"                    , package="microplot", ask=TRUE)
     demo("LegendrePolynomials"       , package="microplot", ask=TRUE)
     demo("timeseries"                , package="microplot", ask=TRUE)
     demo("NTplot"                    , package="microplot", ask=TRUE)
     demo("bwplot-lattice"            , package="microplot", ask=TRUE)
     demo("boxplot-ggplot"            , package="microplot", ask=TRUE)
     demo("tablesPlusGraphicColumn"   , package="microplot", ask=TRUE)
     demo("regrcoef"                  , package="microplot", ask=TRUE)
     demo("iris"                      , package="microplot", ask=TRUE)
     demo("AEdotplot"                 , package="microplot", ask=TRUE)
     demo("xtable"                    , package="microplot", ask=TRUE)
     demo("Examples"                  , package="microplot", ask=TRUE)
   </pre>
<p>To run the demos automatically, with no stops, use <code>ask=FALSE</code>.
</p>
<p>The <code>examples</code> directory
<code>system.file(package="microplot", "examples")</code>
includes complete working examples of <span class="pkg">Sweave</span> (both LaTeX-style and
Noweb-style), <span class="pkg">knitr</span>, <code>emacs</code> <span class="pkg">orgmode</span>, and
<span class="pkg">rmarkdown</span>
input files and their <code>pdf</code> output files.  These files must be
copied into a directory in which you have write privilege, and that
directory must be made the current working directory with <code>setwd</code>.
They will not work from the installed package directory.
</p>
<p>The 'Excel' for Windows example is in file
<code>examples/irisExcel.xls</code>.  The 'VBA' code in that file shows how to
place the individual microplots into 'Excel' cells.
</p>
<p>See also the vignette:<br><code>vignette("rmhPoster", package="microplot")</code>
</p>


<h3>Author(s)</h3>

<p>Richard M. Heiberger, with contributions from Karen Byron and Nooreen Dabbish.
</p>
<p>Maintainer: Richard M. Heiberger &lt;rmh@temple.edu&gt;
</p>


<h3>See Also</h3>

<p><code>latex</code>, <code>latex.trellis</code>, <code>microplot</code>, <code>as.includegraphics</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## This example writes a set of pdf files and then uses the latex
## function to display them in LaTeX.

## The graphs are constructed three times, once each with lattice,
## base graphics, and ggplot2.

## Not run: 

  ## 0. set options for pdflatex and pdf graphics files
  latexSetOptions()


  ## 1. define dataset
  tmp &lt;- matrix(rnorm(10), 2, 5, byrow=TRUE,
                dimnames=list(c("A", "B"), paste0("X", 1:5)))

  tmp.df &lt;- data.frame(y=as.vector(t(tmp)),
                       group=factor(rep(row.names(tmp), each=5)))
  tmp.df


  ## 2. lattice example for latex and msWord

  tmp.lattice &lt;- lattice::bwplot(group ~ y | " " * group, data=tmp.df, layout=c(1,2),
                                 as.table=TRUE, xlim=c(-2.1, 1.3),
                                 scales=list(y=list(relation="free", at=NULL)))
  tmp.lattice


  ## 3. using the latex.trellis method
  latex(tmp.lattice,
        height.panel=.3, width.panel=3, ## inches
        x.axis=TRUE, y.axis=FALSE,
        rowlabel="group", caption="latex.trellis of lattice graph column")

  latex(tmp.lattice, dataobject=formatDF(tmp, dec=2),
        height.panel=.3, width.panel=1.5, ## inches
        x.axis=FALSE, y.axis=FALSE,
        rowlabel="group", caption="latex.trellis of numeric data and lattice graph column")


  ## 4. MS Word example.  Uses functions in the flextable and officer packages.

  tmplw.docx &lt;-
    msWord(tmp.lattice, dataobject=format(tmp, digits=2),
           height.panel=.3, width.panel=2, ## inches
           height.x.axis=.35, width.y.axis=.3,
           figPrefix="tmplw",
           y.axis=FALSE,
           rowlabel="group", width.rowname=.6,
           data.header="data values", width.dataobject=.6,
           graph.header="bwplot",
           caption="Lattice bwplot using msWord function")
  print.default(tmplw.docx)
  tmplw.docx  ## print method opens file
  ## cut and paste this graph into a larger .docx file.


  ## 5. ggplot2 example for latex and msWord

  library(ggplot2)

  tmpga.df &lt;- cbind(tmp.df, fake="ff")
  tmpga &lt;-
    ggplot(tmpga.df, aes(fake, y)) +
    geom_boxplot(outlier.size = 2) +
    facet_wrap(~ group, ncol=1) +
    coord_flip() + ylim(-2, 1.1)
  tmpga ## on interactive device


  ## 6. using the latex.ggplot method

  latex(tmpga, height.x.axis=.2, width.y.axis=.2, y.axis=FALSE)

  latex(tmpga, dataobject=formatDF(tmp, dec=2),
        height.panel=.5, height.x.axis=.2, width.y.axis=.2, y.axis=FALSE)


  ## 7. msWord with ggplot

  tmpga.docx &lt;-
    msWord(tmpga, dataobject=format(tmp, digits=2),
           height.panel=.25, height.x.axis=.2, width.y.axis=.2, y.axis=FALSE,
           rowlabel="group", width.rowname=.6,
           data.header="data values", width.dataobject=.6,
           graph.header="bwplot",
           caption="ggplot2 boxplot using msWord function")
  print.default(tmpga.docx)
  tmpga.docx  ## print method opens file


  detach("package:ggplot2")


  ## 8. base graphics example
  ## This must be done with an explicit loop because
  ## base graphics doesn't produce a graphics object.

  dir.verify("tmpb")
  pdf("tmpb/fig%03d.pdf", onefile=FALSE, height=.5, width=3) ## inch
  par( bty="n", xaxt="n", omd=c(0,1, 0,1), mai=c(0,0,0,0))
  boxplot(tmp["A",], horizontal=TRUE, ylim=range(tmp)) ## ylim for horizontal plot
  boxplot(tmp["B",], horizontal=TRUE, ylim=range(tmp)) ## ylim for horizontal plot
  dev.off()

  tmpb.graphnames &lt;- paste0("tmpb/fig", sprintf("%03i", 1:2), ".pdf")

  tmpb.display &lt;-
    data.frame(round(tmp, 2),
               graphs=as.includegraphics(tmpb.graphnames, height="2em", raise="-1.4ex"))
  tmpb.display

  ## we are now using the latex.data.frame method in the Hmisc package
  tmpb.latex &lt;- latex(tmpb.display, rowlabel="group",
                      caption="latex.default of base graphs")
  tmpb.latex$style &lt;- "graphicx"
  tmpb.latex  ## this line requires latex in the PATH


  ## 9. detail for latex of lattice.  This is essentially what the
  ## latex.trellis method does all together.

  dir.verify("tmpl") ## create a new subdirectory of the working directory
  pdf("tmpl/fig%03d.pdf", onefile=FALSE, height=.5, width=2.5) ## inch
  update(tmp.lattice, layout=c(1,1), xlab="",
         par.settings=list(layout.heights=layoutHeightsCollapse(),
                           layout.widths=layoutWidthsCollapse(),
                           axis.line=list(col="transparent"),
                           strip.border=list(col="transparent")))
  dev.off()

  tmpl.graphnames &lt;- paste0("tmpl/fig", sprintf("%03i", 1:2), ".pdf")
  names(tmpl.graphnames) &lt;- rownames(tmp)

  tmpl &lt;-
    as.includegraphics(tmpl.graphnames)
  ## retains dimensions from pdf() statement
  tmpl
  tmpl.latex &lt;- latex(tmpl, rowlabel="group",
                      caption="latex.default of lattice graph column")
  tmpl.latex  ## this line requires latex in the PATH

  tmplw &lt;-
    data.frame(round(tmp, 2),
               graphs=as.includegraphics(tmpl.graphnames, width="1in"))
  ## retains aspect ratio from pdf() statement
  tmplw

  tmplw.latex &lt;- latex(tmplw, rowlabel="group",
                       caption="latex.default of numeric data and lattice graph column")
  tmplw.latex$style &lt;- "graphicx"
  tmplw.latex  ## this line requires latex in the PATH


  ## 10. detail for latex of ggplot.
  ## left as an exercise.  It is very similar to the detail for latex with lattice.


## End(Not run)

## Please see the demos for more interesting examples.
## demo(package="microplot")

</code></pre>


</div>