<div class="container">

<table style="width: 100%;"><tr>
<td>msaTrim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Trimming multiple sequence alignments</h2>

<h3>Description</h3>

<p>Trimming a multiple sequence alignment by discarding columns with too many gaps.
</p>


<h3>Usage</h3>

<pre><code class="language-R">msaTrim(msa, gap.end = 0.5, gap.mid = 0.9)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>msa</code></td>
<td>
<p>A fasta object containing a multiple alignment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gap.end</code></td>
<td>
<p>Fraction of gaps tolerated at the ends of the alignment (0-1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gap.mid</code></td>
<td>
<p>Fraction of gaps tolerated inside the alignment (0-1).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A multiple alignment is trimmed by removing columns with too many indels (gap-symbols). Any 
columns containing a fraction of gaps larger than <code>gap.mid</code> are discarded. For this reason, <code>gap.mid</code>
should always be farily close to 1.0 therwise too many columns may be discarded, destroying the alignment.
</p>
<p>Due to the heuristics of multiple alignment methods, both ends of the alignment tend to be uncertain and most
of the trimming should be done at the ends. Starting at each end, columns are discarded as long as their fraction of gaps
surpasses <code>gap.end</code>. Typically <code>gap.end</code> can be much smaller than <code>gap.mid</code>, but if 
set too low you risk that all columns are discarded!
</p>


<h3>Value</h3>

<p>The trimmed alignment is returned as a fasta object.
</p>


<h3>Author(s)</h3>

<p>Lars Snipen.
</p>


<h3>See Also</h3>

<p><code>muscle</code>, <code>msalign</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">msa.file &lt;- file.path(path.package("microseq"),"extdata", "small.msa")
msa &lt;- readFasta(msa.file)
print(str_length(msa$Sequence))
msa.trimmed &lt;- msaTrim(msa)
print(str_length(msa.trimmed$Sequence))
msa.mat &lt;- msa2mat(msa)  # for use with ape::as.DNAbin(msa.mat)

</code></pre>


</div>