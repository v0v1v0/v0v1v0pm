<div class="container">

<table style="width: 100%;"><tr>
<td>cmtest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Conditional moments test</h2>

<h3>Description</h3>

<p>Conditional moments tests for maximum likelihood estimators,
particularly convenient for the probit and the tobit model to test
relevance of functional form, omitted variables, heteroscedasticity and
normality.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cmtest(
  x,
  test = c("normality", "reset", "heterosc", "skewness", "kurtosis"),
  powers = 2:3,
  heter_cov = NULL,
  opg = FALSE
)

## S3 method for class 'tobit'
cmtest(
  x,
  test = c("normality", "reset", "heterosc", "skewness", "kurtosis"),
  powers = 2:3,
  heter_cov = NULL,
  opg = FALSE
)

## S3 method for class 'micsr'
cmtest(
  x,
  test = c("normality", "reset", "heterosc", "skewness", "kurtosis"),
  powers = 2:3,
  heter_cov = NULL,
  opg = FALSE
)

## S3 method for class 'censReg'
cmtest(
  x,
  test = c("normality", "reset", "heterosc", "skewness", "kurtosis"),
  powers = 2:3,
  heter_cov = NULL,
  opg = FALSE
)

## S3 method for class 'glm'
cmtest(
  x,
  test = c("normality", "reset", "heterosc", "skewness", "kurtosis"),
  powers = 2:3,
  heter_cov = NULL,
  opg = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a fitted model, currently a tobit model either fitted by
<code>AER::tobit</code>, <code>censReg::censReg</code> or <code>micsr::tobit1</code> or a probit model fitted by
<code>glm</code> with <code>family = binomial(link = "probit")</code> or by <code>micsr::binomreg</code> with <code>link = "probit"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>the kind of test to be performed, either a normality
test (or separately a test that the skewness or kurtosis
are 0 and 3), a heteroscedasticity test or a reset
test,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>powers</code></td>
<td>
<p>the powers of the fitted values that should be used
in the reset test,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>heter_cov</code></td>
<td>
<p>a one side formula that indicates the covariates
that should be used for the heteroscedasticity test (by default
all the covariates used in the regression are used),</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opg</code></td>
<td>
<p>a boolean, if <code>FALSE</code> (the default), the analytic
derivatives are used, otherwise the outer product of the
gradient formula is used</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object of class <code>"htest"</code> containing the following components:
</p>

<ul>
<li>
<p> data.mane: a character string describing the fitted model
</p>
</li>
<li>
<p> statistic: the value of the test statistic
</p>
</li>
<li>
<p> parameter: degrees of freedom
</p>
</li>
<li>
<p> p.value: the p.value of the test
</p>
</li>
<li>
<p> method: a character indicating what type of test is performed
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Yves Croissant
</p>


<h3>References</h3>

<p>Newey WK (1985).
“Maximum Likelihood Specification Testing and Conditional Moment Tests.”
<em>Econometrica</em>, <b>53</b>(5), 1047–1070.
</p>
<p>Pagan A, Vella F (1989).
“Diagnostic Tests for Models Based on Individual Data: A Survey.”
<em>Journal of Applied Econometrics</em>, <b>4</b>, S29–S59.
</p>
<p>Tauchen G (1985).
“Diagnostic testing and evaluation of maximum likelihood models.”
<em>Journal of Econometrics</em>, <b>30</b>(1), 415-443.
</p>
<p>Wells C (2003).
“Retesting Fair's (1978) Model on Infidelity.”
<em>Journal of Applied Econometrics</em>, <b>18</b>(2), 237–239.
</p>


<h3>Examples</h3>

<pre><code class="language-R">charitable$logdon &lt;- with(charitable, log(donation) - log(25))
ml &lt;- tobit1(logdon ~ log(donparents) + log(income) + education +
             religion + married + south, data = charitable)
cmtest(ml, test = "heterosc")
cmtest(ml, test = "normality", opg = TRUE)
</code></pre>


</div>