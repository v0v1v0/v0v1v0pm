<div class="container">

<table style="width: 100%;"><tr>
<td>pscore</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Propensity scores</h2>

<h3>Description</h3>

<p>Propensity scores estimation, using an algorithm that checks the
balancing hypothesis using strata and enable the estimation of the
treatment effect using stratification methods
</p>


<h3>Usage</h3>

<pre><code class="language-R">pscore(formula, data, maxiter = 4, tol = 0.005, link = c("logit", "probit"))

## S3 method for class 'pscore'
summary(object, ...)

## S3 method for class 'pscore'
print(
  x,
  ...,
  digits = getOption("digits"),
  var_equal = c("none", "strata", "group", "both")
)

## S3 method for class 'summary.pscore'
print(
  x,
  ...,
  digits = getOption("digits"),
  format = c("rst", "pipe", "simple"),
  step = c("all", "strata", "covariates", "atet")
)

## S3 method for class 'pscore'
nobs(object, ..., smpl = c("total", "cs"))

## S3 method for class 'summary.pscore'
nobs(object, ..., smpl = c("total", "cs"))

rg(object, ...)

## S3 method for class 'pscore'
rg(object, ..., smpl = c("total", "cs"))

## S3 method for class 'summary.pscore'
rg(object, ..., smpl = c("total", "cs"))

stdev(object, ...)

## S3 method for class 'pscore'
mean(x, ..., var_equal = c("none", "strat", "group", "both"))

## S3 method for class 'summary.pscore'
mean(x, ...)

## S3 method for class 'pscore'
stdev(object, ..., var_equal = c("none", "strata", "group", "both"))

## S3 method for class 'summary.pscore'
stdev(object, ..., var_equal = c("none", "strata", "group", "both"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a Formula object; the left-hand side should contain
two variables (<code>x1 + x2</code>), where x1 is the group variable and
x2 the outcome. The group variable can be either a dummy for
treated individuals or a factor with levels <code>"treated"</code> and
<code>"control"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>the maximum number of iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>stratas are cut in halves as long as the hypothesis of
equal means is rejected at the <code>tol</code> level,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>the link for the binomial glm estimation, either
<code>"logit"</code> or <code>"probit"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x, object</code></td>
<td>
<p>a <code>"pscore"</code> or a <code>"summary.pscore"</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>number of digits for the <code>print</code> methods</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_equal</code></td>
<td>
<p>to compute the variance of the ATET, variances can
be computed at the class/group level (<code>var_equal = "none"</code>), at
the class level (<code>var_equal = "group"</code>), at the group level
(<code>var_equal = "strata"</code>) or globally (<code>var_equal = "both"</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>format</code></td>
<td>
<p>one of <code>"rst"</code> <code>"pipe"</code> and <code>"simple"</code>, this argument
is passed to <code>knitr::kable</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step</code></td>
<td>
<p>for the <code>print.summary</code> method, the step of the test to
be printed: one of <code>"all"</code> (the default), <code>strata</code>,
<code>covariates</code> and <code>atet</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smpl</code></td>
<td>
<p>the sample to use, either the whole sample (<code>smpl = "total"</code>) or the sample with common support (<code>smpl = "cs"</code>)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object of class <code>"pscore"</code>, with the following elements:
</p>

<ul>
<li> <p><code>strata</code>: a tibble containing the stratas, the frequencies, the
means and the variances of the propensity scores for treated and
controled observations
</p>
</li>
<li> <p><code>cov_balance</code>: a tibble containing the results of the balancing
tests for every covariate; the results for the class with the
lowest p-value is reported
</p>
</li>
<li> <p><code>unchecked_cov</code>: a character vector containing the names of the
covariates for which the balancing test could be computed
</p>
</li>
<li> <p><code>model</code>: a tibble containing the original data, with
supplementary columns: <code>gp_</code> for the groups, <code>resp_</code> for the
outcome and <code>cls_</code> for the stratas
</p>
</li>
<li> <p><code>pscore</code>: the glm model fitted to compute the propensity scores
</p>
</li>
</ul>
<h3>References</h3>

<p>Dehejia RH, Wahba S (2002).
“Propensity Score-Matching Methods for Nonexperimental Causal Studies.”
<em>The Review of Economics and Statistics</em>, <b>84</b>(1), 151-161.
ISSN 0034-6535, <a href="https://doi.org/10.1162/003465302317331982">doi:10.1162/003465302317331982</a>.
</p>
<p>Becker SO, Ichino A (2002).
“Estimation of average treatment effects based on propensity scores.”
<em>Stata Journal</em>, <b>2</b>(4), 358-377(20).
</p>


<h3>Examples</h3>

<pre><code class="language-R">data_tuscany &lt;- dplyr::mutate(dplyr::filter(twa, region == "Tuscany"),
  dist2 = dist ^ 2, livselfemp = I((city == "livorno") * (occup == "selfemp")),
  perm = ifelse(outcome == "perm", 1, 0))
formula_tuscany &lt;- group | perm ~ city + sex + marital + age +
   loc + children + educ + pvoto + training +
   empstat + occup + sector + wage + hour + feduc + femp + fbluecol +
   dist + dist2 + livselfemp
pscore(formula_tuscany, data_tuscany)
</code></pre>


</div>