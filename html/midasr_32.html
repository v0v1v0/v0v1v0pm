<div class="container">

<table style="width: 100%;"><tr>
<td>hAhr_test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test restrictions on coefficients of MIDAS regression using robust version of the test</h2>

<h3>Description</h3>

<p>Perform a test whether the restriction on MIDAS regression coefficients holds.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hAhr_test(x, PHI = vcovHAC(x$unrestricted, sandwich = FALSE))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>MIDAS regression model with restricted coefficients, estimated with <code>midas_r</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PHI</code></td>
<td>
<p>the "meat" covariance matrix, defaults to <code>vcovHAC(x$unrestricted, sandwich=FALSE)</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given MIDAS regression:
</p>
<p style="text-align: center;"><code class="reqn">y_t=\sum_{j=0}^k\sum_{i=0}^{m-1}\theta_{jm+i} x_{(t-j)m-i}+u_t</code>
</p>

<p>test the null hypothesis that the following restriction holds:
</p>
<p style="text-align: center;"><code class="reqn">\theta_h=g(h,\lambda),</code>
</p>

<p>where <code class="reqn">h=0,...,(k+1)m</code>.
</p>


<h3>Value</h3>

<p>a <code>htest</code> object
</p>


<h3>Author(s)</h3>

<p>Virmantas Kvedaras, Vaidotas Zemlys
</p>


<h3>References</h3>

<p>Kvedaras V., Zemlys, V. <em>The statistical content and empirical testing of the MIDAS restrictions</em>
</p>


<h3>See Also</h3>

<p>hAh_test
</p>


<h3>Examples</h3>

<pre><code class="language-R">##The parameter function
theta_h0 &lt;- function(p, dk, ...) {
   i &lt;- (1:dk-1)
   (p[1] + p[2]*i)*exp(p[3]*i + p[4]*i^2)
}

##Generate coefficients
theta0 &lt;- theta_h0(c(-0.1,0.1,-0.1,-0.001),4*12)

##Plot the coefficients
plot(theta0)

##Generate the predictor variable
set.seed(13)

xx &lt;- ts(arima.sim(model = list(ar = 0.6), 600 * 12), frequency = 12)

##Simulate the response variable
y &lt;- midas_sim(500, xx, theta0)

x &lt;- window(xx, start=start(y))
##Fit restricted model
mr &lt;- midas_r(y~fmls(x,4*12-1,12,theta_h0)-1,
              list(y=y,x=x),
              start=list(x=c(-0.1,0.1,-0.1,-0.001)))

##The gradient function
theta_h0_gradient &lt;-function(p, dk,...) {
   i &lt;- (1:dk-1)
   a &lt;- exp(p[3]*i + p[4]*i^2)
   cbind(a, a*i, a*i*(p[1]+p[2]*i), a*i^2*(p[1]+p[2]*i))
}

##Perform test (the expected result should be the acceptance of null)

hAhr_test(mr)

mr &lt;- midas_r(y~fmls(x,4*12-1,12,theta_h0)-1,
              list(y=y,x=x),
              start=list(x=c(-0.1,0.1,-0.1,-0.001)),
              weight_gradients=list())

##Use exact gradient. Note the 
hAhr_test(mr)

</code></pre>


</div>