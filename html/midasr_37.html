<div class="container">

<table style="width: 100%;"><tr>
<td>imidas_r</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Restricted MIDAS regression with I(1) regressors</h2>

<h3>Description</h3>

<p>Estimate restricted MIDAS regression using non-linear least squares, when the regressor is I(1)
</p>


<h3>Usage</h3>

<pre><code class="language-R">imidas_r(
  formula,
  data,
  start,
  Ofunction = "optim",
  weight_gradients = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>formula for restricted MIDAS regression. Formula must include <code>fmls</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a named list containing data with mixed frequencies</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>the starting values for optimisation. Must be a list with named elements.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ofunction</code></td>
<td>
<p>the list with information which R function to use for optimisation. The list must have element named <code>Ofunction</code> which contains character string of chosen R function. Other elements of the list are the arguments passed to this function. The default optimisation function is <code>optim</code> with argument <code>method="BFGS"</code>. Other supported functions are <code>nls</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight_gradients</code></td>
<td>
<p>a named list containing gradient functions of weights. The weight gradient function must return the matrix with dimensions
<code class="reqn">d_k \times q</code>, where <code class="reqn">d_k</code> and <code class="reqn">q</code> are the number of coefficients in unrestricted and restricted regressions correspondingly.
The names of the list should coincide with the names of weights used in formula.
The default value is NULL, which means that the numeric approximation of weight function gradient is calculated. If the argument is not NULL, but the
name of the weight used in formula is not present, it is assumed that there exists an R function which has  
the name of the weight function appended with <code>.gradient</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments supplied to optimisation function</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given MIDAS regression:
</p>
<p style="text-align: center;"><code class="reqn">y_t=\sum_{j=0}^k\sum_{i=0}^{m-1}\theta_{jm+i} x_{(t-j)m-i}+\mathbf{z_t}\beta+u_t</code>
</p>

<p>estimate the parameters of the restriction
</p>
<p style="text-align: center;"><code class="reqn">\theta_h=g(h,\lambda),</code>
</p>

<p>where <code class="reqn">h=0,...,(k+1)m</code>, together with coefficients <code class="reqn">\beta</code> corresponding to additional low frequency regressors.
</p>
<p>It is assumed that <code class="reqn">x</code> is a I(1) process, hence the special transformation is made. After the transformation midas_r is used for estimation.
</p>
<p>MIDAS regression involves times series with different frequencies. 
</p>
<p>The restriction function must return the restricted coefficients of
the MIDAS regression.
</p>


<h3>Value</h3>

<p>a <code>midas_r</code> object which is the list with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>the estimates of parameters of restrictions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>midas_coefficients</code></td>
<td>
<p>the estimates of MIDAS coefficients of MIDAS regression</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>model data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unrestricted</code></td>
<td>
<p>unrestricted regression estimated using <code>midas_u</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>term_info</code></td>
<td>
<p>the named list. Each element is a list with the information about the term, such as its frequency, function for weights, gradient function of weights, etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fn0</code></td>
<td>
<p>optimisation function for non-linear least squares problem solved in restricted MIDAS regression</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rhs</code></td>
<td>
<p>the function which evaluates the right-hand side of the MIDAS regression</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gen_midas_coef</code></td>
<td>
<p>the function which generates the MIDAS coefficients of MIDAS regression</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt</code></td>
<td>
<p>the output of optimisation procedure</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>argmap_opt</code></td>
<td>
<p>the list containing the name of optimisation function together with arguments for optimisation function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start_opt</code></td>
<td>
<p>the starting values used in optimisation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start_list</code></td>
<td>
<p>the starting values as a list</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the call to the function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms</code></td>
<td>
<p>terms object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gradient</code></td>
<td>
<p>gradient of NLS objective function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessian</code></td>
<td>
<p>hessian of NLS objective function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gradD</code></td>
<td>
<p>gradient function of MIDAS weight functions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Zenv</code></td>
<td>
<p>the environment in which data is placed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_gradient</code></td>
<td>
<p>TRUE if user supplied gradient is used, FALSE otherwise</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nobs</code></td>
<td>
<p>the number of effective observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>the convergence message</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>the fitted values of MIDAS regression</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>the residuals of MIDAS regression</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Virmantas Kvedaras, Vaidotas Zemlys
</p>


<h3>See Also</h3>

<p>midas_r.midas_r
</p>


<h3>Examples</h3>

<pre><code class="language-R">theta.h0 &lt;- function(p, dk) {
  i &lt;- (1:dk-1)/100
  pol &lt;- p[3]*i + p[4]*i^2
 (p[1] + p[2]*i)*exp(pol)
}

theta0 &lt;- theta.h0(c(-0.1,10,-10,-10),4*12)

xx &lt;- ts(cumsum(rnorm(600*12)), frequency = 12)

##Simulate the response variable
y &lt;- midas_sim(500, xx, theta0)

x &lt;- window(xx, start=start(y))

imr &lt;- imidas_r(y~fmls(x,4*12-1,12,theta.h0)-1,start=list(x=c(-0.1,10,-10,-10)))

</code></pre>


</div>