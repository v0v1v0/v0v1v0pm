<div class="container">

<table style="width: 100%;"><tr>
<td>midas_r</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Restricted MIDAS regression</h2>

<h3>Description</h3>

<p>Estimate restricted MIDAS regression using non-linear least squares.
</p>


<h3>Usage</h3>

<pre><code class="language-R">midas_r(
  formula,
  data,
  start,
  Ofunction = "optim",
  weight_gradients = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>formula for restricted MIDAS regression or <code>midas_r</code> object. Formula must include <code>fmls</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a named list containing data with mixed frequencies</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>the starting values for optimisation. Must be a list with named elements.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ofunction</code></td>
<td>
<p>the list with information which R function to use for optimisation. The list must have element named <code>Ofunction</code> which contains character string of chosen R function. Other elements of the list are the arguments passed to this function.  The default optimisation function is <code>optim</code> with argument <code>method="BFGS"</code>. Other supported functions are <code>nls</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight_gradients</code></td>
<td>
<p>a named list containing gradient functions of weights. The weight gradient function must return the matrix with dimensions
<code class="reqn">d_k \times q</code>, where <code class="reqn">d_k</code> and <code class="reqn">q</code> are the number of coefficients in unrestricted and restricted regressions correspondingly.
The names of the list should coincide with the names of weights used in formula.
The default value is NULL, which means that the numeric approximation of weight function gradient is calculated. If the argument is not NULL, but the
name of the weight used in formula is not present, it is assumed that there exists an R function which has  
the name of the weight function appended with <code>_gradient</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments supplied to optimisation function</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given MIDAS regression:
</p>
<p style="text-align: center;"><code class="reqn">y_t = \sum_{j=1}^p\alpha_jy_{t-j} +\sum_{i=0}^{k}\sum_{j=0}^{l_i}\beta_{j}^{(i)}x_{tm_i-j}^{(i)} + u_t,</code>
</p>

<p>estimate the parameters of the restriction
</p>
<p style="text-align: center;"><code class="reqn">\beta_j^{(i)}=g^{(i)}(j,\lambda).</code>
</p>

<p>Such model is a generalisation of so called ADL-MIDAS regression. It is not required that all the coefficients should be restricted, i.e the function <code class="reqn">g^{(i)}</code>
might be an identity function. Model with no restrictions is called U-MIDAS model. The regressors <code class="reqn">x_\tau^{(i)}</code> must be of higher
(or of the same) frequency as the dependent variable <code class="reqn">y_t</code>. 
</p>
<p>MIDAS-AR* (a model with a common factor, see (Clements and Galvao, 2008)) can be estimated by specifying additional argument, see an example.
</p>
<p>The restriction function must return the restricted coefficients of
the MIDAS regression.
</p>


<h3>Value</h3>

<p>a <code>midas_r</code> object which is the list with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>the estimates of parameters of restrictions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>midas_coefficients</code></td>
<td>
<p>the estimates of MIDAS coefficients of MIDAS regression</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>model data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unrestricted</code></td>
<td>
<p>unrestricted regression estimated using <code>midas_u</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>term_info</code></td>
<td>
<p>the named list. Each element is a list with the information about the term, such as its frequency, function for weights, gradient function of weights, etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fn0</code></td>
<td>
<p>optimisation function for non-linear least squares problem solved in restricted MIDAS regression</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rhs</code></td>
<td>
<p>the function which evaluates the right-hand side of the MIDAS regression</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gen_midas_coef</code></td>
<td>
<p>the function which generates the MIDAS coefficients of MIDAS regression</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt</code></td>
<td>
<p>the output of optimisation procedure</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>argmap_opt</code></td>
<td>
<p>the list containing the name of optimisation function together with arguments for optimisation function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start_opt</code></td>
<td>
<p>the starting values used in optimisation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start_list</code></td>
<td>
<p>the starting values as a list</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the call to the function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms</code></td>
<td>
<p>terms object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gradient</code></td>
<td>
<p>gradient of NLS objective function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessian</code></td>
<td>
<p>hessian of NLS objective function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gradD</code></td>
<td>
<p>gradient function of MIDAS weight functions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Zenv</code></td>
<td>
<p>the environment in which data is placed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_gradient</code></td>
<td>
<p>TRUE if user supplied gradient is used, FALSE otherwise</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nobs</code></td>
<td>
<p>the number of effective observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>the convergence message</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>the fitted values of MIDAS regression</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>the residuals of MIDAS regression</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Virmantas Kvedaras, Vaidotas Zemlys
</p>


<h3>References</h3>

<p>Clements, M. and Galvao, A., <em>Macroeconomic Forecasting With Mixed-Frequency Data: Forecasting Output Growth in the United States</em>, Journal of Business and Economic Statistics, Vol.26 (No.4), (2008) 546-554
</p>


<h3>Examples</h3>

<pre><code class="language-R">##The parameter function
theta_h0 &lt;- function(p, dk, ...) {
   i &lt;- (1:dk-1)/100
   pol &lt;- p[3]*i + p[4]*i^2
   (p[1] + p[2]*i)*exp(pol)
}

##Generate coefficients
theta0 &lt;- theta_h0(c(-0.1,10,-10,-10),4*12)

##Plot the coefficients
plot(theta0)

##Generate the predictor variable
xx &lt;- ts(arima.sim(model = list(ar = 0.6), 600 * 12), frequency = 12)

##Simulate the response variable
y &lt;- midas_sim(500, xx, theta0)

x &lt;- window(xx, start=start(y))

##Fit restricted model
mr &lt;- midas_r(y~fmls(x,4*12-1,12,theta_h0)-1,
              list(y=y,x=x),
              start=list(x=c(-0.1,10,-10,-10)))

##Include intercept and trend in regression
mr_it &lt;- midas_r(y~fmls(x,4*12-1,12,theta_h0)+trend,
                 list(data.frame(y=y,trend=1:500),x=x),
                 start=list(x=c(-0.1,10,-10,-10)))

data("USrealgdp")
data("USunempr")

y.ar &lt;- diff(log(USrealgdp))
xx &lt;- window(diff(USunempr), start = 1949)
trend &lt;- 1:length(y.ar)

##Fit AR(1) model
mr_ar &lt;- midas_r(y.ar ~ trend + mls(y.ar, 1, 1) +
                 fmls(xx, 11, 12, nealmon),
                 start = list(xx = rep(0, 3)))

##First order MIDAS-AR* restricted model 
mr_arstar &lt;-  midas_r(y.ar ~ trend + mls(y.ar, 1, 1, "*")
                     + fmls(xx, 11, 12, nealmon),
                     start = list(xx = rep(0, 3)))

</code></pre>


</div>