<div class="container">

<table style="width: 100%;"><tr>
<td>simulate_bundle</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generates a cross section of a cylinder bundle</h2>

<h3>Description</h3>

<p>Generates a cross section of a cylinder bundle with a given density and voxel
size. The cross section is generated by simulating a random distribution of
cylinders and computing the intersection of the cylinders with a plane. The
radii of the cylinders are drawn from a Gamma distribution fitted from data
retrieved by histology in the genu of the corpus callosum (Aboitiz et al.,
1992). The number of cylinders is determined by the density and the voxel
size.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simulate_bundle(
  density = 0.5,
  voxel_size = 10,
  rel_tol = 0.001,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>density</code></td>
<td>
<p>A numeric value between 0 and 1 specifying the density of the
cylinders in the voxel. Defaults to <code>0.5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>voxel_size</code></td>
<td>
<p>A numeric value specifying the size of the voxel in micro-
meters. Defaults to <code>10</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rel_tol</code></td>
<td>
<p>A numeric value specifying the relative tolerance to reach the
target volume defined as <code>density * voxel_size^2</code>. Defaults to <code>1e-3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A logical value specifying whether to print messages. Defaults
to <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li> <p><code>sections</code>: A numeric matrix with 3 columns:
</p>

<ul>
<li> <p><code>x</code>: The x-coordinates of the centers of the cylinders;
</p>
</li>
<li> <p><code>y</code>: The y-coordinates of the centers of the cylinders;
</p>
</li>
<li> <p><code>r</code>: The radii of the cylinders in micrometers.
</p>
</li>
</ul>
</li>
<li> <p><code>voxel_size</code>: The size of the voxel in micrometers
</p>
</li>
</ul>
<h3>References</h3>

<p>Aboitiz, F., Scheibel, A. B., Fisher, R. S., &amp; Zaidel, E. (1992).
Fiber composition of the human corpus callosum. Brain research, 598(1-2),
143-153.
</p>


<h3>Examples</h3>

<pre><code class="language-R">density &lt;- 0.5
voxel_size &lt;- 5 # micrometers
withr::with_seed(1234, {
  out &lt;- simulate_bundle(density, voxel_size)
})

# Actual density in the simulated substrate
sum(out$sections[, "r"]^2 * pi) / voxel_size^2
</code></pre>


</div>