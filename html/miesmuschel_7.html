<div class="container">

<table style="width: 100%;"><tr>
<td>dict_filtors_surprog</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Progressive Surrogate Model Filtering</h2>

<h3>Description</h3>

<p>Performs progressive surrogate model filtering. A surrogate model is used, as described in the parent class <code>FiltorSurrogate</code>.
The filtering is "progressive" in that successive values are filtered more agressively.
</p>


<h3>Algorithm</h3>

<p>Given the number <code>n_filter</code> of of individuals to sample, and the desired pool size at round <code>i</code> <code>pool_size(i)</code>, progressive
surrogate model filtering proceeds as follows:
</p>

<ol>
<li>
<p> Train the <code>surrogate_learner</code> <code>LearnerRegr</code> on the <code>known_values</code> and their <code>fitnesses</code>.
</p>
</li>
<li>
<p> Take <code>pool_size(1)</code> configurations, predict their expected performance using the surrogate model, and put them
into a pool <code>P</code> of configurations to consider.
</p>
</li>
<li>
<p> Initialize <code>i</code> to 1.
</p>
</li>
<li>
<p> Take the individual that is optimal according to predicted performance, remove it from <code>P</code> and add it to solution set <code>S</code>.
</p>
</li>
<li>
<p> If the number of solutions in <code>S</code> equals <code>n_filter</code>, quit.
</p>
</li>
<li>
<p> If <code>pool_size(i + 1)</code> is larger than <code>pool_size(i)</code>, take the next <code>pool_size(i + 1) - pool_size(i)</code> configurations,
predict their expected performance using the surrogate model, and add them to <code>P</code>. Otherwise, remove <code>pool_size(i) - pool_size(i + 1)</code>
random individuals from the pool. The size of <code>P</code> ends up being <code>pool_size(i + 1) - i</code>, as <code>i</code> individuals have also been removed and
added to <code>S</code>.
</p>
</li>
<li>
<p> Increment <code>i</code>, jump to 4.
</p>
</li>
</ol>
<p>(The algorithm presented here is optimized for clarity; the actual implementation does all the surrogate model prediction in one go, but is functionally
equivalent).
</p>
<p><code>pool_size(i)</code> is calculated as <code>round(n_filter * pool_factor * (pool_factor_last / pool_factor) ^ (i / n_filter))</code>, i.e. a log-linear interpolation from
<code>pool_factor * n_filter</code> to <code>pool_factor_last * n_filter</code>.
</p>
<p>The <code>pool_factor</code> and <code>pool_factor_last</code> configuration parameters of this algorithm determine how agressively the surrogate model is used to
filter out sampled configurations. If the filtering is agressive (large values), then more "exploitation" at the cost of "exploration" is performed.
When <code>pool_factor</code> is small but <code>pool_factor_last</code> is large (or vice-versa), then different individuals are filtered with different agressiveness, potentially
leading to a tradeoff between "exploration" and "exploitation".
</p>
<p>When <code>pool_factor_last</code> is set, it defaults to <code>pool_factor</code>, with no new individuals added and no individuals removed from the filter pool during filtering.
It is equivalent to taking the top <code>n_filter</code> individuals out of a sample of <code>n_filter * pool_factor</code>.
</p>


<h3>Configuration Parameters</h3>

<p><code>FiltorSurrogateProgressive</code>'s configuration parameters are the hyperparameters of the <code>FiltorSurrogate</code> base class, as well as:
</p>

<ul>
<li> <p><code>filter.pool_factor</code> :: <code>numeric(1)</code><br><code>pool_factor</code> parameter of the progressive surrogate model filtering algorithm, see the corresponding section. Initialized to 1. Together with the
default of <code>filter.pool_factor_last</code>, this is equivalent to random sampling new individuals.
</p>
</li>
<li> <p><code>filter.pool_factor_last</code> :: <code>numeric(1)</code><br><code>pool_factor_last</code> parameter of the progressive surrogate model filtering algorithm, see the corresponding section.
When not given, it defaults to <code>filter.pool_factor</code>, equivalent to taking the top <code>n_filter</code> from <code>n_filter * pool_factor</code> individuals.
</p>
</li>
</ul>
<h3>Supported Operand Types</h3>

<p>See <code>FiltorSurrogate</code> about supported operand types.
</p>


<h3>Dictionary</h3>

<p>This <code>Filtor</code> can be created with the short access form <code>ftr()</code>
(<code>ftrs()</code> to get a list), or through the the dictionary
<code>dict_filtors</code> in the following way:
</p>
<div class="sourceCode"><pre># preferred:
ftr("surprog", &lt;surrogate_learner&gt; [, &lt;surrogate_selector&gt;])
ftrs("surprog", &lt;surrogate_learner&gt; [, &lt;surrogate_selector&gt;])  # takes vector IDs, returns list of Filtors

# long form:
dict_filtors$get("surprog", &lt;surrogate_learner&gt; [, &lt;surrogate_selector&gt;])
</pre></div>


<h3>Super classes</h3>

<p><code>miesmuschel::MiesOperator</code> -&gt; <code>miesmuschel::Filtor</code> -&gt; <code>miesmuschel::FiltorSurrogate</code> -&gt; <code>FiltorSurrogateProgressive</code>
</p>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-FiltorSurrogateProgressive-new"><code>FiltorSurrogateProgressive$new()</code></a>
</p>
</li>
<li> <p><a href="#method-FiltorSurrogateProgressive-clone"><code>FiltorSurrogateProgressive$clone()</code></a>
</p>
</li>
</ul>
<details><summary>Inherited methods</summary><ul>
<li><span class="pkg-link" data-pkg="miesmuschel" data-topic="MiesOperator" data-id="help"><a href="../../miesmuschel/html/MiesOperator.html#method-MiesOperator-help"><code>miesmuschel::MiesOperator$help()</code></a></span></li>
<li><span class="pkg-link" data-pkg="miesmuschel" data-topic="MiesOperator" data-id="operate"><a href="../../miesmuschel/html/MiesOperator.html#method-MiesOperator-operate"><code>miesmuschel::MiesOperator$operate()</code></a></span></li>
<li><span class="pkg-link" data-pkg="miesmuschel" data-topic="MiesOperator" data-id="print"><a href="../../miesmuschel/html/MiesOperator.html#method-MiesOperator-print"><code>miesmuschel::MiesOperator$print()</code></a></span></li>
<li><span class="pkg-link" data-pkg="miesmuschel" data-topic="MiesOperator" data-id="repr"><a href="../../miesmuschel/html/MiesOperator.html#method-MiesOperator-repr"><code>miesmuschel::MiesOperator$repr()</code></a></span></li>
<li><span class="pkg-link" data-pkg="miesmuschel" data-topic="Filtor" data-id="needed_input"><a href="../../miesmuschel/html/Filtor.html#method-Filtor-needed_input"><code>miesmuschel::Filtor$needed_input()</code></a></span></li>
<li><span class="pkg-link" data-pkg="miesmuschel" data-topic="FiltorSurrogate" data-id="prime"><a href="../../miesmuschel/html/FiltorSurrogate.html#method-FiltorSurrogate-prime"><code>miesmuschel::FiltorSurrogate$prime()</code></a></span></li>
</ul></details><hr>
<a id="method-FiltorSurrogateProgressive-new"></a>



<h4>Method <code>new()</code>
</h4>

<p>Initialize the <code>FiltorSurrogateProgressive</code>.
</p>


<h5>Usage</h5>

<div class="r"><pre>FiltorSurrogateProgressive$new(
  surrogate_learner,
  surrogate_selector = SelectorBest$new()
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>surrogate_learner</code></dt>
<dd>
<p>(<code>mlr3::LearnerRegr</code>)<br>
Regression learner for the surrogate model filtering algorithm.<br>
The <code style="white-space: pre;">⁠$surrogate_learner⁠</code> field will reflect this value.</p>
</dd>
<dt><code>surrogate_learner</code></dt>
<dd>
<p>(<code>mlr3::LearnerRegr</code>)<br>
Regression learner for the surrogate model filtering algorithm.<br>
The <code style="white-space: pre;">⁠$surrogate_learner⁠</code> field will reflect this value.</p>
</dd>
<dt><code>surrogate_selector</code></dt>
<dd>
<p>(<code>Selector</code>)
<code>Selector</code> for the surrogate model filtering algorithm.<br>
The <code style="white-space: pre;">⁠$surrogate_selector⁠</code> field will reflect this value.</p>
</dd>
<dt><code>surrogate_selector</code></dt>
<dd>
<p>(<code>Selector</code>)
<code>Selector</code> for the surrogate model filtering algorithm.<br>
The <code style="white-space: pre;">⁠$surrogate_selector⁠</code> field will reflect this value.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-FiltorSurrogateProgressive-clone"></a>



<h4>Method <code>clone()</code>
</h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>FiltorSurrogateProgressive$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt>
<dd>
<p>Whether to make a deep clone.</p>
</dd>
</dl>
</div>




<h3>See Also</h3>

<p>Other filtors: 
<code>Filtor</code>,
<code>FiltorSurrogate</code>,
<code>dict_filtors_maybe</code>,
<code>dict_filtors_null</code>,
<code>dict_filtors_proxy</code>,
<code>dict_filtors_surtour</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library("mlr3")
library("mlr3learners")
fp = ftr("surprog", lrn("regr.lm"), filter.pool_factor = 2)

p = ps(x = p_dbl(-5, 5))
known_data = data.frame(x = 1:5)
fitnesses = 1:5
new_data = data.frame(x = c(2.5, 4.5))

fp$prime(p)

fp$needed_input(1)

fp$operate(new_data, known_data, fitnesses, 1)

</code></pre>


</div>