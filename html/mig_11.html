<div class="container">

<table style="width: 100%;"><tr>
<td>mig_kdens_bandwidth</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Optimal scale matrix for MIG kernel density estimation</h2>

<h3>Description</h3>

<p>Given an <code>n</code> sample from a multivariate
inverse Gaussian distribution on the half-space defined by
<code class="reqn">\{\boldsymbol{x} \in \mathbb{R}^d: \boldsymbol{\beta}^\top\boldsymbol{x}&gt;0\}</code>,
the function computes the bandwidth (<code>type="isotropic"</code>) or scale
matrix that minimizes the asymptotic mean integrated squared error away from the boundary.
The latter depend on the true unknown density, which is replaced using as plug-in
a MIG distribution evaluated at the maximum likelihood estimator. The integral or the integrated
squared error are obtained by Monte Carlo integration with <code>N</code> simulations
</p>


<h3>Usage</h3>

<pre><code class="language-R">mig_kdens_bandwidth(
  x,
  beta,
  shift,
  method = c("amise", "lcv", "lscv", "rlcv"),
  type = c("isotropic", "full"),
  approx = c("mig", "tnorm"),
  transformation = c("none", "scaling", "spherical"),
  N = 10000L,
  buffer = 0.25,
  pointwise = NULL,
  maxiter = 2000L,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an <code>n</code> by <code>d</code> matrix of observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p><code>d</code> vector defining the half-space</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shift</code></td>
<td>
<p>location vector for translating the half-space. If missing, defaults to zero</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>estimation criterion, either <code>amise</code> for the expression that minimizes the asymptotic integrated squared error, <code>lcv</code> for likelihood (leave-one-out) cross-validation, <code>lscv</code> for least-square cross-validation or <code>rlcv</code> for robust cross validation of Wu (2019)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>string indicating whether to compute an isotropic model or estimate the optimal scale matrix via optimization</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>approx</code></td>
<td>
<p>string; distribution to approximate the true density function <code class="reqn">f(x)</code>; either <code>mig</code> for multivariate inverse Gaussian, or <code>tnorm</code> for truncated Gaussian.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transformation</code></td>
<td>
<p>string for optional scaling of the data before computing the bandwidth. Either standardization to unit variance <code>scaling</code>, spherical transformation to unit variance and zero correlation (<code>spherical</code>), or <code>none</code> (default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>integer number of simulations to evaluate the integrals of the MISE by Monte Carlo</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>buffer</code></td>
<td>
<p>double indicating the buffer from the halfspace</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pointwise</code></td>
<td>
<p>if <code>NULL</code>, evaluates the mean integrated squared error, otherwise a <code>d</code> vector to evaluate the bandwidth or scale pointwise</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>integer; max number of iterations in the call to <code>optim</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters, currently ignored</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>d</code> by <code>d</code> scale matrix
</p>


<h3>References</h3>

<p>Wu, X. (2019). Robust likelihood cross-validation for kernel density estimation. <em>Journal of Business &amp; Economic Statistics</em>, 37(<b>4</b>), 761–770. <a href="https://doi.org/10.1080/07350015.2018.1424633">doi:10.1080/07350015.2018.1424633</a>
Bowman, A.W. (1984). An alternative method of cross-validation for the smoothing of density estimates, <em>Biometrika</em>, 71(<b>2</b>), 353–360. <a href="https://doi.org/10.1093/biomet/71.2.353">doi:10.1093/biomet/71.2.353</a>
Rudemo, M. (1982). Empirical choice of histograms and kernel density estimators. <em>Scandinavian Journal of Statistics</em>, 9(<b>2</b>), 65–78. http://www.jstor.org/stable/4615859
</p>


</div>