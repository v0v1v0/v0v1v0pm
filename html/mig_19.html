<div class="container">

<table style="width: 100%;"><tr>
<td>dmig</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multivariate inverse Gaussian distribution</h2>

<h3>Description</h3>

<p>The density of the MIG model is
</p>
<p style="text-align: center;"><code class="reqn">f(\boldsymbol{x}+\boldsymbol{a}) =(2\pi)^{-d/2}\boldsymbol{\beta}^{\top}\boldsymbol{\xi}|\boldsymbol{\Omega}|^{-1/2}(\boldsymbol{\beta}^{\top}\boldsymbol{x})^{-(1+d/2)}\exp\left\{-\frac{(\boldsymbol{x}-\boldsymbol{\xi})^{\top}\boldsymbol{\Omega}^{-1}(\boldsymbol{x}-\boldsymbol{\xi})}{2\boldsymbol{\beta}^{\top}\boldsymbol{x}}\right\}</code>
</p>

<p>for points in the <code>d</code>-dimensional half-space <code class="reqn">\{\boldsymbol{x} \in \mathbb{R}^d: \boldsymbol{\beta}^{\top}(\boldsymbol{x}-\boldsymbol{a}) \geq 0\}</code>
</p>


<h3>Usage</h3>

<pre><code class="language-R">dmig(x, xi, Omega, beta, shift, log = FALSE)

rmig(n, xi, Omega, beta, shift, method = c("invsim", "bm"), timeinc = 0.001)

pmig(q, xi, Omega, beta, log = FALSE, method = c("sov", "mc"), B = 10000L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p><code>n</code> by <code>d</code> matrix of quantiles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xi</code></td>
<td>
<p><code>d</code> vector of location parameters <code class="reqn">\boldsymbol{\xi}</code>, giving the expected value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Omega</code></td>
<td>
<p><code>d</code> by <code>d</code> positive definite scale matrix <code class="reqn">\boldsymbol{\Omega}</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p><code>d</code> vector <code class="reqn">\boldsymbol{\beta}</code> defining the half-space through <code class="reqn">\boldsymbol{\beta}^{\top}\boldsymbol{\xi}&gt;0</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shift</code></td>
<td>
<p><code>d</code> translation for the half-space <code class="reqn">\boldsymbol{a}</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>logical; if <code>TRUE</code>, returns log probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>string; one of inverse system (<code>invsim</code>, default), Brownian motion (<code>bm</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeinc</code></td>
<td>
<p>time increment for multivariate simulation algorithm based on the hitting time of Brownian motion, default to <code>1e-3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p><code>n</code> by <code>d</code> matrix of quantiles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>number of Monte Carlo replications for the SOV estimator</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Observations are generated using the representation as the first hitting time of a hyperplane of a correlated Brownian motion.
</p>


<h3>Value</h3>

<p>for <code>dmig</code>, the (log)-density
</p>
<p>for <code>rmig</code>, an <code>n</code> vector if <code>d=1</code> (univariate) or an <code>n</code> by <code>d</code> matrix if <code>d &gt; 1</code>
</p>
<p>an <code>n</code> vector of (log) probabilities
</p>


<h3>Author(s)</h3>

<p>Frederic Ouimet (<code>bm</code>), Leo Belzile (<code>invsim</code>)
</p>
<p>Leo Belzile
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Density evaluation
x &lt;- rbind(c(1, 2), c(2,3), c(0,-1))
beta &lt;- c(1, 0)
xi &lt;- c(1, 1)
Omega &lt;- matrix(c(2, -1, -1, 2), nrow = 2, ncol = 2)
dmig(x, xi = xi, Omega = Omega, beta = beta)
# Random number generation
d &lt;- 5L
beta &lt;- runif(d)
xi &lt;- rexp(d)
Omega &lt;- matrix(0.5, d, d) + diag(d)
samp &lt;- rmig(n = 1000, beta = beta, xi = xi, Omega = Omega)
mle &lt;- fit_mig(samp, beta = beta, method = "mle")
set.seed(1234)
d &lt;- 2L
beta &lt;- runif(d)
Omega &lt;- rWishart(n = 1, df = 2*d, Sigma = matrix(0.5, d, d) + diag(d))[,,1]
xi &lt;- rexp(d)
q &lt;- mig::rmig(n = 10, beta = beta, Omega = Omega, xi = xi)
pmig(q, xi = xi, beta = beta, Omega = Omega)
</code></pre>


</div>