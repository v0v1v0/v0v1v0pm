<div class="container">

<table style="width: 100%;"><tr>
<td>cm_net_tot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Conditional maximization routine for the indirect estimation of origin-destination-type migration flow tables with known net migration and grand totals.</h2>

<h3>Description</h3>

<p>The <code>cm_net</code> function finds the maximum likelihood estimates for fitted values in the log-linear model:
</p>
<p style="text-align: center;"><code class="reqn">\log y_{ij} = \log \alpha_{i} + \log \alpha_{i}^{-1} + \log m_{ij} </code>
</p>



<h3>Usage</h3>

<pre><code class="language-R">cm_net_tot(
  net_tot = NULL,
  tot = NULL,
  m = NULL,
  tol = 1e-06,
  maxit = 500,
  verbose = TRUE,
  alpha0 = rep(1, length(net_tot)),
  lambda0 = 1,
  alpha_constrained = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>net_tot</code></td>
<td>
<p>Vector of net migration totals to constrain the sum of the imputed cell row and columns. Elements must sum to zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tot</code></td>
<td>
<p>Numeric value of grand total to constrain sum of all imputed cells.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>Array of auxiliary data. By default, set to 1 for all origin-destination-migrant typologies combinations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Numeric value for the tolerance level used in the parameter estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>Numeric value for the maximum number of iterations used in the parameter estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical value to indicate the print the parameter estimates at each iteration. By default <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha0</code></td>
<td>
<p>Vector of initial estimates for alpha</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda0</code></td>
<td>
<p>Numeric value of initial estimates for lambda</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_constrained</code></td>
<td>
<p>Logical value to indicate if the first alpha should be constrain to unity. By default <code>TRUE</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Conditional maximisation routine set up using the partial likelihood derivatives. The argument <code>net_tot</code> takes the known net migration totals.
The user must ensure that the net migration totals sum globally to zero.
</p>
<p>Returns a <code>list</code> object with
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mu </code></td>
<td>
<p>Array of indirect estimates of origin-destination matrices by migrant characteristic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>it </code></td>
<td>
<p>Iteration count</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol </code></td>
<td>
<p>Tolerance level at final iteration</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Guy J. Abel, Peter W. F. Smith
</p>


<h3>Examples</h3>

<pre><code class="language-R">m &lt;- matrix(data = 1:16, nrow = 4)
# m[lower.tri(m)] &lt;- t(m)[lower.tri(m)]
addmargins(m)
sum_net(m)

y &lt;- cm_net_tot(net_tot = c(30, 40, -15, -55), tot = 200, m = m)
addmargins(y$n)
sum_net(y$n)

m &lt;- matrix(data = c(0, 100, 30, 70, 50, 0, 45, 5, 60, 35, 0, 40, 20, 25, 20, 0),
            nrow = 4, ncol = 4, byrow = TRUE,
            dimnames = list(orig = LETTERS[1:4], dest = LETTERS[1:4]))
addmargins(m)
sum_net(m)

y &lt;- cm_net_tot(net_tot = c(-100, 125, -75, 50), tot = 600, m = m)
addmargins(y$n)
sum_net(y$n)
</code></pre>


</div>