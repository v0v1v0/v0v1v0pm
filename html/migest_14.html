<div class="container">

<table style="width: 100%;"><tr>
<td>ffs_demo</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimation of bilateral migrant flows from bilateral migrant stocks using demographic accounting approaches</h2>

<h3>Description</h3>

<p>Estimates migrant transitions flows between two sequential migrant stock tables. Replaces old <code>ffs</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ffs_demo(
  stock_start = NULL,
  stock_end = NULL,
  births = NULL,
  deaths = NULL,
  seed = NULL,
  stayer_assumption = TRUE,
  match_global = "before-demo-adjust",
  match_birthplace_tot_method = "rescale",
  birth_method = "native",
  birth_non_negative = TRUE,
  death_method = "proportion",
  verbose = FALSE,
  return = "flow"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>stock_start</code></td>
<td>
<p>Matrix of migrant stock totals at time <em>t</em>. Rows in the matrix correspond to place of birth and columns to place of residence at time <em>t</em>. Previously had argument name <code>m1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stock_end</code></td>
<td>
<p>Matrix of migrant stock totals at time <em>t</em>+1. Rows in the matrix correspond to place of birth and columns to place of residence at time <em>t</em>+1. Previously had argument name <code>m2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>births</code></td>
<td>
<p>Vector of the number of births between time <em>t</em> and <em>t</em>+1 in each region. Previously had argument name <code>b_por</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deaths</code></td>
<td>
<p>Vector of the number of deaths between time <em>t</em> and <em>t</em>+1 in each region. Previously had argument name <code>d_por</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Matrix of auxiliary data. By default set to 1 for all origin-destination combinations. Previously had argument name <code>m</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stayer_assumption</code></td>
<td>
<p>Logical value to indicate whether to use a quasi-independent or independent IPFP to estimate flows. By default uses quasi-independent, i.e. is set to <code>TRUE</code> and estimates the minimum migration. When set to <code>FALSE</code> estimates flows under the independent model as used as part of Azose and Raftery (2019).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>match_global</code></td>
<td>
<p>Character string used to indicate whether to balance the change in stocks totals with the changes in births and deaths. Only applied when <code>match_birthplace_tot_method</code> is either <code>rescale</code> or <code>rescale-adjust-zero-fb</code>. By default uses <code>after-demo-adjust</code> rather than <code>before-demo-adjust</code> which I think minimises risk of negative values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>match_birthplace_tot_method</code></td>
<td>
<p>Character string passed to <code>method</code> argument in <code>match_birthplace_tot</code> to ensure place of birth margins in stock tables match.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>birth_method</code></td>
<td>
<p>Character string passed to <code>method</code> argument in <code>birth_mat</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>birth_non_negative</code></td>
<td>
<p>Logical value passed to <code>non_negative</code> argument in <code>birth_mat</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>death_method</code></td>
<td>
<p>Character string passed to <code>method</code> argument in <code>death_mat</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical value to show progress of the estimation procedure. By default <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return</code></td>
<td>
<p>Character string used to indicate whether to return the array of estimated flows when set to <code>flow</code> (default), array of demographic accounts when set to <code>account</code> or the demographic account, list of input settings and the origin-destination matrix when set to <code>classic</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Estimates migrant transitions flows between two sequential migrant stock tables using various methods. See the example section for possible variations on estimation methods.
</p>
<p>Detail of returned object varies depending on the setting used in the <code>return</code> argument.
</p>


<h3>Author(s)</h3>

<p>Guy J. Abel
</p>


<h3>References</h3>

<p>Abel and Cohen (2019) Bilateral international migration flow estimates for 200 countries <em>Scientific Data</em> 6 (1), 1-13
</p>
<p>Azose &amp; Raftery (2019) Estimation of emigration, return migration, and transit migration between all pairs of countries <em>Proceedings of the National Academy of Sciences</em> 116 (1) 116-122
</p>
<p>Abel, G. J. (2018). Estimates of Global Bilateral Migration Flows by Gender between 1960 and 2015. <em>International Migration Review</em> 52 (3), 809â€“852.
</p>
<p>Abel, G. J. and Sander, N. (2014). Quantifying Global International Migration Flows. <em>Science</em>, 343 (6178) 1520-1522
</p>
<p>Abel, G. J. (2013). Estimating Global Migration Flow Tables Using Place of Birth. <em>Demographic Research</em> 28, (18) 505-546
</p>


<h3>See Also</h3>

<p><code>ffs_diff</code>, <code>ffs_rates</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">##
## without births and deaths over period
##
# data as in demographic research and science paper papers
s1 &lt;- matrix(data = c(1000, 100, 10, 0, 55, 555, 50, 5, 80, 40, 800, 40, 20, 25, 20, 200),
             nrow = 4, ncol = 4, byrow = TRUE)
s2 &lt;- matrix(data = c(950, 100, 60, 0, 80, 505, 75, 5, 90, 30, 800, 40, 40, 45, 0, 180),
             nrow = 4, ncol = 4, byrow = TRUE)
b &lt;- d &lt;- rep(0, 4)
r &lt;- LETTERS[1:4]
dimnames(s1) &lt;- dimnames(s2) &lt;- list(birth =  r, dest = r)
names(b) &lt;- names(d) &lt;- r
addmargins(s1)
addmargins(s2)
b
d

# demographic research and science paper example
e0 &lt;- ffs_demo(stock_start = s1, stock_end = s2, births = b, deaths = d)
e0
sum_od(e0)

# international migration review paper example
s1[,] &lt;- c(100, 20, 10, 20, 10, 55, 40, 25, 10, 25, 140, 20, 0, 10, 65, 200)
s2[,] &lt;- c(70, 25, 10, 40, 30, 60, 55, 45, 10, 10, 140, 0, 10, 15, 50, 180)
addmargins(s1)
addmargins(s2)

e1 &lt;- ffs_demo(stock_start = s1, stock_end = s2, births = b, deaths = d)
sum_od(e1)

# international migration review supp. material example
# distance matrix
dd &lt;- matrix(data = c(0, 5, 50, 500, 5, 0, 45, 495, 50, 45, 0, 450, 500, 495, 450, 0),
             nrow = 4, ncol = 4, byrow = TRUE)
dimnames(dd) &lt;- list(orig = r, dest = r)
dd
e2 &lt;- ffs_demo(stock_start = s1, stock_end = s2, births = b, deaths = d, seed = dd)
sum_od(e2)

##
## with births and deaths over period
##
# demographic research paper example (with births and deaths)
s1[,] &lt;- c(1000, 55, 80, 20, 100, 555, 40, 25, 10, 50, 800, 20, 0, 5, 40, 200)
s2[,] &lt;- c(1060, 45, 70, 30, 60, 540, 75, 30, 10, 40, 770, 20, 10, 0, 70, 230)
b[] &lt;- c(80, 20, 40, 60)
d[] &lt;- c(70, 30, 50, 10)
e3 &lt;- ffs_demo(stock_start = s1, stock_end = s2, 
               births = b, deaths = d, 
               match_birthplace_tot_method = "open-dr")
sum_od(e3)
# makes more sense to use this method
e4 &lt;- ffs_demo(stock_start = s1, stock_end = s2, 
               births = b, deaths = d, 
               match_birthplace_tot_method = "open")
sum_od(e4)

# science paper  supp. material example
b[] &lt;- c(80, 20, 60, 60)
e5 &lt;- ffs_demo(stock_start = s1, stock_end = s2, births = b, deaths = d)
sum_od(e5)

# international migration review supp. material example (with births and deaths)
s1[,] &lt;- c(100, 20, 10, 20, 10, 55, 40, 25, 10, 25, 140, 20, 0, 10, 65, 200)
s2[,] &lt;- c(75, 20, 30, 30, 25, 45, 40, 30, 5, 30, 150, 20, 0, 15, 60, 230)
b[] &lt;- c(10, 50, 25, 60)
d[] &lt;- c(30, 10, 40, 10)
e6 &lt;- ffs_demo(stock_start = s1, stock_end = s2, births = b, deaths = d)
sum_od(e6)

# scientific data 2019 paper
s1[] &lt;- c(100, 80, 30, 60, 10, 180, 10, 70, 10, 10, 140, 10, 0, 90, 40, 160)
s2[] &lt;- c(95, 75, 55, 35, 5, 225, 0, 25, 15, 5, 115, 25, 5, 55, 50, 215)
b[] &lt;- c(0, 0, 0, 0)
d[] &lt;- c(0, 0, 0, 0)
e7 &lt;- ffs_demo(stock_start = s1, stock_end = s2, births = b, deaths = d)
sum_od(e7)
</code></pre>


</div>