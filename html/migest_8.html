<div class="container">

<table style="width: 100%;"><tr>
<td>cm2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Conditional maximization routine for the indirect estimation of origin-destination migration flow table with known margins</h2>

<h3>Description</h3>

<p>The <code>cm2</code> function finds the maximum likelihood estimates for parameters in the log-linear model:
</p>
<p style="text-align: center;"><code class="reqn"> \log y_{ij} = \log \alpha_i + \log \beta_j + \log m_{ij} </code>
</p>

<p>as introduced by Willekens (1999). The <code class="reqn">\alpha_i</code> and  <code class="reqn">\beta_j</code> represent background information related to  the characteristics of the origin and destinations respectively. The <code class="reqn">m_{ij}</code> factor represents auxiliary information on migration flows, which imposes its interaction structure onto the estimated flow matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cm2(
  row_tot = NULL,
  col_tot = NULL,
  m = matrix(data = 1, nrow = length(row_tot), ncol = length(col_tot)),
  tol = 1e-06,
  maxit = 500,
  verbose = TRUE,
  rtot = row_tot,
  ctot = col_tot
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>row_tot</code></td>
<td>
<p>Vector of origin totals to constrain the sum of the imputed cell rows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_tot</code></td>
<td>
<p>Vector of destination totals to constrain the sum of the imputed cell columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>Matrix of auxiliary data. By default set to 1 for all origin-destination combinations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Numeric value for the tolerance level used in the parameter estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>Numeric value for the maximum number of iterations used in the parameter estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical value to indicate the print the parameter estimates at each iteration. By default <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rtot</code></td>
<td>
<p>Depreciated. Use <code>row_tot</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ctot</code></td>
<td>
<p>Depreciated. Use <code>col_tot</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Parameter estimates are obtained using the EM algorithm outlined in Willekens (1999). This is equivalent to a conditional maximization of the likelihood, as discussed by Raymer et. al. (2007). It also provides identical indirect estimates to those obtained from the <code>ipf2</code> routine. 
</p>
<p>The user must ensure that the row and column totals are equal in sum. Care must also be taken to allow the dimension of the auxiliary matrix (<code>m</code>) to equal those provided in the row (<code>row_tot</code>) and column (<code>col_tot</code>) arguments.
</p>
<p>Returns a <code>list</code> object with
</p>
<table>
<tr style="vertical-align: top;">
<td><code>N </code></td>
<td>
<p>Origin-Destination matrix of indirect estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta </code></td>
<td>
<p>Collection of parameter estimates</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Guy J. Abel
</p>


<h3>References</h3>

<p>Raymer, J., G. J. Abel, and P. W. F. Smith (2007). Combining census and registration data to estimate detailed elderly migration flows in England and Wales. <em>Journal of the Royal Statistical Society: Series A (Statistics in Society)</em> 170 (4), 891–908.
</p>
<p>Willekens, F. (1999). Modelling Approaches to the Indirect Estimation of Migration Flows: From Entropy to EM. <em>Mathematical Population Studies</em> 7 (3), 239–78.
</p>


<h3>See Also</h3>

<p><code>ipf2</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## with Willekens (1999) data
r &lt;- LETTERS[1:2]
y &lt;- cm2(row_tot = c(18, 20), col_tot = c(16, 22), 
         m = matrix(c(5, 1, 2, 7), ncol = 2, dimnames = list(orig = r, dest = r)))
y

## with all elements of offset equal (independence fit)
y &lt;- cm2(row_tot = c(18, 20), col_tot = c(16, 22))
y

## with bigger matrix
r &lt;- LETTERS[1:4]
y &lt;- cm2(row_tot = c(250, 100, 140, 110), col_tot = c(150, 150, 180, 120),
         m = matrix(data = c(0, 100, 30, 70, 50, 0, 45, 5, 60, 35, 0, 40, 20, 25, 20, 0),
                    nrow = 4, ncol = 4, dimnames = list(orig = r, dest = r), byrow = TRUE))
                    
# display with row and col totals
round(addmargins(y$n)) 
</code></pre>


</div>