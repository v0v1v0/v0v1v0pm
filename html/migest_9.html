<div class="container">

<table style="width: 100%;"><tr>
<td>cm3</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Conditional maximization routine for the indirect estimation of origin-destination-migrant type migration flow tables with known origin and destination margins.</h2>

<h3>Description</h3>

<p>The <code>cm3</code> function finds the maximum likelihood estimates for parameters in the log-linear model:
</p>
<p style="text-align: center;"><code class="reqn"> \log y_{ijk} = \log \alpha_{i} + \log \beta_{j} + \log m_{ijk} </code>
</p>

<p>as introduced by Abel (2005). The <code class="reqn">\alpha_{i}</code> and  <code class="reqn">\beta_{j}</code> represent background information related to  the characteristics of the origin and destinations respectively. The <code class="reqn">m_{ijk}</code> factor represents auxiliary information on origin-destination migration flows by a migrant characteristic (such as age, sex, disability, household type, economic status, etc.). This method is useful for combining data from detailed data collection processes (such as a Census) with more up-to-date information on migration inflows and outflows (where details on movements by migrant characteristics are not known).
</p>


<h3>Usage</h3>

<pre><code class="language-R">cm3(
  row_tot = NULL,
  col_tot = NULL,
  m = NULL,
  tol = 1e-06,
  maxit = 500,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>row_tot</code></td>
<td>
<p>Vector of origin totals to constrain the sum of the imputed cell rows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_tot</code></td>
<td>
<p>Vector of destination totals to constrain the sum of the imputed cell columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>Array of auxiliary data. By default set to 1 for all origin-destination-migrant typology combinations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Numeric value for the tolerance level used in the parameter estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>Numeric value for the maximum number of iterations used in the parameter estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical value to indicate the print the parameter estimates at each iteration. By default <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Parameter estimates were obtained using the conditional maximization of the likelihood, as discussed by Abel (2005) and Raymer et. al. (2007). 
</p>
<p>The user must ensure that the row and column totals are equal in sum. Care must also be taken to allow the row and column dimension of the auxiliary matrix (<code>m</code>) to equal those provided in the row and column totals.
</p>
<p>Returns a <code>list</code> object with
</p>
<table>
<tr style="vertical-align: top;">
<td><code>N </code></td>
<td>
<p>Origin-Destination matrix of indirect estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta </code></td>
<td>
<p>Collection of parameter estimates</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Guy J. Abel
</p>


<h3>References</h3>

<p>Abel, G. J. (2005) <em>The Indirect Estimation of Elderly Migrant Flows in England and Wales</em> (MS.c. Thesis). University of Southampton
</p>
<p>Raymer, J., G. J. Abel, and P. W. F. Smith (2007). Combining census and registration data to estimate detailed elderly migration flows in England and Wales. <em>Journal of the Royal Statistical Society: Series A (Statistics in Society)</em> 170 (4), 891â€“908.
</p>


<h3>See Also</h3>

<p><code>cm2</code>, <code>ipf3</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## over two tables
r &lt;- LETTERS[1:2]
y &lt;- cm3(row_tot = c(18, 20) * 2, col_tot = c(16, 22) * 2,
         m = array(c(5, 1, 2, 7, 4, 2, 5, 9), dim = c(2, 2, 2),
                   dimnames = list(orig = r, dest = r, type = c("ILL", "HEALTHY"))))
# display with row, col and table totals
y

## over three tables
y &lt;- cm3(row_tot = c(170, 120, 410), col_tot = c(500, 140, 60),
         m = array(c(5, 1, 2, 7,  4, 2, 5, 9,  5, 4, 3, 1), dim = c(2, 2, 3),
                   dimnames = list(orig = r, dest = r, type = c("0--15", "15-60", "&gt;60"))),
                   verbose = FALSE)
# display with row, col and table totals
y
</code></pre>


</div>