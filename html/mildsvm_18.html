<div class="container">

<table style="width: 100%;"><tr>
<td>kfm_nystrom</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit a Nyström kernel feature map approximation</h2>

<h3>Description</h3>

<p>Use the Nyström method to fit a feature map that approximates a given kernel.
</p>


<h3>Usage</h3>

<pre><code class="language-R">kfm_nystrom(df, m, r, kernel, sampling, ...)

## Default S3 method:
kfm_nystrom(
  df,
  m = nrow(df),
  r = m,
  kernel = "radial",
  sampling = "random",
  ...
)

## S3 method for class 'mild_df'
kfm_nystrom(
  df,
  m = nrow(df),
  r = m,
  kernel = "radial",
  sampling = "random",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>An object containing covariates for training.  Usually a data.frame
or matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>The number of examples from <code>df</code> to sample in fitting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>The rank of matrix approximation to use. Must be less than or equal
to <code>m</code>, the default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>
<p>A character determining the kernel to use.  Currently, only
<code>'radial'</code> is implemented.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampling</code></td>
<td>
<p>A character determining how to sample instances.  Default is
<code>'random'</code>. For <code>kfm_nystrom.mild_df()</code>, one can specify <code>sampling = 'stratified'</code> to ensure that samples are chosen evenly from bags and
instances. <code>sampling</code> can also be a numeric vector of length <code>m</code> of
pre-determined samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters needed for the kernels.  See details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For the <code>...</code> argument, the additional parameters depend on which kernel is
used:
</p>

<ul><li>
<p> For <code>kernel = 'radial'</code>, specify <code>sigma</code> to define kernel bandwidth.
</p>
</li></ul>
<h3>Value</h3>

<p>an object of class <code>kfm_nystrom</code> with the following components:
</p>

<ul>
<li> <p><code>df_sub</code> the sub-sampled version of <code>df</code>
</p>
</li>
<li> <p><code>dv</code> pre-multiplication matrix which contains information on the
eigenvalues and eigenvectors of <code>df_sub</code>
</p>
</li>
<li> <p><code>method</code> <code>'nystrom'</code>
</p>
</li>
<li> <p><code>kernel</code> the input parameter <code>kernel</code>
</p>
</li>
<li> <p><code>kernel_params</code> parameters passed to <code>...</code>
</p>
</li>
</ul>
<h3>Methods (by class)</h3>


<ul>
<li> <p><code>default</code>: For use on objects of class <code>data.frame</code> or <code>matrix</code>.
</p>
</li>
<li> <p><code>mild_df</code>: Ignore the information columns <code>'bag_label'</code>,
<code>'bag_name'</code>, and <code>'instance_name'</code> when calculating kernel approximation.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Sean Kent
</p>


<h3>References</h3>

<p>Williams, C., &amp; Seeger, M. (2001). Using the Nyström Method to
Speed Up Kernel Machines. <em>Advances in Neural Information Processing
Systems</em>, <em>13</em>, 682–688.
</p>
<p>Kent, S., &amp; Yu, M. (2022). Non-convex SVM for cancer diagnosis based on
morphologic features of tumor microenvironment <em>arXiv preprint</em>
<a href="https://arxiv.org/abs/2206.14704">arXiv:2206.14704</a>
</p>


<h3>See Also</h3>

<p>Other kernel feature map functions: 
<code>kfm_exact()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">df &lt;- data.frame(
  X1 = c(2,   3,   4,   5,   6, 7, 8),
  X2 = c(1, 1.2, 1.3, 1.4, 1.1, 7, 1),
  X3 = rnorm(7)
)

fit &lt;- kfm_nystrom(df, m = 7, r = 6, kernel = "radial", sigma = 0.05)
fm &lt;- build_fm(fit, df)

</code></pre>


</div>