<div class="container">

<table style="width: 100%;"><tr>
<td>softmax</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multiple-instance logistic regression via softmax function</h2>

<h3>Description</h3>

<p>This function calculates the alternative maximum likelihood estimation for 
multiple-instance logistic regression
through a softmax function (Xu and Frank, 2004; Ray and Craven, 2005).
</p>


<h3>Usage</h3>

<pre><code class="language-R">softmax(y, x, bag, alpha = 0, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector. Bag-level binary labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the design matrix. The number of rows of <code>x</code> must be equal to the length of <code>y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bag</code></td>
<td>
<p>a vector, bag id.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>A non-negative realnumber, the softmax parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments to be passed to the <code>optim</code> function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list including coefficients and fitted values.
</p>


<h3>References</h3>


<ol>
<li>
<p> S. Ray, and M. Craven. (2005) Supervised versus multiple instance learning: 
An empirical comparsion. in Proceedings of the 22nd International Conference on 
Machine Learnings, ACM, 697–704.
</p>
</li>
<li>
<p> X. Xu, and E. Frank. (2004) Logistic regression and boosting for labeled bags 
of instances. in Advances in Knowledge Discovery and Data Mining, Springer, 272–281.
</p>
</li>
</ol>
<h3>Examples</h3>

<pre><code class="language-R">set.seed(100)
beta &lt;- runif(10, -5, 5)
trainData &lt;- DGP(40, 3, beta)
testData &lt;- DGP(5, 3, beta)
# Fit softmax-MILR model S(0)
softmax_result &lt;- softmax(trainData$Z, trainData$X, trainData$ID, alpha = 0)
coef(softmax_result)      # coefficients
fitted(softmax_result)                    # fitted bag labels
fitted(softmax_result, type = "instance") # fitted instance labels
predict(softmax_result, testData$X, testData$ID)                    # predicted bag labels
predict(softmax_result, testData$X, testData$ID, type = "instance") # predicted instance labels
# Fit softmax-MILR model S(3) (not run)
# softmax_result &lt;- softmax(trainData$Z, trainData$X, trainData$ID, alpha = 3)
</code></pre>


</div>