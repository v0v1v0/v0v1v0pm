<div class="container">

<table style="width: 100%;"><tr>
<td>mine</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MINE family statistics
Maximal Information-Based Nonparametric Exploration (MINE) 
statistics. <code>mine</code> computes the MINE family measures between two variables.</h2>

<h3>Description</h3>

<p>MINE family statistics
Maximal Information-Based Nonparametric Exploration (MINE) 
statistics. <code>mine</code> computes the MINE family measures between two variables.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mine(
  x,
  y = NULL,
  master = NULL,
  alpha = 0.6,
  C = 15,
  n.cores = 1,
  var.thr = 1e-05,
  eps = NULL,
  est = "mic_approx",
  na.rm = FALSE,
  use = "all.obs",
  normalization = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector (of size <em>n</em>), matrix or data frame (which is coerced to matrix).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>NULL (default) or a numeric vector of size <em>n</em> (<em>i.e.</em>, with compatible dimensions to x).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>master</code></td>
<td>
<p>an optional vector of indices (numeric or character) to
be given when <code>y</code> is not set, otherwise master is ignored. It can be 
either one column index to be used as reference for the comparison 
(versus all other columns) or a vector of column indices to be used for 
computing all mutual statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>float (0, 1.0] or &gt;=4 if alpha is in (0,1] then B will be max(n^alpha, 4) where n is the
number of samples. If alpha is &gt;=4 then alpha defines directly the B
parameter. If alpha is higher than the number of samples (n) it will be
limited to be n, so B = min(alpha, n) Default value is 0.6 (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>an optional number determining the starting point of the 
<em>X-by-Y</em> search-grid. When trying to partition the <em>x</em>-axis into 
<em>X</em> columns, the algorithm will start with at most <code>C</code><em>X</em> 
<em>clumps</em>. Default value is 15 (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.cores</code></td>
<td>
<p>ooptional number of cores to be used in the
computations, when master is specified. It requires the
<span class="pkg">parallel</span> package, which provides support for parallel 
computing, released with <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> &gt;= 2.14.0. Defaults is 1 (<em>i.e.</em>, not performing parallel computing).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.thr</code></td>
<td>
<p>minimum value allowed for the variance of the input
variables, since <code>mine</code> can not be computed in case of variance
close to 0. Default value is 1e-5. Information about failed check
are reported in <em>var_thr.log</em> file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>integer in [0,1].  If 'NULL' (default) it is set to
1-MIC. It can be set to zero for noiseless functions,
but the default choice is the most appropriate parametrization
for general cases (as stated in Reshef et al. SOM).
It provides robustness.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>
<p>Default value is "mic_approx". With est="mic_approx" the original MINE statistics will
be computed, with est="mic_e" the equicharacteristic matrix is
is evaluated and the mic() and tic() methods will return MIC_e and
TIC_e values respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>boolean. This variable is passed directly to the
<code>cor</code>-based functions. See <code>cor</code> for further details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use</code></td>
<td>
<p>Default value is "all.obs". This variable is passed directly to the 
<code>cor</code>-based functions. See <code>cor</code> for further details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalization</code></td>
<td>
<p>logical whether to use normalization when computing <code>tic</code> measure. Ignored for other measures.
Default to FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>currently ignored</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>mine</code> is an R wrapper for the C engine <em>cmine</em> 
(<a href="http://minepy.readthedocs.io/en/latest/">http://minepy.readthedocs.io/en/latest/</a>), 
an implementation of Maximal Information-Based Nonparametric Exploration (MINE) 
statistics. The MINE statistics were firstly detailed in 
D. Reshef et al. (2011) <em>Detecting novel associations in large datasets</em>. 
Science 334, 6062 (<a href="http://www.exploredata.net">http://www.exploredata.net</a>).
</p>
<p>Here we recall the main concepts of the MINE family statistics.
Let <code class="reqn">D={(x,y)}</code> be the set of <em>n</em> ordered pairs of elements of <code>x</code>
and <code>y</code>. The data space is partitioned in 
an <em>X-by-Y</em> grid, grouping the <em>x</em> and <em>y</em> values 
in <em>X</em> and <em>Y</em> bins respectively.<br></p>
<p>The <strong>Maximal Information Coefficient (MIC)</strong> is defined as 
</p>
<p style="text-align: center;"><code class="reqn">\textrm{MIC}(D)=\max_{XY&lt;B(n)} M(D)_{X,Y} = \max_{XY&lt;B(n)} \frac{I^*(D,X,Y)}{log(\min{X,Y})},</code>
</p>
<p> where
<code class="reqn">B(n)=n^{\alpha}</code> is the search-grid size,
<code class="reqn">I^*(D,X,Y)</code>
is the maximum mutual information over all grids <em>X-by-Y</em>, of the distribution induced by D on 
a grid having <em>X</em> and <em>Y</em> bins (where the probability mass on a cell 
of the grid is the fraction of points of D falling in that cell).
The other statistics of the MINE family are derived from the mutual information 
matrix achieved by an <em>X-by-Y</em> grid on D.<br></p>
<p>The <strong>Maximum Asymmetry Score (MAS)</strong> is defined as
</p>
<p style="text-align: center;"><code class="reqn">\textrm{MAS}(D) = \max_{XY&lt;B(n)} |M(D)_{X,Y} - M(D)_{Y,X}|.</code>
</p>

<p>The <strong>Maximum Edge Value (MEV)</strong> is defined as
</p>
<p style="text-align: center;"><code class="reqn">\textrm{MEV}(D) = \max_{XY&lt;B(n)} \{M(D)_{X,Y}: X=2~or~Y=2\}.</code>
</p>

<p>The <strong>Minimum Cell Number (MCN)</strong> is defined as
</p>
<p style="text-align: center;"><code class="reqn">\textrm{MCN}(D,\epsilon) = \min_{XY&lt;B(n)} \{\log(XY): M(D)_{X,Y} \geq (1-\epsilon)MIC(D)\}.</code>
</p>

<p>More details are provided in the supplementary material (SOM) of the original paper.
</p>
<p>The MINE statistics can be computed for two numeric vectors <code>x</code> and <code>y</code>. 
Otherwise a matrix (or data frame) can be provided and two options are available 
according to the value of <code>master</code>. If <code>master</code> is a column identifier, 
then the MINE statistics are computed for the <em>master</em> variable versus the 
other matrix columns. If <code>master</code> is a set of column identifiers, then all 
mutual MINE statistics are computed among the column subset.
<code>master</code>, <code>alpha</code>, and <code>C</code> refers respectively to the <em>style</em>,
<em>exp</em>, and <em>c</em> parameters of the original <em>java</em> code. 
In the original article, the authors state that the default value <code class="reqn">\alpha=0.6</code> 
(which is the exponent of the search-grid size <code class="reqn">B(n)=n^{\alpha}</code>) has been 
empirically chosen. It is worthwhile noting that <code>alpha</code> and <code>C</code> are 
defined to obtain an heuristic approximation in a reasonable amount of time. In case
of small sample size (<em>n</em>) it is preferable to increase <code>alpha</code> to 1 to 
obtain a solution closer to the theoretical one.
</p>


<h3>Value</h3>

<p>The Maximal Information-Based Nonparametric Exploration (MINE) statistics 
provide quantitative evaluations of different aspects of the relationship 
between two variables. 
In particular <code>mine</code> returns a list of 5 statistics: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>MIC</code></td>
<td>
 <p><strong>Maximal Information Coefficient.</strong> <br> 
It is related to the relationship strenght and it can be interpreted as a 
correlation measure. It is symmetric and it ranges in [0,1], where it 
tends to 0 for statistically independent data and it approaches 1 in 
probability for noiseless functional relationships (more details can 
ben found in the original paper). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MAS</code></td>
<td>
 <p><strong>Maximum Asymmetry Score.</strong> <br> 
It captures the deviation from monotonicity. Note that 
<code class="reqn">\textrm{MAS} &lt; \textrm{MIC}</code>. <br><em>Note:</em> it can be useful for detecting periodic relationships 
(unknown frequencies). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MEV</code></td>
<td>
 <p><strong>Maximum Edge Value.</strong> <br> 
It measures the closeness to being a function. Note that 
<code class="reqn">\textrm{MEV} \leq \textrm{MIC}</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MCN</code></td>
<td>
 <p><strong>Minimum Cell Number.</strong> <br> 
It is a complexity measure. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MIC-R2</code></td>
<td>
<p>It is the difference between the MIC value and the Pearson
correlation coefficient. </p>
</td>
</tr>
</table>
<p><br></p>
<p>When computing <code>mine</code> between two numeric vectors <code>x</code> and <code>y</code>, 
the output is a list of 5 numeric values. When <code>master</code> is provided, 
<code>mine</code> returns a list of 5 matrices having <code>ncol</code> equal to 
<em>m</em>. In particular, if <code>master</code> is a single value, 
then <code>mine</code> returns a list of 5 matrices having 1 column, 
whose rows correspond to the MINE measures between the <em>master</em> 
column versus all. Instead if <code>master</code> is a vector of <em>m</em> indices,
then <code>mine</code> output is a list of 5 <em>m-by-m</em> matrices, whose element 
<em>i,j</em> corresponds to the MINE statistics computed between the <em>i</em> 
and <em>j</em> columns of <code>x</code>.
</p>


<h3>Author(s)</h3>

<p>Michele Filosi and Roberto Visintainer
</p>


<h3>References</h3>

<p>D. Reshef, Y. Reshef, H. Finucane, S. Grossman, G. McVean, P. Turnbaugh, 
E. Lander, M. Mitzenmacher, P. Sabeti. (2011)
<em>Detecting novel associations in large datasets</em>. 
Science 334, 6062<br><a href="http://www.exploredata.net">http://www.exploredata.net</a><br>
(SOM: Supplementary Online Material at
<a href="https://science.sciencemag.org/content/suppl/2011/12/14/334.6062.1518.DC1">https://science.sciencemag.org/content/suppl/2011/12/14/334.6062.1518.DC1</a>)
</p>
<p>D. Albanese, M. Filosi, R. Visintainer, S. Riccadonna, G. Jurman,
C. Furlanello. 
<em>minerva and minepy: a C engine for the MINE suite and its R, Python and MATLAB wrappers</em>. 
Bioinformatics (2013) 29(3): 407-408, doi: <a href="https://doi.org/10.1093/bioinformatics/bts707">10.1093/bioinformatics/bts707</a>.<br></p>
<p><em>minepy. Maximal Information-based Nonparametric Exploration in C and Python.</em><br><a href="http://minepy.sourceforge.net">http://minepy.sourceforge.net</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">A &lt;- matrix(runif(50),nrow=5)
mine(x=A, master=1)
mine(x=A, master=c(1,3,5,7,8:10))

x &lt;- runif(10); y &lt;- 3*x+2; plot(x,y,type="l")
mine(x,y)
# MIC = 1 
# MAS = 0
# MEV = 1
# MCN = 2
# MIC-R2 = 0

set.seed(100); x &lt;- runif(10); y &lt;- 3*x+2+rnorm(10,mean=2,sd=5); plot(x,y)
mine(x,y)
# rounded values of MINE statistics
# MIC = 0.61
# MAS = 0
# MEV = 0.61
# MCN = 2
# MIC-R2 = 0.13

t &lt;-seq(-2*pi,2*pi,0.2); y1 &lt;- sin(2*t); plot(t,y1,type="l")
mine(t,y1)
# rounded values of MINE statistics
# MIC = 0.66 
# MAS = 0.37
# MEV = 0.66
# MCN = 3.58
# MIC-R2 = 0.62

y2 &lt;- sin(4*t); plot(t,y2,type="l")
mine(t,y2)
# rounded values of MINE statistics
# MIC = 0.32 
# MAS = 0.18
# MEV = 0.32
# MCN = 3.58
# MIC-R2 = 0.31

# Note that for small n it is better to increase alpha
mine(t,y1,alpha=1)
# rounded values of MINE statistics
# MIC = 1 
# MAS = 0.59
# MEV = 1
# MCN = 5.67
# MIC-R2 = 0.96

mine(t,y2,alpha=1)
# rounded values of MINE statistics
# MIC = 1 
# MAS = 0.59
# MEV = 1
# MCN = 5
# MIC-R2 = 0.99

# Some examples from SOM
x &lt;- runif(n=1000, min=0, max=1)

# Linear relationship
y1 &lt;- x; plot(x,y1,type="l"); mine(x,y1)
# MIC = 1 
# MAS = 0
# MEV = 1
# MCN = 4
# MIC-R2 = 0

# Parabolic relationship
y2 &lt;- 4*(x-0.5)^2; plot(sort(x),y2[order(x)],type="l"); mine(x,y2)
# rounded values of MINE statistics
# MIC = 1 
# MAS = 0.68
# MEV = 1
# MCN = 5.5
# MIC-R2 = 1

# Sinusoidal relationship (varying frequency)
y3 &lt;- sin(6*pi*x*(1+x)); plot(sort(x),y3[order(x)],type="l"); mine(x,y3)
# rounded values of MINE statistics
# MIC = 1 
# MAS = 0.85
# MEV = 1
# MCN = 4.6
# MIC-R2 = 0.96

# Circle relationship
t &lt;- seq(from=0,to=2*pi,length.out=1000)
x4 &lt;- cos(t); y4 &lt;- sin(t); plot(x4, y4, type="l",asp=1)
mine(x4,y4)
# rounded values of MINE statistics
# MIC = 0.68 
# MAS = 0.01
# MEV = 0.32
# MCN = 5.98
# MIC-R2 = 0.68

data(Spellman)
res &lt;- mine(Spellman,master=1,n.cores=1)

## Not run: ## example of multicore computation
res &lt;- mine(Spellman,master=1,n.cores=parallel::detectCores()-1)
## End(Not run)
</code></pre>


</div>