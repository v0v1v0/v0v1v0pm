<div class="container">

<table style="width: 100%;"><tr>
<td>dmstate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Survival Distributions with piece-wise constant hazards and multiple states</h2>

<h3>Description</h3>

<p>Densitiy, distribution function, hazard function, cumulative hazard function
and survival function of multi-state survival functions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dmstate(x, t, Q, pi, abs)

pmstate(q, t, Q, pi, abs)

hmstate(x, t, Q, pi, abs)

chmstate(x, t, Q, pi, abs)

smstate(q, t, Q, pi, abs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector of quantiles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>vector of left interval borders</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q</code></td>
<td>
<p>Q-matrices of the process, see details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi</code></td>
<td>
<p>initial distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abs</code></td>
<td>
<p>indicator vector of absorbing states, see details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>vector of quantiles</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>Q</code> is an array of dimensions N x N x M where M is the number of time intervals
and N is the number of states. Every slice of Q along the third dimension is
an N x N Q-matrix. Each row of the Q-matrix contains the hazard-rates for
transitioning from the respective state to each other state in the
off-diagonal elements. The diagonal element is minus the sum of the other
elements (such that the row sums are 0 for each row). (See Norris (1997) Part
2, Continuous-time Markov chains I, for the definition of Q-matrices and the
theory of continuous time markov chains.)
</p>
<p><code>abs</code> is a vector that is one for each absorbing state that corresponds to an
event of interest and zero everywhere else. With this different events of
interest can be encoded for the same model. For example overall survival and
progression free survival can be encoded by setting <code>abs</code> to one in the
"death" state or the "death" and the "progressed disease" state and leaving
<code>Q</code> and <code>pi</code> the same.
</p>
<p>The initial distribution <code>pi</code> can be used to set the probabilities of
starting in different stages. The starting distribution in combination with
<code>Q</code> can be used to model sub-populations. The corresponding values of <code>pi</code>
are then the prevalence of the sub-populations in the initial state.
</p>
<p>The densities, distribution functions, ... now correspond to the event of
entering one of the absorbing states when the initial distribution in the
states is <code>pi</code>.
</p>


<h3>Value</h3>

<p><code>dmstate</code> gives the density evaluated at <code>x</code>.
</p>
<p><code>pmstate</code> gives the distribution function evaluated at <code>q</code>.
</p>
<p><code>hmstate</code> gives the hazard function evaluated at <code>x</code>.
</p>
<p><code>chmstate</code> gives the cumulative hazard function evaluated at <code>x</code>.
</p>
<p><code>smstate</code> gives the survival function evaluated at <code>q</code>.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>dmstate()</code>: density of survival distributions for a piece-wise exponential multi-state model
</p>
</li>
<li> <p><code>pmstate()</code>: distribution function of survival distributions for a piece-wise exponential multi-state model
</p>
</li>
<li> <p><code>hmstate()</code>: hazard of survival distributions for a piece-wise exponential multi-state model
</p>
</li>
<li> <p><code>chmstate()</code>: cumulative hazard of survival distributions for a piece-wise exponential multi-state model
</p>
</li>
<li> <p><code>smstate()</code>: survival function of survival distributions for a piece-wise exponential multi-state model
</p>
</li>
</ul>
<h3>References</h3>

<p>Norris, J. R. (1997)
<em>Markov Chains</em>
Cambridge University Press
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Example 1: Proportional Hazards
Tint &lt;- 0
Q &lt;- matrix(
  c(
    -0.1, 0.1,
    0  , 0
  ), 2, 2, byrow = TRUE
)
dim(Q) &lt;- c(2,2,1)
pi &lt;- c(1,0)
abs &lt;- c(0,1)

t &lt;- 0:100

par(mfrow=c(3,2))
plot.new()
text(0.5,0.5,"example 1 proportional hazards")
plot(t, pmstate(t, Tint, Q, pi, abs), type="l")
plot(t, smstate(t, Tint, Q, pi, abs), type="l")
plot(t, dmstate(t, Tint, Q, pi, abs), type="l")
plot(t, hmstate(t, Tint, Q, pi, abs), type="l", ylim=c(0,1))
plot(t, chmstate(t, Tint, Q, pi, abs), type="l")

# Example 2: Disease Progression
Tint &lt;- 0
Q &lt;- matrix(
  c(
    -0.3, 0.2, 0.1,
    0  ,-0.4, 0.4,
    0  ,   0,   0
  ), 3, 3, byrow = TRUE
)
dim(Q) &lt;- c(3,3,1)
pi &lt;- c(1,0,0)
abs_os  &lt;- c(0,0,1)
abs_pfs &lt;- c(0,1,1)

t &lt;- seq(0,20, by=0.1)

par(mfrow=c(3,2))
plot.new()
text(0.5,0.5,"example 2a disease progression\noverall survival")
plot(t, pmstate(t, Tint, Q, pi, abs_os), type="l")
plot(t, smstate(t, Tint, Q, pi, abs_os), type="l")
plot(t, dmstate(t, Tint, Q, pi, abs_os), type="l")
plot(t, hmstate(t, Tint, Q, pi, abs_os), type="l", ylim=c(0,1))
plot(t, chmstate(t, Tint, Q, pi, abs_os), type="l")

par(mfrow=c(3,2))
plot.new()
text(0.5,0.5,"example 2b disease progression\nprogression-free survival")
plot(t, pmstate(t, Tint, Q, pi, abs_pfs), type="l")
plot(t, smstate(t, Tint, Q, pi, abs_pfs), type="l")
plot(t, dmstate(t, Tint, Q, pi, abs_pfs), type="l")
plot(t, hmstate(t, Tint, Q, pi, abs_pfs), type="l", ylim=c(0,1))
plot(t, chmstate(t, Tint, Q, pi, abs_pfs), type="l")

# Example 3: Sub-Populations
Tint &lt;- 0
Q &lt;- matrix(
  c(
    -0.4, 0  , 0.4,
    0  ,-0.1, 0.1,
    0  ,   0,   0
  ), 3, 3, byrow = TRUE
)
dim(Q) &lt;- c(3,3,1)
pi &lt;- c(0.5,0.5,0)
abs &lt;- c(0,0,1)

t &lt;- seq(0, 40, by=0.1)

par(mfrow=c(3,2))
plot.new()
text(0.5,0.5,"example 3 sub-populations")
plot(t, pmstate(t, Tint, Q, pi, abs), type="l")
plot(t, smstate(t, Tint, Q, pi, abs), type="l")
plot(t, dmstate(t, Tint, Q, pi, abs), type="l")
plot(t, hmstate(t, Tint, Q, pi, abs), type="l", ylim=c(0,1))
plot(t, chmstate(t, Tint, Q, pi, abs), type="l")


# Example 4: Delayed Effect in one group and immediate effect in the other group
Tint &lt;- c(0,20)
Q &lt;- array(NA_real_, dim=c(3,3,2))
Q[,,1] &lt;- matrix(
  c(
    -0.2, 0   , 0.2 ,
    0  ,-0.05, 0.05,
    0  ,    0, 0
  ), 3, 3, byrow = TRUE
)
Q[,,2] &lt;- matrix(
  c(
    -0.05, 0   , 0.05 ,
    0  ,-0.05, 0.05,
    0  ,    0, 0
  ), 3, 3, byrow = TRUE
)

pi &lt;- c(0.75,0.25,0)
abs &lt;- c(0,0,1)

t &lt;- seq(0, 100, by=0.1)

par(mfrow=c(3,2))
plot.new()
text(0.5,0.5,"example 4\ndelayed effect in one group\nimmediate effect in the other")
plot(t, pmstate(t, Tint, Q, pi, abs), type="l")
plot(t, smstate(t, Tint, Q, pi, abs), type="l")
plot(t, dmstate(t, Tint, Q, pi, abs), type="l")
plot(t, hmstate(t, Tint, Q, pi, abs), type="l", ylim=c(0,0.2))
plot(t, chmstate(t, Tint, Q, pi, abs), type="l")
</code></pre>


</div>