<div class="container">

<table style="width: 100%;"><tr>
<td>wfct</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Weighting function that can be supplied to the <code>weights</code> argument
of <code>nlsLM</code> or <code>nls</code>
</h2>

<h3>Description</h3>

<p><code>wfct</code> can be supplied to the <code>weights</code> argument of
<code>nlsLM</code> or <code>nls</code>, and facilitates specification of
weighting schemes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">wfct(expr)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>expr</code></td>
<td>
<p>An expression specifying the weighting scheme
as described in the Details section below.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>The weighting function can take 5 different variable definitions and
combinations thereof:
</p>

<ul>
<li>
<p>  the name of the predictor (independent) variable
</p>
</li>
<li>
<p> the name of the response (dependent) variable
</p>
</li>
<li>
<p> error: if replicates <code class="reqn">y_{ij}</code>
exist, the error <code class="reqn">\sigma(y_{ij})</code>
</p>
</li>
<li>
<p> fitted: the fitted values <code class="reqn">\hat{y}_i</code> of the model
</p>
</li>
<li>
<p> resid: the residuals <code class="reqn">y_i - \hat{y}_i</code> of the model
</p>
</li>
</ul>
<p>For the last two, the model is fit unweighted, fitted values and
residuals are extracted and the model is refit by the defined weights.
</p>


<h3>Value</h3>

<p>The results of evaluation of <code>expr</code> in a new
environment, yielding the vector of weights to be applied.  
</p>


<h3>Author(s)</h3>

<p>Andrej-Nikolai Spiess</p>


<h3>See Also</h3>

<p><code>nlsLM</code>, <code>nls</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
### Examples from 'nls' doc ###
## note that 'nlsLM' below may be replaced with calls to 'nls'
Treated &lt;- Puromycin[Puromycin$state == "treated", ]

## Weighting by inverse of response 1/y_i:
nlsLM(rate ~ Vm * conc/(K + conc), data = Treated,
start = c(Vm = 200, K = 0.05), weights = wfct(1/rate))

## Weighting by square root of predictor \sqrt{x_i}:
nlsLM(rate ~ Vm * conc/(K + conc), data = Treated,
start = c(Vm = 200, K = 0.05), weights = wfct(sqrt(conc)))

## Weighting by inverse square of fitted values 1/\hat{y_i}^2:
nlsLM(rate ~ Vm * conc/(K + conc), data = Treated,
start = c(Vm = 200, K = 0.05), weights = wfct(1/fitted^2))

## Weighting by inverse variance 1/\sigma{y_i}^2:
nlsLM(rate ~ Vm * conc/(K + conc), data = Treated,
start = c(Vm = 200, K = 0.05), weights = wfct(1/error^2))

</code></pre>


</div>