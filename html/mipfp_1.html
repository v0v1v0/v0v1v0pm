<div class="container">

<table style="width: 100%;"><tr>
<td>mipfp-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Multidimensional Iterative Proportional Fitting and Alternative Models
</h2>

<h3>Description</h3>

<p>An implementation of several methods for updating an initial <code class="reqn">N</code>-dimensional
array (called a seed) with respect to given target marginal distributions. 
Those targets can also be multi-dimensional. The procedures are also able to 
estimate a (multi-dimensional) contingency table (encoded as an array) 
matching a given set of (multi-dimensional) margins. In that case, each cell 
of the seed must simply be set to 1.
</p>
<p>The package provides the iterative proportional fitting procedure (IPFP), also 
known as the RAS algorithm in economics and matrix raking or matrix scaling in 
computer science. Additionnaly several alternative estimating methods to 
the IPFP are also included, namely the maximum likelihood (ML), minimum 
chi-squared (CHI2) and weighted least squares (WLSQ) model-based approaches.
</p>
<p>The package also includes an application of the IPFP to simulate and estimate 
the parameters of multivariate Bernoulli distributions.
</p>
<p>Finally a function extracting the linearly independant columns from a matrix,
hence returning a matrix of full rank is provided.
</p>


<h3>Details</h3>


<table>
<tr>
<td style="text-align: left;">
Package: </td>
<td style="text-align: left;"> mipfp</td>
</tr>
<tr>
<td style="text-align: left;">
Type: </td>
<td style="text-align: left;"> Package</td>
</tr>
<tr>
<td style="text-align: left;">
Version: </td>
<td style="text-align: left;"> 3.2.1</td>
</tr>
<tr>
<td style="text-align: left;">
Date: </td>
<td style="text-align: left;"> 2018-08-29</td>
</tr>
<tr>
<td style="text-align: left;">
Depends: </td>
<td style="text-align: left;"> cmm, numDeriv, Rsolnp, R(&gt;= 2.10.0)</td>
</tr>
<tr>
<td style="text-align: left;">
License: </td>
<td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>This package provides an implementation of several fitting procedures for 
updating a <code class="reqn">N</code>-dimensional array with respect to given target marginal 
distributions. Those targets can also multi-dimensional. The available methods
are listed herehunder.
</p>

<ul>
<li>
<p> The function <code>Ipfp</code> provides the iterative 
proportionnal fitting Procedure.
</p>
</li>
<li>
<p> Maximum likelihood, minimum Chi-square and weighted least squares
approaches are availables in the function
ObtainModelEstimates.
</p>
</li>
</ul>
<p>The function <code>Estimate</code> provides an interface to
these two methods. Each of them returns an object of class <code>mipfp</code>, but
<code>Estimate</code> should be the preferred constructor.
</p>
<p>The package provides several methods and functions to extract various 
information from the resulting object such as as the variance-covariance matrix 
of the estimated cell probabilities or counts using either the Lang's (2004) or 
the Delta method (Little and Wu, 1991) (<code>vcov</code>),
the confidence interval of the estimates 
(<code>confint</code>), the comparison of the deviations
(<code>CompareMaxDev</code>), etc. Note that the functions 
starting with a lower case are S3 methods for objects of class <code>mipfp</code> 
while the one starting with an upper case are general functions.
</p>
<p>The package also includes an application of the IPFP to simulate and estimate 
the parameters of multivariate Bernoulli distributions, respectively in the
functions <code>RMultBinary</code> and 
<code>ObtainMultBinaryDist</code>. In addition, the functions 
<code>Corr2Odds</code>, <code>Odds2Corr</code>, 
<code>Corr2PairProbs</code>, <code>Odds2PairProbs</code> are in 
turn responsible for converting correlation to odds ratio, odds ratio to 
correlation, correlation to pairwise probability and odds ratio to pairwise 
probability.
</p>
<p>Finally, auxillary functions are also provided. <code>expand</code> 
expands a multi-dimensional contingency table (stored in <code>table</code>) into a
data frame of individual recors. <code>Array2Vector</code> and 
<code>Vector2Array</code> transforms an array to a vector and 
vice-versa. <code>flat</code> flattens multi-dimensional objects 
for pretty printing. The function <code>GetLinInd</code> extracting the 
linearly independant columns from a matrix (using QR decomposition) and 
returning a matrix of full rank is also provided. 
</p>


<h3>Author(s)</h3>

<p>Johan Barthelemy and Thomas Suesse.
</p>
<p>Maintainer: Johan Barthelemy <a href="mailto:johan@uow.edu.au">johan@uow.edu.au</a>.
</p>


<h3>References</h3>

<p>Bacharach, M. (1965).
Estimating Nonnegative Matrices from Marginal Data.
<em>International Economic Review</em> (Blackwell Publishing) 6 (3): 294-310.
</p>
<p>Barthelemy, J., Suesse, T. (2018).
mipfp: An R Package for Multidimensional Array Fitting and Simulating Multivariate Bernoulli Distributions.
<em>Journal of Statistical Software, Code Snippets</em> 86 (2): 1-20, doi: 10.18637/jss.v086.c02.
</p>
<p>Bishop, Y. M. M., Fienberg, S. E., Holland, P. W. (1975).
<em>Discrete Multivariate Analysis: Theory and Practice.</em>
MIT Press. ISBN 978-0-262-02113-5.
</p>
<p>Deming, W. E., Stephan, F. F. (1940).
On a Least Squares Adjustment of a Sampled Frequency Table When the Expected
Marginal Totals are Known.
<em>Annals of Mathematical Statistics</em> 11 (4): 427-444.
</p>
<p>Fienberg, S. E. (1970).
An Iterative Procedure for Estimation in Contingency Tables.
<em>Annals of Mathematical Statistics</em> 41 (3): 907-917.
</p>
<p>Golub, G. H., Van Loan C. F. (2012)
<em>Matrix Computations. Third Edition.</em>
Johns Hopkins University Press.
</p>
<p>Lang, J.B. (2004) 
Multinomial-Poisson homogeneous models for contingency tables. 
<em>Annals of Statistics</em> 32(1): 340-383.
</p>
<p>Lee, A.J. (1993).
Generating Random Binary Deviates Having Fixed Marginal Distributions and 
Specified Degrees of Association
<em>The American Statistician</em>  47 (3): 209-215.
</p>
<p>Little, R. J., Wu, M. M. (1991)
Models for contingency tables with known margins when target and sampled 
populations differ.
<em>Journal of the American Statistical Association</em> 86 (413): 87-95.
</p>
<p>Qaqish, B. F., Zink, R. C., and Preisser, J. S. (2012). 
Orthogonalized residuals for estimation of marginally specified association
parameters in multivariate binary data.
<em>Scandinavian Journal of Statistics</em> 39, 515-527.
</p>
<p>Stephan, F. F. (1942).
Iterative method of adjusting frequency tables when expected margins are known.
<em>Annals of Mathematical Statistics</em> 13 (2): 166-178.
</p>


<h3>See Also</h3>

<p><code>ipfp</code> for a package implementing the ipfp to solve problems of the form
<code class="reqn">Ax = b</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># generation of an intial 2-ways table to be updated
seed &lt;- array(1, dim=c(2, 2))
# desired targets (margins)
target.row &lt;- c(87, 13)
target.col &lt;- c(52, 48)
# storing the margins in a list
target.data &lt;- list(target.col, target.row)
# list of dimensions of each marginal constrain
target.list &lt;- list(1, 2)
# calling the fitting methods
r.ipfp &lt;- Ipfp(seed, target.list, target.data)
r.ml &lt;- ObtainModelEstimates(seed, target.list, target.data, method = "ml")
r.chi2 &lt;- ObtainModelEstimates(seed, target.list, target.data, method = "chi2")
r.lsq &lt;- ObtainModelEstimates(seed, target.list, target.data, method = "lsq")
</code></pre>


</div>