<div class="container">

<table style="width: 100%;"><tr>
<td>gof.estimates</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Wald, Log-likelihood ratio and Person Chi-square statistics for mipfp object
</h2>

<h3>Description</h3>

<p>This method computes three statistics to perform a test wheter the seed
agrees with the target data. The statistics are the Wilk's log-likelihood ratio
statistic, the Wald statistic and the Person Chi-square statistic.
</p>
<p>The method also returns the associated degrees of freedom.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'mipfp'
gof.estimates(object, seed = NULL, target.data = NULL, 
              target.list = NULL, replace.zeros = 1e-10, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>The object of class <code>mipfp</code> containing.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>

<p>The seed used to compute the estimates (optional). If not provided, the
method tries to determine the <code>seed</code> automatically.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target.data</code></td>
<td>

<p>A list containing the data of the target margins. Each component of the 
list is an array storing a margin. The list order must follow the one 
defined in <code>target.list</code>. Note that the cells of the arrays must be 
non-negative (and can even be NA if <code>method = ipfp</code>) (optional). 
If not provided, the method tries to dermine <code>target.data</code>
automatically.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target.list</code></td>
<td>

<p>A list of the target margins provided in <code>target.data</code>. Each
component of the list is an array whose cells indicates which dimension the 
corresponding margin relates to (optional). If not provided, the method
tries to determine <code>target.list</code> automatically.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replace.zeros</code></td>
<td>

<p>If 0-cells are to be found, then they are replaced with this value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Not used.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The test is formally expressed as:
</p>
<p style="text-align: center;"><code class="reqn">H_0 ~ : ~ h(\pi) = 0 \quad vs \quad H_1~:~h(\pi) \neq 0</code>
</p>

<p>where <code class="reqn">\pi</code> is the vector of the seed probabilities and 
<code class="reqn">h(x) = A^T x - m</code> with <code class="reqn">A</code> and <code class="reqn">m</code> being
respectively the marginal matrix and the margins vector of the estimation
problem.
</p>
<p>The three statistics are then defined as:
</p>

<ul>
<li>
<p>Wilk's log-likelihoold ratio
</p>
<p style="text-align: center;"><code class="reqn">G^2 = 2 \sum x_i \ln \frac{\pi_i}{\hat{\pi}_i}</code>
</p>


</li>
<li>
<p>Wald's statistic
</p>
<p style="text-align: center;"><code class="reqn">W^2 = h(x)^T ( H^T_x D_x H_x)^{-1} h(x)</code>
</p>


</li>
<li>
<p>Pearson Chi-square
</p>
<p style="text-align: center;"><code class="reqn">\chi^2 = (x - n \hat{\pi})^T D^{-1}_{n\hat{\pi}} (x - n \hat{\pi})</code>
</p>


</li>
</ul>
<p>where <code class="reqn">x</code> is the vectorization of the <code>seed</code>, 
<code class="reqn">n = \sum x_i</code>, <code class="reqn">D_v</code> is a diagonal matrix 
derived from the vector <code class="reqn">v</code> and <code class="reqn">H</code> denotes the Jacobian evaluated 
in <code class="reqn">\hat{\pi}</code> (the vector of the estimated probabilities) of the 
function <code class="reqn">h(x)</code>.
</p>
<p>The degrees of freedom for these statistics corresponds to the number of
components in <code class="reqn">m</code>.
</p>


<h3>Value</h3>

<p>A list whose elements are detailed below.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>G2</code></td>
<td>

<p>The Log-likelihood statistic.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W2</code></td>
<td>

<p>The Wald statistic.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X2</code></td>
<td>

<p>The Pearson chi-squared statistic.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stats.df</code></td>
<td>

<p>The degrees of freedom for the <code>G2</code>, <code>W2</code> and 
<code>X2</code> statistics.
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Johan Barthelemy
</p>
<p>Maintainer: Johan Barthelemy <a href="mailto:johan@uow.edu.au">johan@uow.edu.au</a>.
</p>


<h3>References</h3>

<p>Lang, J.B. (2004) 
Multinomial-Poisson homogeneous models for contingency tables. 
<em>Annals of Statistics</em> 32(1): 340-383.
</p>


<h3>See Also</h3>

<p><code>Estimate</code> function to create an object of class
<code>mipfp</code> and to update an initial multidimensional array with respect to 
given constraints.
<code>summary.mipfp</code> can also retrieve the
statistics and their associated p-values.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># loading the data
data(spnamur, package = "mipfp")
# subsetting the data frame, keeping only the first 3 variables
spnamur.sub &lt;- subset(spnamur, select = Household.type:Prof.status)
# true table
true.table &lt;- table(spnamur.sub)
# extracting the margins
tgt.v1        &lt;- apply(true.table, 1, sum)
tgt.v1.v2     &lt;- apply(true.table, c(1,2), sum)
tgt.v2.v3     &lt;- apply(true.table, c(2,3), sum)
tgt.list.dims &lt;- list(1, c(1,2), c(2,3))
tgt.data      &lt;- list(tgt.v1, tgt.v1.v2, tgt.v2.v3)
# creating the seed, a 10 pct sample of spnamur
seed.df &lt;- spnamur.sub[sample(nrow(spnamur), round(0.10*nrow(spnamur))), ]
seed.table &lt;- table(seed.df)
# applying one fitting method (ipfp)
r.ipfp &lt;- Estimate(seed=seed.table, target.list=tgt.list.dims, 
                   target.data = tgt.data)
# printing the G2, X2 and W2 statistics
print(gof.estimates(r.ipfp))
# alternative way (pretty printing, with p-values)
print(summary(r.ipfp)$stats.gof)
</code></pre>


</div>