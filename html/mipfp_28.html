<div class="container">

<table style="width: 100%;"><tr>
<td>IpfpCov</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Covariance matrix of the estimators produced by Ipfp (deprecated)
</h2>

<h3>Description</h3>

<p>This function determines the (asymptotic) covariance matrix of the estimates 
produced by the iterative proportional fitting procedure using the formula 
designed by Little and Wu (1991).
</p>


<h3>Usage</h3>

<pre><code class="language-R">IpfpCov(estimate, seed, target.list, replace.zeros = 1e-10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>

<p>The array of estimates produced by the <code>Ipfp</code>
function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>

<p>The intial array (seed) that was updated by the 
<code>Ipfp</code> function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target.list</code></td>
<td>

<p>A list of dimensions of the marginal target constrains. Each component of 
the list is an array whose cells indicate which dimension the corresponding 
margin relates to.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replace.zeros</code></td>
<td>

<p>If a cell of the <code>estimate</code> or the <code>seed</code> has a value equals to 
0, then it is replaced with this value. Default is 1e-10.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The asymptotic covariance matrix of the estimates produced by the iterative
proportional fitting procedure has the form (Little and Wu, 1991)
</p>
<p style="text-align: center;"><code class="reqn">K(K^T D1^{-1} K)^{-1} K^T D2^{-1} K (K^T D1^{-1} K)^{-1} K^T</code>
</p>

<p>where
</p>

<ul>
<li>
<p><code>K</code> is the orthogonal complement of the marginal matrix, i.e. the 
matrix required to obtain the marginal frequencies;
</p>
</li>
<li>
<p><code>D1</code> is a diagonal matrix of the estimates probabilities;
</p>
</li>
<li>
<p><code>D2</code> is a diagonal matrix of the seed probabilities.
</p>
</li>
</ul>
<h3>Value</h3>

<p>A matrix of dimension <code>length(estimate) x length(estimate)</code> of the
asymptotic variance of the proportion estimates produced by <code>Ipfp</code>.  
</p>


<h3>Warning</h3>

<p>Note: this function is deprecated, instead use
<code>vcov.mipfp</code>.
</p>


<h3>Author(s)</h3>

<p>Johan Barthelemy.
</p>
<p>Maintainer: Johan Barthelemy <a href="mailto:johan@uow.edu.au">johan@uow.edu.au</a>.
</p>


<h3>References</h3>

<p>Little, R. J., Wu, M. M. (1991)
Models for contingency tables with known margins when target and seed 
populations differ.
<em>Journal of the American Statistical Association</em> 86 (413): 87-95.
</p>


<h3>See Also</h3>

<p><code>Ipfp</code> function to update an initial multidimensional
array with respect to given constraints.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># true contingency (2-way) table
true.table &lt;- array(c(43, 44, 9, 4), dim = c(2, 2))
# generation of sample, i.e. the seed to be updated
seed &lt;- ceiling(true.table / 10)
# desired targets (margins)
target.row &lt;- apply(true.table, 2, sum)
target.col &lt;- apply(true.table, 1, sum)
# storing the margins in a list
target.data &lt;- list(target.col, target.row)
# list of dimensions of each marginal constrain
target.list &lt;- list(1, 2)
# calling the Ipfp function
res &lt;- Ipfp(seed, target.list, target.data)
# computation of the covariance matrix of the produced estimated probabilities
res.cov &lt;- IpfpCov(res$x.hat, seed, target.list)
# 0.95 level confidence interval of the estimates
n &lt;- sum(res$x.hat)
# ... lower bound
ci.lb &lt;- Array2Vector(res$x.hat) - 1.96 * sqrt(n * diag(res.cov))
# ... upperbound
ci.ub &lt;- Array2Vector(res$x.hat) + 1.96 * sqrt(n * diag(res.cov))
</code></pre>


</div>