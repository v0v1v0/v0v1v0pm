<div class="container">

<table style="width: 100%;"><tr>
<td>vcov.mipfp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Calculate variance-covariance matrix for mipfp objects
</h2>

<h3>Description</h3>

<p>This function determines the (asymptotic) covariance matrix of the estimates 
in an <code>mipfp</code> object using either the Delta formula designed by Little 
and Wu (1991) or Lang's formula (2004).
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'mipfp'
vcov(object, method.cov = "delta", seed = NULL, 
     target.data = NULL, target.list = NULL, replace.zeros = 1e-10, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>An object of class mipfp.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method.cov</code></td>
<td>

<p>Select the method to use for the computation of the covariance.
The available methods are <code>delta</code> and <code>lang</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>

<p>The initial multi-dimensional array used to create <code>object</code>
(optional). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target.data</code></td>
<td>

<p>A list containing the data of the target margins used to create 
<code>object</code>. Each component of the list is an array storing a margin. 
The list order must follow the one defined in <code>target.list</code>
(optional).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target.list</code></td>
<td>

<p>A list of the target margins used to create <code>object</code> function. Each
component of the list is an array whose cells indicates which dimension the
corresponding margin relates to (optional).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replace.zeros</code></td>
<td>

<p>If 0-cells are to be found, then their values are replaced with this
value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Not used.  
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The asymptotic covariance matrix of the estimates probabilities using Delta's 
formula has the form (Little and Wu, 1991)
</p>
<p style="text-align: center;"><code class="reqn">K(K^T D1^{-1} K)^{-1} K^T D2^{-1} K (K^T D1^{-1} K)^{-1} K^T</code>
</p>

<p>where
</p>

<ul>
<li>
<p><code>K</code> is the orthogonal complement of the marginal matrix, i.e. the 
matrix <code class="reqn">A</code> required to obtain the marginal frequencies <code class="reqn">m</code>;

</p>
</li>
<li>
<p><code>D1</code> and <code>D2</code> are two diagonal matrices whose components
depends on the estimation process used to generate <code>object</code>.

</p>
</li>
</ul>
<p>If the estimation process has been done using
</p>

<ul>
<li>
<p><code>ipfp</code>
then <code class="reqn">diag(D1) = \hat{p}</code> and 
<code class="reqn">diag(D2) = p_*</code>;

</p>
</li>
<li>
<p><code>ml</code>
then <code class="reqn">diag(D1) = \frac{\hat{p}^2}{p_*}</code> and 
<code class="reqn">diag(D2) = diag(D1)</code>;

</p>
</li>
<li>
<p><code>chi2</code>
then <code class="reqn">diag(D1) = \frac{\hat{p}^4}{p_*^3}</code>
and <code class="reqn">diag(D2) = diag(D1)</code>;

</p>
</li>
<li>
<p><code>lsq</code>
then <code class="reqn">diag(D1) = p_*</code> and 
<code class="reqn">diag(D2) = \frac{p_*3}{\hat{p}^2}</code>;

</p>
</li>
</ul>
<p>where <code class="reqn">\hat{p}</code> is the vector of estimated probabilities and
<code class="reqn">p_*</code> is the vector of the seed probabilities.
</p>
<p>Using Lang's formula (2004), the covariance matrix becomes
</p>
<p style="text-align: center;"><code class="reqn">\frac{1}{N} 
      \left( D - \hat{p}\hat{p}^T - D H(H^T D H)^{-1} H^T D \right)</code>
</p>

<p>where
</p>

<ul>
<li>
<p><code>D</code>
is a diagonal matrix of the estimated probabilities <code class="reqn">\hat{p}</code>;

</p>
</li>
<li>
<p><code>H</code>
denotes the Jacobian evaluated in <code class="reqn">\hat{p}</code> of the function
<code class="reqn">h(p) = A^T p - m</code>.

</p>
</li>
</ul>
<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x.hat.cov</code></td>
<td>

<p>A covariance matrix of the estimated counts (last index move fastest)
computed using the method specified in <code>cov.method</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.hat.cov</code></td>
<td>

<p>A covariance matrix of the estimated probabilities (last index 
move fastest) computed using the method specified in <code>cov.method</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.hat.se</code></td>
<td>

<p>The standard deviation of the estimated counts (last index move fastest)
computed using the method specified in <code>cov.method</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.hat.se</code></td>
<td>

<p>The standard deviation of the estimated probabilities (last index move 
fastest) computed using the method specified in <code>cov.method</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>

<p>Degrees of freedom of the estimates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method.cov</code></td>
<td>

<p>The method used to compute the covariance matrix.
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Johan Barthelemy.
</p>
<p>Maintainer: Johan Barthelemy <a href="mailto:johan@uow.edu.au">johan@uow.edu.au</a>.
</p>


<h3>References</h3>

<p>Lang, J.B. (2004) 
Multinomial-Poisson homogeneous models for contingency tables. 
<em>Annals of Statistics</em> 32(1): 340-383.
</p>
<p>Little, R. J., Wu, M. M. (1991)
Models for contingency tables with known margins when target and seed 
populations differ.
<em>Journal of the American Statistical Association</em> 86 (413): 87-95.
</p>


<h3>See Also</h3>

<p><code>Estimate</code> function to create an object of class
<code>mipfp</code> and to update an initial multidimensional array with respect to 
given constraints.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># true contingency (2-way) table
true.table &lt;- array(c(43, 44, 9, 4), dim = c(2, 2))
# generation of sample, i.e. the seed to be updated
seed &lt;- ceiling(true.table / 10)
# desired targets (margins)
target.row &lt;- apply(true.table, 2, sum)
target.col &lt;- apply(true.table, 1, sum)
# storing the margins in a list
target.data &lt;- list(target.col, target.row)
# list of dimensions of each marginal constrain
target.list &lt;- list(1, 2)
# calling the Estimate function
res &lt;- Estimate(seed, target.list, target.data)
# printing the variance-covariance matrix
print(vcov(res))
</code></pre>


</div>