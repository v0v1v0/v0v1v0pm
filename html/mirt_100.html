<div class="container">

<table style="width: 100%;"><tr>
<td>residuals-method</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute model residuals</h2>

<h3>Description</h3>

<p>Return model implied residuals for linear dependencies between items or at the person level.
If the latent trait density was approximated (e.g., Davidian curves, Empirical histograms, etc)
then passing <code>use_dentype_estimate = TRUE</code> will use the internally saved quadrature and
density components (where applicable).
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'SingleGroupClass'
residuals(
  object,
  type = "LD",
  p.adjust = "none",
  df.p = FALSE,
  approx.z = FALSE,
  full.scores = FALSE,
  QMC = FALSE,
  printvalue = NULL,
  tables = FALSE,
  verbose = TRUE,
  Theta = NULL,
  suppress = NA,
  theta_lim = c(-6, 6),
  quadpts = NULL,
  fold = TRUE,
  upper = TRUE,
  technical = list(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of class <code>SingleGroupClass</code> or
<code>MultipleGroupClass</code>. Bifactor models are automatically detected and utilized for
better accuracy</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of residuals to be displayed.
Can be either <code>'LD'</code> or <code>'LDG2'</code> for a local dependence matrix based on the
X2 or G2 statistics (Chen &amp; Thissen, 1997), <code>'Q3'</code> for the statistic proposed by
Yen (1984), <code>'JSI'</code> for the jack-knife statistic proposed Edwards et al. (2018),
<code>'exp'</code> for the expected values for the frequencies of every response pattern,
and <code>'expfull'</code> for the expected values for every theoretically observable response pattern.
For the 'LD' and 'LDG2' types, the upper diagonal elements represent the standardized
residuals in the form of signed Cramers V coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.adjust</code></td>
<td>
<p>method to use for adjusting all p-values (see <code>p.adjust</code>
for available options). Default is <code>'none'</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df.p</code></td>
<td>
<p>logical; print the degrees of freedom and p-values?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>approx.z</code></td>
<td>
<p>logical; transform <code class="reqn">\chi^2(df)</code> information from LD tests into approximate
z-ratios instead using the transformation <code class="reqn">z=\sqrt{2 * \chi^2} - \sqrt{2 * df - 1}</code>?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>full.scores</code></td>
<td>
<p>logical; compute relevant statistics
for each subject in the original data?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>QMC</code></td>
<td>
<p>logical; use quasi-Monte Carlo integration? If <code>quadpts</code> is omitted the
default number of nodes is 5000</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>printvalue</code></td>
<td>
<p>a numeric value to be specified when using the <code>res='exp'</code>
option. Only prints patterns that have standardized residuals greater than
<code>abs(printvalue)</code>. The default (NULL) prints all response patterns</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tables</code></td>
<td>
<p>logical; for LD type, return the observed, expected, and standardized residual
tables for each item combination?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical; allow information to be printed to the console?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Theta</code></td>
<td>
<p>a matrix of factor scores used for statistics that require empirical estimates (i.e., Q3).
If supplied, arguments typically passed to <code>fscores()</code> will be ignored and these values will
be used instead</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>suppress</code></td>
<td>
<p>a numeric value indicating which parameter local dependency combinations
to flag as being too high. Absolute values for the standardized estimates greater than
this value will be returned, while all values less than this value will be set to NA</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta_lim</code></td>
<td>
<p>range for the integration grid</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quadpts</code></td>
<td>
<p>number of quadrature nodes to use. The default is extracted from model (if available)
or generated automatically if not available</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fold</code></td>
<td>
<p>logical; apply the sum 'folding' described by Edwards et al. (2018) for the JSI statistic?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>logical; which portion of the matrix (upper versus lower triangle)
should the <code>suppress</code> argument be applied to?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>technical</code></td>
<td>
<p>list of technical arguments when models are re-estimated (see <code>mirt</code>
for details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to be passed to <code>fscores()</code></p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Chalmers, R., P. (2012). mirt: A Multidimensional Item Response Theory
Package for the R Environment. <em>Journal of Statistical Software, 48</em>(6), 1-29.
<a href="https://doi.org/10.18637/jss.v048.i06">doi:10.18637/jss.v048.i06</a>
</p>
<p>Chen, W. H. &amp; Thissen, D. (1997). Local dependence indices for item pairs using item
response theory. <em>Journal of Educational and Behavioral Statistics, 22</em>, 265-289.
</p>
<p>Edwards, M. C., Houts, C. R. &amp; Cai, L. (2018). A Diagnostic Procedure to Detect Departures
From Local Independence in Item Response Theory Models.
<em>Psychological Methods, 23</em>, 138-149.
</p>
<p>Yen, W. (1984). Effects of local item dependence on the fit and equating performance of the three
parameter logistic model. <em>Applied Psychological Measurement, 8</em>, 125-145.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 

x &lt;- mirt(Science, 1)
residuals(x)
residuals(x, tables = TRUE)
residuals(x, type = 'exp')
residuals(x, suppress = .15)
residuals(x, df.p = TRUE)
residuals(x, df.p = TRUE, p.adjust = 'fdr') # apply FWE control

# Pearson's X2 estimate for goodness-of-fit
full_table &lt;- residuals(x, type = 'expfull')
head(full_table)
X2 &lt;- with(full_table, sum((freq - exp)^2 / exp))
df &lt;- nrow(full_table) - extract.mirt(x, 'nest') - 1
p &lt;- pchisq(X2, df = df, lower.tail=FALSE)
data.frame(X2, df, p, row.names='Pearson-X2')

# above FOG test as a function
PearsonX2 &lt;- function(x){
   full_table &lt;- residuals(x, type = 'expfull')
   X2 &lt;- with(full_table, sum((freq - exp)^2 / exp))
   df &lt;- nrow(full_table) - extract.mirt(x, 'nest') - 1
   p &lt;- pchisq(X2, df = df, lower.tail=FALSE)
   data.frame(X2, df, p, row.names='Pearson-X2')
}
PearsonX2(x)


# extract results manually
out &lt;- residuals(x, df.p = TRUE, verbose=FALSE)
str(out)
out$df.p[1,2]

# with and without supplied factor scores
Theta &lt;- fscores(x)
residuals(x, type = 'Q3', Theta=Theta)
residuals(x, type = 'Q3', method = 'ML')

# Edwards et al. (2018) JSI statistic
N &lt;- 250
a &lt;- rnorm(10, 1.7, 0.3)
d &lt;- rnorm(10)
dat &lt;- simdata(a, d, N=250, itemtype = '2PL')

mod &lt;- mirt(dat, 1)
residuals(mod, type = 'JSI')
residuals(mod, type = 'JSI', fold=FALSE) # unfolded

# LD between items 1-2
aLD &lt;- numeric(10)
aLD[1:2] &lt;- rnorm(2, 2.55, 0.15)
a2 &lt;- cbind(a, aLD)
dat &lt;- simdata(a2, d, N=250, itemtype = '2PL')

mod &lt;- mirt(dat, 1)

# JSI executed in parallel over multiple cores
if(interactive()) mirtCluster()
residuals(mod, type = 'JSI')


## End(Not run)
</code></pre>


</div>