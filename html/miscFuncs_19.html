<div class="container">

<table style="width: 100%;"><tr>
<td>KFadvanceAR2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>KFadvanceAR2 function</h2>

<h3>Description</h3>

<p>A function to compute one step of the Kalman filter with second order AR state evolution. 
Embed in a loop to run the filter on a set of data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">KFadvanceAR2(
  obs,
  oldmean,
  oldermean,
  oldvar,
  oldervar,
  A,
  A1,
  B,
  C,
  D,
  E,
  F,
  W,
  V,
  marglik = FALSE,
  log = TRUE,
  na.rm = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>
<p>Y(t)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>oldmean</code></td>
<td>
<p>mu(t-1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>oldermean</code></td>
<td>
<p>mu(t-2)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>oldvar</code></td>
<td>
<p>Sigma(t-1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>oldervar</code></td>
<td>
<p>Sigma(t-2)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>A matrix A</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A1</code></td>
<td>
<p>A matrix A1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>column vector B</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>matrix C</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>matrix D</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E</code></td>
<td>
<p>column vector E</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>F</code></td>
<td>
<p>matrix F</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>state noise covariance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>observation noise covariance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marglik</code></td>
<td>
<p>logical, whether to return the marginal likelihood contribution from this observation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>whether or not to return the log of the likelihood contribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>na.rm logical, whether or not to handle NAs. Defult is FALSE. Set to TRUE if there are any missing values in the observed data.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The model is: (note that Y and theta are COLUMN VECTORS)
</p>
<p>theta(t) = A*theta(t-1) + A1*theta(t-2) + B + C*W (state equation)
</p>
<p>Y(t) = D*theta(t) + E + F*V         (observation equation)
</p>
<p>W and V are the covariance matrices of the state and observation noise. Priors are normal, 
</p>
<p>N(mu(t-1),Sigma(t-1)) and N(mu(t-2),Sigma(t-2))
</p>
<p>Result is the posterior, N(mu(t),Sigma(t)), together with the likelihood contribution Prob(Y(t)|Y(t-1))
</p>


<h3>Value</h3>

<p>list containing the new mean and variance, and if specified, the likelihood
</p>


</div>