<div class="container">

<table style="width: 100%;"><tr>
<td>misclassMlogit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mlogit estimation under misclassified covariate</h2>

<h3>Description</h3>

<p><code>misclassMLogit</code> computes estimator for a GLM with a misclassified covariate
using additional side information on the misclassification process
</p>


<h3>Usage</h3>

<pre><code class="language-R">misclassMlogit(
  Y,
  X,
  setM,
  P,
  na.action = na.omit,
  control = list(),
  par = NULL,
  baseoutcome = NULL,
  x = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>a matrix of 0s and 1s, indicating the target class. This is the dependent variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a matrix containing the independent variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>setM</code></td>
<td>
<p>matrix, rows containing potential patterns for a misclassed (latent) covariate M in
any coding for a categorical independent variable, e.g. dummy coding.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>probabilities corresponding to each of the potential pattern conditional on the other
covariates denoted in x.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>how to treat NAs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>options for the optimization procedure (see <code>optim</code>,
<code>ucminf</code> for options and details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>(optional) starting parameter vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>baseoutcome</code></td>
<td>
<p>reference outcome class</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>logical, add covariates matrix to result?</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">## simulate data

data &lt;- simulate_mlogit_dataset()


## estimate model without misclassification error

library(mlogit)
data2 &lt;- mlogit.data(data, varying = NULL, choice = "Y", shape = "wide")
summary(mlogit(Y ~ 1 | X + M2, data2, reflevel = "3"))


## estimate model with misclassification error

summary(mlogit(Y ~ 1 | X + M, data2, reflevel = "3"))


## estimate misclassification probabilities

Pmodel &lt;- glm(M2 ~ M + X, data = data, family = binomial("logit"))
summary(Pmodel)


## construct a-posteriori probabilities from Pmodel

P &lt;- predict(Pmodel, newdata = data, type = "response")
P &lt;- cbind(1 - P, P)
dimnames(P)[[2]] &lt;- c("M0", "M1") ## speaking names


## estimate misclassGLM

Yneu &lt;- matrix(rep.int(0, nrow(data) * 3), ncol = 3)
for (i in 1:nrow(data)) Yneu[i, data$Y[i]] &lt;- 1
est &lt;- misclassMlogit(Y = Yneu,
                      X = as.matrix(data[, 2, drop = FALSE]),
                      setM = matrix(c(0, 1), nrow = 2),
                      P = P)
summary(est)


## and bootstrapping the results from dataset
## Not run: 
summary(boot.misclassMlogit(est,
                         Y = Yneu,
                         X = data.matrix(data[, 2, drop = FALSE]),
                         Pmodel = Pmodel,
                         PX = data,
                         repetitions = 100))

## End(Not run)

</code></pre>


</div>