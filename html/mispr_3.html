<div class="container">

<table style="width: 100%;"><tr>
<td>mispr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multiple Imputation with Sequential Penalized Regression</h2>

<h3>Description</h3>

<p>Generates Multivariate Imputations using sequential regression with L2 penalization.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mispr(x, x.select = FALSE, pen = FALSE, maxit = 5, m = 5,
  track = FALSE, init.method = "random", L2.fix = NULL, cv = TRUE,
  maxL2 = 2^10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A data frame or a matrix containing the incomplete data.  Missing
values are coded as <code>NA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.select</code></td>
<td>
<p>A Boolean flag. If <code>TRUE</code>, linearly dependent columns 
will be removed before fitting of each imputation model. If <code>FALSE</code>, 
the linearly dependent columns will be removed only when number of predictors
is greater than the sample size for fitting an imputation model. The default 
is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pen</code></td>
<td>
<p>A Boolean flag. If <code>TRUE</code>, each imputation model will be
fitted with L2 penalty. If <code>FALSE</code>, maximum likelihood estimation
(MLE) will be used. However, if MLE fails, L2 penalty is used for
fitting the imputation model. The default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>A scalar giving the number of iterations. The default is 5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>Number of multiple imputations. The default is <code>m=5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>track</code></td>
<td>
<p>A Boolean flag. If <code>TRUE</code>, <code>mispr</code> will print
additional information about iterations on console. The default is 
<code>FALSE</code> for silent computation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init.method</code></td>
<td>
<p>Method for initialization of missing values. 
<code>random</code> for filling <code>NA</code> in each column with a random sample from 
the observed values of that column. <code>median</code> for mean imputation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L2.fix</code></td>
<td>
<p>Fixed value of ridge penalty (optional) to use for each 
imputation model. For default i.e., <code>NULL</code>, L2 penalty will be decided
with k-fold cross-validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv</code></td>
<td>
<p>A Boolean flag. If <code>TRUE</code> that is default, optimal value of L2
penalty will be decided indepndently for each imputation model using 5-fold
cross-validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxL2</code></td>
<td>
<p>The maximum value of the tuning parameter for L2 penalization
to be used for optimizing the cross-validated likelihood. Default value is
$2^10$.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Generates multiple imputations for incomplete multivariate data by fitting a 
sequence of regression models using L2 penalty iteratively. Missing data
can occur in one or more variables of the data. In each step of the iteration,
ridge regression is fitted according to the distributional form of the missing
variable taken as a response. All other variables are taken as predictors. 
If some predictors are incomplete, the most #'recently generated imputations 
are used to complete the predictors before using them as a predictor.
</p>


<h3>Value</h3>

<p>a list containing the number of imputed datasets, number of iterations used to obtain imputed data, list of multiply imputed datasets, and summary of missing values.
</p>


<h3>Author(s)</h3>

<p>Faisal Maqbool Zahid 
<a href="mailto:faisalmz99@yahoo.com">faisalmz99@yahoo.com</a>.
</p>


<h3>References</h3>

<p>Zahid, F. M., and Heumann, C. (2018). Multiple imputation with 
sequential penalized regression. 
<em>Statistical Methods in Medical Research</em>, 0962280218755574.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(data1)
# Select a subset of data1 
x=data1[ , 1:10]
res1 = mispr(x)
# to get 3 multiply imputed datasets
res2 = mispr(x, m=3)

</code></pre>


</div>