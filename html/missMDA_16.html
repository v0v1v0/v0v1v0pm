<div class="container">

<table style="width: 100%;"><tr>
<td>MIPCA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multiple Imputation with PCA</h2>

<h3>Description</h3>

<p>MIPCA performs Multiple Imputation with a PCA model. Can be used as a preliminary step to perform Multiple Imputation in PCA.</p>


<h3>Usage</h3>

<pre><code class="language-R">MIPCA(X, ncp = 2, scale = TRUE, method=c("Regularized","EM"), threshold = 1e-04, 
    nboot = 100,  method.mi="Boot", Lstart=1000, L=100, verbose=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a data.frame with continuous variables containing missing values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncp</code></td>
<td>
<p>integer corresponding to the number of components used to reconstruct data with the PCA reconstruction formulae</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>boolean. By default TRUE leading to a same weight for each variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>"Regularized" by default or "EM"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>the threshold for the criterion convergence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot</code></td>
<td>
<p>the number of imputed datasets</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method.mi</code></td>
<td>
<p>a string. If "Bayes", the uncertainty on the parameters of the imputation model is taken into account using a Bayesian treatment of PCA. By default "Boot" leading to a MI which reflect uncertainty a bootstrap procedure. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lstart</code></td>
<td>
<p>number of iterations for the burn-in period (only used if method.mi="Bayes")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>number of skipped iterations to keep one imputed data set after the burn-in period (only used if method.mi="Bayes")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>use verbose=TRUE for screen printing of iteration numbers</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>MIPCA generates nboot imputed datasets from a PCA model. The observed values are the same from one dataset to the others whereas the imputed values change. The variation among the imputed values reflects the variability with which missing values can be predicted.
The multiple imputation is proper in the sense of Little and Rubin (2002) since it takes into account the variability of the parameters. Two versions are available: multiple imputation using a parametric bootstrap (Josse, J., Husson, F. (2010)) and multiple imputation using a Bayesian treatment of the PCA model (Audigier et al 2015). The methods differ by the way in which the variability due to missing values is reflected. The method used is controlled by the <code>method.mi</code> argument. By default, MIPCA uses the parametric bootstrap <code>method.mi="Boot"</code>. This bootstrap method is more recommended to evaluate uncertainty in PCA (through confidence ellipses). Otherwise, the Bayesian method can be used by specifying the argument <code>method.mi="Bayes"</code>. It is based on an iterative algorithm which alternates imputation of the data set and draw of the PCA parameters in a posterior distribution. These steps are repeated <code>Lstart</code> times to reach a convergence. Then, one imputed data set is kept each <code>L</code> iterations to ensure independence between imputed values from a data set to another. The Bayesian method is more recommanded to apply a statistical method on an incomplete data set.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>res.imputePCA</code></td>
<td>
<p>A matrix corresponding to the imputed dataset obtained with the function imputePCA (the completed dataset)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res.MI</code></td>
<td>
<p>A list of data frames corresponding to the nboot imputed data sets</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Francois Husson  <a href="mailto:francois.husson@institut-agro.fr">francois.husson@institut-agro.fr</a>, Julie Josse  <a href="mailto:julie.josse@polytechnique.edu">julie.josse@polytechnique.edu</a> and Vincent Audigier</p>


<h3>References</h3>

<p>Josse, J., Husson, F. (2011). Multiple Imputation in PCA. Advances in Data Analysis and Classification.
</p>
<p>Audigier, V. Josse, J., Husson, F. (2015). Multiple imputation for continuous variables using a Bayesian principal component analysis. Journal of Statistical Computation and Simulation.
</p>
<p>Little R.J.A., Rubin D.B. (2002) Statistical Analysis with Missing Data. Wiley series in probability and statistics, New-York.
</p>


<h3>See Also</h3>

<p><code>imputePCA</code>,<code>plot.MIPCA</code>,<code>Overimpute</code>,<code>MIMCA</code>,<code>with.mids</code>,<code>pool</code>,<code>summary.mira</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
#########################################################
## Multiple Imputation for visualization on the PCA map
#########################################################

data(orange)
## First the number of components has to be chosen 
##   (for the reconstruction step)
nb &lt;- estim_ncpPCA(orange,ncp.max=4)

## Multiple Imputation
resMI &lt;- MIPCA(orange,ncp=2)

## Visualization on the PCA map
plot(resMI)

#########################################################
## Multiple Imputation for applying statistical methods
(Bayesian method)
#########################################################
data(ozone)

## First the number of components has to be chosen 
nb &lt;- estim_ncpPCA(ozone[,1:11])

## Multiple Imputation with Bayesian method
res.BayesMIPCA&lt;-MIPCA(ozone[,1:11],ncp=2,method.mi="Bayes",verbose=TRUE)

## Regression on the multiply imputed data set and pooling with mice
require(mice)
imp&lt;-prelim(res.mi=res.BayesMIPCA,X=ozone[,1:11])#creating a mids object
fit &lt;- with(data=imp,exp=lm(maxO3~T9+T12+T15+Ne9+Ne12+Ne15+Vx9+Vx12+Vx15+maxO3v))#analysis
res.pool&lt;-pool(fit);summary(res.pool)#pooling

## Diagnostics
res.over&lt;-Overimpute(res.BayesMIPCA)

## End(Not run)
</code></pre>


</div>