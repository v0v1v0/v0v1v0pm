<div class="container">

<table style="width: 100%;"><tr>
<td>estim_ncpPCA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate the number of dimensions for the Principal Component Analysis by cross-validation</h2>

<h3>Description</h3>

<p>Estimate the number of dimensions for the Principal Component Analysis by cross-validation</p>


<h3>Usage</h3>

<pre><code class="language-R">estim_ncpPCA(X, ncp.min = 0, ncp.max = 5, method = c("Regularized","EM"), 
       scale = TRUE, method.cv = c("gcv","loo","Kfold"), nbsim = 100, 
	   pNA = 0.05, ind.sup=NULL, quanti.sup=NULL, quali.sup=NULL,
	   threshold=1e-4, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a data.frame with continuous variables; with missing entries or not</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncp.min</code></td>
<td>
<p>integer corresponding to the minimum number of components to test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncp.max</code></td>
<td>
<p>integer corresponding to the maximum number of components to test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>"Regularized" by default or "EM"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>boolean. TRUE implies a same weight for each variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method.cv</code></td>
<td>
<p>string with the values "gcv" for generalised cross-validation, "loo" for leave-one-out or "Kfold" cross-validation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbsim</code></td>
<td>
<p>number of simulations, useful only if method.cv="Kfold"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pNA</code></td>
<td>
<p>percentage of missing values added in the data set, useful only if method.cv="Kfold"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ind.sup</code></td>
<td>
<p>a vector indicating the indexes of the supplementary individuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quanti.sup</code></td>
<td>
<p>a vector indicating the indexes of the quantitative supplementary variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quali.sup</code></td>
<td>
<p>a vector indicating the indexes of the categorical supplementary variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>the threshold for assessing convergence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>boolean. TRUE means that a progressbar is writtent</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For leave-one-out (loo) cross-validation, each cell of the data matrix is alternatively removed and predicted with a PCA model using ncp.min to ncp.max dimensions. The number of components which leads to the smallest mean square error of prediction (MSEP) is retained.
For the Kfold cross-validation, pNA percentage of missing values is inserted and predicted with a PCA model using ncp.min to ncp.max dimensions. This process is repeated nbsim times. The number of components which leads to the smallest MSEP is retained. <br>
For both cross-validation methods, missing entries are predicted using the imputePCA function, it means using the regularized iterative PCA algorithm (method="Regularized") or the iterative PCA algorithm (method="EM"). The regularized version is more appropriate when there are already many missing values in the dataset to avoid overfitting issues.
<br>
Cross-validation (especially method.cv="loo") is time-consuming. The generalised cross-validation criterion (method.cv="gcv") can be seen as an approximation of the loo cross-validation criterion which provides a straightforward way to estimate the number of dimensions without resorting to a computationally intensive method. <br></p>
<p>This argument scale has to be chosen in agreement with the PCA that will be performed. If one wants to perform a normed PCA (where the variables are centered and scaled, i.e. divided by their standard deviation), then the argument scale has to be set to the value TRUE.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ncp</code></td>
<td>
<p>the number of components retained for the PCA</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>the criterion (the MSEP) calculated for each number of components</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Francois Husson  <a href="mailto:francois.husson@institut-agro.fr">francois.husson@institut-agro.fr</a> and Julie Josse  <a href="mailto:julie.josse@polytechnique.edu">julie.josse@polytechnique.edu</a>
</p>


<h3>References</h3>

<p>Bro, R., Kjeldahl, K. Smilde, A. K. and Kiers, H. A. L. (2008) Cross-validation of component models: A critical look at current methods. Analytical and Bioanalytical Chemistry, 5, 1241-1251.<br></p>
<p>Josse, J. and Husson, F. (2011). Selecting the number of components in PCA using cross-validation approximations. Computational Statistics and Data Analysis. 56 (6), pp. 1869-1879.</p>


<h3>See Also</h3>

<p><code>imputePCA</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(orange)
nb &lt;- estim_ncpPCA(orange,ncp.min=0,ncp.max=4) 

## End(Not run)
</code></pre>


</div>