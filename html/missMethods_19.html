<div class="container">

<table style="width: 100%;"><tr>
<td>impute_LS_adaptive</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>LSimpute_adaptive</h2>

<h3>Description</h3>

<p>Perform LSimpute_adaptive as described by Bo et al. (2004)
</p>


<h3>Usage</h3>

<pre><code class="language-R">impute_LS_adaptive(
  ds,
  k = 10,
  eps = 1e-06,
  min_common_obs = 5,
  r_max_min = 100,
  p_mis_sim = 0.05,
  warn_r_max = FALSE,
  verbose_gene = FALSE,
  verbose_array = FALSE,
  verbose_gene_p = FALSE,
  verbose_array_p = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ds</code></td>
<td>
<p>A data frame or matrix with missing values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Directly passed to <code>impute_LS_gene()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>Directly passed to <code>impute_LS_gene()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_common_obs</code></td>
<td>
<p>Directly passed to <code>impute_LS_gene()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r_max_min</code></td>
<td>
<p>Minimum number of nearest genes used for imputation. The
default value (100) corresponds to the choice of Bo et al. (2004).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_mis_sim</code></td>
<td>
<p>Percentage of observed values that are set <code>NA</code> to estimate
the mixing coefficient <em>p</em>. The default value (0.05) corresponds to the
choice of Bo et al. (2004).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warn_r_max</code></td>
<td>
<p>Should a warning be given, if <code>r_max_min</code> is set too high?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose_gene</code></td>
<td>
<p>Should <code>impute_LS_gene()</code> be <code>verbose</code>?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose_array</code></td>
<td>
<p>Should <code>impute_LS_array()</code> be <code>verbose</code>?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose_gene_p</code></td>
<td>
<p>Should <code>impute_LS_gene()</code> be <code>verbose</code> while estimating
<em>p</em>?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose_array_p</code></td>
<td>
<p>Should <code>impute_LS_array()</code> be <code>verbose</code> while
estimating <em>p</em>?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function performs LSimpute_adaptive as described by Bo et al. (2004).The function assumes that the genes are the rows of <code>ds</code>.
</p>
<p>LSimpute_adaptive combines imputation values from <code>impute_LS_gene()</code> and
<code>impute_LS_array()</code> using a local (adaptive) approach for the mixing
coefficient <em>p</em>.
</p>
<p>If the dataset is too small or has too many missing values, there are some
fallback systems implemented. First, if <code>ncol(ds) &lt;= min_common_obs</code>
(normally, this should not the case!), values are imputed through
<code>impute_LS_array()</code>. Second, <code>r_max_min</code> is automatically adjusted, if it is
too high. In this case, a warning will be given, if <code>warn_r_max = TRUE</code>.
Third, if there are not enough observed values in a row (less than
<code>min_common_obs</code>), the calculation of the mixing coefficient is not possible
and missing values of these rows are imputed with the values from
<code>impute_LS_array()</code>.
</p>
<p>The amount of feedback given from <code>impute_LS_gene()</code> and <code>impute_LS_array()</code>
is controlled via <code>verbose_gene</code>, <code>verbose_array</code>, <code>verbose_gene_p</code> and
<code>verbose_array_p</code>. The last two control the amount of feedback while
estimating <em>p</em> and the first two the amount of feedback during the estimation
of the values that are mixed with <em>p</em>. Internally,  the imputed dataset from
<code>impute_LS_gene()</code> is passed on to <code>impute_LS_array()</code>. Therefore, all
messages from <code>impute_LS_gene()</code> are truly from <code>impute_LS_gene()</code> and not a
part of <code>impute_LS_array()</code>, which never calls <code>impute_LS_gene()</code> in this
case. Furthermore, all messages from <code>impute_expected_values()</code> belong to
<code>impute_LS_array()</code>.
</p>


<h3>Value</h3>

<p>An object of the same class as <code>ds</code> with imputed missing values.
</p>


<h3>References</h3>

<p>Bo, T. H., Dysvik, B., &amp; Jonassen, I. (2004). LSimpute: accurate estimation of missing values in microarray data with least squares methods. Nucleic acids research, 32(3), e34
</p>


<h3>See Also</h3>

<p>Other LSimpute functions: 
<code>impute_LS_array()</code>,
<code>impute_LS_combined()</code>,
<code>impute_LS_gene()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)
ds_mis &lt;- delete_MCAR(mvtnorm::rmvnorm(100, rep(0, 10)), 0.1)
ds_imp &lt;- impute_LS_adaptive(ds_mis)
</code></pre>


</div>