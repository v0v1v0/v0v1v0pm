<div class="container">

<table style="width: 100%;"><tr>
<td>delete_MAR_rank</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create MAR values using a ranking mechanism</h2>

<h3>Description</h3>

<p>Create missing at random (MAR) values using a ranking mechanism in a data
frame or a matrix
</p>


<h3>Usage</h3>

<pre><code class="language-R">delete_MAR_rank(
  ds,
  p,
  cols_mis,
  cols_ctrl,
  n_mis_stochastic = FALSE,
  ties.method = "average",
  miss_cols,
  ctrl_cols
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ds</code></td>
<td>
<p>A data frame or matrix in which missing values will be created.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>A numeric vector with length one or equal to length <code>cols_mis</code>;
the probability that a value is missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cols_mis</code></td>
<td>
<p>A vector of column names or indices of columns in which
missing values will be created.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cols_ctrl</code></td>
<td>
<p>A vector of column names or indices of columns, which
controls the creation of missing values in <code>cols_mis</code>. Must be of the
same length as <code>cols_mis</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_mis_stochastic</code></td>
<td>
<p>Logical, should the number of missing values be
stochastic? If <code>n_mis_stochastic = TRUE</code>, the number of missing values
for a column with missing values <code>cols_mis[i]</code> is a random variable
with expected value <code>nrow(ds) * p[i]</code>. If <code>n_mis_stochastic =
FALSE</code>, the number of missing values will be deterministic. Normally, the
number of missing values for a column with missing values
<code>cols_mis[i]</code> is <code>round(nrow(ds) * p[i])</code>. Possible deviations
from this value, if any exists, are documented in Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ties.method</code></td>
<td>
<p>How ties are handled. Passed to <code>rank</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>miss_cols</code></td>
<td>
<p>Deprecated, use <code>cols_mis</code> instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ctrl_cols</code></td>
<td>
<p>Deprecated, use <code>cols_ctrl</code> instead.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function creates missing at random (MAR) values in the columns
specified by the argument <code>cols_mis</code>.
The probability for missing values is controlled by <code>p</code>.
If <code>p</code> is a single number, then the overall probability for a value to
be missing will be <code>p</code> in all columns of <code>cols_mis</code>.
(Internally <code>p</code> will be replicated to a vector of the same length as
<code>cols_mis</code>.
So, all <code>p[i]</code> in the following sections will be equal to the given
single number <code>p</code>.)
Otherwise, <code>p</code> must be of the same length as <code>cols_mis</code>.
In this case, the overall probability for a value to be missing will be
<code>p[i]</code> in the column <code>cols_mis[i]</code>.
The position of the missing values in <code>cols_mis[i]</code> is controlled by
<code>cols_ctrl[i]</code>.
The following procedure is applied for each pair of <code>cols_ctrl[i]</code> and
<code>cols_mis[i]</code> to determine the positions of missing values:
</p>
<p>At first, the probability for a value to be missing is calculated. This
probability for a missing value in a row of <code>cols_mis[i]</code> is
proportional to the rank of the value in <code>cols_ctrl[i]</code> in the same row.
If <code>n_mis_stochastic = FALSE</code> these probabilities are given to the
<code>prob</code> argument of <code>sample</code>. If <code>n_mis_stochastic
= TRUE</code>, they are scaled to sum up to <code>nrow(ds) * p[i]</code>. Then for each
probability a uniformly distributed random number is generated. If this
random number is less than the probability, the value in <code>cols_mis[i]</code>
is set <code>NA</code>.
</p>
<p>The ranks are calculated via <code>rank</code>.
The argument <code>ties.method</code> is directly passed to this function.
Possible choices for <code>ties.method</code> are documented in
<code>rank</code>.
</p>
<p>For high values of <code>p</code> it is mathematically not possible to get
probabilities proportional to the ranks. In this case, a warning is given.
This warning can be silenced by setting the option
<code>missMethods.warn.too.high.p</code> to false.
</p>


<h3>Value</h3>

<p>An object of the same class as <code>ds</code> with missing values.
</p>


<h3>References</h3>

<p>Santos, M. S., Pereira, R. C., Costa, A. F., Soares, J. P.,
Santos, J., &amp; Abreu, P. H. (2019). Generating Synthetic Missing Data: A
Review by Missing Mechanism. <em>IEEE Access</em>, 7, 11651-11667
</p>


<h3>See Also</h3>

<p><code>rank</code>, <code>delete_MNAR_rank</code>
</p>
<p>Other functions to create MAR: 
<code>delete_MAR_1_to_x()</code>,
<code>delete_MAR_censoring()</code>,
<code>delete_MAR_one_group()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">ds &lt;- data.frame(X = 1:20, Y = 101:120)
delete_MAR_rank(ds, 0.2, "X", "Y")
</code></pre>


</div>