<div class="container">

<table style="width: 100%;"><tr>
<td>pic</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Predictive information criteria for Bayesian models fitted in <code>JAGS</code> using the funciton <code>selection</code>, <code>selection_long</code>, <code>pattern</code> or <code>hurdle</code>
</h2>

<h3>Description</h3>

<p>Efficient approximate leave-one-out cross validation (LOO), deviance information criterion (DIC) and widely applicable information criterion (WAIC) for Bayesian models, 
calculated on the observed data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pic(x, criterion = "dic", module = "total")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A <code>missingHE</code> object containing the results of a Bayesian model fitted in cost-effectiveness analysis using the function <code>selection</code>, <code>selection_long</code>, 
<code>pattern</code> or <code>hurdle</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>type of information criteria to be produced. Available choices are <code>'dic'</code> for the Deviance Information Criterion, 
<code>'waic'</code> for the Widely Applicable Information Criterion, and <code>'looic'</code> for the Leave-One-Out Information Criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>module</code></td>
<td>
<p>The modules with respect to which the information criteria should be computed. Available choices are <code>'total'</code> for the whole model, 
<code>'e'</code> for the effectiveness variables only (<code>'u'</code> for longitudinal models), <code>'c'</code> for the cost variables only, and <code>'both'</code> for both outcome variables.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Deviance Information Criterion (DIC), Leave-One-Out Information Criterion (LOOIC) and the Widely Applicable Information Criterion (WAIC) are methods for estimating 
out-of-sample predictive accuracy from a Bayesian model using the log-likelihood evaluated at the posterior simulations of the parameters. If <code>x</code> contains the results from 
a longitudinal model, all parameter names indexed by "e" should be instead indexed by "u". In addition, for longitudinal models information criteria results are displayed by time
and only a general approximation to the total value of the criteria and pD is given as the sum of the corresponding measures computed at each time point. 
DIC is computationally simple to calculate but it is known to have some problems, arising in part from it not being fully Bayesian in that it is based on a point estimate.
LOOIC can be computationally expensive but can be easily approximated using importance weights that are smoothed by fitting a generalised Pareto distribution to the upper tail 
of the distribution of the importance weights. For more details about the methods used to compute LOOIC see the PSIS-LOO section in <code>loo-package</code>.
WAIC is fully Bayesian and closely approximates Bayesian cross-validation. Unlike DIC, WAIC is invariant to parameterisation and also works for singular models. 
In finite cases, WAIC and LOO give similar estimates, but for influential observations WAIC underestimates the effect of leaving out one observation.
</p>


<h3>Value</h3>

<p>A named list containing different predictive information criteria results and quantities according to the value of <code>criterion</code>. In all cases, the measures are 
computed on the observed data for the specific modules of the model selected in <code>module</code>.
</p>

<dl>
<dt>d_bar</dt>
<dd>
<p>Posterior mean deviance (only if <code>criterion</code> is <code>'dic'</code>).</p>
</dd>
<dt>pD</dt>
<dd>
<p>Effective number of parameters calculated with the formula used by <code>JAGS</code> (only if <code>criterion</code> is <code>'dic'</code>)</p>
</dd>
</dl>
<p>.
</p>
<dl>
<dt>dic</dt>
<dd>
<p>Deviance Information Criterion calculated with the formula used by <code>JAGS</code> (only if <code>criterion</code> is <code>'dic'</code>)</p>
</dd>
</dl>
<p>. 
</p>
<dl>
<dt>d_hat</dt>
<dd>
<p>Deviance evaluated at the posterior mean of the parameters and calculated with the formula used by <code>JAGS</code> (only if <code>criterion</code> is <code>'dic'</code>)</p>
</dd>
<dt>elpd, elpd_se</dt>
<dd>
<p>Expected log pointwise predictive density and standard error calculated on the observed data for the model nodes indicated in <code>module</code>
(only if <code>criterion</code> is <code>'waic'</code> or <code>'loo'</code>).</p>
</dd>
<dt>p, p_se</dt>
<dd>
<p>Effective number of parameters and standard error calculated on the observed data for the model nodes indicated in <code>module</code>
(only if <code>criterion</code> is <code>'waic'</code> or <code>'loo'</code>).</p>
</dd>
<dt>looic, looic_se</dt>
<dd>
<p>The leave-one-out information criterion and standard error calculated on the observed data for the model nodes indicated in <code>module</code>
(only if <code>criterion</code> is <code>'loo'</code>).</p>
</dd>
<dt>waic, waic_se</dt>
<dd>
<p>The widely applicable information criterion and standard error calculated on the observed data for the model nodes indicated in <code>module</code>
(only if <code>criterion</code> is <code>'waic'</code>).</p>
</dd>
<dt>pointwise</dt>
<dd>
<p>A matrix containing the pointwise contributions of each of the above measures calculated on the observed data for the model nodes indicated in <code>module</code>
(only if <code>criterion</code> is <code>'waic'</code> or <code>'loo'</code>).</p>
</dd>
<dt>pareto_k</dt>
<dd>
<p>A vector containing the estimates of the shape parameter <code class="reqn">k</code> for the generalised Pareto fit to the importance ratios for each leave-one-out distribution 
calculated on the observed data for the model nodes indicated in <code>module</code> (only if <code>criterion</code> is <code>'loo'</code>). 
See <code>loo</code> for details about interpreting <code class="reqn">k</code>.</p>
</dd>
<dt>sum_dic</dt>
<dd>
<p>DIC value calculated by summing up all model dic evaluated at each time point (only for longitudinal models). Similar estimates can
are obtained also for the other criteria, either <code>sum_waic</code> or <code>sum_looic</code>.</p>
</dd>
<dt>sum_pdic</dt>
<dd>
<p>DIC value calculated by summing up all model effective number of parameter estimates based on dic evaluated at each time point (only for longitudinal models). Similar estimates can
are obtained also for the other criteria, either <code>sum_pwaic</code> or <code>sum_plooic</code>.</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Andrea Gabrio
</p>


<h3>References</h3>

<p>Plummer, M. <em>JAGS: A program for analysis of Bayesian graphical models using Gibbs sampling.</em> (2003).
</p>
<p>Vehtari, A. Gelman, A. Gabry, J. (2016a) Practical Bayesian model evaluation using leave-one-out cross-validation and WAIC. 
<em>Statistics and Computing</em>. Advance online publication.
</p>
<p>Vehtari, A. Gelman, A. Gabry, J. (2016b) Pareto smoothed importance sampling. <em>ArXiv</em> preprint.
</p>
<p>Gelman, A. Hwang, J. Vehtari, A. (2014) Understanding predictive information criteria for Bayesian models. 
<em>Statistics and Computing</em> 24, 997-1016. 
</p>
<p>Watanable, S. (2010). Asymptotic equivalence of Bayes cross validation and widely application information 
criterion in singular learning theory. <em>Journal of Machine Learning Research</em> 11, 3571-3594.
</p>


<h3>See Also</h3>

<p><code>jags</code>, <code>loo</code>, <code>waic</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> 
# For examples see the function \code{\link{selection}}, \code{\link{selection_long}},
# \code{\link{pattern}} or \code{\link{hurdle}}
# 
# 
</code></pre>


</div>