<div class="container">

<table style="width: 100%;"><tr>
<td>diagnostic</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Diagnostic checks for assessing MCMC convergence of Bayesian models fitted in <code>JAGS</code> using the function <code>selection</code>, <code>selection_long</code>, <code>pattern</code> or <code>hurdle</code>
</h2>

<h3>Description</h3>

<p>The focus is restricted to full Bayesian models in cost-effectiveness analyses based on the function <code>selection</code>, <code>selection_long</code>, <code>pattern</code> and <code>hurdle</code>, 
with convergence of the MCMC chains that is assessed through graphical checks of the posterior distribution of the parameters of interest,
Examples are density plots, trace plots, autocorrelation plots, etc. Other types of posterior checks are related to some summary MCMC statistics 
that are able to detect possible issues in the convergence of the algorithm, such as the potential scale reduction factor or the effective sample size.
Different types of diagnostic tools and statistics are used to assess model convergence using functions contained in the package <strong>ggmcmc</strong> and <strong>mcmcplots</strong>. 
Graphics and plots are managed using functions contained in the package <strong>ggplot2</strong> and <strong>ggthemes</strong>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">diagnostic(x, type = "denplot", param = "all", theme = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class "missingHE" containing the posterior results of a full Bayesian model implemented using the function <code>selection</code>, <code>selection_long</code>,
<code>pattern</code> or <code>hurdle</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type of diagnostic check to be plotted for the model parameter selected. Available choices include: 'histogram' for histogram plots,
'denplot' for density plots, 'traceplot' for trace plots, 'acf' for autocorrelation plots, 'running' for running mean plots,
'compare' for comparing the distribution of the whole chain with only its last part, 'cross' for crosscorrelation plots, 'Rhat' for the potential scale reduction factor, 'geweke' for the geweke diagnostic,
'pairs' for posterior correlation among the parameters,'caterpillar' for caterpillar plots. In addition the class 'summary' provides an overview of some of the most popular
diagnostic checks for each parameter selected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>Name of the family of parameters to process, as given by a regular expression. For example the mean parameters 
for the effect and cost variables can be specified using 'mu.e' ('mu.u' for longitudinal models) and 'mu.c', respectively. Different types of
models may have different parameters depending on the assumed distributions and missing data assumptions. 
To see a complete list of all possible parameters by types of models assumed see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theme</code></td>
<td>
<p>Type of ggplot theme among some pre-defined themes. For a full list of available themes see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters that can be provided to manage the graphical output of <code>diagnostic</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Depending on the types of plots specified in the argument <code>type</code>, the output of <code>diagnostic</code> can produce
different combinations of MCMC visual posterior checks for the family of parameters indicated in the argument <code>param</code>.
For a full list of the available plots see the description of the argument <code>type</code> or see the corresponding plots in the package <strong>ggmcmc</strong>.
</p>
<p>The parameters that can be assessed through <code>diagnostic</code> are only those included in the object <code>x</code> (see Arguments). Specific character names
must be specified in the argument <code>param</code> according to the specific model implemented. If <code>x</code> contains the results from a longitudinal model, 
all parameter names indexed by "e" should be instead indexed by "u". The available names and the parameters associated with them are:
</p>

<ul>
<li>
<p> "mu.e" the mean parameters of the effect variables in the two treatment arms.
</p>
</li>
<li>
<p> "mu.c" the mean parameters of the cost variables in the two treatment arms.
</p>
</li>
<li>
<p> "mu.e.p" the pattern-specific mean parameters of the effect variables in the two treatment arms (only with the function <code>pattern</code>).
</p>
</li>
<li>
<p> "mu.c.p" the pattern-specific mean parameters of the cost variables in the two treatment arms (only with the function <code>pattern</code>).
</p>
</li>
<li>
<p> "sd.e" the standard deviation parameters of the effect variables in the two treatment arms.
</p>
</li>
<li>
<p> "sd.c" the standard deviation parameters of the cost variables in the two treatment arms.
</p>
</li>
<li>
<p> "alpha" the regression intercept and covariate coefficient parameters for the effect variables in the two treatment arms.
</p>
</li>
<li>
<p> "beta" the regression intercept and covariate coefficient parameters for the cost variables in the two treatment arms.
</p>
</li>
<li>
<p> "random.alpha" the regression random effects intercept and covariate coefficient parameters for the effect variables in the two treatment arms.
</p>
</li>
<li>
<p> "random.beta" the regression random effects intercept and covariate coefficient parameters for the cost variables in the two treatment arms.
</p>
</li>
<li>
<p> "p.e" the probability parameters of the missingness or structural values mechanism for the effect variables in the two treatment arms 
(only with the function <code>selection</code>, <code>selection_long</code> or <code>hurdle</code>).
</p>
</li>
<li>
<p> "p.c" the probability parameters of the missingness or structural values mechanism for the cost variables in the two treatment arms 
(only with the function <code>selection</code>, <code>selection_long</code> or <code>hurdle</code>).
</p>
</li>
<li>
<p> "gamma.e" the regression intercept and covariate coefficient parameters of the missingness or structural values mechanism
for the effect variables in the two treatment arms (only with the function <code>selection</code>, <code>selection_long</code> or <code>hurdle</code>).
</p>
</li>
<li>
<p> "gamma.c" the regression intercept and covariate coefficient parameters of the missingness or structural values mechanism 
for the cost variables in the two treatment arms (only with the function <code>selection</code>, <code>selection_long</code> or <code>hurdle</code>).
</p>
</li>
<li>
<p> "random.gamma.e" the random effects regression intercept and covariate coefficient parameters of the missingness or structural values mechanism
for the effect variables in the two treatment arms (only with the function <code>selection</code>, <code>selection_long</code> or <code>hurdle</code>).
</p>
</li>
<li>
<p> "random.gamma.c" the random effects regression intercept and covariate coefficient parameters of the missingness or structural values mechanism 
for the cost variables in the two treatment arms (only with the function <code>selection</code>, <code>selection_long</code> or <code>hurdle</code>).
</p>
</li>
<li>
<p> "pattern" the probabilities associated with the missingness patterns in the data (only with the function <code>pattern</code>).
</p>
</li>
<li>
<p> "delta.e" the mnar parameters of the missingness mechanism for the effect variables in the two treatment arms 
(only with the function <code>selection</code>, <code>selection_long</code>, or <code>pattern</code>).
</p>
</li>
<li>
<p> "delta.c" the mnar parameters of the missingness mechanism for the cost variables in the two treatment arms 
(only with the function <code>selection</code>, <code>selection_long</code>, or <code>pattern</code>).
</p>
</li>
<li>
<p> "random.delta.e" the random effects mnar parameters of the missingness mechanism for the effect variables in the two treatment arms 
(only with the function <code>selection</code> or <code>selection_long</code>).
</p>
</li>
<li>
<p> "random.delta.c" the random effects mnar parameters of the missingness mechanism for the cost variables in the two treatment arms 
(only with the function <code>selection</code> or <code>selection_long</code>).
</p>
</li>
<li>
<p> "all" all available parameters stored in the object <code>x</code>.
</p>
</li>
</ul>
<p>When the object <code>x</code> is created using the function <code>pattern</code>, pattern-specific standard deviation ("sd.e", "sd.c") and regression coefficient 
parameters ("alpha", "beta") for both outcomes can be visualised. The parameters associated with a missingness mechanism can be accessed only when <code>x</code>
is created using the function <code>selection</code>, <code>selection_long</code>, or <code>pattern</code>, while the parameters associated with the model for the structural values mechanism
can be accessed only when <code>x</code> is created using the function <code>hurdle</code>.
</p>
<p>The argument <code>theme</code> allows to customise the graphical output of the plots generated by <code>diagnostic</code> and
allows to choose among a set of possible pre-defined themes taken form the package <strong>ggtheme</strong>. For a complete list of the available character names
for each theme, see <strong>ggthemes</strong>.
</p>


<h3>Value</h3>

<p>A <strong>ggplot</strong> object containing the plots specified in the argument <code>type</code>
</p>


<h3>Author(s)</h3>

<p>Andrea Gabrio
</p>


<h3>References</h3>

<p>Gelman, A. Carlin, JB., Stern, HS. Rubin, DB.(2003). <em>Bayesian Data Analysis, 2nd edition</em>, CRC Press.
</p>
<p>Brooks, S. Gelman, A. Jones, JL. Meng, XL. (2011). <em>Handbook of Markov Chain Monte Carlo</em>, CRC/Chapman and Hall.
</p>


<h3>See Also</h3>

<p><code>ggs</code> <code>selection</code>, <code>selection_long</code>, <code>pattern</code> <code>hurdle</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># For examples see the function \code{\link{selection}}, \code{\link{selection_long}},
# \code{\link{pattern}} or \code{\link{hurdle}}
#
#
</code></pre>


</div>