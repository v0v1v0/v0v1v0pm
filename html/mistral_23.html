<div class="container">

<table style="width: 100%;"><tr>
<td>ok</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Class of Ordinary Kriging</h2>

<h3>Description</h3>

<p>An implementation of Ordinary Kriging based upon a km-class object that should be
faster than usual predict method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ok(model, beta = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a kriging model object from <code>DiceKriging::km-class</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>the trend of the model</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Ordinary Kriging is a special case of kriging where the trend is supposed to be
and unknown constant. Consequently some linear algebra operations can be reduced by knowning
that the vector of parameter <code>beta</code> is indeed a real.
</p>
<p>The ok class defines three functions: <code>xi</code> the kriging predictor, <code>updateSd</code> and
<code>updateSdfast</code> two methods for updating the kriging variance when some poitns are
virtually added to the model. These two last functions differ in their implementation: the
first one allows for the user to specify which are the predicted points and which are the
added points. The second one outputs a matrix where the kriging variances of all the points
is updated when each one is iteratively added the the Design of Experiments.
</p>
<p>The faster between looping <code>updateSd</code> and using <code>updateSdfast</code> is indeed problem
dependent (depending on parallel computer, size of the data, etc.) and should be
benchmark by the user.
</p>


<h3>Value</h3>

<p>An object of S3 class 'ok' containing
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Kinv</code></td>
<td>
<p>the inverse of the covariance matrix of the data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>the estimated coefficient of the trend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_centred</code></td>
<td>
<p>the data centred according to the estimated trend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma_beta</code></td>
<td>
<p>the standard deviation of the estimation of beta</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xi</code></td>
<td>
<p>the kriging predictor</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>updateSd</code></td>
<td>
<p>a function to calculate the updated kriging variance when
<code>Xnew</code> points are added to the Design of Experiments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>updateSdfast</code></td>
<td>
<p>a function to calculate the update kriging variance
when the SUR criterion is minimised over a population which is also the one
used to estimate it.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Clement WALTER <a href="mailto:clementwalter@icloud.com">clementwalter@icloud.com</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate a dataset
X &lt;- data.frame(x1 = rnorm(10), x2 = rnorm(10))
y &lt;- cos(sqrt(rowSums(X^2)))

# Learn a model
krig &lt;- DiceKriging::km(design=X, response=y)

# Create Ordinary Kriging object
OK &lt;- ok(krig)

# Microbenchmark
# create a dataset
X = data.frame(x1 = rnorm(100), x2 = rnorm(100))
microbenchmark::microbenchmark(OK$xi(t(X)), predict(krig, X, type="UK"))

# Check identical results
X &lt;- rnorm(2)
OK$xi(X)[c('mean', 'sd')]
predict(krig, data.frame(x1=X[1], x2=X[2]), type="UK")[c('mean', 'sd')]

</code></pre>


</div>