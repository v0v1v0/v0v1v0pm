<div class="container">

<table style="width: 100%;"><tr>
<td>BMP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian Moving Particles</h2>

<h3>Description</h3>

<p>This function runs the Bayesian Moving Particles algorithm for estimating extreme probability
and quantile.
</p>


<h3>Usage</h3>

<pre><code class="language-R">BMP(
  dimension,
  lsf,
  q,
  N = 1000,
  N.final = N,
  N.iter = 30,
  adaptive = FALSE,
  N.DoE = 5 * dimension,
  firstDoE = "uniform",
  radius = qnorm(1e-10, lower.tail = FALSE),
  X,
  y,
  covariance = NULL,
  learn_each_train = Inf,
  km.param = list(nugget.estim = TRUE, multistart = 1, optim.method = "BFGS", coef.trend
    = q),
  burnin = 20,
  fast = TRUE,
  sur = list(integrated = TRUE, r = 1, approx.pnorm = FALSE),
  lower.tail = TRUE,
  save.dir,
  plot = FALSE,
  plot.lsf = TRUE,
  plot.lab = c("x_1", "x_2"),
  chi2 = FALSE,
  verbose = 1,
  breaks
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dimension</code></td>
<td>
<p>the dimension of the input space.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lsf</code></td>
<td>
<p>the function defining the RV of interest Y = lsf(X).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>a given quantile to estimate the corresponding probability.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>the total number of Poisson processes during the refinement step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N.final</code></td>
<td>
<p>the total number of Poisson processes for the final alpha estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N.iter</code></td>
<td>
<p>the total number of iteration of the algorithm, ie that total number of
calls to the <code>lsf</code> will be <code>N.DoE + N.iter*r</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adaptive</code></td>
<td>
<p>if the algorithm should stop automatically if the stopping criterion
is verified, precisely the mean probability of misclassification of the particles
being over a given threshold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N.DoE</code></td>
<td>
<p>the number of points for the initial Design of Experiment</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>firstDoE</code></td>
<td>
<p>default is "uniform" for a random
uniform sampling over a sphere of radius <code>radius</code>. Also available "maximim" for a maximim LHS.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>radius</code></td>
<td>
<p>the size of the radius of the sphere for uniform DoE or the semi length
of the interval on each dimension for maximin LHS</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>(optional) a first Design of Experiemnt to be used instead of building
a new DoE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the value of <code>lsf</code> on the <code>X</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariance</code></td>
<td>
<p>(optional) to give a covariance kernel for the <code>km</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>learn_each_train</code></td>
<td>
<p>a integer: after this limit the covariance parameters are not
learnt any more and model is just updated with the new datapoints.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>km.param</code></td>
<td>
<p>(optional) list of parameters to be passed to <code>DiceKriging::km</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>a burnin parameter for Markov Chain drawing of the metamodel based
Poisson process (this does not change the number of calls to <code>lsf</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fast</code></td>
<td>
<p>in current implementation it appears that the call to the metamodel is
faster when doing batch computation. This parameter lets do the Markov chain the other way
around: instead of first selecting a starting point and then applying <code>burnin</code> times the
transition kernel, it creates a working population by apply the kernel to all the
particles and then makes some moves with the generated discretised distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sur</code></td>
<td>
<p>a list containing any parameters to be passed to <code>estimateSUR</code>. Default is
<code>sur$integrated=TRUE</code> and <code>sur$r=1</code> for a one step ahead integrated SUR criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>as for pxxxx functions, TRUE for estimating P(lsf(X) &lt; q), FALSE
for P(lsf(X) &gt; q).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save.dir</code></td>
<td>
<p>(optional) a directory to save the <code>X</code> and <code>y</code> at each iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>to plot the DoE and the updated model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.lsf</code></td>
<td>
<p>to plot the contour of the true <code>lsf</code>. Note that this requires its
evaluation on a grid and should be used only on toy examples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.lab</code></td>
<td>
<p>the labels of the axis for the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chi2</code></td>
<td>
<p>for a chi2 test on the number of events.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>controls the level of outputs of the algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>
<p>optional, for the final histogram if <code>chi2 == TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Bayesian Moving Particles algorithm uses the point process framework for rare event to iteratively estimate
the conditional expectation of the (random) limit-state function, to quantify the quality of the learning
and to propose a new point to be added to the model with a SUR criterion.
</p>


<h3>Value</h3>

<p>An object of class <code>list</code> containing the outputs described below:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>the estimated conditional expectation of the probability.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha.seq</code></td>
<td>
<p>the sequence of estimated alpha during the refinement step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv2</code></td>
<td>
<p>an estimate of the squarred coefficient of variation of alpha.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.seq</code></td>
<td>
<p>the sequence of the estimated coefficients of variations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>the sequence of the estimated upper bound of the conditional variance
divided by estimated alpha.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>I</code></td>
<td>
<p>the sequence of the estimated integrated h.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sur_min</code></td>
<td>
<p>a list containing the the sequence of corresponding thresholds and
-log probability of the sample minimising the SUR criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sur_stat</code></td>
<td>
<p>a list containing at each iterations number of points tried for the SUR
criterion as well as the computational spent.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>the reference quantile for the probability estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ecdf</code></td>
<td>
<p>the empirical cdf, i.e. the estimation of the function q -&gt; E(alpha(q)).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L_max</code></td>
<td>
<p>the farthest state reached by the random process. Validity range
for the <code>ecdf</code> is then (-Inf, L_max] or [L_max, Inf).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PPP</code></td>
<td>
<p>the last Poisson process generated with <code>N.final</code> particles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meta_fun</code></td>
<td>
<p>the metamodel approximation of the <code>lsf</code>. A call output is a
list containing the value and the standard deviation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>the final metamodel. An S4 object from <span class="pkg">DiceKriging</span>. Note
that the algorithm enforces the problem to be the estimation of P[lsf(X)&gt;q]
and so using ‘predict’ with this object will return inverse values if
<code>lower.tail==TRUE</code>; in this scope prefer using directly <code>meta_fun</code> which
handles this possible issue.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.first</code></td>
<td>
<p>the first metamodel with the intial DoE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_int</code></td>
<td>
<p>a 95% confidence intervalle on the estimate of alpha.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>moves</code></td>
<td>
<p>a vector containing the number of moves for each one of the <code>N.batch</code> particles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chi2</code></td>
<td>
<p>the output of the chisq.test function.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Probleme should be defined in the standard space. Transformations can be made using <code>UtoX</code> and <code>XtoU</code>
functions.
</p>


<h3>Author(s)</h3>

<p>Clement WALTER <a href="mailto:clementwalter@icloud.com">clementwalter@icloud.com</a>
</p>


<h3>References</h3>


<ul>
<li>
<p> A. Guyader, N. Hengartner and E. Matzner-Lober:<br><em>Simulation and estimation of extreme quantiles and extreme
probabilities</em><br>
Applied Mathematics and Optimization, 64(2), 171-196.<br></p>
</li>
<li>
<p> C. Walter:<br><em>Moving Particles: a parallel optimal Multilevel Splitting
method with application in quantiles estimation and meta-model
based algorithms</em><br>
Structural Safety, 55, 10-25.<br></p>
</li>
<li>
<p> J. Bect, L. Li and E. Vazquez:<br><em>Bayesian subset simulation</em><br>
arXiv preprint arXiv:1601.02557
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>SubsetSimulation</code>
<code>MonteCarlo</code>
<code>IRW</code>
<code>MP</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Estimate P(g(X)&lt;0)
## Not run: p &lt;- BMP(dimension = 2, lsf = kiureghian, q = 0, N = 100, N.iter = 30, plot = TRUE)

# More extreme event
## Not run: p &lt;- BMP(dimension = 2, lsf = waarts, q = -4, N = 100, N.iter = 50, plot = TRUE)

# One can also estimate probability of the form P(g(X)&gt;q)
## Not run: p &lt;- BMP(dimension = 2, lsf = cantilever, q = 1/325, N = 100, N.iter = 30, plot = TRUE)

</code></pre>


</div>