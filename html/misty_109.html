<div class="container">

<table style="width: 100%;"><tr>
<td>test.levene</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Levene's Test for Homogeneity of Variance</h2>

<h3>Description</h3>

<p>This function performs Levene's test for homogeneity of variance across two
or more independent groups.
</p>


<h3>Usage</h3>

<pre><code class="language-R">test.levene(formula, data, method = c("median", "mean"), conf.level = 0.95,
            hypo = TRUE, descript = TRUE, plot = FALSE, violin.alpha = 0.3,
            violin.trim = FALSE, box = TRUE, box.alpha = 0.2, box.width = 0.2,
            jitter = TRUE, jitter.size = 1.25, jitter.width = 0.05,
            jitter.height = 0, jitter.alpha = 0.2, gray = FALSE,
            start = 0.9, end = 0.4, color = NULL, xlab = NULL, ylab = NULL,
            ylim = NULL, breaks = ggplot2::waiver(), title = "",
            subtitle = "", digits = 2, p.digits = 3, as.na = NULL,
            write = NULL, append = TRUE, check = TRUE, output = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula of the form <code>y ~ group</code> where <code>y</code> is
a numeric variable giving the data values and <code>group</code>
a numeric variable, character variable or factor with two
or more than two values or factor levels giving the
corresponding groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a matrix or data frame containing the variables in the
formula <code>formula</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string specifying the method to compute the
center of each group, i.e. <code>method = "median"</code> (default)
to compute the Levene's test based on the median (aka
Brown-Forsythe test) or <code>method = "mean"</code> to compute
the Levene's test based on the arithmetic mean.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>a numeric value between 0 and 1 indicating the confidence
level of the interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hypo</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), null and alternative hypothesis
are shown on the console.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>descript</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), descriptive statistics are shown
on the console.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical: if <code>TRUE</code>, a plot showing violin plots with
boxplots is drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>violin.alpha</code></td>
<td>
<p>a numeric value indicating the opacity of the violins.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>violin.trim</code></td>
<td>
<p>logical: if <code>TRUE</code>, the tails of the violins to the
range of the data is trimmed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>box</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), boxplots are drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>box.alpha</code></td>
<td>
<p>a numeric value indicating the opacity of the boxplots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>box.width</code></td>
<td>
<p>a numeric value indicating the width of the boxplots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jitter</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), jittered data points
are drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jitter.size</code></td>
<td>
<p>a numeric value indicating the <code>size</code> aesthetic
for the jittered data points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jitter.width</code></td>
<td>
<p>a numeric value indicating the amount of horizontal jitter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jitter.height</code></td>
<td>
<p>a numeric value indicating the amount of vertical jitter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jitter.alpha</code></td>
<td>
<p>a numeric value indicating the opacity of the jittered
data points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gray</code></td>
<td>
<p>logical: if <code>TRUE</code>, the plot is drawn in gray scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>a numeric value between 0 and 1, graphical parameter to
specify the gray value at the low end of the palette.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end</code></td>
<td>
<p>a numeric value between 0 and 1, graphical parameter to
specify the gray value at the high end of the palette.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color</code></td>
<td>
<p>a character vector, indicating the color of the violins
and the boxes. By default, default ggplot2 colors are
used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>a character string specifying the labels for the x-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>a character string specifying the labels for the y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>a numeric vector of length two specifying limits of the
limits of the y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>
<p>a numeric vector specifying the points at which tick-marks
are drawn at the y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>a character string specifying the text for the title for
the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subtitle</code></td>
<td>
<p>a character string specifying the text for the subtitle
for the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>an integer value indicating the number of decimal places
to be used for displaying results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.digits</code></td>
<td>
<p>an integer value indicating the number of decimal places
to be used for displaying the <em>p</em>-value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as.na</code></td>
<td>
<p>a numeric vector indicating user-defined missing values,
i.e. these values are converted to <code>NA</code> before
conducting the analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>write</code></td>
<td>
<p>a character string naming a text file with file extension
<code>".txt"</code> (e.g., <code>"Output.txt"</code>) for writing the
output into a text file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>append</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), output will be appended
to an existing text file with extension <code>.txt</code> specified
in <code>write</code>, if <code>FALSE</code> existing text file will be
overwritten.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), argument specification is checked.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), output is shown.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Levene's test is equivalent to a one-way analysis of variance (ANOVA) with the
absolute deviations of observations from the mean of each group as dependent
variable (<code>center = "mean"</code>). Brown and Forsythe (1974) modified the
Levene's test by using the absolute deviations of observations from the median
(<code>center = "median"</code>). By default, the Levene's test uses the absolute
deviations of observations from the median.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>misty.object</code>, which is a list with following
entries:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>function call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>formula of the current analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data frame specified in <code>data</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>ggplot2 object for plotting the results</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args</code></td>
<td>
<p>specification of function arguments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>result</code></td>
<td>
<p>list with result tables, i.e., <code>descript</code> for
descriptive statistics and <code>test</code> for the ANOVA
table</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Takuya Yanagida <a href="mailto:takuya.yanagida@univie.ac.at">takuya.yanagida@univie.ac.at</a>
</p>


<h3>References</h3>

<p>Brown, M. B., &amp; Forsythe, A. B. (1974). Robust tests for the equality of
variances. <em>Journal of the American  Statistical Association, 69</em>,
364-367.
</p>
<p>Rasch, D., Kubinger, K. D., &amp; Yanagida, T. (2011). <em>Statistics in psychology
- Using R and SPSS</em>. John Wiley &amp; Sons.
</p>


<h3>See Also</h3>

<p><code>aov.b</code>, <code>test.t</code>, <code>test.welch</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">dat &lt;- data.frame(y = c(2, 3, 4, 5, 5, 7, 8, 4, 5, 2, 4, 3),
                  group = c(1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3))

# Example 1: Levene's test based on the median with 95% confidence interval
test.levene(y ~ group, data = dat)

# Example 2: Levene's test based on the arithmetic mean  with 95% confidence interval
test.levene(y ~ group, data = dat, method = "mean")

# Example 3: Levene's test based on the median with 99% confidence interval
test.levene(y ~ group, data = dat, conf.level = 0.99)

## Not run: 
# Example 4: Write results into a text file
test.levene(y ~ group, data = dat, write = "Levene.txt")

# Example 5: Levene's test based on the median with 95
# plot results
test.levene(y ~ group, data = dat, plot = TRUE)

# Load ggplot2 package
library(ggplot2)

# Save plot, ggsave() from the ggplot2 package
ggsave("Levene-test.png", dpi = 600, width = 5, height = 6)

# Levene's test based on the median with 95
# extract plot
p &lt;- test.levene(y ~ group, data = dat, output = FALSE)$plot
p

# Example 6: Extract data
plotdat &lt;- test.levene(y ~ group, data = dat, output = FALSE)$data

# Draw violin and boxplots in line with the default setting of test.levene()
ggplot(plotdat, aes(group, y, fill = group)) +
  geom_violin(alpha = 0.3, trim = FALSE) +
  geom_boxplot(alpha = 0.2, width = 0.2) +
  geom_jitter(alpha = 0.2, width = 0.05, size = 1.25) +
  theme_bw() + guides(fill = "none")

## End(Not run)
</code></pre>


</div>