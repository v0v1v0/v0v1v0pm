<div class="container">

<table style="width: 100%;"><tr>
<td>write.sav</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Write SPSS File</h2>

<h3>Description</h3>

<p>This function writes a data frame or matrix into a SPSS file by either using the
<code>write_sav()</code> function in the <span class="pkg">haven</span> package by Hadley Wickham and Evan
Miller (2019) or the free software <em>PSPP</em>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">write.sav(x, file = "SPSS_Data.sav", var.attr = NULL, pspp.path = NULL,
          digits = 2, write.csv = FALSE, sep = c(";", ","), na = "",
          write.sps = FALSE, check = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a matrix or data frame to be written in SPSS, vectors are
coerced to a data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>a character string naming a file with or without file extension
'.sav', e.g., <code>"SPSS_Data.sav"</code> or <code>"SPSS_Data"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.attr</code></td>
<td>
<p>a matrix or data frame with variable attributes used in the
SPSS file, only 'variable labels' (column name <code>label</code>),
'value labels' column name <code>values</code>, and 'user-missing values'
column name <code>missing</code> are supported (see 'Details').</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pspp.path</code></td>
<td>
<p>a character string indicating the path where the PSPP folder
is located on the computer, e.g.<code>C:/Program Files/PSPP/</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>an integer value indicating the number of decimal places shown
in the SPSS file for non-integer variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>write.csv</code></td>
<td>
<p>logical: if <code>TRUE</code>, CSV file is written along with the
SPSS file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sep</code></td>
<td>
<p>a character string for specifying the CSV file, either <code>";"</code>
for the separator and <code>"."</code>
for the decimal point (default, i.e. equivalent to <code>write.csv2</code>)
or <code>"."</code> for the decimal point and <code>","</code> for the
separator (i.e. equivalent to <code>write.csv</code>), must be one
of both <code>";"</code> (default) or <code>","</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na</code></td>
<td>
<p>a character string for specifying missing values in the CSV file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>write.sps</code></td>
<td>
<p>logical: if <code>TRUE</code>, SPSS syntax is written along with
the SPSS file when using PSPP.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check</code></td>
<td>
<p>logical: if <code>TRUE</code>, variable attributes specified in the
argument <code>var.attr</code> is checked.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If arguments <code>pspp.path</code> is not specified (i.e., <code>pspp.path = NULL</code>),
<code>write_sav()</code> function in the <span class="pkg">haven</span> is used. Otherwise the object <code>x</code>
is written as CSV file, which is subsequently imported into SPSS using the free
software <em>PSPP</em> by executing a SPSS syntax written in R. Note that <em>PSPP</em>
needs to be installed on your computer when using the <code>pspp.path</code> argument.
</p>
<p>A SPSS file with 'variable labels', 'value labels', and 'user-missing values' is
written by specifying the <code>var.attr</code> argument. Note that the number of rows
in the matrix or data frame specified in <code>var.attr</code> needs to match with the
number of columns in the data frame or matrix specified in <code>x</code>, i.e., each
row in <code>var.attr</code> represents the variable attributes of the corresponding
variable in <code>x</code>. In addition, column names of the matrix or data frame
specified in <code>var.attr</code> needs to be labeled as <code>label</code> for 'variable
labels, <code>values</code> for 'value labels', and <code>missing</code> for 'user-missing
values'.
</p>
<p>Labels for the values are defined in the column <code>values</code> of the matrix or
data frame in <code>var.attr</code> using the equal-sign (e.g., <code>0 = female</code>) and
are separated by a semicolon (e.g., <code>0 = female; 1 = male</code>).
</p>
<p>User-missing values are defined in the column <code>missing</code> of the matrix or
data frame in <code>var.attr</code>, either specifying one user-missing value (e.g.,
<code>-99</code>) or more than one but up to three user-missing values separated
by a semicolon (e.g., <code>-77; -99</code>.
</p>


<h3>Note</h3>

<p>Part of the function using <em>PSPP</em> was adapted from the <code>write.pspp()</code>
function in the <span class="pkg">miceadds</span> package by Alexander Robitzsch, Simon Grund and
Thorsten Henke (2019).
</p>


<h3>Author(s)</h3>

<p>Takuya Yanagida <a href="mailto:takuya.yanagida@univie.ac.at">takuya.yanagida@univie.ac.at</a>
</p>


<h3>References</h3>

<p>GNU Project (2018). <em>GNU PSPP for GNU/Linux</em> (Version 1.2.0).
Boston, MA: Free Software Foundation. https://www.gnu.org/software/pspp/
</p>
<p>Wickham H., &amp; Miller, E. (2019). <em>haven: Import and Export 'SPSS', 'Stata'
and 'SAS' Files</em>. R package version 2.2.0.
</p>
<p>Robitzsch, A., Grund, S., &amp; Henke, T. (2019). <em>miceadds: Some additional
multiple imputation functions, especially for mice</em>. R package version 3.4-17.
</p>


<h3>See Also</h3>

<p><code>read.sav</code>, <code>write.xlsx</code>, <code>write.dta</code>,
<code>write.mplus</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
dat &lt;- data.frame(id = 1:5,
                  gender = c(NA, 0, 1, 1, 0),
                  age = c(16, 19, 17, NA, 16),
                  status = c(1, 2, 3, 1, 4),
                  score = c(511, 506, 497, 502, 491))

# Example 1: Write SPSS file using the haven package
write.sav(dat, file = "Dataframe_haven.sav")

# Example 2: Write SPSS file using PSPP,
# write CSV file and SPSS syntax along with the SPSS file
write.sav(dat, file = "Dataframe_PSPP.sav", pspp.path = "C:/Program Files/PSPP",
          write.csv = TRUE, write.sps = TRUE)

# Example 3: Specify variable attributes
# Note that it is recommended to manually specify the variables attritbues in a CSV or
# Excel file which is subsequently read into R
attr &lt;- data.frame(# Variable names
                   var = c("id", "gender", "age", "status", "score"),
                   # Variable labels
                   label = c("Identification number", "Gender", "Age in years",
                             "Migration background", "Achievement test score"),
                   # Value labels
                   values = c("", "0 = female; 1 = male", "",
                              "1 = Austria; 2 = former Yugoslavia; 3 = Turkey; 4 = other",
                              ""),
                   # User-missing values
                   missing = c("", "-99", "-99", "-99", "-99"), stringsAsFactors = FALSE)

# Example 4: Write SPSS file with variable attributes using the haven package
write.sav(dat, file = "Dataframe_haven_Attr.sav", var.attr = attr)

# Example 5: Write SPSS with variable attributes using PSPP
write.sav(dat, file = "Dataframe_PSPP_Attr.sav", var.attr = attr,
          pspp.path = "C:/Program Files/PSPP")

## End(Not run)
</code></pre>


</div>