<div class="container">

<table style="width: 100%;"><tr>
<td>aov.w</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Repeated Measures Analysis of Variance (Within-Subject ANOVA)</h2>

<h3>Description</h3>

<p>This function performs an one-way repeated measures analysis of variance (within
subject ANOVA) including paired-samples t-tests for multiple comparison and
provides descriptive statistics, effect size measures, and a plot showing error
bars for difference-adjusted Cousineau-Morey within-subject confidence intervals
with jittered data points including subject-specific lines.
</p>


<h3>Usage</h3>

<pre><code class="language-R">aov.w(formula, data, print = c("all", "none", "LB", "GG", "HF"),
      posthoc = FALSE, conf.level = 0.95,
      p.adj = c("none", "bonferroni", "holm", "hochberg", "hommel", "BH", "BY", "fdr"),
      hypo = TRUE, descript = TRUE, epsilon = TRUE, effsize = FALSE,
      na.omit = TRUE, plot = FALSE, point.size = 4, adjust = TRUE,
      error.width = 0.1, xlab = NULL, ylab = NULL, ylim = NULL,
      breaks = ggplot2::waiver(), jitter = TRUE, line = TRUE,
      jitter.size = 1.25, jitter.width = 0.05, jitter.height = 0,
      jitter.alpha = 0.1, title = "", subtitle = "Confidence Interval",
      digits = 2, p.digits = 4, as.na = NULL, write = NULL, append = TRUE,
      check = TRUE, output = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula of the form <code>cbind(time1, time2, time3) ~ 1</code>
where <code>time1</code>, <code>time2</code>, and <code>time3</code> are
numeric variables representing the levels of the within-subject
factor, i.e., data are specified in wide-format (i.e.,
multivariate person level format).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a matrix or data frame containing the variables in the
formula <code>formula</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print</code></td>
<td>
<p>a character vector indicating which sphericity correction
to use, i.e., <code>all</code> for all corrections, <code>none</code>
for no correction, <code>LB</code> for lower bound correction,
<code>GG</code> for Greenhouse-Geisser correction, and <code>HF</code>,
for Huynh-Feldt correction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posthoc</code></td>
<td>
<p>logical: if <code>TRUE</code>, paired-samples t-tests for multiple
comparison are conducted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>a numeric value between 0 and 1 indicating the confidence
level of the interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.adj</code></td>
<td>
<p>a character string indicating an adjustment method for
multiple testing based on <code>p.adjust</code>, i.e.,
<code>none</code>, <code>bonferroni</code>, <code>holm</code> (default),
<code>h ochberg</code>, <code>hommel</code>, <code>BH</code>, <code>BY</code>, or
<code>fdr</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hypo</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), null and alternative hypothesis
are shown on the console.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>descript</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), descriptive statistics are shown
on the console.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), box indices of sphericity (epsilon)
are shown on the console, i.e., lower bound, Greenhouse
and Geiser (GG), Huynh and Feldt (HF) and average of GG
and HF.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effsize</code></td>
<td>
<p>logical: if <code>TRUE</code>, effect size measures eta-squared
(<code class="reqn">\eta^2</code>), partial eta-squared (<code class="reqn">\eta^2_p</code>),
omega-squared (<code class="reqn">\omega^2</code>), and partial omega-squared
(<code class="reqn">\omega^2_p</code>) for the repeated measures ANOVA and
Cohen's <em>d</em> for the post hoc tests are shown on
the console.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.omit</code></td>
<td>
<p>logical: if <code>TRUE</code>, incomplete cases are removed
before conducting the analysis (i.e., listwise deletion).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical: if <code>TRUE</code>, a plot showing error bars for
confidence intervals is drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>point.size</code></td>
<td>
<p>a numeric value indicating the <code>size</code> aesthetic for
the point representing the mean value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjust</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), difference-adjustment
for the Cousineau-Morey within-subject confidence
intervals is applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error.width</code></td>
<td>
<p>a numeric value indicating the horizontal bar width of
the error bar.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>a character string specifying the labels for the x-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>a character string specifying the labels for the y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>a numeric vector of length two specifying limits of the
limits of the y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>
<p>a numeric vector specifying the points at which tick-marks
are drawn at the y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jitter</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), jittered data points
are drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), subject-specific lines
are drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jitter.size</code></td>
<td>
<p>a numeric value indicating the <code>size</code> aesthetic
for the jittered data points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jitter.width</code></td>
<td>
<p>a numeric value indicating the amount of horizontal jitter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jitter.height</code></td>
<td>
<p>a numeric value indicating the amount of vertical jitter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jitter.alpha</code></td>
<td>
<p>a numeric value indicating the opacity of the jittered
data points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>a character string specifying the text for the title for
the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subtitle</code></td>
<td>
<p>a character string specifying the text for the subtitle for
the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>an integer value indicating the number of decimal places
to be used for displaying descriptive statistics and
confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.digits</code></td>
<td>
<p>an integer value indicating the number of decimal places
to be used for displaying the <em>p</em>-value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as.na</code></td>
<td>
<p>a numeric vector indicating user-defined missing values,
i.e. these values are converted to <code>NA</code> before
conducting the analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>write</code></td>
<td>
<p>a character string naming a text file with file extension
<code>".txt"</code> (e.g., <code>"Output.txt"</code>) for writing the
output into a text file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>append</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), output will be appended
to an existing text file with extension <code>.txt</code> specified
in <code>write</code>, if <code>FALSE</code> existing text file will be
overwritten.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), argument specification is checked.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), output is shown on the console.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>


<dl>
<dt><strong>Sphericity</strong></dt>
<dd>
<p>The <em>F</em>-Test of the repeated measures ANOVA
is based on the assumption of sphericity, which is defined as the assumption
that the variance of differences between repeated measures are equal in the
population. The Mauchly's test is commonly used to test this hypothesis.
However, test of assumptions addresses an irrelevant hypothesis because what
matters is the degree of violation rather than its presence (Baguley, 2012a).
Moreover, the test is not recommended because it lacks statistical power (Abdi,
2010). Instead, the Box index of sphericity (<code class="reqn">\varepsilon</code>) should be used to
assess the degree of violation of the sphericity assumption. The <code class="reqn">\varepsilon</code>
parameter indicates the degree to which the population departs from sphericity
with <code class="reqn">\varepsilon = 1</code> indicating that sphericity holds. As the departure
becomes more extreme, <code class="reqn">\varepsilon</code> approaches its lower bound
<code class="reqn">\hat{\varepsilon}_{lb}</code>:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\varepsilon}_{lb} = \frac{1}{J - 1}</code>
</p>

<p>where <code class="reqn">J</code> is the number of levels of the within-subject factor. Box (1954a,
1954b) suggested a measure for sphericity, which applies to a population
covariance matrix. Greenhouse and Geisser (1959) proposed an estimate for
<code class="reqn">\varepsilon</code> known as <code class="reqn">\hat{\varepsilon}_{gg}</code> that can be computed
from the sample covariance matrix, whereas Huynh and Feldt (1976) proposed
an alternative estimate <code class="reqn">\hat{\varepsilon}_{hf}</code>. These estimates can
be used to correct the effect and error <em>df</em> of the <em>F</em>-test.
Simulation studies showed that <code class="reqn">\hat{\varepsilon}_{gg} \leq \hat{\varepsilon}_{hf}</code>
and that <code class="reqn">\hat{\varepsilon}_{gg}</code> tends to be conservative underestimating
<code class="reqn">\varepsilon</code>, whereas <code class="reqn">\hat{\varepsilon}_{hf}</code> tends to be liberal
overestimating <code class="reqn">\varepsilon</code> and occasionally exceeding one. Baguley (2012a)
recommended to compute the average of the conservative estimate <code class="reqn">\hat{\varepsilon}_{gg}</code>
and the liberal estimate <code class="reqn">\hat{\varepsilon}_{hf}</code> to assess the sphericity
assumption.
By default, the function prints results depending on the average
<code class="reqn">\hat{\varepsilon}_{gg}</code> and <code class="reqn">\hat{\varepsilon}_{hf}</code>:
</p>

<ul>
<li>
<p> If the average is less than 0.75 results of the <em>F</em>-Test based on
Greenhouse-Geiser correction factor (<code class="reqn">\hat{\varepsilon}_{gg}</code>) is printed.
</p>
</li>
<li>
<p> If the average is less greater or equal 0.75, but less than 0.95
results of the <em>F</em>-Test based on Huynh-Feldt correction factor
(<code class="reqn">\hat{\varepsilon}_{hf}</code>) is printed.
</p>
</li>
<li>
<p> If the average is greater or equal 0.95 results of the <em>F</em>-Test
without any corrections are printed.
</p>
</li>
</ul>
</dd>
<dt><strong>Missing Data</strong></dt>
<dd>
<p>The function uses listwise deletion by default to
deal with missing data. However, the function also allows to use all available
observations by conducting the repeated measures ANOVA in long data format when
specifying <code>na.omit = FALSE</code>. Note that in the presence of missing data,
the <em>F</em>-Test without any sphericity corrections may be reliable, but it
is not clear whether results based on Greenhouse-Geiser or Huynh-Feldt correction
are trustworthy given that pairwise deletion is used for estimating the
variance-covariance matrix when computing <code class="reqn">\hat{\varepsilon}_{gg}</code> and the total
number of subjects regardless of missing values (i.e., complete and incomplete
cases) are used for computing <code class="reqn">\hat{\varepsilon}_{hf}</code>.
</p>
</dd>
<dt><strong>Within-Subject Confidence Intervals</strong></dt>
<dd>
<p>The function provides a
plot showing error bars for difference-adjusted Cousineau-Morey confidence
intervals (Baguley, 2012b). The intervals matches that of a CI for a difference,
i.e., non-overlapping CIs corresponds to an inferences of no statistically
significant difference. The Cousineau-Morey confidence intervals without
adjustment can be used by specifying <code>adjust = FALSE</code>.
</p>
</dd>
</dl>
<h3>Value</h3>

<p>Returns an object of class <code>misty.object</code>, which is a list with following
entries:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>function call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>list with the data (<code>data</code>) in wide-format (<code>wide</code>), reshaped data in long-format (<code>long</code>), and within-subject confidence intervals (<code>ci</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>formula of the current analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>ggplot2 object for plotting the results</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args</code></td>
<td>
<p>specification of function arguments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>result</code></td>
<td>
<p>list with result tables, i.e., <code>descript</code> for descriptive
statistics, <code>epsilon</code> for a table with indices of sphericity,
<code>test</code> for the ANOVA table (<code>none</code> for no sphericity
correction, <code>lb</code> for lower bound correction, <code>gg</code>
for Greenhouse and Geiser correction, and <code>hf</code> for
Huynh and Feldt correction), <code>posthoc</code> for post hoc
tests, and <code>aov</code> for the return object of the <code>aov</code>
function</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Takuya Yanagida <a href="mailto:takuya.yanagida@univie.ac.at">takuya.yanagida@univie.ac.at</a>
</p>


<h3>References</h3>

<p>Abdi, H. (2010). The Greenhouse-Geisser correction. In N. J. Salkind (Ed.)
<em>Encyclopedia of Research Design</em> (pp. 630-634), Sage.
https://dx.doi.org/10.4135/9781412961288
</p>
<p>Baguley, T. S. (2012a). <em>Serious stats: A guide to advanced statistics for the
behavioral sciences</em>. Palgrave Macmillan.
</p>
<p>Baguley, T. (2012b). Calculating and graphing within-subject confidence intervals
for ANOVA. <em>Behavior Research Methods, 44</em>, 158-175.
https://doi.org/10.3758/s13428-011-0123-7
</p>
<p>Bakerman, R. (2005). Recommended effect size statistics for repeated measures
designs. <em>Behavior Research Methods</em>, 37, 179-384.
https://doi.org/10.3758/BF03192707
</p>
<p>Box, G. E. P. (1954a) Some Theorems on Quadratic Forms Applied in the Study
of Analysis of Variance Problems, I. Effects of Inequality of Variance in
the One-way Classification. <em>Annals of Mathematical Statistics, 25</em>,
290–302.
</p>
<p>Box, G. E. P. (1954b) Some Theorems on Quadratic Forms Applied in the Study
of Analysis of Variance Problems, II. Effects of Inequality of Variance and
of Correlation between Errors in the Two-way Classification.
<em>Annals of Mathematical Statistics, 25</em>, 484–98.
</p>
<p>Greenhouse, S. W., and Geisser, S. (1959). On methods in the analysis of profile
data.<em>Psychometrika, 24</em>, 95-112. https://doi.org/10.1007/BF02289823
</p>
<p>Huynh, H., and Feldt, L. S. (1976). Estimation of the box correction for degrees
of freedom from sample data in randomized block and splitplot designs.
<em>Journal of Educational Statistics, 1</em>, 69-82.
https://doi.org/10.2307/1164736
</p>
<p>Olejnik, S., &amp; Algina, J. (2000). Measures of effect size for comparative studies:
Applications, interpretations, and limitations. <em>Contemporary Educational
Psychology, 25</em>, 241-286. https://doi.org/10.1006/ceps.2000.1040
</p>
<p>Rasch, D., Kubinger, K. D., &amp; Yanagida, T. (2011). <em>Statistics in psychology
- Using R and SPSS</em>. John Wiley &amp; Sons.
</p>


<h3>See Also</h3>

<p><code>aov.b</code>, <code>test.t</code>, <code>test.z</code>,
<code>cohens.d</code>, <code>ci.mean.diff</code>, <code>ci.mean</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">dat &lt;- data.frame(time1 = c(3, 2, 1, 4, 5, 2, 3, 5, 6, 7),
                  time2 = c(4, 3, 6, 5, 8, 6, 7, 3, 4, 5),
                  time3 = c(1, 2, 2, 3, 6, 5, 1, 2, 4, 6))

# Example 1: Repeated measures ANOVA
aov.w(cbind(time1, time2, time3) ~ 1, data = dat)

# Example 2: Repeated measures ANOVA
# print results based on all sphericity corrections
aov.w(cbind(time1, time2, time3) ~ 1, data = dat, print = "all")

# Example 3: Repeated measures ANOVA
# print effect size measures
aov.w(cbind(time1, time2, time3) ~ 1, data = dat, effsize = TRUE)

# Example 4: Repeated measures ANOVA
# do not print hypotheses and descriptive statistics,
aov.w(cbind(time1, time2, time3) ~ 1, data = dat, descript = FALSE, hypo = FALSE)

## Not run: 
# Example 5: Write results into a text file
aov.w(cbind(time1, time2, time3) ~ 1, data = dat, write = "RM-ANOVA.txt")

# Example 6: Repeated measures ANOVA
# plot results
aov.w(cbind(time1, time2, time3) ~ 1, data = dat, plot = TRUE)

# Load ggplot2 package
library(ggplot2)

# Save plot, ggsave() from the ggplot2 package
ggsave("Repeated_measures_ANOVA.png", dpi = 600, width = 4.5, height = 4)

# Example 7: Repeated measures ANOVA
# extract plot
p &lt;- aov.w(cbind(time1, time2, time3) ~ 1, data = dat, output = FALSE)$plot
p

# Extract data
plotdat &lt;- aov.w(cbind(time1, time2, time3) ~ 1, data = dat, output = FALSE)$data

# Draw plot in line with the default setting of aov.w()
ggplot(plotdat$long, aes(time, y, group = 1L)) +
geom_point(aes(time, y, group = id),
          alpha = 0.1, position = position_dodge(0.05)) +
geom_line(aes(time, y, group = id),
         alpha = 0.1, position = position_dodge(0.05)) +
geom_point(data = plotdat$ci, aes(variable, m), stat = "identity", size = 4) +
stat_summary(aes(time, y), fun = mean, geom = "line") +
geom_errorbar(data = plotdat$ci, aes(variable, m, ymin = low, ymax = upp), width = 0.1) +
theme_bw() + xlab(NULL) +
labs(subtitle = "Two-Sided 95
theme(plot.subtitle = element_text(hjust = 0.5),
     plot.title = element_text(hjust = 0.5))

## End(Not run)
</code></pre>


</div>