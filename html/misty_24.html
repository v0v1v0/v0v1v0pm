<div class="container">

<table style="width: 100%;"><tr>
<td>ci.mean.w</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Within-Subject Confidence Interval for the Arithmetic Mean</h2>

<h3>Description</h3>

<p>This function computes difference-adjusted Cousineau-Morey within-subject
confidence interval for the arithmetic mean.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ci.mean.w(..., data = NULL, adjust = TRUE,
          alternative = c("two.sided", "less", "greater"),
          conf.level = 0.95, na.omit = TRUE, digits = 2,
          as.na = NULL, write = NULL, append = TRUE, check = TRUE,
          output = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>a matrix or data frame with numeric variables representing
the levels of the within-subject factor, i.e., data are
specified in wide-format (i.e., multivariate person level
format). Alternatively, an expression indicating the variable
names in <code>data</code> e.g., <code>ci.mean.w(x1, x2, x3, data = dat)</code>.
Note that the operators
<code>.</code>, <code>+</code>, <code>-</code>, <code>~</code>, <code>:</code>, <code>::</code>,
and <code>!</code> can also be used to select variables, see 'Details'
in the <code>df.subset</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame when specifying one or more variables in the
argument <code>...</code>. Note that the argument is <code>NULL</code>
when specifying a matrix or data frame
for the argument <code>...</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjust</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), difference-adjustment
for the Cousineau-Morey within-subject confidence intervals
is applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis,
must be one of <code>"two.sided"</code> (default), <code>"greater"</code>
or <code>"less"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>a numeric value between 0 and 1 indicating the confidence
level of the interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.omit</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), incomplete cases are removed
before conducting the analysis (i.e., listwise deletion).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>an integer value indicating the number of decimal places
to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as.na</code></td>
<td>
<p>a numeric vector indicating user-defined missing values,
i.e. these values are converted to <code>NA</code> before
conducting the analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>write</code></td>
<td>
<p>a character string naming a text file with file extension
<code>".txt"</code> (e.g., <code>"Output.txt"</code>) for writing the
output into a text file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>append</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), output will be appended
to an existing text file with extension <code>.txt</code> specified
in <code>write</code>, if <code>FALSE</code> existing text file will be
overwritten.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), argument specification is checked.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), output is shown on the console.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Cousineau within-subject confidence interval (CI, Cousineau, 2005) is an
alternative to the Loftus-Masson within-subject CI (Loftus &amp; Masson, 1994)
that does not assume sphericity or homogeneity of covariances. This approach
removes individual differences by normalizing the raw scores using
participant-mean centering and adding the grand mean back to every score:
</p>
<p style="text-align: center;"><code class="reqn">Y_{ij}^{'} = Y_{ij} - \hat{\mu}_{i} + \hat{\mu}_{grand}</code>
</p>

<p>where <code class="reqn">Y_{ij}^{'}</code> is the score of the <code class="reqn">i</code>th participant in condition
<code class="reqn">j</code> (for <code class="reqn">i = 1</code> to <code class="reqn">n</code>), <code class="reqn">\hat{\mu}_{i}</code> is the mean of
participant <code class="reqn">i</code> across all <code class="reqn">J</code> levels (for <code class="reqn">j = 1</code> to <code class="reqn">J</code>),
and <code class="reqn">\hat{\mu}_{grand}</code> is the grand mean.
</p>
<p>Morey (2008) pointed out that Cousineau's (2005) approach produces intervals
that are consistently too narrow due to inducing a positive covariance
between normalized scores within a condition introducing bias into the
estimate of the sample variances. The degree of bias is proportional to the
number of means and can be removed by rescaling the confidence interval by
a factor of <code class="reqn">\sqrt{J - 1}/J</code>:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\mu}_j \pm t_{n - 1, 1 - \alpha/2} \sqrt{\frac{J}{J - 1}} \hat{\sigma}^{'}_{{\hat{\mu}}_j}</code>
</p>

<p>where <code class="reqn">\hat{\sigma}^{'}_{{\mu}_j}</code> is the standard error of the mean computed
from the normalized scores of he <code class="reqn">j</code>th factor level.
</p>
<p>Baguley (2012) pointed out that the Cousineau-Morey interval is larger than
that for a difference in means by a factor of <code class="reqn">\sqrt{2}</code> leading to a
misinterpretation of these intervals that overlap of 95% confidence intervals
around individual means is indicates that a 95% confidence interval for the
difference in means would include zero. Hence, following adjustment to the
Cousineau-Morey interval was proposed:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\mu}_j \pm \frac{\sqrt{2}}{2} (t_{n - 1, 1 - \alpha/2} \sqrt{\frac{J}{J - 1}} \hat{\sigma}^{'}_{{\hat{\mu}}_j})</code>
</p>

<p>The adjusted Cousineau-Morey interval is informative about the pattern of
differences between means and is computed by default (i.e., <code>adjust = TRUE</code>).
</p>


<h3>Value</h3>

<p>Returns an object of class <code>misty.object</code>, which is a list with following
entries:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>function call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data frame used for the current analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args</code></td>
<td>
<p>specification of function arguments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>result</code></td>
<td>
<p>result table</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Takuya Yanagida <a href="mailto:takuya.yanagida@univie.ac.at">takuya.yanagida@univie.ac.at</a>
</p>


<h3>References</h3>

<p>Baguley, T. (2012). Calculating and graphing within-subject confidence intervals
for ANOVA. <em>Behavior Research Methods, 44</em>, 158-175.
https://doi.org/10.3758/s13428-011-0123-7
</p>
<p>Cousineau, D. (2005) Confidence intervals in within-subject designs: A simpler
solution to Loftus and Masson’s Method. <em>Tutorials in Quantitative Methods
for Psychology, 1</em>, 42–45.  https://doi.org/10.20982/tqmp.01.1.p042
</p>
<p>Loftus, G. R., and Masson, M. E. J. (1994). Using confidence intervals in
within-subject designs. <em>Psychonomic Bulletin and Review, 1</em>, 476–90.
https://doi.org/10.3758/BF03210951
</p>
<p>Morey, R. D. (2008). Confidence intervals from normalized data: A correction
to Cousineau. <em>Tutorials in Quantitative Methods for Psychology, 4</em>, 61–4.
https://doi.org/10.20982/tqmp.01.1.p042
</p>


<h3>See Also</h3>

<p><code>aov.w</code>, <code>test.z</code>, <code>test.t</code>,
<code>ci.mean.diff</code>,' <code>ci.median</code>, <code>ci.prop</code>,
<code>ci.var</code>, <code>ci.sd</code>, <code>descript</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">dat &lt;- data.frame(time1 = c(3, 2, 1, 4, 5, 2, 3, 5, 6, 7),
                  time2 = c(4, 3, 6, 5, 8, 6, 7, 3, 4, 5),
                  time3 = c(1, 2, 2, 3, 6, 5, 1, 2, 4, 6))

# Example 1: Difference-adjusted Cousineau-Morey confidence intervals
ci.mean.w(dat)

# Example 1: Alternative specification using the 'data' argument
ci.mean.w(., data = dat)

# Example 2: Cousineau-Morey confidence intervals
ci.mean.w(dat, adjust = FALSE)

## Not run: 
# Example 3: Write results into a text file
ci.mean.w(dat, write = "WS_Confidence_Interval.txt")

## End(Not run)
</code></pre>


</div>