<div class="container">

<table style="width: 100%;"><tr>
<td>item.invar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Between-Group and Longitudinal Measurement Invariance Evaluation</h2>

<h3>Description</h3>

<p>This function is a wrapper function for evaluating configural, metric, scalar,
and strict between-group or longitudinal (partial) measurement invariance using
confirmatory  factor analysis with continuous indicators by calling the <code>cfa</code>
function in the R package <span class="pkg">lavaan</span>. By default, the function evaluates
configural, metric, and scalar measurement invariance by providing a table
with model fit information (i.e., chi-square test, fit indices based on a proper
null model, and information criteria) and model comparison (i.e., chi-square
difference test, change in fit indices, and change in information criteria).
Additionally, variance-covariance coverage of the data, descriptive statistics,
parameter estimates, modification indices, and residual correlation matrix can
be requested by specifying the argument <code>print</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">item.invar(..., data = NULL, model = NULL, rescov = NULL, rescov.long = TRUE,
           group = NULL, long = FALSE, cluster = NULL,
           invar = c("config", "metric", "scalar", "strict"),
           partial = NULL, ident = c("marker", "var", "effect"),
           estimator = c("ML", "MLM", "MLMV", "MLMVS", "MLF", "MLR",
                         "GLS", "WLS", "DWLS", "WLSM", "WLSMV",
                         "ULS", "ULSM", "ULSMV", "DLS", "PML"),
           missing = c("listwise", "pairwise", "fiml", "two.stage",
                       "robust.two.stage", "doubly.robust"), null.model = TRUE,
           print = c("all", "summary", "coverage", "descript", "fit", "est",
                     "modind", "resid"),
           print.fit = c("all", "standard", "scaled", "robust"),
           mod.minval = 6.63, resid.minval = 0.1, digits = 3, p.digits = 3,
           as.na = NULL, write = NULL, append = TRUE, check = TRUE, output = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>a matrix or data frame. If <code>model = NULL</code>, confirmatory
factor analysis based on a measurement model with one factor
labeled <code>f</code> comprising all variables in the matrix or
data frame specified in <code>x</code> for evaluating between-group
measurement invariance for the grouping variable specified
in the argument <code>group</code> is conducted. Longitudinal
measurement invariance evaluation can only be conducted by
specifying the model using the argument <code>model</code>. Note
that the cluster variable is excluded from <code>x</code> when
specifying <code>cluster</code>. If <code>model</code> is specified,
the matrix or data frame needs to contain all variables
used in the argument <code>model</code> and the cluster variable
when specifying the name of the cluster variable in the
argument <code>cluster</code>. Alternatively, an expression
indicating the variable names in <code>data</code> e.g.,
<code>item.invar(x1, x2, x2, data = dat)</code>. Note that the operators
<code>.</code>, <code>+</code>, <code>-</code>, <code>~</code>, <code>:</code>, <code>::</code>,
and <code>!</code> can also be used to select variables, see 'Details'
in the <code>df.subset</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame when specifying one or more variables in the
argument <code>...</code>. Note that the argument is <code>NULL</code>
when specifying a vector, factor, matrix, array, data frame,
or list for the argument <code>...</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a character vector specifying a measurement model with one
factor, or a list of character vectors for specifying a
measurement model with more than one factor for evaluating
between-group measurement invariance when <code>long = FALSE</code>
or a list of character vectors for specifying a measurement
model with one factor for each time of measurement for
evaluating longitudinal measurement invariance when
specifying <code>long = TRUE</code>. For example,
<code>model = c("x1", "x2", "x3", "x4")</code> for specifying a
measurement model with one factor labeled <code>f</code> comprising
four indicators, or <code>model = list(factor1 = c("x1", "x2", "x3", "x4"),
factor2 = c("x5", "x6", "x7", "x8"))</code> for specifying a
measurement model with two latent factors labeled <code>factor1</code>
and <code>factor2</code> each comprising four indicators for
evaluating between-group measurement invariance, or
<code>model = list(time1 = c("ax1", "ax2", "ax3", "ax4"),
time2 = c("bx1", "bx2", "bx3", "bx4"),
time3 = c("cx1", "cx2", "cx3", "cx4"))</code> for specifying a
longitudinal measurement model with three time points comprising
four indicators at each time point. This function cannot
evaluate longitudinal measurement invariance for a measurement
model with more than one factor. Note that the name of each
list element is used to label factors, i.e., all list elements
need to be named, otherwise factors are labeled with <code>"f1", "f2", "f3"</code>
when <code>long = FALSE</code> and with <code>"t1", "t2", "t3"</code>
when <code>long = TRUE</code> and so on.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rescov</code></td>
<td>
<p>a character vector or a list of character vectors for specifying
residual covariances, e.g., <code>rescov = c("x1", "x2")</code>
for specifying a residual covariance between items <code>x1</code>
and <code>x2</code>, or <code>rescov = list(c("x1", "x2"), c("x3", "x4"))</code>
for specifying residual covariances between items <code>x1</code>
and <code>x2</code>, and items <code>x3</code> and <code>x4</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rescov.long</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), residual covariances between
parallel indicators are estimated across time when evaluating
longitudinal measurement invariance (<code>long = TRUE</code>),
i.e., residual variances of the same indicators that are
measured at different time points are correlated across all
possible time points. Note that residual covariances should
be estimated even if the parameter estimates are statistically
not significant since indicator-specific systematic variance
is likely to correlate with itself over time (Little, 2013,
p. 164).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>either a character string indicating the variable name of
the grouping variable in the matrix or data frame specified
in <code>x</code> or a vector representing the groups
for conducting multiple-group analysis to evaluate between-group
measurement invariance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>long</code></td>
<td>
<p>logical: if <code>TRUE</code>, longitudinal measurement invariance
evaluation is conducted. The longitudinal measurement model
is specified by using the argument <code>model</code>. Note that
this function can only evaluate either between-group or
longitudinal measurement invariance, but not both at the
same time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>either a character string indicating the variable name
of the cluster variable in <code>...</code> or <code>data</code>,
or a vector representing the nested grouping structure
(i.e., group or cluster variable) for computing
cluster-robust standard errors. Note that cluster-robust
standard errors are not available when treating indicators
of the measurement model as ordered (ordinal).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>invar</code></td>
<td>
<p>a character string indicating the level of measurement
invariance to be evaluated, i.e., <code>config</code> to evaluate
configural measurement invariance (i.e., same factor structure
across groups or time), <code>metric</code> to evaluate configural
and metric measurement invariance (i.e., equal factor loadings
across groups or time), <code>scalar</code> (default) to evaluate
configural, metric and scalar measurement invariance (i.e.,
equal intercepts or thresholds across groups or time), and
<code>strict</code> to evaluate configural, metric, scalar, and
strict measurement invariance (i.e., equal residual variances
across groups or time).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>partial</code></td>
<td>
<p>a character string or character vector containing the labels
of the parameters which should be free in all groups or across
time to specify a partial measurement invariance model. Note
that the labels of the parameters need to match the labels
shown in the output, i.e., <code>"L"</code> with a number for factor
loadings, <code>"T"</code> with a number for intercepts, and
<code>"E"</code> with a number for factor residual variances. The
number attached to the <code>"L"</code>, <code>"T"</code>, or <code>"E"</code>
label corresponds to the number of the indicator in the
measurement model (e.g., <code>"T3"</code> for the intercept of
the third indicator). When specifying the model using the
argument <code>model</code>, however, the number for the factor
loading is a combination of the number of the factor and
the number of the indicator (e.g., <code>"L23"</code> is the third
indicator of the second factor). Note that at least two
invariant indicators are needed for a partial measurement
invariance model. Otherwise there might be issues with model
non-identification.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ident</code></td>
<td>
<p>a character string indicating the method used for identifying
and scaling latent variables, i.e., <code>"marker"</code> for the
marker variable method fixing the first factor loading of
each latent variable to 1, <code>"var"</code> (default) for the
fixed variance method fixing the variance of each latent
variable to 1, or <code>"effect"</code> for the effects-coding
method using equality constraints so that the average of
the factor loading for each latent variable equals 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimator</code></td>
<td>
<p>a character string indicating the estimator to be used
(see 'Details' in the help page of the <code>item.cfa()</code>
function). By default, <code>"MLR"</code> is used for CFA models
with continuous indicators.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missing</code></td>
<td>
<p>a character string indicating how to deal with missing data,
i.e., <code>"listwise"</code> for listwise deletion, <code>"pairwise"</code>
for pairwise deletion, <code>"fiml"</code> for full information
maximum likelihood method, <code>two.stage</code> for two-stage
maximum likelihood method, <code>robust.two.stage</code> for robust
two-stage maximum likelihood method, and <code>doubly-robust</code>
for doubly-robust method (see 'Details' in the help page
of the<code>item.cfa()</code> function). By default, <code>"fiml"</code>
is used for CFA models with continuous indicators which are
estimated by using <code>estimator = "MLR"</code>. However, argument
<code>missing</code> switches to <code>listwise</code> when the data
set is complete, i.e., it is not possible to use FIML in
complete data. Note that the robust CFI, TLI, and RMSEA
are different in complete data depending on whether FIML or
listwise deletion was specified when estimating the model
in lavaan.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null.model</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), the proper null model
for computing incremental fit indices (i.e., CFI and TLI)
is used, i.e., means and variances of the indicators are
constrained to be equal across group or time in the null
model (Little, 2013, p. 112).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print</code></td>
<td>
<p>a character string or character vector indicating which results
to show on the console, i.e. <code>"all"</code> for all results,
<code>"summary"</code> for a summary of the specification of the
estimation method and missing data handling in lavaan,
<code>"coverage"</code> for the variance-covariance coverage of
the data, <code>"descript"</code> for descriptive statistics,
<code>"fit"</code> for model fit and model comparison, <code>"est"</code>
for parameter estimates, <code>"modind"</code> for modification
indices, and <code>"resid"</code> for the residual correlation
matrix and standardized residual means. By default, a summary
of the specification, model fit, and parameter estimates
are printed. Note that parameter estimates, modification
indices, and residual correlation matrix is only provided
for the model investigating the level of measurement
invariance specified in the argument <code>"invar"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.fit</code></td>
<td>
<p>a character string or character vector indicating which
version of the CFI, TLI, and RMSEA to show on the console
when using a robust estimation method involving a scaling
correction factor, i.e., <code>"all"</code> for all versions of
the CFI, TLI, and RMSEA, <code>"standard"</code> (default when
<code>estimator</code> is one of <code>"ML", "MLF", "GLS", "WLS", "DWLS", "ULS", "PML"</code>)
for fit indices without any non-normality correction,
<code>"scaled"</code> for population-corrected robust fit indices
with ad hoc non-normality correction, and <code>robust</code>
(default when <code>estimator</code> is one of <code>"MLM", "MLMV", "MLMVS", "MLR", "WLSM", "WLSMV", "ULSM", "ULSMV", "DLS"</code>)
for sample-corrected robust fit indices based on formula
provided by Li and Bentler (2006) and Brosseau-Liard and
Savalei (2014).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mod.minval</code></td>
<td>
<p>numeric value to filter modification indices and only show
modifications with a modification index value equal or higher
than this minimum value. By default, modification indices
equal or higher 6.63 are printed. Note that a modification
index value of 6.63 is equivalent to a significance level
of <code class="reqn">\alpha = .01</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resid.minval</code></td>
<td>
<p>numeric value indicating the minimum absolute residual
correlation coefficients and standardized means to highlight
in boldface. By default, absolute residual correlation
coefficients and standardized means equal or higher 0.1
are highlighted. Note that highlighting can be disabled by
setting the minimum value to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>an integer value indicating the number of decimal places
to be used for displaying results. Note that information
criteria and chi-square test statistic are printed with
<code>digits</code> minus 1 decimal places.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.digits</code></td>
<td>
<p>an integer value indicating the number of decimal places
to be used for displaying <em>p</em>-values, covariance coverage
(i.e., <code>p.digits - 1</code>), and residual correlation
coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as.na</code></td>
<td>
<p>a numeric vector indicating user-defined missing values, i.e.,
these values are converted to <code>NA</code> before conducting
the analysis. Note that <code>as.na()</code> function is only
applied to <code>x</code> but not to <code>group</code> or <code>cluster</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>write</code></td>
<td>
<p>a character string naming a file for writing the output into
either a text file with file extension <code>".txt"</code> (e.g.,
<code>"Output.txt"</code>) or Excel file with file extension
<code>".xlsx"</code>  (e.g., <code>"Output.xlsx"</code>). If the file
name does not contain any file extension, an Excel file will
be written.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>append</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), output will be appended
to an existing text file with extension <code>.txt</code> specified
in <code>write</code>, if <code>FALSE</code> existing text file will be
overwritten.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), argument specification is checked
and convergence and model identification checks are conducted
for all estimated models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), output is shown.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns an object of class <code>misty.object</code>, which is a list with following
entries:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>function call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data frame including all variables used in the analysis, i.e.,
indicators for the factor, grouping variable and cluster variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args</code></td>
<td>
<p>specification of function arguments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>list with specified model for the configural, metric, scalar,
and strict invariance model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.fit</code></td>
<td>
<p>list with fitted lavaan object of the configural, metric,
scalar, and strict invariance model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check</code></td>
<td>
<p>list with the results of the convergence and model identification
check for the configural, metric, scalar, and strict invariance
model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>result</code></td>
<td>
<p>list with result tables, i.e., <code>summary</code> for the
summary of the specification of the estimation method and
missing data handling in lavaan, <code>coverage</code> for the
variance-covariance coverage of the data, <code>descript</code>
for descriptive statistics, <code>fit</code> for a list with
model fit based on standard, scaled, and robust fit indices,
<code>est</code> for a list with parameter estimates for the
configural, metric, scalar, and strict invariance model,
<code>modind</code> for the list with modification indices for
the configural, metric, scalar, and strict invariance model,
<code>score</code> for the list with result of the score tests
for constrained parameters for the configural, metric,
scalar, and strict invariance model, and <code>resid</code> for
the list with residual correlation matrices and standardized
residual means for the configural, metric, scalar, and
strict invariance model</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The function uses the functions <code>cfa</code>, <code>fitmeasures</code> ,<code>lavInspect</code>,
<code>lavTech</code>, <code>lavTestLRT</code>, <code>lavTestScore</code>, <code>modindices</code>,
<code>parameterEstimates</code>, <code>parTable</code>, and <code>standardizedsolution</code>
provided in the R package <span class="pkg">lavaan</span> by Yves Rosseel (2012).
</p>


<h3>Author(s)</h3>

<p>Takuya Yanagida <a href="mailto:takuya.yanagida@univie.ac.at">takuya.yanagida@univie.ac.at</a>
</p>


<h3>References</h3>

<p>Brosseau-Liard, P. E., &amp; Savalei, V. (2014) Adjusting incremental fit indices
for nonnormality. <em>Multivariate Behavioral Research, 49</em>, 460-470.
https://doi.org/10.1080/00273171.2014.933697
</p>
<p>Li, L., &amp; Bentler, P. M. (2006). Robust statistical tests for evaluating the
hypothesis of close fit of misspecified mean and covariance structural models.
<em>UCLA Statistics Preprint #506</em>. University of California.
</p>
<p>Little, T. D. (2013). <em>Longitudinal structural equation modeling</em>. Guilford
Press.
</p>
<p>Rosseel, Y. (2012). lavaan: An R Package for Structural Equation Modeling.
<em>Journal of Statistical Software, 48</em>, 1-36. https://doi.org/10.18637/jss.v048.i02
</p>


<h3>See Also</h3>

<p><code>item.cfa</code>, <code>multilevel.invar</code>, <code>write.result</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Load data set "HolzingerSwineford1939" in the lavaan package
data("HolzingerSwineford1939", package = "lavaan")

#-------------------------------------------------------------------------------
# Between-Group Measurement Invariance Evaluation

#..................
# Measurement model with one factor

# Example 1a: Specification of the grouping variable in 'x'
item.invar(HolzingerSwineford1939[, c("x1", "x2", "x3", "x4", "sex")], group = "sex")

# Example 1b: Specification of the grouping variable in 'group'
item.invar(HolzingerSwineford1939[, c("x1", "x2", "x3", "x4")],
           group = HolzingerSwineford1939$sex)

# Example 1c: Alternative specification using the 'data' argument
item.invar(x1:x4, data = HolzingerSwineford1939, group = "sex")

# Example 1d: Alternative specification using the argument 'model'
item.invar(HolzingerSwineford1939, model = c("x1", "x2", "x3", "x4"), group = "sex")

# Example 1e: Alternative specification using the 'data' and 'model' argument
item.invar(., data = HolzingerSwineford1939, model = c("x1", "x2", "x3", "x4"), group = "sex")

#..................
# Measurement model with two factors

item.invar(HolzingerSwineford1939,
           model = list(c("x1", "x2", "x3", "x4"),
                        c("x5", "x6", "x7", "x8")), group = "sex")

#..................
# Configural, metric, scalar, and strict measurement invariance

# Example 2: Evaluate configural, metric, scalar, and strict measurement invariance
item.invar(HolzingerSwineford1939, model = c("x1", "x2", "x3", "x4"),
           group = "sex", invar = "strict")

#..................
# Partial measurement invariance

# Example 3: Free second factor loading (L2) and third intercept (T3)
item.invar(HolzingerSwineford1939, model = c("x1", "x2", "x3", "x4"),
           group = "sex", partial = c("L2", "T3"), print = c("fit", "est"))

#..................
# Residual covariances

# Example 4a: One residual covariance
item.invar(HolzingerSwineford1939, model = c("x1", "x2", "x3", "x4"),
           rescov = c("x3", "x4"), group = "sex")

# Example 4b: Two residual covariances
item.invar(HolzingerSwineford1939, model = c("x1", "x2", "x3", "x4"),
           rescov = list(c("x1", "x2"), c("x3", "x4")), group = "sex")

#..................
# Scaled test statistic and cluster-robust standard errors

# Example 5a: Specify cluster variable using a variable name in 'x'
item.invar(HolzingerSwineford1939, model = c("x1", "x2", "x3", "x4"),
           group = "sex", cluster = "agemo")

# Example 5b: Specify vector of the cluster variable in the argument 'cluster'
item.invar(HolzingerSwineford1939, model = c("x1", "x2", "x3", "x4"),
           group = "sex", cluster = HolzingerSwineford1939$agemo)

#..................
# Default Null model

# Example 6: Specify default null model for computing incremental fit indices
item.invar(HolzingerSwineford1939, model = c("x1", "x2", "x3", "x4"),
           group = "sex", null.model = FALSE)

#..................
# Print argument

# Example 7a: Request all results
item.invar(HolzingerSwineford1939, model = c("x1", "x2", "x3", "x4"),
           group = "sex", print = "all")

# Example 7b: Request fit indices with ad hoc non-normality correction
item.invar(HolzingerSwineford1939, model = c("x1", "x2", "x3", "x4"),
           group = "sex", print.fit = "scaled")

# Example 7c: Request modification indices with value equal or higher than 10
# and highlight residual correlations equal or higher than 0.3
item.invar(HolzingerSwineford1939, model = c("x1", "x2", "x3", "x4"),
           group = "sex", print = c("modind", "resid"),
           mod.minval = 10, resid.minval = 0.3)

#..................
# Model syntax and lavaan summary of the estimated model

# Example 8
mod &lt;- item.invar(HolzingerSwineford1939, model = c("x1", "x2", "x3", "x4"),
                  group = "sex", output = FALSE)

# lavaan model syntax scalar invariance model
cat(mod$model$scalar)

# lavaan summary of the scalar invariance model
lavaan::summary(mod$model.fit$scalar, standardized = TRUE, fit.measures = TRUE)

#-------------------------------------------------------------------------------
# Longitudinal Measurement Invariance Evaluation

# Example 9: Two time points with three indicators at each time point
item.invar(HolzingerSwineford1939,
           model = list(c("x1", "x2", "x3"),
                        c("x5", "x6", "x7")), long = TRUE)

#------------------------------------------------
# Write Results

# Example 10a: Write results into a text file
item.invar(HolzingerSwineford1939, model = c("x1", "x2", "x3", "x4"),
            group = "sex", print = "all", write = "Invariance.txt", output = FALSE)

# Example 10b: Write results into an Excel file
item.invar(HolzingerSwineford1939, model = c("x1", "x2", "x3", "x4"),
            group = "sex", print = "all", write = "Invariance.xlsx", output = FALSE)

result &lt;- item.invar(HolzingerSwineford1939, model = c("x1", "x2", "x3", "x4"),
                     group = "sex", print = "all", output = FALSE)
write.result(result, "Invariance.xlsx")

## End(Not run)
</code></pre>


</div>