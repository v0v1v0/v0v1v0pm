<div class="container">

<table style="width: 100%;"><tr>
<td>blimp.plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Blimp Trace Plots and Posterior Distribution Plots</h2>

<h3>Description</h3>

<p>This function reads the posterior distribution including burn-in and
post-burn-in phase for all parameters saved in long format in a file called
<code>posterior.*</code> by the function <code>blimp.run</code> or <code>blimp</code> when specifying
<code>posterior = TRUE</code> to display trace plots and posterior distribution plots.
</p>


<h3>Usage</h3>

<pre><code class="language-R">blimp.plot(x, plot = c("none", "trace", "post"), param = NULL, labels = TRUE,
           burnin = TRUE, point = c("all", "none", "m", "med", "map"),
           ci = c("none", "eti", "hdi"), conf.level = 0.95, hist = TRUE,
           density = TRUE, area = TRUE, alpha = 0.4, fill = "gray85",
           nrow = NULL, ncol = NULL, scales = c("fixed", "free", "free_x", "free_y"),
           xlab = NULL, ylab = NULL, xlim = NULL, ylim = NULL,
           xbreaks = ggplot2::waiver(), ybreaks = ggplot2::waiver(),
           xexpand = ggplot2::waiver(), yexpand = ggplot2::waiver(),
           palette = "Set 2", binwidth = NULL, bins = NULL,
           density.col = "#0072B2", shape = 21,
           point.col = c("#CC79A7", "#D55E00", "#009E73"),
           linewidth = 0.6, linetype = "dashed", line.col = "black",
           plot.margin = NULL, legend.title.size = 10, legend.text.size = 10,
           legend.box.margin = NULL, saveplot = c("all", "none", "trace", "post"),
           file = "Blimp_Plot.pdf", file.plot = c("_TRACE", "_POST"),
           width = NA, height = NA, units = c("in", "cm", "mm", "px"), dpi = 600,
           check = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a character string indicating the name of folder
containing the <code>posterior.*</code> file, e.g.,
<code>"Posterior_Ex4.3"</code> or the name of the
<code>posterior.*</code> file with or without any file
extension, e.g., <code>"Posterior_ExEx4.3/posterior.csv"</code>
or <code>"Posterior_ExEx4.3/posterior"</code>. Alternatively,
a <code>misty.object</code> of type <code>blimp</code> can be
specified, i.e., result object of the <code>blimp.plot()</code>
function. Note that if the <code>posterior</code> file is
specified without file extension while multiple
<code>posterior.*</code> files in different file formats
are available, then the file is read in following
order: <code>csv</code>,<code>RData</code>, <code>rds</code>,
and <code>xlsx</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>a character string indicating the type of plot to
display, i.e., <code>"none"</code> for not displaying any
plot, <code>"trace"</code> (default) for displaying trace
plots, and <code>post</code> for displaying posterior
distribution plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>a numeric vector indicating which parameters to print
for the trace plots or posterior distribution plots.
Note that the number of the parameter (<code>Param</code>)
and the parameter specification (<code>L1</code>, <code>L2</code>,
and <code>L3</code>) are provided in the text file
<code>"partable.txt"</code>. Note that parameters with zero
variance are excluded by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), parameter labels
(e.g., <code>y Beta x</code> for the slope of the regression
y on x) are shown in the facet labels. If <code>FALSE</code>,
the numbers of the parameter (e.g., <code>Parameter 1</code>
are shown in the the facet labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>logical: if <code>FALSE</code>, the burn-in iterations are
discarded when displaying trace plots. The default
setting for <code>plot = "trace"</code> is <code>TRUE</code>.
Note that the burn-in iterations are always discarded
when displaying posterior distribution plots
(<code>plot = "post"</code>) regardless of the setting of
the argument <code>burnin</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>point</code></td>
<td>
<p>a character vector indicating the point estimate(s)
to be displayed in the posterior distribution plots,
i.e., <code>"all"</code> for all point estimates, <code>"none"</code>
for not displaying any point estimates, <code>"m"</code>
for the posterior mean estimate, <code>"med"</code> (default)
for the posterior median estimate, and <code>"map"</code>
for the maximum a posteriori estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>a character string indicating the type of credible
interval to be displayed in the posterior distribution
plots, i.e., <code>"none"</code> for not displaying any
credible intervals, <code>"eti"</code> (default) for displaying
the equal-tailed intervals and <code>"hdi"</code> for displaying
the highest density interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>a numeric value between 0 and 1 indicating the
confidence level of the credible interval (default is
<code>0.95</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hist</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), histograms are
drawn in the posterior probability plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), density curves are
drawn in the posterior probability plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>area</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), statistical not
significant and statistical significant area is
filled with a different color and vertical lines are
drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>a numeric value between 0 and 1 for the <code>alpha</code>
argument (default is <code>0.4</code>) for the <code>annotate</code>,
and <code>geom_histogram</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill</code></td>
<td>
<p>a character string indicating the color for the
<code>"fill"</code> argument (default is <code>"gray85"</code>)
for the <code>annotate</code> and <code>geom_histogram</code>
functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrow</code></td>
<td>
<p>a numeric value indicating the <code>nrow</code> argument
(default is <code>NULL</code>) for the <code>facet_wrap</code>
function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncol</code></td>
<td>
<p>a numeric value indicating the <code>ncol</code> argument
(default is <code>2</code>) for the <code>facet_wrap</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scales</code></td>
<td>
<p>a character string indicating the <code>scales</code> argument
(default is <code>"free"</code>) for the <code>facet_wrap</code>
function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>a character string indicating the <code>name</code> argument
for the <code>scale_x_continuous</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>a character string indicating the <code>name</code> argument
for the <code>scale_y_continuous</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>a numeric vector with two elements indicating the
<code>limits</code> argument (default it <code>NULL</code>) for
the <code>scale_x_continuous</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>a numeric vector with two elements indicating the
<code>limits</code> argument (default it <code>NULL</code>) for
the <code>scale_y_continuous</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xbreaks</code></td>
<td>
<p>a numeric vector indicating the <code>breaks</code> argument
(default is <code>ggplot2::waiver()</code>) for the
<code>scale_x_continuous</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ybreaks</code></td>
<td>
<p>a numeric vector indicating the <code>breaks</code> argument
(default is <code>ggplot2::waiver()</code>) for the
<code>scale_y_continuous</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xexpand</code></td>
<td>
<p>a numeric vector with two elements indicating the
<code>expand</code> argument (default is <code>(0.02, 0)</code>)
for the <code>scale_x_continuous</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yexpand</code></td>
<td>
<p>a numeric vector with two elements indicating the
<code>expand</code> argument for the <code>scale_y_continuous</code>
function. Note that the default setting depends
on the type of plot, e.g., <code>(0.02, 0)</code> for the
trace plots and <code>expansion(mult = c(0, 0.05))</code>
for the posterior distribution plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>palette</code></td>
<td>
<p>a character string indicating the palette name (default
is <code>"Set 2"</code>) for the <code>hcl.colors</code> function.
Note that the character string must be one of
<code>hcl.pals()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binwidth</code></td>
<td>
<p>a numeric value indicating the <code>binwidth</code> argument
(default is to use the number of bins in <code>bins</code>
argument) for the <code>geom_histogram</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bins</code></td>
<td>
<p>a numeric value indicating the <code>bins</code> argument
(default is <code>30</code>) for the <code>geom_histogram</code>
function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density.col</code></td>
<td>
<p>a character string indicating the <code>color</code> argument
(default is <code>"#0072B2"</code>) for the <code>geom_density</code>
function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape</code></td>
<td>
<p>a numeric value indicating the <code>shape</code> argument
(default is <code>21</code>) for the <code>geom_point</code>
function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>point.col</code></td>
<td>
<p>a character vector with three elements indicating the
<code>values</code> argument (default is
<code>c("#CC79A7", "#D55E00", "#009E73")</code>) for the
<code>scale_color_manual</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linewidth</code></td>
<td>
<p>a numeric value indicating the <code>linewidth</code> argument
(default is <code>0.6</code>) for the <code>geom_vline</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linetype</code></td>
<td>
<p>a numeric value indicating the <code>linetype</code> argument
(default is <code>"dashed"</code>) for the <code>geom_vline</code>
function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line.col</code></td>
<td>
<p>a character string indicating the <code>color</code> argument
(default is <code>"black"</code>) for the <code>geom_vline</code>
function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.margin</code></td>
<td>
<p>a numeric vector indicating the <code>plot.margin</code>
argument for the <code>theme</code> function. Note that the
default setting depends on the type of the plot, e.g.,
<code>c(4, 15, -10, 0)</code> for the trace plots, and
<code>c(4, 15, 4, 4)</code> for the autocorrelation plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.title.size</code></td>
<td>
<p>a numeric value indicating the <code>legend.title</code>
argument (default is <code>element_text(size = 10)</code>)
for the <code>theme</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.text.size</code></td>
<td>
<p>a numeric value indicating the <code>legend.text</code>
argument (default is <code>element_text(size = 10)</code>)
for the <code>theme</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.box.margin</code></td>
<td>
<p>a numeric vector indicating the <code>legend.box.margin</code>
argument for the <code>theme</code> function. Note that the
default setting depends on the type of plot, e.g.,
<code>c(-16, 6, 6, 6)</code> for the trace plots, and
<code>c(-25, 6, 6, 6)</code> for the posterior distribution
plots with displaying point estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>saveplot</code></td>
<td>
<p>a character vector indicating the plot to be saved,
i.e., <code>"all"</code> for saving all plots, <code>"none"</code>
(default) for not saving any plots, <code>"trace"</code>
for saving the trace plots and <code>post</code> for the saving
the posterior distribution plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>a character string indicating the <code>filename</code>
argument (default is <code>"Blimp_Plot.pdf"</code>) including
the file extension for the <code>ggsave</code> function.
Note that one of <code>".eps"</code>, <code>".ps"</code>,
<code>".tex"</code>, <code>".pdf"</code> (default), <code>".jpeg"</code>,
<code>".tiff"</code>, <code>".png"</code>, <code>".bmp"</code>,
<code>".svg"</code> or <code>".wmf"</code> needs to be specified
as file extension in the <code>file</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file.plot</code></td>
<td>
<p>a character vector with two elements for distinguishing
different types of plots. By default, the character
string specified in the argument <code>"file"</code>
(<code>"Blimp_Plot"</code>) is concatenated with <code>"_TRACE"</code>
(<code>"Blimp_Plot_TRACE"</code>) for the trace plots,
and <code>"_POST"</code> (<code>"Blimp_Plot_POST"</code>) for
the posterior distribution plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>a numeric value indicating the <code>width</code> argument
(default is the size of the current graphics device)
for the <code>ggsave</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>height</code></td>
<td>
<p>a numeric value indicating the <code>height</code> argument
(default is the size of the current graphics device)
for the <code>ggsave</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>units</code></td>
<td>
<p>a character string indicating the <code>units</code> argument
(default is <code>in</code>) for the <code>ggsave</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dpi</code></td>
<td>
<p>a numeric value indicating the <code>dpi</code> argument
(default is <code>600</code>) for the <code>ggsave</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), argument
specification is checked.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns an object of class <code>misty.object</code>, which is a list with following
entries:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>function call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a character string indicating the name of the <code>posterior.*</code> file</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args</code></td>
<td>
<p>specification of function arguments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>list with posterior distribution of each parameter estimate
in long format (<code>plotdat</code>), plot data for the trace
plots (<code>trace</code>), and plot data for the posterior
distribution plots (<code>post</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>list with the trace plots (<code>trace</code> and posterior distribution
plots (<code>post</code>)</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Takuya Yanagida
</p>


<h3>References</h3>

<p>Keller, B. T., &amp; Enders, C. K. (2023). <em>Blimp userâ€™s guide</em> (Version 3).
Retrieved from www.appliedmissingdata.com/blimp
</p>


<h3>See Also</h3>

<p><code>blimp</code>, <code>blimp.update</code>, <code>blimp.run</code>,
<code>blimp.print</code>, <code>blimp.plot</code>, <code>blimp.bayes</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
#----------------------------------------------------------------------------
# Blimp Example 4.3: Linear Regression

#..........
# Trace Plots

# Example 1a: Default setting, specifying name of the folder
blimp.plot("Posterior_Ex4.3")

# Example 1b: Default setting, specifying the posterior file
blimp.plot("Posterior_Ex4.3/posterior.csv")

# Example 1c: Print parameters 2, 3, 4, and 5
blimp.plot("Posterior_Ex4.3", param = 2:5)

# Example 1e: Arrange panels in three columns
blimp.plot("Posterior_Ex4.3", ncol = 3)

# Example 1f: Specify "Pastel 1" palette for the hcl.colors function
blimp.plot("Posterior_Ex4.3", palette = "Pastel 1")

#..........
# Posterior Distribution Plots

# Example 2a: Default setting, i.e., posterior median and equal-tailed interval
blimp.plot("Posterior_Ex4.3", plot = "post")

# Example 2b: Display posterior mean and maximum a posteriori
blimp.plot("Posterior_Ex4.3", plot = "post", point = c("m", "map"))

# Example 2c: Display maximum a posteriori and highest density interval
blimp.plot("Posterior_Ex4.3", plot = "post", point = "map", ci = "hdi")

# Example 2d: Do not display any point estimates and credible interval
blimp.plot("Posterior_Ex4.3", plot = "post", point = "none", ci = "none")

# Example 2d: Do not display histograms
blimp.plot("Posterior_Ex4.3", plot = "post", hist = FALSE)

#..........
# Save Plots

# Example 3a: Save all plots in pdf format
blimp.plot("Posterior_Ex4.3", saveplot = "all")

# Example 3b: Save all plots in png format with 300 dpi
blimp.plot("Posterior_Ex4.3", saveplot = "all", file = "Blimp_Plot.png", dpi = 300)

# Example 3a: Save posterior distribution plot, specify width and height of the plot
blimp.plot("Posterior_Ex4.3", plot = "none", saveplot = "post",
           width = 7.5, height = 7)

#----------------------------------------------------------------------------
# Plot from misty.object

# Create misty.object
object &lt;- blimp.plot("Posterior_Ex4.3", plot = "none")

# Trace plot
blimp.plot(object, plot = "trace")

# Posterior distribution plot
blimp.plot(object, plot = "post")

#----------------------------------------------------------------------------
# Create Plots Manually

# Load ggplot2 package
library(ggplot2)

# Create misty object
object &lt;- blimp.plot("Posterior_Ex4.3", plot = "none")

#..........
# Example 4: Trace Plots

# Extract data
data.trace &lt;- object$data$trace

# Plot
ggplot(data.trace, aes(x = iter, y = value, color = chain)) +
  annotate("rect", xmin = 0, xmax = 1000, ymin = -Inf, ymax = Inf,
           alpha = 0.4, fill = "gray85") +
  geom_line() +
  facet_wrap(~ param, ncol = 2, scales = "free") +
  scale_x_continuous(name = "", expand = c(0.02, 0)) +
  scale_y_continuous(name = "", expand = c(0.02, 0)) +
  scale_colour_manual(name = "Chain",
                      values = hcl.colors(n = 2, palette = "Set 2")) +
  theme_bw() +
  guides(color = guide_legend(nrow = 1, byrow = TRUE)) +
  theme(plot.margin = margin(c(4, 15, -10, 0)),
        legend.position = "bottom",
        legend.title = element_text(size = 10),
        legend.text = element_text(size = 10),
        legend.box.margin = margin(c(-16, 6, 6, 6)),
        legend.background = element_rect(fill = "transparent"))

#..........
# Example 5: Posterior Distribution Plots

# Extract data
data.post &lt;- object$data$post

# Plot
ggplot(data.post, aes(x = value)) +
  geom_histogram(aes(y = after_stat(density)), color = "black", alpha = 0.4,
                 fill = "gray85") +
  geom_density(color = "#0072B2") +
  geom_vline(data = data.frame(param = levels(data.post$param),
                               stat = tapply(data.post$value, data.post$param, median)),
             aes(xintercept = stat, color = "Median"), linewidth = 0.6) +
  geom_vline(data = data.frame(param = levels(data.post$param),
                               low = tapply(data.post$value, data.post$param,
                                            function(y) quantile(y, probs = 0.025))),
             aes(xintercept = low), linetype = "dashed", linewidth = 0.6) +
  geom_vline(data = data.frame(param = levels(data.post$param),
                               upp = tapply(data.post$value, data.post$param,
                                            function(y) quantile(y, probs = 0.975))),
             aes(xintercept = upp), linetype = "dashed", linewidth = 0.6) +
  facet_wrap(~ param, ncol = 2, scales = "free") +
  scale_x_continuous(name = "", expand = c(0.02, 0)) +
  scale_y_continuous(name = "Probability Density, f(x)",
                     expand = expansion(mult = c(0L, 0.05))) +
  scale_color_manual(name = "Point Estimate", values = c(Median = "#D55E00")) +
  labs(caption = "95% Equal-Tailed Interval") +
  theme_bw() +
  theme(plot.margin = margin(c(4, 15, -8, 4)),
        plot.caption = element_text(hjust = 0.5, vjust = 7),
        legend.position = "bottom",
        legend.title = element_text(size = 10),
        legend.text = element_text(size = 10),
        legend.box.margin = margin(c(-30, 6, 6, 6)),
        legend.background = element_rect(fill = "transparent"))

## End(Not run)
</code></pre>


</div>