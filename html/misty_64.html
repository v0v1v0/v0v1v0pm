<div class="container">

<table style="width: 100%;"><tr>
<td>mplus.bayes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mplus Summary Measures, Convergence and Efficiency Diagnostics</h2>

<h3>Description</h3>

<p>This function uses the <code>h5file</code> function in the <span class="pkg">hdf5r</span> package to
read a Mplus GH5 file that is requested by the command <code>PLOT: TYPE IS PLOT2</code>
in Mplus to compute point estimates (i.e., mean, median, and MAP), measures of dispersion
(i.e., standard deviation and mean absolute deviation), measures of shape (i.e.,
skewness and kurtosis), credible intervals (i.e., equal-tailed intervals and
highest density interval), convergence and efficiency diagnostics (i.e., potential
scale reduction factor R-hat, effective sample size, and Monte Carlo standard error),
probability of direction, and probability of being in the region of practical
equivalence for the posterior distribution for each parameter. By default, the
function computes the maximum of rank-normalized split-R-hat and rank normalized
folded-split-R-hat, Bulk effective sample size
(Bulk-ESS) for rank-normalized values using split chains, tail effective sample
size (Tail-ESS) defined as the minimum of the effective sample size for 0.025 and
0.975 quantiles, the Bulk Monte Carlo standard error (Bulk-MCSE) for the median
and Tail Monte Carlo standard error (Tail-MCSE) defined as the maximum of the MCSE
for 0.025 and 0.975 quantiles.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mplus.bayes(x,
            print = c("all", "default", "m", "med", "map", "sd", "mad",
                      "skew", "kurt", "eti", "hdi",
                      "rhat", "b.ess", "t.ess", "b.mcse", "t.mcse"),
            param = c("all", "on", "by", "with", "inter", "var", "r2", "new"),
            std = c("all", "none", "stdyx", "stdy", "std"),
            m.bulk = FALSE, split = TRUE, rank = TRUE, fold = TRUE,
            pd = FALSE, null = 0, rope = NULL,
            ess.tail = c(0.025, 0.975), mcse.tail = c(0.025, 0.975),
            alternative = c("two.sided", "less", "greater"),
            conf.level = 0.95, digits = 2, r.digits = 3, ess.digits = 0,
            mcse.digits = 3, p.digits = 3, write = NULL, append = TRUE,
            check = TRUE, output = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a character string indicating the name of the Mplus GH5 file
(HDF5 format) with or without the file extension <code>.gh5</code>,
e.g., <code>"Mplus_Plot.gh5"</code> or <code>"Mplus_Plot"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print</code></td>
<td>
<p>a character vector indicating which summary measures,
convergence, and efficiency diagnostics to be printed on
the console, i.e. <code>"all"</code> for all summary measures,
convergence, and efficiency diagnostics, <code>"m"</code> for the
mean, <code>"med"</code> for the median, <code>"MAP"</code> for the
maximum a posteriori probability estimate, <code>"med"</code>
for the standard deviation, <code>"mad"</code> for the mean
absolute deviation, <code>"skew"</code> for the skewness,
<code>"kurt"</code> for the kurtosis, <code>"eti"</code> for the
equal-tailed credible interval, <code>"hdi"</code> for the
highest density credible interval, <code>"rhat"</code> for the
potential scale reduction (PSR) factor R-hat convergence
diagnostic, <code>"b.ess"</code> for the bulk effective sample
size (ESS), <code>"t.ess"</code> for the tail ESS, <code>"b.mcse"</code>
for the bulk Monte Carlo standard error (MCSE), and
<code>"t.mcse"</code> for the tail MCSE. The default setting is
<code>print = c("med", "sd", "skew", "kurt", "eti", "rhat", "b.ess", "t.ess", "b.mcse", "t.mcse")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>character vector indicating which parameters to print
for the summary measures, convergence, and efficiency
diagnostics, i.e., <code>"all"</code> for all parameters,
<code>"on"</code> (default), for regression slopes, <code>"by"</code>
for factor loadings, <code>"with"</code> for covariances,
<code>"inter"</code> for intercepts and thresholds, <code>"var"</code>
for (residual) variances, <code>"r2"</code> for r-square, and
<code>"new"</code> for parameters not in the analysis model
specified in the <code>NEW</code> option. The default setting
is <code>"on"</code> if regression slopes are available. Otherwise,
the default setting switches to <code>"by"</code> and to
<code>"with"</code> if factor loadings are not available.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>std</code></td>
<td>
<p>a character vector indicating the standardized
parameters to print for the summary measures, convergence,
and efficiency diagnostics, i.e., <code>"all"</code> for all
standardized parameters, <code>"none"</code> (default) for not
printing any standardized parameters, <code>"stdyx"</code> for
StdYX standardized parameters, <code>"stdy"</code> for StdY
standardized parameters, and <code>"std"</code> for StdX
standardized parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m.bulk</code></td>
<td>
<p>logical: if <code>TRUE</code> the Monte Carlo standard error for the mean
is computed. The default setting is <code>m.bulk = FALSE</code>, i.e., the Monte Carlo
standard error for the median is computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>split</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), each MCMC chain is split
in half before computing R-hat. Note that the argument
<code>split</code> is always set to <code>FALSE</code> when computing
ESS.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), rank-normalization is
applied to the posterior draws before computing R-hat and ESS. Note that
the argument <code>rank</code> is always set to <code>FALSE</code> when computing MCSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fold</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), the maximum of
rank-normalized split-R-hat and rank normalized folded-split-R-hat
is computed. Note that the arguments <code>split</code> and
<code>rank</code> are always set to <code>TRUE</code> when specifying
<code>fold = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pd</code></td>
<td>
<p>logical: if <code>TRUE</code>, the probability of direction is
printed on the console.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null</code></td>
<td>
<p>a numeric value considered as a null effect for the probability
of direction (default is <code>0</code>). Note that the value
specified in the argument <code>null</code> applies to all parameters
which might not be sensible for all parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rope</code></td>
<td>
<p>a numeric vector with two elements indicating the ROPE's
lower and upper bounds. ROPE is also depending on the argument
<code>alternative</code>, e.g., if <code>rope = c(-0.1, 0.1)</code>,
then the actual ROPE is <code>[-0.1, 0.1]</code> given
<code>alternative = "two.sided} (default), \code{[-Inf, 0.1]}
given \code{alternative = "greater</code>, and <code>[-0.1, Inf]</code>
given <code>alternative = "less"</code>. Note that the interval
specified in the argument <code>rope</code> applies to all parameters
which might not be sensible for all parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ess.tail</code></td>
<td>
<p>a numeric vector with two elements to specify the quantiles
for computing the tail ESS. The default setting is
<code>tail = c(0.025, 0.975)</code>, i.e., tail ESS is the minimum
of effective sample sizes for 5% and 95% quantiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcse.tail</code></td>
<td>
<p>a numeric vector with two elements to specify the quantiles
for computing the tail MCSE. The default setting is
<code>tail = c(0.025, 0.975)</code>, i.e., tail MCSE is the maximum
of Monte Carlo standard error for 5% and 95% quantiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis
for the credible intervals, must be one of <code>"two.sided"</code>
(default), <code>"greater"</code> or <code>"less"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>a numeric value between 0 and 1 indicating the confidence
level of the credible interval. The default setting is <code>conf.level = 0.95</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>an integer value indicating the number of decimal places
to be used for displaying point estimates, measures of
dispersion, and credible intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r.digits</code></td>
<td>
<p>an integer value indicating the number of decimal places
to be used for displaying R-hat values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ess.digits</code></td>
<td>
<p>an integer value indicating the number of decimal places
to be used for displaying effective sample sizes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcse.digits</code></td>
<td>
<p>an integer value indicating the number of decimal places
to be used for displaying Monte Carlo standard errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.digits</code></td>
<td>
<p>an integer value indicating the number of decimal places
to be used for displaying the probability of direction
and the probability of being in the region of practical
equivalence (ROPE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>write</code></td>
<td>
<p>a character string naming a file for writing the output into
either a text file with file extension <code>".txt"</code> (e.g.,
<code>"Output.txt"</code>) or Excel file with file extension
<code>".xlsx"</code>  (e.g., <code>"Output.xlsx"</code>). If the file
name does not contain any file extension, an Excel file will
be written.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>append</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), output will be appended
to an existing text file with extension <code>.txt</code> specified
in <code>write</code>, if <code>FALSE</code> existing text file will be
overwritten.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), argument specification is
checked.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), output is shown on the
console by using the function <code>mplus.print()</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>


<dl>
<dt><strong>Convergence and Efficiency Diagnostics for Markov Chains</strong></dt>
<dd>
<p>Convergence
and efficiency diagnostics for Markov chains is based on following numeric
measures:
</p>

<ul>
<li>
<p><strong>Potential Scale Reduction (PSR) factor R-hat</strong>: The PSR factor
R-hat compares the between- and within-chain variance for a model
parameter, i.e., R-hat larger than 1 indicates that the between-chain
variance is greater than the within-chain variance and chains have not
mixed well. According to the default setting, the function computes the
improved R-hat as recommended by Vehtari et al. (2020) based on rank-normalizing
(i.e., <code>rank = TRUE</code>) and folding (i.e., <code>fold = TRUE</code>) the
posterior draws after splitting each MCMC chain in half (i.e.,
<code>split = TRUE</code>). The traditional R-hat used in Mplus can be requested
by specifying <code>split = FALSE</code>, <code>rank = FALSE</code>, and
<code>fold = FALSE</code>. Note that the traditional R-hat can catch many
problems of poor convergence, but fails if the chains have different
variances with the same mean parameter or if the chains have infinite
variance with one of the chains having a different location parameter to
the others (Vehtari et al., 2020). According to Gelman et al. (2014) a
R-hat value of 1.1 or smaller for all parameters can be considered evidence
for convergence. The Stan Development Team (2024) recommends running at
least four chains and a convergence criterion of less than 1.05 for the
maximum of rank normalized split-R-hat and rank normalized folded-split-R-hat.
Vehtari et al. (2020), however, recommended to only use the posterior
samples if R-hat is less than 1.01 because the R-hat can fall below 1.1
well before convergence in some scenarios (Brooks &amp; Gelman, 1998; Vats &amp;
Knudon, 2018).
</p>
</li>
<li>
<p><strong>Effective Sample Size (ESS)</strong>: The ESS is the estimated number
of independent samples from the posterior distribution that would lead
to the same precision as the autocorrelated samples at hand. According
to the default setting, the function computes the ESS based on rank-normalized
split-R-hat and within-chain autocorrelation. The function provides the
estimated Bulk-ESS (<code>B.ESS</code>) and the Tail-ESS (<code>T.ESS</code>). The
Bulk-ESS is a useful measure for sampling efficiency in the bulk of the
distribution (i.e, efficiency of the posterior mean), and the Tail-ESS
is useful measure for sampling efficiency in the tails of the distribution
(e.g., efficiency of tail quantile estimates). Note that by default, the
Tail-ESS is the minimum of the effective sample sizes for 5% and 95%
quantiles (<code>tail = c(0.025, 0.975)</code>). According to Kruschke (2015),
a rank-normalized ESS greater than 400 is usually sufficient to get a
stable estimate of the Monte Carlo standard error. However, a ESS of
at least 1000 is considered optimal (Zitzmann &amp; Hecht, 2019).
</p>
</li>
<li>
<p><strong>Monte Carlo Standard Error (MCSE)</strong>: The MCSE is defined as
the standard deviation of the chains divided by their effective sample
size and reflects uncertainty due to the stochastic algorithm of the
Markov Chain Monte Carlo method. The function provides the estimated
Bulk-MCSE (<code>B.MCSE</code>) for the margin of error when using the MCMC
samples to estimate the posterior mean and the Tail-ESS (<code>T.MCSE</code>)
for the margin of error when using the MCMC samples for interval
estimation.
</p>
</li>
</ul>
</dd>
</dl>
<h3>Value</h3>

<p>Returns an object of class <code>misty.object</code>, which is a list with following
entries:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>function call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Mplus GH5 file</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args</code></td>
<td>
<p>specification of function arguments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>three-dimensional array parameter x iteration x chain of
the posterior</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>result</code></td>
<td>
<p>result table with summary measures, convergence, and
efficiency diagnostics</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>This function is a modified copy of functions provided in the <span class="pkg">rstan</span>
package by Stan Development Team (2024) and <span class="pkg">bayestestR</span> package by
Makowski et al. (2019).
</p>


<h3>Author(s)</h3>

<p>Takuya Yanagida
</p>


<h3>References</h3>

<p>Brooks, S. P. and Gelman, A. (1998). General Methods for Monitoring Convergence
of Iterative Simulations. <em>Journal of Computational and Graphical Statistics, 7</em>(4):
434–455. MR1665662.
</p>
<p>Gelman, A., &amp; Rubin, D.B. (1992). Inference from iterative simulation using
multiple sequences. <em>Statistical Science, 7</em>, 457-472.
https://doi.org/10.1214/ss/1177011136
</p>
<p>Kruschke, J. (2015). <em>Doing Bayesian data analysis: A tutorial with R, JAGS, and Stan</em>.
Academic Press.
</p>
<p>Makowski, D., Ben-Shachar, M., &amp; Lüdecke, D. (2019). bayestestR: Describing
effects and their uncertainty, existence and significance within the Bayesian
framework. <em>Journal of Open Source Software, 4</em>(40), 1541.
https://doi.org/10.21105/joss.01541
</p>
<p>Stan Development Team (2024). <em>RStan: the R interface to Stan</em>. R package
version 2.32.6. https://mc-stan.org/.
</p>
<p>Vats, D. and Knudson, C. (2018). Revisiting the Gelman-Rubin Diagnostic.
arXiv:1812.09384.
</p>
<p>Vehtari, A., Gelman, A., Simpson, D., Carpenter, B., &amp; Bürkner, P.-C. (2020).
Rank-normalization, folding, and localization: An improved R-hat for assessing
convergence of MCMC. <em>Bayesian analysis, 16</em>(2), 667-718.
https://doi.org/110.1214/20-BA1221
</p>
<p>Zitzmann, S., &amp; Hecht, M. (2019). Going beyond convergence in Bayesian estimation:
Why precision matters too and how to assess it. <em>Structural Equation Modeling:
A Multidisciplinary Journal, 26</em>(4), 646–661. https://doi.org/10.1080/10705511.2018.1545232
</p>


<h3>See Also</h3>

<p><code>read.mplus</code>, <code>write.mplus</code>, <code>mplus</code>,
<code>mplus.update</code>, <code>mplus.print</code>, <code>mplus.plot</code>,
<code>mplus.run</code>, <code>mplus.lca</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
#----------------------------------------------------------------------------
# Mplus Example 3.18: Moderated Mediation with a Plot of the Indirect Effect

# Example 1: Default setting
mplus.bayes("ex3.18.gh5")

# Example 2: Print all parameters
mplus.bayes("ex3.18.gh5", param = "all")

# Example 3: Print parameters not in the analysis model
mplus.bayes("ex3.18.gh5", param = "new")

# Example 4a: Print all summary measures, convergence, and efficiency diagnostics
mplus.bayes("ex3.18.gh5", print = "all")

# Example 4a: Print default measures plus MAP
mplus.bayes("ex3.18.gh5", print = c("default", "map"))

# Example 5: Print traditional R-hat in line with Mplus
mplus.bayes("ex3.18.gh5", split = FALSE, rank = FALSE, fold = FALSE)

# Example 6: Print probability of direction and the probability of
# being ROPE [-0.1, 0.1]
mplus.bayes("ex3.18.gh5", pd = TRUE, rope = c(-0.1, 0.1))

# Example 7: Write Results into a text file
mplus.bayes("ex3.18.gh5", write = "Bayes_Summary.txt")

# Example 8b: Write Results into a Excel file
mplus.bayes("ex3.18.gh5", write = "Bayes_Summary.xlsx")

## End(Not run)
</code></pre>


</div>