<div class="container">

<table style="width: 100%;"><tr>
<td>mplus.lca</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mplus Model Specification for Latent Class Analysis</h2>

<h3>Description</h3>

<p>This function writes Mplus input files for conducting latent class analysis (LCA)
for continuous, count, ordered categorical, and unordered categorical variables.
LCA with continuous indicator variables are based on six different
variance-covariance structures, while LCA for all other variable types assume
local independence. By default, the function conducts LCA with continuous
variables and creates folders in the current working directory for each of the
six sets of analysis, writes Mplus input files for conducting LCA with
<em>k</em> = 1 to <em>k</em> = 6 classes into these folders, and writes the matrix
or data frame specified in <code>x</code> into a Mplus data file in the current working
directory. Optionally, all models can be estimated by setting the argument
<code>mplus.run</code> to <code>TRUE</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mplus.lca(x, ind = NULL,
          type = c("continuous", "count", "categorical", "nominal"), cluster = NULL,
          folder = c("A_Invariant-Theta_Diagonal-Sigma",
                     "B_Varying-Theta_Diagonal-Sigma",
                     "C_Invariant-Theta_Invariant-Unrestrictred-Sigma",
                     "D_Invariant-Theta_Varying-Unrestricted-Sigma",
                     "E_Varying-Theta_Invariant-Unrestricted-Sigma",
                     "F_Varying-Theta_Varying-Unrestricted-Sigma"),
          file = "Data_LCA.dat", write = c("all", "folder", "data", "input"),
          useobservations = NULL, missing = -99, classes = 6, estimator = "MLR",
          starts = c(100, 50), stiterations = 10, lrtbootstrap = 1000,
          lrtstarts = c(0, 0, 100, 50), processors = c(8, 8),
         output = c("all", "SVALUES", "CINTERVAL", "TECH7", "TECH8", "TECH11", "TECH14"),
          replace.inp = FALSE, mplus.run = FALSE, Mplus = "Mplus",
          replace.out = c("always", "never", "modified"), check = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a matrix or data frame. Note that all variable names must
be no longer than 8 character.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ind</code></td>
<td>
<p>a character vector indicating the variables names of the
latent class indicators in <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>a character string indicating the variable type of the
latent class indicators, i.e., <code>"continuous"</code> (default)
for continuous variables, <code>"count"</code> for count variables,
<code>"categorical"</code> for binary or ordered categorical
variables, and <code>"nominal"</code> for unordered categorical
variables. Note that it is not possible to mix different
variable types in the analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>a character string indicating the cluster variable in
the matrix or data frame specified in <code>x</code> representing
the nested grouping structure for computing cluster-robust
standard errors. Note that specifying a cluster variables
does not have any effect on the information criteria,
but on the Vuong-Lo-Mendell-Rubin likelihood ratio test
of model fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>folder</code></td>
<td>
<p>a character vector with six character strings for specifying
the names of the six folder representing different
variance-covariance structures for conducting LCA with
continuous indicator variables. There is only one folder
for LCA with all other variable types which is called
<code>"LCA_1-x_Classes"</code> with <code>x</code> being the maximum number of classes
specified in the argument <code>classes</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>a character string naming the Mplus data file with or
without the file extension '.dat', e.g., <code>"Data_LCA.dat"</code>
(default) or <code>"Data_LCA"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>write</code></td>
<td>
<p>a character string or character vector indicating whether
to create the six folders specified in the argument
<code>folder</code> (<code>"folder"</code>), to write the matrix or
data frame specified in <code>x</code> into a Mplus data file
(<code>"data"</code>), and write the Mplus input files into
the six folders specified in the argument <code>folder</code>
(<code>"input"</code>). By default, the function creates the
folders, writes the Mplus data file, and writes the Mplus
input files into the folders.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useobservations</code></td>
<td>
<p>a character string indicating the conditional statement
to select observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missing</code></td>
<td>
<p>a numeric value or character string representing missing
values (<code>NA</code>) in the Mplus data set. This values
or character string will be specified in the Mplus input
file as <code>MISSING IS ALL(missing)</code>. By default,
<code>-99</code> is used to represent missing values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>classes</code></td>
<td>
<p>an integer value specifying the maximum number of classes
for the latent class analysis. By default, LCA with
a maximum of 6 classes is specified (i.e., <em>k</em> = 1
to <em>k</em> = 6).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimator</code></td>
<td>
<p>a character string for specifying the <code>ESTIMATOR</code>
option in Mplus. By default, the estimator <code>"MLR"</code>
is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>starts</code></td>
<td>
<p>a vector with two integer values for specifying the
<code>STARTS</code> option in Mplus. The first number represents
the number of random sets of starting values to generate
in the initial stage and the second number represents the
optimizations to use in the final stage. By default, 500
random sets of starting values are generated and 100
optimizations are carried out in the final stage.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stiterations</code></td>
<td>
<p>an integer value specifying the <code>STITERATIONS</code> option
in Mplus. The numeric value represents the maximum number
of iterations allowed in the initial stage. By default,
50 iterations are requested.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lrtbootstrap</code></td>
<td>
<p>an integer value for specifying the <code>LRTBOOTSTRAP</code>
option in Mplus when requesting a parametric bootstrapped
likelihood ratio test (i.e., <code>output = "TECH14"</code>).
The value represents the number of bootstrap draws to
be used in estimating the <em>p</em>-value of the parametric
bootstrapped likelihood ratio test. By default, 1000
bootstrap draws are requested.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lrtstarts</code></td>
<td>
<p>a vector with four integer values for specifying the
<code>LRTSTARTS</code> option in Mplus when requesting a
parametric bootstrapped likelihood ratio test (i.e.,
<code>output = "TECH14"</code>). The values specify the number
of starting values to use in the initial stage and the
number of optimizations to use in the final stage for
the <code>k - 1</code> and <code>k</code> classes model when the
data generated by bootstrap draws are analyzed. By default,
0 random sets of starting values in the initial stage
and 0 optimizations in the final stage are used for the
<code>k - 1</code> classes model and 100 random sets of starting
values in the initial stage and 50 optimizations in the
final stage are used for the <code>k</code> class model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>processors</code></td>
<td>
<p>a vector of one or two integer values for specifying the
<code>PROCESSORS</code> option in Mplus. The values specifies
the number of processors and threads to be used for
parallel computing to increase computational speed. By
default, 8 processors and threads are used for parallel
computing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>a character string or character vector specifying the
<code>TECH</code> options in the <code>OUTPUT</code> section in Mplus,
i.e., <code>SVALUES</code> to request input statements that
contain parameter estimates from the analysis, <code>CINTERVAL</code>
to request confidence intervals, <code>TECH7</code> to request
sample statistics for each class using raw data weighted
by the estimated posterior probabilities for each class,
<code>TECH8</code> to request the optimization history in
estimating the model, <code>TECH11</code> to request the
Lo-Mendell-Rubin likelihood ratio test of model fit,
and <code>TECH14</code> to request a parametric bootstrapped
likelihood ratio test. By default, <code>SVALUES</code> and
<code>TECH11</code> are requested. Note that <code>TECH11</code>
is only available for the <code>MLR</code> estimator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replace.inp</code></td>
<td>
<p>logical: if <code>TRUE</code>, all existing input files in the
folder specified in the argument <code>folder</code> are replaced.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mplus.run</code></td>
<td>
<p>logical: if <code>TRUE</code>, all models in the folders specified
in the argument <code>folder</code> are estimated by using the
<code>mplus.run</code> function in the R package <code>misty</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mplus</code></td>
<td>
<p>a character string for specifying the name or path of
the Mplus executable to be used for running models. This
covers situations where Mplus is not in the system's path,
or where one wants to test different versions of the Mplus
program. Note that there is no need to specify this argument
for most users since it has intelligent defaults.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replace.out</code></td>
<td>
<p>a character string for specifying three settings, i.e.,
<code>"always"</code> to run all models regardless of whether
an output file for the model exists, <code>"never"</code>
to not run any model that has an existing output file,
and <code>"modified"</code> (default) to only runs a model if the
modified date for the input file is more recent than
the output file modified date.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), argument specification is checked.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Latent class analysis (LCA) is a model-based clustering and classification
method used to identify qualitatively different classes of observations which
are unknown and must be inferred from the data. LCA can accommodate continuous,
count, binary, ordered categorical, and unordered categorical indicators. LCA
with continuous indicator variables are also known as latent profile analysis
(LPA). In LPA, the within-profile variance-covariance structures represent
different assumptions regarding the variance and covariance of the indicator
variables both within and between latent profiles. As the best within-profile
variance-covariance structure is not known a priori, all of the different
structures must be investigated to identify the best model (Masyn, 2013). This
function specifies six different variance-covariance structures labeled A to F
(see Table 1 in Patterer et al, 2023):
</p>

<dl>
<dt><strong>Model A</strong></dt>
<dd>
<p>The within-profile variance is constrained to be
profile-invariant and covariances are constrained to be 0 in all profiles
(i.e., equal variances across profiles and no covariances among indicator
variables). This is the default setting in Mplus.</p>
</dd>
<dt><strong>Model B</strong></dt>
<dd>
<p>The within-profile variance is profile-varying and
covariances are constrained to be 0 in all profiles (i.e., unequal variances
across profiles and no covariances among indicator variables).</p>
</dd>
<dt><strong>Model C</strong></dt>
<dd>
<p>The within-profile variance is constrained to be
profile-invariant and covariances are constrained to be equal in all profiles
(i.e., equal variances and covariances across profiles).</p>
</dd>
<dt><strong>Model D</strong></dt>
<dd>
<p>The within-profile variance is constrained to be
profile-invariant and covariances are profile-varying (i.e., equal variances
across profiles and unequal covariances across profiles).</p>
</dd>
<dt><strong>Model E</strong></dt>
<dd>
<p>The within-profile variances are profile-varying and
covariances are constrained to be equal in all profiles (i.e., unequal
variances across profiles and equal covariances across profiles).</p>
</dd>
<dt><strong>Model F</strong></dt>
<dd>
<p>The within-class variance and covariances are both
profile-varying (i.e., unequal variances and covariances across profiles).</p>
</dd>
</dl>
<h3>Value</h3>

<p>Returns an object of class <code>misty.object</code>, which is a list with following
entries:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>function call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>matrix or data frame specified in the argument x</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args</code></td>
<td>
<p>specification of function arguments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>result</code></td>
<td>
<p>list with six entries for each of the variance-covariance
structures and Mplus inputs based on different number
of profiles in case of continuous indicators or list of
Mplus inputs based on different number of classes in case
of count, ordered or unordered categorical indicators.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Takuya Yanagida <a href="mailto:takuya.yanagida@univie.ac.at">takuya.yanagida@univie.ac.at</a>
</p>


<h3>References</h3>

<p>Masyn, K. E. (2013). Latent class analysis and finite mixture modeling. In T. D.
Little (Ed.), <em>The Oxford handbook of quantitative methods: Statistical analysis</em>
(pp. 551–611). Oxford University Press.
</p>
<p>Muthen, L. K., &amp; Muthen, B. O. (1998-2017). <em>Mplus User's Guide</em> (8th ed.).
Muthen &amp; Muthen.
</p>
<p>Patterer, A. S., Yanagida, T., Kühnel, J., &amp; Korunka, C. (2023). Daily receiving
and providing of social support at work: Identifying support exchange patterns
in hierarchical data. <em>Journal of Work and Organizational Psychology, 32</em>(4),
489-505. https://doi.org/10.1080/1359432X.2023.2177537
</p>


<h3>See Also</h3>

<p><code>read.mplus</code>, <code>write.mplus</code>, <code>mplus</code>,
<code>mplus.update</code>, <code>mplus.print</code>, <code>mplus.plot</code>,
<code>mplus.bayes</code>, <code>mplus.run</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Load data set "HolzingerSwineford1939" in the lavaan package
data("HolzingerSwineford1939", package = "lavaan")

#-------------------------------------------------------------------------------
# Example 1: LCA with k = 1 to k = 8 profiles, continuous indicators
# Input statements that contain parameter estimates
# Vuong-Lo-Mendell-Rubin LRT and bootstrapped LRT
mplus.lca(HolzingerSwineford1939, ind = c("x1", "x2", "x3", "x4"),
          classes = 8, output = c("SVALUES", "TECH11", "TECH14"))

#-------------------------------------------------------------------------------
# Example 22: LCA with k = 1 to k = 6 profiles, ordered categorical indicators
# Select observations with ageyr &lt;= 13
# Estimate all models in Mplus
mplus.lca(round(HolzingerSwineford1939[, -5]), ind = c("x1", "x2", "x3", "x4"),
          type = "categorical", useobservations = "ageyr &lt;= 13",
          mplus.run = TRUE)

## End(Not run)
</code></pre>


</div>