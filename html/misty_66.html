<div class="container">

<table style="width: 100%;"><tr>
<td>mplus.plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot Mplus GH5 File</h2>

<h3>Description</h3>

<p>This function uses the <code>h5file</code> function in the <span class="pkg">hdf5r</span> package to
read a Mplus GH5 file that is requested by the command <code>PLOT: TYPE IS PLOT2</code>
in Mplus to display trace plots, posterior distribution plots, autocorrelation
plots, posterior predictive check plots based on the "bayesian_data" section, and
the loop plot based on the "loop_data" section of the Mplus GH5 file. By default,
the function displays trace plots if the "bayesian_data" section is available in
the Mplus GH5 File. Otherwise, the function plots the loop plot if the "loop_data"
section is available in the Mplus GH5 file.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mplus.plot(x, plot = c("none", "trace", "post", "auto", "ppc", "loop"),
           param = c("all", "on", "by", "with", "inter", "var", "r2", "new"),
           std = c("all", "none", "stdyx", "stdy", "std"), burnin = TRUE,
           point = c("all", "none", "m", "med", "map"),
           ci = c("none", "eti", "hdi"), chain = 1, conf.level = 0.95,
           hist = TRUE, density = TRUE, area = TRUE, alpha = 0.4,
           fill = "gray85", nrow = NULL, ncol = NULL,
           scales = c("fixed", "free", "free_x", "free_y"),
           xlab = NULL, ylab = NULL, xlim = NULL, ylim = NULL,
           xbreaks = ggplot2::waiver(), ybreaks = ggplot2::waiver(),
           xexpand = ggplot2::waiver(), yexpand = ggplot2::waiver(),
           palette = "Set 2", binwidth = NULL, bins = NULL,
           density.col = "#0072B2", shape = 21,
           point.col = c("#CC79A7", "#D55E00", "#009E73"),
           linewidth = 0.6, linetype = "dashed", line.col = "black",
           bar.col = "black", bar.width = 0.8, plot.margin = NULL,
           legend.title.size = 10, legend.text.size = 10, legend.box.margin = NULL,
           saveplot = c("all", "none", "trace", "post", "auto", "ppc", "loop"),
           file = "Mplus_Plot.pdf",
           file.plot = c("_TRACE", "_POST", "_AUTO", "_PPC", "_LOOP"),
           width = NA, height = NA, units = c("in", "cm", "mm", "px"),
           dpi = 600, check = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a character string indicating the name of the Mplus
GH5 file (HDF5 format) with or without the file
extension <code>.gh5</code>, e.g., <code>"Mplus_Plot.gh5"</code>
or <code>"Mplus_Plot"</code>. Alternatively, a <code>misty.object</code>
of type <code>mplus</code> can be specified, i.e., result
object of the <code>mplus.plot()</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>a character string indicating the type of plot to
display, i.e., <code>"none"</code> for not displaying any
plot, <code>"trace"</code> (default) for displaying trace
plots, <code>post</code> for displaying posterior distribution
plots, <code>"auto"</code> for displaying autocorrelation
plots, <code>"ppc"</code> for displaying posterior predictive
check plots, and <code>"loop"</code> for displaying the
loop plot. The default setting is <code>"trace"</code> if
the "bayesian_data" section is available in the Mplus
GH5 file. Otherwise, the default setting switches to
<code>"loop"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>character vector indicating which parameters to print
for the trace plots, posterior distribution plots,
and autocorrelation plots, i.e., <code>"all"</code> for all
parameters, <code>"on"</code> (default), for regression
slopes, <code>"by"</code> for factor loadings, <code>"with"</code>
for covariances, <code>"inter"</code> for intercepts and
thresholds, <code>"var"</code> for (residual) variances,
<code>"r2"</code> for r-square, and <code>"new"</code> for
parameters not in the analysis model specified in the
<code>NEW</code> option. The default setting is <code>"on"</code>
if regression slopes are available. Otherwise, the
default setting switches to <code>"by"</code> and to
<code>"with"</code> if factor loadings are not available.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>std</code></td>
<td>
<p>a character vector indicating the standardized
parameters to print for the trace plots, posterior
distribution plots, and autocorrelation plots, i.e.,
<code>"all"</code> for all standardized parameters,
<code>"none"</code> (default) for not printing any
standardized parameters, <code>"stdyx"</code> for StdYX
standardized parameters, <code>"stdy"</code> for StdY
standardized parameters, and <code>"std"</code> for StdX
standardized parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>logical: if <code>FALSE</code>, the first half of each chain
is discarded as being part of the burnin phase when
displaying trace plots. The default setting for
<code>plot = "trace"</code> is <code>TRUE</code>. Note that the
first half of each chain is always discarded when
displaying posterior distribution plots (<code>plot = "post"</code>) regardless
of the setting of the argument <code>burnin</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>point</code></td>
<td>
<p>a character vector indicating the point estimate(s)
to be displayed in the posterior distribution plots,
i.e., <code>"all"</code> for all point estimates, <code>"none"</code>
for not displaying any point estimates, <code>"m"</code>
for the posterior mean estimate, <code>"med"</code> (default)
for the posterior median estimate, and <code>"map"</code>
for the maximum a posteriori estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>a character string indicating the type of credible
interval to be displayed in the posterior distribution
plots, i.e., <code>"none"</code> for not displaying any
credible intervals, <code>"eti"</code> (default) for displaying
the equal-tailed intervals and <code>"hdi"</code> for displaying
the highest density interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chain</code></td>
<td>
<p>a numerical value indicating the chain to be used for
the autocorrelation plots. By default, the first
chain is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>a numeric value between 0 and 1 indicating the
confidence level of the credible interval (default is
<code>0.95</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hist</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), histograms are
drawn in the posterior probability plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), density curves are
drawn in the posterior probability plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>area</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), statistical not
significant and statistical significant area is
filled with a different color and vertical lines are
drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>a numeric value between 0 and 1 for the <code>alpha</code>
argument (default is <code>0.4</code>) for the <code>annotate</code>,
<code>geom_histogram</code>, <code>geom_bar</code>, and
<code>geom_ribbon</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill</code></td>
<td>
<p>a character string indicating the color for the
<code>"fill"</code> argument (default is <code>"gray85"</code>)
for the <code>annotate</code>, <code>geom_histogram</code>,
<code>geom_bar</code>, and <code>geom_point</code> functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrow</code></td>
<td>
<p>a numeric value indicating the <code>nrow</code> argument
(default is <code>NULL</code>) for the <code>facet_wrap</code>
function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncol</code></td>
<td>
<p>a numeric value indicating the <code>ncol</code> argument
(default is <code>2</code>) for the <code>facet_wrap</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scales</code></td>
<td>
<p>a character string indicating the <code>scales</code> argument
(default is <code>"free"</code>) for the <code>facet_wrap</code>
function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>a character string indicating the <code>name</code> argument
for the <code>scale_x_continuous</code> function. Note that
the default setting depends on the type of plot,
e.g., <code>""</code> for the trace plots and <code>"Lag"</code>
for the autocorrelation plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>a character string indicating the <code>name</code> argument
for the <code>scale_y_continuous</code> function. Note that
the default setting depends on the type of plot,
e.g., <code>""</code> for the trace plots and <code>"Autocorrelation"</code>
for the autocorrelation plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>a numeric vector with two elements indicating the
<code>limits</code> argument (default it <code>NULL</code>) for
the <code>scale_x_continuous</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>a numeric vector with two elements indicating the
<code>limits</code> argument (default it <code>NULL</code>) for
the <code>scale_y_continuous</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xbreaks</code></td>
<td>
<p>a numeric vector indicating the <code>breaks</code> argument
(default is <code>ggplot2::waiver()</code>) for the
<code>scale_x_continuous</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ybreaks</code></td>
<td>
<p>a numeric vector indicating the <code>breaks</code> argument
(default is <code>ggplot2::waiver()</code>) for the
<code>scale_y_continuous</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xexpand</code></td>
<td>
<p>a numeric vector with two elements indicating the
<code>expand</code> argument (default is <code>(0.02, 0)</code>)
for the <code>scale_x_continuous</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yexpand</code></td>
<td>
<p>a numeric vector with two elements indicating the
<code>expand</code> argument for the <code>scale_y_continuous</code>
function. Note that the default setting depends
on the type of plot, e.g., <code>(0.02, 0)</code> for the
trace plots and <code>expansion(mult = c(0, 0.05))</code>
for the posterior distribution plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>palette</code></td>
<td>
<p>a character string indicating the palette name (default
is <code>"Set 2"</code>) for the <code>hcl.colors</code> function.
Note that the character string must be one of
<code>hcl.pals()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binwidth</code></td>
<td>
<p>a numeric value indicating the <code>binwidth</code> argument
(default is to use the number of bins in <code>bins</code>
argument) for the <code>geom_histogram</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bins</code></td>
<td>
<p>a numeric value indicating the <code>bins</code> argument
(default is <code>30</code>) for the <code>geom_histogram</code>
function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density.col</code></td>
<td>
<p>a character string indicating the <code>color</code> argument
(default is <code>"#0072B2"</code>) for the <code>geom_density</code>
function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape</code></td>
<td>
<p>a numeric value indicating the <code>shape</code> argument
(default is <code>21</code>) for the <code>geom_point</code>
function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>point.col</code></td>
<td>
<p>a character vector with three elements indicating the
<code>values</code> argument (default is
<code>c("#CC79A7", "#D55E00", "#009E73")</code>) for the
<code>scale_color_manual</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linewidth</code></td>
<td>
<p>a numeric value indicating the <code>linewidth</code> argument
(default is <code>0.6</code>) for the <code>geom_vline</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linetype</code></td>
<td>
<p>a numeric value indicating the <code>linetype</code> argument
(default is <code>"dashed"</code>) for the <code>geom_vline</code>
function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line.col</code></td>
<td>
<p>a character string indicating the <code>color</code> argument
(default is <code>"black"</code>) for the <code>geom_vline</code>
function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bar.col</code></td>
<td>
<p>a character string indicating the <code>color</code> argument
(default is <code>"black"</code>) for the <code>geom_bar</code>
function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bar.width</code></td>
<td>
<p>a character string indicating the <code>width</code> argument
(default = <code>0.8</code>)for the <code>geom_bar</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.margin</code></td>
<td>
<p>a numeric vector indicating the <code>plot.margin</code>
argument for the <code>theme</code> function. Note that the
default setting depends on the type of the plot, e.g.,
<code>c(4, 15, -10, 0)</code> for the trace plots, and
<code>c(4, 15, 4, 4)</code> for the autocorrelation plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.title.size</code></td>
<td>
<p>a numeric value indicating the <code>legend.title</code>
argument (default is <code>element_text(size = 10)</code>)
for the <code>theme</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.text.size</code></td>
<td>
<p>a numeric value indicating the <code>legend.text</code>
argument (default is <code>element_text(size = 10)</code>)
for the <code>theme</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.box.margin</code></td>
<td>
<p>a numeric vector indicating the <code>legend.box.margin</code>
argument for the <code>theme</code> function. Note that the
default setting depends on the type of plot, e.g.,
<code>c(-16, 6, 6, 6)</code> for the trace plots, and
<code>c(-25, 6, 6, 6)</code> for the posterior distribution
plots with displaying point estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>saveplot</code></td>
<td>
<p>a character vector indicating the plot to be saved,
i.e., <code>"all"</code> for saving all plots, <code>"none"</code>
(default) for not saving any plots, <code>"trace"</code>
for saving the trace plots, <code>post</code> for the saving
the posterior distribution plots, <code>"auto"</code> for
saving the autocorrelation plots, <code>"ppc"</code> for
saving the posterior predictive check plots, and
<code>"loop"</code> for saving the loop plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>a character string indicating the <code>filename</code>
argument (default is <code>"Mplus_Plot.pdf"</code>) including
the file extension for the <code>ggsave</code> function.
Note that one of <code>".eps"</code>, <code>".ps"</code>,
<code>".tex"</code>, <code>".pdf"</code> (default), <code>".jpeg"</code>,
<code>".tiff"</code>, <code>".png"</code>, <code>".bmp"</code>,
<code>".svg"</code> or <code>".wmf"</code> needs to be specified
as file extension in the <code>file</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file.plot</code></td>
<td>
<p>a character vector with five elements for distinguishing
different types of plots. By default, the character
string specified in the argument <code>"file"</code>
(<code>"Mplus_Plot"</code>) is concatenated with <code>"_TRACE"</code>
(<code>"Mplus_Plot_TRACE"</code>) for the trace plots,
<code>"_POST"</code> (<code>"Mplus_Plot_POST"</code>) for
the posterior distribution plots, <code>"_AUTO"</code>
(<code>"Mplus_Plot_AUTO"</code>) for the autocorrelation
plots, <code>"_PPC"</code> (<code>"Mplus_Plot_PPC"</code>) for the
posterior predictive check plots, and <code>"_LOOP"</code>
(<code>"Mplus_Plot_LOOP"</code>) for the loop plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>a numeric value indicating the <code>width</code> argument
(default is the size of the current graphics device)
for the <code>ggsave</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>height</code></td>
<td>
<p>a numeric value indicating the <code>height</code> argument
(default is the size of the current graphics device)
for the <code>ggsave</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>units</code></td>
<td>
<p>a character string indicating the <code>units</code>
argument (default is <code>in</code>) for the <code>ggsave</code>
function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dpi</code></td>
<td>
<p>a numeric value indicating the <code>dpi</code> argument
(default is <code>600</code>) for the <code>ggsave</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), argument
specification is checked.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns an object of class <code>misty.object</code>, which is a list with following
entries:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>function call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Mplus GH5 file</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args</code></td>
<td>
<p>specification of function arguments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>list with posterior distribution of each parameter estimate
in wide and long format (<code>post</code>), autocorrelation for
each parameter estimate in wide and long format (<code>auto</code>),
data for the posterior predictive check (<code>ppc</code>),
and data for the loop plot (<code>loop</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>list with the trace plots (<code>trace</code>, posterior distribution
plots (<code>post</code>), autocorrelation plots (<code>auto</code>),
posterior predictive check plots (<code>ppc</code>), and
loop plot (<code>loop</code>)</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Takuya Yanagida
</p>


<h3>References</h3>

<p>Muthen, L. K., &amp; Muthen, B. O. (1998-2017). <em>Mplus User's Guide</em> (8th ed.).
Muthen &amp; Muthen.
</p>


<h3>See Also</h3>

<p><code>read.mplus</code>, <code>write.mplus</code>, <code>mplus</code>,
<code>mplus.update</code>, <code>mplus.print</code>, <code>mplus.bayes</code>,
<code>mplus.run</code>, <code>mplus.lca</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
#----------------------------------------------------------------------------
# Mplus Example 3.18: Moderated Mediation with a Plot of the Indirect Effect

#..........
# Trace Plots

# Example 1a: Default setting
mplus.plot("ex3.18.gh5")

# Example 1b: Exclude first half of each chain
mplus.plot("ex3.18.gh5", burnin = FALSE)

# Example 1c: Print all parameters
mplus.plot("ex3.18.gh5", param = "all")

# Example 1d: Print user-specified parameters
mplus.plot("ex3.18.gh5", param = "param")

# Example 1e: Arrange panels in three columns
mplus.plot("ex3.18.gh5", ncol = 3)

# Example 1f: Specify "Pastel 1" palette for the hcl.colors function
mplus.plot("ex3.18.gh5", palette = "Pastel 1")

#..........
# Posterior Distribution Plots

# Example 2a: Default setting, i.e., posterior median and equal-tailed interval
mplus.plot("ex3.18.gh5", plot = "post")

# Example 2b: Display posterior mean and maximum a posteriori
mplus.plot("ex3.18.gh5", plot = "post", point = c("m", "map"))

# Example 2c: Display maximum a posteriori and highest density interval
mplus.plot("ex3.18.gh5", plot = "post", point = "map", ci = "hdi")

# Example 2d: Do not display any point estimates and credible interval
mplus.plot("ex3.18.gh5", plot = "post", point = "none", ci = "none")

# Example 2d: Do not display histograms
mplus.plot("ex3.18.gh5", plot = "post", hist = FALSE)

#..........
# Autocorrelation Plots

# Example 3a: Default setting, i.e., first chain
mplus.plot("ex3.18.gh5", plot = "auto")

# Example 3b: Use second chain
mplus.plot("ex3.18.gh5", plot = "auto", chain = 2)

# Example 3b: Modify limits and breaks of the y-axis
mplus.plot("ex3.18.gh5", plot = "auto",
           ylim = c(-0.05, 0.05), ybreaks = seq(-0.1, 0.1, by = 0.025))

#..........
# Posterior Predictive Check Plots

# Example 4a: Default setting, i.e., 95% Interval
mplus.plot("ex3.18.gh5", plot = "ppc")

# Example 4b: Default setting, i.e., 99% Interval
mplus.plot("ex3.18.gh5", plot = "ppc", conf.level = 0.99)

#..........
# Loop Plot

# Example 5a: Default setting
mplus.plot("ex3.18.gh5", plot = "loop")

# Example 5b: Do not fill area and draw vertical lines
mplus.plot("ex3.18.gh5", plot = "loop", area = FALSE)

#..........
# Save Plots

# Example 6a: Save all plots in pdf format
mplus.plot("ex3.18.gh5", saveplot = "all")

# Example 6b: Save all plots in png format with 300 dpi
mplus.plot("ex3.18.gh5", saveplot = "all", file = "Mplus_Plot.png", dpi = 300)

# Example 6a: Save loop plot, specify width and height of the plot
mplus.plot("ex3.18.gh5", plot = "none", saveplot = "loop",
           width = 7.5, height = 7)

#----------------------------------------------------------------------------
# Plot from misty.object

# Create misty.object
object &lt;- mplus.plot("ex3.18.gh5", plot = "none")

# Trace plot
mplus.plot(object, plot = "trace")

# Posterior distribution plot
mplus.plot(object, plot = "post")

# Autocorrelation plot
mplus.plot(object, plot = "auto")

# Posterior predictive check plot
mplus.plot(object, plot = "ppc")

# Loop plot
mplus.plot(object, plot = "loop")

#----------------------------------------------------------------------------
# Create Plots Manually

# Load ggplot2 package
library(ggplot2)

# Create misty object
object &lt;- mplus.plot("ex3.18.gh5", plot = "none")

#..........
# Example 7: Trace Plots

# Extract data in long format
data.post &lt;- object$data$post$long

# Extract ON parameters
data.trace &lt;- data.post[grep(" ON ", data.post$param), ]

# Plot
ggplot(data.trace, aes(x = iter, y = value, color = chain)) +
  annotate("rect", xmin = 0, xmax = 15000, ymin = -Inf, ymax = Inf,
           alpha = 0.4, fill = "gray85") +
  geom_line() +
  facet_wrap(~ param, ncol = 2, scales = "free") +
  scale_x_continuous(name = "", expand = c(0.02, 0)) +
  scale_y_continuous(name = "", expand = c(0.02, 0)) +
  scale_colour_manual(name = "Chain",
                      values = hcl.colors(n = 2, palette = "Set 2")) +
  theme_bw() +
  guides(color = guide_legend(nrow = 1, byrow = TRUE)) +
  theme(plot.margin = margin(c(4, 15, -10, 0)),
        legend.position = "bottom",
        legend.title = element_text(size = 10),
        legend.text = element_text(size = 10),
        legend.box.margin = margin(c(-16, 6, 6, 6)),
        legend.background = element_rect(fill = "transparent"))

#..........
# Example 8: Posterior Distribution Plots

# Extract data in long format
data.post &lt;- object$data$post$long

# Extract ON parameters
data.post &lt;- data.post[grep(" ON ", data.post$param), ]

# Discard burn-in iterations
data.post &lt;- data.post[data.post$iter &gt; 15000, ]

# Drop factor levels
data.post$param &lt;- droplevels(data.post$param,
                              exclude = c("[Y]", "[M]", "Y", "M", "INDIRECT", "MOD"))

# Plot
ggplot(data.post, aes(x = value)) +
  geom_histogram(aes(y = after_stat(density)), color = "black", alpha = 0.4,
                 fill = "gray85") +
  geom_density(color = "#0072B2") +
  geom_vline(data = data.frame(param = unique(data.post$param),
                               stat = tapply(data.post$value, data.post$param, median)),
             aes(xintercept = stat, color = "Median"), linewidth = 0.6) +
  geom_vline(data = data.frame(param = unique(data.post$param),
                               low = tapply(data.post$value, data.post$param,
                                            function(y) quantile(y, probs = 0.025))),
             aes(xintercept = low), linetype = "dashed", linewidth = 0.6) +
  geom_vline(data = data.frame(param = unique(data.post$param),
                               upp = tapply(data.post$value, data.post$param,
                                            function(y) quantile(y, probs = 0.975))),
             aes(xintercept = upp), linetype = "dashed", linewidth = 0.6) +
  facet_wrap(~ param, ncol = 2, scales = "free") +
  scale_x_continuous(name = "", expand = c(0.02, 0)) +
  scale_y_continuous(name = "Probability Density, f(x)",
                     expand = expansion(mult = c(0L, 0.05))) +
  scale_color_manual(name = "Point Estimate", values = c(Median = "#D55E00")) +
  labs(caption = "95% Equal-Tailed Interval") +
  theme_bw() +
  theme(plot.margin = margin(c(4, 15, -8, 4)),
        plot.caption = element_text(hjust = 0.5, vjust = 7),
        legend.position = "bottom",
        legend.title = element_text(size = 10),
        legend.text = element_text(size = 10),
        legend.box.margin = margin(c(-30, 6, 6, 6)),
        legend.background = element_rect(fill = "transparent"))

#..........
# Example 9: Autocorrelation Plots

# Extract data in long format
data.auto &lt;- object$data$auto$long

# Select first chain
data.auto &lt;- data.auto[data.auto$chain == 1, ]

# Extract ON parameters
data.auto &lt;- data.auto[grep(" ON ", data.auto$param), ]

# Plot
ggplot(data.auto, aes(x = lag, y = cor)) +
  geom_bar(stat = "identity", alpha = 0.4, color = "black", fill = "gray85",
           width = 0.8) +
  facet_wrap(~ param, ncol = 2) +
  scale_x_continuous(name = "Lag", breaks = seq(1, 30, by = 2), expand = c(0.02, 0)) +
  scale_y_continuous(name = "Autocorrelation", limits = c(-0.1, 0.1),
                     breaks = seq(-0.1, 1., by = 0.05), expand = c(0.02, 0)) +
  theme_bw() +
  theme(plot.margin = margin(c(4, 15, 4, 4)))

#..........
# Example 10: Posterior Predictive Check (PPC) Plots

# Extract data
data.ppc &lt;- object$data$ppc

# Scatter plot
ppc.scatter &lt;- ggplot(data.ppc, aes(x = obs, y = rep)) +
  geom_point(shape = 21, fill = "gray85") +
  geom_abline(slope = 1) +
  scale_x_continuous("Observed", limits = c(0, 45), breaks = seq(0, 45, by = 5),
                     expand = c(0.02, 0)) +
  scale_y_continuous("Recpliated", limits = c(0, 45), breaks = seq(0, 45, by = 5),
                     expand = c(0.02, 0)) +
  theme_bw() +
  theme(plot.margin = margin(c(2, 15, 4, 4)))

# Histogram
ppc.hist &lt;- ggplot(data.ppc, aes(x = diff)) +
  geom_histogram(color = "black", alpha = 0.4, fill = "gray85") +
  geom_vline(xintercept = mean(data.ppc$diff), color = "#CC79A7") +
  geom_vline(xintercept = quantile(data.ppc$diff, probs = 0.025),
             linetype = "dashed", color = "#CC79A7") +
  geom_vline(xintercept = quantile(data.ppc$diff, probs = 0.975),
             linetype = "dashed", color = "#CC79A7") +
  scale_x_continuous("Observed - Replicated", expand = c(0.02, 0)) +
  scale_y_continuous("Count", expand = expansion(mult = c(0L, 0.05))) +
  theme_bw() +
  theme(plot.margin = margin(c(2, 15, 4, 4)))

# Combine plots using the patchwork package
patchwork::wrap_plots(ppc.scatter, ppc.hist)

#..........
# Example 11: Loop Plot

# Extract data
data.loop &lt;- object$data$loop

# Plot
plot.loop &lt;- ggplot(data.loop, aes(x = xval, y = estimate)) +
  geom_line(linewidth = 0.6, show.legend = FALSE) +
  geom_line(aes(xval, low)) +
  geom_line(aes(xval, upp)) +
  scale_x_continuous("MOD", expand = c(0.02, 0)) +
  scale_y_continuous("INDIRECT", expand = c(0.02, 0)) +
  scale_fill_manual("Statistical Significance",
                    values = hcl.colors(n = 2, palette = "Set 2")) +
  theme_bw() +
  theme(plot.margin = margin(c(4, 15, -6, 4)),
        legend.position = "bottom",
        legend.title = element_text(size = 10),
        legend.text = element_text(size = 10),
        legend.box.margin = margin(-10, 6, 6, 6),
        legend.background = element_rect(fill = "transparent"))

# Significance area
for (i in unique(data.loop$group)) {

  plot.loop &lt;- plot.loop + geom_ribbon(data = data.loop[data.loop$group == i, ],
                                       aes(ymin = low, ymax = upp, fill = sig), alpha = 0.4)

}

# Vertical lines
plot.loop + geom_vline(data = data.loop[data.loop$change == 1, ],
                       aes(xintercept = xval, color = sig), linewidth = 0.6,
                           linetype = "dashed", show.legend = FALSE)

## End(Not run)
</code></pre>


</div>