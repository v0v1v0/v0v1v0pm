<div class="container">

<table style="width: 100%;"><tr>
<td>multilevel.descript</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multilevel Descriptive Statistics for Two-Level and Three-Level Data</h2>

<h3>Description</h3>

<p>This function computes descriptive statistics for two-level and three-level
multilevel data, e.g. average cluster size, variance components, intraclass
correlation coefficient, design effect, and effective sample size.
</p>


<h3>Usage</h3>

<pre><code class="language-R">multilevel.descript(..., data = NULL, cluster, type = c("1a", "1b"),
                    method = c("aov", "lme4", "nlme"),
                    print = c("all", "var", "sd"), REML = TRUE, digits = 2,
                    icc.digits = 3, as.na = NULL, write = NULL, append = TRUE,
                    check = TRUE, output = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>a numeric vector, matrix, or data frame. Alternatively, an
expression indicating the variable names in <code>data</code> e.g.,
<code>multilevel.descript(x1, x2, x3, data = dat, cluster = "cluster")</code>. Note that the operators <code>.</code>, <code>+</code>, <code>-</code>, <code>~</code>, <code>:</code>, <code>::</code>,
and <code>!</code> can also be used to select variables, see 'Details'
in the <code>df.subset</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame when specifying one or more variables in the
argument <code>...</code>. Note that the argument is <code>NULL</code>
when specifying a numeric vector, matrix, or data frame for
the argument <code>...</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>a character string indicating the name of the cluster
variable in <code>...</code> or <code>data</code> for two-level data,
a character vector indicating the names of the cluster
variables in <code>...</code> for three-level data, or a vector
or data frame representing the nested grouping structure
(i.e., group or cluster variables). Alternatively, a
character string or character vector indicating the variable
name(s) of the cluster variable(s) in <code>data</code>. Note that
the cluster variable at Level 3 come first in a three-level
model, i.e., <code>cluster = c("level3", "level2")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>a character string indicating the type of intraclass
correlation coefficient, i.e., <code>type = "1a"</code> (default)
for ICC(1) representing the proportion of variance at Level 2 and Level 3,
<code>type = "1b"</code> representing an estimate of the expected correlation
between two randomly chosen elements in the same group when specifying
a three-level model (i.e., two cluster variables). See 'Details' in the
<code>multilevel.icc</code> function for the formula used
in this function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string indicating the method used to estimate
intraclass correlation coefficients, i.e., <code>"aov"</code> ICC
estimated using the <code>aov</code> function, <code>"lme4"</code> (default)
ICC estimated using the <code>lmer</code> function in the <span class="pkg">lme4</span>
package, <code>"nlme"</code> ICC estimated using the <code>lme</code> function
in the <span class="pkg">nlme</span> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print</code></td>
<td>
<p>a character string or character vector indicating which results to
show on the console, i.e. <code>"all"</code> for variances and standard deviations,
<code>"var"</code> (default) for variances, or <code>"sd"</code> for standard deviations
within and between clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>REML</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), restricted maximum likelihood
is used to estimate the null model when using the <code>lmer()</code>
function in the <span class="pkg">lme4</span> package or the <code>lme()</code> function in
the <span class="pkg">nlme</span> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>an integer value indicating the number of decimal places to
be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>icc.digits</code></td>
<td>
<p>an integer indicating the number of decimal places to be used
for displaying intraclass correlation coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as.na</code></td>
<td>
<p>a numeric vector indicating user-defined missing values,
i.e. these values are converted to <code>NA</code> before conducting
the analysis. Note that <code>as.na()</code> function is only applied
to <code>...</code> but not to <code>cluster</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>write</code></td>
<td>
<p>a character string naming a file for writing the output into
either a text file with file extension <code>".txt"</code> (e.g.,
<code>"Output.txt"</code>) or Excel file with file extension
<code>".xlsx"</code>  (e.g., <code>"Output.xlsx"</code>). If the file
name does not contain any file extension, an Excel file will
be written.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>append</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), output will be appended
to an existing text file with extension <code>.txt</code> specified
in <code>write</code>, if <code>FALSE</code> existing text file will be
overwritten.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), argument specification is checked.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), output is shown on the console.</p>
</td>
</tr>
</table>
<h3>Details</h3>


<dl>
<dt><strong>Two-Level Model</strong></dt>
<dd>
<p>In a two-level model, the intraclass
correlation coefficients, design effect, and the effective sample size are
computed based on the random intercept-only model:
</p>
<p style="text-align: center;"><code class="reqn">Y_{ij} = \gamma_{00} + u_{0j} + r_{ij}</code>
</p>

<p>where the variance in <code class="reqn">Y</code> is decomposed into two independent components:
<code class="reqn">\sigma^2_{u_{0}}</code>, which represents the variance at Level 2, and
<code class="reqn">\sigma^2_{r}</code>, which represents the variance at Level 1 (Hox et al.,
2018). For the computation of the intraclass correlation coefficients, see
'Details' in the <code>multilevel.icc</code> function. The design effect
represents the effect of cluster sampling on the variance of parameter
estimation and is defined by the equation
</p>
<p style="text-align: center;"><code class="reqn">deff = (\frac{SE_{Cluster}}{SE_{Simple}})^2 = 1 + \rho(J - 1)</code>
</p>

<p>where <code class="reqn">SE_{Cluster}</code> is the standard error under cluster sampling,
<code class="reqn">SE_{Simple}</code> is the standard error under simple random sampling,
<code class="reqn">\rho</code> is the intraclass correlation coefficient, ICC(1), and
<code class="reqn">J</code> is the average cluster size. The effective sample size is defined
by the equation:
</p>
<p style="text-align: center;"><code class="reqn">N_{effective} = \frac{N{total}}{deff}</code>
</p>

<p>The effective sample size <code class="reqn">N_{effective}</code> represents the equivalent total
sample size that we should use in estimating the standard error (Snijders &amp;
Bosker, 2012).
</p>
</dd>
<dt><strong>Three-Level Model</strong></dt>
<dd>
<p>In a three-level model, the intraclass
correlation coefficients, design effect, and the effective sample size are
computed based on the random intercept-only model:
</p>
<p style="text-align: center;"><code class="reqn">Y_{ijk} = \gamma_{000} + v_{0k} + u_{0jk} + r_{ijk}</code>
</p>

<p>where the variance in <code class="reqn">Y</code> is decomposed into three independent components:
<code class="reqn">\sigma^2_{v_{0}}</code>, which represents the variance at Level 3,
<code class="reqn">\sigma^2_{u_{0}}</code>, which represents the variance at Level 2, and
<code class="reqn">\sigma^2_{r}</code>, which represents the variance at Level 1 (Hox et al., 2018).
For the computation of the intraclass correlation coefficients, see 'Details'
in the <code>multilevel.icc</code> function. The design effect
represents the effect of cluster sampling on the variance of parameter
estimation and is defined by the equation
</p>
<p style="text-align: center;"><code class="reqn">deff = (\frac{SE_{Cluster}}{SE_{Simple}})^2 = 1 + \rho_{L2}(J - 1) + \rho_{L3}(JK - 1)</code>
</p>

<p>where <code class="reqn">\rho_{L2}</code> is the ICC(1) at Level 2, <code class="reqn">\rho_{L3}</code> is the ICC(1) at Level 3,
<code class="reqn">J</code> is the average cluster size at Level 2, and <code class="reqn">K</code> is the average
cluster size at Level 3.</p>
</dd>
</dl>
<h3>Value</h3>

<p>Returns an object of class <code>misty.object</code>, which is a list with following
entries:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>function call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data frame specified in <code>...</code> including the cluster
variable(s) specified in <code>cluster</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args</code></td>
<td>
<p>specification of function arguments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.fit</code></td>
<td>
<p>fitted lavaan object (<code>mod.fit</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>result</code></td>
<td>
<p>list with result tables, i.e.,
<code>no.obs</code> for the number of observations,
<code>no.no.miss</code> for the number of missing value,
<code>no.cluster.l2</code> and <code>no.cluster.l3</code> for the number of clusters at Level 2 and/or Level 3,
<code>m.cluster.size.l2</code> and <code>m.cluster.size.l3</code> for the average cluster size at Level 2 and/or Level 3,
<code>sd.cluster.size.l2</code> and <code>sd.cluster.size.l3</code> for the standard deviation of the cluster size at Level 2 and/or Level 3,
<code>min.cluster.size.l2</code> <code>min.cluster.size.l3</code> for the minimum cluster size at Level 2 and/or Level 3,
<code>max.cluster.size.l2</code> <code>max.cluster.size.l3</code> for the maximum cluster size at Level 2 and/or Level 3,
<code>mean.x</code> for the intercept of the multilevel model,
<code>var.r</code> for the variance within clusters,
<code>var.u</code> for the variance between Level 2 clusters,
<code>var.b</code> for the variance between Level 3 clusters,
<code>icc1.l2</code> and <code>icc1.l3</code> for ICC(1) at Level 2 and/or Level 3,
<code>icc2.l2</code> and <code>icc2.l3</code> for ICC(2) at Level 2 and/or Level 3,
<code>deff</code> for the design effect,
<code>deff.sqrt</code> for the square root of the design effect,
<code>n.effect</code> for the effective sample size</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Takuya Yanagida <a href="mailto:takuya.yanagida@univie.ac.at">takuya.yanagida@univie.ac.at</a>
</p>


<h3>References</h3>

<p>Hox, J., Moerbeek, M., &amp; van de Schoot, R. (2018). <em>Multilevel analysis:
Techniques and applications</em> (3rd. ed.). Routledge.
</p>
<p>Snijders, T. A. B., &amp; Bosker, R. J. (2012). <em>Multilevel analysis: An
introduction to basic and advanced multilevel modeling</em> (2nd ed.). Sage Publishers.
</p>


<h3>See Also</h3>

<p><code>write.result</code>, <code>multilevel.icc</code>, <code>descript</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Load data set "Demo.twolevel" in the lavaan package
data("Demo.twolevel", package = "lavaan")

#----------------------------------------------------------------------------
# Two-Level Data

#..........
# Cluster variable specification

# Example 1a: Cluster variable 'cluster'
multilevel.descript(Demo.twolevel[, c("y1", "cluster")], cluster = "cluster")

# Example 1b: Cluster variable 'cluster' not in '...'
multilevel.descript(Demo.twolevel$y1, cluster = Demo.twolevel$cluster)

# Example 1c: Alternative specification using the 'data' argument
multilevel.descript(y1, data = Demo.twolevel, cluster = "cluster")

#---------------------------

# Example 2: Multilevel descriptive statistics for 'y1'
multilevel.descript(Demo.twolevel$y1, cluster = Demo.twolevel$cluster)

# Example 3: Multilevel descriptive statistics, print variance and standard deviation
multilevel.descript(Demo.twolevel$y1, cluster = Demo.twolevel$cluster, print = "all")

# Example 4: Multilevel descriptive statistics, print ICC with 5 digits
multilevel.descript(Demo.twolevel$y1, cluster = Demo.twolevel$cluster, icc.digits = 5)

# Example 5: Multilevel descriptive statistics
# use lme() function in the nlme package to estimate ICC
multilevel.descript(Demo.twolevel$y1, cluster = Demo.twolevel$cluster, method = "nlme")

# Example 6a: Multilevel descriptive statistics for 'y1', 'y2', 'y3', 'w1', and 'w2'
multilevel.descript(Demo.twolevel[, c("y1", "y2", "y3", "w1", "w2")],
                      cluster = Demo.twolevel$cluster)

# Example 6b: Alternative specification using the 'data' argument
multilevel.descript(y1:y3, w1, w2, data = Demo.twolevel, cluster = "cluster")

#----------------------------------------------------------------------------
# Three-Level Data

# Create arbitrary three-level data
Demo.threelevel &lt;- data.frame(Demo.twolevel, cluster2 = Demo.twolevel$cluster,
                                             cluster3 = rep(1:10, each = 250))

#..........
# Cluster variable specification

# Example 7a: Cluster variables 'cluster' in '...'
multilevel.descript(Demo.threelevel[, c("y1", "cluster3", "cluster2")],
                    cluster = c("cluster3", "cluster2"))

# Example 7b: Cluster variables 'cluster' not in '...'
multilevel.descript(Demo.threelevel$y1, cluster = Demo.threelevel[, c("cluster3", "cluster2")])

# Example 7c: Alternative specification using the 'data' argument
multilevel.descript(y1, data = Demo.threelevel, cluster = c("cluster3", "cluster2"))

#----------------------------------------------------------------------------

# Example 8: Multilevel descriptive statistics for 'y1', 'y2', 'y3', 'w1', and 'w2'
multilevel.descript(y1:y3, w1, w2, data = Demo.threelevel, cluster = c("cluster3", "cluster2"))

#----------------------------------------------------------------------------
# Write Results

# Example 9a: Write results into a Excel file
multilevel.descript(Demo.twolevel[, c("y1", "y2", "y3", "w1", "w2")],
                    cluster = Demo.twolevel$cluster, write = "Multilevel_Descript.txt")

# Example 9b: Write results into a Excel file
multilevel.descript(Demo.twolevel[, c("y1", "y2", "y3", "w1", "w2")],
                    cluster = Demo.twolevel$cluster, write = "Multilevel_Descript.xlsx")

result &lt;- multilevel.descript(Demo.twolevel[, c("y1", "y2", "y3", "w1", "w2")],
                              cluster = Demo.twolevel$cluster, output = FALSE)
write.result(result, "Multilevel_Descript.xlsx")

## End(Not run)
</code></pre>


</div>