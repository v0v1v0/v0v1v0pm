<div class="container">

<table style="width: 100%;"><tr>
<td>multilevel.omega</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multilevel Composite Reliability</h2>

<h3>Description</h3>

<p>This function computes point estimate and Monte Carlo confidence interval for
the multilevel composite reliability defined by Lai (2021) for a within-cluster
construct, shared cluster-level construct, and configural cluster construct by
calling the <code>cfa</code> function in the R package <span class="pkg">lavaan</span>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">multilevel.omega(..., data = NULL, cluster, rescov = NULL,
                 const = c("within", "shared", "config"),
                 fix.resid = NULL, optim.method = c("nlminb", "em"),
                 missing = c("listwise", "fiml"), nrep = 100000, seed = NULL,
                 conf.level = 0.95, print = c("all", "omega", "item"),
                 digits = 2, as.na = NULL, write = NULL, append = TRUE,
                 check = TRUE, output = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>a matrix or data frame. Multilevel confirmatory factor
analysis based on a measurement model with one factor
at the Within level and one factor at the Between level
comprising all variables in the matrix or data frame is
conducted. Note that the cluster variable specified in
<code>cluster</code> is excluded from <code>x</code> when specifying
the argument <code>cluster</code> using the variable name of the
cluster variable. Alternatively, an expression indicating
the variable names in <code>data</code> e.g.,
<code>multilevel.omega(x1, x2, x3, data = dat, cluster = "cluster")</code>.
Note that the operators
<code>.</code>, <code>+</code>, <code>-</code>, <code>~</code>, <code>:</code>, <code>::</code>,
and <code>!</code> can also be used to select variables, see 'Details'
in the <code>df.subset</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame when specifying one or more variables in the
argument <code>...</code>. Note that the argument is <code>NULL</code>
when specifying a matrix or data frame for the argument
<code>...</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>either a character string indicating the variable name of
the cluster variable in <code>...</code> or <code>data</code>, or a
vector representing the nested grouping structure (i.e.,
group or cluster variable).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rescov</code></td>
<td>
<p>a character vector or a list of character vectors for specifying
residual covariances at the Within level, e.g. <code>rescov = c("x1", "x2")</code>
for specifying a residual covariance between indicators <code>x1</code>
and <code>x2</code> at the Within level or <code>rescov = list(c("x1", "x2"), c("x3", "x4"))</code>
for specifying residual covariances between indicators <code>x1</code>
and <code>x2</code>, and indicators <code>x3</code> and <code>x4</code> at
the Within level. Note that residual covariances at the
Between level cannot be  specified using this function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>const</code></td>
<td>
<p>a character string indicating the type of construct(s), i.e.,
<code>"within"</code> for within-cluster constructs, <code>"shared"</code>
for shared cluster-level constructs, and <code>"config"</code>
(default) for configural cluster constructs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix.resid</code></td>
<td>
<p>a character vector for specifying residual variances to be
fixed at 0 at the Between level, e.g., <code>fix.resid = c("x1", "x3")</code>
to fix residual variances of indicators <code>x1</code> and <code>x2</code>
at the Between level at 0. Note that it is also possible
to specify <code>fix.resid = "all"</code> which fixes all residual
variances at the Between level at 0 in line with the strong
factorial measurement invariance assumption across cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim.method</code></td>
<td>
<p>a character string indicating the optimizer, i.e., <code>"nlminb"</code>
(default) for the unconstrained and bounds-constrained
quasi-Newton method optimizer and <code>"em"</code> for the
Expectation Maximization (EM) algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missing</code></td>
<td>
<p>a character string indicating how to deal with missing data,
i.e., <code>"listwise"</code> for listwise deletion or <code>"fiml"</code>
(default) for full information maximum likelihood (FIML)
method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrep</code></td>
<td>
<p>an integer value indicating the number of Monte Carlo
repetitions for computing confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>a numeric value specifying the seed of the random number
generator for computing the Monte Carlo confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>a numeric value between 0 and 1 indicating the confidence
level of the interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print</code></td>
<td>
<p>a character vector indicating which results to show, i.e.
<code>"all"</code> (default), for all results <code>"omega"</code> for
omega, and <code>"item"</code> for item statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>an integer value indicating the number of decimal places
to be used for displaying results. Note that loglikelihood,
information criteria and chi-square test statistic is
printed with <code>digits</code> minus 1 decimal places.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as.na</code></td>
<td>
<p>a numeric vector indicating user-defined missing values,
i.e. these values are converted to <code>NA</code> before conducting
the analysis. Note that <code>as.na()</code> function is only
applied to <code>x</code> but not to <code>cluster</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>write</code></td>
<td>
<p>a character string naming a file for writing the output into
either a text file with file extension <code>".txt"</code> (e.g.,
<code>"Output.txt"</code>) or Excel file with file extension
<code>".xlsx"</code>  (e.g., <code>"Output.xlsx"</code>). If the file
name does not contain any file extension, an Excel file will
be written.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>append</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), output will be appended
to an existing text file with extension <code>.txt</code> specified
in <code>write</code>, if <code>FALSE</code> existing text file will be
overwritten.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), argument specification, convergence
and model identification is checked.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), output is shown.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>function call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data frame specified in <code>x</code> including the group variable
specified in <code>cluster</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args</code></td>
<td>
<p>specification of function arguments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>specified model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.fit</code></td>
<td>
<p>fitted lavaan object (<code>mod.fit</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check</code></td>
<td>
<p>results of the convergence and model identification check</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>result</code></td>
<td>
<p>list with result tables, i.e., <code>omega</code> for the coefficient
omega including Monte Carlo confidence interval and
<code>itemstat</code> for descriptive statistics</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The function uses the functions <code>lavInspect</code>, <code>lavTech</code>, and <code>lavNames</code>,
provided in the R package <span class="pkg">lavaan</span> by Yves Rosseel (2012). The internal function
<code>.internal.mvrnorm</code> is a copy of the <code>mvrnorm</code> function in the package
<span class="pkg">MASS</span> by Venables and Ripley (2002).
</p>


<h3>Author(s)</h3>

<p>Takuya Yanagida <a href="mailto:takuya.yanagida@univie.ac.at">takuya.yanagida@univie.ac.at</a>
</p>


<h3>References</h3>

<p>Lai, M. H. C. (2021). Composite reliability of multilevel data: It’s about
observed scores and construct meanings. <em>Psychological Methods, 26</em>(1),
90–102. https://doi.org/10.1037/met0000287
</p>
<p>Rosseel, Y. (2012). lavaan: An R Package for Structural Equation Modeling.
<em>Journal of Statistical Software, 48</em>, 1-36. https://doi.org/10.18637/jss.v048.i02
</p>
<p>Venables, W. N., Ripley, B. D. (2002).<em>Modern Applied Statistics with S</em> (4th ed.).
Springer. https://www.stats.ox.ac.uk/pub/MASS4/.
</p>


<h3>See Also</h3>

<p><code>item.omega</code>, <code>multilevel.cfa</code>, <code>multilevel.fit</code>,
<code>multilevel.invar</code>, <code>multilevel.cor</code>,
<code>multilevel.descript</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Load data set "Demo.twolevel" in the lavaan package
data("Demo.twolevel", package = "lavaan")

#-------------------------------------------------------------------------------
# Cluster variable specification

# Example 1a: Cluster variable 'cluster' in 'x'
multilevel.omega(Demo.twolevel[,c("y1", "y2", "y3", "y4", "cluster")], cluster = "cluster")

# Example 1b: Cluster variable 'cluster' not in 'x'
multilevel.omega(Demo.twolevel[,c("y1", "y2", "y3", "y4")], cluster = Demo.twolevel$cluster)

# Example 1c: Alternative specification using the 'data' argument
multilevel.omega(y1:y4, data = Demo.twolevel, cluster = "cluster")

#-------------------------------------------------------------------------------
# Type of construct

# Example 2a: Within-Cluster Construct
multilevel.omega(Demo.twolevel[,c("y1", "y2", "y3", "y4")],
                 cluster = Demo.twolevel$cluster, const = "within")

# Example 2b: Shared Cluster-Level Construct
multilevel.omega(Demo.twolevel[,c("y1", "y2", "y3", "y4")],
                 cluster = Demo.twolevel$cluster, const = "shared")

# Example 2c: Configural Construct
multilevel.omega(Demo.twolevel[,c("y1", "y2", "y3", "y4")],
                 cluster = Demo.twolevel$cluster, const = "config")

#-------------------------------------------------------------------------------
# Residual covariance at the Within level and residual variance at the Between level

# Example 3a: Residual covariance between "y4" and "y5" at the Within level
multilevel.omega(Demo.twolevel[,c("y1", "y2", "y3", "y4")],
                 cluster = Demo.twolevel$cluster, const = "config",
                 rescov = c("y3", "y4"))

# Example 3b: Residual variances of 'y1' at the Between level fixed at 0
multilevel.omega(Demo.twolevel[,c("y1", "y2", "y3", "y4")],
                 cluster = Demo.twolevel$cluster, const = "config",
                 fix.resid = c("y1", "y2"), digits = 3)

#----------------------------------------------------------------------------
# Write results

# Example 4a: Write results into a text file
multilevel.omega(Demo.twolevel[,c("y1", "y2", "y3", "y4")],
                 cluster = Demo.twolevel$cluster, write = "Multilevel_Omega.txt")

# Example 4b: Write results into an Excel file
multilevel.omega(Demo.twolevel[,c("y1", "y2", "y3", "y4")],
                 cluster = Demo.twolevel$cluster, write = "Multilevel_Omega.xlsx")

# Example 4b: Assign results into an object and write results into an Excel file
mod &lt;- multilevel.omega(Demo.twolevel[,c("y1", "y2", "y3", "y4")],
                        cluster = Demo.twolevel$cluster, output = FALSE)

# Write results into an Excel file
write.result(mod, "Multilevel_Omega.xlsx")

## End(Not run)
</code></pre>


</div>