<div class="container">

<table style="width: 100%;"><tr>
<td>multilevel.r2.manual</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>R-Squared Measures for Multilevel and Linear Mixed Effects Models by Rights
and Sterba (2019), Manually Inputting Parameter Estimates</h2>

<h3>Description</h3>

<p>This function computes R-squared measures by Rights and Sterba (2019) for
multilevel and linear mixed effects models by manually inputting parameter
estimates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">multilevel.r2.manual(data, within = NULL, between = NULL, random = NULL,
                     gamma.w = NULL, gamma.b = NULL, tau, sigma2,
                     intercept = TRUE, center = TRUE, digits = 3,
                     plot = FALSE, gray = FALSE, start = 0.15, end = 0.85,
                     color = c("#D55E00", "#0072B2", "#CC79A7", "#009E73", "#E69F00"),
                     write = NULL, append = TRUE, check = TRUE, output = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a matrix or data frame with the level-1 and level-2 predictors
and outcome variable used in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>within</code></td>
<td>
<p>a character vector with the variable names in <code>data</code> or
numeric vector with numbers corresponding to the columns in
<code>data</code> of the level-1 predictors used in the model. If
none used, set to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>between</code></td>
<td>
<p>a character vector with the variable names in <code>data</code> or
numeric vector with numbers corresponding to the columns in
<code>data</code> of the level-2 predictors used in the model. If
none used, set to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random</code></td>
<td>
<p>a character vector with the variable names in <code>data</code> or
numeric vector with numbers corresponding to the columns in
<code>data</code> of the level-1 predictors that have random slopes
in the model. If no random slopes specified, set to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma.w</code></td>
<td>
<p>a numeric vector of fixed slope estimates for all level-1
predictors, to be entered in the order of the predictors
listed in the argument <code>within</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma.b</code></td>
<td>
<p>a numeric vector of the intercept and fixed slope estimates
for all level-2predictors, to be entered in the order of the
predictors listed in the argument <code>between</code>. Note that
the first element is the parameter estimate for the intercept
if <code>intercept = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>a matrix indicating the random effects covariance matrix, the
first row/column denotes the intercept variance and covariances
(if intercept is fixed, set all to 0) and each subsequent
row/column denotes a given random slope's variance and covariances
(to be entered in the order listed in the argument <code>random</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2</code></td>
<td>
<p>a numeric value indicating the level-1 residual variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), the first element in the
<code>gamma.b</code> is assumed to be the fixed intercept estimate;
if set to <code>FALSE</code>, the first element in the argument
<code>gamma.b</code> is assumed to be the first fixed level-2
predictor slope.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), all level-1 predictors are
assumed to be cluster-mean-centered and the function will
output all decompositions; if set to <code>FALSE</code>, function
will output only the total decomposition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>an integer value indicating the number of decimal places to be
used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical: if <code>TRUE</code>, bar chart showing the decomposition
of scaled total, within-cluster, and between-cluster outcome
variance into five (total), three (within-cluster), and two
(between-cluster) proportions is drawn. Note that the <span class="pkg">ggplot2</span>
package is required to draw the bar chart.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gray</code></td>
<td>
<p>logical: if <code>TRUE</code>, graphical parameter to draw the bar
chart in gray scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>a numeric value between 0 and 1, graphical parameter to specify
the gray value at the low end of the palette.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end</code></td>
<td>
<p>a numeric value between 0 and 1, graphical parameter to specify
the gray value at the high end of the palette.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color</code></td>
<td>
<p>a character vector, graphical parameter indicating the color
of bars in the bar chart in the following order: Fixed slopes
(Within), Fixed slopes (Between), Slope variation (Within),
Intercept variation (Between), and Residual (Within). By default,
colors from the colorblind-friendly palettes are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>write</code></td>
<td>
<p>a character string naming a text file with file extension
<code>".txt"</code> (e.g., <code>"Output.txt"</code>) for writing the
output into a text file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>append</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), output will be appended
to an existing text file with extension <code>.txt</code> specified
in <code>write</code>, if <code>FALSE</code> existing text file will be
overwritten.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), argument specification is checked.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), output is shown on the console.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A number of R-squared measures for multilevel and linear mixed effects models
have been developed in the methodological literature (see Rights &amp; Sterba, 2018).
R-squared measures by Rights and Sterba (2019) provide an integrative framework
of R-squared measures for multilevel and linear mixed effects models with random
intercepts and/or slopes. Their measures are based on partitioning model implied
variance from a single fitted model, but they provide a full partitioning of
the total outcome variance to one of five specific sources. See the help page
of the <code>multilevel.r2</code> function for more details.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>misty.object</code>, which is a list with following
entries:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>function call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>matrix or data frame specified in <code>data</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>ggplot2 object for plotting the results</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args</code></td>
<td>
<p>specification of function arguments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>result</code></td>
<td>
<p>list with result tables, i.e., <code>decomp</code> for the
decomposition, <code>total</code> for total R2 measures,
<code>within</code> for the within-cluster R2 measures, and
<code>between</code></p>
</td>
</tr>
</table>
<p> for the between-cluster R2 measures.
</p>


<h3>Note</h3>

<p>This function is based on a copy of the function <code>r2mlm_manual()</code> in the
<span class="pkg">r2mlm</span> package by Mairead Shaw, Jason Rights, Sonya Sterba, and Jessica
Flake.
</p>


<h3>Author(s)</h3>

<p>Jason D. Rights, Sonya K. Sterba, Jessica K. Flake, and Takuya Yanagida
</p>


<h3>References</h3>

<p>Rights, J. D., &amp; Cole, D. A. (2018). Effect size measures for multilevel models
in clinical child and adolescent research: New r-squared methods and recommendations.
<em>Journal of Clinical Child and Adolescent Psychology, 47</em>, 863-873.
https://doi.org/10.1080/15374416.2018.1528550
</p>
<p>Rights, J. D., &amp; Sterba, S. K. (2019). Quantifying explained variance in multilevel
models: An integrative framework for defining R-squared measures. <em>Psychological Methods, 24</em>,
309-338. https://doi.org/10.1037/met0000184
</p>


<h3>See Also</h3>

<p><code>multilevel.r2</code>, <code>multilevel.cor</code>,
<code>multilevel.descript</code>, <code>multilevel.icc</code>,
<code>multilevel.indirect</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Load misty, lme4, nlme, and ggplot2 package
library(misty)
library(lme4)

# Load data set "Demo.twolevel" in the lavaan package
data("Demo.twolevel", package = "lavaan")

#-------------------------------------------------------------------------------

# Cluster mean centering, center() from the misty package
Demo.twolevel$x2.c &lt;- center(Demo.twolevel$x2, type = "CWC",
                             cluster = Demo.twolevel$cluster)

# Compute group means, cluster.scores() from the misty package
Demo.twolevel$x2.b &lt;- cluster.scores(Demo.twolevel$x2,
                                     cluster = Demo.twolevel$cluster)

# Estimate random intercept model using the lme4 package
mod1 &lt;- lmer(y1 ~ x2.c + x2.b + w1 + (1| cluster), data = Demo.twolevel,
             REML = FALSE, control = lmerControl(optimizer = "bobyqa"))

# Estimate random intercept and slope model using the lme4 package
mod2 &lt;- lmer(y1 ~ x2.c + x2.b + w1 + (1 + x2.c | cluster), data = Demo.twolevel,
             REML = FALSE, control = lmerControl(optimizer = "bobyqa"))

#-------------------------------------------------------------------------------
# Example 1: Random intercept model

# Fixed slope estimates
fixef(mod1)

# Random effects variance-covariance matrix
as.data.frame(VarCorr(mod1))

# R-squared measures according to Rights and Sterba (2019)
multilevel.r2.manual(data = Demo.twolevel,
                     within = "x2.c", between = c("x2.b", "w1"),
                     gamma.w = 0.41127956,
                     gamma.b = c(0.01123245, -0.08269374, 0.17688507),
                     tau = 0.9297401,
                     sigma2 = 1.813245794)

#-------------------------------------------------------------------------------
# Example 2: Random intercept and slope model

# Fixed slope estimates
fixef(mod2)

# Random effects variance-covariance matrix
as.data.frame(VarCorr(mod2))

# R-squared measures according to Rights and Sterba (2019)
multilevel.r2.manual(data = Demo.twolevel,
                     within = "x2.c", between = c("x2.b", "w1"), random = "x2.c",
                     gamma.w = 0.41127956,
                     gamma.b = c(0.01123245, -0.08269374, 0.17688507),
                     tau = matrix(c(0.931008649, 0.004110479, 0.004110479, 0.017068857), ncol = 2),
                     sigma2 = 1.813245794)

## End(Not run)
</code></pre>


</div>