<div class="container">

<table style="width: 100%;"><tr>
<td>na.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Missing Completely at Random (MCAR) Test</h2>

<h3>Description</h3>

<p>This function performs Little's Missing Completely at Random (MCAR) test and
Jamshidian and Jalal's approach for testing the MCAR assumption. By default,
the function performs the Jamshidian and Jalal's
approach.
</p>


<h3>Usage</h3>

<pre><code class="language-R">na.test(..., data = NULL, print = c("all", "little", "jamjal"),
        impdat = NULL, delete = 6, method = c("npar", "normal"),
        m = 20, seed = 123, nrep = 10000, n.min = 30,
        pool = c("m", "med", "min", "max", "random"),
        alpha = 0.05, digits = 2, p.digits = 3, as.na = NULL,
        write = NULL, append = TRUE, check = TRUE, output = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>a matrix or data frame with incomplete data, where missing
values are coded as <code>NA</code>. Alternatively, an expression
indicating the variable names in <code>data</code> e.g.,
<code>na.test(x1, x2, x3, data = dat)</code>. Note that the operators
<code>.</code>, <code>+</code>, <code>-</code>, <code>~</code>, <code>:</code>, <code>::</code>,
and <code>!</code> can also be used to select variables, see 'Details'
in the <code>df.subset</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame when specifying one or more variables in the
argument <code>...</code>. Note that the argument is <code>NULL</code>
when specifying a matrix or data frame for the argument <code>...</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print</code></td>
<td>
<p>a character vector indicating which results to be printed on
the console, i.e. <code>"all"</code> for Little's MCAR test and Jamshidian and
Jalal's approach, <code>"little"</code> for Little's MCAR test, and <code>"jamjal"</code>
(default) for Jamshidian and Jalal's approach.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>impdat</code></td>
<td>
<p>an object of class <code>mids</code> from the <span class="pkg">mice</span> package to
provide a data set multiply imputed in the <span class="pkg">mice</span> package.
The function will not impute the data data set specified in
the argument <code>data</code> when specifying this argument and will
use the imputed data sets provided in the argument <code>impdat</code>
for performing the Jamshidian and Jalal's approach. Note that
the argument <code>data</code> still needs to be specified because
the variables used for the analysis are extracted from the
data frame specified in <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delete</code></td>
<td>
<p>an integer value indicating missing data patterns consisting
of <code>delete</code> number of cases or less removed from the
Jamshidian and Jalal's approach. The default setting is
<code>delete = 6</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string indicating the imputation method, i.e.,
<code>"npar"</code> for using a non-parametric imputation method
by Sirvastava and Dolatabadi (2009) or <code>"normal"</code> for
imputing missing data assuming that the data come from a
multivariate normal distribution (see Jamshidian &amp; Jalal, 2010).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>an integer value indicating the number of multiple imputations.
The default setting is <code>m = 20</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>an integer value that is used as argument by the <code>set.seed</code>
function for offsetting the random number generator before
performing Jamshidian and Jalal's approach. The default
setting is <code>seed = 123</code>. Set the value to <code>NULL</code> to
specify a system selected seed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrep</code></td>
<td>
<p>an integer value indicating the replications used to simulate
the Neyman distribution to determine the cut off value for the
Neyman test. Larger values increase the accuracy of the Neyman
test. The default setting is <code>nrep = 10000</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.min</code></td>
<td>
<p>an integer value indicating the minimum number of cases in a
group that triggers the use of asymptotic Chi-square distribution
in place of the empirical distribution in the Neyman test of
uniformity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pool</code></td>
<td>
<p>a character string indicating the pooling method, i.e.,
<code>"m"</code> for computing the average test statistic and p-values,
<code>"med"</code> for computing the median test statistic and p-values,
<code>"min"</code> for computing the maximum test statistic and minimum p-values,
<code>"max"</code> for computing the minimum test statistic and maximum p-values,
and <code>"random"</code> for randomly choosing a test statistic and
corresponding p-value from repeated complete data analyses.
The default setting is <code>pool = "med"</code>, i.e., median test
statistic and p-values are computed as suggested by
Eekhout, Wiel and Heymans (2017).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>a numeric value between 0 and 1 indicating the significance
level of the Hawkins test. The default setting is <code>alpha = 0.05</code>,
i.e., the Anderson-Darling non-parametric test is provided
when the p-value of the Hawkins test is less than or equal
<code>0.05</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>an integer value indicating the number of decimal places to
be used for displaying results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.digits</code></td>
<td>
<p>an integer value indicating the number of decimal places to be
used for displaying the <em>p</em>-value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as.na</code></td>
<td>
<p>a numeric vector indicating user-defined missing values, i.e.
these values are converted to NA before conducting the analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>write</code></td>
<td>
<p>a character string naming a text file with file extension
<code>".txt"</code> (e.g., <code>"Output.txt"</code>) for writing the
output into a text file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>append</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), output will be appended
to an existing text file with extension <code>.txt</code> specified
in <code>write</code>, if <code>FALSE</code> existing text file will be
overwritten.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), argument specification is checked.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), output is shown.</p>
</td>
</tr>
</table>
<h3>Details</h3>


<dl>
<dt><strong>Little's MCAR Test</strong></dt>
<dd>
<p>Little (1988) proposed a multivariate test of Missing Completely at Random
(MCAR) that tests for mean differences on every variable in the data set
across subgroups that share the same missing data pattern by comparing the
observed variable means for each pattern of missing data with the expected
population means estimated using the expectation-maximization (EM) algorithm
(i.e., EM maximum likelihood estimates). The test statistic is the sum of
the squared standardized differences between the subsample means and the
expected population means weighted by the estimated variance-covariance
matrix and the number of observations within each subgroup (Enders, 2010).
Under the null hypothesis that data are MCAR, the test statistic follows
asymptotically a chi-square distribution with <code class="reqn">\sum k_j - k</code> degrees of
freedom, where <code class="reqn">k_j</code> is the number of complete variables for missing data
pattern <code class="reqn">j</code>, and <code class="reqn">k</code> is the total number of variables. A statistically
significant result provides evidence against MCAR.
</p>
<p>Note that Little's MCAR test has a number of problems (see Enders, 2010).
</p>

<ul>
<li>
<p><strong>First</strong>, the test does not identify the specific variables
that violates MCAR, i.e., the test does not identify potential correlates
of missingness (i.e., auxiliary variables).
</p>
</li>
<li>
<p><strong>Second</strong>, the test is based on multivariate normality,
i.e., under departure from the normality assumption the test might be
unreliable unless the sample size is large and is not suitable for
categorical variables.
</p>
</li>
<li>
<p><strong>Third</strong>, the test investigates mean differences assuming
that the missing data pattern share a common covariance matrix, i.e.,
the test cannot detect covariance-based deviations from MCAR stemming
from a Missing at Random (MAR) or Missing Not at Random (MNAR) mechanism
because MAR and MNAR mechanisms can also produce missing data subgroups
with equal means.
</p>
</li>
<li>
<p><strong>Fourth</strong>, simulation studies suggest that Little's MCAR
test suffers from low statistical power, particularly when the number
of variables that violate MCAR is small, the relationship between the
data and missingness is weak, or the data are MNAR (Thoemmes &amp; Enders,
2007).
</p>
</li>
<li>
<p><strong>Fifth</strong>, the test can only reject, but cannot prove the
MCAR assumption, i.e., a statistically not significant result and failing
to reject the null hypothesis of the MCAR test does not prove the null
hypothesis that the data is MCAR.
</p>
</li>
<li>
<p><strong>Sixth</strong>, under the null hypothesis the data are actually
MCAR or MNAR, while a statistically significant result indicates that
missing data are MAR or MNAR, i.e., MNAR cannot be ruled out regardless
of the result of the test.
</p>
</li>
</ul>
<p>The function for performing Little's MCAR test is based on the <code>mlest</code>
function from the <span class="pkg">mvnmle</span> package which can handle up to 50 variables.
Note that the <code>mcar_test</code> function in the <span class="pkg">naniar</span> package is based
on the <code>prelim.norm</code> function from the <span class="pkg">norm</span> package. This function
can handle about 30 variables, but with more than 30 variables specified in
the argument <code>data</code>, the <code>prelim.norm</code> function might run into
numerical problems leading to results that are not trustworthy (i.e.,
<code>p.value = 1</code>). In that case, the warning message
<code>In norm::prelim.norm(data) : NAs introduced by coercion to integer range</code>
is printed on the console.</p>
</dd>
<dt><strong>Jamshidian and Jalal's Approach for Testing MCAR</strong></dt>
<dd>
<p>Jamshidian
and Jalal (2010) proposed an approach for testing the Missing Completely at
Random (MCAR) assumption based on two tests of multivariate normality and
homogeneity of covariances among groups of cases with identical missing data
patterns:
</p>

<ol>
<li>
<p><strong>In the first step</strong>, missing data are multiply imputed
(<code>m = 20</code> times by default) using a non-parametric imputation method
(<code>method = "npar"</code> by default) by Sirvastava and Dolatabadi (2009)
or using a parametric imputation method assuming multivariate normality
of data (<code>method = "normal"</code>) for each group of cases sharing a common
missing data pattern.
</p>
</li>
<li>
<p><strong>In the second step</strong>, a modified Hawkins test for multivariate
normality and homogeneity of covariances applicable to complete data
consisting of groups with a small number of cases is performed. A statistically
not significant result indicates no evidence against multivariate normality
of data or homogeneity of covariances, while a statistically significant
result provides evidence against multivariate normality of data or homogeneity
of covariances (i.e., violation of the MCAR assumption). Note that the
Hawkins test is a test of multivariate normality as well as homogeneity
of covariance. Hence, a statistically significant test is ambiguous unless
the researcher assumes multivariate normality of data.
</p>
</li>
<li>
<p><strong>In the third step</strong>, if the Hawkins test is statistically
significant, the Anderson-Darling non-parametric test is performed. A
statistically not significant result indicates evidence against multivariate
normality of data but no evidence against homogeneity of covariances, while
a statistically significant result provides evidence against homogeneity
of covariances (i.e., violation of the MCAR assumption). However, no
conclusions can be made about the multivariate normality of data when the
Anderson-Darling non-parametric test is statistically significant.
</p>
</li>
</ol>
<p>In summary, a statistically significant result of both the Hawkins and the
Anderson-Darling non-parametric test provides evidence against the MCAR assumption.
The test statistic and the significance values of the Hawkins test and the
Anderson-Darling non-parametric based on multiply imputed data sets are pooled
by computing the median test statistic and significance value (<code>pool = "med"</code>
by default) as suggested by Eekhout, Wiel, and Heymans (2017).
</p>
<p>Note that out of the problems listed for the Little's MCAR test the first,
second (i.e., approach is not suitable for categorical variables), fifth,
and sixth problems also apply to the Jamshidian and Jalal's approach for
testing the MCAR assumption.
</p>
</dd>
</dl>
<p>In practice, rejecting or not rejecting the MCAR assumption may not be relevant
as modern missing data handling methods like full information maximum likelihood
(FIML) estimation, Bayesian estimation, or multiple imputation are asymptotically
valid under the missing at random (MAR) assumption (Jamshidian &amp; Yuan, 2014).
It is more important to distinguish MAR from missing not at random (MNAR),
but MAR and MNAR mechanisms cannot be distinguished without auxiliary
information.

</p>


<h3>Value</h3>

<p>Returns an object of class <code>misty.object</code>, which is a list with following
entries:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>function call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>matrix or data frame specified in <code>x</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args</code></td>
<td>
<p>specification of function arguments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>result</code></td>
<td>
<p>list with result tables, i.e., <code>little</code> for the
result table of the Little's MCAR test, <code>jamjal</code>
for the list with results of the Jamshidian and Jalal's
approach, <code>hawkins</code> for the result table of the
Hawkins test, and <code>anderson</code> for the result table of
the Anderson-Darling non-parametric test</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The code for Little's MCAR test is a modified copy of the <code>LittleMCAR</code>
function in the <span class="pkg">BaylorEdPsych</span> package by A. Alexander Beaujean. The code
for Jamshidian and Jalal's approach is a modified copy of the <code>TestMCARNormality</code>
function in the <span class="pkg">MissMech</span> package by Mortaza Jamshidian, Siavash Jalal,
Camden Jansen, and Mao Kobayashi (2024).
</p>


<h3>Author(s)</h3>

<p>Takuya Yanagida <a href="mailto:takuya.yanagida@univie.ac.at">takuya.yanagida@univie.ac.at</a>
</p>


<h3>References</h3>

<p>Beaujean, A. A. (2012). <em>BaylorEdPsych: R Package for Baylor University
Educational Psychology Quantitative Courses</em>. R package version 0.5.
http://cran.nexr.com/web/packages/BaylorEdPsych/index.html
</p>
<p>Eekhout, I., M. A. Wiel, &amp; M. W. Heymans (2017). Methods for significance
testing of categorical covariates in logistic regression models after multiple
imputation: Power and applicability analysis. <em>BMC Medical Research
Methodology</em>, 17:129. https://doi.org/10.1186/s12874-017-0404-7
</p>
<p>Enders, C. K. (2010). <em>Applied missing data analysis</em>. Guilford Press.
</p>
<p>Little, R. J. A. (1988). A test of Missing Completely at Random for multivariate
data with missing values. <em>Journal of the American Statistical Association,
83</em>, 1198-1202. https://doi.org/10.2307/2290157
</p>
<p>Jamshidian, M., &amp; Jalal, S. (2010). Tests of homoscedasticity, normality, and
missing completely at random for incomplete multivariate data. <em>Psychometrika,
75</em>(4), 649-674. https://doi.org/10.1007/s11336-010-9175-3
</p>
<p>Jamshidian, M., &amp; Yuan, K.H. (2014). Examining missing data mechanisms via
homogeneity of parameters, homogeneity of distributions, and multivariate
normality. <em>WIREs Computational Statistics, 6</em>(1), 56-73.
https://doi.org/10.1002/wics.1287
</p>
<p>Mortaza, J., Siavash, J., Camden, J., &amp; Kobayashi, M. (2024). <em>MissMech:
Testing Homoscedasticity, Multivariate Normality, and Missing Completely at
Random</em>. R package version 1.0.4. https://doi.org/10.32614/CRAN.package.MissMech
</p>
<p>Srivastava, M.S., &amp; Dolatabadi, M. (2009). Multiple imputation and other
resampling scheme for imputing missing observations. <em>Journal of Multivariate
Analysis, 100</em>, 1919-1937. https://doi.org/10.1016/j.jmva.2009.06.003
</p>
<p>Thoemmes, F., &amp; Enders, C. K. (2007, April). <em>A structural equation model for
testing whether data are missing completely at random</em>. Paper presented at the
annual meeting of the American Educational Research Association, Chicago, IL.
</p>


<h3>See Also</h3>

<p><code>as.na</code>, <code>na.as</code>, <code>na.auxiliary</code>,
<code>na.coverage</code>, <code>na.descript</code>, <code>na.indicator</code>,
<code>na.pattern</code>, <code>na.prop</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Example 1a: Perform Little's MCAR test and Jamshidian and Jalal's approach
na.test(airquality)

# Example b: Alternative specification using the 'data' argument,
na.test(., data = airquality)

## Not run: 
# Example 2: Write results into a text file
na.test(airquality, write = "NA_Test.txt")

## End(Not run)
</code></pre>


</div>