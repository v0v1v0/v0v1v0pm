<div class="container">

<table style="width: 100%;"><tr>
<td>MVT</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Multivariate Student t distribution
</h2>

<h3>Description</h3>

<p>Density and random generation for the multivariate Student t distribution
with location equal to <code>mu</code>, precision matrix equal to <code>Q</code> (or scale
matrix equal to <code>Sigma</code>).
</p>
<p>Mentioned functions implement the multivariate Student t distribution
with a density given by
</p>
<p style="text-align: center;"><code class="reqn">%
    p(\boldsymbol{z}) = 
      \frac{\Gamma\bigl(\frac{\nu+p}{2}\bigr)}{\Gamma\bigl(\frac{\nu}{2}\bigr)\,\nu^{\frac{p}{2}}\,\pi^{\frac{p}{2}}}\,
      \bigl|\Sigma\bigr|^{-\frac{1}{2}}\,
      \Bigl\{1 + \frac{(\boldsymbol{z} -
	\boldsymbol{\mu})'\Sigma^{-1}(\boldsymbol{z} -
	\boldsymbol{\mu})}{\nu}\Bigr\}^{-\frac{\nu+p}{2}},        
  </code>
</p>
  
<p>where <code class="reqn">p</code> is the dimension, <code class="reqn">\nu &gt; 0</code> degrees of
freedom, <code class="reqn">\boldsymbol{\mu}</code> the location parameter and
<code class="reqn">\Sigma</code> the scale matrix.
</p>
<p>For <code class="reqn">\nu &gt; 1</code>, the mean in equal to
<code class="reqn">\boldsymbol{\mu}</code>,
for <code class="reqn">\nu &gt; 2</code>, the covariance matrix is equal to
<code class="reqn">\frac{\nu}{\nu - 2}\Sigma</code>.        
</p>


<h3>Usage</h3>

<pre><code class="language-R">dMVT(x, df, mu=0, Q=1, Sigma, log=FALSE)

rMVT(n, df, mu=0, Q=1, Sigma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>degrees of freedom of the multivariate Student t distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>vector of the location parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q</code></td>
<td>
<p>precision (inverted scale) matrix of the multivariate Student
t distribution. Ignored if <code>Sigma</code> is given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>scale matrix of the multivariate Student t
distribution. If <code>Sigma</code> is supplied, precision
is computed from <code class="reqn">\Sigma</code> as
<code class="reqn">Q = \Sigma^{-1}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations to be sampled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector or matrix of the points where the density should be
evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>logical; if <code>TRUE</code>, log-density is computed</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Some objects.
</p>


<h3>Value for dMVT</h3>

<p>A vector with evaluated values of the (log-)density
</p>


<h3>Value for rMVT</h3>

<p>A list with the components:
</p>

<dl>
<dt>x</dt>
<dd>
<p>vector or matrix with sampled values</p>
</dd>
<dt>log.dens</dt>
<dd>
<p>vector with the values of the log-density evaluated
in the sampled values</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Arnošt Komárek <a href="mailto:arnost.komarek@mff.cuni.cz">arnost.komarek@mff.cuni.cz</a>
</p>


<h3>See Also</h3>

<p><code>dt</code>, <code>Mvt</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1977)

### Univariate central t distribution
z &lt;- rMVT(10, df=1, mu=0, Q=1)
ldz &lt;- dMVT(z$x, df=1, log=TRUE)
boxplot(as.numeric(z$x))
cbind(z$log.dens, ldz, dt(as.numeric(z$x), df=1, log=TRUE))

### Multivariate t distribution
mu &lt;- c(1, 2, 3)
Sigma &lt;- matrix(c(1, 1, -1.5,  1, 4, 1.8,  -1.5, 1.8, 9), nrow=3)
Q &lt;- chol2inv(chol(Sigma))

nu &lt;- 3
z &lt;- rMVT(1000, df=nu, mu=mu, Sigma=Sigma)
apply(z$x, 2, mean)              ## should be close to mu
((nu - 2) / nu) * var(z$x)       ## should be close to Sigma            

dz &lt;- dMVT(z$x, df=nu, mu=mu, Sigma=Sigma)
ldz &lt;- dMVT(z$x, df=nu, mu=mu, Sigma=Sigma, log=TRUE)

### Compare with mvtnorm package
#require(mvtnorm)
#ldz2 &lt;- dmvt(z$x, sigma=Sigma, df=nu, delta=mu, log=TRUE)
#plot(z$log.dens, ldz2, pch=21, col="red3", bg="orange", xlab="mixAK", ylab="mvtnorm")
#plot(ldz, ldz2, pch=21, col="red3", bg="orange", xlab="mixAK", ylab="mvtnorm")
</code></pre>


</div>