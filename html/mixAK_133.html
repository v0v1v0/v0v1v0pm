<div class="container">

<table style="width: 100%;"><tr>
<td>NMixRelabel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Re-labeling the MCMC output of the mixture model
</h2>

<h3>Description</h3>

<p>This function takes an object generated by the <code>NMixMCMC</code>
or <code>GLMM_MCMC</code> function and internally re-labels the mixture
components using selected re-labeling algorithm. It also computes
posterior summary statistics for mixture means, weights, variances
which correspond to newly labeled MCMC sample. Further, posterior
component probabilities (<code>poster.comp.prob_u</code> and
<code>poster.comp.prob_b</code> components of the object <code>object</code>) are
updated according to the newly labeled MCMC sample.
</p>
<p>This function only works for models with a fixed number of mixture components.
</p>


<h3>Usage</h3>

<pre><code class="language-R">NMixRelabel(object, type=c("mean", "weight", "stephens"), par, ...)

## Default S3 method:
NMixRelabel(object, type = c("mean", "weight", "stephens"), par, ...)

## S3 method for class 'NMixMCMC'
NMixRelabel(object, type = c("mean", "weight","stephens"), par,
   prob=c(0.025, 0.5, 0.975), keep.comp.prob = FALSE, info, ...)

## S3 method for class 'NMixMCMClist'
NMixRelabel(object, type = c("mean", "weight","stephens"), par,
   prob=c(0.025, 0.5, 0.975), keep.comp.prob = FALSE, info,
   silent = FALSE, parallel = FALSE, ...)

## S3 method for class 'GLMM_MCMC'
NMixRelabel(object, type = c("mean", "weight", "stephens"), par,
   prob = c(0.025, 0.5, 0.975), keep.comp.prob = FALSE, info,
   silent = FALSE, ...)

## S3 method for class 'GLMM_MCMClist'
NMixRelabel(object, type = c("mean", "weight", "stephens"), par,
   prob = c(0.025, 0.5, 0.975), keep.comp.prob = FALSE, jointly = FALSE,
   info, silent = FALSE, parallel = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of apropriate class.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>character string which specifies the type of the
re-labeling algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>additional parameters for particular re-labeling
algorithms.
</p>

<dl>
<dt>mean</dt>
<dd>
<p><code>par</code> specifies margin which is used to order the
components. It is set to 1 if not given.</p>
</dd>
<dt>weight</dt>
<dd>
<p><code>par</code> is empty.</p>
</dd>
<dt>stephens</dt>
<dd>
<p><code>par</code> is a list with components
<code>type.init</code>, <code>par</code>, <code>maxiter</code>.
</p>
<p>Component <code>type.init</code> is a character string being equal to
either of “identity”, “mean”, “weight”. It
determines the way which is used to obtain initial re-labeling.
</p>
<p>Component <code>par</code> determines the margin in the case that
<code>type.init</code> is equal to “mean”.
</p>
<p>Component <code>maxiter</code> determines maximum number of iterations
of the re-labeling algorithm.		
</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>probabilities for which the posterior quantiles
of component allocation probabilities are computed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep.comp.prob</code></td>
<td>
<p>logical. If <code>TRUE</code>, posterior sample of
component allocation probabilities (for each subject) is kept in the
resulting object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jointly</code></td>
<td>
<p>a logical value. If it is <code>TRUE</code> then both chains
are processed together. In the output, all posterior summary
statistics are then also related to both chains as if it is one long
chain. If it is <code>FALSE</code> then both chains are processed independently.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>info</code></td>
<td>
<p>number which specifies frequency used to re-display the
iteration counter during the computation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>a logical value indicating whether the information on
the MCMC progress is to be supressed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>a logical value indicating whether parallel
computation (based on a package <code>parallel</code>) should be used (if
possible) for re-labelling of the two chains.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional additional arguments.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object being equal to the value of the <code>object</code> argument in
which the following components are updated according to new labeling
of the mixture components.
</p>


<h3>Value for NMixMCMC object</h3>

<p>When the argument <code>object</code> is of class <code>NMixMCMC</code>, the
resulting object is equal to <code>object</code> with the following
components being modified:
</p>

<dl>
<dt>relabel</dt>
<dd>
<p>see <code>NMixMCMC</code></p>
</dd>
<dt>order</dt>
<dd>
<p>see <code>NMixMCMC</code></p>
</dd>
<dt>rank</dt>
<dd>
<p>see <code>NMixMCMC</code></p>
</dd>
<dt>poster.mean.w</dt>
<dd>
<p>see <code>NMixMCMC</code></p>
</dd>
<dt>poster.mean.mu</dt>
<dd>
<p>see <code>NMixMCMC</code></p>
</dd>
<dt>poster.mean.Q</dt>
<dd>
<p>see <code>NMixMCMC</code></p>
</dd>
<dt>poster.mean.Sigma</dt>
<dd>
<p>see <code>NMixMCMC</code></p>
</dd>
<dt>poster.mean.Li</dt>
<dd>
<p>see <code>NMixMCMC</code></p>
</dd>
<dt>poster.comp.prob_u</dt>
<dd>
<p>see <code>NMixMCMC</code></p>
</dd>
<dt>poster.comp.prob_b</dt>
<dd>
<p>see <code>NMixMCMC</code></p>
</dd>
</dl>
<p>Additionally, new components are added, namely
</p>

<dl>
<dt>quant.comp.prob_b</dt>
<dd>
<p>a list with the posterior quantiles of
component probabilities. One <code>list</code> component for each
quantile specified by <code>prob</code> argument.</p>
</dd>
<dt>comp.prob_b</dt>
<dd>
<p>posterior sample of individual component
probabilities (also given random effects). It is an <code class="reqn">M \times
	n\cdot K</code> matrix where <code class="reqn">M</code> is the length of the
posterior sample, <code class="reqn">n</code> is the number of subjects, and <code class="reqn">K</code>
is the number of mixture components. Component labels correspond
to the re-labelled sample. It is included in the
resulting object only if <code>keep.comp.prob</code> argument is
<code>TRUE</code>.</p>
</dd>
</dl>
<h3>Value for GLMM_MCMC object</h3>

<p>When the argument <code>object</code> is of class <code>GLMM_MCMC</code>, the
resulting object is equal to <code>object</code> with the following
components being modified:
</p>

<dl>
<dt>relabel_b</dt>
<dd>
<p>see <code>GLMM_MCMC</code></p>
</dd>
<dt>order_b</dt>
<dd>
<p>see <code>GLMM_MCMC</code></p>
</dd>
<dt>rank_b</dt>
<dd>
<p>see <code>GLMM_MCMC</code></p>
</dd>
<dt>poster.mean.w_b</dt>
<dd>
<p>see <code>GLMM_MCMC</code></p>
</dd>
<dt>poster.mean.mu_b</dt>
<dd>
<p>see <code>GLMM_MCMC</code></p>
</dd>
<dt>poster.mean.Q_b</dt>
<dd>
<p>see <code>GLMM_MCMC</code></p>
</dd>
<dt>poster.mean.Sigma_b</dt>
<dd>
<p>see <code>GLMM_MCMC</code></p>
</dd>
<dt>poster.mean.Li_b</dt>
<dd>
<p>see <code>GLMM_MCMC</code></p>
</dd>
<dt>poster.comp.prob_u</dt>
<dd>
<p>see <code>GLMM_MCMC</code></p>
</dd>
<dt>poster.comp.prob_b</dt>
<dd>
<p>see <code>GLMM_MCMC</code></p>
</dd>
</dl>
<p>Additionally, new components are added, namely
</p>

<dl>
<dt>quant.comp.prob_b</dt>
<dd>
<p>a list with the posterior quantiles of
component probabilities. One <code>list</code> component for each
quantile specified by <code>prob</code> argument.</p>
</dd>
<dt>comp.prob_b</dt>
<dd>
<p>posterior sample of individual component
probabilities (also given random effects). It is an <code class="reqn">M \times
	I\cdot K</code> matrix where <code class="reqn">M</code> is the length of the
posterior sample, <code class="reqn">I</code> is the number of subjects, and <code class="reqn">K</code>
is the number of mixture components. Component labels correspond
to the re-labelled sample. It is included in the
resulting object only if <code>keep.comp.prob</code> argument is
<code>TRUE</code>.</p>
</dd>
<dt>poster.comp.prob</dt>
<dd>
<p>a matrix with the posterior means of
component probabilities which are calculated with random effects
integrated out.</p>
</dd>
<dt>quant.comp.prob</dt>
<dd>
<p>a list with the posterior quantiles of
component probabilities. One <code>list</code> component for each
quantile specified by <code>prob</code> argument.</p>
</dd>
<dt>comp.prob</dt>
<dd>
<p>posterior sample of individual component
probabilities (with random effects integrated out). It is an <code class="reqn">M \times
	I\cdot K</code> matrix where <code class="reqn">M</code> is the length of the
posterior sample, <code class="reqn">I</code> is the number of subjects, and <code class="reqn">K</code>
is the number of mixture components. Component labels correspond
to the re-labelled sample. It is included in the
resulting object only if <code>keep.comp.prob</code> argument is
<code>TRUE</code>.
</p>
<p><b>Remark.</b> These are the component probabilities which should
normally be used for clustering purposes.
</p>
</dd>    
</dl>
<h3>Author(s)</h3>

<p>Arnošt Komárek <a href="mailto:arnost.komarek@mff.cuni.cz">arnost.komarek@mff.cuni.cz</a>
</p>


<h3>References</h3>

<p>Celeux, G. (1998).
Bayesian inference for mixtures: The label-switching problem.
In: <em>COMPSTAT 98</em> (eds. R. Payne and P. Green),
pp. 227-232. Heidelberg: Physica-Verlag.
</p>
<p>Jasra, A., Holmes, C. C., and Stephens, D. A. (2005).
Markov chain Monte Carlo methods and the label switching problem in
Bayesian mixture modeling.
<em>Statistical Science</em>, <b>20</b>, 50-67.
</p>
<p>Stephens, M. (1997).
<em>Bayesian methods for mixtures of normal distributions. DPhil Thesis.</em>
Oxford: University of Oxford.
(Available from:
<a href="http://stephenslab.uchicago.edu/publications.html">http://stephenslab.uchicago.edu/publications.html</a>
(accessed on 05/02/2014)).
</p>
<p>Stephens, M. (2000).
Dealing with label switching in mixture models.
<em>Journal of the Royal Statistical Society, Series B</em>, <b>62</b>, 795-809.
</p>


<h3>See Also</h3>

<p><code>NMixMCMC</code>, <code>GLMM_MCMC</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## See also additional material available in 
## YOUR_R_DIR/library/mixAK/doc/
## or YOUR_R_DIR/site-library/mixAK/doc/
## - file PBCseq.R and
##   https://www2.karlin.mff.cuni.cz/~komarek/software/mixAK/PBCseq.pdf
##
## ==============================================
</code></pre>


</div>