<div class="container">

<table style="width: 100%;"><tr>
<td>rRotationMatrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Random rotation matrix
</h2>

<h3>Description</h3>

<p>Generate a random rotation matrix, i.e., a matrix
<code class="reqn">\boldsymbol{P} = (p_{i,j})_{i=1,\dots,p, j=1,\dots,p},</code>
which satisfies
</p>
<p>a) <code class="reqn">\boldsymbol{P}\boldsymbol{P}' = \boldsymbol{I}</code>,
</p>
<p>b) <code class="reqn">\boldsymbol{P}'\boldsymbol{P} = \boldsymbol{I}</code>,
</p>
<p>c) <code class="reqn">\mbox{det}(\boldsymbol{P}) = 1</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rRotationMatrix(n, dim)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of matrices to generate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dim</code></td>
<td>
<p>dimension of a generated matrix/matrices.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For <code>dim</code> = 2, <code class="reqn">p_{2,1}</code>
(<code class="reqn">\sin(\theta)</code>)
is generated from Unif(0, 1) and the rest computed as follows:
<code class="reqn">p_{1,1} = p_{2,2} = \sqrt{1 - p_{2,1}^2}</code>
(<code class="reqn">\cos(\theta)</code>) and
<code class="reqn">p_{1,2} = -p_{2,1}</code>
(<code class="reqn">-\sin(\theta)</code>).
</p>
<p>For <code>dim</code> <code class="reqn">&gt;</code> 2, the matrix <code class="reqn">\boldsymbol{P}</code> is generated
in the following steps:
</p>
<p>1) Generate a <code class="reqn">p\times p</code> matrix <code class="reqn">\boldsymbol{A}</code> with
independent Unif(0, 1) elements and check whether <code class="reqn">\boldsymbol{A}</code>
is of full rank <code class="reqn">p</code>.
</p>
<p>2) Computes a QR decomposition of <code class="reqn">\boldsymbol{A}</code>, i.e.,
<code class="reqn">\boldsymbol{A} = \boldsymbol{Q}\boldsymbol{R}</code> where
<code class="reqn">\boldsymbol{Q}</code> satisfies
<code class="reqn">\boldsymbol{Q}\boldsymbol{Q}' = \boldsymbol{I}</code>,
<code class="reqn">\boldsymbol{Q}'\boldsymbol{Q} = \boldsymbol{I}</code>,
<code class="reqn">\mbox{det}(\boldsymbol{Q}) = (-1)^{p+1}</code>,
and columns of <code class="reqn">\boldsymbol{Q}</code> spans the linear space generated by
the columns of <code class="reqn">\boldsymbol{A}</code>.
</p>
<p>3) For odd <code>dim</code>, return matrix <code class="reqn">\boldsymbol{Q}</code>. For even
<code>dim</code>, return corrected matrix <code class="reqn">\boldsymbol{Q}</code> to satisfy the
determinant condition.
</p>


<h3>Value</h3>

<p>For <code>n</code>=1, a matrix is returned.
</p>
<p>For <code>n</code>&gt;1, a list of matrices is returned.
</p>


<h3>Author(s)</h3>

<p>Arnošt Komárek <a href="mailto:arnost.komarek@mff.cuni.cz">arnost.komarek@mff.cuni.cz</a>
</p>


<h3>References</h3>

<p>Golub, G. H. and Van Loan, C. F. (1996, Sec. 5.1).
<em>Matrix Computations. Third Edition</em>.
Baltimore: The Johns Hopkins University Press.
</p>


<h3>Examples</h3>

<pre><code class="language-R">P &lt;- rRotationMatrix(n=1, dim=5)
print(P)
round(P %*% t(P), 10)
round(t(P) %*% P, 10)
det(P)

n &lt;- 10
P &lt;- rRotationMatrix(n=n, dim=5)
for (i in 1:3){
  cat(paste("*** i=", i, "\n", sep=""))
  print(P[[i]])
  print(round(P[[i]] %*% t(P[[i]]), 10))
  print(round(t(P[[i]]) %*% P[[i]], 10))
  print(det(P[[i]]))
}
</code></pre>


</div>