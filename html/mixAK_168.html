<div class="container">

<table style="width: 100%;"><tr>
<td>TMVN</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Truncated multivariate normal distribution
</h2>

<h3>Description</h3>

<p>Random generation for the truncated multivariate normal distribution.
The mean and covariance matrix of the original multivariate normal distribution
are <code>mean</code> and <code>Sigma</code>. Truncation limits are given by
<code>a</code>, <code>b</code>, type of truncation is given by <code>trunc</code>.
</p>
<p>This function uses a Gibbs algorithm to produce a Markov chain whose
stationary distribution is the targeted truncated multivariate normal
distribution, see Geweke (1991) for more details. Be aware that the
sampled values are not i.i.d.!
</p>


<h3>Usage</h3>

<pre><code class="language-R">rTMVN(n, mean=c(0, 0), Sigma=diag(2), a, b, trunc, xinit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>a numeric vector of the mean of the original multivariate
normal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>covariance matrix of the original multivariate normal
distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>a numeric vector of the same length as <code>mean</code> of
truncation limits 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>a numeric vector of the same length as <code>mean</code> of
truncation limits 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trunc</code></td>
<td>
<p>a numeric vector of the same length as <code>mean</code>
describing the type of truncation in each margin.
</p>

<dl>
<dt>
<code>trunc</code>=0</dt>
<dd>
<p>normal distribution is truncated on the
interval <code class="reqn">(a,\,\infty).</code>. Value of <code class="reqn">b</code> is
ignored.</p>
</dd>
<dt>
<code>trunc</code>=1</dt>
<dd>
<p>degenerated normal distribution, all values
are with probability 1 equal to <code class="reqn">a</code>, <code class="reqn">b</code> is ignored.</p>
</dd>
<dt>
<code>trunc</code>=2</dt>
<dd>
<p>normal distribution is truncated on the
interval <code class="reqn">(-\infty,\,a).</code> Value of <code class="reqn">b</code> is ignored.</p>
</dd>
<dt>
<code>trunc</code>=3</dt>
<dd>
<p>normal distribution is truncated on the
interval <code class="reqn">(a,\,b).</code></p>
</dd>
<dt>
<code>trunc</code>=4</dt>
<dd>
<p>there is no truncation, values of <code class="reqn">a</code>
and <code class="reqn">b</code> are ignored.</p>
</dd>      
</dl>
<p>If <code>trunc</code> is not given, it is assumed that it is equal to
4. Note that <code>a</code>, <code>b</code> and <code>trunc</code>
must have the same length, with exception that 
<code>b</code> does not have to be supplied if all <code>trunc</code> values 0,
1, 2 or 4.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xinit</code></td>
<td>
<p>a numeric vector of the same length as <code>mean</code> with
the initial value for the Gibbs sampler. If it is not supplied, the
function determines itself the initial value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations to be sampled.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A matrix with the sampled values (Markov chain) in rows.
</p>


<h3>Author(s)</h3>

<p>Arnošt Komárek <a href="mailto:arnost.komarek@mff.cuni.cz">arnost.komarek@mff.cuni.cz</a>
</p>


<h3>References</h3>

<p>Geweke, J. (1991).
Efficient simulation from the multivariate normal and
Student-t distributions subject to linear constraints 
and the evaluation of constraint probabilities.
<em>Computer Sciences and Statistics</em>, <b>23</b>, 571–578.
</p>


<h3>See Also</h3>

<p><code>rTNorm</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
set.seed(1977)

exam2 &lt;- function(n, mu, sigma, rho, a, b, trunc)
{
  Sigma &lt;- matrix(c(sigma[1]^2, rho*sigma[1]*sigma[2], rho*sigma[1]*sigma[2], sigma[2]^2), nrow=2)
  x &lt;- rTMVN(n, mean=mu, Sigma=Sigma, a=a, b=b, trunc=trunc)
  x1.gr &lt;- seq(mu[1]-3.5*sigma[1], mu[1]+3.5*sigma[1], length=100)
  x2.gr &lt;- seq(mu[2]-3.5*sigma[2], mu[2]+3.5*sigma[2], length=100)    
  z &lt;- cbind(rep(x1.gr, 100), rep(x2.gr, each=100))
  dens.z &lt;- matrix(dMVN(z, mean=mu, Sigma=Sigma), ncol=100)

  MEAN &lt;- round(apply(x, 2, mean), 3)
  SIGMA &lt;- var(x)
  SD &lt;- sqrt(diag(SIGMA))
  RHO &lt;- round(SIGMA[1,2]/(SD[1]*SD[2]), 3)
  SD &lt;- round(SD, 3)
  
  layout(matrix(c(0,1,1,0, 2,2,3,3), nrow=2, byrow=TRUE))
  contour(x1.gr, x2.gr, dens.z, col="darkblue", xlab="x[1]", ylab="x[2]")
  points(x[,1], x[,2], col="red")
  title(sub=paste("Sample mean = ", MEAN[1], ", ", MEAN[2], ",  Sample SD = ", SD[1], ", ", SD[2],
                  ",  Sample rho = ", RHO, sep=""))
  plot(1:n, x[,1], type="l", xlab="Iteration", ylab="x[1]", col="darkgreen")
  plot(1:n, x[,2], type="l", xlab="Iteration", ylab="x[2]", col="darkgreen")

  return(x)  
}  

x1 &lt;- exam2(1000, mu=c(-1, 1), sigma=c(1, sqrt(2)), rho=0, a=c(-6, -9), b=c(4, 11), trunc=c(3, 3))
x2 &lt;- exam2(1000, mu=c(-1, 1), sigma=c(1, sqrt(2)), rho=0.7, a=c(-6, -9), b=c(4, 11), trunc=c(3, 3))
x3 &lt;- exam2(1000, mu=c(-1, 1), sigma=c(1, sqrt(2)), rho=0.7, a=c(-100, -100), b=c(100, 100),
            trunc=c(3, 3))
x4 &lt;- exam2(1000, mu=c(-1, 1), sigma=c(1, sqrt(2)), rho=-0.7, a=c(-6, -9), b=c(4, 11),
            trunc=c(3, 3))
x5 &lt;- exam2(1000, mu=c(-1, 1), sigma=c(1, sqrt(2)), rho=-0.9, a=c(-6, -9), b=c(4, 11),
            trunc=c(3, 3))

x6 &lt;- exam2(1000, mu=c(-1, 1), sigma=c(1, sqrt(2)), rho=0.7, a=c(0, 0), trunc=c(0, 2))
x7 &lt;- exam2(1000, mu=c(-1, 1), sigma=c(1, sqrt(2)), rho=0.7, a=c(-1, 1), trunc=c(0, 2))
x8 &lt;- exam2(1000, mu=c(-1, 1), sigma=c(1, sqrt(2)), rho=0.7, a=c(-1, 1), trunc=c(1, 2))
x9 &lt;- exam2(1000, mu=c(-1, 1), sigma=c(1, sqrt(2)), rho=0.7, a=c(-1.5, 0.5), b=c(-0.5, 1.5),
            trunc=c(3, 3))
x10 &lt;- exam2(1000, mu=c(-1, 1), sigma=c(1, sqrt(2)), rho=0.7, a=c(-1.5, 0.5), b=c(-0.5, 1.5),
             trunc=c(4, 3))

## End(Not run)
</code></pre>


</div>