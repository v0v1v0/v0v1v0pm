<div class="container">

<table style="width: 100%;"><tr>
<td>Wishart</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Wishart distribution
</h2>

<h3>Description</h3>

<p>Wishart distribution
</p>
<p style="text-align: center;"><code class="reqn">\mbox{Wishart}(\nu, \boldsymbol{S}),</code>
</p>

<p>where <code class="reqn">\nu</code> are degrees of freedom of the Wishart distribution
and <code class="reqn">\boldsymbol{S}</code> is its scale matrix. The same parametrization as in
Gelman (2004) is assumed, that is, if
<code class="reqn">\boldsymbol{W}\sim\mbox{Wishart}(\nu,\,\boldsymbol{S})</code> then
</p>
<p style="text-align: center;"><code class="reqn">\mbox{E}(\boldsymbol{W}) = \nu \boldsymbol{S}.</code>
</p>

<p>Prior to version 3.4-1 of this package, functions <code>dWISHART</code> and
<code>rWISHART</code> were called as <code>dWishart</code> and <code>rWishart</code>,
respectively. The names were changed in order to avoid conflicts with
<code>rWishart</code> from a standard package <code>stats</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dWISHART(W, df, S, log=FALSE)

rWISHART(n, df, S)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>Either a matrix with the same number of rows and columns as
<code>S</code> (1 point sampled from the Wishart distribution) or a matrix
with <code>ncol</code> equal to <code>ncol</code>*<code>(ncol+1)</code>/2 and <code>n</code>
rows (<code>n</code> points sampled from the Wishart distribution for
which only lower triangles are given in rows of the matrix <code>W</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations to be sampled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>degrees of freedom of the Wishart distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>scale matrix of the Wishart distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>logical; if <code>TRUE</code>, log-density is computed</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The density of the Wishart distribution is the following
</p>
<p style="text-align: center;"><code class="reqn">
    f(\boldsymbol{W}) = \Bigl(2^{\nu\,p/2}\,\pi^{p(p-1)/4}\,\prod_{i=1}^p
    \Gamma\bigl(\frac{\nu + 1 - i}{2}\bigr)\Bigr)^{-1}\,
    |\boldsymbol{S}|^{-\nu/2}\,|\boldsymbol{W}|^{(\nu - p - 1)/2}\,
    \exp\Bigl(-\frac{1}{2}\mbox{tr}(\boldsymbol{S}^{-1}\boldsymbol{W})\Bigr),    
  </code>
</p>
  
<p>where <code class="reqn">p</code> is number of rows and columns of the matrix <code class="reqn">\boldsymbol{W}</code>.
</p>
<p>In the univariate case, <code class="reqn">\mbox{Wishart}(\nu,\,S)</code> is the
same as <code class="reqn">\mbox{Gamma}(\nu/2, 1/(2S)).</code>  
</p>
<p>Generation of random numbers is performed by the algorithm described
in Ripley (1987, pp. 99).
</p>


<h3>Value</h3>

<p>Some objects.
</p>


<h3>Value for dWISHART</h3>

<p>A numeric vector with evaluated (log-)density.
</p>


<h3>Value for rWISHART</h3>

<p>If <code>n</code> equals 1 then a sampled symmetric matrix W is returned.
</p>
<p>If <code>n</code> &gt; 1 then a matrix with sampled points (lower triangles of
<code class="reqn">\boldsymbol{W}</code>) in rows is returned.
</p>


<h3>Author(s)</h3>

<p>Arnošt Komárek <a href="mailto:arnost.komarek@mff.cuni.cz">arnost.komarek@mff.cuni.cz</a>
</p>


<h3>References</h3>

<p>Gelman, A., Carlin, J. B., Stern, H. S., and Rubin, D. B. (2004).
<em>Bayesian Data Analysis, Second edition</em>. 
Boca Raton: Chapman and Hall/CRC.
</p>
<p>Ripley, B. D. (1987).
<em>Stochastic Simulation</em>.
New York: John Wiley and Sons.  
</p>


<h3>See Also</h3>

<p><code>rWishart</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1977)
### The same as gamma(shape=df/2, rate=1/(2*S))
df &lt;- 1
S  &lt;- 3

w &lt;- rWISHART(n=1000, df=df, S=S)
mean(w)    ## should be close to df*S
var(w)     ## should be close to 2*df*S^2

dWISHART(w[1], df=df, S=S)
dWISHART(w[1], df=df, S=S, log=TRUE)

dens.w &lt;- dWISHART(w, df=df, S=S)
dens.wG &lt;- dgamma(w, shape=df/2, rate=1/(2*S))
rbind(dens.w[1:10], dens.wG[1:10])

ldens.w &lt;- dWISHART(w, df=df, S=S, log=TRUE)
ldens.wG &lt;- dgamma(w, shape=df/2, rate=1/(2*S), log=TRUE)
rbind(ldens.w[1:10], ldens.wG[1:10])


### Bivariate Wishart
df &lt;- 2
S &lt;- matrix(c(1,3,3,13), nrow=2)

print(w2a &lt;- rWISHART(n=1, df=df, S=S))
dWISHART(w2a, df=df, S=S)

w2 &lt;- rWISHART(n=1000, df=df, S=S)
print(w2[1:10,])
apply(w2, 2, mean)                ## should be close to df*S
(df*S)[lower.tri(S, diag=TRUE)]

dens.w2 &lt;- dWISHART(w2, df=df, S=S)
ldens.w2 &lt;- dWISHART(w2, df=df, S=S, log=TRUE)
cbind(w2[1:10,], data.frame(Density=dens.w2[1:10], Log.Density=ldens.w2[1:10]))


### Trivariate Wishart
df &lt;- 3.5
S &lt;- matrix(c(1,2,3,2,20,26,3,26,70), nrow=3)

print(w3a &lt;- rWISHART(n=1, df=df, S=S))
dWISHART(w3a, df=df, S=S)

w3 &lt;- rWISHART(n=1000, df=df, S=S)
print(w3[1:10,])
apply(w3, 2, mean)                ## should be close to df*S
(df*S)[lower.tri(S, diag=TRUE)]

dens.w3 &lt;- dWISHART(w3, df=df, S=S)
ldens.w3 &lt;- dWISHART(w3, df=df, S=S, log=TRUE)
cbind(w3[1:10,], data.frame(Density=dens.w3[1:10], Log.Density=ldens.w3[1:10]))
</code></pre>


</div>