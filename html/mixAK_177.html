<div class="container">

<table style="width: 100%;"><tr>
<td>TNorm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Truncated normal distribution
</h2>

<h3>Description</h3>

<p>Random generation for the truncated normal distribution.
The mean and standard deviation of the original normal distribution
are <code>mean</code> and <code>sd</code>. Truncation limits are given by
<code>a</code>, <code>b</code>, type of truncation is given by <code>trunc</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rTNorm(n, mean=0, sd=1, a, b, trunc)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>mean (if common for all observations) or a vector of
length <code>n</code> of means.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd</code></td>
<td>
<p>standard deviation (if common for all observations) or a vector of
length <code>n</code> of standard deviations.
</p>
<p>Note that <code>mean</code> and <code>sd</code>
must have the same length, either 1 or <code>n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>truncation limit 1 (if common for all observations) or a
vector of length <code>n</code> of truncation limits 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>truncation limit 2 (if common for all observations) or a
vector of length <code>n</code> of truncation limits 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trunc</code></td>
<td>
<p>type of truncation (if common for all observations) or a
vector of length <code>n</code> of types of truncation
</p>

<dl>
<dt>
<code>trunc</code>=0</dt>
<dd>
<p>normal distribution is truncated on the
interval <code class="reqn">(a,\,\infty).</code>. Value of <code class="reqn">b</code> is
ignored.</p>
</dd>
<dt>
<code>trunc</code>=1</dt>
<dd>
<p>degenerated normal distribution, all values
are with probability 1 equal to <code class="reqn">a</code>, <code class="reqn">b</code> is ignored.</p>
</dd>
<dt>
<code>trunc</code>=2</dt>
<dd>
<p>normal distribution is truncated on the
interval <code class="reqn">(-\infty,\,a).</code> Value of <code class="reqn">b</code> is ignored.</p>
</dd>
<dt>
<code>trunc</code>=3</dt>
<dd>
<p>normal distribution is truncated on the
interval <code class="reqn">(a,\,b).</code></p>
</dd>
<dt>
<code>trunc</code>=4</dt>
<dd>
<p>there is no truncation, values of <code class="reqn">a</code>
and <code class="reqn">b</code> are ignored.</p>
</dd>      
</dl>
<p>If <code>trunc</code> is not given, it is assumed that it is equal to
4. Note that <code>a</code>, <code>b</code> and <code>trunc</code>
must have the same length, either 1 or <code>n</code> with exception that
<code>b</code> does not have to be supplied if <code>trunc</code> is 0, 1, 2 or 4.    
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations to be sampled.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A numeric vector with sampled values.
</p>


<h3>Author(s)</h3>

<p>Arnošt Komárek <a href="mailto:arnost.komarek@mff.cuni.cz">arnost.komarek@mff.cuni.cz</a>
</p>


<h3>References</h3>

<p>Geweke, J. (1991).
Efficient simulation from the multivariate normal and
Student-t distributions subject to linear constraints 
and the evaluation of constraint probabilities.
<em>Computer Sciences and Statistics</em>, <b>23</b>, 571–578.
</p>


<h3>See Also</h3>

<p><code>rnorm</code>, <code>rTMVN</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1977)

### Not truncated normal distribution
x1 &lt;- rTNorm(1000, mean=10, sd=3)
c(mean(x1), sd(x1), range(x1))

### Truncation from left only
x2 &lt;- rTNorm(1000, mean=10, sd=3, a=7, trunc=0)
c(mean(x2), sd(x2), range(x2))

### Degenerated normal distribution
x6 &lt;- rTNorm(1000, mean=10, sd=3, a=13, trunc=1)
c(mean(x6), sd(x6), range(x6))

### Truncation from right only
x3 &lt;- rTNorm(1000, mean=10, sd=3, a=13, trunc=2)
c(mean(x3), sd(x3), range(x3))

### Truncation from both sides
x4 &lt;- rTNorm(1000, mean=10, sd=3, a=7, b=13, trunc=3)
c(mean(x4), sd(x4), range(x4))

x5 &lt;- rTNorm(1000, mean=10, sd=3, a=5.5, b=14.5, trunc=3)
c(mean(x5), sd(x5), range(x5))

oldPar &lt;- par(mfrow=c(2, 3))
hist(x1, main="N(10, 3^2)")
hist(x2, main="TN(10, 3^2, 7, Infty)")
hist(x6, main="TN(10, 3^2, 13, 13)")
hist(x3, main="TN(10, 3^2, -Infty, 13)")
hist(x4, main="TN(10, 3^2, 7, 13)")
hist(x5, main="TN(10, 3^2, 5.5, 14.5)")
par(oldPar)

### Different truncation limits
n &lt;- 1000
a &lt;- rnorm(n, -2, 1)
b &lt;- a + rgamma(n, 1, 1)
trunc &lt;- rep(c(0, 1, 2, 3, 4), each=n/5)
x7 &lt;- rTNorm(n, mean=1, sd=2, a=a, b=b, trunc=trunc)
cbind(trunc, a, x7)[1:10,]
sum(x7[1:(n/5)] &gt; a[1:(n/5)])      ## must be equal to n/5

cbind(trunc, a, x7)[201:210,]
sum(x7[(n/5+1):(2*n/5)] == a[(n/5+1):(2*n/5)])         ## must be equal to n/5

cbind(trunc, x7, a)[401:410,]
sum(x7[(2*n/5+1):(3*n/5)] &lt; a[(2*n/5+1):(3*n/5)])      ## must be equal to n/5

cbind(trunc, a, x7, b)[601:610,]
sum(x7[(3*n/5+1):(4*n/5)] &gt; a[(3*n/5+1):(4*n/5)])      ## must be equal to n/5
sum(x7[(3*n/5+1):(4*n/5)] &lt; b[(3*n/5+1):(4*n/5)])      ## must be equal to n/5

cbind(trunc, x7)[801:810,]

### Different moments and truncation limits
n &lt;- 1000
mu &lt;- rnorm(n, 1, 0.2)
sigma &lt;- 0.5 + rgamma(n, 1, 1)
a &lt;- rnorm(n, -2, 1)
b &lt;- a + rgamma(n, 1, 1)
trunc &lt;- rep(c(0, 1, 2, 3, 4), each=n/5)
x8 &lt;- rTNorm(n, mean=1, sd=2, a=a, b=b, trunc=trunc)

### Truncation from left only
### (extreme cases when we truncate to the area
###  where the original normal distribution has
###  almost zero probability)
x2b &lt;- rTNorm(1000, mean=0, sd=1, a=7.9, trunc=0)
c(mean(x2b), sd(x2b), range(x2b))

x2c &lt;- rTNorm(1000, mean=1, sd=2, a=16, trunc=0)
c(mean(x2c), sd(x2c), range(x2c))

### Truncation from right only (extreme cases)
x3b &lt;- rTNorm(1000, mean=0, sd=1, a=-7.9, trunc=2)
c(mean(x3b), sd(x3b), range(x3b))

x3c &lt;- rTNorm(1000, mean=1, sd=2, a=-13, trunc=2)
c(mean(x3c), sd(x3c), range(x3c))

### Truncation from both sides (extreme cases)
x4b &lt;- rTNorm(1000, mean=0, sd=1, a=-9, b=-7.9, trunc=3)
c(mean(x4b), sd(x4b), range(x4b))

x4c &lt;- rTNorm(1000, mean=0, sd=1, a=7.9, b=9, trunc=3)
c(mean(x4c), sd(x4c), range(x4c))
</code></pre>


</div>