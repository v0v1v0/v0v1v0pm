<div class="container">

<table style="width: 100%;"><tr>
<td>MVN</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Multivariate normal distribution
</h2>

<h3>Description</h3>

<p>Density and random generation for the multivariate normal distribution
with mean equal to <code>mean</code>, precision matrix equal to <code>Q</code> (or covariance
matrix equal to <code>Sigma</code>).
</p>
<p>Function <code>rcMVN</code> samples from the multivariate normal
distribution with a canonical mean <code class="reqn">b</code>, i.e., the mean is
<code class="reqn">\mu = Q^{-1}\,b.</code>
</p>


<h3>Usage</h3>

<pre><code class="language-R">dMVN(x, mean=0, Q=1, Sigma, log=FALSE)

rMVN(n, mean=0, Q=1, Sigma)

rcMVN(n, b=0, Q=1, Sigma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>vector of mean.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>vector of a canonical mean.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q</code></td>
<td>
<p>precision matrix of the multivariate normal
distribution. Ignored if <code>Sigma</code> is given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>covariance matrix of the multivariate normal
distribution. If <code>Sigma</code> is supplied, precision
is computed from <code class="reqn">\Sigma</code> as
<code class="reqn">Q = \Sigma^{-1}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations to be sampled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector or matrix of the points where the density should be
evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>logical; if <code>TRUE</code>, log-density is computed</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Some objects.
</p>


<h3>Value for dMVN</h3>

<p>A vector with evaluated values of the (log-)density
</p>


<h3>Value for rMVN</h3>

<p>A list with the components:
</p>

<dl>
<dt>x</dt>
<dd>
<p>vector or matrix with sampled values</p>
</dd>
<dt>log.dens</dt>
<dd>
<p>vector with the values of the log-density evaluated
in the sampled values</p>
</dd>
</dl>
<h3>Value for rcMVN</h3>

<p>A list with the components:
</p>

<dl>
<dt>x</dt>
<dd>
<p>vector or matrix with sampled values</p>
</dd>
<dt>mean</dt>
<dd>
<p>vector or the mean of the normal distribution</p>
</dd>    
<dt>log.dens</dt>
<dd>
<p>vector with the values of the log-density evaluated
in the sampled values</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Arnošt Komárek <a href="mailto:arnost.komarek@mff.cuni.cz">arnost.komarek@mff.cuni.cz</a>
</p>


<h3>References</h3>

<p>Rue, H. and Held, L. (2005).
<em>Gaussian Markov Random Fields: Theory and Applications</em>.
Boca Raton: Chapman and Hall/CRC.  
</p>


<h3>See Also</h3>

<p><code>dnorm</code>, <code>Mvnorm</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1977)

### Univariate normal distribution
### ==============================
c(dMVN(0), dnorm(0))
c(dMVN(0, log=TRUE), dnorm(0, log=TRUE))

rbind(dMVN(c(-1, 0, 1)), dnorm(c(-1, 0, 1)))
rbind(dMVN(c(-1, 0, 1), log=TRUE), dnorm(c(-1, 0, 1), log=TRUE))

c(dMVN(1, mean=1.2, Q=0.5), dnorm(1, mean=1.2, sd=sqrt(2)))
c(dMVN(1, mean=1.2, Q=0.5, log=TRUE), dnorm(1, mean=1.2, sd=sqrt(2), log=TRUE))

rbind(dMVN(0:2, mean=1.2, Q=0.5), dnorm(0:2, mean=1.2, sd=sqrt(2)))
rbind(dMVN(0:2, mean=1.2, Q=0.5, log=TRUE), dnorm(0:2, mean=1.2, sd=sqrt(2), log=TRUE))

### Multivariate normal distribution
### ================================
mu &lt;- c(0, 6, 8)
L &lt;- matrix(1:9, nrow=3)
L[upper.tri(L, diag=FALSE)] &lt;- 0
Sigma &lt;- L %*% t(L)
Q &lt;- chol2inv(chol(Sigma))
b &lt;- solve(Sigma, mu)

dMVN(mu, mean=mu, Q=Q)
dMVN(mu, mean=mu, Sigma=Sigma)
dMVN(mu, mean=mu, Q=Q, log=TRUE)
dMVN(mu, mean=mu, Sigma=Sigma, log=TRUE)

xx &lt;- matrix(c(0,6,8, 1,5,7, -0.5,5.5,8.5, 0.5,6.5,7.5), ncol=3, byrow=TRUE)
dMVN(xx, mean=mu, Q=Q)
dMVN(xx, mean=mu, Sigma=Sigma)
dMVN(xx, mean=mu, Q=Q, log=TRUE)
dMVN(xx, mean=mu, Sigma=Sigma, log=TRUE)

zz &lt;- rMVN(1000, mean=mu, Sigma=Sigma)
rbind(apply(zz$x, 2, mean), mu)
var(zz$x)
Sigma
cbind(dMVN(zz$x, mean=mu, Sigma=Sigma, log=TRUE), zz$log.dens)[1:10,]

zz &lt;- rcMVN(1000, b=b, Sigma=Sigma)
rbind(apply(zz$x, 2, mean), mu)
var(zz$x)
Sigma
cbind(dMVN(zz$x, mean=mu, Sigma=Sigma, log=TRUE), zz$log.dens)[1:10,]

zz &lt;- rMVN(1000, mean=rep(0, 3), Sigma=Sigma)
rbind(apply(zz$x, 2, mean), rep(0, 3))
var(zz$x)
Sigma
cbind(dMVN(zz$x, mean=rep(0, 3), Sigma=Sigma, log=TRUE), zz$log.dens)[1:10,]


### The same using the package mvtnorm
### ==================================
# require(mvtnorm)
# c(dMVN(mu, mean=mu, Sigma=Sigma), dmvnorm(mu, mean=mu, sigma=Sigma))
# c(dMVN(mu, mean=mu, Sigma=Sigma, log=TRUE), dmvnorm(mu, mean=mu, sigma=Sigma, log=TRUE))
#
# rbind(dMVN(xx, mean=mu, Sigma=Sigma), dmvnorm(xx, mean=mu, sigma=Sigma))
# rbind(dMVN(xx, mean=mu, Sigma=Sigma, log=TRUE), dmvnorm(xx, mean=mu, sigma=Sigma, log=TRUE))
</code></pre>


</div>