<div class="container">

<table style="width: 100%;"><tr>
<td>NMixEM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
EM algorithm for a homoscedastic normal mixture
</h2>

<h3>Description</h3>

<p>This function computes ML estimates of the parameters
of the <code class="reqn">p</code>-dimensional <code class="reqn">K</code>-component normal mixture using the EM algorithm
</p>


<h3>Usage</h3>

<pre><code class="language-R">NMixEM(y, K, weight, mean, Sigma, toler=1e-5, maxiter=500)

## S3 method for class 'NMixEM'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>vector (if <code class="reqn">p=1</code>) matrix or data frame (if <code class="reqn">p &gt; 1</code>) with data. Rows correspond to
observations, columns correspond to margins.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>required number of mixture components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>a numeric vector with initial mixture weights.
</p>
<p>If not given, initial weights are all equal to <code class="reqn">1/K</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>vector or matrix of initial mixture means.
</p>
<p>For <code class="reqn">p=1</code> this
should be a vector of length <code class="reqn">K</code>, for <code class="reqn">p&gt;1</code> this should be a
<code class="reqn">K\times p</code> matrix with mixture means in rows.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>number or <code class="reqn">p\times p</code> matrix giving the
initial variance/covariance matrix.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>toler</code></td>
<td>
<p>tolerance to determine convergence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>maximum number of iterations of the EM algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>NMixEM</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments passed to the default <code>print</code> method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>NMixEM</code> which has the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>number of mixture components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>estimated mixture weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>estimated mixture means</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>estimated covariance matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>log-likelihood value at fitted values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aic</code></td>
<td>
<p>Akaike information criterion
(<code class="reqn">-2\hat{\ell} + 2\nu</code>), where
<code class="reqn">\hat{\ell}</code> stands for the log-likelihood value at
fitted values and <code class="reqn">\nu</code> for the number of free model parameters
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bic</code></td>
<td>
<p>Bayesian (Schwarz) information criterion
(<code class="reqn">-2\hat{\ell} + \log(n)\,\nu</code>), where
<code class="reqn">\hat{\ell}</code> stands for the log-likelihood value at
fitted values and <code class="reqn">\nu</code> for the number of free model
parameters, and <code class="reqn">n</code> for the sample size    
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>number of iterations of the EM algorithm used to get the solution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter.loglik</code></td>
<td>
<p>values of the log-likelihood at iterations of the
EM algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter.Qfun</code></td>
<td>
<p>values of the EM objective function at iterations of
the EM algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dim</code></td>
<td>
<p>dimension <code class="reqn">p</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nobs</code></td>
<td>
<p>number of observations <code class="reqn">n</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Arnošt Komárek <a href="mailto:arnost.komarek@mff.cuni.cz">arnost.komarek@mff.cuni.cz</a>
</p>


<h3>References</h3>

<p>Dempster, A. P., Laird, N. M., Rubin, D. B. (1977).
Maximum likelihood from incomplete data via the EM algorithm.
<em>Journal of the Royal Statistical Society, Series B</em>, <b>39</b>, 1-38.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## Estimates for 3-component mixture in  Anderson's iris data
## ==========================================================
data(iris, package="datasets")
summary(iris)

VARS &lt;- names(iris)[1:4]
fit &lt;- NMixEM(iris[, VARS], K = 3)
print(fit)

apply(subset(iris, Species == "versicolor")[, VARS], 2, mean)
apply(subset(iris, Species == "setosa")[, VARS], 2, mean)
apply(subset(iris, Species == "virginica")[, VARS], 2, mean)

## Estimates of 6-component mixture in Galaxy data
## ==================================================
data(Galaxy, package="mixAK")
summary(Galaxy)

fit2 &lt;- NMixEM(Galaxy, K = 6)
y &lt;- seq(5, 40, length=300)
fy &lt;- dMVNmixture(y, weight=fit2$weight, mean=fit2$mean,
                     Sigma=rep(fit2$Sigma, fit2$K))
hist(Galaxy, prob=TRUE, breaks=seq(5, 40, by=0.5),
     main="", xlab="Velocity (km/sec)", col="sandybrown")
lines(y, fy, col="darkblue", lwd=2)

## End(Not run)
</code></pre>


</div>