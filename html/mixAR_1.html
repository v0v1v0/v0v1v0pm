<div class="container">

<table style="width: 100%;"><tr>
<td>mixAR-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>







Mixture Autoregressive Models
</h2>

<h3>Description</h3>

<p>Model time series using mixture autoregressive (MAR)
             models.  Implemented are frequentist (EM) and Bayesian
             methods for estimation, prediction and model
             evaluation. See Wong and Li (2002)
             &lt;doi:10.1111/1467-9868.00222&gt;, Boshnakov (2009)
             &lt;doi:10.1016/j.spl.2009.04.009&gt;), and the extensive
             references in the documentation.
</p>


<h3>Details</h3>

















































































































































<p>Package <span class="pkg">mixAR</span> provides functions for modelling with mixture
autoregressive (MixAR) models. The S4 class <code>"MixARGaussian"</code> can
be used when the error distributions of the components are standard
Gaussian. The class <code>"MixARgen"</code> admits arbitrary (well, within
reason) distributions for the error components. Both classes inherit
from the virtual class <code>"MixAR"</code>.
</p>
<p>Estimation can be done with <code>fit_mixAR</code>.  Currently, the EM
algorithm is used for estimation.
</p>
<p>For <code>"MixARGaussian"</code> the M-step of the EM algorithm reduces to a
system of linear equations. For <code>"MixARgen"</code> the problem is
substantially non-linear. The implementation is fairly general but
currently not optimised for efficiency. The specification of the error
distributions went through several stages and may still be
reviewed. However, backward compatibility will be kept.
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov [aut, cre],
  Davide Ravagli [aut]
</p>
<p>Maintainer: Georgi N. Boshnakov &lt;georgi.boshnakov@manchester.ac.uk&gt;
</p>


<h3>References</h3>

<p>Akinyemi MI (2013).
<em>Mixture autoregressive models: asymptotic properties and application to financial risk</em>.
Ph.D. thesis, Probability and Statistics Group, School of Mathematics, University of Manchester.
</p>
<p>Boshnakov GN (2009).
“Analytic expressions for predictive distributions in mixture autoregressive models.”
<em>Stat. Probab. Lett. </em>, <b>79</b>(15), 1704-1709.
<a href="https://doi.org/10.1016/j.spl.2009.04.009">doi:10.1016/j.spl.2009.04.009</a>.
</p>
<p>Boshnakov GN (2011).
“On First and Second Order Stationarity of Random Coefficient Models.”
<em>Linear Algebra Appl.</em>, <b>434</b>(2), 415–423.
<a href="https://doi.org/10.1016/j.laa.2010.09.023">doi:10.1016/j.laa.2010.09.023</a>.
</p>
<p>Fong PW, Li WK, Yau CW, Wong CS (2007).
“On a mixture vector autoregressive model.”
<em>Can. J. Stat. </em>, <b>35</b>(1), 135-150.
</p>
<p>Ravagli D, Boshnakov GN (2020).
“Bayesian analysis of mixture autoregressive models covering the complete parameter space.”
2006.11041, <a href="https://arxiv.org/abs/2006.11041">https://arxiv.org/abs/2006.11041</a>.
</p>
<p>Ravagli D, Boshnakov GN (2020).
“Portfolio optimization with mixture vector autoregressive models.”
2005.13396, <a href="https://arxiv.org/abs/2005.13396">https://arxiv.org/abs/2005.13396</a>.
</p>
<p>Hossain AS (2012).
<em>Complete Bayesian analysis of some mixture time series models</em>.
Ph.D. thesis, Probability and Statistics Group, School of Mathematics, University of Manchester.
</p>
<p>Wong CS (1998).
<em>Statistical inference for some nonlinear time series models</em>.
Ph.D. thesis, University of Hong Kong, Hong Kong .
</p>
<p>Wong CS, Li WK (2000).
“On a mixture autoregressive model.”
<em>J. R. Stat. Soc., Ser. B, Stat. Methodol. </em>, <b>62</b>(1), 95-115.
</p>
<p>Wong CS, Li WK (2001).
“On a logistic mixture autoregressive model.”
<em>Biometrika </em>, <b>88</b>(3), 833-846.
<a href="https://doi.org/10.1093/biomet/88.3.833">doi:10.1093/biomet/88.3.833</a>.
</p>
<p>Wong CS, Li WK (2001).
“On a mixture autoregressive conditional heteroscedastic model.”
<em>J. Am. Stat. Assoc. </em>, <b>96</b>(455), 982-995.
<a href="https://doi.org/10.1198/016214501753208645">doi:10.1198/016214501753208645</a>.
</p>


<h3>See Also</h3>

<p>fit several types of mixAR models:
<code>fit_mixAR</code>, <code>bayes_mixAR</code>,
<code>fit_mixARreg</code>,
<code>mixSARfit</code>;
</p>
<p>Predictive distributions and summaries:
<code>mix_pdf</code>, <code>mix_cdf</code>, <code>mix_qf</code>,
<code>mix_location</code>,
<code>mix_variance</code>,
<code>mix_central_moment</code>,
<code>mix_moment</code>,
<code>mix_kurtosis</code>,
<code>mix_ekurtosis</code>
</p>
<p>multi-step prediction:
<code>multiStep_dist</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## object 'exampleModels' contains a number of models for examples and testing
names(exampleModels)
exampleModels$WL_ibm

## some of the models below are available in object 'exampleModels';
## the examples here show how to create them from scratch
mo_WLprob &lt;- c(0.5439, 0.4176, 0.0385)              # model coefficients from Wong&amp;Li
mo_WLsigma &lt;- c(4.8227, 6.0082, 18.1716)
mo_WLar &lt;- list(c(0.6792, 0.3208), c(1.6711, -0.6711), 1)

mo_WL &lt;- new("MixARGaussian", prob = mo_WLprob, scale = mo_WLsigma, arcoef = mo_WLar)
                                        
mo_WL_A &lt;- new("MixARGaussian"                         # WongLi, model A
              , prob = c(0.5, 0.5)
              , scale = c(5, 1)
              , shift = c(0, 0)
              , arcoef = list(c(0.5), c(1.1))
              )

mo_WL_B &lt;- new("MixARGaussian"                         # WongLi, model B
              , prob = c(0.75, 0.25)
              , scale = c(5, 1)
              , shift = c(0, 0)
              , arcoef = list(c(0.5), c(1.4))
              )
                                        
mo_WL_I &lt;- new("MixARGaussian"                          # WongLi, model I
              , prob = c(0.4, 0.3, 0.3)
              , scale = c(1, 1, 5)
              , shift = c(0, 0, -5)
              , arcoef = list(c(0.9, -0.6), c(-0.5), c(1.50, -0.74, 0.12))
              )

mo_WL_II &lt;- new("MixARGaussian"                         # WongLi, model II
               , prob = c(0.4, 0.3, 0.3)
               , scale = c(1, 1, 5)
               , shift = c(5, 0, -5)
               , arcoef = list(c(0.9, -0.6), c(-0.7, 0), c( 0, 0.80))
               )

## MixAR models with arbitrary dist. of the components
## (user interface not finalized)

## Gaussian
mo_WLgen &lt;- new("MixARgen", prob = mo_WLprob, scale = mo_WLsigma, arcoef = mo_WLar,
               dist = list(dist_norm))

## t_3
mo_WLt3v &lt;- new("MixARgen", prob = mo_WLprob, scale = mo_WLsigma, arcoef = mo_WLar,
               dist = list(fdist_stdt(3, fixed = FALSE)))

## t_20, t_30, t_40 (can be used to start estimation)
mo_WLtf &lt;- new("MixARgen", prob = mo_WLprob, scale = mo_WLsigma, arcoef = mo_WLar,
              dist = list(generator =
                              function(par)
                                  fn_stdt(par, fixed = FALSE), param = c(20, 30, 40)))

## data(ibmclose, package = "fma")  # for `ibmclose'

## The examples below are quick but some of them are marked as 'not run'
## to avoid cumulative time of more than 5s on CRAN.

## fit a MAR(2,2,1) model
a0a &lt;- fit_mixAR(as.numeric(fma::ibmclose), c(2, 2, 1), crit = 1e-4)
## same with 2 sets of automatically generated initial values.

a0b &lt;- fit_mixAR(as.numeric(fma::ibmclose), c(2, 2, 1), 2, crit = 1e-4)


## fix the shift parameters:
a1a &lt;- fit_mixAR(as.numeric(fma::ibmclose), c(2, 2, 1), fix = "shift", crit = 1e-4)
## ... with 3 sets of automatically generated initial values.

a1b &lt;- fit_mixAR(as.numeric(fma::ibmclose), c(2, 2, 1), 3, fix = "shift", crit = 1e-4)



## specify the model using a MixAR model object
a1c &lt;- fit_mixAR(as.numeric(fma::ibmclose), a1a$model, init = a0a$model, fix = "shift",
           crit = 1e-4)

## fit a model like mo_WL using as initial values 2 automatically generated sets.
a2 &lt;- fit_mixAR(as.numeric(fma::ibmclose), mo_WL, 2, fix = "shift", permute = TRUE, 
          crit = 1e-4)


moT_B3 &lt;- new("MixARgen"
               , prob = c(0.3, 0.3, 0.4)
               , scale = c(2, 1, 0.5)
               , shift = c(5, -5, 0)
               , arcoef = list(c(0.5, 0.24), c(-0.9), c(1.5, -0.74, 0.12))
                                        # t4, t4, t10
               , dist = distlist("stdt", c(4,10), fixed = c(FALSE, TRUE), tr = c(1, 1, 2))
               )

moT_C1 &lt;- new("MixARgen"
              , prob = c(0.3, 0.3, 0.4)
              , scale = c(2, 1, 0.5)
              , shift = c(5, -5, 0)
              , arcoef = list(c(0.5, 0.24), c(-0.9), c(1.5, -0.74, 0.12))
                                        # t4, t7, N(0,1)
              , dist = distlist(c("stdt", "stdt", "stdnorm"), c(4,7))
              )

## demonstrate reuse of existing models
exampleModels$WL_Bt_1
moT_C2 &lt;- new("MixARgen"
              , model = exampleModels$WL_Bt_1
              , dist = distlist(c("stdt", "stdt", "stdnorm"), c(4,7))  # t4, t7, N(0,1)
              )
moT_C3 &lt;- new("MixARGaussian", model = exampleModels$WL_Bt_1 )
</code></pre>


</div>