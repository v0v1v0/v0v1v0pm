<div class="container">

<table style="width: 100%;"><tr>
<td>label_switch</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>A posteriori relabelling of a Markov chain</h2>

<h3>Description</h3>

<p>Takes the output from a MCMC simulation of parameters of a mixture,
and detects whether labels switch has occured while sampling, using
the method by Celeux (2000).
</p>


<h3>Usage</h3>

<pre><code class="language-R">label_switch(x, m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>output from an MCMC sampling of a mixture. A <code>matrix</code>, each
column corresponds to one component of the mixture.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>

<p>the number of observations in the sample that will be used to
initialise the algorithm. <code>m~100</code> is recommended.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Function can be directly executed when <code>x</code> is one of
<code>mix_weights</code>, <code>scale</code>, <code>precision</code>, <code>shift</code> or
<code>mu</code> from <code>bayes_mixAR</code> output.  <code>ARcoeff</code> cannot be input
as it is, but element from the list may be used.
</p>


<h3>Value</h3>

<p>A list of 2:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The input matrix, with adjusted labels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>true_perm</code></td>
<td>
<p>The "true" permutation at each iteration.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>There is no absolute choice on what <code>x</code> should be to obtain the
"true" permutation at any given point. User is subject to make the
most suitable choice, given output of their MCMC.
</p>


<h3>Author(s)</h3>

<p>Davide Ravagli</p>


<h3>References</h3>

<p>Celeux G (2000).
<em>Bayesian Inference of Mixture: The Label Switching Problem.</em>.
Payne R., Green P. (eds) COMPSTAT. Physica, Heidelberg.
</p>


<h3>See Also</h3>

<p><code>bayes_mixAR</code>

</p>


<h3>Examples</h3>

<pre><code class="language-R">model &lt;- new("MixARGaussian",
             prob   = exampleModels$WL_At@prob,      # c(0.5, 0.5)
             scale  = exampleModels$WL_At@scale,     # c(1, 2)        
             arcoef = exampleModels$WL_At@arcoef@a ) # list(-0.5, 1.1)

y &lt;- mixAR_sim(model, n = 300, init = rep(0, which.max(model@order)))

## just examples, use larger numbers in practice
nsim &lt;- 30   # 200
burnin &lt;- 10  # 100
x &lt;- bayes_mixAR(y, model, fix_shift = FALSE, tau = c(.15, .25),
              nsim = nsim, burnin = burnin)

label_switch(x$mix_weights, m = 5)
</code></pre>


</div>