<div class="container">

<table style="width: 100%;"><tr>
<td>marg_loglik</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Calculate marginal loglikelihood at high density points of a MAR model.
</h2>

<h3>Description</h3>

<p>The function implements the method by
Chib (1995) and
Chib and Jeliazkov (2001) for calculation of the
marginal loglikelihood of a mixture autoregressive model. It
automatically finds high density values for model parameters, and
evaluates the likelihood at such points.
</p>


<h3>Usage</h3>

<pre><code class="language-R">marg_loglik(y, model, tau, nsim, prob_mod)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a time series (currently a numeric vector).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>object of formal class <code>MixAR</code>, containing initial values for
the parameters. Currently available for <code>MixARGaussian</code> objects
only.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>

<p>tuning parameter for Metropolis-Hasting move to update
autoregressive parameters.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>

<p>sample size on which to evaluate highest density values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob_mod</code></td>
<td>

<p>this is currently the output from <code>Choose_pk</code>: the proportion
of times the "best model" was chosen.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>nsim</code> is the sample size on which to evaluate highest density
values for each set of parameters. For example, choosing
<code>nsim=1000</code> results in <code>1000*(g+3)</code> (1000 iterations for
each autoregressive component, plus 1000 for mean and scale parameters
and mixing weights).
</p>


<h3>Value</h3>

<p>A list containing the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>marg_loglik</code></td>
<td>
<p>value of the marginal loglikelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi_hd</code></td>
<td>
<p>set of highest density autoregressive parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prec_hd</code></td>
<td>
<p>set of highest density precision parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu_hd</code></td>
<td>
<p>set of highest density mean parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weig_hd</code></td>
<td>
<p>set of highest density mixing weights.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Davide Ravagli</p>


<h3>References</h3>

<p>Chib S (1995).
“Marginal likelihood from the Gibbs output.”
<em>J. A. Stat. Ass.</em>, <b>90</b>(432), 1313-1321.
</p>
<p>Chib S, Jeliazkov I (2001).
“Marginal likelihood from the Metropolis-Hastings output.”
<em>J. A. Stat. Ass.</em>, <b>96</b>(453), 270-281.
</p>


<h3>Examples</h3>

<pre><code class="language-R">prob &lt;- c(0.5, 0.5)
sigma &lt;- c(1, 2)
arco &lt;- list(-0.5, 1)

model &lt;- new("MixARGaussian", prob = prob, scale = sigma, arcoef = arco)

set.seed(1234)
y &lt;- mixAR_sim(model, 250, rep(0, max(model@order)), nskip = 100)  # data

nsim &lt;- 10 # 50
marg_loglik(y, model, tau = c(.15, .25), nsim = nsim, 0.5)
</code></pre>


</div>