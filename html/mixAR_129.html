<div class="container">

<table style="width: 100%;"><tr>
<td>fit_mixARreg-methods</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fit time series regression models with mixture autoregressive residuals
</h2>

<h3>Description</h3>

<p>Estimate a linear regression model for time series with residuals
from a mixture autoregressive process.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit_mixARreg(x, y, mixARmodel, EMinit, ...)

mixARreg(x, y, mixARmodel, tol = 1e-6, niter = 200)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the response time series (currently a numeric vector).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p><code>data.frame</code>, <code>matrix</code> or <code>numeric</code> vector. If either
of the first two, each column must contain one covariate (currently
numeric). A check for matching lengths between <code>x</code> and <code>y</code>
is done. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mixARmodel</code></td>
<td>

<p>An object inheriting from class <code>"MixAR"</code>, giving initial
values for EM-estimation of mixture autoregressive
parameters. Currenlty only <code>"MixARGaussian"</code> is supported.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EMinit</code></td>
<td>

<p>starting values for EM estimation of MixAR parameters. If present,
must be a named list, containing at least <code>prob</code> and
<code>scale</code> as numeric vectors, and a list for <code>arcoef</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>

<p>threshold for convergence criterion.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>passed on to <code>MixARreg</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter</code></td>
<td>
<p>maximal number of iterations.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>fit_mixARreg</code> is a generic function. 
Currently there is no default method for <code>fit_mixARreg</code>.
Arguments <code>y</code>, <code>mixARmodel</code>, <code>EMinit</code> can be given in a
number of ways, see individual methods for details. 
</p>
<p>Argument <code>mixARmodel</code> gives the details of the the MixAR part of
the model and initial values for the parameters. For
<code>fit_mixARreg</code> this can alternatively be done with a list using 
argument <code>EMinit</code>. Currently, at least one of the two must be
supplied, and if both are present <code>EMinit</code> is ignored.
</p>
<p><code>mixARreg</code> performs a two-step estimation of a linear regression
model with mixture autoregressive residuals.  It is the workhorse for
<code>fit_mixARreg</code> which calls it to do the computations.
</p>


<h3>Value</h3>

  
<table>
<tr style="vertical-align: top;">
<td><code>reg</code></td>
<td>
<p>The summary output of the regression part of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mixARmodel</code></td>
<td>

<p>Estimates of the mixture autoregressive part of the model. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter</code></td>
<td>
<p>The number of iterations until convergence.</p>
</td>
</tr>
</table>
<h3>Methods</h3>


<dl>
<dt><code>signature(x = "ANY", y = "data.frame", mixARmodel =
	"MixAR", EMinit = "missing")
    </code></dt>
<dd>
<p>Covariates <code>y</code> are supplied as <code>data.frame</code>: each column
corresponds to one covariate. Initialization of <code>MixAR</code> paramters is
done using input <code>mixARmodel</code></p>
</dd>
<dt>
<code>signature(x = "ANY", y = "matrix",
        mixARmodel = "MixAR", EMinit = "missing")</code>
</dt>
<dd>
<p>Covariates <code>y</code> are supplied as <code>matrix</code>: each column
corresponds to one covariate. Initialization of <code>MixAR</code> paramters is
done using input <code>mixARmodel</code></p>
</dd>
<dt>
<code>signature(x = "ANY", y = "numeric", mixARmodel = "MixAR", EMinit = "missing")</code>
</dt>
<dd>
<p>Covariates <code>y</code> is supplied as <code>numeric</code>: this method handles the
simple regression case with a single covairate. 
Initialization of <code>MixAR</code> paramters is done using input <code>mixARmodel</code></p>
</dd>
</dl>
<dl>
<dt><code>signature(x = "ANY", y = "ANY", mixARmodel = "missing", EMinit = "list")</code></dt>
<dd>
<p><code>EMinit</code> must be a named list (see 'Arguments').

</p>
</dd>
<dt><code>signature(x = "ANY", y = "ANY", mixARmodel = "MixAR", EMinit = "list")</code></dt>
<dd>
<p>When both <code>mixARmodel</code> and <code>EMinit</code> are supplied, the second is ignored.</p>
</dd>
</dl>
<h3>Note</h3>

<p>Estimation is done using the function <code>mixARreg</code> within each
method.
</p>


<h3>Author(s)</h3>

<p>Davide Ravagli and Georgi N. Boshnakov</p>


<h3>See Also</h3>

<p><code>fit_mixAR</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Simulate covariates
set.seed(1234)
n &lt;- 50 # for CRAN
y &lt;- data.frame(rnorm(n, 7, 1), rt(n, 3), rnorm(n, 3, 2))

## Build mixAR part
model &lt;- new("MixARGaussian", 
             prob   = exampleModels$WL_At@prob,      # c(0.5, 0.5)
             scale  = exampleModels$WL_At@scale,     # c(1, 2)        
             arcoef = exampleModels$WL_At@arcoef@a ) # list(-0.5, 1.1)

## Simulate from MixAR part
u &lt;- mixAR_sim(model, n, 0)

x &lt;- 10 + y[, 1] + 3 * y[, 2] + 2 * y[, 3] + u

## Fit model

## Using MixARGaussian
fit_mixARreg(x = x, y = y, mixARmodel = model, niter = 3)

## Using EMinit
EMinit &lt;- list(prob = exampleModels$WL_At@prob, scale = exampleModels$WL_At@scale,
               arcoef = exampleModels$WL_At@arcoef@a)
fit_mixARreg(x = x, y = y, EMinit = EMinit, niter = 3)
</code></pre>


</div>