<div class="container">

<table style="width: 100%;"><tr>
<td>mix_moment</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Conditional moments of MixAR models</h2>

<h3>Description</h3>

<p>Conditional moments of MixAR models.</p>


<h3>Usage</h3>

<pre><code class="language-R">mix_location(model, x, index, xcond)
mix_variance(model, x, index, xcond)
mix_central_moment(model, x, index, xcond, k)
mix_moment(model, x, index, xcond, k)
mix_kurtosis(...)
mix_ekurtosis(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a MixAR object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>

<p>a vector of indices in <code>x</code> for which to compute the requested
property.  If missing, the computation is done for all indices
greater than <code>max(model@order)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xcond</code></td>
<td>

<p>a time series, the point prediction is computed for the
first value after the end of the time series. Only the last
<code>max(model@order)</code> values in <code>xcond</code> are used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>a positive integer specifying the moment to compute.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>passed on to <code>mix_central_moment</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These functions compute conditional moments and related quantities.
</p>
<p><code>kurtosis</code> and <code>ekurtosis</code> compute conditional kurtosis and
excess kurtosis, respectively. Effectively, they have the same
parameters as <code>mix_central_moment</code>, since they pass <code>"..."</code>
to it along with <code>k = 4</code>. It is an error to supply argument
<code>k</code> to the kurtosis functions.
</p>


<h3>Value</h3>

<p>when called with one argument (<code>model</code>), a function with argument <code>xcond</code>;
otherwise if <code>xcond</code> is not missing, a single numeric value;
otherwise a vector of length <code>length(index)</code>.
</p>


<h3>Note</h3>


<p>I wrote the above description recently from reading six years old
code, it may need further verification. 
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>References</h3>

<p>Boshnakov GN (2009).
“Analytic expressions for predictive distributions in mixture autoregressive models.”
<em>Stat. Probab. Lett. </em>, <b>79</b>(15), 1704-1709.
<a href="https://doi.org/10.1016/j.spl.2009.04.009">doi:10.1016/j.spl.2009.04.009</a>.
</p>


<h3>See Also</h3>

<p><code>mix_pdf</code>, <code>mix_cdf</code>, <code>mix_qf</code>
for the predictive distributions (pdf, cdf, quantiles);
</p>


<h3>Examples</h3>

<pre><code class="language-R">## data(ibmclose, package = "fma") # `ibmclose'
ibmclose &lt;- as.numeric(fma::ibmclose)
length(ibmclose) # 369
max(exampleModels$WL_ibm@order) # 2

## compute point predictions for t = 3,...,369
pred &lt;- mix_location(exampleModels$WL_ibm, ibmclose)
plot(pred)
## compute one-step point predictions for t = 360,...369
mix_location(exampleModels$WL_ibm, ibmclose, index = 369 - 9:0 )

f &lt;- mix_location(exampleModels$WL_ibm) # a function
## predict the value after the last
f(ibmclose)

## a different way to compute one-step point predictions for t = 360,...369
sapply(369 - 10:1, function(k) f(ibmclose[1:k]))

## the results are the same, but notice that xcond gives past values
## while index above specifies the times for which to compute the predictions.
identical(sapply(369 - 10:1, function(k) f(ibmclose[1:k])),
          mix_location(exampleModels$WL_ibm, ibmclose, index = 369 - 9:0 ))


## conditional variance
f &lt;- mix_variance(exampleModels$WL_ibm) # a function
## predict the value after the last
f(ibmclose)

## a different way to compute one-step point predictions for t = 360,...369
sapply(369 - 10:1, function(k) f(ibmclose[1:k]))

## the results are the same, but notice that xcond gives past values
## while index above specifies the times for which to compute the predictions.
identical(sapply(369 - 10:1, function(k) f(ibmclose[1:k])),
          mix_variance(exampleModels$WL_ibm, ibmclose, index = 369 - 9:0 ))


# interesting example
# bimodal distribution, low kurtosis, 4th moment not much larger than 2nd
moWL &lt;- exampleModels$WL_ibm

mix_location(moWL,xcond = c(500,450))
mix_kurtosis(moWL,xcond = c(500,450))

f1pdf &lt;- mix_pdf(moWL,xcond = c(500,450))
f1cdf &lt;- mix_cdf(moWL,xcond = c(500,450))
gbutils::plotpdf(f1pdf,cdf=f1cdf)
gbutils::plotpdf(f1cdf,cdf=f1cdf)
f1cdf(c(400,480))

mix_variance(moWL,xcond = c(500,450))
mix_central_moment(moWL,xcond = c(500,450), k=2)

sqrt(mix_variance(moWL,xcond = c(500,450)))
sqrt(mix_central_moment(moWL,xcond = c(500,450), k=2))
</code></pre>


</div>