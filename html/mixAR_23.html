<div class="container">

<table style="width: 100%;"><tr>
<td>bayes_mixAR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian sampling of mixture autoregressive models</h2>

<h3>Description</h3>

<p>Samples parameters of a mixture autoregressive model from respective
posterior distributions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bayes_mixAR(y, model, fix_shift = FALSE, a = .2, c = 2, tau, nsim, burnin)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a time series (currently a numeric vector).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>an object of class <code>MixAR</code>. Currently only handles
<code>MixARGaussian</code> objects.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix_shift</code></td>
<td>

<p>should <code>shift</code> be kept fixed? If <code>FALSE</code> (default)
<code>shift</code> is sampled.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a, c</code></td>
<td>

<p>numeric hyperparameters, default values are from
Richardson and Green (1997).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>

<p><code>numeric</code> vector of length g, the number of components in the
mixture. Tuning parameter for M-H move in updating AR parameters. If
<code>length(tau)</code> is 1, same tuning parameter is taken for all
components.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>

<p><code>numeric</code>, the number of iterations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>

<p><code>numeric</code>, the number of iterations taken as burn-in period.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For details see Ravagli and Boshnakov (2020).
</p>


<h3>Value</h3>

<p>a list with following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mix_weights</code></td>
<td>

<p>a <code>g</code> columns matrix with samples from the posterior distributions of
the mixing weights.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>

<p>a <code>g</code> columns matrix with samples from posterior distributions of
scale parameters.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>precision</code></td>
<td>

<p>a <code>g</code> columns matrix with samples from posterior distributions of
precision parameters, defined as <code>1 / (scale ^ 2)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shift</code></td>
<td>

<p>a <code>g</code> columns matrix with samples from posterior distributions of
shift parameters, namely phi_k0.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>

<p>a <code>g</code> columns matrix with samples from posterior distributions
of component means, calculated as <code>phi_k0 / (1 - phi_k1 - phi_k2 - ...)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ARcoeff</code></td>
<td>

<p>a list which elements are matrices, one for each AR component in the
mixture.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acc_rate</code></td>
<td>

<p><code>numeric</code> vector, the acceptance rate for M-H moves.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_samp</code></td>
<td>

<p>the sample size, calculated as <code>nsim - burnin</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LatentZ</code></td>
<td>

<p>the latest Z variables drawn (for utility only).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_comp</code></td>
<td>

<p>the number of components in the mixture.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix_shift</code></td>
<td>

<p>same as input, whether the shift parameter was kept fixed or not.
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Davide Ravagli
</p>


<h3>References</h3>

<p>Richardson S, Green PJ (1997).
“On Bayesian Analysis of Mixtures with an Unknown Number of Components.”
<em>J. R. Stat. Soc., Ser. B, Stat. Methodol. </em>, <b>59</b>(4), 731-792.
</p>
<p>Ravagli D, Boshnakov GN (2020).
“Bayesian analysis of mixture autoregressive models covering the complete parameter space.”
2006.11041, <a href="https://arxiv.org/abs/2006.11041">https://arxiv.org/abs/2006.11041</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">prob &lt;- c(0.5, 0.5)
sigma &lt;- c(1, 2)
ar &lt;- list(-0.5, 1)

model &lt;- new("MixARGaussian", prob = prob, scale = sigma, arcoef = ar)

## MAR(1,1) model
y &lt;- mixAR_sim(model, 300, rep(0, max(model@order)))

bayes_mixAR(y, model, fix_shift = FALSE, tau = c(.15,.25), nsim = 20, burnin = 10)
</code></pre>


</div>