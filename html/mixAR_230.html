<div class="container">

<table style="width: 100%;"><tr>
<td>multiStep_dist-methods</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multi-step predictions for MixAR models</h2>

<h3>Description</h3>

<p>Multi-step predictions for MixAR models.</p>


<h3>Usage</h3>

<pre><code class="language-R">multiStep_dist(model, maxh, N, xcond, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a MixAR model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxh</code></td>
<td>
<p>maximal horizon, a positive integer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>

<p>an integer specifying the number of simulation samples to use, see
'Details. This argument is used only by simulation based methods.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xcond</code></td>
<td>

<p>the past values needed for the conditional distribution, a numeric
vector of length at least the maximal AR order of the components.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>used only in some methods, see the details for the individual
methods.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function currently implements two methods: the exact method due to
Boshnakov (2009) and a simulation
method described by (Wong and Li 2000) for Gaussian MixAR
models but valid more generally.
</p>
<p>The simulation method is available for any MixAR model, while
the exact method is currently implemented only for models with
Gaussian components ("MixARGaussian" class).
</p>
<p><code>multiStep_dist</code> returns a function which can be used to obtain
various properties of the predictive distribution for lags up to
<code>maxh</code>.
</p>
<p>If argument <code>N</code> is missing the exact method is tried. Currently
an error will result if the exact method is not implemented for
<code>model</code>.
</p>
<p>If argument <code>N</code> is given it must be a scalar numeric value, the
number of simulations to be performed to construct an approximation
for the predictive distributions.
</p>
<p>The simulation is done by <code>multiStep_dist</code>. The properties
obtained later from the function returned by <code>multiStep_dist</code> use
the samples generated by the call to <code>multiStep_dist</code>.
To do a simulation with different parameters (e.g., with larger
<code>N</code>) call <code>multiStep_dist</code> again.
</p>


<h4>Details on the returned function</h4>

<p>If <code>xcond</code> is missing <code>multiStep_dist</code> returns a function
with arguments <code>h</code>, <code>what</code> and <code>xcond</code>.

If <code>xcond</code> is supplied, then it is fixed to that value and the
arguments of the returned function are <code>h</code>, <code>what</code> and
<code>'...'</code>. The dots argument is currently used in the case of the
simulation method, see below.
</p>
<p>Let <code>f</code> be the function returned by <code>multiStep_dist</code>.
Argument <code>h</code> is the required prediction horizon and can be a
number in the interval <code class="reqn">[1,maxh]</code>. Argument <code>what</code> is the
required property of the predictive distribution for lag
<code>h</code>. If <code>what</code> is a function, it is applied to the simulated
sample for the requested horizon (currently available only for
the simulation method). If <code>what</code> is a character string, the
corresponding property of the predictive distribution for horizon
<code>h</code> is returned.
Currently possible values for <code>what</code> are:
</p>

<dl>
<dt>"pdf"</dt>
<dd>
<p>the probability density function.</p>
</dd>
<dt>"cdf"</dt>
<dd>
<p>the cumulative distribution function.</p>
</dd>
<dt>"location"</dt>
<dd>
<p>the location (conditional mean).</p>
</dd>
<dt>"variance"</dt>
<dd>
<p>the conditional variance, a.k.a (squared) volatility.</p>
</dd>
<dt>"sd"</dt>
<dd>
<p>the conditional standard deviation, a.k.a volatility.</p>
</dd>
<dt>"skewness"</dt>
<dd>
<p>the conditional skewness.</p>
</dd>
<dt>"kurtosis"</dt>
<dd>
<p>the conditional kurtosis.</p>
</dd>
</dl>
<p>Note that <code>what = "pdf"</code> and <code>what = "cdf"</code> return functions
even in the simulation case. For "pdf" the function is constructed
using <code>density</code> and the <code>"..."</code> arguments passed to <code>f</code> will
be passed on to <code>density</code> if finer control is needed.
</p>
<p>If <code>what</code> is none of the above, the raw object is returned
currently (but this may change).
</p>



<h3>Value</h3>

<p>a function as described in sections ‘Details’ and ‘Methods’
</p>


<h3>Methods</h3>

<p>The Details section gives a rather detailed description of the
function, so the descriptions below are brief.
</p>

<dl>
<dt><code>signature(model = "MixAR", maxh = "numeric", N = "numeric",
	xcond = "numeric")</code></dt>
<dd> 
<p>Non-missing <code>N</code> requests the simulation method. The
predictive distribution is approximated by simulating <code>N</code>
of future paths up to horizon <code>maxh</code> and using a
non-parametric estimate. Arguments <code>"..."</code> are passed to
<code>density</code> to allow finer control.
</p>
</dd>
<dt><code>signature(model = "MixARGaussian", maxh = "numeric", N = "missing", 
	xcond = "missing")</code></dt>
<dd>
<p>Computes the predictive distribution using the exact method.
Returns a function with arguments <code>h</code>, <code>what</code> and <code>xcond</code>.
</p>
</dd>
<dt><code>signature(model = "MixARGaussian", maxh = "numeric", N = "missing",
	xcond = "ANY")</code></dt>
<dd>
<p>Computes the predictive distribution using the exact method.
Returns a function with arguments <code>h</code> and <code>what</code>.
(i.e., <code>xcond</code> is fixed to the supplied argument <code>xcond</code>).
</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>References</h3>

<p>Boshnakov GN (2009).
“Analytic expressions for predictive distributions in mixture autoregressive models.”
<em>Stat. Probab. Lett. </em>, <b>79</b>(15), 1704-1709.
<a href="https://doi.org/10.1016/j.spl.2009.04.009">doi:10.1016/j.spl.2009.04.009</a>.<br><br> Wong CS, Li WK (2000).
“On a mixture autoregressive model.”
<em>J. R. Stat. Soc., Ser. B, Stat. Methodol. </em>, <b>62</b>(1), 95-115.
</p>


<h3>See Also</h3>

<p><code>predict_coef</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## exact method, without xcond
dist &lt;- multiStep_dist(exampleModels$WL_ibm, maxh = 3)

tfpdf &lt;- dist(3, "pdf", xcond = c(560, 600)) # xcond is argument to 'dist' here
tfcdf &lt;- dist(3, "cdf", xcond = c(560, 600))
## plot the pdf (gbutils::plotpdf determines suitable range automatically)
gbutils::plotpdf(tfpdf, cdf = tfcdf)

args(dist(3, "pdf", xcond = c(500, 600)))  # x

## use a simulation method with N = 1000
tf  &lt;- multiStep_dist(exampleModels$WL_ibm, maxh = 3, N = 1000, xcond = c(560, 600))
args(tf) # (h, what, ...)

## the exact method may also be used with fixed xcond:
tfe &lt;- multiStep_dist(exampleModels$WL_ibm, maxh = 3, xcond = c(560, 600))

## get pdf and cdf for horizon 3
tfepdf &lt;- tfe(3, "pdf")
tfecdf &lt;- tfe(3, "cdf")
## plot the pdf
gbutils::plotpdf(tfepdf, cdf = tfecdf)

tf(3, "location")

tf(1, "location")
mix_location(exampleModels$WL_ibm, xcond = c(560, 600))

## larger simulation gives better approximation, in general
tf &lt;- multiStep_dist(exampleModels$WL_ibm, maxh = 3, N = 10000, xcond = c(560, 600))
tf(1, "location")

tf1000pdf &lt;- tf(3, "pdf")
tf1000cdf &lt;- tf(3, "cdf")
gbutils::plotpdf(tf1000pdf, cdf = tf1000cdf)

## plot the exact and simulated pdf's together for comparison
gbutils::plotpdf(tfepdf, cdf = tfecdf)
curve(tf1000pdf, add = TRUE, col = "red")

## get the raw data
tfs &lt;- tf(1, "sampled")
apply(tfs, 2, mean) # location for lags from 1 to maxh (here 3)

tf(1, "location")
tf(1, "variance")
tf(1, "sd")
mix_variance(exampleModels$WL_ibm, xcond = c(560, 600))
sqrt(mix_variance(exampleModels$WL_ibm, xcond = c(560, 600)))

mix_kurtosis(exampleModels$WL_ibm, xcond = c(359, 200))
mix_kurtosis(exampleModels$WL_ibm, xcond = c(359, 400))
</code></pre>


</div>