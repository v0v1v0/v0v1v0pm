<div class="container">

<table style="width: 100%;"><tr>
<td>Choose_pk</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Choose the autoregressive order of MixAR components</h2>

<h3>Description</h3>

<p>Reversible Jump MCMC algorithm to choose the optimal
autoregressive order of each component of a mixture autoregressive
model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Choose_pk(y, model, fix_shift = FALSE, tau, pmax, method, par = NULL, nsim)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>a time series. Currently a <code>numeric</code> vector.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>an object inheriting from class <code>"MixAR"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix_shift</code></td>
<td>

<p>whether the shift/mean parameter should be kept fixed to its
starting value or not. Default is <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>

<p>tuning parameters for Metropolis-Hastings algorithm in sampling AR
coefficients.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pmax</code></td>
<td>

<p>the largest autoregressive order allowed for each component.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>character vector of length 1. Method for calculating probability of
new AR order to be increased/decreased by 1 unit. Currently
available <code>"Ratio"</code>, <code>"Poisson"</code> and
<code>"NULL"</code>. Default is <code>"NULL"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>

<p><code>numeric</code>, parameter for tuning probabilities according to
<code>method</code>. Ignored if <code>method</code> is "NULL".
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>

<p><code>numeric</code>, the number of iterations.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>out</code></td>
<td>

<p>a dataframe with <code>g+1</code> columns. The first <code>g</code> columns
contain the autoregressive orders of the components, the last column
how often a model is preferred, divided by <code>nsim</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix_shift</code></td>
<td>
<p>the choice made for the shift/mean parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the method used to increase/decrease AR orders.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p><code>Choose_pk</code> currenlty supports class <code>"MixARGaussian"</code>
only.
</p>


<h3>Author(s)</h3>

<p>Davide Ravagli</p>


<h3>References</h3>

<p>Ravagli D, Boshnakov GN (2020).
“Bayesian analysis of mixture autoregressive models covering the complete parameter space.”
2006.11041, <a href="https://arxiv.org/abs/2006.11041">https://arxiv.org/abs/2006.11041</a>.
</p>


<h3>See Also</h3>

<p><code>bx_dx</code> for more details on the <code>method</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">model &lt;- new("MixARGaussian", 
             prob   = exampleModels$WL_At@prob,      # c(0.5, 0.5)
             scale  = exampleModels$WL_At@scale,     # c(1, 2)        
             arcoef = list(-0.5, 1) )
             # note: arcoef != list(-0.5, 1.1) == exampleModels$WL_At@arcoef@a

set.seed(1234)
n &lt;- 50 # 200
y &lt;- mixAR_sim(model, n, rep(0, max(model@order)), nskip = 100)

nsim &lt;- 25 # 100
pk_star &lt;- Choose_pk(y, model, tau = c(.15, .25), pmax = 5, method = "NULL", nsim = nsim)
</code></pre>


</div>