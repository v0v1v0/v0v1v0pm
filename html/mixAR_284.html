<div class="container">

<table style="width: 100%;"><tr>
<td>sampZpi</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Sampling functions for Bayesian analysis of mixture autoregressive
models
</h2>

<h3>Description</h3>

<p>Sampling functions for Bayesian analysis of mixture autoregressive
models. Draws observations from posterior distributions of the latent
variables <code>Z_t</code>s and the parameters of mixture autoregressive
models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sampZpi(y, pk, prob, mu, AR, sigma, nsim, d)
sampMuShift(y, pk, prec, nk, shift, z, AR, nsim)
sampSigmaTau(y, pk, prec, nk, AR, mu, z, a, c, nsim)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a time series (currently a  <code>numeric</code> vector).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pk</code></td>
<td>

<p><code>numeric</code> vector of length <code>g</code>. The autoregressive order
of each component.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>

<p><code>numeric</code> vector of length <code>g</code>. Current mixing weights.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>

<p><code>numeric</code> vector of length <code>g</code>. Current mean parameters.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shift</code></td>
<td>

<p><code>numeric</code> vector of length <code>g</code>. Current shift parameters.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AR</code></td>
<td>

<p><code>list</code> of <code>g</code> elements. Autoregressive coefficients for
each component.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>

<p><code>numeric</code> vector of length <code>g</code>. Current scale parameters
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>dessired sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>

<p><code>numeric</code> vector of length <code>g</code>. Hyperparameters for
Dirichlet prior. If missing, a vector of <code>1</code>s is generated. If
length is <code>1</code>, creates a vector of length <code>g</code> with given
number.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prec</code></td>
<td>

<p><code>numeric</code> vector of length <code>g</code>. Current precision
parameters.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nk</code></td>
<td>

<p>output from <code>sampZpi</code>. Component sum of latent variables Z_t.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>

<p>output <code>latentZ</code> from <code>sampZpi</code>. A matrix containing the
simulated latent variables.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a,c</code></td>
<td>
<p>hyperparameters.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>sampZpi</code> draws observations from posterior distributions of the
latent variables <code>Z_t</code>s and mixing weights of a Mixture
autoregressive model.
</p>
<p><code>sampSigmaTau</code> draws observations from posterior distributions of
the precisions <code>tau_k</code> of a Mixture autoregressive model, and
obtains scales <code>sigma_k</code> by transformation.
</p>
<p><code>sampMuShift</code> Draws observations from posterior distributions of
the means <code>mu_k</code> of a Mixture autoregressive model, and obtains
shifts <code>phi_k0</code> by transformation.
</p>


<h3>Value</h3>

<p>for <code>sampZpi</code>, a list containing the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mix_weights</code></td>
<td>

<p><code>matrix</code> with <code>nrow = nsim</code> and <code>ncol = g</code>: 
sampled mixing weights.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>latentZ</code></td>
<td>

<p><code>matrix</code> with <code>nrow = n - p</code> and <code>ncol = g</code>, <code>n</code> equal to
<code>length(y)</code> and <code>p</code> equal to <code>max(pk</code>: 
the simulated latent variables <code>Z_t</code> at the last of <code>nsim</code> iterations 
(functional). Specifically, each row contains <code>1</code> for exactly 
one component, and is filled with <code>0</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nk</code></td>
<td>

<p>Vector of length <code>g</code>. Column sums of <code>latentZ</code>.
</p>
</td>
</tr>
</table>
<p>for <code>sampMuShift</code>, a list containing the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>shift</code></td>
<td>

<p><code>matrix</code> with <code>nrow = nsim</code> and <code>ncol = g</code>: 
simulated shift parameters, obtained by transformation of the
means.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>

<p><code>matrix</code> with <code>nrow = nsim</code> and <code>ncol = g</code>:
simulated mean parameters.</p>
</td>
</tr>
</table>
<p>for <code>sampSigmaTau</code>, a list containing the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>

<p><code>matrix</code> with <code>nrow = nsim</code> and <code>ncol = g</code>: 
scale parameters, obtained by transformation
of precisions.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>precision</code></td>
<td>

<p><code>matrix</code> with <code>nrow = nsim</code> and <code>ncol = g</code>: 
precision parameters.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>

<p><code>numeric</code> vector of length <code>nsim</code> simulated values 
of hyperparameter lambda, due to hierarchical setup.
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Davide Ravagli</p>


<h3>Examples</h3>

<pre><code class="language-R">model &lt;- new("MixARGaussian",
             prob   = exampleModels$WL_At@prob,      # c(0.5, 0.5)
             scale  = exampleModels$WL_At@scale,     # c(1, 2)        
             arcoef = exampleModels$WL_At@arcoef@a ) # list(-0.5, 1.1)
             
prob  &lt;- model@prob
sigma &lt;- model@scale
prec  &lt;- 1 / sigma ^ 2
g     &lt;- length(model@prob)
d     &lt;- rep(1, g)
pk    &lt;- model@arcoef@p
p     &lt;- max(pk)
shift &lt;- mu &lt;- model@shift
         
AR &lt;- model@arcoef@a       

model

set.seed(1234)
n &lt;- 50 # 500
nsim &lt;- 50

y &lt;- mixAR_sim(model, n = n, init = 0)
x  &lt;- sampZpi(y, pk, prob, shift, AR, sigma, nsim = nsim, d)
x1 &lt;- sampMuShift(y, pk, prec, nk = x$nk, shift, z = x$latentZ, AR, nsim = nsim)
x2 &lt;- sampSigmaTau(y, pk, prec, nk = x$nk, AR, mu = x1$mu, z = x$latentZ,
                   a = 0.2, c = 2, nsim = nsim)
</code></pre>


</div>