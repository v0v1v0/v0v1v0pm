<div class="container">

<table style="width: 100%;"><tr>
<td>mixAR_diag</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Diagnostic checks for mixture autoregressive models
</h2>

<h3>Description</h3>

<p>Carry out diagnostic checks and tests on fitted mixAR models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'MixAR'
tsdiag(object, gof.lag = NULL, y, ask = interactive(), ..., 
       plot = interactive(), std.resid = FALSE)

mixAR_diag(model, y, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model,object</code></td>
<td>

<p>the model on which to perform the checks, an object from class
<code>MixAR</code>. <code>model</code> can also be the output list from
<code>fit_mixAR</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gof.lag</code></td>
<td>

<p>Goodness of fit lag(s) for the Ljung-Box tests. Vector containing
one or more positive integers. <code>max(gof.lag)</code> is the maximal
lag in the acf and pacf plots.
</p>
<p>how many lags to compute for acf and pacf? The default is as that of
<code>lag.max</code> for <code>acf</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a time series, currently a <code>numeric</code> vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ask</code></td>
<td>

<p>if <code>TRUE</code>, ask (using a menu) which plot to present. Otherwise
just plot the selected plots. <code>ask</code> is ignored if only one plot 
is selected with argument <code>plot</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>

<p>if <code>TRUE</code>, the default, produce diagnostic plots. If
<code>FALSE</code> don't produce plots. Otherwise, a numeric vector of
integers defining a subset of plots to consider, see Details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>std.resid</code></td>
<td>

<p>if <code>TRUE</code> standardise the ordinary residuals using
the conditional standard deviations. <strong>NOTE:</strong>  the default is
currently <code>FALSE</code> but it may soon be changed to <code>TRUE</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>for <code>mixAR_diag</code>, passed on to <code>tsdiag</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>It is recommended to use <code>tsdiag</code>.  <code>mixAR_diag</code> is
essentially deprecated and is still here for compatibility with old
code. Moreover, the <code>tsdiag</code> method is more flexible. The only
advantage of <code>mixAR_diag</code> is that it accepts also a list for
argument <code>model</code> but this is equivalent to calling <code>tsdiag</code>
with <code>object = model$model</code>.
</p>
<p>The function calculates several types of residuals, provides
diagnostic plots for each of them, and returns numerical results.
The following choices are currently available:
</p>

<ol>
<li>
<p> ACF/PACF of residuals,
</p>
</li>
<li>
<p> ACF/PACF of U_residuals,
</p>
</li>
<li>
<p> ACF/PACF of tau_residuals,
</p>
</li>
<li>
<p> ACF/Histogram of tau_residuals.
</p>
</li>
</ol>
<p>In interactive sessions the user is presented with a menu to select
plot(s) from the available ones. The choice can be restricted to a
subset of them by giving argument <code>plot</code> a vector of integers.
This is most useful to select a particular plot, with somethinng like
<code>plot = 2</code> in the call to <code>tsdiag</code>.  <code>plot</code> is used as
an index vector, so <code>plot = -1</code> would remove the first item
listed above from the offered alternatives.
</p>
<p>Transformations on the data are performed, as described in Smith
(1985).
</p>
<p>Four types of residuals are computed:
</p>

<dl>
<dt>ordinary residuals</dt>
<dd>
<p>difference (possibly scaled) between observed values and point
predictions.
</p>
</dd>
<dt>U_residuals/PIT residuals</dt>
<dd>
<p>probability integral transform of the data using the CDF of the
conditional distributions implied by the fitted model.  For a good
model these should resemble an IID sequence uniformly distributed
on (0,1).


</p>
</dd>
<dt>V_residuals</dt>
<dd>
<p>set of transformed <code>U_residuals</code> with the quantile function
of the standard normal distribution (<code>qnorm</code>).  For a good
model these should resemble an IID sequence from N(0,1).
</p>
</dd>
<dt>tau_residuals</dt>
<dd>
<p>These residuals are calculated as the component specific residual
<code>e_tk</code> divided by its corresponding scale <code>sigma_k</code>,
according to under which component y_t has largest density.  Under
correct model specification, these should be jointly
Normal. Shapiro-Wilk test is performed on this set of residual to
assess the hypothesis.
</p>
</dd>
</dl>
<p>For all types of residual results for the Ljung-Box test are
provided. This test is particularly relevant for the V- and
tau-residuals.
</p>
<p>Kolmogorov-Smirnov test is carried out for the U_residuals to assess
the hypothesis of uniform distribution.
</p>
<p>Shapiro-Wilk test of normality is applied to V- and tau-residuals.
</p>


<h3>Value</h3>

<p>returns invisibly a list with class <code>"tsdiagMixAR"</code>, currently
containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>ordinary residuals,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U_residuals</code></td>
<td>
<p>see Details,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V_residuals</code></td>
<td>
<p>see Details,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau_residuals</code></td>
<td>
<p>see Details,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BIC</code></td>
<td>
<p>the value of the BIC criterion, a number.</p>
</td>
</tr>
</table>
<p>Each component, except <code>BIC</code>, is a list containing the residuals
in component <code>value</code>, Ljung-Box test in <code>"Ljung-Box"</code> and
possibly other tests suitable for the corresponding type of
residuals. 
</p>


<h3>Note</h3>

<p>This function should be used for diagnostic checking of <code>MixARGaussian</code>
objects only.
</p>


<h3>Author(s)</h3>

<p>Davide Ravagli and Georgi N. Boshnakov</p>


<h3>References</h3>

<p>Smith JQ (1985).
“Diagnostic checks of non-standard time series models.”
<em>Journal of Forecasting</em>, <b>4</b>(3), 283-291.
<a href="https://doi.org/10.1002/for.3980040305">doi:10.1002/for.3980040305</a>, https://onlinelibrary.wiley.com/doi/pdf/10.1002/for.3980040305, <a href="https://onlinelibrary.wiley.com/doi/abs/10.1002/for.3980040305">https://onlinelibrary.wiley.com/doi/abs/10.1002/for.3980040305</a>.
</p>
<p>Wong CS, Li WK (2000).
“On a mixture autoregressive model.”
<em>J. R. Stat. Soc., Ser. B, Stat. Methodol. </em>, <b>62</b>(1), 95-115.
</p>


<h3>See Also</h3>

<p><code>mixAR_BIC</code>,
<code>tsdiag</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">model1 &lt;- new("MixARGaussian", prob = c(0.5, 0.5), scale = c(1, 2),
              arcoef = list(-0.5, 1.1))
set.seed(123)
y &lt;- mixAR_sim(model1, 400, c(0,0,0), nskip = 100) 

fit1 &lt;- fit_mixAR(y, model1)
d &lt;- tsdiag(fit1$model, c(10, 20, 50), y)
d
## This will put each plot in a separate file (mydiag01.pdf, ..., mydiag04.pdf)
## pdf("mydiag%02d.pdf", onefile = FALSE)
## d &lt;- tsdiag(fit1$model, c(10, 20, 50), y,  ask = FALSE)
## dev.off()
</code></pre>


</div>