<div class="container">

<table style="width: 100%;"><tr>
<td>stableEM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Stable EM solution</h2>

<h3>Description</h3>

<p>This function performs the clustering for different EM starting values in order
to find a stable solution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">stableEM(x, K, numEMstart = 5, method = "separate", Sdist = "weibull", cutpoint = NULL,
EMoption = "classification", EMstop = 0.0001, maxiter = 1000, print.likvec = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Data frame or matrix of dimension n*p with survival times (<code>NA</code>'s allowed).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Number of mixture components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numEMstart</code></td>
<td>
<p>Number of different starting solutions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Imposing proportionality restrictions on the hazards: 
With <code>separate</code> no restrictions are imposed, <code>main.g</code> relates to a group main effect, 
<code>main.p</code> to the variables main effects. <code>main.gp</code> reflects the proportionality assumption over groups
and variables. <code>int.gp</code> allows for interactions between groups and variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sdist</code></td>
<td>
<p>Various survival distrubtions such as <code>weibull</code>, <code>exponential</code>, and <code>rayleigh</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutpoint</code></td>
<td>
<p>Integer value with upper bound for observed dwell times. Above this cutpoint, values are regarded as censored. If NULL, no censoring is performed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EMoption</code></td>
<td>
<p><code>classification</code> is based on deterministic cluster assignment, 
<code>maximization</code> on deterministic assignment, and <code>randomization</code> 
provides a posterior-based randomized cluster assignement.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EMstop</code></td>
<td>
<p>Stopping criterion for EM-iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>Maximum number of iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.likvec</code></td>
<td>
<p>If <code>TRUE</code> the likelihood values for different starting solutions are printed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>After the computation of the models for different starting solutions using the
function <code>phmclust</code> the best model is chosen, i.e., the model with the largest likelihood value. 
The output values refer to this final model.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>mws</code> with the following values:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Number of components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>Number of EM iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Method with propotionality restrictions used for estimation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sdist</code></td>
<td>
<p>Assumed survival distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>likelihood</code></td>
<td>
<p>Log-likelihood value for each iteration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvisit</code></td>
<td>
<p>Matrix of prior probabilities due to <code>NA structure</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.pvisit</code></td>
<td>
<p>Standard errors for priors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape</code></td>
<td>
<p>Matrix with shape parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>Matrix with scale parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>Final deterministic cluster assignment</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posteriors</code></td>
<td>
<p>Final probabilistic cluster assignment</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npar</code></td>
<td>
<p>Number of estimated parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aic</code></td>
<td>
<p>Akaike information criterion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bic</code></td>
<td>
<p>Bayes information criterion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clmean</code></td>
<td>
<p>Matrix with cluster means</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.clmean</code></td>
<td>
<p>Standard errors for cluster means</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clmed</code></td>
<td>
<p>Matrix with cluster medians</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>phmclust</code>,<code>msBIC</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
## Exponental mixture model with 2 components for 4 different starting solutions
data(webshop)
res &lt;- stableEM(webshop, K = 2, numEMstart = 4, Sdist = "exponential")
res
summary(res)
</code></pre>


</div>