<div class="container">

<table style="width: 100%;"><tr>
<td>phmclust</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fits mixtures of proportional hazard models</h2>

<h3>Description</h3>

<p>This function allows for the computation of proportional hazards models with different distribution assumptions 
on the underlying baseline hazard. Several options for imposing proportionality restrictions on the hazards are provided.
This function offers several variations of the EM-algorithm regarding the posterior computation in the M-step.
</p>


<h3>Usage</h3>

<pre><code class="language-R">phmclust(x, K, method = "separate", Sdist = "weibull", cutpoint = NULL, EMstart = NA, 
EMoption = "classification", EMstop = 0.01, maxiter = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Data frame or matrix of dimension n*p with survival times (<code>NA</code>'s allowed).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Number of mixture components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Imposing proportionality restrictions on the hazards: 
With <code>"separate"</code> no restrictions are imposed, <code>"main.g"</code> relates to a group main effect, 
<code>"main.p"</code> to variable main effects. <code>"main.gp"</code> reflects the proportionality assumption over groups
and variables. <code>"int.gp"</code> allows for interactions between groups and variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sdist</code></td>
<td>
<p>Various survival distrubtions such as <code>"weibull"</code>, <code>"exponential"</code>, and <code>"rayleigh"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutpoint</code></td>
<td>
<p>Integer value with upper bound for observed dwell times. Above this cutpoint, values are regarded as censored. If NULL, no censoring is performed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EMstart</code></td>
<td>
<p>Vector of length n with starting values for group membership, 
<code>NA</code> indicates random starting values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EMoption</code></td>
<td>
<p><code>"classification"</code> is based on deterministic cluster assignment, 
<code>"maximization"</code> on deterministic assignment, and <code>"randomization"</code> 
provides a posterior-based randomized cluster assignement.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EMstop</code></td>
<td>
<p>Stopping criterion for EM-iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>Maximum number of iterations.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The method <code>"separate"</code> corresponds to an ordinary mixture model. <code>"main.g"</code> imposes proportionality 
restrictions over variables (i.e., the group main effect allows for free-varying variable hazards). <code>"main.p"</code> 
imposes proportionality restrictions over groups (i.e., the variable main effect allows for free-varying group hazards).
If clusters with only one observation are generated, the algorithm stops. 
</p>


<h3>Value</h3>

<p>Returns an object of class <code>mws</code> with the following values:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Number of components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>Number of EM iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Proportionality restrictions used for estimation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sdist</code></td>
<td>
<p>Assumed survival distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>likelihood</code></td>
<td>
<p>Log-likelihood value for each iteration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvisit</code></td>
<td>
<p>Matrix of prior probabilities due to <code>NA structure</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.pvisit</code></td>
<td>
<p>Standard errors for priors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape</code></td>
<td>
<p>Matrix with shape parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>Matrix with scale parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>Final deterministic cluster assignment</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posteriors</code></td>
<td>
<p>Final probabilistic cluster assignment</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npar</code></td>
<td>
<p>Number of estimated parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aic</code></td>
<td>
<p>Akaike information criterion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bic</code></td>
<td>
<p>Bayes information criterion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clmean</code></td>
<td>
<p>Matrix with cluster means</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.clmean</code></td>
<td>
<p>Standard errors for cluster means</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clmed</code></td>
<td>
<p>Matrix with cluster medians</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Mair, P., and Hudec, M. (2009). Multivariate Weibull mixtures with proportional hazard
restrictions for dwell time based session clustering with incomplete data. Journal of
the Royal Statistical Society, Series C (Applied Statistics), 58(5), 619-639.
</p>
<p>Celaux, G., and Govaert, G. (1992). A classification EM algorithm for clustering and
two stochastic versions. Computational Statistics and Data Analysis, 14, 315-332.
</p>


<h3>See Also</h3>

<p><code>stableEM</code>, <code>msBIC</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">
data(webshop)

## Fitting a Weibll mixture model (3 components) is fitted with classification EM 
## Observations above 600sec are regarded as censored

res1 &lt;- phmclust(webshop, K = 3, cutpoint = 600)
res1
summary(res1)

## Fitting a Rayleigh Weibull proportional hazard model (2 components, proportional over groups)
res2 &lt;- phmclust(webshop, K = 2, method = "main.p", Sdist = "rayleigh") 
res2
summary(res2)

</code></pre>


</div>