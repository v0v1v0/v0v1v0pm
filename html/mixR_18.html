<div class="container">

<table style="width: 100%;"><tr>
<td>select</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Finite Mixture Model Selection by Information Criterion</h2>

<h3>Description</h3>

<p>This function selects the best model from a candidate of mixture models based on the
information criterion BIC.
</p>


<h3>Usage</h3>

<pre><code class="language-R">select(
  x,
  ncomp,
  family = c("normal", "weibull", "gamma", "lnorm"),
  mstep.method = c("bisection", "newton"),
  init.method = c("kmeans", "hclust"),
  tol = 1e-06,
  max_iter = 500
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector for raw data or a three-column matrix for the binned data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncomp</code></td>
<td>
<p>a vector of positive integers specifying the number of components of the candidate mixture models</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>a character string specifying the family of the mixture model. It can only be
one element from <code>normal</code>, <code>weibull</code>, <code>gamma</code> or <code>lnorm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mstep.method</code></td>
<td>
<p>a character string specifying the method used in M-step of the EM algorithm
when fitting weibull or gamma mixture models. It can be either <code>bisection</code> or <code>newton</code>.
The default is <code>bisection</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init.method</code></td>
<td>
<p>a character string specifying the method used for providing initial values
for the parameters for EM algorithm. It can be one of <code>kmeans</code> or <code>hclust</code>. The default is
<code>kmeans</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>the tolerance for the stopping rule of EM algorithm. It is the value to stop EM algorithm when the two
consecutive iterations produces loglikelihood with difference less than <code>tol</code>. The default value is 1e-6.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_iter</code></td>
<td>
<p>the maximum number of iterations for the EM algorithm (default 500).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>By specifying different number of components, the function <code>select</code> fits a series
of mixture models for a given family, and a mixture model with minimum value of BIC
is regarded as the best.
</p>


<h3>Value</h3>

<p>The function returns an object of class <code>selectEM</code> which contains the following items.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>ncomp</code></td>
<td>
<p>the specified number of components of the candidate mixture models</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>equal.var</code></td>
<td>
<p>a logical vector indicating whether the variances of each component in each mixture model
are constrained to be the same (only for <code>normal</code> family)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bic</code></td>
<td>
<p>the value of BIC for each mixture model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>best</code></td>
<td>
<p>an indicator of the best model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>the family of the mixture model</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>plot.selectEM</code>, <code>bs.test</code>, <code>mixfit</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## selecting the optimal normal mixture model by BIC
set.seed(105)
x &lt;- rmixnormal(1000, c(0.3, 0.4, 0.3), c(-4, 0, 4), c(1, 1, 1))
hist(x, breaks = 40)
ret &lt;- select(x, ncomp = 2:5)
## [1] "The final model: normal mixture (equal variance) with 3 components"

## (not run) selecting the optimal Weibull mixture model by BIC
## set.seed(106)
## x &lt;- rmixweibull(1000, c(0.3, 0.4, 0.3), c(2, 5, 8), c(0.7, 0.6, 1))
## ret &lt;- select(x, ncomp = 2:5, family = "weibull")
## [1] "The final model: weibull mixture with 3 components"

## (not run) selecting the optimal Gamma mixture model by BIC
## set.seed(107)
## x &lt;- rmixgamma(1000, c(0.3, 0.7), c(2, 5), c(0.7, 1))
## ret &lt;- select(x, ncomp = 2:5, family = "gamma")
## [1] "The final model: gamma mixture with 2 components"


## (not run) selecting the optimal lognormal mixture model by BIC
## set.seed(108)
## x &lt;- rmixlnorm(1000, c(0.2, 0.3, 0.2, 0.3), c(4, 7, 9, 12), c(1, 0.5, 0.7, 1))
## ret &lt;- select(x, ncomp = 2:6, family = "lnorm")
## [1] "The final model: lnorm mixture with 4 components"

</code></pre>


</div>