<div class="container">

<table style="width: 100%;"><tr>
<td>bs.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bootstrap Likelihood Ratio Test for Finite Mixture Models</h2>

<h3>Description</h3>

<p>This function performs the likelihood ratio test by parametric bootstrapping for two mixture
models with different number of components.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bs.test(
  x,
  ncomp = c(1, 2),
  family = c("normal", "weibull", "gamma", "lnorm"),
  B = 100,
  ev = FALSE,
  mstep.method = c("bisection", "newton"),
  init.method = c("kmeans", "hclust"),
  tol = 1e-06,
  max_iter = 500
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector for the raw data or a three-column matrix for the binned data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncomp</code></td>
<td>
<p>a vector of two positive integers specifying the number of components of the
mixture model under the null and alternative hypothesis.
The first integer should be smaller than the second one. The default value is
<code>c(1, 2)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>a character string specifying the family of the mixture model, which can be one
of <code>normal</code>, <code>weibull</code>, <code>gamma</code>, or <code>lnorm</code> (default <code>normal</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>the number of bootstrap iterations (default 100).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ev</code></td>
<td>
<p>a logical value indicating whether the variance of each component should be the same
or not (default <code>FALSE</code>). <code>ev</code> is ignored for other family members.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mstep.method</code></td>
<td>
<p>the method used in M-step of EM algorithm for <code>weibull</code> or
<code>gamma</code> family. It is ignored for <code>normal</code> or <code>lnorm</code> family,
which has closed-form solution in the M-step. The default value is <code>bisection</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init.method</code></td>
<td>
<p>a character string specifying the method used for providing the initial values
for the parameters for the EM algorithm. It can be one of <code>kmeans</code> or <code>hclust</code>. The default is
<code>kmeans</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>the tolerance for the stopping rule of EM algorithm. It is the value to stop
EM algorithm when the two consecutive iterations produces log-likelihood with difference
less than <code>tol</code>. The default value is 1e-6.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_iter</code></td>
<td>
<p>the maximum number of iterations for the EM algorithm (default 500).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For the given data <code>x</code> and the specified family, the function <code>bs.test</code> conducts
a bootstrap likelihood ratio test for two mixture models with the number of components
under the null and the alternative hypothesis specified in <code>ncomp</code>.
</p>


<h3>Value</h3>

<p>The function <code>bs.test</code> returns an object of class <code>bootEM</code> which
contains the following three items.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>pvalue</code></td>
<td>
<p>The p-value of the bootstrap likelihood ratio test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w0</code></td>
<td>
<p>the observed likelihood ratio test statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w1</code></td>
<td>
<p>a vector of simulated likelihood ratio test statistics</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>plot.bootEM</code>, <code>mixfit</code>, <code>select</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## testing normal mixture models with 2 and 3 components
set.seed(100)
x &lt;- rmixnormal(200, c(0.5, 0.5), c(2, 5), c(1, 0.7))
ret &lt;- bs.test(x, ncomp = c(2, 3), B = 30)
ret

## (not run) testing Weibull mixture models with 2 and 3 components
## set.seed(101)
## x &lt;- rmixweibull(200, c(0.3, 0.4, 0.3), c(2, 5, 8), c(1, 0.6, 0.8))
## ret &lt;- bs.test(x, ncomp = c(2, 3), family = "weibull", B = 30)
## ret

## (not run) testing Gamma mixture models with 1 and 2 components
## set.seed(102)
## x &lt;- rgamma(200, 2, 1)
## ret &lt;- bs.test(x, ncomp = c(1, 2), family = "gamma", B = 30)
## ret

</code></pre>


</div>