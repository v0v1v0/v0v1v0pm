<div class="container">

<table style="width: 100%;"><tr>
<td>mixfit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Finite Mixture Modeling for Raw Data and Binned Data</h2>

<h3>Description</h3>

<p>This function is used to perform the maximum likelihood estimation for
a variety of finite mixture models for both raw and binned data by using
the EM algorithm, together with Newton-Raphson algorithm or bisection method when necessary.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mixfit(
  x,
  ncomp = NULL,
  family = c("normal", "weibull", "gamma", "lnorm"),
  pi = NULL,
  mu = NULL,
  sd = NULL,
  ev = FALSE,
  mstep.method = c("bisection", "newton"),
  init.method = c("kmeans", "hclust"),
  tol = 1e-06,
  max_iter = 500
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector for the raw data or a three-column matrix for the binned data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncomp</code></td>
<td>
<p>a positive integer specifying the number of components of the mixture model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>a character string specifying the family of the mixture model. It can only be
one element from <code>normal</code>, <code>weibull</code>, <code>gamma</code> or <code>lnorm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi</code></td>
<td>
<p>a vector of the initial value for the proportion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>a vector of the initial value for the mean</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd</code></td>
<td>
<p>a vector of the initial value for the standard deviation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ev</code></td>
<td>
<p>a logical value controlling whether each component has the same variance when
fitting normal mixture models. It is ignored when fitting other mixture models. The default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mstep.method</code></td>
<td>
<p>a character string specifying the method used in M-step of the EM algorithm
when fitting weibull or gamma mixture models. It can be either <code>bisection</code> or <code>newton</code>.
The default is <code>bisection</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init.method</code></td>
<td>
<p>a character string specifying the method used for providing initial values
for the parameters for EM algorithm. It can be one of <code>kmeans</code> or <code>hclust</code>. The default is
<code>kmeans</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>the tolerance for the stopping rule of EM algorithm. It is the value to stop EM algorithm when the two
consecutive iterations produces loglikelihood with difference less than <code>tol</code>. The default value is 1e-6.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_iter</code></td>
<td>
<p>the maximum number of iterations for the EM algorithm (default 500).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>mixfit</code> is the core function in this package. It is used to perform
the maximum likelihood estimation for finite mixture models from the families of normal,
weibull, gamma or lognormal by using the EM algorithm. When the family is <code>weibull</code>
or <code>gamma</code>, the M-step of the EM algorithm has no closed-form solution and we can
use Newton algorithm by specifying <code>method = "newton"</code> or use bisection method by
specifying <code>method = "bisection"</code>.
</p>
<p>The initial values of the EM algorithm can be provided by specifying the proportion of each
component <code>pi</code>, the mean of each component <code>mu</code> and the standard deviation of
each component <code>sd</code>. If one or more of these initial values are not provided, then
their values are estimated by using K-means clustering method or hierarchical clustering
method. If all of <code>pi</code>, <code>mu</code>, and <code>sd</code>
are not provided, then <code>ncomp</code> should be provided so initial values are automatically
generated. For the normal mixture models, we can
control whether each component has the same variance or not.
</p>


<h3>Value</h3>

<p>the function <code>mixfit</code> return an object of class <code>mixfitEM</code>, which contains a list of
different number of items when fitting different mixture models. The common items include
</p>
<table>
<tr style="vertical-align: top;">
<td><code>pi</code></td>
<td>
<p>a numeric vector representing the estimated proportion of each component</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>a numeric vector representing the estimated mean of each component</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd</code></td>
<td>
<p>a numeric vector representing the estimated standard deviation of each component</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>a positive integer recording the number of EM iteration performed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>the loglikelihood of the estimated mixture model for the data <code>x</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aic</code></td>
<td>
<p>the value of AIC of the estimated model for the data <code>x</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bic</code></td>
<td>
<p>the value of BIC of the estimated model for the data <code>x</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>the data <code>x</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comp.prob</code></td>
<td>
<p>the probability that <code>x</code> belongs to each component</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>the family the mixture model belongs to</p>
</td>
</tr>
</table>
<p>For the Weibull mixture model, the following extra items are returned.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>a numeric vector representing the estimated shape parameter of each component</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>a numeric vector representing the estimated scale parameter of each component</p>
</td>
</tr>
</table>
<p>For the Gamma mixture model, the following extra items are returned.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>a numeric vector representing the estimated shape parameter of each component</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>a numeric vector representing the estimated rate parameter of each component</p>
</td>
</tr>
</table>
<p>For the lognormal mixture model, the following extra items are returned.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mulog</code></td>
<td>
<p>a numeric vector representing the estimated logarithm mean of each component</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdlog</code></td>
<td>
<p>a numeric vector representing the estimated logarithm standard deviation of
each component</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>plot.mixfitEM</code>, <code>density.mixfitEM</code>,
<code>select</code>, <code>bs.test</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## fitting the normal mixture models
set.seed(103)
x &lt;- rmixnormal(200, c(0.3, 0.7), c(2, 5), c(1, 1))
data &lt;- bin(x, seq(-1, 8, 0.25))
fit1 &lt;- mixfit(x, ncomp = 2)  # raw data
fit2 &lt;- mixfit(data, ncomp = 2)  # binned data
fit3 &lt;- mixfit(x, pi = c(0.5, 0.5), mu = c(1, 4), sd = c(1, 1))  # providing the initial values
fit4 &lt;- mixfit(x, ncomp = 2, ev = TRUE)  # setting the same variance

## (not run) fitting the weibull mixture models
## x &lt;- rmixweibull(200, c(0.3, 0.7), c(2, 5), c(1, 1))
## data &lt;- bin(x, seq(0, 8, 0.25))
## fit5 &lt;- mixfit(x, ncomp = 2, family = "weibull")  # raw data
## fit6 &lt;- mixfit(data, ncomp = 2, family = "weibull")  # binned data

## (not run) fitting the Gamma mixture models
## x &lt;- rmixgamma(200, c(0.3, 0.7), c(2, 5), c(1, 1))
## data &lt;- bin(x, seq(0, 8, 0.25))
## fit7 &lt;- mixfit(x, ncomp = 2, family = "gamma")  # raw data
## fit8 &lt;- mixfit(data, ncomp = 2, family = "gamma")  # binned data

## (not run) fitting the lognormal mixture models
## x &lt;- rmixlnorm(200, c(0.3, 0.7), c(2, 5), c(1, 1))
## data &lt;- bin(x, seq(0, 8, 0.25))
## fit9 &lt;- mixfit(x, ncomp = 2, family = "lnorm")  # raw data
## fit10 &lt;- mixfit(data, ncomp = 2, family = "lnorm")  # binned data

</code></pre>


</div>