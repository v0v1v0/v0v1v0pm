<div class="container">

<table style="width: 100%;"><tr>
<td>ecm.mix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
ECM Algorithm for Restricted General Location Model
</h2>

<h3>Description</h3>

<p>Computes maximum-likelihood estimates  for the parameters of the
general location model from an incomplete mixed dataset.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ecm.mix(s, margins, design, start, prior=1, maxits=1000, 
        showits=TRUE, eps=0.0001)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>

<p>summary list of an incomplete data matrix <code>x</code> produced by
the function <code>prelim.mix</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margins</code></td>
<td>

<p>vector describing the sufficient configurations or margins in the
desired loglinear model. The variables are ordered in the original
order of the columns of <code>x</code>, so that 1 refers to <code>x[,1]</code>, 2 refers to
<code>x[,2]</code>, and so on.  A margin is described by the factors not summed
over, and margins are separated by zeros.  Thus c(1,2,0,2,3,0,1,3)
would indicate the (1,2), (2,3), and (1,3) margins in a three-way
table, i.e., the model of no three-way association.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>

<p>design matrix specifying the relationship of the continuous
variables to the categorical ones. The dimension is <code>c(D,r)</code> where
<code class="reqn">D</code> is the number of cells in the contingency table, and <code class="reqn">r</code> is the
number of effects which must be less than or equal to <code class="reqn">D</code>. The
order of the rows corresponds to the storage order of the cell
probabilities in the contingency table; see <code>getparam.mix</code> for
details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>

<p>optional starting value of the parameter. This is a list such as one
created by this function or by <code>dabipf.mix</code>. If structural zeros
appear in the table, <code>start$pi</code> should contain zeros in those
positions and ones elsewhere. If no starting value is supplied,
<code>ecm.mix</code> chooses its own appropriate starting value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>

<p>Optional vector or array of hyperparameter(s) for a Dirichlet prior
distribution. By default, uses a uniform prior on the cell
probabilities. ECM finds the posterior mode, which under
a uniform prior is the same as a maximum-likelihood estimate. If
structural zeros appear in the table, hyperparameters for those cells
should be set to <code>NA</code>..
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxits</code></td>
<td>

<p>maximum number of iterations performed. The algorithm will stop if the
parameter still has not converged after this many iterations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showits</code></td>
<td>

<p>if <code>TRUE</code>, reports the iterations of ECM so the user can monitor
the progress of the algorithm.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>

<p>optional convergence criterion. The algorithm stops when the maximum
relative difference in every parameter from one iteration to the next
is less than or equal to this value.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list representing the maximum-likelihood estimates (or posterior
mode) of the normal parameters. This list contains cell probabilities,
cell means, and covariances.  The parameter can be transformed back to
the original scale and put into a more understandable format by the
function <code>getparam.mix</code>.
</p>


<h3>Note</h3>

<p>If zero cell counts occur in the complete-data table, the maximum
likelihood estimate may not be unique, and the algorithm may converge
to different stationary values depending on the starting value. Also,
if zero cell counts occur in the complete-data table, the ML estimate may
lie on the boundary of the parameter space.
</p>


<h3>References</h3>

<p>Schafer, J. L. (1996) <em>Analysis of Incomplete Multivariate Data.</em>
Chapman &amp; Hall, Chapter 9.
</p>


<h3>See Also</h3>

<p><code>prelim.mix</code>, <code>em.mix</code>,
<code>getparam.mix</code>,
<code>loglik.mix</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(stlouis)
s &lt;- prelim.mix(stlouis,3)         # preliminary manipulations
margins &lt;- c(1,2,3)          # saturated loglinear model
design &lt;- diag(rep(1,12))     # identity matrix, D=no of cells
thetahat &lt;- ecm.mix(s,margins,design)  # should be same as em.mix(s)
loglik.mix(s,thetahat)             # loglikelihood at thetahat
</code></pre>


</div>