<div class="container">

<table style="width: 100%;"><tr>
<td>estep2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Computing posteriors expected value.</h2>

<h3>Description</h3>

<p>For a finite mixture model with density function
</p>
<p style="text-align: center;"><code class="reqn">
{\cal{M}}(\bold{y}|\bold{\Psi})=\sum_{g=1}^{G} \omega_{g} f_{\bold{Y}}(\bold{y}, \bold{\Theta}_g),
</code>
</p>

<p>we use method of Basford et al. (1997) for Computing observed Fisher information matrix. Based on above representation for density function of a finite mixture model, we can write
</p>
<p style="text-align: center;"><code class="reqn">
\bold{Y}| {T}, W \sim N_{d}\bigl(\bold{\mu}+\bold{\lambda}{T}, {W} \Sigma\bigr), {T}| W \sim HN({0}, {W}), W  \sim f_W(w| \bold{\theta}).
</code>
</p>

<p>The required posteriors expectations are <code class="reqn">E\bigl(W^{-1}|\bold{y},\bold{\Psi}\bigr)</code>, <code class="reqn">E\bigl(W^{-1}T|\bold{y},\bold{\Psi}\bigr)</code>, and <code class="reqn">E\bigl(W^{-1}T^2|\bold{y},\bold{\Psi}\bigr)</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">estep2(Y, G, weight, mu, sigma, lambda, family, skewness, param, theta, tick, h, N, PDF)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>an <code class="reqn">n\times d</code> matrix of observations. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>the number of components. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>a vector of weight parameters (or mixing proportions). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>a list of location vectors of <code>G</code> components. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>a list of dispersion matrices of <code>G</code> components. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>a list of skewness matrices of <code>G</code> components. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>name of the mixing distribution. By default <code>family = "constant"</code> that corresponds to the finite mixture of multivariate normal (or skew normal) distribution. Other candidates for family name are: "bs" (for Birnbaum-Saunders), "burriii" (for Burr type iii), "chisq" (for chi-square), "exp" (for exponential), "f" (for Fisher), "gamma" (for gamma), "gig" (for generalized inverse-Gaussian), "igamma" (for inverse-gamma), "igaussian" (for inverse-Gaussian), "lindley" (for Lindley), "loglog" (for log-logistic), "lognorm" (for log-normal), "lomax" (for Lomax), "ptstable" (for positive <code class="reqn">\alpha</code>-stable), "ptstable" (for polynomially tilted <code class="reqn">\alpha</code>-stable), "rayleigh" (for Rayleigh), and "weibull" (for Weibull). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skewness</code></td>
<td>
<p>logical statement.If <code>skewness = "FALSE"</code> means that a symmetric model is fitted to each component (cluster). If <code>skewness = "TRUE"</code> a skewed model is fitted to each component. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>name of the elements of <code class="reqn">{\bold{\theta)}}</code> as the parameter vector of mixing distribution with density function <code class="reqn">f_W(w|{\bold{\theta)}}</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>a list of maximum likelihood estimator for <code class="reqn">{\bold{\theta)}}</code> across <code>G</code> components. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tick</code></td>
<td>
<p> a binary vector whose length depends on type of family. The elements of <code>tick</code> are either <code>0</code> or <code>1</code>. If element of <code>tick</code> is <code>0</code>, then the correspoding element of <code class="reqn">\bold{\theta}</code> is not considered in the formula of <code class="reqn">f_W(w|{\bold{\theta)}}</code> for computing the required posterior expectations. If element of <code>tick</code> is <code>1</code>, then the corresponding element of <code class="reqn">\bold{\theta}</code> is considered in the formula of <code class="reqn">f_W(w|{\bold{\theta)}}</code>. For instance, if <code>family = "gamma"</code> and either its shape or rate parameter is one, then <code>tick = c(1)</code>. This is while, if <code>family = "gamma"</code> and both of the shape and rate parameters are in the formula of <code class="reqn">f_W(w|{\bold{\theta)}}</code>, then <code>tick = c(1, 1)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>a positive small value for computing numerical derivative of <code class="reqn">f_W(w| {\bold{\theta)}})</code> with respect to <code class="reqn">{\bold{\theta)}}</code>, that is
<code class="reqn">\partial/ \partial {\bold{\theta)}} f_W(w| {\bold{\theta)}}</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>a large integer number for computing Monte Carlo approximation of expected value within the E-step of the EM algorithm. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PDF</code></td>
<td>
<p>expression for mixing density function <code class="reqn">f_W(w| {\bold{\theta)}}</code>. </p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The required posteriors expectations for approximating the observed Fisher information matrix for canonical or unrestricted finite mixture model. These include
<code class="reqn">\tau_{ig}=E\bigl( Z_{ig}=1 \vert {\bold{y}}_{i}, \hat{\bold{\Psi}} \bigr) = {\omega}_g f_{\bold{Y}}\bigl({\bold{y}}_{i}\big|{\bold{\Theta}_g}\bigr)/\bigl[ \sum_{g=1}^{G} {{\omega}}_g f_{\bold{Y}}\bigl({\bold{y}}_{i}\big|{\bold{\Theta}_g}\bigr) \bigr]</code>,
<code class="reqn">E\bigl( W^{-1}\big \vert {\bold{y}}_{i}, \hat{\bold{\Psi}} \bigr)</code>,
<code class="reqn">E\bigl( {\bold{U}}W^{-1}\big \vert {\bold{y}}_{i}, \hat{\bold{\Psi}} \bigr)</code>,
<code class="reqn">E\bigl( {\bold{U}}{\bold{U}}^{\top}W^{-1}\big \vert {\bold{y}}_{i}, \hat{{\bold{\Psi}}} \bigr)</code>, and
<code class="reqn">E\bigl( \partial f_W(w| {\bold{\theta)}})/\partial {\bold{\theta)}} \big \vert {\bold{y}}_{i}, \hat{{\bold{\Psi}}} \bigr)</code>
</p>


<h3>Author(s)</h3>

<p>Mahdi Teimouri</p>


<h3>References</h3>

<p>K. E. Basford, D. R. Greenway, G. J. McLachlan, and D. Peel, (1997). Standard errors of fitted means under normal mixture, <em>Computational Statistics</em>, 12, 1-17.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
      n &lt;- 100
      G &lt;- 2
 weight &lt;- rep( 0.5, 2 )
    mu1 &lt;- rep(-5  , 2 )
    mu2 &lt;- rep( 5  , 2 )
 sigma1 &lt;- matrix( c( 0.4, -0.20, -0.20, 0.5 ), nrow = 2, ncol = 2 )
 sigma2 &lt;- matrix( c( 0.5,  0.20,  0.20, 0.4 ), nrow = 2, ncol = 2 )
lambda1 &lt;- diag( c(-5, -5) )
lambda2 &lt;- diag( c( 5,  5) )
 theta1 &lt;- c( 10 )
 theta2 &lt;- c( 20 )
     mu &lt;- list( mu1, mu2 )
  sigma &lt;- list( sigma1 , sigma2 )
 lambda &lt;- list( lambda1, lambda2)
  theta &lt;- list( theta1 , theta2 )
  param &lt;- c( "a" )
    PDF &lt;- quote( (a/2)^(a/2)*x^(-a/2 - 1)/gamma(a/2)*exp( -a/(2*x) ) )
  tick  &lt;- rep( 1, 2 )
theta10 &lt;- c( 10, 10 )
theta20 &lt;- c( 20, 20 )
 theta0 &lt;- list( theta10 , theta20 )
      Y &lt;- rmix( n, G, weight, model = "unrestricted", mu, sigma, lambda,
      family = "igamma", theta0)
    out &lt;- estep2( Y[, 1:2], G, weight, mu, sigma, lambda, family = "igamma",
    skewness = "TRUE", param, theta, tick, h = 0.001, N = 3000, PDF)

</code></pre>


</div>