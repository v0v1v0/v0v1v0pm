<div class="container">

<table style="width: 100%;"><tr>
<td>ofim2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Computing observed Fisher information matrix for unrestricted or canonical finite mixture model.</h2>

<h3>Description</h3>

<p>This function computes the observed Fisher information matrix for a given unrestricted or canonical finite mixture model. For this, we use the method of Basford et al. (1997). The density function of each <code class="reqn">G</code>-component finite mixture model is given by
</p>
<p style="text-align: center;"><code class="reqn">
g({\bold{y}}|\Psi)=\sum_{g=1}^{G} \omega_{g} f_{\bold{Y}}({\bold{y}}, \Theta_g),
</code>
</p>

<p>where <code class="reqn">\bold{\Psi} = \bigl(\bold{\Theta}_{1},\cdots, \bold{\Theta}_{G}\bigr)^{\top}</code> with <code class="reqn">\bold{\Theta}_g=\bigl({\bold{\omega}}_g, {\bold{\mu}}_g, {{\Sigma}}_g, {\bold{\lambda}}_g\bigr)^{\top}</code>. Herein, <code class="reqn">f_{\bold{Y}}(\bold{y}, \bold{\Theta}_g)</code> accounts for the density function of random vector <code class="reqn">\bold{Y}</code> within <code class="reqn">g</code>-th component that admits the representation given by
</p>
<p style="text-align: center;"><code class="reqn">
{\bold{Y}} \mathop=\limits^d {\bold{\mu}}_g+\sqrt{W}{\bold{\lambda}}_g\vert{Z}_0\vert + \sqrt{W}{\Sigma}_g^{\frac{1}{2}} {\bold{Z}}_1,
</code>
</p>

<p>where <code class="reqn"> {\bold{\mu}}_g \in {R}^{d} </code> is location vector, <code class="reqn"> {\bold{\lambda}}_g \in {R}^{d} </code> is skewness vector, <code class="reqn">\Sigma_g</code> is a positive definite symmetric dispersion matrix for <code class="reqn">g =1,\cdots,G</code>. Further, <code class="reqn">W</code> is a positive random variable with mixing density function <code class="reqn">f_W(w| \bold{\theta}_g)</code>, <code class="reqn"> {Z}_0\sim N(0, 1) </code>, and <code class="reqn"> {\bold{Z}}_1\sim N_{d}\bigl( {\bold{0}}, \Sigma\bigr) </code>. We note that <code class="reqn">W</code>, <code class="reqn">Z_0</code>, and <code class="reqn"> {\bold{Z}}_1</code> are mutually independent. For approximating the observed Fisher information matrix of the finite mixture models, we use the method of
Basford et al. (1997). Based on this method, using observations <code class="reqn">{\bold{y}}=({{\bold{y}}_{1},{\bold{y}}_{2},\cdots,{\bold{y}}_{n}})^{\top}</code>, an approximation of the expected information
</p>
<p style="text-align: center;"><code class="reqn">
-E\Bigl\{ \frac{\partial^2 \log L({\bold{\Psi}}) }{\partial \bold{\Psi} \partial \Psi^{\top} } \Bigr\},
</code>
</p>

<p>is give by the observed information as
</p>
<p style="text-align: center;"><code class="reqn">
\sum_{i =1}^{n} \hat{{\bold{h}}}_{i} \hat{{\bold{h}}}^{\top}_{i},
</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\hat{\bold{h}}_{i} = \frac{\partial}{\partial \bold{\Psi} } \log L_{i}(\hat{\bold{\Psi} }) </code>
</p>

<p>and
<code class="reqn"> \log L(\hat{\bold{\Psi} })= \sum_{i =1}^{n} \log L_{i}(\hat{\bold{\Psi} })= \sum_{i =1}^{n} \log \Bigl\{ \sum_{g=1}^{G} \widehat{{\omega}}_g f_{\bold{Y}}\bigl({\bold{y}}_{i}|\widehat{\bold{\Theta}_g}\bigr)\Bigr\}.</code>
Herein <code class="reqn">\widehat{\omega}_g</code> and <code class="reqn">\widehat{\bold{\Theta}_g}</code> denote the maximum likelihood estimator of <code class="reqn">\omega_g</code> and <code class="reqn">\bold{\Theta}_g</code>, for <code class="reqn">g=1,\cdots,G</code>, respectively. </p>


<h3>Usage</h3>

<pre><code class="language-R"> ofim2(Y, G, weight, model, mu, sigma, lambda, family = "constant", skewness = "FALSE",
      param = NULL, theta = NULL, tick = NULL, h = 0.001, N = 3000, level = 0.05,
    PDF = NULL )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>an <code class="reqn">n \times d</code> matrix of observations. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>number of components. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>a vector of weight parameters (or mixing proportions). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>It must be <code>"canonical"</code> or <code>"unrestricted"</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>a list of location vectors of <code>G</code> components. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>a list of dispersion matrices of <code>G</code> components. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>a list of skewness vectors of <code>G</code> components. If model is either <code>"canonical"</code> or <code>"unrestricted"</code>, then skewness vactor must be given in matrix form of appropriate size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>name of the mixing distribution. By default <code>family = "constant"</code> that corresponds to the finite mixture of multivariate normal (or skew normal) distribution. Other candidates for family name are: "bs" (for Birnbaum-Saunders), "burriii" (for Burr type iii), "chisq" (for chi-square), "exp" (for exponential), "f" (for Fisher), "gamma" (for gamma), "gig" (for generalized inverse-Gaussian), "igamma" (for inverse-gamma), "igaussian" (for inverse-Gaussian), "lindley" (for Lindley), "loglog" (for log-logistic), "lognorm" (for log-normal), "lomax" (for Lomax), "pstable" (for positive <code class="reqn">\alpha</code>-stable), "ptstable" (for polynomially tilted <code class="reqn">\alpha</code>-stable), "rayleigh" (for Rayleigh), and "weibull" (for Weibull). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skewness</code></td>
<td>
<p>logical statement. By default <code>skewness = "FALSE"</code> which means that a symmetric model is fitted to each component (cluster). If <code>skewness = "TRUE"</code>, then a skewed model is fitted to each component. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>name of the elements of <code class="reqn">\theta</code> as the parameter vector of mixing distribution with density function <code class="reqn">f_W(w|{\bold{\theta)}}</code>. By default it is <code>NULL</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>a list of maximum likelihood estimator for <code class="reqn">\theta</code> across <code>G</code> components. By default it is <code>NULL</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tick</code></td>
<td>
<p>a binary vector whose length depends on type of family. The elements of <code>tick</code> are either <code>0</code> or <code>1</code>. If element of <code>tick</code> is <code>0</code>, then the corresponding element of <code class="reqn">\bold{\theta}</code> is not considered in the formula of <code class="reqn">f_W(w|{\bold{\theta)}}</code> for computing the required posterior expectations. If element of <code>tick</code> is <code>1</code>, then the corresponding element of <code class="reqn">\bold{\theta}</code> is considered in the formula of <code class="reqn">f_W(w|{\bold{\theta)}}</code>. For instance, if <code>family = "gamma"</code> and either its shape or rate parameter is one, then <code>tick = c(1)</code>. This is while, if <code>family = "gamma"</code> and both of the shape and rate parameters are in the formula of <code class="reqn">f_W(w|{\bold{\theta)}}</code>, then <code>tick = c(1, 1)</code>. By default <code>tick = NULL</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>a positive small value for computing numerical derivative of <code class="reqn">f_W(w| \bold{\theta})</code> with respect to <code class="reqn">\bold{\theta}</code>, that is <code class="reqn">\partial/ \partial \theta f_W(w| \bold{\theta})</code>. By default <code class="reqn">h = 0.001</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>an integer number for approximating the posterior expected values within the E-step of the EM algorithm through the Monte Carlo method. By default <code class="reqn">N = 3000</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>significance level <code class="reqn">\alpha</code> for constructing <code class="reqn">100(1-\alpha)\%</code> confidence interval. By default <code class="reqn">\alpha = 0.05</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PDF</code></td>
<td>
<p>mathematical expression for mixing density function <code class="reqn">f_W(w| \bold{\theta})</code>. By default it is <code>NULL</code>. </p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A two-part list whose first part is the observed Fisher information matrix for finite mixture model.
</p>


<h3>Author(s)</h3>

<p>Mahdi Teimouri</p>


<h3>References</h3>

<p>K. E. Basford, D. R. Greenway, G. J. McLachlan, and D. Peel, (1997). Standard errors of fitted means under normal mixture, <em>Computational Statistics</em>, 12, 1-17.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
      n &lt;- 100
      G &lt;- 2
 weight &lt;- rep( 0.5, 2 )
    mu1 &lt;- rep(-5  , 2 )
    mu2 &lt;- rep( 5  , 2 )
 sigma1 &lt;- matrix( c(0.4, -0.20, -0.20, 0.5 ), nrow = 2, ncol = 2 )
 sigma2 &lt;- matrix( c(0.5,  0.20,  0.20, 0.4 ), nrow = 2, ncol = 2 )
lambda1 &lt;- diag( c( 5, -5 ) )
lambda2 &lt;- diag( c(-5,  5 ) )
     mu &lt;- list( mu1, mu2 )
 lambda &lt;- list( lambda1, lambda2 )
  sigma &lt;- list( sigma1 , sigma2  )
    PDF &lt;- quote( (b/2)^(a/2)*x^(-a/2 - 1)/gamma(a/2)*exp( -b/(x*2) ) )
  param &lt;- c( "a","b")
 theta1 &lt;- c( 10, 12 )
 theta2 &lt;- c( 10, 20 )
  theta &lt;- list( theta1, theta2 )
  tick  &lt;- c( 1, 1 )
         Y &lt;- rmix(n, G, weight, model = "unrestricted", mu, sigma, lambda, family = "igamma",
            theta)
    out &lt;- ofim2(Y[, 1:2], G, weight, model = "unrestricted", mu, sigma, lambda,
            family = "igamma", skewness = "TRUE", param, theta, tick, h = 0.001, N = 3000,
           level = 0.05, PDF)

</code></pre>


</div>