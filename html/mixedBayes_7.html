<div class="container">

<table style="width: 100%;"><tr>
<td>mixedBayes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>fit a Bayesian longitudinal regularized quantile mixed model</h2>

<h3>Description</h3>

<p>fit a Bayesian longitudinal regularized quantile mixed model
</p>


<h3>Usage</h3>

<pre><code class="language-R">mixedBayes(
  y,
  e,
  X,
  g,
  w,
  k,
  iterations = 10000,
  burn.in = NULL,
  slope = TRUE,
  robust = TRUE,
  quant = 0.5,
  sparse = TRUE,
  structure = c("group", "individual")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the vector of response variable. The current version of mixedBayes only supports continuous response.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e</code></td>
<td>
<p>the matrix of a group of dummy environmental factors variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>the matrix of the intercept and time effects (time effects are optional).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>the matrix of predictors (genetic factors) without intercept. Each row should be an observation vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>the matrix of interactions between genetic factors and environmental factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>the total number of time points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p>the number of MCMC iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn.in</code></td>
<td>
<p>the number of iterations for burn-in.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slope</code></td>
<td>
<p>logical flag. If TRUE, random intercept and slope model will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>
<p>logical flag. If TRUE, robust methods will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quant</code></td>
<td>
<p>specify different quantiles when applying robust methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sparse</code></td>
<td>
<p>logical flag. If TRUE, spike-and-slab priors will be used to shrink coefficients of irrelevant covariates to zero exactly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>structure</code></td>
<td>
<p>structure for interaction effects, two choices are available. "group" for selection on group-level only. "individual" for selection on individual-level only.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Consider the data model described in "<code>data</code>":
</p>
<p style="text-align: center;"><code class="reqn">Y_{ij} = X_{ij}^\top\gamma_{0}+E_{ij}^\top\gamma_{1}+\sum_{l=1}^{p}G_{ijl}\gamma_{2l}+\sum_{l=1}^{p}W_{ijl}^\top\gamma_{3l}+Z_{ij}^\top\alpha_{i}+\epsilon_{ij}.</code>
</p>

<p>where <code class="reqn">\gamma_{2l}</code> is the main effect of the <code class="reqn">l</code>th genetic variant. The interaction effects is corresponding to the coefficient vector <code class="reqn">\gamma_{3l}=(\gamma_{3l1}, \gamma_{3l2},\ldots,\gamma_{3lm})^\top</code>.
</p>
<p>When 'structure="group"', group-level selection will be conducted on <code class="reqn">||\gamma_{3l}||_{2}</code>. If 'structure="individual"', individual-level selection will be conducted on each <code class="reqn">\gamma_{3lq}</code>, (<code class="reqn">q=1,\ldots,m</code>).
</p>
<p>When 'slope=TRUE' (default), random intercept and slope model will be used as the mixed effects model.
</p>
<p>When 'sparse=TRUE' (default), spike-and-slab priors are imposed on individual and/or group levels to identify important main and interaction effects. Otherwise, Laplacian shrinkage will be used.
</p>
<p>When 'robust=TRUE' (default), the distribution of <code class="reqn">\epsilon_{ij}</code> is defined as a Laplace distribution with density.
</p>
<p><code class="reqn">
f(\epsilon_{ij}|\theta,\tau) = \theta(1-\theta)\exp\left\{-\tau\rho_{\theta}(\epsilon_{ij})\right\}
</code>, (<code class="reqn">i=1,\dots,n,j=1,\dots,k </code>), which leads to a Bayesian formulation of quantile regression. If 'robust=FALSE', <code class="reqn">\epsilon_{ij}</code> follows a normal distribution.
<br></p>
<p>Please check the references for more details about the prior distributions.
</p>


<h3>Value</h3>

<p>an object of class ‘mixedBayes’ is returned, which is a list with component:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>posterior</code></td>
<td>
<p>the posteriors of coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficient</code></td>
<td>
<p>the estimated coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn.in</code></td>
<td>
<p>the total number of burn-ins.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p>the total number of iterations.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>data</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(data)

## default method
fit = mixedBayes(y,e,X,g,w,k,structure=c("group"))
fit$coefficient

## Compute TP and FP
b = selection(fit,sparse=TRUE)
index = which(coeff!=0)
pos = which(b != 0)
tp = length(intersect(index, pos))
fp = length(pos) - tp
list(tp=tp, fp=fp)

## alternative: robust individual selection
fit = mixedBayes(y,e,X,g,w,k,structure=c("individual"))
fit$coefficient

## alternative: non-robust group selection
fit = mixedBayes(y,e,X,g,w,k,robust=FALSE, structure=c("group"))
fit$coefficient

## alternative: robust group selection under random intercept model
fit = mixedBayes(y,e,X,g,w,k,slope=FALSE, structure=c("group"))
fit$coefficient



</code></pre>


</div>