<div class="container">

<table style="width: 100%;"><tr>
<td>mixedCCA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sparse CCA for data of mixed types with BIC criterion</h2>

<h3>Description</h3>

<p>Applies sparse canonical correlation analysis (CCA) for high-dimensional data of mixed types (continuous/binary/truncated continuous). Derived rank-based estimator instead of sample correlation matrix is implemented. There are two types of BIC criteria for variable selection. We found that BIC1 works best for variable selection, whereas BIC2 works best for prediction.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mixedCCA(
  X1,
  X2,
  type1,
  type2,
  lamseq1 = NULL,
  lamseq2 = NULL,
  nlamseq = 20,
  lam.eps = 0.01,
  w1init = NULL,
  w2init = NULL,
  BICtype,
  KendallR = NULL,
  maxiter = 100,
  tol = 0.01,
  trace = FALSE,
  lassoverbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X1</code></td>
<td>
<p>A numeric data matrix (n by p1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X2</code></td>
<td>
<p>A numeric data matrix (n by p2).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type1</code></td>
<td>
<p>A type of data <code>X1</code> among "continuous", "binary", "trunc".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type2</code></td>
<td>
<p>A type of data <code>X2</code> among "continuous", "binary", "trunc".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lamseq1</code></td>
<td>
<p>A tuning parameter sequence for <code>X1</code>. The length should be the same as <code>lamseq2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lamseq2</code></td>
<td>
<p>A tuning parameter sequence for <code>X2</code>. The length should be the same as <code>lamseq1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlamseq</code></td>
<td>
<p>The number of tuning parameter sequence lambda - default is 20.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lam.eps</code></td>
<td>
<p>A ratio of the smallest value for lambda to the maximum value of lambda.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w1init</code></td>
<td>
<p>An initial vector of length p1 for canonical direction <code class="reqn">w1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w2init</code></td>
<td>
<p>An initial vector of length p2 for canonical direction <code class="reqn">w2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BICtype</code></td>
<td>
<p>Either 1 or 2: For more details for two options, see the reference.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>KendallR</code></td>
<td>
<p>An estimated Kendall <code class="reqn">\tau</code> matrix. The default is NULL, which means that it will be automatically estimated by Kendall's <code class="reqn">\tau</code> estimator unless the user supplies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>The maximum number of iterations allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>The desired accuracy (convergence tolerance).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>If <code>trace = TRUE</code>, progress per each iteration will be printed. The default value is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lassoverbose</code></td>
<td>
<p>If <code>lassoverbose = TRUE</code>, all warnings from lassobic optimization regarding convergence will be printed. The default value is <code>lassoverbose = FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>mixedCCA</code> returns a data.frame containing
</p>

<ul>
<li>
<p>KendallR: estimated Kendall's <code class="reqn">\tau</code> matrix estimator.
</p>
</li>
<li>
<p>lambda_seq: the values of <code>lamseq</code> used for sparse CCA.
</p>
</li>
<li>
<p>w1: estimated canonical direction <code class="reqn">w1</code>.
</p>
</li>
<li>
<p>w2: estimated canonical direction <code class="reqn">w2</code>.
</p>
</li>
<li>
<p>cancor: estimated canonical correlation.
</p>
</li>
<li>
<p>fitresult: more details regarding the progress at each iteration.
</p>
</li>
</ul>
<h3>References</h3>

<p>Yoon G., Carroll R.J. and Gaynanova I. (2020) "Sparse semiparametric canonical correlation analysis for data of mixed types" &lt;doi:10.1093/biomet/asaa007&gt;.
</p>


<h3>Examples</h3>

<pre><code class="language-R">### Simple example

# Data setting
n &lt;- 100; p1 &lt;- 15; p2 &lt;- 10 # sample size and dimensions for two datasets.
maxcancor &lt;- 0.9 # true canonical correlation

# Correlation structure within each data set
set.seed(0)
perm1 &lt;- sample(1:p1, size = p1);
Sigma1 &lt;- autocor(p1, 0.7)[perm1, perm1]
blockind &lt;- sample(1:3, size = p2, replace = TRUE);
Sigma2 &lt;- blockcor(blockind, 0.7)
mu &lt;- rbinom(p1+p2, 1, 0.5)

# true variable indices for each dataset
trueidx1 &lt;- c(rep(1, 3), rep(0, p1-3))
trueidx2 &lt;- c(rep(1, 2), rep(0, p2-2))

# Data generation
simdata &lt;- GenerateData(n=n, trueidx1 = trueidx1, trueidx2 = trueidx2, maxcancor = maxcancor,
                        Sigma1 = Sigma1, Sigma2 = Sigma2,
                        copula1 = "exp", copula2 = "cube",
                        muZ = mu,
                        type1 = "trunc", type2 = "trunc",
                        c1 = rep(1, p1), c2 =  rep(0, p2)
)
X1 &lt;- simdata$X1
X2 &lt;- simdata$X2

# Check the range of truncation levels of variables
range(colMeans(X1 == 0))
range(colMeans(X2 == 0))

# Kendall CCA with BIC1
kendallcca1 &lt;- mixedCCA(X1, X2, type1 = "trunc", type2 = "trunc", BICtype = 1, nlamseq = 10)

# Kendall CCA with BIC2. Estimated correlation matrix is plugged in from the above result.
R &lt;- kendallcca1$KendallR
kendallcca2 &lt;- mixedCCA(X1, X2, type1 = "trunc", type2 = "trunc",
                        KendallR = R, BICtype = 2, nlamseq = 10)
</code></pre>


</div>