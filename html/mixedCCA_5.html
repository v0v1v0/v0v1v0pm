<div class="container">

<table style="width: 100%;"><tr>
<td>estimateR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate latent correlation matrix</h2>

<h3>Description</h3>

<p>Estimation of latent correlation matrix from observed data of (possibly) mixed types (continuous/binary/truncated continuous) based on the latent Gaussian copula model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">estimateR(
  X,
  type = "trunc",
  method = "original",
  use.nearPD = TRUE,
  nu = 0.01,
  tol = 0.001,
  verbose = FALSE
)

estimateR_mixed(
  X1,
  X2,
  type1 = "trunc",
  type2 = "continuous",
  method = "original",
  use.nearPD = TRUE,
  nu = 0.01,
  tol = 0.001,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A numeric data matrix (n by p), n is the sample size and p is the number of variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A type of variables in <code>X</code>, must be one of "continuous", "binary" or "trunc".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The calculation method of latent correlation. Either "original" method or "approx". If <code>method = "approx"</code>, multilinear approximation method is used, which is much faster than the original method (requires <code>chebpol</code> R package). If <code>method = "original"</code>, optimization of the bridge inverse function is used. The default is "original".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.nearPD</code></td>
<td>
<p>A logical value indicating whether to use nearPD or not when the resulting correlation estimator is not positive definite (have at least one negative eigenvalue).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>Shrinkage parameter for correlation matrix, must be between 0 and 1, the default value is 0.01.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Desired accuracy when calculating the solution of bridge function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If <code>verbose = FALSE</code>, printing information whether nearPD is used or not is disabled. The default value is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X1</code></td>
<td>
<p>A numeric data matrix (n by p1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X2</code></td>
<td>
<p>A numeric data matrix (n by p2).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type1</code></td>
<td>
<p>A type of variables in <code>X1</code>, must be one of "continuous", "binary" or "trunc".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type2</code></td>
<td>
<p>A type of variables in <code>X2</code>, must be one of "continuous", "binary" or "trunc".</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>estimateR</code> returns
</p>

<ul>
<li>
<p>type: Type of the data matrix <code>X</code>
</p>
</li>
<li>
<p>R: Estimated p by p latent correlation matrix of <code>X</code>
</p>
</li>
</ul>
<p><code>estimateR_mixed</code> returns
</p>

<ul>
<li>
<p>type1: Type of the data matrix <code>X1</code>
</p>
</li>
<li>
<p>type2: Type of the data matrix <code>X2</code>
</p>
</li>
<li>
<p>R: Estimated latent correlation matrix of whole <code>X</code> = (<code>X1</code>, <code>X2</code>) (p1+p2 by p1+p2)
</p>
</li>
<li>
<p>R1: Estimated latent correlation matrix of <code>X1</code> (p1 by p1)
</p>
</li>
<li>
<p>R2: Estimated latent correlation matrix of <code>X2</code> (p2 by p2)
</p>
</li>
<li>
<p>R12: Estimated latent correlation matrix between <code>X1</code> and <code>X2</code> (p1 by p2)
</p>
</li>
</ul>
<h3>References</h3>

<p>Fan J., Liu H., Ning Y. and Zou H. (2017) "High dimensional semiparametric latent graphicalmodel for mixed data" &lt;doi:10.1111/rssb.12168&gt;.
</p>
<p>Yoon G., Carroll R.J. and Gaynanova I. (2020) "Sparse semiparametric canonical correlation analysis for data of mixed types" &lt;doi:10.1093/biomet/asaa007&gt;.
</p>
<p>Yoon G., Mueller C.L., Gaynanova I. (2020) "Fast computation of latent correlations" &lt;arXiv:2006.13875&gt;.
</p>


<h3>Examples</h3>

<pre><code class="language-R">### Data setting
n &lt;- 100; p1 &lt;- 15; p2 &lt;- 10 # sample size and dimensions for two datasets.
maxcancor &lt;- 0.9 # true canonical correlation

### Correlation structure within each data set
set.seed(0)
perm1 &lt;- sample(1:p1, size = p1);
Sigma1 &lt;- autocor(p1, 0.7)[perm1, perm1]
blockind &lt;- sample(1:3, size = p2, replace = TRUE);
Sigma2 &lt;- blockcor(blockind, 0.7)
mu &lt;- rbinom(p1+p2, 1, 0.5)

### true variable indices for each dataset
trueidx1 &lt;- c(rep(1, 3), rep(0, p1-3))
trueidx2 &lt;- c(rep(1, 2), rep(0, p2-2))

### Data generation
simdata &lt;- GenerateData(n=n, trueidx1 = trueidx1, trueidx2 = trueidx2, maxcancor = maxcancor,
                        Sigma1 = Sigma1, Sigma2 = Sigma2,
                        copula1 = "exp", copula2 = "cube",
                        muZ = mu,
                        type1 = "trunc", type2 = "continuous",
                        c1 = rep(1, p1), c2 =  rep(0, p2)
)
X1 &lt;- simdata$X1
X2 &lt;- simdata$X2

### Check the range of truncation levels of variables
range(colMeans(X1 == 0))
range(colMeans(X2 == 0))

### Estimate latent correlation matrix
# with original method
R1_org &lt;- estimateR(X1, type = "trunc", method = "original")$R
# with faster approximation method
R1_approx &lt;- estimateR(X1, type = "trunc", method = "approx")$R
R12_approx &lt;- estimateR_mixed(X1, X2, type1 = "trunc", type2 = "continuous", method = "approx")$R12


</code></pre>


</div>