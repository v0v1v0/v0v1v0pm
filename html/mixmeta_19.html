<div class="container">

<table style="width: 100%;"><tr>
<td>mixmeta.control</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Ancillary Parameters for Controlling the Fit in mixmeta Models </h2>

<h3>Description</h3>

<p>This internal function sets the parameter options used for fitting meta-analytical models, commonly to pre-specified default values. It is usually internally called by <code>mixmeta</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mixmeta.control(optim=list(), showiter=FALSE, maxiter=100, initPsi=NULL, Psifix=NULL,
  Scor=NULL, addSlist=NULL, inputna=FALSE, inputvar=10^4, loglik.iter="hybrid",
  igls.inititer=10, hessian=FALSE, vc.adj=TRUE, reltol=sqrt(.Machine$double.eps),
  checkPD=NULL, set.negeigen=sqrt(.Machine$double.eps))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>optim </code></td>
<td>
<p> list of parameters passed to the <code>control</code> argument of the function <code>optim</code>, which performs the <code>quasi-Newton optimization</code> in likelihood-based random-effects models. See <code>optim</code> for the list of arguments. See Details for additional info.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showiter </code></td>
<td>
<p> logical. If <code>TRUE</code>, the progress of iterative optimization is shown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter </code></td>
<td>
<p> positive interger value. Maximum number of iterations in methods involving optimization procedures.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initPsi </code></td>
<td>
<p> either a matrix or a vector of its lower triangular elements (with diagonal, taken by column), or optionally a named list with one or more of such objects. Used as starting values of random-effects parameters in likelihood-based optimization routines. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Psifix </code></td>
<td>
<p> either a matrix or a vector of its lower triangular elements (with diagonal, taken by column), or optionally a named list with one or more of such objects. Used to define fixed parts of the random-effects <code>(co)variance structures</code>. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Scor </code></td>
<td>
<p> either a scalar, vector or matrix representing the within-unit correlation(s) to be inputted when the covariances are not provided in multivariate models, and ignored if they are. See <code>inputcov</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>addSlist </code></td>
<td>
<p> a list of <code class="reqn">m</code> matrices for the (outer-level) groups of units defining the (known) error (co)variance structure, when this cannot be passed through the argument <code>S</code> of <code>mixmeta</code>. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inputna </code></td>
<td>
<p> logical. If missing values must be internally inputted. To be used with caution. See <code>inputna</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inputvar </code></td>
<td>
<p> multiplier for inputting the missing variances, to be passed as an argument to <code>inputna</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik.iter </code></td>
<td>
<p> iterative scheme used in in likelihood-based optimization routines. Options are <code>"hybrid"</code>, <code>"newton"</code>, and <code>"igls"</code> or <code>"RIGLS"</code>. See <code>mixmeta.ml</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>igls.inititer </code></td>
<td>
<p> number of iterations of the (restricted) iterative generalized least square algorithm when used in the initial phase of hybrid optimization procedure of likelihood-based estimators. See <code>mixmeta.ml</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessian </code></td>
<td>
<p> logical. If <code>TRUE</code>, the Hessian matrix of the parameters estimated in the optimization process is computed and returned. Only applicable to likelihood-based estimation methods. For details, see the info provided in the help pages of the <code>optimizations algorithms</code> and <code>(co)variance structures</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vc.adj </code></td>
<td>
<p> logical. If <code>TRUE</code>, an adjustement to the way the marginal variance part is computed in the (co)variance components estimator is applied in the variance components estimator. See <code>mixmeta.vc</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reltol </code></td>
<td>
<p> relative convergence tolerance in methods involving optimization procedures. The algorithm stops if it is unable to reduce the value by a factor of <code>reltol * (abs(val) + reltol)</code> at a step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>checkPD </code></td>
<td>
<p> logical. Determines if the semi-positiveness of within-unit error or random-effects (co)variance matrices must be checked.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>set.negeigen </code></td>
<td>
<p> positive value. Value to which negative eigenvalues are to be set in estimators where such method is used to force semi-positive definiteness of the estimated between-study (co)variance matrix.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function has default values for most of the arguments, some of them set internally. Non-default values are passed through the control argument of <code>mixmeta</code>. Many arguments refer to specific fitting procedures. See the help page of the related estimator for details.
</p>
<p>The function automatically sets non-default values for some control arguments for <code>optim</code>, unless explicitly set in the list passed to it. Specifically, the function selects <code>fnscale=-1</code>, <code>maxit=maxiter</code> and <code>reltol=reltol</code>, where the latter two are specified by other arguments of this function.
</p>
<p>The arguments <code>initPsi</code> and <code>Psifix</code> are used to provide information for estimation procedures of the random-effects parameters in likelihood-based methods. Specifically, the former is used to choose non-default starting values (see <code>mixmeta.ml</code>), and the latter for defining the fixed (known) part of specific <code>(co)variance structures</code>. In multilevel models, these arguments must be lists with named components referring to one or more levels of grouping defined by the argument <code>random</code> of <code>mixmeta</code>.
</p>
<p>The argument <code>addSlist</code> can be used to define more complex (known) error structures of the outcome(s) that are usually provided through the argument <code>S</code> of <code>mixmeta</code> as within-unit variances (or (co)variance matrices for multivariate models). This can be useful when these error structures spans multiple units (rows), and the between-unit correlation cannot be defined through <code>S</code>, for instance in dose-response meta-analysis (see examples in <code>mixmeta</code>). Note that this information is passed internally after the data have be re-ordered following the grouping defined by <code>random</code> in <code>mixmeta</code>, and this should be consistent in <code>addSlist</code>. Specifically, the grouping variables are assumed as factors and therefore the groups are taken in alphabetical/numeric order. It is suggested to re-order the data according to this order of the groups before fitting the model, so to ensure consistency between the grouped data and <code>addSlist</code>.
</p>


<h3>Value</h3>

<p>A list with components named as the arguments.
</p>


<h3>Note</h3>

<p>The function is expected to be extended and/or modified at every release of the package <span class="pkg">mixmeta</span>. It is strongly suggested to check the arguments of this function at every release.
</p>


<h3>Author(s)</h3>

<p>Antonio Gasparrini &lt;<a href="mailto:antonio.gasparrini@lshtm.ac.uk">antonio.gasparrini@lshtm.ac.uk</a>&gt; and Francesco Sera &lt;<a href="mailto:francesco.sera@lshtm.ac.uk">francesco.sera@lshtm.ac.uk</a>&gt;</p>


<h3>References</h3>

<p>Sera F, Armstrong B, Blangiardo M, Gasparrini A (2019). An extended mixed-effects framework for meta-analysis.<em>Statistics in Medicine</em>. 2019;38(29):5429-5444. [Freely available <a href="http://www.ag-myresearch.com/2019_sera_statmed.html"><b>here</b></a>].
</p>


<h3>See Also</h3>

<p>See <code>mixmeta</code>. See also <code>glm.control</code>. See the help pages of the related fitting functions for details on each parameter. See <code>mixmeta-package</code> for an overview of this modelling framework.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># PRINT THE ITERATIONS (SEE ?optim) AND CHANGE THE DEFAULT FOR STARTING VALUES
mixmeta(cbind(PD,AL) ~ pubyear, S=berkey98[5:7], data=berkey98,
  control=list(showiter=TRUE, igls.inititer=20))

# INPUT THE CORRELATION
mixmeta(cbind(y1,y2), S=cbind(V1,V2), data=p53, control=list(Scor=0.5))

# FIX (PARTS OF) THE RANDOM-EFFECTS (CO)VARIANCE MATRIX
y &lt;- as.matrix(smoking[11:13])
S &lt;- as.matrix(smoking[14:19])
mixmeta(y, S, bscov="prop", control=list(Psifix=diag(3)+1))
</code></pre>


</div>