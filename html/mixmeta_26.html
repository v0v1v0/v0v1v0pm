<div class="container">

<table style="width: 100%;"><tr>
<td>mixmetaCovStruct</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> (Co)variance Structures for mixmeta Models </h2>

<h3>Description</h3>

<p>Alternative options for the (co)variance structure of the random effects random effects in meta-analytical models, usually defined through the argument <code>bscov</code> of the function <code>mixmeta</code>.
</p>


<h3>Options</h3>

<p>Assuming a meta-analysis or meta-regression based on <code class="reqn">k</code> outcomes, for each grouping level with <code class="reqn">q</code> random-effects predictors the matrix can be specified in various forms listed below. For multivariate models with multiple predictors, the order implies a sequence of <code class="reqn">q</code> parameters for each <code class="reqn">k</code> outcomes. These are the options:
</p>

<ul>
<li> <p><code>unstr</code>: an unstructured form for a general positive-definite matrix. The matrix is represented by <code class="reqn">kq(kq+1)/2</code> unrestricted parameters defined as the upper triangular entries of its Cholesky decomposition.
</p>
</li>
<li> <p><code>diag</code>: a diagonal positive-definite matrix. The matrix is represented by <code class="reqn">kq</code> unrestricted parameters defined as the logarithm of the diagonal values.
</p>
</li>
<li> <p><code>id</code>: a multiple of the identity positive-definite matrix. The matrix is represented by a single unrestricted parameter defined as the logarithm of the diagonal value.
</p>
</li>
<li> <p><code>cs</code>: a positive-definite matrix with compound symmetry structure. The matrix is represented by 2 unrestricted parameters defined as the logarithm of the identical diagonal value and the transformed correlation. The latter is parameterized so to obtain a correlation value between <code class="reqn">-1/(kq-1)</code> and 1, in order to ensure positive-definiteness.
</p>
</li>
<li> <p><code>hcs</code>: a positive-definite matrix with heterogeneous compound symmetry structure. The matrix is represented by <code class="reqn">kq+1</code> unrestricted parameters defined as the logarithm of the diagonal values and the transformed correlation. The latter is parameterized so to obtain a correlation value between <code class="reqn">-1/(kq-1)</code> and 1, in order to ensure positive-definiteness.
</p>
</li>
<li> <p><code>ar1</code>: a positive-definite matrix with autoregressive structure of first order. The matrix is represented by 2 unrestricted parameters defined as the logarithm of the identical diagonal value and the logistic transformed correlation. The latter is parameterized so to obtain a correlation value between -1 and 1.
</p>
</li>
<li> <p><code>har1</code>: a positive-definite matrix with heterogeneous autoregressive structure of first order. The matrix is represented by <code class="reqn">kq+1</code> unrestricted parameters defined as the logarithm of the diagonal value and the logistic transformed correlation. The latter is parameterized so to obtain a correlation value between -1 and 1.
</p>
</li>
<li> <p><code>prop</code>: a positive-definite matrix proportional to that provided by the user through the argument <code>Psifix</code> in the control list (see <code>mixmeta.control</code>). The matrix is represented by 1 unrestricted parameter defined as the logarithm of the multiplier.
</p>
</li>
<li> <p><code>cor</code>: a positive-definite matrix with correlation structure provided by the user through the argument <code>Psifix</code> (with <code>cov2cor</code>) in the control list (see <code>mixmeta.control</code>). The matrix is represented by <code class="reqn">k</code> unrestricted parameters defined as the logarithm of the diagonal values.
</p>
</li>
<li> <p><code>fixed</code>: a known matrix provided by the user through the argument <code>Psifix</code> in the control list (see <code>mixmeta.control</code>). The matrix is known and no parameters are needed to represent it.
</p>
</li>
</ul>
<h3>Details</h3>

<p>Structures other than <code>unstr</code> are only available for models estimated through (restricted) maximum likelihood.
</p>
<p>The unrestricted parameters defining the random-effects (co)variance matrix (or matrices for multilvel models) are estimated in the iterative optimization algorithm (see <code>mixmeta.ml</code>). Although rarely needed and not recommeded, the user can provided a starting value of the (co)variance matrix, from which the parameters are derived (see <code>mixmeta.control</code>).
</p>


<h3>Note</h3>

<p>The choice of structures can affect the performance of the optimization procedure, determining forms of likelihood surfaces which induce convergence to local maxima. In particular, structures such as multiple of identity or proportional to a fixed matrix are based on strong assumptions and should be used with caution.
</p>


<h3>Author(s)</h3>

<p>Antonio Gasparrini &lt;<a href="mailto:antonio.gasparrini@lshtm.ac.uk">antonio.gasparrini@lshtm.ac.uk</a>&gt; and Francesco Sera &lt;<a href="mailto:francesco.sera@lshtm.ac.uk">francesco.sera@lshtm.ac.uk</a>&gt;</p>


<h3>References</h3>

<p>Sera F, Armstrong B, Blangiardo M, Gasparrini A (2019). An extended mixed-effects framework for meta-analysis.<em>Statistics in Medicine</em>. 2019;38(29):5429-5444. [Freely available <a href="http://www.ag-myresearch.com/2019_sera_statmed.html"><b>here</b></a>].
</p>
<p>Pinheiro JC and Bates DM (2000). <em>Mixed-Effects Models in S and S-PLUS</em>. New York, Springer Verlag.
</p>


<h3>See Also</h3>

<p>See <code>mixmeta</code>. See <code>lm</code> or <code>glm</code> for standard regression functions. See <code>mixmeta-package</code> for an overview of this modelling framework.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># UNSTRUCTURED AND STRUCTURED BETWEEN-STUDY (CO)VARIANCE
y &lt;- as.matrix(smoking[11:13])
S &lt;- as.matrix(smoking[14:19])
mod1 &lt;- mixmeta(y, S)
summary(mod1)
mod1$Psi

# DIAGONAL
mod2 &lt;- mixmeta(y, S, bscov="diag")
summary(mod2)
mod2$Psi

# HETEROGENEOUS COMPOUND SYMMETRY
mod3 &lt;- mixmeta(y, S, bscov="hcs")
summary(mod3)
mod3$Psi

# PROPORTIONAL
mod4 &lt;- mixmeta(y, S, bscov="prop", control=list(Psifix=diag(3)+1))
summary(mod4)
mod4$Psi

# CORRELATION
Psicor &lt;- matrix(0.2, 3, 3) ; diag(Psicor) &lt;- 1
mod5 &lt;- mixmeta(y, S, bscov="cor", control=list(Psifix=Psicor))
summary(mod5)
mod5$Psi
</code></pre>


</div>