<div class="container">

<table style="width: 100%;"><tr>
<td>blup.mixmeta</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Best Linear Unbiased Predictions from mixmeta Models </h2>

<h3>Description</h3>

<p>This method function computes (empirical) best linear unbiased predictions from fitted random-effects meta-analytical models represented in objects of class <code>"mixmeta"</code>. Quantities can represent prediction of outcomes given both fixed and random effects, or just random-effects residuals from the fixed-effects estimates. Predictions are optionally accompanied by standard errors, prediction intervals or the entire (co)variance matrix of the predicted outcomes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'mixmeta'
blup(object, se=FALSE, pi=FALSE, vcov=FALSE, pi.level=0.95, type="outcome",
  level, format, aggregate="stat", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object </code></td>
<td>
<p> an object of class <code>"mixmeta"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se </code></td>
<td>
<p> logical switch indicating if standard errors must be included.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi </code></td>
<td>
<p> logical switch indicating if prediction intervals must be included.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov </code></td>
<td>
<p> logical switch indicating if the (co)variance matrix must be included.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi.level </code></td>
<td>
<p> a numerical value between 0 and 1, specifying the confidence level for the computation of prediction intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type </code></td>
<td>
<p> the type of prediction. This can be either <code>outcome</code> (default) or <code>residual</code>. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level </code></td>
<td>
<p> level of random-effects grouping for which predictions are to be computed. Default to the highest (inner) level, with 0 corresponding to fixed-effects predictions obtained through <code>predict</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>format </code></td>
<td>
<p> the format for the returned results. See Value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aggregate </code></td>
<td>
<p> when <code>format="matrix"</code> and <code>se</code> or <code>ci</code> are required, the results may be aggregated by statistic or by outcome. See Value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>... </code></td>
<td>
<p> further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The method function <code>blup</code> produces (empirical) best linear unbiased predictions from <code>mixmeta</code> objects. These can represent outcomes, given by the sum of fixed and random parts, or just random-effects residuals representing deviations from the fixed-effects estimated outcomes. In non-standard models with multiple hierarchies of random effects, the argument <code>level</code> can be used to determine the level of grouping for which predictions are to be computed.
</p>
<p>These predictions are a shrunk version of unit-specific realizations, where unit-specific estimates borrow strength from the assumption of an underlying (potentially multivariate) distribution of outcomes or residuals in a (usually hypothetical) population. The amount of shrinkage depends from the relative size of the within and between-unit covariance matrices reported as components <code>S</code> and <code>Psi</code> in <code>mixmeta</code> objects (see <code>mixmetaObject</code>).
</p>
<p>Fixed-effects models do not assume random effects, and the results of <code>blup</code> for these models are identical to <code>predict</code> (for <code>type="oucome"</code>) or just 0's (for <code>type="residuals"</code>).
</p>
<p>How to handle predictions for units removed from estimation due to invalid missing pattern is determined by the <code>na.action</code> argument used in <code>mixmeta</code> to produce <code>object</code>. If <code>na.action=na.omit</code>, units excluded from estimation will not appear, whereas if <code>na.action=na.exclude</code> they will appear, with values set to <code>NA</code> for all the outcomes. This step is performed by <code>napredict</code>. See Note below.
</p>
<p>In the presence of missing values in the outcomes <code>y</code> of the fitted model, correspondent values of point estimates and covariance terms are set to 0, while the variance terms are set to <code>1e+10</code>. In this case, in practice, the unit-specific estimates do not provide any information (their weight is virtually 0), and the prediction tends to the value returned by <code>predict</code> with <code>interval="prediction"</code>, when applied to a new but identical set of predictors. See also Note below.
</p>


<h3>Value</h3>

<p>(Empirical) best linear unbiased predictions of outcomes or random-effects residuals. The results may be aggregated in matrices (the default), or returned as lists, depending on the argument <code>format</code>. For multivariate models, the aggregation is ruled by the argument <code>aggregate</code>, and the results may be grouped by statistic or by outcome. If <code>vcov=TRUE</code>, lists are always returned.
</p>


<h3>Note</h3>

<p>The definition of missing in model frames used for estimation in <code>mixmeta</code> is different than that commonly adopted in other regression models such as <code>lm</code> or <code>glm</code>. See info on <code>missing values</code> in <code>mixmeta</code>.
</p>
<p>Differently from <code>predict</code>, this method function computes the predicted values in the presence of partially missing outcomes. Interestingly, BLUPs for missing outcomes may be slightly different than predictions returned by <code>predict</code> on a new but identical set of predictors, as the BLUP also depends on the random part of the model. Specifically, the function uses information from the random-effects (co)variance to predict missing outcomes given the observed ones.
</p>


<h3>Author(s)</h3>

<p>Antonio Gasparrini &lt;<a href="mailto:antonio.gasparrini@lshtm.ac.uk">antonio.gasparrini@lshtm.ac.uk</a>&gt; and Francesco Sera &lt;<a href="mailto:francesco.sera@lshtm.ac.uk">francesco.sera@lshtm.ac.uk</a>&gt;</p>


<h3>References</h3>

<p>Sera F, Armstrong B, Blangiardo M, Gasparrini A (2019). An extended mixed-effects framework for meta-analysis.<em>Statistics in Medicine</em>. 2019;38(29):5429-5444. [Freely available <a href="http://www.ag-myresearch.com/2019_sera_statmed.html"><b>here</b></a>].
</p>
<p>Verbeke G, Molenberghs G. <em>Linear Mixed Models for Longitudinal Data</em>. Springer; 1997.
</p>


<h3>See Also</h3>

<p>See <code>predict</code> for standard predictions. See <code>mixmeta-package</code> for an overview of the package and modelling framework.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># RUN THE MODEL
model &lt;- mixmeta(cbind(PD,AL) ~ 1, S=berkey98[5:7], data=berkey98)

# ONLY BLUP
blup(model)

# BLUP AND SE
blup(model, se=TRUE)

# SAME AS ABOVE, AGGREGATED BY OUTCOME, WITH PREDICTION INTERVALS
blup(model, se=TRUE, pi=TRUE, aggregate="outcome")

# WITH VCOV, FORCED TO A LIST
blup(model, se=TRUE, pi=TRUE, vcov=TRUE, aggregate="outcome")

# PREDICTING ONLY THE RANDOM-EFFECT RESIDUALS
blup(model, type="residual")
</code></pre>


</div>