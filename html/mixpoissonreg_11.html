<div class="container">

<table style="width: 100%;"><tr>
<td>influence.mixpoissonreg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Global Influence Diagnostics for Mixed Poisson Regression Models</h2>

<h3>Description</h3>

<p>These functions provides global influence diagnostic quantities such as Cook's distance, hat values, generalized Cook's distance (through argument
on <code>cooks.distance.mixpoissonreg</code> function), likelihood displacement (through argument
on <code>cooks.distance.mixpoissonreg</code> function) and Q-displacement (through argument
on <code>cooks.distance.mixpoissonreg</code> function).
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'mixpoissonreg'
hatvalues(model, parameters = c("mean", "precision"), ...)

## S3 method for class 'mixpoissonreg'
cooks.distance(
  model,
  type = c("CD", "GCD", "GCDmean", "GCDprecision", "LD", "QD"),
  hat = c("mean", "precision"),
  ...
)

## S3 method for class 'mixpoissonreg'
influence(model, do.coef = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a <code>mixpoissonreg</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>
<p>the parameter to which the hat values will be computed. The options are 'mean' and 'precision'. The default is 'mean'. For hatvalues with respect to the mean
the model must be fitted with 'x' set to TRUE, and for hatvalues with respect to the precision the model must be fitted with 'w' set to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Currently not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>the type of Cook's distance to be used. The options are 'CD', the standard Cook's distance;
'GCD', the generalized Cook's distance with respect to all parameters, Zhu et al. (2001);
'GCDmean', the generalized Cook's distance with respect to the mean parameters;
'GCDprecision', the generalized Cook's distance with respect to the precision parameters;
'LD', the likelihood displacement (also known as likelihood distance), see Cook and Weisberg (1982); 'QD', the Q-displacement, see Zhu et al. (2001).
See 'details' for more informations. For 'GCD', 'GCDmean', 'LD' and 'QD', the model must be fitted with 'x' set to TRUE,
and for 'GCD', 'GCDprecision', 'LD' and 'QD', the model must be fitted with 'w' set to TRUE. For 'CD', if 'hat' is set to 'mean',
the model must be fitted with 'x' set to TRUE, whereas
if 'hat' is set to 'precision', the model must be fitted with 'w' set to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hat</code></td>
<td>
<p>hat values <code>H[i,i]</code>. The default is obtained through the second-derivative of the Q-function in the spirit of Zhu et al. (2001) and Pregibon (1981), see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.coef</code></td>
<td>
<p>logical indicating if the the approximation to the change of coefficients values after case removal are desired. The model must be fitted with x = TRUE. See details for further explanations.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For hat values of mixed Poisson regression models, we follow Zhu et al. (2001) to consider the negative of the hessian of the Q-function as weight matrix, and follow
Pregibon (1981) to define the 'hat' matrix with respect to this weight matrix. We can consider the hessian of the Q-function with respect to mean-related parameters,
which is the default. We can also consider the hessian of the Q-function with respect to the precision-related parameters to give rise to hat values related to the precision
parameters.
</p>
<p>The Generalized Cook's distance and Q-displacement for EM-based models were defined in Zhu et al. (2001) and computed for mixed Poisson regression models
in Barreto-Souza and Simas (2016). We implemented first-order approximation to these quantities to make it computationally feasible. These first-order approximations
are available in Barreto-Souza and Simas (2016). We also provide versions of generalized Cook's distance for mean-related or precision-related parameters, whose
details can be found in Barreto-Souza and Simas (2016).
</p>
<p>In the influence method we provide a 'do.coef' argument that computes first-order approximations to the impact of removal of each case to each parameter, in the
same spirit as the 'do.coeff' argument in 'influence.lm'.
</p>


<h3>Value</h3>

<p>The method <code>influence.mixpoissonreg</code> returns a list containing
<em>hat.mean</em>, a vector containing the hat values with respect to the mean, <em>hat.precision</em>,
a vector containing the hat values with respect to the precision, <em>coefficients.mean</em> (if <code>do.coef=TRUE</code>), a matrix
containing the first
order approximations for the mean-related coefficients after the removal
of each observation, <em>coefficients.precision</em> (if <code>do.coef=TRUE</code>), a matrix containing the first
order approximations for the precision-related coefficients after the removal
of each observation, <em>pear.res</em>, a vector containing the Pearson residuals,
<em>score.res</em>, a vector containing the score residuals.
</p>
<p>The <em>cooks.distance.mixpoissonreg</em> returns a vector containing the Cook's distances.
</p>
<p>The <em>hatvalues.mixpoissonreg</em> returns a vector containing the hat values.
</p>


<h3>References</h3>

<p>DOI:10.1007/s11222-015-9601-6 doi: <a href="https://doi.org/10.1007/s11222-015-9601-6">10.1007/s11222-015-9601-6</a>(Barreto-Souza and Simas, 2016)
</p>
<p>Cook, D.R. and Weisberg, S. (1982) <em>Residuals and Influence in Regression</em>. (New York: Chapman and Hall, 1982)
</p>
<p>Pregibon, D. (1981) <em>Logistic Regression Diagnostics</em>. Ann. Stat. 9, 705-724.
</p>
<p>Zhu, H.T., Lee, S.Y., Wei, B.C., Zhu, J. (2001) <em>Case-deletion measures formodels with incomplete data.</em> Biometrika, 88, 727â€“737.
</p>


</div>