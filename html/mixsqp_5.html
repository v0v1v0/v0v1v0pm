<div class="container">

<table style="width: 100%;"><tr>
<td>simulatemixdata</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create likelihood matrix from simulated data set</h2>

<h3>Description</h3>

<p>Simulate a data set, then compute the conditional
likelihood matrix under a univariate normal likelihood and a
mixture-of-normals prior. This models a simple nonparametric
Empirical Bayes method applied to simulated data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simulatemixdata(
  n,
  m,
  simtype = c("n", "nt"),
  log = FALSE,
  normalize.rows = !log
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Positive integer specifying the number of samples to
generate and, consequently, the number of rows of the likelihood
matrix L.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>Integer 2 or greater specifying the number of mixture
components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simtype</code></td>
<td>
<p>The type of data to simulate. If <code>simtype =
"n"</code>, simulate <code>n</code> random numbers from a mixture of three
univariate normals with mean zero and standard deviation 1, 3 and
6. If <code>simtype = "nt"</code>, simulate from a mixture of three
univariate normals (with zero mean and standard deviations 1, 3 and
5), and a t-distribution with 2 degrees of freedom.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>If <code>log = TRUE</code>, return the</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalize.rows</code></td>
<td>
<p>If <code>normalize.rows = TRUE</code>, normalize
the rows of the likelihood matrix so that the largest entry in each
row is 1. The maximum-likelihood estimate of the mixture weights
should be invariant to this normalization, and can improve the
numerical stability of the optimization.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>simulatemixdata</code> returns a list with three list
elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The vector of simulated random numbers (it has length n).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>The standard deviations of the mixture components in the
mixture-of-normals prior. The rules for selecting the standard
deviations are based on the <code>autoselect.mixsd</code> function from
the <code>ashr</code> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>The n x m conditional likelihood matrix, in which
individual entries (i,j) of the likelihood matrix are given by the
normal density function with mean zero and variance <code>1 +
s[j]^2</code>. If <code>normalize.rows = TRUE</code>, the entries in each row
are normalized such that the larger entry in each row is 1. If
<code>log = TRUE</code>, the matrix of log-likelihoods is returned.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">
# Generate the likelihood matrix for a data set with 1,000 samples
# and a nonparametric Empirical Bayes model with 20 mixture
# components.
dat &lt;- simulatemixdata(1000,20)

</code></pre>


</div>