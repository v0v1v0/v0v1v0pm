<div class="container">

<table style="width: 100%;"><tr>
<td>rmvnormmix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate from Multivariate (repeated measures) Mixtures of Normals</h2>

<h3>Description</h3>

<p>Simulate from a mixture of multivariate zero-correlation normal distributions
</p>


<h3>Usage</h3>

<pre><code class="language-R">rmvnormmix(n, lambda=1, mu=0, sigma=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of cases to simulate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Vector of mixture probabilities with length equal to <code class="reqn">m</code>, the
desired number of components.  This is assumed to sum
to 1; if not, it is normalized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>Matrix of means of dimensions <code class="reqn">m\times r</code>, where
<code class="reqn">m</code> is the number of components (subpopulations) and <code class="reqn">r</code> is
the number of coordinates (repeated measurements) per case.  Note:  <code>mu</code>
is automatically coerced to a matrix with <code class="reqn">m</code> rows even if it is not
given in this form, which can lead to unexpected behavior in some cases.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>Matrix of standard deviations, same dimensions as <code>mu</code>.
The coordinates within a case are independent, conditional on the mixture
component. (There is marginal correlation among the coordinates, but
this is due to the mixture structure only.)  Note:  <code>sigma</code> is
automatically coerced to a matrix with <code class="reqn">m</code> rows even if it is not
given in this form, which can lead to unexpected behavior in some cases.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>It is possible to generate univariate standard normal random variables using
the default values (but why bother?).  The case of conditionally iid
coordinates is covered by the situation in which
all columns in mu and sigma are identical.
</p>


<h3>Value</h3>

<p><code>rmvnormmix</code> returns an <code class="reqn">n\times r</code> matrix in which each row is
a sample from one of the components of a mixture of zero-correlation 
multivariate normals.  The mixture structure
induces nonzero correlations among the coordinates.
</p>


<h3>See Also</h3>

<p><code>rnormmix</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">##Generate data from a 2-component mixture of trivariate normals.

set.seed(100)
n &lt;- 200
lambda &lt;- rep(1, 2)/2
mu &lt;- matrix(2*(1:6), 2, 3)
sigma &lt;- matrix(1,2,3)
mydata&lt;-rmvnormmix(n, lambda, mu, sigma)

## Now check to see if we can estimate mixture densities well:
title &lt;- paste("Does this resemble N(", mu[1,], ",1) and N(", mu[2,],",1)?",
                sep="")
plot(npEM(mydata, 2), title=title)
</code></pre>


</div>