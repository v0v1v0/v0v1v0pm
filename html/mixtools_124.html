<div class="container">

<table style="width: 100%;"><tr>
<td>spEMsymlocN01</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>semiparametric EM-like algorithm for univariate mixture in False Discovery Rate (FDR) estimation</h2>

<h3>Description</h3>

<p>Return semiparametric EM-like algorithm output for a 2-components 
mixture model with one component set to Normal(0,1), and the other component 
being a unspecified but symmetric density with a location parameter. 
This model is tailored to
FDR estimation on probit transform (<code>qnorm</code>) of p-values arising from multiple testing.</p>


<h3>Usage</h3>

<pre><code class="language-R">spEMsymlocN01(x, mu0 = 2, bw = bw.nrd0(x), h=bw, eps = 1e-8,
              maxiter = 100, verbose = FALSE, plotf = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A vector of length n consisting of the data, probit transform of pvalues, preferably sorted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu0</code></td>
<td>
<p>Starting value of vector of component means. If not set then the initial value
is randomly generated by a <code>kmeans</code> of the data in two bins. Since component 1 is 
theoretically normal(0,1), <code>mu[1]</code> must be 0 and <code>mu[2]</code> some negative value (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p>Bandwidth for weighted kernel density estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>Alternative way to specify the bandwidth, to provide backward compatibility.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>Tolerance limit for declaring algorithm convergence. 
Convergence is declared before <code>maxiter</code> iterations 
whenever the maximum change in any coordinate of the 
<code>lambda</code> (mixing proportion estimates) and <code>mu</code> (mean of the semiparametric component) 
vector  does not exceed <code>eps</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>The maximum number of iterations allowed; convergence
may be declared before <code>maxiter</code> iterations (see <code>eps</code> above).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If TRUE, print updates for every iteration of the algorithm as
it runs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotf</code></td>
<td>
<p>If TRUE, plots successive updates of the nonparametric density estimate
over iterations. Mostly for testing purpose.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This algorithm is a specific version of semiparametric EM-like algorithm
similar in spirit to <code>spEMsymloc</code>, but specialized for FDR estimation on
probit transform (<code>qnorm</code>) of p-values in multiple testing framework.
In this model, component 1 corresponds to the individuals under the null hypothesis,
i.e. theoretically normal(0,1) distributed, whereas component 2 corresponds to individuals in the
alternative hypothesis, with typically very small p-values and consequently
negative values for probit(p) data. This model only assumes
that these individuals come from an unspecified but symmetric density with a location parameter,
as in Bordes and Vandekerkhove (2010) and Chauveau et al. (2014).</p>


<h3>Value</h3>

<p><code>spEMsymlocN01</code> returns a list of class <code>spEMN01</code> with the following items:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The raw data (an <code class="reqn">n\times r</code> matrix).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posteriors</code></td>
<td>
<p>An <code class="reqn">n\times 2</code> matrix of posterior probabilities for
observations. This can be used in, e.g., <code>plotFDR</code> to plot
False Discovery Rate estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandwidth</code></td>
<td>
<p>Same as the <code>bw</code> input argument, returned because this
information is needed by any method that produces density estimates from the
output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>The sequence of mixing proportions over iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambdahat</code></td>
<td>
<p>The final estimate for mixing proportions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>the sequence of second component mean over iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>muhat</code></td>
<td>
<p>the final estimate of second component mean.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>symmetric</code></td>
<td>
<p>Flag indicating that the kernel density estimate is
using a symmetry assumption.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Didier Chauveau</p>


<h3>References</h3>


<ul>
<li>
<p> Bordes, L. and Vandekerkhove, P. (2010). 
Semiparametric two-component mixture model with a known component:
an asymptotically normal estimator.
Mathematical Methods of Statistics, 19(1):22-41
</p>
</li>
<li>
<p> Chauveau, D., Saby, N., Orton, T. G., Lemercier B., 
Walter, C. and Arrouys, D. (2014)
Large-scale simultaneous hypothesis testing in monitoring carbon
content from french soil database: A semi-parametric mixture approach.
Geoderma 219-220 (2014): 117-124.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>spEMsymloc</code>, <code>normalmixEM</code>,
<code>npEM</code>, <code>plot.spEMN01</code>,
<code>plotFDR</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Probit transform of p-values
## from a Beta-Uniform mixture model
## comparion of parametric and semiparametric EM fit
## Note: in actual situations n=thousands 
set.seed(50)
n=300 # nb of multiple tests
m=2 # 2 mixture components
a=c(1,0.1); b=c(1,1); lambda=c(0.6,0.4) # parameters
z=sample(1:m, n, rep=TRUE, prob = lambda)
p &lt;- rbeta(n, shape1 = a[z], shape2 = b[z]) # p-values
o &lt;- order(p)
cpd &lt;- cbind(z,p)[o,] # sorted complete data, z=1 if H0, 2 if H1
p &lt;- cpd[,2] # sorted p-values

y &lt;- qnorm(p) # probit transform of the pvalues
# gaussian EM fit with component 1 constrained to N(0,1)
s1 &lt;- normalmixEM(y, mu=c(0,-4), 
				mean.constr = c(0,NA), sd.constr = c(1,NA)) 
s2 &lt;- spEMsymlocN01(y, mu0 = c(0,-3)) # spEM with N(0,1) fit
hist(y, freq = FALSE, col = 8, main = "histogram of probit(pvalues)")
plot(s2, add.plot = TRUE, lwd = 2)

# Exemples of plot capabilities
# Note: posteriors must be ordered by p for plot.FDR
# plotFDR(s1$post) # when true complete data not observed
# plotFDR(s1$post, s2$post) # comparing 2 strategies
plotFDR(s1$post, s2$post, lg1 = "normalmixEM", lg2 = "spEMsymlocN01", 
		complete.data = cpd) # with true FDR computed from z
</code></pre>


</div>