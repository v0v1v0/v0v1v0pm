<div class="container">

<table style="width: 100%;"><tr>
<td>weibullRMM_SEM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>St-EM algorithm for Reliability Mixture Models (RMM) of Weibull with right Censoring</h2>

<h3>Description</h3>

<p>Parametric Stochastic EM (St-EM) algorithm for univariate finite mixture of Weibull 
distributions with randomly right censored data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">weibullRMM_SEM(x, d = NULL, lambda = NULL, shape = NULL, scale = NULL,
        k = 2, maxit = 200, maxit.survreg = 200, epsilon = 1e-03,
        averaged = TRUE, verb = FALSE) </code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A vector of <code class="reqn">n</code> real positive lifetime (possibly censored) durations.
If <code>d</code> is not <code>NULL</code> then a vector of random censoring times
<code>c</code> occured,  
so that <code class="reqn">x= min(x,c)</code> and <code class="reqn">d = I(x &lt;= c)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>The vector of censoring indication, where 1 means observed lifetime data, 
and 0 means censored lifetime data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Initial value of mixing proportions.
If <code>NULL</code>, then <code>lambda</code> is set to <code>rep(1/k,k)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape</code></td>
<td>
<p>Initial value of Weibull component shapes, 
all set to 1 if  <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>Initial value of Weibull component scales, 
all set to 1 if  <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Number of components of the mixture.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>The number of iterations allowed, since for St-EM algorithms convergence
is not based on stabilization, exactly <code>maxit</code> iterations are performed
(see  Bordes L. and Chauveau D. (2016) reference below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit.survreg</code></td>
<td>
<p>The number of iterations allowed in the computations of the
MLE for censored weibull data from the  <code>survival</code> package
(see  Bordes L. and Chauveau D. (2016) reference below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>Tolerance parameter used in the numerical computations of the
MLE for censored weibull data by <code>survreg</code> from the  <code>survival</code> package
(see  Bordes L. and Chauveau D. (2016) reference below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>averaged</code></td>
<td>
<p>The way of updating parameters at each iteration: if <code>TRUE</code>, current values of the parameters 
are obtained by averaging the sequence
(see Bordes L. and Chauveau D. (2016) reference below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verb</code></td>
<td>
<p>If TRUE, print updates for every iteration of the algorithm as
it runs</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This St-EM algorithm calls functions from  the <code>survival</code> package to compute 
parametric MLE for censored weibull data.</p>


<h3>Value</h3>

<p><code>weibullRMM_SEM</code> returns a list of class "mixEM" with the following items:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The input data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>The input censoring indicator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>The estimates for the  mixing proportions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>The estimates for the Weibull component scales.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape</code></td>
<td>
<p>The estimates for the Weibull component shapes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>The log-likelihood value at convergence of the algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posterior</code></td>
<td>
<p>An <code class="reqn">n\times k</code> matrix of posterior probabilities for
observation, after convergence of the algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>all.loglik</code></td>
<td>
<p>The sequence of log-likelihoods over iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>all.lambda</code></td>
<td>
<p>The sequence of mixing proportions over iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>all.scale</code></td>
<td>
<p>The sequence of component scales over iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>all.shape</code></td>
<td>
<p>The sequence of component shapes over iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ft</code></td>
<td>
<p>A character vector giving the name of the function called.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Didier Chauveau</p>


<h3>References</h3>


<ul><li>
<p> Bordes, L., and Chauveau, D. (2016),
Stochastic EM algorithms for parametric and semiparametric mixture models 
for right-censored lifetime data, 
Computational Statistics, Volume 31, Issue 4, pages 1513-1538.
<a href="https://link.springer.com/article/10.1007/s00180-016-0661-7">https://link.springer.com/article/10.1007/s00180-016-0661-7</a>
</p>
</li></ul>
<h3>See Also</h3>

<p>Related functions:
<code>plotweibullRMM</code>,   <code>summary.mixEM</code>.
</p>
<p>Other models and algorithms for censored lifetime data 
(name convention is model_algorithm):
<code>expRMM_EM</code>,
<code>spRMM_SEM</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">n = 500 # sample size
m = 2 # nb components
lambda=c(0.4, 0.6)
shape &lt;- c(0.5,5); scale &lt;- c(1,20) # model parameters
set.seed(321)
x &lt;- rweibullmix(n, lambda, shape, scale) # iid ~ weibull mixture
cs=runif(n,0,max(x)+10) # iid censoring times
t &lt;- apply(cbind(x,cs),1,min) # censored observations
d &lt;- 1*(x &lt;= cs)              # censoring indicator

## set arbitrary or "reasonable" (e.g., data-driven) initial values
l0 &lt;- rep(1/m,m); sh0 &lt;- c(1, 2); sc0 &lt;- c(2,10)
# Stochastic EM algorithm 
a &lt;- weibullRMM_SEM(t, d, lambda = l0, shape = sh0, scale = sc0, maxit = 200)

summary(a) # Parameters estimates etc
plotweibullRMM(a) # plot of St-EM sequences
plot(a, which=2) # or equivalently, S3 method for "mixEM" object


</code></pre>


</div>