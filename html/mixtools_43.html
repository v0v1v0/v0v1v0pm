<div class="container">

<table style="width: 100%;"><tr>
<td>multmixEM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>EM Algorithm for Mixtures of Multinomials</h2>

<h3>Description</h3>

<p>Return EM algorithm output for mixtures of multinomial distributions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">multmixEM(y, lambda = NULL, theta = NULL, k = 2,
          maxit = 10000, epsilon = 1e-08, verb = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Either An nxp matrix of data (multinomial counts), where n is the
sample size and p is the number of multinomial bins, or the
output of the <code>makemultdata</code> function.  It is not necessary
that all of the rows contain the same number of multinomial trials (i.e.,
the row sums of <code>y</code> need not be identical).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Initial value of mixing proportions.  Entries should sum to
1.  This determines number of components.  If NULL, then <code>lambda</code> is
random from uniform Dirichlet and number of
components is determined by <code>theta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>Initial value of <code>theta</code> parameters.  Should be a kxp matrix,
where p is the number of columns of y and k is number of components.
Each row of <code>theta</code> should sum to 1.
If NULL, then each row is random from uniform Dirichlet.
If both <code>lambda</code> and <code>theta</code> are NULL, then number of components 
is determined by k.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Number of components.  Ignored unless <code>lambda</code> and <code>theta</code>
are NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>The convergence criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>The maximum number of iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verb</code></td>
<td>
<p>If TRUE, then various updates are printed during each iteration of the algorithm.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>multmixEM</code> returns a list of class <code>mixEM</code> with items:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The raw data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>The final mixing proportions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>The final multinomial parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>The final log-likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posterior</code></td>
<td>
<p>An nxk matrix of posterior probabilities for
observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>all.loglik</code></td>
<td>
<p>A vector of each iteration's log-likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>restarts</code></td>
<td>
<p>The number of times the algorithm restarted due to unacceptable choice of initial values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ft</code></td>
<td>
<p>A character vector giving the name of the function.</p>
</td>
</tr>
</table>
<h3>References</h3>


<ul>
<li>
<p> McLachlan, G. J. and Peel, D. (2000) <em>Finite Mixture Models</em>, John Wiley and Sons, Inc.
</p>
</li>
<li>
<p> Elmore, R. T., Hettmansperger, T. P. and Xuan, F. (2004) The Sign Statistic, One-Way Layouts
and Mixture Models, <em>Statistical Science</em> <b>19(4)</b>, 579â€“587.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>compCDF</code>, <code>makemultdata</code>, <code>multmixmodel.sel</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## The sulfur content of the coal seams in Texas

set.seed(100)
A &lt;- c(1.51, 1.92, 1.08, 2.04, 2.14, 1.76, 1.17)
B &lt;- c(1.69, 0.64, .9, 1.41, 1.01, .84, 1.28, 1.59) 
C &lt;- c(1.56, 1.22, 1.32, 1.39, 1.33, 1.54, 1.04, 2.25, 1.49) 
D &lt;- c(1.3, .75, 1.26, .69, .62, .9, 1.2, .32) 
E &lt;- c(.73, .8, .9, 1.24, .82, .72, .57, 1.18, .54, 1.3)

dis.coal &lt;- makemultdata(A, B, C, D, E, 
                         cuts = median(c(A, B, C, D, E)))
em.out &lt;- multmixEM(dis.coal)
em.out[1:4]
</code></pre>


</div>