<div class="container">

<table style="width: 100%;"><tr>
<td>mvnormalmixEM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>EM Algorithm for Mixtures of Multivariate Normals</h2>

<h3>Description</h3>

<p>Return EM algorithm output for mixtures of multivariate normal distributions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mvnormalmixEM(x, lambda = NULL, mu = NULL, sigma = NULL, k = 2,
              arbmean = TRUE, arbvar = TRUE, epsilon = 1e-08, 
              maxit = 10000, verb = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A matrix of size nxp consisting of the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Initial value of mixing proportions.  Entries should sum to
1.  This determines number of components.  If NULL, then <code>lambda</code> is
random from uniform Dirichlet and number of
components is determined by <code>mu</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>A list of size k consisting of initial values for the p-vector mean parameters.  
If NULL, then the vectors are generated from a normal distribution with
mean and standard deviation according to a binning method done on the data.
If both <code>lambda</code> and <code>mu</code> are NULL, then number of components is determined by <code>sigma</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>A list of size k consisting of initial values for the pxp variance-covariance matrices.  
If NULL, then <code>sigma</code> is generated using the data.  
If <code>lambda</code>, <code>mu</code>, and <code>sigma</code> are
NULL, then number of components is determined by <code>k</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Number of components.  Ignored unless <code>lambda</code>, <code>mu</code>, and <code>sigma</code>
are all NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arbmean</code></td>
<td>
<p>If TRUE, then the component densities are allowed to have different <code>mu</code>s. If FALSE, then
a scale mixture will be fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arbvar</code></td>
<td>
<p>If TRUE, then the component densities are allowed to have different <code>sigma</code>s. If FALSE, then
a location mixture will be fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>The convergence criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>The maximum number of iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verb</code></td>
<td>
<p>If TRUE, then various updates are printed during each iteration of the algorithm.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>normalmixEM</code> returns a list of class <code>mixEM</code> with items:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The raw data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>The final mixing proportions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>A list of with the final mean vectors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>A list with the final variance-covariance matrices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>The final log-likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posterior</code></td>
<td>
<p>An nxk matrix of posterior probabilities for
observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>all.loglik</code></td>
<td>
<p>A vector of each iteration's log-likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>restarts</code></td>
<td>
<p>The number of times the algorithm restarted due to unacceptable choice of initial values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ft</code></td>
<td>
<p>A character vector giving the name of the function.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>McLachlan, G. J. and Peel, D. (2000) <em>Finite Mixture Models</em>, John Wiley and Sons, Inc.
</p>


<h3>See Also</h3>

<p><code>normalmixEM</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">##Fitting randomly generated data with a 2-component location mixture of bivariate normals.

set.seed(100)
x.1 &lt;- rmvnorm(40, c(0, 0))
x.2 &lt;- rmvnorm(60, c(3, 4))
X.1 &lt;- rbind(x.1, x.2)
mu &lt;- list(c(0, 0), c(3, 4))

out.1 &lt;- mvnormalmixEM(X.1, arbvar = FALSE, mu = mu,
                       epsilon = 1e-02)
out.1[2:5]

##Fitting randomly generated data with a 2-component scale mixture of bivariate normals.

x.3 &lt;- rmvnorm(40, c(0, 0), sigma = 
               matrix(c(200, 1, 1, 150), 2, 2))
x.4 &lt;- rmvnorm(60, c(0, 0))
X.2 &lt;- rbind(x.3, x.4)
lambda &lt;- c(0.40, 0.60)
sigma &lt;- list(diag(1, 2), matrix(c(200, 1, 1, 150), 2, 2))
 
out.2 &lt;- mvnormalmixEM(X.2, arbmean = FALSE,
                       sigma = sigma, lambda = lambda,
                       epsilon = 1e-02)
out.2[2:5]
</code></pre>


</div>