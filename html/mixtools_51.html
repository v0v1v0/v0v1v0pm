<div class="container">

<table style="width: 100%;"><tr>
<td>normalmixEM2comp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fast EM Algorithm for 2-Component Mixtures of Univariate Normals</h2>

<h3>Description</h3>

<p>Return EM algorithm output for mixtures of univariate normal distributions 
for the special case of 2 components, exploiting the simple structure of the
problem to speed up the code.
</p>


<h3>Usage</h3>

<pre><code class="language-R">normalmixEM2comp(x, lambda, mu, sigsqrd, eps= 1e-8, maxit = 1000, verb=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A vector of length <code class="reqn">n</code> consisting of the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Initial value of first-component mixing proportion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>A 2-vector of initial values for the mean parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigsqrd</code></td>
<td>
<p>Either a scalar or a 2-vector with initial value(s) for
the variance parameters.  If a scalar, the algorithm assumes that the
two components have equal variances; if a 2-vector, it assumes that the
two components do not have equal variances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>The convergence criterion.  Convergence is declared when the change in 
the observed data log-likelihood increases by less than epsilon.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>The maximum possible number of iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verb</code></td>
<td>
<p>If TRUE, then various updates are printed during each iteration of the algorithm.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This code is written to be very fast, sometimes more than an order of magnitude
faster than <code>normalmixEM</code> for the same problem.  It is less numerically
stable that <code>normalmixEM</code> in the sense that it does not safeguard 
against underflow as carefully.
</p>
<p>Note that when the two components are assumed to have unequal variances,
the loglikelihood is unbounded.  However, in practice this is rarely a problem
and quite often the algorithm converges to a "nice" local maximum.
</p>


<h3>Value</h3>

<p><code>normalmixEM2comp</code> returns a list of class <code>mixEM</code> with items:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The raw data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>The final mixing proportions (lambda and 1-lambda).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>The final two mean parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>The final one or two standard deviations. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>The final log-likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posterior</code></td>
<td>
<p>An nx2 matrix of posterior probabilities for
observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>all.loglik</code></td>
<td>
<p>A vector of each iteration's log-likelihood.  This vector
includes both the initial and the final values; thus, the number of iterations 
is one less than its length.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>restarts</code></td>
<td>
<p>The number of times the algorithm restarted due to 
unacceptable choice of initial values (always zero).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ft</code></td>
<td>
<p>A character vector giving the name of the function.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>McLachlan, G. J. and Peel, D. (2000) <em>Finite Mixture Models</em>, John Wiley and Sons, Inc.
</p>


<h3>See Also</h3>

<p><code>mvnormalmixEM</code>, <code>normalmixEM</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">##Analyzing the Old Faithful geyser data with a 2-component mixture of normals.

data(faithful)
attach(faithful)
set.seed(100)
system.time(out &lt;- normalmixEM2comp(waiting, lambda=.5, 
            mu=c(50,80), sigsqrd=100))
out$all.loglik # Note:  must be monotone increasing

# Compare elapsed time with more general version
system.time(out2 &lt;- normalmixEM(waiting, lambda=c(.5,.5), 
            mu=c(50,80), sigma=c(10,10), arbvar=FALSE))
out2$all.loglik # Values should be identical to above
</code></pre>


</div>