<div class="container">

<table style="width: 100%;"><tr>
<td>plot.npEM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot Nonparametric or Semiparametric EM Output</h2>

<h3>Description</h3>

<p>Takes an object of class <code>npEM</code> and returns a set of plots of the 
density estimates for each block and each component.  There is one plot
per block, with all the components displayed on each block so it is possible
to see the mixture structure for each block.      
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'npEM'
plot(x, blocks = NULL, hist=TRUE, addlegend = TRUE,
      scale=TRUE, title=NULL, breaks="Sturges", ylim=NULL, dens.col,
      newplot = TRUE, pos.legend = "topright", cex.legend = 1, ...)         
## S3 method for class 'spEM'
plot(x, blocks = NULL, hist=TRUE, addlegend = TRUE,
      scale=TRUE, title=NULL, breaks="Sturges", ylim=NULL, dens.col,
      newplot = TRUE, pos.legend = "topright", cex.legend = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class <code>npEM</code> such as the output
of the <code>npEM</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blocks</code></td>
<td>
<p>Blocks (of repeated measures coordinates) to plot; not relevant
for univariate case.  Default is to plot all blocks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hist</code></td>
<td>
<p>If TRUE, superimpose density estimate plots on a histogram
of the data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>addlegend</code></td>
<td>
<p>If TRUE, adds legend to the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>If TRUE, scale each density estimate by its corresponding estimated
mixing proportion, so that the total area under all densities equals 1 and the 
densities plotted may be added to produce an estimate of the mixture density.
When FALSE, each density curve has area 1 in the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>Alternative vector of main titles for plots (recycled as many times
as needed)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>
<p>Passed directly to the <code>hist</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p><code>ylim</code> parameter to use for all plots, if desired.  If not
given, each plot uses its own ylim that ensures that no part of the plot will
go past the top of the plotting area.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dens.col</code></td>
<td>
<p>Color values to use for the individual component density
functions, repeated as necessary.  Default value is <code>2:(m+1)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newplot</code></td>
<td>
<p>If TRUE, creates a new plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos.legend</code></td>
<td>
<p>Single argument specifying the 
position of the legend.  See ‘Details’ section of
<code>legend</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.legend</code></td>
<td>
<p>Character expansion factor for <code>legend</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Any remaining arguments are passed to the <code>hist</code> and 
<code>lines</code> functions.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>plot.npEM</code> returns a list with two elements:




</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>List of matrices.  The <code class="reqn">j</code>th column of the <code class="reqn">i</code>th matrix is the vector of 
<code class="reqn">x</code>-values for the <code class="reqn">j</code>th density in the <code class="reqn">i</code>th plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p><code class="reqn">y</code>-values, given in the same form as the <code class="reqn">x</code>-values.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

 
<p><code>npEM</code>, <code>density.npEM</code>, <code>spEMsymloc</code>,
<code>plotseq.npEM</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> 
## Examine and plot water-level task data set.

## First, try a 3-component solution where no two coordinates are
## assumed i.d.
data(Waterdata)
set.seed(100)
## Not run: 
a &lt;- npEM(Waterdata[,3:10], 3, bw=4)
par(mfrow=c(2,4))
plot(a) # This produces 8 plots, one for each coordinate

## End(Not run)

## Not run: 
## Next, same thing but pairing clock angles that are directly opposite one
## another (1:00 with 7:00, 2:00 with 8:00, etc.)
b &lt;- npEM(Waterdata[,3:10], 3, blockid=c(4,3,2,1,3,4,1,2), bw=4)
par(mfrow=c(2,2))
plot(b) # Now only 4 plots, one for each block

## End(Not run)

</code></pre>


</div>