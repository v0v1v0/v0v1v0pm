<div class="container">

<table style="width: 100%;"><tr>
<td>density.npEM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Normal kernel density estimate for nonparametric EM output</h2>

<h3>Description</h3>

<p>Takes an object of class <code>npEM</code> and returns an object of class
<code>density</code> giving the kernel density estimate for the selected
component and, if applicable, the selected block.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'npEM'
density(x, u=NULL, component=1, block=1, scale=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class <code>npEM</code> such as the output
of the <code>npEM</code> or <code>spEMsymloc</code> functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>Vector of points at which the density is to be evaluated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>component</code></td>
<td>
<p>Mixture component number; should be an integer from 1 to the
number of columns of <code>x$posteriors</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>block</code></td>
<td>
<p>Block of repeated measures.  Only applicable in repeated measures
case, for which <code>x$blockid</code> exists; should be an integer from 1 to
<code>max(x$blockid)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>Logical:  If TRUE, multiply the density values by the 
corresponding mixing proportions found in <code>x$lambdahat</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments; not used by this method.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The bandwidth is taken to be the same as that used to produce the <code>npEM</code>
object, which is given by <code>x$bandwidth</code>.
</p>


<h3>Value</h3>

<p><code>density.npEM</code> returns a list of type <code>"density"</code>.  See 
<code>density</code> for details.  In particular, the output of 
<code>density.npEM</code> may be used directly by functions such as 
<code>plot</code> or <code>lines</code>.
</p>


<h3>See Also</h3>

 
<p><code>npEM</code>, <code>spEMsymloc</code>, <code>plot.npEM</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> 
## Look at histogram of Old Faithful waiting times
data(faithful)
Minutes &lt;- faithful$waiting
hist(Minutes, freq=FALSE)

## Superimpose equal-variance normal mixture fit:
set.seed(100)
nm &lt;- normalmixEM(Minutes, mu=c(50,80), sigma=5, arbvar=FALSE, fast=TRUE)
x &lt;- seq(min(Minutes), max(Minutes), len=200)
for (j in 1:2) 
  lines(x, nm$lambda[j]*dnorm(x, mean=nm$mu[j], sd=nm$sigma), lwd=3, lty=2)
  
## Superimpose several semiparametric fits with different bandwidths:
bw &lt;- c(1, 3, 5)
for (i in 1:3) {
  sp &lt;- spEMsymloc(Minutes, c(50,80), bw=bw[i], eps=1e-3)
  for (j in 1:2) 
    lines(density(sp, component=j, scale=TRUE), col=1+i, lwd=2)    
}
legend("topleft", legend=paste("Bandwidth =",bw), fill=2:4)
</code></pre>


</div>