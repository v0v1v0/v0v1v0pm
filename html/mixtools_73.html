<div class="container">

<table style="width: 100%;"><tr>
<td>plotly_FDR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot False Discovery Rate (FDR) estimates from output by EM-like strategies using <code>plotly</code>
</h2>

<h3>Description</h3>

<p>This is an updated version of <code>plotFDR</code>. For more technical details, please refer to <code>plotFDR</code>.</p>


<h3>Usage</h3>

<pre><code class="language-R">plotly_FDR(post1, post2=NULL, lg1="FDR 1", lg2=NULL, 
          compH0=1, alpha=0.1, complete.data =NULL, pctfdr=0.3,
          col = NULL, width = 3 ,
          title = NULL , title.size = 15 , title.x = 0.5 , title.y = 0.95,
          xlab = "Index" , xlab.size = 15 , xtick.size = 15,
          ylab = "Probability" , ylab.size = 15 , ytick.size = 15,
          legend.text = "" , legend.text.size = 15 , legend.size = 15)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>post1</code></td>
<td>
<p>The matrix of posterior probabilities from objects such as the output
from <code>spEMsymlocN01</code>. The rows need to be sorted by increasing pvalues.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>post2</code></td>
<td>
<p>A second object like <code>post1</code> if comparison is desired, also sorted by increasing pvalues.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lg1</code></td>
<td>
<p>Text describing the FDR estimate in <code>post1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lg2</code></td>
<td>
<p>Text describing the FDR estimate in <code>post2</code> if provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compH0</code></td>
<td>
<p>The component indicator associated to the null hypothesis H0,
normally 1 since it is defined in this way in <code>spEMsymlocN01</code>, but in case of label switching in other algorithms it can be set to <code>2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The target FDR level; the index at which the FDR estimate crosses the horizontal line for level <code>alpha</code> gives the maximum number of cases to reject.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>complete.data</code></td>
<td>
<p>An array with <code class="reqn">n</code> lines and 2 columns, with the component indicator in column 1 and the p-values in column 2, sorted by p-values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pctfdr</code></td>
<td>
<p>The level up to which the FDR is plotted, i.e. 
the scale of the vertical axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>Color of traces.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>Width of traces.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>Text of the main title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title.size</code></td>
<td>
<p>Size of the main title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title.x</code></td>
<td>
<p>Horsizontal position of the main title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title.y</code></td>
<td>
<p>Vertical posotion of the main title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>Label of X-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab.size</code></td>
<td>
<p>Size of the lable of X-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xtick.size</code></td>
<td>
<p>Size of tick lables of X-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>Label of Y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab.size</code></td>
<td>
<p>Size of the lable of Y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ytick.size</code></td>
<td>
<p>Size of tick lables of Y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.text</code></td>
<td>
<p>Title of legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.text.size</code></td>
<td>
<p>Size of the legend title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.size</code></td>
<td>
<p>Size of legend.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A plot of one or two FDR estimates, with the true FDR if available</p>


<h3>Author(s)</h3>

<p>Didier Chauveau</p>


<h3>References</h3>


<ul><li>
<p> Chauveau, D., Saby, N., Orton, T. G., Lemercier B., Walter, C. and Arrouys, D.
Large-scale simultaneous hypothesis testing in monitoring carbon content 
from French soil database â€“ A semi-parametric mixture approach, Geoderma 219-220 (2014), 117-124.
</p>
</li></ul>
<h3>See Also</h3>

<p><code>spEMsymlocN01</code>, <code>plotFDR</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Probit transform of p-values
## from a Beta-Uniform mixture model
## comparion of parametric and semiparametric EM fit
## Note: in actual situations n=thousands
set.seed(50)
n=300 # nb of multiple tests
m=2 # 2 mixture components
a=c(1,0.1); b=c(1,1); lambda=c(0.6,0.4) # parameters
z=sample(1:m, n, rep=TRUE, prob = lambda)
p &lt;- rbeta(n, shape1 = a[z], shape2 = b[z]) # p-values
o &lt;- order(p)
cpd &lt;- cbind(z,p)[o,] # sorted complete data, z=1 if H0, 2 if H1
p &lt;- cpd[,2] # sorted p-values
y &lt;- qnorm(p) # probit transform of the pvalues
# gaussian EM fit with component 1 constrained to N(0,1)
s1 &lt;- normalmixEM(y, mu=c(0,-4),
                  mean.constr = c(0,NA), sd.constr = c(1,NA))
s2 &lt;- spEMsymlocN01(y, mu0 = c(0,-3)) # spEM with N(0,1) fit
plotly_FDR(s1$post, s2$post, lg1 = "normalmixEM", lg2 = "spEMsymlocN01",
           complete.data = cpd) # with true FDR computed from z
</code></pre>


</div>