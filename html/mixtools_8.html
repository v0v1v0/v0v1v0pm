<div class="container">

<table style="width: 100%;"><tr>
<td>density.spEM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Normal kernel density estimate for semiparametric EM output</h2>

<h3>Description</h3>

<p>Takes an object of class <code>spEM</code> and returns an object of class
<code>density</code> giving the kernel density estimate.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'spEM'
density(x, u=NULL, component=1, block=1, scale=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class <code>npEM</code> such as the output
of the <code>npEM</code> or <code>spEMsymloc</code> functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>Vector of points at which the density is to be evaluated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>component</code></td>
<td>
<p>Mixture component number; should be an integer from 1 to the
number of columns of <code>x$posteriors</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>block</code></td>
<td>
<p>Block of repeated measures.  Only applicable in repeated measures
case, for which <code>x$blockid</code> exists; should be an integer from 1 to
<code>max(x$blockid)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>Logical:  If TRUE, multiply the density values by the 
corresponding mixing proportions found in <code>x$lambdahat</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments; not used by this method.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The bandwidth is taken to be the same as that used to produce the <code>npEM</code>
object, which is given by <code>x$bandwidth</code>.
</p>


<h3>Value</h3>

<p><code>density.spEM</code> returns a list of type <code>"density"</code>.  See 
<code>density</code> for details.  In particular, the output of 
<code>density.spEM</code> may be used directly by functions such as 
<code>plot</code> or <code>lines</code>.
</p>


<h3>See Also</h3>

 
<p><code>spEM</code>, <code>spEMsymloc</code>, <code>plot.spEM</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> 
set.seed(100)
mu &lt;- matrix(c(0, 15), 2, 3)
sigma &lt;- matrix(c(1, 5), 2, 3)
x &lt;- rmvnormmix(300, lambda = c(.4,.6), mu = mu, sigma = sigma)

d &lt;- spEM(x, mu0 = 2, blockid = rep(1,3), constbw = TRUE) 
plot(d, xlim=c(-10, 40), ylim = c(0, .16), xlab = "", breaks = 30, 
     cex.lab=1.5, cex.axis=1.5) # plot.spEM calls density.spEM here
</code></pre>


</div>