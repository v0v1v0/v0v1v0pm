<div class="container">

<table style="width: 100%;"><tr>
<td>plotly_spEMN01</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot mixture pdf for the semiparametric mixture model output by <code>spEMsymlocN01</code> using <code>plotly</code>.</h2>

<h3>Description</h3>

<p>This is an updated version of <code>plotlspEMN01</code> function by using <code>plotly</code>. For technical details, please refer to <code>plot.spEMN01</code>.</p>


<h3>Usage</h3>

<pre><code class="language-R">plotly_spEMN01(x, bw=x$bandwidth, knownpdf=dnorm, add.plot=FALSE,
               width = 3 , col.dens = NULL, col.hist =  '#1f77b4',
               title = NULL , title.size = 15 , 
               title.x = 0.5 , title.y = 0.95,
               xlab = "t" , xlab.size = 15 , xtick.size = 15,
               ylab = "Density" , ylab.size = 15 , ytick.size = 15,
               legend.text = "Densities" , legend.text.size = 15 , 
               legend.size = 15)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class "spEMN01" as returned by spEMsymlocN01</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p>Bandwidth for weighted kernel density estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knownpdf</code></td>
<td>
<p>The known density of component 1, default to <code>dnorm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.plot</code></td>
<td>
<p>Set to TRUE to add to an existing plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>Line width.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.dens</code></td>
<td>
<p>Color of density lines. Number of colors specified needs to be consistent with number of components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.hist</code></td>
<td>
<p>Color of histogram.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>Text of the main title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title.size</code></td>
<td>
<p>Size of the main title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title.x</code></td>
<td>
<p>Horsizontal position of the main title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title.y</code></td>
<td>
<p>Vertical posotion of the main title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>Label of X-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab.size</code></td>
<td>
<p>Size of the lable of X-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xtick.size</code></td>
<td>
<p>Size of tick lables of X-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>Label of Y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab.size</code></td>
<td>
<p>Size of the lable of Y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ytick.size</code></td>
<td>
<p>Size of tick lables of Y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.text</code></td>
<td>
<p>Title of legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.text.size</code></td>
<td>
<p>Size of the legend title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.size</code></td>
<td>
<p>Size of legend.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A plot of the density of the mixture</p>


<h3>Author(s)</h3>

<p>Didier Chauveau</p>


<h3>References</h3>


<ul><li>
<p> Chauveau, D., Saby, N., Orton, T. G., Lemercier B., Walter, C. and Arrouys, D.
Large-scale simultaneous hypothesis testing in soil monitoring:
A semi-parametric mixture approach, preprint (2013).
</p>
</li></ul>
<h3>See Also</h3>

<p><code>spEMsymlocN01</code>, <code>plot.spEMN01</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Probit transform of p-values
## from a Beta-Uniform mixture model
## comparion of parametric and semiparametric EM fit
## Note: in actual situations n=thousands
set.seed(50)
n=300 # nb of multiple tests
m=2 # 2 mixture components
a=c(1,0.1); b=c(1,1); lambda=c(0.6,0.4) # parameters
z=sample(1:m, n, rep=TRUE, prob = lambda)
p &lt;- rbeta(n, shape1 = a[z], shape2 = b[z]) # p-values
o &lt;- order(p)
cpd &lt;- cbind(z,p)[o,] # sorted complete data, z=1 if H0, 2 if H1
p &lt;- cpd[,2] # sorted p-values
y &lt;- qnorm(p) # probit transform of the pvalues
# gaussian EM fit with component 1 constrained to N(0,1)
s1 &lt;- normalmixEM(y, mu=c(0,-4),
                  mean.constr = c(0,NA), sd.constr = c(1,NA))
s2 &lt;- spEMsymlocN01(y, mu0 = c(0,-3)) # spEM with N(0,1) fit
plotly_spEMN01(s2 , add.plot = FALSE)


</code></pre>


</div>