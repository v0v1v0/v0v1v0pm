<div class="container">

<table style="width: 100%;"><tr>
<td>regcr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Add a Confidence Region or Bayesian Credible Region for Regression Lines to a Scatterplot</h2>

<h3>Description</h3>

<p>Produce a confidence or credible region for regression lines based on
a sample of bootstrap beta values or posterior beta values.
The beta parameters are the intercept and slope
from a simple linear regression.
</p>


<h3>Usage</h3>

<pre><code class="language-R">regcr(beta, x, em.beta = NULL, em.sigma = NULL, alpha = .05, 
      nonparametric = FALSE, plot = FALSE, xyaxes = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>An nx2 matrix of regression parameters.  The first column
gives the intercepts and the second column gives the slopes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An n-vector of the predictor variable which is necessary when
nonparametric = TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>em.beta</code></td>
<td>
<p>The estimates for beta required when obtaining confidence
regions. This is required for performing the standardization necessary when
obtaining nonparametric confidence regions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>em.sigma</code></td>
<td>
<p>The estimates for the regression standard deviation required when obtaining confidence
regions. This is required for performing the standardization necessary when
obtaining nonparametric confidence regions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The proportion of the beta sample to remove. In other
words, 1-alpha is the level of the credible region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nonparametric</code></td>
<td>

<p>If nonparametric = TRUE, then the region is based on the convex
hull of the remaining beta after trimming, which is accomplished
using a data depth technique.
If nonparametric = FALSE, then the region is based on the
asymptotic normal approximation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>If plot = TRUE, lines are added to the existing plot.
The type of plot created depends on the value of xyaxes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xyaxes</code></td>
<td>
<p>If xyaxes = TRUE and plot = TRUE, then a confidence or credible region
for the regression lines is plotted on the x-y axes, presumably
overlaid on a scatterplot of the data.  If xyaxes = FALSE and
plot = TRUE, the (convex) credible region for the regression line is
plotted on the beta, or intercept-slope, axes, presumably overlaid
on a scatterplot of beta.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Graphical parameters passed to <code>lines</code> or <code>plot</code>
command.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>regcr</code> returns a list containing the following items:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>boundary</code></td>
<td>
<p>A matrix of points in beta, or intercept-slope, space
arrayed along the boundary of the confidence or credible region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>A matrix of points in x-y space arrayed along the upper
confidence or credible limit for the regression line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>A matrix of points in x-y space arrayed along the lower
confidence or credible limit for the regression line.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>regmixEM</code>, <code>regmixMH</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Nonparametric credible regions fit to NOdata. 

data(NOdata)
attach(NOdata)
set.seed(100)
beta &lt;- matrix(c(1.3, -0.1, 0.6, 0.1), 2, 2)
sigma &lt;- c(.02, .05)
MH.out &lt;- regmixMH(Equivalence, NO, beta = beta, s = sigma, 
                   sampsize = 2500, omega = .0013)
attach(data.frame(MH.out$theta))
beta.c1 &lt;- cbind(beta0.1[2400:2499], beta1.1[2400:2499])
beta.c2 &lt;- cbind(beta0.2[2400:2499], beta1.2[2400:2499])
plot(NO, Equivalence)
regcr(beta.c1, x = NO, nonparametric = TRUE, plot = TRUE, 
      col = 2)
regcr(beta.c2, x = NO, nonparametric = TRUE, plot = TRUE, 
      col = 3)

</code></pre>


</div>