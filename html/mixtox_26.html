<div class="container">

<table style="width: 100%;"><tr>
<td>tuneFit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find Optimal Starting values for Curve Fitting</h2>

<h3>Description</h3>

<p> Curve fitting is dependent on the package minpack.lm.
This generic function first seaches optimal starting values based on 
trial and error. The the concentration response data will be fitted using the optimal 
starting values. The statistics for goodness of fit
is evaluated by the following statistics: coefficient of
determination (<code class="reqn">R^2</code>), adjusted coefficient of determination (<code class="reqn">R_{adj}^2</code>),
root mean squared error (RMSE), mean absolute error (MAE), Akaike information criterion (AIC),
bias-corrected Akaike information criterion(AICc), and Bayesian information criterion (BIC).
Thirteen sigmoidal models ("Hill", "Hill_two", "Hill_three", "Hill_four",
"Weibull", "Weibull_three", "Weibull_four", "Logit", "Logit_three", "Logit_four",
"BCW(Box-Cox-Weibull)", "BCL(Box-Cox-Logit)", "GL(Generalized Logit)") and four
J-shaped models ("Brain_Consens", "BCV", "Biphasic", "Hill_five")
are provided to fit the concentration-response data. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">tuneFit(conc, rspn, eq = 'Weibull', effv, rtype = 'quantal', rsq = 0.6, highBar = 5000, 
		bar = 1000, sav = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>conc</code></td>
<td>
<p>a numeric vector (matrix) of experimental concentrations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rspn</code></td>
<td>
<p>a numeric vector (matrix) of responses corresponding to conc, it should have the
same length (or rows and columns for matrix) as conc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eq</code></td>
<td>
<p>models for curve fitting: "Hill", "Hill_two", "Hill_three", "Hill_four",
"Weibull", "Weibull_three", "Weibull_four", "Logit", "Logit_three", "Logit_four",
"BCW", "BCL", "GL", "Brain_Consens", "BCV", "Biphasic", "Hill_five".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rtype</code></td>
<td>
<p>the response type of endpoint: 'continuous' or 'quantal' data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effv</code></td>
<td>
<p>numeric response to calculate effect concentration, scaled respones [0, 1].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rsq</code></td>
<td>
<p>r2 below which would be ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>highBar</code></td>
<td>
<p>if the number of starting values exceeds highBar, a random sample of 
starting values will be taken.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bar</code></td>
<td>
<p>the number of random samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sav</code></td>
<td>
<p>TRUE: save output to a default file; FALSE: output will not be saved; 
a custom file directory: save output to the custom file directory.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>tuneFit provides high frequency trial and error approach to find appropriate starting 
values for users. It will deploy those starting values one by one until 
finding the right one.<br>
Function tuneFit can also be used to fit the concentration response data for a batch of 
chemicals and calculate corresponding effect concentration.
</p>


<h3>Value</h3>

<table><tr style="vertical-align: top;">
<td><code>sta </code></td>
<td>
<p>goodness of fit statistics: (<code class="reqn">R^2</code>, <code class="reqn">R_{adj}^2</code>, MAE, RMSE, AIC,
AICc, and BIC)</p>
</td>
</tr></table>
<h3>Note</h3>

<p>tuneFit will load the file staval.rda which contains hundreds of starting values for each 
of the sigmoidal and hormetic models. However, 
those starting values are also limited. Users are encouraged to send their fitted 
coefficients to us to extent the coverage of staval.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## example 1
# Fit the non-monotonic concentration-response data
# we'll get a fit with r2 of 0.740
x &lt;- hormesis$OmimCl$x
expr &lt;- hormesis$OmimCl$y
y &lt;- rowMeans(expr)
tuneFit(x, y, eq = 'Biphasic')

## example 2
# Fit the non-monotonic concentration-response data
# use r2 (rsq) of 0.9, we'll get a fit with r2 of 0.989
# calcualte the effect concentration that causes 5% inhibition
x &lt;- hormesis$OmimCl$x
expr &lt;- hormesis$OmimCl$y
y &lt;- rowMeans(expr)
tuneFit(x, y, eq = 'Biphasic', effv = 0.05, rsq = 0.9)

## example 3
# Fit the concentration-response data of heavy metal Ni(2+) on MCF-7 cells.
# Calculate the concentration that causes 5% inhibition on the growth of MCF-7

x &lt;- cytotox$Ni$x
expr &lt;- cytotox$Ni$y
y &lt;- rowMeans(expr)
tuneFit(x, y, eq = 'Logit', effv = 0.05)

## example 4
# Fit the concentration-response data of Paromomycin Sulfate (PAR) on photobacteria.
# Calculate the concentrations that cause 50% inhibition on the growth of photobacteria 

x &lt;- antibiotox$PAR$x
expr &lt;- antibiotox$PAR$y
y &lt;- rowMeans(expr)
tuneFit(x, y, eq = 'Logit', effv = 0.5)
</code></pre>


</div>