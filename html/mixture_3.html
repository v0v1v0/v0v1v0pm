<div class="container">

<table style="width: 100%;"><tr>
<td>e_step</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Expectation Step</h2>

<h3>Description</h3>

<p>Calculates the expectation of class memberships, and imputes if missing values for a given dataset.</p>


<h3>Usage</h3>

<pre><code class="language-R">e_step(data, model_obj, start=0, nu = 1.0) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>A matrix or data frame such that rows correspond to observations and columns correspond to variables. Note that this function currently only works with multivariate data p &gt; 1. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p> Start values in this context are only used for imputation. Non-missing values have their expectation of class memberships calculated directly.
If <code>0</code> then the random soft function is used for initialization.
If <code>1</code> then the random hard function is used for initialization.
If <code>2</code> then the kmeans function is used for initialization. 
If <code>is.matrix</code> then matrix is used as an initialization matrix as along as it has non-negative elements. Note: only models with the same number of columns of this matrix will be fit.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model_obj</code></td>
<td>

<p>A gpcm_best, vgpcm_best, stpcm_best, ghpcm_best, and salpcm_best object class.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>

<p>deterministic annealing for the class membership E-step. 
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This will only work on a dataset with the same dimension as estimated in the model. <code>e_step</code> will also work for missing values, provided that there is at least one non-missing entry. 
</p>


<h3>Value</h3>

<p>Returns a list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A matrix of the original dataset plus imputed values if applicable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>origX</code></td>
<td>
<p>A matrix of the original dataset including missing values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>map</code></td>
<td>
<p>A vector of integers indicating the maximum <em>a posteriori</em> classifications for the best model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>A matrix giving the raw values upon which <code>map</code> is based.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row_tags</code></td>
<td>
<p>If there were NAs in the original dataset, a vector of indices referencing the row of the imputed vectors is given.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Nik Pocuca, Ryan P. Browne and Paul D. McNicholas.
</p>
<p>Maintainer: Paul D. McNicholas &lt;mcnicholas@math.mcmaster.ca&gt;
</p>


<h3>References</h3>

<p>Browne, R.P. and McNicholas, P.D. (2014). Estimating common principal components in high dimensions. <em>Advances in Data Analysis and Classification</em> <b>8</b>(2), 217-226.
</p>
<p>Zhou, H. and Lange, K. (2010). On the bumpy road to the dominant mode. <em>Scandinavian Journal of Statistics</em> <b>37</b>, 612-631. 
</p>
<p>Celeux, G., Govaert, G. (1995). Gaussian parsimonious clustering models. <em>Pattern Recognition</em> <b>28</b>(5), 781-793.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# load dataset and perform model search. 

data(x2)
data_in &lt;- matrix(x2,ncol = 2)
mm &lt;- mixture::gpcm(data = data_in,G = 1:7,
           start = 0,
           veo = FALSE,pprogress=FALSE)

# get best model 
best = get_best_model(mm)
best 

# lets try imputing some missing data. 
x2NA &lt;- x2
x2NA[5,1] &lt;- NA
x2NA[140,2] &lt;- NA
x2NA[99,1] &lt;- NA

# calculate expectation
expect &lt;- e_step(data=x2NA,start = 0,nu = 1.0,model_obj = best)

# plot imputed entries and compare with original 
plot(x2,col = "grey")
points(expect$X[expect$row_tags+1,],col = "blue", pch = 20,cex = 2) # blue are imputed values.
points(x2[expect$row_tags+1,], col = "red" , pch = 20,cex = 2) # red are original values.
legend(-2,2,legend = c("imputed","original"),col = c("blue","red"),pch = 20)

## End(Not run)
</code></pre>


</div>