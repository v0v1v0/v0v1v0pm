<div class="container">

<table style="width: 100%;"><tr>
<td>contexts.covlmc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Contexts of a VLMC with covariates</h2>

<h3>Description</h3>

<p>This function returns the different contexts present in a VLMC with
covariates, possibly with some associated data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'covlmc'
contexts(
  ct,
  sequence = FALSE,
  reverse = FALSE,
  frequency = NULL,
  positions = FALSE,
  local = FALSE,
  metrics = FALSE,
  model = NULL,
  hsize = FALSE,
  merging = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ct</code></td>
<td>
<p>a fitted covlmc model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sequence</code></td>
<td>
<p>if <code>TRUE</code> the function returns its results as a <code>data.frame</code>,
if <code>FALSE</code> (default) as a list of <code>ctx_node</code> objects. (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reverse</code></td>
<td>
<p>logical (defaults to <code>FALSE</code>). See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frequency</code></td>
<td>
<p>specifies the counts to be included in the result
data.frame. The default value of <code>NULL</code> does not include anything.
<code>"total"</code> gives the number of occurrences of each context in the original
sequence. <code>"detailed"</code> includes in addition the break down of these
occurrences into all the possible states.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>positions</code></td>
<td>
<p>logical (defaults to FALSE). Specify whether the positions
of each context in the time series used to build the context tree should be
reported in a <code>positions</code> column of the result data frame. The availability
of the positions depends on the way the context tree was built. See details
for the definition of a position.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>local</code></td>
<td>
<p>specifies how the counts reported by <code>frequency</code> are computed.
When <code>local</code> is <code>FALSE</code> (default value) the counts include both counts that
are specific to the context (if any) and counts from the descendants of the
context in the tree. When <code>local</code> is <code>TRUE</code> the counts include only the
number of times the context appears without being the last part of a longer
context.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metrics</code></td>
<td>
<p>if TRUE, adds predictive metrics for each context (see
<code>metrics()</code> for the definition of predictive metrics).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>specifies whether to include the model associated to a each
context. The default result with <code>model=NULL</code> does not include any model.
Setting <code>model</code> to <code>"coef"</code> adds the coefficients of the models in a <code>coef</code>
column, while <code>"full"</code> include the models themselves (as R objects) in a
<code>model</code> column.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hsize</code></td>
<td>
<p>if TRUE, adds a <code>hsize</code> column to the result data frame that
gives for each context the size of the history of covariates used by the
model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>merging</code></td>
<td>
<p>if TRUE, adds a <code>merged</code> column to the result data frame. For
a normal context, the value of <code>merged</code> is FALSE. Contexts that share the
same model have a TRUE <code>merged</code> value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments for the contexts function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The default behaviour of the function is to return a list of all the
contexts using <code>ctx_node_covlmc</code> objects (as returned by
<code>find_sequence.covlmc()</code>). The properties of the contexts can then be
explored using adapted functions such as <code>counts()</code>, <code>covariate_memory()</code>,
<code>cutoff.ctx_node()</code>, <code>metrics.ctx_node()</code>, <code>model()</code>, <code>merged_with()</code> and
<code>positions()</code>.
</p>
<p>When <code>sequence=TRUE</code> the method returns a data.frame whose first column,
named <code>context</code>, contains the contexts as vectors (i.e. the value returned
by <code>as_sequence()</code> applied to a <code>ctx_node</code> object). Other columns contain
context specific values specified by the additional parameters. Setting any
of those parameters to a value that ask for reporting information will
toggle the result type of the function to <code>data.frame</code>.
</p>
<p>See <code>contexts.ctx_tree()</code> for details about the <code>frequency</code> parameter. When
<code>model</code> is non <code>NULL</code>, the resulting <code>data.frame</code> contains the models
associated to each context (either the full R model or its coefficients).
Other columns are added is the corresponding parameters are set to <code>TRUE</code>.
</p>


<h3>Value</h3>

<p>A list of class <code>contexts</code> containing the contexts represented in
this tree (as <code>ctx_node_covlmc</code>) or a data.frame.
</p>


<h3>Positions</h3>

<p>A position of a context <code>ctx</code> in the time series <code>x</code> is
an index value <code>t</code> such that the context ends with <code>x[t]</code>. Thus <code>x[t+1]</code> is
after the context. For instance if <code>x=c(0, 0, 1, 1)</code> and <code>ctx=c(0, 1)</code> (in
standard state order), then the position of <code>ctx</code> in <code>x</code> is 3.
</p>


<h3>State order in a context</h3>

<p>Notice that contexts are given by default
in the temporal order and not in the "reverse" order used by many VLMC
research papers: older values are on the left. For instance, the context
<code>c(1, 0)</code> is reported if the sequence 0, then 1 appeared in the time series
used to build the context tree. Set reverse to <code>TRUE</code> for the reverse
convention which is somewhat easier to relate to the way the context trees
are represented by <code>draw()</code> (i.e. recent values at the top the tree).
</p>


<h3>See Also</h3>

<p><code>find_sequence()</code> and <code>find_sequence.covlmc()</code> for direct access to
a specific context, and <code>contexts.ctx_tree()</code>, <code>contexts.vlmc()</code> and
<code>contexts.covlmc()</code> for concrete implementations of <code>contexts()</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">pc &lt;- powerconsumption[powerconsumption$week == 5, ]
breaks &lt;- c(0, median(pc$active_power), max(pc$active_power))
dts &lt;- cut(pc$active_power, breaks = breaks)
dts_cov &lt;- data.frame(day_night = (pc$hour &gt;= 7 &amp; pc$hour &lt;= 17))
m_cov &lt;- covlmc(dts, dts_cov, min_size = 5)
## direct representation with ctx_node_covlmc objects
m_cov_ctxs &lt;- contexts(m_cov)
m_cov_ctxs
sapply(m_cov_ctxs, covariate_memory)
sapply(m_cov_ctxs, is_merged)
sapply(m_cov_ctxs, model)
## data.frame interface
contexts(m_cov, model = "coef")
contexts(m_cov, model = "full", hsize = TRUE)
</code></pre>


</div>