<div class="container">

<table style="width: 100%;"><tr>
<td>tune_vlmc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit an optimal Variable Length Markov Chain (VLMC)</h2>

<h3>Description</h3>

<p>This function fits a Variable Length Markov Chain (VLMC) to a discrete time
series by optimizing an information criterion (BIC or AIC).
</p>


<h3>Usage</h3>

<pre><code class="language-R">tune_vlmc(
  x,
  criterion = c("BIC", "AIC"),
  initial = c("truncated", "specific", "extended"),
  alpha_init = NULL,
  cutoff_init = NULL,
  min_size = 2L,
  max_depth = 100L,
  backend = getOption("mixvlmc.backend", "R"),
  verbose = 0,
  save = c("best", "initial", "all")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a discrete time series; can be numeric, character, factor and
logical.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>criterion used to select the best model. Either <code>"BIC"</code>
(default) or <code>"AIC"</code> (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial</code></td>
<td>
<p>specifies the likelihood function, more precisely the way the
first few observations for which contexts cannot be calculated are
integrated in the likelihood. Default to <code>"truncated"</code>. See
<code>loglikelihood()</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_init</code></td>
<td>
<p>if non <code>NULL</code> used as the initial cut off parameter (in
quantile scale) to build the initial VLMC</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff_init</code></td>
<td>
<p>if non <code>NULL</code> used as the initial cut off parameter to
build the initial VLMC. Takes precedence over <code>alpha_init</code> if specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_size</code></td>
<td>
<p>integer &gt;= 1 (default: 2). Minimum number of observations for
a context in the growing phase of the initial context tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_depth</code></td>
<td>
<p>integer &gt;= 1 (default: 100). Longest context considered in
growing phase of the initial context tree (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>backend</code></td>
<td>
<p>backend "R" or "C++" (default: as specified by the
"mixvlmc.backend" option). Specifies the implementation used to represent
the context tree and to built it. See <code>vlmc()</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>integer &gt;= 0 (default: 0). Verbosity level of the pruning
process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save</code></td>
<td>
<p>specify which BIC models are saved during the pruning process.
The default value <code>"best"</code> asks the function to keep only the best model
according to the <code>criterion</code>. When <code>save="initial"</code> the function keeps <em>in
addition</em> the initial (complex) model which is then pruned during the
selection process. When <code>save="all"</code>, the function returns all the models
considered during the selection process.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function automates the process of fitting a large VLMC to a discrete
time series with <code>vlmc()</code> and of pruning the tree (with <code>cutoff()</code> and
<code>prune()</code>) to get an optimal with respect to an information criterion. To
avoid missing long term dependencies, the function uses the <code>max_depth</code>
parameter as an initial guess but then relies on an automatic increase of the
value to make sure the initial context tree is only limited by the <code>min_size</code>
parameter. The initial value of the <code>cutoff</code> parameter of <code>vlmc()</code> is also
set to conservative values (depending on the criterion) to avoid prior
simplification of the context tree. This default value can be overridden
using the <code>cutoff_init</code> or <code>alpha_init</code> parameter.
</p>
<p>Once the initial VLMC is obtained, the <code>cutoff()</code> and <code>prune()</code> functions are
used to build all the VLMC models that could be generated using larger values
of the initial cut off parameter. The best model is selected from this
collection, including the initial complex tree, as the one that minimizes the
chosen information criterion.
</p>


<h3>Value</h3>

<p>a list with the following components:
</p>

<ul>
<li> <p><code>best_model</code>: the optimal VLMC
</p>
</li>
<li> <p><code>criterion</code>: the criterion used to select the optimal VLMC
</p>
</li>
<li> <p><code>initial</code>: the likelihood function used to select the optimal VLMC
</p>
</li>
<li> <p><code>results</code>: a data frame with details about the pruning process
</p>
</li>
<li> <p><code>saved_models</code>: a list of intermediate VLMCs if <code>save="initial"</code> or
<code>save="all"</code>. It contains an <code>initial</code> component with the large VLMC
obtained first and an <code>all</code> component with a list of all the <em>other</em> VLMC
obtained by pruning the initial one.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>vlmc()</code>, <code>cutoff()</code> and <code>prune()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">dts &lt;- sample(as.factor(c("A", "B", "C")), 100, replace = TRUE)
tune_result &lt;- tune_vlmc(dts)
draw(tune_result$best_model)
</code></pre>


</div>