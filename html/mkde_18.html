<div class="container">

<table style="width: 100%;"><tr>
<td>mkde3Dgrid</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Movement-based kernel density estimate (MKDE) in 3D using Rcpp
</h2>

<h3>Description</h3>

<p>Provides a function for 3-dimensional MKDEs.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mkde3Dgrid(mkde.obj, move.dat, t.step, d.thresh)	
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mkde.obj</code></td>
<td>
<p>A 3D MKDE object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>move.dat</code></td>
<td>
<p>A move data object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t.step</code></td>
<td>
<p>An integration time step</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d.thresh</code></td>
<td>
<p>A kernel density threshold</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is  lower-level function that call the C++ function. for
estimating the movement-based density in 3D.  In practice, users
should call <code>initializeDensity</code>. <br>
The argument <code>d.thresh</code> is a univariate probability density beyond which
the kernel contribution to the overall MKDE is assumed to be
negligible. Usually this is set at a very small value and is used to
prevent calculations from being performed in cells to which the kernel
makes a negligible contribution.
</p>


<h3>Value</h3>

<p>An array whose elements are the estimated utilization probabilities
for each voxel.
</p>


<h3>Author(s)</h3>

<p>Jeff A. Tracey, PhD <br>
USGS Western Ecological Research Center, San Diego Field Station <br><a href="mailto:jatracey@usgs.gov">jatracey@usgs.gov</a>  <br>
James Sheppard, PhD <br>
San Diego Zoo Institute for Conservation Research <br><a href="mailto:jsheppard@sandiegozoo.org">jsheppard@sandiegozoo.org</a> <br>
Robert Sinkovits, PhD <br>
San Diego Supercomputer Center <br><a href="mailto:sinkovit@sdsc.edu">sinkovit@sdsc.edu</a> <br>
Glenn Lockwood, PhD <br>
San Diego Supercomputer Center <br><a href="mailto:glock@sdsc.edu">glock@sdsc.edu</a> <br>
Jun Zhu, PhD <br>
University of Wisconsin-Madison <br><a href="mailto:jzhu@stat.wisc.edu">jzhu@stat.wisc.edu</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(condor)

# Find min/max coordinates and add buffer
xmax = max(condor$x) + 1000
xmin = min(condor$x) - 1000
ymax = max(condor$y) + 1000
ymin = min(condor$y) - 1000

# Calculate grid dimensions
xrange &lt;- xmax - xmin
yrange &lt;- ymax - ymin
cell.sz = 600
nx &lt;- as.integer(xrange/cell.sz)
ny &lt;- as.integer(yrange/cell.sz)
nz &lt;- ceiling(3000.0/cell.sz)

mv.dat &lt;- initializeMovementData(condor$time, condor$x, condor$y, z.obs=condor$z, t.max=185.0,
sig2obs=25.0, sig2obs.z=81.0)
if (all(is.na(mv.dat$sig2xy))) {
  mv.dat &lt;- estVarMKDE(mv.dat)
}

mkde.obj &lt;- initializeMKDE3D(xmin, cell.sz, nx, ymin, cell.sz, ny, 0.0, cell.sz, nz)
res &lt;- mkde3Dgrid(mkde.obj, mv.dat, 5.0, 1e-20)
</code></pre>


</div>