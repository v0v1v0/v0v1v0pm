<div class="container">

<table style="width: 100%;"><tr>
<td>multistart</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Perform a hierarchical model fit with multiple starting values</h2>

<h3>Description</h3>

<p>The purpose of this method is to check if a certain algorithm for fitting
nonlinear hierarchical models (also known as nonlinear mixed-effects models)
will reliably yield results that are sufficiently similar to each other, if
started with a certain range of reasonable starting parameters. It is
inspired by the article on practical identifiabiliy in the frame of nonlinear
mixed-effects models by Duchesne et al (2021).
</p>


<h3>Usage</h3>

<pre><code class="language-R">multistart(
  object,
  n = 50,
  cores = if (Sys.info()["sysname"] == "Windows") 1 else parallel::detectCores(),
  cluster = NULL,
  ...
)

## S3 method for class 'saem.mmkin'
multistart(object, n = 50, cores = 1, cluster = NULL, ...)

## S3 method for class 'multistart'
print(x, ...)

best(object, ...)

## Default S3 method:
best(object, ...)

which.best(object, ...)

## Default S3 method:
which.best(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>The fit object to work with</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>How many different combinations of starting parameters should be
used?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cores</code></td>
<td>
<p>How many fits should be run in parallel (only on posix platforms)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>A cluster as returned by parallel::makeCluster to be used
for parallel execution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Passed to the update function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The multistart object to print</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of saem.mmkin objects, with class attributes
'multistart.saem.mmkin' and 'multistart'.
</p>
<p>The object with the highest likelihood
</p>
<p>The index of the object with the highest likelihood
</p>


<h3>References</h3>

<p>Duchesne R, Guillemin A, Gandrillon O, Crauste F. Practical
identifiability in the frame of nonlinear mixed effects models: the example
of the in vitro erythropoiesis. BMC Bioinformatics. 2021 Oct 4;22(1):478.
doi: 10.1186/s12859-021-04373-4.
</p>


<h3>See Also</h3>

<p>parplot, llhist
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(mkin)
dmta_ds &lt;- lapply(1:7, function(i) {
  ds_i &lt;- dimethenamid_2018$ds[[i]]$data
  ds_i[ds_i$name == "DMTAP", "name"] &lt;-  "DMTA"
  ds_i$time &lt;- ds_i$time * dimethenamid_2018$f_time_norm[i]
  ds_i
})
names(dmta_ds) &lt;- sapply(dimethenamid_2018$ds, function(ds) ds$title)
dmta_ds[["Elliot"]] &lt;- rbind(dmta_ds[["Elliot 1"]], dmta_ds[["Elliot 2"]])
dmta_ds[["Elliot 1"]] &lt;- dmta_ds[["Elliot 2"]] &lt;- NULL

f_mmkin &lt;- mmkin("DFOP", dmta_ds, error_model = "tc", cores = 7, quiet = TRUE)
f_saem_full &lt;- saem(f_mmkin)
f_saem_full_multi &lt;- multistart(f_saem_full, n = 16, cores = 16)
parplot(f_saem_full_multi, lpos = "topleft")
illparms(f_saem_full)

f_saem_reduced &lt;- update(f_saem_full, no_random_effect = "log_k2")
illparms(f_saem_reduced)
# On Windows, we need to create a PSOCK cluster first and refer to it
# in the call to multistart()
library(parallel)
cl &lt;- makePSOCKcluster(12)
f_saem_reduced_multi &lt;- multistart(f_saem_reduced, n = 16, cluster = cl)
parplot(f_saem_reduced_multi, lpos = "topright", ylim = c(0.5, 2))
stopCluster(cl)

## End(Not run)
</code></pre>


</div>