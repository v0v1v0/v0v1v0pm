<div class="container">

<table style="width: 100%;"><tr>
<td>expected.varcov</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Expected Fisher Information</h2>

<h3>Description</h3>

<p><code>expected.varcov</code> calculates the inverse of the expected Fisher information. Analytical second-order partial log-density derivatives and numerical integration are used in the calculations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">expected.varcov(density, logdensity, n, parms, mle, lower = "-Inf",
  upper = "Inf", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>density</code></td>
<td>
<p>An expression with the probability density function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logdensity</code></td>
<td>
<p>An expression with the log of the probability density function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>A numeric scalar with the sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parms</code></td>
<td>
<p>A character vector with the parameter name(s) specified in the density and logdensity expressions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mle</code></td>
<td>
<p>A numeric vector with the parameter estimate(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>The lower integration limit (lower = “-Inf” is the default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>The upper integration limit (upper = “Inf” is the default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to <code>integrate</code> function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The second-order partial log-density derivatives and its expected values are calculated via <code>D</code> and <code>integrate</code> functions, respectively.
</p>


<h3>Value</h3>

<p><code>expected.varcov</code> returns a list with two components (i) <b>mle</b>: the inputted maximum likelihood estimate(s) and (ii) <b>varcov</b>: the expected variance-covariance evaluated at the inputted mle argument.
</p>
<p>If the numerical integration fails and/or the expected information is singular an error message is returned.
</p>


<h3>Author(s)</h3>

<p>Josmar Mazucheli <a href="mailto:jmazucheli@gmail.com">jmazucheli@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code>deriv</code>, <code>D</code>, <code>integrate</code>, <code>expected.varcov</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">{library(mle.tools); library(fitdistrplus); set.seed(1)};

## Normal distribution
pdf &lt;- quote(1 / (sqrt(2 * pi) * sigma) * exp(-0.5 / sigma ^ 2 * (x - mu) ^ 2))
lpdf &lt;- quote(-log(sigma) - 0.5 / sigma ^ 2 * (x - mu) ^ 2)

x &lt;- rnorm(n = 100, mean = 0.0, sd = 1.0)

expected.varcov(density = pdf, logdensity = lpdf, n = length(x), parms = c("mu", "sigma"),
 mle = c(mean(x), sd(x)), lower = '-Inf', upper = 'Inf')

################################################################################

## Weibull distribution
pdf &lt;- quote(shape / scale ^ shape * x ^ (shape - 1) * exp(-(x / scale) ^ shape))
lpdf &lt;- quote(log(shape) - shape * log(scale) + shape * log(x) -
 (x / scale) ^ shape)

x &lt;- rweibull(n = 100, shape = 1.5, scale = 2.0)

fit &lt;- fitdist(data = x, distr = 'weibull')
fit$vcov

expected.varcov(density = pdf, logdensity = lpdf, n = length(x), parms = c("shape", "scale"),
 mle = fit$estimate, lower = 0)

################################################################################

## Expoentiated Weibull distribution
pdf &lt;- quote(alpha * shape / scale ^ shape * x ^ (shape - 1) * exp(-(x / scale) ^ shape) *
 (1 - exp(-(x / scale) ^ shape)) ^ (alpha - 1))
lpdf &lt;- quote(log(alpha) + log(shape) - shape * log(scale) + shape * log(x) -
 (x / scale) ^ shape + (alpha - 1) * log((1 - exp(-(x / scale) ^ shape))))

expected.varcov(density = pdf, logdensity = lpdf, n = 100, parms = c("shape", "scale", "alpha"),
 mle = c(1.5, 2.0, 1.0), lower = 0)
################################################################################

## Exponetial distribution
pdf &lt;- quote(rate * exp(-rate * x))
lpdf &lt;- quote(log(rate) - rate * x)

x &lt;- rexp(n = 100, rate = 0.5)

fit &lt;- fitdist(data = x, distr = 'exp')
fit$vcov

expected.varcov(density = pdf, logdensity = lpdf, n = length(x), parms = c("rate"),
 mle = fit$estimate, lower = 0)

################################################################################

## Gamma distribution
pdf &lt;- quote(1 /(scale ^ shape * gamma(shape)) * x ^ (shape - 1) * exp(-x / scale))
lpdf &lt;- quote(-shape * log(scale) - lgamma(shape) + shape * log(x) -
 x / scale)

x &lt;- rgamma(n = 100, shape = 1.5, scale = 2.0)

fit &lt;- fitdist(data = x, distr = 'gamma', start = list(shape = 1.5, scale =  2.0))
fit$vcov

expected.varcov(density = pdf, logdensity = lpdf, n = length(x), parms = c("shape", "scale"),
 mle = fit$estimate, lower = 0)

################################################################################

## Beta distribution
pdf &lt;- quote(gamma(shape1 + shape2) / (gamma(shape1) * gamma(shape2)) * x ^ (shape1 - 1) *
(1 - x) ^ (shape2 - 1))
lpdf &lt;- quote(lgamma(shape1 + shape2) - lgamma(shape1) - lgamma(shape2) +
 shape1 * log(x) + shape2 * log(1 - x))

x &lt;- rbeta(n = 100, shape1 = 2.0, shape2 = 2.0)

fit &lt;- fitdist(data = x, distr = 'beta', start = list(shape1 = 2.0, shape2 =  2.0))
fit$vcov

expected.varcov(density = pdf, logdensity = lpdf, n = length(x), parms = c("shape1", "shape2"),
 mle = fit$estimate, lower = 0, upper = 1)

</code></pre>


</div>