<div class="container">

<table style="width: 100%;"><tr>
<td>observed.varcov</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Observed Fisher Information</h2>

<h3>Description</h3>

<p><code>observed.varcov</code> calculates the inverse of the observed Fisher Information. Analytical second-order partial log-density derivatives are used in the calculations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">observed.varcov(logdensity, X, parms, mle)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>logdensity</code></td>
<td>
<p>An expression with the log of the probability density function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A numeric vector with the observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parms</code></td>
<td>
<p>A character vector with the parameter name(s) specified in the logdensity expression.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mle</code></td>
<td>
<p>A numeric vector with the parameter estimate(s).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The second-order partial log-density derivatives are calculated via <code>D</code> function.
</p>


<h3>Value</h3>

<p><code>observed.varcov</code> returns a list with two components (i) <b>mle</b>: the inputted maximum likelihood estimate(s) and (ii) <b>varcov</b>: the observed variance-covariance evaluated at the inputted mle argument.
</p>
<p>If the observed information is singular an error message is returned.
</p>


<h3>Author(s)</h3>

<p>Josmar Mazucheli <a href="mailto:jmazucheli@gmail.com">jmazucheli@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code>deriv</code>, <code>D</code>, <code>expected.varcov</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">{library(mle.tools); library(fitdistrplus); set.seed(1)};

##Normal distribution
lpdf &lt;- quote(-log(sigma) - 0.5 / sigma ^ 2 * (x - mu) ^ 2)

x &lt;- rnorm(n = 100, mean = 0.0, sd = 1.0)

observed.varcov(logdensity = lpdf, X = x, parms = c("mu", "sigma"),
 mle = c(mean(x), sd(x)))

################################################################################

## Weibull distribution
lpdf &lt;- quote(log(shape) - shape * log(scale) + shape * log(x) - (x / scale) ^ shape)

x &lt;- rweibull(n = 100, shape = 1.5, scale = 2.0)

fit &lt;- fitdist(data = x, distr = 'weibull')
fit$vcov

observed.varcov(logdensity = lpdf, X = x, parms = c("shape", "scale"), mle = fit$estimate)

################################################################################

## Exponetial distribution
lpdf &lt;- quote(log(rate) - rate * x)

x &lt;- rexp(n = 100, rate = 0.5)

fit &lt;- fitdist(data = x, distr = 'exp')
fit$vcov

observed.varcov(logdensity = lpdf, X = x, parms = c("rate"), mle = fit$estimate)

################################################################################

## Gamma distribution
lpdf &lt;- quote(-shape * log(scale) - lgamma(shape) + shape * log(x) -
 x / scale)

x &lt;- rgamma(n = 100, shape = 1.5, scale = 2.0)

fit &lt;- fitdist(data = x, distr = 'gamma', start = list(shape = 1.5, scale =  2.0))
fit$vcov

observed.varcov(logdensity = lpdf, X = x, parms = c("shape", "scale"), mle = fit$estimate)

################################################################################

## Beta distribution
lpdf &lt;- quote(lgamma(shape1 + shape2) - lgamma(shape1) - lgamma(shape2) +
  shape1 * log(x) + shape2 * log(1 - x))

x &lt;- rbeta(n = 100, shape1 = 2.0, shape2 = 2.0)

fit &lt;- fitdist(data = x, distr = 'beta', start = list(shape1 = 2.0, shape2 =  2.0))
fit$vcov

observed.varcov(logdensity = lpdf, X = x, parms = c("shape1", "shape2"), mle = fit$estimate)

</code></pre>


</div>