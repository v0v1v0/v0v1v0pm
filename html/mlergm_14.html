<div class="container">

<table style="width: 100%;"><tr>
<td>simulate_mlnet</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate a multilevel network</h2>

<h3>Description</h3>

<p>Function simulates a multilevel network by specifying a network size, node block memberships, and within-block and between-block models. The function currently only suppports block-models where between-block edges are dyad-independent.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simulate_mlnet(
  form,
  node_memb,
  theta,
  parameterization = "standard",
  seed = NULL,
  between_form = NULL,
  between_theta = NULL,
  between_prob = NULL,
  options = set_options()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>A <code>formula</code> object of the form <code>network ~ model terms</code> which specifies how the within-block subgraphs are modeled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>node_memb</code></td>
<td>
<p>Vector of node block memberships.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>A vector of model parameters (coefficients) for the ERGM governing the within-subgraph edges.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameterization</code></td>
<td>
<p>Parameterization options include 'standard', 'offset', or 'size'.
</p>

<ul>
<li>
<p> 'standard' : Does not adjust the individual block parameters for size.
</p>
</li>
<li>
<p> 'offset' : The offset parameterization uses edge and mutual offsets along the lines of Krivitsky, Handcock, and Morris (2011) and Krivitsky and Kolaczyk (2015). The edge parameter is offset by <code class="reqn">-log n(k)</code> and the mutual parameter is offset by <code class="reqn">+log n(k)</code>, where <code class="reqn">n(k)</code> is the size of the kth block.
</p>
</li>
<li>
<p> 'size' : Multiplies the block parameters by <code class="reqn">log n(k)</code>, where <code class="reqn">n(k)</code> is the size of the kth block.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Seed to be provided for reproducibility.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>between_form</code></td>
<td>
<p>A <code>formula</code> object of the form <code>~ model terms</code> which specifies how the within-block subgraphs are modeled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>between_theta</code></td>
<td>
<p>A vector of model parameters (coefficients) for the ERGM governing the between-subgraph edges.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>between_prob</code></td>
<td>
<p>A probability which specifies how edges between blocks are governerd. An ERGM (<code>between_form</code> and <code>between_theta</code>) cannot be specified together with <code>between_prob</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>options</code></td>
<td>
<p>Use <code>set_options</code> to change the simulation options. Note that some options are only valid for estimation using <code>mlergm</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Simulation of multilevel block networks is done with a Monte-Carlo Markov chain (MCMC) and can be done in parallel where <code>set_options</code> can be used to adjust the simulation settings (such as <code>burnin</code>, <code>interval</code>, and <code>sample_size</code>). Each within-block subgraph is given its own Markov chain, and so these settings are the settings to be used for each within-block chain.
</p>


<h3>Value</h3>

<p><code>simulate_mlnet</code> returns an objects of class <code>mlnet</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Create a K = 2 block network with edge + gwesp term 
net &lt;- simulate_mlnet(form = network.initialize(30, directed = FALSE) ~ edges + gwesp, 
                      node_memb = c(rep(1, 15), rep(2, 15)),
                      theta = c(-3, 0.5, 1.0), 
                      between_prob = 0.01,
                      options = set_options(number_cores = 2, burnin = 2000))

# Simulate a K = 2 block directed network, specifying a formula for between edges
net &lt;- simulate_mlnet(form = network.initialize(30, directed = TRUE) ~ edges + gwesp,
                      node_memb = c(rep(1, 15), rep(2, 15)),
                      theta = c(-3, 0.5, 1.0),
                      between_form = ~ edges + mutual, 
                      between_theta = c(-4, 2),
                      options = set_options(number_cores = 2, burnin = 2000))

</code></pre>


</div>