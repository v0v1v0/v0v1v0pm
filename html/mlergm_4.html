<div class="container">

<table style="width: 100%;"><tr>
<td>is.inCHv3.9</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Determine whether a vector is in the closure of the convex hull of some
sample of vectors</h2>

<h3>Description</h3>

<p><code>is.inCH</code> returns <code>TRUE</code> if and only if <code>p</code> is contained in
the convex hull of the points given as the rows of <code>M</code>. If <code>p</code> is
a matrix, each row is tested individually, and <code>TRUE</code> is returned if
all rows are in the convex hull.
</p>


<h3>Usage</h3>

<pre><code class="language-R">is.inCHv3.9(p, M, verbose = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>A <code class="reqn">d</code>-dimensional vector or a matrix with <code class="reqn">d</code> columns</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>An <code class="reqn">r</code> by <code class="reqn">d</code> matrix.  Each row of <code>M</code> is a
<code class="reqn">d</code>-dimensional vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A logical vector indicating whether to print progress</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed directly to linear program solver</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code class="reqn">d</code>-vector <code>p</code> is in the convex hull of the <code class="reqn">d</code>-vectors
forming the rows of <code>M</code> if and only if there exists no separating
hyperplane between <code>p</code> and the rows of <code>M</code>.  This condition may be
reworded as follows:
</p>
<p>Letting <code class="reqn">q=(1 p')'</code> and <code class="reqn">L = (1 M)</code>, if the maximum value of
<code class="reqn">z'q</code> for all <code class="reqn">z</code> such that <code class="reqn">z'L \le 0</code> equals zero (the maximum
must be at least zero since z=0 gives zero), then there is no separating
hyperplane and so <code>p</code> is contained in the convex hull of the rows of
<code>M</code>.  So the question of interest becomes a constrained optimization
problem.
</p>
<p>Solving this problem relies on the package <code>lpSolve</code> to solve a linear
program.  We may put the program in "standard form" by writing <code class="reqn">z=a-b</code>,
where <code class="reqn">a</code> and <code class="reqn">b</code> are nonnegative vectors.  If we write <code class="reqn">x=(a'
b')'</code>, we obtain the linear program given by:
</p>
<p>Minimize <code class="reqn">(-q' q')x</code> subject to <code class="reqn">x'(L -L) \le 0</code> and <code class="reqn">x \ge 0</code>.
One additional constraint arises because whenever any strictly negative
value of <code class="reqn">(-q' q')x</code> may be achieved, doubling <code class="reqn">x</code> arbitrarily many
times makes this value arbitrarily large in the negative direction, so no
minimizer exists.  Therefore, we add the constraint <code class="reqn">(q' -q')x \le 1</code>.
</p>
<p>This function is used in the "stepping" algorithm of Hummel et al (2012).
</p>


<h3>Value</h3>

<p>Logical, telling whether <code>p</code> is (or all rows of <code>p</code> are)
in the closed convex hull of the points in <code>M</code>.
</p>


<h3>References</h3>

 
<ul><li>
<p> Hummel, R. M., Hunter, D. R., and Handcock, M. S. (2012), Improving
Simulation-Based Algorithms for Fitting ERGMs, Journal of Computational and
Graphical Statistics, 21: 920-939. </p>
</li></ul>
</div>