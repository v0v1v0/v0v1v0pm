<div class="container">

<table style="width: 100%;"><tr>
<td>flatten_ml_fit_problem</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Return a flattened representation of a multi-level fitting problem instance</h2>

<h3>Description</h3>

<p>This function transforms a multi-level fitting problem to a representation
more suitable for applying the algorithms:  A matrix with one row per controlled
attribute and one column per household, a weight vector with one weight
per household, and a control vector.
</p>


<h3>Usage</h3>

<pre><code class="language-R">flatten_ml_fit_problem(
  ml_problem,
  model_matrix_type = c("combined", "separate"),
  verbose = FALSE
)

as_flat_ml_fit_problem(x, model_matrix_type = c("combined", "separate"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ml_problem</code></td>
<td>
<p>A fitting problem created by
<code>ml_problem()</code> or returned by <code>flatten_ml_fit_problem()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model_matrix_type</code></td>
<td>
<p>Which model matrix building strategy to use? See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If <code>TRUE</code>, print diagnostic output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further parameters passed to the algorithm</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The standard way to build a model matrix (<code>model_matrix = "combined"</code>)
is to include intercepts and avoid repeating redundant attributes.
A simpler model matrix specification, available via <code>model_matrix = "separate"</code>,
is suggested by Ye et al. (2009) and required for the <code>ml_fit_ipu()</code> implementation:
Here, simply one column per target value is used, which
results in a larger model matrix if more than one control is given.
</p>


<h3>Value</h3>

<p>An object of classes <code>flat_ml_fit_problem</code>,
essentially a named list.
</p>


<h3>See Also</h3>

<p><code>ml_fit()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">path &lt;- toy_example("Tiny")
flat_problem &lt;- flatten_ml_fit_problem(ml_problem = readRDS(path))
flat_problem

fit &lt;- ml_fit_dss(flat_problem)
fit$flat_weights
fit$weights
</code></pre>


</div>