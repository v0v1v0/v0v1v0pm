<div class="container">

<table style="width: 100%;"><tr>
<td>mlmc.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multi-level Monte Carlo estimation test suite</h2>

<h3>Description</h3>

<p>Computes a suite of diagnostic values for an MLMC estimation problem.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mlmc.test(
  mlmc_l,
  N,
  L,
  N0,
  eps.v,
  Lmin,
  Lmax,
  parallel = NA,
  silent = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mlmc_l</code></td>
<td>
<p>a user supplied function which provides the estimate for level <code class="reqn">l</code>.
It must take at least two arguments, the first is the level number to be simulated and the second the number of paths.
Additional arguments can be taken if desired: all additional <code>...</code> arguments to this function are forwarded to the user defined <code>mlmc_l</code> function.
</p>
<p>The user supplied function should return a named list containing one element named <code>sums</code> and second named <code>cost</code>, where:
</p>

<dl>
<dt><code>sums</code></dt>
<dd>
<p>is a vector of length six <code class="reqn">\left(\sum Y_i, \sum Y_i^2, \sum Y_i^3, \sum Y_i^4, \sum X_i, \sum X_i^2\right)</code> where <code class="reqn">Y_i</code> are iid simulations with expectation <code class="reqn">E[P_0]</code> when <code class="reqn">l=0</code> and expectation <code class="reqn">E[P_l-P_{l-1}]</code> when <code class="reqn">l&gt;0</code>, and <code class="reqn">X_i</code> are iid simulations with expectation <code class="reqn">E[P_l]</code>.
Note that this differs from the main <code>mlmc()</code> driver, which only requires the first two of these elements in order to calculate the estimate.
The remaining elements are required by <code>mlmc.test()</code> since they are used for convergence tests, kurtosis, and telescoping sum checks.</p>
</dd>
<dt><code>cost</code></dt>
<dd>
<p>is a scalar with the total cost of the paths simulated.
For example, in the financial options samplers included in this package, this is calculated as <code class="reqn">NM^l</code>, where <code class="reqn">N</code> is the number of paths requested in the call to the user function <code>mlmc_l</code>, <code class="reqn">M</code> is the refinement cost factor (<code class="reqn">M=2</code> for <code>mcqmc06_l()</code> and <code class="reqn">M=4</code> for <code>opre_l()</code>), and <code class="reqn">l</code> is the level being sampled.</p>
</dd>
</dl>
<p>See the function (and source code of) <code>opre_l()</code> and <code>mcqmc06_l()</code> in this package for an example of user supplied level samplers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>number of samples to use in the tests</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>number of levels to use in the tests</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N0</code></td>
<td>
<p>initial number of samples which are used for the first 3 levels and for any subsequent levels which are automatically added.
Must be <code class="reqn">&gt; 0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps.v</code></td>
<td>
<p>a vector of one or more target accuracies for the tests.
Must all be <code class="reqn">&gt; 0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lmin</code></td>
<td>
<p>the minimum level of refinement.
Must be <code class="reqn">\ge 2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lmax</code></td>
<td>
<p>the maximum level of refinement.
Must be <code class="reqn">\ge</code> <code>Lmin</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>if an integer is supplied, R will fork <code>parallel</code> parallel processes.
This is done for the convergence tests section by splitting the <code>N</code> samples as evenly as possible across cores when sampling each level.
This is also done for the MLMC complexity tests by passing the <code>parallel</code> argument on to the <code>mlmc()</code> driver when targeting each accuracy level in <code>eps</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>set to TRUE to supress running output (identical output can still be printed by printing the return result)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments which are passed on when the user supplied <code>mlmc_l</code> function is called</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See one of the example level sampler functions (e.g. <code>opre_l()</code>) for example usage.
</p>
<p>This function is based on GPL-2 'Matlab' code by Mike Giles.
</p>


<h3>Value</h3>

<p>An <code>mlmc.test</code> object which contains all the computed diagnostic values.
This object can be printed or plotted (see <code>plot.mlmc.test</code>).
</p>


<h3>Author(s)</h3>

<p>Louis Aslett &lt;louis.aslett@durham.ac.uk&gt;
</p>
<p>Mike Giles &lt;Mike.Giles@maths.ox.ac.uk&gt;
</p>
<p>Tigran Nagapetyan &lt;nagapetyan@stats.ox.ac.uk&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Example calls with realistic arguments
# Financial options using an Euler-Maruyama discretisation
tst &lt;- mlmc.test(opre_l, N = 2000000,
                 L = 5, N0 = 1000,
                 eps.v = c(0.005, 0.01, 0.02, 0.05, 0.1),
                 Lmin = 2, Lmax = 6,
                 option = 1)
tst
plot(tst)

# Financial options using a Milstein discretisation
tst &lt;- mlmc.test(mcqmc06_l, N = 20000,
                 L = 8, N0 = 200,
                 eps.v = c(0.005, 0.01, 0.02, 0.05, 0.1),
                 Lmin = 2, Lmax = 10,
                 option = 1)
tst
plot(tst)


# Toy versions for CRAN tests
tst &lt;- mlmc.test(opre_l, N = 10000,
                 L = 5, N0 = 1000,
                 eps.v = c(0.025, 0.1),
                 Lmin = 2, Lmax = 6,
                 option = 1)

tst &lt;- mlmc.test(mcqmc06_l, N = 10000,
                 L = 8, N0 = 1000,
                 eps.v = c(0.025, 0.1),
                 Lmin = 2, Lmax = 10,
                 option = 1)

</code></pre>


</div>