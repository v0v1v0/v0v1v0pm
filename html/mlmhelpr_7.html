<div class="container">

<table style="width: 100%;"><tr>
<td>ncv_tests</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Non-constant Variance Tests at Level-1 (experimental)</h2>

<h3>Description</h3>

<p>Computes three different Non-constant variance tests: the H test as discussed in Raudenbush and Bryk (2002, pp. 263-265) and Snijders and Bosker (2012, p. 159-160), an approximate Levene's test discussed by Hox et al. (2018, p. 238), and a variation of the Breusch-Pagan test.
</p>
<p>For the H test, the user must specify the level-1 formula. This test computes a standardized measure of dispersion for each level-2 group and detects heteroscedasticity in the form of between-group differences in the level-one residuals variances. The standardized measure of dispersion is based on estimated ordinary least squares residuals in each group.
</p>
<p>The Levene's test computes a oneway analysis of variance of the level-2 grouping variable on the squared residuals of the model. This test examines whether the variance of the residuals is the same in all groups.
</p>
<p>The Breusch-Pagan test regresses the squared residuals on the fitted model. A likelihood ratio test is used to compare this model with a with a null model that regresses the squared residuals on an empty model with the same random effects. This test examines whether the variance of the residuals depends on the predictor variables.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ncv_tests(model, formula = NULL, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a mixed model produced using the <code>lme4</code> package and the <code>lmer()</code> function. This is an object of class <code>merMod</code> and subclass <code>lmerMod</code>. Currently, only supports 2-level models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>level-1 formula to compute H test. Formula should be of the form <code class="reqn">y \sim x_1 + ... + x_n \; | \; g</code> where <code class="reqn">y</code> is the response, <code class="reqn">x_1 + ... + x_n</code> are the covariates, and <code class="reqn">g</code> is the grouping factor, see <code>lme4::lmList</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>return additional statistics including d-values and outliers from H test; adjusted R-squared, ANOVA results, and mean residual by cluster for Levene test; and likelihood ratio test for B-P test.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing results from the three non-constant variance tests.
</p>


<h3>References</h3>


<p>Hox JJ, Moerbeek M, van de Schoot R (2018).
<em>Multilevel Analysis: Techniques and Applications</em>.
Taylor and Francis.
ISBN 9781138121362.

</p>

<p>Raudenbush SW, Bryk AS (2002).
<em>Hierarchical Linear Models: Applications and Data Analysis Methods</em>.
SAGE.
ISBN 9780761919049.

</p>

<p>Singer JD, Willett JB (2003).
<em>Applied Longitudinal Data Analysis: Modeling Change and Event Occurrence</em>.
Oxford University Press.
ISBN 978-0-19-515296-8.

</p>


<h3>Examples</h3>

<pre><code class="language-R">
fit &lt;- lme4::lmer(mathach ~ 1 + ses + catholic + (1|id), data=hsb, REML=FALSE)

ncv_tests(fit)

# extract outliers from H test
test &lt;- ncv_tests(fit, formula = mathach ~ 1 + ses | id, verbose = TRUE)
test$H_test$outliers

</code></pre>


</div>