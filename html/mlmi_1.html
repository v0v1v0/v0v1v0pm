<div class="container">

<table style="width: 100%;"><tr>
<td>catImp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Imputation for categorical variables using log linear models</h2>

<h3>Description</h3>

<p>This function performs multiple imputation under a log-linear model
as described by Schafer (1997), using his <code>cat</code> package, either with
or without posterior draws.
</p>


<h3>Usage</h3>

<pre><code class="language-R">catImp(
  obsData,
  M = 10,
  pd = FALSE,
  type = 1,
  margins = NULL,
  steps = 100,
  rseed
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obsData</code></td>
<td>
<p>The data frame to be imputed. Variables must be coded such that
they take consecutive positive integer values, i.e. 1,2,3,...</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>Number of imputations to generate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pd</code></td>
<td>
<p>Specify whether to use posterior draws (<code>TRUE</code>)
or not (<code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>An integer specifying what type of log-linear model to impute using.
<code>type=1</code>, the default, allows for all two-way associations in the log-linear model.
<code>type=2</code> allows for all three-way associations (plus lower).
<code>type=3</code> fits a saturated model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margins</code></td>
<td>
<p>An optional argument that can be used instead of <code>type</code> to specify
the desired log-linear model. See the documentation for the <code>margins</code> argument
in <code>ecm.cat</code> and Schafer (1997) on how to specify this.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>steps</code></td>
<td>
<p>If <code>pd</code> is <code>TRUE</code>, the <code>steps</code> argument specifies
how many MCMC iterations to perform in order to generate the model parameter value for
each imputation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rseed</code></td>
<td>
<p>The value to set the <code>cat</code> package's random number seed to,
using the <code>rngseed</code> function of <code>cat</code>. This function must be called at least
once before imputing using <code>cat</code>. If the user wishes to set the seed using
<code>rngseed</code> before calling <code>catImp</code>, set <code>rseed=NULL</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>By default <code>catImp</code> will impute using a log-linear model allowing for all two-way
associations, but not higher order associations. This can be modified through
use of the <code>type</code> and <code>margins</code> arguments.
</p>
<p>With <code>pd=FALSE</code>, all imputed datasets are generated conditional on the MLE
of the model parameter, referred to as maximum likelihood multiple imputation
by von Hippel and Bartlett (2021).
</p>
<p>With <code>pd=TRUE</code>, regular 'proper' multiple imputation
is used, where each imputation is drawn from a distinct value of the model
parameter. Specifically, for each imputation, a single MCMC chain is run,
iterating for <code>steps</code> iterations.
</p>
<p>Imputed datasets can be analysed using <code>withinBetween</code>,
<code>scoreBased</code>, or for example the
<a href="https://cran.r-project.org/package=bootImpute">bootImpute</a> package.
</p>


<h3>Value</h3>

<p>A list of imputed datasets, or if <code>M=1</code>, just the imputed data frame.
</p>


<h3>References</h3>

<p>Schafer J.L. (1997). Analysis of incomplete multivariate data.
Chapman &amp; Hall, Boca Raton, Florida, USA.
</p>
<p>von Hippel P.T. and Bartlett J.W. Maximum likelihood multiple imputation: faster,
more efficient imputation without posterior draws. Statistical Science 2021; 36(3) 400-420 <a href="https://doi.org/10.1214/20-STS793">doi:10.1214/20-STS793</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#simulate a partially observed categorical dataset
set.seed(1234)
n &lt;- 100

#for simplicity we simulate completely independent variables
temp &lt;- data.frame(x1=ceiling(3*runif(n)), x2=ceiling(2*runif(n)), x3=ceiling(2*runif(n)))

#make some data missing
for (i in 1:3) {
  temp[(runif(n)&lt;0.25),i] &lt;- NA
}

#impute using catImp, assuming two-way associations in the log-linear model
imps &lt;- catImp(temp, M=10, pd=FALSE, rseed=4423)

#impute assuming a saturated log-linear model
imps &lt;- catImp(temp, M=10, pd=FALSE, type=3, rseed=4423)
</code></pre>


</div>