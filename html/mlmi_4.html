<div class="container">

<table style="width: 100%;"><tr>
<td>normImp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multivariate normal model imputation</h2>

<h3>Description</h3>

<p>This function performs multiple imputation under a multivariate normal model
as described by Schafer (1997), using his <code>norm</code> package, either with
or without posterior draws.
</p>


<h3>Usage</h3>

<pre><code class="language-R">normImp(obsData, M = 10, pd = FALSE, steps = 100, rseed)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obsData</code></td>
<td>
<p>The data frame to be imputed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>Number of imputations to generate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pd</code></td>
<td>
<p>Specify whether to use posterior draws (<code>TRUE</code>)
or not (<code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>steps</code></td>
<td>
<p>If <code>pd</code> is <code>TRUE</code>, the <code>steps</code> argument specifies
how many MCMC iterations to perform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rseed</code></td>
<td>
<p>The value to set the <code>norm</code> package's random number seed to,
using the <code>rngseed</code> function of <code>norm</code>. This function must be called at least
once before imputing using <code>norm</code>. If the user wishes to set the seed using
<code>rngseed</code> before calling <code>normImp</code>, set <code>rseed=NULL</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function imputes from a multivariate normal model with unstructured covariance
matrix, as described by Schafer (1997). With <code>pd=FALSE</code>, all imputed datasets
are generated conditional on the MLE of the model parameter, referred to as maximum
likelihood multiple imputation by von Hippel and Bartlett (2021).
</p>
<p>With <code>pd=TRUE</code>, regular 'proper' multiple imputation
is used, where each imputation is drawn from a distinct value of the model
parameter. Specifically, for each imputation, a single MCMC chain is run,
iterating for <code>steps</code> iterations.
</p>
<p>Imputed datasets can be analysed using <code>withinBetween</code>,
<code>scoreBased</code>, or for example the
<a href="https://cran.r-project.org/package=bootImpute">bootImpute</a> package.
</p>


<h3>Value</h3>

<p>A list of imputed datasets, or if <code>M=1</code>, just the imputed data frame.
</p>


<h3>References</h3>

<p>Schafer J.L. (1997). Analysis of incomplete multivariate data.
Chapman &amp; Hall, Boca Raton, Florida, USA.
</p>
<p>von Hippel P.T. and Bartlett J.W. Maximum likelihood multiple imputation: faster,
more efficient imputation without posterior draws. Statistical Science 2021; 36(3) 400-420 <a href="https://doi.org/10.1214/20-STS793">doi:10.1214/20-STS793</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#simulate a partially observed dataset from multivariate normal distribution
set.seed(1234)
n &lt;- 100
temp &lt;- MASS::mvrnorm(n=n,mu=rep(0,4),Sigma=diag(4))

#make some values missing
for (i in 1:4) {
  temp[(runif(n)&lt;0.25),i] &lt;- NA
}

#impute using normImp
imps &lt;- normImp(data.frame(temp), M=10, pd=FALSE, rseed=4423)
</code></pre>


</div>