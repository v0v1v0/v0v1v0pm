<div class="container">

<table style="width: 100%;"><tr>
<td>refBasedCts</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Reference based imputation of repeated measures continuous data</h2>

<h3>Description</h3>

<p>Performs multiple imputation of a repeatedly measured continuous endpoint in a
randomised clinical trial
using reference based imputation as proposed by <a href="https://doi.org/10.1080/10543406.2013.834911">doi:10.1080/10543406.2013.834911</a>Carpenter et al (2013). This approach
can be used for imputation of missing data in randomised clinical trials.
</p>


<h3>Usage</h3>

<pre><code class="language-R">refBasedCts(
  obsData,
  outcomeVarStem,
  nVisits,
  trtVar,
  baselineVars = NULL,
  baselineVisitInt = TRUE,
  type = "MAR",
  M = 5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obsData</code></td>
<td>
<p>The data frame to be imputed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outcomeVarStem</code></td>
<td>
<p>String for stem of outcome variable name, e.g. y if y1, y2, y3 are the outcome columns</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nVisits</code></td>
<td>
<p>The integer number of visits (not including baseline)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trtVar</code></td>
<td>
<p>The string variable name of the randomised treatment group variable. The reference arm is assumed
to correspond to <code>trtVar==0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>baselineVars</code></td>
<td>
<p>A string or vector of strings specfying the baseline variables. Often this will include
the baseline measurement of the outcome</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>baselineVisitInt</code></td>
<td>
<p>TRUE/FALSE indicating whether to allow for interactions between each baseline variable
and visit. Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A string specifying imputation type to use. Valid options are "MAR", "J2R"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>Number of imputations to generate.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Unlike most implementations of reference based imputation, this implementation
imputes conditional on the maximum likelihood estimates of the model parameters,
rather than a posterior draw. If one is interested in frequentist valid inferences,
this is ok provided the bootstrapping used, for example with using the
<a href="https://cran.r-project.org/package=bootImpute">bootImpute</a> package.
</p>
<p>Intermediate missing values are imputed assuming MAR, based on the mixed model fit
to that patient's treatment arm. Monotone missing values are imputed using the specified
imputation type.
</p>
<p>Baseline covariates must be numeric variables. If you have factor variables you must
code these into suitable dummy indicators and pass these to the function.
</p>


<h3>Value</h3>

<p>A list of imputed datasets, or if <code>M=1</code>, just the imputed data frame.
</p>


<h3>References</h3>

<p>Carpenter JR, Roger JH, Kenward MG. Analysis of Longitudinal Trials with Protocol Deviation:
A Framework for Relevant, Accessible Assumptions, and Inference via Multiple Imputation. (2013) 23(6) 1352-1371
</p>
<p>von Hippel PT &amp; Bartlett JW (2019) Maximum likelihood multiple imputation: Faster imputations and
consistent standard errors without posterior draws <a href="https://arxiv.org/abs/1210.0870v10">arXiv:1210.0870v10</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#take a look at ctsTrialWide data
head(ctsTrialWide)

#impute the missing outcome values twice assuming MAR
imps &lt;- refBasedCts(ctsTrialWide, outcomeVarStem="y", nVisits=3, trtVar="trt",
                    baselineVars=c("v", "y0"), type="MAR", M=2)

#now impute using jump to reference method
imps &lt;- refBasedCts(ctsTrialWide, outcomeVarStem="y", nVisits=3, trtVar="trt",
                    baselineVars=c("v", "y0"), type="J2R", M=2)

#for frequentist valid inferences we use bootstrapping from the bootImpute package
## Not run: 
  #bootstrap 10 times using 2 imputations per bootstrap. Note that to do this
  #we specify nImp=2 to bootImpute by M=1 to the refBasedCts function.
  #Also, 10 bootstraps is far too small to get reliable inferences. To do this
  #for real you would want to use a lot more (e.g. at least nBoot=1000).
  library(bootImpute)
  bootImps &lt;- bootImpute(ctsTrialWide, refBasedCts, nBoot=10, nImp=2,
                         outcomeVarStem="y", nVisits=3, trtVar="trt",
                         baselineVars=c("v", "y0"), type="J2R", M=1)

  #write a small wrapper function to perform an ANCOVA at the final time point
  ancova &lt;- function(inputData) {
    coef(lm(y3~v+y0+trt, data=inputData))
  }
  ests &lt;- bootImputeAnalyse(bootImps, ancova)
  ests

## End(Not run)
</code></pre>


</div>