<div class="container">

<table style="width: 100%;"><tr>
<td>withinBetween</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Within between variance estimation</h2>

<h3>Description</h3>

<p>This function implements the within-between variance estimation approach. If the imputations
were generated using posterior draws, it implements the approach proposed by Barnard &amp; Rubin (1999).
If posterior draws were not used, it implements the WB approach described by von Hippel and
Bartlett (2021).
</p>


<h3>Usage</h3>

<pre><code class="language-R">withinBetween(imps, analysisFun, pd = NULL, dfComplete = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>imps</code></td>
<td>
<p>A list of imputed datasets produced by one of the imputation functions
in <code>mlmi</code> or another package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>analysisFun</code></td>
<td>
<p>A function to analyse the imputed datasets that when applied to
a dataset returns a list containing a vector <code>est</code> and covariance matrix <code>var</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pd</code></td>
<td>
<p>If <code>imps</code> was not generated by one of the imputation functions in
<code>mlmi</code>, this argument must be specified to indicate whether the imputations
were generated using posterior draws (TRUE) or not (FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dfComplete</code></td>
<td>
<p>The complete data degrees of freedom. If <code>analysisFun</code> returns a vector
of parameter estimates, <code>dfComplete</code> should be a vector of the same length. If not
specified, it is assumed that the complete data degrees of freedom is effectively infinite (1e+05).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other parameters that are to be passed through to <code>analysisFun</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the overall parameter estimates, its corresponding covariance matrix, and
degrees of freedom for each parameter.
</p>


<h3>References</h3>

<p>Barnard J, Rubin DB. Miscellanea. Small-sample degrees of freedom with multiple imputation.
Biometrika 1999; 86(4): 948-955. <a href="https://doi.org/10.1093/biomet/86.4.948">doi:10.1093/biomet/86.4.948</a>
</p>
<p>von Hippel P.T. and Bartlett J.W. Maximum likelihood multiple imputation: faster,
more efficient imputation without posterior draws. Statistical Science 2021; 36(3) 400-420 <a href="https://doi.org/10.1214/20-STS793">doi:10.1214/20-STS793</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#simulate a partially observed dataset
set.seed(1234)
n &lt;- 100
x &lt;- rnorm(n)
y &lt;- x+rnorm(n)
y[1:50] &lt;- NA
temp &lt;- data.frame(x,y)

#impute using normImp
imps &lt;- normImp(temp, M=100, pd=TRUE, rseed=4423)

#define a function which analyses a dataset using our desired
#analysis model, returning the estimated parameters and their
#corresponding variance covariance matrix
analysisFun &lt;- function(inputData) {
  mod &lt;- lm(y~x, data=inputData)
  list(est=coef(mod), var=vcov(mod))
}
withinBetween(imps,analysisFun, dfComplete=c(n-2,n-2))
</code></pre>


</div>