<div class="container">

<table style="width: 100%;"><tr>
<td>run_entire_gwas_pipeline</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MLMM, model selection and effects estimation</h2>

<h3>Description</h3>

<p>Internaly run functions of the mlmm.gwas package:
</p>

<ul>
<li> <p><code>mlmm_allmodels</code> (GWAS)
</p>
</li>
<li> <p><code>frommlmm_toebic</code>
</p>
</li>
<li> <p><code>eBIC_allmodels</code> (model selection)
</p>
</li>
<li> <p><code>threshold_allmodels</code>
</p>
</li>
<li> <p><code>fromeBICtoEstimation</code>
</p>
</li>
<li> <p><code>Estimation_allmodels</code> (effects estimation)
</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">run_entire_gwas_pipeline(Y, XX, KK, nbchunks = 2, maxsteps = 20,
  cofs = NULL, female = NULL, male = NULL,threshold=NULL,lambda=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>A numeric named vector where the names are individuals' names and the values their phenotype. The names of Y will be matched to the row names of X.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>XX</code></td>
<td>
<p>A list of length one, two or three matrices depending on the model. Matrices are n by m matrix, where n=number of individuals, m=number of SNPs, with rownames(X)=individual names, and colnames(X)=SNP names.
</p>
<p>- additive: a single matrix
</p>
<p>- additive+dominance: two matrices
</p>
<p>- female+male: two matrices with the female one first
</p>
<p>- female+male+interaction: three matrices with the female first, the male then the interaction</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>KK</code></td>
<td>
<p>a list of one, two or three matrices depending on the models
</p>
<p>- additive: a n by n matrix, where n=number of individuals, with rownames()=colnames()=individual names
</p>
<p>- additive+dominance: two n by n matrices, where n=number of individuals, with rownames()=colnames()=individual names
</p>
<p>- female+male: a n.female by n.female matrix, with rownames()=colnames()=female names and a n.male by n.male matrix, with rownames()=colnames()=male names
</p>
<p>- female+male+interaction: the same two matrices as the model female+male and a n by n matrix, where n=number of individuals, with rownames()=colnames()=individual names</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbchunks</code></td>
<td>
<p>An integer defining the number of chunks of matrices to run the analysis, allows to decrease the memory usage. minimum=2, increase it if you do not have enough memory</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxsteps</code></td>
<td>
<p>An integer &gt;= 3. Maximum number of steps desired in the forward approach. The forward approach breaks automatically once the pseudo-heritability is close to 0, however to avoid doing too many steps in case the pseudo-heritability does not reach a value close to 0, this parameter is also used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cofs</code></td>
<td>
<p>A n by q matrix, where n=number of individuals, q=number of fixed effect, with rownames()=individual names and with column names, forbidden head of column names for this matrix "eff1_" and usage of special characters as "*","/","&amp;"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>female</code></td>
<td>
<p>A factor of levels female names and length n, only for the last two models</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>male</code></td>
<td>
<p>A factor of levels male names and length n, only for the last two models</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>a value to declare the significant p value. The default value is Bonferroni 0.05</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>penalty used in the computation of the eBIC; if NULL, the default will be 1 - 1/(2k) with L=n^k where L=total number of SNPs (see function "lambda.calc")</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A named list with 2 or 3 elements:
</p>

<ul>
<li>
<p> pval: the return value of <code>mlmm_allmodels</code>
</p>
</li>
<li>
<p> eBic: the return value of <code>eBIC_allmodels</code>
</p>
</li>
<li>
<p> threshold: the return value of <code>threshold_allmodels</code>
</p>
</li>
<li>
<p> effects: the return value of <code>Estimation_allmodels</code>, only if there is at least one marker in the model selected by lowest eBIC.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">data("mlmm.gwas.AD")
results &lt;- run_entire_gwas_pipeline(floweringDateAD, list(Xa), list(K.add))
</code></pre>


</div>