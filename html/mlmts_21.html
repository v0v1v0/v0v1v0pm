<div class="container">

<table style="width: 100%;"><tr>
<td>dis_ppca</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Constructs a pairwise distance matrix relying on a piecewise representation
based on PCA</h2>

<h3>Description</h3>

<p><code>dis_ppca</code> returns a pairwise distance matrix based on an extension of
the procedure proposed by Wan et al. (2022). The
function can also be used for dimensionality reduction purposes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dis_ppca(X, w = 2, var_rate = 0.9, features = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A list of MTS (numerical matrices).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>The number of segments (in the time dimension) in which we want to
divide the MTS (default is 2).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_rate</code></td>
<td>
<p>Rate of retained variability concerning the
dimensionality-reduced MTS samples (default is 0.90).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>features</code></td>
<td>
<p>Logical. If <code>features = FALSE</code> (default), a distance matrix is returned. Otherwise, the function
returns a dataset of feature vectors.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given a collection of MTS, the function returns the pairwise distance matrix,
where the distance between two MTS <code class="reqn">\boldsymbol X_T</code> and <code class="reqn">\boldsymbol Y_T</code> is defined
as </p>
<p style="text-align: center;"><code class="reqn">d_{PPCA}(\boldsymbol X_{T}, \boldsymbol Y_{T})=\Big|\Big|vec\big(\widehat{\boldsymbol \Sigma}_a ^{\boldsymbol X_T}\big)
-vec\big(\widehat{\boldsymbol \Sigma}_a^{\boldsymbol Y_T}\big)\Big|\Big|,</code>
</p>

<p>where <code class="reqn">\widehat{\boldsymbol \Sigma}_a ^{\boldsymbol X_T}</code> and <code class="reqn">\widehat{\boldsymbol \Sigma}_a ^{\boldsymbol Y_T}</code>
are estimates of the covariance matrices based on a piecewise representation for which the
original MTS <code class="reqn">\boldsymbol X_T</code> and <code class="reqn">\boldsymbol Y_T</code>, respectively,
are divided into a number of <code>w</code> local segments (in the time dimension).
If we use the function to perform dimensionality reduction (<code>features = TRUE</code>),
then for a given series <code class="reqn">\boldsymbol X_T</code>, matrix <code class="reqn">\widehat{\boldsymbol \Sigma}_a ^{\boldsymbol X_T}</code>
is decomposed by executing the standard PCA and a certain number of
principal components are retained (according to the parameter <code>var_rate</code>).
Function <code>dis_ppca</code> returns the reduced counterpart of <code class="reqn">\boldsymbol X_T</code>,
which is constructed from <code class="reqn">\boldsymbol X_T</code> by considering the
matrix of scores with respect to the retained principal components.
</p>


<h3>Value</h3>

<p>The computed pairwise distance matrix.
</p>


<h3>Author(s)</h3>

<p>Ángel López-Oriona, José A. Vilar
</p>


<h3>References</h3>


<p>Wan X, Li H, Zhang L, Wu YJ (2022).
“Dimensionality reduction for multivariate time-series data mining.”
<em>The Journal of Supercomputing</em>, <b>78</b>(7), 9862–9878.
</p>



<h3>Examples</h3>

<pre><code class="language-R">reduced_dataset &lt;- dis_ppca(RacketSports$data[1], features = TRUE) # Reducing
# the dimensionality of the first MTS in dataset RacketSports
reduced_dataset
distance_matrix &lt;- dis_ppca(RacketSports$data) # Computing the
# corresponding distance matrix for all MTS in dataset RacketSports
# (by default, features = F)
</code></pre>


</div>