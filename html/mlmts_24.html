<div class="container">

<table style="width: 100%;"><tr>
<td>dis_spectral</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Constructs a pairwise distance matrix based on estimated
spectral matrices</h2>

<h3>Description</h3>

<p><code>dis_spectral</code> returns a pairwise distance matrix based on the
dissimilarities introduced by Kakizawa et al. (1998).
</p>


<h3>Usage</h3>

<pre><code class="language-R">dis_spectral(X, method = "j_divergence", alpha = 0.5, features = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A list of MTS (numerical matrices).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Parameter indicating the method to be used for the computation
of the distance. If <code>method="j_divergence"</code> (default), the J divergence is
considered. If <code>method="chernoff_divergence"</code>, the Chernoff information divergence
is considered</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>If <code>method="chernoff_divergence"</code>, parameter alpha in (0,1) used for the computation of the
Chernoff divergence (default is 0.5).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>features</code></td>
<td>
<p>Logical. If <code>features = FALSE</code> (default), a distance matrix is returned. Otherwise, the function
returns a dataset of feature vectors.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given a collection of MTS, the function returns a pairwise distance matrix. If <code>method="j_divergence"</code>
then the distance between two MTS <code class="reqn">\boldsymbol X_T</code> and <code class="reqn">\boldsymbol Y_T</code> is defined as
</p>
<p style="text-align: center;"><code class="reqn">d_{JSPEC}(\boldsymbol X_T, \boldsymbol Y_T)=\frac{1}{2T}
\sum_{k=1}^{K}\bigg(tr\Big(\widehat{\boldsymbol f}_{\boldsymbol X_T}(\omega_k)
\widehat{\boldsymbol f}_{\boldsymbol Y_T}^{-1}(\omega_k)\Big)
+tr\Big(\widehat{\boldsymbol f}_{\boldsymbol Y_T}(\omega_k)
\widehat{\boldsymbol f}_{\boldsymbol X_T}^{-1}(\omega_k)\Big)-2d\bigg),</code>
</p>

<p>where <code class="reqn">\widehat{\boldsymbol f}_{\boldsymbol X_T}(\omega_k)</code> and
<code class="reqn">\widehat{\boldsymbol f}_{\boldsymbol Y_T}(\omega_k)</code> are the estimated
spectral density matrices from the series <code class="reqn">\boldsymbol X_T</code> and
<code class="reqn">\boldsymbol Y_T</code>, respectively, evaluated at frequency <code class="reqn">\omega_k</code>,
and <code class="reqn">tr(\cdot)</code> denotes the trace of a square matrix. If
<code>method="chernoff_divergence"</code>,  then the distance between two MTS
<code class="reqn">\boldsymbol X_T</code> and <code class="reqn">\boldsymbol Y_T</code> is defined as
</p>
<p style="text-align: center;"><code class="reqn">d_{CSPEC}(\boldsymbol X_T, \boldsymbol Y_T)=</code>
</p>

<p style="text-align: center;"><code class="reqn">\frac{1}{2T}
\sum_{k=1}^{K}\bigg(\log{\frac{\Big|\alpha\widehat{\boldsymbol f}^{\boldsymbol X_T}(\omega_k)
+(1-\alpha)\widehat{\boldsymbol f}^{\boldsymbol Y_T}(\omega_k)\Big |}
{\Big|\widehat{\boldsymbol f}^{\boldsymbol Y_T}(\omega_k)\Big|}}+ \log{\frac{\Big|\alpha\widehat{\boldsymbol f}^{\boldsymbol Y_T}(\omega_k) +
(1-\alpha)\widehat{\boldsymbol f}^{\boldsymbol X_T}(\omega_k)\Big |}
{\Big|\widehat{\boldsymbol f}^{\boldsymbol X_T}(\omega_k)\Big|}}\bigg),</code>
</p>

<p>where <code class="reqn">\alpha \in (0,1)</code>.
</p>


<h3>Value</h3>

<p>If <code>features = FALSE</code> (default), returns a distance matrix based on the distance
<code class="reqn">d_{JSPEC}</code> as long as we set <code>method="j_divergence"</code>, and based on the alternative distance <code class="reqn">d_{CSPEC}</code> as long as we set <code>method=</code>
<code>"chernoff_divergence"</code>.
Otherwise, if <code>features = TRUE</code>, the function returns a dataset of feature vectors, i.e., each row in the dataset
contains the features employed to compute either <code class="reqn">d_{JSPEC}</code> or <code class="reqn">d_{CSPEC}</code>. These vectors
are vectorized versions of the estimated spectral matrices.
</p>


<h3>Author(s)</h3>

<p>Ángel López-Oriona, José A. Vilar
</p>


<h3>References</h3>


<p>Kakizawa Y, Shumway RH, Taniguchi M (1998).
“Discrimination and clustering for multivariate time series.”
<em>Journal of the American Statistical Association</em>, <b>93</b>(441), 328–340.
</p>



<h3>Examples</h3>

<pre><code class="language-R">toy_dataset &lt;- Libras$data[1 : 10] # Selecting the first 10 MTS from the
# dataset Libras
distance_matrix_j &lt;- dis_spectral(toy_dataset) # Computing the pairwise
# distance matrix based on the distance dis_jspec
distance_matrix_c &lt;- dis_spectral(toy_dataset,
method = 'chernoff_divergence') # Computing the pairwise
# distance matrix based on the distance dis_cspec
feature_dataset &lt;- dis_qcd(toy_dataset, features = TRUE) # Computing
# the corresponding dataset of features for d_cpec
</code></pre>


</div>