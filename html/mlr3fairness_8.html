<div class="container">

<table style="width: 100%;"><tr>
<td>compute_metrics</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute metrics for non-mlr3 predictions.</h2>

<h3>Description</h3>

<p>Allows computing metrics for predictions that do not stem from mlr3, and were
e.g. being made by models outside of mlr3.
Currently only <code>classif</code> and <code>regr</code> - style predictions are supported.
</p>


<h3>Usage</h3>

<pre><code class="language-R">compute_metrics(data, target, protected_attribute, prediction, metrics = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>(<code>data.table</code>) <br> The dataset used for predicting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>(<code>character</code>) <br> The name of the target variable. Must be available in <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>protected_attribute</code></td>
<td>
<p>(<code>character</code>) <br> The name(s) of the protected attributes(s). Must be available in <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prediction</code></td>
<td>
<p>(<code>vector</code>) <br> A vector containing predictions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metrics</code></td>
<td>
<p>(<code>Metric</code>|<code>list</code>) <br> (List of) mlr3 metrics to apply.</p>
</td>
</tr>
</table>
<h3>Protected Attributes</h3>

<p>The protected attribute is specified as a <code>col_role</code> in the corresponding <code>Task()</code>:<br><code style="white-space: pre;">⁠&lt;Task&gt;$col_roles$pta = "name_of_attribute"⁠</code> <br>
This also allows specifying more than one protected attribute,
in which case fairness will be considered on the level of intersecting groups defined by all columns
selected as a predicted attribute.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library("mlr3")
# Get adult data as a data.table
train = tsk("adult_train")$data()
mod = rpart::rpart(target ~ ., train)

# Predict on test data
test = tsk("adult_test")$data()
yhat = predict(mod, test, type = "vector")

# Convert to a factor with the same levels
yhat = as.factor(yhat)
levels(yhat) = levels(test$target)

compute_metrics(
  data = test, 
  target = "target",
  prediction = yhat,
  protected_attribute = "sex",
  metrics = msr("fairness.acc")
)
</code></pre>


</div>