<div class="container">

<table style="width: 100%;"><tr>
<td>FSelectInstanceBatchSingleCrit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Class for Single Criterion Feature Selection</h2>

<h3>Description</h3>

<p>The FSelectInstanceBatchSingleCrit specifies a feature selection problem for a FSelector.
The function <code>fsi()</code> creates a FSelectInstanceBatchSingleCrit and the function <code>fselect()</code> creates an instance internally.
</p>
<p>The instance contains an ObjectiveFSelectBatch object that encodes the black box objective function a FSelector has to optimize.
The instance allows the basic operations of querying the objective at design points (<code style="white-space: pre;">⁠$eval_batch()⁠</code>).
This operation is usually done by the FSelector.
Evaluations of feature subsets are performed in batches by calling <code>mlr3::benchmark()</code> internally.
The evaluated feature subsets are stored in the Archive (<code style="white-space: pre;">⁠$archive⁠</code>).
Before a batch is evaluated, the bbotk::Terminator is queried for the remaining budget.
If the available budget is exhausted, an exception is raised, and no further evaluations can be performed from this point on.
The FSelector is also supposed to store its final result, consisting of a selected feature subset and associated estimated performance values, by calling the method <code>instance$assign_result()</code>.
</p>


<h3>Default Measures</h3>

<p>If no measure is passed, the default measure is used.
The default measure depends on the task type.</p>

<table>
<tr>
<td style="text-align: left;">
   Task </td>
<td style="text-align: left;"> Default Measure </td>
<td style="text-align: left;"> Package </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>"classif"</code> </td>
<td style="text-align: left;"> <code>"classif.ce"</code> </td>
<td style="text-align: left;"> <a href="https://CRAN.R-project.org/package=mlr3"><span class="pkg">mlr3</span></a> </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>"regr"</code> </td>
<td style="text-align: left;"> <code>"regr.mse"</code> </td>
<td style="text-align: left;"> <a href="https://CRAN.R-project.org/package=mlr3"><span class="pkg">mlr3</span></a> </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>"surv"</code> </td>
<td style="text-align: left;"> <code>"surv.cindex"</code> </td>
<td style="text-align: left;"> <a href="https://CRAN.R-project.org/package=mlr3proba"><span class="pkg">mlr3proba</span></a> </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>"dens"</code> </td>
<td style="text-align: left;"> <code>"dens.logloss"</code> </td>
<td style="text-align: left;"> <a href="https://CRAN.R-project.org/package=mlr3proba"><span class="pkg">mlr3proba</span></a> </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>"classif_st"</code> </td>
<td style="text-align: left;"> <code>"classif.ce"</code> </td>
<td style="text-align: left;"> <a href="https://CRAN.R-project.org/package=mlr3spatial"><span class="pkg">mlr3spatial</span></a> </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>"regr_st"</code> </td>
<td style="text-align: left;"> <code>"regr.mse"</code> </td>
<td style="text-align: left;"> <a href="https://CRAN.R-project.org/package=mlr3spatial"><span class="pkg">mlr3spatial</span></a> </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>"clust"</code> </td>
<td style="text-align: left;"> <code>"clust.dunn"</code> </td>
<td style="text-align: left;"> <a href="https://CRAN.R-project.org/package=mlr3cluster"><span class="pkg">mlr3cluster</span></a> </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>Resources</h3>

<p>There are several sections about feature selection in the <a href="https://mlr3book.mlr-org.com">mlr3book</a>.
</p>

<ul>
<li>
<p> Getting started with <a href="https://mlr3book.mlr-org.com/chapters/chapter6/feature_selection.html#sec-fs-wrapper">wrapper feature selection</a>.
</p>
</li>
<li>
<p> Do a <a href="https://mlr3book.mlr-org.com/chapters/chapter6/feature_selection.html#sec-fs-wrapper-example">sequential forward selection</a> Palmer Penguins data set.
</p>
</li>
</ul>
<p>The <a href="https://mlr-org.com/gallery.html">gallery</a> features a collection of case studies and demos about optimization.
</p>

<ul>
<li>
<p> Utilize the built-in feature importance of models with <a href="https://mlr-org.com/gallery/optimization/2023-02-07-recursive-feature-elimination/">Recursive Feature Elimination</a>.
</p>
</li>
<li>
<p> Run a feature selection with <a href="https://mlr-org.com/gallery/optimization/2023-02-01-shadow-variable-search/">Shadow Variable Search</a>.
</p>
</li>
<li> <p><a href="https://mlr-org.com/gallery/optimization/2020-09-14-mlr3fselect-basic/">Feature Selection</a> on the Titanic data set.
</p>
</li>
</ul>
<h3>Analysis</h3>

<p>For analyzing the feature selection results, it is recommended to pass the archive to <code>as.data.table()</code>.
The returned data table is joined with the benchmark result which adds the mlr3::ResampleResult for each feature set.
</p>
<p>The archive provides various getters (e.g. <code style="white-space: pre;">⁠$learners()⁠</code>) to ease the access.
All getters extract by position (<code>i</code>) or unique hash (<code>uhash</code>).
For a complete list of all getters see the methods section.
</p>
<p>The benchmark result (<code style="white-space: pre;">⁠$benchmark_result⁠</code>) allows to score the feature sets again on a different measure.
Alternatively, measures can be supplied to <code>as.data.table()</code>.
</p>


<h3>Super classes</h3>

<p><code>bbotk::OptimInstance</code> -&gt; <code>bbotk::OptimInstanceBatch</code> -&gt; <code>bbotk::OptimInstanceBatchSingleCrit</code> -&gt; <code>FSelectInstanceBatchSingleCrit</code>
</p>


<h3>Active bindings</h3>

<div class="r6-active-bindings">

<dl>
<dt><code>result_feature_set</code></dt>
<dd>
<p>(<code>character()</code>)<br>
Feature set for task subsetting.</p>
</dd>
</dl>
</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-FSelectInstanceBatchSingleCrit-new"><code>FSelectInstanceBatchSingleCrit$new()</code></a>
</p>
</li>
<li> <p><a href="#method-FSelectInstanceBatchSingleCrit-assign_result"><code>FSelectInstanceBatchSingleCrit$assign_result()</code></a>
</p>
</li>
<li> <p><a href="#method-FSelectInstanceBatchSingleCrit-print"><code>FSelectInstanceBatchSingleCrit$print()</code></a>
</p>
</li>
<li> <p><a href="#method-FSelectInstanceBatchSingleCrit-clone"><code>FSelectInstanceBatchSingleCrit$clone()</code></a>
</p>
</li>
</ul>
<details open><summary>Inherited methods</summary><ul>
<li><span class="pkg-link" data-pkg="bbotk" data-topic="OptimInstance" data-id="clear"><a href="../../bbotk/html/OptimInstance.html#method-OptimInstance-clear"><code>bbotk::OptimInstance$clear()</code></a></span></li>
<li><span class="pkg-link" data-pkg="bbotk" data-topic="OptimInstance" data-id="format"><a href="../../bbotk/html/OptimInstance.html#method-OptimInstance-format"><code>bbotk::OptimInstance$format()</code></a></span></li>
<li><span class="pkg-link" data-pkg="bbotk" data-topic="OptimInstanceBatch" data-id="eval_batch"><a href="../../bbotk/html/OptimInstanceBatch.html#method-OptimInstanceBatch-eval_batch"><code>bbotk::OptimInstanceBatch$eval_batch()</code></a></span></li>
<li><span class="pkg-link" data-pkg="bbotk" data-topic="OptimInstanceBatch" data-id="objective_function"><a href="../../bbotk/html/OptimInstanceBatch.html#method-OptimInstanceBatch-objective_function"><code>bbotk::OptimInstanceBatch$objective_function()</code></a></span></li>
</ul></details><hr>
<a id="method-FSelectInstanceBatchSingleCrit-new"></a>



<h4>Method <code>new()</code>
</h4>

<p>Creates a new instance of this R6 class.
</p>


<h5>Usage</h5>

<div class="r"><pre>FSelectInstanceBatchSingleCrit$new(
  task,
  learner,
  resampling,
  measure,
  terminator,
  store_benchmark_result = TRUE,
  store_models = FALSE,
  check_values = FALSE,
  callbacks = NULL,
  ties_method = "least_features"
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>task</code></dt>
<dd>
<p>(mlr3::Task)<br>
Task to operate on.</p>
</dd>
<dt><code>learner</code></dt>
<dd>
<p>(mlr3::Learner)<br>
Learner to optimize the feature subset for.</p>
</dd>
<dt><code>resampling</code></dt>
<dd>
<p>(mlr3::Resampling)<br>
Resampling that is used to evaluated the performance of the feature subsets.
Uninstantiated resamplings are instantiated during construction so that all feature subsets are evaluated on the same data splits.
Already instantiated resamplings are kept unchanged.</p>
</dd>
<dt><code>measure</code></dt>
<dd>
<p>(mlr3::Measure)<br>
Measure to optimize. If <code>NULL</code>, default measure is used.</p>
</dd>
<dt><code>terminator</code></dt>
<dd>
<p>(bbotk::Terminator)<br>
Stop criterion of the feature selection.</p>
</dd>
<dt><code>store_benchmark_result</code></dt>
<dd>
<p>(<code>logical(1)</code>)<br>
Store benchmark result in archive?</p>
</dd>
<dt><code>store_models</code></dt>
<dd>
<p>(<code>logical(1)</code>).
Store models in benchmark result?</p>
</dd>
<dt><code>check_values</code></dt>
<dd>
<p>(<code>logical(1)</code>)<br>
Check the parameters before the evaluation and the results for
validity?</p>
</dd>
<dt><code>callbacks</code></dt>
<dd>
<p>(list of CallbackBatchFSelect)<br>
List of callbacks.</p>
</dd>
<dt><code>ties_method</code></dt>
<dd>
<p>(<code>character(1)</code>)<br>
The method to break ties when selecting sets while optimizing and when selecting the best set.
Can be <code>"least_features"</code> or <code>"random"</code>.
The option <code>"least_features"</code> (default) selects the feature set with the least features.
If there are multiple best feature sets with the same number of features, one is selected randomly.
The <code>random</code> method returns a random feature set from the best feature sets.
Ignored if multiple measures are used.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-FSelectInstanceBatchSingleCrit-assign_result"></a>



<h4>Method <code>assign_result()</code>
</h4>

<p>The FSelector writes the best found feature subset and estimated performance value here.
For internal use.
</p>


<h5>Usage</h5>

<div class="r"><pre>FSelectInstanceBatchSingleCrit$assign_result(xdt, y)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>xdt</code></dt>
<dd>
<p>(<code>data.table::data.table()</code>)<br>
x values as <code>data.table</code>. Each row is one point. Contains the value in
the <em>search space</em> of the FSelectInstanceBatchMultiCrit object. Can contain
additional columns for extra information.</p>
</dd>
<dt><code>y</code></dt>
<dd>
<p>(<code>numeric(1)</code>)<br>
Optimal outcome.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-FSelectInstanceBatchSingleCrit-print"></a>



<h4>Method <code>print()</code>
</h4>

<p>Printer.
</p>


<h5>Usage</h5>

<div class="r"><pre>FSelectInstanceBatchSingleCrit$print(...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>...</code></dt>
<dd>
<p>(ignored).</p>
</dd>
</dl>
</div>


<hr>
<a id="method-FSelectInstanceBatchSingleCrit-clone"></a>



<h4>Method <code>clone()</code>
</h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>FSelectInstanceBatchSingleCrit$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt>
<dd>
<p>Whether to make a deep clone.</p>
</dd>
</dl>
</div>




<h3>Examples</h3>

<pre><code class="language-R"># Feature selection on Palmer Penguins data set


task = tsk("penguins")
learner = lrn("classif.rpart")

# Construct feature selection instance
instance = fsi(
  task = task,
  learner = learner,
  resampling = rsmp("cv", folds = 3),
  measures = msr("classif.ce"),
  terminator = trm("evals", n_evals = 4)
)

# Choose optimization algorithm
fselector = fs("random_search", batch_size = 2)

# Run feature selection
fselector$optimize(instance)

# Subset task to optimal feature set
task$select(instance$result_feature_set)

# Train the learner with optimal feature set on the full data set
learner$train(task)

# Inspect all evaluated sets
as.data.table(instance$archive)

</code></pre>


</div>