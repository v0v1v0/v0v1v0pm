<div class="container">

<table style="width: 100%;"><tr>
<td>mlr_pipeops_datefeatures</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Preprocess Date Features</h2>

<h3>Description</h3>

<p>Based on <code>POSIXct</code> columns of the data, a set of date related features is computed and added to
the feature set of the output task. If no <code>POSIXct</code> column is found, the original task is
returned unaltered. This functionality is based on the <code>add_datepart()</code> and
<code>add_cyclic_datepart()</code> functions from the <code>fastai</code> library. If operation on only particular
<code>POSIXct</code> columns is requested, use the <code>affect_columns</code> parameter inherited from
<code>PipeOpTaskPreprocSimple</code>.
</p>
<p>If <code>cyclic = TRUE</code>, cyclic features are computed for the features <code>"month"</code>, <code>"week_of_year"</code>,
<code>"day_of_year"</code>, <code>"day_of_month"</code>, <code>"day_of_week"</code>, <code>"hour"</code>, <code>"minute"</code> and <code>"second"</code>. This
means that for each feature <code>x</code>, two additional features are computed, namely the sine and cosine
transformation of <code>2 * pi * x / max_x</code> (here <code>max_x</code> is the largest possible value the feature
could take on <code>+ 1</code>, assuming the lowest possible value is given by 0, e.g., for hours from 0 to
23, this is 24). This is useful to respect the cyclical nature of features such as seconds, i.e.,
second 21 and second 22 are one second apart, but so are second 60 and second 1 of the next
minute.
</p>


<h3>Format</h3>

<p><code>R6Class</code> object inheriting from <code>PipeOpTaskPreprocSimple</code>/<code>PipeOpTaskPreproc</code>/<code>PipeOp</code>.
</p>


<h3>Construction</h3>

<div class="sourceCode"><pre>PipeOpDateFeatures$new(id = "datefeatures", param_vals = list())
</pre></div>

<ul>
<li> <p><code>id</code> :: <code>character(1)</code><br>
Identifier of resulting object, default <code>"datefeatures"</code>.
</p>
</li>
<li> <p><code>param_vals</code> :: named <code>list</code><br>
List of hyperparameter settings, overwriting the hyperparameter settings that would otherwise
be set during construction. Default <code>list()</code>.
</p>
</li>
</ul>
<h3>Input and Output Channels</h3>

<p>Input and output channels are inherited from <code>PipeOpTaskPreprocSimple</code>.
</p>
<p>The output is the input <code>Task</code> with date-related features computed and added to the
feature set of the output task and the <code>POSIXct</code> columns of the data removed from the
feature set (depending on the value of <code>keep_date_var</code>).
</p>


<h3>State</h3>

<p>The <code style="white-space: pre;">⁠$state⁠</code> is a named <code>list</code> with the <code style="white-space: pre;">⁠$state⁠</code> elements inherited from
<code>PipeOpTaskPreprocSimple</code>.
</p>


<h3>Parameters</h3>

<p>The parameters are the parameters inherited from <code>PipeOpTaskPreprocSimple</code>, as well as:
</p>

<ul>
<li> <p><code>keep_date_var</code> :: <code>logical(1)</code><br>
Should the <code>POSIXct</code> columns be kept as features? Default FALSE.
</p>
</li>
<li> <p><code>cyclic</code> :: <code>logical(1)</code><br>
Should cyclic features be computed? See Internals. Default FALSE.
</p>
</li>
<li> <p><code>year</code> :: <code>logical(1)</code><br>
Should the year be extracted as a feature? Default TRUE.
</p>
</li>
<li> <p><code>month</code> :: <code>logical(1)</code><br>
Should the month be extracted as a feature? Default TRUE.
</p>
</li>
<li> <p><code>week_of_year</code> :: <code>logical(1)</code><br>
Should the week of the year be extracted as a feature? Default TRUE.
</p>
</li>
<li> <p><code>day_of_year</code> :: <code>logical(1)</code><br>
Should the day of the year be extracted as a feature? Default TRUE.
</p>
</li>
<li> <p><code>day_of_month</code> :: <code>logical(1)</code><br>
Should the day of the month be extracted as a feature? Default TRUE.
</p>
</li>
<li> <p><code>day_of_week</code> :: <code>logical(1)</code><br>
Should the day of the week be extracted as a feature? Default TRUE.
</p>
</li>
<li> <p><code>hour</code> :: <code>logical(1)</code><br>
Should the hour be extracted as a feature? Default TRUE.
</p>
</li>
<li> <p><code>minute</code> :: <code>logical(1)</code><br>
Should the minute be extracted as a feature? Default TRUE.
</p>
</li>
<li> <p><code>second</code> :: <code>logical(1)</code><br>
Should the second be extracted as a feature? Default TRUE.
</p>
</li>
<li> <p><code>is_day</code> :: <code>logical(1)</code><br>
Should a feature be extracted indicating whether it is day time (06:00am - 08:00pm)?
Default TRUE.
</p>
</li>
</ul>
<h3>Internals</h3>

<p>The cyclic feature transformation always assumes that values range from 0, so some values
(e.g. day of the month) are shifted before sine/cosine transform.
</p>


<h3>Methods</h3>

<p>Only methods inherited from <code>PipeOpTaskPreprocSimple</code>/<code>PipeOpTaskPreproc</code>/<code>PipeOp</code>.
</p>


<h3>Fields</h3>

<p>Only fields inherited from <code>PipeOpTaskPreproc</code>/<code>PipeOp</code>.
</p>


<h3>See Also</h3>

<p>https://mlr-org.com/pipeops.html
</p>
<p>Other PipeOps: 
<code>PipeOp</code>,
<code>PipeOpEnsemble</code>,
<code>PipeOpImpute</code>,
<code>PipeOpTargetTrafo</code>,
<code>PipeOpTaskPreproc</code>,
<code>PipeOpTaskPreprocSimple</code>,
<code>mlr_pipeops</code>,
<code>mlr_pipeops_adas</code>,
<code>mlr_pipeops_blsmote</code>,
<code>mlr_pipeops_boxcox</code>,
<code>mlr_pipeops_branch</code>,
<code>mlr_pipeops_chunk</code>,
<code>mlr_pipeops_classbalancing</code>,
<code>mlr_pipeops_classifavg</code>,
<code>mlr_pipeops_classweights</code>,
<code>mlr_pipeops_colapply</code>,
<code>mlr_pipeops_collapsefactors</code>,
<code>mlr_pipeops_colroles</code>,
<code>mlr_pipeops_copy</code>,
<code>mlr_pipeops_encode</code>,
<code>mlr_pipeops_encodeimpact</code>,
<code>mlr_pipeops_encodelmer</code>,
<code>mlr_pipeops_featureunion</code>,
<code>mlr_pipeops_filter</code>,
<code>mlr_pipeops_fixfactors</code>,
<code>mlr_pipeops_histbin</code>,
<code>mlr_pipeops_ica</code>,
<code>mlr_pipeops_imputeconstant</code>,
<code>mlr_pipeops_imputehist</code>,
<code>mlr_pipeops_imputelearner</code>,
<code>mlr_pipeops_imputemean</code>,
<code>mlr_pipeops_imputemedian</code>,
<code>mlr_pipeops_imputemode</code>,
<code>mlr_pipeops_imputeoor</code>,
<code>mlr_pipeops_imputesample</code>,
<code>mlr_pipeops_kernelpca</code>,
<code>mlr_pipeops_learner</code>,
<code>mlr_pipeops_missind</code>,
<code>mlr_pipeops_modelmatrix</code>,
<code>mlr_pipeops_multiplicityexply</code>,
<code>mlr_pipeops_multiplicityimply</code>,
<code>mlr_pipeops_mutate</code>,
<code>mlr_pipeops_nmf</code>,
<code>mlr_pipeops_nop</code>,
<code>mlr_pipeops_ovrsplit</code>,
<code>mlr_pipeops_ovrunite</code>,
<code>mlr_pipeops_pca</code>,
<code>mlr_pipeops_proxy</code>,
<code>mlr_pipeops_quantilebin</code>,
<code>mlr_pipeops_randomprojection</code>,
<code>mlr_pipeops_randomresponse</code>,
<code>mlr_pipeops_regravg</code>,
<code>mlr_pipeops_removeconstants</code>,
<code>mlr_pipeops_renamecolumns</code>,
<code>mlr_pipeops_replicate</code>,
<code>mlr_pipeops_rowapply</code>,
<code>mlr_pipeops_scale</code>,
<code>mlr_pipeops_scalemaxabs</code>,
<code>mlr_pipeops_scalerange</code>,
<code>mlr_pipeops_select</code>,
<code>mlr_pipeops_smote</code>,
<code>mlr_pipeops_smotenc</code>,
<code>mlr_pipeops_spatialsign</code>,
<code>mlr_pipeops_subsample</code>,
<code>mlr_pipeops_targetinvert</code>,
<code>mlr_pipeops_targetmutate</code>,
<code>mlr_pipeops_targettrafoscalerange</code>,
<code>mlr_pipeops_textvectorizer</code>,
<code>mlr_pipeops_threshold</code>,
<code>mlr_pipeops_tunethreshold</code>,
<code>mlr_pipeops_unbranch</code>,
<code>mlr_pipeops_updatetarget</code>,
<code>mlr_pipeops_vtreat</code>,
<code>mlr_pipeops_yeojohnson</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library("mlr3")
dat = iris
set.seed(1)
dat$date = sample(seq(as.POSIXct("2020-02-01"), to = as.POSIXct("2020-02-29"), by = "hour"),
 size = 150L)
task = TaskClassif$new("iris_date", backend = dat, target = "Species")
pop = po("datefeatures", param_vals = list(cyclic = FALSE, minute = FALSE, second = FALSE))
pop$train(list(task))
pop$state
</code></pre>


</div>