<div class="container">

<table style="width: 100%;"><tr>
<td>mlr_graphs_robustify</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Robustify a learner</h2>

<h3>Description</h3>

<p>Creates a <code>Graph</code> that can be used to robustify any subsequent learner.
Performs the following steps:
</p>

<ul>
<li>
<p> Drops empty factor levels using <code>PipeOpFixFactors</code>
</p>
</li>
<li>
<p> Imputes <code>numeric</code> features using <code>PipeOpImputeHist</code> and <code>PipeOpMissInd</code>
</p>
</li>
<li>
<p> Imputes <code>factor</code> features using <code>PipeOpImputeOOR</code>
</p>
</li>
<li>
<p> Encodes <code>factors</code> using <code>one-hot-encoding</code>. Factors with a cardinality &gt; max_cardinality are
collapsed using <code>PipeOpCollapseFactors</code>
</p>
</li>
</ul>
<p>The graph is built conservatively, i.e. the function always tries to assure everything works.
If a learner is provided, some steps can be left out, i.e. if the learner can deal with
factor variables, no encoding is performed.
</p>
<p>All input arguments are cloned and have no references in common with the returned <code>Graph</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pipeline_robustify(
  task = NULL,
  learner = NULL,
  impute_missings = NULL,
  factors_to_numeric = NULL,
  max_cardinality = 1000,
  ordered_action = "factor",
  character_action = "factor",
  POSIXct_action = "numeric"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>task</code></td>
<td>
<p><code>Task</code> <br>
A <code>Task</code> to create a robustifying pipeline for.
Optional, if omitted, the "worst possible" <code>Task</code> is assumed and the full pipeline is created.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>learner</code></td>
<td>
<p><code>Learner</code> <br>
A learner to create a robustifying pipeline for. Optional, if omitted,
the "worst possible" <code>Learner</code> is assumed and a more conservative pipeline is built.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>impute_missings</code></td>
<td>
<p><code>logical(1)</code> | <code>NULL</code> <br>
Should missing values be imputed? Defaults to <code>NULL</code>: imputes if the task has
missing values (or factors that are not encoded to numerics) and the learner can not handle them.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factors_to_numeric</code></td>
<td>
<p><code>logical(1)</code> | <code>NULL</code> <br>
Should (ordered and unordered) factors be encoded? Defaults to <code>NULL</code>: encodes if the task has factors (or character columns that get converted to factor)
and the learner can not handle factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_cardinality</code></td>
<td>
<p><code>integer(1)</code> <br>
Maximum number of factor levels allowed. See above. Default: 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ordered_action</code></td>
<td>
<p><code>character(1)</code><br>
How to handle <code>ordered</code> columns: <code>"factor"</code> (default) or <code>"factor!"</code>: convert to <code>factor</code> columns;
<code>"numeric"</code> or <code>"numeric!"</code>: convert to <code>numeric</code> columns; <code>"integer"</code> or <code>"integer!"</code>: convert to <code>integer</code> columns; <code>"ignore"</code> or <code>"ignore!"</code>: ignore.
When <code>task</code> is given and has no <code>ordered</code> columns, or when <code>learner</code> is given and can handle <code>ordered</code>, then
<code>"factor"</code>, <code>"numeric"</code> and <code>"integer"</code> are treated like <code>"ignore"</code>. This means it is necessary to add the exclamation point to
override <code>Task</code> or <code>Learner</code> properties when given. <code>"ignore"</code> and <code>"ignore!"</code> therefore
behave completely identically, <code>"ignore!"</code> is only present for consistency.<br>
When <code>ordered</code> features are converted to <code>factor</code>, then they are treated like <code>factor</code> features further down in the pipeline,
and are possibly eventually converted to <code>numeric</code>s, but in a different way: <code>factor</code>s get one-hot encoded, <code>ordered_action</code> = <code>"numeric"</code>
converts ordered using <code>as.numeric</code> to their integer-valued rank.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>character_action</code></td>
<td>
<p><code>character(1)</code><br>
How to handle <code>character</code> columns: <code>"factor"</code> (default) or <code>"factor!"</code>: convert to <code>factor</code> columns;
<code>"matrix"</code> or <code>"matrix!"</code>: Use <code>PipeOpTextVectorizer</code>. <code>"ignore"</code> or <code>"ignore!"</code>: ignore.
When <code>task</code> is given and has no <code>character</code> columns, or when <code>learner</code> is given and can handle <code>character</code>, then
<code>"factor"</code> and <code>"matrix"</code> are treated like <code>"ignore"</code>. This means it is necessary to add the exclamation point to
override <code>Task</code> or <code>Learner</code> properties when given. <code>"ignore"</code> and <code>"ignore!"</code> therefore
behave completely identically, <code>"ignore!"</code> is only present for consistency.<br>
When <code>character</code> columns are converted to <code>factor</code>, then they are treated like <code>factor</code> further down in the pipeline,
and are possibly eventually converted to <code>numeric</code>s, using one-hot encoding.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>POSIXct_action</code></td>
<td>
<p><code>character(1)</code><br>
How to handle <code>POSIXct</code> columns: <code>"numeric"</code> (default) or <code>"numeric!"</code>: convert to <code>numeric</code> columns;
<code>"datefeatures"</code> or <code>"datefeatures!"</code>: Use <code>PipeOpDateFeatures</code>. <code>"ignore"</code> or <code>"ignore!"</code>: ignore.
When <code>task</code> is given and has no <code>POSIXct</code> columns, or when <code>learner</code> is given and can handle <code>POSIXct</code>, then
<code>"numeric"</code> and <code>"datefeatures"</code> are treated like <code>"ignore"</code>. This means it is necessary to add the exclamation point to
override <code>Task</code> or <code>Learner</code> properties when given. <code>"ignore"</code> and <code>"ignore!"</code> therefore
behave completely identically, <code>"ignore!"</code> is only present for consistency.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>Graph</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

library(mlr3)
lrn = lrn("regr.rpart")
task = mlr_tasks$get("boston_housing")
gr = pipeline_robustify(task, lrn) %&gt;&gt;% po("learner", lrn)
resample(task, GraphLearner$new(gr), rsmp("holdout"))


</code></pre>


</div>