<div class="container">

<table style="width: 100%;"><tr>
<td>mlr_graphs_targettrafo</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Transform and Re-Transform the Target Variable</h2>

<h3>Description</h3>

<p>Wraps a <code>Graph</code> that transforms a target during training and inverts the transformation
during prediction. This is done as follows:
</p>

<ul>
<li>
<p> Specify a transformation and inversion function using any subclass of <code>PipeOpTargetTrafo</code>, defaults to
<code>PipeOpTargetMutate</code>, afterwards apply <code>graph</code>.
</p>
</li>
<li>
<p> At the very end, during prediction the transformation is inverted using <code>PipeOpTargetInvert</code>.
</p>
</li>
<li>
<p> To set a transformation and inversion function for <code>PipeOpTargetMutate</code> see the
parameters <code>trafo</code> and <code>inverter</code> of the <code>param_set</code> of the resulting <code>Graph</code>.
</p>
</li>
<li>
<p> Note that the input <code>graph</code> is not explicitly checked to actually return a
<code>Prediction</code> during prediction.
</p>
</li>
</ul>
<p>All input arguments are cloned and have no references in common with the returned <code>Graph</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pipeline_targettrafo(
  graph,
  trafo_pipeop = PipeOpTargetMutate$new(),
  id_prefix = ""
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>graph</code></td>
<td>
<p><code>PipeOpLearner</code> | <code>Graph</code> <br>
A <code>PipeOpLearner</code> or <code>Graph</code> to wrap between a transformation and re-transformation of the target variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trafo_pipeop</code></td>
<td>
<p><code>PipeOp</code> <br>
A <code>PipeOp</code> that is a subclass of <code>PipeOpTargetTrafo</code>. Default is <code>PipeOpTargetMutate</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id_prefix</code></td>
<td>
<p><code>character(1)</code> <br>
Optional id prefix to prepend to <code>PipeOpTargetInvert</code> ID. The resulting ID will be <code>"[id_prefix]targetinvert"</code>. Default is <code>""</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>Graph</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library("mlr3")

tt = pipeline_targettrafo(PipeOpLearner$new(LearnerRegrRpart$new()))
tt$param_set$values$targetmutate.trafo = function(x) log(x, base = 2)
tt$param_set$values$targetmutate.inverter = function(x) list(response = 2 ^ x$response)

# gives the same as
g = Graph$new()
g$add_pipeop(PipeOpTargetMutate$new(param_vals = list(
  trafo = function(x) log(x, base = 2),
  inverter = function(x) list(response = 2 ^ x$response))
  )
)
g$add_pipeop(LearnerRegrRpart$new())
g$add_pipeop(PipeOpTargetInvert$new())
g$add_edge(src_id = "targetmutate", dst_id = "targetinvert",
  src_channel = 1, dst_channel = 1)
g$add_edge(src_id = "targetmutate", dst_id = "regr.rpart",
  src_channel = 2, dst_channel = 1)
g$add_edge(src_id = "regr.rpart", dst_id = "targetinvert",
  src_channel = 1, dst_channel = 2)

</code></pre>


</div>