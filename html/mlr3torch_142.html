<div class="container">

<table style="width: 100%;"><tr>
<td>ModelDescriptor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Represent a Model with Meta-Info</h2>

<h3>Description</h3>

<p>Represents a <em>model</em>; possibly a complete model, possibly one in the process of being built up.
</p>
<p>This model takes input tensors of shapes <code>shapes_in</code> and
pipes them through <code>graph</code>. Input shapes get mapped to input channels of <code>graph</code>.
Output shapes are named by the output channels of <code>graph</code>; it is also possible
to represent no-ops on tensors, in which case names of input and output should be identical.
</p>
<p><code>ModelDescriptor</code> objects typically represent partial models being built up, in which case the <code>pointer</code> slot
indicates a specific point in the graph that produces a tensor of shape <code>pointer_shape</code>, on which the graph should
be extended.
It is allowed for the <code>graph</code> in this structure to be modified by-reference in different parts of the code.
However, these modifications may never add edges with elements of the <code>Graph</code> as destination. In particular, no
element of <code>graph$input</code> may be removed by reference, e.g. by adding an edge to the <code>Graph</code> that has the input
channel of a <code>PipeOp</code> that was previously without parent as its destination.
</p>
<p>In most cases it is better to create a specific <code>ModelDescriptor</code> by training a <code>Graph</code> consisting (mostly) of
operators <code>PipeOpTorchIngress</code>, <code>PipeOpTorch</code>, <code>PipeOpTorchLoss</code>, <code>PipeOpTorchOptimizer</code>, and
<code>PipeOpTorchCallbacks</code>.
</p>
<p>A <code>ModelDescriptor</code> can be converted to a <code>nn_graph</code> via <code>model_descriptor_to_module</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ModelDescriptor(
  graph,
  ingress,
  task,
  optimizer = NULL,
  loss = NULL,
  callbacks = NULL,
  pointer = NULL,
  pointer_shape = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>graph</code></td>
<td>
<p>(<code>Graph</code>)<br><code>Graph</code> of <code>PipeOpModule</code> and <code>PipeOpNOP</code> operators.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ingress</code></td>
<td>
<p>(uniquely named <code>list</code> of <code>TorchIngressToken</code>)<br>
List of inputs that go into <code>graph</code>. Names of this must be a subset of <code>graph$input$name</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>task</code></td>
<td>
<p>(<code>Task</code>)<br>
(Training)-Task for which the model is being built. May be necessary for for some aspects of what loss to use etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimizer</code></td>
<td>
<p>(<code>TorchOptimizer</code> | <code>NULL</code>)<br>
Additional info: what optimizer to use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loss</code></td>
<td>
<p>(<code>TorchLoss</code> | <code>NULL</code>)<br>
Additional info: what loss to use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>callbacks</code></td>
<td>
<p>(A <code>list</code> of <code>CallbackSet</code> or <code>NULL</code>)<br>
Additional info: what callbacks to use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pointer</code></td>
<td>
<p>(<code>character(2)</code> | <code>NULL</code>)<br>
Indicating an element on which a model is. Points to an output channel within <code>graph</code>:
Element 1 is the <code>PipeOp</code>'s id and element 2 is that <code>PipeOp</code>'s output channel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pointer_shape</code></td>
<td>
<p>(<code>integer</code> | <code>NULL</code>)<br>
Shape of the output indicated by <code>pointer</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>(<code>ModelDescriptor</code>)
</p>


<h3>See Also</h3>

<p>Other Model Configuration: 
<code>mlr_pipeops_torch_callbacks</code>,
<code>mlr_pipeops_torch_loss</code>,
<code>mlr_pipeops_torch_optimizer</code>,
<code>model_descriptor_union()</code>
</p>
<p>Other Graph Network: 
<code>TorchIngressToken()</code>,
<code>mlr_learners_torch_model</code>,
<code>mlr_pipeops_module</code>,
<code>mlr_pipeops_torch</code>,
<code>mlr_pipeops_torch_ingress</code>,
<code>mlr_pipeops_torch_ingress_categ</code>,
<code>mlr_pipeops_torch_ingress_ltnsr</code>,
<code>mlr_pipeops_torch_ingress_num</code>,
<code>model_descriptor_to_learner()</code>,
<code>model_descriptor_to_module()</code>,
<code>model_descriptor_union()</code>,
<code>nn_graph()</code>
</p>


</div>