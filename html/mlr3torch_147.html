<div class="container">

<table style="width: 100%;"><tr>
<td>nn_graph</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Graph Network</h2>

<h3>Description</h3>

<p>Represents a neural network using a <code>Graph</code> that usually costains mostly <code>PipeOpModule</code>s.
</p>


<h3>Usage</h3>

<pre><code class="language-R">nn_graph(graph, shapes_in, output_map = graph$output$name, list_output = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>graph</code></td>
<td>
<p>(<code>Graph</code>)<br>
The <code>Graph</code> to wrap. Is <strong>not</strong> cloned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shapes_in</code></td>
<td>
<p>(named <code>integer</code>)<br>
Shape info of tensors that go into <code>graph</code>. Names must be <code>graph$input$name</code>, possibly in different order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output_map</code></td>
<td>
<p>(<code>character</code>)<br>
Which of <code>graph</code>'s outputs to use. Must be a subset of <code>graph$output$name</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>list_output</code></td>
<td>
<p>(<code>logical(1)</code>)<br>
Whether output should be a list of tensors. If <code>FALSE</code> (default), then <code>length(output_map)</code> must be 1.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>nn_graph</code>
</p>


<h3>See Also</h3>

<p>Other Graph Network: 
<code>ModelDescriptor()</code>,
<code>TorchIngressToken()</code>,
<code>mlr_learners_torch_model</code>,
<code>mlr_pipeops_module</code>,
<code>mlr_pipeops_torch</code>,
<code>mlr_pipeops_torch_ingress</code>,
<code>mlr_pipeops_torch_ingress_categ</code>,
<code>mlr_pipeops_torch_ingress_ltnsr</code>,
<code>mlr_pipeops_torch_ingress_num</code>,
<code>model_descriptor_to_learner()</code>,
<code>model_descriptor_to_module()</code>,
<code>model_descriptor_union()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
graph = mlr3pipelines::Graph$new()
graph$add_pipeop(po("module_1", module = nn_linear(10, 20)), clone = FALSE)
graph$add_pipeop(po("module_2", module = nn_relu()), clone = FALSE)
graph$add_pipeop(po("module_3", module = nn_linear(20, 1)), clone = FALSE)
graph$add_edge("module_1", "module_2")
graph$add_edge("module_2", "module_3")

network = nn_graph(graph, shapes_in = list(module_1.input = c(NA, 10)))

x = torch_randn(16, 10)

network(module_1.input = x)

</code></pre>


</div>