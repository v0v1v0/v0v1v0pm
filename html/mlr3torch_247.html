<div class="container">

<table style="width: 100%;"><tr>
<td>TorchIngressToken</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Torch Ingress Token</h2>

<h3>Description</h3>

<p>This function creates an S3 class of class <code>"TorchIngressToken"</code>, which is an internal data structure.
It contains the (meta-)information of how a batch is generated from a <code>Task</code> and fed into an entry point
of the neural network. It is stored as the <code>ingress</code> field in a <code>ModelDescriptor</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">TorchIngressToken(features, batchgetter, shape)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>features</code></td>
<td>
<p>(<code>character</code>)<br>
Features on which the batchgetter will operate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batchgetter</code></td>
<td>
<p>(<code>function</code>)<br>
Function with two arguments: <code>data</code> and <code>device</code>. This function is given
the output of <code>Task$data(rows = batch_indices, cols = features)</code>
and it should produce a tensor of shape <code>shape_out</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape</code></td>
<td>
<p>(<code>integer</code>)<br>
Shape that <code>batchgetter</code> will produce. Batch-dimension should be included as <code>NA</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>TorchIngressToken</code> object.
</p>


<h3>See Also</h3>

<p>Other Graph Network: 
<code>ModelDescriptor()</code>,
<code>mlr_learners_torch_model</code>,
<code>mlr_pipeops_module</code>,
<code>mlr_pipeops_torch</code>,
<code>mlr_pipeops_torch_ingress</code>,
<code>mlr_pipeops_torch_ingress_categ</code>,
<code>mlr_pipeops_torch_ingress_ltnsr</code>,
<code>mlr_pipeops_torch_ingress_num</code>,
<code>model_descriptor_to_learner()</code>,
<code>model_descriptor_to_module()</code>,
<code>model_descriptor_union()</code>,
<code>nn_graph()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Define a task for which we want to define an ingress token
task = tsk("iris")

# We create an ingress token for two feature Sepal.Length and Petal.Length:
# We have to specify the features, the batchgetter and the shape
features = c("Sepal.Length", "Petal.Length")
# As a batchgetter we use batchgetter_num

batch_dt = task$data(rows = 1:10, cols =features)
batch_dt
batch_tensor = batchgetter_num(batch_dt, "cpu")
batch_tensor

# The shape is unknown in the first dimension (batch dimension)

ingress_token = TorchIngressToken(
  features = features,
  batchgetter = batchgetter_num,
  shape = c(NA, 2)
)
ingress_token

</code></pre>


</div>