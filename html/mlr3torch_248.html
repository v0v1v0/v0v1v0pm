<div class="container">

<table style="width: 100%;"><tr>
<td>TorchLoss</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Torch Loss</h2>

<h3>Description</h3>

<p>This wraps a <code>torch::nn_loss</code> and annotates it with metadata, most importantly a <code>ParamSet</code>.
The loss function is created for the given parameter values by calling the <code style="white-space: pre;">⁠$generate()⁠</code> method.
</p>
<p>This class is usually used to configure the loss function of a torch learner, e.g.
when construcing a learner or in a <code>ModelDescriptor</code>.
</p>
<p>For a list of available losses, see <code>mlr3torch_losses</code>.
Items from this dictionary can be retrieved using <code>t_loss()</code>.
</p>


<h3>Parameters</h3>

<p>Defined by the constructor argument <code>param_set</code>.
If no parameter set is provided during construction, the parameter set is constructed by creating a parameter
for each argument of the wrapped loss function, where the parametes are then of type <code>ParamUty</code>.
</p>


<h3>Super class</h3>

<p><code>mlr3torch::TorchDescriptor</code> -&gt; <code>TorchLoss</code>
</p>


<h3>Public fields</h3>

<div class="r6-fields">

<dl>
<dt><code>task_types</code></dt>
<dd>
<p>(<code>character()</code>)<br>
The task types this loss supports.</p>
</dd>
</dl>
</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-TorchLoss-new"><code>TorchLoss$new()</code></a>
</p>
</li>
<li> <p><a href="#method-TorchLoss-print"><code>TorchLoss$print()</code></a>
</p>
</li>
<li> <p><a href="#method-TorchLoss-clone"><code>TorchLoss$clone()</code></a>
</p>
</li>
</ul>
<details open><summary>Inherited methods</summary><ul>
<li><span class="pkg-link" data-pkg="mlr3torch" data-topic="TorchDescriptor" data-id="generate"><a href="../../mlr3torch/html/TorchDescriptor.html#method-TorchDescriptor-generate"><code>mlr3torch::TorchDescriptor$generate()</code></a></span></li>
<li><span class="pkg-link" data-pkg="mlr3torch" data-topic="TorchDescriptor" data-id="help"><a href="../../mlr3torch/html/TorchDescriptor.html#method-TorchDescriptor-help"><code>mlr3torch::TorchDescriptor$help()</code></a></span></li>
</ul></details><hr>
<a id="method-TorchLoss-new"></a>



<h4>Method <code>new()</code>
</h4>

<p>Creates a new instance of this R6 class.
</p>


<h5>Usage</h5>

<div class="r"><pre>TorchLoss$new(
  torch_loss,
  task_types = NULL,
  param_set = NULL,
  id = NULL,
  label = NULL,
  packages = NULL,
  man = NULL
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>torch_loss</code></dt>
<dd>
<p>(<code>nn_loss</code>)<br>
The loss module.</p>
</dd>
<dt><code>task_types</code></dt>
<dd>
<p>(<code>character()</code>)<br>
The task types supported by this loss.</p>
</dd>
<dt><code>param_set</code></dt>
<dd>
<p>(<code>ParamSet</code> or <code>NULL</code>)<br>
The parameter set. If <code>NULL</code> (default) it is inferred from <code>torch_loss</code>.</p>
</dd>
<dt><code>id</code></dt>
<dd>
<p>(<code>character(1)</code>)<br>
The id for of the new object.</p>
</dd>
<dt><code>label</code></dt>
<dd>
<p>(<code>character(1)</code>)<br>
Label for the new instance.</p>
</dd>
<dt><code>packages</code></dt>
<dd>
<p>(<code>character()</code>)<br>
The R packages this object depends on.</p>
</dd>
<dt><code>man</code></dt>
<dd>
<p>(<code>character(1)</code>)<br>
String in the format <code style="white-space: pre;">⁠[pkg]::[topic]⁠</code> pointing to a manual page for this object.
The referenced help package can be opened via method <code style="white-space: pre;">⁠$help()⁠</code>.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-TorchLoss-print"></a>



<h4>Method <code>print()</code>
</h4>

<p>Prints the object
</p>


<h5>Usage</h5>

<div class="r"><pre>TorchLoss$print(...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>...</code></dt>
<dd>
<p>any</p>
</dd>
</dl>
</div>


<hr>
<a id="method-TorchLoss-clone"></a>



<h4>Method <code>clone()</code>
</h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>TorchLoss$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt>
<dd>
<p>Whether to make a deep clone.</p>
</dd>
</dl>
</div>




<h3>See Also</h3>

<p>Other Torch Descriptor: 
<code>TorchCallback</code>,
<code>TorchDescriptor</code>,
<code>TorchOptimizer</code>,
<code>as_torch_callbacks()</code>,
<code>as_torch_loss()</code>,
<code>as_torch_optimizer()</code>,
<code>mlr3torch_losses</code>,
<code>mlr3torch_optimizers</code>,
<code>t_clbk()</code>,
<code>t_loss()</code>,
<code>t_opt()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Create a new torch loss
torch_loss = TorchLoss$new(torch_loss = nn_mse_loss, task_types = "regr")
torch_loss
# the parameters are inferred
torch_loss$param_set

# Retrieve a loss from the dictionary:
torch_loss = t_loss("mse", reduction = "mean")
# is the same as
torch_loss
torch_loss$param_set
torch_loss$label
torch_loss$task_types
torch_loss$id

# Create the loss function
loss_fn = torch_loss$generate()
loss_fn
# Is the same as
nn_mse_loss(reduction = "mean")

# open the help page of the wrapped loss function
# torch_loss$help()

# Use in a learner
learner = lrn("regr.mlp", loss = t_loss("mse"))
# The parameters of the loss are added to the learner's parameter set
learner$param_set

</code></pre>


</div>