<div class="container">

<table style="width: 100%;"><tr>
<td>mlr_context_torch</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Context for Torch Learner</h2>

<h3>Description</h3>

<p>Context for training a torch learner.
This is the - mostly read-only - information callbacks have access to through the argument <code>ctx</code>.
For more information on callbacks, see <code>CallbackSet</code>.
</p>


<h3>Public fields</h3>

<div class="r6-fields">

<dl>
<dt><code>learner</code></dt>
<dd>
<p>(<code>Learner</code>)<br>
The torch learner.</p>
</dd>
<dt><code>task_train</code></dt>
<dd>
<p>(<code>Task</code>)<br>
The training task.</p>
</dd>
<dt><code>task_valid</code></dt>
<dd>
<p>(<code>Task</code> or <code>NULL</code>)<br>
The validation task.</p>
</dd>
<dt><code>loader_train</code></dt>
<dd>
<p>(<code>torch::dataloader</code>)<br>
The data loader for training.</p>
</dd>
<dt><code>loader_valid</code></dt>
<dd>
<p>(<code>torch::dataloader</code>)<br>
The data loader for validation.</p>
</dd>
<dt><code>measures_train</code></dt>
<dd>
<p>(<code>list()</code> of <code>Measure</code>s)<br>
Measures used for training.</p>
</dd>
<dt><code>measures_valid</code></dt>
<dd>
<p>(<code>list()</code> of <code>Measure</code>s)<br>
Measures used for validation.</p>
</dd>
<dt><code>network</code></dt>
<dd>
<p>(<code>torch::nn_module</code>)<br>
The torch network.</p>
</dd>
<dt><code>optimizer</code></dt>
<dd>
<p>(<code>torch::optimizer</code>)<br>
The optimizer.</p>
</dd>
<dt><code>loss_fn</code></dt>
<dd>
<p>(<code>torch::nn_module</code>)<br>
The loss function.</p>
</dd>
<dt><code>total_epochs</code></dt>
<dd>
<p>(<code>integer(1)</code>)<br>
The total number of epochs the learner is trained for.</p>
</dd>
<dt><code>last_scores_train</code></dt>
<dd>
<p>(named <code>list()</code> or <code>NULL</code>)<br>
The scores from the last training batch. Names are the ids of the training measures.
If <code>LearnerTorch</code> sets <code>eval_freq</code> different from <code>1</code>, this is <code>NULL</code> in all epochs
that don't evaluate the model.</p>
</dd>
<dt><code>last_scores_valid</code></dt>
<dd>
<p>(<code>list()</code>)<br>
The scores from the last validation batch. Names are the ids of the validation measures.
If <code>LearnerTorch</code> sets <code>eval_freq</code> different from <code>1</code>, this is <code>NULL</code> in all epochs
that don't evaluate the model.</p>
</dd>
<dt><code>epoch</code></dt>
<dd>
<p>(<code>integer(1)</code>)<br>
The current epoch.</p>
</dd>
<dt><code>step</code></dt>
<dd>
<p>(<code>integer(1)</code>)<br>
The current iteration.</p>
</dd>
<dt><code>prediction_encoder</code></dt>
<dd>
<p>(<code style="white-space: pre;">⁠function()⁠</code>)<br>
The learner's prediction encoder.</p>
</dd>
<dt><code>batch</code></dt>
<dd>
<p>(named <code>list()</code> of <code>torch_tensor</code>s)<br>
The current batch.</p>
</dd>
<dt><code>terminate</code></dt>
<dd>
<p>(<code>logical(1)</code>)<br>
If this field is set to <code>TRUE</code> at the end of an epoch, training stops.</p>
</dd>
</dl>
</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-ContextTorch-new"><code>ContextTorch$new()</code></a>
</p>
</li>
<li> <p><a href="#method-ContextTorch-clone"><code>ContextTorch$clone()</code></a>
</p>
</li>
</ul>
<hr>
<a id="method-ContextTorch-new"></a>



<h4>Method <code>new()</code>
</h4>

<p>Creates a new instance of this R6 class.
</p>


<h5>Usage</h5>

<div class="r"><pre>ContextTorch$new(
  learner,
  task_train,
  task_valid = NULL,
  loader_train,
  loader_valid = NULL,
  measures_train = NULL,
  measures_valid = NULL,
  network,
  optimizer,
  loss_fn,
  total_epochs,
  prediction_encoder,
  eval_freq = 1L
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>learner</code></dt>
<dd>
<p>(<code>Learner</code>)<br>
The torch learner.</p>
</dd>
<dt><code>task_train</code></dt>
<dd>
<p>(<code>Task</code>)<br>
The training task.</p>
</dd>
<dt><code>task_valid</code></dt>
<dd>
<p>(<code>Task</code> or <code>NULL</code>)<br>
The validation task.</p>
</dd>
<dt><code>loader_train</code></dt>
<dd>
<p>(<code>torch::dataloader</code>)<br>
The data loader for training.</p>
</dd>
<dt><code>loader_valid</code></dt>
<dd>
<p>(<code>torch::dataloader</code> or <code>NULL</code>)<br>
The data loader for validation.</p>
</dd>
<dt><code>measures_train</code></dt>
<dd>
<p>(<code>list()</code> of <code>Measure</code>s or <code>NULL</code>)<br>
Measures used for training. Default is <code>NULL</code>.</p>
</dd>
<dt><code>measures_valid</code></dt>
<dd>
<p>(<code>list()</code> of <code>Measure</code>s or <code>NULL</code>)<br>
Measures used for validation.</p>
</dd>
<dt><code>network</code></dt>
<dd>
<p>(<code>torch::nn_module</code>)<br>
The torch network.</p>
</dd>
<dt><code>optimizer</code></dt>
<dd>
<p>(<code>torch::optimizer</code>)<br>
The optimizer.</p>
</dd>
<dt><code>loss_fn</code></dt>
<dd>
<p>(<code>torch::nn_module</code>)<br>
The loss function.</p>
</dd>
<dt><code>total_epochs</code></dt>
<dd>
<p>(<code>integer(1)</code>)<br>
The total number of epochs the learner is trained for.</p>
</dd>
<dt><code>prediction_encoder</code></dt>
<dd>
<p>(<code style="white-space: pre;">⁠function()⁠</code>)<br>
The learner's prediction encoder.</p>
</dd>
<dt><code>eval_freq</code></dt>
<dd>
<p>(<code>integer(1)</code>)<br>
The evaluation frequency.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-ContextTorch-clone"></a>



<h4>Method <code>clone()</code>
</h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>ContextTorch$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt>
<dd>
<p>Whether to make a deep clone.</p>
</dd>
</dl>
</div>




<h3>See Also</h3>

<p>Other Callback: 
<code>TorchCallback</code>,
<code>as_torch_callback()</code>,
<code>as_torch_callbacks()</code>,
<code>callback_set()</code>,
<code>mlr3torch_callbacks</code>,
<code>mlr_callback_set</code>,
<code>mlr_callback_set.checkpoint</code>,
<code>mlr_callback_set.progress</code>,
<code>t_clbk()</code>,
<code>torch_callback()</code>
</p>


</div>