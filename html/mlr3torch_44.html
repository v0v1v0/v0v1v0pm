<div class="container">

<table style="width: 100%;"><tr>
<td>mlr_learners.mlp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>My Little Pony</h2>

<h3>Description</h3>

<p>Fully connected feed forward network with dropout after each activation function.
The features can either be a single <code>lazy_tensor</code> or one or more numeric columns (but not both).
</p>


<h3>Dictionary</h3>

<p>This Learner can be instantiated using the sugar function <code>lrn()</code>:
</p>
<div class="sourceCode"><pre>lrn("classif.mlp", ...)
lrn("regr.mlp", ...)
</pre></div>


<h3>Properties</h3>


<ul>
<li>
<p> Supported task types: 'classif', 'regr'
</p>
</li>
<li>
<p> Predict Types:
</p>

<ul>
<li>
<p> classif: 'response', 'prob'
</p>
</li>
<li>
<p> regr: 'response'
</p>
</li>
</ul>
</li>
<li>
<p> Feature Types: “integer”, “numeric”, “lazy_tensor”
</p>
</li>
<li>
<p> Required Packages: <a href="https://CRAN.R-project.org/package=mlr3"><span class="pkg">mlr3</span></a>, <a href="https://CRAN.R-project.org/package=mlr3torch"><span class="pkg">mlr3torch</span></a>, <a href="https://CRAN.R-project.org/package=torch"><span class="pkg">torch</span></a>
</p>
</li>
</ul>
<h3>Parameters</h3>

<p>Parameters from <code>LearnerTorch</code>, as well as:
</p>

<ul>
<li> <p><code>activation</code> :: <code style="white-space: pre;">⁠[nn_module]⁠</code><br>
The activation function. Is initialized to <code>nn_relu</code>.
</p>
</li>
<li> <p><code>activation_args</code> :: named <code>list()</code><br>
A named list with initialization arguments for the activation function.
This is intialized to an empty list.
</p>
</li>
<li> <p><code>neurons</code> :: <code>integer()</code><br>
The number of neurons per hidden layer. By default there is no hidden layer.
Setting this to <code>c(10, 20)</code> would have a the first hidden layer with 10 neurons and the second with 20.
</p>
</li>
<li> <p><code>p</code> :: <code>numeric(1)</code><br>
The dropout probability. Is initialized to <code>0.5</code>.
</p>
</li>
<li> <p><code>shape</code> :: <code>integer()</code> or <code>NULL</code><br>
The input shape of length 2, e.g. <code>c(NA, 5)</code>.
Only needs to be present when there is a lazy tensor input with unknown shape (<code>NULL</code>).
Otherwise the input shape is inferred from the number of numeric features.
</p>
</li>
</ul>
<h3>Super classes</h3>

<p><code>mlr3::Learner</code> -&gt; <code>mlr3torch::LearnerTorch</code> -&gt; <code>LearnerTorchMLP</code>
</p>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-LearnerTorchMLP-new"><code>LearnerTorchMLP$new()</code></a>
</p>
</li>
<li> <p><a href="#method-LearnerTorchMLP-clone"><code>LearnerTorchMLP$clone()</code></a>
</p>
</li>
</ul>
<details><summary>Inherited methods</summary><ul>
<li><span class="pkg-link" data-pkg="mlr3" data-topic="Learner" data-id="base_learner"><a href="../../mlr3/html/Learner.html#method-Learner-base_learner"><code>mlr3::Learner$base_learner()</code></a></span></li>
<li><span class="pkg-link" data-pkg="mlr3" data-topic="Learner" data-id="help"><a href="../../mlr3/html/Learner.html#method-Learner-help"><code>mlr3::Learner$help()</code></a></span></li>
<li><span class="pkg-link" data-pkg="mlr3" data-topic="Learner" data-id="predict"><a href="../../mlr3/html/Learner.html#method-Learner-predict"><code>mlr3::Learner$predict()</code></a></span></li>
<li><span class="pkg-link" data-pkg="mlr3" data-topic="Learner" data-id="predict_newdata"><a href="../../mlr3/html/Learner.html#method-Learner-predict_newdata"><code>mlr3::Learner$predict_newdata()</code></a></span></li>
<li><span class="pkg-link" data-pkg="mlr3" data-topic="Learner" data-id="reset"><a href="../../mlr3/html/Learner.html#method-Learner-reset"><code>mlr3::Learner$reset()</code></a></span></li>
<li><span class="pkg-link" data-pkg="mlr3" data-topic="Learner" data-id="train"><a href="../../mlr3/html/Learner.html#method-Learner-train"><code>mlr3::Learner$train()</code></a></span></li>
<li><span class="pkg-link" data-pkg="mlr3torch" data-topic="LearnerTorch" data-id="dataset"><a href="../../mlr3torch/html/LearnerTorch.html#method-LearnerTorch-dataset"><code>mlr3torch::LearnerTorch$dataset()</code></a></span></li>
<li><span class="pkg-link" data-pkg="mlr3torch" data-topic="LearnerTorch" data-id="format"><a href="../../mlr3torch/html/LearnerTorch.html#method-LearnerTorch-format"><code>mlr3torch::LearnerTorch$format()</code></a></span></li>
<li><span class="pkg-link" data-pkg="mlr3torch" data-topic="LearnerTorch" data-id="marshal"><a href="../../mlr3torch/html/LearnerTorch.html#method-LearnerTorch-marshal"><code>mlr3torch::LearnerTorch$marshal()</code></a></span></li>
<li><span class="pkg-link" data-pkg="mlr3torch" data-topic="LearnerTorch" data-id="print"><a href="../../mlr3torch/html/LearnerTorch.html#method-LearnerTorch-print"><code>mlr3torch::LearnerTorch$print()</code></a></span></li>
<li><span class="pkg-link" data-pkg="mlr3torch" data-topic="LearnerTorch" data-id="unmarshal"><a href="../../mlr3torch/html/LearnerTorch.html#method-LearnerTorch-unmarshal"><code>mlr3torch::LearnerTorch$unmarshal()</code></a></span></li>
</ul></details><hr>
<a id="method-LearnerTorchMLP-new"></a>



<h4>Method <code>new()</code>
</h4>

<p>Creates a new instance of this R6 class.
</p>


<h5>Usage</h5>

<div class="r"><pre>LearnerTorchMLP$new(
  task_type,
  optimizer = NULL,
  loss = NULL,
  callbacks = list()
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>task_type</code></dt>
<dd>
<p>(<code>character(1)</code>)<br>
The task type, either <code style="white-space: pre;">⁠"classif⁠</code>" or <code>"regr"</code>.</p>
</dd>
<dt><code>optimizer</code></dt>
<dd>
<p>(<code>TorchOptimizer</code>)<br>
The optimizer to use for training.
Per default, <em>adam</em> is used.</p>
</dd>
<dt><code>loss</code></dt>
<dd>
<p>(<code>TorchLoss</code>)<br>
The loss used to train the network.
Per default, <em>mse</em> is used for regression and <em>cross_entropy</em> for classification.</p>
</dd>
<dt><code>callbacks</code></dt>
<dd>
<p>(<code>list()</code> of <code>TorchCallback</code>s)<br>
The callbacks. Must have unique ids.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-LearnerTorchMLP-clone"></a>



<h4>Method <code>clone()</code>
</h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>LearnerTorchMLP$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt>
<dd>
<p>Whether to make a deep clone.</p>
</dd>
</dl>
</div>




<h3>See Also</h3>

<p>Other Learner: 
<code>mlr_learners.tab_resnet</code>,
<code>mlr_learners.torch_featureless</code>,
<code>mlr_learners_torch</code>,
<code>mlr_learners_torch_image</code>,
<code>mlr_learners_torch_model</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Define the Learner and set parameter values
learner = lrn("classif.mlp")
learner$param_set$set_values(
  epochs = 1, batch_size = 16, device = "cpu",
  neurons = 10
)

# Define a Task
task = tsk("iris")

# Create train and test set
ids = partition(task)

# Train the learner on the training ids
learner$train(task, row_ids = ids$train)

# Make predictions for the test rows
predictions = learner$predict(task, row_ids = ids$test)

# Score the predictions
predictions$score()

</code></pre>


</div>