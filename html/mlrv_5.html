<div class="container">

<table style="width: 100%;"><tr>
<td>heter_gradient</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Structural stability tests for non-stationary time series regression</h2>

<h3>Description</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script><p> Test for long memory of \(e_i\) in the time series regression \[y_i = x_i \beta_i + e_i, 1\leq i \leq n\] where \(x_i\) is the multivariate covariate process with first component 1, \(\beta_i\) is the coefficient, \(e_i\) is the error term which can be long memory. The goal is to test whether the null hypothesis  \[\beta_1 = \ldots = \beta_n = \beta\] holds. The alternative hypothesis is that the coefficient function \(\beta_i\) is time-varying.  Covariates and the error term are allowed to be dependent.
</p>


<h3>Usage</h3>

<pre><code class="language-R">heter_gradient(data, param, mvselect = -1, verbose_dist = FALSE, hyper = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a list with the vector y (response) and the matrix x (covariates), for example, list(x=...,y=...).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>a list of parameters, list(B =..., lrvmethod =...,gcv = ..., neighbour =..., lb = ..., ub = ..., tau_n = ..., type = ..., ind = ...)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mvselect</code></td>
<td>
<p>the value of moving window parameter \(m\). In addition, mvselect=-1 provides data-driven smoothing parameters via Minimum Volatility of the long-run covariance estimator, while mvselect = -2 provides data-driven smoothing parameters via Minimum Volatility of the bootstrap statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose_dist</code></td>
<td>
<p>whether to print intermediate results, i.e., the bootstrap distribution and statistics, default FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hyper</code></td>
<td>
<p>whether to only print the selected values of the smoothing parameters,\(m\) and \(\tau_n\), default FALSE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>param
</p>

<ul>
<li>
<p> B, the number of bootstrap simulation, say 2000
</p>
</li>
<li>
<p> lrvmethod  the method of long-run variance estimation, lrvmethod = -1 uses the ols plug-in estimator as in Wu and Zhou (2018), lrvmethod = 0 uses the plug-in estimator in Zhou (2010), lrvmethod = 1 offers the debias difference-based estimator in Bai and Wu (2024), lrvmethod = 2 provides the plug-in estimator using the \(\breve{\beta}\), the pilot estimator proposed in Bai and Wu (2024)
</p>
</li>
<li>
<p> gcv,  1 or 0, whether to use Generalized Cross Validation for the selection of \(b\), the bandwidth parameter in the local linear regression, which will not be used when lrvmethod is -1, 1 or 2.
</p>
</li>
<li>
<p> neighbour, the number of neighbours in the extended minimum volatility, for example 1,2 or 3
</p>
</li>
<li>
<p> lb, the lower bound of the range of \(m\) in the extended minimum volatility Selection
</p>
</li>
<li>
<p> ub,  the upper bound of the range of \(m\) in the extended minimum volatility Selection
</p>
</li>
<li>
<p> bw_set, the proposed grid of the range of bandwidth selection, which is only useful when lrvmethod = 1. if not presented, a rule of thumb method will be used for the data-driven range.
</p>
</li>
<li>
<p> tau_n,  the value of \(\tau\) when no data-driven selection is used. if \(tau\) is set to \(0\), the rule of thumb \(n^{-1/5}\) will be used
</p>
</li>
<li>
<p> type, default 0, uses the residual-based statistic proposed in Wu and Zhou (2018). “type” can also be set to -1, using the coefficient-based statistic in Wu and Zhou (2018).
</p>
</li>
<li>
<p> ind,  types of kernels
</p>
</li>
<li>
<p> 1 Triangular \(1-|u|\), \(u \le 1\)
</p>
</li>
<li>
<p> 2 Epanechnikov kernel \(3/4(1 - u^{2})\), \(u \le 1\)
</p>
</li>
<li>
<p> 3 Quartic \(15/16(1 - u^{2})^{2}\), \(u \le 1\)
</p>
</li>
<li>
<p> 4 Triweight \(35/32(1 - u^{2})^{3}\), \(u \le 1\)
</p>
</li>
<li>
<p> 5 Tricube  \(70/81(1 - |u|^{3})^{3}\), \(u \le 1\)
</p>
</li>
</ul>
<h3>Value</h3>

<p>p-value of the structural stability test
</p>


<h3>References</h3>

<p>Bai, L., &amp; Wu, W. (2024). Difference-based covariance matrix estimation in time series nonparametric regression with application to specification tests. Biometrika, asae013.
</p>
<p>Wu, W., and Zhou, Z. (2018). Gradient-based structural change detection for nonstationary time series M-estimation. The Annals of Statistics, 46(3), 1197-1224.
</p>
<p>Politis, D. N., Romano, J. P., and Wolf, M. (1999). Subsampling. Springer Science &amp; Business Media.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># choose a small B for tests
param = list(B = 50, bw_set = c(0.15, 0.25), gcv =1, neighbour = 1, lb = 10, ub = 20, type = 0)
n = 300
data = bregress2(n, 2, 1) # time series regression model with 2 changes points
param$lrvmethod = 0 # plug-in
heter_gradient(data, param, 4, 1)
param$lrvmethod = 1 # difference based
heter_gradient(data, param, 4, 1)
</code></pre>


</div>