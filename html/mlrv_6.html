<div class="container">

<table style="width: 100%;"><tr>
<td>Heter_LRV</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Long-run covariance matrix estimators</h2>

<h3>Description</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script><p> The function provides a wide range of estimators for the long-run covariance matrix estimation in non-stationary time series with covariates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Heter_LRV(
  e,
  X,
  m,
  tau_n = 0,
  lrv_method = 1L,
  ind = 2L,
  print_deg = 0L,
  rescale = 0L,
  ncp = 0L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>e, </code></td>
<td>
<p>vector, if the plug-in estimator is used, e should be the vector of residuals, OLS or nonparametric ones. If the difference-based debiased method is adopted, e should be the response time series, i.e., \(y\). Specially, e should also be the response time series, i.e., \(y\), if the plug-in estimator using the \(\breve{\beta}\), the pilot estimator proposed in Bai and Wu (2024).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X, </code></td>
<td>
<p>a matrix \(n\times p\)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m, </code></td>
<td>
<p>integer, the window size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau_n, </code></td>
<td>
<p>double, the smoothing parameter in the estimator. If tau_n is 0, a rule-of-thumb value will be automatically used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lrv_method, </code></td>
<td>
<p>the method of long-run variance estimation, lrvmethod = 0 uses the plug-in estimator in Zhou (2010), lrvmethod = 1 offers the debias difference-based estimator in Bai and Wu (2024), lrvmethod = 2 provides the plug-in estimator using the \(\breve{\beta}\), the pilot estimator proposed in Bai and Wu (2024)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ind, </code></td>
<td>
<p>types of kernels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print_deg, </code></td>
<td>
<p>bool, whether to print information of non-positiveness, default 0\(n\times p\)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rescale, </code></td>
<td>
<p>bool, whether to use rescaling to correct the negative eigenvalues, default 0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncp, </code></td>
<td>
<p>1 no change points, 0 possible change points
</p>

<ul>
<li>
<p> 1 Triangular \(1-|u|\), \(u \le 1\)
</p>
</li>
<li>
<p> 2 Epanechnikov kernel \(3/4(1-u^{2})\), \(u \le 1\)
</p>
</li>
<li>
<p> 3 Quartic \(15/16(1-u^{2})^{2}\), \(u \le 1\)
</p>
</li>
<li>
<p> 4 Triweight \(35/32(1-u^{2})^{3}\), \(u \le 1\)
</p>
</li>
<li>
<p> 5 Tricube  \(70/81(1-|u|^{3})^{3}\), \(u \le 1\)
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a cube. The time-varying long-run covariance matrix \(p \times p \times n\), where <i>p</i> is the dimension of the time series vector, and <i>n</i> is the sample size.
</p>


<h3>References</h3>

<p>Bai, L., &amp; Wu, W. (2024). Difference-based covariance matrix estimation in time series nonparametric regression with application to specification tests. Biometrika, asae013.
</p>
<p>Zhou, Z. and Wu, W. B. (2010). Simultaneous inference of linear models with time varying coefficients.J. R. Stat. Soc. Ser. B. Stat. Methodol., 72(4):513â€“531.
</p>


<h3>Examples</h3>

<pre><code class="language-R">param = list(d = -0.2, heter = 2, tvd = 0,
tw = 0.8, rate = 0.1, cur = 1, center = 0.3,
ma_rate =  0, cov_tw =  0.2, cov_rate = 0.1,
cov_center = 0.1, all_tw  = 1, cov_trend = 0.7)
data = Qct_reg(1000, param)
sigma = Heter_LRV(data$y, data$x, 3, 0.3, lrv_method = 1)
</code></pre>


</div>