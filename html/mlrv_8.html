<div class="container">

<table style="width: 100%;"><tr>
<td>LocLinear</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Local linear Regression</h2>

<h3>Description</h3>

<p>Local linear estimates for time varying coefficients
</p>


<h3>Usage</h3>

<pre><code class="language-R">LocLinear(bw, t, y, X, db_kernel = 0L, deriv2 = 0L, scb = 0L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p>double, bandwidth</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>vector, time, 1:n/n</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>vector, response series to be tested for long memory in the next step</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>matrix, covariates matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>db_kernel</code></td>
<td>
<p>bool, whether to use jackknife kernel, default 0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deriv2</code></td>
<td>
<p>bool,whether to return second-order derivative, default 0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scb</code></td>
<td>
<p>bool, whether to use the result for further calculation of simultaneous confidence bands.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The time varying coefficients are estimated by
\[(\hat{\boldsymbol{\beta}}_{b_{n}}(t), \hat{\boldsymbol{\beta}}_{b_{n}}^{\prime}(t)) = \mathbf{arg min}_{\eta_{0},\eta_{1}}[\sum_{i=1}^{n}{y_{i}-\mathbf{x}_{i}^{\mathrm{T}}\eta_{0}-\mathbf{x}_{i}^{\mathrm{T}} \eta_{1}(t_{i}-t)}^{2} \boldsymbol{K}_{b_{n}}(t_{i}-t)]\]
where beta0 is \(\hat{\boldsymbol{\beta}}_{b_{n}}(t)\), mu is \(X^T \hat{\boldsymbol{\beta}}_{b_{n}}(t)\)
</p>


<h3>Value</h3>

<p>a list of results
</p>

<ul>
<li>
<p> mu: the estimated trend
</p>
</li>
<li>
<p> beta0: time varying coefficient
</p>
</li>
<li>
<p> X_reg: a matrix whose j'th row is \(x_j^T\hat{M}(t_j)\)
</p>
</li>
<li>
<p> t: 1:n/n
</p>
</li>
<li>
<p> bw: bandwidth used
</p>
</li>
<li>
<p> X: covariates matrix
</p>
</li>
<li>
<p> y: response
</p>
</li>
<li>
<p> n: sample size
</p>
</li>
<li>
<p> p: dimension of covariates including the intercept
</p>
</li>
<li>
<p> invM: inversion of M matrix, when scb = 1
</p>
</li>
</ul>
<h3>References</h3>

<p>Zhou, Z., &amp; Wu, W. B. (2010). Simultaneous inference of linear models with time varying coefficients. Journal of the Royal Statistical Society: Series B (Statistical Methodology), 72(4), 513-531.
</p>


<h3>Examples</h3>

<pre><code class="language-R">param = list(d = -0.2, heter = 2, tvd = 0,
 tw = 0.8, rate = 0.1, cur = 1, center = 0.3,
  ma_rate =  0, cov_tw =  0.2, cov_rate = 0.1,
   cov_center = 0.1, all_tw  = 1, cov_trend = 0.7)
n = 500
t = (1:n)/n
data = Qct_reg(n, param)
result = LocLinear(0.2, t, data$y, data$x)
</code></pre>


</div>