<div class="container">

<table style="width: 100%;"><tr>
<td>modelfit1</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function used to fit Model 1</h2>

<h3>Description</h3>

<p>This function fits the multinomial mixed model with one independent random effect per category
of the response variable (Model 1), like in the formulation described in Lopez-Vizcaino et al. (2013).
The fitting algorithm combines the penalized quasi-likelihood method (PQL) for estimating
and predicting the fixed and random effects with the residual maximum likelihood method (REML)
for estimating the variance components. This function uses as initial values the output of the function
<code>initial.values</code>
</p>


<h3>Usage</h3>

<pre><code class="language-R">modelfit1(pp, Xk, X, Z, initial, y, M, MM)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pp</code></td>
<td>
<p>vector with the number of the auxiliary variables per category.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xk</code></td>
<td>
<p>list of matrices with the auxiliary variables per category obtained from <code>data.mme</code>. The dimension of the list is the number of domains.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>list of matrices with the auxiliary variables obtained from <code>data.mme</code>. The dimension of the list is the number of categories of the response variable minus one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>design matrix of random effects obtained from <code>data.mme</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial</code></td>
<td>
<p>output of the function <code>initial.values</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>matrix with the response variable except the reference category obtained from <code>data.mme</code>. The rows are the domains and the columns are the categories of the
response variable minus 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>vector with the area sample sizes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MM</code></td>
<td>
<p>vector with the population sample sizes.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the following components.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Estimated.probabilities</code></td>
<td>
<p>matrix with the estimated probabilities
for the categories of response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Fisher.information.matrix.phi</code></td>
<td>
<p>Fisher information matrix of the random effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Fisher.information.matrix.beta</code></td>
<td>
<p>Fisher information matrix of the fixed effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>matrix with the estimated random effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>matrix with the estimated mean of the response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warning1</code></td>
<td>
<p>0=OK,1=The model could not be fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warning2</code></td>
<td>
<p>0=OK,1=The value of the variance component is negative: the initial value
is taken.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.Stddev.p.value</code></td>
<td>
<p>matrix with the estimated fixed effects, its standard
deviations and its p-values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi.Stddev.p.value</code></td>
<td>
<p>matrix with the estimated variance components, its
standard deviations and its p-values.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Lopez-Vizcaino, ME, Lombardia, MJ and Morales, D (2013).
Multinomial-based small area estimation of labour force indicators.
Statistical Modelling, 13, 153-178.
</p>


<h3>See Also</h3>

<p><code>data.mme</code>, <code>initial.values</code>,
<code>wmatrix</code>, <code>phi.mult</code>,
<code>prmu</code>, <code>phi.direct</code>,
<code>sPhikf</code>, <code>ci</code>,
<code>Fbetaf</code>, <code>msef</code>,
<code>mseb</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">k=3 #number of categories of the response variable
pp=c(1,1) #vector with the number of auxiliary variables in each category
data(simdata)  #data
mod=1 #type of model
datar=data.mme(simdata,k,pp,mod)

#Model fit
result=modelfit1(pp,datar$Xk,datar$X,datar$Z,datar$initial,datar$y[,1:(k-1)],
      datar$n,datar$N)
</code></pre>


</div>