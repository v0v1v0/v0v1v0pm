<div class="container">

<table style="width: 100%;"><tr>
<td>mseb</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bias and MSE using parametric bootstrap</h2>

<h3>Description</h3>

<p>This function calculates the bias and the mse for the multinomial mixed effects models
using parametric bootstrap. Three types of multinomial mixed models are considered, with one independent domain random effect in each category of the response variable  (Model 1),
with two random effects: the first, with a domain random effect and with independent time and domain random effect (Model 2) and the second, with a domain random effect and with correlated time and domain random effect (Model 3).
See details of the parametric bootstrap procedure in Gonzalez-Manteiga et al. (2008) and in Lopez-Vizcaino et al. (2013)
for the adaptation to these three models. This function uses the output of <code>modelfit1</code>, <code>modelfit2</code> or <code>modelfit3</code>,
depending of the current multinomial mixed model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mseb(pp, Xk, X, Z, M, MM, resul, B, mod)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pp</code></td>
<td>
<p>vector with the number of the auxiliary variables per category.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xk</code></td>
<td>
<p>list of matrices with the auxiliary variables per category obtained from <code>data.mme</code>. The dimension of the list is the number of domains.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>list of matrices with the auxiliary variables obtained from <code>data.mme</code>. The dimension of the list is the number of categories of the response variable minus one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>design matrix of random effects obtained from <code>data.mme</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>vector with the area sample sizes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MM</code></td>
<td>
<p>vector with the population sample sizes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resul</code></td>
<td>
<p>output of the function <code>modelfit1</code>, <code>modelfit2</code> or <code>modelfit3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>number of bootstrap replications.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mod</code></td>
<td>
<p>a number specifying the type of models: 1=multinomial mixed model with one independent random effect in each category of the response variable
(Model 1), 2=multinomial mixed model with two independent random effects in each category of the response variable: one domain random effect and another independent time and domain random effect (Model 2) and
3= multinomial model with two independent random effects in each category of the response variable: one domain random effect and another correlated time and domain random effect (Model 3).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list containing the following components.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>bias.pboot</code></td>
<td>
<p>BIAS of the parametric bootstrap estimator of the mean of the response variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mse.pboot</code></td>
<td>
<p>MSE of the parametric bootstrap estimator of the mean of the response variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rmse.pboot</code></td>
<td>
<p>RMSE of the parametric bootstrap estimator of the mean of the response variable</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Lopez-Vizcaino, ME, Lombardia, MJ and Morales, D (2013).
Multinomial-based small area estimation of labour force indicators.
Statistical Modelling, 13 ,153-178.
</p>
<p>Lopez-Vizcaino, ME, Lombardia, MJ and Morales, D (2013).
Small area estimation of labour force indicator under a multinomial mixed model
with correlated time and area effects. Submitted for review.
</p>
<p>Gonzalez-Manteiga, W, Lombardia, MJ, Molina, I, Morales, D, Santamaria, L (2008). Estimation of the mean
squared error of predictors of small area linear parameters under a logistic mixed model, Computational Statistics
and Data Analysis, 51, 2720-2733.
</p>


<h3>See Also</h3>

<p><code>data.mme</code>, <code>initial.values</code>,
<code>wmatrix</code>, <code>phi.mult</code>, <code>phi.mult.it</code>,
<code>phi.mult.ct</code>, <code>prmu</code>, <code>prmu.time</code>, <code>phi.direct</code>,
<code>phi.direct.it</code>, <code>phi.direct.ct</code>, <code>sPhikf</code>, <code>sPhikf.it</code>,
<code>sPhikf.ct</code>, <code>modelfit1</code>, <code>modelfit2</code>,
<code>modelfit3</code>, <code>omega</code>,
<code>Fbetaf</code>, <code>Fbetaf.it</code>, <code>Fbetaf.ct</code>,
<code>ci</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">k=3 #number of categories of the response variable
pp=c(1,1) #vector with the number of auxiliary variables in each category
data(simdata)
mod=1  # Type of model
datar=data.mme(simdata,k,pp,mod)
##Model fit
result=modelfit1(pp,datar$Xk,datar$X,datar$Z,datar$initial,datar$y[,1:(k-1)],datar$n,datar$N)

B=1    #Bootstrap iterations
ss=12345 #SEED
set.seed(ss)

##Bootstrap parametric BIAS and MSE
mse.pboot=mseb(pp,datar$Xk,datar$X,datar$Z,datar$n,datar$N,result,B,mod)
</code></pre>


</div>