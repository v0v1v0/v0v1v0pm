<div class="container">

<table style="width: 100%;"><tr>
<td>phi.direct</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Variance components for Model 1</h2>

<h3>Description</h3>

<p>This function calculates the variance components for the multinomial mixed model with
one independent random effect in each category
of the response variable (Model 1). These values are used in the second part of the fitting algorithm
implemented in <code>modelfit1</code>. The algorithm adapts the ideas of Schall (1991) to a
multivariate model and the variance components are estimated by the REML method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">phi.direct(sigmap, phi, X, u)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sigmap</code></td>
<td>
<p>a list with the model variance-covariance matrices for each domain obtained from <code>wmatrix</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>list of matrices with the auxiliary variables obtained from <code>data.mme</code>. The dimension of the list is the number of categories of the response variable minus one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>vector with the initial values of the variance components obtained from <code>modelfit1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>matrix with the values of the random effects obtained from <code>modelfit1</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list containing the following components.
</p>
<table><tr style="vertical-align: top;">
<td><code>phi.new</code></td>
<td>
<p>vector with the variance components.</p>
</td>
</tr></table>
<h3>References</h3>

<p>Lopez-Vizcaino, ME, Lombardia, MJ and Morales, D (2013).
Multinomial-based small area estimation of labour force indicators.
Statistical Modelling, 13 ,153-178.
</p>
<p>Schall, R (1991). Estimation in generalized linear models with
random effects. Biometrika,
78,719-727.
</p>


<h3>See Also</h3>

<p><code>data.mme</code>, <code>initial.values</code>,
<code>wmatrix</code>, <code>phi.mult</code>,
<code>prmu</code>, <code>Fbetaf</code>,
<code>sPhikf</code>, <code>ci</code>,
<code>modelfit1</code>, <code>msef</code>,
<code>mseb</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">k=3 #number of categories of the response variable
pp=c(1,1) #vector with the number of auxiliary variables in each category
data(simdata)   #data
mod=1 #type of model
datar=data.mme(simdata,k,pp,mod)
initial=datar$initial
mean=prmu(datar$n,datar$Xk,initial$beta.0,initial$u.0)
#model variance-covariance matrix
sigmap=wmatrix(datar$n,mean$estimated.probabilities)

##Variance components
phi=phi.direct(sigmap,initial$phi.0,datar$X,initial$u.0)
</code></pre>


</div>