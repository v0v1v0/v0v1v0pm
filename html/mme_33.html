<div class="container">

<table style="width: 100%;"><tr>
<td>sPhikf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fisher information matrix and score vectors of the variance components for Model 1</h2>

<h3>Description</h3>

<p>This function computes the Fisher information matrix and the score vectors
of the variance components, for the multinomial mixed model with
one independent random effect in each category
of the response variable (Model 1). These values are used in the fitting algorithm
implemented in <code>modelfit1</code> to estimate the random effects. The algorithm adatps the ideas of Schall (1991) to a multivariate
model. The variance components are estimated by the REML method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sPhikf(pp, sigmap, X, eta, phi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pp</code></td>
<td>
<p>vector with the number of the auxiliary variables per category.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmap</code></td>
<td>
<p>a list with the model variance-covariance matrices for each domain obtained from <code>wmatrix</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>list of matrices with the auxiliary variables obtained from <code>data.mme</code>. The dimension of the list is the number of categories of the response variable minus one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>
<p>matrix with the estimated log-rates of probabilities of each category over the reference category obtained from
<code>prmu</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>vector with the values of the variance components obtained from <code>modelfit1</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the following components.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>S.k</code></td>
<td>
<p>phi score vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>F</code></td>
<td>
<p>Fisher information matrix of the variance component phi.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Lopez-Vizcaino, ME, Lombardia, MJ and Morales, D (2013).
Multinomial-based small area estimation of labour force indicators.
Statistical Modelling, 13 ,153-178.
</p>
<p>Schall, R (1991). Estimation in generalized linear models with
random effects. Biometrika,
78,719-727.
</p>


<h3>See Also</h3>

<p><code>data.mme</code>, <code>initial.values</code>,
<code>wmatrix</code>, <code>phi.mult</code>,
<code>prmu</code>, <code>phi.direct</code>,
<code>Fbetaf</code>, <code>ci</code>,
<code>modelfit1</code>, <code>msef</code>,
<code>mseb</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">k=3 #number of categories of the response variable
pp=c(1,1) #vector with the number of auxiliary variables in each category
data(simdata) #data
mod=1 #type of model
datar=data.mme(simdata,k,pp, mod)
initial=datar$initial
mean=prmu(datar$n,datar$Xk,initial$beta.0,initial$u.0)
sigmap=wmatrix(datar$n,mean$estimated.probabilities)

##Fisher information matrix and score vectors
Fisher.phi=sPhikf(pp,sigmap,datar$X,mean$eta,initial$phi.0)
</code></pre>


</div>