<div class="container">

<table style="width: 100%;"><tr>
<td>sPhikf.it</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fisher information matrix and score vectors of the variance components for Model 2</h2>

<h3>Description</h3>

<p>This function computes the Fisher information matrix and the score vectors
of the variance components, for the multinomial mixed model with two independent random effects
for each category of the response variable: one domain random effect and another independent time and domain random effect (Model 2).
These values are used in the fitting algorithm implemented in <code>modelfit2</code> to estimate the random effects. The algorithm adatps the ideas of Schall (1991) to a multivariate
model. The variance components are estimated by the REML method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sPhikf.it(d, t, pp, sigmap, X, eta, phi1, phi2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>number of areas.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>number of time periods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pp</code></td>
<td>
<p>vector with the number of the auxiliary variables per category.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmap</code></td>
<td>
<p>a list with the model variance-covariance matrices for each domain obtained from <code>wmatrix</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>list of matrices with the auxiliary variables obtained from <code>data.mme</code>. The dimension of the list is the number of categories of the response variable minus one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>
<p>matrix with the estimated log-rates of probabilities of each category over the reference category obtained from <code>prmu.time</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi1</code></td>
<td>
<p>vector with the values of the first variance component obtained from <code>modelfit2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi2</code></td>
<td>
<p>vector with the values of the second variance component obtained from <code>modelfit2</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the following components.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>phi score vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>F</code></td>
<td>
<p>Fisher information matrix of the variance components phi1 and phi2.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Lopez-Vizcaino, ME, Lombardia, MJ and Morales, D (2013).
Small area estimation of labour force indicators under a multinomial mixed model
with correlated time and area effects. Submitted for review.
</p>
<p>Schall, R (1991). Estimation in generalized linear models with
random effects. Biometrika,
78,719-727.
</p>


<h3>See Also</h3>

<p><code>data.mme</code>, <code>initial.values</code>,
<code>wmatrix</code>, <code>phi.mult.it</code>,
<code>prmu.time</code>, <code>phi.direct.it</code>,
<code>Fbetaf.it</code>, <code>ci</code>,
<code>modelfit2</code>, <code>msef.it</code>,
<code>mseb</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">k=3 #number of categories of the response variable
pp=c(1,1) #vector with the number of auxiliary variables in each category
mod=2 #Type of model
data(simdata2) #data
datar=data.mme(simdata2,k,pp,mod)
initial=datar$initial
mean=prmu.time(datar$n,datar$Xk,initial$beta.0,initial$u1.0,initial$u2.0)
sigmap=wmatrix(datar$n,mean$estimated.probabilities)

##Fisher information matrix and score vectors
Fisher.phi=sPhikf.it(datar$d,datar$t,pp,sigmap,datar$X,mean$eta,initial$phi1.0,
           initial$phi2.0)
</code></pre>


</div>