<div class="container">

<table style="width: 100%;"><tr>
<td>Fbetaf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Inverse of the Fisher information matrix of the fixed and random effects in Model 1</h2>

<h3>Description</h3>

<p>This function calculates the inverse of the Fisher information
matrix of the fixed effects (beta) and the random effects (u) and the score vectors S.beta and S.u, for the model with
one independent random effect in each category
of the response variable (Model 1). <code>modelfit1</code> uses the output of this function
to estimate the fixed and random effects by the PQL method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Fbetaf(sigmap, X, Z, phi, y, mu, u)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sigmap</code></td>
<td>
<p>a list with the model variance-covariance matrices for each domain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>list of matrices with the auxiliary variables obtained from <code>data.mme</code>. The dimension of the list is the number of categories of the response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>design matrix  of random effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>vector with the values of the variance components obtained from <code>modelfit1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>matrix with the response variable except the reference category. The rows are the domains and the columns are the categories of the
response variable minus one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>matrix with the estimated mean of the response variable obtained from <code>prmu</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>matrix with the values of random effects obtained from <code>modelfit1</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the following components.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>F.beta.beta</code></td>
<td>
<p>the first diagonal element of the inverse of the
Fisher information matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>F.beta.u</code></td>
<td>
<p>the element out of the diagonal of the inverse of the
Fisher information matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>F.u.u</code></td>
<td>
<p>the second diagonal element of the inverse of the Fisher
information matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S.beta</code></td>
<td>
<p>beta scores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S.u</code></td>
<td>
<p>u scores.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Lopez-Vizcaino, ME, Lombardia, MJ and Morales, D (2013).
Multinomial-based small area estimation of labour force indicators.
Statistical Modelling, 13 ,153-178.
</p>


<h3>See Also</h3>

<p><code>data.mme</code>, <code>initial.values</code>,
<code>wmatrix</code>, <code>phi.mult</code>,
<code>prmu</code>, <code>phi.direct</code>,
<code>sPhikf</code>, <code>ci</code>,
<code>modelfit1</code>, <code>msef</code>,
<code>mseb</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">k=3 #number of categories of the response variable
pp=c(1,1) #vector with the number of auxiliary variables in each category
data(simdata) #data
mod=1 #type of model
datar=data.mme(simdata,k,pp,mod)
initial=datar$initial
mean=prmu(datar$n,datar$Xk,initial$beta.0,initial$u.0)
sigmap=wmatrix(datar$n,mean$estimated.probabilities)

#Inverse of the Fisher information matrix
Fisher=Fbetaf(sigmap,datar$X,datar$Z,initial$phi.0,datar$y[,1:(k-1)],
       mean$mean,initial$u.0)
</code></pre>


</div>