<div class="container">

<table style="width: 100%;"><tr>
<td>Fbetaf.ct</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Inverse of the Fisher information matrix of fixed and random effects in Model 3</h2>

<h3>Description</h3>

<p>This function calculates the score vector S and the inverse of the Fisher information
matrix for the fixed (beta) and the random effects (u1, u2) in Model 3. This model has two independet sets of random effects.
The first one contains independent random effects u1dk associated to each category and domain. The second set contains random effects
u2dkt associated to each category, domain and time period. Model 3 assumes that the u2dk are AR(1) correlated across time.
<code>modelfit3</code> uses the output of this function to estimate the fixed and random effect by the PQL method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Fbetaf.ct(sigmap, X, Z, phi1, phi2, y, mu, u1, u2, rho)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sigmap</code></td>
<td>
<p>a list with the model variance-covariance matrices for each domain obtained from <code>wmatrix</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>list of matrices with the auxiliary variables obtained from <code>data.mme</code>. The dimension of the list is the number of categories of the response variable minus one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>design matrix  of random effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi1</code></td>
<td>
<p>vector with the values of the variance components for the first random effects obtained from <code>modelfit3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi2</code></td>
<td>
<p>vector with the values of the variance components for the second random effects obtained from <code>modelfit3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>matrix with the response variable, except the reference category. The rows are the domains and the columns are the categories of the response variable minus one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>matrix with the estimated mean of the response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u1</code></td>
<td>
<p>matrix with the values of the first random effect obtained from <code>modelfit3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u2</code></td>
<td>
<p>matrix with the values of the second random effect obtained from <code>modelfit3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>vector with the values of the correlation parameter obtained from <code>modelfit3</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the following components.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>F</code></td>
<td>
<p>the inverse of the Fisher information matrix of (beta, u1, u2).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>(beta, u1, u2) score vectors</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Lopez-Vizcaino, ME, Lombardia, MJ and Morales, D (2013).
Small area estimation of labour force indicators under a multinomial mixed model
with correlated time and area effects. Submitted for review.
</p>


<h3>See Also</h3>

<p><code>data.mme</code>, <code>initial.values</code>,
<code>wmatrix</code>, <code>phi.mult.ct</code>,
<code>prmu.time</code>, <code>phi.direct.ct</code>,
<code>sPhikf.ct</code>, <code>ci</code>,
<code>modelfit3</code>, <code>msef.ct</code>, <code>omega</code>,
<code>mseb</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">k=3 #number of categories of the response variable
pp=c(1,1) #vector with the number of auxiliary variables in each category
mod=3 #type of model
data(simdata3)
datar=data.mme(simdata3,k,pp,mod)
initial=datar$initial
mean=prmu.time(datar$n,datar$Xk,initial$beta.0,initial$u1.0,initial$u2.0)
sigmap=wmatrix(datar$n,mean$estimated.probabilities) #variance-covariance

##The inverse of the Fisher information matrix and the score matrix
Fisher.beta=Fbetaf.ct(sigmap,datar$X,datar$Z,initial$phi1.0,initial$phi2.0,
         datar$y[,1:(k-1)],mean$mean,initial$u1.0,initial$u2.0,initial$rho.0)
</code></pre>


</div>