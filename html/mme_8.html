<div class="container">

<table style="width: 100%;"><tr>
<td>Fbetaf.it</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The inverse of the Fisher information matrix of the fixed and random effects for Model 2</h2>

<h3>Description</h3>

<p>This function calculates the score vector S and the inverse of the Fisher information
matrix for the fixed (beta) and the random effects (u1, u2) in Model 2. This model has two independet sets of random effects.
The first one contains independent random effects u1dk associated to each category and domain. The second set contains random effects
u2dkt associated to each category, domain and time period. Model 2 assumes that the u2dk are independent across time.
<code>modelfit2</code> uses the output of this function to estimate the fixed and random effect by the PQL method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Fbetaf.it(sigmap, X, Z, phi1, phi2, y, mu, u1, u2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sigmap</code></td>
<td>
<p>a list with the model variance-covariance matrices for each domain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>list of matrices with the auxiliary variables obtained from <code>data.mme</code>. The dimension of the list is the number of categories of the response variable minus one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>design matrix  of random effects obtained from <code>data.mme</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi1</code></td>
<td>
<p>vector with the first variance component obtained from <code>modelfit2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi2</code></td>
<td>
<p>vector with the second variance component obtained from <code>modelfit2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>matrix with the response variable, except the reference category obtained from <code>data.mme</code>. The rows are the domains and the columns are the categories of the response variable minus one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>matrix with the estimated mean of the response variable obtained from <code>prmu.time</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u1</code></td>
<td>
<p>matrix with the values of the first random effect obtained from <code>modelfit2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u2</code></td>
<td>
<p>matrix with the values of the second random effect obtained from <code>modelfit2</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the following components.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>F</code></td>
<td>
<p>the inverse of the Fisher information matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>(beta, u1, u2) scores</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Lopez-Vizcaino, ME, Lombardia, MJ and Morales, D (2013).
Small area estimation of labour force indicator under a multinomial mixed model
with correlated time and area effects. Submitted for review.
</p>


<h3>See Also</h3>

<p><code>data.mme</code>, <code>initial.values</code>,
<code>wmatrix</code>, <code>phi.mult.it</code>,
<code>prmu.time</code>, <code>phi.direct.it</code>,
<code>sPhikf.it</code>, <code>ci</code>,
<code>modelfit2</code>, <code>msef.it</code>,
<code>mseb</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">k=3 #number of categories of the response variable
pp=c(1,1) #vector with the number of auxiliary variables in each category
mod=2  #Type of model
data(simdata2) #data
datar=data.mme(simdata2,k,pp,mod)
initial=datar$initial
mean=prmu.time(datar$n,datar$Xk,initial$beta.0,initial$u1.0,initial$u2.0)
sigmap=wmatrix(datar$n,mean$estimated.probabilities)

##The inverse of the Fisher information matrix of the fixed effects
Fisher=Fbetaf.it(sigmap,datar$X,datar$Z,initial$phi1.0,initial$phi2.0,
       datar$y[,1:(k-1)],mean$mean,initial$u1.0,initial$u2.0)
</code></pre>


</div>