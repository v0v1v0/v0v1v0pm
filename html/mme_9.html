<div class="container">

<table style="width: 100%;"><tr>
<td>initial.values</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Initial values for fitting algorithm to estimate the fixed and random effects and the variance components</h2>

<h3>Description</h3>

<p>This function sets the initial values. An iterative algorithm fits the multinomial mixed models
that requires initial values for the fixed effects, the random
effects and the variance components. This initial values are used in <code>modelfit1</code>,
<code>modelfit2</code> and <code>modelfit3</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">initial.values(d, pp, datar, mod)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>number of areas.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pp</code></td>
<td>
<p>vector with the number of auxiliary variables per category.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datar</code></td>
<td>
<p>output of function <code>data.mme</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mod</code></td>
<td>
<p>a number specifying the type of model: 1=multinomial mixed model with one independent random effect for each category of the response variable
(Model 1), 2=multinomial mixed model with two independent random effects for each category of the response variable: one domain random effect and another independent time and domain random effect (Model 2) and
3= multinomial mixed model with two independent random effects for each category of the response variable: one domain random effect and another correlated time and domain random effect (Model 3).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the following components, depending on the chosen model.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>beta.0</code></td>
<td>
<p>a list with the initial values for the fixed effects beta per category.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi.0</code></td>
<td>
<p>vector with the initial values for the variance components phi of Model 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi1.0</code></td>
<td>
<p>vector with the initial values for the variance components phi1 of Model 2 or 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi2.0</code></td>
<td>
<p>vector with the initial values for the variance components phi2 of Model 2 or 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>matrix with the initial values for the random effect for Model 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u1.0</code></td>
<td>
<p>matrix with the initial values for the first random effect for Model 2 or 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u2.0</code></td>
<td>
<p>matrix with the initial values for the second random effect for Model 2 or 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho.0</code></td>
<td>
<p>vector with the initial values for the correlation parameter for Model 3.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Lopez-Vizcaino, ME, Lombardia, MJ and Morales, D (2013).
Multinomial-based small area estimation of labour force indicators.
Statistical Modelling, 13, 153-178.
</p>
<p>Lopez-Vizcaino, ME, Lombardia, MJ and Morales, D (2013). Small area estimation of labour force indicators under a multinomial mixed model
with correlated time and area effects. Submitted for review.
</p>


<h3>See Also</h3>

<p><code>data.mme</code>, <code>wmatrix</code>,
<code>phi.mult.it</code>, <code>prmu.time</code>,
<code>Fbetaf.it</code>, <code>phi.direct.it</code>,
<code>sPhikf.it</code>, <code>ci</code>,
<code>modelfit2</code>, <code>msef.it</code>,
<code>mseb</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">k=3 #number of categories of the response variable
pp=c(1,1) #vector with the number of auxiliary variables in each category
data(simdata)
D=nrow(simdata)
mod=1 #Type of model
datar=data.mme(simdata,k,pp,mod)

## Initial values for fixed, random effects and variance components
initial=datar$initial
</code></pre>


</div>