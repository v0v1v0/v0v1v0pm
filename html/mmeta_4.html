<div class="container">

<table style="width: 100%;"><tr>
<td>MultipleTables.modelFit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Exact posterior inference based on multiple 2x2 tables.</h2>

<h3>Description</h3>

<p>This function conducts exact posterior inference based on the object created by <code>MultipleTables.create</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MultipleTables.modelFit(
  multiple_tables_object,
  method = "exact",
  verbose = FALSE,
  control = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>multiple_tables_object</code></td>
<td>
<p>The object created by <code>MultipleTables.create</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string specifying the method. Options are <code>exact</code>
and <code>sampling</code>. <code>exact</code> (default) is a method based on Monte Carlo sampling. <code>exact</code> is exact method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>a logical value; if TRUE, the detailed summary messages are displayed, else FALSE (default) the messages are omitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list can be specified to control the fitting process. Options are stated in details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>control list can be specified to control the fitting process:
</p>

<ul>
<li> <p><code>n_samples</code>:  number of posterior samples; Defualt is 5000.
</p>
</li>
<li> <p><code>mcmc_initial</code>:  initial values for (p1, p2) in MCMC; Default is c(0.5, 0.5).
</p>
</li>
<li> <p><code>upper_bound</code>:  upper bound for the measure. Default is 100.
</p>
</li>
<li> <p><code>lower_bound</code>: lower bound for the measure. For RD, default is -1. For RR/OR, defualt is 0.
</p>
</li>
<li> <p><code>num_grids</code>:  number of grids to calculate density; The defualt is 20498.
</p>
</li>
<li> <p><code>optim_method</code>: optimazation method. Default is “L-BFGS-B”. Please refer to ‘optim’ function.
</p>
</li>
<li> <p><code>maxit</code>: maximum number of iterations for iteration. Default is 1000. Please refer to ‘optim’ function.
</p>
</li>
<li> <p><code>initial_values</code>: initial value for optimization.
The default approach is to fit beta-bin model to generate initial values via <code>aod</code> package.
</p>
</li>
</ul>
<p>There are two kinds of study design, i.e., prospective study or
clinical trial, and retrospective or case-control study. In a
prospective study or clinical trial, <code>data</code> is a data frame that contains <code>y1</code>, <code>n1</code>, <code>y2</code>, <code>n2</code>,
<code>studynames</code>. <code>y1</code> is the number of subjects
experienced a certain event in the unexposed group. <code>n1</code> is the number
of subjects in the unexposed group. <code>y2</code> is the number of subjects experienced
a certain event in the exposed group. <code>n2</code> is the number of
subjects in the exposed group. In this study, <code>OR</code> is odds ratio
of event comparing exposed group with unexposed group. <code>RR</code>
is relative risk of event comparing exposed group with unexposed group. <code>RD</code> is risk
difference of event comparing exposed group with unexposed group.
</p>
<p>For case-control study, <code>y1</code> is the number of subjects with
exposure in the control group. <code>n1</code> is the number of
subjects in the control group. <code>y2</code> is the number of
subjects with exposure in the case group. <code>n2</code> is the
number of subjects in the case group. In this study, <code>OR</code> is odds ratio
of event comparing case group with control group. <code>RR</code> is
relative risk of event comparing case group with control group. <code>RD</code> is risk
difference of event comparing case group with control group.
</p>
<p>Empirical Bayes method is used to maximize the marginal likelihood
combining all studies to obtained the estimates of the
hyperparameters a1, b1, a2, b2, and rho. When
<code>method="independent"</code>, only the estimated hyperparameters
of a1, b1, a2, and b2 are used. When <code>model="Sarmanov"</code>,
<code>rho</code> is subject to constraints. See Chen et al (2011) for
details.
</p>
<p>The output <code>cov.matrix</code> and <code>hessian</code> are the estimated
covariance matrix and hessian matrix of the estimated
parameters in the transformed scales. The estimated parameters
are log(a1), log(b1), log(a2), log(b2), omega, where the
correlation coefficient rho is a function of a1, b1, a2, b2, and
omega. Please see details on page 7 of Chen et al (2012 b).
</p>


<h3>Value</h3>

<p>An object inheriting from class <code>MultipleTables</code> is returned. Objects of this class including the following non-null values:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>measure</code></td>
<td>
<p>the value of <code>measure</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>the value of <code>model</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data matrix with rows being <code>y1</code>, <code>n1</code>, <code>y2</code>, and <code>n2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the value of <code>method</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>study_names</code></td>
<td>
<p>a character string indicating all the study names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chi2_value</code></td>
<td>
<p>the chi-square test statistics of the likelihood ratio test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_value</code></td>
<td>
<p>the p-value of the likelihood ratio test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior_mle</code></td>
<td>
<p>a numeric vector of the estimated hyperparameters in the
following order: <code>a1</code>, <code>b1</code>, <code>a2</code>, <code>b2</code>, <code>rho</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov_matrix_log</code></td>
<td>
<p>the estimated covariance matrix of the estimated parameters in the transformed scales.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessian_log</code></td>
<td>
<p>the estimated hessian matrix of the estimated parameters in the transformed scales.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samples</code></td>
<td>
<p>a list of samples for the posterior and prior distributions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density</code></td>
<td>
<p>a list of the density of the posterior and prior distributions.</p>
</td>
</tr>
</table>
<p>These values are essential for generic functions: <code>MultipleTables.summary</code> and <code>MultipleTables.plot</code>.
</p>


<h3>References</h3>

<p>Luo, S., Chen, Y., Su, X., Chu, H., (2014). mmeta: An R Package for
Multivariate Meta-Analysis. <br><em>Journal of Statistical Software</em>, 56(11), 1-26. <br>
&lt;https://dukespace.lib.duke.edu/dspace/bitstream/handle/10161/15522/2014Luo_Chen_Su_Chu_JSS_mmeta.pdf?sequence=1&gt; <br>
Chen, Y., Luo, S., (2011a). A Few Remarks on "Statistical Distribution of the Difference of
Two Proportions' by Nadarajah and Kotz, Statistics in Medicine 2007; 26(18):3518-3523". <br><em>Statistics in Medicine, 30(15)</em>, 1913-1915. <br>
&lt;doi:10.1002/sim.4248&gt; <br>
Chen, Y., Chu, H., Luo, S., Nie, L., and Chen, S. (2014a). Bayesian
analysis on meta-analysis of case-control studies accounting for
within-study correlation. <br><em>Statistical Methods in Medical Research</em>, 4.6 (2015): 836-855. <br>
&lt;https://doi.org/10.1177/0962280211430889&gt;. <br>
Chen, Y., Luo, S., Chu, H., Su, X., and Nie, L. (2014b). An empirical
Bayes method for multivariate meta-analysis with an application in
clinical trials. <br><em>Communication in Statistics: Theory and Methods</em>, 43.16 (2014): 3536-3551. <br>
&lt;https://doi.org/10.1080/03610926.2012.700379&gt;. <br>
Chen, Y., Luo, S., Chu, H., Wei, P. (2013). Bayesian inference on risk
differences: an application to multivariate meta-analysis of adverse
events in clinical trials. <br><em>Statistics in Biopharmaceutical Research</em>, 5(2), 142-155. <br>
&lt;https://doi.org/10.1080/19466315.2013.791483&gt;. <br></p>


<h3>See Also</h3>

<p><code>MultipleTables.create</code>, <code>MultipleTables.summary</code>, and <code>MultipleTables.plot</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
 library(mmeta)
 library(ggplot2)
 ## Analyze the dataset colorectal to conduct exact inference of the odds ratios
 data(colorectal)
 colorectal['study_name'] &lt;- colorectal['studynames']
 # ########################## If exact method is used ############################
 ## Create object multiple_tables_obj_exact
 multiple_tables_obj_exact &lt;- MultipleTables.create(data=colorectal,
 measure='OR', model= 'Sarmanov')
 ## Model fit default
 multiple_tables_obj_exact &lt;- MultipleTables.modelFit(
 multiple_tables_obj_exact, method = 'exact')
 ## Options for Control; If set number of posterior samples is 5000
 multiple_tables_obj_exact &lt;- MultipleTables.modelFit(multiple_tables_obj_exact, method = 'exact',
 control = list(n_samples = 3000))
 ## If set intial values correspoinding to c(a1, b1, a2, b2, rho) as c(1,1,1,1,0):
 multiple_tables_obj_exact &lt;- MultipleTables.modelFit(multiple_tables_obj_exact, method = 'exact',
 control = list(initial_values = c(1,1,1,1,0)))
 ## If maximum number of iterations for iteration is 100
 multiple_tables_obj_exact &lt;- MultipleTables.modelFit(multiple_tables_obj_exact, method = 'exact',
 control = list(maxit = 100))
 ## If maximum number of iterations for iteration is 100 and number of posterior samples as 3000
 multiple_tables_obj_exact &lt;- MultipleTables.modelFit(multiple_tables_obj_exact, method = 'exact',
 control = list(maxit = 100, nsamples = 3000))
 # ########################## If sampling method is used ############################
 multiple_tables_obj_sampling &lt;- MultipleTables.create(data=colorectal,
 measure='OR', model= 'Sarmanov')
 multiple_tables_obj_sampling &lt;- MultipleTables.modelFit(
 multiple_tables_obj_sampling, method = 'sampling')
 ## The options of \code{control} list specifying the fitting process are similar
 ## to the codes shown above.


</code></pre>


</div>