<div class="container">

<table style="width: 100%;"><tr>
<td>SingleTable.modelFit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Exact posterior inference based on a single 2x2 table</h2>

<h3>Description</h3>

<p>This function conducts exact posterior inference based on the object created by <code>SingleTable.create</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SingleTable.modelFit(
  single_table_Obj,
  method = "exact",
  verbose = TRUE,
  control = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>single_table_Obj</code></td>
<td>
<p>The object created by <code>SingleTable.create</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string specifying the method. Options are <code>exact</code>
and <code>sampling</code>. <code>exact</code> (default) is a method based on Monte Carlo sampling. <code>exact</code> is exact method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>a logical value; if TRUE(default), the detailed summary messages are displayed, else the messages are omitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list can be specified to control the fitting process. Options are stated in details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>control list can be specified to control the fitting process:
</p>

<ul>
<li> <p><code>n_samples</code>:  number of posterior samples; Defualt is 5000.
</p>
</li>
<li> <p><code>mcmc_initial</code>:  initial values for (p1, p2) in MCMC; Default is c(0.5, 0.5).
</p>
</li>
<li> <p><code>upper_bound</code>:  upper bound for the measure. Default is 100.
</p>
</li>
<li> <p><code>lower_bound</code>: lower bound for the measure. For RD, default is -1. For RR/OR, defualt is 0.
</p>
</li>
<li> <p><code>num_grids</code>:  number of grids to calculate density; The defualt is 20498.
</p>
</li>
</ul>
<h3>Value</h3>

<p>An object of <code>singletable</code> class is returned including the following non-null values:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>measure</code></td>
<td>
<p>the value of <code>measure</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>the value of <code>model</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a numeric vector of input data with components: <code>y1</code>, <code>n1</code>, <code>y2</code>, <code>n2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter</code></td>
<td>
<p>a numeric vector of the hyperparameters: <code>a1</code>, <code>b1</code>, <code>a2</code>, <code>b2</code>, and <code>rho</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the value of <code>method</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample</code></td>
<td>
<p>a list of samples for the posterior and prior distributions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density</code></td>
<td>
<p>a list of the density of the posterior and prior distributions.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>SingleTable.summary</code>, <code>SingleTable.plot</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Assume we have a 2x2 table:{{40,56},{49,60}} and set prior parameters as a1=b1=a2=b2=rho=0.5.
 
 library(mmeta)
 library(ggplot2)
 # ########################## If sampling method is used ############################
 ## Create object \code{single_table_obj_samling}
 single_table_obj_samling &lt;- SingleTable.create(a1=0.5,b1=0.5,
 a2=0.5,b2=0.5,rho=0.5, y1=40, n1=96, y2=49, n2=109,model="Sarmanov",measure="OR")
 ## model fit
 single_table_obj_samling &lt;- SingleTable.modelFit(single_table_obj_samling,
 method = 'sampling')
 ## Control list option examples
 ## set number of posterior samples as 3000 (default is 5000)
 single_table_obj_samling &lt;- SingleTable.modelFit(single_table_obj_samling,
 method = 'sampling', control = list(n_sample = 3000))
 ## set initial values for MCMC is c(0.2, 0,4) (default is c(0.5,0.5))
 single_table_obj_samling &lt;- SingleTable.modelFit(single_table_obj_samling,
 method = 'sampling', control = list(mcmc_initial = c(0.2,0.4)))
 ## set upper bound for the measure is 20( default is 100)
 single_table_obj_samling &lt;- SingleTable.modelFit(single_table_obj_samling,
 method = 'sampling', control = list(upper_bound = 20))
 # ########################### If exact method is used ##############################
 ## Create object \code{single_table_obj_exact}
 single_table_obj_exact &lt;- SingleTable.create(a1=0.5, b1=0.5, a2=0.5, b2=0.5,
 rho=0.5, y1=40, n1=96, y2=49, n2=109, model="Sarmanov",measure="OR")
 ## model fit
 single_table_obj_exact &lt;- SingleTable.modelFit(single_table_obj_exact, method = 'exact')
 ## The options of \code{control} list specifying the fitting process are similar
 ## to the codes shown above.
 
</code></pre>


</div>