<div class="container">

<table style="width: 100%;"><tr>
<td>mmmgee.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Hypothesis Tests for Linear Contrasts in Multiple Marginal GEE Models</h2>

<h3>Description</h3>

<p>Global hypothesis tests, multiple testing procedures and simultaneous confidence intervals for multiple linear contrasts of regression
coefficients in a single generalized estimating equation (GEE) model or across multiple GEE models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mmmgee.test(x, L, r = NULL, statistic = c("wald", "score"),
  type = c("maximum", "quadratic"), asymptotic = TRUE,
  biascorr = FALSE, closed.test = FALSE, conf.int = FALSE,
  conf.level = 0.95, alternative = c("undirected", "greater", "less"),
  denomDF = NULL, scaled.F = FALSE, maxit = 20, tol = 10^(-8), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a <code>geem2</code> object fitted with <code>geem2</code> or a list of <code>geem2</code>. In the latter case, the <code>geem2</code> objects must be different
models calculated with data from the same subjects. In particular, the parameter <code>id</code> in the call to <code>geem2</code> must refer to the same subjects in each model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>a contrast matrix defining a contrast for the stacked vector of regression coefficients of the marginal models, or a list of contrast matrices.
In the latter case, the list must contain one matrix for each model listed in <code>x</code>, in the same order as the models. When using the the score test 
and <code>x</code> is a list, <code>L</code> must be a list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>right hand side vector of the null hypothesis or a list of vectors resembling the right hand side of the null hypothesis. If not specified, <code>r</code> is assumed to be a null vector 
of appropriate length. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>either <code>"wald"</code> or <code>"score"</code>, see details. The default is <code>"wald"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>either <code>"maximum"</code> or <code>"quadratic"</code>, see details. The default is <code>"maximum"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asymptotic</code></td>
<td>
<p>logical, if <code>TRUE</code> the reference distribution for the maximum-type Wald test statistic is a multivariate normal distribution and the reference distribution for 
the quadratic form Wald test statistic is a chi-squared distribution. If <code>FALSE</code>, a multivariate t-distribution or an F-distribution is used instead.
Ignored for the Score test, see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>biascorr</code></td>
<td>
<p>logical indicating whether the Mancl and DeRouen Bias correction should be used when estimating the joint covariance matrix via <code>mmmgee</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>closed.test</code></td>
<td>
<p>logical, if <code>TRUE</code>, multiplicity adjusted p-values based on a closed test procedure using the selected type of test are calculated. With <code class="reqn">k</code> hypotheses this 
involves the computation of <code class="reqn">2^k</code> tests, which may require considerable computation time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.int</code></td>
<td>
<p>logical. If <code>TRUE</code> simultaneous confidence intervals corresponding to a single step maximum-type test are calculated using a multivariate
normal or t approximation, depending on <code>asymptotic</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>the nominal simultaneous coverage probability of the confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>one of <code>"undirected"</code>, <code>"greater"</code>, or <code>"less"</code>. Determines the direction of maximum-type tests and of confidence intervals.
The default is <code>"undirected"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>denomDF</code></td>
<td>
<p>Defaults to <code>NULL</code>. In that case, denominator degrees of freedom for the multavariate t-distribution or F-distribution are calculated as <code>min(n-p)</code>,
where <code>n</code> and <code>p</code> are vectors of the number of independent clusters and the number of regression coefficients in the models in <code>x</code>.
Alternatively, a numeric value may be entered to be used as denominator degrees of freedom.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaled.F</code></td>
<td>
<p>logical. If <code>TRUE</code> and <code>type="quadratic"</code> and <code>asymptotic=FALSE</code> a scaled F distribution similar as for Hotelling's test is used. Ignored otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>maximal number of iterations to be passed to <code>geem2</code>. Only required when using the score test, where the models are refitted under the
restriction of the null hyptothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>tolerance limit for the convergence criterion to be passed to <code>geem2</code>. Only required when using the score test, where the models are refitted under the
restriction of the null hyptothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments that are passed to <code>pmvnorm</code>, <code>qmvnorm</code>, <code>pmvt</code> and <code>qmvt</code>.
In particular the algorithm to solve the multivariate normal or t-distribution integrals may be selected.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The null hypothesis is <code class="reqn">H0:L\beta=r</code> where <code>L</code> is a contrast matrix, <code class="reqn">\beta</code>
the stacked vector of regression coefficients rom the marginal models and <code>r</code> a real values right hand side vector.
<code>L</code> can be specified as matrix or, if it is a block diagonal matrix with each block corresponding to 
a contrast for one marginal GEE model, as list of the matrices on the diagonal. The right hand side <code>r</code> can be speficied as vector or as list of 
vectors each corresponding to the part of the right hand side vector for one model.
</p>
<p>When choosing <code>statistic="wald"</code> and <code>type="maximum"</code>, the maximum of the standardized entries of <code class="reqn">L\hat{\beta}</code> is used as test statistic and the
p-value is calculated from a multivariate normal or t-distribution (depending on <code>asymptotic</code> being <code>TRUE</code> or <code>FALSE</code>) with correlation matrix
estimated for <code class="reqn">L\hat{\beta}</code>. For the t-distribution, denominator degrees of freedom are used as specified in <code>denomDF</code>.
When choosing <code>statistic="wald"</code> and <code>type="quadratic"</code>, a quadratic form of <code class="reqn">L\hat{\beta}</code> and the inverse of the estimated covariance matrix
of <code class="reqn">L\hat{\beta}</code> is used as test statistic and the p-value is calculated from a 
chi-squared distribution or an F-distribution (depending on <code>asymptotic</code> being <code>TRUE</code> or <code>FALSE</code>).
</p>
<p>With <code>statistic="score"</code>, generalized score tests are calculated by replacing <code class="reqn">L\hat{\beta}</code> by the first order approximation <code class="reqn">LAU</code> where <code class="reqn">U</code>
is the stacked estimating equation (the score) and <code class="reqn">A</code> is the negative inverse of the matrix
of first derivatives of <code class="reqn">U</code>, both evaluated at the location of constrained estimates for <code class="reqn">\beta</code> under the null hypothesis. 
Analogous to the Wald statistic, a maximum-type and a quadratic form score test are available. For the score test the option <code>asymptotic</code> is ignored
and the reference distribution is multivariate normal or chi-squared.
</p>


<h3>Value</h3>

<p>A list with class <code>mmmgeetest</code> containing the following components, if required:
</p>

<dl>
<dt><code>test</code></dt>
<dd>
<p>Contains a data frame with the test statistic, degrees of freedom (depending in the type of test) and the p-value. If closed test was required,
a further data frame is reported with estimates, right hand side vector, unadjusted p-values and adjusted p-values for each line of <code class="reqn">H0:L\beta-r=0</code>.</p>
</dd>
<dt><code>hypothesis</code></dt>
<dd>
<p>A list containing the contrast matrix <code class="reqn">L</code> and the right hand side vector <code class="reqn">r</code>.</p>
</dd>
<dt><code>conf.int</code></dt>
<dd>
<p>The simultaneous confidence intervals.</p>
</dd>
<dt><code>denomDF</code></dt>
<dd>
<p>The type and value of the denominator degrees of freedom used in the procedure.</p>
</dd>
<dt><code>mmmgee</code></dt>
<dd>
<p>The <code>mmmgee</code> object containing in particular the estimated covariance matrix for the coefficents of the models in <code>x</code>. See <code>mmmgee</code>.</p>
</dd>
</dl>
<h3>Note</h3>

<p>A single value for the denominator degrees of freedom is calculated for the covariance matrix estimate across all contrasts. In the closed testing procedure,
this value is used for the degrees of freedom
associated with the covariance matrix of any subset of contrasts.
</p>
<p>Usual linear models or generalized linear models can be regarded as special case of GEE models and can be included in the analysis framework.
Note however that <code>mmmgee.test</code> always uses the robust sandwich covariance matrix estimate, even if the calculation of the sandwich covariance was suppressed
in the model objects in <code>x</code>.
</p>


<h3>Author(s)</h3>

<p>Robin Ristl, <a href="mailto:robin.ristl@meduniwien.ac.at">robin.ristl@meduniwien.ac.at</a>
</p>


<h3>References</h3>

<p>Dennis D. Boos. On generalized score tests. The American Statistician, 1992, 46(4):327-333.
</p>
<p>Lloyd A. Mancl, Timothy A. DeRouen. A covariance estimator for GEE with improved small sample properties. Biometrics, 2001, 57(1):126-134.
</p>


<h3>See Also</h3>

<p><code>geem2</code>, <code>mmmgee</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(keratosis)
m1&lt;-geem2(clearance~trt,id=id,data=keratosis,family=binomial,corstr="independence")
m2&lt;-geem2(pain~trt,id=id,data=keratosis[keratosis$lesion==1,],family=gaussian,corstr="independence")
L1&lt;-L2&lt;-diag(1,4)[-1,]
mmmgee.test(x=m1,L=list(L1),statistic="wald",type="maximum")
mmmgee.test(x=m1,L=list(L1),statistic="score",type="maximum")
mmmgee.test(x=list(m1,m2),L=list(L1,L2),type="maximum",asymptotic=FALSE,biascorr=TRUE)
mmmgee.test(x=list(m1,m2),L=list(L1,L2),type="maximum",closed.test=TRUE)
mmmgee.test(x=list(m1,m2),L=list(L1,L2),type="maximum",asymptotic=FALSE,
	alternative="less",conf.int=TRUE,denomDF=40)
mmmgee.test(x=list(m1,m2),L=list(L1,L2),type="quadratic",asymptotic=TRUE)
mmmgee.test(x=list(m1,m2),L=list(L1,L2),statistic="score",type="quadratic")
mmmgee.test(x=list(m1,m2),L=list(L1,L2),statistic="score",type="maximum")
#
## Not run: 
data(datasim)
mod1&lt;-geem2(Y.lin~gr.lang+x1,id=id,data=datasim,family="gaussian",corstr="exchangeable")
mod2&lt;-geem2(Y.poi~gr.lang+x2,id=id,data=datasim,family="poisson",corstr="exchangeable")
mod3&lt;-geem2(Y.bin~gr.lang+x3,id=id,data=datasim,family="binomial",corstr="exchangeable")
Li&lt;-matrix(c(0,1,0),nrow=1)
mmmgee.test(list(mod1,mod2,mod3),L=list(Li,Li,Li),statistic="Wald",type="maximum",
	biascorr=TRUE,asymptotic=FALSE,closed.test=TRUE)
mmmgee.test(list(mod1,mod2,mod3),L=list(Li,Li,Li),statistic="score",closed.test=TRUE)

## End(Not run)

</code></pre>


</div>