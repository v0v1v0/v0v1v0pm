<div class="container">

<table style="width: 100%;"><tr>
<td>fmetric</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute Filter-based Metrics in a Functional Space Between Marked Point Processes</h2>

<h3>Description</h3>

<p>The most commonly used and intensively studied metrics for spike trains, which is based on the continuation of event sequence to a real valued continuous function using a smoother function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fmetric(S1, S2, measure = "sim", h = "laplacian", tau = 1, M = NULL,
  abs.tol = .Machine$double.eps^0.25)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>S1</code></td>
<td>
<p>marked point process data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S2</code></td>
<td>
<p>marked point process data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>measure</code></td>
<td>
<p><code>"sim"</code> for similarity and <code>"dist"</code> for distance. Default <code>"sim"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>filtering function. Default <code>"laplacian"</code> offers significant computational advantage. A function can be specified here like
<code>h=function(x,tau) exp(-x^2/tau)</code>.
The function should be square integrable and non-negative (not checked in the code).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>parameter for filtering function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>a precision matrix for filter of marks, i.e., exp( - r' M r) is used for filtering marks. It should be symmetric and positive semi-definite.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abs.tol</code></td>
<td>
<p>absolute tolerance for numerical integration.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>fmetric</code> computes filter-based measure between MPP realizations. Discrete event timings are transformed into a continuous function by using a kernel smoother, and usual l2 inner product is adopted for defining the similarity between two point process realizations.
</p>


<h3>Value</h3>

<p>Similarity or distance between two inputs (marked) point process S1 and S2.
</p>


<h3>Author(s)</h3>

<p>Hideitsu Hino <a href="mailto:hinohide@cs.tsukuba.ac.jp">hinohide@cs.tsukuba.ac.jp</a>, Ken Takano, Yuki Yoshikawa, and Noboru Murata
</p>


<h3>References</h3>

<p>M. C. W. van Rossum. A Novel Spike Distance. Neural Computation, Vol. 13(4), pp. 751-763, 2001.
</p>
<p>S. Schreiber, J.M. Fellous, P.H. Tiesinga, and T.J. Sejnowski. A new correlation-based measure of spike timing reliability, Neurocomputing, Vols. 52-54, pp. 925-931, 2003.
</p>


<h3>Examples</h3>

<pre><code class="language-R">##The aftershock data of 26th July 2003 earthquake of M6.2 at the northern Miyagi-Ken Japan.
data(Miyagi20030626)
## time longitude latitude depth magnitude
## split events by 7-hour
sMiyagi &lt;- splitMPP(Miyagi20030626,h=60*60*7,scaleMarks=TRUE)$S
N &lt;- 10
tau &lt;- 0.1
sMat &lt;- matrix(0,N,N)
  cat("calculating fmetric with tau ",tau,"...")
 for(i in 1:(N)){
   cat(i," ")
   for(j in i:N){
     S1 &lt;- sMiyagi[[i]]$time;S2 &lt;- sMiyagi[[j]]$time
    sMat[i,j] &lt;- fmetric(S1,S2,tau=tau,M=diag(1,4))
   }
 }
 sMat &lt;- sMat+t(sMat)
 tmpd &lt;- diag(sMat) &lt;- diag(sMat)/2
 sMat &lt;- sMat/sqrt(outer(tmpd,tmpd))
image(sMat)
</code></pre>


</div>