<div class="container">

<table style="width: 100%;"><tr>
<td>ieimetric</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute Inter Event Interval-based Metric Between Marked Point Processes</h2>

<h3>Description</h3>

<p>This metric considers inter event interval for point processes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ieimetric(S1, S2, measure = "sim", M = NULL, window.length = NULL,
  variant = "spike", abs.tol = .Machine$double.eps^0.25)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>S1</code></td>
<td>
<p>marked point process data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S2</code></td>
<td>
<p>marked point process data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>measure</code></td>
<td>
<p><code>"sim"</code> for similarity and <code>"dist"</code> for distance. Default <code>"sim"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>a precision matrix for filter of marks, i.e., exp( - r' M r) is used for filtering marks. It should be symmetric and positive semi-definite.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window.length</code></td>
<td>
<p>width of the window used for splitting the original MPP.<br>
If not provided, <code>max(max(S1$time,S2$time) - min(S1$time,S2$time))</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variant</code></td>
<td>
<p>choose from two variants "spike-weighted" or "time-weighted".<br> Default <code>"spike"</code>, which is computationally efficient than <code>"time"</code>. See the reference for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abs.tol</code></td>
<td>
<p>absolute tolerance for numerical integration.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>iei</code> computes inter event interval-based measure between MPP realizations. iei for simple point process does not have any tuning parameter, which can be a desirable property for data analysis. However, it's computational cost is relatively higher than other metrics.
</p>


<h3>Value</h3>

<p>Similarity or distance between two inputs (marked) point process S1 and S2.
</p>


<h3>Author(s)</h3>

<p>Hideitsu Hino <a href="mailto:hinohide@cs.tsukuba.ac.jp">hinohide@cs.tsukuba.ac.jp</a>, Ken Takano, Yuki Yoshikawa, and Noboru Murata
</p>


<h3>References</h3>

<p>T. Kreuz, J.S. Haas, A. Morelli, H.D.I. Abarbanel, and A. Politi. Measuring spike train synchrony, Journal of Neuroscience Methods, Vol. 165(1), pp. 151-161, 2007.
</p>


<h3>Examples</h3>

<pre><code class="language-R">##The aftershock data of 26th July 2003 earthquake of M6.2 at the northern Miyagi-Ken Japan.
data(Miyagi20030626)
## time longitude latitude depth magnitude
## split events by 7-hour
sMiyagi &lt;- splitMPP(Miyagi20030626,h=60*60*7,scaleMarks=TRUE)$S
N &lt;- 5
sMat &lt;- matrix(0,N,N)
  cat("calculating intensity inner product...")
 for(i in 1:(N)){
   cat(i," ")
   for(j in i:N){
     S1 &lt;- sMiyagi[[i]]$time;S2 &lt;- sMiyagi[[j]]$time
    sMat[i,j] &lt;- ieimetric(S1,S2,M=diag(1,4))
   }
 }
 sMat &lt;- sMat+t(sMat)
 tmpd &lt;- diag(sMat) &lt;- diag(sMat)/2
 sMat &lt;- sMat/sqrt(outer(tmpd,tmpd))
image(sMat)
</code></pre>


</div>