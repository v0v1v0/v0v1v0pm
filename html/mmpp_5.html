<div class="container">

<table style="width: 100%;"><tr>
<td>iipmetric</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute Intensity Inner Product Metrics</h2>

<h3>Description</h3>

<p>For the analysis of point process, intensity function plays a central roll. Paiva et al. (2009) proposed to use the intensity function for defining the inner product between point process realizations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">iipmetric(S1, S2, measure = "sim", tau = 1, M = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>S1</code></td>
<td>
<p>marked point process data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S2</code></td>
<td>
<p>marked point process data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>measure</code></td>
<td>
<p><code>"sim"</code> for similarity and <code>"dist"</code> for distance. Default <code>"sim"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>a parameter for filtering function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>a precision matrix for filter of marks, i.e., exp( - r' M r) is used for filtering marks. It should be symmetric and positive semi-definite.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>iipmetric</code> computes intensity inner product metric. Intensity function for the point process realization is estimated by kernel density estimator. This function adopts Gaussian kernels for the sake of computational efficiency.
</p>


<h3>Value</h3>

<p>Similarity or distance between two inputs (marked) point process S1 and S2.
</p>


<h3>Author(s)</h3>

<p>Hideitsu Hino <a href="mailto:hinohide@cs.tsukuba.ac.jp">hinohide@cs.tsukuba.ac.jp</a>, Ken Takano, Yuki Yoshikawa, and Noboru Murata
</p>


<h3>References</h3>

<p>A.R.C. Paiva, I. Park, and J.C. Principe. A reproducing kernel Hilbert space framework for spike train signal processing, Neural Computation, Vol. 21(2), pp. 424-449, 2009.
</p>


<h3>Examples</h3>

<pre><code class="language-R">##The aftershock data of 26th July 2003 earthquake of M6.2 at the northern Miyagi-Ken Japan.
data(Miyagi20030626)
## time longitude latitude depth magnitude
## split events by 7-hour
sMiyagi &lt;- splitMPP(Miyagi20030626,h=60*60*7,scaleMarks=TRUE)$S
N &lt;- 10
tau &lt;- 0.1
sMat &lt;- matrix(0,N,N)
  cat("calculating intensity inner product...")
 for(i in 1:(N)){
   cat(i," ")
   for(j in i:N){
     S1 &lt;- sMiyagi[[i]]$time;S2 &lt;- sMiyagi[[j]]$time
    sMat[i,j] &lt;- iipmetric(S1,S2,tau=tau,M=diag(1,4))
   }
 }
 sMat &lt;- sMat+t(sMat)
 tmpd &lt;- diag(sMat) &lt;- diag(sMat)/2
 sMat &lt;- sMat/sqrt(outer(tmpd,tmpd))
image(sMat)
</code></pre>


</div>