<div class="container">

<table style="width: 100%;"><tr>
<td>k2d</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Convert Kernel Matrix to Distance Matrix</h2>

<h3>Description</h3>

<p><code>k2d</code> provides various methods for converting kernel matrix to distance matrix and vice versa.
</p>


<h3>Usage</h3>

<pre><code class="language-R">k2d(Mat, direction = "k2d", method = "norm", scale = 1, pos = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Mat</code></td>
<td>
<p>matrix, either kernel matrix or distance matrix to be converted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>direction</code></td>
<td>
<p>a character string "k2d" or "d2k". The latter interpret the Mat as a distance matrix and convert it to a kernel matrix. Default "k2d".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string to specify how the matrix is converted. "Default "norm".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>a numeric parameter used to scale the matrix. Typically used in exp( - d(x,y)/scale).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos</code></td>
<td>
<p>logical. If <code>TRUE</code> when <code>direction="d2k"</code>, negative eigenvalues are round to zero to obtain positive semidefinite kernel matrix. Default <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>There are various ways to convert kernel function values to distance between two points.
Normal-distance (when <code>method="norm"</code>) means a conversion
d_ND(x,y) = sqrt k(x,x) - 2k(x,y) + k(y,y).
</p>
<p>Cauchy-Schwarz-type conversion (<code>method="CS"</code>) is more principled way:
d_CS(x,y) = arccos k^2(x,y)/k(x,x)k(y,y).
</p>
<p>Other two simple ways are
d_exp(x,y) = exp(- k(x,y)/scale),
which is an exponential-type distance (<code>method="exp"</code>), and
d_n(x,y) = 1 - k(x,y)/sqrt k(x,x)k(y,y),
which we call naive (<code>method="naive"</code>).
</p>
<p>For converting distance to kernel (<code>direction="d2k"</code>), it should be noted that we usually have distance between pairs of points only, and distances from "origin" are unknown.
Double-centering (<code>method="DC"</code>) is the most popular and simple way to convert distance to kernel. However, it does not make positive definite kernel in general,
and it sometimes require post-processing, e.g., cutting off negative eigenvalues (<code>pos=TRUE</code>).
Another simple way is exponential map (<code>method="exp"</code>), i.e., k(x,y) = exp( - d(x,y)/scale).
</p>


<h3>Author(s)</h3>

<p>Hideitsu Hino <a href="mailto:hinohide@cs.tsukuba.ac.jp">hinohide@cs.tsukuba.ac.jp</a>, Ken Takano, Yuki Yoshikawa, and Noboru Murata
</p>


</div>