<div class="container">

<table style="width: 100%;"><tr>
<td>fit_mmrm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Low-Level Fitting Function for MMRM</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt="[Experimental]"></a>
</p>
<p>This is the low-level function to fit an MMRM. Note that this does not
try different optimizers or adds Jacobian information etc. in contrast to
<code>mmrm()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit_mmrm(formula, data, weights, reml = TRUE, control = mmrm_control())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>(<code>formula</code>)<br> model formula with exactly one special term
specifying the visits within subjects, see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>(<code>data.frame</code>)<br> input data containing the variables used
in <code>formula</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>(<code>vector</code>)<br> input vector containing the weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reml</code></td>
<td>
<p>(<code>flag</code>)<br> whether restricted maximum likelihood (REML) estimation is used,
otherwise maximum likelihood (ML) is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>(<code>mmrm_control</code>)<br> list of control options produced
by <code>mmrm_control()</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>formula</code> typically looks like:
<code>FEV1 ~ RACE + SEX + ARMCD * AVISIT + us(AVISIT | USUBJID)</code>
so specifies response and covariates as usual, and exactly one special term
defines which covariance structure is used and what are the visit and
subject variables.
Always use only the first optimizer if multiple optimizers are provided.
</p>


<h3>Value</h3>

<p>List of class <code>mmrm_tmb</code>, see <code>h_mmrm_tmb_fit()</code> for details.
</p>


<h3>Examples</h3>

<pre><code class="language-R">formula &lt;- FEV1 ~ RACE + SEX + ARMCD * AVISIT + us(AVISIT | USUBJID)
data &lt;- fev_data
system.time(result &lt;- fit_mmrm(formula, data, rep(1, nrow(fev_data))))
</code></pre>


</div>