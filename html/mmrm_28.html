<div class="container">

<table style="width: 100%;"><tr>
<td>h_get_kr_comp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Obtain Kenward-Roger Adjustment Components</h2>

<h3>Description</h3>

<p>Obtains the components needed downstream for the computation of Kenward-Roger degrees of freedom.
Used in <code>mmrm()</code> fitting if method is "Kenward-Roger" or "Kenward-Roger-Linear".
</p>


<h3>Usage</h3>

<pre><code class="language-R">h_get_kr_comp(tmb_data, theta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tmb_data</code></td>
<td>
<p>(<code>mmrm_tmb_data</code>)<br> produced by <code>h_mmrm_tmb_data()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>(<code>numeric</code>)<br> theta estimate.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>the function returns a named list, <code class="reqn">P</code>, <code class="reqn">Q</code> and <code class="reqn">R</code>, which corresponds to the
paper in 1997. The matrices are stacked in columns so that <code class="reqn">P</code>, <code class="reqn">Q</code> and <code class="reqn">R</code> has the same
column number(number of beta parameters). The number of rows, is dependent on
the total number of theta and number of groups, if the fit is a grouped mmrm.
For <code class="reqn">P</code> matrix, it is stacked sequentially. For <code class="reqn">Q</code> and <code class="reqn">R</code> matrix, it is stacked so
that the <code class="reqn">Q_{ij}</code> and <code class="reqn">R_{ij}</code> is stacked from <code class="reqn">j</code> then to <code class="reqn">i</code>, i.e. <code class="reqn">R_{i1}</code>, <code class="reqn">R_{i2}</code>, etc.
<code class="reqn">Q</code> and <code class="reqn">R</code> only contains intra-group results and inter-group results should be all zero matrices
so they are not stacked in the result.
</p>


<h3>Value</h3>

<p>Named list with elements:
</p>

<ul>
<li> <p><code>P</code>: <code>matrix</code> of <code class="reqn">P</code> component.
</p>
</li>
<li> <p><code>Q</code>: <code>matrix</code> of <code class="reqn">Q</code> component.
</p>
</li>
<li> <p><code>R</code>: <code>matrix</code> of <code class="reqn">R</code> component.
</p>
</li>
</ul>
</div>