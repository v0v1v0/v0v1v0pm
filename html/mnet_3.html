<div class="container">

<table style="width: 100%;"><tr>
<td>mlVAR_GC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Testing Group Differences in mlVAR
</h2>

<h3>Description</h3>

<p>Does inference on group differences in mlVAR models using a permutation test. The function is a wrapper around the function <code>mlVAR()</code> from the <code>mlVAR</code> package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mlVAR_GC(data, vars, idvar, dayvar = NULL,
         beepvar = NULL, groups, test = "permutation",
         paired = FALSE, estimator, contemporaneous,
         temporal, nCores = 1, nP = 500, saveModels = FALSE,
         verbose = FALSE, pbar = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The data.frame containing the data (rows=cases, columns=variables) including the variables to be modeled, a unique id per subject, and potentially additional variables about the measurement procedure (see <code>dayvar</code> and <code>dayvar</code> below).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vars</code></td>
<td>

<p>A character vector with the column names of the variables that should be included in the mlVAR models.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idvar</code></td>
<td>

<p>The name of the column containing the unique subject id.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dayvar</code></td>
<td>

<p>Optional: The name of the column indicating assessment day. Adding this argument makes sure that the first measurement of a day is not regressed on the last measurement of the previous day. IMPORTANT: only add this if the data has multiple observations per day. See also <code>mlVAR()</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beepvar</code></td>
<td>

<p>Optional: The name of the column indicating measurement occasion per day. Adding this argument will cause non-consecutive beeps to be treated as missing! See also <code>mlVAR()</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>

<p>The name of the column indicating group membership.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>

<p>The type of test used. Defaults to <code>test = "permutation"</code>, which performs a permutation test. Alternatively, <code>test = "parametric"</code> performs a parametric test based on confidence intervals. For the latter, a (vectorcritical p-value has to be specified.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>paired</code></td>
<td>

<p>Indicates whether samples are paired or not (independent). If <code>paired = TRUE</code> indicates dependent samples. This requires that <code>idvar</code> needs to be specified such that each subject is contained in both groups, which implies that both groups have the same size. Also, the function assumes that the subjects are ordered in the same way in both groups. In this case, the permutation is computed based on within-person permutationst. The parametric test is not possible in this case since we are not able to obtain the required standard error from <code>mlVAR</code> models. If <code>paired = FALSE</code> the permutations are unrestricted. Defaults to <code>paired = FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimator</code></td>
<td>

<p>The estimator to be used. <code>"lmer"</code> for sequential univariate multi-level estimation, <code>"Mplus"</code> for multivariate Bayesian estimation (requires Mplus), and <code>"lm"</code> for fixed effects estimation. See also <code>mlVAR()</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contemporaneous</code></td>
<td>

<p>How should the contemporaneous networks be estimated? These networks are always estimated post-hoc by investigating the residuals of the temporal models. <code>"correlated"</code> and <code>"orthogonal"</code> run second multi-level models in which the networks are estimated using node-wise estimation. <code>"fixed"</code> and <code>"unique"</code> simply correlate the residuals, either by computing one network for all subjects (fixed) or a single network per per subject. See also <code>mlVAR()</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>temporal</code></td>
<td>

<p>How should the temporal effects be estimated? <code>"correlated"</code> estimates correlated random effects, <code>"orthogonal"</code> estimates non-correlated random effects and <code>"fixed"</code> estimates a model in which only the intercept is random. Defaults to <code>"correlated"</code> when the number of variables is less than 6 and <code>"orthogonal"</code> otherwise. <code>"unique"</code> uses lm to estimate an unique model for each subject. See also <code>mlVAR()</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nCores</code></td>
<td>

<p>Number of cores to use in computation. See also <code>mlVAR()</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nP</code></td>
<td>

<p>Number of permutations used to create the sampling distribution under the null hypothesis for the permutation test. Defaults to <code>nP = 500</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>saveModels</code></td>
<td>

<p>If true, the pair of mlVAR objects for each permutations are saved in the output. Defaults to <code>saveModels = FALSE</code> since the resulting output object can become very large.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>If true, the the verbose option in foreach, which is used in side <code>mlVAR_GC()</code>, is switched on. Defaults to <code>verbose = FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pbar</code></td>
<td>

<p>If true, a progress bar is shown. Defaults to <code>pbar = TRUE</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The output consists of a list with the following entries:
</p>


<h3>Value</h3>

<p>Returns a list with the following entries:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>EmpDiffs</code></td>
<td>
<p>A list containing five matrices with the empirically observed differences (Group 1 - Group 2) in the between-person network, the fixed and random effects variances of the temporal network, and the fixed and random effects variances of the contemporaneous network.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pval</code></td>
<td>
<p>Same structure as <code>TrueDiffs</code> but provides p-values for the corresponding observed group differences. Note that for the parametric test, p-values are only available for fixed lagged effects, fixed contemporaneous (residual) effects, and the between network effects. This is because <code>mlVAR</code> only provides standard errors for those types of parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SampDist</code></td>
<td>
<p>A list of arrays, containing the sampling distributions for between-person network, the fixed and random effects variances of the temporal network, and the fixed and random effects variances of the contemporaneous network.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Models</code></td>
<td>
<p>If <code>saveModels = TRUE</code>, this contains a list with all pairs of mlVAR models for each permutation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Runtime</code></td>
<td>
<p>The runtime of the function in minutes.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jonas Haslbeck &lt;jonashaslbeck@protonmail.com&gt;
</p>


<h3>References</h3>

<p>Epskamp, S., Waldorp, L. J., MÃµttus, R., &amp; Borsboom, D. (2018). The Gaussian graphical model in cross-sectional and time-series data. Multivariate behavioral research, 53(4), 453-480.
</p>


<h3>Examples</h3>

<pre><code class="language-R">


# Use simulated example data loaded with package
head(ExampleData)

# Call Permutation test
out &lt;- mlVAR_GC(data = ExampleData,
                vars = c("V1", "V2", "V3"),
                idvar = "id",
                groups = "group",
                nCores = 2, # choose max cores possible on your machine
                nP = 2) # Should be more in practice, see paper!

# P-values for the five parameter types:
out$Pval
# e.g., we see that there is a small p-value for
out$Pval$Phi_mean[1,2]
# which is a parameter with a true group difference
# (which we know since this is simulated data)

# The observed group differences (i.e., the test statistics)
# Can be found in:
out$EmpDiffs

# Specifically, the difference is: group 1 - group 2
# For example:
out$EmpDiffs$Phi_mean[1,2,]
# The true group difference was -0.4



</code></pre>


</div>