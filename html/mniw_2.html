<div class="container">

<table style="width: 100%;"><tr>
<td>crossprodV</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Matrix cross-product.</h2>

<h3>Description</h3>

<p>Vectorized matrix cross-products <code style="white-space: pre;">⁠t(X) V Y⁠</code> or <code style="white-space: pre;">⁠t(X) V^{-1} Y⁠</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">crossprodV(X, Y = NULL, V, inverse = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A matrix of size <code style="white-space: pre;">⁠p x q⁠</code>, or an array of size <code style="white-space: pre;">⁠p x q x n⁠</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>A matrix of size <code style="white-space: pre;">⁠p x r⁠</code>, or an array of size <code style="white-space: pre;">⁠p x r x n⁠</code>.  If missing defaults to <code>Y = X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>A matrix of size <code style="white-space: pre;">⁠p x p⁠</code>, or an array of size <code style="white-space: pre;">⁠p x p x n⁠</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inverse</code></td>
<td>
<p>Logical; whether or not the inner product should be calculated with <code>V</code> or <code>V^{-1}</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An array of size <code style="white-space: pre;">⁠q x r x n⁠</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># problem dimensions
p &lt;- 4
q &lt;- 2
r &lt;- 3
n &lt;- 5
X &lt;- array(rnorm(p*q*n), dim = c(p, q, n)) # vectorized
Y &lt;- array(rnorm(p*r*n), dim = c(p, r, n)) # vectorized
V &lt;- crossprod(matrix(rnorm(p*p), p, p)) # not vectorized (but positive definite)
crossprodV(X = X, V = V) # self cross-product
# cross-product with inverse matrix weight
crossprodV(X = X, V = V, Y = Y, inverse = TRUE)
</code></pre>


</div>