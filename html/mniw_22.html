<div class="container">

<table style="width: 100%;"><tr>
<td>MatrixNormal-dist</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The Matrix-Normal distribution.</h2>

<h3>Description</h3>

<p>Density and random sampling for the Matrix-Normal distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dMNorm(X, Lambda, SigmaR, SigmaC, log = FALSE)

rMNorm(n, Lambda, SigmaR, SigmaC)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Argument to the density function.  Either a <code style="white-space: pre;">⁠p x q⁠</code> matrix or a <code style="white-space: pre;">⁠p x q x n⁠</code> array.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lambda</code></td>
<td>
<p>Mean parameter.  Either a <code style="white-space: pre;">⁠p x q⁠</code> matrix or a <code style="white-space: pre;">⁠p x q x n⁠</code> array.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SigmaR</code></td>
<td>
<p>Between-row covariance matrix.  Either a <code style="white-space: pre;">⁠p x p⁠</code> matrix or a <code style="white-space: pre;">⁠p x p x n⁠</code> array.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SigmaC</code></td>
<td>
<p>Between-column covariance matrix  Either a <code style="white-space: pre;">⁠q x q⁠</code> matrix or a <code style="white-space: pre;">⁠q x q x n⁠</code> array.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>Logical; whether or not to compute the log-density.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Integer number of random samples to generate.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Matrix-Normal distribution <code class="reqn">\boldsymbol{X} \sim \textrm{Matrix-Normal}(\boldsymbol{\Lambda}, \boldsymbol{\Sigma}_R, \boldsymbol{\Sigma}_C)</code> on the random matrix <code class="reqn">\boldsymbol{X}_{p \times q}</code> is defined as
</p>
<p style="text-align: center;"><code class="reqn">
\textrm{vec}(\boldsymbol{X}) \sim \mathcal{N}(\textrm{vec}(\boldsymbol{\Lambda}), \boldsymbol{\Sigma}_C \otimes \boldsymbol{\Sigma}_R),
</code>
</p>

<p>where <code class="reqn">\textrm{vec}(\boldsymbol{X})</code> is a vector stacking the columns of <code class="reqn">\boldsymbol{X}</code>, and <code class="reqn">\boldsymbol{\Sigma}_C \otimes \boldsymbol{\Sigma}_R</code> denotes the Kronecker product.
</p>


<h3>Value</h3>

<p>A vector length <code>n</code> for density evaluation, or an array of size <code style="white-space: pre;">⁠p x q x n⁠</code> for random sampling.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># problem dimensions
p &lt;- 4
q &lt;- 2
n &lt;- 10 # number of observations
# parameter values
Lambda &lt;- matrix(rnorm(p*q),p,q) # mean matrix
# row-wise variance matrix (positive definite)
SigmaR &lt;- crossprod(matrix(rnorm(p*p), p, p))
SigmaC &lt;- rwish(n, Psi = diag(q), nu = q + 1) # column-wise variance (vectorized)

# random sample
X &lt;- rMNorm(n, Lambda = Lambda, SigmaR = SigmaR, SigmaC = SigmaC)

# log-density at each sampled value
dMNorm(X, Lambda = Lambda, SigmaR = SigmaR, SigmaC = SigmaC, log = TRUE)
</code></pre>


</div>