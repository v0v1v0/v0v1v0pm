<div class="container">

<table style="width: 100%;"><tr>
<td>Wishart-dist</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Wishart and Inverse-Wishart distributions.</h2>

<h3>Description</h3>

<p>Densities and random sampling for the Wishart and Inverse-Wishart distributions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dwish(X, Psi, nu, log = FALSE)

rwish(n, Psi, nu)

diwish(X, Psi, nu, log = FALSE)

riwish(n, Psi, nu)

dwishart(X, Psi, nu, inverse = FALSE, log = FALSE)

rwishart(n, Psi, nu, inverse = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Argument to the density function.  Either a <code style="white-space: pre;">⁠q x q⁠</code> matrix or a <code style="white-space: pre;">⁠q x q x n⁠</code> array.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Psi</code></td>
<td>
<p>Scale parameter.  Either a <code style="white-space: pre;">⁠q x q⁠</code> matrix or a <code style="white-space: pre;">⁠q x q x n⁠</code> array.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>Degrees-of-freedom parameter.  A scalar or vector of length <code>n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>Logical; whether or not to compute the log-density.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Integer number of random samples to generate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inverse</code></td>
<td>
<p>Logical; whether or not to use the Inverse-Wishart distribution.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Wishart distribution <code class="reqn">\boldsymbol{X} \sim \textrm{Wishart}(\boldsymbol{\Psi}, \nu)</code> on a symmetric positive-definite random matrix <code class="reqn">\boldsymbol{X}</code> of size <code class="reqn">q \times q</code> has PDF
</p>
<p style="text-align: center;"><code class="reqn">
f(\boldsymbol{X} \mid \boldsymbol{\Psi}, \nu) = \frac{|\boldsymbol{X}|^{(\nu-q-1)/2}\exp\big\{-\textrm{tr}(\boldsymbol{\Psi}^{-1}\boldsymbol{X})/2\big\}}{2^{q\nu/2}|\boldsymbol{\Psi}|^{\nu/2} \Gamma_q(\frac \nu 2)},
</code>
</p>

<p>where <code class="reqn">\Gamma_q(\alpha)</code> is the multivariate gamma function,
</p>
<p style="text-align: center;"><code class="reqn">
\Gamma_q(\alpha) = \pi^{q(q-1)/4} \prod_{i=1}^q \Gamma(\alpha + (1-i)/2).
</code>
</p>

<p>The Inverse-Wishart distribution <code class="reqn">\boldsymbol{X} \sim \textrm{Inverse-Wishart}(\boldsymbol{\Psi}, \nu)</code> is defined as <code class="reqn">\boldsymbol{X}^{-1} \sim \textrm{Wishart}(\boldsymbol{\Psi}^{-1}, \nu)</code>.
</p>
<p><code>dwish()</code> and <code>diwish()</code> are convenience wrappers for <code>dwishart()</code>, and similarly <code>rwish()</code> and <code>riwish()</code> are wrappers for <code>rwishart()</code>.
</p>


<h3>Value</h3>

<p>A vector length <code>n</code> for density evaluation, or an array of size <code style="white-space: pre;">⁠q x q x n⁠</code> for random sampling.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Random sampling

n &lt;- 1e5
q &lt;- 3
Psi1 &lt;- crossprod(matrix(rnorm(q^2),q,q))
nu &lt;- q + runif(1, 0, 5)

X1 &lt;- rwish(n,Psi1,nu) # Wishart

# plot it
plot_fun &lt;- function(X) {
  q &lt;- dim(X)[1]
  par(mfrow = c(q,q))
  for(ii in 1:q) {
    for(jj in 1:q) {
      hist(X[ii,jj,], breaks = 100, freq = FALSE,
           xlab = "", main = parse(text = paste0("X[", ii, jj, "]")))
    }
  }
}

plot_fun(X1)

# "vectorized" scale parameeter
Psi2 &lt;- 5 * Psi1
vPsi &lt;- array(c(Psi1, Psi2), dim = c(q, q, n))
X2 &lt;- rwish(n, Psi = vPsi, nu = nu)
plot_fun(X2)

# Inverse-Wishart
X3 &lt;- riwish(n, Psi2, nu)
plot_fun(X3)

# log-density calculation for sampled values
par(mfrow = c(1,1))
hist(dwish(X2, vPsi, nu, log = TRUE),
     breaks = 100, freq = FALSE, xlab = "",
     main = expression("log-p"*(X[2]*" | "*list(Psi,nu))))
</code></pre>


</div>