<div class="container">

<table style="width: 100%;"><tr>
<td>rmnorm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Random number generator for (conditional) multivariate normal distribution</h2>

<h3>Description</h3>

<p>This function generates random numbers (i.e. variates) from 
(conditional) multivariate normal distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rmnorm(
  n,
  mean,
  sigma,
  given_ind = numeric(),
  given_x = numeric(),
  dependent_ind = numeric(),
  is_validation = TRUE,
  n_cores = 1L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>positive integer representing the number of random variates
to be generated from (conditional) multivariate normal distribution.
If <code>given_ind</code> is not empty vector then <code>n</code> should be
be equal to <code>nrow(given_x)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>numeric vector representing expectation of multivariate
normal vector (distribution).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>positively defined numeric matrix representing covariance
matrix of multivariate normal vector (distribution).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>given_ind</code></td>
<td>
<p>numeric vector representing indexes of multivariate
normal vector which are conditioned at values given by 
<code>given_x</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>given_x</code></td>
<td>
<p>numeric vector which <code>i</code>-th element corresponds to
the given value of the <code>given_ind[i]</code>-th element (component) of 
multivariate normal vector. If <code>given_x</code> is numeric matrix then it's 
rows are such vectors of given values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dependent_ind</code></td>
<td>
<p>numeric vector representing indexes of unconditional
elements (components) of multivariate normal vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>is_validation</code></td>
<td>
<p>logical value indicating whether input 
arguments should be validated.  Set it to <code>FALSE</code> to get
performance boost (default value is <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_cores</code></td>
<td>
<p>positive integer representing the number of CPU cores
used for parallel computing. Currently it is not recommended to set
<code>n_cores &gt; 1</code> if vectorized arguments include less then 100000 elements.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function uses Cholesky decomposition to generate multivariate
normal variates from independent standard normal variates.
</p>


<h3>Value</h3>

<p>This function returns a numeric matrix which rows a random variates
from (conditional) multivariate normal distribution with mean equal to
<code>mean</code> and covariance equal to <code>sigma</code>. If <code>given_x</code> and 
<code>given_ind</code> are also provided then random variates will be from
conditional multivariate normal distribution. Please, see details section
of <code>cmnorm</code> to get additional information on the 
conditioning procedure.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Consider multivariate normal vector:
# X = (X1, X2, X3, X4, X5) ~ N(mean, sigma)

# Prepare multivariate normal vector parameters
  # expected value
mean &lt;- c(-2, -1, 0, 1, 2)
n_dim &lt;- length(mean)
  # correlation matrix
cor &lt;- c(   1,  0.1,  0.2,   0.3,  0.4,
          0.1,    1, -0.1,  -0.2, -0.3,
          0.2, -0.1,    1,   0.3,  0.2,
          0.3, -0.2,  0.3,     1, -0.05,
          0.4, -0.3,  0.2, -0.05,     1)
cor &lt;- matrix(cor, ncol = n_dim, nrow = n_dim, byrow = TRUE)
  # covariance matrix
sd_mat &lt;- diag(c(1, 1.5, 2, 2.5, 3))
sigma &lt;- sd_mat %*% cor %*% t(sd_mat)

# Simulate random variates from this distribution
rmnorm(n = 3, mean = mean, sigma = sigma)

# Simulate random variate from (X1, X3, X5 | X1 = -1, X4 = 1)
given_x &lt;- c(-1, 1)
given_ind = c(1, 4)
rmnorm(n = 1, mean = mean, sigma = sigma, 
       given_x = given_x, given_ind = given_ind)

# Simulate random variate from (X1, X3, X5 | X1 = -1, X4 = 1)
# and (X1, X3, X5 | X1 = 2, X4 = 3)
given_x = rbind(c(-1, 1), c(2, 3))
rmnorm(n = nrow(given_x), mean = mean, sigma = sigma, 
       given_x = given_x, given_ind = given_ind)
</code></pre>


</div>