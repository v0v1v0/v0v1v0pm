<div class="container">

<table style="width: 100%;"><tr>
<td>nlmeModel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MNREAD data fitting using a nonlinear mixed-effect (NLME) modeling.</h2>

<h3>Description</h3>

<p>This function uses a nonlinear mixed effects model (NLME), as described in Cheung et al. 2008, 
where variations across individuals are modeled as random effects. 
This function estimates and returns the NLME model while performing print size correction for non-standard testing viewing distance (ie. different than 40 cm).
</p>


<h3>Usage</h3>

<pre><code class="language-R">nlmeModel(
  data,
  print_size,
  viewing_distance,
  reading_time,
  errors,
  subjectID,
  nested = NULL,
  group = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The name of your dataframe</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print_size</code></td>
<td>
<p>The variable that contains print size values for each sentence (print size uncorrected for viewing distance)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>viewing_distance</code></td>
<td>
<p>The variable that contains the viewing distance value used for testing</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reading_time</code></td>
<td>
<p>The variable that contains the reading time for each sentence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>errors</code></td>
<td>
<p>The variable that contains the number of errors for each sentence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subjectID</code></td>
<td>
<p>The variable that contains the subject identifiers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nested</code></td>
<td>
<p>Optional argument to build a model with a nested structure. 'nested' specifies which variable should be nested within subject. Default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>Optional argument to build a model with a grouped structure. 'group' specifies which variable should be used as grouping argument. Default is NULL</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function returns a list of two objects: 
</p>

<ul>
<li>
<p> an object of class dataframe which is a cleaned version of the dataset called by the function to fit the model
</p>
</li>
<li>
<p> an object of class nlme returned by the function <code>nlme</code> 
</p>
</li>
</ul>
<h3>Notes</h3>

<p>For subjects with incomplete data, warning messages might appear in the console. However, the NLME model will run, 
using supporting data from the rest of the population.
</p>
<p>This functions supports nested, grouped and nested + grouped structures. 
</p>
<p>If needed, the nlme object returned can be further explored using generic functions from the nlme package.
</p>
<p>This function implements several functions from the nlme package to build the NLME model:
</p>

<ul>
<li>
<p> it first calls groupedData() to format the dataset in order to match the desired structure
</p>
</li>
<li>
<p> it then uses nlsList() to generate starting values
</p>
</li>
<li>
<p> it finally calls nlme() to build the model 
</p>
</li>
</ul>
<p>For more details on the nlme fit, see:\
Cheung SH, Kallie CS, Legge GE, Cheong AM. Nonlinear mixed-effects modeling of MNREAD data. 
Invest Ophthalmol Vis Sci. 2008;49:828â€“835. doi: 10.1167/iovs.07-0555.
</p>


<h3>Warning</h3>

<p>For the function to run properly, please make sure that variables are of the following classes:
</p>

<ul>
<li> <p><strong>print_size</strong> -&gt; numeric
</p>
</li>
<li> <p><strong>viewing_distance</strong> -&gt; integer
</p>
</li>
<li> <p><strong>reading_time</strong> -&gt; numeric
</p>
</li>
<li> <p><strong>errors</strong> -&gt; integer
</p>
</li>
</ul>
<p>The optional arguments "nested" and "group" should only be specified when they are needed. 
In case they are called and set to NULL, the function will not run and will return an error.
</p>


<h3>See Also</h3>

<p><code>nlmeParam</code> to estimate Maximum Reading Speed (MRS) and Critical Print Size (CPS) from the NLME model
</p>
<p><code>nlmeCurve</code> to plot the individual MNREAD curves estimated from the NLME model
</p>


<h3>Examples</h3>

<pre><code class="language-R"># inspect the structure of the dataframe
head(data_low_vision, 10)

#------

# restrict dataset to one MNREAD test per subject (regular polarity only)
data_regular &lt;- data_low_vision %&gt;%
    filter (polarity == "regular")

# run the NLME model for data grouped by subject
 model_simple &lt;- nlmeModel(data_regular, ps, vd, rt, err, subject) 

# to print the model summary
 summary(model_simple[[2]]) 

# to print the first 3 rows of the cleaned dataset containing the raw data and used to run the model
 head(model_simple[[1]], 3) 

#------

# run the NLME model on the whole dataset with polarity nested within subject
 model_nested &lt;- lmeModel(data_low_vision, ps, vd, rt, err, subject,
                                   nested = polarity) 

#------

# run theNLME model on the whole dataset with polarity nested within subject 
# and grouped based on treatment
 model_nested_grouped &lt;- nlmeModel(data_low_vision, ps, vd, rt, err, subject,
                                            nested = polarity, group = treatment) 



</code></pre>


</div>