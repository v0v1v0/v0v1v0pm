<div class="container">

<table style="width: 100%;"><tr>
<td>sim_sad</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate species abundance distributions</h2>

<h3>Description</h3>

<p>Simulate species abundance distribution (SAD) of a local community with
user-defined number of species and relative abundance distribution in the pool,
and user-defined number of individuals in the simulated local community.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim_sad(
  s_pool = NULL,
  n_sim = NULL,
  sad_type = c("lnorm", "bs", "gamma", "geom", "ls", "mzsm", "nbinom", "pareto",
    "poilog", "power", "powbend", "weibull"),
  sad_coef = list(cv_abund = 1),
  fix_s_sim = FALSE,
  drop_zeros = TRUE,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>s_pool</code></td>
<td>
<p>Number of species in the pool (integer)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_sim</code></td>
<td>
<p>Number of individuals in the simulated community (integer)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sad_type</code></td>
<td>
<p>Root name of the species abundance distribution model of the
species pool (character) - e.g., "lnorm" for the lognormal distribution
(<code>rlnorm</code>); "geom" for the geometric distribution
(<code>rgeom</code>), or "ls" for Fisher's log-series distribution
(<code>rls</code>).
</p>
<p>See the table in <strong>Details</strong> below, or <code>rsad</code>
for all SAD model options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sad_coef</code></td>
<td>
<p>List with named arguments to be passed to the distribution
function defined by the argument <code>sad_type</code>. An overview of parameter
names is given in the table below.
</p>
<p>In <code>mobsim</code> the log-normal and the Poisson log-normal distributions
can alternatively be parameterized by the coefficient of variation (cv)
of the relative abundances in the species pool. Accordingly, <code>cv_abund</code>
is the standard deviation of abundances divided by the mean abundance
(no. of individuals / no. of species). <code>cv_abund</code> is thus negatively
correlated with the evenness of the species abundance distribution.
</p>
<p>Please note that the parameters <em>mu</em> and <em>sigma</em> are not equal
to the mean and standard deviation of the log-normal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix_s_sim</code></td>
<td>
<p>Should the simulation constrain the number of
species in the simulated local community? (logical)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop_zeros</code></td>
<td>
<p>Should the function remove species with abundance zero
from the output? (logical)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Integer. Any integer passed to <code>set.seed</code> for reproducibility.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>sim_sad</code> was built using code of the function
<code>sads::rsad</code> from the R package <code>sads</code>. However, in
contrast to <code>sads::rsad</code>, the function <code>sim_sad</code> allows to
define the number of individuals in the simulated local community. This is
implemented by converting the abundance distribution simulated based on
<code>sads::rsad</code> into a relative abundance distribution. This
relative abundance distribution is considered as the species pool for the
local community. In a second step the required no. of individuals <code>(n_sim)</code>
is sampled (with replacement) from this relative abundance distribution.
</p>
<p>Please note that this might effect the interpretation of the parameters of
the underlying statistical distribution, e.g. the mean abundance will always
be <code>n_sim/s_pool</code> irrespective of the settings of <code>sad_coef</code>.
</p>
<p>When <code>fix_s_sim = FALSE</code> the species number in the local
community might deviate from <code>s_pool</code> due to stochastic sampling. When
<code>fix_s_sim = TRUE</code> the local number of species will equal
<code>s_pool</code>, but this constraint can result in systematic biases from the
theoretical distribution parameters. Generally, with <code>fix_s_sim = TRUE</code>
additional very rare species will be added to the community, while the abundance
of the most common ones is reduced to keep the defined number of individuals.
</p>
<p>Here is an overview of all available models (<code>sad_type</code>) and their
respective coefficients (<code>sad_coef</code>). Further information is provided
by the documentation of the specific functions that can be accesses by the
links. Please note that the coefficient <code>cv_abund</code> for the log-normal
and Poisson log-normal model are only available within <code>mobsim</code>.
</p>

<table>
<tr>
<td style="text-align: left;">
   <strong>SAD function</strong> </td>
<td style="text-align: left;"> <strong>Distribution name</strong> </td>
<td style="text-align: left;"> <strong>coef #1</strong> </td>
<td style="text-align: left;"> <strong>coef #2</strong> </td>
<td style="text-align: left;"> <strong>coef #3</strong> </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>sads::rbs</code> </td>
<td style="text-align: left;"> Mac-Arthur's brokenstick </td>
<td style="text-align: left;"> N </td>
<td style="text-align: left;"> S </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>stats:rgamma</code> </td>
<td style="text-align: left;"> Gamma distribution </td>
<td style="text-align: left;"> shape </td>
<td style="text-align: left;"> rate </td>
<td style="text-align: left;"> scale </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>rgeom</code> </td>
<td style="text-align: left;"> Geometric distribution </td>
<td style="text-align: left;"> prob </td>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>rlnorm</code> </td>
<td style="text-align: left;">	Log-normal distributions </td>
<td style="text-align: left;">	meanlog </td>
<td style="text-align: left;"> sdlog </td>
<td style="text-align: left;"> cv_abund </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>rls</code> </td>
<td style="text-align: left;"> Fisher's log-series distribution </td>
<td style="text-align: left;"> N </td>
<td style="text-align: left;"> alpha </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>sads::rmzsm</code> </td>
<td style="text-align: left;"> Metacommunity zero-sum multinomial </td>
<td style="text-align: left;"> J </td>
<td style="text-align: left;"> theta </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>stats::rnbinom</code> </td>
<td style="text-align: left;"> Negative binomial distribution </td>
<td style="text-align: left;"> size </td>
<td style="text-align: left;">	prob </td>
<td style="text-align: left;"> mu </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>sads::rpareto</code> </td>
<td style="text-align: left;"> Pareto distribution </td>
<td style="text-align: left;"> shape </td>
<td style="text-align: left;"> scale </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>sads::rpoilog</code> </td>
<td style="text-align: left;"> Poisson-lognormal distribution </td>
<td style="text-align: left;">	mu	 </td>
<td style="text-align: left;"> sigma </td>
<td style="text-align: left;"> cv_abund </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>sads::rpower</code> </td>
<td style="text-align: left;"> Power discrete distributions </td>
<td style="text-align: left;"> s </td>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>sads::rpowbend</code> </td>
<td style="text-align: left;"> Puyeo's Power-bend discrete distribution </td>
<td style="text-align: left;"> s </td>
<td style="text-align: left;"> omega </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>stats::rweibull</code> </td>
<td style="text-align: left;"> Weibull distribution </td>
<td style="text-align: left;"> shape </td>
<td style="text-align: left;"> scale </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>Value</h3>

<p>Object of class <code>sad</code>, which contains a named integer vector
with species abundances
</p>


<h3>Author(s)</h3>

<p>Felix May
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Simulate log-normal species abundance distribution
sad_lnorm1 &lt;- sim_sad(s_pool = 100, n_sim = 10000, sad_type = "lnorm",
                      sad_coef = list("meanlog" = 5, "sdlog" = 0.5))
plot(sad_lnorm1, method = "octave")
plot(sad_lnorm1, method = "rank")

# Alternative parameterization of the log-normal distribution
sad_lnorm2 &lt;- sim_sad(s_pool = 100, n_sim = 10000, sad_type = "lnorm",
                      sad_coef = list("cv_abund" = 0.5))
plot(sad_lnorm2, method = "octave")

# Fix species richness in the simulation by adding rare species
sad_lnorm3a &lt;- sim_sad(s_pool = 500, n_sim = 10000, sad_type = "lnorm",
                       sad_coef = list("cv_abund" = 5), fix_s_sim = TRUE)
sad_lnorm3b &lt;- sim_sad(s_pool = 500, n_sim = 10000, sad_type = "lnorm",
                       sad_coef = list("cv_abund" = 5))

plot(sad_lnorm3a, method = "rank")
points(1:length(sad_lnorm3b), sad_lnorm3b, type = "b", col = 2)
legend("topright", c("fix_s_sim = TRUE","fix_s_sim = FALSE"),
       col = 1:2, pch = 1)

# Different important SAD models

# Fisher's log-series
sad_logseries &lt;- sim_sad(s_pool = NULL, n_sim = NULL, sad_type = "ls",
                         sad_coef = list("N" = 1e5, "alpha" = 20))

# Poisson log-normal
sad_poilog &lt;- sim_sad(s_pool = 100, n_sim = 10000, sad_type = "poilog",
                      sad_coef = list("mu" = 5, "sig" = 0.5))

# Mac-Arthur's broken stick
sad_broken_stick &lt;- sim_sad(s_pool = NULL, n_sim = NULL, sad_type = "bs",
                            sad_coef = list("N" = 1e5, "S" = 100))

# Plot all SADs together as rank-abundance curves
plot(sad_logseries, method = "rank")
lines(1:length(sad_lnorm2), sad_lnorm2, type = "b", col = 2)
lines(1:length(sad_poilog), sad_poilog, type = "b", col = 3)
lines(1:length(sad_broken_stick), sad_broken_stick, type = "b", col = 4)
legend("topright", c("Log-series","Log-normal","Poisson log-normal","Broken stick"),
       col = 1:4, pch = 1)
</code></pre>


</div>