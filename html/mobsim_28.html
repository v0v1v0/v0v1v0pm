<div class="container">

<table style="width: 100%;"><tr>
<td>sim_thomas_community</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate community with clumped spatial positions.</h2>

<h3>Description</h3>

<p>This function simulates a community with a certain abundance distribution and
with intraspecific aggregation, i.e. individuals of the same species are
distributed in clusters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim_thomas_community(
  s_pool,
  n_sim,
  sad_type = "lnorm",
  sad_coef = list(cv_abund = 1),
  fix_s_sim = FALSE,
  sigma = 0.02,
  cluster_points = NA,
  mother_points = NA,
  xmother = NA,
  ymother = NA,
  xrange = c(0, 1),
  yrange = c(0, 1),
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>s_pool</code></td>
<td>
<p>Number of species in the pool (integer)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_sim</code></td>
<td>
<p>Number of individuals in the simulated community (integer)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sad_type</code></td>
<td>
<p>Root name of the species abundance distribution model of the
species pool (character) - e.g., "lnorm" for the lognormal distribution
(<code>rlnorm</code>); "geom" for the geometric distribution
(<code>rgeom</code>), or "ls" for Fisher's log-series distribution
(<code>rls</code>).
</p>
<p>See the table in <strong>Details</strong> below, or <code>rsad</code>
for all SAD model options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sad_coef</code></td>
<td>
<p>List with named arguments to be passed to the distribution
function defined by the argument <code>sad_type</code>. An overview of parameter
names is given in the table below.
</p>
<p>In <code>mobsim</code> the log-normal and the Poisson log-normal distributions
can alternatively be parameterized by the coefficient of variation (cv)
of the relative abundances in the species pool. Accordingly, <code>cv_abund</code>
is the standard deviation of abundances divided by the mean abundance
(no. of individuals / no. of species). <code>cv_abund</code> is thus negatively
correlated with the evenness of the species abundance distribution.
</p>
<p>Please note that the parameters <em>mu</em> and <em>sigma</em> are not equal
to the mean and standard deviation of the log-normal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix_s_sim</code></td>
<td>
<p>Should the simulation constrain the number of
species in the simulated local community? (logical)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>Mean displacement (along each coordinate axes) of a point from
its mother point (= cluster centre). <code>Sigma</code> correlates with cluster
extent. When <code>length(sigma) == length(abund_vec)</code>, each species
receives a specific cluster extent. Otherwise, the first value of <code>sigma</code>
is recycled and all species share the same cluster extent.
When <code>sigma</code> of any species is more than twice as large as the largest
plot dimension, a random Poisson distribution is simulated, which is more
efficient than a Thomas cluster process. The parameter <code>sigma</code> corresponds
to the <code>scale</code> parameter of the function <code>rThomas</code> in the package
<a href="https://CRAN.R-project.org/package=spatstat.random">spatstat.random</a>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster_points</code></td>
<td>
<p>Mean number of points per cluster. If this is
a single value, species have the same average number of points per cluster.
If this is a vector of the same length as <code>abund_vec</code>, each species has
a specific mean number of points per cluster.  If no value is provided, the
number of points per cluster is determined from the abundance and from
<code>mother_points</code>. If <code>mother_points</code> and <code>cluster_points</code> are given OR
<code>xmother</code> and <code>ymother</code>, and cluster points are given, <code>cluster_points</code> is overridden.
If <code>mother_points</code>=0, there will be no clustering even if <code>cluster_points</code>=400 (high clustering) because
<code>cluster_points</code> is overridden.
The parameter <code>cluster_points</code> corresponds to the
<code>mu</code> parameter of <code>spatstat.random::rThomas</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mother_points</code></td>
<td>
<p>Number of mother points (= cluster centres).
If this is a single value, all species have the same number of clusters.
For example <code>mother_points = 1</code> can be used to simulate only one cluster
per species, which then represents the complete species range.
If <code>mother_points</code> is a vector of the same length as <code>abund_vec</code>,
each species has a specific number of clusters. If <code>mother_points</code> equals 0
there is no clustering and the distribution is homogeneous. If no value is provided,
the number of clusters is determined from the abundance and the number of points
per cluster (<code>cluster_points</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmother</code></td>
<td>
<p>List of length equal to the number of species. Each list element
is a vector of x coordinates for every mother points. If one element is NA, the
the corresponding species is not clustered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ymother</code></td>
<td>
<p>List of length equal to the number of species. Each list element
is a vector of y coordinates for every mother points. If one element is NA, the
the corresponding species is not clustered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xrange</code></td>
<td>
<p>Extent of the community in x-direction. If this a numeric vector
of length 2, all species share the same range. To specify different x ranges for
all species, <code>xrange</code> should be a data.frame with 2 columns, min and max.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yrange</code></td>
<td>
<p>Extent of the community in y-direction. If this a numeric vector
of length 2, all species share the same range. To specify different y ranges for
all species, <code>xrange</code> should be a data.frame with 2 columns, min and max.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Integer. Any integer passed to <code>set.seed</code> for reproducibility.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function consecutively calls <code>sim_sad</code> and
<code>sim_thomas_coords</code>
</p>
<p>See the documentations of <code>sim_sad</code> and
<code>sim_thomas_coords</code> for details.
</p>


<h3>Value</h3>

<p>A community object as defined by <code>community</code>
</p>


<h3>Author(s)</h3>

<p>Felix May
</p>


<h3>Examples</h3>

<pre><code class="language-R">com1 &lt;- sim_thomas_community(s_pool = 20, n_sim = 500, sad_type = "lnorm",
                             sad_coef = list("meanlog" = 2, "sdlog" = 1),
                             sigma = 0.01)
plot(com1)

</code></pre>


</div>