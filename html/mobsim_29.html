<div class="container">

<table style="width: 100%;"><tr>
<td>sim_thomas_coords</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate clumped spatial coordinates</h2>

<h3>Description</h3>

<p>Add clumped (aggregated) positions to a species abundance distribution.
Clumping is simulated using a Thomas cluster process, also known as Poisson
cluster process (Morlon et al. 2008, Wiegand &amp; Moloney 2014)
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim_thomas_coords(
  abund_vec,
  sigma = 0.02,
  mother_points = NA,
  xmother = NA,
  ymother = NA,
  cluster_points = NA,
  xrange = c(0, 1),
  yrange = c(0, 1),
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>abund_vec</code></td>
<td>
<p>Species abundance vector (integer)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>Mean displacement (along each coordinate axes) of a point from
its mother point (= cluster centre). <code>Sigma</code> correlates with cluster
extent. When <code>length(sigma) == length(abund_vec)</code>, each species
receives a specific cluster extent. Otherwise, the first value of <code>sigma</code>
is recycled and all species share the same cluster extent.
When <code>sigma</code> of any species is more than twice as large as the largest
plot dimension, a random Poisson distribution is simulated, which is more
efficient than a Thomas cluster process. The parameter <code>sigma</code> corresponds
to the <code>scale</code> parameter of the function <code>rThomas</code> in the package
<a href="https://CRAN.R-project.org/package=spatstat.random">spatstat.random</a>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mother_points</code></td>
<td>
<p>Number of mother points (= cluster centres).
If this is a single value, all species have the same number of clusters.
For example <code>mother_points = 1</code> can be used to simulate only one cluster
per species, which then represents the complete species range.
If <code>mother_points</code> is a vector of the same length as <code>abund_vec</code>,
each species has a specific number of clusters. If <code>mother_points</code> equals 0
there is no clustering and the distribution is homogeneous. If no value is provided,
the number of clusters is determined from the abundance and the number of points
per cluster (<code>cluster_points</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmother</code></td>
<td>
<p>List of length equal to the number of species. Each list element
is a vector of x coordinates for every mother points. If one element is NA, the
the corresponding species is not clustered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ymother</code></td>
<td>
<p>List of length equal to the number of species. Each list element
is a vector of y coordinates for every mother points. If one element is NA, the
the corresponding species is not clustered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster_points</code></td>
<td>
<p>Mean number of points per cluster. If this is
a single value, species have the same average number of points per cluster.
If this is a vector of the same length as <code>abund_vec</code>, each species has
a specific mean number of points per cluster.  If no value is provided, the
number of points per cluster is determined from the abundance and from
<code>mother_points</code>. If <code>mother_points</code> and <code>cluster_points</code> are given OR
<code>xmother</code> and <code>ymother</code>, and cluster points are given, <code>cluster_points</code> is overridden.
If <code>mother_points</code>=0, there will be no clustering even if <code>cluster_points</code>=400 (high clustering) because
<code>cluster_points</code> is overridden.
The parameter <code>cluster_points</code> corresponds to the
<code>mu</code> parameter of <code>spatstat.random::rThomas</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xrange</code></td>
<td>
<p>Extent of the community in x-direction. If this a numeric vector
of length 2, all species share the same range. To specify different x ranges for
all species, <code>xrange</code> should be a data.frame with 2 columns, min and max.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yrange</code></td>
<td>
<p>Extent of the community in y-direction. If this a numeric vector
of length 2, all species share the same range. To specify different y ranges for
all species, <code>xrange</code> should be a data.frame with 2 columns, min and max.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Integer. Any integer passed to <code>set.seed</code> for reproducibility.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>To generate a Thomas cluster process of a single species this
function uses a C++ re-implementation of the function
<code>rThomas</code> in the package
<a href="https://CRAN.R-project.org/package=spatstat.random">spatstat.random</a>.
</p>
<p>There is an inherent link between the parameters <code>abund_vec</code>,
<code>mother_points</code>, and <code>cluster_points</code>. For every species the
abundance has to be equal to the number of clusters
(<code>mother_points</code>) times the number of points per cluster
(<code>cluster_points</code>).
</p>
<p style="text-align: center;"><code class="reqn">abundance = mother_points * cluster_points</code>
</p>

<p>Accordingly, if one of the parameters is provided, the other one is directly
calculated from the abundance. Values for <code>mother_points</code> override values
for <code>cluster_points</code>. If none of the parameters is specified, it is assumed
that for every species there is a similar number of clusters and of points
per cluster.
</p>
<p style="text-align: center;"><code class="reqn">mother_points = cluster_points = \sqrt(abundance),</code>
</p>

<p>In this case rare species have few clusters with few points per
cluster, while abundant species have many clusters with many points per cluster.
</p>


<h3>Value</h3>

<p>A community object as defined by <code>community</code>.
</p>


<h3>Author(s)</h3>

<p>Felix May, Alban Sagouis
</p>


<h3>References</h3>

<p>Morlon et al. 2008. A general framework for the distance-decay of similarity
in ecological communities. Ecology Letters 11, 904-917.
</p>
<p>Wiegand and Moloney 2014. Handbook of Spatial Point-Pattern Analysis in Ecology.
CRC Press
</p>


<h3>See Also</h3>

<p><code>rThomas</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
abund &lt;- c(10,20,50,100)
sim1 &lt;- sim_thomas_coords(abund, sigma = 0.02)
plot(sim1)

# Simulate species "ranges"
sim2 &lt;- sim_thomas_coords(abund, sigma = 0.02, mother_points = 1)
plot(sim2)

# Equal numbers of points per cluster
sim3 &lt;- sim_thomas_coords(abund, sigma = 0.02, cluster_points = 5)
plot(sim3)

# With large sigma the distribution will be essentially random (see Details)
sim4 &lt;- sim_thomas_coords(abund, sigma = 10)
plot(sim4)

# Some random and some clustered species with different numbers of mother points.
mother_points &lt;- sample(0:3, length(abund), replace = TRUE)
sim5 &lt;- sim_thomas_coords(abund, mother_points = mother_points, sigma=0.01)
plot(sim5)

# Specifying mother point coordinates or no-clustering (\code{NA}).
mother_points &lt;- sample(1:3, length(abund), replace = TRUE)
xmother &lt;- lapply(1:length(abund), function(i) runif(mother_points[i], 0, 1))
ymother &lt;- lapply(1:length(abund), function(i) runif(mother_points[i], 0, 1))
xmother[[1]] &lt;- NA
ymother[[1]] &lt;- NA
sim6 &lt;- sim_thomas_coords(abund, xmother=xmother, ymother=ymother, sigma=0.01)
plot(sim6)

# Species having different ranges.
xrange &lt;- data.frame(t(sapply(1:length(abund), function(i) sort(runif(2, 0, 1)))))
yrange &lt;- data.frame(t(sapply(1:length(abund), function(i) sort(runif(2, 0, 1)))))
sim7 &lt;- sim_thomas_coords(abund, mother_points=1, sigma=1, xrange=xrange, yrange=yrange)
plot(sim7)

</code></pre>


</div>