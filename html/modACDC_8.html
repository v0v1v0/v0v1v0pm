<div class="container">

<table style="width: 100%;"><tr>
<td>OSCA_par</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>OSCA_par</h2>

<h3>Description</h3>

<p>OSCA_par determines the percent variance explained in an external variable (exposures or responses) for a range of increasingly reduced datasets. Dimension reduction is done with Partition, where features are only condensed into modules if the intraclass correlation between the features is at least the user-supplied information loss criterion (ILC), 0 &lt;= ILC &lt;= 1. An ILC of one returns the full dataset with no reduction, and an ILC of zero returns one module of all input features, reducing the dataset to the mean value. For each ILC value, with the number of ILCs tested determined by input parameter ILCincrement, the function returns the point estimate and standard error of the percent variance explained in the observed external variable by the reduced dataset. If input parameter permute is true, the function also returns the same values for a random permutation of the external variable.
</p>


<h3>Usage</h3>

<pre><code class="language-R">OSCA_par(
  df,
  externalVar,
  ILCincrement = 0.05,
  oscaPath,
  remlAlg = 0,
  maxRemlIt = 100,
  numCovars = NULL,
  catCovars = NULL,
  permute = TRUE,
  numNodes = 1,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>n x p data frame or matrix of numeric -omics values with no ID column</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>externalVar</code></td>
<td>
<p>vector of length n of external variable values with no ID column</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ILCincrement</code></td>
<td>
<p>float between zero and one determining interval between tested ILC values; default is 0.05</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>oscaPath</code></td>
<td>
<p>absolute path to OSCA software</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remlAlg</code></td>
<td>
<p>which algorithm to run REML iterations in GCTA; 0 = average information (AI), 1 = Fisher-scoring, 2 = EM; default is 0 (AI)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxRemlIt</code></td>
<td>
<p>the maximum number of REML iterations; default is 100</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numCovars</code></td>
<td>
<p>n x c_n matrix of numerical covariates to adjust heritability model for; must be in same person order as externalVar; default is NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>catCovars</code></td>
<td>
<p>n x c_c matrix of categorical covariates to adjust heritability model for; must be in same person order as externalVar; default is NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>permute</code></td>
<td>
<p>boolean value for whether or not to calculate values for a random permutation of the external variable; default is true</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numNodes</code></td>
<td>
<p>number of available compute nodes for parallelization; default is 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical for whether or not to display progress updates; default is TRUE</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>OmicS-data-based Complex trait Analysis (OSCA) is a suite of C++ functions. In order to use the OSCA functions, the user must specify the absolute path to the OSCA software, which can be downloaded from the Yang Lab website <a href="https://yanglab.westlake.edu.cn/software/osca/#Download">here</a>.
</p>
<p>Here, we use OSCA's Omics Restricted Maximum Likelihood (OREML) method to estimate the percent of variance in an external phenotype that can be explained by an omics profile, akin to heritability estimates in GWAS. OREML is called twice for each ILC tested if permutations are included.
</p>
<p>Dimension reduction is done with Partition, an agglomerative data reduction method which performs both feature condensation and extraction based on a user provided information loss criterion (ILC). Feature condensation into modules are only accepted if the intraclass correlation between the features is at least the ILC. The superPartition function is called if the gene expression dataset contains more than 4,000 features.
</p>


<h3>Value</h3>

<p>Data frame with columns
</p>

<dl>
<dt>ILC</dt>
<dd>
<p>the information loss criterion used for that iteration</p>
</dd>
<dt>InformationLost</dt>
<dd>
<p>percent information lost due to data reduction</p>
</dd>
<dt>PercentReduction</dt>
<dd>
<p>percent of variables condensed compared to unreduced data</p>
</dd>
<dt>VarianceExplained_Observed</dt>
<dd>
<p>percent variance explained in observed external variable by the data</p>
</dd>
<dt>SE_Observed</dt>
<dd>
<p>standard error of the percent variance estimate for observed external variable</p>
</dd>
<dt>VarianceExplained_Permuted</dt>
<dd>
<p>percent variance explained in permuted external variable by the data; only if input parameter "permute" is true</p>
</dd>
<dt>SE_Permuted</dt>
<dd>
<p>standard error of the percent variance estimate for permuted external variable; only if input parameter "permute" is true</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Katelyn Queen, <a href="mailto:kjqueen@usc.edu">kjqueen@usc.edu</a>
</p>


<h3>References</h3>

<p>Benjamini Y, Hochberg Y. Controlling the false discovery rate: a practical and powerful approach to multiple testing. <em>Journal of the Royal statistical society: series B (Methodological)</em> <strong>57</strong> (1995) 289–300.
</p>
<p>Martin P, et al. Novel aspects of PPARalpha-mediated regulation of lipid and xenobiotic metabolism revealed through a nutrigenomic study. <em>Hepatology</em>, in press, 2007.
</p>
<p>Millstein J, Battaglin F, Barrett M, Cao S, Zhang W, Stintzing S, et al. Partition: a surjective mapping approach for dimensionality reduction. <em>Bioinformatics</em> <strong>36</strong> (2019) 676–681. doi:10.1093/bioinformatics/ btz661.
</p>
<p>Queen K, Nguyen MN, Gilliland F, Chun S, Raby BA, Millstein J. ACDC: a general approach for detecting phenotype or exposure associated co-expression. <em>Frontiers in Medicine</em> (2023) 10. doi:10.3389/fmed.2023.1118824.
</p>


<h3>See Also</h3>

<p>OSCA software - <a href="https://yanglab.westlake.edu.cn/software/osca/">https://yanglab.westlake.edu.cn/software/osca/</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#load CCA package for example dataset
library(CCA)

# load dataset
data("nutrimouse")

# run function; input absolute path to OSCA software before running
## Not run: OSCA_par(df = nutrimouse$gene, 
          externalVar = as.numeric(nutrimouse$diet),
          ILCincrement = 0.25, 
          oscaPath = "pathHere")
## End(Not run)

</code></pre>


</div>