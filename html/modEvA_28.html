<div class="container">

<table style="width: 100%;"><tr>
<td>predDensity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Plot the density of predicted or predictor values for presences and absences.
</h2>

<h3>Description</h3>

<p>This function produces a histogram and/or a kernel density plot of predicted or predictor values for a binary-response model, optionally separately for the observed presences and absences, given either a model object or a vector of predicted (or predictor) values, and optionally a vector of the corresponding observed values (with 0 for absence and 1 for presence). When there are multiple predicted values for each site (e.g. for BART models), it can also plot a confidence interval.
</p>


<h3>Usage</h3>

<pre><code class="language-R">predDensity(model = NULL, obs = NULL, pred = NULL,
separate = TRUE, type = "both", ci = NA, legend.pos = "topright",
main = "Density of pred values", na.rm = TRUE, rm.dup = FALSE,
xlim = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a binary-response model object of class "glm", "gam", "gbm", "randomForest" or "bart". If this argument is provided, 'obs' and 'pred' will be extracted with <code>mod2obspred</code>. Alternatively, you can input the 'pred' (and optionally 'obs') argument(s) instead of 'model'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>
<p>alternatively to 'model' and together with 'pred', an optional numeric vector (in the same order of 'pred') of observed presences (1) and absences (0) of a binary response variable. Alternatively (and if 'pred' is a 'SpatRaster'), a two-column matrix or data frame containing, respectively, the x (longitude) and y (latitude) coordinates of the presence points, in which case the 'obs' vector will be extracted with <code>ptsrast2obspred</code>. This argument may be omitted (to show the density plot of all 'pred' values combined), and it is ignored if 'model' is provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred</code></td>
<td>
<p>alternatively to 'model', a vector of predicted values of presence probability, habitat suitability, environmental favourability or alike; or a vector of values of a continuous predictor variable. Must be of the same length and in the same order as 'obs' (if the latter is provided). Alternatively (and if 'obs' is a set of point coordinates), a 'SpatRaster' map of the predicted values for the entire evaluation region, in which case the 'pred' vector will be extracted with <code>ptsrast2obspred</code>. This argument is ignored if 'model' is provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>separate</code></td>
<td>
<p>logical value indicating whether prediction densities should be computed separately for observed presences (ones) and absences (zeros). Defaults to TRUE, but it is automatically changed to FALSE if either 'model' or 'obs' are not provided, or if 'ci' is not NA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>character vector specifying whether to produce a "histogram", a "density" plot, or "both" (the default). Partial argument matching is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>optional numeric value for a confidence interval to add to the plot, e.g. 0.95 for 95%. The default is NA. If specified, argument 'separate' is set to FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.pos</code></td>
<td>
<p>character specifying the position for the legend; NA or "n" for no legend. Position can be "topright" (the default), "topleft, "bottomright"", "bottomleft", "top", "bottom", "left", "right", or "center". Partial argument matching is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>main title for the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>logical value indicating whether missing values should be ignored in computations. Defaults to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rm.dup</code></td>
<td>
<p>if <code>TRUE</code> and if 'pred' is a SpatRaster and if there are repeated points within the same pixel, a maximum of one point per pixel is used to compute the presences. See examples in <code>ptsrast2obspred</code>. The default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>numeric vector of length 2 setting the limits for the x axis of the plot. The default is NULL, for the range of the <code>density</code> of predicted or predictor values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to pass to <code>hist</code>, e.g. 'breaks' or 'border'.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For more details, see <code>density</code> and/or <code>hist</code>.
</p>


<h3>Value</h3>

<p>This function outputs and plots the object(s) specified in 'type' â€“ by default, a <code>density</code> object and a <code>hist</code>ogram.
</p>


<h3>Author(s)</h3>

<p>A. Marcia Barbosa
</p>


<h3>See Also</h3>

<p><code>hist</code>, <code>density</code>, <code>predPlot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># load sample models:
data(rotif.mods)

# choose a particular model to play with:
mod &lt;- rotif.mods$models[[1]]


# compute predDensity with different parameters:

predDensity(model = mod)

predDensity(model = mod, breaks = seq(0, 1, by = 0.05))

predDensity(model = mod, type = "histogram")

predDensity(model = mod, type = "density")

predDensity(model = mod, ci = 0.975)


# you can also use 'predDensity' with vectors of
# observed and predicted values, instead of a model object:

obs &lt;- mod$y
pred &lt;- mod$fitted.values

predDensity(obs = obs, pred = pred)

predDensity(pred = pred, ci = 0.95)


# 'obs' can also be a table of presence point coordinates
# and 'pred' a SpatRaster of predicted values
</code></pre>


</div>