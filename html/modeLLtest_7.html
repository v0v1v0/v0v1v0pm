<div class="container">

<table style="width: 100%;"><tr>
<td>cvmf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cross-Validated Median Fit (CVMF) Test</h2>

<h3>Description</h3>

<p>Applies cross-validated log-likelihood to test between
partial likelihood maximization (PLM) and the iteratively reweighted
robust (IRR) method of estimation for a given application of the Cox model.
For more, see: Desmarais, B. A., &amp; Harden, J. J. (2012). Comparing partial
likelihood and robust estimation methods for the Cox regression model.
Political Analysis, 20(1), 113-135.
doi: <a href="https://doi.org/10.1093/pan/mpr042">10.1093/pan/mpr042</a>
</p>


<h3>Usage</h3>

<pre><code class="language-R">cvmf(
  formula,
  data,
  method = c("exact", "approximate", "efron", "breslow"),
  trunc = 0.95,
  subset,
  na.action,
  f.weight = c("linear", "quadratic", "exponential"),
  weights,
  singular.ok = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula object, with the response on the left of a ~
operator, and the terms on the right. The response must be a survival
object as returned by the <code>Surv</code> function from the survival package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame, list or environment (or object coercible by
as.data.frame to a data frame) containing the variables in the model
or in the subset and the weights argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A character string specifying the method for tie handling in coxph().
If there are no tied death times all the methods are equivalent.
Following the <code>coxph</code> function in the survival package, the Efron
approximation is used as the default. The survival package justifies this
due to the Efron method being is more accurate when dealing with tied death
times, and is as efficient computationally than the common Breslow method.
The "exact partial likelihood" is equivalent to a 'conditional logistic model,
and is appropriate when the times are a small set of discrete values.
This argument does not exist in the <code>coxr</code> function in the
coxrobust package. For <code>coxr</code>, method is based on a smooth
modification of the partial likelihood. See documentation from survival package
for more on <code>coxph</code> method and coxrobust package for
<code>coxr</code> method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trunc</code></td>
<td>
<p>A value that determines the trimming level for the robust
estimator. The default is 0.95. Roughly, quantile of the sample
<code class="reqn">T_i exp(\beta'Z_i)</code>. It is an argument in the <code>coxr</code> function
in the coxrobust package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>Expression indicating which subset of the rows of data should be
used in the fit. All observations are included by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>A missing-data filter function, applied to the model.frame,
after any subset argument has been used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f.weight</code></td>
<td>
<p>A type of weighting function for <code>coxr</code> in the coxrobust package.
The default is <code>quadratic</code>. See <code>coxr</code> documentation for more.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>A vector of case weights for <code>coxph</code> in the survival package.
See <code>coxph</code> documentation for more.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>singular.ok</code></td>
<td>
<p>Logical value indicating how to handle collinearity in the
model matrix. If <code>TRUE</code>, the program will automatically skip over columns
of the X matrix that are linear combinations of earlier columns. In this case
the coefficients for such columns will be NA, and the variance matrix will contain
zeros. For ancillary calculations, such as the linear predictor, the missing
coefficients are treated as zeros.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function implements the cross-validated median fit (CVMF) test.
The function cvmf() tests between the partial
likelihood maximization (PLM) and the iteratively reweighted robust
(IRR) method of estimation for a given application of the Cox model.
The Cox model is a partial parametric model that does not make assumptions
about the baseline hazard. It can be estimated via PLM, the standard
estimator, or IRR, a robust estimator that identifies and downweights
outliers. The choice between the two methods involves a trade-off
between bias and efficiency. PLM is more efficient, but biased under
specification problems. IRR reduces bias, but results in high
variance due to the loss of efficiency. The cvmf() function returns an
object to identify the prefered estimation method.
</p>
<p>See also <code>coxph</code>, <code>coxr</code>,
<code>Surv</code>
</p>


<h3>Value</h3>

<p>An object of class <code>cvmf</code> computed by the cross-validated median fit test
(CVMF) to test between the PLM and IRR methods of estimating the Cox model.
See <code>cvmf_object</code> for more details.
</p>


<h3>References</h3>

<p>Desmarais, B. A., &amp; Harden, J. J. (2012). Comparing partial
likelihood and robust estimation methods for the Cox regression model.
Political Analysis, 20(1), 113-135.
doi: <a href="https://doi.org/10.1093/pan/mpr042">10.1093/pan/mpr042</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

  set.seed(12345)
  x1 &lt;- rnorm(100)
  x2 &lt;- rnorm(100)

  x2e &lt;- x2 + rnorm(100, 0, 0.5)

  y &lt;- rexp(100, exp(x1 + x2))
  y &lt;- survival::Surv(y)

  dat &lt;- data.frame(y, x1, x2e)
  form &lt;- y ~ x1 + x2e

  results &lt;- cvmf(formula = form, data = dat)
  

</code></pre>


</div>