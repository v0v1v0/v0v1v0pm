<div class="container">

<table style="width: 100%;"><tr>
<td>modeHunting</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multiscale analysis of a density on all possible intervals</h2>

<h3>Description</h3>

<p>Simultanous confidence statements for the existence and location of local increases and decreases 
of a density f, computed on all intervals spanned by two observations.</p>


<h3>Usage</h3>

<pre><code class="language-R">modeHunting(X.raw, lower = -Inf, upper = Inf, crit.vals, min.int = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X.raw</code></td>
<td>
<p>Vector of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>Lower support point of <code class="reqn">f</code>, if known.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>Upper support point of <code class="reqn">f</code>, if known.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crit.vals</code></td>
<td>
<p>2-dimensional vector giving the critical values for the desired level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.int</code></td>
<td>
<p>If <code>min.int = TRUE</code>, the set of minimal intervals is output, otherwise all intervals with a test 
statistic above the critical value are given.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In general, the methods <code>modeHunting</code>, <code>modeHuntingApprox</code>, and 
<code>modeHuntingBlock</code> compute for a given level <code class="reqn">\alpha \in (0, 1)</code> and the corresponding
critical value <code class="reqn">c_{jk}(\alpha)</code> two sets of intervals
</p>
<p style="text-align: center;"><code class="reqn">\mathcal{D}^\pm(\alpha) = \Bigl\{ \mathcal{I}_{jk} \ : \ \pm T_{jk}({\bf{X}} ) &gt; c_{jk}(\alpha) \Bigr\}</code>
</p>

<p>where <code class="reqn">\mathcal{I}_{jk}:=(X_{(j)},X_{(k)})</code> for <code class="reqn">0\le j &lt; k \le n+1, k-j&gt; 1</code> and <code class="reqn">c_{jk}</code> are
appropriate critical values.
</p>
<p>Specifically, the function <code>modeHunting</code> computes <code class="reqn">\mathcal{D}^\pm(\alpha)</code> based on the two 
test statistics
</p>
<p style="text-align: center;"><code class="reqn">T_n^+({\bf{X}}, \mathcal{I}) = \max_{(j,k) \in \mathcal{I}} \Bigl( |T_{jk}({\bf{X}})| / \sigma_{jk} - \Gamma \Bigl(\frac{k-j}{n+2}\Bigr)\Bigr)</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">T_n({\bf{X}}, \mathcal{I}) = \max_{(j,k) \in \mathcal{I}} ( |T_{jk}({\bf{X}})| / \sigma_{jk} ),</code>
</p>

<p>using the set <code class="reqn">\mathcal{I} := \mathcal{I}_{all}</code> of all intervals spanned by two observations 
<code class="reqn">(X_{(j)}, X_{(k)})</code>:
</p>
<p style="text-align: center;"><code class="reqn">\mathcal{I}_{all} = \Bigl\{(j, \ k ) \ : \ 0 \le j &lt; k \le n+1, \ k - j &gt; 1\Bigr\}.</code>
</p>

<p>We introduced the local test statistics
</p>
<p style="text-align: center;"><code class="reqn">T_{jk}({\bf{X}}) := \sum_{i=j+1}^{k-1} ( 2 X_{(i; j, k)} - 1) 1\{X_{(i; j, k)} \in (0,1)\},</code>
</p>

<p>for local order statistics
</p>
<p style="text-align: center;"><code class="reqn">X_{(i; j, k)} := \frac{X_{(i)}-X_{(j)}}{X_{(k)} - X_{(j)}},</code>
</p>

<p>the standard deviation <code class="reqn">\sigma_{jk} :=  \sqrt{(k-j-1)/3}</code> and the additive correction term 
<code class="reqn">\Gamma(\delta) := \sqrt{2 \log(e / \delta)}</code> for <code class="reqn">\delta &gt; 0</code>.
</p>
<p>If <code>min.int = TRUE</code>, the set <code class="reqn">\mathcal{D}^\pm(\alpha)</code> is replaced by the set <code class="reqn">{\bf{D}}^\pm(\alpha)</code>
of its <em>minimal elements</em>. An interval <code class="reqn">J \in \mathcal{D}^\pm(\alpha)</code> is called <em>minimal</em> if 
<code class="reqn">\mathcal{D}^\pm(\alpha)</code> contains no proper subset of <code class="reqn">J</code>. This <em>minimization</em> post-processing 
step typically massively reduces the number of intervals. If we are mainly interested in locating the ranges
of increases and decreases of <code class="reqn">f</code> as precisely as possible, the intervals in 
<code class="reqn">\mathcal{D}^\pm(\alpha) \setminus \bf{D}^\pm(\alpha)</code> do not contain relevant information.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Dp</code></td>
<td>
<p>The set <code class="reqn">\mathcal{D}^+(\alpha)</code> (or <code class="reqn">\bf{D}^+(\alpha)</code>), based on the test statistic with additive correction <code class="reqn">\Gamma</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dm</code></td>
<td>
<p>The set <code class="reqn">\mathcal{D}^-(\alpha)</code> (or <code class="reqn">\bf{D}^-(\alpha)</code>), based on the test statistic with <code class="reqn">\Gamma</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dp.noadd</code></td>
<td>
<p>The set <code class="reqn">\mathcal{D}^+(\alpha)</code> (or <code class="reqn">\bf{D}^+(\alpha)</code>), based on the test statistic without <code class="reqn">\Gamma</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dm.noadd</code></td>
<td>
<p>The set <code class="reqn">\mathcal{D}^+(\alpha)</code> (or <code class="reqn">\bf{D}^-(\alpha)</code>), based on the test statistic without <code class="reqn">\Gamma</code>.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Critical values for <code>modeHunting</code> and some combinations of <code class="reqn">n</code> and <code class="reqn">\alpha</code> are provided in the 
data set <code>cvModeAll</code>. Critical values for other values of <code class="reqn">n</code> and <code class="reqn">\alpha</code> can be generated 
using <code>criticalValuesAll</code>.
</p>
<p>Parts of this function were derived from MatLab code provided on Lutz Duembgen's webpage, <br><a href="http://www.staff.unibe.ch/duembgen">http://www.staff.unibe.ch/duembgen</a>.</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach, <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a>, <br><a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a> 
</p>
<p>Guenther Walther, <a href="mailto:gwalther@stanford.edu">gwalther@stanford.edu</a>, <br><a href="www-stat.stanford.edu/~gwalther">www-stat.stanford.edu/~gwalther</a>
</p>


<h3>References</h3>

<p>Duembgen, L. and Walther, G. (2008).
Multiscale Inference about a density.
<em>Ann. Statist.</em>, <b>36</b>, 1758–1785.
</p>
<p>Rufibach, K. and Walther, G. (2010).
A general criterion for multiscale inference. 
<em>J. Comput. Graph. Statist.</em>, <b>19</b>, 175–190.
</p>


<h3>See Also</h3>

<p><code>modeHuntingApprox</code>, <code>modeHuntingBlock</code>, and <code>cvModeAll</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R">## for examples type
help("mode hunting")
## and check the examples there</code></pre>


</div>