<div class="container">

<table style="width: 100%;"><tr>
<td>blocks</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Computes number of observations for each block</h2>

<h3>Description</h3>

<p>In Rufibach and Walther (2010) a new multiscale mode hunting procedure is presented
that compares the local test statistics with critical values given by blocks. Blocks are collection
of intervals on a given grid that contain roughly the same number of original observations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">blocks(n, m0 = 10, fm = 2)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m0</code></td>
<td>
<p>Initial parameter that determines the number of observations in one block.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fm</code></td>
<td>
<p>Factor by which <code class="reqn">m</code> is increased from block to block.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In our block procedure, we only consider a subset <code class="reqn">\mathcal{I}_{app}</code> of all possible intervals
<code class="reqn">\mathcal{I}_{all}</code> where
</p>
<p style="text-align: center;"><code class="reqn">\mathcal{I}_{all} = \Bigl\{(j, \ k ) \ : \ 0 \le j &lt; k \le n+1, \ k - j &gt; 1\Bigr\}.</code>
</p>

<p>This subset <code class="reqn">\mathcal{I}_{app}</code> is computed as follows: 
</p>
<p>Set <code class="reqn">d_1, m_1, f_m &gt; 1</code>. Then:
</p>
<p><code class="reqn">for \ \ r = 1,\ldots,\#blocks</code>
</p>
<p><code class="reqn">d_r := round(d_1 f_m^{(r-1)/2}), \ m_r := m_1 f_m^{r-1}.</code>
</p>
<p>Include <code class="reqn">(j,k)</code> in <code class="reqn">\mathcal{I}_{app}</code> if 
</p>
<p>(a) <code class="reqn">j, k \in \{1+i d_r, \ i = 0, 1, \dots \}</code> \ \ (we only consider every <code class="reqn">d</code>–th observation) and 
</p>
<p>(b) <code class="reqn">m_r \le k-j-1 \le 2m_r-1</code> \ \ (<code class="reqn">\mathcal{I}_{jk}</code> contains between <code class="reqn">m_r</code> and <code class="reqn">2m_r - 1</code> observations)
</p>
<p><code class="reqn">end \ \ for</code>
</p>


<h3>Value</h3>

<p><code class="reqn">b \times 2</code>–matrix, where <code class="reqn">b</code> is the number of blocks and the columns contain the lower
and the upper number of observations that form each block.
</p>


<h3>Note</h3>

<p>The asymptotic results in Rufibach and Walther (2010) are only derived for <code class="reqn">f_m = 2</code>.</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach, <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a>, <br><a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a> 
</p>
<p>Guenther Walther, <a href="mailto:gwalther@stanford.edu">gwalther@stanford.edu</a>, <br><a href="www-stat.stanford.edu/~gwalther">www-stat.stanford.edu/~gwalther</a>
</p>


<h3>References</h3>

<p>Rufibach, K. and Walther, G. (2010).
A general criterion for multiscale inference. 
<em>J. Comput. Graph. Statist.</em>, <b>19</b>, 175–190.
</p>


<h3>See Also</h3>

<p>This function is called by <code>modeHuntingBlock</code>.</p>


</div>