<div class="container">

<table style="width: 100%;"><tr>
<td>overalllikelihood</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The likelihood function</h2>

<h3>Description</h3>

<p>This function (i.e., <code>overalllikelihood()</code>) calculates the likelihood value with a list of pre-defined epidemiological parameters and a given structured contact tracing data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">overalllikelihood(
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = "D",
  is.log = TRUE,
  data = NULL,
  var.name = list(obssize = NULL, seedsize = NULL, typelab = NULL),
  obs.type.lab = list(offspring = NULL, nextgen = NULL, outbreak = NULL)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>epi.para</code></td>
<td>
<p>A list (<code>list</code>) of pre-defined epidemiological parameters for offspring distribution, in the format of <code>list(mean = ?, disp = ?, shift = ?)</code>,
where the three parameters accept non-negative values.
Each parameter must be a scalar.
For Delaporte distribution, the value of <code>mean</code> should be larger than the value of <code>shift</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offspring.type</code></td>
<td>
<p>A character label (<code>character</code>) indicating the type of distribution used to describe the offspring distribution.
It only accepts one of the following values:
</p>

<ul>
<li>
<p><code>"D"</code> indicates the <em>Delaporte</em> distribution, 
</p>
</li>
<li>
<p><code>"NB"</code> indicates the <em>negative binomial</em> distribution, 
</p>
</li>
<li>
<p><code>"G"</code> indicates the <em>geometric</em> distribution, or 
</p>
</li>
<li>
<p><code>"P"</code> indicates the <em>Poisson</em> distribution. 
</p>
</li>
</ul>
<p>By default, <code>offspring.type = 'D'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>is.log</code></td>
<td>
<p>A logical variable, under which the likelihood would be taken natural logarithm, i.e., log-likelihood, if <code>is.log = TRUE</code>.
By default, <code>is.log = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame (<code>data.frame</code>), or a vector (only when <code>obs.type.lab = "offspring"</code>) that contains the structured contact tracing data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.name</code></td>
<td>
<p>A list (<code>list</code>), or a character of variable name for the column names of dataset given in <code>data</code>.
For a list of variable names, it should be in the format of <code>list(obssize = ?, seedsize = ?, typelab = ?)</code>.
Please see the details section for more information.
By default, <code>var.name = list(obssize = NULL, seedsize = NULL, typelab = NULL)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs.type.lab</code></td>
<td>
<p>A list (<code>list</code>), or a character of labels (i.e., "offspring", "nextgen", or "outbreak") for the type of observations.
For a list of labels, it should be in the format of <code>list(offspring = ?, nextgen = ?, outbreak = ?)</code>.
Please see the details section for more information.
By default, <code>obs.type.lab = list(offspring = NULL, nextgen = NULL, outbreak = NULL)</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When <code>obs.type.lab</code> is a character, it should be either <code>"offspring"</code>, <code>"nextgen"</code>, or <code>"outbreak"</code> for type of observations.
</p>
<p>When <code>obs.type.lab</code> is a list, this occurs when the contact tracing data has more than one types of observations.
See example 4 in the Examples section.
</p>
<p>When the contact tracing dataset is offspring case observations, the function arguments <code>data</code> could be either a vector, or a data frame.
If <code>data</code> is a vector, it is not necessary to assign any value to <code>var.name</code>.
If <code>data</code> is a data frame, it is necessary to identify the variable name of offspring observations in <code>var.name</code>.
See example 1 in the Examples section.
</p>
<p>When the contact tracing dataset is next-generation cluster size, or final outbreak size observations, the variable names of both observations and seed case size should be identified in <code>var.name</code> with the format of <code>list(obssize = ?, seedsize = ?)</code>.
See example 2 and example 3 in the Examples section.
</p>
<p>When the contact tracing dataset has more than one types of observations, the variable names of observations, seed case size, and observation type should be identified in <code>var.name</code> with the format of <code>list(obssize = ?, seedsize = ?, typelab = ?)</code>.
See example 4 in the Examples section.
</p>


<h3>Value</h3>

<p>The log-likelihood (by default), or likelihood value from contact tracing data, with pre-defined epidemiological parameters.
</p>


<h3>Note</h3>

<p>Each parameter in <code>epi.para = list(mean = ?, disp = ?, shift = ?)</code> should be a scalar, which means vector is not allowed here.
</p>
<p>For the contact tracing data in <code>data</code>, unknown observations (i.e., <code>NA</code>) is not allowed.
</p>


<h3>References</h3>

<p>Lloyd-Smith JO, Schreiber SJ, Kopp PE, Getz WM. Superspreading and the effect of individual variation on disease emergence. <em>Nature</em>. 2005;438(7066):355-359.
<a href="https://doi.org/10.1038/nature04153">doi:10.1038/nature04153</a>
</p>
<p>Nishiura H, Yan P, Sleeman CK, Mode CJ. Estimating the transmission potential of supercritical processes based on the final size distribution of minor outbreaks. <em>Journal of Theoretical Biology</em>. 2012;294:48-55.
<a href="https://doi.org/10.1016/j.jtbi.2011.10.039">doi:10.1016/j.jtbi.2011.10.039</a>
</p>
<p>Blumberg S, Funk S, Pulliam JR. Detecting differential transmissibilities that affect the size of self-limited outbreaks. <em>PLoS Pathogens</em>. 2014;10(10):e1004452.
<a href="https://doi.org/10.1371/journal.ppat.1004452">doi:10.1371/journal.ppat.1004452</a>
</p>
<p>Kucharski AJ, Althaus CL. The role of superspreading in Middle East respiratory syndrome coronavirus (MERS-CoV) transmission. <em>Eurosurveillance</em>. 2015;20(25):21167.
<a href="https://doi.org/10.2807/1560-7917.ES2015.20.25.21167">doi:10.2807/1560-7917.ES2015.20.25.21167</a>
</p>
<p>Endo A, Abbott S, Kucharski AJ, Funk S. Estimating the overdispersion in COVID-19 transmission using outbreak sizes outside China. <em>Wellcome Open Research</em>. 2020;5:67.
<a href="https://doi.org/10.12688/wellcomeopenres.15842.3">doi:10.12688/wellcomeopenres.15842.3</a>
</p>
<p>Adam DC, Wu P, Wong JY, Lau EH, Tsang TK, Cauchemez S, Leung GM, Cowling BJ. Clustering and superspreading potential of SARS-CoV-2 infections in Hong Kong. <em>Nature Medicine</em>. 2020;26(11):1714-1719.
<a href="https://doi.org/10.1038/s41591-020-1092-0">doi:10.1038/s41591-020-1092-0</a>
</p>
<p>Zhao S, Chong MK, Ryu S, Guo Z, He M, Chen B, Musa SS, Wang J, Wu Y, He D, Wang MH. Characterizing superspreading potential of infectious disease: Decomposition of individual transmissibility. <em>PLoS Computational Biology</em>. 2022;18(6):e1010281.
<a href="https://doi.org/10.1371/journal.pcbi.1010281">doi:10.1371/journal.pcbi.1010281</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# example 1 #
## likelihood for the offspring observations
data(COVID19_JanApr2020_HongKong)
overalllikelihood(
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = "D",
  data = COVID19_JanApr2020_HongKong,
  var.name = list(obssize = 'obs'),
  obs.type.lab = 'offspring'
)
overalllikelihood(
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = "D",
  data = COVID19_JanApr2020_HongKong$obs,
  obs.type.lab = 'offspring'
)


# example 2 #
## likelihood for the next-generation cluster size observations
data(smallpox_19581973_Europe)
overalllikelihood(
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = 'D',
  data = smallpox_19581973_Europe,
  var.name = list(obssize = 'obs.clustersize', seedsize = 'obs.seed'),
  obs.type.lab = 'nextgen'
)


# example 3 #
## likelihood for the final outbreak size observations
data(MERS_2013_MEregion)
overalllikelihood(
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = 'D',
  data = MERS_2013_MEregion,
  var.name = list(obssize = 'obs.finalsize', seedsize = 'obs.seed'),
  obs.type.lab = 'outbreak'
)


# example 4 #
## likelihood for more than one types of observations
data(mpox_19801984_DRC)
overalllikelihood(
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = 'D',
  data = mpox_19801984_DRC,
  var.name = list(obssize = 'obs.size', seedsize = 'obs.seed', typelab = 'type'),
  obs.type.lab = list(offspring = 'offspring', nextgen = 'nextgen', outbreak = 'outbreak')
)


# example 5 #
## reproducing the AIC results in Adam, et al. (2020) https://doi.org/10.1038/s41591-020-1092-0,
## (see Supplementary Table 4),
## where the AIC scores were calculated for NB, Geometric, and Poisson models from top to bottom.
## Here, the AIC is defined as: AIC = -2 * log-likelihood + 2 * number of unknown model parameters.
data(COVID19_JanApr2020_HongKong)
overalllikelihood(
  epi.para = list(mean = 0.58, disp = 0.43, shift = 0.2),
  offspring.type = "NB",
  data = COVID19_JanApr2020_HongKong$obs,
  obs.type.lab = 'offspring'
) * (-2) + 2*2
overalllikelihood(
  epi.para = list(mean = 0.63, disp = 0.43, shift = 0.2),
  offspring.type = "G",
  data = COVID19_JanApr2020_HongKong$obs,
  obs.type.lab = 'offspring'
) * (-2) + 1*2
overalllikelihood(
  epi.para = list(mean = 0.58, disp = 0.43, shift = 0.2),
  offspring.type = "P",
  data = COVID19_JanApr2020_HongKong$obs,
  obs.type.lab = 'offspring'
) * (-2) + 1*2

</code></pre>


</div>