<div class="container">

<table style="width: 100%;"><tr>
<td>d_offspringdistn</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The offspring distribution</h2>

<h3>Description</h3>

<p>Density, cumulative distribution, quantile, and random variable generating functions for the <strong>offspring</strong> distribution with pre-defined epidemiological parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">d_offspringdistn(
  x = 1,
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = "D",
  is.log = FALSE
)

p_offspringdistn(
  q = 1.5,
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = "D",
  is.log = FALSE,
  lower.tail = TRUE
)

q_offspringdistn(
  p = 0.8,
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = "D",
  lower.tail = TRUE
)

r_offspringdistn(
  n = 10,
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = "D"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A scalar, or a vector of non-negative integer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epi.para</code></td>
<td>
<p>A list (<code>list</code>) of pre-defined epidemiological parameters for offspring distribution, in the format of <code>list(mean = ?, disp = ?, shift = ?)</code>,
where the three parameters accept non-negative values.
Each parameter can be either a scalar, or a vector.
For the parameters being assigned with values of vectors, the vectors should be of the same length.
For Delaporte distribution, the value of <code>mean</code> should be larger than the value of <code>shift</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offspring.type</code></td>
<td>
<p>A character label (<code>character</code>) indicating the type of distribution used to describe the offspring distribution.
It only accepts one of the following values:
</p>

<ul>
<li>
<p><code>"D"</code> indicates the <em>Delaporte</em> distribution, 
</p>
</li>
<li>
<p><code>"NB"</code> indicates the <em>negative binomial</em> distribution, 
</p>
</li>
<li>
<p><code>"G"</code> indicates the <em>geometric</em> distribution, or 
</p>
</li>
<li>
<p><code>"P"</code> indicates the <em>Poisson</em> distribution. 
</p>
</li>
</ul>
<p>By default, <code>offspring.type = 'D'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>is.log</code></td>
<td>
<p>A logical variable, under which probability would be taken natural logarithm, if <code>is.log = TRUE</code>.
By default, <code>is.log = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>A scalar, or a vector of non-negative number (not necessarily integer).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>A logical variable, under which the probability is cumulative distribution function (CDF, i.e., <em>P(X &lt;= x)</em>), if <code>lower.tail = TRUE</code>, and otherwise, 1 - CDF (i.e., <em>P(X &gt; x)</em>).
By default, <code>lower.tail = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>A scalar, or a vector of probability (i.e., ranging from 0 to 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>A scalar of positive integer.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For different values of <code>offspring.type</code>,
</p>

<ul>
<li>
<p>When <code>offspring.type = "D"</code>, no action to any parameter; 
</p>
</li>
<li>
<p>When <code>offspring.type = "NB"</code>, we set parameter <code>shift = 0</code>; 
</p>
</li>
<li>
<p>When <code>offspring.type = "G"</code>, we set parameters <code>disp = 1</code> and <code>shift = 0</code>; and 
</p>
</li>
<li>
<p>When <code>offspring.type = "P"</code>, we set parameters <code>disp = +Inf</code> and <code>shift = mean</code>. 
</p>
</li>
</ul>
<h3>Value</h3>

<p>For the values returned from the four functions,
</p>

<ul>
<li>
<p><code>d_offspringdistn()</code> is the <em>probability mass function</em> (PMF), and it returns value of probability (i.e., ranging from 0 to 1); 
</p>
</li>
<li>
<p><code>p_offspringdistn()</code> is the <em>cumulative distribution function</em> (CDF), and it returns value of probability (i.e., ranging from 0 to 1); 
</p>
</li>
<li>
<p><code>q_offspringdistn()</code> is the <em>quantile function</em>, and it returns value of quantile (non-negative integer); and 
</p>
</li>
<li>
<p><code>r_offspringdistn()</code> is the <em>random variable generating function</em>, and it generates a set of <code>n</code> random variables (non-negative integers). 
</p>
</li>
</ul>
<h3>Note</h3>

<p>Depending on the values of parameters, the functions could take hours to complete, given the double-summation nature for the Delaporte distribution.
</p>


<h3>References</h3>

<p>Vose D. Risk analysis: a quantitative guide. John Wiley &amp; Sons. 2008; pp. 618-619. ISBN: 978-0-470-51284-5
</p>
<p>Lloyd-Smith JO, Schreiber SJ, Kopp PE, Getz WM. Superspreading and the effect of individual variation on disease emergence. <em>Nature</em>. 2005;438(7066):355-359.
<a href="https://doi.org/10.1038/nature04153">doi:10.1038/nature04153</a>
</p>
<p>Zhao S, Chong MK, Ryu S, Guo Z, He M, Chen B, Musa SS, Wang J, Wu Y, He D, Wang MH. Characterizing superspreading potential of infectious disease: Decomposition of individual transmissibility. <em>PLoS Computational Biology</em>. 2022;18(6):e1010281.
<a href="https://doi.org/10.1371/journal.pcbi.1010281">doi:10.1371/journal.pcbi.1010281</a>
</p>


<h3>See Also</h3>

<p><code>Delaporte</code> for the parameterization of Delaporte distribution.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Please see the "Usage" section.


## the following returns the proportion of index cases that generated at least 1 offspring cases.
p_offspringdistn(
  q = 0,
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = 'D', lower.tail = FALSE
)

## reproducing the results in Adam, et al. (2020)
## paper doi link: https://doi.org/10.1038/s41591-020-1092-0 (see Fig 3b),
## where the number of offspring cases were fitted
## with parameter R of 0.58 and k of 0.43 under NB distribution.
data(COVID19_JanApr2020_HongKong)
hist(
  COVID19_JanApr2020_HongKong$obs, breaks = c(0:100) -0.5, xlim = c(0,12),
  freq = FALSE, xlab = 'secondary cases', ylab = 'rel. freq.', main = ''
)
lines(0:12, d_offspringdistn(
  x = 0:12,
  epi.para = list(mean = 0.58, disp = 0.43, shift = 0.2),
  offspring.type = "NB"
), pch = 20, type = 'o', lty = 2)


## an example to generate 100 rv of offspring case number
table(r_offspringdistn(
  n = 100,
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = 'D'
))

</code></pre>


</div>