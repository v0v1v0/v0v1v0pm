<div class="container">

<table style="width: 100%;"><tr>
<td>d_nextgenclusterdistn</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The next-generation cluster size distribution</h2>

<h3>Description</h3>

<p>Density, cumulative distribution, quantile, and random variable generating functions for the <strong>next-generation cluster size</strong> distribution with pre-defined epidemiological parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">d_nextgenclusterdistn(
  x = 5,
  seed.size = 1,
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = "D",
  is.log = FALSE
)

p_nextgenclusterdistn(
  q = 10.5,
  seed.size = 1,
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = "D",
  lower.tail = TRUE,
  is.log = FALSE
)

q_nextgenclusterdistn(
  p = 0.8,
  seed.size = 1,
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = "D",
  lower.tail = TRUE
)

r_nextgenclusterdistn(
  n = 10,
  seed.size = 1,
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = "D"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A scalar, or a vector of positive integer, for the next-generation cluster size.  The value of <code>x</code> must be not less than <code>seed.size</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed.size</code></td>
<td>
<p>A scalar, or a vector of positive integer.
For vector type of <code>seed.size</code>, it only applies to <code>d_nextgenclusterdistn()</code>, <code>p_nextgenclusterdistn()</code>, and <code>q_nextgenclusterdistn()</code>.
If <code>seed.size</code> and <code>x</code>, <code>q</code> or <code>p</code> are vectors, <code>seed.size</code> should be of the same length as <code>x</code>, <code>q</code> or <code>p</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epi.para</code></td>
<td>
<p>A list (<code>list</code>) of pre-defined epidemiological parameters for offspring distribution, in the format of <code>list(mean = ?, disp = ?, shift = ?)</code>,
where the three parameters accept non-negative values.
Each parameter can be either a scalar, or a vector.
For the parameters being assigned with values of vectors, the vectors should be of the same length.
For Delaporte distribution, the value of <code>mean</code> should be larger than the value of <code>shift</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offspring.type</code></td>
<td>
<p>A character label (<code>character</code>) indicating the type of distribution used to describe the offspring distribution.
It only accepts one of the following values:
</p>

<ul>
<li>
<p><code>"D"</code> indicates the <em>Delaporte</em> distribution, 
</p>
</li>
<li>
<p><code>"NB"</code> indicates the <em>negative binomial</em> distribution, 
</p>
</li>
<li>
<p><code>"G"</code> indicates the <em>geometric</em> distribution, or 
</p>
</li>
<li>
<p><code>"P"</code> indicates the <em>Poisson</em> distribution. 
</p>
</li>
</ul>
<p>By default, <code>offspring.type = 'D'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>is.log</code></td>
<td>
<p>A logical variable, under which probability would be taken natural logarithm, if <code>is.log = TRUE</code>.
By default, <code>is.log = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>A scalar, or a vector of positive number (not necessarily integer), for the next-generation cluster size. The value of <code>q</code> must be not less than <code>seed.size</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>A logical variable, under which the probability is cumulative distribution function (CDF, i.e., <em>P(X &lt;= x)</em>), if <code>lower.tail = TRUE</code>, and otherwise, 1 - CDF (i.e., <em>P(X &gt; x)</em>).
By default, <code>lower.tail = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>A scalar, or a vector of probability (i.e., ranging from 0 to 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>A scalar of positive integer.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Function <code>d_nextgenclusterdistn()</code> returns the probability of having a next-generation case cluster with size <code>x</code> generated by <code>seed.size</code> index cases, where (<code>seed.size</code>) is given.
</p>
<p>Function <code>p_nextgenclusterdistn()</code> returns the probability of having a next-generation case cluster with size less than or equal to, or larger than <code>q</code> (depending on the value of <code>lower.tail</code>), generated by <code>seed.size</code> index cases, where (<code>seed.size</code>) is given.
</p>
<p>Function <code>q_nextgenclusterdistn()</code> returns a value such that there is a probability of <code>p</code> for having a next-generation case cluster with size less than or equal to, or larger than this value (depending on the value of <code>lower.tail</code>) generated by <code>seed.size</code> index cases, where (<code>seed.size</code>) is given.
</p>
<p>Function <code>r_nextgenclusterdistn()</code> returns a set of random variables of <code>n</code> next-generation cluster size, given (<code>seed.size</code>).
</p>


<h3>Value</h3>

<p>For the values returned from the four functions,
</p>

<ul>
<li>
<p><code>d_nextgenclusterdistn()</code> is the <em>probability mass function</em> (PMF), and it returns value of probability (i.e., ranging from 0 to 1); 
</p>
</li>
<li>
<p><code>p_nextgenclusterdistn()</code> is the <em>cumulative distribution function</em> (CDF), and it returns value of probability (i.e., ranging from 0 to 1); 
</p>
</li>
<li>
<p><code>q_nextgenclusterdistn()</code> is the <em>quantile function</em>, and it returns value of quantile (positive integer); and 
</p>
</li>
<li>
<p><code>r_nextgenclusterdistn()</code> is the <em>random variable generating function</em>, and it generates a set of <code>n</code> random variables (positive integers). 
</p>
</li>
</ul>
<h3>Note</h3>

<p>Depending on the values of parameters, the functions could take hours to complete, given the double-summation nature for the Delaporte distribution.
</p>


<h3>References</h3>

<p>Blumberg S, Lloyd-Smith JO. Inference of R 0 and transmission heterogeneity from the size distribution of stuttering chains. <em>PLoS Computational Biology</em>. 2013 May 2;9(5):e1002993.
<a href="https://doi.org/10.1371/journal.pcbi.1002993">doi:10.1371/journal.pcbi.1002993</a>
</p>
<p>Zhao S, Chong MK, Ryu S, Guo Z, He M, Chen B, Musa SS, Wang J, Wu Y, He D, Wang MH. Characterizing superspreading potential of infectious disease: Decomposition of individual transmissibility. <em>PLoS Computational Biology</em>. 2022;18(6):e1010281.
<a href="https://doi.org/10.1371/journal.pcbi.1010281">doi:10.1371/journal.pcbi.1010281</a>
</p>


<h3>See Also</h3>

<p><code>Delaporte</code> for the parameterization of Delaporte distribution.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Please see the "Usage" section.

</code></pre>


</div>