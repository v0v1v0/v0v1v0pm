<div class="container">

<table style="width: 100%;"><tr>
<td>d_outbreakdistn</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The final outbreak size distribution</h2>

<h3>Description</h3>

<p>Density, cumulative distribution, quantile, and random variable generating functions for the <strong>final outbreak size</strong> distribution with pre-defined epidemiological parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">d_outbreakdistn(
  x = 10,
  seed.size = 1,
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = "D",
  is.log = FALSE
)

p_outbreakdistn(
  q = 30.5,
  seed.size = 1,
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = "D",
  lower.tail = TRUE,
  is.log = FALSE
)

q_outbreakdistn(
  p = 0.8,
  seed.size = 1,
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = "D",
  lower.tail = TRUE,
  upr.limit = 1000
)

r_outbreakdistn(
  n = 10,
  seed.size = 1,
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = "D",
  upr.limit = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A scalar, or a vector of final outbreak size, which is positive integer. The value of <code>x</code> must be not less than <code>seed.size</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed.size</code></td>
<td>
<p>A scalar, or a vector of positive integer.
For vector type of <code>seed.size</code>, it only applies to <code>d_outbreakdistn()</code>, and <code>p_outbreakdistn()</code>.
If <code>seed.size</code> and <code>x</code> or <code>q</code> are vectors, <code>seed.size</code> should be of the same length as <code>x</code> or <code>q</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epi.para</code></td>
<td>
<p>A list (<code>list</code>) of pre-defined epidemiological parameters for offspring distribution, in the format of <code>list(mean = ?, disp = ?, shift = ?)</code>,
where the three parameters accept non-negative values.
Each parameter must be a scalar.
For Delaporte distribution, the value of <code>mean</code> should be larger than the value of <code>shift</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offspring.type</code></td>
<td>
<p>A character label (<code>character</code>) indicating the type of distribution used to describe the offspring distribution.
It only accepts one of the following values:
</p>

<ul>
<li>
<p><code>"D"</code> indicates the <em>Delaporte</em> distribution, 
</p>
</li>
<li>
<p><code>"NB"</code> indicates the <em>negative binomial</em> distribution, 
</p>
</li>
<li>
<p><code>"G"</code> indicates the <em>geometric</em> distribution, or 
</p>
</li>
<li>
<p><code>"P"</code> indicates the <em>Poisson</em> distribution. 
</p>
</li>
</ul>
<p>By default, <code>offspring.type = 'D'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>is.log</code></td>
<td>
<p>A logical variable, under which probability would be taken natural logarithm, if <code>is.log = TRUE</code>.
By default, <code>is.log = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>A scalar, or a vector of positive number (not necessarily integer). The value of <code>q</code> must be not less than <code>seed.size</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>A logical variable, under which the probability is cumulative distribution function (CDF, i.e., <em>P(X &lt;= x)</em>), if <code>lower.tail = TRUE</code>, and otherwise, 1 - CDF (i.e., <em>P(X &gt; x)</em>).
By default, <code>lower.tail = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>A scalar, or a vector of probability (i.e., ranging from 0 to 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upr.limit</code></td>
<td>
<p>A positive integer.
If the result final outbreak size is larger than <code>upr.limit</code>, the returned value will be set as "<code>&gt; upr.limit</code>".
The value of <code>upr.limit</code> must be larger than <code>seed.size</code>.
By default, <code>upr.limit = 1000</code>, and no need to change the default setting here unless for special reasons.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>A scalar of positive integer.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Function <code>d_outbreakdistn()</code> returns the probability of having an outbreak with final size <code>x</code> generated by <code>seed.size</code> index cases, where (<code>seed.size</code>) is given.
</p>
<p>Function <code>p_outbreakdistn()</code> returns the probability of having an outbreak with final size less than or equal to, or larger than <code>q</code> (depending on the value of <code>lower.tail</code>), generated by <code>seed.size</code> index cases, where (<code>seed.size</code>) is given.
</p>
<p>Function <code>q_outbreakdistn()</code> returns a value such that there is a probability of <code>p</code> for having a final outbreak size less than or equal to, or larger than this value (depending on the value of <code>lower.tail</code>) generated by <code>seed.size</code> index cases, where (<code>seed.size</code>) is given.
</p>
<p>Function <code>r_outbreakdistn()</code> returns a set of <code>n</code> random variables of final outbreak size, given (<code>seed.size</code>).
</p>


<h3>Value</h3>

<p>For the values returned from the four functions,
</p>

<ul>
<li>
<p><code>d_outbreakdistn()</code> is the <em>probability mass function</em> (PMF), and it returns value of probability (i.e., ranging from 0 to 1); 
</p>
</li>
<li>
<p><code>p_outbreakdistn()</code> is the <em>cumulative distribution function</em> (CDF), and it returns value of probability (i.e., ranging from 0 to 1); 
</p>
</li>
<li>
<p><code>q_outbreakdistn()</code> is the <em>quantile function</em>, and it returns value of quantile (positive integer); and 
</p>
</li>
<li>
<p><code>r_outbreakdistn()</code> is the <em>random variable generating function</em>, and it generates a set of <code>n</code> random variables (positive integers). 
</p>
</li>
</ul>
<p>Specially, due to the computational consumption, an upper limit was set for the functions <code>q_outbreakdistn()</code> and <code>r_outbreakdistn()</code>,
i.e., <code>upr.limit</code>, and thus, both functions here return value in string form (i.e., <code>character</code>).
</p>


<h3>Note</h3>

<p>Each parameter in <code>epi.para = list(mean = ?, disp = ?, shift = ?)</code> should be a scalar, which means vector is not allowed here.
</p>
<p>When <code>q</code> is large, e.g., <code>q</code> &gt; 10000, the function <code>p_outbreakdistn()</code> could take few seconds, or even minutes to complete.
</p>
<p>When <code>upr.limit</code> is large, e.g., <code>upr.limit</code> &gt; 10000, the functions <code>q_outbreakdistn()</code> and <code>r_outbreakdistn()</code> could take few seconds, or even minutes to complete.
Thus, we do not recommend the users to change the default setting of <code>upr.limit</code> unless for special reasons.
</p>


<h3>References</h3>

<p>Farrington CP, Kanaan MN, Gay NJ. Branching process models for surveillance of infectious diseases controlled by mass vaccination. <em>Biostatistics</em>. 2003;4(2):279-95.
<a href="https://doi.org/10.1093/biostatistics/4.2.279">doi:10.1093/biostatistics/4.2.279</a>
</p>
<p>Nishiura H, Yan P, Sleeman CK, Mode CJ. Estimating the transmission potential of supercritical processes based on the final size distribution of minor outbreaks. <em>Journal of Theoretical Biology</em>. 2012;294:48-55.
<a href="https://doi.org/10.1016/j.jtbi.2011.10.039">doi:10.1016/j.jtbi.2011.10.039</a>
</p>
<p>Blumberg S, Funk S, Pulliam JR. Detecting differential transmissibilities that affect the size of self-limited outbreaks. <em>PLoS Pathogens</em>. 2014;10(10):e1004452.
<a href="https://doi.org/10.1371/journal.ppat.1004452">doi:10.1371/journal.ppat.1004452</a>
</p>
<p>Kucharski AJ, Althaus CL. The role of superspreading in Middle East respiratory syndrome coronavirus (MERS-CoV) transmission. <em>Eurosurveillance</em>. 2015;20(25):21167.
<a href="https://doi.org/10.2807/1560-7917.ES2015.20.25.21167">doi:10.2807/1560-7917.ES2015.20.25.21167</a>
</p>
<p>Endo A, Abbott S, Kucharski AJ, Funk S. Estimating the overdispersion in COVID-19 transmission using outbreak sizes outside China. <em>Wellcome Open Research</em>. 2020;5:67.
<a href="https://doi.org/10.12688/wellcomeopenres.15842.3">doi:10.12688/wellcomeopenres.15842.3</a>
</p>
<p>Zhao S, Chong MK, Ryu S, Guo Z, He M, Chen B, Musa SS, Wang J, Wu Y, He D, Wang MH. Characterizing superspreading potential of infectious disease: Decomposition of individual transmissibility. <em>PLoS Computational Biology</em>. 2022;18(6):e1010281.
<a href="https://doi.org/10.1371/journal.pcbi.1010281">doi:10.1371/journal.pcbi.1010281</a>
</p>


<h3>See Also</h3>

<p><code>d_offspringdistn</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## an example to generate 1000 rv of final outbreak size
table(r_outbreakdistn(
  n = 1000,
  seed.size = 1,
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = "D",
  upr.limit = 10
))




## an attempt to reproduce the results in Guo, et al. (2022)
## paper doi link: https://doi.org/10.1016/j.jinf.2022.05.041 (see Fig 1B),
## where the probability of one seed case generating an outbreak with final size &gt;= a given number,
## with parameter R of 0.78 and k of 0.10 under NB distribution.
plot(1:100, 1 - c(0,cumsum(d_outbreakdistn(
  x = 1:99,
  seed.size = 1,
  epi.para = list(mean = 0.78, disp = 0.10, shift = 0.2),
  offspring.type = "NB",
))), log = 'y', type = 'l', xlab = 'outbreak size', ylab = 'probability')
plot(1:100, c(1,p_outbreakdistn(
  q = 1:99,
  seed.size = 1,
  epi.para = list(mean = 0.78, disp = 0.10, shift = 0.2),
  offspring.type = "NB",
  lower.tail = FALSE
)), log = 'y', type = 'l', xlab = 'outbreak size', ylab = 'probability')



</code></pre>


</div>