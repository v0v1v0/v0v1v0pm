<div class="container">

<table style="width: 100%;"><tr>
<td>tailoffspringQ</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The "20/80" rule</h2>

<h3>Description</h3>

<p>To calculate proportion of (<code>Q</code>) offspring cases generated from proportion of (<code>P</code>) the most infectious index cases with pre-defined epidemiological parameters for the offspring distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tailoffspringQ(
  P = 0.2,
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = "D",
  n.seed = 1000
)

mostinfectiousP(
  Q = 0.8,
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = "D",
  n.seed = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>P, Q</code></td>
<td>
<p>A scalar, or a vector of probability (i.e., ranging from 0 to 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epi.para</code></td>
<td>
<p>A list (<code>list</code>) of pre-defined epidemiological parameters for offspring distribution, in the format of <code>list(mean = ?, disp = ?, shift = ?)</code>,
where the three parameters accept non-negative values.
Each parameter must be a scalar.
For Delaporte distribution, the value of <code>mean</code> should be larger than the value of <code>shift</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offspring.type</code></td>
<td>
<p>A character label (<code>character</code>) indicating the type of distribution used to describe the offspring distribution.
It only accepts one of the following values:
</p>

<ul>
<li>
<p><code>"D"</code> indicates the <em>Delaporte</em> distribution, 
</p>
</li>
<li>
<p><code>"NB"</code> indicates the <em>negative binomial</em> distribution, 
</p>
</li>
<li>
<p><code>"G"</code> indicates the <em>geometric</em> distribution, or 
</p>
</li>
<li>
<p><code>"P"</code> indicates the <em>Poisson</em> distribution. 
</p>
</li>
</ul>
<p>By default, <code>offspring.type = 'D'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.seed</code></td>
<td>
<p>A positive integer, for the number of seeds used to solve <code>P</code> or <code>Q</code> numerically.
By default, <code>n.seed = 1000</code>, and no need to change the default setting here unless for special reasons.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Function <code>tailoffspringQ()</code> returns the proportion of (<code>Q</code>) offspring cases generated from proportion of (<code>P</code>) index cases, where (<code>P</code>) is given.
</p>
<p>Function <code>mostinfectiousP()</code> returns the proportion of (<code>P</code>) index cases that generated proportion of (<code>Q</code>) offspring cases, where (<code>Q</code>) is given.
</p>


<h3>Note</h3>

<p>When <code>n.seed</code> is large, e.g., <code>n.seed</code> &gt; 100000, the functions could take minutes to complete.
As such, we do not recommend the users to change the default setting of <code>n.seed</code> unless for special reasons.
</p>
<p>Each parameter in <code>epi.para = list(mean = ?, disp = ?, shift = ?)</code> should be a scalar, which means vector is not allowed here.
</p>


<h3>References</h3>

<p>Lloyd-Smith JO, Schreiber SJ, Kopp PE, Getz WM. Superspreading and the effect of individual variation on disease emergence. <em>Nature</em>. 2005;438(7066):355-359.
<a href="https://doi.org/10.1038/nature04153">doi:10.1038/nature04153</a>
</p>
<p>Endo A, Abbott S, Kucharski AJ, Funk S. Estimating the overdispersion in COVID-19 transmission using outbreak sizes outside China. <em>Wellcome Open Research</em>. 2020;5:67.
<a href="https://doi.org/10.12688/wellcomeopenres.15842.3">doi:10.12688/wellcomeopenres.15842.3</a>
</p>
<p>Adam DC, Wu P, Wong JY, Lau EH, Tsang TK, Cauchemez S, Leung GM, Cowling BJ. Clustering and superspreading potential of SARS-CoV-2 infections in Hong Kong. <em>Nature Medicine</em>. 2020;26(11):1714-9.
<a href="https://doi.org/10.1038/s41591-020-1092-0">doi:10.1038/s41591-020-1092-0</a>
</p>
<p>Zhao S, Chong MK, Ryu S, Guo Z, He M, Chen B, Musa SS, Wang J, Wu Y, He D, Wang MH. Characterizing superspreading potential of infectious disease: Decomposition of individual transmissibility. <em>PLoS Computational Biology</em>. 2022;18(6):e1010281.
<a href="https://doi.org/10.1371/journal.pcbi.1010281">doi:10.1371/journal.pcbi.1010281</a>
</p>


<h3>See Also</h3>

<p><code>d_offspringdistn</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">


## reproducing the results in Endo, et al. (2020) https://doi.org/10.12688/wellcomeopenres.15842.3,
## where ~80% offspring cases were generated from ~10% index cases
## with parameters R of ~2.5 (ranging from 2 to 3) and
## k of ~0.1 (ranging from 0.05 to 0.20) under NB distribution.
tailoffspringQ(
  P = 0.10,
  epi.para = list(mean = 2.5, disp = 0.10, shift = 0.2),
  offspring.type = "NB"
)
mostinfectiousP(
  Q = 0.80,
  epi.para = list(mean = 2.5, disp = 0.10, shift = 0.2),
  offspring.type = "NB"
)


## reproducing the results in Adam, et al. (2020) https://doi.org/10.1038/s41591-020-1092-0,
## where ~80% offspring cases were generated from ~19% index cases
## with parameters R of 0.58 and k of 0.43 under NB distribution.
tailoffspringQ(
  P = 0.19,
  epi.para = list(mean = 0.58, disp = 0.43, shift = 0.2),
  offspring.type = "NB"
)
mostinfectiousP(
  Q = 0.80,
  epi.para = list(mean = 0.58, disp = 0.43, shift = 0.2),
  offspring.type = "NB"
)



</code></pre>


</div>