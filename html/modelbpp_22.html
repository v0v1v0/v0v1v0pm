<div class="container">

<table style="width: 100%;"><tr>
<td>model_set</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>BIC Posterior Probabilities
of Neighboring Models</h2>

<h3>Description</h3>

<p>Identify neighboring
models, fit them, and return the
BIC posterior probabilities.
</p>


<h3>Usage</h3>

<pre><code class="language-R">model_set(
  sem_out,
  partables = NULL,
  model_set_out = NULL,
  prior_sem_out = NULL,
  must_add = NULL,
  must_not_add = NULL,
  must_drop = NULL,
  must_not_drop = NULL,
  remove_constraints = TRUE,
  exclude_error_cov = TRUE,
  exclude_feedback = TRUE,
  exclude_xy_cov = TRUE,
  df_change_add = 1,
  df_change_drop = 1,
  remove_duplicated = TRUE,
  fit_models = ifelse(!is.null(model_set_out$fit), FALSE, TRUE),
  compute_bpp = TRUE,
  original = "original",
  parallel = FALSE,
  ncores = max(parallel::detectCores(logical = FALSE) - 1, 1),
  make_cluster_args = list(),
  progress = TRUE,
  verbose = TRUE,
  skip_check_sem_out = FALSE,
  drop_equivalent_models = TRUE
)

gen_models(
  sem_out,
  must_add = NULL,
  must_not_add = NULL,
  must_drop = NULL,
  must_not_drop = NULL,
  remove_constraints = TRUE,
  exclude_error_cov = TRUE,
  df_change_add = 1,
  df_change_drop = 1,
  remove_duplicated = TRUE,
  progress = TRUE,
  output = c("partables", "model_set")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sem_out</code></td>
<td>
<p>It can be the output
from an
SEM function. Currently it supports
lavaan::lavaan objects only.
If it is a named list of
lavaan::lavaan objects, then
all arguments for model generation
will be ignored, and models will not
be refitted. Users need to ensure
that the models can be meaningfully
compared because they will not be
checked.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>partables</code></td>
<td>
<p>A <code>partables</code>-class
object, usually generated by
<code>get_add()</code> or <code>get_drop()</code>. A named
list of parameter tables to be fitted
along with the original model in
<code>sem_out</code>.
If supplied, all arguments related
to identifying models will be ignored.
Default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model_set_out</code></td>
<td>
<p>If set to
the output of a previous call
to <code>model_set()</code> (a <code>model_set</code>-class
object), the list of stored models
will be used. All arguments related
to generate neighboring models will
be ignored.
If supplied, <code>sem_out</code> will also be
ignored and will be retrieved from
<code>model_set_out</code>, and <code>partables</code>
will also be ignored.
Default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior_sem_out</code></td>
<td>
<p>The prior of the
model fitted in <code>sem_out</code>. Default
is <code>NULL</code>, and all models will have
equal prior probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>must_add</code></td>
<td>
<p>A character vector
of parameters, named in
<code>lavaan::lavaan()</code> style (e.g.,
<code>"y ~ x"</code>), that must be added.
Default is 'NULL“.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>must_not_add</code></td>
<td>
<p>A character
vector of parameters, named in
<code>lavaan::lavaan()</code> style (e.g.,
<code>"x1 ~~ x1"</code>), that must not be
added. Default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>must_drop</code></td>
<td>
<p>A character vector
of parameters, named in
<code>lavaan::lavaan()</code> style (e.g.,
<code>"y ~ x"</code>), that must be included.
Default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>must_not_drop</code></td>
<td>
<p>A character
vector of parameters, named in
<code>lavaan::lavaan()</code> style (e.g.,
<code>"x1 ~~ x1"</code>), that must not be
included. Default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove_constraints</code></td>
<td>
<p>Whether
equality constraints will be
removed. Default is “TRUE'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude_error_cov</code></td>
<td>
<p>Exclude
error covariances of indicators.
Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude_feedback</code></td>
<td>
<p>Exclude
paths that will result in a feedback
loop. For example, if there is
path from <code>x</code> through <code>m</code> to <code>y</code>,
then the path <code>x ~ y</code> will create
a feedback loop.  Default has been
changed to
<code>TRUE</code> since Version 0.1.3.5 because
feedback loops are usually
not included except when theoretically
justified. To reproduce results
based on previous version, set this
argument to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude_xy_cov</code></td>
<td>
<p>Exclude
covariance between two variables,
in which one has a path to another.
For example, if there is
path from <code>x</code> through <code>m</code> to <code>y</code>,
then the covariance <code>x ~~ y</code>,
which denotes the covariance between
<code>x</code> and the error term of <code>y</code>, will
be excluded if this argument is
<code>TRUE</code>. Default has been changed to
<code>TRUE</code> since Version 0.1.3.5 because
these covariances rarely are
interpretable. To reproduce results
based on previous version, set this
argument to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df_change_add</code></td>
<td>
<p>How many degrees
of freedom (<em>df</em>) away in the list.
All models with <em>df</em> change less than
or equal to this number will be
included, taking into account
requirements set by other arguments.
Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df_change_drop</code></td>
<td>
<p>How many degrees
of freedom away in the list. All
models with <em>df</em> change less than
or equal to this number will be
included, taking into account
requirements set by other arguments.
Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove_duplicated</code></td>
<td>
<p>If <code>TRUE</code>,
the default, duplicated models are
removed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit_models</code></td>
<td>
<p>If <code>TRUE</code>,
the
models will be fitted to the data,
usually stored in <code>sem_out</code>.
If <code>FALSE</code>, the models will be returned
as is, in the element <code>models</code>
of the output. If <code>model_set_out</code>
is set and models have been fitted,
then default is <code>FALSE</code>. Otherwise,
default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compute_bpp</code></td>
<td>
<p>If <code>TRUE</code>, then BIC
posterior probabilities will be
computed. Default
is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>original</code></td>
<td>
<p>String. The name of the
original (traget) model. Default is
<code>"original"</code>. Used if <code>prior_sem_out</code>
is unnamed and only has one value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>If <code>TRUE</code>, parallel
processing will be used to fit the
models. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>Numeric. The number of
CPU cores to be used if <code>parallel</code>
is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>make_cluster_args</code></td>
<td>
<p>A list of
named arguments to be passed to
<code>parallel::makeCluster()</code>. Used by
advanced users to configure the
cluster if <code>parallel</code> is <code>TRUE</code>.
Default is <code>list()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>
<p>Whether a progress
bar will be displayed, implemented
by the <code>pbapply</code> package or by
<code>utils::txtProgressBar</code>. Default
is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Whether additional
messages will be displayed, such
as the expected processing time.
Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skip_check_sem_out</code></td>
<td>
<p>If <code>TRUE</code>
and <code>sem_out</code> is set, check
whether <code>sem_out</code> is of a supported
type (estimator is <code>"ML"</code> and
the model has only one group). If
not, an error will be raised.
Can be set to <code>FALSE</code> for experimenting
the functions on models not officially
supported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop_equivalent_models</code></td>
<td>
<p>If
<code>TRUE</code>, the default, equivalent
models will be dropped in the final
output. This check can only be
conducted when no models are fitted
in <code>lavaan::lavaan()</code> with
<code>fixed.x = TRUE</code> (which is the
default of <code>lavaan::sem()</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>If <code>"model_set"</code>,
then the output is a <code>model_set</code>-class
object. If <code>"partables"</code>, the output
is a <code>partables</code>-class object.
Default is <code>partables</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>It computes the BIC
posterior probabilities of a set
of models by the method presented
in Wu, Cheung, and Leung (2020).
</p>
<p>First, a list of model is identified
based on user-specified criteria.
By default, models differ from a fitted
model by one degree of freedom,
the 1-df-away <em>neighboring</em> models,
will be found using <code>get_add()</code>
and get_drop.
</p>
<p>Second, these models will be fitted
to the sample dataset, and their
BICs will be computed.
</p>
<p>Third, their BIC posterior
probabilities will be computed
using their BICs. By default,
equal prior
probabilities for all the models
being fitted will be assumed in
the current version. This can be
changed by <code>prior_sem_out</code>.
</p>
<p>The results can then be printed,
with the models sorted by descending
order of BIC posterior
probabilities. The results can
also be visualized using
<code>model_graph()</code>.
</p>


<h3>Value</h3>

<p>The function <code>model_set()</code>
returns an object of the class
<code>model_set</code>, a list with the following
major elements:
</p>

<ul>
<li> <p><code>models</code>: A named list of parameter
tables. Each represent the models
identified.
</p>
</li>
<li> <p><code>bic</code>: A numeric vector, of the
same length as <code>model</code>. The BIC of
each model.
</p>
</li>
<li> <p><code>postprob</code>: A numeric vector, of
the same length as <code>model</code>. The
BIC posterior probability of each
model.
</p>
</li>
<li> <p><code>fit</code>: A named list of
<code>lavaan::lavaan()</code> output objects
or <code>update()</code> for fitting a model
with the added parameters, of the
same length as <code>model</code>.
</p>
</li>
<li> <p><code>change</code>: A numeric vector, of the
same length as <code>model</code>. The change
in model df for each fit. A
positive number denotes one less
free parameter. A negative number
denotes one more free parameter or
one less constraint.
</p>
</li>
<li> <p><code>converged</code>: A named vector of
boolean values, of the same length
as <code>model</code>. Indicates whether each
fit converged or not.
</p>
</li>
<li> <p><code>post_check</code>: A named vector of
boolean values, of the same length
as <code>model</code>. Indicates whether the
solution of each fit is admissible
or not. Checked by
<code>lavaan::lavInspect()</code>.
</p>
</li>
</ul>
<p>The object returned by <code>gen_models()</code>
depends on the argument <code>output</code>.
See the argument <code>output</code> for the
details
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>model_set()</code>: Compute the BPPs of a list of models.
Can generate the models and/or fit the models. Can also
accept pregenerated models, or just update BPPs.
</p>
</li>
<li> <p><code>gen_models()</code>: Generate a list of models (parameter tables).
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Shu Fai Cheung <a href="https://orcid.org/0000-0002-9871-9448">https://orcid.org/0000-0002-9871-9448</a>
</p>


<h3>References</h3>

<p>Wu, H., Cheung, S. F., &amp; Leung, S. O.
(2020). Simple use of BIC to assess
model selection uncertainty: An
illustration using mediation and
moderation models.
<em>Multivariate Behavioral Research</em>,
<em>55</em>(1), 1–16.
<a href="https://doi.org/10.1080/00273171.2019.1574546">doi:10.1080/00273171.2019.1574546</a>
</p>


<h3>See Also</h3>

<p><code>print.model_set()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(lavaan)

dat &lt;- dat_path_model

mod &lt;-
"
x3 ~ a*x1 + b*x2
x4 ~ a*x1
ab := a*b
"

fit &lt;- sem(mod, dat_path_model, fixed.x = TRUE)

out &lt;- model_set(fit)
out

</code></pre>


</div>