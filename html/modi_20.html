<div class="container">

<table style="width: 100%;"><tr>
<td>POEM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Nearest Neighbour Imputation with Mahalanobis distance</h2>

<h3>Description</h3>

<p>POEM takes into account missing values, outlier indicators, error indicators
and sampling weights.
</p>


<h3>Usage</h3>

<pre><code class="language-R">POEM(
  data,
  weights,
  outind,
  errors,
  missing.matrix,
  alpha = 0.5,
  beta = 0.5,
  reweight.out = FALSE,
  c = 5,
  preliminary.mean.imputation = FALSE,
  monitor = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame or matrix with the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>sampling weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outind</code></td>
<td>
<p>an indicator vector for the outliers with <code>1</code> indicating
an outlier.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>errors</code></td>
<td>
<p>matrix of indicators for items which failed edits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missing.matrix</code></td>
<td>
<p>the missingness matrix can be given as input. Otherwise,
it will be recalculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>scalar giving the weight attributed to an item that is failing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>minimal overlap to accept a donor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reweight.out</code></td>
<td>
<p>if <code>TRUE</code>, the outliers are redefined.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p>tuning constant when redefining the outliers (cutoff for Mahalanobis
distance).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>preliminary.mean.imputation</code></td>
<td>
<p>assume the problematic observation is at
the mean of good observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>monitor</code></td>
<td>
<p>if <code>TRUE</code> verbose output.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>POEM</code> assumes that an multivariate outlier detection has been carried out
beforehand and assumes the result is summarized in the vector <code>outind</code>.
In addition, further observations may have been flagged as failing edit-rules
and this information is given in the vector <code>errors</code>. The mean and
covariance estimate is calculated with the good observations (no outliers and
downweighted errors). Preliminary mean imputation is sometimes needed to avoid
a non-positive definite covariance estimate at this stage. Preliminary mean
imputation assumes that the problematic values of an observation (with errors,
outliers or missing) can be replaced by the mean of the rest of the non-problematic
observations. Note that the algorithm imputes these problematic observations
afterwards and therefore the final covariance matrix with imputed data is not
the same as the working covariance matrix (which may be based on preliminary mean
imputation).
</p>


<h3>Value</h3>

<p><code>POEM</code> returns a list whose first component <code>output</code> is a
sub-list with the following components:
</p>

<dl>
<dt><code>preliminary.mean.imputation</code></dt>
<dd>
<p>Logical. <code>TRUE</code> if preliminary
mean imputation should be used</p>
</dd>
<dt><code>completely.missing</code></dt>
<dd>
<p>Number of observations with no observed values</p>
</dd>
<dt><code>good.values</code></dt>
<dd>
<p>Weighted number of of good values (not missing, not
outlying, not erroneous)</p>
</dd>
<dt><code>nonoutliers.before</code></dt>
<dd>
<p>Number of nonoutliers before reweighting</p>
</dd>
<dt><code>weighted.nonoutliers.before</code></dt>
<dd>
<p>Weighted number of nonoutliers
before reweighting</p>
</dd>
<dt><code>nonoutliers.after</code></dt>
<dd>
<p>Number of nonoutliers after reweighting</p>
</dd>
<dt><code>weighted.nonoutliers.after</code></dt>
<dd>
<p>Weighted number of nonoutliers after
reweighting</p>
</dd>
<dt><code>old.center</code></dt>
<dd>
<p>Coordinate means after weighting, before imputation</p>
</dd>
<dt><code>old.variances</code></dt>
<dd>
<p>Coordinate variances after weighting, before imputation</p>
</dd>
<dt><code>new.center</code></dt>
<dd>
<p>Coordinate means after weighting, after imputation</p>
</dd>
<dt><code>new.variances</code></dt>
<dd>
<p>Coordinate variances after weighting, after imputation</p>
</dd>
<dt><code>covariance</code></dt>
<dd>
<p>Covariance (of standardised observations) before imputation</p>
</dd>
<dt><code>imputed.observations</code></dt>
<dd>
<p>Indices of observations with imputed values</p>
</dd>
<dt><code>donors</code></dt>
<dd>
<p>Indices of donors for imputed observations</p>
</dd>
<dt><code>new.outind</code></dt>
<dd>
<p>Indices of new outliers</p>
</dd>
</dl>
<p>The further component returned by <code>POEM</code> is:
</p>

<dl>
<dt><code>imputed.data</code></dt>
<dd>
<p>Imputed data set</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Beat Hulliger
</p>


<h3>References</h3>

<p>BÃ©guin, C. and Hulliger B., (2002), EUREDIT Workpackage x.2
D4-5.2.1-2.C Develop and evaluate new methods for statistical outlier
detection and outlier robust multivariate imputation, Technical report,
EUREDIT 2002.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(bushfirem, bushfire.weights)
outliers &lt;- rep(0, nrow(bushfirem))
outliers[31:38] &lt;- 1
imp.res &lt;- POEM(bushfirem, bushfire.weights, outliers,
preliminary.mean.imputation = TRUE)
print(imp.res$output)
var(imp.res$imputed.data)
</code></pre>


</div>