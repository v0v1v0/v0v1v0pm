<div class="container">

<table style="width: 100%;"><tr>
<td>TRC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Transformed rank correlations for multivariate outlier detection</h2>

<h3>Description</h3>

<p><code>TRC</code> starts from bivariate Spearman correlations and obtains
a positive definite covariance matrix by back-transforming robust
univariate medians and mads of the eigenspace. <code>TRC</code> can cope
with missing values by a regression imputation using the a robust
regression on the best predictor and it takes sampling weights
into account.
</p>


<h3>Usage</h3>

<pre><code class="language-R">TRC(
  data,
  weights,
  overlap = 3,
  mincor = 0,
  robust.regression = "rank",
  gamma = 0.5,
  prob.quantile = 0.75,
  alpha = 0.05,
  md.type = "m",
  monitor = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame or matrix with the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>sampling weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overlap</code></td>
<td>
<p>minimum number of jointly observed values for calculating
the rank correlation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mincor</code></td>
<td>
<p>minimal absolute correlation to impute.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust.regression</code></td>
<td>
<p>type of regression: <code>"irls"</code> is iteratively
reweighted least squares M-estimator, <code>"rank"</code> is based on the rank
correlations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>minimal number of jointly observed values to impute.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob.quantile</code></td>
<td>
<p>if mads are 0, try this quantile of absolute deviations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p><code>(1 - alpha)</code> Quantile of F-distribution is used for cut-off.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>md.type</code></td>
<td>
<p>type of Mahalanobis distance when missing values occur:
<code>"m"</code> marginal (default), <code>"c"</code> conditional.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>monitor</code></td>
<td>
<p>if <code>TRUE</code>, verbose output.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>TRC</code> is similar to a one-step OGK estimator where the starting
covariances are obtained from rank correlations and an ad hoc missing
value imputation plus weighting is provided.
</p>


<h3>Value</h3>

<p><code>TRC</code> returns a list whose first component <code>output</code> is a
sublist with the following components:
</p>

<dl>
<dt><code>sample.size</code></dt>
<dd>
<p>Number of observations</p>
</dd>
<dt><code>number.of.variables</code></dt>
<dd>
<p>Number of variables</p>
</dd>
<dt><code>number.of.missing.items</code></dt>
<dd>
<p>Number of missing values</p>
</dd>
<dt><code>significance.level</code></dt>
<dd>
<p><code>1 - alpha</code></p>
</dd>
<dt><code>computation.time</code></dt>
<dd>
<p>Elapsed computation time</p>
</dd>
<dt><code>medians</code></dt>
<dd>
<p>Componentwise medians</p>
</dd>
<dt><code>mads</code></dt>
<dd>
<p>Componentwise mads</p>
</dd>
<dt><code>center</code></dt>
<dd>
<p>Location estimate</p>
</dd>
<dt><code>scatter</code></dt>
<dd>
<p>Covariance estimate</p>
</dd>
<dt><code>robust.regression</code></dt>
<dd>
<p>Input parameter</p>
</dd>
<dt><code>md.type</code></dt>
<dd>
<p>Input parameter</p>
</dd>
<dt><code>cutpoint</code></dt>
<dd>
<p>The default threshold MD-value for the cut-off of outliers</p>
</dd>
</dl>
<p>The further components returned by <code>TRC</code> are:
</p>

<dl>
<dt><code>outind</code></dt>
<dd>
<p>Indicator of outliers</p>
</dd>
<dt><code>dist</code></dt>
<dd>
<p>Mahalanobis distances (with missing values)</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Beat Hulliger
</p>


<h3>References</h3>

<p>BÃ©guin, C. and Hulliger, B. (2004) Multivariate outlier detection in
incomplete survey data: the epidemic algorithm and transformed rank correlations,
JRSS-A, 167, Part 2, pp. 275-294.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(bushfirem, bushfire.weights)
det.res &lt;- TRC(bushfirem, weights = bushfire.weights)
PlotMD(det.res$dist, ncol(bushfirem))
print(det.res)
</code></pre>


</div>