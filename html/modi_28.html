<div class="container">

<table style="width: 100%;"><tr>
<td>Winsimp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Winsorization followed by imputation</h2>

<h3>Description</h3>

<p>Winsorization of outliers according to the Mahalanobis distance
followed by an imputation under the multivariate normal model.
Only the outliers are winsorized. The Mahalanobis distance MDmiss
allows for missing values.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Winsimp(data, center, scatter, outind, seed = 1000003)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame with the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>(robust) estimate of the center (location) of the observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scatter</code></td>
<td>
<p>(robust) estimate of the scatter (covariance-matrix) of the
observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outind</code></td>
<td>
<p>logical vector indicating outliers with 1 or TRUE for outliers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>seed for random number generator.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>It is assumed that <code>center</code>, <code>scatter</code> and <code>outind</code>
stem from a multivariate outlier detection algorithm which produces
robust estimates and which declares outliers observations with a large
Mahalanobis distance. The cutpoint is calculated as the least (unsquared)
Mahalanobis distance among the outliers. The winsorization reduces the
weight of the outliers:
</p>
<p style="text-align: center;"><code class="reqn">\hat{y}_i = \mu_R + (y_i - \mu_R) \cdot c/d_i</code>
</p>

<p>where <code class="reqn">\mu_R</code> is the robust center and <code class="reqn">d_i</code> is the (unsquared) Mahalanobis
distance of observation i.
</p>


<h3>Value</h3>

<p><code>Winsimp</code> returns a list whose first component <code>output</code> is a
sublist with the following components:
</p>

<dl>
<dt><code>cutpoint</code></dt>
<dd>
<p>Cutpoint for outliers</p>
</dd>
<dt><code>proc.time</code></dt>
<dd>
<p>Processing time</p>
</dd>
<dt><code>n.missing.before</code></dt>
<dd>
<p>Number of missing values before imputation</p>
</dd>
<dt><code>n.missing.after</code></dt>
<dd>
<p>Number of missing values after imputation</p>
</dd>
</dl>
<p>The further component returned by <code>winsimp</code> is:
</p>

<dl>
<dt><code>imputed.data</code></dt>
<dd>
<p>Imputed data set</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Beat Hulliger
</p>


<h3>References</h3>

<p>Hulliger, B. (2007), Multivariate Outlier Detection and Treatment
in Business Surveys, Proceedings of the III International Conference on
Establishment Surveys, Montr√©al.
</p>


<h3>See Also</h3>

<p><code>MDmiss</code>. Uses <code>imp.norm</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(bushfirem, bushfire.weights)
det.res &lt;- TRC(bushfirem, weight = bushfire.weights)
imp.res &lt;- Winsimp(bushfirem, det.res$center, det.res$scatter, det.res$outind)
print(imp.res$n.missing.after)
</code></pre>


</div>