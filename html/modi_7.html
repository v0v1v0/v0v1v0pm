<div class="container">

<table style="width: 100%;"><tr>
<td>EAimp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Epidemic Algorithm for imputation of multivariate outliers in incomplete
survey data.</h2>

<h3>Description</h3>

<p>After running <code>EAdet</code> an imputation of the detected outliers with
<code>EAimp</code> may be run.
</p>


<h3>Usage</h3>

<pre><code class="language-R">EAimp(
  data,
  weights,
  outind,
  reach = "max",
  transmission.function = "root",
  power = ncol(data),
  distance.type = "euclidean",
  duration = 5,
  maxl = 5,
  kdon = 1,
  monitor = FALSE,
  threshold = FALSE,
  deterministic = TRUE,
  fixedprop = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame or matrix with the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>a vector of positive sampling weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outind</code></td>
<td>
<p>a logical vector with component <code>TRUE</code> for outliers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reach</code></td>
<td>
<p>reach of the threshold function (usually set to the maximum
distance to a nearest neighbour, see internal function <code>EA.dist</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transmission.function</code></td>
<td>
<p>form of the transmission function of distance d:
<code>"step"</code> is a heaviside function which jumps to <code>1</code> at <code>d0</code>,
<code>"linear"</code> is linear between <code>0</code> and <code>d0</code>, <code>"power"</code> is
<code>beta*d+1^(-p)</code> for <code>p=ncol(data)</code> as default, <code>"root"</code> is the
function <code>1-(1-d/d0)^(1/maxl)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>sets <code>p=power</code>, where <code>p</code> is the parameter in the above
transmission function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance.type</code></td>
<td>
<p>distance type in function <code>dist()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>duration</code></td>
<td>
<p>the duration of the detection epidemic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxl</code></td>
<td>
<p>maximum number of steps without infection.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kdon</code></td>
<td>
<p>the number of donors that should be infected before imputation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>monitor</code></td>
<td>
<p>if <code>TRUE</code> verbose output on epidemic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>Infect all remaining points with infection probability above
the threshold <code>1-0.5^(1/maxl)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deterministic</code></td>
<td>
<p>if <code>TRUE</code> the number of infections is the expected
number and the infected observations are the ones with largest infection
probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixedprop</code></td>
<td>
<p>if <code>TRUE</code> a fixed proportion of observations is infected
at each step.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>EAimp</code> uses the distances calculated in <code>EAdet</code> (actually the
counterprobabilities, which are stored in a global data set) and starts an
epidemic at each observation to be imputed until donors for the missing values
are infected. Then a donor is selected randomly.
</p>


<h3>Value</h3>

<p><code>EAimp</code> returns a list with two components: <code>parameters</code> and
<code>imputed.data</code>.
<code>parameters</code> contains the following elements:
</p>

<dl>
<dt><code>sample.size</code></dt>
<dd>
<p>Number of observations</p>
</dd>
<dt><code>number.of.variables</code></dt>
<dd>
<p>Number of variables</p>
</dd>
<dt><code>n.complete.records</code></dt>
<dd>
<p>Number of records without missing values</p>
</dd>
<dt><code>n.usable.records</code></dt>
<dd>
<p>Number of records with less than half of values
missing (unusable observations are discarded)</p>
</dd>
<dt><code>duration</code></dt>
<dd>
<p>Duration of epidemic</p>
</dd>
<dt><code>reach</code></dt>
<dd>
<p>Transmission distance (<code>d0</code>)</p>
</dd>
<dt><code>threshold</code></dt>
<dd>
<p>Input parameter</p>
</dd>
<dt><code>deterministic</code></dt>
<dd>
<p>Input parameter</p>
</dd>
<dt><code>computation.time</code></dt>
<dd>
<p>Elapsed computation time</p>
</dd>
</dl>
<p><code>imputed.data</code> contains the imputed data.
</p>


<h3>Author(s)</h3>

<p>Beat Hulliger
</p>


<h3>References</h3>

<p>BÃ©guin, C. and Hulliger, B. (2004) Multivariate outlier detection in
incomplete survey data: the epidemic algorithm and transformed rank correlations,
JRSS-A, 167, Part 2, pp. 275-294.
</p>


<h3>See Also</h3>

<p><code>EAdet</code> for outlier detection with the Epidemic Algorithm.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(bushfirem, bushfire.weights)
det.res &lt;- EAdet(bushfirem, bushfire.weights)
imp.res &lt;- EAimp(bushfirem, bushfire.weights, outind = det.res$outind, kdon = 3)
print(imp.res$output)
</code></pre>


</div>