<div class="container">

<table style="width: 100%;"><tr>
<td>mlGVAR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit GVAR models with multilevel data</h2>

<h3>Description</h3>

<p>Fits a graphical vector autoregressive model to data containing multiple time
points measured for multiple individuals.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mlGVAR(
  data,
  m = NULL,
  selectFUN = NULL,
  subjectNets = FALSE,
  idvar = "ID",
  exogenous = TRUE,
  center = TRUE,
  scale = TRUE,
  fixedType = "g",
  betweenType = "g",
  centerWithin = TRUE,
  scaleWithin = FALSE,
  rule = "OR",
  threshold = "none",
  verbose = TRUE,
  pcor = FALSE,
  fixedArgs = NULL,
  betweenArgs = NULL,
  bm = FALSE,
  beepno = NULL,
  dayno = NULL,
  deleteMissing = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p><code>n x k</code> dataframe or matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>Character vector or numeric vector indicating the moderator(s), if
any. Can also specify <code>"all"</code> to make every variable serve as a
moderator, or <code>0</code> to indicate that there are no moderators. If the
length of <code>m</code> is <code>k - 1</code> or longer, then it will not be possible
to have the moderators as exogenous variables. Thus, <code>exogenous</code> will
automatically become <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selectFUN</code></td>
<td>
<p>Choose a variable selection function. Can specify either
<code>"varSelect"</code> or <code>"resample"</code> to use the corresponding functions.
If you want to use the <code>resample</code> function though, then it is
recommended to specify <code>selectFUN</code> as one of: <code>"stability",
  "split", "bootstrap"</code> in order to identify the specific method. If
<code>selectFUN = "resample"</code>, then it is recommended to add the
<code>sampMethod</code> argument to the call to <code>mlGVAR</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subjectNets</code></td>
<td>
<p>If <code>TRUE</code>, then subject-specific networks are fit for
all subjects and returned in the final output. Otherwise, can specify a
single value or a vector of values to represent which subjects to return
individual networks for â€“ specifically, the SUR network. One caveat is
that variable selection methods are not applied to these subject-specific
networks. Further modeling could be done using the output, however.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idvar</code></td>
<td>
<p>Character string to indicate which variable contains the
participant identification numbers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exogenous</code></td>
<td>
<p>Logical. Indicates whether moderator variables should be
treated as exogenous or not. If they are exogenous, they will not be
modeled as outcomes/nodes in the network. If the number of moderators
reaches <code>k - 1</code> or <code>k</code>, then <code>exogenous</code> will automatically
be <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>Logical. Determines whether to mean-center the variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>Logical. Determines whether to standardize the variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixedType</code></td>
<td>
<p>If logical, then any variable selection procedure specified
by <code>selectFUN</code> will not be applied to the SUR network. Alternatively,
a variable selection result, such as the output from either
<code>varSelect</code> or <code>modSelect</code>, can be supplied to
choose a specific constrained model in advance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betweenType</code></td>
<td>
<p>If logical, then any variable selection procedure
specified by <code>selectFUN</code> will not be applied to the SUR network.
Alternatively, a variable selection result, such as the output from either
<code>varSelect</code> or <code>modSelect</code>, can be supplied to
choose a specific constrained model in advance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centerWithin</code></td>
<td>
<p>Following the application of <code>center</code> and
<code>scale</code>, this determines whether to center variables within individual
subjects to create subject-centered values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaleWithin</code></td>
<td>
<p>Following the application of <code>center</code> and
<code>scale</code>, this determines whether to scale variables within individual
subjects to create subject-standardized values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rule</code></td>
<td>
<p>Only applies to the between-subject network when a threshold is
supplied. The <code>"AND"</code> rule will only preserve edges when both
corresponding coefficients have p-values below the threshold, while the
<code>"OR"</code> rule will preserve an edge so long as one of the two
coefficients have a p-value below the supplied threshold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>Logical or numeric. If <code>TRUE</code>, then a default value of
.05 will be set. Indicates whether a threshold should be placed on the
models at each iteration of the sampling. A significant choice by the
researcher.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical. Determines whether to output progress bars and
messages in the console during the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pcor</code></td>
<td>
<p>See corresponding argument in the <code>fitNetwork</code>
function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixedArgs</code></td>
<td>
<p>A named list of arguments for the variable selection
function can be provided here, specifically those that are meant to be
applied to the SUR network estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betweenArgs</code></td>
<td>
<p>A named list of arguments for the variable selection
function can be provided for the between-subjects network.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bm</code></td>
<td>
<p>Logical. Determines whether the same moderators are applied in the
between-subjects network. By default, the value of <code>m</code> only applies to
the SUR network. This allows one to decide whether or not to apply those
moderators in the between-subject network.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beepno</code></td>
<td>
<p>Character string or numeric value to indicate which variable
(if any) encodes the survey number within a single day. Must be used in
conjunction with <code>dayno</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dayno</code></td>
<td>
<p>Character string or numeric value to indiciate which variable
(if any) encodes the survey number within a single day. Must be used in
conjunction with <code>beepno</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deleteMissing</code></td>
<td>
<p>Logical. Determines whether to automatically perform
listwise deletion if there are any missing values in the dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Uses a pseudo-mixed effects approach, wherein fixed effects are estimated and
random effects are approximated. See the work of Epskamp et al. (2018) for
more details on how these types of effects are estimated.
</p>


<h3>Value</h3>

<p><code>mlGVAR</code> objects
</p>


<h3>References</h3>

<p>Epskamp, S., Waldorp, L. J., Mottus, R., &amp; Borsboom, B. (2018).
The gaussian graphical model in cross-sectional and time-series data.
Multivariate Behavioral Research. 53, 453-580.
</p>


<h3>See Also</h3>

<p><code>mlGVARsim, lmerVAR, fitNetwork,
  varSelect, resample, net, netInts,
  plotNet</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
fit1 &lt;- mlGVAR(mlgvarDat, 'M')

fit2 &lt;- mlGVAR(mlgvarDat, 'M', bm = TRUE) # Fit the same moderator in the between-subjects network

fit3 &lt;- mlGVAR(mlgvarDat, 'M', selectFUN = 'varSelect')

</code></pre>


</div>