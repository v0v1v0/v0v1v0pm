<div class="container">

<table style="width: 100%;"><tr>
<td>coefH</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Scalability coefficents H
</h2>

<h3>Description</h3>

<p>Computes item-pair scalability coefficents Hij, item scalability coefficents Hi, and scale scalability coefficent H 
(Loevinger, 1948; Mokken, 1971, pp. 148-153; Molenaar &amp; Sijtsma, 2000, pp. 11-13; Sijtsma &amp; Molenaar, chap. 4; Van der Ark, 2007; 2010),  
as well as their standard errors (Kuijpers et al., 2013; also see Van der Ark et al., 2008)
and possibly confidence intervals (Koopman, et al., in press a, in press b). 
Mokken's coefficients and standard errors can also be estimated in two-level data (Koopman et al., in press a).
It is also possible to compare scalability coefficients across groups using the item-step ordering of the entire sample 
(cf. <code>CHECK=GROUPS</code> option in MSP; Molenaar and Sijtsma, 2000). The estimated variance-covariance matrix of the coefficients 
is invisible but can be printed by saving the result, see examples.
</p>


<h3>Usage</h3>

<pre><code class="language-R">coefH(X, se = TRUE, ci = FALSE, nice.output = TRUE, level.two.var = NULL, 
     group.var = NULL, fixed.itemstep.order = NULL, type.ci = "WB", 
     results = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>matrix or data frame of numeric data 
containing the responses of <code>nrow(X)</code> respondents to <code>ncol(X)</code> items. 
Missing values are not allowed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>Logical: If <code>TRUE</code>, the standard errors of the scalability coefficients are given</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>The confidence level between 0 and 1 of the range-preserving confidence intervals. 
If <code>FALSE</code> (default), no confidence intervals are printed (Koopman et al.,in press b).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nice.output</code></td>
<td>
<p>Logical: If <code>TRUE</code>, scalability coefficients and standard errors are combined in an a single object of class <code>noquote</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level.two.var</code></td>
<td>
<p>vector of length <code>nrow(X)</code> or matrix with number of rows equal to <code>nrow(X)</code> 
that indicates the level two variable for nested data to get appropriate standard errors (Koopman et al., in press a.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group.var</code></td>
<td>
<p>vector of length <code>nrow(X)</code> or matrix with number of rows equal to <code>nrow(X)</code> to be used as grouping variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed.itemstep.order</code></td>
<td>
<p>matrix with number of rows equal to the number of item steps (m) and number of columns equal to the number of items (J). 
The matrix should consis the integers 1 : (m * J), indicating a predefined order of the items steps with respect to popularity. 
Value 1 indicates the easiest (most popular) item step, value (m * J) indicates the most difficult item step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type.ci</code></td>
<td>
<p>If <code>WB</code>, Wald-based confidence interval are printed, if <code>RP</code> range-preserving confidence intervals are printed (Koopman et al., in press b, in press c). Default is <code>WB</code>. Used only if <code>ci</code> has been specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>results</code></td>
<td>
<p>Logical: If TRUE results are printed to the screen. Option <code>FALSE</code> is useful only for some internal functions</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>May not work if any of the item variances equals zero. 
Such items should not be used in a test and removed from the data frame.
</p>
<p>If <code>nice.output = TRUE</code> and <code>se = TRUE</code>, the result is a list of 3 objects of class <code>noquote</code>;  
if <code>nice.output = FALSE</code> and <code>se = TRUE</code>, the result is a list of 6 matrices (3 for the scalability coefficients and 3 for the standard errors); and 
if <code>se = FALSE</code>, the result is a list of 3 matrices (for the scalability coefficients);
if <code>ci</code> is specified and <code>se = TRUE</code> or <code>nice.output = FALSE</code>, there is one additional matrix for the ci's of the Hij coefficients;
if <code>level.two.var</code> is not null the standard errors are adjusted to take the nesting into account;
if <code>group.var = Y</code> with Y having K values, an additional element named <code>Groups</code> is added to the list.
Element <code>Groups</code> shows the scalability coefficients per group ordered by means of <code>sort</code> (see <code>Sys.getlocale</code> for details).
<code>group.var</code> returns coefficients for groups containing at least two case.
Computation of standard errors can be slow for a combination of a large sample size and a large number of items.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Hij</code></td>
<td>
<p>scalability coefficients of the item pairs (possibly with standard errors; see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Hi</code></td>
<td>
<p>vector containing scalability coefficients of the items (possibly with standard errors; see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>scalability coefficient of the entire scale (possibly with standard error; see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.Hij</code></td>
<td>
<p>standard errors of the scalability coefficients of the item pairs (only if <code>nice.output = FALSE</code> and <code>se = TRUE</code>; see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.Hi</code></td>
<td>
<p>standard errors of the scalability coefficients of the items (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.H</code></td>
<td>
<p>standard error of the scalability coefficient of the entire scale (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.Hij</code></td>
<td>
<p>confidence intervals of the scalability coefficients of the item pairs (only if <code>nice.output = FALSE</code> and/or <code>se = TRUE</code>; see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.Hi</code></td>
<td>
<p>confidence intervals of the scalability coefficients of the items (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.H</code></td>
<td>
<p>confidence intervals of the scalability coefficient of the entire scale (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Groups</code></td>
<td>
<p>Scalability coefficients for subgroups (see details)</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>L. A. van der Ark <a href="mailto:L.A.vanderArk@uva.nl">L.A.vanderArk@uva.nl</a> 
L. Koopman</p>


<h3>References</h3>

<p>Koopman, L., Zijlstra, B. J. H., &amp; Van der Ark, L. A. (in press a).
A two-step, test-guided Mokken scale analysis for nonclustered and clustered data. 
<em>Quality of Life Research</em>. (advanced online publication)
<a href="https://doi.org/10.1007/s11136-021-02840-2">doi:10.1007/s11136-021-02840-2</a>
</p>
<p>Koopman, L., Zijlstra, B. J. H., &amp; Van der Ark, L. A. (in press b).
Range-preserving confidence intervals and significance tests for scalability coefficients in Mokken scale analysis.
In M. Wiberg, D. Molenaar, J. Gonzalez, &amp; Kim, J.-S. (Eds.),
<em>Quantitative Psychology; The 1st Online Meeting of the Psychometric Society, 2020</em>.
Springer.
<a href="https://doi.org/10.1007/978-3-030-74772-5_16">doi:10.1007/978-3-030-74772-5_16</a>
</p>
<p>Kuijpers, R. E., Van der Ark, L. A., &amp; Croon, M. A. (2013).
Standard errors and confidence intervals for scalability coefficients in Mokken scale analysis using marginal models.
<em>Sociological Methodology, 43,</em> 42-69.
<a href="https://doi.org/10.1177/0081175013481958">doi:10.1177/0081175013481958</a>
</p>
<p>Loevinger, J. (1948). 
The technique of homogeneous tests compared with some aspects of 'scale analysis' and factor analysis.
<em>Psychological Bulletin, 45</em>, 507-530.
</p>
<p>Mokken, R. J. (1971) 
<em>A Theory and Procedure of Scale Analysis</em>. 
De Gruyter.
</p>
<p>Molenaar, I.W., &amp; Sijtsma, K. (2000) 
<em>User's Manual MSP5 for Windows</em> [Software manual].
IEC ProGAMMA.
</p>
<p>Sijtsma, K., &amp; Molenaar, I. W. (2002)
<em>Introduction to nonparametric item response theory</em>.
Sage.
</p>
<p>Van der Ark, L. A. (2007). 
Mokken scale analysis in <span class="pkg">R</span>. 
<em>Journal of Statistical Software, 20</em> (11), 1-19.
<a href="https://doi.org/10.18637/jss.v020.i11">doi:10.18637/jss.v020.i11</a>
</p>
<p>Van der Ark, L. A. (2010). 
Getting started with Mokken scale analysis in <span class="pkg">R</span>. 
Unpublished manuscript.
<a href="https://sites.google.com/a/tilburguniversity.edu/avdrark/mokken">https://sites.google.com/a/tilburguniversity.edu/avdrark/mokken</a>
</p>
<p>Van der Ark, L. A., Croon, M. A., &amp; Sijtsma (2008). 
Mokken scale analysis for dichotomous items using marginal models.
<em>Psychometrika, 73</em>, 183-208.
<a href="https://doi.org/10.1007/s11336-007-9034-z">doi:10.1007/s11336-007-9034-z</a>
</p>


<h3>See Also</h3>

<p><code>coefZ</code>, <code>search.normal</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">data(acl)
Communality &lt;- acl[, 1:10]

# Compute scalability coefficients and standard errors
Hs &lt;- coefH(Communality)

# Compute scalability coefficients, standard errors, and range-preserving confidence intervals
coefH(Communality, ci = .95)

# Scalability coefficients but no standard errors
coefH(Communality, se = FALSE)

# Scalability coefficients for different groups:
subgroup &lt;- ifelse(acl[,11] &lt; 2,1,2)
coefH(Communality, group.var = subgroup)

# Extract variance-covariance matrices
attributes(Hs)
Hs$covHij
Hs$covHi
Hs$covH

# Nested data:
data(autonomySupport)
scores &lt;- autonomySupport[, -1]
classes &lt;- autonomySupport[, 1]
coefH(scores, level.two.var = classes, ci = .95)

</code></pre>


</div>