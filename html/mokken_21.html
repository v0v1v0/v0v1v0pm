<div class="container">

<table style="width: 100%;"><tr>
<td>MLcoefH</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Two-level scalability coefficents H
</h2>

<h3>Description</h3>

<p>Computes all types of two-level scalability coefficients (Snijders, 2001; Crisan et al., 2016),
that is, between- and within-rater item-pair scalability coefficents and their ratio (HBij, HWij, and BWij, respectively),
between- and within-rater item scalability coefficients and their ratio (HBi, HWi, and BWi, respectively),
and between- and within-rater total scale scalability coefficients and their ratio (HB, HW, and BW, respectively).
In addition, standard errors are estimated (Koopman, et al., 2020) and if requested 
incorporated in confidence intervals (Koopman et al., in press a, in press b). Note that this version is an 
adaptation of the estimation methods described in Snijders (1999) and in Koopman et al. (2020), as the group proportions are now by 
default weighted for group size (Koopman, et al. , in press a). As a result, the estimates for the 
autonomySupport data differs from the printed table in Koopman et al. (2020). The estimated variance-covariance matrix 
of the coefficients can also be printed if requested.
</p>


<h3>Usage</h3>

<pre><code class="language-R">    MLcoefH(X, se = TRUE, ci = FALSE, nice.output = TRUE, subject = 1, 
            fixed.itemstep.order = NULL, weigh.props = TRUE, 
            type.ci = "WB", cov.mat = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>matrix or data frame of numeric data containing a subject indicator column and the
responses of <code>nrow(X)</code> raters to <code>ncol(X) - 1</code> items. 
Missing values are not allowed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>Logical: If <code>TRUE</code>, the standard errors are printed alongside the scalability coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>The confidence level between 0 and 1 of the range-preserving confidence intervals. 
If FALSE (default), no confidence intervals are printed (Koopman et al., in press a).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nice.output</code></td>
<td>
<p>Logical: If <code>TRUE</code>, scalability coefficients and standard errors are combined 
in an a single object of class <code>noquote</code>. Item-pair ratios BWij are only printed if <code>FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subject</code></td>
<td>
<p>Represents the subject column. Default is column 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed.itemstep.order</code></td>
<td>
<p>matrix with number of rows equal to the number of item steps (m) and number of columns equal to the number of items (J). 
The matrix should consis the integers 1 : (m * J), indicating a predefined order of the items steps with respect to popularity. 
Value 1 indicates the easiest (most popular) item step, value (m * J) indicates the most difficult item step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weigh.props</code></td>
<td>
<p>If <code>TRUE</code>: Use weighted proportions across groups to estimate coefficients and standard errors, if <code>FALSE</code>: 
Use averaged proportions across groups to estimate coefficients and standard errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type.ci</code></td>
<td>
<p>If <code>WB</code>, Wald-based confidence interval are printed, if <code>RP</code> range-preserving confidence intervals are printed 
(Koopman et al., in press a, in press b). Default is <code>WB</code>. Only used if <code>ci</code> is specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.mat</code></td>
<td>
<p>Logical: If <code>TRUE</code>, the variance-covariance matrices of the estimated coefficients are printed. Default is <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>se = TRUE</code> and <code>nice.output = TRUE</code>, the result is a list of 3 objects of class <code>noquote</code>;  
if <code>se = TRUE</code> and <code>nice.output = FALSE</code>, the result is a list of 3 matrices, one per set of coefficients; and 
if <code>se = FALSE</code>, the result is a list of 3 matrices containing only the scalability coefficients;
if <code>ci</code> is specified and <code>nice.output = TRUE</code>, there is one additional matrix for the ci's of the Hij coefficients.
Computation of standard errors can be slow for a combination of many subjects and a large number of items;
if <code>cov.mat = TRUE</code> three additional matrices are printed with the variance-covariances of Hij, Hi, and H.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Hij</code></td>
<td>
<p>Scalability coefficients of the item pairs, upper triangle are the between-rater coefficients, and the
lower triangle the within-rater coefficients (possibly with standard errors and/or confidence intervals; see details). 
If <code>nice.output = FALSE</code> this returns a matrix with the type of coefficients per column</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Hi</code></td>
<td>
<p>Between- and within-rater scalability coefficients of the items and their ratio (possibly with standard errors and/or confidence intervals; see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>between- and within-rater scalability coefficients of the entire scale and their ratio (possibly with standard error and/or confidence intervals; see details)</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Letty Koopman <a href="mailto:V.E.C.Koopman@uva.nl">V.E.C.Koopman@uva.nl</a>
L. Andries van der Ark <a href="mailto:L.A.vanderArk@uva.nl">L.A.vanderArk@uva.nl</a> 
</p>


<h3>References</h3>

<p>Crisan, D. R., Van de Pol, J. E., &amp; Van der Ark, L. A. (2016). 
Scalability coefficients for two-level polytomous item scores: An introduction and an application. 
In L. A. Van der Ark, D. M. Bolt, W.-C. Wang, &amp; M. Wiberg (Eds.), 
<em>Quantitative psychology research</em>. 
Springer. 
<a href="https://doi.org/10.1007/978-3-319-38759-8_11">doi:10.1007/978-3-319-38759-8_11</a>
</p>
<p>Koopman, L., Zijlstra, B. J. H. &amp; Van der Ark, L. A., (2020). 
Standard errors of two-lvel scalability coefficients. 
<em>British Journal of Statistical and Mathematical Psychology, 73,</em> 213-236. 
<a href="https://doi.org/10.1111/bmsp.12174">doi:10.1111/bmsp.12174</a> 
</p>
<p>Koopman, L., Zijlstra, B. J. H., &amp; Van der Ark, L. A. (in press a).
A two-step, test-guided Mokken scale analysis for nonclustered and clustered data. 
<em>Quality of Life Research</em>. (advanced online publication)
<a href="https://doi.org/10.1007/s11136-021-02840-2">doi:10.1007/s11136-021-02840-2</a>
</p>
<p>Koopman, L., Zijlstra, B. J. H., &amp; Van der Ark, L. A. (in press b).
Range-preserving confidence intervals and significance tests for scalability coefficients in Mokken scale analysis.
In M. Wiberg, D. Molenaar, J. Gonzalez, &amp; Kim, J.-S. (Eds.),
<em>Quantitative Psychology; The 1st Online Meeting of the Psychometric Society, 2020</em>.
Springer.
<a href="https://doi.org/10.1007/978-3-030-74772-5_16">doi:10.1007/978-3-030-74772-5_16</a>
</p>
<p>Snijders, T. A. B. (2001). Two-level non-parametric scaling for dichotomous data. 
In A. Boomsma, M. A. J. van Duijn, &amp; T. A. B. Snijders (Eds.), 
<em>Essays on item response theory</em> (pp. 319-338). 
Springer. 
<a href="https://doi.org/10.1007/978-1-4613-0169-1_17">doi:10.1007/978-1-4613-0169-1_17</a>
</p>


<h3>See Also</h3>

<p><code>MLcoefZ</code>,<code>coefH</code>, 
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Small data example (Koopman et al., 2019)
smallData &lt;- data.frame(Subs = c(1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3),
                        Xa   = c(0, 0, 1, 0, 1, 1, 1, 2, 1, 0, 1, 2, 0, 0, 0), 
                        Xb   = c(0, 0, 1, 0, 2, 2, 2, 1, 2, 1, 2, 2, 1, 1, 0), 
                        Xc   = c(1, 0, 0, 0, 1, 1, 2, 1, 2, 0, 1, 1, 2, 1, 0))

MLcoefH(smallData)

# Compute also the range-preserving confidence intervals
MLcoefH(smallData, ci = .95)

# Print variance-covariance matrices
MLcoefH(smallData, cov.mat = TRUE)

# Load real data example. Note that due to an estimation adaptation (Koopman et al., 2020)
# the results differ from the table in Koopman et al. (2019).
data(autonomySupport)

# Compute scalability coefficients with or without standard errors, range-preserving 
# confidence intervals, nice output
           
 H.se.nice &lt;- MLcoefH(autonomySupport)
 H.se.nice 
 
           
 H.se.not  &lt;- MLcoefH(autonomySupport, nice.output = FALSE)
 H.se.not  
 
           
 H.se.ci.nice &lt;- MLcoefH(autonomySupport, ci = .95)
 H.se.ci.nice
 
           
 H.se.ci.not &lt;- MLcoefH(autonomySupport, ci = .95, nice.output = FALSE)
 H.se.ci.not
 
           
 H.nice    &lt;- MLcoefH(autonomySupport, se = FALSE)
 H.nice    
 
           
 H.not     &lt;- MLcoefH(autonomySupport, se = FALSE, nice.output = FALSE)
 H.not     
 

</code></pre>


</div>