<div class="container">

<table style="width: 100%;"><tr>
<td>rnlp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Posterior sampling for regression parameters
</h2>

<h3>Description</h3>

<p>Gibbs sampler for linear, generalized linear and survival models
under product non-local priors, Zellner's prior and a Normal
approximation to the posterior.
Both sampling conditional on a model and Bayesian model averaging are
implemented (see Details).
</p>
<p>If x and y not specified samples from non-local priors/posteriors with
density proportional to d(theta) N(theta; m, V) are produced,
where d(theta) is the non-local penalty term.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rnlp(y, x, m, V, msfit, outcometype, family, priorCoef, priorGroup,
priorVar, isgroup, niter=10^3, burnin=round(niter/10), thinning=1, pp='norm')
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Vector with observed responses. When <code>class(y)=='Surv'</code>
sampling is based on the Cox partial likelihood, else a linear model
is assumed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Design matrix with all potential predictors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>Mean for the Normal kernel</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>Covariance for the Normal kernel</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>msfit</code></td>
<td>
<p>Object of class <code>msfit</code> returned by
<code>modelSelection</code>. If specified Bayesian model averaging
posterior samples are returned, according to posterior model
probabilities in <code>msfit</code>, and then arguments <code>y</code>,
<code>x</code>, <code>m</code>, <code>V</code> etc. If <code>msfit</code> is missing then
posterior samples under the full model <code>y ~ x</code> are returned</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outcometype</code></td>
<td>
<p>Type of outcome. Possible values are "Continuous",
"glm" or "Survival"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>Assumed family for the family. Some possible values are
"normal", "binomial logit" and "Cox"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priorCoef</code></td>
<td>
<p>Prior distribution for the coefficients. Ignored if
<code>msfit</code> is supplied. Must be object of class
<code>msPriorSpec</code>, e.g. created by <code>momprior</code>,
<code>emomprior</code>, <code>imomprior</code>, <code>zellnerprior</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priorGroup</code></td>
<td>
<p>Prior on grouped coefficients (e.g. categorical
predictors with &gt;2 categories, splines), as passed to <code>modelSelection</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priorVar</code></td>
<td>
<p>Prior on residual variance. Ignored if <code>msfit</code>
supplied. Must be object of class <code>msPriorSpec</code>, e.g. created
with <code>igprior</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>isgroup</code></td>
<td>
<p>Logical vector where <code>TRUE</code> indicates that the
variable is part of a group, e.g. one of several dummy indicators
for a discrete covariate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter</code></td>
<td>
<p>Number of MCMC iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>Number of burn-in MCMC iterations. Defaults to <code>.1*niter</code>. Set to 0 for no burn-in</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thinning</code></td>
<td>
<p>MCMC thinning factor, i.e. only one out of each <code>thinning</code> iterations are reported. Defaults to no thinning</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pp</code></td>
<td>
<p>When <code>msfit</code> is provided this is the method to compute posterior model probabilities,
which determine the sampled models. Can be 'norm' or 'exact', see <code>postProb</code> for details. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The algorithm is implemented for product MOM (pMOM), product iMOM
(piMOM) and product eMOM (peMOM) priors.
The algorithm combines an
orthogonalization that provides low serial correlation
with a latent truncation representation that allows fast sampling.
</p>
<p>When <code>y</code> and <code>x</code> are specified sampling is for the linear
regression posterior.
When argument <code>msfit</code> is left missing, posterior sampling is for
the full model regressing <code>y</code> on all covariates in <code>x</code>.
When <code>msfit</code> is specified each model is drawn with
probability given by <code>postProb(msfit)</code>. In this case, a Bayesian
Model Averaging estimate of the regression coefficients can be
obtained by applying <code>colMeans</code> to the <code>rnlp</code> ouput matrix.
</p>
<p>When <code>y</code> and <code>x</code> are left missing, sampling is from a
density proportional to d(theta) N(theta; m,V), where d(theta) is the
non-local penalty (e.g. d(theta)=prod(theta^(2r)) for the pMOM prior).
</p>


<h3>Value</h3>

<p>Matrix with posterior samples
</p>


<h3>Author(s)</h3>

<p>David Rossell
</p>


<h3>References</h3>

<p>D. Rossell and D. Telesca. Non-local priors for high-dimensional
estimation, 2014. http://arxiv.org/pdf/1402.5107v2.pdf
</p>


<h3>See Also</h3>

<p><code>modelSelection</code> to perform model selection and compute
posterior model probabilities.
For more details on prior specification see <code>msPriorSpec-class</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Simulate data
x &lt;- matrix(rnorm(100*3),nrow=100,ncol=3)
theta &lt;- matrix(c(1,1,0),ncol=1)
y &lt;- x %*% theta + rnorm(100)
fit1 &lt;- modelSelection(y=y, x=x, center=FALSE, scale=FALSE)

th &lt;- rnlp(msfit=fit1, niter=100)
colMeans(th)
</code></pre>


</div>