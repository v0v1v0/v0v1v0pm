<div class="container">

<table style="width: 100%;"><tr>
<td>dpostNIW</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Posterior Normal-IWishart density</h2>

<h3>Description</h3>

<p>dpostNIW evalutes the posterior Normal-IWishart density at (mu,Sigma).
rpostNIW draws independent samples.
This posterior corresponds to a Normal model for the data
</p>
<p>x[i,] ~ N(mu,Sigma) iid i=1,...,n
</p>
<p>under conjugate priors
</p>
<p>mu | Sigma ~ N(mu0, g Sigma)
Sigma      ~ IW(nu0, S0)
</p>


<h3>Usage</h3>

<pre><code class="language-R">dpostNIW(mu, Sigma, x, g=1, mu0=rep(0,length(mu)), nu0=nrow(Sigma)+1, S0,
  logscale=FALSE)

rpostNIW(n, x, g=1, mu0=0, nu0, S0, precision=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>Vector of length p</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>p x p positive-definite covariance matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>n x p data matrix (individuals in rows, variables in columns)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>Prior dispersion parameter for mu</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu0</code></td>
<td>
<p>Prior mean for mu</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu0</code></td>
<td>
<p>Prior degrees of freedom for Sigma</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S0</code></td>
<td>
<p>Prior scale matrix for Sigma, by default set to I/nu0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logscale</code></td>
<td>
<p>set to TRUE to get the log-posterior density</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of samples to draw</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>precision</code></td>
<td>
<p>If set to <code>TRUE</code>, samples from the precision
matrix (inverse of Sigma) are returned instead</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>dpostNIW</code> returns the Normal-IW posterior density evaluated at
(mu,Sigma).
</p>
<p><code>rpostNIW</code> returns a list with two elements. The first element are
posterior draws for the mean. The second element are posterior draws for
the covariance (or its inverse if <code>precision==TRUE</code>). Only
lower-diagonal elements are returned (<code>Sigma[lower.tri(Sigma,diag=TRUE)]</code>).
</p>


<h3>Author(s)</h3>

<p> David Rossell </p>


<h3>See Also</h3>

 <p><code>diwish</code> for the inverse Wishart prior density,
<code>marginalNIW</code> for the integrated likelihood under a
Normal-IW prior</p>


<h3>Examples</h3>

<pre><code class="language-R">#Simulate data
x= matrix(rnorm(100),ncol=2)
#Evaluate posterior at data-generating truth
mu= c(0,0)
Sigma= diag(2)
dpostNIW(mu,Sigma,x=x,g=1,nu0=4,log=FALSE)
</code></pre>


</div>