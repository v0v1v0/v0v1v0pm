<div class="container">

<table style="width: 100%;"><tr>
<td>msPriorSpec-class</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Class "msPriorSpec"</h2>

<h3>Description</h3>

<p>Stores the prior distributions to be used for Bayesian variable selection
in normal regression models.
This class can be used to specify the prior on non-zero regression coefficients,
the model indicator or the nuisance parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">aic()
bic()
bicprior()
ic(penalty)

momprior(taustd=1, tau, tau.adj=10^6, r=1)
imomprior(tau, tau.adj=10^6)
emomprior(tau, tau.adj=10^6)
zellnerprior(taustd=1, tau, tau.adj=10^6)
normalidprior(taustd=1, tau, tau.adj=10^6)

exponentialprior(lambda = 1)

groupmomprior(taustd=1, tau, tau.adj=10^6)
groupimomprior(tau, tau.adj=10^6)
groupemomprior(tau, tau.adj=10^6)
groupzellnerprior(taustd=1, tau, tau.adj=10^6)

modelunifprior()
modelbinomprior(p=0.5)
modelbbprior(alpha.p=1, beta.p=1)
modelcomplexprior(c=1)

igprior(alpha=.01, lambda=.01)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>
<p>Penalty on model dimension, i.e. for the AIC penalty=2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>Prior dispersion parameter for covariates undergoing selection</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taustd</code></td>
<td>
<p>Prior dispersion parameter for covariates undergoing selection.
It is calibrated so that 'taustd=1' equals the unit information prior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau.adj</code></td>
<td>
<p>Prior variance in Normal prior for covariates not undergoing selection</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>MOM prior parameter is <code>2*r</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Prior inclusion probability for binomial prior on model space</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha.p</code></td>
<td>
<p>Beta-binomial prior on model space has parameters alpha.p, beta.p</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.p</code></td>
<td>
<p>Beta-binomial prior on model space has parameters
alpha.p, beta.p</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p>Under the Complexity prior the prior
probability of having k variables in the model is proportional to <code>1/p^(ck)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Inverse gamma prior has parameters alpha/2, lambda/2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p><code>igprior</code> defines an inverse gamma prior with
parameters alpha/2, lambda/2. <code>exponentialprior</code> defines an
exponential prior with rate parameter <code>lambda</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>DISCUSSION OF PRIOR ON PARAMETERS
</p>
<p>Let beta=(beta_1,...,beta_p) be the regression coefficients for
individual variables and delta=(delta_1,...,delta_q) those for grouped
variables (e.g. factors or smooth terms in modelSelection).
</p>
<p>momprior, emomprior, imomprior, zellnerprior and normalid can be priors on
both beta or delta. For further information see the vignette.
</p>
<p>groupzellnerprior is the prior density on delta
</p>
<p style="text-align: center;"><code class="reqn">p_z(\delta; \tau)= \prod_j N(\delta_j; 0, (\tau/p_j)) (X_j'X_j)^{-1}</code>
</p>

<p>where <code class="reqn">X_j</code> are the design matrix columns associated to <code class="reqn">delta_j</code> and p_j=ncol(X_j)
is the number of covariates in the group (for groupmomprior, the term in the
denominator is (p_j +2) instead of p_j). A default
tau=n=nrow(X_j) mimics the unit information prior and implies that the
ratio of variance explained by X_j / residual variance is expected to be
1 a priori. To set the dispersion in terms of unit information prior, taustd
is also available.
</p>
<p>groupmomprior adds a quadratic MOM penalty
</p>
<p>p_m(delta; tau)= p_z(delta; tau * n) prod_j delta_j'X_j'X_jdelta_j ncol(X_j)/(tau * n * p_j / (p_j + 2))
</p>
<p>and analogously for eMOM and iMOM. Note that unlike groupzellnerprior, the nrow(X_j)
factor is already included in the code. This is done to give user introduced tau values
a roughly similar meaning between momprior and groupmomprior.
</p>
<p>DISCUSSION OF PRIOR ON MODELS
</p>
<p>Under the uniform prior, the prior probability of any model is
1 / number of models.
</p>
<p>Under the Binomial, Beta-Binomial and Complexity priors a model with k
out of K active variables has prior probability
P(Z=k) / (K choose k), where
where Z ~ Binomial(K,p),
Z ~ BetaBinomial(K,alpha.p,beta.p)
or for the Complexity prior P(Z=k) proportional to <code>1/K^(c*k)</code>.
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("msPriorSpec",
  ...)</code>, but it is easier to use creator functions.
</p>
<p>For priors on regression coefficients use <code>momprior</code>,
<code>imomprior</code> or <code>emomprior</code>.
For prior on model space <code>modelunifprior</code>, <code>modelbinomprior</code>
<code>modelbbprior</code>, or <code>modelcomplexprior</code>.
For prior on residual variance use <code>igprior</code>.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>priorType</code>:</dt>
<dd>
<p>Object of class <code>"character"</code>. <code>"coefficients"</code> indicates
that the prior is for the non-zero regression coefficients.
<code>"modelIndicator"</code> that it is for the model indicator,
and <code>"nuisancePars"</code> that it is for the nuisance parameteres.
Several prior distributions are available for each choice of <code>priorType</code>,
and these can be speicified in the slot <code>priorDist</code>. </p>
</dd>
<dt>
<code>priorDistr</code>:</dt>
<dd>
<p>Object of class <code>"character"</code>.
If <code>priorType=="coefficients"</code>, <code>priorDistr</code> can be equal to
"pMOM", "piMOM", "peMOM", "zellner", "normalid", "groupMOM" or "groupzellner"
(product moment, product inverse moment, product exponential moment, Zellner prior, normal prior with <code class="reqn">\Sigma=\mathbf{I}</code>, respectively).
If <code>priorType=="modelIndicator"</code>, <code>priorDistr</code> can be equal to "uniform" or "binomial"
to specify a uniform prior (all models equaly likely a priori) or a
binomial prior, or to "complexity" for the Complexity prior of Castillo
et al 2015. For a binomial prior,
the prior inclusion probability for any single variable must be
specified in slot <code>priorPars['p']</code>. For a beta-binomial prior, the
Beta hyper-prior parameters must be in <code>priorPars['alpha.p']</code> and
<code>priorPars['beta.p']</code>.
For the Complexity prior, the prior parameter must be in the slot
<code>priorPars['c']</code>.
If <code>priorType=="nuisancePars"</code>, <code>priorDistr</code> must be equal to "invgamma". This corresponds to an
inverse gamma distribution for the residual variance, with parameters
specified in the slot <code>priorPars</code>.</p>
</dd>
<dt>
<code>priorPars</code>:</dt>
<dd>
<p>Object of class <code>"vector"</code>, where each element must be named.
For <code>priorDistr=='pMOM'</code>, there must be an element "r" (MOM power
is 2r).
For any <code>priorDistr</code> there must be either an element "tau" indicating
the prior dispersion or elements "a.tau" and "b.tau" specifying an
inverse gamma hyper-prior for "tau".
Optionally, there may be an element "tau.adj" indicating the prior
dispersion for the adjustment variables (i.e. not undergoing variable
selection). If not defined, "tau.adj" is set to 0.001 by default.
For <code>priorDistr=='binomial'</code>, there must be either an element "p" specifying the prior inclusion probability
for any single covariate, or a vector with elements "alpha.p" and
"beta.p" specifying a Beta(alpha.p,beta.p) hyper-prior on p.
For <code>priorDistr=='invgamma'</code> there must be elements "alpha" and "lambda". The prior for the residual variance
is an inverse gamma with parameteres <code>.5*alpha</code> and <code>.5*lambda</code>.
</p>
</dd>
</dl>
<h3>Methods</h3>

<p>No methods defined with class "msPriorSpec" in the signature.
</p>


<h3>Note</h3>

<p>When new instances of the class are created a series of check are performed to ensure that a valid prior
specification is produced.
</p>


<h3>Author(s)</h3>

<p>David Rossell
</p>


<h3>References</h3>

<p>Johnson VE, Rossell D. Non-Local Prior Densities for Default Bayesian Hypothesis Tests. Journal of the Royal Statistical Society B, 2010, 72, 143-170
</p>
<p>Johnson VE, Rossell D. Bayesian model selection in high-dimensional
settings. Journal of the American Statistical Association, 107, 498:649-660.
</p>


<h3>See Also</h3>

<p>See also <code>modelSelection</code> for an example of defining an instance of the class
and perform Bayesian model selection.
</p>


<h3>Examples</h3>

<pre><code class="language-R">showClass("msPriorSpec")
</code></pre>


</div>