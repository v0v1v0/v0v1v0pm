<div class="container">

<table style="width: 100%;"><tr>
<td>mombf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Moment and inverse moment Bayes factors for linear models. </h2>

<h3>Description</h3>

<p><code>mombf</code> computes moment Bayes factors to test whether a subset of
regression coefficients are equal to some user-specified value.
<code>imombf</code> computes inverse moment Bayes factors.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mombf(lm1, coef, g, prior.mode, baseDensity='normal', nu=3, theta0,
logbf=FALSE, B=10^5)
imombf(lm1, coef, g, prior.mode, nu = 1, theta0 , method='adapt',
nquant=100, B = 10^5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>lm1</code></td>
<td>
<p> Linear model fit, as returned by <code>lm1</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>
<p> Vector with indexes of coefficients to be
tested. e.g. <code>coef==c(2,3)</code>
and <code>theta0==c(0,0)</code> tests <code>coef(lm1)[2]=coef(lm1)[3]=0</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p> Vector with prior parameter values. See <code>dmom</code> and
<code>dimom</code> for details. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.mode</code></td>
<td>
<p> If specified, <code>g</code> is set such that the prior
mode is <code>prior.mode</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>baseDensity</code></td>
<td>
<p>Density upon which the Mom prior is
based. <code>baseDensity=='normal'</code> results in the normal Mom prior,
<code>baseDensity=='t'</code> in the t Mom prior with <code>nu</code> degrees of freedom.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>For <code>mombf</code>, <code>nu</code> specifies the degrees of freedom
of the t Mom prior. It is ignored unless
<code>baseDensity=='t'</code>. <code>nu</code> defaults to 3.
For <code>imombf</code>, <code>nu</code> specifies the degrees of freedom for
the inverse moment prior (see
<code>dimom</code> for details). Defaults to <code>nu=1</code>, which Cauchy-like
tails.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta0</code></td>
<td>
<p> Null value for the regression coefficients. Defaults to
0. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logbf</code></td>
<td>
<p> If <code>logbf==TRUE</code> the natural logarithm of the Bayes
factor is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p> Numerical integration method to compute the bivariate
integral (only used by <code>imombf</code>).
For <code>method=='adapt'</code>, the inner integral is evaluated (via <code>integrate</code>) at a series of
<code>nquant</code> quantiles of the residual variance posterior distribution, and then
averaged as described in Johnson (1992).
Set <code>method=='MC'</code> to use Monte Carlo integration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nquant</code></td>
<td>
<p> Number of quantiles at which to evaluate the integral
for known <code>sigma</code>. Only used if <code>method=='adapt'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Number of Monte Carlo samples to estimate the T Mom and the inverse moment
Bayes factor. Only used in <code>mombf</code> if <code>baseDensity=='t'</code>. Only used in <code>imombf</code> if <code>method=='MC'</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These functions actually call <code>momunknown</code> and
<code>imomunknown</code>, but they have a simpler interface.
See <code>dmom</code> and <code>dimom</code> for details on the moment and inverse
moment priors.
</p>


<h3>Value</h3>

<p><code>mombf</code> returns the moment Bayes factor to compare the model where
<code>theta!=theta0</code>
with the null model where <code>theta==theta0</code>. Large values favor the
alternative model; small values favor the null.
<code>imombf</code> returns
inverse moment Bayes factors.
</p>


<h3>Author(s)</h3>

<p> David Rossell </p>


<h3>References</h3>

<p> See http://rosselldavid.googlepages.com for technical
reports.
For details on the quantile integration, see Johnson, V.E. A Technique for Estimating Marginal Posterior Densities in Hierarchical Models
Using Mixtures of Conditional Densities. Journal of the American Statistical Association, Vol. 87, No. 419. (Sep., 1992), pp. 852-860.
</p>


<h3>See Also</h3>

<p><code>nlpMarginal</code> for a better interface to
integrated likelihoods and <code>modelSelection</code> to also
search over the model space</p>


<h3>Examples</h3>

<pre><code class="language-R">##compute Bayes factor for Hald's data
data(hald)
lm1 &lt;- lm(hald[,1] ~ hald[,2] + hald[,3] + hald[,4] + hald[,5])

# Set g so that interval (-0.2,0.2) has 5% prior probability
# (in standardized effect size scale)
priorp &lt;- .05; q &lt;- .2
gmom &lt;- priorp2g(priorp=priorp,q=q,prior='normalMom')
gimom &lt;- priorp2g(priorp=priorp,q=q,prior='iMom')

mombf(lm1,coef=2,g=gmom) #moment BF
imombf(lm1,coef=2,g=gimom,B=10^5) #inverse moment BF

</code></pre>


</div>