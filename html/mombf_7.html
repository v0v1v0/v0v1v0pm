<div class="container">

<table style="width: 100%;"><tr>
<td>bfnormmix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Number of Normal mixture components under Normal-IW and
Non-local priors</h2>

<h3>Description</h3>

<p>Posterior sampling and Bayesian model selection to choose the number
of components k in multivariate Normal mixtures.
</p>
<p><code>bfnormmix</code> computes posterior probabilities under non-local
MOM-IW-Dir(q) priors, and also for local Normal-IW-Dir(q.niw) priors.
It also computes posterior probabilities on cluster occupancy
and posterior samples on the model parameters for several k.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bfnormmix(x, k=1:2, mu0=rep(0,ncol(x)), g, nu0, S0, q=3, q.niw=1,
B=10^4, burnin= round(B/10), logscale=TRUE, returndraws=TRUE, verbose=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>n x p input data matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Number of components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu0</code></td>
<td>
<p>Prior on mu[j] is N(mu0,g Sigma[j])</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>Prior on mu[j] is N(mu0,g Sigma[j]). This is a critical MOM-IW prior
parameter that specifies the separation between
components deemed practically relevant. It defaults to assigning 0.95
prior probability to any pair of mu's giving a bimodal mixture, see details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S0</code></td>
<td>
<p>Prior on Sigma[j] is IW(Sigma_j; nu0, S0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu0</code></td>
<td>
<p>Prior on Sigma[j] is IW(Sigma_j; nu0, S0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>Prior parameter in MOM-IW-Dir(q) prior</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q.niw</code></td>
<td>
<p>Prior parameter in Normal-IW-Dir(q.niw) prior</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Number of MCMC iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>Number of burn-in iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logscale</code></td>
<td>
<p>If set to TRUE then log-Bayes factors are returned</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returndraws</code></td>
<td>
<p>If set to <code>TRUE</code> the MCMC posterior draws under
the Normal-IW-Dir prior are returned for all <code>k</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Set to <code>TRUE</code> to print iteration progress</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The likelihood is
</p>
<p>p(x[i,] | mu,Sigma,eta)= sum_j eta_j N(x[i,]; mu_j,Sigma_j)
</p>
<p>The Normal-IW-Dir prior is
</p>
<p>Dir(eta; q.niw) prod_j N(mu_j; mu0, g Sigma) IW(Sigma_j; nu0, S0)
</p>
<p>The MOM-IW-Dir prior is
</p>
<p style="text-align: center;"><code class="reqn">d(\mu,A) Dir(\eta; q) \prod_j N(\mu_j; \mu0, g \Sigma_j) IW(\Sigma_j; \nu_0, S0)</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">d(\mu,A)= [\prod_{j&lt;l} (\mu_j-\mu_l)' A (\mu_j-\mu_l)]</code>
</p>

<p>and A is the average of <code class="reqn">\Sigma_1^{-1},...,\Sigma_k^{-1}</code>. Note that
one must have q&gt;1 for the MOM-IW-Dir to define a non-local prior.
</p>
<p>By default the prior parameter g is set such that
</p>
<p>P( (mu[j]-mu[l])' A (mu[j]-mu[l]) &lt; 4)= 0.05.
</p>
<p>The reasonale when Sigma[j]=Sigma[l] and eta[j]=eta[l]
then (mu[j]-mu[l])' A (mu[j]-mu[l])&gt;4 corresponds to a bimodal
density. That is, the default g focuses 0.95 prior prob on a degree of
separation between components giving rise to a bimodal mixture density.
</p>
<p><code>bfnormmix</code> computes posterior model probabilities under the
MOM-IW-Dir and Normal-IW-Dir priors using MCMC output. As described in
Fuquene, Steel and Rossell (2018) the estimate is based on the
posterior probability that one cluster is empty under each possible k.
</p>


<h3>Value</h3>

<p>A list with elements
</p>
<table>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Number of components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pp.momiw</code></td>
<td>
<p>Posterior probability of k components under a
MOM-IW-Dir(q) prior</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pp.niw</code></td>
<td>
<p>Posterior probability of k components under a
Normal-IW-Dir(q.niw) prior</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probempty</code></td>
<td>
<p>Posterior probability that any one cluster is empty under a
MOM-IW-Dir(q.niw) prior</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bf.momiw</code></td>
<td>
<p>Bayes factor comparing 1 vs k components under a
MOM-IW-Dir(q) prior</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logpen</code></td>
<td>
<p>log of the posterior mean of the MOM-IW-Dir(q) penalty term</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logbf.niw</code></td>
<td>
<p>Bayes factor comparing 1 vs k components under a
Normal-IW-Dir(q.niw) prior</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> David Rossell </p>


<h3>References</h3>

<p>Fuquene J., Steel M.F.J., Rossell D. On choosing mixture components via
non-local priors. 2018. arXiv
</p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- matrix(rnorm(100*2),ncol=2)

bfnormmix(x=x,k=1:3)
</code></pre>


</div>