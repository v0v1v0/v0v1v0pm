<div class="container">

<table style="width: 100%;"><tr>
<td>marginalNIW</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Marginal likelihood under a multivariate Normal likelihood and a conjugate
Normal-inverse Wishart prior.
</h2>

<h3>Description</h3>

<p>The argument <code>z</code> can be used to specify cluster allocations. If
left missing then the usual marginal likelihood is computed, else it is
computed conditional on the clusters (this is equivalent to the product
of marginal likelihoods across clusters)
</p>


<h3>Usage</h3>

<pre><code class="language-R">marginalNIW(x, xbar, samplecov, n, z, g,  mu0=rep(0,ncol(x)),
nu0=ncol(x)+4, S0, logscale=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Data matrix (individuals in rows, variables in
columns). Alternatively you can leave missing and specify
<code>xbar</code>, <code>samplecov</code> and <code>n</code> instead</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xbar</code></td>
<td>
<p>Either a vector with column means of <code>x</code> or a list
where each element corresponds to the column means for each cluster</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samplecov</code></td>
<td>
<p>Either the sample covariance matrix <code>cov(x)</code> or
a list where each element contains the covariance for each clsuter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Either an integer indicating the sample size <code>nrow(x)</code>
or a vector indicating the cluster counts <code>table(z)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>Optional argument specifying cluster allocations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>Prior dispersion parameter for mu</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu0</code></td>
<td>
<p>Prior mean for mu</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu0</code></td>
<td>
<p>Prior degrees of freedom for Sigma</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S0</code></td>
<td>
<p>Prior scale matrix for Sigma, by default set to I/nu0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logscale</code></td>
<td>
<p>set to TRUE to get the log-posterior density</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function computes
</p>
<p>p(x)= int p(x | mu,Sigma) p(mu,Sigma) dmu dSigma
</p>
<p>where p(x[i])= N(x[i]; mu,Sigma) iid i=1,...,n
</p>
<p>p(mu | Sigma)= N(mu; mu0, g Sigma)
p(Sigma)=     IW(Sigma; nu0, S0)
</p>


<h3>Value</h3>

<p>If <code>z</code> is missing the integrated likelihood under a Normal-IW
prior. If <code>z</code> was specified then the product of integrated
likelihoods across clusters
</p>


<h3>Author(s)</h3>

<p>David Rossell
</p>


<h3>See Also</h3>

<p><code>dpostNIW</code> for the posterior Normal-IW density.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Simulate data
x= matrix(rnorm(100),ncol=2)

#Integrated likelihood under correct model
marginalNIW(x,g=1,nu0=4,log=FALSE)

#Integrated likelihood under random cluster allocations
z= rep(1:2,each=25)
marginalNIW(x,z=z,g=1,nu0=4,log=FALSE)
</code></pre>


</div>