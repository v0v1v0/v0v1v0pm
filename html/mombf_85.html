<div class="container">

<table style="width: 100%;"><tr>
<td>momknown</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Bayes factors for moment and inverse moment priors</h2>

<h3>Description</h3>

<p><code>momknown</code> and <code>momunknown</code> compute moment Bayes
factors for linear models when <code>sigma^2</code> is known and unknown,
respectively. The functions can also be used to compute approximate
Bayes factors for generalized linear models and other settings.
<code>imomknown</code>, <code>imomunknown</code> compute inverse
moment Bayes factors.
</p>


<h3>Usage</h3>

<pre><code class="language-R">momknown(theta1hat, V1, n, g = 1, theta0, sigma, logbf = FALSE)
momunknown(theta1hat, V1, n, nuisance.theta, g = 1, theta0, ssr, logbf =
FALSE)
imomknown(theta1hat, V1, n, nuisance.theta, g = 1, nu = 1, theta0,
sigma, method='adapt', B=10^5)
imomunknown(theta1hat, V1, n, nuisance.theta, g = 1, nu = 1, theta0,
ssr, method='adapt', nquant = 100, B = 10^5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>theta1hat</code></td>
<td>
<p> Vector with regression coefficients estimates. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V1</code></td>
<td>
<p> Matrix proportional to the covariance of
<code>theta1hat</code>. For linear models, the covariance is <code>sigma^2*V1</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p> Sample size. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nuisance.theta</code></td>
<td>
<p>Number of nuisance regression coefficients, i.e.
coefficients that we do not wish to test for.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ssr</code></td>
<td>
<p>Sum of squared residuals from a linear model call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p> Prior parameter. See <code>dmom</code> and <code>dimom</code> for details. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta0</code></td>
<td>
<p> Null value for the regression coefficients. Defaults to
0. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p> Dispersion parameter is <code>sigma^2</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logbf</code></td>
<td>
<p> If <code>logbf==TRUE</code> the natural logarithm of the Bayes
factor is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p> Prior parameter for the inverse moment prior. See
<code>dimom</code> for details. Defaults to <code>nu=1</code>, which Cauchy-like
tails.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p> Numerical integration method (only used by
<code>imomknown</code> and <code>imomunknown</code>).
Set <code>method=='adapt'</code> in <code>imomknown</code> to integrate using adaptive
quadrature of functions as implemented in the function
<code>integrate</code>. In <code>imomunknown</code> the integral is evaluated as in
<code>imomknown</code> at a series of
<code>nquant</code> quantiles of the posterior for <code>sigma</code>, and then
averaged as described in Johnson (1992).
Set <code>method=='MC'</code> to use Monte Carlo integration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nquant</code></td>
<td>
<p> Number of quantiles at which to evaluate the integral
for known <code>sigma</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Number of Monte Carlo samples to estimate the inverse moment
Bayes factor. Ignored if <code>method!='MC'</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See <code>dmom</code> and <code>dimom</code> for details on the moment and inverse
moment priors.
The Zellner-Siow g-prior is given by dmvnorm(theta,theta0,n*g*V1).
</p>


<h3>Value</h3>

<p><code>momknown</code> and <code>momunknown</code> return the moment Bayes factor to compare the model where
<code>theta!=theta0</code>
with the null model where <code>theta==theta0</code>. Large values favor the
alternative model; small values favor the null.
<code>imomknown</code> and <code>imomunknown</code> return
inverse moment Bayes factors.
</p>


<h3>Author(s)</h3>

<p> David Rossell </p>


<h3>References</h3>

<p> See http://rosselldavid.googlepages.com for technical
reports.
</p>
<p>For details on the quantile integration, see Johnson, V.E. A Technique for Estimating Marginal Posterior Densities in Hierarchical Models
Using Mixtures of Conditional Densities. Journal of the American Statistical Association, Vol. 87, No. 419. (Sep., 1992), pp. 852-860.</p>


<h3>See Also</h3>

 <p><code>mombf</code> and
<code>imombf</code> for a simpler interface to compute Bayes
factors in linear regression </p>


<h3>Examples</h3>

<pre><code class="language-R">#simulate data from probit regression
set.seed(4*2*2008)
n &lt;- 50; theta &lt;- c(log(2),0)
x &lt;- matrix(NA,nrow=n,ncol=2)
x[,1] &lt;- rnorm(n,0,1); x[,2] &lt;- rnorm(n,.5*x[,1],1)
p &lt;- pnorm(x[,1]*theta[1]+x[,2]+theta[2])
y &lt;- rbinom(n,1,p)

#fit model
glm1 &lt;- glm(y~x[,1]+x[,2],family=binomial(link = "probit"))
thetahat &lt;- coef(glm1)
V &lt;- summary(glm1)$cov.scaled

#compute Bayes factors to test whether x[,1] can be dropped from the model
g &lt;- .5
bfmom.1 &lt;- momknown(thetahat[2],V[2,2],n=n,g=g,sigma=1)
bfimom.1 &lt;- imomknown(thetahat[2],V[2,2],n=n,nuisance.theta=2,g=g,sigma=1)
bfmom.1
bfimom.1

</code></pre>


</div>