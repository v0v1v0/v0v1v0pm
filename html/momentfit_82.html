<div class="container">

<table style="width: 100%;"><tr>
<td>gel4</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>GEL estimation</h2>

<h3>Description</h3>

<p>The main functions and methods to fit any model with GEL. As opposed to
<code>gelFit</code>, models don't need to be created. It is all done by
the functions. It is meant to be more user friendly. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">
gel4(g, x=NULL, theta0=NULL,lambda0=NULL, getVcov=FALSE, 
     gelType = c("EL","ET","EEL","HD", "REEL","ETEL","ETHD"),
     vcov = c("MDS","iid","HAC"), grad=NULL,
     vcovOptions=list(), centeredVcov = TRUE,
     cstLHS=NULL, cstRHS=NULL, lamSlv=NULL,
     rhoFct=NULL, initTheta=c("gmm", "theta0"),
     data = parent.frame(),
     coefSlv=c("optim","nlminb","constrOptim"),
     smooth=FALSE, 
     lControl=list(), tControl=list())

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>A function of the form <code class="reqn">g(\theta,x)</code> and which returns a
<code class="reqn">n \times q</code> matrix with typical element <code class="reqn">g_i(\theta,x_t)</code> for
<code class="reqn">i=1,...q</code> and <code class="reqn">t=1,...,n</code>. This matrix is then used to build
the q sample moment conditions. It can also be a formula if the model
is linear (see detailsbelow).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The matrix or vector of data from which the function
<code class="reqn">g(\theta,x)</code> is computed. If "g" is a formula, it is an <code class="reqn">n
    \times Nh</code> matrix of instruments or a formula (see details below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta0</code></td>
<td>
<p>A <code class="reqn">k \times 1</code> vector of starting values. It is required
only when "g" is a function, a formula or a list of formulas. For
these cases, they are needed to create the <code>"momentModel"</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda0</code></td>
<td>
<p>The <code class="reqn">q \times 1</code> vector of starting values for the
Lagrange multipliers. By default a zero vector is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>getVcov</code></td>
<td>
<p>Should the method computes the covariance matrices of the
coefficients and Lagrange multipliers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gelType</code></td>
<td>
<p>A character string specifying the type of GEL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov</code></td>
<td>
<p>Assumption on the properties of the moment conditions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grad</code></td>
<td>
<p>A function of the form <code class="reqn">G(\theta,x)</code> which returns a
<code class="reqn">q\times k</code> matrix of derivatives of <code class="reqn">\bar{g}(\theta)</code> with
respect to <code class="reqn">\theta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcovOptions</code></td>
<td>
<p>A list of options for the covariance matrix of the
moment conditions. See <code>vcovHAC</code> for the default values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centeredVcov</code></td>
<td>
<p>Should the moment function be centered when
computing its covariance matrix. Doing so may improve inference.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cstLHS</code></td>
<td>
<p>The left hand side of the constraints to impose on the
coefficients. See <code>restModel</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cstRHS</code></td>
<td>
<p>The right hand side of the constraints to impose on the
coefficients. See <code>restModel</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lamSlv</code></td>
<td>
<p>An alternative solver for the Lagrange multiplier. By
default, either <code>Wu_lam</code>, <code>EEL_lam</code>,
<code>REEL_lam</code> or <code>getLambda</code> is
used. See the vignette for the required format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rhoFct</code></td>
<td>
<p>An optional function that return <code class="reqn">\rho(v)</code>. This is
for users who want a GEL model that is not built in the package. The
four arguments of the function must be <code>"gmat"</code>, the matrix of
moments, <code>"lambda"</code>, the vector of Lagrange multipliers,
<code>"derive"</code>, which specify the order of derivative to return, and
<code>k</code> a numeric scale factor required for time series and kernel
smoothed moments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initTheta</code></td>
<td>
<p>Method to obtain the starting values for the
coefficient vector. By default the GMM estimate with identity matrix
is used. The second argument means that <code>"theta0"</code> is used
instead. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A required data.frame, in which all variables in g and x can
be found.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth</code></td>
<td>
<p>If TRUE, <code>"vcov"</code> is set to <code>"MDS"</code> and the
moment conditions are smoothed using a kernel. See the vignette for
more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefSlv</code></td>
<td>
<p>Minimization solver for the coefficient vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lControl</code></td>
<td>
<p>A list of controls for the Lagrange multiplier
algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tControl</code></td>
<td>
<p>A list of controls for the coefficient algorithm.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>It returns an object of class <code>"gelfit"</code>  
</p>


<h3>References</h3>

<p>Anatolyev, S. (2005), GMM, GEL, Serial Correlation, and Asymptotic Bias. <em>Econometrica</em>, <b>73</b>, 983-1002.
</p>
<p>Andrews DWK (1991), Heteroskedasticity and Autocorrelation Consistent Covariance Matrix Estimation.
<em>Econometrica</em>, <b>59</b>, 817â€“858.
</p>
<p>Kitamura, Yuichi (1997), Empirical Likelihood Methods With Weakly Dependent Processes.
<em>The Annals of Statistics</em>, <b>25</b>, 2084-2102.
</p>
<p>Kitamura, Y. and Otsu, T. and Evdokimov, K. (2013), Robustness,
Infinitesimal Neighborhoods and Moment Restrictions.
<em>Econometrica</em>, <b>81</b>, 1185-1201.
</p>
<p>Newey, W.K. and Smith, R.J. (2004), Higher Order Properties of GMM and 
Generalized Empirical Likelihood Estimators. <em>Econometrica</em>, <b>72</b>, 219-255.
</p>
<p>Smith, R.J. (2004), GEL Criteria for Moment Condition Models. <em>Working paper, CEMMAP</em>.
</p>


<h3>See Also</h3>

<p><code>gelFit</code>, <code>momentModel</code> 
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(simData)
res &lt;- gel4(y~x1, ~z1+z2, vcov="MDS", gelType="ET", data=simData)
res
</code></pre>


</div>