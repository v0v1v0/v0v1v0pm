<div class="container">

<table style="width: 100%;"><tr>
<td>w2n</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Scaling function: working to natural parameters</h2>

<h3>Description</h3>

<p>Scales each parameter from the set of real numbers, back to its natural interval.
Used during the optimization of the log-likelihood.
</p>


<h3>Usage</h3>

<pre><code class="language-R">w2n(
  wpar,
  bounds,
  parSize,
  nbStates,
  nbCovs,
  estAngleMean,
  circularAngleMean,
  consensus,
  stationary,
  fullDM,
  DMind,
  nbObs,
  dist,
  Bndind,
  nc,
  meanind,
  covsDelta,
  workBounds,
  covsPi
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>wpar</code></td>
<td>
<p>Vector of working parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bounds</code></td>
<td>
<p>Named list of 2-column matrices specifying bounds on the natural (i.e, real) scale of the probability 
distribution parameters for each data stream.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parSize</code></td>
<td>
<p>Named list indicating the number of natural parameters of the data stream probability distributions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbStates</code></td>
<td>
<p>The number of states of the HMM.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbCovs</code></td>
<td>
<p>The number of beta covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estAngleMean</code></td>
<td>
<p>Named list indicating whether or not to estimate the angle mean for data streams with angular 
distributions ('vm' and 'wrpcauchy').</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>circularAngleMean</code></td>
<td>
<p>Named list indicating whether to use circular-linear or circular-circular
regression on the mean of circular distributions ('vm' and 'wrpcauchy') for turning angles. See <code>fitHMM</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>consensus</code></td>
<td>
<p>Named list indicating whether to use the circular-circular regression consensus model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stationary</code></td>
<td>
<p><code>FALSE</code> if there are time-varying covariates in <code>formula</code> or any covariates in <code>formulaDelta</code>. If <code>TRUE</code>, the initial distribution is considered
equal to the stationary distribution. Default: <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fullDM</code></td>
<td>
<p>Named list containing the full (i.e. not shorthand) design matrix for each data stream.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DMind</code></td>
<td>
<p>Named list indicating whether <code>fullDM</code> includes individual- and/or temporal-covariates for each data stream
specifies (-1,1) bounds for the concentration parameters instead of the default [0,1) bounds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbObs</code></td>
<td>
<p>Number of observations in the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>Named list indicating the probability distributions of the data streams.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Bndind</code></td>
<td>
<p>Named list indicating whether <code>DM</code> is NULL with default parameter bounds for each data stream.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nc</code></td>
<td>
<p>indicator for zeros in fullDM</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meanind</code></td>
<td>
<p>index for circular-circular regression mean angles with at least one non-zero entry in fullDM</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covsDelta</code></td>
<td>
<p>data frame containing the delta model covariates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>workBounds</code></td>
<td>
<p>named list of 2-column matrices specifying bounds on the working scale of the probability distribution, transition probability, and initial distribution parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covsPi</code></td>
<td>
<p>data frame containing the pi model covariates</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Matrices containing the natural parameters for each data stream (e.g., 'step', 'angle', etc.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Matrix of regression coefficients of the transition probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>Initial distribution</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
m&lt;-example$m
nbStates &lt;- 2
nbCovs &lt;- 2
parSize &lt;- list(step=2,angle=2)
par &lt;- list(step=c(t(m$mle$step)),angle=c(t(m$mle$angle)))
bounds &lt;- m$conditions$bounds
beta &lt;- matrix(rnorm(6),ncol=2,nrow=3)
delta &lt;- c(0.6,0.4)

#working parameters
wpar &lt;- momentuHMM:::n2w(par,bounds,list(beta=beta),log(delta[-1]/delta[1]),nbStates,
m$conditions$estAngleMean,NULL,m$conditions$Bndind,
m$conditions$dist)

#natural parameter
p &lt;-   momentuHMM:::w2n(wpar,bounds,parSize,nbStates,nbCovs,m$conditions$estAngleMean,
m$conditions$circularAngleMean,lapply(m$conditions$dist,function(x) x=="vmConsensus"),
m$conditions$stationary,m$conditions$fullDM,
m$conditions$DMind,1,m$conditions$dist,m$conditions$Bndind,
matrix(1,nrow=length(unique(m$data$ID)),ncol=1),covsDelta=m$covsDelta,
workBounds=m$conditions$workBounds)

## End(Not run)


</code></pre>


</div>