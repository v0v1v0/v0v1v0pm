<div class="container">

<table style="width: 100%;"><tr>
<td>getPar0</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Get starting values for new model from existing <code>momentuHMM</code> or <code>momentuHierHMM</code> model fit</h2>

<h3>Description</h3>

<p>For nested models, this function will extract starting parameter values (i.e., <code>Par0</code> in <code>fitHMM</code> or <code>MIfitHMM</code>) from an existing <code>momentuHMM</code> or <code>momentuHierHMM</code> model fit based on the provided arguments for the new model. 
Any parameters that are not in common between <code>model</code> and the new model (as specified by the arguments) are set to <code>0</code>. This function is intended to help users incrementally build and fit more complicated models from simpler nested models (and vice versa).
</p>


<h3>Usage</h3>

<pre><code class="language-R">getPar0(model, ...)

## Default S3 method:
getPar0(
  model,
  nbStates = length(model$stateNames),
  estAngleMean = model$conditions$estAngleMean,
  circularAngleMean = model$conditions$circularAngleMean,
  formula = model$conditions$formula,
  formulaDelta = model$conditions$formulaDelta,
  stationary = model$conditions$stationary,
  mixtures = model$conditions$mixtures,
  formulaPi = model$conditions$formulaPi,
  DM = model$conditions$DM,
  betaRef = model$conditions$betaRef,
  stateNames = model$stateNames,
  ...
)

## S3 method for class 'hierarchical'
getPar0(
  model,
  hierStates = model$conditions$hierStates,
  estAngleMean = model$conditions$estAngleMean,
  circularAngleMean = model$conditions$circularAngleMean,
  hierFormula = model$conditions$hierFormula,
  hierFormulaDelta = model$conditions$hierFormulaDelta,
  mixtures = model$conditions$mixtures,
  formulaPi = model$conditions$formulaPi,
  DM = model$conditions$DM,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>A <code>momentuHMM</code>, <code>momentuHierHMM</code>, <code>miHMM</code>, or <code>miSum</code> object (as returned by <code>fitHMM</code>, <code>MIfitHMM</code>, or <code>MIpool</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbStates</code></td>
<td>
<p>Number of states in the new model. Default: <code>nbStates=length(model$stateNames)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estAngleMean</code></td>
<td>
<p>Named list indicating whether or not the angle mean for data streams with angular 
distributions ('vm' and 'wrpcauchy') are to be estimated in the new model. Default: <code>estAngleMean=model$conditions$estAngleMean</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>circularAngleMean</code></td>
<td>
<p>Named list indicating whether circular-linear or circular-circular 
regression on the mean of circular distributions ('vm' and 'wrpcauchy') for turning angles are to be used in the new model.  See <code>fitHMM</code>. Default: <code>circularAngleMean=model$conditions$circularAngleMean</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>Regression formula for the transition probability covariates of the new model (see <code>fitHMM</code>).  Default: <code>formula=model$conditions$formula</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formulaDelta</code></td>
<td>
<p>Regression formula for the initial distribution covariates of the new model (see <code>fitHMM</code>).  Default: <code>formulaDelta=model$conditions$formulaDelta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stationary</code></td>
<td>
<p><code>FALSE</code> if there are time-varying covariates in <code>formula</code> or any covariates in <code>formulaDelta</code>. If <code>TRUE</code>, the initial distribution is considered
equal to the stationary distribution. Default: <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mixtures</code></td>
<td>
<p>Number of mixtures for the state transition probabilities  (see <code>fitHMM</code>). Default: <code>formula=model$conditions$mixtures</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formulaPi</code></td>
<td>
<p>Regression formula for the mixture distribution probabilities (see <code>fitHMM</code>). Default: <code>formula=model$conditions$formulaPi</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DM</code></td>
<td>
<p>Named list indicating the design matrices to be used for the probability distribution parameters of each data stream in the new model (see <code>fitHMM</code>). Only parameters with design matrix column names that match those in model$conditions$fullDM are extracted, so care must be taken in naming columns if any elements of <code>DM</code>
are specified as matrices instead of formulas. Default: <code>DM=model$conditions$DM</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betaRef</code></td>
<td>
<p>Numeric vector of length <code>nbStates</code> indicating the reference elements for the t.p.m. multinomial logit link. Default: <code>formula=model$conditions$betaRef</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stateNames</code></td>
<td>
<p>Character vector of length <code>nbStates</code> indicating the names and order of the states in the new model. Default: <code>stateNames=model$stateNames[1:nbStates]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hierStates</code></td>
<td>
<p>A hierarchical model structure <code>Node</code> for the states (see <code>fitHMM</code>). Default: <code>hierStates=model$conditions$hierStates</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hierFormula</code></td>
<td>
<p>A hierarchical formula structure for the transition probability covariates for each level of the hierarchy (see <code>fitHMM</code>). Default: <code>hierFormula=model$conditions$hierFormula</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hierFormulaDelta</code></td>
<td>
<p>A hierarchical formula structure for the initial distribution covariates for each level of the hierarchy ('formulaDelta'). Default: <code>NULL</code> (no covariate effects and <code>fixPar$delta</code> is specified on the working scale).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>All other <code>fitHMM</code> (or <code>MIfitHMM</code>) model specifications (e.g., <code>dist</code>, <code>hierDist</code>, <code>userBounds</code>, <code>workBounds</code>, etc.) and <code>data</code> are assumed to be the same 
for <code>model</code> and the new model (as specified by  <code>nbStates</code>, <code>hierStates</code>, <code>estAngleMean</code>, <code>circularAngleMean</code>, <code>formula</code>, <code>hierFormula</code>, <code>formulaDelta</code>, <code>hierFormulaDelta</code>, <code>DM</code>, etc.).
</p>
<p>Note that for hierarchical models, <code>getPar0</code> will return hierarchical data.tree objects (<code>hierBeta</code> and <code>hierDelta</code>) with the default values for <code>fixPar</code>, <code>betaCons</code>, and <code>deltaCons</code>;
if hierarchical t.p.m. or initial distribution parameters are subject to constraints, then these must be set manually on the list object returned by <code>getPar0</code>.
</p>


<h3>Value</h3>

<p>A named list containing starting values suitable for <code>Par0</code> and <code>beta0</code> arguments in <code>fitHMM</code> or <code>MIfitHMM</code>:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Par</code></td>
<td>
<p>A list of vectors of state-dependent probability distribution parameters for 
each data stream specified in <code>model$conditions$dist</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Matrix of regression coefficients for the transition probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>Initial distribution of the HMM. Only returned if <code>stateNames</code> has the same membership as the state names for <code>model</code></p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>getPar</code>, <code>getParDM</code>, <code>fitHMM</code>, <code>MIfitHMM</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># model is a momentuHMM object, automatically loaded with the package
model &lt;- example$m
data &lt;- model$data
dist &lt;- model$conditions$dist
nbStates &lt;- length(model$stateNames)
estAngleMean &lt;- model$conditions$estAngleMean

newformula &lt;- ~cov1+cov2
Par0 &lt;- getPar0(model,formula=newformula)

## Not run: 
newModel &lt;- fitHMM(model$data,dist=dist,nbStates=nbStates,
                   Par0=Par0$Par,beta0=Par0$beta,
                   formula=newformula,
                   estAngleMean=estAngleMean)

## End(Not run)

newDM1 &lt;- list(step=list(mean=~cov1,sd=~cov1))
Par0 &lt;- getPar0(model,DM=newDM1)

## Not run: 
newModel1 &lt;- fitHMM(model$data,dist=dist,nbStates=nbStates,
                   Par0=Par0$Par,beta0=Par0$beta,
                   formula=model$conditions$formula,
                   estAngleMean=estAngleMean,
                   DM=newDM1)

## End(Not run)

# same model but specify DM for step using matrices
newDM2 &lt;- list(step=matrix(c(1,0,0,0,
                           "cov1",0,0,0,
                           0,1,0,0,
                           0,"cov1",0,0,
                           0,0,1,0,
                           0,0,"cov1",0,
                           0,0,0,1,
                           0,0,0,"cov1"),nrow=nbStates*2))
                           
# to be extracted, new design matrix column names must match 
# column names of model$conditions$fullDM
colnames(newDM2$step)&lt;-paste0(rep(c("mean_","sd_"),each=2*nbStates),
                      rep(1:nbStates,each=2),
                      rep(c(":(Intercept)",":cov1"),2*nbStates))
Par0 &lt;- getPar0(model,DM=newDM2)
                      
## Not run: 
newModel2 &lt;- fitHMM(model$data,dist=dist,nbStates=nbStates,
                   Par0=Par0$Par,beta0=Par0$beta,
                   formula=model$conditions$formula,
                   estAngleMean=estAngleMean,
                   DM=newDM2)

## End(Not run)

</code></pre>


</div>