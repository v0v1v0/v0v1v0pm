<div class="container">

<table style="width: 100%;"><tr>
<td>MIpool</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate pooled parameter estimates and states across multiple imputations</h2>

<h3>Description</h3>

<p>Calculate pooled parameter estimates and states across multiple imputations
</p>


<h3>Usage</h3>

<pre><code class="language-R">MIpool(im, alpha = 0.95, ncores = 1, covs = NULL, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>im</code></td>
<td>
<p>List comprised of <code>momentuHMM</code> or <code>momentuHierHMM</code> objects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Significance level for calculating confidence intervals of pooled estimates (including location error ellipses). Default: 0.95.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>Number of cores to use for parallel processing. Default: 1 (no parallel processing).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covs</code></td>
<td>
<p>Data frame consisting of a single row indicating the covariate values to be used in the calculation of pooled natural parameters. 
For any covariates that are not specified using <code>covs</code>, the means of the covariate(s) across the imputations are used 
(unless the covariate is a factor, in which case the first factor in the data is used). By default, no covariates are specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>Logical indicating whether or not to exclude model fits with <code>NA</code> parameter estimates or standard errors from pooling. Default: FALSE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Pooled estimates, standard errors, and confidence intervals are calculated using standard multiple imputation formulas. Working scale parameters are pooled
using <code>MIcombine</code> and t-distributed confidence intervals. Natural scale parameters and normally-distributed confidence intervals are calculated by transforming the pooled working scale parameters 
and, if applicable, are based on covariate means across all imputations (and/or values specified in <code>covs</code>).
</p>
<p>The calculation of pooled error ellipses uses <code>dataEllipse</code> from the <code>car</code> package. The suggested package <code>car</code> is not automatically imported by <code>momentuHMM</code> and must be installed in order to calculate error ellipses. A warning will be triggered if the <code>car</code> package is required but not installed.
</p>
<p>Note that pooled estimates for <code>timeInStates</code> and <code>stateProbs</code> do not include within-model uncertainty and are based entirely on across-model variability.
</p>


<h3>Value</h3>

<p>A <code>miSum</code> object, i.e., a list comprised of model and pooled parameter summaries, including <code>data</code> (averaged across imputations), <code>conditions</code>, <code>Par</code>, and <code>MIcombine</code> 
(as returned by <code>MIcombine</code> for working parameters).
</p>
<p><code>miSum$Par</code> is a list comprised of:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Pooled estimates for the working parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>real</code></td>
<td>
<p>Estimates for the natural parameters based on pooled working parameters and covariate means (or <code>covs</code>) across imputations (if applicable)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeInStates</code></td>
<td>
<p>The proportion of time steps assigned to each state</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>states</code></td>
<td>
<p>The most freqent state assignment for each time step based on the <code>viterbi</code> algorithm for each model fit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stateProbs</code></td>
<td>
<p>Pooled state probability estimates for each time step</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mixtureProbs</code></td>
<td>
<p>Pooled mixture probabilities for each individual (only applies if <code>mixtures&gt;1</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hierStateProbs</code></td>
<td>
<p>Pooled state probability estimates for each time step at each level of the hierarchy (only applies if <code>im</code> is comprised of <code>momentuHierHMM</code> objects)</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
# Extract data and crawl inputs from miExample
obsData &lt;- miExample$obsData

# error ellipse model
err.model &lt;- list(x= ~ ln.sd.x - 1, y =  ~ ln.sd.y - 1, rho =  ~ error.corr)

# Fit crawl to obsData
crwOut &lt;- crawlWrap(obsData,theta=c(4,0),fixPar=c(1,1,NA,NA),
                    err.model=err.model)
                    
# Fit four imputations
bPar &lt;- miExample$bPar
HMMfits &lt;- MIfitHMM(crwOut,nSims=4,poolEstimates=FALSE,
                   nbStates=2,dist=list(step="gamma",angle="vm"),
                   Par0=bPar$Par,beta0=bPar$beta,
                   formula=~cov1+cos(cov2),
                   estAngleMean=list(angle=TRUE),
                   covNames=c("cov1","cov2"))
                   
# Pool estimates
miSum &lt;- MIpool(HMMfits)
print(miSum)

## End(Not run)
</code></pre>


</div>