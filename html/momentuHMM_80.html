<div class="container">

<table style="width: 100%;"><tr>
<td>n2w</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Scaling function: natural to working parameters.</h2>

<h3>Description</h3>

<p>Scales each data stream probability distribution parameter from its natural interval to the set of real numbers, to allow for
unconstrained optimization. Used during the optimization of the log-likelihood. Parameters of
any data streams for which a design matrix is specified are ignored.
</p>


<h3>Usage</h3>

<pre><code class="language-R">n2w(par, bounds, beta, delta = NULL, nbStates, estAngleMean, DM, Bndind, dist)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>Named list of vectors containing the initial parameter values for each data stream.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bounds</code></td>
<td>
<p>Named list of 2-column matrices specifying bounds on the natural (i.e, real) scale of the probability 
distribution parameters for each data stream.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>List of regression coefficients for the transition probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>Initial distribution. Default: <code>NULL</code> ; if the initial distribution is not estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbStates</code></td>
<td>
<p>The number of states of the HMM.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estAngleMean</code></td>
<td>
<p>Named list indicating whether or not to estimate the angle mean for data streams with angular 
distributions ('vm' and 'wrpcauchy').</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DM</code></td>
<td>
<p>An optional named list indicating the design matrices to be used for the probability distribution parameters of each data 
stream. Each element of <code>DM</code> can either be a named list of linear regression formulas or a matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Bndind</code></td>
<td>
<p>Named list indicating whether <code>DM</code> is NULL with default parameter bounds for each data stream.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>A named list indicating the probability distributions of the data streams.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A vector of unconstrained parameters.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
m&lt;-example$m
nbStates &lt;- 2
nbCovs &lt;- 2
parSize &lt;- list(step=2,angle=2)
par &lt;- list(step=c(t(m$mle$step)),angle=c(t(m$mle$angle)))
bounds &lt;- m$conditions$bounds
beta &lt;- matrix(rnorm(6),ncol=2,nrow=3)
delta &lt;- c(0.6,0.4)

#working parameters
wpar &lt;- momentuHMM:::n2w(par,bounds,list(beta=beta),log(delta[-1]/delta[1]),nbStates,
m$conditions$estAngleMean,NULL,m$conditions$Bndind,
m$conditions$dist)

#natural parameter
p &lt;-   momentuHMM:::w2n(wpar,bounds,parSize,nbStates,nbCovs,m$conditions$estAngleMean,
m$conditions$circularAngleMean,lapply(m$conditions$dist,function(x) x=="vmConsensus"),
m$conditions$stationary,m$conditions$fullDM,
m$conditions$DMind,1,m$conditions$dist,m$conditions$Bndind,
matrix(1,nrow=length(unique(m$data$ID)),ncol=1),covsDelta=m$covsDelta,
workBounds=m$conditions$workBounds)

## End(Not run)

</code></pre>


</div>