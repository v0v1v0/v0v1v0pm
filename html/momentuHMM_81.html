<div class="container">

<table style="width: 100%;"><tr>
<td>nLogLike</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Negative log-likelihood function</h2>

<h3>Description</h3>

<p>Negative log-likelihood function
</p>


<h3>Usage</h3>

<pre><code class="language-R">nLogLike(
  optPar,
  nbStates,
  formula,
  bounds,
  parSize,
  data,
  dist,
  covs,
  estAngleMean,
  circularAngleMean,
  consensus,
  zeroInflation,
  oneInflation,
  stationary = FALSE,
  fullDM,
  DMind,
  Bndind,
  knownStates,
  fixPar,
  wparIndex,
  nc,
  meanind,
  covsDelta,
  workBounds,
  prior = NULL,
  betaCons = NULL,
  betaRef,
  deltaCons = NULL,
  optInd = NULL,
  recovs = NULL,
  g0covs = NULL,
  mixtures = 1,
  covsPi,
  recharge = NULL,
  aInd
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>optPar</code></td>
<td>
<p>Vector of working parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbStates</code></td>
<td>
<p>Number of states of the HMM.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>Regression formula for the transition probability covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bounds</code></td>
<td>
<p>Named list of 2-column matrices specifying bounds on the natural (i.e, real) scale of the probability 
distribution parameters for each data stream.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parSize</code></td>
<td>
<p>Named list indicating the number of natural parameters of the data stream probability distributions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>An object <code>momentuHMMData</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>Named list indicating the probability distributions of the data streams.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covs</code></td>
<td>
<p>data frame containing the beta model covariates (if any)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estAngleMean</code></td>
<td>
<p>Named list indicating whether or not to estimate the angle mean for data streams with angular 
distributions ('vm' and 'wrpcauchy').</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>circularAngleMean</code></td>
<td>
<p>Named list indicating whether to use circular-linear or circular-circular 
regression on the mean of circular distributions ('vm' and 'wrpcauchy') for turning angles. See <code>fitHMM</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>consensus</code></td>
<td>
<p>Named list indicating whether to use the circular-circular regression consensus model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zeroInflation</code></td>
<td>
<p>Named list of logicals indicating whether the probability distributions of the data streams are zero-inflated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>oneInflation</code></td>
<td>
<p>Named list of logicals indicating whether the probability distributions of the data streams are one-inflated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stationary</code></td>
<td>
<p><code>FALSE</code> if there are time-varying covariates in <code>formula</code> or any covariates in <code>formulaDelta</code>. If <code>TRUE</code>, the initial distribution is considered
equal to the stationary distribution. Default: <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fullDM</code></td>
<td>
<p>Named list containing the full (i.e. not shorthand) design matrix for each data stream.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DMind</code></td>
<td>
<p>Named list indicating whether <code>fullDM</code> includes individual- and/or temporal-covariates for each data stream
specifies (-1,1) bounds for the concentration parameters instead of the default [0,1) bounds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Bndind</code></td>
<td>
<p>Named list indicating whether <code>DM</code> is NULL with default parameter bounds for each data stream.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knownStates</code></td>
<td>
<p>Vector of values of the state process which are known prior to fitting the
model (if any).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixPar</code></td>
<td>
<p>Vector of working parameters which are assumed known prior to fitting the model (NA indicates parameters is to be estimated).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wparIndex</code></td>
<td>
<p>Vector of indices for the elements of <code>fixPar</code> that are not NA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nc</code></td>
<td>
<p>indicator for zeros in fullDM</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meanind</code></td>
<td>
<p>index for circular-circular regression mean angles with at least one non-zero entry in fullDM</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covsDelta</code></td>
<td>
<p>data frame containing the delta model covariates (if any)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>workBounds</code></td>
<td>
<p>named list of 2-column matrices specifying bounds on the working scale of the probability distribution, transition probability, and initial distribution parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>A function that returns the log-density of the working scale parameter prior distribution(s)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betaCons</code></td>
<td>
<p>Matrix of the same dimension as <code>beta0</code> composed of integers identifying any equality constraints among the t.p.m. parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betaRef</code></td>
<td>
<p>Indices of reference elements for t.p.m. multinomial logit link.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deltaCons</code></td>
<td>
<p>Matrix of the same dimension as <code>delta0</code> composed of integers identifying any equality constraints among the initial distribution working scale parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optInd</code></td>
<td>
<p>indices of constrained parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>recovs</code></td>
<td>
<p>data frame containing the recharge model theta covariates (if any)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g0covs</code></td>
<td>
<p>data frame containing the recharge model g0 covariates (if any)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mixtures</code></td>
<td>
<p>Number of mixtures for the state transition probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covsPi</code></td>
<td>
<p>data frame containing the pi model covariates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>recharge</code></td>
<td>
<p>recharge model specification (only used for hierarchical models)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aInd</code></td>
<td>
<p>vector of indices of first observation for each animal</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The negative log-likelihood of the parameters given the data.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# data is a momentuHMMData object (as returned by prepData), automatically loaded with the package
data &lt;- example$m$data
m&lt;-example$m
Par &lt;- getPar(m)
nbStates &lt;- length(m$stateNames)

inputs &lt;- momentuHMM:::checkInputs(nbStates,m$conditions$dist,Par$Par,m$conditions$estAngleMean,
          m$conditions$circularAngleMean,m$conditions$zeroInflation,m$conditions$oneInflation,
          m$conditions$DM,m$conditions$userBounds,
          m$stateNames)

wpar &lt;- momentuHMM:::n2w(Par$Par,m$conditions$bounds,list(beta=Par$beta),
        log(Par$delta[-1]/Par$delta[1]),nbStates,m$conditions$estAngleMean,
        m$conditions$DM,m$conditions$Bndind,
        m$conditions$dist)

l &lt;- momentuHMM:::nLogLike(wpar,nbStates,m$conditions$formula,m$conditions$bounds,
     inputs$p$parSize,data,inputs$dist,model.matrix(m$conditions$formula,data),
     m$conditions$estAngleMean,m$conditions$circularAngleMean,inputs$consensus,
     m$conditions$zeroInflation,m$conditions$oneInflation,m$conditions$stationary,
     m$conditions$fullDM,m$conditions$DMind,
     m$conditions$Bndind,m$knownStates,unlist(m$conditions$fixPar),
     m$conditions$wparIndex,covsDelta=m$covsDelta,workBounds=m$conditions$workBounds,
     betaRef=m$conditions$betaRef,covsPi=m$covsPi)

## End(Not run)

</code></pre>


</div>