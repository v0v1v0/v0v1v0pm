<div class="container">

<table style="width: 100%;"><tr>
<td>plot.momentuHMM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot <code>momentuHMM</code>
</h2>

<h3>Description</h3>

<p>Plot the fitted step and angle densities over histograms of the data, transition probabilities
as functions of the covariates, and maps of the animals' tracks colored by the decoded states.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'momentuHMM'
plot(
  x,
  animals = NULL,
  covs = NULL,
  ask = TRUE,
  breaks = "Sturges",
  hist.ylim = NULL,
  sepAnimals = FALSE,
  sepStates = FALSE,
  col = NULL,
  cumul = TRUE,
  plotTracks = TRUE,
  plotCI = FALSE,
  alpha = 0.95,
  plotStationary = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Object <code>momentuHMM</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>animals</code></td>
<td>
<p>Vector of indices or IDs of animals for which information will be plotted.
Default: <code>NULL</code> ; all animals are plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covs</code></td>
<td>
<p>Data frame consisting of a single row indicating the covariate values to be used in plots. 
If none are specified, the means of any covariates appearing in the model are used (unless covariate is a factor, in which case the first factor in the data is used).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ask</code></td>
<td>
<p>If <code>TRUE</code>, the execution pauses between each plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>
<p>Histogram parameter. See <code>hist</code> documentation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hist.ylim</code></td>
<td>
<p>An optional named list of vectors specifying <code>ylim=c(ymin,ymax)</code> for the data stream histograms.
See <code>hist</code> documentation. Default: <code>NULL</code> ; the function sets default values for all data streams.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sepAnimals</code></td>
<td>
<p>If <code>TRUE</code>, the data is split by individuals in the histograms.
Default: <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sepStates</code></td>
<td>
<p>If <code>TRUE</code>, the data is split by states in the histograms.
Default: <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>Vector or colors for the states (one color per state).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cumul</code></td>
<td>
<p>If TRUE, the sum of weighted densities is plotted (default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotTracks</code></td>
<td>
<p>If TRUE, the Viterbi-decoded tracks are plotted (default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotCI</code></td>
<td>
<p>Logical indicating whether to include confidence intervals in natural parameter plots (default: FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Significance level of the confidence intervals (if <code>plotCI=TRUE</code>). Default: 0.95 (i.e. 95% CIs).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotStationary</code></td>
<td>
<p>Logical indicating whether to plot the stationary state probabilities as a function of any covariates (default: FALSE). Ignored unless covariate are included in <code>formula</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to <code>graphics::plot</code> and <code>graphics::hist</code> functions. These can currently include <code>asp</code>, <code>cex</code>, <code>cex.axis</code>, <code>cex.lab</code>, <code>cex.legend</code>, <code>cex.main</code>, <code>legend.pos</code>, and <code>lwd</code>. See <code>par</code>. <code>legend.pos</code> can be a single keyword from the list “bottomright”, “bottom”, “bottomleft”, “left”, “topleft”, “top”, “topright”, “right”, and “center”. Note that <code>asp</code> and <code>cex</code> only apply to plots of animal tracks.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The state-dependent densities are weighted by the frequency of each state in the most
probable state sequence (decoded with the function <code>viterbi</code>). For example, if the
most probable state sequence indicates that one third of observations correspond to the first
state, and two thirds to the second state, the plots of the densities in the first state are
weighted by a factor 1/3, and in the second state by a factor 2/3.
</p>
<p>Confidence intervals for natural parameters are calculated from the working parameter point and covariance estimates
using finite-difference approximations of the first derivative for the transformation (see <code>grad</code>).
For example, if <code>dN</code> is the numerical approximation of the first derivative of the transformation <code>N = exp(x_1 * B_1 + x_2 * B_2)</code>
for covariates (x_1, x_2) and working parameters (B_1, B_2), then 
<code>var(N)=dN %*% Sigma %*% dN</code>, where <code>Sigma=cov(B_1,B_2)</code>, and normal confidence intervals can be 
constructed as <code>N +/- qnorm(1-(1-alpha)/2) * se(N)</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># m is a momentuHMM object (as returned by fitHMM), automatically loaded with the package
m &lt;- example$m

plot(m,ask=TRUE,animals=1,breaks=20,plotCI=TRUE)

</code></pre>


</div>