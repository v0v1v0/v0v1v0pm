<div class="container">

<table style="width: 100%;"><tr>
<td>makeTemplate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Make an Acoustic Template
</h2>

<h3>Description</h3>

<p>Functions for creating a spectrogram cross-correlation template or a binary point matching template for later use in identification of acoustic signals.
A template is made by manually or automatically selecting cells within a Fourier-transformed representation (a spectrogram) of an audio recording.
</p>


<h3>Usage</h3>

<pre><code class="language-R"> 

makeCorTemplate(clip, t.lim = NA, frq.lim = c(0, 12), select = "auto", dens = 1,
                score.cutoff = 0.4, name = "A", comment = "", spec.col = gray.3(), 
                sel.col = ifelse(dens == 1, "#99009975", "orange"),
                wl = 512, ovlp = 0, wn = "hanning", write.wav = FALSE, ...)

makeBinTemplate(clip, t.lim = NA, frq.lim = c(0, 12), select = "auto", binary = TRUE, 
                buffer = 0, dens = 1, score.cutoff = 12, name = "A", comment = "", 
                amp.cutoff = "i", shift = "i", high.pass = -Inf, spec.col = gray.3(), 
                bin.col = c("white", "black"), 
                quat.col = c("white", "gray40", "gray75", "black"), 
                sel.col = c("orange", "blue"), legend.bg.col = "#2E2E2E94", 
                legend.text.col = "black", wl = 512, ovlp = 0, wn = "hanning", 
                write.wav = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>clip</code></td>
<td>

<p>A file path to one wav or mp3 file, or a Wave object (but see 'Details' for this case).
Or, for <code>makeBinTemplate</code> only, a list or vector of two such objects.
Character vector or list. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t.lim</code></td>
<td>

<p>Time limits of the spectrogram plot or template itself, or a list of exactly two such vectors.
Length two numeric vector.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frq.lim</code></td>
<td>

<p>Frequency limits of spectrogram plot or template.
Length two numeric vector.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>select</code></td>
<td>

<p>How should points be selected? 
Options are "cell", "rectangle", "auto".
Length one character vector. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binary</code></td>
<td>

<p>Should plot be binary?
Length one logical vector. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>buffer</code></td>
<td>

<p>The size of a buffer (in number of time by frequency bins) around “on” points for select = "rectangle" and select = "auto" for <code>makeBinTemplate</code>.
Bins within the buffer will not be included as “on” or “off” points.
Length one integer vector.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dens</code></td>
<td>

<p>Approximate density of points included with select = "rectangle" and select = "auto" as a fraction of 1.0.
Length one numeric vector.
</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>score.cutoff</code></td>
<td>

<p>The numeric value set for the <code>score.cutoff</code> element of the resulting template.
This value will determine which peaks qualify as detections when the resulting template is used in a complete detection analysis.
Length one numeric vector.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>

<p>The name of the template, which will be associated with the template.
To change the name of an existing template, see <code>templatenames</code>.
Length one character vevetor.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comment</code></td>
<td>

<p>Comment that will be saved with the template.
See <code>templateComment</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>amp.cutoff</code></td>
<td>

<p>Amplitude cutoff for creating a binary plot.
Length one numeric vector or else <code>"i"</code> for interactive selection.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shift</code></td>
<td>

<p>When two clips are used, the forward shift for the second clip, in time bins.
Length one integer vector, or <code>"i"</code> for interactive.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>high.pass</code></td>
<td>

<p>High-pass filter value. 
All amplitudes below this frequency will be set to the minimum.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spec.col</code></td>
<td>

<p>A color palette function for the spectrogram when <code>binary = FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bin.col</code></td>
<td>

<p>Colors for the spectrogram when <code>binary = TRUE</code>.
Length two character vector: <code>bin.col[1]</code> for cells below the cutoff, <code>bin.col[2]</code> for cells above the cutoff.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quat.col</code></td>
<td>

<p>Colors for the spectrogram when using two clips.
Length four character vector: <code>bin.col[1]</code> for cells below the cutoff for both clips, <code>bin.col[2]</code> for cells above the cutoff for clip 1 only, <code>bin.col[3]</code> for cells above the cutoff for clip 2 only, <code>bin.col[4]</code> for cells above the cutoff for both clips.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sel.col</code></td>
<td>

<p>The color for displaying selected cells.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.bg.col</code></td>
<td>

<p>The color of the legend background.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.text.col</code></td>
<td>

<p>Legend text color.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wl</code></td>
<td>

<p>The <code>wl</code> argument sent to the <code>spectro</code> function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ovlp</code></td>
<td>

<p>The <code>ovlp</code> argument sent to the <code>spectro</code> function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wn</code></td>
<td>

<p>The <code>wn</code> argument sent to the <code>spectro</code> function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>write.wav</code></td>
<td>

<p>If <code>clip</code> is a <code>Wave</code> object, should it be written to file? If <code>FALSE</code>, functions will return an error.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Additional arguments to <code>spectro</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>makeCorTemplate</code> is used for making correlation templates, while <code>makeBinTemplate</code> is used to make binary point matching templates.
<code>makeBinTemplate</code> can be used with one or two recordings (<code>clip</code> argument).
If the <code>clip</code> argument is a <code>Wave</code> object, the functions will attempt to write the object(s) to a wav file(s) in the working directory, but only if the <code>write.wav</code> argument is <code>TRUE</code>. 
To use templates produced with these functions, see <code>corMatch</code> or <code>binMatch</code>.
To combine template lists, see <code>combineCorTemplates</code> or <code>combineBinTemplates</code>.
</p>


<h3>Value</h3>

<p>An S4 object of class <code>corTemplateList</code> (returned by <code>makeCorTemplate</code>) or <code>binTemplateList</code> (returned by <code>makeBinTemplate</code>).
</p>


<h3>Author(s)</h3>

<p>Sasha D. Hafner and Jon Katz
</p>


<h3>References</h3>

<p>Mellinger, DK, Clark, CW. 1997. Methods for automatic detection of mysticete sounds. <em>Marine and Freshwater Behaviour and Physiology</em> <b>29</b>, 163-181.
</p>
<p>Towsey M, Planitz, B, Nantes, A, Wimmer, J, Roe, P.  2012.  A toolbox for animal call recognition.  <em>Bioacoustics</em> <b>21</b>, 107-125.
</p>


<h3>See Also</h3>

<p><code>corMatch</code>, 
<code>binMatch</code>, 
<code>templateNames</code>, 
<code>templateCutoff</code> 
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load example Wave objects
data(btnw)
data(oven)

# Use a Wave object directly to make a template
## Not run: 
# Not run because it will create a file in user's working directory with write.wav = TRUE
wct1 &lt;- makeCorTemplate(btnw, name = "w1", write.wav = TRUE)
wct1

## End(Not run)

# For traceability, better to use acoustic files
# Here, first write Wave objects to file (temporary directory used here)
btnw.fp &lt;- file.path(tempdir(), "btnw.wav")
oven.fp &lt;- file.path(tempdir(), "oven.wav")
writeWave(btnw, btnw.fp)
writeWave(oven, oven.fp)

# Use default arguments except for name
wct1 &lt;- makeCorTemplate(btnw.fp, name = "w1")

# Specify time and frequency limits to focus on a smaller area
wct2 &lt;- makeCorTemplate(btnw.fp, t.lim = c(1.5, 2.1), frq.lim = c(4.2, 5.6), name = "w2")

# For finer control, see options for select argument, e.g., 
## Not run: 
# Not run because requires user interaction
wct3 &lt;- makeCorTemplate(btnw.fp, select = "cell", name = "w3")
wct4 &lt;- makeCorTemplate(btnw.fp, select = "rectangle", name = "w4")

## End(Not run)

# Use a different recording--different species here
oct1 &lt;- makeCorTemplate(oven.fp, name = "o1", t.lim = c(1, 4), frq.lim = c(1, 11))

# Reduce cell density
oct2 &lt;- makeCorTemplate(oven.fp, name = "o2", t.lim = c(1, 4), frq.lim = c(1, 11), 
                        dens = 0.1)

# Binary templates are similar
# By default, amplitude cutoff is interactively set
## Not run: 
wbt1 &lt;- makeBinTemplate(btnw.fp, name = "w1")

## End(Not run)

# Or specify cutoff directly
wbt1 &lt;- makeBinTemplate(btnw.fp, amp.cutoff = -40, name = "w1")

# Specify time and frequency limits to focus on a smaller area in spectrogram, and add a 
# buffer
## Not run: 
wbt2 &lt;- makeBinTemplate(btnw.fp, amp.cutoff = -30, t.lim = c(1.5, 2.1), 
                        frq.lim = c(4.2, 5.6), buffer = 2, name = "w2")

## End(Not run)

# For finer control, see options for select argument, e.g., 
## Not run: 
# Not run because it requires user input to select cells for the template
wbt3 &lt;- makeBinTemplate(btnw.fp, amp.cutoff = -40, t.lim = c(0.5, 2.5), 
                        frq.lim = c(1, 11), select = "cell", name = "w3")

wbt4 &lt;- makeBinTemplate(btnw.fp, amp.cutoff = -40, t.lim = c(0.5, 2.5), 
                        frq.lim = c(1, 11), select = "rectangle", buffer = 3, name = "w4")

## End(Not run)

# Clean up (only because these files were created in these examples)
file.remove(btnw.fp)
file.remove(oven.fp)

# TemplateList plotting help:
method?plot('TemplateList')
</code></pre>


</div>