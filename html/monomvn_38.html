<div class="container">

<table style="width: 100%;"><tr>
<td>randmvn</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Randomly Generate a Multivariate Normal Distribution </h2>

<h3>Description</h3>

<p>Randomly generate a mean vector and covariance matrix describing
a multivariate normal (MVN) distribution, and then sample from it
</p>


<h3>Usage</h3>

<pre><code class="language-R">randmvn(N, d, method = c("normwish", "parsimonious"),
        mup=list(mu = 0, s2 = 1), s2p=list(a = 0.5, b = 1),
        pnz=0.1, nu=Inf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p> number of samples to draw </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p> dimension of the  MVN, i.e., the length of the mean vector
and the number of rows/cols of the covariance matrix </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p> the default generation method is <code>"norwish"</code>
uses the direct method described in the details section below,
whereas the <code>"parsimonious"</code> method builds up the random mean
vector and covariance via regression coefficients, intercepts,
and variances. See below for more details.  Here, a random number of
regression coefficients for each regression are set to zero </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mup</code></td>
<td>
<p> a <code>list</code> with entries <code>$mu</code> and <code>$s2</code>:
<code>$mu</code> is the prior mean for the independent components
of the normally distributed mean vector; <code>$s2</code> is the prior
variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s2p</code></td>
<td>
<p> a <code>list</code> with entries <code>$a</code> and <code>$b</code> 
only valid for <code>method = "parsimonious"</code>:
<code>$a &gt; 0</code> is the baseline inverse gamma prior scale parameter
for the regression variances (the actual parameter used for
each column <code>i in 1:d</code> of the covariance matrix is
<code>a + i - 1</code>); <code>$b &gt;= 0</code> is the rate parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pnz</code></td>
<td>
<p> a scalar <code>0 &lt;= pnz &lt;= 1</code>, only valid for
<code>method = "parsimonious"</code>: determines the binomial
proportion of non-zero regression coefficients in the sequential
build-up of <code>mu</code> and <code>S</code>, thereby indirectly determining
the number of non-zero entries in <code>S</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p> a scalar <code>&gt;= 1</code> indicating the degrees of freedom
of a Student-t distribution to be used instead of an MVN
when not infinite </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In the direct method (<code>"normwish"</code>) the components of the
mean vector <code>mu</code> are iid from a standard normal distribution,
and the covariance matrix <code>S</code> is
drawn from an inverseâ€“Wishart distribution with degrees of freedom
<code>d + 2</code> and mean (centering matrix) <code>diag(d)</code>
</p>
<p>In the <code>"parsimonious"</code> method <code>mu</code> and <code>S</code> are
built up sequentially by randomly sampling intercepts, regression
coefficients (of length <code>i-1</code> for <code>i in 1:d</code>) and variances
by applying the <code>monomvn</code> equations.  A unique prior results
when a random number of the regression coefficients are set to zero.
When none are set to zero the direct method results
</p>


<h3>Value</h3>

<p>The return value is a <code>list</code> with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mu </code></td>
<td>
<p>randomly generated mean vector of length <code>d</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S </code></td>
<td>
<p>randomly generated covariance <code>matrix</code> with <code>d</code>
rows and <code>d</code> columns </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x </code></td>
<td>
<p>if <code>N &gt; 0</code> then <code>x</code> is an <code>N*d</code>
<code>matrix</code> of <code>N</code> samples from the MVN with mean vector
<code>mu</code> and covariance <code>matrix</code> <code>S</code>; otherwise when
<code>N = 0</code> this component is not included</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p> requires the <code>rmvnorm</code> function of the
<span class="pkg">mvtnorm</span> package </p>


<h3>Author(s)</h3>

<p> Robert B. Gramacy <a href="mailto:rbg@vt.edu">rbg@vt.edu</a> </p>


<h3>See Also</h3>

 <p><code>rwish</code>, <code>rmvnorm</code>,
<code>rmono</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">randmvn(5, 3)
</code></pre>


</div>