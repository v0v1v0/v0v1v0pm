<div class="container">

<table style="width: 100%;"><tr>
<td>monosurv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian monotonic regression for time-to-event outcomes</h2>

<h3>Description</h3>

<p>This function implements an extended version of the Bayesian monotonic regression
procedure described in Saarela &amp; Arjas (2011), allowing for multiple additive monotonic
components, and time-to-event outcomes through case-base sampling. Logistic/multinomial
regression is fitted if no time variable is present. The extension and its applications, 
including estimation of absolute risks, are described in Saarela &amp; Arjas (2015).
The example below does logistic regression; for an example of modeling a time-to-event outcome, 
please see the documentation for the dataset <code>risks</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">monosurv(niter=15000, burnin=5000, adapt=5000, refresh=10, thin=5, 
         birthdeath=10, timevar=0, seed=1, rhoa=0.1, rhob=0.1, 
         years=NULL, deltai=0.1, drange=2.0, predict, include, 
         casestatus, sprob=NULL, offset=NULL, tstart=NULL, axes, 
         covariates, ccovariates=NULL, settozero, package, cr=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>niter</code></td>
<td>
<p>Total number of MCMC iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>Number of iterations used for burn-in period.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adapt</code></td>
<td>
<p>Number of iterations used for adapting Metropolis-Hastings proposals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>refresh</code></td>
<td>
<p>Interval for producing summary output of the state of the MCMC sampler.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>Interval for saving the state of the MCMC sampler.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>birthdeath</code></td>
<td>
<p>Number of birth-death proposals attempted at each iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timevar</code></td>
<td>
<p>Number identifying the column in argument <code>axes</code> representing a time variable. 
Zero if no time variable is present, in which case a logistic/multinomial regression is fitted (instead of a hazard regression).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Seed for the random generator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rhoa</code></td>
<td>
<p>Shape parameter of a Gamma hyperprior for the Poisson process rate parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rhob</code></td>
<td>
<p>Scale parameter of a Gamma hyperprior for the Poisson process rate parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>years</code></td>
<td>
<p>Time period over which absolute risks are calculated (on a time scale scaled to zero-one interval; optional).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deltai</code></td>
<td>
<p>Range for a uniform proposal for the function level parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drange</code></td>
<td>
<p>Allowed range for the monotonic function components, on log-rate/log-odds scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predict</code></td>
<td>
<p>Indicator vector for the observations for which absolute risks are calculated (not included in the likelihood expression).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include</code></td>
<td>
<p>Indicator vector for  the observations to be included in the likelihood expression.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>casestatus</code></td>
<td>
<p>An integer vector indicating the case status (0=censoring, 1=event of interest, 2=competing event).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sprob</code></td>
<td>
<p>Vector of sampling probabilities/rates for each person/person-moment (optional).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>Vector of offset terms to be included in the linear predictor of the events of interest (optional).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tstart</code></td>
<td>
<p>Vector of entry times on a time scale scaled to zero-one interval (optional).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axes</code></td>
<td>
<p>A matrix where the columns specify the covariate axes in the non-parametrically specified regression functions. 
Each variable here must be scaled to zero-one interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariates</code></td>
<td>
<p>A matrix of additional covariates to be included in the linear predictor of the events of interest. 
Must include at least a vector of ones to specify an intercept term.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ccovariates</code></td>
<td>
<p>A matrix of additional covariates to be included in the linear predictor of the competing events (optional).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>settozero</code></td>
<td>
<p>A zero-one matrix specifying the point process construction. Each row represents a point process,
while columns correspond to the columns of the argument <code>axes</code>, indicating whether the column is one of the dimensions specifying the domain of the point process.
(See function <code>getcmat</code>.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>package</code></td>
<td>
<p>An integer vector specifying the additive component into which each point process (row) specified in argument <code>settozero</code> is placed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cr</code></td>
<td>
<p>A zero-one vector indicating the additive components to be placed in the linear predictor of the competing causes (optional).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with elements
</p>
<table>
<tr style="vertical-align: top;">
<td><code>steptotal</code></td>
<td>
<p>A sample of total number of points in the marked point process construction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>steps</code></td>
<td>
<p>A sample of the number of points used per each additive component.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>A sample of the Poisson process rate parameters (one per each point process specified).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>A sample of log-likelihood values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>A sample of regression coefficients for the variables specified in the argument <code>covariates</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betac</code></td>
<td>
<p>A sample of regression coefficients for the variables specified in the argument <code>ccovariates</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>A sample of non-parametric regression function levels for each observation specified in the argument <code>predict</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>risk</code></td>
<td>
<p>A sample of absolute risks of the event of interest for each observation specified in the argument <code>predict</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crisk</code></td>
<td>
<p>A sample of absolute risks of the competing event for each observation specified in the argument <code>predict</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Olli Saarela &lt;olli.saarela@utoronto.ca&gt;</p>


<h3>References</h3>

<p>Saarela O., Arjas E. (2011). A method for Bayesian monotonic multiple regression. Scandinavian Journal of Statistics, 38:499–513.
</p>
<p>Saarela O., Arjas E. (2015). Non-parametric Bayesian hazard regression for chronic disease risk assessment. Scandinavian Journal of Statistics, 42:609–626.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(monoreg)
set.seed(1)
# nobs &lt;- 1000
nobs &lt;- 50
x1 &lt;- runif(nobs)
x2 &lt;- runif(nobs)

# 6 different monotonic regression surfaces:
# mu &lt;- sqrt(x1)
mu &lt;- 0.5 * x1 + 0.5 * x2
# mu &lt;- pmin(x1, x2)
# mu &lt;- 0.25 * x1 + 0.25 * x2 + 0.5 * (x1 + x2 &gt; 1.0)
# mu &lt;- 0.25 * x1 + 0.25 * x2 + 0.5 * (pmax(x1, x2) &gt; 0.5)
# mu &lt;- ifelse((x1 - 1.0)^2 + (x2 - 1.0)^2 &lt; 1.0, sqrt(1.0 - (x1 - 1.0)^2 - (x2 - 1.0)^2), 0.0)

y &lt;- rbinom(nobs, 1, mu)

# results &lt;- monosurv(niter=15000, burnin=5000, adapt=5000, refresh=10, 
results &lt;- monosurv(niter=5000, burnin=2500, adapt=2500, refresh=10, 
                    thin=5, birthdeath=10, seed=1, 
                    rhoa=0.1, rhob=0.1, deltai=0.5, drange=10.0, 
                    predict=rep(1.0, nobs), include=rep(1.0, nobs), 
                    casestatus=y, axes=cbind(x1,x2), covariates=rep(1.0, nobs),
                    settozero=getcmat(2), package=rep(1,3))

# pdf(file.path(getwd(), 'pred3d.pdf'), width=6.0, height=6.0, paper='special')
op &lt;- par(mar=c(2,2,0,0), oma=c(0,0,0,0), mgp=c(2.5,1,0), cex=0.75)
pred &lt;- colMeans(results$risk)
idx &lt;- order(pred, decreasing=TRUE)

tr &lt;- persp(z=matrix(c(NA,NA,NA,NA), 2, 2), zlim=c(0,1), 
            xlim=c(0,1), ylim=c(0,1),
            ticktype='detailed', theta=-45, phi=25, ltheta=25, 
            xlab='X1', ylab='X2', zlab='mu')
for (i in 1:nobs) {
    lines(c(trans3d(x1[idx[i]], x2[idx[i]], 0.0, tr)$x, 
            trans3d(x1[idx[i]], x2[idx[i]], pred[idx[i]], tr)$x),
          c(trans3d(x1[idx[i]], x2[idx[i]], 0.0, tr)$y, 
            trans3d(x1[idx[i]], x2[idx[i]], pred[idx[i]], tr)$y),
          col='gray70')
}
points(trans3d(x1[idx], x2[idx], pred[idx], tr), pch=21, bg='white')
par(op)
# dev.off()

## End(Not run)
</code></pre>


</div>