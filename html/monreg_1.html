<div class="container">

<table style="width: 100%;"><tr>
<td>monreg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Estimating Monotone Regression Functions Nonparametrically
</h2>

<h3>Description</h3>

<p>monreg provides a strictly monotone estimator of the regression
function based on the nonparametric regression model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">monreg(x, y, a = min(x), b = max(x), N = length(x), t = length(x),
       hd, Kd = "epanech", hr, Kr = "epanech", degree = 1,
       inverse = 0, monotonie = "isoton")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector containing the x-values (design points) of a sample</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>vector containing the y-values (response) of a sample</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>lower bound of the support of the design points density
function, or smallest fixed design point</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>upper bound of the support of the design points density
function, or largest fixed design point</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>number or vector of evaluation points of the unconstrained
nonparametric regression estimator (e.g. Nadaraya-Watson estimator)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>number or vector of points where the monotone estimation is 
computed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hd</code></td>
<td>
<p>bandwith of kernel <code class="reqn">K_d</code> of the density estimation step</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Kd</code></td>
<td>
<p>Kernel for the density estimation step (monotonization step).
'epanech' for Epanechnikov, 'rectangle' for rectangle, 'biweight' for biweight,
'triweight' for triweight, 'triangle' for triangle, 'cosine' for cosine kernel</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hr</code></td>
<td>
<p>bandwith of kernel <code class="reqn">K_r</code> of the regression estimation step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Kr</code></td>
<td>
<p>Kernel for the regression estimation step (unconstrained estimation).
'epanech' for Epanechnikov, 'rectangle' for rectangle, 'biweight' for biweight,
'triweight' for triweight, 'triangle' for triangle, 'cosine' for cosine kernel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>
<p>Determines the method for the unconstrained estimation.
'0' for the classical Nadaraya-Watson estimate, '1' for the local linear estimate.
As well degree can be the vector of the unconditional estimator provided by the
user for the design points given in the vector <code>N</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inverse</code></td>
<td>
<p>For '0' the original regression function is estimated, for '1'
the inverse of the regression function is estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>monotonie</code></td>
<td>
<p>Determines the type of monotonicity. 'isotonÂ´ if the regression
function is assumed to be isotone, 'antinton' if the regression function is assumed to be antitone.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Nonparametric regression models are of the form <code class="reqn">Y_i = m(X_i) + \sigma(X_i) \cdot \varepsilon_i</code>, 
where <code class="reqn">m</code> is the regression funtion and <code class="reqn">\sigma</code> the variance function.
<code>monreg</code> performs a monotone estimate of the unknown regression function 
<code class="reqn">m</code>. <code>monreg</code> first estimates <code class="reqn">m</code> by an unconstrained nonparametric
method, the classical Nadaraya-Watson estimate or the local- linear estimate 
(unless the user decides to pass his or her own estimate).
In a second step the inverse of the (monotone) regression function is calculated,
by monotonizing this unconstrained estimate. With the above notation and 
<code class="reqn">\hat m</code> for the unconstrained estimate, the second step writes as follows,
</p>
<p style="text-align: center;"><code class="reqn">\hat m_I^{-1} = \frac{1}{Nh_d} \sum\limits_{i=1}^N \int\limits_{-\infty}^t K_d \Bigl( \frac{\hat m (\frac{i}{N} ) - u}{h_d} \Bigr) \; du.</code>
</p>

<p>Finally, the monotone estimate achieved by inversion of <code class="reqn">\hat m_I^{-1}</code>.</p>


<h3>Value</h3>

<p><code>monreg</code> returns a list of values
</p>
<table>
<tr style="vertical-align: top;">
<td><code>xs</code></td>
<td>
<p>the input values x, standardized on the interval <code class="reqn">[0,1]</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>input variable y</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>the points, for which the unconstrained function is estimated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>the points, for which the monotone function values will be estimated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>length.x</code></td>
<td>
<p>length of the vector x</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>length.z</code></td>
<td>
<p>length of the vector z</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>length.t</code></td>
<td>
<p>length of the vector t</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hd</code></td>
<td>
<p>bandwidth used with the Kernel <code class="reqn">K_d</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hr</code></td>
<td>
<p>bandwidth used with the Kernel <code class="reqn">K_r</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Kd</code></td>
<td>
<p>kernel used for the monotonization step</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Kr</code></td>
<td>
<p>kernel used for the initial unconstrained regression estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>
<p>method, which was used for the unconstrained regression estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ldeg.vektor</code></td>
<td>
<p> length of the vector degree. If ldeg.vektor is not equal to 1 the user provided the vector of the unconditional
estimator for the design points given in the vector N</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inverse</code></td>
<td>
<p>indicates, if the origin regression function or its inverse has been estimated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimation</code></td>
<td>
<p>the monotone estimate at the design points <code class="reqn">t</code></p>
</td>
</tr>
</table>
<p>...
</p>


<h3>Author(s)</h3>

<p>This R Package was developed by Kay Pilz and Stefanie Titoff. Earlier developements of the estimator were made by Holger Dette and Kay Pilz.
</p>


<h3>See Also</h3>

<p><code>monvardiff</code> and <code>monvarresid</code> for monotone variance function estimation.
</p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- rnorm(100)
y &lt;- x + rnorm(100)
mon1 &lt;- monreg(x, y, hd = .5, hr = .5)
plot(mon1$t, mon1$estimation)
</code></pre>


</div>