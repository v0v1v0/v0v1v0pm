<div class="container">

<table style="width: 100%;"><tr>
<td>lsp_add_clusters</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Adds clusters' ids to a lsp object</h2>

<h3>Description</h3>

<p>Adds clusters' ids to a lsp object.
The output can be of <code>stars</code>, <code>sf</code>, or <code>terra</code> class.
See examples.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lsp_add_clusters(x, clust, output = "sf", window = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Object of class <code>lsp</code> - usually the output of
the <code>lsp_signature()</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clust</code></td>
<td>
<p>Vector containing an id value for each row in <code>x</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>The class of the output. Either <code>stars</code>, <code>sf</code>, or <code>terra</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window</code></td>
<td>
<p>Specifies areas for analysis. It can be either: <code>NULL</code> or an <code>sf</code> object. If <code>window=NULL</code> calculations are performed based on the metadata from <code>x</code>. If an <code>sf</code> object is provided, each feature (row) defines the extent of a local pattern. The <code>sf</code> object should have one attribute (otherwise, the first attribute is used as an id).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Object of class <code>stars</code>, <code>sf</code>, or <code>terra</code> (depending on the <code>output</code> argument) with an additional column <code>"clust"</code> representing clusters' id values.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(stars)
library(sf)
landform = read_stars(system.file("raster/landforms.tif", package = "motif"))
landform_cove = lsp_signature(landform,
                               type = "cove",
                               window = 200,
                               normalization = "pdf")

landform_dist = lsp_to_dist(landform_cove,
                            dist_fun = "jensen-shannon")

landform_hclust = hclust(landform_dist, method = "ward.D2")
#plot(landform_hclust)

clusters = cutree(landform_hclust, k = 4)

landform_grid_sf = lsp_add_clusters(landform_cove, clusters)
#plot(landform_grid_sf["clust"])

#landform_grid_sfq = lsp_add_quality(landform_grid_sf,
#                                        landform_dist)
#plot(landform_grid_sfq["quality"])

## larger data example
# library(stars)
# library(sf)
# landform = read_stars(system.file("raster/landform.tif", package = "motif"),
#                       proxy = FALSE)
# landform_cove = lsp_signature(landform,
#                                type = "cove",
#                                window = 200,
#                                normalization = "pdf")
#
# landform_dist = lsp_to_dist(landform_cove,
#                             dist_fun = "jensen-shannon")
#
# landform_hclust = hclust(landform_dist, method = "ward.D2")
# plot(landform_hclust)
#
# clusters = cutree(landform_hclust, k = 6)
#
# landform_grid_sf = lsp_add_clusters(landform_cove, clusters)
# plot(landform_grid_sf["clust"])
#
# landform_grid_sfq = lsp_add_quality(landform_grid_sf,
#                                        landform_dist)
# plot(landform_grid_sfq["quality"])
</code></pre>


</div>