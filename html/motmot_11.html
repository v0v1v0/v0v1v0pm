<div class="container">

<table style="width: 100%;"><tr>
<td>chr.disp.param</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate character displacement data wrapper</h2>

<h3>Description</h3>

<p>Simulates phylogenetic trait data under a character displacement model (Clarke et al. 2017) in which traits interact inter-specifically, with competition between sympatric lineages driving trait values apart
</p>


<h3>Usage</h3>

<pre><code class="language-R">chr.disp.param(
  phy,
  n.sim = 100,
  n.steps = 1000,
  max.sigma = 8,
  max.a = 8,
  est.blomberg.k = FALSE,
  ntraits = 1,
  sympatry = NA,
  allopatry = NA,
  trait.lim = NA,
  mc.cores = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>An object of class <code>phylo</code> (see <span class="pkg">ape</span>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.sim</code></td>
<td>
<p>Number of replications to simulate data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.steps</code></td>
<td>
<p>Number of time steps the for the simulation (default = 1000 time steps).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.sigma</code></td>
<td>
<p>The maximum value of Brownian variance in the simulation sampled from a U(0, max.sigma) distribution for each iteration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.a</code></td>
<td>
<p>The maximum value of the strength of competition between inter-specific lineages sampled from a U(0, max.a) distribution for each iteration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est.blomberg.k</code></td>
<td>
<p>Logical. If TRUE, Blomberg's K is simultaneously estimated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntraits</code></td>
<td>
<p>Number of traits to be simulated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sympatry</code></td>
<td>
<p>an optional matrix giving the time that each pair of species starts to interact</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allopatry</code></td>
<td>
<p>an optional matrix giving the times when species stop interacting</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trait.lim</code></td>
<td>
<p>an optional parameter that puts limits on the available trait-space, preventing trait values with magnitude greater than the value of lim</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mc.cores</code></td>
<td>
<p>Numeric. The number of parallel cores to be used in simulations. Only applicable on Linux and Mac systems</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>List containing the simulated data 'simulated.param': a matrix with each row represented an iteration, the sigma (Brownian variance) used in the iteration, the 'a' value used in each iteration, the mean and standard deviation between neighbouring trait values. The 'input.arguments' from the model, the 'input.phy' from the model, and the input 'sympatry' and 'allopatry' matrices.
</p>


<h3>Author(s)</h3>

<p>Magnus Clarke and Mark Puttick
</p>


<h3>References</h3>

<p>Clarke M, Thomas GH, &amp; Freckleton RP. 2017. Trait evolution in adaptive radiations: modeling and measuring interspecific competition on phylogenies. The American Naturalist 189, 121-137.
</p>


<h3>See Also</h3>

<p><code>chr.disp.sim</code>, <code>chr.disp.lrt</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## import finch data form Clarke et al. (2017)
data(finches)
## simulate small amount of data 
## (example only - many more datasets are required for accuracy)
param.simulation &lt;- chr.disp.param(finch.tree, n.sim = 3, n.steps=100,  
max.sigma = 8, max.a = 8, ntraits=1, 
allopatry=as.matrix(allopatric.data), mc.cores = 1)
</code></pre>


</div>