<div class="container">

<table style="width: 100%;"><tr>
<td>contemporaryPhy</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>prune tree and data to lineages present in a time bin in the past</h2>

<h3>Description</h3>

<p>the function takes a full tree and returns a pruned phylogeny with only tips and lineages found within a time bin preserved. If trait data are supplied the function will return tip states based either on the original tips found in the bin, or tip states inferred from ancestral states
</p>


<h3>Usage</h3>

<pre><code class="language-R">contemporaryPhy(
  phy,
  maxBin,
  minBin,
  reScale = 0,
  allTraits,
  closest.min = TRUE,
  traits.from.tip = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>An object of class <code>phylo</code> (see <span class="pkg">ape</span>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxBin</code></td>
<td>
<p>the start age (older time in myr from present) of the time bin in which lineages are preserved</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minBin</code></td>
<td>
<p>the final age (younger time in myr from present) of the time bin in which lineages are preserved</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reScale</code></td>
<td>
<p>if the most recent tip is not from the present, the age needed to add so the phylogeny is in 'real time'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allTraits</code></td>
<td>
<p>a vector of trait data corresponding to the phy$edge object. The trait data represent tip and internal node data for the phylogeny</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>closest.min</code></td>
<td>
<p>Logical. Should new tip values for lineages that span the bin be taken from the node nearest the <code>minBin</code> age (<code>closest.min=TRUE</code>, default) or the <code>maxBin</code> age <code>closest.min=FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>traits.from.tip</code></td>
<td>
<p>Logical. Should tip values for pendant edges in the bin be taken from the original tip value or the reconstructed node value (if it is closer than the tip value)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>the pruned phylogeny. The object <code>descendants</code> refers to the lineages the branch in the time bin gave rise to before it was pruned. If traits are included a vector of trait values representing species at the tips.
</p>


<h3>Author(s)</h3>

<p>Mark Puttick
</p>


<h3>References</h3>

<p>Puttick, M. N., Kriwet, J., Wen, W., Hu, S., Thomas, G. H., &amp; Benton, M. J. (2017). Body length of bony fishes was not a selective factor during the biggest mass extinction of all time. Palaeontology, 60, 727-741.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## prune a random tree to taxa present between 4 and 2 units before present
# generate tree
set.seed(20)
tree &lt;- rtree(20)
# generate traits
traits &lt;- rnorm(20)
# plot tree and timeframe
plot(tree)
max.age &lt;- nodeTimes(tree)[1,1]
abline(v=max.age - c(4, 2))
# prune tree to timeframe
cont.tree &lt;- contemporaryPhy(phy=tree, maxBin=4, minBin=2, allTraits=traits)
plot(cont.tree$phy)
</code></pre>


</div>