<div class="container">

<table style="width: 100%;"><tr>
<td>pic.pgls</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fast PLGS estimation based on contrasts</h2>

<h3>Description</h3>

<p>Estimates regression parameters for a phylogenetic generalised least-squares analysis using the fast constrasts method (Felsenstein 1973; 1985; Freckleton 2012). This implementation is applicable for continuous traits only and not factors
</p>


<h3>Usage</h3>

<pre><code class="language-R">pic.pgls(
  formula,
  phy,
  y,
  lambda = "ML",
  return.intercept.stat = FALSE,
  meserr = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A model formula with continuous variables only</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>An object of class <code>phylo</code> (see <span class="pkg">ape</span>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A matrix of trait values with rownames corresponding to the phy tip labels, and column names corresponding to the formula variable names</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Default is "ML" meaning the phylogenetic signal of the response variable will be estimated using restricted Maximum likelihood. If a numeric value between 0-1 is provided this will be used in the calculation of regression coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.intercept.stat</code></td>
<td>
<p>Logical. If <code>TRUE</code> the standard errors, t value, and p value of the estimated Intercept is provided for comparison with output from <code>pgls</code> from <span class="pkg">caper</span> etc.,. Default is <code>FALSE</code> as this slows the function as it involves constructing and calculating the inverse of the phy variance-covariance matrix, and based on contrasts the design matrix column of ones would have zero contrasts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meserr</code></td>
<td>
<p>A vector (or matrix) of measurement error for each tip. This is only applicable to univariate analyses.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the model, model summary, intercept, estimate of Lambda, model log-Likelihood, model AIC
</p>


<h3>Author(s)</h3>

<p>Mark N Puttick and Rob Freckleton
</p>


<h3>See Also</h3>

<p><code>pgls</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Data and phylogeny
data(anolis.tree)
anolis.tree$node.label &lt;- NULL
lm.data &lt;- transformPhylo.sim(phy=anolis.tree, n=2, model="bm")
dat &lt;- data.frame(x = lm.data[,1], y = lm.data[,2],
names = anolis.tree$tip, row.names = anolis.tree$tip)
picModel &lt;- pic.pgls(formula=y ~  x,
phy=anolis.tree, y = dat, lambda=1,
return.intercept.stat=FALSE)
</code></pre>


</div>