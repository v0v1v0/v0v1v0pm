<div class="container">

<table style="width: 100%;"><tr>
<td>transformPhylo</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Phylogenetic tree transformations</h2>

<h3>Description</h3>

<p>Transforms the branch lengths of a phylo object according to a model of trait evolution (see details).
</p>


<h3>Usage</h3>

<pre><code class="language-R">transformPhylo(
  phy,
  model = NULL,
  y = NULL,
  meserr = NULL,
  kappa = NULL,
  lambda = NULL,
  delta = NULL,
  alpha = NULL,
  psi = NULL,
  lambda.sp = NULL,
  nodeIDs = NULL,
  rateType = NULL,
  branchRates = NULL,
  cladeRates = NULL,
  splitTime = NULL,
  timeRates = NULL,
  acdcRate = NULL,
  branchLabels = NULL,
  cophenetic.dist = NULL,
  vcv.matrix = NULL,
  mode.order = NULL,
  mode.param = NULL,
  rate.var = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>An object of class <code>phylo</code> (see <span class="pkg">ape</span>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>The model of trait evolution (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A matrix of trait values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meserr</code></td>
<td>
<p>A vector (or matrix) of measurement error for each tip. This is only applicable to univariate analyses. Largely untested - please use cautiously</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kappa</code></td>
<td>
<p>Value of kappa transform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Value of lambda transform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>Value of delta transform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Value of alpha (OU) transform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi</code></td>
<td>
<p>Value of psi transform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.sp</code></td>
<td>
<p>Estimate of speciation (lambda) for the psi models</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nodeIDs</code></td>
<td>
<p>Integer - ancestral nodes of clades.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rateType</code></td>
<td>
<p>If model="clade", a vector specifying if rate shift occurs in a clade ("clade") or on the single branch leading to a clade ("branch").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>branchRates</code></td>
<td>
<p>Numeric vector specifying relative rates for individual branches</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cladeRates</code></td>
<td>
<p>Numeric vector specifying telative rates for clades or logical to indicate scalar is included in the 'modeslice' model (the scalar is included in the mode.param argument with the 'modeslice' model).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>splitTime</code></td>
<td>
<p>A split time (measured from the present, or most recent species) at which a shift in the rate occurs for the "timeSlice" model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeRates</code></td>
<td>
<p>The rates (from ancient to recent) for the timeSlice model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acdcRate</code></td>
<td>
<p>Value of ACDC transform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>branchLabels</code></td>
<td>
<p>A vector of length equal to the number of internal branches, signifying the which "multiPsi" class it belongs to</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cophenetic.dist</code></td>
<td>
<p>a cophenetic distance matrix showing the absolute distance between taxa - only applicable for OU models run on non-ultrmetric trees. If null will be calculated internally, but supplying the data can speed up run time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcv.matrix</code></td>
<td>
<p>a variance-covariance matrix - only applicable for OU models run on non-ultrmetric trees. If null will be calculated internally, but supplying the data can speed up run time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode.order</code></td>
<td>
<p>The order of modes for the 'modeslice' model. Any combination of 'BM', 'OU', 'acdc', and 'kappa'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode.param</code></td>
<td>
<p>Parameters for the modes of evoluton in the 'modeslice' model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate.var</code></td>
<td>
<p>Allows rate variation in BM modes in the 'modeslice' model</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Transforms the branch lengths of a phylo object according to one of the following models:
</p>

<ul>
<li> <p>model="bm"- Brownian motion (constant rates random walk)
</p>
</li>
<li> <p>model="kappa" - fits Pagel's kappa by raising all branch lengths to the power kappa. As kappa approaches zero, trait change becomes focused at branching events. For complete phylogenies, if kappa approaches zero this infers speciational trait change. 
</p>
</li>
<li> <p>model="lambda" - fits Pagel's lambda to estimate phylogenetic signal by multiplying all internal branches of the tree by lambda, leaving tip branches as their original length (root to tip distances are unchanged);
</p>
</li>
<li> <p>model="delta" - fits Pagel's delta by raising all node depths to the power delta. If delta &lt;1, trait evolution is concentrated early in the tree whereas if delta &gt;1 trait evolution is concentrated towards the tips. Values of delta above one can be difficult to fit reliably.
</p>
</li>
<li> <p>model="free" - fits Mooer's et al's (1999) free model where each branch has its own rate of trait evolution. This can be a useful exploratory analysis but it is slow due to the number of parameters, particularly for large trees.
</p>
</li>
<li> <p>model="clade" - fits a model where particular clades are a priori hypothesised to have different rates of trait evolution (see O'Meara et al. 2006; Thomas et al. 2006, 2009). Clades are specified using nodeIDs and are defined as the mrca node. Unique rates for each clade are specified using cladeRates. rateType specifies whether the rate shift occurs in the stem clade or on the single branch leading to the clade.
</p>
</li>
<li> <p>model="OU" - fits an Ornstein-Uhlenbeck model - a random walk with a central tendency proportional to alpha. High values of alpha can be interpreted as evidence of evolutionary constraints, stabilising selection or weak phylogenetic signal.
</p>
</li>
<li> <p>model="psi" - fits a model to assess to the relative contributions of speciation and gradual evolution to a trait's evolutionary rate (Ingram 2010). Note that 'original nodes' from the full phylogeny can be included as an element on the phylogeny (e.g., phy$orig.node) as well as estimates of 'hidden' speciation (e.g., phy$hidden.speciation) if estimates of extinction (mu) are &gt; 0.
</p>
</li>
<li> <p>model="multiPsi" fits a model to assess to the relative contributions of speciation and gradual evolution to a trait's evolutionary rate but allows seperate values of psi fitted to seperate branches (Ingram 2010; Ingram et al. 2016). Note that 'original nodes' from the full phylogeny can be included as an element on the phylogeny (e.g., phy$orig.node) as well as estimates of 'hidden' speciation (e.g., phy$hidden.speciation) if estimates of extinction (mu) are &gt; 0.
</p>
</li>
<li> <p>model="ACDC" fits a model to in which rates can exponentially increased or decrease through time (Blomberg et al. 2003). If the upper bound is &lt; 0, the model is equivalent to the 'Early Burst' model of Harmon et al. 2010. If a nodeIDs is supplied, the model will fit a ACDC model nested within a clade, with a BM fit to the rest of the tree.
</p>
</li>
<li> <p>model="timeSlice" A model in which all branch rates change at time(s) in the past.
</p>
</li>
<li> <p>model="modeSlice" A model in which all branch modes change at a time or times set a priori by the user.
</p>
</li>
</ul>
<h3>Value</h3>

<p>phy  A phylo object with branch lengths scaled according to the given model and parameters
</p>


<h3>Author(s)</h3>

<p>Gavin Thomas, Mark Puttick
</p>


<h3>References</h3>

<p>Ingram T. 2011. Speciation along a depth gradient in a marine adaptive radiation. Proc. Roy. Soc. B. 278, 613-618.
</p>
<p>Ingram T,  Harrison AD, Mahler L, Castaneda MdR, Glor RE, Herrel A, Stuart YE, and Losos JB. Comparative tests of the role of dewlap size in Anolis lizard speciation. Proc. Roy. Soc. B. 283, 20162199.
</p>
<p>Mooers AO, Vamosi S, &amp; Schluter D. 1999. Using phylogenies to test macroevolutionary models of trait evolution: sexual selection and speciation in Cranes (Gruinae). American Naturalist 154, 249-259.
</p>
<p>O'Meara BC, Ane C, Sanderson MJ &amp; Wainwright PC. 2006. Testing for different rates of continuous trait evolution using likelihood. Evolution 60, 922-933
</p>
<p>Pagel M. 1997. Inferring evolutionary processes from phylogenies. Zoologica Scripta 26, 331-348.
</p>
<p>Pagel M. 1999 Inferring the historical patterns of biological evolution. Nature 401, 877-884.
</p>
<p>Thomas GH, Meiri S, &amp; Phillimore AB. 2009. Body size diversification in Anolis: novel environments and island effects. Evolution 63, 2017-2030.
</p>


<h3>See Also</h3>

<p><code>transformPhylo.ML</code>, <code>transformPhylo.ll</code>, <code>transformPhylo.MCMC</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(anolis.tree)
anolis.treeDelta &lt;- transformPhylo(phy=anolis.tree, model="delta", delta=0.5)
</code></pre>


</div>