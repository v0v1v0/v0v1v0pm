<div class="container">

<table style="width: 100%;"><tr>
<td>transformPhylo.MCMC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian MCMC for models of trait evolution</h2>

<h3>Description</h3>

<p>Fits Bayesian models for various models of continuous character evolution using a Metropolis-Hastings Markov Chain Monte Carlo (MCMC) approach
</p>


<h3>Usage</h3>

<pre><code class="language-R">transformPhylo.MCMC(
  y,
  phy,
  model,
  mcmc.iteration = 1000,
  burn.in = 0.1,
  hiddenSpeciation = FALSE,
  full.phy = NULL,
  lowerBound = NULL,
  upperBound = NULL,
  useMean = FALSE,
  random.start = TRUE,
  meserr = NULL,
  covPIC = TRUE,
  lambdaEst = FALSE,
  nodeIDs = NULL,
  branchLabels = NULL,
  acdcScalar = FALSE,
  sample.every = 10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A matrix of trait values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>An object of class <code>phylo</code> (see <span class="pkg">ape</span>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>The model of trait evolution (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcmc.iteration</code></td>
<td>
<p>Integer - the number of generations for which to run the MCMC chain</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn.in</code></td>
<td>
<p>The proportion of the chain (as given by mcmc.iteration) which to discard as 'burn-in'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hiddenSpeciation</code></td>
<td>
<p>Logical. If TRUE the psi model will include nodes that are on the 'full.phy' but not the tree pruned of trait data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>full.phy</code></td>
<td>
<p>The full phylogeny containing the species that do not contain trait data so are not included in 'phy'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lowerBound</code></td>
<td>
<p>Minimum value for parameter estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upperBound</code></td>
<td>
<p>Maximum value for parameter estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useMean</code></td>
<td>
<p>Logical. Use the branch-based estimates of extinction of mean (TRUE, default) for the "psi" and "multispi" models only applicable if "hiddenSpeciation" = TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random.start</code></td>
<td>
<p>Use a random starting value for the MCMC run (TRUE), or use the environment set.seed() value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meserr</code></td>
<td>
<p>A vector (or matrix) of measurement error for each tip. This is only applicable to univariate analyses</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covPIC</code></td>
<td>
<p>Logical. For multivariate analyses, allow for co-variance between traits rates (TRUE) or no covariance in trait rates (FALSE). If FALSE, only the trait variances not co-variances are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambdaEst</code></td>
<td>
<p>Logical.  Estimate lambda alongside parameter estimates to reduce data noise. Only applicable for models "kappa", "delta", "OU", "psi", "multispi", and "ACDC". Default=FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nodeIDs</code></td>
<td>
<p>Integer - ancestral nodes of clades applicable to rate heterogenous and nested models of evolution (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>branchLabels</code></td>
<td>
<p>Branches on which different psi parameters are estimated in the "multipsi" model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acdcScalar</code></td>
<td>
<p>Logical.  For nested EB rate model, simultaneously estimated a rate scalar alongside EB model. Default=FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample.every</code></td>
<td>
<p>Number specifying the every nth that is sampled in the MCMC chain (default = 1).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The method estimates posterior probabilities using a Metropolis-Hastings MCMC approach that places a prior bounded uniform distribution on all parameters with an independence sampler. These prior distributions can be altered by changing the upperBound and lowerBound arguments. The MCMC model will estimate the posterior probability for the following models:
</p>

<ul>
<li> <p>model="kappa" fits Pagel's kappa by raising all branch lengths to the power kappa. As kappa approaches zero, trait change becomes focused at branching events. For complete phylogenies, if kappa approaches zero this infers speciational trait change. Default bounds from ~0 - 1.
</p>
</li>
<li> <p>model="lambda" fits Pagel's lambda to estimate phylogenetic signal by multiplying all internal branches of the tree by lambda, leaving tip branches as their original length (root to tip distances are unchanged). Default bounds from ~0 - 1.
</p>
</li>
<li> <p>model="delta" fits Pagel's delta by raising all node depths to the power delta. If delta &lt;1, trait evolution is concentrated early in the tree whereas if delta &gt;1 trait evolution is concentrated towards the tips. Values of delta above one can be difficult to fit reliably. Default bounds from ~0 - 5.
</p>
</li>
<li> <p>model="OU" fits an Ornstein-Uhlenbeck model - a random walk with a central tendency proportional to alpha. High values of alpha can be interpreted as evidence of evolutionary constraints, stabilising selection or weak phylogenetic signal. It is often difficult to distinguish among these possibilities. Default bounds from ~0 - 10.
</p>
</li>
<li> <p>model="psi" fits a acceleration-deacceleration model to assess to the relative contributions of speciation and gradual evolution to a trait's evolutionary rate (Ingram 2010).
</p>
</li>
<li> <p>model="ACDC" fits a model to in which rates can exponentially increased or decrease through time (Blomberg et al. 2003). If the upper bound is &lt; 0, the model is equivalent to the 'Early Burst' model of Harmon et al. 2010. Default rate parameter bounds from ln(1e-10) ~ ln(20) divided by the root age.
</p>
</li>
</ul>
<h3>Value</h3>

<p>median The median estimate of the posterior for the parameter
</p>
<p>95.HPD The 95 percent Highest Posterior Density for the parameter
</p>
<p>ESS Effective Sample Size for the posterior
</p>
<p>acceptance.rate The ratio for which new proposals were accepted during the MCMC chain
</p>
<p>mcmc.chain Full MCMC chain containing all iterations (including burn-in)
</p>


<h3>Author(s)</h3>

<p>Mark Puttick, Gavin Thomas
</p>


<h3>See Also</h3>

<p><code>transformPhylo.ML</code>, <code>transformPhylo.ll</code>, <code>transformPhylo</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(anolis.tree)
data(anolis.data)
attach(anolis.data)
male.length &lt;- matrix(Male_SVL, dimnames=list(rownames(anolis.data)))
sortedData &lt;- sortTraitData(anolis.tree, male.length)
phy &lt;- sortedData$phy
male.length &lt;- sortedData$trait
phy.clade &lt;- extract.clade(phy, 182)
male.length.clade &lt;- as.matrix(male.length[match(phy.clade$tip.label, rownames(male.length)),])
## please note, this model will be need to run for longer to achieve convergence
lambda.mcmc &lt;- transformPhylo.MCMC(y=male.length.clade, phy=phy.clade, 
model="lambda", mcmc.iteration=100, burn.in=0.1)
</code></pre>


</div>