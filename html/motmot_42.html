<div class="container">

<table style="width: 100%;"><tr>
<td>transformPhylo.sim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Phylogenetic tree transformations</h2>

<h3>Description</h3>

<p>Simulates trait data on a tree using a specified model of evolution (see details).
</p>


<h3>Usage</h3>

<pre><code class="language-R">transformPhylo.sim(
  phy,
  n = 1,
  x = NULL,
  model = NULL,
  returnNodes = FALSE,
  kappa = NULL,
  lambda = NULL,
  delta = NULL,
  alpha = NULL,
  psi = NULL,
  acdcRate = NULL,
  lambda.sp = NULL,
  trend = NULL,
  trend.anc.state = 0,
  nodeIDs = NULL,
  rateType = NULL,
  cladeRates = NULL,
  branchRates = NULL,
  rate = NULL,
  group.means = NULL,
  splitTime = NULL,
  timeRates = NULL,
  branchLabels = NULL,
  rate.var = NULL,
  mode.order = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>An object of class <code>phylo</code> (see <span class="pkg">ape</span>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of simulations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Vector, matrix or data.frame (with taxon names as names or rownames) of categories for each species. Only applicable if model="mixedRate"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>The model of trait evolution (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnNodes</code></td>
<td>
<p>Logical. If TRUE, alongside the tip values all node values are returned corresponding to APE's edge.matrix for the tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kappa</code></td>
<td>
<p>Value of kappa transform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Value of lambda transform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>Value of delta transform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Value of alpha (OU) transform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi</code></td>
<td>
<p>Value of psi transform.  Note that 'original nodes' from the full phylogeny can be included as an element on the phylogeny (e.g., phy$orig.node) as well as estimates of 'hidden' speciation (e.g., phy$hidden.speciation) if estimates of extinction (mu) are &gt; 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acdcRate</code></td>
<td>
<p>Value of ACDC transform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.sp</code></td>
<td>
<p>Estimate of speciation (lambda) for the psi models</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trend</code></td>
<td>
<p>value of the expectation mean change through time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trend.anc.state</code></td>
<td>
<p>the expected ancestal state for the trend model (default is 0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nodeIDs</code></td>
<td>
<p>Integer - ancestral nodes of clades.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rateType</code></td>
<td>
<p>If model="clade", a vector specifying if rate shift occurs in a clade ("clade") or on the single branch leading to a clade ("branch").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cladeRates</code></td>
<td>
<p>Numeric vector specifying telative rates for clades or logical to indicate scalar is included in the 'modeslice' model (the scalar is included in the mode.param argument with the 'modeslice' model).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>branchRates</code></td>
<td>
<p>Numeric vector specifying relative rates for individual branches</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate</code></td>
<td>
<p>a vector of relative rate parameters. The length of the vector is equal to the number of rates being estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group.means</code></td>
<td>
<p>a vector of the relative difference in means between rate categories, expressed as a scalar applied to the expected standard deviation (see Ricklefs 2006)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>splitTime</code></td>
<td>
<p>A split time (measured from the present, or most recent species) at which a shift in the rate occurs for the "timeSlice" model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeRates</code></td>
<td>
<p>The rates (from ancient to recent) for the timeSlice model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>branchLabels</code></td>
<td>
<p>Branches on which different psi parameters are estimated in the "multipsi" model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate.var</code></td>
<td>
<p>Allows rate variation in BM modes in the 'modeslice' model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode.order</code></td>
<td>
<p>The order of modes for the 'modeslice' model. Any combination of 'BM', 'OU', 'acdc', and 'kappa'</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a matrix of simulated dated with taxon names as rownames (number of columns=n).
</p>


<h3>Author(s)</h3>

<p>Gavin Thomas, Mark Puttick
</p>


<h3>References</h3>

<p>Ricklefs RE. 2006. Time, species, and the generation of trait variation in clades. Systematic Biology 55, 151-159.
</p>
<p>Ricklefs RE. 2006. Thomas GH, Meiri S, &amp; Phillimore AB. 2009. Body size diversification in Anolis: novel environments and island effects. Evolution 63, 2017-2030
</p>


<h3>See Also</h3>

<p><code>transformPhylo.ML</code>, <code>transformPhylo.ll</code>, <code>transformPhylo</code>, <code>transformPhylo.MCMC</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(anolis.tree)
data(anolis.data)

# Simulate 10 sets of data with kappa=0.1 using the anolis tree
sim.dat1 &lt;- transformPhylo.sim(phy=anolis.tree, n=10, model="kappa", kappa=0.1)

# Simulate 10 sets of data where rates and means differ between to the categories defined by "x"
x &lt;- anolis.data$geo_ecomorph
names(x) &lt;-  rownames(anolis.data)
sim.dat2 &lt;- transformPhylo.sim(phy=anolis.tree, n=10, x=x, model="mixedRate", rate=c(1,1,2,4),
group.means=c(0,5,0,0))
</code></pre>


</div>