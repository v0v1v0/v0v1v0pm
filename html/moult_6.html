<div class="container">

<table style="width: 100%;"><tr>
<td>moult</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Models to analyse data of moult in birds</h2>

<h3>Description</h3>

<p>Estimate duration and mean start date of moult from 
moult score data by maximum likelihood.  Covariates 
to model duration and start of moult are possible. </p>


<h3>Usage</h3>

<pre><code class="language-R">moult(formula, data, start = NULL, type = 2, method = "BFGS", fixed = NULL, 
             fixed.val = NULL, prec = 0.02)
            
moult_alternative(formula, data, start = NULL, type = 2, method = "BFGS", 
                  fixed = NULL, fixed.val = NULL, prec = 0.02)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>symbolic description of the model, see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>starting values for parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame containing the variables in the model. 
If not found in data, the variables are taken from the environment
from which <code>moult</code> was called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>integer (one of 1,2,3,4,5) referring to type of moult data
and consequently model to be fitted (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>optimisation algorithm, passed to <code>optim</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>logical vector specifying which parameter values to fix during optimization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed.val</code></td>
<td>
<p>numeric vector with values for the fixed parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prec</code></td>
<td>
<p>numeric, measurement precision of moult index (proportion of feather mass grown), 
default = 0.02.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>formula</code> is specified in 5 parts: 
</p>
<p><code>moult.index ~ days | x1 + x2 | y1 + y2 | z1 + z2</code>
</p>
<p>where <code>moult.index</code> is a numerical vector with values between 0
and 1, <code>days</code> is a vector with corresponding day numbers on which
moult indeces were observed.  The next three parts contain explanatory
variables for modelling duration, mean start date and standard
deviation in start date, respectively.  If no explanatory variables are
wanted for duration, say, this can be specified by leaving a blank
between the first and second vertical lines, or equivalently,
inserting a 1 between the vertical lines (which means all durations
will be assumed equal).  Similarly for mean start date and standard
deviation. The minimum formula must contain <code>moult.index ~ days</code>,
which will assume the same duration, mean start date and standard
deviation for all individuals.   
</p>
<p><code>type</code> refers to the type of moult data available (see Underhill and
Zucchini (1998) and Underhill, Zucchini and Summers (1990)). 
</p>

<dl>
<dt>type = 1</dt>
<dd>
<p>sample is representative of entire population (not yet
moulting, in moult, and birds which have completed moult).  For type 1
data, any value between 0 and 1 (&gt; 0 and &lt; 1) can be used as the moult
index for birds in active moult.  The value used does not matter, only
the fact that they are in moult.</p>
</dd>
<dt>type = 2</dt>
<dd>
<p>(default) sample is representative of entire population
(not yet moulting, in moult, and birds which have completed
moult).  Moult scores are required.</p>
</dd>
<dt>type = 3</dt>
<dd>
<p>sample is representative only of birds in
moult. Individuals with moult scores 0 or 1 are ignored.</p>
</dd> 
<dt>type = 4</dt>
<dd>
<p>sample is representative only of birds in moult and those
that have completed moult.  Individuals with moult scores 0 are ignored.</p>
</dd> 
<dt>type = 5</dt>
<dd>
<p>sample is representative only of birds that have not
started moult or that are in moult.  Individuals with moult scores 1
are ignored.</p>
</dd>
</dl>
<p>To <em>fix parameters</em> <code>fixed</code> will be a logical vector, e.g. <code>fixed = c(F, F, T), 
fixed.val = 3.5</code> will fix the standard deviation in start date to exp(3.5) and only estimate 
the remaining two parameters. 
</p>
<p><code>moult</code> uses the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> function <code>optim</code> to minimise the negative log-likelihood. 
</p>
<p>Note: The standard deviation parameters are estimated on the log-scale. Thus
the corresponding elements in the covariance matrix are also on the
log-scale. Starting values for the standard deviation should also be supplied on 
the log-scale. Standard errors for the standard deviation parameters are on
the scale of the standard deviation (in days), estimated using the delta
method.
</p>
<p><code>moult_alternative</code> offers a different parameterization (still in testing!): 
the <em>duration of moult</em> parameter is as before, but instead of start of moult, 
the parameter estimated is the <em>halfway date</em>, i.e. the date at which 50% of 
individuals have completed 50% of moult. The standard deviation parameter now is 
for the standard deviation between indiviudals in reaching 50% of moult. Start and 
end of moult can be derived as halfway date - 0.5 x duration, + 0.5 x duration, 
respectively. This alternative parameterization attempts to reduce the problem of 
strong negative correlation between the previous parameters start of moult and 
duration, and gives a more robust estimate for timing of moult (Les Underhill, 
pers. comm., Jackson 2018).
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>parameter estimates split up into duration, mean
start date and standard deviation of start date.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>log-likelihood at parameter estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov</code></td>
<td>
<p>variance covariance matrix for paramter estimates (duration, mean start date, SD(start date)).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standard.errors</code></td>
<td>
<p>vector of standard errors for parameter
estimates, obtained from diagonal elements of vcov, see details (duration, mean start date, SD(start date)).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of data assumed, see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>vector of residuals: observed - fitted moult index.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>a vector of fitted values (moult scores).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df.residual</code></td>
<td>
<p>residual degrees of freedom for fitted model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms</code></td>
<td>
<p>duration formula, mean formula, full formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>model matrix with covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>observed response (moult index) values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Day</code></td>
<td>
<p>observed observation days.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.formula</code></td>
<td>
<p>model formula for mean start date.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>duration.formula</code></td>
<td>
<p>model formula for duration of moult.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>model formula for mean start and duration of moult.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd.formula</code></td>
<td>
<p>grouping variable used to estimate standard
deviations in mean start dates, different for each group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim</code></td>
<td>
<p>object returned by call to <code>optim</code>, which minimises
negative log-likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>converged</code></td>
<td>
<p>logical value indicating whether algorithm has
converged or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence.value</code></td>
<td>
<p>value for convergence returned by optim,
see <code>optim</code> for details.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Birgit Erni <a href="mailto:birgit.erni@uct.ac.za">birgit.erni@uct.ac.za</a></p>


<h3>References</h3>

<p>Erni, B., Bonnevie, B. T., Oschadleus, H.-D., Altwegg,
R. and Underhill, L. G. (2013) moult: An R package to analyze
moult in birds. <em>Journal of Statistical Software</em>, <b>52</b>(8), 1–23.
<a href="https://doi.org/10.18637/jss.v052.i08">doi:10.18637/jss.v052.i08</a>
</p>
<p>Jackson, C. 2018. <em>The moult and migration strategies of Lesser Sand Plover, 
Greater Sand Plover and Terek Sandpiper.</em> PhD Thesis, University of Cape Town, 
South Africa. 
</p>
<p>Underhill, L. G. and Zucchini, W. (1988) A model for avian
primary moult. <em>Ibis</em> <b>130</b>, 358–372.
</p>
<p>Underhill, L. G. and Zucchini, W. and Summers, R. W. (1990) A model
for avian primary moult-data types based on migration strategies and
an example using the Redshank <em>Tringa totanus</em>. <em>Ibis</em> <b>132</b>,
118–123. </p>


<h3>See Also</h3>

<p><code>predict.moult</code>, <code>ms2pfmg</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
data(sanderlings)

m2 &lt;- moult(MIndex ~ Day, data = sanderlings) 
summary(m2)
</code></pre>


</div>