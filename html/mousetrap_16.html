<div class="container">

<table style="width: 100%;"><tr>
<td>mt_animate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create gif trajectory animation.</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt="[Experimental]"></a>
</p>
<p><code>mt_animate</code> animates trajectories using the animation package. Note
that this function has beta status.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mt_animate(
  data,
  use = "trajectories",
  dimensions = c("xpos", "ypos"),
  timestamps = "timestamps",
  filename = "trajectory_animation.gif",
  xres = 1000,
  seconds = 3,
  framerate = 24,
  speed = 0.5,
  density = 3,
  jitter = TRUE,
  remove = FALSE,
  bg = "black",
  col = "white",
  lwd = 1,
  loop = FALSE,
  bounds = NULL,
  norm = FALSE,
  upscale = 1,
  decay = 10,
  max_intensity = 5,
  discard_images = TRUE,
  im_path = NULL,
  parallel = TRUE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a mousetrap data object created using one of the mt_import
functions (see mt_example for details). Alternatively, a trajectory
array can be provided directly (in this case <code>use</code> will be ignored).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use</code></td>
<td>
<p>a character string specifying which trajectory data should be
used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dimensions</code></td>
<td>
<p>a character vector specifying the two dimensions in the
trajectory array that contain the mouse positions. Usually (and by
default), the first value in the vector corresponds to the x-positions
(<code>xpos</code>) and the second to the y-positions (<code>ypos</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timestamps</code></td>
<td>
<p>a character string specifying the trajectory dimension
containing the timestamps. If <code>NULL</code> linearly increasing timestamps
are assumed, producing a perfectly constant timestamp interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filename</code></td>
<td>
<p>character string specifying the path and filename of the
resulting <em>.gif</em>. If the extension of <code>filename</code> is not
<em>.gif</em>, <em>.gif</em> is added at the end. Must not contain spaces.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xres</code></td>
<td>
<p>numeric specifying the resolution of the <em>.gif</em> file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seconds</code></td>
<td>
<p>numeric specifying the duration of the <em>.gif</em> file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>framerate</code></td>
<td>
<p>numeric specifying the framerate of the <em>.gif</em> file.
Defaults to 24 implying smooth non-discrete frame transitions for the human
eye.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>speed</code></td>
<td>
<p>numeric specifying the speed of the trajectories with regard to
their original velocity profile. I.e., a value of .5 shows trajectories in
half of the original velocities, whereas a value of 2 shows trajectories in
double of the original velocities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density</code></td>
<td>
<p>integer specifying the number of trajectories to be added
each frame. I.e., if <code>density = 10</code>, <code>seconds = 10</code>,
<code>framerate = 24</code> and <code>speed = .5</code> then the animation will show 10
x 10 x 24 x .5 = 1200 trajectories.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jitter</code></td>
<td>
<p>logical specifying whether the density should be jittered. If
<code>TRUE</code>, <code>density</code> varies according to
rgeom (<code>1/density</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove</code></td>
<td>
<p>logical specifying whether trajectories that reached their end
points should be removed from the rest of the animation. Defaults to
<code>FALSE</code> implying that all finished trajectories remain visible.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bg</code></td>
<td>
<p>character string specifying the background color.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>character string specifying the foreground color, i.e., the color
used to draw the trajectories.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>numeric specifying the line width of the trajectories.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loop</code></td>
<td>
<p>logical specifying whether gif should be looped. If <code>FALSE</code>
(the default), the last frame will remain visible after the animation is
finished. If <code>TRUE</code>, the gif will infinitely repeat itself.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bounds</code></td>
<td>
<p>numeric vector specifying the xleft, xright, ybottom, and ytop
limits of the animation canvas. Defaults to <code>NULL</code> in which case the
animation canvas is set to include all existing trajectory points,
irrespective of how extreme they may be.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norm</code></td>
<td>
<p>logical specifying whether the trajectories should be remapped to
the <em>mt-space</em>. See mt_align. Note that aligning often requires
that that all trajectories are flipped to one side first (see
mt_remap_symmetric).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upscale</code></td>
<td>
<p>numeric specifying a scaling factor for the animation
resolution. E.g, <code>upscale = 2</code> implies that the x-resolution in
<em>.gif</em> file is <code>2*xres</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>decay</code></td>
<td>
<p>numeric defining a within-trajectory gradient of color intensity.
Specifically, values larger than 1 will give more recent movements higher
color intensities than movements that lie longer in the past, and vice
versa.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_intensity</code></td>
<td>
<p>numeric specifying the maximum color intensity. A value
of, e.g., 5, implies that color intensity is limited to 5 overlapping
trajectories. I.e., a point at which 4 trajectories overlap will in that
case have a smaller color intensity than a point at which 5 trajectories
overlap, but there will be no difference between the latter and a point at
which 6 trajectories overlap. If <code>decay</code> is unequal 1, this metric
refers to the most intense color point within the trajectory.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>discard_images</code></td>
<td>
<p>logical specifying whether the temporary folder
containing the temporary <em>.png</em> images should be deleted. Defaults to
TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>im_path</code></td>
<td>
<p>character string specifying the location of ImageMagick's
<em>convert</em> function. If <code>NULL</code>, the <em>convert</em> function is
expected in <code>'/usr/local/bin/convert'</code>, the default location for Linux
and OSX operating systems. The location has to be specified explicitly for
Windows (see Details and Examples).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>logical specifying whether the temporary <em>.png</em> images
should be created using parallel processing (uses
clusterApplyLB). Process will be run on the maximum
number of available cores (as determined by detectCores).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical indicating whether function should report its
progress.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>mt_animate</code> produces a .gif file showing a continuous stream of
animated trajectories. The function first produces a series of <em>.png</em>
images, which then are combined into a <em>.gif</em> animation using
<em>ImageMagick</em> (see <a href="https://www.imagemagick.org/">https://www.imagemagick.org/</a>).
</p>
<p>In order to run this function, ImageMagick must be installed (download from
<a href="https://www.imagemagick.org/">https://www.imagemagick.org/</a>). Under Unix systems (Linux and Apple's
OSX) the function will look for ImageMagick using its default installation
path. Alternatively, the location of ImageMagick's <em>convert</em> function
can be provided using the <code>im_path</code> argument. Under Windows,
<code>im_path</code> must always be specified explicitly (e.g., it might look
something like this <code>im_path = "C:/Program
Files/ImageMagick-7.0.5-Q16/convert.exe"</code>).
</p>
<p>During the animation trajectories are sampled from the data without
replacement. The function stops when it reaches the last trajectory contained
in <code>data</code>.
</p>
<p>By default, <code>mt_animate</code> animates trajectories using the original
timestamps. Timestamps are expected to be expressed in milliseconds. By
setting <code>timestamps = NULL</code>, the function can also assume timestamps to
be regular, i.e., of constant interval, in this case the longest duration is
set to exactly one second.
</p>
<p>In order to create high-resolution (large) animations in a relatively short
time increase <code>upscale</code> in favor of <code>xres</code>. However, note that this
will decrease the sharpness of the image.
</p>
<p>In order to increase or decrease the overall color intensity decrease or
increase the <code>max_intensity</code>, respectively.
</p>


<h3>Author(s)</h3>

<p>Dirk U. Wulff
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Preprocess trajectory data
mt_example &lt;- mt_align_start(mt_example)
mt_example &lt;- mt_remap_symmetric(mt_example) 

# Create animated trajectory gif
# (under Linux / OSX)
mt_animate(mt_example,filename = "MyMovie.gif")

# Increase duration and density while decreasing speed
mt_animate(mt_example, filename = "MyMovie2.gif",
  seconds = 10, speed = .3, density = 10)

# Create animated trajectory gif
# (under Windows - ImageMagick version specific example)
mt_animate(mt_example,filename = "MyMovie.gif",
  im_path = "C:/Program Files/ImageMagick-7.0.5-Q16/convert.exe")


## End(Not run)

</code></pre>


</div>