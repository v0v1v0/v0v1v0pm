<div class="container">

<table style="width: 100%;"><tr>
<td>mt_cluster</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cluster trajectories.</h2>

<h3>Description</h3>

<p>Performs trajectory clustering. It first computes distances between each pair
of trajectories and then applies off-the-shelf clustering tools to explain
the resulting dissimilarity matrix using a predefined number of clusters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mt_cluster(
  data,
  use = "ln_trajectories",
  save_as = "clustering",
  dimensions = c("xpos", "ypos"),
  n_cluster = 5,
  method = "hclust",
  weights = rep(1, length(dimensions)),
  pointwise = TRUE,
  minkowski_p = 2,
  hclust_method = "ward.D",
  kmeans_nstart = 10,
  na_rm = FALSE,
  cluster_output = FALSE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a mousetrap data object created using one of the mt_import
functions (see mt_example for details). Alternatively, a trajectory
array can be provided directly (in this case <code>use</code> will be ignored).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use</code></td>
<td>
<p>a character string specifying which trajectory data should be
used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save_as</code></td>
<td>
<p>a character string specifying where the resulting data should
be stored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dimensions</code></td>
<td>
<p>a character vector specifying which trajectory variables
should be used. Can be of length 2 or 3, for two-dimensional or
three-dimensional trajectories respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_cluster</code></td>
<td>
<p>an integer specifying the number of clusters to estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>character string specifying the clustering procedure. Either
hclust (the default) or kmeans.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>numeric vector specifying the relative importance of the
variables specified in <code>dimensions</code>. Defaults to a vector of 1s
implying equal importance. Technically, each variable is rescaled so that
the standard deviation matches the corresponding value in <code>weights</code>.
To use the original variables, set <code>weights = NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pointwise</code></td>
<td>
<p>boolean specifying the way in which dissimilarity between
the trajectories is measured. If <code>TRUE</code> (the default),
<code>mt_distmat</code> measures the average dissimilarity and then sums the
results. If <code>FALSE</code>, <code>mt_distmat</code>  measures dissimilarity once
(by treating the various points as independent dimensions). This is only
relevant if <code>method</code> is "hclust". See mt_distmat for further
details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minkowski_p</code></td>
<td>
<p>an integer specifying the distance metric for the cluster
solution. <code>minkowski_p = 1</code> computes the city-block distance,
<code>minkowski_p = 2</code> (the default) computes the Euclidian distance,
<code>minkowski_p = 3</code> the cubic distance, etc. Only relevant if
<code>method</code> is "hclust". See mt_distmat for further details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hclust_method</code></td>
<td>
<p>character string specifying the linkage criterion used.
Passed on to the <code>method</code> argument of hclust. Default is
set to <code>ward.D</code>. Only relevant if <code>method</code> is "hclust".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kmeans_nstart</code></td>
<td>
<p>integer specifying the number of reruns of the kmeans
procedure. Larger numbers minimize the risk of finding local minima. Passed
on to the <code>nstart</code> argument of kmeans. Only relevant if
<code>method</code> is "kmeans".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na_rm</code></td>
<td>
<p>logical specifying whether trajectory points containing NAs
should be removed. Removal is done column-wise. That is, if any trajectory
has a missing value at, e.g., the 10th recorded position, the 10th position
is removed for all trajectories. This is necessary to compute distance
between trajectories.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster_output</code></td>
<td>
<p>logical. If <code>FALSE</code> (the default), the mousetrap
data object with the cluster assignments is returned (see Value). If
<code>TRUE</code>, the output of the cluster method (<code>kmeans</code> or
<code>hclust</code>) is returned directly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical indicating whether function should report its
progress.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>mt_cluster</code> uses off-the-shelf clustering tools, i.e.,
hclust and kmeans, for cluster estimation.
Cluster estimation using hclust relies on distances
computed by mt_distmat.
</p>
<p>Mouse trajectories often occur in distinct, qualitative types (see Wulff et
al., 2019; Wulff et al., 2022). Common trajectory types are linear
trajectories, mildly and strongly curved trajctories, and single and multiple
change-of-mind trials (see also mt_map). <code>mt_cluster</code> can tease
these types apart.
</p>
<p><code>mt_cluster</code> uses hclust or kmeans to
explain the distances between every pair of trajectories using a predefined
number of clusters. If method is "hclust", <code>mt_cluster</code> computes the
dissimiliarity matrix for all trajectory pairs using mt_distmat. If
method is "kmeans", this is done internally by kmeans.
</p>
<p>We recommend setting <code>method</code> to hclust using
<code>ward.D</code> as the linkage criterion (via <code>hclust_method</code>). Relative
to kmeans, the other implemented clustering method, and other
linkage criteria, this setup handles the skewed distribution cluster sizes
and trajectory outliers found in the majority of datasets best.
</p>
<p>For clustering trajectories, it is often useful that the endpoints of all
trajectories share the same direction, e.g., that all trajectories end in the
top-left corner of the coordinate system (mt_remap_symmetric or
mt_align can be used to achieve this). Furthermore, it is recommended
to use length normalized trajectories (see mt_length_normalize; Wulff
et al., 2019, Wulff et al., 2023).
</p>


<h3>Value</h3>

<p>A mousetrap data object (see mt_example) with an additional
data.frame added to it (by default called <code>clustering</code>) that
contains the cluster assignments. If a trajectory array was provided
directly as <code>data</code>, only the clustering <code>data.frame</code> will be
returned.
</p>


<h3>Author(s)</h3>

<p>Dirk U. Wulff
</p>
<p>Jonas M. B. Haslbeck
</p>


<h3>References</h3>

<p>Wulff, D. U., Haslbeck, J. M. B., Kieslich, P. J., Henninger, F.,
&amp; Schulte-Mecklenbeck, M. (2019). Mouse-tracking: Detecting types in
movement trajectories. In M. Schulte-Mecklenbeck, A. KÃ¼hberger, &amp; J. G.
Johnson (Eds.), <em>A Handbook of Process Tracing Methods</em> (pp. 131-145).
New York, NY: Routledge.
</p>
<p>Wulff, D. U., Kieslich, P. J., Henninger, F., Haslbeck, J. M. B., &amp;
Schulte-Mecklenbeck, M. (2023). <em>Movement tracking of psychological
processes: A tutorial using mousetrap.</em> PsyArXiv.
<a href="https://doi.org/10.31234/osf.io/v685r">doi:10.31234/osf.io/v685r</a>
</p>
<p>Wulff, D. U., Haslbeck, J. M. B., &amp; Schulte-Mecklenbeck, M. (2022).
<em>Measuring the (dis-)continuous mind: What movement trajectories
reveal about cognition</em>. Manuscript in preparation.
</p>


<h3>See Also</h3>

<p>mt_distmat for more information about how the distance matrix is
computed when the hclust method is used.
</p>
<p>mt_cluster_k for estimating the optimal number of clusters.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Length normalize trajectories
KH2017 &lt;- mt_length_normalize(KH2017)

# Cluster trajectories
KH2017 &lt;- mt_cluster(KH2017, use="ln_trajectories")

# Plot clustered trajectories
mt_plot(KH2017,use="ln_trajectories",
  use2="clustering",facet_col="cluster")

</code></pre>


</div>