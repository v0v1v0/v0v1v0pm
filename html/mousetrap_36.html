<div class="container">

<table style="width: 100%;"><tr>
<td>mt_heatmap_raw</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Creates high-resolution heatmap of trajectory data.</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt="[Experimental]"></a>
</p>
<p><code>mt_heatmap_raw</code> creates a high-resolution heatmap image of the
trajectory data using gaussian smoothing. Note that this function has beta
status.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mt_heatmap_raw(
  data,
  use = "trajectories",
  dimensions = c("xpos", "ypos"),
  variable = NULL,
  bounds = NULL,
  xres = 1000,
  upsample = 1,
  norm = FALSE,
  colors = c("black", "blue", "white"),
  n_shades = c(1000, 1000),
  smooth_radius = 1.5,
  low_pass = 200,
  auto_enhance = TRUE,
  mean_image = 0.15,
  mean_color = 0.25,
  aggregate_lwd = 0,
  aggregate_col = "black",
  n_trajectories = NULL,
  seed = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a mousetrap data object created using one of the mt_import
functions (see mt_example for details). Alternatively, a trajectory
array can be provided directly (in this case <code>use</code> will be ignored).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use</code></td>
<td>
<p>a character string specifying which trajectory data should be
used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dimensions</code></td>
<td>
<p>a character vector specifying the trajectory variables used
to create the heatmap. The first two entries are used as x and
y-coordinates, the third, if provided, will be added as color information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variable</code></td>
<td>
<p>boolean or numeric vector matching the number of trajectories
that if provided will be used as color information. <code>variable</code> is only
considered when <code>length(dimensions) &lt; 3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bounds</code></td>
<td>
<p>numeric vector specifying the corners (xmin, ymin, xmax, ymax)
of the plot region. By default (<code>bounds = NULL</code>), bounds are
determined based on the data input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xres</code></td>
<td>
<p>an integer specifying the number of pixels along the x-dimension.
An <code>xres</code> of 1000 implies an 1000*N px, where N is determined so that
the trajectories aspect ratio is preserved (provided the <code>bounds</code> are
unchanged).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upsample</code></td>
<td>
<p>a numeric value by which the number of points used to
represent individual trajectories are increased or decreased. Values of
smaller than one will improve speed but also introduce a certain level of
granularity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norm</code></td>
<td>
<p>a logical specifying whether the data should be warped into
standard space. If <code>norm = TRUE</code>, this overrules <code>bounds</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colors</code></td>
<td>
<p>a character vector specifying two or three colors used to color
the background, the foreground (trajectories), and the values of a third
dimension (if specified).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_shades</code></td>
<td>
<p>an integer specifying the number of shades for the color
gradient between the first and second, and the second and third color in
<code>colors</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth_radius</code></td>
<td>
<p>a numeric value specifying the standard deviation of the
gaussian smoothing. If zero, smoothing is omitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>low_pass</code></td>
<td>
<p>an integer specifying the allowed number of counts per pixel.
This arguments limits the maximum pixel color intensity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>auto_enhance</code></td>
<td>
<p>boolean. If <code>TRUE</code> (the default), the image is
adjusted so that the mean color intensity matches <code>mean_image</code> and
<code>mean_color</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean_image</code></td>
<td>
<p>a numeric value between 0 and 1 specifying the average
foreground color intensity across the entire image. Defaults to 0.1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean_color</code></td>
<td>
<p>a numeric value between 0 and 1 specifying the average
third dimension's color intensity across the entire image. Defaults to 0.1.
Only relevant if a third dimension is specified in <code>colors</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aggregate_lwd</code></td>
<td>
<p>an integer specifying the width of the aggregate
trajectory. If <code>aggregate_lwd</code> is 0 (the default), the aggregate
trajectory is omitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aggregate_col</code></td>
<td>
<p>a character value specifying the color of the aggregate
trajectory.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_trajectories</code></td>
<td>
<p>an optional integer specifying the number of
trajectories used to create the image. By default, all trajectories are
used. If <code>n_trajectories</code> is specified and smaller than the number of
trajectories in the trajectory array, then <code>n_trajectories</code> are
randomly sampled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>an optional integer specifying the seed used for the trajectory
sampling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical indicating whether function should report its
progress.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>To create the image, <code>mt_heatmap_raw</code> takes the following steps. First,
the function maps the trajectory points to a pixel space with x ranging from
1 to xres and y ranging from 1 to xres divided by the ratio of x and y's
value range. Second, the function counts and normalizes the number of
trajectory points occupying each of the x,y-pixels to yield image intensities
between 0 and 1. Third, the function smooths the image using an approximative
guassian approach governed by <code>smooth_radius</code>, which controls the
dispersion of the gaussian smoothing. Fourth, the function automatically
enhances the image (unless <code>auto_enhance = FALSE</code>) using a non-linear
transformation in order to yield a desired <code>mean_image</code> intensity.
Fifth, the function translates the image intensity into color using the
colors specified in <code>colors</code>. Finally, the function returns the image
data in a long format containing the x, y, and color information.
</p>
<p><code>mt_heatmap_raw</code> also offers the possibility to overlay the heatmap with
an additional variable, such as for instance velocity, so that both the
density of mouse trajectories and the information of the additional variable
are visible. In order to do this, specify a third variable label in
<code>dimensions</code> and control its appearance using the <code>color</code> and
<code>mean_color</code> arguments.
</p>


<h3>Value</h3>

<p>An object of class <code>mt_object_raw</code> containing in a matrix format
the image's pixel information, the aggregate trajectory, and the colors.
</p>


<h3>Author(s)</h3>

<p>Dirk U. Wulff
</p>


<h3>References</h3>

<p>Wulff, D. U., Haslbeck, J. M. B., Kieslich, P. J., Henninger, F.,
&amp; Schulte-Mecklenbeck, M. (2019). Mouse-tracking: Detecting types in
movement trajectories. In M. Schulte-Mecklenbeck, A. Kühberger, &amp; J. G.
Johnson (Eds.), <em>A Handbook of Process Tracing Methods</em> (pp. 131-145). New York, NY:
Routledge.
</p>
<p>Kieslich, P. J., Henninger, F., Wulff, D. U., Haslbeck, J. M. B., &amp;
Schulte-Mecklenbeck, M. (2019). Mouse-tracking: A practical guide to
implementation and analysis. In M. Schulte-Mecklenbeck, A. Kühberger, &amp; J.
G. Johnson (Eds.), <em>A Handbook of Process Tracing Methods</em> (pp.
111-130). New York, NY: Routledge.
</p>


<h3>See Also</h3>

<p>mt_heatmap and  mt_heatmap_ggplot for plotting
trajectory heatmaps.
</p>
<p>mt_diffmap for plotting trajectory difference-heatmaps.
</p>


</div>