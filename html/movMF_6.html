<div class="container">

<table style="width: 100%;"><tr>
<td>movMF_distribution</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mixtures of von Mises-Fisher Distributions</h2>

<h3>Description</h3>

<p>Density and random number generation for finite mixtures of von
Mises-Fisher distributions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dmovMF(x, theta, alpha = 1, log = FALSE)
rmovMF(n, theta, alpha = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a matrix of rows of points on the unit hypersphere.
Standardized to unit row length if necessary.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>a matrix with rows giving the parameters of the mixture
components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>a numeric vector with non-negative elements giving the
mixture probabilities.
Standardized to sum to one if necessary.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>a logical; if <code>TRUE</code> log-densities are computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>an integer giving the number of samples to draw.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A random <code class="reqn">d</code>-dimensional unit length vector <code class="reqn">x</code> has a von
Mises-Fisher (or Langevin, short: vMF) distribution with parameter
<code class="reqn">\theta</code> if its density with respect to the uniform distribution
on the unit hypersphere is given by
</p>
<p style="text-align: center;"><code class="reqn">f(x|\theta) = \exp(\theta'x) / {}_0F_1(; d/2; \|\theta\|^2/4),</code>
</p>

<p>where <code class="reqn">{}_0F_1</code> is a generalized hypergeometric function
(e.g.,
<a href="https://en.wikipedia.org/wiki/Generalized_hypergeometric_function">https://en.wikipedia.org/wiki/Generalized_hypergeometric_function</a>)
and related to the modified Bessel function <code class="reqn">I_\nu</code> of the first
kind via
</p>
<p style="text-align: center;"><code class="reqn">{}_0F_1(; \nu+1; z^2/4) =
    I_\nu(z)\Gamma(\nu+1) / (z/2)^\nu.</code>
</p>

<p>With this parametrization, the von Mises-Fisher family is the natural
exponential family through the uniform distribution on the unit
sphere, with cumulant transform
</p>
<p style="text-align: center;"><code class="reqn">M(\theta) = \log({}_0F_1(; d/2; \|\theta\|^2/4)).</code>
</p>

<p>We note that the vMF distribution is commonly parametrized by the
<em>mean direction parameter</em> <code class="reqn">\mu = \theta / \|\theta\|</code> (which however is not well-defined if <code class="reqn">\theta =
  0</code>) and the <em>concentration parameter</em> <code class="reqn">\kappa = \|\theta\|</code>, e.g., 
<a href="https://en.wikipedia.org/wiki/Von_Mises%E2%80%93Fisher_distribution">https://en.wikipedia.org/wiki/Von_Mises%E2%80%93Fisher_distribution</a>
(which also uses the un-normalized Haar measure on the unit sphere as
the reference distribution, and hence includes the “area” of
the unit sphere as an additional normalizing constant).
</p>
<p><code>dmovMF</code> computes the (log) density of mixtures of vMF
distributions.
</p>
<p><code>rmovMF</code> generates samples from finite mixtures of vMF
distributions, using Algorithm VM* in Wood (1994) for sampling from
the vMF distribution.
</p>
<p>Arguments <code>theta</code> and <code>alpha</code> are recycled to a common
number of mixture components.
</p>


<h3>Value</h3>

<p>For <code>dmovMF</code>, a numeric vector of (log) density values.
</p>
<p>For <code>rmovMF</code>, a matrix with <code>n</code> unit length rows
representing the samples from the vMF mixture distribution.
</p>


<h3>References</h3>

<p>A. T. A. Wood (1994).
Simulation of the von Mises Fisher distribution.
<em>Communications in Statistics – Simulation and Computation</em>,
<b>23</b>(1), 157–164.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## To simulate from the vMF distribution with mean direction
## proportional to c(1, -1) and concentration parameter 3:
rmovMF(10, 3 * c(1, -1) / sqrt(2))
## To simulate from a mixture of vMF distributions with mean direction
## parameters c(1, 0) and c(0, 1), concentration parameters 3 and 4, and
## mixture probabilities 1/3 and 2/3, respectively:
rmovMF(10, c(3, 4) * rbind(c(1, 0), c(0, 1)), c(1, 2))
</code></pre>


</div>