<div class="container">

<table style="width: 100%;"><tr>
<td>gROC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Build a ROC curve for a univariate marker
</h2>

<h3>Description</h3>

<p>This is one of the main functions of the movieROC package.
It builds a univariate ROC curve (standard or general) and returns a
‘groc’ object, a list of class ‘groc’.
This object can be <code>print</code>ed, <code>plot</code>ted, or <code>predict</code>ed
for a particular point. It may be also passed to other functions:
<code>plot_regions()</code>, <code>plot_buildROC()</code>, <code>movieROC()</code>,
<code>plot_densities()</code>, and <code>plot_densityROC()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gROC(X, D, ...)
## Default S3 method:
gROC(X, D, side = c("right", "left", "both", "both2"),
    restric = FALSE, optim = TRUE, t0 = NULL, t0max = FALSE, verbose = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>Vector of marker values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>

<p>Vector of response values. Two levels; if more, the two first ones are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>side</code></td>
<td>

<p>Type of ROC curve. One of <code>"right"</code> (<code class="reqn">\mathcal{R}_r(\cdot)</code>),
<code>"left"</code> (<code class="reqn">\mathcal{R}_l(\cdot)</code>), <code>"both"</code> (<code class="reqn">\mathcal{R}_g(\cdot)</code>)
or <code>"both2"</code> (<code class="reqn">\mathcal{R}_{g'}(\cdot)</code>). Default: <code>"right"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>restric</code></td>
<td>

<p>If TRUE, the gROC curve with restriction <em>(C)</em> is computed. Default: FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim</code></td>
<td>

<p>If TRUE (and <code>restric = TRUE</code>), the computation of the optimal gROC curve
under restriction <em>(C)</em> is performed by using Floyd's algorithm (Floyd, 1962), implemented in the <code>allShortestPaths()</code> function in the <a href="https://CRAN.R-project.org/package=e1071"><span class="pkg">e1071</span></a> package. Default: TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t0</code></td>
<td>

<p>An integer number between 1 and <code class="reqn">m+1</code> (where <code class="reqn">m</code> is the negative sample size).
If <code>restric = TRUE</code>, the restricted gROC curve is computed departing
from (<code>t0</code><code class="reqn">-1</code>)/<code class="reqn">m</code>. Default: the one reporting the Youden index.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t0max</code></td>
<td>

<p>If TRUE, the computation of the gROC curve under restriction <em>(C)</em> is performed
departing from every possible <code>t0</code> and the one reporting the maximum AUC is selected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>If TRUE, a progress bar is displayed for computationally intensive methods. Default: FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Other parameters to be passed. Not used.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function's main job is to estimate an ROC curve for a univariate marker
under one of these considerations: larger values of the marker are associated
with a higher probability of being positive (resulting in the <em>right-sided</em>
ROC curve, <code class="reqn">\mathcal{R}_r (\cdot)</code>), the opposite (<em>left-sided</em> ROC curve,
<code class="reqn">\mathcal{R}_l (\cdot)</code>), when both smaller and larger values of the marker are
associated with having more probability of being positive (<em>gROC curve</em>,
<code class="reqn">\mathcal{R}_g(\cdot)</code>), the opposite (<em>opposite gROC curve</em>, <code class="reqn">\mathcal{R}_{g'}(\cdot)</code>).
</p>


<h3>Value</h3>

<p>A list of class ‘groc’ with the following fields:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>controls, cases</code></td>
<td>
<p>Marker values of negative and positive subjects, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels</code></td>
<td>
<p>Levels of response values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>side</code></td>
<td>
<p>Type of ROC curve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>Vector of false-positive rates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>roc</code></td>
<td>
<p>Vector of values of the ROC curve for <code>t</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p>Vector of marker thresholds resulting in (<code>t</code>, <code>roc</code>)
if <code>side = "right" | "left"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xl, xu</code></td>
<td>
<p>Vectors of marker thresholds resulting in (<code>t</code>, <code>roc</code>)
if <code>side = "both" | "both2"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>auc</code></td>
<td>
<p>Area under the curve estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aucfree</code></td>
<td>
<p>Area under the curve estimate without restrictions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aucs</code></td>
<td>
<p>Area under the curve with restriction <em>(C)</em> departing from every
false-positive rate, <code class="reqn">FPR \in \{ 0, 1/m, \dots, 1 \}</code>.</p>
</td>
</tr>
</table>
<h3>Dependencies</h3>

<p>If <code>side = "both"</code> and <code>optim = TRUE</code>, the <code>allShortesPaths()</code> function in the <a href="https://CRAN.R-project.org/package=e1071"><span class="pkg">e1071</span></a> package is used. Also the <code>combinations()</code> function in <a href="https://CRAN.R-project.org/package=gtools"><span class="pkg">gtools</span></a> and <code>%[]%</code> in <span class="pkg">intrval</span>.
</p>


<h3>References</h3>

<p>P. Martínez-Camblor, N. Corral, C. Rey, J. Pascual, and E. Cernuda-Morollón (2017) “Receiver operating characteristic curve generalization for non-monotone relationships”. <em>Statistical Methods in Medical Research</em>, <b>26</b>(1):113–123. DOI: <a href="https://doi.org/10.1177/0962280214541095">doi:10.1177/0962280214541095</a>.
</p>
<p>S. Pérez-Fernández, P. Martínez-Camblor, P. Filzmoser, and N. Corral (2021). “Visualizing the decision rules behind the ROC curves: understanding the classification process”. <em>AStA Advances in Statistical Analysis</em>, <b>105</b>(1):135-161. DOI: <a href="https://doi.org/10.1007/s10182-020-00385-2">doi:10.1007/s10182-020-00385-2</a>.
</p>
<p>R. W. Floyd (1962) “Algorithm 97: Shortest path”. <em>Communications of the ACM</em>, <b>5</b>: 345–345. DOI: <a href="https://doi.org/10.1145/367766.368168">doi:10.1145/367766.368168</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(HCC)

# ROC curve estimates for gene 03515901 and response tumor
gROC(X = HCC[,"cg03515901"], D = HCC$tumor) # Standard right-sided ROC curve
gROC(X = HCC[,"cg03515901"], D = HCC$tumor, side = "left") # Left-sided ROC curve
gROC(X = HCC[,"cg03515901"], D = HCC$tumor, side = "both") # gROC curve without restrictions


### Warning: Next line of code is time consuming. gROC curve with restriction (C)
gROC(X = HCC[,"cg03515901"], D = HCC$tumor, side = "both", restric = TRUE)

</code></pre>


</div>