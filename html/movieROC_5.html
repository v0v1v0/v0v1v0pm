<div class="container">

<table style="width: 100%;"><tr>
<td>hROC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Build a ROC curve for a transformation of a univariate marker
</h2>

<h3>Description</h3>

<p>This is one of the main functions of the movieROC package. 
It builds a univariate ROC curve for a transformed marker <code class="reqn">h(X)</code> 
and returns a ‘hroc’ object, a list of class ‘hroc’. 
This object can be <code>print</code>ed, <code>plot</code>ted, or <code>predict</code>ed
for a particular point. It may be also passed to  
<code>plot_funregions()</code> and <code>plot_regions()</code> functions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hROC(X, D, ...)
## Default S3 method:
hROC(X, D, type = c("lrm", "overfitting", "kernel", "h.fun"), 
    formula.lrm = "D ~ pol(X,3)", h.fun = function(x) {x},  kernel.h = 1,
    plot.h = FALSE, plot.roc = FALSE, new.window = FALSE, 
    main = NULL, xlab = "x", ylab = "h(x)", xaxis = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>Vector of marker values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>

<p>Vector of response values. Two levels; if more, the two first ones are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>Type of transformation considered. One of 
<code>"lrm"</code> (a binary logistic regression is computed by using <code>lrm()</code> function in <a href="https://CRAN.R-project.org/package=rms"><span class="pkg">rms</span></a> package), 
<code>"kernel"</code> (the transformation included in Martínez-Camblor et al. (2021) estimated by the kernel density approach),
<code>"overfitting"</code> (the overfitting transformation, <code class="reqn">\hat{h}_{of}(\cdot)</code> is taken), or
<code>"h.fun"</code> (the transformation indicated in the input parameter <code>h.fun</code> 
is considered). Default: <code>"lrm"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula.lrm</code></td>
<td>

<p>If <code>type = "lrm"</code>, the transformation employed in the right-hand side 
of the logistic regression model (in terms of <code>X</code> and <code>D</code>). 
Default: <code>'D ~ pol(X, 3)'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel.h</code></td>
<td>

<p>If <code>type = "kernel"</code>, the bandwidth used for the kernel density estimation by using the <code>density()</code> function in <span class="pkg">stats</span> package. Default: 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h.fun</code></td>
<td>

<p>If <code>type = "h.fun"</code>, the transformation employed (as a function in R). 
Default: <code>function(x){x}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.h</code></td>
<td>

<p>If TRUE, the transformation employed is illustrated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.roc</code></td>
<td>

<p>If TRUE, the resulting ROC curve is illustrated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>new.window</code></td>
<td>

<p>If TRUE, two previous graphics are plotted separately in different windows.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>

<p>A main title for the plot used if <code>plot.h = TRUE</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab</code></td>
<td>

<p>A label for the x and y axis of the plot used if <code>plot.h = TRUE</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xaxis</code></td>
<td>

<p>Graphical parameter used if <code>plot.h = TRUE</code>. If FALSE, plotting of the axis is supressed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Other parameters to be passed. Not used.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A theoretical and practical discussion about the <code>type</code> of transformation considered and its basis may be found in Martínez-Camblor et al. (2019) and Martínez-Camblor et al. (2021).
</p>
<p>The overfitting function estimate is defined as follows:
</p>
<p style="text-align: center;"><code class="reqn">\hat{h}_{of}(x) = \sum_{i=1}^{n_1} I(x = y_i) + \sum_{i=1}^{n_2} \dfrac{\#(\xi = z_i)}{\#(\xi = z_i) + \#(\chi = z_i)} I(x = z_i)</code>
</p>

<p>where <code class="reqn">I(A)</code> denotes the indicator function (which takes the value 1 if <code class="reqn">A</code> is true and 0 otherwise), <code class="reqn">\#(B)</code> is the cardinal of the subset <code class="reqn">B</code>, <code class="reqn">\{y_1, \dots, y_{n_1}\} \subseteq \left\{ \xi_1, \dots, \xi_n \right\}</code> are the positive sample values without ties and <code class="reqn">\{z_1, \dots, z_{n_2}\} \subseteq \left\{ \xi_1, \dots, \xi_n \right\}</code> are the positive sample values with ties with any negative sample value. Classification based on this transformation is the optimal one in the AUC sense, but the resulting decision rules cannot be extended to any other sample.
</p>


<h3>Value</h3>

<p>A list of class ‘hroc’ with the following fields: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>levels</code></td>
<td>
<p>Levels of response values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X, Y</code></td>
<td>
<p>Original and transformed marker values, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sp, Se</code></td>
<td>
<p>Vector of true-negtive and true-positive rates, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>auc</code></td>
<td>
<p>Area under the curve estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>If <code>type = "lrm"</code>, the coefficients of the logistic regression model fitted by <code>formula</code>.</p>
</td>
</tr>
</table>
<h3>Dependencies</h3>

<p>If <code>type = "lrm"</code>, the <code>lrm()</code> function in the <a href="https://CRAN.R-project.org/package=rms"><span class="pkg">rms</span></a> package is used. This library is also loaded to consider special transformation functions such as <code>pol()</code> and <code>rcs()</code>.
</p>


<h3>References</h3>

<p>P. Martínez-Camblor, S. Pérez-Fernández, and S. Díaz-Coto (2019) “Improving the biomarker diagnostic capacity via functional transformations”. <em>Journal of Applied Statistics</em>, <b>46</b>(9): 1550–1566. DOI: <a href="https://doi.org/10.1080/02664763.2018.1554628">doi:10.1080/02664763.2018.1554628</a>.
</p>
<p>P. Martínez-Camblor, S. Pérez-Fernández, and S. Díaz-Coto (2021) “Optimal classification scores based on multivariate marker transformations”. <em>AStA Advances in Statistical Analysis</em>, <b>105</b>(4): 581–599. DOI: <a href="https://doi.org/10.1007/s10182-020-00388-z">doi:10.1007/s10182-020-00388-z</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(HCC)

# ROC curve for gene 18384097 to identify tumor by considering 4  different transformations:
X &lt;- HCC$cg18384097; D &lt;- HCC$tumor
## 1. Ordinary cubic polynomial formula for binary logistic regression
hROC(X, D)
## 2. Linear tail-restricted cubic splines for binary logistic regression
hROC(X, D, formula.lrm = "D ~ rcs(X,8)")
## 3. Overfitting transformation for this particular sample
hROC(X, D, type = "overfitting")
## 4. Optimal transformation in terms of likelihood ratio 
##    by kernel density estimation with bandwidth 3
hROC(X, D, type = "kernel", kernel.h = 3)
</code></pre>


</div>