<div class="container">

<table style="width: 100%;"><tr>
<td>filter_mispicked_ions</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mispicked ions filter</h2>

<h3>Description</h3>

<p><code>filter_mispicked_ions()</code> identifies ions that were incorrectly split into
separate features during preprocessing. This filter checks the feature table
for similar ions in terms of mass and retention time. Peaks found to be
similar are merged into a single feature given <code>merge_peaks</code> is <code>TRUE</code>.
</p>
<p>The parameter <code>ringwin</code> is the detector saturation mass window, specific for
some instruments, such as Waters Synapse G2-Si-Q-ToF, to account for high
concentration samples.
</p>
<p>Parameter <code>isowin</code> is the isotopic mass window, which accounts for isotopic
peaks of the same precussor mass that were incorrectly assigned during
preprocessing.
</p>
<p><code>copy_object</code>: mpactr is built on an R6 class-system, meaning it operates on
reference semantics in which data is updated <em>in-place</em>. Compared to a
shallow copy, where only data pointers are copied, or a deep copy, where
the entire data object is copied in memory, any changes to the original
data object, regardless if they are assigned to a new object, result in
changes to the original data object. We recommend using the default
<code>copy_object = FALSE</code> as this makes for an extremely fast and
memory-efficient way to chain mpactr filters together; however, if you
would like to run the filters individually with traditional R style objects,
you can set <code>copy_object</code> to <code>TRUE</code> as shown in the filter examples.
</p>


<h3>Usage</h3>

<pre><code class="language-R">filter_mispicked_ions(
  mpactr_object,
  ringwin = 0.5,
  isowin = 0.01,
  trwin = 0.005,
  max_iso_shift = 3,
  merge_peaks = TRUE,
  merge_method = "sum",
  copy_object = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mpactr_object</code></td>
<td>
<p>An <code>mpactr_object</code>. See <code>import_data()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ringwin</code></td>
<td>
<p>Ringing mass window or detector saturation mass window.
Default = 0.5 atomic mass units (AMU).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>isowin</code></td>
<td>
<p>Isotopic mass window. Default = 0.01 AMU.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trwin</code></td>
<td>
<p>A <code>numeric</code> denoting the retention time threshold for assessing
if ions should be merged. Default = 0.005.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_iso_shift</code></td>
<td>
<p>A <code>numeric</code>. Default = 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>merge_peaks</code></td>
<td>
<p>A <code>boolean</code> parameter to determine if peaks found to
belong to the same ion should be merged in the feature table.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>merge_method</code></td>
<td>
<p>If merge_peaks is TRUE, a method for how similar peaks
should be merged. Can be one of "sum".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copy_object</code></td>
<td>
<p>A <code>boolean</code> parameter that allows users to return a copied
object instead of modifying the object.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an <code>mpactr_object</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data &lt;- import_data(example("coculture_peak_table.csv"),
  example("metadata.csv"),
  format = "Progenesis"
)

data_filter &lt;- filter_mispicked_ions(data,
  ringwin = 0.5,
  isowin = 0.01,
  trwin = 0.005,
  max_iso_shift = 3,
  merge_peaks = TRUE,
  merge_method = "sum"
)

</code></pre>


</div>