<div class="container">

<table style="width: 100%;"><tr>
<td>cv.glmreg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cross-validation for glmreg</h2>

<h3>Description</h3>

<p>Does k-fold cross-validation for glmreg, produces a plot,
and returns cross-validated log-likelihood values for <code>lambda</code></p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'formula'
cv.glmreg(formula, data, weights, offset=NULL, contrasts=NULL, ...)
## S3 method for class 'matrix'
cv.glmreg(x, y, weights, offset=NULL, ...)
## Default S3 method:
cv.glmreg(x,  ...)
## S3 method for class 'cv.glmreg'
plot(x,se=TRUE,ylab=NULL, main=NULL, width=0.02, col="darkgrey", ...)
## S3 method for class 'cv.glmreg'
predict(object, newx, ...)
## S3 method for class 'cv.glmreg'
coef(object,which=object$lambda.which, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>symbolic description of the model, see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>argument controlling formula processing
via <code>model.frame</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p><code>x</code> matrix as in <code>glmreg</code>. It could be object of <code>cv.glmreg</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>response <code>y</code> as in <code>glmreg</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Observation weights; defaults to 1 per observation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>this can be used to specify an a priori known component to be included in the linear predictor during fitting. This should be NULL or a numeric vector of length equal to the number of cases. Currently only one offset term can be included in the formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>the contrasts corresponding to <code>levels</code> from the
respective models</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>object of <code>cv.glmreg</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newx</code></td>
<td>
<p>Matrix of values at which predictions are to be made.  Not
used for <code>type="coefficients"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>Indices of the penalty parameter <code>lambda</code> at which
estimates are extracted. By default, the one which generates the optimal cross-validation value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>logical value, if <code>TRUE</code>, standard error curve is also plotted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>ylab on y-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>title of plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>width of lines</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>color of standard error curve</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments that can be passed to <code>glmreg</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function runs <code>glmreg</code> <code>nfolds</code>+1 times; the
first to compute the <code>lambda</code> sequence, and then to
compute the fit with each of the folds omitted. The error or the log-likelihood value is
accumulated, and the average value and standard deviation over the
folds is computed. Note that <code>cv.glmreg</code> can be used to search for
values for <code>alpha</code>: it is required to call <code>cv.glmreg</code> with a fixed vector <code>foldid</code> for different values of <code>alpha</code>. 
</p>


<h3>Value</h3>

<p>an object of class <code>"cv.glmreg"</code> is returned, which is a
list with the ingredients of the cross-validation fit.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>a fitted glmreg object for the full data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residmat</code></td>
<td>
<p>matrix of log-likelihood values with row values for <code>lambda</code> and column values for <code>k</code>th cross-validation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bic</code></td>
<td>
<p>matrix of BIC values with row values for <code>lambda</code> and column values for <code>k</code>th cross-validation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv</code></td>
<td>
<p>The mean cross-validated log-likelihood values - a vector of length
<code>length(lambda)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.error</code></td>
<td>
<p>estimate of standard error of <code>cv</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>foldid</code></td>
<td>
<p>an optional vector of values between 1 and <code>nfold</code>
identifying what fold each observation is in.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>a vector of <code>lambda</code> values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.which</code></td>
<td>
<p>index of <code>lambda</code> that gives maximum <code>cv</code> value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.optim</code></td>
<td>
<p>value of <code>lambda</code> that gives maximum <code>cv</code> value.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Zhu Wang &lt;zwang145@uthsc.edu&gt;</p>


<h3>References</h3>

<p>Zhu Wang, Shuangge Ma, Michael Zappitelli, Chirag Parikh, Ching-Yun Wang and Prasad Devarajan (2014)      <em>Penalized Count Data Regression with Application to Hospital Stay after Pediatric Cardiac Surgery</em>, <em>Statistical Methods in Medical Research</em>. 2014 Apr 17. [Epub ahead of print]
</p>


<h3>See Also</h3>

<p><code>glmreg</code> and <code>plot</code>, <code>predict</code>, and <code>coef</code> methods for <code>"cv.glmreg"</code> object.</p>


<h3>Examples</h3>

<pre><code class="language-R">data("bioChemists", package = "pscl")
fm_pois &lt;- cv.glmreg(art ~ ., data = bioChemists, family = "poisson")
title("Poisson Family",line=2.5)
predict(fm_pois, newx=bioChemists[,-1])[1:4]
coef(fm_pois)
</code></pre>


</div>