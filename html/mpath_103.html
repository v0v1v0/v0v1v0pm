<div class="container">

<table style="width: 100%;"><tr>
<td>cv.zipath</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cross-validation for zipath</h2>

<h3>Description</h3>

<p>Does k-fold cross-validation for zipath, produces a plot,
and returns cross-validated log-likelihood values for <code>lambda</code></p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'formula'
cv.zipath(formula, data, weights, offset=NULL, contrasts=NULL, ...)
## S3 method for class 'matrix'
cv.zipath(X, Z, Y, weights, offsetx=NULL, offsetz=NULL, ...)
## Default S3 method:
cv.zipath(X, ...)
## S3 method for class 'cv.zipath'
predict(object, newdata, ...)
## S3 method for class 'cv.zipath'
coef(object, which=object$lambda.which, model = c("full", "count", "zero"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>symbolic description of the model with an optional numeric vector <code>offset</code> with an a priori known component to be included in the linear predictor of the count model or zero model. Offset must be a variable in <code>data</code> if used, while this is optional in <code>zipath</code>. See an example below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>arguments controlling formula processing
via <code>model.frame</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Observation weights; defaults to 1 per observation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>optional numeric vector with an a priori known component to be
included in the linear predictor of the count model or zero model. See below   for an example.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>predictor matrix of the count model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>predictor matrix of the zero model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>response variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offsetx, offsetz</code></td>
<td>
<p>optional numeric vector with an a priori known component to be
included in the linear predictor of the count model (offsetx)or zero model (offsetz).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>a list with elements <code>"count"</code> and <code>"zero"</code>
containing the contrasts corresponding to <code>levels</code> from the
respective models</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>object of class <code>cv.zipath</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>optionally, a data frame in which to look for variables with
which to predict. If omitted, the original observations are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>Indices of the pair of penalty parameters <code>lambda.count</code> and <code>lambda.zero</code> at which
estimates are extracted.  By default, the one which generates the optimal cross-validation value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>character specifying for which component of the model the
estimated coefficients should be extracted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments that can be passed to <code>zipath</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function runs <code>zipath</code> <code>nfolds</code>+1 times; the
first to compute the <code>(lambda.count, lambda.zero)</code> sequence, and then to
compute the fit with each of the folds omitted. 
The model is fitted to the training data and then given the fitted model the log-likelihood is evaluated at the observations left out, i.e., the test data.
The average value of log-likelihood and standard deviation over the
folds is computed. Note that <code>cv.zipath</code> can be used to search for
values for <code>count.alpha</code> or <code>zero.alpha</code>: it is required to call <code>cv.zipath</code> with a fixed vector <code>foldid</code> for different values of <code>count.alpha</code> or <code>zero.alpha</code>.
</p>
<p>The methods for <code>coef</code> and <code>predict</code> were deprecated since version 0.3-25. In fact, the <code>fit</code> object was removed in the output of cv.zipath so that predict an object of cv.zipath is not feasible, and should be via zipath. See examples below. The reason for such a change is that cv.zipath can take both formula and matrix, hence <code>predict</code> on cv. zipath object can easily lead to problems in codes.
</p>
<p>When <code>family="negbin"</code>, it can be slow because there is a repeated search for the <code>theta</code> values by default. One may change the default values from <code>init.theta=NULL, theta.fixed=FALSE</code> to <code>init.theta=MLE, theta.fixed=TRUE</code>, where MLE is a number from glm.nb in the R package MASS or something desired. 
</p>


<h3>Value</h3>

<p>an object of class <code>"cv.zipath"</code> is returned, which is a
list with the components of the cross-validation fit.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>a fitted zipath object for the full data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residmat</code></td>
<td>
<p>matrix for cross-validated log-likelihood at each <code>(count.lambda, zero.lambda)</code> sequence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bic</code></td>
<td>
<p>matrix of BIC values with row values for <code>lambda</code> and column values for <code>k</code>th cross-validation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv</code></td>
<td>
<p>The mean cross-validated log-likelihood - a vector of length
<code>length(count.lambda)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.error</code></td>
<td>
<p>estimate of standard error of <code>cv</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>foldid</code></td>
<td>
<p>an optional vector of values between 1 and <code>nfold</code>
identifying what fold each observation is in.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.which</code></td>
<td>
<p>index of <code>(count.lambda, zero.lambda)</code> that gives maximum <code>cv</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.optim</code></td>
<td>
<p>value of <code>(count.lambda, zero.lambda)</code> that gives maximum <code>cv</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Zhu Wang &lt;zwang145@uthsc.edu&gt;</p>


<h3>References</h3>

<p>Zhu Wang, Shuangge Ma, Michael Zappitelli, Chirag Parikh, Ching-Yun Wang and Prasad Devarajan (2014)      <em>Penalized Count Data Regression with Application to Hospital Stay after Pediatric Cardiac Surgery</em>, <em>Statistical Methods in Medical Research</em>. 2014 Apr 17. [Epub ahead of print]
</p>
<p>Zhu Wang, Shuangge Ma, Ching-Yun Wang, Michael Zappitelli, Prasad Devarajan and Chirag R. Parikh (2014)
<em>EM for Regularized Zero Inflated Regression Models with Applications to Postoperative Morbidity after Cardiac Surgery in Children</em>, <em>Statistics in Medicine</em>. 33(29):5192-208.
</p>
<p>Zhu Wang, Shuangge Ma and Ching-Yun Wang (2015) <em>Variable selection for zero-inflated and overdispersed data with application to health care demand in Germany</em>, <em>Biometrical Journal</em>. 57(5):867-84.
</p>


<h3>See Also</h3>

<p><code>zipath</code> and <code>plot</code>, <code>predict</code>, methods for <code>"cv.zipath"</code> object.</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data("bioChemists", package = "pscl")
fm_zip &lt;- zipath(art ~ . | ., data = bioChemists, family = "poisson", nlambda=10)
fm_cvzip &lt;- cv.zipath(art ~ . | ., data = bioChemists, family = "poisson", nlambda=10)
### prediction from the best model
pred &lt;- predict(fm_zip, newdata=bioChemists, which=fm_cvzip$lambda.which)
coef(fm_zip, which=fm_cvzip$lambda.which)
fm_znb &lt;- zipath(art ~ . | ., data = bioChemists, family = "negbin", nlambda=10)
fm_cvznb &lt;- cv.zipath(art ~ . | ., data = bioChemists, family = "negbin", nlambda=10)
pred &lt;- predict(fm_znb, which=fm_cvznb$lambda.which)
coef(fm_znb, which=fm_cvznb$lambda.which)
fm_zinb2 &lt;- zipath(art ~ . +offset(log(phd))| ., data = bioChemists, 
		      family = "poisson", nlambda=10)
fm_cvzinb2 &lt;- cv.zipath(art ~ . +offset(log(phd))| ., data = bioChemists, 
		      family = "poisson", nlambda=10)
pred &lt;- predict(fm_zinb2, which=fm_cvzinb2$lambda.which)
coef(fm_zinb2, which=fm_cvzinb2$lambda.which)

## End(Not run)
</code></pre>


</div>