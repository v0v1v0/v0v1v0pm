<div class="container">

<table style="width: 100%;"><tr>
<td>cv.glmreg_fit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Internal function of cross-validation for glmreg</h2>

<h3>Description</h3>

<p>Internal function to conduct k-fold cross-validation for glmreg, produces a plot,
and returns cross-validated log-likelihood values for <code>lambda</code></p>


<h3>Usage</h3>

<pre><code class="language-R">cv.glmreg_fit(x, y, weights, offset, lambda=NULL, balance=TRUE, 
              family=c("gaussian", "binomial", "poisson", "negbin"), 
              type=c("loss", "error"), nfolds=10, foldid, plot.it=TRUE,
              se=TRUE, n.cores=2, trace=FALSE, parallel=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p><code>x</code> matrix as in <code>glmreg</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>response <code>y</code> as in <code>glmreg</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Observation weights; defaults to 1 per observation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>this can be used to specify an a priori known component to be included in the linear predictor during fitting. This should be NULL or a numeric vector of length equal to the number of cases. Currently only one offset term can be included in the formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Optional user-supplied lambda sequence; default is
<code>NULL</code>, and <code>glmreg</code> chooses its own sequence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>balance</code></td>
<td>
<p>for <code>family="binomial"</code> only</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>response variable distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p> cross-validation criteria. For <code>type="loss"</code>, loss function (log-negative-likelihood) values and <code>type="error"</code> is misclassification error if <code>family="binomial"</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfolds</code></td>
<td>
<p>number of folds &gt;=3, default is 10</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>foldid</code></td>
<td>
<p>an optional vector of values between 1 and <code>nfold</code>
identifying what fold each observation is in. If supplied,
<code>nfold</code> can be missing and will be ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.it</code></td>
<td>
<p> a logical value, to plot the estimated log-likelihood values if <code>TRUE</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p> a logical value, to plot with standard errors. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel, n.cores</code></td>
<td>
<p>a logical value, parallel computing or not with the number of CPU cores to use. The cross-validation loop will attempt to send different CV folds off to different cores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p> a logical value, print progress of cross validation or not</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments that can be passed to <code>glmreg</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function runs <code>glmreg</code> <code>nfolds</code>+1 times; the
first to compute the <code>lambda</code> sequence, and then to
compute the fit with each of the folds omitted. The error or the log-likelihood value is
accumulated, and the average value and standard deviation over the
folds is computed. Note that <code>cv.glmreg</code> can be used to search for
values for <code>alpha</code>: it is required to call <code>cv.glmreg</code> with a fixed vector <code>foldid</code> for different values of <code>alpha</code>.
</p>


<h3>Value</h3>

<p>an object of class <code>"cv.glmreg"</code> is returned, which is a
list with the ingredients of the cross-validation fit.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>a fitted glmreg object for the full data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residmat</code></td>
<td>
<p>matrix of log-likelihood values with row values for <code>lambda</code> and column values for <code>k</code>th cross-validation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv</code></td>
<td>
<p>The mean cross-validated log-likelihood values - a vector of
<code>length(lambda)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.error</code></td>
<td>
<p>estimate of standard error of <code>cv</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>foldid</code></td>
<td>
<p>an optional vector of values between 1 and <code>nfold</code>
identifying what fold each observation is in.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>a vector of <code>lambda</code> values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.which</code></td>
<td>
<p>index of <code>lambda</code> that gives maximum <code>cv</code> value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.optim</code></td>
<td>
<p>value of <code>lambda</code> that gives maximum <code>cv</code> value.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Zhu Wang &lt;zwang145@uthsc.edu&gt;</p>


<h3>References</h3>

<p>Zhu Wang, Shuangge Ma, Michael Zappitelli, Chirag Parikh, Ching-Yun Wang and Prasad Devarajan (2014)
<em>Penalized Count Data Regression with Application to Hospital Stay after Pediatric Cardiac Surgery</em>, <em>Statistical Methods in Medical Research</em>. 2014 Apr 17. [Epub ahead of print]
</p>


<h3>See Also</h3>

<p><code>glmreg</code> and <code>plot</code>, <code>predict</code>, and <code>coef</code> methods for <code>"cv.glmreg"</code> object.</p>


</div>