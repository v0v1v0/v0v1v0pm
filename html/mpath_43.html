<div class="container">

<table style="width: 100%;"><tr>
<td>cv.nclreg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cross-validation for nclreg</h2>

<h3>Description</h3>

<p>Does k-fold cross-validation for nclreg, produces a plot,
and returns cross-validated loss values for <code>lambda</code></p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'formula'
cv.nclreg(formula, data, weights, offset=NULL, ...)
## S3 method for class 'matrix'
cv.nclreg(x, y, weights, offset=NULL, ...)
## Default S3 method:
cv.nclreg(x,  ...)
## S3 method for class 'cv.nclreg'
plot(x,se=TRUE,ylab=NULL, main=NULL, width=0.02, col="darkgrey", ...)
## S3 method for class 'cv.nclreg'
coef(object,which=object$lambda.which, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>symbolic description of the model, see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>argument controlling formula processing
via <code>model.frame</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p><code>x</code> matrix as in <code>nclreg</code>. It could be object of <code>cv.nclreg</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>response <code>y</code> as in <code>nclreg</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Observation weights; defaults to 1 per observation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>Not implemented yet</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>object of <code>cv.nclreg</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>Indices of the penalty parameter <code>lambda</code> at which
estimates are extracted. By default, the one which generates the optimal cross-validation value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>logical value, if <code>TRUE</code>, standard error curve is also plotted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>ylab on y-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>title of plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>width of lines</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>color of standard error curve</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments that can be passed to <code>nclreg</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function runs <code>nclreg</code> <code>nfolds</code>+1 times; the
first to compute the <code>lambda</code> sequence, and then to
compute the fit with each of the folds omitted. The error or the loss value is
accumulated, and the average value and standard deviation over the
folds is computed. Note that <code>cv.nclreg</code> can be used to search for
values for <code>alpha</code>: it is required to call <code>cv.nclreg</code> with a fixed vector <code>foldid</code> for different values of <code>alpha</code>. 
</p>


<h3>Value</h3>

<p>an object of class <code>"cv.nclreg"</code> is returned, which is a
list with the ingredients of the cross-validation fit.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>a fitted nclreg object for the full data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residmat</code></td>
<td>
<p>matrix of loss values with row values for <code>lambda</code> and column values for <code>k</code>th cross-validation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bic</code></td>
<td>
<p>matrix of BIC values with row values for <code>lambda</code> and column values for <code>k</code>th cross-validation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv</code></td>
<td>
<p>The mean cross-validated loss values - a vector of length
<code>length(lambda)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.error</code></td>
<td>
<p>estimate of standard error of <code>cv</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>foldid</code></td>
<td>
<p>an optional vector of values between 1 and <code>nfold</code>
identifying what fold each observation is in.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>a vector of <code>lambda</code> values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.which</code></td>
<td>
<p>index of <code>lambda</code> that gives minimum <code>cv</code> value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.optim</code></td>
<td>
<p>value of <code>lambda</code> that gives minimum <code>cv</code> value.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Zhu Wang &lt;zwang145@uthsc.edu&gt;</p>


<h3>References</h3>

<p>Zhu Wang (2021),
<em>MM for Penalized Estimation</em>,
<em>TEST</em>,
doi: <a href="https://doi.org/10.1007/s11749-021-00770-2">10.1007/s11749-021-00770-2</a>
</p>


<h3>See Also</h3>

<p><code>nclreg</code> and <code>plot</code>, <code>predict</code>, and <code>coef</code> methods for <code>"cv.nclreg"</code> object.</p>


</div>