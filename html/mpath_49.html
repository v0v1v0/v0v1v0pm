<div class="container">

<table style="width: 100%;"><tr>
<td>cv.zipath_fit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cross-validation for zipath</h2>

<h3>Description</h3>

<p>Internal function k-fold cross-validation for zipath, produces a plot, and returns cross-validated log-likelihood values for <code>lambda</code></p>


<h3>Usage</h3>

<pre><code class="language-R">cv.zipath_fit(X, Z, Y, weights, offsetx, offsetz, nlambda=100, lambda.count=NULL,
              lambda.zero=NULL, nfolds=10, foldid, plot.it=TRUE, se=TRUE, 
              n.cores=2, trace=FALSE, parallel=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>predictor matrix of the count model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>predictor matrix of the zero model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>response variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>optional numeric vector of weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offsetx</code></td>
<td>
<p>optional numeric vector with an a priori known component to be included in the linear predictor of the count model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offsetz</code></td>
<td>
<p>optional numeric vector with an a priori known component to be included in the linear predictor of the zero model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlambda</code></td>
<td>
<p>number of <code>lambda</code> value, default value is 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.count</code></td>
<td>
<p>Optional user-supplied lambda.count sequence; default is
<code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.zero</code></td>
<td>
<p>Optional user-supplied lambda.zero sequence; default is
<code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfolds</code></td>
<td>
<p>number of folds &gt;=3, default is 10</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>foldid</code></td>
<td>
<p>an optional vector of values between 1 and <code>nfold</code>
identifying what fold each observation is in. If supplied,
<code>nfold</code> can be missing and will be ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.it</code></td>
<td>
<p> a logical value, to plot the estimated log-likelihood values if <code>TRUE</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p> a logical value, to plot with standard errors. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.cores</code></td>
<td>
<p>The number of CPU cores to use. The cross-validation loop
will attempt to send different CV folds off to different cores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p> a logical value, print progress of cross-validation or not </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p> a logical value, parallel computing or not</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments that can be passed to <code>zipath</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function runs <code>zipath</code> <code>nfolds</code>+1 times; the
first to compute the <code>(lambda.count, lambda.zero)</code> sequence, and then to
compute the fit with each of the folds omitted. The log-likelihood value is
accumulated, and the average value and standard deviation over the
folds is computed. Note that <code>cv.zipath</code> can be used to search for
values for <code>count.alpha</code> or <code>zero.alpha</code>: it is required to call <code>cv.zipath</code> with a fixed vector <code>foldid</code> for different values of <code>count.alpha</code> or <code>zero.alpha</code>.
</p>
<p>The method for <code>coef</code> by default
return a single vector of coefficients, i.e., all coefficients are concatenated. By setting the <code>model</code>
argument, the estimates for the corresponding model components can be extracted.
</p>


<h3>Value</h3>

<p>an object of class <code>"cv.zipath"</code> is returned, which is a
list with the components of the cross-validation fit.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>a fitted zipath object for the full data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residmat</code></td>
<td>
<p>matrix for cross-validated log-likelihood at each <code>(count.lambda, zero.lambda)</code> sequence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bic</code></td>
<td>
<p>matrix of BIC values with row values for <code>lambda</code> and column values for <code>k</code>th cross-validation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv</code></td>
<td>
<p>The mean cross-validated log-likelihood - a vector of length
<code>length(count.lambda)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.error</code></td>
<td>
<p>estimate of standard error of <code>cv</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>foldid</code></td>
<td>
<p>an optional vector of values between 1 and <code>nfold</code>
identifying what fold each observation is in.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.which</code></td>
<td>
<p>index of <code>(count.lambda, zero.lambda)</code> that gives maximum <code>cv</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.optim</code></td>
<td>
<p>value of <code>(count.lambda, zero.lambda)</code> that gives maximum <code>cv</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Zhu Wang &lt;zwang145@uthsc.edu&gt;</p>


<h3>References</h3>

<p>Zhu Wang, Shuangge Ma, Michael Zappitelli, Chirag Parikh, Ching-Yun Wang and Prasad Devarajan (2014)      <em>Penalized Count Data Regression with Application to Hospital Stay after Pediatric Cardiac Surgery</em>, <em>Statistical Methods in Medical Research</em>. 2014 Apr 17. [Epub ahead of print]
</p>
<p>Zhu Wang, Shuangge Ma, Ching-Yun Wang, Michael Zappitelli, Prasad Devarajan and Chirag R. Parikh (2014)
<em>EM for Regularized Zero Inflated Regression Models with Applications to Postoperative Morbidity after Cardiac Surgery in Children</em>, <em>Statistics in Medicine</em>. 33(29):5192-208.
</p>
<p>Zhu Wang, Shuangge Ma and Ching-Yun Wang (2015) <em>Variable selection for zero-inflated and overdispersed data with application to health care demand in Germany</em>, <em>Biometrical Journal</em>. 57(5):867-84.
</p>


<h3>See Also</h3>

<p><code>zipath</code> and <code>plot</code>, <code>predict</code>, and <code>coef</code> methods for <code>"cv.zipath"</code> object.</p>


</div>