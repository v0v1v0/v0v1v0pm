<div class="container">

<table style="width: 100%;"><tr>
<td>irglm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>fit a robust generalized linear models</h2>

<h3>Description</h3>

<p>Fit a robust GLM where the loss function is a composite function <code>cfun</code>o<code>dfun</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'formula'
irglm(formula, data, weights, offset=NULL, contrasts=NULL,
 cfun="ccave", dfun=gaussian(), s=NULL, delta=0.1, fk=NULL, init.family=NULL,
 iter=10, reltol=1e-5, theta, x.keep=FALSE, y.keep=TRUE, trace=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>symbolic description of the model, see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>argument controlling formula processing
via <code>model.frame</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>optional numeric vector of weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>input matrix, of dimension nobs x nvars; each row is an
observation vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>response variable. Quantitative for <code>dfun=1</code> and -1/1 for classification. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>the contrasts corresponding to <code>levels</code> from the
respective models</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>this can be used to specify an a priori known component to be included in the linear predictor during fitting. This should be NULL or a numeric vector of length equal to the number of cases. Currently only one offset term can be included in the formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cfun</code></td>
<td>
<p> character, type of convex cap (concave) function.<br>
Valid options are:
</p>

<ul>
<li> <p><code>"hcave"</code>
</p>
</li>
<li> <p><code>"acave"</code>
</p>
</li>
<li> <p><code>"bcave"</code>
</p>
</li>
<li> <p><code>"ccave"</code>
</p>
</li>
<li> <p><code>"dcave"</code>
</p>
</li>
<li> <p><code>"ecave"</code>
</p>
</li>
<li> <p><code>"gcave"</code>
</p>
</li>
<li> <p><code>"tcave"</code>
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dfun</code></td>
<td>
<p> character, type of convex component. <br>
Valid options are:
</p>

<ul>
<li> <p><code>gaussian()</code>
</p>
</li>
<li> <p><code>binomial()</code>
</p>
</li>
<li> <p><code>poisson()</code>
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init.family</code></td>
<td>
<p> character value for initial family, one of "clossR","closs","gloss","qloss", which can be used to derive an initial estimator, if the selection is different from the default value </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p> tuning parameter of <code>cfun</code>. <code>s &gt; 0</code> and can be equal to 0 for <code>cfun="tcave"</code>. If <code>s</code> is too close to 0 for  <code>cfun="acave", "bcave", "ccave"</code>, the calculated weights can become 0 for all observations, thus crash the program.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>a small positive number provided by user only if <code>cfun="gcave"</code> and <code>0 &lt; s &lt;1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fk</code></td>
<td>
<p> predicted values at an iteration in the IRGLM algorithm </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>number of iteration in the IRGLM algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reltol</code></td>
<td>
<p>convergency criteria in the IRGLM algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p> an overdispersion scaling parameter for <code>family=negbin()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.keep, y.keep</code></td>
<td>
<p> logical values indicating whether the response
vector and model matrix used in the fitting process should be
returned as components of the returned value, x is a design matrix of dimension n * p,
and x is a vector of observations of length n.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>if <code>TRUE</code>, fitting progress is reported</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments passing to <code>irglm</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A robust linear, logistic or Poisson regression model is fit by the iteratively reweighted GLM (IRGLM). The output <code>weights_update</code> is a useful diagnostic to the outlier status of the observations.
</p>


<h3>Value</h3>

<p>An object with S3 class <code>"irglm", "glm"</code> for various types of models.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the call that produced the model fit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>original weights used in the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights_update</code></td>
<td>
<p>weights in the final iteration of the IRGLM algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cfun, s, dfun</code></td>
<td>
<p>original input arguments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>is.offset</code></td>
<td>
<p>is offset used?</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Zhu Wang &lt;zwang145@uthsc.edu&gt;</p>


<h3>References</h3>

<p>Zhu Wang (2024)
<em>Unified Robust Estimation</em>, <em>Australian &amp; New Zealand Journal         of      Statistics</em>. 66(1):77-102.
</p>


<h3>See Also</h3>

<p><code>print</code>, <code>predict</code>, <code>coef</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R">x=matrix(rnorm(100*20),100,20)
g2=sample(c(-1,1),100,replace=TRUE)
fit=irglm(g2~x,data=data.frame(cbind(x, g2)), s=1, cfun="ccave", dfun=gaussian())
fit$weights_update
</code></pre>


</div>