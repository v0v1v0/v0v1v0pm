<div class="container">

<table style="width: 100%;"><tr>
<td>ncl_fit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Internal function to fit a nonconvex loss based robust linear model</h2>

<h3>Description</h3>

<p>Fit a linear model via penalized nonconvex loss function.  
</p>


<h3>Usage</h3>

<pre><code class="language-R">ncl_fit(x,y, weights, offset=NULL, 
        rfamily=c("clossR", "closs", "gloss", "qloss"), 
        s=NULL, fk=NULL, iter=10, reltol=1e-5, trace=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>input matrix, of dimension nobs x nvars; each row is an
observation vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>response variable. Quantitative for <code>rfamily="clossR"</code> and -1/1 for classifications.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>observation weights. Can be total counts if responses are proportion matrices. Default is 1 for each observation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>this can be used to specify an a priori known component to be included in the linear predictor during fitting. This should be NULL or a numeric vector of length equal to the number of cases. Currently only one offset term can be included in the formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rfamily</code></td>
<td>
<p>Response type and relevant loss functions (see above)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p> nonconvex loss tuning parameter for robust regression and classification. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fk</code></td>
<td>
<p> predicted values at an iteration in the MM algorithm </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>number of iteration in the MM algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reltol</code></td>
<td>
<p>convergency criteria</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>If <code>TRUE</code>, fitting progress is reported</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The robust linear model is fit by majorization-minimization along with least squares.
Note that the objective function is </p>
<p style="text-align: center;"><code class="reqn">weights*loss</code>
</p>
<p>.
</p>


<h3>Value</h3>

<p>An object with S3 class <code>"ncl"</code> for the various types of models.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the call that produced the model fit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>predicted values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p> pseudo response values in the MM algorithm </p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Zhu Wang &lt;zwang145@uthsc.edu&gt;</p>


<h3>References</h3>

<p>Zhu Wang (2021),
<em>MM for Penalized Estimation</em>,
<em>TEST</em>,
doi: <a href="https://doi.org/10.1007/s11749-021-00770-2">10.1007/s11749-021-00770-2</a>
</p>


<h3>See Also</h3>

<p><code>ncl</code></p>


</div>