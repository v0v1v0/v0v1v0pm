<div class="container">

<table style="width: 100%;"><tr>
<td>mpitb.est</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate multidimensional poverty indices based on the Alkire-Foster method</h2>

<h3>Description</h3>

<p>Estimate multidimensional poverty indices (MPI) based on the Alkire-Foster (AF) method including
disaggregated cross-sectional and changes over time estimates as well as quantities such as standard
errors and confidences intervals (accounting for the household survey design).
</p>


<h3>Usage</h3>

<pre><code class="language-R">mpitb.est(set, ...)

## S3 method for class 'mpitb_set'
mpitb.est(
  set,
  klist = NULL,
  weights = "equal",
  measures = c("M0", "H", "A"),
  indmeasures = c("hd", "hdk", "actb", "pctb"),
  indklist = NULL,
  over = NULL,
  ...,
  cotyear = NULL,
  tvar = NULL,
  cotmeasures = c("M0", "H", "A", "hd", "hdk"),
  ann = FALSE,
  cotklist = NULL,
  cotoptions = "total",
  noraw = FALSE,
  nooverall = FALSE,
  level = 0.95,
  multicore = getOption("mpitb.multicore"),
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>set</code></td>
<td>
<p>a "mpitb_set"-class object in which data, indicators, names and description have been specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>klist</code></td>
<td>
<p>a numeric vector representing the poverty cut-offs for calculating the MPI. Should be values between 1 and 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>either a character value or a numeric vector. If "equal", it automatically calculated equal nested weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>measures</code></td>
<td>
<p>a character vector with the MPI and partial measures. Default include all the measures <code>c("M0","A","H")</code>. For more information, see Details section below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indmeasures</code></td>
<td>
<p>a character vector with the indicator-specific measures. Default include all the measures <code>c("hd", "hdk", "actb", "pctb")</code>. For more information, see Details section below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indklist</code></td>
<td>
<p>a numeric vector representing the poverty cut-offs for calculating indicator-specific measures. Should be values between 1 and 100. If <code>NULL</code>, it will be equal to <code>klist</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>over</code></td>
<td>
<p>a character vector with columns names of the population subgroups in data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cotyear</code></td>
<td>
<p>a character value containing the column name of the years variable in the data. This argument is required if annualized changes over time measure are desired.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tvar</code></td>
<td>
<p>a character value containing the column name of the time ID variable in the data.  This argument determines if changes over time are calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cotmeasures</code></td>
<td>
<p>a character vector with the changes over time measures. Default include all the measures <code>c("M0","A","H","hd", "hdk")</code>. For more information, see Details section below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ann</code></td>
<td>
<p>logical. If <code>TRUE</code>, annualized changes over time measure are estimated. If <code>FALSE</code>, only  non-annualized changes over time are calculated. Default value is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cotklist</code></td>
<td>
<p>a numeric vector representing the poverty cut-offs for calculating changes over time measures. Should be values between 1 and 100. If <code>NULL</code>, it will be equal to <code>klist</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cotoptions</code></td>
<td>
<p>a character vector. If "total", estimates change over the total period of observation, i.e. from the first year of observation to the last year of observation. If "insequence", then  estimates all consecutive (i.e. year-to-year) changes. The default is "total"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noraw</code></td>
<td>
<p>logical. If <code>TRUE</code>, non-annualized changes over time measure are not estimated. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nooverall</code></td>
<td>
<p>logical. If <code>TRUE</code>, estimations over all the observations are omitted, e.g., national level calculations, and only measure for the specified subgroups are estimated. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>numeric value with the desired confidence level for the confidence interval calculations in decimal format. Default value is 0.95.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>multicore</code></td>
<td>
<p>logical. Use <code>multicore</code> package for parallel estimation by measure and poverty cut-off over multiple processors? It uses forking approach. See Details below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical. If TRUE, print information messages to the console so the user can control the dimension and indicators weights and which measures are being estimated in the process. If FALSE, these messages are ommited.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This functions is a S3 method for "mpitb_set" class. Hence, the project
has to be correctly specified with <code>mpitb.set()</code> function previously.
</p>
<p>The vector of poverty cut-offs (<code class="reqn">k</code>) in percentage point, i.e., numbers
between 1 and 100. Although the deprivation score (<code class="reqn">c_i = \sum_{i=1}^n w_j g_{ij}^0</code>) is a real-valued
function, given the weights, it will assume a limited number of values. The same
occurs with the censored deprivation score. Therefore, despite accepting infinite
number of values, results may not vary with close values of <code class="reqn">k</code>. For this reason,
it is recommended to use a very limited number of poverty cut-offs for the analysis.
</p>
<p>If nothing is passed to <code>weights</code> argument, equal nested weights are calculated
by dimension and indicator. In this case, it is preferred to pass indicators as a list
in <code>mpitb.set()</code>. If the user wants to pass another weighting
scheme, she should first pass the indicators as a character vector in <code>mpitb.set()</code>
and then pass a numeric vector in <code>weights</code> such that the elements of this
vector match with the vector of indicators and all the weights sum up to 1.
</p>
<p>To specify the population subgroups (e.g., living area, sex, etc.) and estimate the
disaggregated measures by each level of the subgroup, the user should pass the column
names of the population subgroups in the data using <code>over</code> argument. If <code>over</code>
is <code>NULL</code>, the measure are estimate using all the observations (e.g., national-level).
If population subgroups are specified and <code>nooverall</code> is set to <code>TRUE</code>,
aggregate (or national-level) estimates will not be produced.
</p>
<p>Details on the AF measures estimation:
</p>
<p>Available measures include the Adjusted Headcount Ratio (<code class="reqn">M_0</code>), the
Incidence (<code class="reqn">H</code>) and the Intensity of poverty (<code class="reqn">A</code>), as well as other
indicator-specific measures
such as the uncensored headcount ratio (<code class="reqn">h_j</code>), the censored headcount ratio (<code class="reqn">h_j(k)</code>)
and the absolute and percentage contribution.
</p>
<p>The three first partial measures are pass in <code>measures</code> argument. By default,
<code>mpitb.est</code> calculates every measure <code>c("M0","H","A")</code>. The poverty
cut-off (<code class="reqn">k</code>) for these measures estimation is specified in <code>klist</code> argument.
</p>
<p>The indicator-specific measure are passed in <code>indmeasures</code> argument. By default,
<code>mpitb.est</code> calculates every measure <code>c("hd","hdk","actb","pctb")</code>. The poverty
cut-off (<code class="reqn">k</code>) for these measures estimation is specified in <code>indklist</code> argument.
If <code>indklist</code> is <code>NULL</code>, poverty cut-offs in <code>klist</code> is used.
The absolute contribution <code>c("actb")</code> cannot be estimated without also
passing the censored headcount
ratios of each indicator  <code>c("hdk")</code> and the percentage contribution cannot be
calculated without <code>c("hdk")</code> and <code>c("M0")</code> passed in <code>measures</code> argument.
</p>
<p>If any of these arguments is <code>NULL</code>, <code>mpitb.est()</code> skips these
measures. So it is useful for avoid calculating unnecessary estimations. For example,
if <code>measures = c("H","A")</code> and <code>indmeasures = NULL</code>, only the Incidence and
the Intensity will be estimated.
</p>
<p>Details on changes over time measures:
</p>
<p>The user can decide which AF measure changes over time she want to study. This is
set in <code>cotmeasures</code>. By default it calculates all the measure, except contributions, i.e.,
<code>cotmeasure = c("M0","A","H","hd","hdk")</code>. It would be important to check this argument in order to save time.
The poverty
cut-off (<code class="reqn">k</code>) for these measures estimation is specified in <code>cotklist</code> argument.
If <code>cotklist</code> is <code>NULL</code>, poverty cut-offs in <code>klist</code> is used.
The standard errors of the changes over time measures is estimated using Delta method.
</p>
<p>For calculating any point estimate for each time period and any change over time
measure, <code>tvar</code> should not be <code>NULL</code>. This argument should be a character with the
column name that references the time period <code class="reqn">t = 1, \ldots,T</code>.
</p>
<p>Changes over time measure can also be annualized. For such measure, information about
the years is needed. <code>cotyear</code>  should be a character with the column name
that have information about the years. Decimal digits are permitted. Argument <code>ann</code> is a logical
value. If <code>TRUE</code>, annualized measures are calculated. If <code>cotyear</code> is passed, <code>ann</code>
is automatically set to <code>TRUE</code>. If the former is not <code>NULL</code> and
<code>ann</code> is <code>FALSE</code>, only non-annualized
measures are estimated. If only annualized measure are
under study, the user can switch <code>noraw</code> to <code>TRUE</code> to avoid estimating non-annualized changes.
</p>
<p>Finally, if there are more than two years survey rounds, the user can decide if estimate the
change over the total period of observation, i.e. from the first year of observation to the
last year of observation or year-to-year changes. To do the former, <code>cotoptions = "total"</code>
whereas for the latter case, <code>cotoptions = "insequence"</code>. By default, <code>cotoptions = "total"</code>
to avoid unnecessary estimations.
</p>
<p>Some details on other arguments and estimations:
</p>
<p>The package includes the possibility to do parallel calculations over all the measures and poverty cut-offs.
If <code>multicore</code> is <code>TRUE</code>, the package proceeds with parallel estimations. Caveat: this package uses
Forking method for parallelization which is only available on Unix-like systems (including Linux), i.e., Windows
users cannot benefit from parallelization.
</p>
<p>For every measure the standard errors and confidence intervals are estimated. The former are estimated taking into
account the survey structure whereas the latter are estimated considering measures as proportions using <code>svyciprop()</code>
function from "survey" R package (it uses the "logit" method which consists of fitting a logistic regression model
and computes a Wald-type interval on the log-odds scale, which is then transformed to the probability scale).
</p>


<h3>Value</h3>

<p>An object with S3 class "mpitb_est" containing two data frames with the estimates of the cross-sectional measures ("lframe"-class) and changes over time ("cotframe"-class).
</p>


<h3>Author(s)</h3>

<p>Ignacio Girela
</p>


<h3>References</h3>

<p><em>Alkire, S., Foster, J. E., Seth, S., Santos, M. E., Roche, J., &amp; Ballon, P. (2015). Multidimensional poverty measurement and analysis. Oxford University Press.</em>
</p>
<p><em>Alkire, S., Roche, J. M., &amp; Vaz, A. (2017). Changes over time in multidimensional poverty: Methodology and results for 34 countries. World Development, 94, 232-249</em>. <a href="https://doi.org/10.1016/j.worlddev.2017.01.011">doi:10.1016/j.worlddev.2017.01.011</a>
</p>
<p><em>Suppa, N. (2023). mpitb: A toolbox for multidimensional poverty indices. The Stata Journal, 23(3), 625-657</em>. <a href="https://doi.org/10.1177/1536867X231195286">doi:10.1177/1536867X231195286</a>
</p>


<h3>See Also</h3>

<p><code>coef</code>, <code>confint</code>, and <code>summary</code> methods, and <code>mpitb.set</code> function.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(mpitbR)

data &lt;- subset(syn_cdta)
data &lt;- na.omit(data)

svydata &lt;- survey::svydesign(id=~psu, weights = ~weight, strata = ~stratum, data = data)

indicators &lt;- list(d1 = c("d_nutr","d_cm"),
                   d2 = c("d_satt","d_educ"),
                   d3 = c("d_elct","d_sani","d_wtr","d_hsg","d_ckfl","d_asst"))

# Specify mpitb project
set &lt;- mpitb.set(svydata, indicators = indicators, name = "myname", desc = "pref. desc")

# Estimate the cross-sectional MPI and compare non-annualized changes over time
est &lt;- mpitb.est(set, klist = c(33), measures = "M0", indmeasures = NULL,
                 tvar = "t", cotmeasures = "M0",
                 weights = "equal", over = c("area"))

coef(subset(est$lframe, measure == "M0" &amp; t == 1))
confint(subset(est$lframe, measure == "M0" &amp; t == 1))
summary(subset(est$lframe, measure == "M0" &amp; t == 1))

coef(subset(est$cotframe, measure == "M0"))
confint(subset(est$cotframe, measure == "M0"))
summary(subset(est$cotframe, measure == "M0" &amp; ctype == "abs" &amp; ann == 0 &amp; k == 33))
</code></pre>


</div>