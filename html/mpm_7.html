<div class="container">

<table style="width: 100%;"><tr>
<td>plot.mpm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spectral Map Plot of Multivariate Data
Produces a spectral map plot (biplot) of an object of class <code>mpm</code>
</h2>

<h3>Description</h3>

<p>Spectral maps are special types of biplots with the area of the symbols
proportional to some measure, usually the row or column mean value and an
identification of row- and column-items.  For large matrices, such as gene
expression data, where there is an abundance of rows, this can obscure the
plot.  In this case, the argument <code>label.tol</code> can be used to select the
most informative rows, i.e. rows that are most distant from the center of
the plot.  Only these row-items are then labeled and represented as circles
with their areas proportional to the marginal mean value.  For the
column-items it can be useful to apply some grouping specified by
<code>col.group</code>. Examples of groupings are different pathologies, such as
specified in <code>Golub.grp</code>
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'mpm'
plot(
  x,
  scale = c("singul", "eigen", "uvr", "uvc"),
  dim = c(1, 2),
  zoom = rep(1, 2),
  show.row = c("all", "position"),
  show.col = c("all", "position"),
  col.group = rep(1, length(x$col.names)),
  colors = c("orange1", "red", rainbow(length(unique(col.group)), start = 2/6, end =
    4/6)),
  col.areas = TRUE,
  col.symbols = c(1, rep(2, length(unique(col.group)))),
  sampleNames = TRUE,
  rot = rep(-1, length(dim)),
  labels = NULL,
  label.tol = 1,
  label.col.tol = 1,
  lab.size = 0.725,
  col.size = 10,
  row.size = 10,
  do.smoothScatter = FALSE,
  do.plot = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>object of class <code>mpm</code> a result of a call to <code>mpm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>optional character string specifying the type of factor scaling
of the biplot. This can be either <kbd>"singul"</kbd> (singular value scaling),
<kbd>"eigen"</kbd> (eigenvalue scaling), <kbd>"uvr"</kbd> (unit row-variance
scaling), <kbd>"uvc"</kbd> (unit column-variance scaling). The latter is of
particular value when analyzing large matrices, such as gene expression
data. Singular value scaling <kbd>"singul"</kbd> is customary in spectral map
analysis. Defaults to <kbd>"singul"</kbd>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dim</code></td>
<td>
<p>optional principal factors that are plotted along the horizontal
and vertical axis. Defaults to <code>c(1,2)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zoom</code></td>
<td>
<p>optional zoom factor for row and column items. Defaults to
<code>c(1,1)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.row</code></td>
<td>
<p>optional character string indicating whether all rows
(<kbd>"all"</kbd>) are to be plotted or just the positioned rows
<kbd>"position"</kbd>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.col</code></td>
<td>
<p>optional character string indicating whether all columns
(<kbd>"all"</kbd>) are to be plotted or just the positioned columns
<kbd>"position"</kbd>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.group</code></td>
<td>
<p>optional vector (character or numeric) indicating the
different groupings of the columns, e.g. <code>Golub.grp</code>. Defaults to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colors</code></td>
<td>
<p>vector specifying the colors for the annotation of the plot;
the first two elements concern the rows; the third till the last element
concern the columns; the first element will be used to color the unlabeled
rows; the second element for the labeled rows and the remaining elements
to give different colors to different groups of columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.areas</code></td>
<td>
<p>logical value indicating whether columns should be plotted
as squares with areas proportional to their marginal mean and colors
representing the different groups (<code>TRUE</code>), or with symbols
representing the groupings and identical size (<code>FALSE</code>). Defaults to
<code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.symbols</code></td>
<td>
<p>vector of symbols when <code>col.areas=FALSE</code> corresponds
to the <code>pch</code> argument of the function <code>plot</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampleNames</code></td>
<td>
<p>Either a logical vector of length one or a character
vector of length equal to the number of samples in the dataset. If a
logical is provided, sample names will be displayed on the plot
(<code>TRUE</code>; default) or not (<code>FALSE</code>); if a character vector is
provided, the names provided will be used to label the samples instead of
the default column names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rot</code></td>
<td>
<p>rotation of plot. Defaults to <code>c(-1,-1)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>character vector to be used for labeling points on the graph;
if <code>NULL</code>, the row names of <code>x</code> are used instead</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label.tol</code></td>
<td>
<p>numerical value specifying either the percentile
(<code>label.tol&lt;=1</code>) of rows or the number of rows (<code>label.tol&gt;1</code>)
most distant from the plot-center (0,0) that are labeled and are plotted
as circles with area proportional to the marginal means of the original
data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label.col.tol</code></td>
<td>
<p>numerical value specifying either the percentile
(<code>label.col.tol&lt;=1</code>) of columns or the number of columns (<code>label.col.tol&gt;1</code>)
most distant from the plot-center (0,0) that are labeled and are plotted
as circles with area proportional to the marginal means of the original
data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lab.size</code></td>
<td>
<p>size of identifying labels for row- and column-items as
<code>cex</code> parameter of the <code>text</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.size</code></td>
<td>
<p>size in mm of the column symbols</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row.size</code></td>
<td>
<p>size in mm of the row symbols</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.smoothScatter</code></td>
<td>
<p>use smoothScatter or not instead of plotting
individual points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.plot</code></td>
<td>
<p>produce a plot or not</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to <code>eqscaleplot</code> which draws the canvas
for the plot; useful for adding a <code>main</code> or a custom <code>sub</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>plot.mpm</code> that has the following
components: </p>
<table>
<tr style="vertical-align: top;">
<td><code>Rows</code></td>
<td>
<p>a data frame with the X and Y coordinates of the
rows and an indication <code>Select</code> of whether the row was selected
according to <code>label.tol</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Columns</code></td>
<td>
<p>a data frame with the X and
Y coordinates of the columns</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p><code>value</code> is returned invisibly, but is available for further use
when an explicit assignment is made
</p>


<h3>Author(s)</h3>

<p>Luc Wouters
</p>


<h3>References</h3>

<p>Wouters, L., Goehlmann, H., Bijnens, L., Kass, S.U.,
Molenberghs, G., Lewi, P.J. (2003). Graphical exploration of gene
expression data: a comparative study of three multivariate methods.
<em>Biometrics</em> <b>59</b>, 1131-1140.
</p>


<h3>See Also</h3>

<p><code>mpm</code>, <code>summary.mpm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
  # Weighted spectral map analysis
  data(Golub) # Gene expression data of leukemia patients
  data(Golub.grp) # Pathological classes coded as 1, 2, 3
  r.sma &lt;- mpm(Golub[,1:39], row.weight = "mean", col.weight = "mean")
  # Spectral map biplot with result
  r &lt;- plot(r.sma, label.tol = 20, scale = "uvc",
            col.group = (Golub.grp)[1:38], zoom = c(1,1.2), col.size = 5)
  Golub[r$Rows$Select, 1] # 20 most extreme genes

</code></pre>


</div>