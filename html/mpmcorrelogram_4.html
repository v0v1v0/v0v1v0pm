<div class="container">

<table style="width: 100%;"><tr>
<td>mpmcorrelogram</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multivariate Partial Mantel Correlogram</h2>

<h3>Description</h3>

<p>Function <code>mpmcorrelogram</code> computes both multivariate and multivariate partial
Mantel correlograms. Multivariate Mantel correlograms were proposed by Sokal
(1986) and Oden and Sokal (1986) and popularized among ecologists by Legendre
and Legendre (1998, pp. 736-738). Multivariate partial Mantel correlograms
are described and employed by Matesanz et al. (2011).
</p>


<h3>Usage</h3>

<pre><code class="language-R">  mpmcorrelogram(xdis, geodis, zdis = NULL, method = "pearson",
                 alfa = 0.05, nclass = NULL, breaks = NULL,
                 permutations = 999, strata, simil = FALSE,
                 plot = TRUE, print = TRUE)

  ## S3 method for class 'mpmcorrelogram'
plot(x, pch = c(15, 22), xlim = NULL, ylim = NULL,
                ylab = NULL, xlab = NULL, alfa = 0.05, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xdis, geodis, zdis</code></td>
<td>

<p>Multivariate distance (or similarity) matrices or their
as.dist representation
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>Correlation method, as accepted by cor:
"pearson", "spearman" or "kendall". 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alfa</code></td>
<td>

<p>Significance level for the points drawn with black symbols in the
correlogram. By default <code>alpha</code> = 0.05.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nclass</code></td>
<td>

<p>Number of distance classes. Deafult <code>NULL</code> causes Sturge's law
being used to determine the number of classes unless break points
are provided.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>

<p>Vector with break points of the distance classes.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>permutations</code></td>
<td>

<p>Number of permutations for the tests of significance.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strata</code></td>
<td>

<p>An integer vector or factor specifying the strata for permutation.
If supplied, observations are permuted only within the specified strata.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simil</code></td>
<td>

<p>Logical. Is the first matrix a similarity matrix? Default=<code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>

<p>Logical. Should the correlogram be ploted?. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print</code></td>
<td>

<p>Logical. Should the results be printed?
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>An object of class mpmcorrelogram, i.e. resulting from function
mpmcorrelogram.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>

<p>Vector with two integers (or two single characters) specifying the symbols
(or characters) to plot respectively the significant
and non-significant <em>rM</em> values.  See points for possible
values and their interpretation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>

<p>Vector with the limits for the x-axis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>

<p>Vector with the limits for the y-axis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>

<p>Label for the y-axis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>

<p>Label for the x-axis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Other parameters passed to print and plot methods.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>mpmcorrelogram</code> computes both Mantel correlograms and
<em>partial</em> Mantel correlograms.
A correlogram is a graph in which spatial correlation values are plotted,
on the ordinate, as a function of the geographic distance classes among
the study units along the abscissa. In a "classical" Mantel correlogram,
a Mantel correlation (Mantel 1967) is computed between a multivariate 
(e.g. multi-species or multi-locus) distance or similarity matrix
and a design matrix representing each of the geographic distance classes
in turn. The Mantel statistic is tested through a permutational Mantel test
performed by <span class="pkg">vegan</span>'s mantel function.
</p>
<p>In a partial Mantel correlogram, a partial correlation conditioned on a
third matrix is computed between the focal matrix and the design matrix
representing each of the geographic distance classes. In this case, 
the partial Mantel statistic is tested through a permutational test
performed by <span class="pkg">vegan</span>'s mantel.partial function.
</p>
<p>A practical application of the use of the partial Mantel correlogram 
can be seen in Matesanz et al. (2011).
</p>


<h3>Value</h3>

<p>If the arguments <code>plot</code> and <code>print</code> are both <code>TRUE</code>, 
<code>mpmcorrelogram</code> by default will draw a correlogram where solid squares
indicate significant <code>rM</code> values and void squares indicate non-significant ones.
It will also print the results as a table. In any case, <code>mpmcorrelogram</code>
will return an object of <code>class mpmcorrelogram</code>, i.e. a list with the
following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>

<p>Vector with the break points of the distance classes considered. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rM</code></td>
<td>

<p>Vector with the computed Mantel correlations for each distance class.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>signif</code></td>
<td>

<p>The value of the selected <code>alfa</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalues</code></td>
<td>

<p>Vector with the p-values computed for each distance class.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval.Bonferroni</code></td>
<td>

<p>Vector with the p-values after a progressive Bonferroni correction.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clases</code></td>
<td>

<p>Alfanumeric vector with the range of each distance class.
</p>
</td>
</tr>
</table>
<h3>Acknowledgements</h3>

<p>This package  has been developed thaks to the subvention 099/RN08/02.1 of the Spanish Ministerio de Medio Ambiente, Medio Rural y Marino.
</p>


<h3>Note</h3>

<p>The implementation of the Mantel correlogram computation in
the function <code>mpmcorrelogram</code> (and that of Mantel correlation performed
by <span class="pkg">vegan</span>'s mantel.partial and mantel 
functions) are based on the description of Legendre and Legendre (1998).
Following these approaches, positive Mantel statistics correspond to
positive autocorrelation when the focal matrix (i.e. <code>xdis</code>)
is a similarity matrix and to negative values when it is a 
distance matrix. As most of the designed tools in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> for summarizing
relationships between the rows of data matrices return distance objects,
the argument <code>simil</code> in <code>mpmcorrelogram</code> is set by default to 
<code>FALSE</code>. See the examples for the use with a similarity matrix.
</p>


<h3>Author(s)</h3>

<p>Marcelino de la Cruz Rot <a href="mailto:marcelino.delacruz@upm.es">marcelino.delacruz@upm.es</a>
</p>


<h3>References</h3>

<p>Legendre, P. and L. Legendre. 1998. <em>Numerical ecology</em>, 2nd English
edition. Elsevier Science BV, Amsterdam. 
</p>
<p>Mantel, N. 1967. The detection of disease clustering and a generalized
regression approach. <em>Cancer Res.</em> 27: 209-220. 
</p>
<p>Matesanz S., Gimeno T.E., de la Cruz M., Escudero A. and Valladares F. 2011.
Competition may explain the fine-scale spatial patterns and genetic structure
of two co-occurring plant congeners. <em>J. Ecol.</em> 99: 838-848
</p>
<p>Oden, N. L. and R. R. Sokal. 1986. Directional autocorrelation: an extension
of spatial correlograms to two dimensions. <em>Syst. Zool.</em> 35: 608-617. 
</p>
<p>Sokal, R. R. 1986. Spatial data analysis and historical processes.
29-43 in: E. Diday et al. (eds.) <em>Data analysis and informatics</em>,
IV. North-Holland, Amsterdam. 
</p>


<h3>See Also</h3>

<p><span class="pkg">vegan</span>'s mantel.correlog for another implementation of 
(non-partial) Mantel correlograms.
</p>


<h3>Examples</h3>

<pre><code class="language-R"> # Example from Figure 13.12 of Legendre and Legendre (1998):

 # Get similarity matrix based on assemblage composition.
 
 data(S) 
 
 # Get euclidean distance between sites.
 
 data(D)
 
 # Compute Multivariate Mantel Correlogram
 # as in Fig. 13.12 of Legendre and Legendre
 
 ## Not run: 
 result &lt;- mpmcorrelogram(S, D, simil=TRUE)
 
## End(Not run)
 
 
 # A Multivariate Partial examle.
 # Get distance matrix of "covariate" attributes
 
 data(Zd)
 
 # Compute multivariate partial Mantel correlogram
 
 ## Not run: 
 result &lt;- mpmcorrelogram(S, D, Zd, simil=TRUE)
 
## End(Not run)
 

# Change the appearance of the plot
 
 ## Not run: 
 plot(result, pch=c(17,24))
 
## End(Not run)
</code></pre>


</div>