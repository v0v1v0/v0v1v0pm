<div class="container">

<table style="width: 100%;"><tr>
<td>rand_lefko_set</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate lists of Lefkovitch matrix population models (MPMs) based on life
history archetypes</h2>

<h3>Description</h3>

<p>This function generates a list of <code>n</code> MPMs according to the specified
criteria. Criteria include the <code>archetype</code>, and the acceptable constraining
criteria, which could include lambda, generation time or any other metric
derived from an A matrix. The function attempts to find matrices that fulfil
the criteria, discarding unacceptable matrices. By default, if it takes more
than 1000 attempts to find a suitable matrix model, then an error is
produced. However, the number of attempts can be altered with the <code>attempts</code>
parameter.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rand_lefko_set(
  n_models = 5,
  n_stages = 3,
  archetype = 1,
  fecundity = 1.5,
  output = "Type1",
  max_surv = 0.99,
  constraint = NULL,
  attempts = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n_models</code></td>
<td>
<p>An integer indicating the number of MPMs to generate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_stages</code></td>
<td>
<p>The number of stages for the MPMs. Default is <code>3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>archetype</code></td>
<td>
<p>The archetype of the MPMs. Default is <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fecundity</code></td>
<td>
<p>The average number of offspring produced (fecundity).
Values can be provided in 4 ways:
</p>

<ul>
<li>
<p> An numeric vector of length 1 providing a single measure of fecundity
to the top right corner of the matrix model only.
</p>
</li>
<li>
<p> A numeric vector of integers of length equal to <code>n_stages</code> to provide
fecundity estimates for the whole top row of the matrix model. Use 0 for
cases with no fecundity.
</p>
</li>
<li>
<p> A matrix of numeric values of the same dimension as <code>n_stages</code> to provide
fecundity estimates for the entire matrix model. Use 0 for cases with no
fecundity.
</p>
</li>
<li>
<p> A list of two matrices of numeric values, both with the same dimension as
<code>n_stages</code>, to provide lower and upper limits of mean fecundity for the
entire matrix model.
</p>
</li>
</ul>
<p>In the latter case, a fecundity value will be drawn from a uniform
distribution for the defined range. If there is no fecundity in a
particular age class, use a value of 0 for both the lower and upper limit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>Character string indicating the type of output.
</p>

<ul>
<li> <p><code>Type1</code>: A <code>compadreDB</code> Object containing MPMs split into the submatrices
(i.e. A, U, F and C).
</p>
</li>
<li> <p><code>Type2</code>: A <code>compadreDB</code> Object containing MPMs that are not split into
submatrices (i.e. only the A matrix is included).
</p>
</li>
<li> <p><code>Type3</code>: A <code>list</code> of MPMs arranged so that each element of the list
contains a model and associated submatrices (i.e. the nth element contains
the nth A matrix alongside the nth U and F matrices).
</p>
</li>
<li> <p><code>Type4</code>: A <code>list</code> of MPMs arranged so that the list contains 3 lists for
the A  matrix and the U and F submatrices respectively.
</p>
</li>
<li> <p><code>Type5</code>: A <code>list</code> of MPMs, including only the A matrix.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_surv</code></td>
<td>
<p>The maximum acceptable survival value, calculated across all
transitions from a stage. Defaults to <code>0.99</code>. This is only used the output
splits a matrix into the submatrices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constraint</code></td>
<td>
<p>An optional data frame with 4 columns named <code>fun</code>, <code>arg</code>,
<code>lower</code> and <code>upper</code>. These columns specify (1) a function that outputs a
metric derived from an A matrix and (2) an argument for the function (<code>NA</code>,
if no argument supplied) (3) the lower acceptable bound for the metric and
(4) upper acceptable bound for the metric.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>attempts</code></td>
<td>
<p>An integer indicating the number of attempts To be made when
simulating matrix model. The default is 1000. If it takes more than 1000
attempts to make a matrix that satisfies the conditions set by the other
arguments, then a warning is produced.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>compadreDB</code> object or list of MPMs that meet the specified
criteria.
</p>


<h3>Author(s)</h3>

<p>Owen Jones <a href="mailto:jones@biology.sdu.dk">jones@biology.sdu.dk</a>
</p>


<h3>References</h3>

<p>Caswell, H. (2001). Matrix Population Models: Construction, Analysis, and
Interpretation. Sinauer.
</p>
<p>Lefkovitch, L. P. (1965). The study of population growth in organisms grouped
by stages. Biometrics, 21(1), 1.
</p>
<p>Takada, T., Kawai, Y., &amp; Salguero-Gómez, R. (2018). A cautionary note on
elasticity analyses in a ternary plot using randomly generated population
matrices. Population Ecology, 60(1), 37–47.
</p>


<h3>See Also</h3>

<p><code>rand_lefko_mpm()</code> which this function is essentially a wrapper for.
</p>
<p>Other Lefkovitch matrices: 
<code>generate_mpm_set()</code>,
<code>rand_lefko_mpm()</code>,
<code>random_mpm()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(42) # set seed for repeatability

# Basic operation, without splitting matrices and with no constraints
rand_lefko_set(
  n_models = 3, n_stages = 5, fecundity = c(0, 0, 4, 8, 10),
  archetype = 4, output = "Type5"
)

# Constrain outputs to A matrices with lambda between 0.9 and 1.1
library(popbio)
constrain_df &lt;- data.frame(
  fun = "lambda", arg = NA, lower = 0.9, upper =
    1.1
)
rand_lefko_set(
  n_models = 10, n_stages = 5, fecundity = c(0, 0, 4, 8, 10),
  archetype = 4, constraint = constrain_df, output = "Type5"
)

# As above, but using popdemo::eigs function instead of popbio::lambda
# to illustrate use of argument
library(popdemo)
constrain_df &lt;- data.frame(
  fun = "eigs", arg = "lambda", lower = 0.9, upper = 1.1
)

rand_lefko_set(
  n_models = 10, n_stages = 5, fecundity = c(0, 0, 4, 8, 10),
  archetype = 4, constraint = constrain_df, output = "Type5"
)

# Multiple constraints
# Constrain outputs to A matrices with lambda between 0.9 and 1.1, generation
# time between 3 and 5 and damping ratio between 1 and 7.
library(popbio)
constrain_df &lt;- data.frame(
  fun = c("lambda", "generation.time", "damping.ratio"),
  arg = c(NA, NA, NA),
  lower = c(0.9, 3.0, 1.0),
  upper = c(1.1, 5.0, 7.0)
)
rand_lefko_set(
  n_models = 10, n_stages = 5, fecundity = c(0, 0, 4, 8, 10),
  archetype = 4, constraint = constrain_df, output = "Type5"
)

</code></pre>


</div>