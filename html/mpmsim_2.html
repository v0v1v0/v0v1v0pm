<div class="container">

<table style="width: 100%;"><tr>
<td>add_mpm_error</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Add sampling error to matrix population models (MPMs) based on expected
values of transition rates and sample sizes</h2>

<h3>Description</h3>

<p>Produces a list of matrix population models based on expected values in the
transition matrix and sample size. The expected values are provided in lists
of two submatrices: <code>mat_U</code> for the growth/development and survival
transitions and <code>mat_F</code> for the reproductive transitions. The output <code>mat_U</code>
values are simulated based on expected probabilities, assuming a binomial
process with a sample size defined by <code>sample_size</code>. The output <code>mat_F</code>
values are simulated using a Poisson process with a sample size defined by
<code>sample_size</code>.Thus users can expect that large sample sizes will result in
simulated matrices that match closely with the expectations, while simulated
matrices with small sample sizes will be more variable.
</p>


<h3>Usage</h3>

<pre><code class="language-R">add_mpm_error(mat_U, mat_F, sample_size, split = TRUE, by_type = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mat_U</code></td>
<td>
<p>A list of U submatrices, or a single U submatrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mat_F</code></td>
<td>
<p>A list of F submatrices, or a single F submatrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample_size</code></td>
<td>
<p>either (1) a single matrix of sample sizes for each
element of every MPM, (2) a list of two named matrices ("<code>mat_F_ss</code>",
"<code>mat_U_ss</code>") containing sample sizes for the survival and reproductive
output submatrices of every MPM or (3) a single value applied to the every
element of every matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>split</code></td>
<td>
<p>logical, whether to split the output into survival and
reproductive output matrices or not. Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by_type</code></td>
<td>
<p>A logical indicating whether the matrices should be returned
in a list by type (A, U, F, C). If split is <code>FALSE</code>, then <code>by_type</code> must
also be <code>FALSE</code>. Defaults to <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>if any <code>sample_size</code> input is 0, it is assumed that the estimate for
the element(s) concerned is known without error.
</p>


<h3>Value</h3>

<p>list of matrices of survival and reproductive output if <code>split = TRUE</code>, otherwise a single matrix of the sum of survival and reproductive
output.
</p>


<h3>Author(s)</h3>

<p>Owen Jones <a href="mailto:jones@biology.sdu.dk">jones@biology.sdu.dk</a>
</p>


<h3>See Also</h3>

<p>Other errors: 
<code>calculate_errors()</code>,
<code>compute_ci()</code>,
<code>compute_ci_U()</code>
</p>
<p>Other errors: 
<code>calculate_errors()</code>,
<code>compute_ci()</code>,
<code>compute_ci_U()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(42) # set seed for repeatability

# First generate a set of MPMs
mpm_set &lt;- rand_lefko_set(n = 5, n_stages = 5, fecundity = c(
  0, 0, 4, 8, 10
), archetype = 4, output = "Type4")

# Now apply sampling error to this set
add_mpm_error(
  mat_U = mpm_set$U_list, mat_F = mpm_set$F_list, sample_size =
    50
)

# Also works with a single matrix.
mats &lt;- make_leslie_mpm(
  survival = c(0.1, 0.2, 0.5),
  fecundity = c(0, 1.2, 2.4),
  n_stages = 3, split = TRUE
)

# Sample size is a single value
add_mpm_error(mat_U = mats$mat_U, mat_F = mats$mat_F, sample_size = 20)

# Sample size is a list of two matrices
# here with a sample size of 20 for fecundity and 10 for growth/survival.
mpm_set &lt;- rand_lefko_set(
  n = 5, n_stages = 3, fecundity = c(0, 2, 4),
  archetype = 4, output = "Type4"
)

ssMats &lt;- list(
  "mat_F_ss" = matrix(20, nrow = 3, ncol = 3),
  "mat_U_ss" = matrix(10, nrow = 3, ncol = 3)
)

# Add sampling error to the matrix models
output &lt;- add_mpm_error(
  mat_U = mpm_set$U_list, mat_F = mpm_set$F_list,
  sample_size = ssMats
)

# Examine the outputs
names(output)
output

</code></pre>


</div>