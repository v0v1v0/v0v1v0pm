<div class="container">

<table style="width: 100%;"><tr>
<td>calculate_errors</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate error (standard error or 95%CI) in elements of a matrix population
model.</h2>

<h3>Description</h3>

<p>Given two submatrices of a matrix population model (<code>mat_U</code> and <code>mat_F</code>, the
growth/survival matrix and the fecundity matrix respectively) and a sample
size, or matrix/matrices of sample sizes, this function calculates the
standard error or 95% confidence interval (95%CI) for each element of the
matrix. These calculations assume that <code>mat_U</code> is the result of binomial
processes (i.e., the survival (0/1) of a sample of n individuals), while
<code>mat_F</code> is the result of Poisson processes (i.e., counts of offspring from n
individuals), where n is the sample size.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calculate_errors(mat_U, mat_F, sample_size, type = "sem", calculate_A = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mat_U</code></td>
<td>
<p>matrix of mean survival probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mat_F</code></td>
<td>
<p>matrix of mean fecundity values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample_size</code></td>
<td>
<p>either (1) a single matrix of sample sizes for each
element of the MPM, (2) a list of two named matrices ("<code>mat_F_ss</code>",
"<code>mat_U_ss</code>") containing sample sizes for the survival and fecundity
submatrices of the MPM or (3) a single value applied to the whole matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A character string indicating the type of error to calculate.
Must be one of "<code>sem</code>" (standard error), or "<code>CI95</code>" (95% confidence
interval).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calculate_A</code></td>
<td>
<p>A logical argument indicating whether the returned error
information should include the A matrix and its error. Defaults to <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The output is a list containing the original matrices and matrices showing
error estimates or confidence intervals.
</p>


<h3>Value</h3>

<p>A list containing the original matrices and the error estimates (or
upper and lower confidence intervals) for the U, F and (optionally) A
matrices.
</p>


<h3>Author(s)</h3>

<p>Owen Jones <a href="mailto:jones@biology.sdu.dk">jones@biology.sdu.dk</a>
</p>


<h3>See Also</h3>

<p><code>add_mpm_error()</code> which simulates matrices with known values and
sample sizes.
</p>
<p>Other errors: 
<code>add_mpm_error()</code>,
<code>compute_ci()</code>,
<code>compute_ci_U()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Set up two submatrices
matU &lt;- matrix(c(
  0.1, 0,
  0.2, 0.4
), byrow = TRUE, nrow = 2)
matF &lt;- matrix(c(
  0, 4,
  0., 0.
), byrow = TRUE, nrow = 2)

# errors as 95% CI, with a sample size of 20 for all elements
calculate_errors(mat_U = matU, mat_F = matF, sample_size = 20, type = "CI95")

# errors as sem, with a sample size of 20 for all elements
calculate_errors(mat_U = matU, mat_F = matF, sample_size = 20, type = "sem")

# Sample size is a single matrix applied to both F and U matrices
ssMat &lt;- matrix(10, nrow = 2, ncol = 2)

calculate_errors(
  mat_U = matU, mat_F = matF, sample_size = ssMat, type =
    "sem"
)

# Sample size is a list of two matrices, one for F and one for U.
ssMats &lt;- list(
  "mat_F_ss" = matrix(10, nrow = 2, ncol = 2),
  "mat_U_ss" = matrix(10, nrow = 2, ncol = 2)
)
calculate_errors(
  mat_U = matU, mat_F = matF, sample_size = ssMats, type =
    "sem"
)

</code></pre>


</div>