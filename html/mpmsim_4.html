<div class="container">

<table style="width: 100%;"><tr>
<td>compute_ci</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute 95% confidence intervals for derived estimates from a matrix
population model</h2>

<h3>Description</h3>

<p>This function computes the 95% confidence interval for measures derived from
a matrix population model using parametric bootstrapping. In this approach a
sampling distribution of the matrix population model (MPM) is generated by
taking a large number of random independent draws using the sampling
distribution of each underlying transition rate. The approach rests on our
assumption that survival-related processes are binomial, while fecundity
is a Poisson process (see the function <code>add_mpm_error()</code> for details).
</p>


<h3>Usage</h3>

<pre><code class="language-R">compute_ci(mat_U, mat_F, sample_size, FUN, ..., n_sim = 1000, dist.out = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mat_U</code></td>
<td>
<p>A matrix that describes the growth and survival process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mat_F</code></td>
<td>
<p>A matrix that describes fecundity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample_size</code></td>
<td>
<p>either (1) a single matrix of sample sizes for each
element of the MPM, (2) a list of two named matrices ("<code>mat_F_ss</code>",
"<code>mat_U_ss</code>") containing sample sizes for the survival and fecundity
submatrices of the MPM or (3) a single value applied to the whole matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN</code></td>
<td>
<p>A function to apply to each simulated matrix population model.
This function must take, as input, a single matrix population model (i.e.,
the A matrix). For functions that require only the U matrix, use
<code>compute_ci_U</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to be passed to <code>FUN</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_sim</code></td>
<td>
<p>An integer indicating the number of simulations to run. Default
is 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist.out</code></td>
<td>
<p>Logical. If TRUE, returns a list with both the quantiles and
the simulated estimates. Default is FALSE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The inputs are the U matrix, which describes the survival-related processes,
and the F matrix which describes fecundity. The underlying assumption is
that the U matrix is the average of a binomial process while the F matrix is
the average of a Poisson process . The confidence interval will depend
largely on the sample size used.
</p>


<h3>Value</h3>

<p>If dist.out is FALSE, a numeric vector of the 2.5th and 97.5th
quantiles of the estimated measures. If <code>dist.out = TRUE</code>, a list with two
elements: <code>quantiles</code> and <code>estimates</code>. <code>quantiles</code> is a numeric vector of
the 2.5th and 97.5th quantiles of the estimated measures, and <code>estimates</code>
is a numeric vector of the estimated measures.
</p>


<h3>Author(s)</h3>

<p>Owen Jones <a href="mailto:jones@biology.sdu.dk">jones@biology.sdu.dk</a>
</p>


<h3>References</h3>

<p>Chapter 12 in Caswell, H. (2001). Matrix Population Models.
Sinauer Associates Incorporated.
</p>


<h3>See Also</h3>

<p>Other errors: 
<code>add_mpm_error()</code>,
<code>calculate_errors()</code>,
<code>compute_ci_U()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(42) # set seed for repeatability

# Data for use in example
matU &lt;- matrix(c(
  0.1, 0.0,
  0.2, 0.4
), byrow = TRUE, nrow = 2)

matF &lt;- matrix(c(
  0.0, 5.0,
  0.0, 0.0
), byrow = TRUE, nrow = 2)

set.seed(42)

# Example of use to calculate 95% CI of lambda
compute_ci(
  mat_U = matU, mat_F = matF, sample_size = 10, FUN =
    popbio::lambda
)

# Example of use to calculate 95% CI of generation time
compute_ci(
  mat_U = matU, mat_F = matF, sample_size = 40, FUN =
    popbio::generation.time
)

# Example of use to calculate 95% CI of generation time and show the
# distribution of those bootstrapped estimates
xx &lt;- compute_ci(
  mat_U = matU, mat_F = matF, sample_size = 100, FUN =
    popbio::generation.time, dist.out = TRUE
)
summary(xx$quantiles)
hist(xx$estimates)

</code></pre>


</div>