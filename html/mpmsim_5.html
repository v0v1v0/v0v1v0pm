<div class="container">

<table style="width: 100%;"><tr>
<td>compute_ci_U</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute 95% confidence intervals for derived estimates from the U submatrix
of a matrix population model</h2>

<h3>Description</h3>

<p>This function computes the 95% confidence interval for measures derived from
the U submatrix of a matrix population model using parametric bootstrapping.
In this approach a sampling distribution of the U submatrix is generated by
taking a large number of random independent draws using the sampling
distribution of each underlying transition rate. The approach rests on our
assumption that survival-related processes are binomial (see the function
<code>add_mpm_error()</code> for details).
</p>


<h3>Usage</h3>

<pre><code class="language-R">compute_ci_U(mat_U, sample_size, FUN, ..., n_sim = 1000, dist.out = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mat_U</code></td>
<td>
<p>A matrix that describes the growth and survival process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample_size</code></td>
<td>
<p>either (1) a single matrix of sample sizes for each
element of the U matrix, (2) a single value applied to the whole matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN</code></td>
<td>
<p>A function to apply to each simulated matrix population model.
This function must take, as input, a single U submatrix of a matrix
population model (i.e., the U matrix). For functions that require the A
matrix, use <code>compute_ci</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to be passed to <code>FUN</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_sim</code></td>
<td>
<p>An integer indicating the number of simulations to run. Default
is 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist.out</code></td>
<td>
<p>Logical. If TRUE, returns a list with both the quantiles and
the simulated estimates. Default is FALSE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The main inputs is the U matrix, which describes the survival-related
processes. The underlying assumption is that the U matrix is the average of a
binomial process. The confidence interval will depend largely on the sample
size used.
</p>


<h3>Value</h3>

<p>If dist.out is FALSE, a numeric vector of the 2.5th and 97.5th
quantiles of the estimated measures. If <code>dist.out = TRUE</code>, a list with two
elements: <code>quantiles</code> and <code>estimates</code>. <code>quantiles</code> is a numeric vector of
the 2.5th and 97.5th quantiles of the estimated measures, and <code>estimates</code>
is a numeric vector of the estimated measures.
</p>


<h3>Author(s)</h3>

<p>Owen Jones <a href="mailto:jones@biology.sdu.dk">jones@biology.sdu.dk</a>
</p>


<h3>References</h3>

<p>Chapter 12 in Caswell, H. (2001). Matrix Population Models.
Sinauer Associates Incorporated.
</p>


<h3>See Also</h3>

<p>Other errors: 
<code>add_mpm_error()</code>,
<code>calculate_errors()</code>,
<code>compute_ci()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(42) # set seed for repeatability

# Data for use in example
matU &lt;- matrix(c(
  0.1, 0.0,
  0.2, 0.4
), byrow = TRUE, nrow = 2)


# Example of use to calculate 95% CI of life expectancy
compute_ci_U(
  mat_U = matU, sample_size = 10, FUN =
    Rage::life_expect_mean
)

# Example of use to calculate 95% CI of generation time and show the
# distribution of those bootstrapped estimates
xx &lt;- compute_ci_U(
  mat_U = matU, sample_size = 100, FUN =
    Rage::life_expect_mean, dist.out = TRUE
)

summary(xx$quantiles)
hist(xx$estimates)

</code></pre>


</div>