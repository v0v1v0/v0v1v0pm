<div class="container">

<table style="width: 100%;"><tr>
<td>mppGE_CIM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MPP GxE Composite Interval Mapping</h2>

<h3>Description</h3>

<p>Computes multi-QTL models with cofactors along the genome using an approximate
mixed model computation. An initial variance covariance (VCOV) structure is
calculated using function from the <code>nlme</code> package. Then, this information
is used to estimate the QTL global and within parental effect significance using a
Wald test.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mppGE_CIM(
  mppData,
  trait,
  VCOV = "UN",
  VCOV_data = "unique",
  cofactors = NULL,
  cof_red = FALSE,
  cof_pval_sign = 0.1,
  window = 20,
  ref_par = NULL,
  n.cores = 1,
  maxIter = 100,
  msMaxIter = 100
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mppData</code></td>
<td>
<p>An object of class <code>mppData</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trait</code></td>
<td>
<p><code>Character vector</code> specifying which traits (environments) should be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VCOV</code></td>
<td>
<p>VCOV <code>Character</code> expression defining the type of variance
covariance structure used. 'CS' for compound symmetry assuming a unique
genetic covariance between environments. 'CSE' for cross-specific within
environment error term. 'CS_CSE' for both compound symmetry plus
cross-specific within environment error term. 'UN' for unstructured
environmental variance covariance structure allowing a specific genotypic
covariance for each pair of environments. Default = 'UN'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VCOV_data</code></td>
<td>
<p><code>Character</code> specifying if the reference VCOV should
be formed  taking all cofactors into consideration ("unique") or if different
VCOVs should be formed by removing the cofactor information that is too close
of a tested QTL position ("minus_cof"). Default = "unique"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cofactors</code></td>
<td>
<p>Object of class <code>QTLlist</code> representing a list of
selected marker positions obtained with the function <code>QTL_select()</code> or
a vector of <code>character</code> marker positions names.
Default = NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cof_red</code></td>
<td>
<p><code>Logical</code> value specifying if the cofactor matrix should
be reduced by only keeping the significant allele by environment interaction.
Default = FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cof_pval_sign</code></td>
<td>
<p><code>Numeric</code> value specifying the p-value significance
of an allele by environment term to be kept in the model. Default = 0.1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window</code></td>
<td>
<p><code>Numeric</code> distance (cM) on the left and the right of a
cofactor position where it is not included in the model. Default = 20.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref_par</code></td>
<td>
<p>Optional <code>Character</code> expression defining the parental
allele that will be used as reference for the parental model. Default = NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.cores</code></td>
<td>
<p><code>Numeric</code>. Specify here the number of cores you like to
use. Default = 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxIter</code></td>
<td>
<p>maximum number of iterations for the lme optimization algorithm.
Default = 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>msMaxIter</code></td>
<td>
<p>maximum number of iterations for the optimization step inside
the lme optimization. Default = 100.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The estimated model is the following:
</p>
<p><code class="reqn">\underline{y}_{icj} = E_{j} + C_{cj} + \sum_{qc=1}^{n_{cof}} x_{i_{qc}p} + \beta_{pj} + x_{i_{q}p} * \beta_{pj} + \underline{GE}_{icj} + \underline{e}_{icj}</code>
</p>
<p>For further details see the vignette.
</p>
<p>It is possible to calculate one initial VCOV using a null model with all
the cofactors (<code>VCOV_data = "unique"</code>) or one VCOV per combination of
cofactors (<code>VCOV_data = "minus_cof"</code>). In the later case, the cofactor
that fall witin a distance of <code>window</code> on the left and right of a QTL
position is removed for the calculation of the initial VCOV. Therefore,
N_cof + 1 VCOV are calculated.
</p>


<h3>Value</h3>

<p>Return:
</p>
<table><tr style="vertical-align: top;">
<td><code>CIM </code></td>
<td>
<p><code>Data.frame</code> of class <code>QTLprof</code>. with five columns :
1) QTL marker or in between position names; 2) chromosomes;
3) integer position indicators on the chromosome;
4) positions in centi-Morgan; and 5) -log10(p-val) of the global QTL effect
across environments 6) p-values of the within environment QTL effects
(one column per environment); and p-values of the within environment parental
QTL allelic effects (one column per parent environment combination).</p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>Vincent Garin
</p>


<h3>References</h3>

<p>Pinheiro J, Bates D, DebRoy S, Sarkar D, R Core Team (2021). nlme: Linear
and Nonlinear Mixed Effects Models_. R package version 3.1-152,
&lt;URL: https://CRAN.R-project.org/package=nlme&gt;.
</p>
<p><code>mppGE_SIM</code>,
<code>mppGE_proc</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(mppData_GE)

cofactors &lt;- mppData_GE$map$mk.names[c(35, 61)]

CIM &lt;- mppGE_CIM(mppData = mppData_GE, trait = c('DMY_CIAM', 'DMY_TUM'),
                     cofactors = cofactors, window = 20)
                     
Qpos &lt;- QTL_select(CIM)
                      
plot(CIM)

plot_allele_eff_GE(mppData = mppData_GE, nEnv = 2, EnvNames = c('CIAM', 'TUM'),
                   Qprof = CIM, Q.eff = 'par', QTL = Qpos, text.size = 14)

</code></pre>


</div>