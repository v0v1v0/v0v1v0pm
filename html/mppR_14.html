<div class="container">

<table style="width: 100%;"><tr>
<td>mppGE_proc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MPP GxE QTL analysis</h2>

<h3>Description</h3>

<p>QTL detection in MPP characterized in multiple environments.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mppGE_proc(
  pop.name = "MPP",
  trait.name = "trait1",
  mppData,
  trait,
  EnvNames = NULL,
  VCOV = "UN",
  ref_par = NULL,
  VCOV_data = "unique",
  SIM_only = FALSE,
  thre.cof = 4,
  win.cof = 50,
  cof_red = FALSE,
  cof_pval_sign = 0.1,
  window = 20,
  thre.QTL = 4,
  win.QTL = 20,
  text.size = 18,
  n.cores = 1,
  maxIter = 100,
  msMaxIter = 100,
  verbose = TRUE,
  output.loc = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pop.name</code></td>
<td>
<p><code>Character</code> name of the studied population.
Default = "MPP".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trait.name</code></td>
<td>
<p><code>Character</code> name of the studied trait.
Default = "trait1".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mppData</code></td>
<td>
<p>An object of class <code>mppData</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trait</code></td>
<td>
<p><code>Character vector</code> specifying which traits (environments) should be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EnvNames</code></td>
<td>
<p><code>character</code> expression indicating the environment or trait
labels. By default: Env_1, 2, 3, etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VCOV</code></td>
<td>
<p>VCOV <code>Character</code> expression defining the type of variance
covariance structure used. 'CS' for compound symmetry assuming a unique
genetic covariance between environments. 'CSE' for cross-specific within
environment error term. 'CS_CSE' for both compound symmetry plus
cross-specific within environment error term. 'UN' for unstructured
environmental variance covariance structure allowing a specific genotypic
covariance for each pair of environments. Default = 'UN'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref_par</code></td>
<td>
<p>Optional <code>Character</code> expression defining the parental
allele that will be used as reference for the parental model. Default = NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VCOV_data</code></td>
<td>
<p><code>Character</code> specifying if the reference VCOV of the
CIM profile computation should be formed  taking all cofactors into
consideration ("unique") or if different VCOVs should be formed by removing
the cofactor information that is too close of a tested cofactor position
("minus_cof"). Default = "unique"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SIM_only</code></td>
<td>
<p><code>Logical</code> value specifying if the procedure should
only calculate a SIM profile (no CIM). This option can be used with
large dataset to save time. Default = FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thre.cof</code></td>
<td>
<p><code>Numeric</code> value representing the -log10(p-value)
threshold above which a position can be selected as cofactor. Default = 4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>win.cof</code></td>
<td>
<p><code>Numeric</code> value in centi-Morgan representing the minimum
distance between two selected cofactors. Default = 50.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cof_red</code></td>
<td>
<p><code>Logical</code> value specifying if the cofactor matrix should
be reduced by only keeping the significant allele by environment interaction.
Default = FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cof_pval_sign</code></td>
<td>
<p><code>Numeric</code> value specifying the p-value significance
of an allele by environment term to be kept in the model. Default = 0.1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window</code></td>
<td>
<p><code>Numeric</code> distance (cM) on the left and the right of a
cofactor position where it is not included in the model. Default = 20.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thre.QTL</code></td>
<td>
<p><code>Numeric</code> value representing the -log10(p-value)
threshold above which a position can be selected as QTL. Default = 4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>win.QTL</code></td>
<td>
<p><code>Numeric</code> value in centi-Morgan representing the minimum
distance between two selected QTLs. Default = 20.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text.size</code></td>
<td>
<p><code>Numeric</code> value specifying the size of graph axis text
elements. Default = 18.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.cores</code></td>
<td>
<p><code>Numeric</code>. Specify here the number of cores you like to
use. Default = 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxIter</code></td>
<td>
<p>maximum number of iterations for the lme optimization algorithm.
Default = 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>msMaxIter</code></td>
<td>
<p>maximum number of iterations for the optimization step inside
the lme optimization. Default = 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p><code>Logical</code> value indicating if the steps of mpp_proc should
be printed. Default = TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output.loc</code></td>
<td>
<p>Path where a folder will be created to save the results.
Default = NULL.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The procedure is the following:
</p>

<ol>
<li>
<p>Simple interval mapping (SIM) to select cofactors
(<code>mppGE_SIM</code>).
</p>
</li>
<li>
<p>Composite interval mapping (CIM) with selected cofactors
(<code>mppGE_CIM</code>).
</p>
</li>
<li>
<p>Estimation of QTLs additive allelic effect
(<code>QTL_effect_GE</code>).
</p>
</li>
<li>
<p>Estimation of the global QTLs effect R squared and individual QTL effect
R squared (<code>QTL_R2_GE</code>).
</p>
</li>
</ol>
<h3>Value</h3>

<p>Return:
</p>
<p>List containing the following items:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>n.QTL</code></td>
<td>
<p>Number of detected QTLs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cofactors</code></td>
<td>
<p><code>Data.frame</code> with cofactors positions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>QTL</code></td>
<td>
<p><code>Data.frame</code> with QTL positions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q_eff</code></td>
<td>
<p><code>list</code> containing the estimated QTL allelic effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R2</code></td>
<td>
<p><code>List</code> containing R squared statistics of the QTL effects</p>
</td>
</tr>
</table>
<p>Some output files are also saved at the specified location
(<code>output.loc</code>):
</p>

<ol>
<li>
<p>The SIM and CIM results in a RData file (SIM.RData, CIM.RData).
</p>
</li>
<li>
<p>The list of cofactors (cofactors.RData).
</p>
</li>
<li>
<p>The list of QTL (QTLs.RData).
</p>
</li>
<li>
<p>The list of QTL allelic effects (QTL_effects.RData).
</p>
</li>
<li>
<p>The QTL R squared statistics (QTL_R2.RData)
</p>
</li>
<li>
<p>The number of detected QTLs and adjusted R2 (Glb_res.RData)
</p>
</li>
<li>
<p>The plot of the CIM profile (QTL_profile.pdf) with dotted vertical
lines representing the cofactors positions and the
plot of the genetic effects per cross or parents obtained with
<code>plot_allele_eff_GE</code> (gen_eff.pdf) with dashed
lines representing the QTL positions.
</p>
</li>
</ol>
<h3>Author(s)</h3>

<p>Vincent Garin
</p>


<h3>See Also</h3>

<p><code>mppGE_CIM</code>,
<code>mppGE_SIM</code>,
<code>QTL_effect_GE</code>,
<code>QTL_R2_GE</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 

data(mppData_GE)

MPP_GE_QTL &lt;- mppGE_proc(pop.name = 'EUNAM', trait.name = 'DMY',
mppData = mppData_GE, trait = c('DMY_CIAM', 'DMY_TUM'),
n.cores = 1, output.loc = tempdir())


## End(Not run)

</code></pre>


</div>