<div class="container">

<table style="width: 100%;"><tr>
<td>mpp_CV</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MPP cross-validation</h2>

<h3>Description</h3>

<p>Evaluation of MPP QTL detection procedure by cross-validation (CV).
</p>


<h3>Usage</h3>

<pre><code class="language-R">mpp_CV(
  pop.name = "MPP_CV",
  trait.name = "trait1",
  mppData,
  trait = 1,
  her = 1,
  Rep = 10,
  k = 5,
  Q.eff = "cr",
  thre.cof = 3,
  win.cof = 50,
  N.cim = 1,
  window = 20,
  thre.QTL = 3,
  win.QTL = 20,
  backward = TRUE,
  alpha.bk = 0.05,
  n.cores = 1,
  verbose = TRUE,
  output.loc
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pop.name</code></td>
<td>
<p><code>Character</code> name of the studied population.
Default = "MPP_CV".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trait.name</code></td>
<td>
<p><code>Character</code> name of the studied trait.
Default = "trait1".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mppData</code></td>
<td>
<p>An object of class <code>mppData</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trait</code></td>
<td>
<p><code>Numerical</code> or <code>character</code> indicator to specify which
trait of the <code>mppData</code> object should be used. Default = 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>her</code></td>
<td>
<p><code>Numeric</code> value between 0 and 1 representing the heritability
of the trait. <code>her</code> can be a single value or a vector specifying each
within cross heritability. Default = 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rep</code></td>
<td>
<p><code>Numeric</code> value representing the number of repetition of the
k-fold procedure. Default = 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p><code>Numeric</code> value representing the number of folds for the within
cross partition of the population. Default = 5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q.eff</code></td>
<td>
<p><code>Character</code> expression indicating the assumption concerning
the QTL effects: 1) "cr" for cross-specific; 2) "par" for parental; 3) "anc"
for ancestral; 4) "biall" for a bi-allelic. For more details see
<code>mpp_SIM</code>. Default = "cr".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thre.cof</code></td>
<td>
<p><code>Numeric</code> value representing the -log10(p-value)
threshold above which a position can be peaked as a cofactor. Default = 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>win.cof</code></td>
<td>
<p><code>Numeric</code> value in centi-Morgan representing the minimum
distance between two selected cofactors. Default = 50.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N.cim</code></td>
<td>
<p><code>Numeric</code> value specifying the number of time the CIM
analysis is repeated. Default = 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window</code></td>
<td>
<p><code>Numeric</code> distance (cM) on the left and the right of a
cofactor position where it is not included in the model. Default = 20.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thre.QTL</code></td>
<td>
<p><code>Numeric</code> value representing the -log10(p-value)
threshold above which a position can be selected as QTL. Default = 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>win.QTL</code></td>
<td>
<p><code>Numeric</code> value in centi-Morgan representing the minimum
distance between two selected QTLs. Default = 20.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>backward</code></td>
<td>
<p><code>Logical</code> value. If <code>backward = TRUE</code>,
the function performs a backward elimination on the list of selected QTLs.
Default = TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha.bk</code></td>
<td>
<p><code>Numeric</code> value indicating the significance level for
the backward elimination. Terms with p-values above this value will
iteratively be removed. Default = 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.cores</code></td>
<td>
<p><code>Numeric</code>. Specify here the number of cores you like to
use. Default = 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p><code>Logical</code> value indicating if the progresses of the CV
should be printed. Default = TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output.loc</code></td>
<td>
<p>Path where a folder will be created to save the results.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For details on the MPP QTL detection models see <code>mpp_SIM</code>
documentation. The CV scheme is adapted from Utz et al. (2000) to the MPP
context. A single CV run works like that:
</p>

<ol>
<li>
<p>Generation of a k-fold partition of the data. The partition is done
within crosses. Each cross is divided into k subsets. Then for the kth
repetition, the kth subset is used as validation set, the rest goes into the
training set.
</p>
</li>
<li>
<p>For the kth repetition, utilization of the training set for cofactor
selection and multi-QTL model determination (<code>mpp_SIM</code> and
<code>mpp_CIM</code>). If <code>backward = TRUE</code>, the final list of QTLs is
tested simultaneously using a backward elimination
(<code>mpp_back_elim</code>).
</p>
</li>
<li>
<p>Use the list of detected QTLs in the training set to calculate
the proportion of genetic variance explained by all detected QTLs in the
training set (p.ts = R2.ts/h2). Where R2.ts is the adjusted
R squared and h2 is the average within cross heritability (<code>her</code>). By
default, her = 1, which mean that
</p>
<p>For each single QTL effect, difference partial R squared are also
calculated. Difference R squared are computed by doing the difference between
a model with all QTLs and a model without the ith position. For details about R
squared computation and adjustment look at <code>QTL_R2</code>.
</p>
</li>
<li>
<p>Use the estimates of the QTL effects in the training set (B.ts) to
predict the phenotypic values of the validation set. y.pred.vs = X.vs*B.ts.
Computes the predicted R squared  in the validation set using the squared
Pearson correlation coefficient between the real values (y.vs) and the
predicted values (y.pred.vs). R2.vs = cor(y.ts,y.pred.ts)^2. Then
the predicted genetic variance in the validation set (p.vs) is equal to
p.vs = R2.vs/h2. For heritability correction, the user can provide a single
value for the average within cross heritability or a vector specifying each
within cross heritability. By default, <code>her = 1</code>, which means that the
results represent the proportion of phenotypic variance explained (predicted)
in the training (validation) sets.
</p>
<p>The predicted R squared is computed per cross and then averaged
at the population level (p.ts). Both results are returned. Partial QTL
predicted R squared are also calculated using the difference between the
predicted R squared using all QTL and the predicted R squared without QTL i.
The bias between p.ts and p.vs is calculated as bias = 1 - (p.vs/p.ts).
</p>

</li>
</ol>
<h3>Value</h3>

<p><code>List</code> containing the following results items:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>CV_res</code></td>
<td>
<p><code>Data.frame</code> containing for each CV run: 1) the number
of detected QTL; 2) the proportion of explained genetic variance in the TS
(p.ts); 3) the proportion of predicted genetic variance in the VS (p.vs) at
the population level (average of within cross prediction); the bias between
p.ts and p.vs (bias = 1-(p.vs/p.ts)).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.vs.cr</code></td>
<td>
<p><code>Matrix</code> containing the within cross p.vs for each CV run.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>QTL</code></td>
<td>
<p><code>Data.frame</code> containing: 1) the list of QTL position detected
at least one time during the entire CV process; 2) the number of times
the position has been detected; 3) the average partial p.ts of the QTL
position; 4) the average partial p.vs of the QTL position; 5) the average
partial bias of the QTL position.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>QTL.profiles</code></td>
<td>
<p><code>Data.frame</code> -log10(p-value) QTL profiles of the
different CV runs.</p>
</td>
</tr>
</table>
<p>The results elements return as R object are also saved as text
files at the specified output location (<code>output.loc</code>). A transparency
plot of the CV results (plot.pdf) is also saved.
</p>


<h3>Author(s)</h3>

<p>Vincent Garin
</p>


<h3>References</h3>

<p>Utz, H. F., Melchinger, A. E., &amp; Schon, C. C. (2000). Bias and sampling error
of the estimated proportion of genotypic variance explained by quantitative
trait loci determined from experimental data in maize using cross validation
and validation with independent samples. Genetics, 154(4), 1839-1849.
</p>


<h3>See Also</h3>

<p><code>mpp_back_elim</code>,
<code>mpp_CIM</code>,
<code>mpp_perm</code>,
<code>mpp_SIM</code>,
<code>QTL_R2</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 

data(mppData)

# Specify a location where your results will be saved
my.loc &lt;- tempdir()

CV &lt;- mpp_CV(pop.name = "USNAM", trait.name = "ULA", mppData = mppData,
her = .4, Rep = 1, k = 3, verbose = FALSE, output.loc = my.loc)


## End(Not run)

</code></pre>


</div>