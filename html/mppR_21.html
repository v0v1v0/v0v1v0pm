<div class="container">

<table style="width: 100%;"><tr>
<td>mpp_proc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MPP QTL analysis</h2>

<h3>Description</h3>

<p>Multi-parent population QTL analysis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mpp_proc(
  pop.name = "MPP",
  trait.name = "trait1",
  mppData,
  trait = 1,
  Q.eff = "cr",
  plot.gen.eff = FALSE,
  thre.cof = 3,
  win.cof = 50,
  N.cim = 1,
  window = 20,
  thre.QTL = 3,
  win.QTL = 20,
  backward = TRUE,
  alpha.bk = 0.05,
  ref.par = NULL,
  sum_zero = FALSE,
  CI = FALSE,
  drop = 1.5,
  text.size = 18,
  n.cores = 1,
  verbose = TRUE,
  output.loc
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pop.name</code></td>
<td>
<p><code>Character</code> name of the studied population.
Default = "MPP".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trait.name</code></td>
<td>
<p><code>Character</code> name of the studied trait.
Default = "trait1".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mppData</code></td>
<td>
<p>An object of class <code>mppData</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trait</code></td>
<td>
<p><code>Numerical</code> or <code>character</code> indicator to specify which
trait of the <code>mppData</code> object should be used. Default = 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q.eff</code></td>
<td>
<p><code>Character</code> expression indicating the assumption concerning
the QTL effect: 1) "cr" for cross-specific effects; 2) "par" parental
effects; 3) "anc" for an ancestral effects; 4) "biall" for a bi-allelic
effects. For more details see <code>mpp_SIM</code>. Default = "cr".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.gen.eff</code></td>
<td>
<p><code>Logical</code> value. If <code>plot.gen.eff = TRUE</code>,
the function will save the decomposed genetic effects per cross/parent.
These results can be plotted with the function <code>plot.QTLprof</code>
to visualize a genome-wide decomposition of the genetic effects.
<strong>This functionality is ony available for the cross-specific,
parental and ancestral models.</strong>
Default value = FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thre.cof</code></td>
<td>
<p><code>Numeric</code> value representing the -log10(p-value)
threshold above which a position can be peaked as a cofactor. Default = 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>win.cof</code></td>
<td>
<p><code>Numeric</code> value in centi-Morgan representing the minimum
distance between two selected cofactors. Default = 50.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N.cim</code></td>
<td>
<p><code>Numeric</code> value specifying the number of time the CIM
analysis is repeated. Default = 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window</code></td>
<td>
<p><code>Numeric</code> distance (cM) on the left and the right of a
cofactor position where it is not included in the model. Default = 20.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thre.QTL</code></td>
<td>
<p><code>Numeric</code> value representing the -log10(p-value)
threshold above which a position can be selected as QTL. Default = 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>win.QTL</code></td>
<td>
<p><code>Numeric</code> value in centi-Morgan representing the minimum
distance between two selected QTLs. Default = 20.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>backward</code></td>
<td>
<p><code>Logical</code> value. If <code>backward = TRUE</code>,
the function performs a backward elimination on the list of selected QTLs.
Default = TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha.bk</code></td>
<td>
<p><code>Numeric</code> value indicating the significance level for
the backward elimination. Terms with p-values above this value will
iteratively be removed. Default = 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref.par</code></td>
<td>
<p>Optional <code>Character</code> expression defining the parental
allele that will be used as reference to compute QTL effects for the parental
model. For the ancestral model, the ancestral class containing the reference
parent will be set as reference. <strong>This option can only be used if
the MPP design is composed of a unique connected part</strong>. Default = NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sum_zero</code></td>
<td>
<p>Optional <code>Logical</code> value specifying if the QTL effect of
a parental or an ancestral model should be calculated using the sum to zero
constraint. Default = FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI</code></td>
<td>
<p><code>Logical</code> value. If <code>CI = TRUE</code>, the function will
compute a -log10(pval) drop confidence interval for each QTL after
calculating a CIM- profile (without cofactors on the scanned chromosome).
Default = FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop</code></td>
<td>
<p><code>Numeric</code> -log10(p-value) drop value at the limits of the
interval. Default = 1.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text.size</code></td>
<td>
<p><code>Numeric</code> value specifying the size of graph axis text
elements. Default = 18.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.cores</code></td>
<td>
<p><code>Numeric</code>. Specify here the number of cores you like to
use. Default = 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p><code>Logical</code> value indicating if the steps of mpp_proc should
be printed. Default = TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output.loc</code></td>
<td>
<p>Path where a folder will be created to save the results.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function run a full MPP QTL detection using models with different possible
assumptions concerning the number of alleles at the QTL position. For more
details about the different models, see documentation of the function
<code>mpp_SIM</code>. The procedure is the following:
</p>

<ol>
<li>
<p>Simple interval mapping (SIM) to select cofactor
(<code>mpp_SIM</code>).
</p>
</li>
<li>
<p>Composite interval mapping (CIM) with selected cofactors
(<code>mpp_CIM</code>).
</p>
</li>
<li>
<p>Optional backward elimination on the list of QTL
candidates (<code>backward = TRUE</code>) (<code>mpp_back_elim</code>).
</p>
</li>
<li>
<p>Computation of the QTL genetic effects (<code>QTL_gen_effects</code>)
and proportion of the phenotypic variation explained by the QTLs (R squared)
(<code>QTL_R2</code>).
</p>
</li>
<li>
<p>Optional QTL confidence interval computation from a CIM- profile
(excluding cofactors on the scanned chromosome) (<code>argument CI=TRUE</code>).
</p>
</li>
</ol>
<h3>Value</h3>

<p>Return:
</p>
<p>List containing the following items:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>n.QTL</code></td>
<td>
<p>Number of detected QTLs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cofactors</code></td>
<td>
<p><code>Data.frame</code> with cofactors positions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>QTL</code></td>
<td>
<p><code>Data.frame</code> with QTL positions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R2</code></td>
<td>
<p><code>List</code> containing R squared statistics of the QTL effects.
For details see <code>QTL_R2</code> output section.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>QTL.effects</code></td>
<td>
<p><code>List</code> of QTLs genetic effects. For details see
<code>QTL_gen_effects</code> output section.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>QTL.CI</code></td>
<td>
<p>If <code>CI = TRUE</code>, confidence interval information of
the QTLs.</p>
</td>
</tr>
</table>
<p>Some output files are also saved at the specified location
(<code>output.loc</code>):
</p>

<ol>
<li>
<p>A QTL report (QTL_REPORT.txt) with: 1) the number of detected QTLs;
2) the global R squared statistics; 3) for each QTL, position information
(plus confidence interval if <code>CI = TRUE</code>) and estimated QTL genetic
effects per cross or parents (for details see <code>QTL_gen_effects</code>).
</p>
</li>
<li>
<p>The SIM and CIM results in a text file (SIM.txt, CIM.txt).
</p>
</li>
<li>
<p>The list of cofactors (cofactors.txt).
</p>
</li>
<li>
<p>The list of QTL (QTL.txt).
</p>
</li>
<li>
<p>The QTL R squared statistics (QTL_R2.txt) (for details see
<code>QTL_R2</code>).
</p>
</li>
<li>
<p>If <code>CI = TRUE</code>, the QTL confidence intervals (QTL_CI.txt).
</p>
</li>
<li>
<p>General results of the QTL detection process: number of QTLs and
global adjusted and non-adjusted R squared statistics (QTL_genResults.txt).
</p>
</li>
<li>
<p>The plot of the CIM profile (QTL_profile.pdf) with dotted vertical
lines representing the cofactors positions. If <code>plot.gen.eff = TRUE</code>,
plot of the genetic effects per cross or parents (gen_eff.pdf) with dashed
lines representing the QTL positions. For more details see
<code>plot.QTLprof</code>
</p>
</li>
</ol>
<h3>Author(s)</h3>

<p>Vincent Garin
</p>


<h3>See Also</h3>

<p><code>mpp_back_elim</code>,
<code>mpp_CIM</code>,
<code>mpp_perm</code>,
<code>mpp_SIM</code>,
<code>plot.QTLprof</code>,
<code>QTL_gen_effects</code>,
<code>QTL_R2</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> 

data(mppData)

# Specify a location where your results will be saved
my.loc &lt;- tempdir()

# Cross-specific model

USNAM_cr &lt;- mpp_proc(pop.name = "USNAM", trait.name = "ULA",
                     mppData = mppData, plot.gen.eff = TRUE, CI = TRUE,
                     verbose = FALSE, output.loc = my.loc)




</code></pre>


</div>