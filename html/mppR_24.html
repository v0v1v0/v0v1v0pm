<div class="container">

<table style="width: 100%;"><tr>
<td>MQE_proc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multi-QTL effect MPP analysis</h2>

<h3>Description</h3>

<p>Build multi-QTL effects (MQE) models in which different QTL effects
(cross-specific, parental, ancestral or bi-allelic) can be assumed at
different loci.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MQE_proc(
  pop.name = "MPP_MQE",
  trait.name = "trait1",
  mppData = NULL,
  trait = 1,
  Q.eff,
  ref.par = NULL,
  threshold = 4,
  window = 30,
  backward = TRUE,
  alpha.bk = 0.05,
  plot.MQE = FALSE,
  CI = FALSE,
  drop = 1.5,
  n.cores = 1,
  verbose = TRUE,
  output.loc
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pop.name</code></td>
<td>
<p><code>Character</code> name of the studied population.
Default = "MPP_MQE".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trait.name</code></td>
<td>
<p><code>Character</code> name of the studied trait.
Default = "trait1".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mppData</code></td>
<td>
<p>An object of class <code>mppData</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trait</code></td>
<td>
<p><code>Numerical</code> or <code>character</code> indicator to specify which
trait of the <code>mppData</code> object should be used. Default = 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q.eff</code></td>
<td>
<p><code>Character</code> vector of possible QTL effects the user want to
test. Elements of <code>Q.eff</code> can be "cr", "par", "anc" or "biall".
For details look at <code>mpp_SIM</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref.par</code></td>
<td>
<p>Optional <code>Character</code> expression defining the parental
allele that will be used as reference to calculate the allelic effects of 
the parental model. For the ancestral model, the ancestral class containing
the reference parent will be set as reference. <strong>This option can only
be used if the MPP design is composed of a unique connected part</strong>.
Default = NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p><code>Numeric</code> value representing the -log10(p-value)
threshold above which a position can be considered as significant.
Default = 4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window</code></td>
<td>
<p><code>Numeric</code> distance (cM) on the left and the right of a
cofactor position where it is not included in the model. Default = 30.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>backward</code></td>
<td>
<p><code>Logical</code> value. If <code>backward = TRUE</code>,
the function performs
a backward elimination on the list of selected QTLs. Default = TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha.bk</code></td>
<td>
<p><code>Numeric</code> value indicating the significance level for
the backward elimination. Default = 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.MQE</code></td>
<td>
<p><code>Logical</code> value. If <code>plot.MQE = TRUE</code>,
the function will plot the last run of the MQE model determination.
Default = FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI</code></td>
<td>
<p><code>Logical</code> value. If <code>CI = TRUE</code>, the function will
compute a -log10(pval) drop confidence interval for each QTL using
the QTL profile of the last iteration. Default = FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop</code></td>
<td>
<p><code>Numeric</code> -log10(p-value) drop value at the limits of the
interval. Default = 1.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.cores</code></td>
<td>
<p><code>Numeric</code>. Specify here the number of cores you like to
use. Default = 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p><code>Logical</code> value indicating if the steps of MQE_proc should
be printed. Default = TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output.loc</code></td>
<td>
<p>Path where a folder will be created to save the results.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The possible QTL effect that the user wants to allow must be
specified in <code>Q.eff</code>. The procedure is the following:
</p>

<ol>
<li>
<p>Forward regression to determine a MQE model with different
possible assumptions for the QTL effect at different loci. The function
use.
</p>
</li>
<li>
<p>Optional backward elimination (<code>backward = TRUE</code>) on the final
list of detected QTLs. 
</p>
</li>
<li>
<p>Estimation of the QTL genetic effects and R squared statistics.
</p>
</li>
<li>
<p>If <code>plot.MQE = TRUE</code>, plot of the last CIM run of the
forward regression.
</p>
</li>
<li>
<p>If <code>CI = TRUE</code>, confidence interval calculation based on a
CIM- (CIM without cofactor on the selected chromosome) of the last run of the
forward regression.
</p>
</li>
</ol>
<h3>Value</h3>

<p>Return:
</p>
<p><code>List</code> containing the following items:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>n.QTL</code></td>
<td>
<p>Number of detected QTLs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>QTL</code></td>
<td>
<p><code>Data.frame</code> with QTL positions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R2</code></td>
<td>
<p><code>list</code> containing R squared statistics of the QTL effects.
for details see <code>QTL_R2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>QTL.effects</code></td>
<td>
<p><code>List</code> of genetic effects per QTL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>QTL.CI</code></td>
<td>
<p>If <code>CI = TRUE</code>, confidence interval information of
the QTLs.</p>
</td>
</tr>
</table>
<p>Some output files are also saved at the location specified
(<code>output.loc</code>):
</p>

<ol>
<li>
<p>A QTL report (QTL_REPORT.txt) with: 1) the number of detected QTLs;
2) the global R squared statistics; 3) for each QTL, position information
and estimated QTL genetic effect per cross or parents.
</p>
</li>
<li>
<p>The list of QTLs (QTL.txt).
</p>
</li>
<li>
<p>The QTL R squared statistics (QTL_R2.txt) (for details see
<code>QTL_R2</code>).
</p>
</li>
<li>
<p>General results of the QTL detection process: Number of QTL and
global adjusted and non-adjusted R squared statistics. (QTL_genResults.txt).
</p>
</li>
<li>
<p>if <code>plot.MQE = TRUE</code>, a plot of the last QTL detection run profile
(plot_MQE.pdf).
</p>
</li>
<li>
<p>If <code>CI = TRUE</code>, the QTL confidence intervals (QTL_CI.txt).
</p>
</li>
</ol>
<h3>Author(s)</h3>

<p>Vincent Garin
</p>


<h3>See Also</h3>

<p><code>mpp_SIM</code>, <code>MQE_gen_effects</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 

data(mppData)

# Specify a location where your results will be saved
my.loc &lt;- tempdir()

MQE &lt;- MQE_proc(pop.name = "USNAM", trait.name = "ULA", mppData = mppData,
                Q.eff = c("par", "biall"), verbose = FALSE,
                output.loc = my.loc)
                 

## End(Not run)

</code></pre>


</div>