<div class="container">

<table style="width: 100%;"><tr>
<td>QC.mppData</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Quality control for <code>mppData</code> objects</h2>

<h3>Description</h3>

<p>Perform different operations of quality control (QC) on the marker data of an
<code>mppData</code> object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">QC.mppData(
  mppData,
  mk.miss = 0.1,
  gen.miss = 0.25,
  n.lim = 15,
  MAF.pop.lim = 0.05,
  MAF.cr.lim = NULL,
  MAF.cr.miss = TRUE,
  MAF.cr.lim2 = NULL,
  verbose = TRUE,
  n.cores = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mppData</code></td>
<td>
<p>An object of class <code>mppData</code> formed with
<code>create.mppData</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mk.miss</code></td>
<td>
<p><code>Numeric</code> maximum marker missing rate at the whole
population level comprised between 0 and 1. Default = 0.1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gen.miss</code></td>
<td>
<p><code>Numeric</code> maximum genotype missing rate at the whole
population level comprised between 0 and 1. Default = 0.25.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.lim</code></td>
<td>
<p><code>Numeric</code> value specifying the minimum cross size.
Default = 15.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MAF.pop.lim</code></td>
<td>
<p><code>Numeric</code> minimum marker minor allele frequency at
the population level. Default = 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MAF.cr.lim</code></td>
<td>
<p><code>Numeric vector</code> specifying the critical within cross
MAF. Marker with a problematic segregation rate in at least
one cross is either set as missing within the problematic cross
(<code>MAF.cr.miss = TRUE</code>), or remove from the marker matrix
(<code>MAF.cr.miss = FALSE</code>). For default value see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MAF.cr.miss</code></td>
<td>
<p><code>Logical</code> value specifying if maker with a too low
segregation rate within cross (<code>MAF.cr.lim</code>) should be put as missing
(<code>MAF.cr.miss = TRUE</code>) or discarded (<code>MAF.cr.miss = FALSE</code>).
Default = TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MAF.cr.lim2</code></td>
<td>
<p><code>Numeric</code>. Alternative option for marker MAF
filtering. Only markers segregating with a MAF larger than <code>MAF.cr.lim2</code>
in at least one cross will be kept for the analysis. Default = NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p><code>Logical</code> value indicating if the steps of the QC should
be printed. Default = TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.cores</code></td>
<td>
<p><code>Numeric</code>. Specify here the number of cores you like to
use. Default = 1.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The different operations of the quality control are the following:
</p>

<ol>
<li>
<p>Remove markers with more than two alleles.
</p>
</li>
<li>
<p>Remove markers that are monomorphic or fully missing in the parents.
</p>
</li>
<li>
<p>Remove markers with a missing rate higher than <code>mk.miss</code>.
</p>
</li>
<li>
<p>Remove genotypes with more missing markers than <code>gen.miss</code>.
</p>
</li>
<li>
<p>Remove crosses with less than <code>n.lim</code> genotypes.
</p>
</li>
<li>
<p>Keep only the most polymorphic marker when multiple markers map at the
same position. 
</p>
</li>
<li>
<p>Check marker minor allele frequency (MAF). Different strategy can be
used to control marker MAF:
</p>
<p>A) A first possibility is to filter marker based on MAF at the whole population
level using <code>MAF.pop.lim</code>, and/or on MAF within crosses using
<code>MAF.cr.lim</code>.
</p>
<p>The user can give the its own vector of critical values for MAF within cross
using <code>MAF.cr.lim</code>. By default, the within cross MAF values are defined
by the following function of the cross-size n.ci: MAF(n.ci) = 0.5 if n.ci c
[0, 10] and MAF(n.ci) = (4.5/n.ci) + 0.05 if n.ci &gt; 10. This means that up
to 10 genotypes, the critical within cross MAF is set to 50
decreases when the number of genotype increases until 5
</p>
<p>If the within cross MAF is below the limit in at least one cross, then marker
scores of the problematic cross are either put as missing
(<code>MAF.cr.miss = TRUE</code>) or the whole marker is discarded
(<code>MAF.cr.miss = FALSE</code>). By default, <code>MAF.cr.miss = TRUE</code> which
allows to include a larger number of markers and to cover a wider genetic
diversity.
</p>
<p>B) An alternative is to select only markers that segregate in at least
on cross at the <code>MAF.cr.lim2</code> rate.
</p>

</li>
</ol>
<h3>Value</h3>

<p>a filtered <code>mppData</code> object containing the the same elements
as <code>create.mppData</code> after filtering. It contains also the
following new elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>geno.id</code></td>
<td>
 <p><code>Character</code> vector of genotpes identifiers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ped.mat</code></td>
<td>
<p>Four columns <code>data.frame</code>: 1) the type of genotype:
"offspring" for the last genration and "founder" for the genotypes above
the offspring in the pedigree; 2) the genotype indicator; 3-4) the parent 1
(2) of each line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geno.par.clu</code></td>
<td>
<p>Parent marker matrix without monomorphic or completely
missing markers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>haplo.map</code></td>
<td>
<p>Genetic map corresponding to the list of marker of the
<code>geno.par.clu</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parents</code></td>
<td>
<p>List of parents.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.cr</code></td>
<td>
<p>Number of crosses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.par</code></td>
<td>
<p>Number of parents.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rem.mk</code></td>
<td>
<p>Vector of markers that have been removed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rem.geno</code></td>
<td>
<p>Vector of genotypes that have been removed.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Vincent Garin
</p>


<h3>See Also</h3>

<p><code>create.mppData</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(mppData_init)

mppData &lt;- QC.mppData(mppData = mppData_init, n.lim = 15, MAF.pop.lim = 0.05,
                      MAF.cr.miss = TRUE, mk.miss = 0.1,
                      gen.miss = 0.25, verbose = TRUE)      

</code></pre>


</div>