<div class="container">

<table style="width: 100%;"><tr>
<td>QTL_pred_R2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Predicted QTL global and partial R squared</h2>

<h3>Description</h3>

<p>Compute predicted R squared in a validation set using QTLs detected in a
training set. These values are corrected by the heritability <code>her</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">QTL_pred_R2(
  mppData.ts,
  mppData.vs,
  trait = 1,
  Q.eff = "cr",
  QTL = NULL,
  her = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mppData.ts</code></td>
<td>
<p>An object of class <code>mppData</code> for the training set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mppData.vs</code></td>
<td>
<p>An object of class <code>mppData</code> for the validation set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trait</code></td>
<td>
<p><code>Numerical</code> or <code>character</code> indicator to specify which
trait of the <code>mppData</code> object should be used. Default = 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q.eff</code></td>
<td>
<p><code>Character</code> expression indicating the assumption concerning
the QTL effects: 1) "cr" for cross-specific; 2) "par" for parental; 3) "anc"
for ancestral; 4) "biall" for a bi-allelic. For more details see
<code>mpp_SIM</code>. Default = "cr".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>QTL</code></td>
<td>
<p>Object of class <code>QTLlist</code> representing a list of
selected position obtained with the function <code>QTL_select</code> or
vector of <code>character</code> marker positions names.
Default = NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>her</code></td>
<td>
<p><code>Numeric</code> value between 0 and 1 representing the heritability
of the trait. <code>her</code> can be a single value or a vector specifying each
within cross heritability. Default = 1.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Compute QTLs predicted R squared in a validation set  (<code>mppData.vs</code>).
These QTLs have been previously detected in a training set
(<code>mppData.ts</code>). The global R squared (R2 = cor(y.ts,y.pred.ts)^2) is
obtained using the Pearson squared correlation between the observed trait
values in the validation set (y.vs) and predicted values using estimated QTL
effects in the training set (y.pred.vs = X.vs * B.ts).
</p>
<p>After that the values are corrected by the general or within cross
heritability <code>her</code>. By default <code>her = 1</code> which means that the
R squared represent the proportion of explained phenotypic variance. The
values are returned per cross (<code>R2.cr</code>) or averaged at the population
level (<code>glb.R2</code>).
</p>
<p>Partial R squared statistics are also calculated for each individual position.
The partial R squared are computed by making the difference between the
global R squared and the R squared computed without the ith position.
</p>


<h3>Value</h3>

<p>Return:
</p>
<p><code>List</code> containing the following objects:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>glb.R2 </code></td>
<td>
<p>Global predicted R squared corrected for the heritability
of all QTL terms. Doing the average of the within cross predicted R squared
(R2.cr)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R2.cr</code></td>
<td>
<p>Within cross predicted R squared corrected for the heritability</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>part.R2.diff </code></td>
<td>
<p> Vector of predicted partial R squared corrected
for the heritability doing the difference between the full model and a model
minus the ith QTL.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Vincent Garin
</p>


<h3>See Also</h3>

<p><code>QTL_R2</code>, <code>QTL_select</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(mppData)

folds &lt;- CV_partition(cross.ind = mppData$cross.ind, k = 5)

mppData.ts &lt;- subset(x = mppData, gen.list = folds[[1]]$train.set)

mppData.vs &lt;- subset(x = mppData, gen.list = folds[[1]]$val.set)

SIM &lt;- mpp_SIM(mppData = mppData)
QTL &lt;- QTL_select(SIM)

QTL_pred_R2(mppData.ts = mppData.ts, mppData.vs = mppData.vs, QTL = QTL)

</code></pre>


</div>