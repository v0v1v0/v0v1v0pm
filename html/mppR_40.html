<div class="container">

<table style="width: 100%;"><tr>
<td>QTL_R2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>QTL global and partial R squared</h2>

<h3>Description</h3>

<p>Computes the global and partial (adjusted) R squared of a  list of QTLs using
a linear model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">QTL_R2(mppData, trait = 1, QTL = NULL, Q.eff = "cr", glb.only = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mppData</code></td>
<td>
<p>An object of class <code>mppData</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trait</code></td>
<td>
<p><code>Numerical</code> or <code>character</code> indicator to specify which
trait of the <code>mppData</code> object should be used. Default = 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>QTL</code></td>
<td>
<p>Object of class <code>QTLlist</code> representing a list of
selected position obtained with the function <code>QTL_select</code> or
vector of <code>character</code> marker positions names.
Default = NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q.eff</code></td>
<td>
<p><code>Character</code> expression indicating the assumption concerning
the QTL effects: 1) "cr" for cross-specific; 2) "par" for parental; 3) "anc"
for ancestral; 4) "biall" for a bi-allelic. For more details see
<code>mpp_SIM</code>. Default = "cr".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>glb.only</code></td>
<td>
<p><code>Logical</code> value. If glb.only = TRUE, only the global and 
global adjusted R squared will be returned. Default = FALSE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function computes R squared statistics using a linear model. The extra
variance explained by a full model containing the QTL terms with respect
to a reduced model containing only the cross intercept terms and uses the
ratio between the residual sum of square of these two models:
R2 = 1-(RSS(f))/(RSS(r)).
</p>
<p>Partial R squared for each individual QTL position can also be calculated.
Two types of partial R squared are returned. The first one
uses the difference between the R squared obtained with all QTL
positions and the R squared obtain with all position minus the ith one
(difference R squared). The second method used only the ith QTL position
in the model (single R squared).
</p>
<p>For both global and partial R squared, it is possible to obtained adjusted
measurements taking the number of degrees of freedom into consideration using
an adaptation of the formula given by Utz et al. (2000):
R.adj = R-(z/(N-z-n.cr))*(1-R) where z is the total
number of estimated components of the genetic effect. N is the total number
of phenotypic information, and n.cr is the number of intercept (cross) terms.
</p>


<h3>Value</h3>

<p>Return:
</p>
<p>object of class <code>QR2Res</code> containing the following objects:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>glb.R2 </code></td>
<td>
<p> Global R squared of all QTL terms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>glb.adj.R2 </code></td>
<td>
<p> Global adjusted R squared of all QTL terms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>part.R2.diff </code></td>
<td>
<p> Vector of partial R squared doing
the difference between the full model and a model minus the ith QTL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>part.adj.R2.diff </code></td>
<td>
<p> Vector of partial adjusted R squared doing
the difference between the full model and a model minus the ith QTL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>part.R2.sg </code></td>
<td>
<p> Vector of partial R squared using only the ith QTL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>part.adj.R2.sg </code></td>
<td>
<p> Vector of partial adjusted R squared using only the
ith QTL.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Vincent Garin
</p>


<h3>References</h3>

<p>Utz, H. F., Melchinger, A. E., &amp; Schon, C. C. (2000). Bias and sampling error
of the estimated proportion of genotypic variance explained by quantitative
trait loci determined from experimental data in maize using cross validation
and validation with independent samples. Genetics, 154(4), 1839-1849.
</p>


<h3>See Also</h3>

<p><code>QTL_select</code>, <code>summary.QR2Res</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(mppData)

SIM &lt;- mpp_SIM(mppData)
QTL &lt;- QTL_select(Qprof = SIM, threshold = 3, window = 20)
Q_R2 &lt;- QTL_R2(mppData = mppData, QTL = QTL, Q.eff = "cr")
summary(Q_R2)


</code></pre>


</div>