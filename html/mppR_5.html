<div class="container">

<table style="width: 100%;"><tr>
<td>IBD.mppData</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>IBD coding for <code>mppData</code> objects</h2>

<h3>Description</h3>

<p>The function first converts genotype data into ABH format. Then it calculates
within cross identical by descent (IBD) probabilities.
</p>


<h3>Usage</h3>

<pre><code class="language-R">IBD.mppData(
  mppData,
  het.miss.par = TRUE,
  subcross.ind = NULL,
  par.per.subcross = NULL,
  type,
  F.gen = NULL,
  BC.gen = NULL,
  type.mating = NULL,
  error.prob = 1e-04,
  map.function = "haldane"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mppData</code></td>
<td>
<p>An object of class <code>mppData</code>. the <code>mppData</code> must
have been processed using: <code>create.mppData</code>,
<code>QC.mppData</code>, and <code>IBS.mppData</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>het.miss.par</code></td>
<td>
<p><code>Logical</code> value. if <code>het.miss.par = TRUE</code>,
the function will use the offspring segregation to try to infer the allele
that was transmitted by the heterozygous or missing parent at a particular
locus to make the ABH conversion. Default = TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subcross.ind</code></td>
<td>
<p>Optional <code>character</code> vector specifying to which
sub-cross each genotype belong. Default = NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par.per.subcross</code></td>
<td>
<p>Optional three columns <code>Character matrix</code>
specifying : 1) the sub-cross indicators; 2) the parents 1 identifiers
of the sub-crosses; 3) the parents 2 identifiers of the sub-crosses.
Default = NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p><code>Character</code> indicator for the type of population analyzed:
type = "F" for Fn (F cross n generations); type = "BC" for BCn (backcross
n generations); type = "BCsFt" for backcross followed by selfing;
type = "DH" for double haploids; and type = "RIL"
for recombinant inbred lines. For RIL type specify if the population was
obtain using selfing or sibling mating using <code>type.mating</code>.
If type = "RIL" or "DH", the function does not assume heterozygous marker
scores for these populations and convert them into missing (NA).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>F.gen</code></td>
<td>
<p><code>Numeric</code> integer representing the number of F generations.
For example F.gen = 2 for F2. Default = NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BC.gen</code></td>
<td>
<p><code>Numeric</code> integer representing the number of
backcross generations. For example BC.gen = 1 for single backcross.
Default = NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type.mating</code></td>
<td>
<p><code>Character</code> specifying for a RIL population if it was
obtained by selfing ("selfing") or by sibling mating ("sib.mat").
Default = NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error.prob</code></td>
<td>
<p><code>Numeric</code> value for assumed genotyping error rate
used in the calculation of the penetrance Pr(observed genotype | true genotype).
Default = 0.0001.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>map.function</code></td>
<td>
<p><code>Character</code> expression specifying the type of map
function used to infer the IBD probabilities. possibility to choose
between "haldane", "kosambi","c-f","morgan". Default = "haldane".</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function first transforms genotype data into within cross ABH format.
The function takes the parents of the different cross as
reference and assigns the following scores: "A" if the offspring score is
equivalent to parent 1; "B" if it is equivalent to parent 2; "H" if it is
heterozygous. The function attributes NA for missing when: 1) the offspring
score is missing; 2) the two parents have the same score; or
3) when at least one parental score is missing.
</p>
<p>If a parent score is heterozygous or missing (<code>het.miss.par = TRUE</code>),
the assignment rules are the following. If the two parents are
heterozygous or one parent is heterozygous and the other missing, the
offspring get NA since the parental origin can not be inferred with certainty.
If one parent is heterozygous or missing and the second parent is
homozygous, the function looks at offspring segregating pattern to
infer which allele was transmitted by the heterozygous parent. If this is
possible we consider the heteroxzygous parent as homozygous for the
transmitted allele and use this allele score for ABH assignment.
</p>
<p>The ABH assignment can be performed using sub-cross structure providing
information about sub-cross in arguments <code>subcross.ind</code> and
<code>par.per.subcross</code>. 
</p>
<p>Then the function calculates the IBD probabilities using <code>read.cross()</code>
and <code>calc.genoprob()</code> functions from the R/qtl package
(Broman et al. 2009).
</p>
<p>The type of population must be specified in argument <cite>type</cite>. Different
population types are possible: F-type ('F'), back-cross ('BC'), backcross
followed by selfing ('BCsFt'), double haploid ('DH'), and recombinant imbred
lines ('RIL'). The number of F and BC generations can be specified using
<code>F.gen</code> and <code>BC.gen</code>. The argument <code>type.mating</code> specifies if
F and RIL populations were obtained by selfing or by sibling mating.
</p>
<p>DH and RIL populations are read as back-cross by R/qtl. For these two
population types, heterozygous scores will be treated as missing values.
</p>


<h3>Value</h3>

<p>an increased <code>mppData</code> object containing the the same elements
as the <code>mppData</code> object provided as argument and the
following new elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>geno.IBD</code></td>
<td>
<p>A R/qtl <code>cross.object</code> containing the IBD probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.zigo</code></td>
<td>
<p><code>Numeric</code> value Indicating the number of different
genotypes: 2 (AA/BB) or 3 (AA/AB/BB)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p><code>Character</code> expression indicating the type of population.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Vincent Garin
</p>


<h3>References</h3>

<p>Broman KW, Wu H, Sen S, Churchill GA (2003) R/qtl: QTL mapping
in experimental crosses. Bioinformatics 19:889-890.
</p>
<p>Broman, K. W., &amp; Sen, S. (2009). A Guide to QTL Mapping with R/qtl (Vol. 46).
New York: Springer.
</p>


<h3>See Also</h3>

<p><code>create.mppData</code>, <code>QC.mppData</code>,
<code>IBS.mppData</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(mppData_init)

mppData &lt;- QC.mppData(mppData_init)
mppData &lt;- IBS.mppData(mppData = mppData)

mppData &lt;- IBD.mppData(mppData = mppData, het.miss.par = TRUE, type = 'RIL',
                       type.mating = 'selfing')


</code></pre>


</div>