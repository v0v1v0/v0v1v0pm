<div class="container">

<table style="width: 100%;"><tr>
<td>mpr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fitting a Multi-Parameter Regression (MPR) model.
</h2>

<h3>Description</h3>

<p>Fits a Multi-Parameter Regression (MPR) model using a Newton-type algorithm via the <code>nlm</code>
function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mpr(formula, data, family = "Weibull", init, iterlim = 1000, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>

<p>a two-sided <code>formula</code> object with the response on the left hand side of the <code>~</code> operator
and a <code>list</code> of one-sided <code>formula</code> objects on the right hand side (one for each
regression component in the <code>mpr</code> model). The response must be a right-censored survival object
as returned by the <code>Surv</code> function. See “Details” for more information on the struture of
the formula within the <code>mpr</code> function as it differs from standard regression models.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>an optional <code>data.frame</code> containing the variables in the model. If missing, the variables are 
taken from the <code>environment</code> from which <code>mpr</code> is called.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>

<p>the name of the parametric distribution to be used in the model. See <code>distributions</code> for the 
list of distributions currently available.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>

<p>an optional vector of initial values for the optimisation routine. If missing, default values
are used. One may also set <code>init="random"</code> to randomly generate initial values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterlim</code></td>
<td>

<p>a positive integer specifying the maximum number of iterations to be performed before the
optimisation procedure is terminated. This is supplied to <code>nlm</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>additional arguments to be passed to <code>nlm</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Multi-Parameter Regression (MPR) models are generated by allowing <em>multiple</em> distributional parameters
to depend on covariates, for example, both the scale and shape parameters. This is in contrast to the
more typical approach where covariates enter a model only through <em>one</em> distributional parameter. As 
these standard models have a single regression component, we may refer to them as Single Parameter
Regression (SPR) models and, clearly, they are special cases of MPR models. The parameter through
which covariates enter such SPR models may be referred to as the “interest” parameter since it 
generally has some specific subject-matter importance. However, this standard approach neglects other
parameters which
may also be important in describing the phenomenon at hand. The MPR approach generalises the standard
SPR approach by viewing all distributional parameters as interest parameters in which covariate effects
can be investigated.
</p>
<p>In the context of survival analysis (currently the focus of the <code>mpr</code> package), the Weibull model
is one of the most popular parametric models. Its hazard function is given by
</p>
<p style="text-align: center;"><code class="reqn">
 h(t) = \lambda \gamma t^{\gamma - 1} </code>
</p>

<p>where <code class="reqn">\lambda &gt; 0</code>, the scale parameter, controls the overall magnitude of <code class="reqn">h(t)</code> and
<code class="reqn">\gamma &gt; 0</code>, the shape parameter, controls its time evolution. In the standard SPR Weibull model,
<code class="reqn">\lambda</code> depends on covariates via <code class="reqn">\log \lambda = x^T \beta</code> leading to a
proportional hazards (PH) model. The MPR model generalises this by allowing <em>both</em> parameters to
depend on covariates as follows
</p>
<p style="text-align: center;"><code class="reqn">\log \lambda = x^T \beta</code>
</p>

<p style="text-align: center;"><code class="reqn">\log \gamma = z^T \alpha</code>
</p>

<p>where <code class="reqn">x</code> and <code class="reqn">z</code> are the scale and shape covariate vectors (which may or may not
contain covariates in common) and <code class="reqn">\beta</code> and <code class="reqn">\alpha</code> are the corresponding
regression coefficients.
</p>
<p>Note that the log-link is used above to ensure positivity of the parameters. More generally, we may
have
</p>
<p style="text-align: center;"><code class="reqn">g_1(\lambda) = x^T \beta</code>
</p>

<p style="text-align: center;"><code class="reqn">g_2(\gamma) = z^T \alpha</code>
</p>

<p>where <code class="reqn">g_1(\cdot)</code> and <code class="reqn">g_2(\cdot)</code> are appropriate link functions.
The <code>mpr</code> function does not
allow the user to alter these link functions but, rather, uses the following default link functions:
<b>log-link</b> (for parameters which must be <em>positive</em>) and <b>identity-link</b> (for parameters
which are <em>unconstrained</em>). Although the two-parameter Weibull distribution is discussed here
(due to its popularity), other distributions may have additional shape parameters, for example,
</p>
<p style="text-align: center;"><code class="reqn">g_3(\rho) = w^T \tau</code>
</p>

<p>where <code class="reqn">w</code> and <code class="reqn">\tau</code> are the vectors of covariates and regression coefficients for this
additional shape component. See <code>distributions</code> for further details on the distributions
currently available.
</p>
<p>The struture of the <code>formula</code> within the <code>mpr</code> function is, for example,
<code>Surv(time, status) ~ list(~ x1 + x2, ~ x1)</code> which clearly generalises the typical <code>formula</code> used in
standard models (i.e., those with only one regression component) in the sense that the right hand side is a
<code>list</code> of one-sided <code>formula</code> objects. Note the requirement that the <code>~</code> operator
precedes each element within the <code>list</code>. Specifically, the example shown here represents the case
where the covariates <code>x1</code> and <code>x2</code> appear in the first regression component, <code class="reqn">\lambda</code>,
and the covariate <code>x2</code> appears in the second regression component, <code class="reqn">\gamma</code>. If there was a
third regression component, <code class="reqn">\rho</code>, then there would be an additional component in the <code>list</code>,
for example, <code>Surv(time, status) ~ list(~ x1 + x2, ~ x1, ~ x1)</code>. The <code>mpr</code> function also accepts
more typical two-sided <code>formula</code> objects, such as <code>Surv(time, status) ~ x1 + x2</code>, which imply that
the terms on the right hand side appear in <em>each</em> of the regression components.
</p>


<h3>Value</h3>

<p><code>mpr</code> returns an object of class “<code>mpr</code>”.
</p>
<p>The function <code>summary</code> (i.e., <code>summary.mpr</code>) can be used to obtain and print a summary
of the results. The the generic accessor function <code>coefficients</code> extracts the <code>list</code> of
regression coefficient vectors. One can also apply <code>predict</code> (i.e., <code>predict.mpr</code>) to
predict various quantites from the fitted <code>mpr</code> model. A stepwise variable selection procedure has
been implemented for <code>mpr</code> models - see <code>stepmpr</code>.
</p>
<p>An object of class <code>mpr</code> is a <code>list</code> containing the following components: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>a <code>data.frame</code> containing useful information about the fitted model with the following headings:
</p>

<dl>
<dt><code>family</code></dt>
<dd>
<p>the chosen <code>distribution</code>.
</p>
</dd>
<dt><code>npar</code></dt>
<dd>
<p>number of estimated parameters in the fitted model.
</p>
</dd>
<dt><code>loglike</code></dt>
<dd>
<p>value of the log-likelihood.
</p>
</dd>
<dt><code>aic</code></dt>
<dd>
<p>value of the AIC (Akaike Information Criterion).
</p>
</dd>
<dt><code>bic</code></dt>
<dd>
<p>value of the BIC (Bayesian Information Criterion).
</p>
</dd>
<dt><code>code</code></dt>
<dd>
<p>an integer indicating why the Newton optimisation procedure terminated (for more
details on this stop-code see <code>nlm</code>) where, in particular, “<code>1</code>” means
“relative gradient is close to zero”. 
</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>

<p>a <code>list</code> whose elements are named vectors of coefficients (one vector per regression component).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov</code></td>
<td>

<p>the variance-covariance matrix for the estimates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gradient</code></td>
<td>

<p>the values of the (negative) score functions from <code>nlm</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncomp</code></td>
<td>

<p>the number of regression components in the model, i.e., the number of distributional parameters in the 
underlying <code>distribution</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>

<p>the <code>formula</code> supplied.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xvars</code></td>
<td>

<p>a record of the names of all variables (i.e., covariates) used in fitting.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlevels</code></td>
<td>

<p>a record of the levels of any <code>factors</code> (i.e., categorical variables) used in fitting.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>

<p>the matched call.
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Kevin Burke.
</p>


<h3>See Also</h3>

<p><code>distributions</code>, <code>summary.mpr</code>, <code>predict.mpr</code>,
<code>stepmpr</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Veterans' administration lung cancer data
veteran &lt;- survival::veteran
head(veteran)

# treatment variable, "trt", in scale (lambda) and shape (gamma)
# components of a Weibull model
mpr(Surv(time, status) ~ list(~ trt, ~ trt), data=veteran, family="Weibull")

# same as first model
mpr(Surv(time, status) ~ trt, data=veteran, family="Weibull")

# now with "celltype" also appearing in the scale
mpr(Surv(time, status) ~ list(~ trt + celltype, ~ trt), data=veteran,
    family="Weibull")

# trt in scale only (this is a PH Weibull model)
mpr(Surv(time, status) ~ list(~ trt, ~ 1), data=veteran, family="Weibull")

# trt in all three components (scale and two shape parameters) of a Burr model
mpr(Surv(time, status) ~ list(~ trt, ~ trt, ~ trt), data=veteran,
    family="Burr")

# use of summary
mod1 &lt;- mpr(Surv(time, status) ~ list(~ trt, ~ trt), data=veteran)
summary(mod1)
</code></pre>


</div>