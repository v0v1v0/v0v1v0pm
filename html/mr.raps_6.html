<div class="container">

<table style="width: 100%;"><tr>
<td>mr.raps</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Main function</h2>

<h3>Description</h3>

<p><code>mr.raps</code> is the main function.
</p>
<p><code>mr.raps.all</code>: Quick analysis with all six methods
</p>
<p><code>mr.raps.simple</code>: No overdispersion, l2 loss
</p>
<p><code>mr.raps.overdispersed</code>: Overdispersion, l2 loss
</p>
<p><code>mr.raps.simple.robust</code>: No overdispersion, robust loss
</p>
<p><code>mr.raps.overdispersed.robust</code>: Overdispersed, robust loss
</p>


<h3>Usage</h3>

<pre><code class="language-R">mr.raps(b_exp, b_out, se_exp, se_out, over.dispersion = FALSE,
  loss.function = c("l2", "huber", "tukey"), diagnosis = FALSE,
  se.method = c("sandwich", "bootstrap"), k = switch(loss.function[1], l2 =
  NULL, huber = 1.345, tukey = 4.685), B = 1000, suppress.warning = FALSE)

mr.raps.all(b_exp, b_out, se_exp, se_out)

mr.raps.simple(b_exp, b_out, se_exp, se_out, diagnosis = FALSE)

mr.raps.overdispersed(b_exp, b_out, se_exp, se_out,
  initialization = c("simple", "mode"), suppress.warning = FALSE,
  diagnosis = FALSE, niter = 20, tol = .Machine$double.eps^0.5)

mr.raps.simple.robust(b_exp, b_out, se_exp, se_out, loss.function = c("huber",
  "tukey"), k = switch(loss.function[1], huber = 1.345, tukey = 4.685),
  diagnosis = FALSE)

mr.raps.overdispersed.robust(b_exp, b_out, se_exp, se_out,
  loss.function = c("huber", "tukey"), k = switch(loss.function[1], huber =
  1.345, tukey = 4.685), initialization = c("l2", "mode"),
  suppress.warning = FALSE, diagnosis = FALSE, niter = 20,
  tol = .Machine$double.eps^0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>b_exp</code></td>
<td>
<p>A vector of SNP effects on the exposure variable, usually obtained from a GWAS.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b_out</code></td>
<td>
<p>A vector of SNP effects on the outcome variable, usually obtained from a GWAS.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se_exp</code></td>
<td>
<p>A vector of standard errors of <code>b_exp</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se_out</code></td>
<td>
<p>A vector of standard errors of <code>b_out</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>over.dispersion</code></td>
<td>
<p>Should the model consider overdispersion (systematic pleiotropy)? Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loss.function</code></td>
<td>
<p>Either the squared error loss (<code>l2</code>) or robust loss functions/scores (<code>huber</code> or <code>tukey</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diagnosis</code></td>
<td>
<p>Should the function returns diagnostic plots and results? Default is FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.method</code></td>
<td>
<p>How should the standard error be estimated? Either by sandwich variance formula (default and recommended) or the bootstrap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Threshold parameter in the Huber and Tukey loss functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Number of bootstrap resamples</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>suppress.warning</code></td>
<td>
<p>Should warning messages be suppressed?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initialization</code></td>
<td>
<p>Method to initialize the robust estimator. "Mode" is not supported currently.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter</code></td>
<td>
<p>Maximum number of interations to solve the estimating equations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Numerical precision.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list
</p>

<dl>
<dt>beta.hat</dt>
<dd>
<p>Estimated causal effect</p>
</dd>
<dt>beta.se</dt>
<dd>
<p>Standard error of <code>beta.hat</code></p>
</dd>
<dt>beta.p.value</dt>
<dd>
<p>Two-sided p-value of <code>beta.hat</code></p>
</dd>
<dt>tau2.hat</dt>
<dd>
<p>Overdispersion parameter if <code>over.dispersion = TRUE</code></p>
</dd>
<dt>tau2.se</dt>
<dd>
<p>Standard error of <code>tau2.hat</code></p>
</dd>
<dt>std.resid</dt>
<dd>
<p>Standardized residuals of each SNP, returned if <code>diagnosis = TRUE</code></p>
</dd>
<dt>beta.hat.loo</dt>
<dd>
<p>Leave-one-out estimates of <code>beta.hat</code>, returned if <code>diagnosis = TRUE</code></p>
</dd>
<dt>beta.hat.bootstrap</dt>
<dd>
<p>Median of the bootstrap estimates, returned if <code>se.method = "bootstrap"</code></p>
</dd>
<dt>beta.se.bootstrap</dt>
<dd>
<p>Median absolute deviation of the bootstrap estimates, returned if <code>se.method = "bootstrap"</code></p>
</dd>
</dl>
<h3>Functions</h3>


<ul>
<li> <p><code>mr.raps.all</code>: 
</p>
</li>
<li> <p><code>mr.raps.simple</code>: 
</p>
</li>
<li> <p><code>mr.raps.overdispersed</code>: 
</p>
</li>
<li> <p><code>mr.raps.simple.robust</code>: 
</p>
</li>
<li> <p><code>mr.raps.overdispersed.robust</code>: 
</p>
</li>
</ul>
<h3>References</h3>

<p>Qingyuan Zhao, Jingshu Wang, Jack Bowden, Dylan S. Small. Statistical inference in two-sample summary-data Mendelian randomization using robust adjusted profile score. <a href="https://arxiv.org/abs/1801.09652">https://arxiv.org/abs/1801.09652</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(bmi.sbp)
attach(bmi.sbp)

## All estimators
mr.raps.all(beta.exposure, beta.outcome, se.exposure, se.outcome)

## Diagnostic plots
res &lt;- mr.raps(beta.exposure, beta.outcome, se.exposure, se.outcome,
diagnosis = TRUE)
res &lt;- mr.raps(beta.exposure, beta.outcome, se.exposure, se.outcome,
TRUE, diagnosis = TRUE)
res &lt;- mr.raps(beta.exposure, beta.outcome, se.exposure, se.outcome,
TRUE, "tukey", diagnosis = TRUE)

detach(bmi.sbp)

data(bmi.bmi)
attach(bmi.bmi)

## Because both the exposure and the outcome are BMI, the true "causal" effect should be 1.

## All estimators
mr.raps.all(beta.exposure, beta.outcome, se.exposure, se.outcome)

detach(bmi.bmi)

</code></pre>


</div>