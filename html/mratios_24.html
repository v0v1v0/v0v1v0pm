<div class="container">

<table style="width: 100%;"><tr>
<td>sci.ratioVH</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Approximate simultaneous confidence intervals for ratios of means when variances are heterogeneous </h2>

<h3>Description</h3>

<p>This function constructs simultaneous confidence intervals for ratios of linear combinations of normal means in a one-way model,
allowing that the variances differ among groups. Different methods are available for multiplicity adjustment.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sci.ratioVH(formula, data,
 type = "Dunnett", base = 1, method = "Plug",
 Num.Contrast = NULL, Den.Contrast = NULL,
 alternative = "two.sided", conf.level = 0.95,
 names = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p> A formula specifying a numerical response and a grouping factor as e.g. response ~ treatment </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>  A dataframe containing the response and group variable </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p> type of contrast, with the following options:
</p>

<ul>
<li>
<p>"Dunnett": many-to-one comparisons, with control in the denominator
</p>
</li>
<li>
<p>"Tukey": all-pair comparisons 
</p>
</li>
<li>
<p>"Sequen": comparison of consecutive groups, where the group with lower order is the denominator
</p>
</li>
<li>
<p>"AVE": comparison of each group with average of all others, where the average is taken as denominator
</p>
</li>
<li>
<p>"Changepoint": ratio of averages of groups of higher order divided by averages of groups of lower order 
</p>
</li>
<li>
<p>"Marcus": Marcus contrasts as ratios 
</p>
</li>
<li>
<p>"McDermott": McDermott contrasts as ratios 
</p>
</li>
<li>
<p>"Williams": Williams contrasts as ratios 
</p>
</li>
</ul>
<p>Note: type is ignored, if Num.Contrast and Den.Contrast are specified by the user (See below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base</code></td>
<td>
<p> a single integer specifying the control (i.e. denominator) group for the Dunnett contrasts, ignored otherwise </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
 
<p>a character string, specifying the method to be used for confidence interval construction:
</p>

<ul>
<li>
<p>"Plug": Plug-in of ratio estimates to obtain the correlation matrix of contrasts (default)
</p>
</li>
<li>
<p>"Bonf": Simple Bonferroni-adjustment of Fieller confidence intervals for the ratios 
</p>
</li>
<li>
<p>"MtI": Sidak- or Slepian- adjustment for two-sided and one-sided confidence intervals, respectively  
</p>
</li>
<li>
<p>"Unadj": Unadjusted Fieller confidence intervals for the ratios (i.e. with comparisonwise confidence level = conf.level) </p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Num.Contrast</code></td>
<td>
<p> Numerator contrast matrix, where columns correspond to groups and rows correspond to contrasts  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Den.Contrast</code></td>
<td>
<p> Denominator contrast matrix, where columns correspond to groups and rows correspond to contrasts </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
 
<p>a character string
</p>

<ul>
<li>
<p>"two.sided": for two-sided intervals 
</p>
</li>
<li>
<p>"less": for upper confidence limits 
</p>
</li>
<li>
<p>"greater": for lower confidence limits </p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p> simultaneous confidence level in case of method="Plug","Bonf", or "MtI", and comparisonwise confidence level in case of method="Unadj" </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names</code></td>
<td>
<p>logical, indicating whether rownames of the contrast matrices shall be retained in the output</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given a one-way ANOVA model, the interest is in simultaneous confidence intervals for several ratios of
linear combinations of the treatment means. It is assumed that the responses are normally distributed
with possibly heterogeneous variances. Multivariate t-distributions are applied with a correlation matrix
depending on the unknown ratios and sample variances and degress of freedom according to Satterthwaite
(1946).
</p>
<p>Using <kbd>method="Unadj"</kbd> results in the methods described in Hasler, Vonk and Hothorn (2007).
</p>


<h3>Value</h3>

<p>An object of class "sci.ratio", containing a list with elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>estimate </code></td>
<td>
<p> the point estimates of the ratios</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CorrMat.est </code></td>
<td>
<p>the estimated correlation matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Num.Contrast </code></td>
<td>
<p>matrix of contrasts used for the numerator of ratios</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Den.Contrast </code></td>
<td>
<p>matrix of contrasts used for the denominator of ratios</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.int </code></td>
<td>
<p>the estimated confidence intervals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NSD </code></td>
<td>
<p>a logical indicating whether any denominator occured, which were not significantly difference from 0</p>
</td>
</tr>
</table>
<p>and some of the input arguments.
</p>


<h3>Author(s)</h3>

<p> Mario Hasler</p>


<h3>References</h3>

 
<p>Simultaneous confidence intervals:
</p>
<p><em>Hasler, M. and Hothorn, L.A. (2008).</em>
Multiple contrast tests in the presence of heteroscedasticity.
<em> Biometrical Journal 50, 793-800.</em>
</p>
<p>Marginal (unadjusted) confidence intervals:
</p>
<p><em>Hasler M, Vonk R, Hothorn LA (2007).</em>
Assessing non-inferiority of a new treatment in a three-arm trial in the presence of heteroscedasticity.
<em> Statistics in Medicine 27, 490-503.</em>
</p>
<p><em>Satterthwaite, FE (1946).</em>
An approximate distribution of estimates of variance components. 
<em>Biometrics 2, 110-114.</em>
</p>


<h3>See Also</h3>

 <p>plot.sci.ratio for plots of confidence intervals and simtest.ratioVH for raw and multiplicity-adjusted p-values </p>


<h3>Examples</h3>

<pre><code class="language-R">
data(Mutagenicity, package="mratios")

boxplot(MN~Treatment, data=Mutagenicity)

# Unless it is hard to assume Gaussian distribution
# in this example this is an attempt to take
# heterogeneous variances into account.

# Comparisons to the vehicle control,
# Proof of Hazard, using multiplicity adjusted 
# confidence intervals:

## Not run: 

sci.ratioVH(MN~Treatment, data=Mutagenicity,
 type="Dunnett", base=6, method="Plug")


# Unadjusted confidence intervals for an 
# intersection union test to proof safety
# for all doses of the compound.

sci.ratioVH(MN~Treatment, data=Mutagenicity,
 type="Dunnett", base=6, method="Unadj", alternative="less")


# # # # 

# User-defined contrasts:

# Mutagenicity of the doses of the new compound,
# expressed as ratio (DoseX-Vehicle)/(Cyclo25-Vehicle):

# Check the order of the factor levels:

levels(Mutagenicity$Treatment)

# numerators:

NC&lt;-rbind(
"Hydro30-Vehicle"=c(0,0,1,0,0,-1),
"Hydro50-Vehicle"=c(0,0,0,1,0,-1),
"Hydro75-Vehicle"=c(0,0,0,0,1,-1),
"Hydro100-Vehicle"=c(0,1,0,0,0,-1)
)

DC&lt;-rbind(
"Cyclo25-Vehicle"=c(1,0,0,0,0,-1),
"Cyclo25-Vehicle"=c(1,0,0,0,0,-1),
"Cyclo25-Vehicle"=c(1,0,0,0,0,-1),
"Cyclo25-Vehicle"=c(1,0,0,0,0,-1)
)

colnames(NC)&lt;-colnames(DC)&lt;-levels(Mutagenicity$Treatment)

NC

DC



CIs&lt;-sci.ratioVH(MN~Treatment, data=Mutagenicity,
 Num.Contrast=NC,
 Den.Contrast=DC)

# # # #

# Unadjusted confidence intervals for multiple ratios
# of means assuming heterogeneous group variances.
# The following code produces the results given in Table
# V of Hasler, Vonk and Hothorn (2007).
# The upper confidence limits in Table V can produced
# by calling:

sci.ratioVH(formula=MN~Treatment, data=Mutagenicity,
 Num.Contrast=NC, Den.Contrast=DC,
 method="Unadj", alternative="less", conf.level=0.95)

## End(Not run)

</code></pre>


</div>