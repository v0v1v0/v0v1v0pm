<div class="container">

<table style="width: 100%;"><tr>
<td>simtest.ratio</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Simultaneous tests for ratios of normal means  </h2>

<h3>Description</h3>

<p>Performs simultaneous tests for several ratios of linear combinations of treatment means in the normal one-way ANOVA model with homogeneous variances.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simtest.ratio(formula, data, type = "Dunnett", base = 1,
 alternative = "two.sided", Margin.vec = NULL, FWER = 0.05,
 Num.Contrast = NULL, Den.Contrast = NULL, names = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p> A formula specifying a numerical response and a grouping factor (e.g., response ~ treatment) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>  A dataframe containing the response and group variable </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p> type of contrast, with the following options:
</p>

<ul>
<li> <p><b>"Dunnett":</b> many-to-one comparisons, with control in the denominator
</p>
</li>
<li> <p><b>"Tukey":</b> all-pair comparisons 
</p>
</li>
<li> <p><b>"Sequen":</b> comparison of consecutive groups, where the group with lower order is the denomniator
</p>
</li>
<li> <p><b>"AVE":</b> comparison of each group with average of all others, where the average is taken as denominator
</p>
</li>
<li> <p><b>"GrandMean":</b> comparison of each group with grand mean of all groups, where the grand mean is taken as denominator
</p>
</li>
<li> <p><b>"Changepoint":</b> ratio of averages of groups of higher order divided by averages of groups of lower order 
</p>
</li>
<li> <p><b>"Marcus":</b> Marcus contrasts as ratios 
</p>
</li>
<li> <p><b>"McDermott":</b> McDermott contrasts as ratios 
</p>
</li>
<li> <p><b>"Williams":</b> Williams contrasts as ratios 
</p>
</li>
<li> <p><b>"UmbrellaWilliams":</b> Umbrella-protected Williams contrasts as ratios
</p>
</li>
</ul>
<p>Note: type is ignored if Num.Contrast and Den.Contrast are specified by the user (See below).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base</code></td>
<td>
<p> a single integer specifying the control (i.e. denominator) group for the Dunnett contrasts, ignored otherwise </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p> a character string:
</p>

<ul>
<li> <p><b>"two.sided":</b> for two-sided tests 
</p>
</li>
<li> <p><b>"less":</b> for lower tail tests 
</p>
</li>
<li> <p><b>"greater":</b> for upper tail tests 
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Margin.vec</code></td>
<td>
<p> a single numerical value or vector of Margins under the null hypotheses, default is 1 </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FWER</code></td>
<td>
<p> a single numeric value specifying the family-wise error rate to be controlled </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Num.Contrast</code></td>
<td>
<p> Numerator contrast matrix, where columns correspond to groups and rows correspond to contrasts  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Den.Contrast</code></td>
<td>
<p> Denominator contrast matrix, where columns correspond to groups and rows correspond to contrasts </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names</code></td>
<td>
<p> a logical value: if TRUE, the output will be named according to names of user defined contrast or factor levels </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given a one-way ANOVA model, the interest is in simultaneous tests for several ratios of linear combinations of the treatment means.
Let us denote the ratios by <code class="reqn">\gamma_i, i=1,...,r</code>, and let <code class="reqn">\psi_i, i=1,...,r</code>, denote the relative margins against which we compare the ratios.
For example, upper-tail simultaneous tests for the ratios are stated as
</p>
<p style="text-align: center;"><code class="reqn">H_0i: \gamma_i &lt;= \psi_i </code>
</p>

<p>versus
</p>
<p style="text-align: center;"><code class="reqn">H_1i: \gamma_i &gt; \psi_i, i=1,...,r</code>
</p>
<p>.
</p>
<p>The associated likelihood ratio test statistic <code class="reqn">T_i</code> has a t-distribution.
For multiplicity adjustments, we use the joint distribution of the <code class="reqn">T_i</code> , <code class="reqn">i=1,...,r</code>,
which under the null hypotheses follows a central r-variate t-distribution.
Adjusted p-values can be calculated by adapting the results of Westfall et al. (1999) for ratio formatted hypotheses.
</p>


<h3>Value</h3>

<p>An object of class simtest.ratio containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>estimate </code></td>
<td>
<p>a (named) vector of estimated ratios</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>teststat </code></td>
<td>
<p> a (named) vector of the calculated test statistics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Num.Contrast </code></td>
<td>
<p>the numerator contrast matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Den.Contrast </code></td>
<td>
<p>the denominator contrast matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CorrMat </code></td>
<td>
<p>the correlation matrix of the multivariate t-distribution calculated under the null hypotheses</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>critical.pt </code></td>
<td>
<p>the equicoordinate critical value of the multi-variate t-distribution for a specified FWER</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value.raw </code></td>
<td>
<p>a (named) vector of unadjusted p-values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value.adj </code></td>
<td>
<p>a (named) vector of p-values adjusted for multiplicity</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Margin.vec </code></td>
<td>
<p>the vector of margins under the null hypotheses</p>
</td>
</tr>
</table>
<p>and some other input arguments.
</p>


<h3>Author(s)</h3>

<p> Gemechis Dilba Djira </p>


<h3>References</h3>

 
<p><em>Dilba, G., Bretz, F., and Guiard, V. (2006).</em>
Simultaneous confidence sets and confidence intervals for multiple ratios.
<em>Journal of Statistical Planning and Inference 136, 2640-2658.</em>
</p>
<p><em>Westfall, P.H., Tobias, R.D., Rom, D., Wolfinger, R.D., and Hochberg, Y. (1999).</em>
Multiple comparisons and multiple tests using the SAS system. SAS Institute Inc. Cary, NC, 65-81.
</p>


<h3>See Also</h3>

<p> While print.simtest.ratio produces a small default print-out of the results,
</p>
<p>summary.simtest.ratio can be used to produce a more detailed print-out, which is recommended if user-defined contrasts are used,
</p>
<p>sci.ratio for constructing simultaneous confidence intervals for ratios in oneway layout 
</p>
<p>See <kbd>summary.glht(multcomp)</kbd> for multiple tests for parameters of lm, glm.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(mratios)

########################################################

# User-defined contrasts for comparisons
# between Active control, Placebo and three dosage groups:

data(AP)
AP
boxplot(prepost~treatment, data=AP)

# Test whether the differences of doses 50, 100, 150 vs. Placebo
# are non-inferior to the difference of Active control vs. Placebo 

# User-defined contrasts:

# Numerator Contrasts:

NC &lt;- rbind(
"(D100-D0)" = c(0,-1,1,0,0),
"(D150-D0)" = c(0,-1,0,1,0),
 "(D50-D0)" = c(0,-1,0,0,1))

# Denominator Contrasts:

DC &lt;- rbind(
"(AC-D0)" = c(1,-1,0,0,0),
"(AC-D0)" = c(1,-1,0,0,0),
"(AC-D0)" = c(1,-1,0,0,0))

NC
DC

noninf &lt;- simtest.ratio(prepost ~ treatment, data=AP,
 Num.Contrast=NC, Den.Contrast=DC, Margin.vec=c(0.9,0.9,0.9),
 alternative="greater")

summary( noninf )


#########################################################

## Not run: 

# Some more examples on standard multiple comparison procedures
# stated in terms of ratio hypotheses:

# Comparisons vs. Control:

many21 &lt;- simtest.ratio(prepost ~ treatment, data=AP,
 type="Dunnett")

summary(many21)

# Let the Placebo be the control group, which is the second level
# in alpha-numeric order. A simultaneous test for superiority of
# the three doses and the Active control vs. Placebo could be
# done as: 

many21P &lt;- simtest.ratio(prepost ~ treatment, data=AP,
 type="Dunnett", base=2, alternative="greater", Margin.vec=1.1)
summary(many21P)

# All pairwise comparisons:

allpairs &lt;- simtest.ratio(prepost ~ treatment, data=AP,
 type="Tukey")

summary(allpairs)

#######################################################

# Comparison to grand mean of all strains
# in the Penicillin example:

data(Penicillin)

CGM &lt;- simtest.ratio(diameter~strain, data=Penicillin, type="GrandMean")
CGM
summary(CGM)


## End(Not run)

</code></pre>


</div>