<div class="container">

<table style="width: 100%;"><tr>
<td>simtest.ratioVH</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Approximate simultaneous tests for ratios of normal means with heterogeneous variances</h2>

<h3>Description</h3>

<p>Performs simultaneous tests for several ratios of linear combinations of treatment means in a normal one-way layout,
assuming normal distribution of the data allowing heterogeneous variances.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simtest.ratioVH(formula, data,
 type = "Dunnett", base = 1, alternative = "two.sided",
 Margin.vec = NULL, FWER = 0.05,
 Num.Contrast = NULL, Den.Contrast = NULL,
 names = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p> A formula specifying a numerical response and a grouping factor (e.g., response ~ treatment) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>  A dataframe containing the response and group variable </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p> type of contrast, with the following options:
</p>

<ul>
<li>
<p>"Dunnett": many-to-one comparisons, with control in the denominator
</p>
</li>
<li>
<p>"Tukey": all-pair comparisons 
</p>
</li>
<li>
<p>"Sequen": comparison of consecutive groups, where the group with lower order is the denomniator
</p>
</li>
<li>
<p>"AVE": comparison of each group with average of all others, where the average is taken as denominator
</p>
</li>
<li>
<p>"Changepoint": ratio of averages of groups of higher order divided by averages of groups of lower order 
</p>
</li>
<li>
<p>"Marcus": Marcus contrasts as ratios 
</p>
</li>
<li>
<p>"McDermott": McDermott contrasts as ratios 
</p>
</li>
<li>
<p>"Williams": Williams contrasts as ratios 
</p>
</li>
</ul>
<p>Note: type is ignored if Num.Contrast and Den.Contrast are specified by the user (See below).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base</code></td>
<td>
<p> a single integer specifying the control (i.e. denominator) group for the Dunnett contrasts, ignored otherwise </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p> a character string:
</p>

<ul>
<li>
<p>"two.sided": for two-sided tests 
</p>
</li>
<li>
<p>"less": for lower tail tests 
</p>
</li>
<li>
<p>"greater": for upper tail tests 
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Margin.vec</code></td>
<td>
<p> a single numerical value or vector of Margins under the null hypotheses, default is 1 </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FWER</code></td>
<td>
<p> a single numeric value specifying the family-wise error rate to be controlled </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Num.Contrast</code></td>
<td>
<p> Numerator contrast matrix, where columns correspond to groups and rows correspond to contrasts  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Den.Contrast</code></td>
<td>
<p> Denominator contrast matrix, where columns correspond to groups and rows correspond to contrasts </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names</code></td>
<td>
<p> a logical value: if TRUE, the output will be named according to names of user defined contrast or factor levels </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The associated ratio test statistic T[i] has a t-distribution. Multiplicity adjustment is achieved by using quantiles of r r-variate t-distributions, which differ in the degree of freedom and share the correlation structure. The compariso-specific degrees of freedom
are derived using the approximation according to Satterthwaite (1946).
</p>


<h3>Value</h3>

<p>An object of class simtest.ratio containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>estimate </code></td>
<td>
<p>a (named) vector of estimated ratios</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>teststat </code></td>
<td>
<p> a (named) vector of the calculated test statistics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Num.Contrast </code></td>
<td>
<p>the numerator contrast matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Den.Contrast </code></td>
<td>
<p>the denominator contrast matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CorrMat </code></td>
<td>
<p>the correlation matrix of the multivariate t-distribution calculated under the null hypotheses</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>critical.pt </code></td>
<td>
<p>the equicoordinate critical value of the multi-variate t-distribution for a specified FWER</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value.raw </code></td>
<td>
<p>a (named) vector of unadjusted p-values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value.adj </code></td>
<td>
<p>a (named) vector of p-values adjusted for multiplicity</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Margin.vec </code></td>
<td>
<p>the vector of margins under the null hypotheses</p>
</td>
</tr>
</table>
<p>and some other input arguments.
</p>


<h3>Author(s)</h3>

<p> Mario Hasler</p>


<h3>References</h3>

<p>Simultaneous tests (adjusted p-values)
</p>
<p><em>Hasler, M. and Hothorn, L.A. (2008):</em>
Multiple contrast tests in the presence of heteroscedasticity.
<em> Biometrical Journal 50, 793-800.</em>
</p>
<p>Unadjusted tests (raw p-values)
</p>
<p><em>Hasler M, Vonk R, Hothorn LA (2007).</em>
Assessing non-inferiority of a new treatment in a three-arm trial in the presence of heteroscedasticity.
<em> Statistics in Medicine 27, 490-503.</em>
</p>
<p><em>Satterthwaite, FE (1946)</em>.
An approximate distribution of estimates of variance components.
<em>Biometrics 2, 110-114</em>.
</p>


<h3>See Also</h3>

 <p>sci.ratioVH for corresponding confidence intervals </p>


<h3>Examples</h3>

<pre><code class="language-R">
###############################################

data(Mutagenicity, package="mratios")

boxplot(MN~Treatment, data=Mutagenicity)

## Not run: 

simtest.ratioVH(MN~Treatment, data=Mutagenicity,
 type="Dunnett", base=6, Margin.vec=1.2, alternative="less")

###############################################

# Unadjusted confidence intervals for multiple ratios
# of means assuming heterogeneous group variances.
# The following code produces the results given in Table
# V of Hasler, Vonk and Hothorn (2007).
# The upper confidence limits in Table V can produced
# by calling:

# Mutagenicity of the doses of the new compound,
# expressed as ratio (DoseX-Vehicle)/(Cyclo25-Vehicle):

# Check the order of the factor levels:

levels(Mutagenicity$Treatment)

# numerators:

NC&lt;-rbind(
"Hydro30-Vehicle"=c(0,0,1,0,0,-1),
"Hydro50-Vehicle"=c(0,0,0,1,0,-1),
"Hydro75-Vehicle"=c(0,0,0,0,1,-1),
"Hydro100-Vehicle"=c(0,1,0,0,0,-1)
)

DC&lt;-rbind(
"Cyclo25-Vehicle"=c(1,0,0,0,0,-1),
"Cyclo25-Vehicle"=c(1,0,0,0,0,-1),
"Cyclo25-Vehicle"=c(1,0,0,0,0,-1),
"Cyclo25-Vehicle"=c(1,0,0,0,0,-1)
)

colnames(NC)&lt;-colnames(DC)&lt;-levels(Mutagenicity$Treatment)

NC

DC

# The raw p-values are those presented in Table V:

simtest.ratioVH(formula=MN~Treatment, data=Mutagenicity,
 Num.Contrast=NC, Den.Contrast=DC,
 alternative="less", Margin.vec=0.5, FWER=0.05)

## End(Not run)
</code></pre>


</div>