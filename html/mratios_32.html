<div class="container">

<table style="width: 100%;"><tr>
<td>ttestratio</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> t-test for the ratio of two means </h2>

<h3>Description</h3>

<p>Performs t-test for the ratio of means of two independent samples from two gaussian distributions.
In case of heterogeneous variances a Satterthwaite approximation of the degrees of freedom
is used (Tamhane &amp; Logan, 2004).
</p>


<h3>Usage</h3>

<pre><code class="language-R"> 
## Default S3 method:
ttestratio(x, y, alternative = "two.sided",
 rho = 1, var.equal = FALSE, conf.level = 0.95,
 iterativeCI=FALSE, ul=1e+10, ll=-1e+10, ...)
## S3 method for class 'formula'
ttestratio(formula, data, base=2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> A numeric vector (group in the numerator of the ratio) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p> A numeric vector (group in the denominator of the ratio) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p> A two-sided formula specifying a numeric response variable and a factor with two levels </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> A dataframe containing the variables specified in formula.
Note: the first group in alpha-numeric order will appear in the denominator of the ratio</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p> character string defining the alternative hypothesis, one of "two.sided", "less" or "greater" </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p> a single numeric value: the margin or ratio under the null hypothesis </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.equal</code></td>
<td>
<p> logical, if set TRUE, a ratio-t-test assuming equal group variances is performed, otherwise (default) unequal variances are assumed </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p> confidence level of Fieller's interval for the ratio of two means </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base</code></td>
<td>
<p>if formula is used: a single numeric value specifying whether the first or second group (according to alpha-numeric order) is to be used as denominator</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterativeCI</code></td>
<td>
<p>a single logical, indicating whether the confidence limits shall be found with based on Fiellers formula (default) or by iteratively inverting the test (if TRUE); ignored when <kbd>var.equal=TRUE</kbd></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ul</code></td>
<td>
<p>a single numeric, defining the upper limit for searching the upper confidence bound in uniroot, if iterativeCI=TRUE and var.equal=FALSE, ignored otherwise</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ll</code></td>
<td>
<p>a single numeric, defining the lower limit for searching the lower confidence bound in uniroot, if iterativeCI=TRUE and var.equal=FALSE, ignored otherwise</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments to be passed to ttestratio.default</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function implements the t-test for the ratio of two means and Fiellers confidence interval for the ratio of two means assuming mutually independent Gaussian errors with homogeneous variances, e.g. in Hauschke, Kieser, Hothorn (1999), when the argument <kbd>var.equal=TRUE</kbd>. With the argument <kbd>var.equal=FALSE</kbd> (default), the t-test for the ratio of two means assuming mutually independent Gaussian errors and possibly heterogeneous group variances (Tamhane and Logan, 2004) is implemented. When <kbd>iterativeCI = FALSE</kbd> (default) the corresponding confidence limits are obtained by using Fiellers formula with plug-in of the Satterthwaites degree of freedom calculated with the sample estimates for ratio and variances (not published). These bounds perform quite well but do not necessarily exactly coincide with the test decision. Setting <kbd>iterativeCI = TRUE</kbd> invokes interatively searching for the confidence limits by inverting Tamhane and Logans test using the function uniroot. If the confidence set is unbounded or gives irregular upper and/or lower bounds, a warning and NAs for the confidence limits are returned.
</p>
<p>Note that when the mean of the denominator of the ratio is close to zero, confidence intervals might be degenerated and are not returned.
</p>


<h3>Value</h3>

<p>An object of class "htest"
</p>


<h3>Author(s)</h3>

<p> Frank Schaarschmidt </p>


<h3>References</h3>

 
<p><em>Hauschke, D., Kieser, M., Hothorn, L.A. (1999).</em>
Proof of safety in toxicology based on the ratio of two means for normally distributed data.
<em>Biometrical Journal 41, 295-304.</em>
</p>
<p><em>Tamhane, A.C., Logan, B.R. (2004).</em>
Finding the maximum safe dose level for heteroscedastic data.
<em>Journal of Biopharmaceutical Statistics 14, 843-856.</em>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(mratios)

####################################################

# ASAT values of female rats in a toxicity study
#     (Hauschke, 1999).

data(ASAT)
ASAT

ttestratio(ASAT~group, data=ASAT, alternative="less",
 base=1, rho=1.25, var.equal=TRUE)

######################################################

# Bodyweights of male rats in a toxicity study.
# Objective was to show equivalence between the high
# dose group (Dosis) and the control group (Kon).
# Equivalence margins are set to 0.8 and 1.25. The 
# type-I-error to show equivalence is set to alpha=0.05.

data(rat.weight)

# two one-sided tests:

ttestratio(weight~group, data=rat.weight, alternative="less",
 rho=1.25, var.equal=TRUE)

ttestratio(weight~group, data=rat.weight, alternative="greater",
 rho=0.8, var.equal=TRUE)



# For rho=1, ttestratio corresponds to a simple t.test
# with the difference of means under the null set to zero 
# (,i.e. mu=0).


ttestratio(ASAT~group, data=ASAT, alternative="less",
 rho=1, var.equal=TRUE)

t.test(ASAT~group, data=ASAT, alternative="less",
 mu=0, var.equal=TRUE)

# Ratio of means bewtween negative and positive control in the
# mutagenicity data set, allowing heterogeneous variances:

data(Mutagenicity)
DM&lt;-subset(Mutagenicity, Treatment=="Vehicle"|Treatment=="Cyclo25")

# 95%-CI using the Fieller formula, Satterthwaite df with plug-in of 
# ratio estimate 

ttestratio(MN~Treatment, data=DM, alternative="two.sided",
 var.equal=FALSE, iterativeCI=FALSE)

# 95%-CI based on directly inverting Tamhane and Logans test 
# (Satterthwaite df, avoiding simple plug-in of the ratio estimate)

ttestratio(MN~Treatment, data=DM, alternative="two.sided",
 var.equal=FALSE, iterativeCI=TRUE)


</code></pre>


</div>