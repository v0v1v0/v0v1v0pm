<div class="container">

<table style="width: 100%;"><tr>
<td>gsci.ratio</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simultaneous confidence intervals for ratios of linear combinations of parameters.</h2>

<h3>Description</h3>

<p>This function calculates simultaneous confidence intervals for ratios of user-defined linear combinations, given a vector parameter estiamtes and a corresponding variance-covariance matrix.
Beside unadjusted intervals, multiplicity adjustments are available using quantiles of a multivariate Normal- or t-distribution. The function provides a more general, but less user-friendly function to calculate ratios of mean parameters from linear (mixed models).
</p>


<h3>Usage</h3>

<pre><code class="language-R">gsci.ratio(est, vcmat, Num.Contrast, Den.Contrast,
 degfree = NULL, conf.level = 0.95, alternative = "two.sided",
 adjusted = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>
<p>A numeric vector of parameter estimates, for example coefficients of a linear model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcmat</code></td>
<td>
<p>The corresponding variance-covariance matrix (Number of rows and columns should be the same as the length of the parameter vector)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Num.Contrast</code></td>
<td>
<p>Numerator contrast matrix, where the number of columns must be the same as the length of the parameter vector, and each row represents one contrast</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Den.Contrast</code></td>
<td>
<p>Denominator contrast matrix, where the number of columns must be the same as the length of the parameter vector, and each row represents one contrast</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degfree</code></td>
<td>
<p>Degrees of freedom used for calculating quantiles of a (multivariate) t-distribution. If NULL, Normal approximations are used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>Simultaneous confidence level in case of <kbd>adjusted == TRUE</kbd>, and comparisonwise confidence level in case of <kbd>adjusted == FALSE</kbd></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>a character string: <kbd>"two.sided"</kbd> for two-sided intervals, <kbd>"less"</kbd> for upper confidence limits, <kbd>"greater"</kbd> for lower confidence limits </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjusted</code></td>
<td>
<p>If <kbd>TRUE</kbd>, the simultaneous confidence level is controlled, otherwise the comparisonwise confidence level is used</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given a parameter vector and its corresponding covariance matrix from a linera model fit, approximate simultaneous confidence intervals for several ratios of linear combinations of these parameters are calculated.
For simultaneous confidence intervals (adjusted=TRUE) the plug-in method is used (plugging the maximum likelihood estimates of the ratios to obtain the correlation matrix for calculating quantiles of a multivariate t or normal distribution).
</p>
<p>Linear combinations can be defined by providing matrices for the nominator and the denominator; some pre-defined contrasts can be constructed by the function contrMatRatio. (These may be weighted for different sample sizes.)
</p>


<h3>Value</h3>

<p>An object of class "sci.ratio" and "gsci.ratio", containing a list with elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>point estimates of the ratios</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CorrMat.est</code></td>
<td>
<p>estimate of the correlation matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Num.Contrast</code></td>
<td>
<p>matrix of contrasts used for the numerator of ratios</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Den.Contrast</code></td>
<td>
<p>matrix of contrasts used for the denominator of ratios</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.int</code></td>
<td>
<p>confidence interval estimates of the ratios</p>
</td>
</tr>
</table>
<p>And some further elements to be passed to print and summary functions.
</p>


<h3>Author(s)</h3>

<p>Daniel Gerhard &amp; Frank Schaarschmidt adapting code of Gemechis Dilba Djira</p>


<h3>References</h3>

<p> The general methodology of constructing inference for ratios of linear model parameters can be found in:
</p>
<p><em>Zerbe G.O., (1978):</em> On Fieller's Theorem and the General Linear Model. The American Statistician 32(3), 103-105.
</p>
<p><em>Young D.A., Zerbe G.O., Hay W.W. (1997):</em> Fieller's Theorem, Scheffe's simultaneous confidence intervals, and ratios of parameters of linear and nonlinear mixed-effect models. Biometrics 53(3), 835-847.
</p>
<p><em>Djira G.D.(2010)</em>: Relative Potency Estimation in Parallel-Line Assays - Method Comparison and Some Extensions. Communications in Statistics - Theory and Methods 39(7), 1180-1189.
</p>
<p>However, when <code>adjusted=TRUE</code>, the quantiles are not obtained as described in Zerbe(1978) or Young et al. (1997), but by adapting the 'plug-in' method described for the completely randomized one-way layout in 
</p>
<p><em>Dilba, G., Bretz, F., and Guiard, V. (2006):</em> Simultaneous confidence sets and confidence intervals for multiple ratios. Journal of Statistical Planning and Inference 136, 2640-2658.
</p>
<p>A simulation study of the performance of these methods in linear mixed models:
</p>
<p><em>Schaarschmidt and Djira(2016):</em> Simultaneous Confidence Intervals for Ratios of Fixed Effect Parameters in Linear Mixed Models.
Communications in Statistics - Simulation and Computation 45:5, 1704-1717. DOI: 10.1080/03610918.2013.849741
</p>


<h3>See Also</h3>

<p>glht(multcomp) for simultaneous CI of differences of means, and function sci.ratio.gen(mratios)</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(mratios)

##############################################################

# A 90-days chronic toxicity assay:
# Which of the doses (groups 2,3,4) do not show a decrease in
# bodyweight more pronounced than 90 percent of the bodyweight
# in the control group?

#############################################################

data(BW)
boxplot(Weight~Dose,data=BW)

lmfit &lt;- lm(Weight~Dose-1, data=BW)
est &lt;- coefficients(lmfit)
vc &lt;- vcov(lmfit)
CMAT &lt;- contrMatRatio(table(BW$Dose), type="Dunnett")

BWnoninf &lt;- gsci.ratio(est, vc, CMAT$numC, CMAT$denC,
 alternative="greater", degfree=lmfit$df.residual)

BWnoninf

# Plot
plot(BWnoninf, rho0=0.9)

##############################################################

#### Mixed Model Example

##############################################################

library("nlme")
data(Milk)

# Fit a linear mixed model (maybe there are nicer models available!)

lmefit &lt;- lme(protein ~ Diet-1, data=Milk,
 random=~Time|Cow, correlation=corAR1(form=~Time|Cow))

# Extract the parameter estimates and the corresponding
# variance-covariance matrix

estm &lt;- fixef(lmefit)
vcm &lt;- vcov(lmefit)


# Define the matrices defining the ratios of interest for
# all-pair comparisons: CM is the numerator matrix and 
# DM is the denominator matrix.

CM &lt;- rbind(c(1,0,0),
            c(1,0,0),
            c(0,1,0))
DM &lt;- rbind(c(0,1,0),
            c(0,0,1),
            c(0,0,1))

# Add some row names (This is optional!)

rownames(CM) &lt;- c("b/b+l", "b/l", "b+l/l")

# Calculate and plot simultaneous confidence intervals:

gscimix &lt;- gsci.ratio(estm, vcm, CM, DM, degfree=anova(lmefit)[,2])
plot(gscimix)

</code></pre>


</div>