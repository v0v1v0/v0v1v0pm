<div class="container">

<table style="width: 100%;"><tr>
<td>mrct</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Minimum regularized covariance trace estimator</h2>

<h3>Description</h3>

<p>Functional outlier detection based on the <code>minimum</code> <code>regularized</code> <code>covariance</code> <code>trace</code> estimator (Oguamalam et al. 2023) as a robust covariance estimator.
This estimator uses a generalization of the Mahalanobis distance for the functional setting (Berrendero et al. 2020) and a corresponding theoretical cutoff value.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mrct(
  data,
  h = 0.75,
  alpha = 0.01,
  initializations = 5,
  subset.iteration = 10,
  seed = 123,
  scaling.iterations = 10,
  scaling.tolerance = 10^(-4),
  criterion = "sum",
  sum.percentage = 0.75
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Numeric matrix of a functional data set for which the esimator has to be calculated. Each row contains an observation. They are assumed to be observed on the same regular grid.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>Numeric value between <code class="reqn">0.5</code> and <code class="reqn">1</code>. Ratio of the data which the estimator is based on. Default is set to <code class="reqn">0.75</code>, i.e. <code class="reqn">75\%</code> of the data will be used for the estimator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Numeric (default is <code class="reqn">0.01</code>). Tikhonov regularization parameter <code class="reqn">\alpha</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initializations</code></td>
<td>
<p>Integer (default is <code class="reqn">5</code>). Number of random initial subsets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset.iteration</code></td>
<td>
<p>Integer (default is <code class="reqn">10</code>). Maximum number of how often each subset is re-estimated and adjusted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Integer (default is <code class="reqn">123</code>). Random seed for reproducibility.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaling.iterations</code></td>
<td>
<p>Integer (default is <code class="reqn">5</code>). The maximum number of times <code class="reqn">k_1</code> is re-scaled if the error between subsequent
scalingparameters does not fall below <code>scaling.tolerance</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaling.tolerance</code></td>
<td>
<p>Numeric (default is <code class="reqn">10^{-4}</code>). The error tolerance for re-scaling. If the error falls below this value, the re-scaling procedure stops.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>Character. Criterion based on which the optimal subset is chosen among the final subsets. Possible options are: "<code>cluster</code>" and the default "<code>sum</code>".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sum.percentage</code></td>
<td>
<p>Numeric value between <code class="reqn">0.5</code> and <code class="reqn">1</code>. Corresponding to the "<code>sum</code>" criterion. Determines the fraction of observations up to which the sum over the sorted functional Mahalanobis distances is calculated (in ascending order). Default is set to <code class="reqn">0.75</code>, i.e. the sum of the smallest <code class="reqn">75\%</code> of Mahalanobis distances is calculated. If outliers are present, this value should not be to high, in order not to include any outlying curves.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>theoretical</code></td>
<td>
<p>Integer vector of the indices corresponding to the outliers based on the MRCT estimator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theoretical.w</code></td>
<td>
<p>Same as <code>theoretical</code> with an additional re-weighting step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aMHD</code></td>
<td>
<p>Numeric vector containing the functional Mahalanobis distances of all observations based on the MRCT estimator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aMHD.w</code></td>
<td>
<p>Same as <code>aMHD</code> with an additional re-weighting step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quant</code></td>
<td>
<p>Numeric. Theoretical cutoff value for outlier detection.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quant.w</code></td>
<td>
<p>Same as <code>quant</code> with an additional re-weighting step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Numeric. Scalingparameter <code class="reqn">k_1</code> of Algorithm 1 described in (Oguamalam et al. 2023).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k.w</code></td>
<td>
<p>Same as <code>k</code> with an additional re-weighting step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimal.subset</code></td>
<td>
<p>Integer vector of the optimal h-subset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subsets</code></td>
<td>
<p>Numeric matrix containing all final subsets. Each row of <code>subsets</code> is one final subset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>objval</code></td>
<td>
<p>Numeric vector with the objective values of the final subsets based on <code>criterion</code>.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Berrendero JR, Bueno-Larraz B, Cuevas A (2020).
“On Mahalanobis Distance in Functional Settings.”
<em>J. Mach. Learn. Res.</em>, <b>21</b>(9), 1–33..
</p>
<p>Oguamalam J, Radojičić U, Filzmoser P (2023).
“Minimum regularized covariance trace estimator and outlier detection for functional data.”
<a href="https://doi.org/10.48550/arXiv.2307.13509">https://doi.org/10.48550/arXiv.2307.13509</a>..
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Fix seed for reproducibility
set.seed(123)

# Sample outlying indices
cont.ind &lt;- sample(1:50, size=10)

# Generate 50 curves on the interval [0,1] at 50 timepoints with 20% outliers
y &lt;- mrct.rgauss(x.grid=seq(0,1,length.out=50), N=50, model=1,
                 outliers=cont.ind, method="linear")

# Visualize curves (regular curves grey, outliers black)
colormap &lt;- rep("grey",50); colormap[cont.ind] &lt;- "black"
matplot(x=seq(0,1,length.out=50), y=t(y), type="l", lty="solid",
        col=colormap, xlab="t",ylab="")

# Run MRCT
mrct.y &lt;- mrct(data=y, h=0.75, alpha=0.1,
               initializations=10, criterion="sum")

# Visualize alpha-Mahalanobis distance with cutoff (horizontal black line)
# Colors correspond to simulated outliers, shapes to estimated (MRCT) ones
# (circle regular and triangle irregular curves)
shapemap &lt;- rep(1,50); shapemap[mrct.y$theoretical.w] &lt;- 2
plot(x=1:50, y=mrct.y$aMHD.w, col=colormap, pch=shapemap,
     xlab="Index", ylab=expression(alpha*"-MHD"))
abline(h = mrct.y$quant.w)

# If you dont have any information on possible outliers,
# alternatively you could use the S3 method plot.mrct()
mrct.plot(mrct.y)
</code></pre>


</div>