<div class="container">

<table style="width: 100%;"><tr>
<td>mrds_opt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Tips on optimisation issues in <code>mrds</code> models</h2>

<h3>Description</h3>

<p>Occasionally when fitting an 'mrds' model one can run into optimisation
issues. In general such problems can be quite complex so these "quick fixes"
may not work. If you come up against problems that are not fixed by these
tips, or you feel the results are dubious please go ahead and contact the
package authors.
</p>


<h3>Debug mode</h3>

<p>One can obtain debug output at each stage of the optimisation using the
<code>showit</code> option. This is set via <code>control</code>, so adding
<code>control=list(showit=3)</code> gives the highest level of debug output
(setting <code>showit</code> to 1 or 2 gives less output).
</p>


<h3>Re-scaling covariates</h3>

<p>Sometimes convergence issues in covariate (MCDS) models are caused by values
of the covariate being very large, so a rescaling of that covariate is then
necessary. Simply scaling by the standard deviation of the covariate can
help (e.g. <code>dat$size.scaled &lt;- dat$scale/sd(dat$scale)</code> for a covariate
<code>size</code>, then including <code>size.scaled</code> in the model instead of
<code>size</code>).
</p>
<p>It is important to note that one needs to use the original covariate (size)
when computing Horvitz-Thompson estimates of population size if the group
size is used in that estimate. i.e. use the unscaled size in the numerator
of the H-T estimator.
</p>


<h3>Factor levels</h3>

<p>By default R will set the base factor level to be the label which comes
first alphabetically. Sometimes this can be an issue when that factor level
corresponds to a subset of the data with very few observations. This can
lead to very large uncertainty estimates (CVs) for model parameters. One way
around this is to use <code>relevel</code> to set the base level to a level
with more observations.
</p>


<h3>Initial values</h3>

<p>Initial (or starting) values for the dsmodel can be set via the <code>initial</code> 
element of the <code>control</code> list. <code>initial</code> is a list itself with 
elements <code>scale</code>, <code>shape</code> and <code>adjustment</code>, corresponding to 
the associated parameters. If a model has covariates then the <code>scale</code> or
<code>shape</code> elements will be vectors with parameter initial values in the
same order as they are specific in the model formula (using <code>showit</code> is
a good check they are in the correct order). Adjustment starting values are
in order of the order of that term (cosine order 2 is before cosine order 3
terms).
</p>
<p>One way of obtaining starting values is to fit a simpler model first (say
with fewer covariates or adjustments) and then use the starting values from
this simpler model for the corresponding parameters.
</p>
<p>Another alternative to obtain starting values is to fit the model (or some
submodel) using Distance for Windows. Note that Distance reports the scale
parameter (or intercept in a covariate model) on the exponential scale, so
one must <code>log</code> this before supplying it to <code>ddf</code>.
</p>


<h3>Bounds</h3>

<p>One can change the upper and lower bounds for the dsmodel parameters. These 
specify the largest and smallest values individual parameters can be. By 
placing these constraints on the parameters, it is possible to "temper" the
optimisation problem, making fitting possible.
</p>
<p>Again, one uses the <code>control</code> list, the elements <code>upperbounds</code> and
<code>lowerbounds</code>. In this case, each of <code>upperbounds</code> and
<code>lowerbounds</code> are vectors, which one can think of as each of the
vectors <code>shape</code>, <code>scale</code> and <code>adjustment</code> from the "Initial
values" section above, concatenated in that order. If one does not occur
(e.g. no shape parameter) then it is simple omitted from the vector.
</p>


<h3>Author(s)</h3>

<p>David L. Miller &lt;dave@ninepointeightone.net&gt;
</p>


</div>