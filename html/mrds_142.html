<div class="container">

<table style="width: 100%;"><tr>
<td>predict.ds</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Predictions from <code>mrds</code> models</h2>

<h3>Description</h3>

<p>Predict detection probabilities (or effective strip widths/effective areas
of detection) from a fitted distance sampling model using either the
original data (i.e. "fitted" values) or using new data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'ds'
predict(object, newdata=NULL, compute=FALSE,
int.range=NULL, esw=FALSE, se.fit=FALSE, ...)
       ## S3 method for class 'io.fi'
predict(object, newdata=NULL, compute=FALSE,
       int.range=NULL, integrate=FALSE, ...)
       ## S3 method for class 'io'
predict(object, newdata=NULL, compute=FALSE,
       int.range=NULL, ...)
       ## S3 method for class 'trial'
predict(object, newdata=NULL, compute=FALSE,
       int.range=NULL, ...)
       ## S3 method for class 'trial.fi'
predict(object, newdata=NULL, compute=FALSE,
       int.range=NULL, integrate=FALSE, ...)
       ## S3 method for class 'rem'
predict(object, newdata=NULL, compute=FALSE,
       int.range=NULL, ...)
       ## S3 method for class 'rem.fi'
predict(object, newdata=NULL, compute=FALSE,
       int.range=NULL, integrate=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p><code>ddf</code> model object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>new <code>data.frame</code> for prediction, this must include a
column called "<code>distance</code>".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compute</code></td>
<td>
<p>if <code>TRUE</code> compute values and don't use the fitted values
stored in the model object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>int.range</code></td>
<td>
<p>integration range for variable range analysis; either
vector or 2 column matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>esw</code></td>
<td>
<p>if <code>TRUE</code>, returns effective strip half-width (or effective
area of detection for point transect models) integral from 0 to the
truncation distance (<code>width</code>) of <code class="reqn">p(y)dy</code>; otherwise it returns the
integral from 0 to truncation width of <code class="reqn">p(y)\pi(y)</code> where
<code class="reqn">\pi(y)=1/w</code> for lines and <code class="reqn">\pi(y)=2r/w^2</code> for points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.fit</code></td>
<td>
<p>for <code>*.ds</code> models only, generate standard errors on the
predicted probabilities of detection (or ESW if <code>esw=TRUE</code>), stored in
the <code>se.fit</code> element</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>for S3 consistency</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>integrate</code></td>
<td>
<p>for <code>*.fi</code> methods, see Details below.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The first 4 arguments are the same in each predict function.  The latter 2
are specific to certain functions. For line transects, the effective strip
half-width (<code>esw=TRUE</code>) is the integral of the fitted detection
function over either 0 to W or the specified <code>int.range</code>.  The
predicted detection probability is the average probability which is simply
the integral divided by the distance range. For point transect models,
<code>esw=TRUE</code> calculates the effective area of detection (commonly
referred to as "nu", this is the integral of <code>2/width^2 * rg(r)</code>.
</p>
<p>Fitted detection probabilities are stored in the <code>model</code> object and
these are returned unless <code>compute=TRUE</code> or <code>newdata</code> is
specified. <code>compute=TRUE</code> is used to estimate numerical derivatives for
use in delta method approximations to the variance.
</p>
<p>For <code>method="io.fi"</code> or <code>method="trial.fi"</code> if
<code>integrate=FALSE</code>, <code>predict</code> returns the value of the conditional
detection probability and if <code>integrate=TRUE</code>, it returns the average
conditional detection probability by integrating over x (distance) with
respect to a uniform distribution.
</p>
<p>Note that the ordering of the returned results when no new data is supplied
(the "fitted" values) will not necessarily be the same as the data supplied
to <code>ddf</code>, the data (and hence results from <code>predict</code>) will
be sorted by object ID (<code>object</code>) then observer ID (<code>observer</code>).
</p>


<h3>Value</h3>

<p>For all but the exceptions below, the value is a list with a single
element: <code>fitted</code>, a vector of average detection probabilities or esw
values for each observation in the original data or<code>newdata</code>
</p>
<p>For <code>predict.ds</code>, if <code>se.fit=TRUE</code> there is an additional element
<code>$se.fit</code>, which contains the standard errors of the probabilities of
detection or ESW.
</p>
<p>For <code>predict.io.fi</code>,<code>predict.trial.fi</code>,<code>predict.rem.fi</code> with
<code>integrate=TRUE</code>, the value is a list with one element: <code>fitted</code>,
which is a vector of integrated (average) detection probabilities for each
observation in the original data or <code>newdata</code>.
</p>
<p>For <code>predict.io.fi</code>, <code>predict.trial.fi</code>, or <code>predict.rem.fi</code>
with <code>integrate=FALSE</code>, the value is a list with the following
elements:
</p>

<dl>
<dt><code>fitted</code></dt>
<dd>
<p><code class="reqn">p(y)</code> values</p>
</dd>
<dt><code>p1</code></dt>
<dd>
<p><code class="reqn">p_{1|2}(y)</code>, conditional detection probability for
observer 1</p>
</dd>
<dt><code>p2</code></dt>
<dd>
<p><code class="reqn">p_{2|1}(y)</code>, conditional detection probability for
observer 2</p>
</dd>
<dt><code>fitted</code></dt>
<dd>
<p><code class="reqn">p_.(y) = p_{1|2}(y) + p_{2|1}(y) - p_{1|2}(y) *
   p_{2|1}(y)</code>, conditional detection probability of being seen by either
observer</p>
</dd>
</dl>
<h3>Note</h3>

<p>Each function is called by the generic function <code>predict</code> for the
appropriate <code>ddf</code> model object.  They can be called directly by the
user, but it is typically safest to use <code>predict</code> which calls the
appropriate function based on the type of model.
</p>


<h3>Author(s)</h3>

<p>Jeff Laake, David L Miller
</p>


<h3>See Also</h3>

<p><code>ddf</code>, <code>summary.ds</code>, <code>plot.ds</code>
</p>


</div>