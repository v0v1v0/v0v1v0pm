<div class="container">

<table style="width: 100%;"><tr>
<td>ddf.ds</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>CDS/MCDS Distance Detection Function Fitting</h2>

<h3>Description</h3>

<p>Fits a conventional distance sampling (CDS) (likelihood eq 6.6 in Laake and
Borchers 2004) or multi-covariate distance sampling (MCDS)(likelihood eq
6.14 in Laake and Borchers 2004) model for the detection function of
observed distance data.  It only uses key functions and does not incorporate
adjustment functions as in CDS/MCDS analysis engines in DISTANCE (Marques
and Buckland 2004). Distance can be grouped (binned), ungrouped (unbinned)
or mixture of the two.  This function is not called directly by the user and
is called from <code>ddf</code>,<code>ddf.io</code>, or <code>ddf.trial</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'ds'
ddf(
  dsmodel,
  mrmodel = NULL,
  data,
  method = "ds",
  meta.data = list(),
  control = list(),
  call
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dsmodel</code></td>
<td>
<p>model list with key function and scale formula if any</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mrmodel</code></td>
<td>
<p>not used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p><code>data.frame</code>; see <code>ddf</code> for details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>analysis method; only needed if this function called from
<code>ddf.io</code> or <code>ddf.trial</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meta.data</code></td>
<td>
<p><code>list</code> containing settings controlling data structure</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p><code>list</code> containing settings controlling model fitting</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>original function call if this function not called directly from
<code>ddf</code> (e.g., called via <code>ddf.io</code>)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For a complete description of each of the calling arguments, see
<code>ddf</code>.  The argument <code>model</code> in this function is the same
as <code>dsmodel</code> in <code>ddf</code>.  The argument <code>dataname</code> is the name
of the dataframe specified by the argument <code>data</code> in <code>ddf</code>. The
arguments <code>control</code>,<code>meta.data</code>,and <code>method</code> are defined the
same as in <code>ddf</code>.
</p>


<h3>Value</h3>

<p>result: a <code>ds</code> model object
</p>


<h3>Note</h3>

<p>If mixture of binned and unbinned distance, width must be set to be &gt;=
largest interval endpoint; this could be changed with a more complicated
analysis; likewise, if all binned and bins overlap, the above must also
hold; if bins don't overlap, width must be one of the interval endpoints;
same holds for left truncation Although the mixture analysis works in
principle it has not been tested via simulation.
</p>


<h3>Author(s)</h3>

<p>Jeff Laake
</p>


<h3>References</h3>

<p>Laake, J.L. and D.L. Borchers. 2004. Methods for incomplete
detection at distance zero. In: Advanced Distance Sampling, eds. S.T.
Buckland, D.R. Anderson, K.P. Burnham, J.L. Laake, D.L. Borchers, and L.
Thomas. Oxford University Press.
</p>
<p>Marques, F.F.C. and S.T. Buckland. 2004. Covariate models for the detection
function. In: Advanced Distance Sampling, eds. S.T. Buckland,
D.R. Anderson, K.P. Burnham, J.L. Laake, D.L. Borchers, and L. Thomas.
Oxford University Press.
</p>


<h3>See Also</h3>

<p><code>flnl</code>, <code>summary.ds</code>, <code>coef.ds</code>,
<code>plot.ds</code>,<code>gof.ds</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# ddf.ds is called when ddf is called with method="ds"

data(book.tee.data)
region &lt;- book.tee.data$book.tee.region
egdata &lt;- book.tee.data$book.tee.dataframe
samples &lt;- book.tee.data$book.tee.samples
obs &lt;- book.tee.data$book.tee.obs
result &lt;- ddf(dsmodel = ~mcds(key = "hn", formula = ~1),
              data = egdata[egdata$observer==1, ], method = "ds",
              meta.data = list(width = 4))
summary(result,se=TRUE)
plot(result,main="cds - observer 1")
print(dht(result,region,samples,obs,options=list(varflag=0,group=TRUE),
          se=TRUE))
print(ddf.gof(result))

</code></pre>


</div>