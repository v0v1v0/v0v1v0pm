<div class="container">

<table style="width: 100%;"><tr>
<td>dht.se</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Variance and confidence intervals for density and abundance estimates</h2>

<h3>Description</h3>

<p>Computes standard error, cv, and log-normal confidence intervals for
abundance and density within each region (if any) and for the total of all
the regions. It also produces the correlation matrix for regional and total
estimates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dht.se(
  model,
  region.table,
  samples,
  obs,
  options,
  numRegions,
  estimate.table,
  Nhat.by.sample
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>ddf model object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>region.table</code></td>
<td>
<p>table of region values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samples</code></td>
<td>
<p>table of samples(replicates)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>
<p>table of observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>options</code></td>
<td>
<p>list of options that can be set (see <code>dht</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numRegions</code></td>
<td>
<p>number of regions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate.table</code></td>
<td>
<p>table of estimate values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nhat.by.sample</code></td>
<td>
<p>estimated abundances by sample</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The variance has two components:
</p>

<ul>
<li>
<p> variation due to uncertainty from estimation of the detection
function parameters;
</p>
</li>
<li>
<p> variation in abundance due to random sample selection;
</p>
</li>
</ul>
<p>The first component (model parameter uncertainty) is computed using a delta
method estimate of variance (Huggins 1989, 1991, Borchers et al. 1998) in
which the first derivatives of the abundance estimator with respect to the
parameters in the detection function are computed numerically (see
<code>DeltaMethod</code>).
</p>
<p>The second component (encounter rate variance) can be computed in one of
several ways depending on the form taken for the encounter rate and the
estimator used. To begin with there three possible values for <code>varflag</code>
to calculate encounter rate:
</p>

<ul>
<li> <p><code>0</code> uses a binomial variance for the number of observations
(equation 13 of Borchers et al. 1998). This estimator is only useful if the
sampled region is the survey region and the objects are not clustered; this
situation will not occur very often;
</p>
</li>
<li> <p><code>1</code> uses the encounter rate <code class="reqn">n/L</code> (objects observed per unit
transect) from Buckland et al. (2001) pg 78-79 (equation 3.78) for line
transects (see also Fewster et al, 2009 estimator R2). This variance
estimator is not appropriate if <code>size</code> or a derivative of <code>size</code>
is used in the detection function;
</p>
</li>
<li> <p><code>2</code> is the default and uses the encounter rate estimator
<code class="reqn">\hat{N}/L</code> (estimated abundance per unit transect) suggested by Innes
et al (2002) and Marques &amp; Buckland (2004).
</p>
</li>
</ul>
<p>In general if any covariates are used in the models, the default
<code>varflag=2</code> is preferable as the estimated abundance will take into
account variability due to covariate effects. If the population is clustered
the mean group size and standard error is also reported.
</p>
<p>For options <code>1</code> and <code>2</code>, it is then possible to choose one of the
estimator forms given in Fewster et al (2009). For line transects:
<code>"R2"</code>, <code>"R3"</code>, <code>"R4"</code>, <code>"S1"</code>, <code>"S2"</code>,
<code>"O1"</code>, <code>"O2"</code> or <code>"O3"</code> can be used by specifying the
<code>ervar=</code> option (default <code>"R2"</code>). For points, either the 
<code>"P2"</code> or <code>"P3"</code> estimator can be selected (&gt;=mrds 2.3.0 
default <code>"P2"</code>, &lt;= mrds 2.2.9 default <code>"P3"</code>). See 
<code>varn</code> and Fewster et al (2009) for further details 
on these estimators.
</p>
<p>Exceptions to the above occur if there is only one sample in a stratum. In
that case it uses Poisson assumption (<code class="reqn">Var(x)=x</code>) and it assumes a known
variance so <code class="reqn">z=1.96</code> is used for critical value. In all other cases the
degrees of freedom for the <code class="reqn">t</code>-distribution assumed for the
log(abundance) or log(density) is based on the Satterthwaite approximation
(Buckland et al. 2001 pg 90) for the degrees of freedom (df). The df are
weighted by the squared cv in combining the two sources of variation because
of the assumed log-normal distribution because the components are
multiplicative. For combining df for the sampling variance across regions
they are weighted by the variance because it is a sum across regions.
</p>
<p>A non-zero correlation between regional estimates can occur from using a
common detection function across regions. This is reflected in the
correlation matrix of the regional and total estimates which is given in the
value list. It is only needed if subtotals of regional estimates are needed.
</p>


<h3>Value</h3>

<p>List with 2 elements: </p>
<table>
<tr style="vertical-align: top;">
<td><code>estimate.table</code></td>
<td>
<p>completed table with se,
cv and confidence limits</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vc </code></td>
<td>
<p>correlation matrix of estimates</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>This function is called by <code>dht</code> and it is not expected that the
user will call this function directly but it is documented here for
completeness and for anyone expanding the code or using this function in
their own code.
</p>


<h3>Author(s)</h3>

<p>Jeff Laake
</p>


<h3>References</h3>

<p>see <code>dht</code>
</p>


<h3>See Also</h3>

<p><code>dht</code>, <code>print.dht</code>
</p>


</div>