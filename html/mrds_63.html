<div class="container">

<table style="width: 100%;"><tr>
<td>flnl</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Log-likelihood computation for distance sampling data</h2>

<h3>Description</h3>

<p>For a specific set of parameter values, it computes and returns the negative
log-likelihood for the distance sampling likelihood for distances that are
unbinned, binned and a mixture of both.  The function <code>flnl</code> is the
function minimized using <code>optim</code> from within
<code>ddf.ds</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">flnl(fpar, ddfobj, misc.options, fitting = "all")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fpar</code></td>
<td>
<p>parameter values for detection function at which negative
log-likelihood should be evaluated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ddfobj</code></td>
<td>
<p>distance sampling object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>misc.options</code></td>
<td>
<p>a <code>list</code> with the following elements: <code>width</code>
transect width; <code>int.range</code> the integration range for observations;
<code>showit</code> 0 to 3 controls level debug output; <code>integral.numeric</code> if
<code>TRUE</code> integral is computed numerically rather than analytically;
<code>point</code> is this a point transect?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitting</code></td>
<td>
<p>character <code>"key"</code> if only fitting key function
parameters, <code>"adjust"</code> if fitting adjustment parameters or <code>"all"</code>
to fit both</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Most of the computation is in <code>flpt.lnl</code> in which the negative
log-likelihood is computed for each observation. <code>flnl</code> is a wrapper
that optionally outputs intermediate results and sums the individual
log-likelihood values.
</p>
<p><code>flnl</code> is the main routine that manipulates the parameters using
<code>getpar</code> to handle fitting of key, adjustment or all of the
parameters.  It then calls <code>flpt.lnl</code> to do the actual computation of
the likelihood.  The probability density function for point counts is
<code>fr</code> and for line transects is <code>fx</code>.
<code>fx</code>=g(x)/mu (where g(x) is the detection function); whereas,
f(r)=r*g(r)/mu where mu in both cases is the normalizing constant.  Both
functions are in source code file for <code>link{detfct}</code> and are called from
<code>distpdf</code> and the integral calculations are made with
<code>integratepdf</code>.
</p>


<h3>Value</h3>

<p>negative log-likelihood value at the parameter values specified in
<code>fpar</code>
</p>


<h3>Note</h3>

<p>These are internal functions used by <code>ddf.ds</code> to fit
distance sampling detection functions.  It is not intended for the user to
invoke these functions but they are documented here for completeness.
</p>


<h3>Author(s)</h3>

<p>Jeff Laake, David L Miller
</p>


<h3>See Also</h3>

<p><code>flt.var</code>, <code>detfct</code>
</p>


</div>