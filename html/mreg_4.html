<div class="container">

<table style="width: 100%;"><tr>
<td>mreg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>To perform regression when discrete outcome variables are missing</h2>

<h3>Description</h3>

<p>This software was created for the paper referred to
below. If a longitudinal data base has regularly updated explanatory
variables, but whose outcome variable is only intermittently
collected then we can still perform exact maximum likelihood
estimation of a regression model if the outcome variable is discrete.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mreg(
  formula,
  data,
  patid,
  start.theta = NULL,
  modify = unity,
  modify.p = 0,
  mod.formula = ~1,
  density.name = "negbin",
  link = "log",
  iterlim = 100,
  gradtol = 1e-06,
  steptol = 1e-06,
  na.action = NULL,
  print.level = 2,
  zero.start = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>This is a formula object e.g.  Y~A+B to describe the
location parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>This is a data frame in which the variables are recorded</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>patid</code></td>
<td>
<p>In a longitudinal context this indexes the individuals.
Note that the observations within each patient is assumed to be ordered
according the timing of the observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.theta</code></td>
<td>
<p>Optional vector of starting values for location
and nuisance parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modify</code></td>
<td>
<p>We may wish to let the location depend on functions of
the previous outcomes. Since these may be missing, we have to
provide a function that can cope with all the potential values the
outcome may have taken. See <code>paper</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modify.p</code></td>
<td>
<p>This is the dimension of the parameters associated
with the modify function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mod.formula</code></td>
<td>
<p>If we require other variables to interact with the
previous observation we must create a set of variables to use. This is
a one-sided formula e.g. ~X+Z, if we wanted to use those variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density.name</code></td>
<td>
<p>This is the density the increment in outcome is
assumed to follow. It can be one of three values: negbin, poisson, geometric.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>This is the link function <code class="reqn">g(\mu)=\eta</code>. Where <code class="reqn">\eta</code> is a linear
combination of covariates, and <code class="reqn">\mu</code> is the expected value of the
outcome. The link function can be one of four values: identity, log,
logit, hyper.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterlim</code></td>
<td>
<p>The maximum number of iterations allowed for the
<code>nlm</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gradtol</code></td>
<td>
<p>The parameter <code>gradtol</code> for the <code>nlm</code>
function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>steptol</code></td>
<td>
<p>The parameter  <code>steptol</code> for the <code>nlm</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>Parameter is not used: If any covariates are missing
the function will return an error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.level</code></td>
<td>
<p>The parameter <code>print.level</code> for the
<code>nlm</code> function. Set to the maximum, verbose level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zero.start</code></td>
<td>
<p>It may be the case that it is known that the first
value of the outcome was zero for all individuals, in which case
invoke this TRUE/FALSE option.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>It returns an object of class <code>mreg</code> which is similar
to a <code>lm</code> object. It has <code>print</code> and
<code>summary</code> methods to display the fitted parameters and standard errors.
</p>


<h3>References</h3>

<p>Bond S, Farewell V, 2006, Exact Likelihood Estimation for a
Negative Binomial Regression Model with Missing Outcomes, Biometrics
</p>


<h3>See Also</h3>

<p><code>print.mreg</code>, <code>summary.mreg</code>,
<code>paper</code>, <code>unity</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">	data(public)
## Not run: 
mod1 &lt;- mreg( damaged~offset(log(intervisit.time))+esr.init,
data=public,patid=ptno,print.level=2, iterlim=1000 )
mod.ncar &lt;-mreg(damaged ~ offset(log(intervisit.time)) + esr.init +
         tender + effused + clinic.time, data = public, patid = ptno,
         modify = paper, modify.p = 5, mod.formula = ~art.dur.init,
       density.name = "negbin.ncar", iterlim = 1000, print.level = 2)

## End(Not run)
</code></pre>


</div>