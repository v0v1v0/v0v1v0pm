<div class="container">

<table style="width: 100%;"><tr>
<td>paper</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>An example of a function to calculate the effect on the location that depends on previous outcome in an mreg model</h2>

<h3>Description</h3>

<p>In a regression model one may want to let the linear predictor depend on
previous values of the outcome variable in longitudinal data. When the outcome variable is missing we can still do this but we have to create a
function that calculates a vector of linear predictors with one element
for each of the possible preceding values of the outcome.
</p>


<h3>Usage</h3>

<pre><code class="language-R">paper(x, y, mod.Z)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>is a vector of possible values the previous value of the
response could take.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>is an vector of the coefficients. Its length is specified in
the <code>mreg</code> function by the argument <code>modify.p</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mod.Z</code></td>
<td>
<p>vector of observed covariates that may interact with the
unobserved preceding outcome corresponding to the observation. It is
taken from the <code>model.frame</code> produced by the <code>mod.formula</code>
argument in <code>mreg</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is an example function that was used in the paper referred to
below. The user may write their own function as long as it takes the
arguments specified above and returns a vector the same length as
<code>x</code> that will be added to the linear predictor. It is up to the user to ensure that
their function  identifies the correct column of <code>mod.Z</code> using indices
(<code>[]</code> that correspond to the desired variables in  <code>mod.formula</code>.
If any function other than <code>unity</code> (which does nothing to
the linear predictor) is used then it is not possible to produce fitted
values or residuals.
</p>


<h3>Value</h3>

<p>A numeric vector the same length as
<code>x</code> that will be added to the linear predictor.
It also has two subsidiary attributes: <code>par.names</code> names to be
used to label the associated coefficients, and <code>par.dim</code> the
length of this vector of coefficients.
</p>


<h3>See Also</h3>

<p><code>unity</code> <code>mreg</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## The function is currently defined as
function(x,y, mod.Z){
  #x is the imputed response
  #y is the set of parameters
 #mod.Z is a VECTOR/matrix of explanatory variables
 rad.type &lt;- cut(x, breaks=c(-1,0,4,9,50))
 if( is.vector(mod.Z)){
   arthdur.first &lt;- rep(mod.Z[2],length(x))
 }
 else{
   arthdur.first &lt;- rep(mod.Z[1,2], length(x))
 }
 X &lt;- model.matrix( ~rad.type+I(x==0):arthdur.first)
 structure( X[,-1, drop=FALSE]%*%y, par.names= colnames( X)[-1],par.dim=dim(X)[2]-1)
}
</code></pre>


</div>