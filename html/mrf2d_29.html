<div class="container">

<table style="width: 100%;"><tr>
<td>mrfi-class</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>mrfi: MRF interaction structure</h2>

<h3>Description</h3>

<p>The <code>mrfi</code> S4 class is a representation of the interaction
structure for a spatially-stationary Markov Random Field.
</p>
<p>The function <code>mrfi()</code> provides an interface for creation
<code>mrfi</code> objects. A <code>plot</code> method is also available for visualization, as
well as conversion methods like <code>as.list</code> and operators like <code>+</code>.
</p>
<p><code>mrfi()</code> creates an object of class <code>mrfi</code> based on a distance
rule and optionally a list of relative positions. The argument <code>max_norm</code> and
<code>norm_type</code> can be used to automatically include all positions within a
"range" defined by the norm type chosen and distance using that norm.
</p>
<p>A list of relative positions may also be included to specify sparse
interaction structures, for example. Alternatively, <code>rpositions()</code>
can be used to create a based exclusively on a list of relative positions.
</p>
<p>Simple operations are provided to include (set union)
new interacting positions to a <code>mrfi</code> object with the <code>'+'</code> operator and
remove positions (set difference) with <code>-</code>. Individual positions can be
included/excluded using length-2 vectors in the right hand side. Union and
set difference of complete structures can also be computed by adding or
subtracting two <code>mrfi</code> objects.
</p>
<p>These operations deal with opposite directions filtering to avoid redundancy
in the interaction structure.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mrfi(max_norm = 1, norm_type = "1", positions = NULL)

rpositions(positions)

## S3 method for class 'mrfi'
as.list(x, ...)

## S4 method for signature 'mrfi'
length(x)

## S4 method for signature 'mrfi,numeric,missing'
x[[i]]

## S4 method for signature 'mrfi,numeric,missing'
x[i]

## S4 method for signature 'mrfi,numeric'
e1 + e2

## S4 method for signature 'mrfi,numeric'
e1 - e2

## S4 method for signature 'mrfi,mrfi'
e1 + e2

## S4 method for signature 'mrfi,mrfi'
e1 - e2

mrfi_to_string(mrfi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>max_norm</code></td>
<td>
<p>a <code>numeric</code> value. All points with norm <code class="reqn">\le</code> <code>max_dist</code>
are included.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norm_type</code></td>
<td>
<p>a <code>character</code> indicating the norm type used. Possible values
are "m", "1", "2", etc. See <code>norm</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>positions</code></td>
<td>
<p>a <code>list</code> of <code>numeric</code> vectors of length 2. Each vector
corresponds to a relative position included.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p><code>mrfi</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments not used by this method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>i</code></td>
<td>
<p>vector of indexes to extract interacting positions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e1, mrfi</code></td>
<td>
<p>A <code>mrfi</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e2</code></td>
<td>
<p>Either a second <code>mrfi</code> object or a length 2 <code>numeric</code> with the new
relative position to include (<code>+</code>) or remove (<code>-</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The interaction structure is defined by the list of relative
positions in it. For a specific pixel, conditional to the values of pixels in
these relative positions from it, its value is independent of any other pixel
in the image.
</p>
<p>The relative positions are indentified by two integers <code>rx</code> and <code>ry</code>
representing the "shift" in the <code>x</code>-axis and <code>y</code>-axis respectively. As an
example: The relative position <code style="white-space: pre;">⁠(1,0)⁠</code> representes the pixel in the immediate
right position, while <code style="white-space: pre;">⁠(-1,0)⁠</code> the left one.
</p>
<p>Note that the inclusion of a relative position to the dependence also implies
its opposite direction is not conditionally independent (commutativeness of
dependence), but only one is included in the <code>mrfi</code> object.
</p>
<p>To illustrate that, a nearest neighbor dependence structure can be specified
by:
</p>
<p><code>mrfi(1)</code>
</p>
<p>Note that it only includes the positions <code style="white-space: pre;">⁠(1,0)⁠</code> and <code style="white-space: pre;">⁠(0,1)⁠</code>, but when
visualizing it, for example, <code>mrf2d</code> understands the opposite directions
are also conditionally dependent, as in
</p>
<p><code>plot(mrfi(1))</code>.
</p>


<h3>Value</h3>

<p>A <code>mrfi</code> object.
</p>
<p><code>as.list()</code>: converts the <code>mrfi</code> object to a list of interacting
positions (list of length-2 vectors).
</p>
<p><code>[[</code>: converts to list and subsets it.
</p>
<p><code>[</code>: subsets the <code>mrfi</code> object and returns another <code>mrfi</code> object.
</p>
<p><code>+</code>: computes the union of the interaction structure in a <code>mrfi</code> object with
a <code>numeric</code> representing an additional position to include or another <code>mrfi</code>
object.
</p>


<h3>Slots</h3>


<dl>
<dt><code>Rmat</code></dt>
<dd>
<p>A 2-column <code>matrix</code> where each row represents a relative position
of interaction.</p>
</dd>
</dl>
<h3>Note</h3>

<p>If a position in <code>positions</code> is already included due to the
<code>max_norm</code> and <code>norm_type</code> specification, the second ocurrence is ignored.
The same is valid for repeated or opposite positions in <code>positions</code>.
</p>


<h3>See Also</h3>

<p>A paper with detailed description of the package can be found at
doi: <a href="https://doi.org/10.18637/jss.v101.i08">10.18637/jss.v101.i08</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">plot(mrfi(max_norm = 2, norm_type = "1"))
plot(mrfi(max_norm = 2, norm_type = "m"))
plot(mrfi(max_norm = 2, norm_type = "1", positions = list(c(4,4))))

as.list(mrfi(1))
mrfi(1)[[1]]
mrfi(2)[[1:3]]

mrfi(1)
rpositions(list(c(1,0), c(0,1)))
mrfi(2)
mrfi(2, norm_type = "m")
mrfi(1, positions = list(c(4,4), c(-4,4)))


#Repeated positions are handled automatically
mrfi(1, positions = list(c(1,0), c(2,0)))

mrfi(1) + c(2,0)
mrfi(1) - c(1,0)
mrfi(1) + mrfi(0, positions = list(c(2,0)))
mrfi(2) - mrfi(1)
</code></pre>


</div>