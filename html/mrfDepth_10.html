<div class="container">

<table style="width: 100%;"><tr>
<td>depthContour</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Depth contours of multivariate data</h2>

<h3>Description</h3>

<p>Computes the vertices of depth contours of multivariate data. The contours can be
computed based on halfspace depth, projection depth, skewness-adjusted projection 
depth or directional projection depth. To make the actual plot for bivariate data, 
the function <code>plotContours</code> needs to be called on the result of <code>depthContour</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">depthContour(x, alpha = NULL, type = "hdepth", directions = NULL, options = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An <code class="reqn">n</code> by <code class="reqn">p</code> data matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>A vector containing the depth values of which the depth
contours have to be computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>The depth used in the computation of the contours:
<code>hdepth</code> for halfspace depth, <code>projdepth</code> for projection depth, 
<code>sprojdepth</code> for skewness-adjusted projection depth and 
<code>dprojdepth</code> for directional projection depth. <br>
Defaults to <code>hdepth</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>directions</code></td>
<td>
<p>An <code class="reqn">m</code> by <code class="reqn">p</code> matrix specifying the directions
on which to compute the vertices (see Details). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>options</code></td>
<td>
<p>A list of options to pass to <code>hdepth</code>, <code>projdepth</code>,
<code>sprojdepth</code> or <code>dprojdepth</code>.
In addition the following option may be specified:
</p>

<ul><li> <p><code>max.iter</code> <br>
The maximum number of iterations in the bisection algorithm used
to compute the depth contour corresponding to level alpha. <br>
Defaults to <code class="reqn">100</code>.

</p>
</li></ul>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Depth contours of level <code class="reqn">\alpha</code> (or <code class="reqn">\alpha</code>-depth contours) are the boundaries of depth regions. Depth regions of level <code class="reqn">\alpha</code> are defined as regions in space containing the multivariate points whose depth value is at least <code class="reqn">\alpha</code>.
</p>
<p>For bivariate data halfspace depth contours can be computed exactly following the algorithm in Ruts and Rousseeuw (1996). When the data are not in general position (i.e. when there is a line containing more than two observations) dithering is performed by adding random Gaussian noise to the data.
</p>
<p>In all other cases an approximated method is performed using a bisection algorithm. Intersections with the depth contours are searched on lines originating from the depth median. The user can specify a set of directions corresponding to these lines. By default a random set of <code class="reqn">250p</code> directions is considered. On each direction a point is searched having depth <code class="reqn">\alpha</code>. Starting limits are obtained by projecting the data on the direction and considering the data point with univariate depth <code class="reqn">\alpha</code>. By definition the multivariate depth of this point has to be lower or equal to <code class="reqn">\alpha</code>. A second limit is obtained by considering the deepest location estimate. The maximum number of iterations bisecting the current search interval can be specified through the options argument <code>max.iter</code>.  Note that this method is only affine or rotation equivariant if the chosen directions are affine or rotation equivariant.
</p>
<p>It is first checked whether the data is found to lie in a subspace of
dimension lower than <code class="reqn">p</code>. If so, the routine will give a warning, giving
back the dimension of the subspace together with a direction describing a
hyperplane containing this subspace.
</p>


<h3>Value</h3>

<p>The output consists of a list. Each element of the list contains the following elements for each value <code class="reqn">\alpha</code> specified in the argument <code>alpha</code>.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>depth</code></td>
<td>
<p>The depth of the depth contour of level <code class="reqn">\alpha</code>. For halfspace depth this is equal to <code class="reqn">floor(\alpha n)/n</code>. For projection depth, skewness-adjusted projection depth and directional depth, this equals to <code class="reqn">\alpha</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vertices</code></td>
<td>
<p>The coordinates of the vertices of the depth contour.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>empty</code></td>
<td>
<p>Logical indicating whether the corresponding depth region is empty. <br><code>FALSE</code> indicates the depth region is non-empty. <br><code>TRUE</code> indicates the depth region is empty. <br></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dithered</code></td>
<td>
<p>Logical indicating whether dithering has been applied in the exact bivariate algorithm based on halfspace depth. <br><code>FALSE</code> indicates no dithering has been applied. <br><code>TRUE</code> indicates dithering has been applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>converged</code></td>
<td>
<p>A vector of length <code class="reqn">m</code> containing a flag indicating for each direction whether convergence was reached by the bisecting algorithm within the allowed <code>max.iter</code> number of steps. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Same as input parameter type.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dimension</code></td>
<td>
<p>If the data are lying in a lower dimensional subspace, the dimension of this subspace.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hyperplane</code></td>
<td>
<p>If the data are lying in a lower dimensional subspace, a direction orthogonal to this subspace.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>P. Segaert based on Fortran code by  P.J. Rousseeuw, I. Ruts and A. Struyf</p>


<h3>References</h3>

<p>Ruts I., Rousseeuw P.J. (1996). Computing depth contours of bivariate point clouds. <em>Computational Statistics &amp; Data Analysis</em>, <b>23</b>, 153â€“168.
</p>


<h3>See Also</h3>

<p><code>plotContours</code>, <code>bagdistance</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
# Compute and plot some halfspace depth contours of a two-dimensional dataset. 
# The returned object is a ggplot2 object that may be edited 
# using standard ggplot2 commands.

# One may consider different depth functions such as projection depth 
# by changing the input parameter 'type'.
# By default the halfspace depth is used.
data(bloodfat)
Result &lt;- depthContour(x = bloodfat,
                       alpha = c(0.03, 0.125, 0.25))
plotContours(x = bloodfat, depthContour = Result)


# Other options are projection depth, skewness-adjusted projection depth
# and directional projection depth
# they can be used by specifying type to be
# "projdepth", "sprojdepth" or "dprojdepth" respectively.
# When there is skewness in the data projection depth
# is less appropriate. 

Result &lt;- depthContour(x = bloodfat,
                       alpha = c(0.25, 0.35, 0.45),
                       type = "projdepth")
plotContours(x = bloodfat, depthContour = Result)

# The skewness-adjusted projection depth and directional projection depth
# better reflect the skewness in the data.
Result &lt;- depthContour(x = bloodfat,
                       alpha = c(0.35, 0.45, 0.55),
                       type = "sprojdepth")
plotContours(x = bloodfat, depthContour = Result)

Result &lt;- depthContour(x = bloodfat,
                       alpha = c(0.25, 0.35, 0.45),
                       type = "dprojdepth")
plotContours(x = bloodfat, depthContour = Result)

</code></pre>


</div>