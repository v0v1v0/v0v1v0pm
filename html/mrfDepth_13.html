<div class="container">

<table style="width: 100%;"><tr>
<td>dprojdepth</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Directional projection depth of points relative to a dataset</h2>

<h3>Description</h3>

<p>Computes the directional projection depth of <code class="reqn">p</code>-dimensional
points <code>z</code> relative to a <code class="reqn">p</code>-dimensional dataset <code>x</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dprojdepth(x, z = NULL, options = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An <code class="reqn">n</code> by <code class="reqn">p</code> data matrix with observations
in the rows and variables in the columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>An optional <code class="reqn">m</code> by <code class="reqn">p</code> matrix containing
rowwise the points <code class="reqn">z_i</code> for which to compute
the directional projection depth. If <code>z</code> is not specified,
it is set equal to <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>options</code></td>
<td>
<p> A list of options to pass to the underlying <code>dirOutl</code> routine.
</p>
<p>See <code>dirOutl</code> for the full list of options. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Directional projection depth is based on the directional
outlyingness and is computed as <code class="reqn">1/(1+DO)</code>. As directional 
outlyingness extends the Stahel-Donoho outlyingness towards 
skewed distributions, the directional projection depth 
is suited for both elliptical distributions and skewed 
multivariate data.
</p>
<p>It is first checked whether the data is found to lie in a subspace of
dimension lower than <code class="reqn">p</code>. If so, a warning is given, as well as the
dimension of the subspace and a direction which is orthogonal to it.
</p>
<p>See <code>dirOutl</code> for more details on the computation of the DO.
To visualize the depth of bivariate data one can apply the 
<code>mrainbowplot</code> function. It plots the data colored according to 
their depth. 
</p>
<p>The output values of this function are based on the output of the 
<code>dirOutl</code> function. More details can be found there. 
</p>


<h3>Value</h3>

<p>A list with components: <br></p>
<table>
<tr style="vertical-align: top;">
<td><code>depthX</code></td>
<td>
<p>Vector of length <code class="reqn">n</code> giving the
directional projection depth of
the observations in x.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>depthZ</code></td>
<td>
<p>Vector of length <code class="reqn">m</code> giving the
directional projection depth of
the points in z.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>Points whose directional projection depth is smaller
than this cutoff can be considered as outliers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flagX</code></td>
<td>
<p>Observations of <code>x</code> whose directional outlyingness exceeds 
the cutoff receive a flag <code>FALSE</code>, regular observations 
receive a flag <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flagZ</code></td>
<td>
<p>Points of <code>z</code> whose directional outlyingness exceeds the 
cutoff receive a flag equal to <code>FALSE</code>, otherwise they 
receive a flag <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>singularSubsets</code></td>
<td>
<p>When the input parameter type is equal to <code>"Affine"</code>,
the number of <code class="reqn">p</code>-subsets that span a subspace of
dimension smaller than <code class="reqn">p-1</code>. In such a case the orthogonal
direction can not be uniquely determined. This is an indication
that the data are not in general position.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dimension</code></td>
<td>
<p>When the data <code>x</code> are lying in a
lower dimensional subspace, the dimension
of this subspace.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hyperplane</code></td>
<td>
<p>When the data <code>x</code> are lying in a lower dimensional 
subspace, a direction orthogonal to this subspace. When a 
direction <code class="reqn">v</code> is found such that the robust directional
scale of <code class="reqn">xv</code> is equal to zero, this equals <code class="reqn">v</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inSubspace</code></td>
<td>
<p>When a direction <code class="reqn">v</code> is found such that DO(<code class="reqn">xv</code>) is 
ill-defined, the observations from <code>x</code> which belong to 
the hyperplane orthogonal to <code class="reqn">v</code> receive a value TRUE. 
The other observations receive a value FALSE.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>J. Raymaekers</p>


<h3>References</h3>

<p>Rousseeuw, P.J., Raymaekers, J., Hubert, M. (2018). A measure of directional outlyingness with applications to image Data and video. <em>Journal of Computational and Graphical Statistics</em>, <b>27</b>, 345â€“359.
</p>


<h3>See Also</h3>

<p><code>dirOutl</code>, <code>dprojmedian</code>, <code>mrainbowplot</code>, <code>adjOutl</code>, <code>outlyingness</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Compute the directional projection depth 
# of a simple two-dimensional dataset.
# Outliers are plotted in red.

data(bloodfat)
Result &lt;- dprojdepth(x = bloodfat)
IndOutliers &lt;- which(!Result$flagX)
plot(bloodfat)
points(bloodfat[IndOutliers,], col = "red")

# A multivariate rainbowplot may be obtained using mrainbowplot.
plot.options = list(legend.title = "DPD")
mrainbowplot(x = bloodfat, 
             depths = Result$depthX, plot.options = plot.options)

# Options for the underlying outlyingness routine may be passed 
# using the options argument. 
Result &lt;- dprojdepth(x = bloodfat, 
                     options = list(type = "Affine", ndir=100))

</code></pre>


</div>