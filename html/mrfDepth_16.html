<div class="container">

<table style="width: 100%;"><tr>
<td>fom</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Draws the Functional Outlier Map (FOM)</h2>

<h3>Description</h3>

<p>Creates the Functional Outlier Map, a graphical tool to detect outliers in multivariate functional data. Depending on the position of a multivariate curve in the FOM, different types of outliers may be distinguished. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">fom(fOutlResult, cutoff = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fOutlResult</code></td>
<td>
<p>The return of a call to <code>fOutl</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>Boolean indicating whether the cutoff should be drawn.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The fom is only applicable when <code>fOutl</code> is called with the following options: <code>diagnostic = TRUE</code> and <code>type</code> equaling either <code>fAO</code> or <code>fDO</code>.
</p>
<p>The functional outlier map was proposed by Hubert et al. (2015) and subsequently improved by Rousseeuw et al. (2018). It consists of a graphical tool to detect outliers in multivariate functional data based on functional outlyingness measures such as the <code class="reqn">fAO</code> or <code class="reqn">fDO</code> (see <code>fOutl</code>). 
</p>
<p>The coordinates of the points in the FOM correspond to two outlyingness indicators. On the horizontal axis, the functional outlyingness as obtained by the routine <code>fOutl</code> is plotted. On the vertical axis the scaled standard deviation of the cross-sectional outlyingness measures across time are plotted. The FOM thus consists of the following points representing the curve <code class="reqn">i</code>: <code class="reqn">(fOutl_i; std_j(fOutl_i(t_j)) / (1 + fOutl_i))</code>. The scaling of the standard deviation is added to ensure that curves with a different location, measured from the center, but with the same relative variability have a similar <code class="reqn">y</code>-coordinate. 
</p>
<p>For some underlying multivariate outlyingness measures, the output of <code>fOutl</code> contains an additional argument signaling whether curve <code class="reqn">i</code> is outlying as measured in the multivariate space at time point <code class="reqn">j</code>. This information is incorporated in the FOM by plotting the points with a different degree of outlyingness by a different symbol. Curves that are outlying in the multivariate space determined by at least <code class="reqn">75\%</code> of the total number of time points in the domain are plotted using filled diamonds. Similarly curves that are outlying in at least <code class="reqn">50\%</code> or <code class="reqn">25\%</code> of the time points are plotted in filled squares and filled triangles respectively. Curves that are outlying in fewer than <code class="reqn">25\%</code> of the time points are plotted using filled circles. 
</p>
<p>The user may opt to draw a cutoff curve for the detection of outliers on the FOM.
This cutoff was introduced in Rousseeuw et al. (2018) and is based on the euclidean
distance between the points on the FOM and the origin, after scaling with the median.
More specifically, let <code class="reqn">(fOutl_i;vOutl_i) = (fOutl_i; std_j(fOutl_i(t_j)) / (1 + fOutl_i))</code> and 
let <code class="reqn">cOutl_i^2 = (fOutl_i / median(fOutl))^2 + (vOutl_i / median(vOutl))^2</code>.
Finally, with <code class="reqn">lcOutl_i = \log(0.1 + coutl_i)</code>,an observation lies outside of the cutoff when 
<code class="reqn">(lcOutl_i - median(lcOutl)) / mad(lcOutl) &gt; \Phi^{-1}(0.995)</code>.
</p>
<p>This FOM may be read in a way similar to the outlier map of robust regression (Rousseeuw and van Zomeren 1990) and the outlier map of
robust principal components (Hubert et al. 2005). Points in the lower left part of the FOM represent regular curves which hold a central position in the dataset. Points in the lower right part are curves with a high <code class="reqn">fOutl</code> but a low variability of their cross-sectional <code class="reqn">fOutl</code> values. This happens for shift outliers, i.e. curves which have the same shape as the majority but are shifted on the whole domain. Points in the upper left part have a low <code class="reqn">fOutl</code> but a high variability in cross-sectional <code class="reqn">fOutl</code>. Typical examples are isolated outliers, i.e. cuves which only display outlyingness over a small part of their domain.
The points in the upper right part of the FOM have both a high <code class="reqn">fOutl</code> and a high cross-sectional <code class="reqn">fOutl</code>. These correspond to curves which are strongly outlying on a substantial part of their domain. 
</p>


<h3>Author(s)</h3>

<p>P. Segaert</p>


<h3>References</h3>

<p>Hubert M., Rousseeuw P.J., Segaert P. (2015). Multivariate functional outlier detection (with rejoinder). <em>Statistical Methods &amp; Applications</em>, <b>24</b>, 177–202.
</p>
<p>Rousseeuw P.J., Raymaekers J., Hubert M., (2018). A measure of directional outlyingness with applications to image data and video. <em>Journal of Computational and Graphical Statistics</em>, <b>27</b>, 345–359.
</p>


<h3>See Also</h3>

<p><code>fOutl</code></p>


<h3>Examples</h3>

<pre><code class="language-R">data(octane)

# To construct the FOM, one first need to compute
# the functional outlyingness.
# Note that the option diagnostic in fOutl must be 
# set to TRUE. If not calling fom will result in an 
# error
Result &lt;- fOutl(octane, alpha = 0, type = "fAO", diagnostic = TRUE)
fom(Result)

# The user may opt to draw a cut off line seperating the outliers.
# which will be plotted in red
fom(Result, cutoff = TRUE)

# Six observations are flagged as outliers. These correspond to 
# the samples with added ethanol. 
</code></pre>


</div>