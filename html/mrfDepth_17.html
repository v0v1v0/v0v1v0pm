<div class="container">

<table style="width: 100%;"><tr>
<td>fOutl</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Functional outlyingness measures for functional data</h2>

<h3>Description</h3>

<p>Computes several measures of functional outlyingness for multivariate 
functional data. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">  fOutl(x, z = NULL, type = "fAO", alpha = 0, time = NULL, 
        diagnostic = FALSE, distOptions = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A three dimensional <code class="reqn">t</code> by <code class="reqn">n</code> by <code class="reqn">p</code> array,
with <code class="reqn">t</code> the number of observed time points,
<code class="reqn">n</code> the number of functional observations
and <code class="reqn">p</code> the number of measurements
for every functional observation at every time point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>An optional three-dimensional <code class="reqn">t</code> by <code class="reqn">m</code> by <code class="reqn">p</code> 
array, containing the observations for which to compute the 
functional outlyingness with respect to <code>x</code>. 
If <code>z</code> is not specified, it is set equal to <code>x</code>. 
The time points of <code>z</code> should correspond to those of 
<code>x</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>The outlyingness measure used in the computations.
One of the following options: <code>"fAO"</code>, <code>"fSDO"</code>,
<code>"fDO"</code> or <code>"fbd"</code>. <br>
Defaults to <code>"fAO"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Specifies the weights at every cross-section. 
When <code>alpha = 0</code>, uniform weights are used. Otherwise
<code>alpha</code> should be a weight vector of length <code class="reqn">t</code>. <br>
Defaults to 0. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>If the measurements are not equidistant, 
a sorted numeric vector containing a set of time points. <br>
Defaults to <code>1:t</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diagnostic</code></td>
<td>
<p>If set to <code>TRUE</code>, the output contains some additional 
components: <br> 
crossDists: an <code class="reqn">n</code> by <code class="reqn">t</code> matrix containing the 
multivariate outlyingness of each observation at each time 
point <br>
locOutl: output containing flags for local outlyingness 
(see "Value" for more details)
<br>
Defaults to FALSE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distOptions</code></td>
<td>
<p>A list of options to pass to the function
computing the cross-sectional distances. <br>
See <code>adjOutl</code>, <code>outlyingness</code>, <code>dirOutl</code>, or
<code>bagdistance</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The functional outlyingness of a multivariate curve with respect to a 
given set of multivariate curves is defined as the weighted average of its 
multivariate outlyingness at each time point (Hubert et al., 2015). 
The functional outlyingness can be computed in all dimensions <code class="reqn">p</code> using
the adjusted outlyingness (<code>fAO</code>), the directional outlyingness (<code>fDO</code>), 
the Stahel-Donoho outlyingness (<code>fSDO</code>) or the bagdistance (<code>fbd</code>). 
</p>
<p>When the data array <code>z</code> is specified, the functional outlyingness and diagnostic 
information for the data array <code>x</code> is also returned whenever the underlying
outlyingness routine allows it. For more information see the specific routines 
listed in the section "See Also".
</p>
<p>In some situations, additional diagnostics are available to flag outlying time 
points. At each time point, observations from the data array <code>x</code> are marked
if they are flagged as outliers. The observations from the data array <code>x</code> 
are marked if their scaled outlyingness is larger than a prescribed cutoff value
from the chi-square distribution. For more details see the respective 
outlyingness routines.
</p>
<p>It is possible that at certain time points a part of the algorithm can not be 
executed due to e.g. exact fits. In that case the weight of that particular time
point is set to zero. A warning is issued at the end of the algorithm to signal 
these time points. Furthermore the output contains an extra argument giving the 
indices of the time points where problems occured.
</p>


<h3>Value</h3>

<p>A  list with the following
components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>fOutlyingnessX</code></td>
<td>
<p>Vector of length <code class="reqn">n</code> containing the 
functional outlyingness of every curve
from <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fOutlyingnessZ</code></td>
<td>
<p>Vector of length <code class="reqn">m</code> containing the 
functional outlyingness of every curve
from <code>z</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Vector of weights according to the input parameter 
<code>alpha</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crossDistsX</code></td>
<td>
<p>An <code class="reqn">n</code> by <code class="reqn">t</code> matrix containing the multivariate
outlyingness of each observation of <code>x</code> at each point. 
Only provided if the input parameter <code>diagnostic</code> is 
set to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crossDistsZ</code></td>
<td>
<p>An <code class="reqn">m</code> by <code class="reqn">t</code> matrix containing the multivariate
outlyingness of each observation of <code>z</code> at each point. 
Only provided if the input parameter <code>diagnostic</code> is 
set to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>locOutlX</code></td>
<td>
<p>An <code class="reqn">n</code> by <code class="reqn">t</code> matrix flagging local outlyingness for 
<code>x</code>. Only provided if the input parameter <code>diagnostic</code>
is set to TRUE.<br>
The <code class="reqn">(i,j)</code>th element takes value 1 if curve 
<code class="reqn">x_i</code> is outlying at time point <code class="reqn">j</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>locOutlZ</code></td>
<td>
<p>An <code class="reqn">m</code> by <code class="reqn">t</code> matrix flagging local outlyingness for 
<code>z</code>. Only provided if the input parameter <code>diagnostic</code>
is set to TRUE.<br>
The <code class="reqn">(i,j)</code>th element takes value 1 if curve 
<code class="reqn">z_i</code> is outlying at time point <code class="reqn">j</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IndFlagExactFit</code></td>
<td>
<p>Vector containing the indices of the
time points for which an exact fit is
detected.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>P. Segaert</p>


<h3>References</h3>

<p>Hubert M., Rousseeuw P.J., Segaert P. (2015). Multivariate functional outlier detection (with rejoinder).
<em>Statistical Methods and Applications,</em> <b>24</b>, 177–202.
</p>
<p>Hubert M., Rousseeuw P.J., Segaert P. (2017). Multivariate and functional classification using depth and distance. <em>Advances in Data Analysis and Classification</em>, <b>11</b>, 445–466.
</p>


<h3>See Also</h3>

<p><code>bagdistance</code>, <code>outlyingness</code>, <code>adjOutl</code>, <code>dirOutl</code>, <code>fom</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(octane)
Data &lt;- octane

# When the option diagnostic is set to TRUE, a crude diagnostic
# to detect outliers can be extracted from the local outlyingness
# indicators. 
Result &lt;- fOutl(x = Data, type = "fAO", diagnostic = TRUE)
matplot(Data[,,1], type = "l", col = "black", lty = 1)
for (i in 1:dim(Data)[2]) {
  if(sum(Result$locOutlZ[i, ]) &gt; 0) {
    obsData &lt;- matrix(Data[,i,1], nrow = 1)
    obsData[!Result$locOutlZ[i,]] &lt;- NA
    obsData &lt;- rbind(obsData, obsData)
    matpoints(t(obsData), col = "red", pch = 15)
  }
}
# For more advanced outlier detection techniques, see the 
# fom routine.
</code></pre>


</div>