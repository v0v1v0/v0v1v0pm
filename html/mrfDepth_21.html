<div class="container">

<table style="width: 100%;"><tr>
<td>hdepthmedian</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Location estimates based on halfspace depth.</h2>

<h3>Description</h3>

<p>Computes the halfspace median and its corresponding
halfspace depth for a <code class="reqn">p</code>-dimensional data set <code>x</code>.  Computation is exact for <code class="reqn">p \le 2</code> and approximate for <code class="reqn">p &gt; 2</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hdepthmedian(x, maxdir = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An <code class="reqn">n</code> by <code class="reqn">p</code> data matrix.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxdir</code></td>
<td>
<p>The number of projections used in the approximate algorithm. <br>
Defaults to <code class="reqn">250p</code>. 
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The halfspace median, or Tukey median, is the multivariate point with largest halfspace depth with respect to the data <code>x</code>. This point is not always unique. In that case the halfspace median corresponds to the center of gravity of the convex set of deepest points.
</p>
<p>It is first checked whether the data is found to lie in a subspace of
dimension lower than <code class="reqn">p</code>. If so, the routine will give a warning, giving
back the dimension of the subspace together with a direction describing a
hyperplane containing this subspace.
</p>
<p>For bivariate data the exact algorithm of Rousseeuw and Ruts (1998) is applied. 
When the data are not in general position (i.e. when there is a line containing more than two observations) dithering is performed by adding random Gaussian noise to the data. In this case the output argument <code>dithered</code> will contain a flag. 
</p>
<p>When <code class="reqn">p &gt; 2</code> the approximate algorithm of Struyf and Rousseeuw (2000) is applied. It is an iterative procedure based on projections. Their number can be chosen by the input parameter <code>maxdir</code>.
</p>


<h3>Value</h3>

<p>A  list containing: <br></p>
<table>
<tr style="vertical-align: top;">
<td><code>median</code></td>
<td>
<p>The coordinates of the halfspace median.<br>
Approximate when <code class="reqn">p&gt;2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>depth</code></td>
<td>
<p>The halfspace depth of the halfspace median. <br>
Approximate when <code class="reqn">p&gt;2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dithered</code></td>
<td>
<p>Logical indicating whether dithering has been applied in the exact algorithm. <br><code>FALSE</code> indicates no dithering has been applied. <br><code>TRUE</code> indicates dithering has been applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndir</code></td>
<td>
<p>The number of projections used by the approximate algorithm. Due to the possibility of singularity of certain <code class="reqn">p</code> subsamples it is possible that not all <code>maxdir</code> directions are evaluated. <br></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AlgStopFlag</code></td>
<td>
<p>Indicates which stopping rule is used by the approximate algorithm.<br>
0 indicates the maximum number of projections was reached <br>
1 indicates no improvement of the location estimate was
made after <code class="reqn">10(p+1)</code> steps.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dimension</code></td>
<td>
<p>If the data are lying in a lower dimensional subspace, the dimension of this subspace.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hyperplane</code></td>
<td>
<p>If the data are lying in a lower dimensional subspace, a direction orthogonal to this subspace.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>P. Segaert based on Fortran code by P.J. Rousseeuw, I. Ruts and A. Struyf</p>


<h3>References</h3>

<p>Rousseeuw P.J., Ruts I. (1998). Constructing the bivariate Tukey median. <em>Statistica Sinica</em>, <b>8</b>, 827–839.
</p>
<p>Struyf A., Rousseeuw P.J. (2000). High-dimensional computation of the deepest location. <em>Computational Statistics &amp; Data Analysis</em>, <b>34</b>, 415–436.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Compute a location estimate of a two-dimensional dataset.
data(cardata90)
Result &lt;- hdepthmedian(x = cardata90)
plot(cardata90, pch = 16)
points(Result$median, col = "red", pch = 18, cex = 1.5)
</code></pre>


</div>