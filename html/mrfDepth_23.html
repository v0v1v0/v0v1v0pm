<div class="container">

<table style="width: 100%;"><tr>
<td>mfd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multivariate functional depth for functional data</h2>

<h3>Description</h3>

<p>Computes the multivariate functional depth for multivariate functional data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  mfd(x, z = NULL, type = "hdepth", alpha = 0, time = NULL, diagnostic = FALSE,
      depthOptions = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A three-dimensional <code class="reqn">t</code> by <code class="reqn">n</code> by <code class="reqn">p</code> array,
with <code class="reqn">t</code> the number of observed time points,
<code class="reqn">n</code> the number of functional observations
and <code class="reqn">p</code> the number of measurements
for every functional observation at every time point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>An optional three-dimensional <code class="reqn">t</code> by <code class="reqn">m</code> by <code class="reqn">p</code> 
array, containing the observations for which to compute the 
multivariate functional depth with respect to <code>x</code>. 
If <code>z</code> is not specified, it is set equal to <code>x</code>. 
The time points of <code>z</code> should correspond to those of 
<code>x</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>The depth used in the computations.
One of the following options: <code>"hdepth"</code>,
<code>"projdepth"</code>, <code>"sprojdepth"</code>, <code>"dprojdepth"</code>,
<code>"sdepth"</code>. <br>  Defaults to <code>"hdepth"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Specifies the weights at every cross-section. 
When <code>alpha = 0</code>, uniform weights are used. Weights 
following equation (2) in Claeskens et al. (2014) are obtained 
by setting <code>alpha</code> to a number smaller than the maximal 
depth at any time point. The weights are then proportional to 
the volume of the <code class="reqn">\alpha</code>-depth regions at each 
cross-section. Otherwise <code>alpha</code> should be a weight vector 
of length <code class="reqn">t</code>. <br>
Defaults to 0. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>If the measurements are not equidistant, 
a sorted numeric vector containing a set of time points. <br>
Defaults to <code>1:t</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diagnostic</code></td>
<td>
<p>If set to <code>TRUE</code>, the output contains some additional 
components: <br><code>crossDepths</code>: an <code class="reqn">n</code> by <code class="reqn">t</code> matrix containing the 
multivariate depth of each observation at each time point <br><code>locOutl</code>: output containing flags for local outlyingness 
(see "Value" for more details)
<br>
Defaults to FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>depthOptions</code></td>
<td>
<p>A list of options to pass to the function
computing the cross-sectional depths. <br>
See <code>hdepth</code>, <code>projdepth</code>, <code>sprojdepth</code>,
<code>dprojdepth</code> or <code>sdepth</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The multivariate functional depth of a multivariate curve with respect to a 
given set of multivariate curves is defined as the weighted average of its 
multivariate depth at each time point (Claeskens et al., 2014). 
The MFD can be computed in all dimensions <code class="reqn">p</code> using halfspace depth, 
projection depth, skewness-adjusted projection depth and directional projection depth. 
For <code class="reqn">p&lt;=2</code> also simplicial depth is available. 
</p>
<p>When the data array <code>z</code> is specified, the MFD depth and diagnostic 
information for the data array <code>x</code> is also returned whenever the underlying
depth routine allows it. For more information see the specific depth routines 
listed in the section "See Also".
</p>
<p>For the weight vector, three options are available: uniform weights, 
user-defined weights or weights proportional to the volume of the 
<code class="reqn">\alpha</code>-depth contour at each time point. 
The <code class="reqn">\alpha</code>-depth contours are computed using the <code>depthContour</code> function. 
</p>
<p>In some situations, additional diagnostics are available to flag outlying time 
points, as described in Hubert et al. (2012). At each time point, observations 
from the data array <code>x</code> are marked if they are flagged as outliers. 
When using any of the projection depth measures, this flag is automatically 
returned by the corresponding functions. When using halfspace depth, 
the diagnostic is only available for bivariate curves. The observations 
from the data array <code>x</code> are marked if they are flagged as outliers by the 
bagplot, or similarly if their <code>bagdistance</code> is larger than 3 at that time 
point. This can be seen as a measure of local outlyingness. The option is not 
available for simplicial depth. 
</p>
<p>A heatmap of the cross-sectional depth values can be drawn by setting <code>diagnostic</code>
to TRUE and passing the results to <code>fHeatmap</code>.
</p>
<p>It is possible that at certain time points a part of the algorithm can not be 
executed due to e.g. exact fits. In that case the weight of that particular time
point is set to zero. A warning is issued at the end of the algorithm to signal 
these time points. Furthermore the output contains an extra argument giving the 
indices of the time points where problems occured.
</p>


<h3>Value</h3>

<p>A  list with the following  components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>MFDdepthX</code></td>
<td>
<p>Vector of length <code class="reqn">n</code> containing the MFD depth
of every curve from <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MFDdepthZ</code></td>
<td>
<p>Vector of length <code class="reqn">m</code> containing the MFD depth
of every curve from <code>z</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Vector of weights according to the input parameter 
<code>alpha</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crossDepthsX</code></td>
<td>
<p>An <code class="reqn">n</code> by <code class="reqn">t</code> matrix containing the multivariate
depth of each observation of <code>x</code> at each time point.<br> Only 
provided if the input parameter <code>diagnostic</code> is set to 
<code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crossDepthsZ</code></td>
<td>
<p>An <code class="reqn">m</code> by <code class="reqn">t</code> matrix containing the multivariate
depth of each observation of <code>z</code> at each time point.<br> Only 
provided if the input parameter <code>diagnostic</code> is set to 
<code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>locOutlX</code></td>
<td>
<p>An <code class="reqn">n</code> by <code class="reqn">t</code> matrix flagging local outlyingness for 
<code>x</code>. Only provided if the input parameter <code>diagnostic</code>
is set to TRUE.<br>
The <code class="reqn">(i,j)</code>th element takes value 1 if curve 
<code class="reqn">x_i</code> is outlying at time point <code class="reqn">j</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>locOutlZ</code></td>
<td>
<p>An <code class="reqn">m</code> by <code class="reqn">t</code> matrix flagging local outlyingness for 
<code>z</code>. Only provided if the input parameter <code>diagnostic</code>
is set to TRUE.<br>
The <code class="reqn">(i,j)</code>th element takes value 1 if curve 
<code class="reqn">z_i</code> is outlying at time point <code class="reqn">j</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IndFlagExactFit</code></td>
<td>
<p>Vector containing the indices of the
time points for which an exact fit is
detected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IndFlagBag</code></td>
<td>
<p>Vector containing the indices of the
time points for which the bagplot could
not be computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IndFlagIso</code></td>
<td>
<p>Vector containing the indices of the time
points for which the cross-sectional <code class="reqn">\alpha</code>-depth 
contours could not be computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IndFlagAlpha</code></td>
<td>
<p>Vector containing the indices of the
time points for which the volume of the
cross-sectional <code class="reqn">\alpha</code>-depth contours could not
be computed.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>P. Segaert and M. Hubert</p>


<h3>References</h3>

<p>Claeskens G., Hubert M., Slaets L., Vakili K. (2014). Multivariate functional halfspace depth.
<em>Journal of the American Statistical Association,</em> <b>109</b>, 411–423.
</p>
<p>Hubert M., Claeskens G., De Ketelaere B., Vakili K. (2012).
A new depth-based approach for detecting outlying curves. 
In <em>Proceedings of COMPSTAT 2012, edited by A. Colubi, K. Fokianos, G. Gonzalez-Rodriguez, E.J. Kontoghiorghes,</em> 329–340. 
</p>


<h3>See Also</h3>

<p><code>depthContour</code>, <code>hdepth</code>, <code>projdepth</code>, 
<code>sprojdepth</code>, <code>dprojdepth</code>, <code>sdepth</code>,
<code>fHeatmap</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(octane)
Result &lt;- mfd(x = octane, alpha = 0.125, diagnostic = TRUE)

Plot &lt;- fHeatmap(rowValues = Result$MFDdepthZ,
                 cellValues = Result$crossdepthZ,
                 type = "depth",
                 legend.title = "HD")
Plot 
</code></pre>


</div>