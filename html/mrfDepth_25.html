<div class="container">

<table style="width: 100%;"><tr>
<td>mrainbowplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Rainbow plot for bivariate data</h2>

<h3>Description</h3>

<p>Makes a scatterplot of bivariate data and colors the observations according to their depth value.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mrainbowplot(x, depths, col = NULL, plot.options = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An <code class="reqn">n</code> by 2 data matrix.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>depths</code></td>
<td>
<p>A column vector of length <code class="reqn">n</code>. <br>
The depth values of the observations in <code>x</code>. The coloring
is based on these depth values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>An <code class="reqn">m &gt; 2</code> by 3 matrix. <br>
Colors in rgb format. The user may use this argument to set the colorscale of the depth range. The first row should contain the rgb values for the lowest depth value, the last row the rgb values of the color for the deepest depth value. Colors for other depth values are interpolated. When more than two rows are provided the color range will be equidistantly divided over the different colors.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.options</code></td>
<td>
<p>A list of available options:
</p>

<ul>
<li>
<p>legend.title Title of the legend. <br>
Defaults to <code>"Depth"</code>.
</p>
</li>
<li>
<p>point.size Numeric defining the size of the points in the plot. <br>
Defaults to 4.
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The plot is made using ggplot2. The plot itself is returned by the function and is fully customisable using standard ggplot2 commands. Similar plots for multivariate data with <code class="reqn">p &gt; 2</code> can be made using the ggpairs function in the library <code>GGally</code>. 
</p>


<h3>Author(s)</h3>

<p>P. Segaert</p>


<h3>Examples</h3>

<pre><code class="language-R">data(cardata90)
Result &lt;- projdepth(x = cardata90)
plot.options &lt;- list(legend.title = "PD")
plot &lt;- mrainbowplot(cardata90,
                     depths = Result$depthZ, 
                     plot.options = plot.options)
plot + ggtitle("Rainbowplot based on projection depth")

# The default color range may be adjusted using the col argument.
RGBmatrix &lt;- c(1, 0, 0, #Red
               1, 1, 1, #White
               0, 1, 0) #Green
RGBmatrix &lt;- matrix(RGBmatrix, ncol = 3, byrow = TRUE)
plot &lt;- mrainbowplot(cardata90, 
                     depths = Result$depthZ, 
                     col = RGBmatrix,
                     plot.options = plot.options)
plot + ggtitle("Rainbowplot based on projection depth")
</code></pre>


</div>