<div class="container">

<table style="width: 100%;"><tr>
<td>bagplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Draws a bagplot, a bivariate boxplot</h2>

<h3>Description</h3>

<p>This function draws a bagplot of bivariate data, based on the result of a call to <code>compBagplot</code>. The bagplot is a generalisation of the univariate boxplot to bivariate data. It aims to visualize the location, spread, skewness and outliers of the data set. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">bagplot(compbag.result,
        colorbag = NULL, colorloop = NULL, colorchull = NULL,
        databag = TRUE, dataloop = TRUE, plot.fence = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>compbag.result</code></td>
<td>
<p>The return of a call to <code>compBagplot</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colorbag</code></td>
<td>
<p>The color of the bag (which contains the 50% observations with largest depth).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colorloop</code></td>
<td>
<p>The color of the loop (which contains the regular observations).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colorchull</code></td>
<td>
<p>When the bagplot is based on halfspace depth, the depth region with maximal depth is plotted. This argument controls its color.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>databag</code></td>
<td>
<p>Logical indicating whether data points inside the bag need to be plotted. <br>
Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataloop</code></td>
<td>
<p>Logical indicating whether data points inside the fence need to be plotted. <br>
Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.fence</code></td>
<td>
<p>Logical indicating whether the fence should be plotted. <br>
Defaults to <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The bagplot has been proposed by Rousseeuw et al. (1999) as a generalisation of the boxplot to bivariate data. It is constructed based on halfspace depth and as such is invariant under affine transformations. Similar graphical representations can be obtained by means of other depth functions, as illustrated in Hubert and Van der Veeken (2008) and in Hubert et al. (2015). See <code>compBagplot</code> for more details.
</p>
<p>The deepest point is indicated by a red diamond symbol, the outlying observations by red stars.
</p>
<p>The plot is made using <code>ggplot2</code>. The plot itself is returned by the function and is fully customisable using standard <code>ggplot2</code> commands.
</p>


<h3>Author(s)</h3>

<p>P. Segaert</p>


<h3>References</h3>

<p>Rousseeuw P.J., Ruts I., Tukey J.W. (1999). The bagplot: a bivariate boxplot. <em>The American Statistician</em>, <b>53</b>, 382–387.
</p>
<p>Hubert M., Van der Veeken S. (2008). Outlier detection for skewed data. <em>Journal of Chemometrics</em>, <b>22</b>, 235–246.
</p>
<p>Hubert M., Rousseeuw P.J., Segaert P. (2015). Rejoinder of 'Multivariate functional outlier detection'. <em>Statistical Methods &amp; Applications</em>, <b>24</b>, 269–277.
</p>


<h3>See Also</h3>

<p><code>compBagplot</code>, <code>hdepth</code>, <code>projdepth</code>, <code>sprojdepth</code>,
<code>dprojdepth</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(bloodfat)

# The bagplot can be plotted based on halfspace depth, projection depth,
# skewness-adjusted projection depth or directional projection depth.
# Note that projection depth is not appropiate for skewed data.
# bagplot(compBagplot(bloodfat))
bagplot(compBagplot(bloodfat, type = "projdepth"))
bagplot(compBagplot(bloodfat, type = "dprojdepth"))

# The main features of the bagplot can easily be adjusted.
result &lt;- compBagplot(bloodfat, type = "projdepth")
bagplot(result, databag = FALSE, dataloop = FALSE)
bagplot(result, colorbag = rgb(0.2, 0.2, 0.2), colorloop = "lightgreen")

data(cardata90)
result &lt;- compBagplot(cardata90, type = "projdepth")
bagplot(result)

# Compared to the original paper on the bagplot,
# an additional outlier is identified. However this
# point lies very close to the fence and this may be
# attributed to differences in numerical rounding.
# This may be illustrated by plotting the fence.
plot &lt;- bagplot(result, plot.fence = TRUE)
plot

# The returned object is a ggplot2 object and may be
# edited using standard ggplot2 commands.
library("ggplot2")
plot + ylab("Engine displacement") + xlab("Weight in pounds")
</code></pre>


</div>