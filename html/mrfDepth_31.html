<div class="container">

<table style="width: 100%;"><tr>
<td>projdepth</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Projection depth of points relative to a dataset</h2>

<h3>Description</h3>

<p>Computes the projection depth of <code class="reqn">p</code>-dimensional points <code>z</code>
relative to a <code class="reqn">p</code>-dimensional dataset <code>x</code>. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">projdepth(x, z = NULL, options = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An <code class="reqn">n</code> by <code class="reqn">p</code> data matrix with observations
in the rows and variables in the columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>An optional <code class="reqn">m</code> by <code class="reqn">p</code> matrix containing
rowwise the points <code class="reqn">z_i</code> for which to compute
the projection depth. If <code>z</code> is not specified,
it is set equal to <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>options</code></td>
<td>
<p> A list of options to pass to the underlying <code>outlyingness</code> routine. <br>
See <code>outlyingness</code> for the full list of options. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Projection depth is based on the Stahel-Donoho outlyingness (SDO) and is computed as <code class="reqn">1/(1+SDO)</code>. It is mostly suited to measure the degree of outlyingness of multivariate points with respect to a data cloud from an elliptical distribution.
</p>
<p>It is first checked whether the data lie in a subspace of dimension smaller than <code class="reqn">p</code>. If so, a warning is given, as well as the dimension of the subspace and a direction which is orthogonal to it.
</p>
<p>See <code>outlyingness</code> for more details on the computation of the SDO. To visualize the depth of bivariate data one can apply the <code>mrainbowplot</code> function. It plots the data colored according to their depth. 
</p>
<p>The output values of this function are based on the output of the <code>outlyingness</code> function. More details can be found there. 
</p>


<h3>Value</h3>

<p>A list with components: <br></p>
<table>
<tr style="vertical-align: top;">
<td><code>depthX</code></td>
<td>
<p>Vector of length <code class="reqn">n</code> giving the projection depth
of the observations in <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>depthZ</code></td>
<td>
<p>Vector of length <code class="reqn">m</code> giving the projection depth
of the points in <code>z</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>Points whose projection depth is smaller than this
cutoff can be considered as outliers. Equivalently the 
outliers are those points whose Stahel-Donoho outlyingness
exceed the corresponding cutoff.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flagX</code></td>
<td>
<p>Observations of <code>x</code> whose projection depth is smaller than
the cutoff receive a flag <code>FALSE</code>, regular observations receive a flag <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flagZ</code></td>
<td>
<p>Points of <code>z</code> whose projection depth is smaller than the cutoff
receive a flag equal to <code>FALSE</code>, otherwise they receive a flag <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>singularSubsets</code></td>
<td>
<p>When the input parameter type is equal to <code>"Affine"</code>, the number of <code class="reqn">p</code>-subsets that span a subspace of dimension smaller than <code class="reqn">p-1</code>. In that case the orthogonal direction can not be uniquely determined. This is an indication that the data are not in general position.   When the input parameter type is equal to <code>"Rotation"</code> it is possible that two randomly selected points of the data coincide due to ties in the data. In this case this value signals how many times this happens.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dimension</code></td>
<td>
<p>When the data <code>x</code> are lying in a lower dimensional subspace, the dimension of this subspace.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hyperplane</code></td>
<td>
<p>When the data <code>x</code> are lying in a lower dimensional subspace, a direction orthogonal to this subspace. When a direction <code class="reqn">v</code> is found such that the robust scale of <code class="reqn">xv</code> is equal to zero, this equals <code class="reqn">v</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inSubspace</code></td>
<td>
<p>When a direction <code class="reqn">v</code> is found such that the robust scale of <code class="reqn">xv</code> is zero, the observations from <code>x</code> which belong to the hyperplane orthogonal to <code class="reqn">v</code> receive a value TRUE. The other observations receive a value FALSE.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>P. Segaert</p>


<h3>References</h3>

<p>Zuo Y. (2003). Projection-based depth functions and associated medians.  <em>The Annals of Statistics</em>, <b>31</b>, 1460â€“1490.
</p>


<h3>See Also</h3>

<p><code>outlyingness</code>, <code>projmedian</code>, <code>mrainbowplot</code>, <code>adjOutl</code>, <code>dirOutl</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Compute the projection depth of a simple two-dimensional dataset.
# Outliers are plotted in red.

if (requireNamespace("robustbase", quietly = TRUE)) {
    BivData &lt;- log(robustbase::Animals2)
} else {
  BivData &lt;- matrix(rnorm(120), ncol = 2)
  BivData &lt;- rbind(BivData, matrix(c(6,6, 6, -2), ncol = 2))
}

Result &lt;- projdepth(x = BivData)
IndOutliers &lt;- which(!Result$flagX)
plot(BivData)
points(BivData[IndOutliers,], col = "red")

# A multivariate rainbowplot may be obtained using mrainbowplot.
plot.options = list(legend.title = "PD")
mrainbowplot(x = BivData, 
             depths = Result$depthX, plot.options = plot.options)

# Options for the underlying outlyingness routine may be passed 
# using the options argument. 
Result &lt;- projdepth(x = BivData, 
                    options = list(type = "Affine",
                                   ndir = 1000,
                                   stand = "MedMad",
                                   h = nrow(BivData)
                                   )
                   )

</code></pre>


</div>