<div class="container">

<table style="width: 100%;"><tr>
<td>projmedian</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Location estimates based on projection depth</h2>

<h3>Description</h3>

<p>Computes a projection depth based location estimate of a <code class="reqn">p</code>-dimensional 
dataset <code>x</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">projmedian(x, projection.depths = NULL, options = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An <code class="reqn">n</code> by <code class="reqn">p</code> data matrix with observations
in the rows and variables in the columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>projection.depths</code></td>
<td>
<p>Vector containing the projection depth of the observations in <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>options</code></td>
<td>
<p>A list of options to pass to the <code>projdepth</code> routine.
See <code>projdepth</code> for more details. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The algorithm depends on the function <code>projdepth</code> to compute the
projection depth of the observations in <code>x</code>. If these depth values have already been computed, they can be passed as an optional
argument to save computing time. If not, the projection depth values will be
computed and the user can pass a list with options to the
<code>projdepth</code> function.
</p>
<p>It is first checked whether the data lie in a subspace of dimension smaller 
than <code class="reqn">p</code>. If so, a warning is given, as well as the dimension of the 
subspace and a direction which is orthogonal to it.
</p>


<h3>Value</h3>

<p>A list with components: <br></p>
<table>
<tr style="vertical-align: top;">
<td><code>max</code></td>
<td>
<p>The point of <code>x</code> with maximal projection depth.
If multiple points have maximum depth, their center
of gravity is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Huber</code></td>
<td>
<p>A weighted center of gravity of all observations.
The weights are defined by the Huber
function with parameter
<code>alpha = 1 / (1+sqrt(qchisq(0.95, p)))</code>
Observations for which the projection depth
is more than alpha receive weight 1,
other points receive weight
<code>( sqrt(qchisq(0.95, p)) / outlyingness )^2.</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>P. Segaert</p>


<h3>References</h3>

<p>Maronna, R.A., Yohai, V.J. (1995). The behavior of the Stahel-Donoho robust multivariate estimator. <em>Journal of the American Statistical Association</em>, <b>90</b>, 330â€“341.
</p>


<h3>See Also</h3>

<p><code>outlyingness</code>, <code>projdepth</code>, <code>adjOutl</code>, <code>dirOutl</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Compute a location estimate of a two-dimensional dataset.
if (requireNamespace("robustbase", quietly = TRUE)) {
  BivData &lt;- log(robustbase::Animals2)
} else {
  BivData &lt;- matrix(rnorm(120), ncol = 2)
  BivData &lt;- rbind(BivData, matrix(c(6, 6, 6, -2), ncol = 2))
}

result &lt;- projmedian(x = BivData)
plot(BivData, pch = 16)
points(result$max, col = "red", pch = 18, cex = 1.5)
points(result$Huber, col = "blue", pch = 3, cex = 1.5)

# Options for the underlying projdepth routine may be passed 
# using the options argument. 
result &lt;- projmedian(x = BivData,
                     options = list(type = "Rotation",
                                    ndir = 100,
                                    stand = "unimcd",
                                    h = 0.75*nrow(BivData)))
              
plot(BivData, pch = 16)
points(result$max, col = "red", pch = 18, cex = 1.5)
points(result$Huber, col = "blue", pch = 3, cex = 1.5)

# One may also compute the depth values of the observations in the data
# separately. This avoids having to recompute them when computing the median. 
depth.result &lt;- projdepth(x = BivData)
result &lt;- projmedian(x = BivData, 
                     projection.depths = depth.result$depthX)
</code></pre>


</div>