<div class="container">

<table style="width: 100%;"><tr>
<td>rdepth</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Regression depth of hyperplanes</h2>

<h3>Description</h3>

<p>Computes the regression depth of several hyperplanes with
respect to a multiple regression dataset with <code class="reqn">p</code> explanatory variables.
The computation is exact for <code class="reqn">p &lt;= 3</code>.
An approximate algorithm is used for <code class="reqn">p&gt;3</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rdepth(x, z = NULL, ndir = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An <code class="reqn">n</code> by <code class="reqn">p+1</code> regression dataset. <br>
The first <code class="reqn">p</code> columns are the explanatory variables. The last
column corresponds to the response variable.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>An <code class="reqn">m</code> by <code class="reqn">p+1</code> matrix containing rowwise the hyperplanes for which to compute the regression depth. The first column should contain the intercepts. <br>
If <code>z</code> is not specified, it is set equal to <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndir</code></td>
<td>
<p>Controls the number of directions when the approximate
algorithm is used. Defaults to <code class="reqn">250p</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Regression depth has been introduced in Rousseeuw and Hubert (1999). To compute the regression depth of a hyperplane, different algorithms are used. When <code class="reqn">p &lt;= 3</code> it can be computed exactly. In higher dimensions an approximate algorithm is used (Rousseeuw and Struyf 1998). 
</p>
<p>It is first checked whether the data <code>x</code> lie in a subspace of
dimension smaller than <code class="reqn">p + 1</code>. If so, a warning is given, as well as the  dimension of the subspace and a direction which is orthogonal to it.</p>


<h3>Value</h3>

<p>A  list with components: <br></p>
<table>
<tr style="vertical-align: top;">
<td><code>depthZ</code></td>
<td>
<p>A vector containing the regression depth of the hyperplanes in <code>z</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>singularSubsets</code></td>
<td>
<p> A vector of length <code class="reqn">m</code>. <br>
For each hyperplane, it contains the number of singular subsamples when the approximate algorithm is used. The actual number of directions used in the algorithm therefore equals <code>ndir-singularSubsets</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dimension</code></td>
<td>
<p>When the data <code>x</code> are lying in a lower dimensional subspace, the dimension of this subspace.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hyperplane</code></td>
<td>
<p>When the data <code>x</code> are lying in a lower dimensional subspace, a direction orthogonal to this subspace.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>P. Segaert using Fortran code by P.J. Rousseeuw, I. Ruts and A. Struyf</p>


<h3>References</h3>

<p>Rousseeuw P.J., Hubert M. (1999). Regression depth.  <em>Journal of the American Statistical Association</em>, <b>94</b>, 388–402.
</p>
<p>Rousseeuw P.J., Struyf A. (1998). Computing location depth and regression depth in higher dimensions.  <em>Statistics and Computing</em>, <b>45</b>, 193–203.
</p>


<h3>See Also</h3>

<p><code>rdepthmedian</code>, <code>cmltest</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Illustrate the concept of regression depth in the case of simple 
# linear regression. 

data(stars)

# Compute the least squares fit. Due to outliers
# this fit will be bad and thus should result in a small
# regression depth.
temp &lt;- lsfit(x = stars[,1], y = stars[,2])$coefficients
intercept &lt;- temp[1]
slope &lt;- temp[2]
plot(stars, ylim = c(4,7))
abline(a = intercept, b = slope)
abline(a = -9.2, b = 3.2, col = "red")

# Let us compare the regression depth of the least squares fit
# with the depth of the better fitting red regression line.
z &lt;- rbind(cbind(intercept, slope),
           cbind(-9.2, 3.2))
result &lt;- rdepth(x = stars, z = z)
result$depthZ
text(x = 3.8, y = 5.3, labels = round(result$depthZ[1], digits =2))
text(x = 4.45, y = 4.8, labels = round(result$depthZ[2], digits =2), col = "red")

# Compute the depth of some other regression lines to illustrate the concept.
# Note that the stars data set has 47 observations and 1/47 = 0.0212766.
z &lt;- rbind(cbind(6.2, 0),
           cbind(6.5, 0))
result &lt;- rdepth(x = stars, z = z)
abline(a = 6.2, b = 0, col = "blue")
abline(a = 6.5, b = 0, col = "darkgreen")
text(x = 3.8, y = 6.25, labels = round(result$depthZ[1], digits = 2),
     col = "blue")
text(x = 4, y = 6.55, labels = round(result$depthZ[2], digits = 2), 
     col = "darkgreen")
# One point needs to removed to make the blue line a nonfit. The green line is 
# clearly a nonfit. 
</code></pre>


</div>