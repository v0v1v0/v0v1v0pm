<div class="container">

<table style="width: 100%;"><tr>
<td>cmltest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test for linearity of the conditional median in simple regression</h2>

<h3>Description</h3>

<p>A test based on regression depth for linearity of the
conditional median <code>z</code> given the simple regression dataset <code>x</code>. The computation of the regression depth of <code>z</code> with respect to <code>x</code> is done by the function <code>rdepth</code>.
The test is only valid when <code>x</code> contains no duplicates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cmltest(x, z)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An <code class="reqn">n</code> by 2 regression data matrix. <br>
The first column is the explanatory variable, the second column corresponds to the response variable. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>A matrix with one row containing an intercept and slope. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The following hypothesis test is performed:<br><code class="reqn">H_0</code>: The data come from a model with: <code class="reqn">med(x_2|x_1) = z_1 + z_2 * x_1</code> <br>
The test statistic being used is the regression depth of <code>z</code> with respect to <code>x</code>.
</p>


<h3>Value</h3>

<table><tr style="vertical-align: top;">
<td><code>pval</code></td>
<td>
<p>The <code class="reqn">p</code>-value of the hypothesis test.</p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>P. Segaert</p>


<h3>References</h3>

<p>Van Aelst S., Rousseeuw P.J., Hubert M., Struyf A. (2002). The deepest regression method. <em>Journal of Multivariate Analysis</em>, <b>81</b>, 138–166.
</p>
<p>Rousseeuw P.J., Struyf A. (2002). A depth test for symmetry. In:  <em>Goodness-of-Fit Tests and Model Validity</em>, Birkhäuser Boston, pages 401–412.
</p>


<h3>See Also</h3>

<p><code>rdepth</code>, <code>rdepthmedian</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(stars)

# Compute the least squares fit. Due to outliers
# this fit will be bad and thus H0 should be rejected. 
temp &lt;- lsfit(x = stars[,1], y = stars[,2])$coefficients
intercept &lt;- temp[1]
slope &lt;- temp[2]
z &lt;- matrix(c(intercept, slope), nrow = 1)
pvalue1 &lt;- cmltest(x = stars[!duplicated(stars), ], z = z)
pvalue1

# Let's now test the deepest regression line. 
result &lt;- rdepthmedian(x = stars)
pvalue2 &lt;- cmltest(x = stars[!duplicated(stars), ], z = matrix(result$deepest, nrow = 1))
pvalue2

plot(stars)
abline(a = intercept, b = slope)
abline(result$deepest, col = "red")
text(x = 3.8, y = 5.3, labels = paste("p-value", round(pvalue1, digits = 3)))
text(x = 4.45, y = 4.8, labels = paste("p-value", round(pvalue2, digits = 3)),
     col = "red")
</code></pre>


</div>