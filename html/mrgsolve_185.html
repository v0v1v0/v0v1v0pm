<div class="container">

<table style="width: 100%;"><tr>
<td>mread</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Read a model specification file</h2>

<h3>Description</h3>

<p><code>mread</code> reads and parses the <code>mrgsolve</code> model specification file,
builds the model, and returns a model object for simulation. 
<code>mread_cache</code> does the same, but caches the compilation result for 
later use.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mread(
  model,
  project = getOption("mrgsolve.project", getwd()),
  code = NULL,
  file = NULL,
  udll = TRUE,
  ignore.stdout = TRUE,
  raw = FALSE,
  compile = TRUE,
  audit = TRUE,
  quiet = getOption("mrgsolve_mread_quiet", FALSE),
  check.bounds = FALSE,
  warn = TRUE,
  soloc = getOption("mrgsolve.soloc", tempdir()),
  capture = NULL,
  preclean = FALSE,
  recover = FALSE,
  ...
)

mread_cache(
  model = NULL,
  project = getOption("mrgsolve.project", getwd()),
  file = paste0(model, ".cpp"),
  code = NULL,
  soloc = getOption("mrgsolve.soloc", tempdir()),
  quiet = FALSE,
  preclean = FALSE,
  capture = NULL,
  ...
)

mread_file(file, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>model name</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>project</code></td>
<td>
<p>location of the model specification file an any 
headers to be included; see also the discussion about model; this argument
can be set via <code>options()</code>
library under details as well as the <code>modlib</code> help topic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>code</code></td>
<td>
<p>a character string with model specification code to be 
used instead of a model file</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>the full file name (with extension, but without path)
where the model is specified</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>udll</code></td>
<td>
<p>use unique name for shared object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ignore.stdout</code></td>
<td>
<p>passed to system call for compiling model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>raw</code></td>
<td>
<p>if TRUE, return a list of raw output</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compile</code></td>
<td>
<p>logical; if <code>TRUE</code>, the model will be built</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>audit</code></td>
<td>
<p>check the model specification file for errors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>don't print messages when compiling</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check.bounds</code></td>
<td>
<p>check boundaries of parameter list</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warn</code></td>
<td>
<p>logical; if <code>TRUE</code>, print warning messages that may arise</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>soloc</code></td>
<td>
<p>the directory location where the model shared object is built
and stored; see details; this argument can be set via <code>options()</code>; 
if the directory does not exist, 'mread' will attempt to create it.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>capture</code></td>
<td>
<p>a character vector or comma-separated string of additional 
model variables to capture; these variables will be added to the capture 
list for the current call to <code>mread</code> only</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>preclean</code></td>
<td>
<p>logical; if <code>TRUE</code>, compilation artifacts are 
cleaned up first</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>recover</code></td>
<td>
<p>if <code>TRUE</code>, a list of build will be returned in case
the model shared object fails to compile; use this option to and 
the returned object to collect information assist in debugging</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>passed to <code>update</code>; also arguments passed
to mread from <code>mread_cache</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>model</code> argument is required.  For typical use, 
the <code>file</code> argument is omitted and the value 
for <code>file</code> is generated from the value for <code>model</code>.
To determine the source file name, <code>mrgsolve</code> will look for 
a file extension in <code>model</code>.  A file extension is 
assumed when it finds a period followed by one to three alpha-numeric 
characters at the end of the string (e.g. <code>mymodel.txt</code> but not 
<code>my.model</code>).  If no file extension is found, the extension <code>.cpp</code> 
is assumed (e.g. <code>file</code> is <code>&lt;model-name&gt;.cpp</code>).  If a file 
extension is found, <code>file</code> is <code>&lt;model-name&gt;</code>.    
</p>
<p>Best practice is to avoid using <code>.</code> in <code>model</code> unless
you are using <code>model</code> to point to the model specification 
file name. Otherwise, use <code>mread_file</code>. 
</p>
<p>Use the <code>soloc</code> argument to specify a directory location for building
the model.  This is the location where the model shared object will be 
stored on disk.  The default is a temporary directory, so compilation 
artifacts are lost when R restarts when the default is used.  Changing
<code>soloc</code> to a persistent directory location will preserve those 
artifacts across R restarts.  Also, if simulation from a single model is 
being done in separate processes on separate compute nodes, it might be 
necessary to store these compilation artifacts in a local directory 
to make them accessible to the different nodes. If the <code>soloc</code> 
directory does not exist, 'mread' will attempt to create it.
</p>
<p>Similarly, using <code>mread_cache</code> will cache results in the temporary 
directory and the cache cannot be accessed after the R process is 
restarted.
</p>


<h3>Model Library</h3>

<p><code>mrgsolve</code> comes bundled with several precoded PK, PK/PD, and 
other systems models that are accessible via the <code>mread</code> interface.  
</p>
<p>Models available in the library include:
</p>

<ul>
<li>
<p> PK models: <code>pk1cmt</code>, <code>pk2cmt</code>, <code>pk3cmt</code>,
<code>pk1</code>, <code>pk2</code>, <code>popex</code>, <code>tmdd</code>
</p>
</li>
<li>
<p> PKPD models: <code>irm1</code>, <code>irm2</code>, <code>irm3</code>, <code>irm4</code>,
<code>emax</code>, <code>effect</code>
</p>
</li>
<li>
<p> Other models: <code>viral1</code>, <code>viral2</code>
</p>
</li>
</ul>
<p>When the library model is accessed, <code>mrgsolve</code> will compile and load
the model as you would for any other model.  It is only necessary to 
reference the correct model name and point the <code>project</code> argument
to the <code>mrgsolve</code> model library location via <code>modlib</code>.
</p>
<p>For more details, see <code>modlib_pk</code>, <code>modlib_pkpd</code>, 
<code>modlib_tmdd</code>, <code>modlib_viral</code>, and 
<code>modlib_details</code> for more information about the state 
variables and parameters in each model.
</p>


<h3>See Also</h3>

<p><code>mcode</code>, <code>mcode_cache</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
code &lt;- '
$PARAM CL = 1, VC = 5
$CMT CENT
$ODE dxdt_CENT = -(CL/VC)*CENT;
'

mod &lt;- mcode("ex_mread", code)

mod

mod %&gt;% init(CENT=1000) %&gt;% mrgsim %&gt;% plot


mod &lt;- mread("irm3", modlib())

mod

# if the model is in the file mymodel.cpp
mod &lt;- mread("mymodel")

# if the model is in the file mymodel.txt
mod &lt;- mread(file = "mymodel.txt")

or

mod &lt;- mread_file("mymodel.txt")



## End(Not run)

</code></pre>


</div>