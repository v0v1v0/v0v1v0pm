<div class="container">

<table style="width: 100%;"><tr>
<td>eblupUFH</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>EBLUPs based on a Univariate Fay Herriot (Model 0)</h2>

<h3>Description</h3>

<p>This function gives the EBLUP and MSE based on a univariate Fay Herriot model (model 0)
</p>


<h3>Usage</h3>

<pre><code class="language-R">eblupUFH(
  formula,
  vardir,
  samevar = FALSE,
  MAXITER = 100,
  PRECISION = 1e-04,
  data
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class list of formula, describe the model to be fitted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vardir</code></td>
<td>
<p>if data is available, it is vector containing name of sampling variances of direct estimators. if not, it is data frame of sampling variances of direct estimators. The order is : <code>var1, var2, . , var(k) , cov12, . cov1k, cov23, . , cov(k-1)(k)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samevar</code></td>
<td>
<p>logical input, true if variance of the data is same, Default: <code>FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MAXITER</code></td>
<td>
<p>maximum number of iterations allowed in the Fisher-scoring algorithm, Default: <code>100</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PRECISION</code></td>
<td>
<p>convergence tolerance limit for the Fisher-scoring algorithm, Default: <code>1e-4</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>dataframe containing the variables named in <code>formula</code> and <code>vardir</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function returns a list with the following objects:
</p>

<dl>
<dt>eblup</dt>
<dd>
<p>a dataframe with the values of the EBLUP estimators</p>
</dd>
<dt>MSE</dt>
<dd>
<p>a dataframe with the estimated mean squared errors of the EBLUPs for the small domains</p>
</dd>
<dt>randomEffect</dt>
<dd>
<p>a dataframe with the values of the random effect estimators</p>
</dd>
<dt>Rmatrix</dt>
<dd>
<p>a block diagonal matrix composed of sampling errors</p>
</dd>
<dt>fit</dt>
<dd>
<p>a list containing the following objects:</p>
</dd>
</dl>
<ul>
<li>
<p> method : type of fitting method, named "REML"
</p>
</li>
<li>
<p> convergence : a logical value of convergence of Fisher Scoring algorithm
</p>
</li>
<li>
<p> iterations : number of iterations performed by Fisher-Scoring algorithm
</p>
</li>
<li>
<p> estcoef : a dataframe with the estimated model coefficient in the first column, their standard error in the second column, the t statistics in the third column, and the p-values of the significance of each coefficient in the last column
</p>
</li>
<li>
<p> refvar : a dataframe with the estimated random effect variance
</p>
</li>
<li>
<p> informationFisher : a matrix of information Fisher of Fisher-Scoring algorithm
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">## Load dataset
data(datasae1)

# Compute EBLUP and MSE of Y1 Y2 and Y3  based on Model 0
# using auxiliary variables X1 and X2 for each dependent variable

## Using parameter 'data'
Fo &lt;- list(f1=Y1~X1+X2,
           f2=Y2~X1+X2,
           f3=Y3~X1+X2)
vardir &lt;- c("v1", "v2", "v3", "v12", "v13", "v23")
un &lt;- eblupUFH(Fo, vardir, data=datasae1)

## Without parameter 'data'
Fo &lt;- list(f1=datasae1$Y1~datasae1$X1+datasae1$X2,
           f2=datasae1$Y2~datasae1$X1+datasae1$X2,
           f3=datasae1$Y3~datasae1$X1+datasae1$X2)
vardir &lt;- datasae1[,c("v1", "v2", "v3", "v12", "v13", "v23")]
un &lt;- eblupUFH(Fo, vardir)

un$eblup   # see the EBLUP estimators
un$MSE   # see MSE of EBLUP estimators

</code></pre>


</div>