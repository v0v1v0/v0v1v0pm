<div class="container">

<table style="width: 100%;"><tr>
<td>msce_numerical</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Numerical solution of the Multi-Stage Clonal Expansion Model</h2>

<h3>Description</h3>

<p>This function aims to solve the general multi-stage model 
with piecewise constant parameters approximatively
by integrating the characteristic equations with Euler's method.
For sufficiently small time intervalls, this approximation often 
yields reasonable results.
Small time intervals can either be provided explicitly with many columns
in argument <code>t</code>.
An alternative is the optional parameter <code>innerSteps</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">msce_numerical(t, parameterList, innerSteps = 1000L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>Each element in a row of <code>t</code> defines the endpoint of a 
time interval.
The first time interval starts at time <code>0</code>.
The last element is the time point for which hazard and survival
function are evaluated.
Elements in a row have to be in monotonously increasing order.
In order to achieve a different number of time intervals for
different rows, rows may start with an arbitrary number of zeros
(i.e. time intervals of length zero).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameterList</code></td>
<td>
<p>List of Matrices.
Each list member has to be named. Allowed names are <code>Nnu0</code>,
<code>alphaX</code>, <code>gammaX</code>, and <code>nuX</code> where <code>X</code>
can be any positive integer value.
The number of stages is deduced from <code>nuX</code>
with the highest <code>X</code>.
Matrices <code>Nnu0</code> and successive <code>nuX</code> must be provided.
Missing other matrices are assumed to be zero.
For each matrix it has to hold that the number of columns 
must be equal to the ones in <code>t</code>.
The number of rows can either equal to the number of rows
in <code>t</code>, or only one row is provided, 
which then is applied to all rows of <code>t</code>.
</p>
<p>Values in matrices <code>Nnu0</code>, <code>alphaX</code>, <code>gammaX</code>,
<code>nuX</code> correspond to parameters for each time interval,
see the figure and explanations in the package vignette.
Here, <code>Nnu0</code> is the product of <code class="reqn">N</code> and <code class="reqn">\nu_0</code>
and <code class="reqn">\gamma_X</code> is defined by
<code class="reqn">\alpha_X-\beta_X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>innerSteps</code></td>
<td>
<p>Positive integer.
To improve accuracy, each time interval is internally
divided into <code>innerSteps</code> time intervals of equal length.
Defaults to 1000.
Note, however, that even in the limit of infinite innerSteps,
there will always be a finite discrepancy to the exact result.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><img src="../help/figures/MSCE.jpg" alt="Schematic depiction of the MSCE model.
        See the package vignette for details."></p>


<h3>Value</h3>

<p>The output list contains all used arguments of the
<code>parameterList</code> and vectors of the model results for
hazard and logarithm of the survival function
for each row of the input.
</p>


<h3>See Also</h3>

<p><code>tsce</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">t &lt;-matrix(data=c(10,20,65,10,20,70),nrow=2,byrow=TRUE)
Nnu0 &lt;- matrix(c(0.3,0.7,1),nrow = 1)
nu1  &lt;- matrix(1e-6,nrow=1,ncol=3)
alpha1&lt;- matrix(1,nrow=1,ncol=3)
gamma1&lt;- matrix(c(0.13,0.13,0.13, 0.15,0.15,0.15),nrow=2,byrow=TRUE)
pars = list(Nnu0=Nnu0, nu1=nu1,alpha1=alpha1,gamma1=gamma1) 

msce_numerical(t,pars)
</code></pre>


</div>