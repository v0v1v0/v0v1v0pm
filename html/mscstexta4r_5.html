<div class="container">

<table style="width: 100%;"><tr>
<td>textaDetectTopics</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Detects the top topics in a group of text documents.</h2>

<h3>Description</h3>

<p>This function returns the top detected topics for a list of
submitted text documents. A topic is identified with a key phrase, which can
be one or more related words. At least 100 text documents must be submitted,
however this API is designed to detect topics across hundreds to thousands of
documents. For best performance, limit each document to a short, human
written text paragraph such as review, conversation or user feedback.
</p>
<p>English is the only language supported at this time.
</p>
<p>You can provide a list of stop words to control which words or documents are
filtered out. You can also supply a list of topics to exclude from the
response. Finally, you can also provide min/max word frequency count
thresholds to exclude rare/ubiquitous document topics.
</p>
<p>We recommend using the <code>textaDetectTopics</code> function in synchronous
mode, in which case it will return only after topic detection has completed.
If you decide to call this function in asynchronous mode, you will need to
call the <code>textaDetectTopicsStatus</code> function periodically yourself
until the Microsoft Cognitive Services server complete topic detection and
results become available.
</p>
<p><strong>IMPORTANT NOTE: If you're calling <code>textaDetectTopics</code> in
synchronous mode within the R console REPL (interactive mode), it will
appear as if the console has hanged. This is <em>EXPECTED</em>. The function
hasn't crashed. It is simply in "sleep mode", activating itself periodically
and then going back to sleep, until the results have become available. In
sleep mode, even though it appears "stuck", <code>textaDetectTopics</code>
dodesn't use any CPU resources. While the function is operating in sleep
mode, you <em>WILL NOT</em> be able to use the console until the function
completes. If need to operate the console while topic detection is being
performed by the Microsoft Cognitive services servers, you should call
<code>textaDetectTopics</code> in asynchronous mode and then call
<code>textaDetectTopicsStatus</code> yourself repeteadly afterwards, until
results are available.</strong>
</p>
<p>Note that one transaction is charged per text document submitted.
</p>
<p>Internally, this function invokes the Microsoft Cognitive Services Text
Analytics REST API documented at <a href="https://www.microsoft.com/cognitive-services/en-us/text-analytics/documentation">https://www.microsoft.com/cognitive-services/en-us/text-analytics/documentation</a>.
</p>
<p>You MUST have a valid Microsoft Cognitive Services account and an API key for
this function to work properly. See <a href="https://www.microsoft.com/cognitive-services/en-us/pricing">https://www.microsoft.com/cognitive-services/en-us/pricing</a>
for details.
</p>


<h3>Usage</h3>

<pre><code class="language-R">textaDetectTopics(documents, stopWords = NULL, topicsToExclude = NULL,
  minDocumentsPerWord = NULL, maxDocumentsPerWord = NULL,
  resultsPollInterval = 30L, resultsTimeout = 1200L, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>documents</code></td>
<td>
<p>(character vector) Vector of sentences or documents on
which to perform topic detection. At least 100 text documents must be
submitted. English is the only language supported at this time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stopWords</code></td>
<td>
<p>(character vector) Vector of stop words to ignore while
performing topic detection (optional)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>topicsToExclude</code></td>
<td>
<p>(character vector) Vector of topics to exclude from
the response (optional)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minDocumentsPerWord</code></td>
<td>
<p>(integer) Words that occur in less than this many
documents are ignored. Use this parameter to help exclude rare document
topics. Omit to let the service choose appropriate value. (optional)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxDocumentsPerWord</code></td>
<td>
<p>(integer) Words that occur in more than this many
documents are ignored. Use this parameter to help exclude ubiquitous document
topics. Omit to let the service choose appropriate value. (optional)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resultsPollInterval</code></td>
<td>
<p>(integer) Interval (in seconds) at which this function
will query the Microsoft Cognitive Services servers for results (optional,
default: 30L). If set to 0L, this function will return immediately and you
will have to call <code>textaDetectTopicsStatus</code> periodically to collect
results. If set to a non-zero integer value, this function will only return
after all results have been collected. It does so by repeatedly calling
<code>textaDetectTopicsStatus</code> on its own until topic detection has
completed. In the latter case, you do not need to call
<code>textaDetectTopicsStatus</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resultsTimeout</code></td>
<td>
<p>(integer) Interval (in seconds) at which point this function
will give up and stop querying the Microsoft Cognitive Services servers for
results (optional, default: 1200L). As soon as all results are available,
this function will return them to the caller. If the Microsoft Cognitive
Services servers within resultsTimeout seconds, this function will
stop polling the servers and return the most current results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>(logical) If set to TRUE, print every poll status to stdout.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An S3 object of the class <code>textatopics</code>. The results are stored in
the <code>results</code> dataframes inside this object. See <code>textatopics</code>
for details. In the synchronous case (i.e., the function only returns after
completion), the dataframes contain the documents, the topics, and which
topics are assigned to which documents. In the asynchonous case (i.e., the
function returns immediately), the dataframes contain the documents, their
unique identifiers, their current operation status code, but they don't
contain the topics yet, nor their assignments. To get the topics and their
assignments, you must call <code>textaDetectTopicsStatus</code> until the
Microsoft Services servers have completed topic detection.
</p>


<h3>Author(s)</h3>

<p>Phil Ferriere <a href="mailto:pferriere@hotmail.com">pferriere@hotmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
 load("./data/yelpChineseRestaurantReviews.rda")
 set.seed(1234)
 documents &lt;- sample(yelpChReviews$text, 1000)

 tryCatch({

   # Detect top topics in group of documents
   topics &lt;- textaDetectTopics(
     documents,                  # At least 100 documents (English only)
     stopWords = NULL,           # Stop word list (optional)
     topicsToExclude = NULL,     # Topics to exclude (optional)
     minDocumentsPerWord = NULL, # Threshold to exclude rare topics (optional)
     maxDocumentsPerWord = NULL, # Threshold to exclude ubiquitous topics (optional)
     resultsPollInterval = 30L,  # Poll interval (in s, default:30s, use 0L for async)
     resultsTimeout = 1200L,     # Give up timeout (in s, default: 1200s = 20mn)
     verbose = TRUE              # If set to TRUE, print every poll status to stdout
   )

   # Class and structure of topics
   class(topics)
   #&gt; [1] "textatopics"

   str(topics, max.level = 1)
   #&gt; List of 8
   #&gt; $ status          : chr "Succeeded"
   #&gt; $ operationId     : chr "30334a3e1e28406a80566bb76ff04884"
   #&gt; $ operationType   : chr "topics"
   #&gt; $ documents       :'data.frame':  1000 obs. of  2 variables:
   #&gt; $ topics          :'data.frame':  71 obs. of  3 variables:
   #&gt; $ topicAssignments:'data.frame':  502 obs. of  3 variables:
   #&gt; $ json            : chr "{\"status\":\"Succeeded\",\"createdDateTime\": __truncated__ }
   #&gt; $ request         :List of 7
   #&gt; ..- attr(*, "class")= chr "request"
   #&gt; - attr(*, "class")= chr "textatopics"

   # Print results
   topics
   #&gt; textatopics [https://westus.api.cognitive.microsoft.com/text/analytics/ __truncated__ ]
   #&gt; status: Succeeded
   #&gt; operationId: 30334a3e1e28406a80566bb76ff04884
   #&gt; operationType: topics
   #&gt; topics (first 20):
   #&gt; ------------------------
   #&gt;    keyPhrase      score
   #&gt; ---------------- -------
   #&gt;     portions       35
   #&gt;   noodle soup      30
   #&gt;    vegetables      20
   #&gt;       tofu         19
   #&gt;      garlic        17
   #&gt;     Eggplant       15
   #&gt;       Pad          15
   #&gt;      combo         13
   #&gt; Beef Noodle Soup   13
   #&gt;      House         12
   #&gt;      entree        12
   #&gt;     wontons        12
   #&gt;     Pei Wei        12
   #&gt;  mongolian beef    11
   #&gt;       crab         11
   #&gt;      Panda         11
   #&gt;       bean         10
   #&gt;    dumplings        9
   #&gt;     veggies         9
   #&gt;      decor          9
   #&gt; ------------------------

 }, error = function(err) {

   # Print error
   geterrmessage()

 })

## End(Not run)
</code></pre>


</div>