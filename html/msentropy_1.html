<div class="container">

<table style="width: 100%;"><tr>
<td>calculate_entropy_similarity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Entropy similarity between two spectra</h2>

<h3>Description</h3>

<p>Calculate the entropy similarity between two spectra
</p>


<h3>Usage</h3>

<pre><code class="language-R">calculate_entropy_similarity(
  peaks_a,
  peaks_b,
  ms2_tolerance_in_da,
  ms2_tolerance_in_ppm,
  clean_spectra,
  min_mz,
  max_mz,
  noise_threshold,
  max_peak_num
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>peaks_a</code></td>
<td>
<p>A matrix of spectral peaks, with two columns: mz and intensity</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>peaks_b</code></td>
<td>
<p>A matrix of spectral peaks, with two columns: mz and intensity</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ms2_tolerance_in_da</code></td>
<td>
<p>The MS2 tolerance in Da, set to -1 to disable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ms2_tolerance_in_ppm</code></td>
<td>
<p>The MS2 tolerance in ppm, set to -1 to disable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clean_spectra</code></td>
<td>
<p>Whether to clean the spectra before calculating the entropy similarity, see <code>clean_spectrum</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_mz</code></td>
<td>
<p>The minimum mz value to keep, set to -1 to disable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_mz</code></td>
<td>
<p>The maximum mz value to keep, set to -1 to disable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noise_threshold</code></td>
<td>
<p>The noise threshold, set to -1 to disable, all peaks have intensity &lt; noise_threshold * max_intensity will be removed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_peak_num</code></td>
<td>
<p>The maximum number of peaks to keep, set to -1 to disable</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The entropy similarity
</p>


<h3>Examples</h3>

<pre><code class="language-R">mz_a &lt;- c(169.071, 186.066, 186.0769)
intensity_a &lt;- c(7.917962, 1.021589, 100.0)
mz_b &lt;- c(120.212, 169.071, 186.066)
intensity_b &lt;- c(37.16, 66.83, 999.0)
peaks_a &lt;- matrix(c(mz_a, intensity_a), ncol = 2, byrow = FALSE)
peaks_b &lt;- matrix(c(mz_b, intensity_b), ncol = 2, byrow = FALSE)
calculate_entropy_similarity(peaks_a, peaks_b,
                             ms2_tolerance_in_da = 0.02, ms2_tolerance_in_ppm = -1,
                             clean_spectra = TRUE, min_mz = 0, max_mz = 1000,
                             noise_threshold = 0.01,
                             max_peak_num = 100)

</code></pre>


</div>