<div class="container">

<table style="width: 100%;"><tr>
<td>msgps</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
msgps (Degrees of Freedom of Elastic Net, Adaptive Lasso and Generalized Elastic Net)
</h2>

<h3>Description</h3>

<p>This package computes the degrees of freedom of the lasso, elastic net, generalized elastic net and adaptive lasso based on the generalized path seeking algorithm.  The optimal model can be selected by model selection criteria including Mallows' Cp, bias-corrected AIC (AICc), generalized cross validation (GCV) and BIC.
</p>


<h3>Usage</h3>

<pre><code class="language-R">msgps(X,y,penalty="enet", alpha=0, gamma=1, lambda=0.001, tau2, STEP=20000, 
STEP.max=200000,  DFtype="MODIFIED",  p.max=300, intercept=TRUE, stand.coef=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>


<p>predictor matrix
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>


<p>response vector
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>


<p>The penalty term.  The <code>"enet"</code> indicates the elastic net:
</p>
<p style="text-align: center;"><code class="reqn">\alpha/2||\beta||_2^2+(1-\alpha)||\beta||_1.</code>
</p>
 
<p>Note that <code>alpha=0</code> is the lasso penalty. The <code>"genet"</code> is the generalized elastic net: 
</p>
<p style="text-align: center;"><code class="reqn">log(\alpha+(1-\alpha)||\beta||_1).</code>
</p>
 
<p>The <code>"alasso"</code> is the adaptive lasso, which is a weighted version of the lasso given by
</p>
<p style="text-align: center;"><code class="reqn">w_i||\beta||_1,</code>
</p>

<p>where  <code class="reqn">w_i</code> is <code class="reqn">1/(\hat{\beta}_i)^{\gamma}</code>. Here <code class="reqn">\gamma&gt;0</code> is a tuning parameter, and <code class="reqn">\hat{\beta}_i</code> is the ridge estimate with regularization parameter being <code class="reqn">\lambda \ge 0</code>.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>


<p>The value of <code class="reqn">\alpha</code> on <code>"enet"</code> and <code>"genet"</code> penalty. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>


<p>The value of <code class="reqn">\gamma</code> on <code>"alasso"</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>


<p>The value of  regularization parameter <code class="reqn">\lambda \ge 0</code> for ridge regression, which is used to calculate the weight vector of  <code>"alasso"</code> penalty.  Note that the ridge estimates can be ordinary least squared estimates when <code>lambda=0</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau2</code></td>
<td>


<p>Estimator of error variance for Mallows' Cp.  The default is the unbiased estimator of error vairance of the most complex model.  When the unbiased estimator of error vairance of the most complex model is not available (e.g., the number of variables exceeds the number of samples), <code>tau2</code> is the variance of response vector.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>STEP</code></td>
<td>


<p>The approximate number of steps. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>STEP.max</code></td>
<td>


<p>The number of steps in this algorithm can often exceed <code>STEP</code>.  When the number of steps exceeds <code>STEP.max</code>, this algorithm stops.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DFtype</code></td>
<td>


<p><code>"MODIFIED"</code> or <code>"NAIVE"</code>.  The <code>"MODIFIED"</code> update is much more efficient thatn <code>"NAIVE"</code> update.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.max</code></td>
<td>


<p>If the number of selected variables exceeds <code>p.max</code>, the algorithm stops.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>


<p>When intercept is <code>TRUE</code>, the result of intercept is included.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stand.coef</code></td>
<td>


<p>When stand.coef is <code>TRUE</code>, the standardized coefficient is displayed.
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Kei Hirose<br><a href="mailto:mail@keihirose.com">mail@keihirose.com</a>
</p>


<h3>References</h3>


<p>Friedman, J. (2008).  Fast sparse regression and classification. <code class="reqn">Technical report</code>, Standford University.<br>
Hirose, K., Tateishi, S. and Konishi, S.. (2011).  Efficient algorithm to select tuning parameters in sparse regression modeling with regularization. arXiv:1109.2411 (arXiv).
</p>


<h3>See Also</h3>

<p><code>coef.msgps</code>, <code>plot.msgps</code>, <code>predict.msgps</code> and <code>summary.msgos</code> objects.</p>


<h3>Examples</h3>

<pre><code class="language-R">#data
X &lt;- matrix(rnorm(100*8),100,8)
beta0 &lt;- c(3,1.5,0,0,2,0,0,0)
epsilon &lt;- rnorm(100,sd=3)
y &lt;- X %*% beta0 + epsilon
y &lt;- c(y)

#lasso
fit &lt;- msgps(X,y)
summary(fit) 
coef(fit) #extract coefficients at t selected by model selection criteria
coef(fit,c(0, 0.5, 2.5)) #extract coefficients at some values of t
predict(fit,X[1:10,]) #predict values at t selected by model selection criteria
predict(fit,X[1:10,],c(0, 0.5, 2.5)) #predict values at some values of t
plot(fit,criterion="cp") #plot the solution path with a model selected by Cp criterion

#elastic net
fit2 &lt;- msgps(X,y,penalty="enet",alpha=0.5)
summary(fit2) 

#generalized elastic net
fit3 &lt;- msgps(X,y,penalty="genet",alpha=0.5)
summary(fit3)

#adaptive lasso
fit4 &lt;- msgps(X,y,penalty="alasso",gamma=1,lambda=0)
summary(fit4)
</code></pre>


</div>