<div class="container">

<table style="width: 100%;"><tr>
<td>msl.trend</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Isolate trend component from mean sea level records.</h2>

<h3>Description</h3>

<p>Isolate trend component from mean sea level records.
</p>


<h3>Usage</h3>

<pre><code class="language-R">msl.trend(file, station_name = " ", fillgaps = 1, iter = 10000,
  plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>csv format input file <strong>with no header row</strong> of annual
average water levels. This file must contain 2 columns with the first column
the time period (in years) and the second column annual average ocean water
levels (in millimetres). Missing data must be denoted by “NA”. Missing
data and maximum missing data gap are limited to 15% and 5%, respectively,
of the data record. The minimum length data record processed by the package
is 80 years.
</p>
<p><strong>Warning: </strong> If input data files do not conform to these pre-conditions,
the analysis will be terminated. It should be further noted that the existence
of quasi 60 year oscillations in global mean sea level have been well recognised
in the literature. Therefore, in order to be effective for climate change and
sea level research, only input files with a minimum length exceeding 80 years
have been considered in order that the package can identify and isloate such
signals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>station_name</code></td>
<td>
<p>character string, providing the name of the data record.
</p>
<p><strong>Note: </strong>This field can be left blank, however, it is retained for use
in banner labelling of all plotting and pdf outputs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fillgaps</code></td>
<td>
<p>numeric, provides 3 alternative gap filling procedures for
missing data. The default procedure (fillgaps = 1) is based on iterative gap
filling using Singular Spectrum Analysis (refer <code>igapfill</code>)
. The alternatives (2 and 3) are based on linear interpolation and cubic
spline interpolation, respectively (refer <code>na.approx</code>).
</p>
<p><strong>Note: </strong>Gap filled portions of the time series are denoted in red on
the default screen plot. This is done specifically to provide ready visual
observation to discern if the selected gap filling method provides an
appropriate estimate within the gaps in keeping with the remainder of the
historical record. Depending on the nature of the record and extent of gaps,
some trial and error between alternatives might be necessary to optimise gap
filling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>numeric, enables a user defined number of iterations for
bootstrapping to determine error margins. The user range is [500 to 10000]
where 10000 is the default setting.
</p>
<p><strong>Warning: </strong>Although the default setting provides a more accurate basis
for estimating error margins, the degree of iterations slows the analysis and
can take several minutes to run.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical, if ‘TRUE’ then the original time series is
plotted to the screen along with the trend component and the result of gap
filling (where necessary). 95% confidence intervals have also been applied.
Default = TRUE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is the key entry point to the package. This function deconstructs
annual average time series data into a trend and associated real-time velocities
and accelerations, filling necessary internal structures to facilitate all
other functions in this package. The trend is isloated using Singular Spectrum
Analysis, in particular, aggregating components whose low frequency band [0 to
0.01] exceed a threshold contribution of 75%. Associated velocities and
accelerations are determined through the fitting of a cubic smoothing spline
to the trend with 1 degree of freedom per every 8 years of record length.
Refer Watson (2016a,b) for more detail.
</p>


<h3>Value</h3>

<p>An object of class “msl.trend” is returned with the following
elements:
</p>

<dl>
<dt><strong>$Station.Name: </strong></dt>
<dd>
<p>the name of the data record.</p>
</dd>
<dt><strong>$Summary: </strong></dt>
<dd>
<p>a summary data frame of the relevant attributes
relating to the trend and
the inputted annual average data set, including:</p>
</dd>
</dl>
<ul>
<li>
<p>$Year: input data; 
</p>
</li>
<li>
<p>$MSL: input data; 
</p>
</li>
<li>
<p>$Trend: mean sea level trend; 
</p>
</li>
<li>
<p>$TrendSD: standard deviation of the determined mean sea level
trend; 
</p>
</li>
<li>
<p>$Vel: velocity (or first derivative) of mean sea level trend
(mm/year); 
</p>
</li>
<li>
<p>$VelSD: standard deviation of the velocity of the mean sea level
trend; 
</p>
</li>
<li>
<p>$Acc: acceleration (or second derivative) of mean sea level trend
(mm/year/year); 
</p>
</li>
<li>
<p>$AccSD: standard deviation of the acceleration of the mean sea level
trend; 
</p>
</li>
<li>
<p>$Resids: time series of uncorrelated residuals; and 
</p>
</li>
<li>
<p>$FilledTS: gap-filled time series (where necessary). 
</p>
</li>
</ul>
<dl>
<dt><strong>$Velocity: </strong></dt>
<dd>
<p>outputs of the peak velocity and the year in
which it occurred.</p>
</dd>
<dt><strong>$Acceleration: </strong></dt>
<dd>
<p>outputs of the peak acceleration and the
year in which it occurred.</p>
</dd>
<dt><strong>$Record.Length: </strong></dt>
<dd>
<p>outputs details of the start, end and
length of the input data set.</p>
</dd>
<dt><strong>$Fillgaps: </strong></dt>
<dd>
<p>outputs the extent of missing data (years) in
the original record and the gap filling method used (where necessary).</p>
</dd>
<dt><strong>$Bootstrapping.Iterations: </strong></dt>
<dd>
<p>outputs the number of iterations
used to generate the respective standard deviations for error margins.</p>
</dd>
<dt><strong>$Changepoints: </strong></dt>
<dd>
<p>outputs the number and time at which
changepoints in the variance of the uncorrelated residuals occur (if any).
Where changepoints are identified, block bootstrapping procedures are used
with residuals quarantined between changepoints.</p>
</dd>
</dl>
<h3>References</h3>

<p>Watson, P.J., 2016a. Identifying the best performing time series
analytics for sea-level research. In: <em>Time Series Analysis and
Forecasting, Contributions to Statistics</em>, ISBN 978-3-319-28725-6, Springer
International Publishing (in press).
</p>
<p>Watson, P.J., 2016b. How to improve estimates of real-time acceleration in
the mean sea level signal. In: Vila-Concejo, A., Bruce, E., Kennedy, D.M.,
and McCarroll, R.J. (eds.), Proceedings of the 14th International Coastal
Symposium (Sydney, Australia). <em>Journal of Coastal Research</em>,
Special Issue, No. 75. Coconut Creek (Florida), ISSN 0749-0208 (in press).
</p>


<h3>See Also</h3>

<p><code>msl.forecast</code>, <code>msl.plot</code>,
<code>msl.pdf</code>, <code>summary</code>, <code>Balt</code>, <code>s</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># -------------------------------------------------------------------------
# Isolate trend from Baltimore record, filling gaps with spline interpolation and
# 500 iterations. Use raw 'Balt.csv' data file. Note: ordinarily user would call
# 'File.csv' direct from working directory using the following sample code:
# s &lt;- msl.trend('Balt.csv', fillgaps = 3, iter = 500, 'BALTIMORE, USA') # DONT RUN
# -------------------------------------------------------------------------

data(s) # msl.trend object from above-mentioned example
str(s) # check structure of msl.trend object
msl.plot(s, type=2) # check screen output of gapfilling and trend estimate


</code></pre>


</div>