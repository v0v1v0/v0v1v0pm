<div class="container">

<table style="width: 100%;"><tr>
<td>pexp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Exponential distribution with piecewise-constant rate</h2>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for
a generalisation of the exponential distribution, in which the rate changes
at a series of times.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dpexp(x, rate = 1, t = 0, log = FALSE)

ppexp(q, rate = 1, t = 0, lower.tail = TRUE, log.p = FALSE)

qpexp(p, rate = 1, t = 0, lower.tail = TRUE, log.p = FALSE)

rpexp(n = 1, rate = 1, t = 0, start = min(t))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, q</code></td>
<td>
<p>vector of quantiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate</code></td>
<td>
<p>vector of rates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>vector of the same length as <code>rate</code>, giving the times at which
the rate changes. The values of <code>t</code> should be in increasing order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log, log.p</code></td>
<td>
<p>logical; if TRUE, probabilities p are given as log(p), or
log density is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>logical; if TRUE (default), probabilities are P[X &lt;= x],
otherwise, P[X &gt; x].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>vector of probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations. If <code>length(n) &gt; 1</code>, the length is
taken to be the number required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>numeric scalar; delayed entry time. The random deviates will be
left truncated from this start time.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Consider the exponential distribution with rates <code class="reqn">r_1, \ldots,
</code><code class="reqn"> r_n</code> changing at times <code class="reqn">t_1, \ldots,
t_n</code>, with <code class="reqn">t_1 = 0</code>. Suppose <code class="reqn">t_k</code> is
the maximum <code class="reqn">t_i</code> such that <code class="reqn">t_i &lt; x</code>.  The density of
this distribution at <code class="reqn">x &gt; 0</code> is <code class="reqn">f(x)</code> for <code class="reqn">k = 1</code>, and
</p>
<p style="text-align: center;"><code class="reqn">\prod_{i=1}^k (1 - F(t_{i} - t_{i-1}, r_i)) f(x - t_{k},
r_{k})</code>
</p>
<p> for k
&gt; 1.
</p>
<p>where <code class="reqn">F()</code> and <code class="reqn">f()</code> are the distribution and density functions of
the standard exponential distribution.
</p>
<p>If <code>rate</code> is of length 1, this is just the standard exponential
distribution.  Therefore, for example, <code>dpexp(x)</code>, with no other
arguments, is simply equivalent to <code>dexp(x)</code>.
</p>
<p>Only <code>rpexp</code> is used in the <code>msm</code> package, to simulate from Markov
processes with piecewise-constant intensities depending on time-dependent
covariates.  These functions are merely provided for completion, and are not
optimized for numerical stability or speed.
</p>


<h3>Value</h3>

<p><code>dpexp</code> gives the density, <code>ppexp</code> gives the distribution
function, <code>qpexp</code> gives the quantile function, and <code>rpexp</code>
generates random deviates.
</p>


<h3>Author(s)</h3>

<p>C. H. Jackson <a href="mailto:chris.jackson@mrc-bsu.cam.ac.uk">chris.jackson@mrc-bsu.cam.ac.uk</a>
</p>


<h3>See Also</h3>

<p><code>dexp</code>, <code>sim.msm</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
x &lt;- seq(0.1, 50, by=0.1)
rate &lt;- c(0.1, 0.2, 0.05, 0.3)
t &lt;- c(0, 10, 20, 30)
## standard exponential distribution
plot(x, dexp(x, 0.1), type="l")
## distribution with piecewise constant rate
lines(x, dpexp(x, rate, t), type="l", lty=2)
## standard exponential distribution
plot(x, pexp(x, 0.1), type="l")
## distribution with piecewise constant rate
lines(x, ppexp(x, rate, t), type="l", lty=2)

</code></pre>


</div>