<div class="container">

<table style="width: 100%;"><tr>
<td>tnorm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Truncated Normal distribution</h2>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for
the truncated Normal distribution with mean equal to <code>mean</code> and
standard deviation equal to <code>sd</code> before truncation, and truncated on
the interval <code>[lower, upper]</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dtnorm(x, mean = 0, sd = 1, lower = -Inf, upper = Inf, log = FALSE)

ptnorm(
  q,
  mean = 0,
  sd = 1,
  lower = -Inf,
  upper = Inf,
  lower.tail = TRUE,
  log.p = FALSE
)

qtnorm(
  p,
  mean = 0,
  sd = 1,
  lower = -Inf,
  upper = Inf,
  lower.tail = TRUE,
  log.p = FALSE
)

rtnorm(n, mean = 0, sd = 1, lower = -Inf, upper = Inf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, q</code></td>
<td>
<p>vector of quantiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>vector of means.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd</code></td>
<td>
<p>vector of standard deviations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>lower truncation point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>upper truncation point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>logical; if TRUE, return log density or log hazard.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>logical; if TRUE (default), probabilities are P[X &lt;= x],
otherwise, P[X &gt; x].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.p</code></td>
<td>
<p>logical; if TRUE, probabilities p are given as log(p).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>vector of probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations. If <code>length(n) &gt; 1</code>, the length is
taken to be the number required.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The truncated normal distribution has density
</p>
<p style="text-align: center;"><code class="reqn"> f(x, \mu, \sigma) = \phi(x, \mu, \sigma) / (\Phi(u, \mu, \sigma) -
\Phi(l, \mu, \sigma)) </code>
</p>
<p> for <code class="reqn">l &lt;= x
&lt;= u</code>, and 0 otherwise.
</p>
<p><code class="reqn">\mu</code> is the mean of the original Normal distribution before
truncation, <br><code class="reqn">\sigma</code> is the corresponding standard deviation,
<br><code class="reqn">u</code> is the upper truncation point, <br><code class="reqn">l</code> is the lower
truncation point, <br><code class="reqn">\phi(x)</code> is the density of the
corresponding normal distribution, and <br><code class="reqn">\Phi(x)</code> is the
distribution function of the corresponding normal distribution.
</p>
<p>If <code>mean</code> or <code>sd</code> are not specified they assume the default values
of <code>0</code> and <code>1</code>, respectively.
</p>
<p>If <code>lower</code> or <code>upper</code> are not specified they assume the default
values of <code>-Inf</code> and <code>Inf</code>, respectively, corresponding to no
lower or no upper truncation.
</p>
<p>Therefore, for example, <code>dtnorm(x)</code>, with no other arguments, is simply
equivalent to <code>dnorm(x)</code>.
</p>
<p>Only <code>rtnorm</code> is used in the <code>msm</code> package, to simulate from
hidden Markov models with truncated normal distributions. This uses the
rejection sampling algorithms described by Robert (1995).
</p>
<p>These functions are merely provided for completion, and are not optimized
for numerical stability or speed.  To fit a hidden Markov model with a
truncated Normal response distribution, use a <code>hmmTNorm</code>
constructor. See the <code>hmm-dists</code> help page for further details.
</p>


<h3>Value</h3>

<p><code>dtnorm</code> gives the density, <code>ptnorm</code> gives the
distribution function, <code>qtnorm</code> gives the quantile function, and
<code>rtnorm</code> generates random deviates.
</p>


<h3>Author(s)</h3>

<p>C. H. Jackson <a href="mailto:chris.jackson@mrc-bsu.cam.ac.uk">chris.jackson@mrc-bsu.cam.ac.uk</a>
</p>


<h3>References</h3>

<p>Robert, C. P. Simulation of truncated normal variables.
Statistics and Computing (1995) 5, 121â€“125
</p>


<h3>See Also</h3>

<p><code>dnorm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
x &lt;- seq(50, 90, by=1)
plot(x, dnorm(x, 70, 10), type="l", ylim=c(0,0.06)) ## standard Normal distribution
lines(x, dtnorm(x, 70, 10, 60, 80), type="l")       ## truncated Normal distribution

</code></pre>


</div>