<div class="container">

<table style="width: 100%;"><tr>
<td>crudeinits.msm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate crude initial values for transition intensities</h2>

<h3>Description</h3>

<p>Calculates crude initial values for transition intensities by assuming that
the data represent the exact transition times of the Markov process.
</p>


<h3>Usage</h3>

<pre><code class="language-R">crudeinits.msm(
  formula,
  subject,
  qmatrix,
  data = NULL,
  censor = NULL,
  censor.states = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula giving the vectors containing the observed states
and the corresponding observation times. For example,
</p>
<p><code>state ~ time</code>
</p>
<p>Observed states should be in the set <code>1, ...{}, n</code>, where <code>n</code> is
the number of states.  Note hidden Markov models are not supported by this
function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subject</code></td>
<td>
<p>Vector of subject identification numbers for the data
specified by <code>formula</code>. If missing, then all observations are assumed
to be on the same subject. These must be sorted so that all observations on
the same subject are adjacent.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qmatrix</code></td>
<td>
<p>Matrix of indicators for the allowed transitions.  An initial
value will be estimated for each value of qmatrix that is greater than zero.
Transitions are taken as disallowed for each entry of <code>qmatrix</code> that is
0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>An optional data frame in which the variables represented by
<code>subject</code> and <code>state</code> can be found.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>censor</code></td>
<td>
<p>A state, or vector of states, which indicates censoring.  See
<code>msm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>censor.states</code></td>
<td>
<p>Specifies the underlying states which censored
observations can represent.  See <code>msm</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Suppose we want a crude estimate of the transition intensity
<code class="reqn">q_{rs}</code> from state <code class="reqn">r</code> to state <code class="reqn">s</code>.  If we observe
<code class="reqn">n_{rs}</code> transitions from state <code class="reqn">r</code> to state <code class="reqn">s</code>, and a
total of <code class="reqn">n_r</code> transitions from state <code class="reqn">r</code>, then <code class="reqn">q_{rs} / </code><code class="reqn"> q_{rr}</code> can be estimated by <code class="reqn">n_{rs} /
n_r</code>. Then, given a total of <code class="reqn">T_r</code> years spent in state
<code class="reqn">r</code>, the mean sojourn time <code class="reqn">1 / q_{rr}</code> can be estimated
as <code class="reqn">T_r / n_r</code>.  Thus, <code class="reqn">n_{rs} / T_r</code> is a crude
estimate of <code class="reqn">q_{rs}</code>.
</p>
<p>If the data do represent the exact transition times of the Markov process,
then these are the exact maximum likelihood estimates.
</p>
<p>Observed transitions which are incompatible with the given <code>qmatrix</code>
are ignored.  Censored states are ignored.
</p>


<h3>Value</h3>

<p>The estimated transition intensity matrix.  This can be used as the
<code>qmatrix</code> argument to <code>msm</code>.
</p>


<h3>Author(s)</h3>

<p>C. H. Jackson <a href="mailto:chris.jackson@mrc-bsu.cam.ac.uk">chris.jackson@mrc-bsu.cam.ac.uk</a>
</p>


<h3>See Also</h3>

<p><code>statetable.msm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(cav)
twoway4.q &lt;- rbind(c(-0.5, 0.25, 0, 0.25), c(0.166, -0.498, 0.166, 0.166),
c(0, 0.25, -0.5, 0.25), c(0, 0, 0, 0))
statetable.msm(state, PTNUM, data=cav)
crudeinits.msm(state ~ years, PTNUM, data=cav, qmatrix=twoway4.q)

</code></pre>


</div>