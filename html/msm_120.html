<div class="container">

<table style="width: 100%;"><tr>
<td>viterbi.msm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate the probabilities of underlying states and the most likely path
through them</h2>

<h3>Description</h3>

<p>For a fitted hidden Markov model, or a model with censored state
observations, the Viterbi algorithm recursively constructs the path with the
highest probability through the underlying states.  The probability of each
hidden state is also computed for hidden Markov models, using the
forward-backward algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">viterbi.msm(x, normboot = FALSE, newdata = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A fitted hidden Markov multi-state model, or a model with censored
state observations, as produced by <code>msm</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normboot</code></td>
<td>
<p>If <code>TRUE</code>, then before running the algorithm, the
maximum likelihood estimates of the model parameters are replaced by an
alternative set of parameters drawn randomly from the asymptotic
multivariate normal distribution of the MLEs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>An optional data frame containing observations on which to
construct the Viterbi path and forward-backward probabilities. It must be in
the same format as the data frame used to fit <code>x</code>.  If <code>NULL</code>, the
data frame used to fit <code>x</code> is used.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data frame with columns:
</p>
<p><code>subject</code> = subject identification numbers
</p>
<p><code>time</code> = times of observations
</p>
<p><code>observed</code> = corresponding observed states
</p>
<p><code>fitted</code> = corresponding fitted states found by Viterbi recursion. If
the model is not a hidden Markov model, and there are no censored state
observations, this is just the observed states.
</p>
<p>For hidden Markov models, an additional matrix <code>pstate</code> is also
returned inside the data frame, giving the probability of each hidden state
at each point, conditionally on all the data.  This is computed by the
forward/backward algorithm.
</p>


<h3>Author(s)</h3>

<p>C. H. Jackson <a href="mailto:chris.jackson@mrc-bsu.cam.ac.uk">chris.jackson@mrc-bsu.cam.ac.uk</a>
</p>


<h3>References</h3>

<p>Durbin, R., Eddy, S., Krogh, A. and Mitchison, G.
<em>Biological sequence analysis</em>, Cambridge University Press, 1998.
</p>


<h3>See Also</h3>

<p><code>msm</code>
</p>


</div>