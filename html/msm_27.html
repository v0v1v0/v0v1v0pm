<div class="container">

<table style="width: 100%;"><tr>
<td>twophase</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Coxian phase-type distribution with two phases</h2>

<h3>Description</h3>

<p>Density, distribution, quantile functions and other utilities for the Coxian
phase-type distribution with two phases.
</p>


<h3>Usage</h3>

<pre><code class="language-R">d2phase(x, l1, mu1, mu2, log = FALSE)

p2phase(q, l1, mu1, mu2, lower.tail = TRUE, log.p = FALSE)

q2phase(p, l1, mu1, mu2, lower.tail = TRUE, log.p = FALSE)

r2phase(n, l1, mu1, mu2)

h2phase(x, l1, mu1, mu2, log = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, q</code></td>
<td>
<p>vector of quantiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l1</code></td>
<td>
<p>Intensity for transition between phase 1 and phase 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu1</code></td>
<td>
<p>Intensity for transition from phase 1 to exit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu2</code></td>
<td>
<p>Intensity for transition from phase 2 to exit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>logical; if TRUE, return log density or log hazard.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>logical; if TRUE (default), probabilities are P[X &lt;= x],
otherwise, P[X &gt; x].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.p</code></td>
<td>
<p>logical; if TRUE, probabilities p are given as log(p).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>vector of probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations. If <code>length(n) &gt; 1</code>, the length is
taken to be the number required.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is the distribution of the time to reach state 3 in a continuous-time
Markov model with three states and transitions permitted from state 1 to
state 2 (with intensity <code class="reqn">\lambda_1</code>) state 1 to state 3
(intensity <code class="reqn">\mu_1</code>) and state 2 to state 3 (intensity
<code class="reqn">\mu_2</code>).  States 1 and 2 are the two "phases" and state 3 is the
"exit" state.
</p>
<p>The density is
</p>
<p style="text-align: center;"><code class="reqn">f(t | \lambda_1, \mu_1) = e^{-(\lambda_1+\mu_1)t}(\mu_1 +
(\lambda_1+\mu_1)\lambda_1 t)</code>
</p>

<p>if <code class="reqn">\lambda_1 + \mu_1 = \mu_2</code>, and
</p>
<p style="text-align: center;"><code class="reqn">f(t | \lambda_1, \mu_1, \mu_2) =
\frac{(\lambda_1+\mu_1)e^{-(\lambda_1+\mu_1)t}(\mu_2-\mu_1) +
\mu_2\lambda_1e^{-\mu_2t}}{\lambda_1+\mu_1-\mu_2}</code>
</p>

<p>otherwise.  The distribution function is
</p>
<p style="text-align: center;"><code class="reqn">F(t | \lambda_1, \mu_1) = 1 - e^{-(\lambda_1+\mu_1) t} (1 + \lambda_1
t)</code>
</p>

<p>if <code class="reqn">\lambda_1 + \mu_1 = \mu_2</code>, and
</p>
<p style="text-align: center;"><code class="reqn">F(t | \lambda_1, \mu_1, \mu_2) =
1  -  \frac{e^{-(\lambda_1 + \mu_1)t} (\mu_2 - \mu_1)  +  \lambda_1 e^{-\mu_2 t}}{
\lambda_1 + \mu_1 - \mu_2}</code>
</p>

<p>otherwise.  Quantiles are calculated by numerically inverting the
distribution function.
</p>
<p>The mean is <code class="reqn">(1 + \lambda_1/\mu_2) / (\lambda_1 + \mu_1)</code>.
</p>
<p>The variance is <code class="reqn">(2 + 2\lambda_1(\lambda_1+\mu_1+ \mu_2)/\mu_2^2 - (1 +
\lambda_1/\mu_2)^2)/(\lambda_1+\mu_1)^2</code>.
</p>
<p>If <code class="reqn">\mu_1=\mu_2</code> it reduces to an exponential distribution with
rate <code class="reqn">\mu_1</code>, and the parameter <code class="reqn">\lambda_1</code> is redundant.
Or also if <code class="reqn">\lambda_1=0</code>.
</p>
<p>The hazard at <code class="reqn">x=0</code> is <code class="reqn">\mu_1</code>, and smoothly increasing if
<code class="reqn">\mu_1&lt;\mu_2</code>.  If <code class="reqn">\lambda_1 + \mu_1 \geq \mu_2</code> it increases to an asymptote of <code class="reqn">\mu_2</code>, and if
<code class="reqn">\lambda_1 + \mu_1 \leq \mu_2</code> it increases to an
asymptote of <code class="reqn">\lambda_1 + \mu_1</code>.  The hazard is decreasing if
<code class="reqn">\mu_1&gt;\mu_2</code>, to an asymptote of <code class="reqn">\mu_2</code>.
</p>


<h3>Value</h3>

<p><code>d2phase</code> gives the density, <code>p2phase</code> gives the
distribution function, <code>q2phase</code> gives the quantile function,
<code>r2phase</code> generates random deviates, and <code>h2phase</code> gives the
hazard.
</p>


<h3>Alternative parameterisation</h3>

<p>An individual following this
distribution can be seen as coming from a mixture of two populations:
</p>
<p>1) "short stayers" whose mean sojourn time is <code class="reqn">M_1 = </code><code class="reqn"> 1/(\lambda_1+\mu_1)</code> and sojourn
distribution is exponential with rate <code class="reqn">\lambda_1 + \mu_1</code>.
</p>
<p>2) "long stayers" whose mean sojourn time <code class="reqn">M_2 = </code><code class="reqn"> 1/(\lambda_1+\mu_1) + 1/\mu_2</code> and sojourn
distribution is the sum of two exponentials with rate <code class="reqn">\lambda_1 +
</code><code class="reqn"> \mu_1</code> and <code class="reqn">\mu_2</code> respectively.  The
individual is a "long stayer" with probability <code class="reqn">p=\lambda_1/(\lambda_1 +
\mu_1)</code>.
</p>
<p>Thus a two-phase distribution can be more intuitively parameterised by the
short and long stay means <code class="reqn">M_1 &lt; M_2</code> and the long stay probability
<code class="reqn">p</code>.  Given these parameters, the transition intensities are
<code class="reqn">\lambda_1=p/M_1</code>, <code class="reqn">\mu_1=(1-p)/M_1</code>, and
<code class="reqn">\mu_2=1/(M_2-M_1)</code>.  This can be useful for choosing
intuitively reasonable initial values for procedures to fit these models to
data.
</p>
<p>The hazard is increasing at least if <code class="reqn">M_2 &lt; 2M_1</code>, and also
only if <code class="reqn">(M_2 - 2M_1)/(M_2 - M_1) &lt; p</code>.
</p>
<p>For increasing hazards with <code class="reqn">\lambda_1 + \mu_1 \leq \mu_2</code>, the maximum hazard ratio between any time <code class="reqn">t</code> and time 0 is
<code class="reqn">1/(1-p)</code>.
</p>
<p>For increasing hazards with <code class="reqn">\lambda_1 + \mu_1 \geq \mu_2</code>, the maximum hazard ratio is <code class="reqn">M_1/((1-p)(M_2 - M_1))</code><code class="reqn"> M_1))</code>. This is the minimum hazard ratio for
decreasing hazards.
</p>



<h3>Author(s)</h3>

<p>C. H. Jackson <a href="mailto:chris.jackson@mrc-bsu.cam.ac.uk">chris.jackson@mrc-bsu.cam.ac.uk</a>
</p>


<h3>References</h3>

<p>C. Dutang, V. Goulet and M. Pigeon (2008). actuar: An R Package
for Actuarial Science. Journal of Statistical Software, vol. 25, no. 7,
1-37. URL http://www.jstatsoft.org/v25/i07
</p>


</div>