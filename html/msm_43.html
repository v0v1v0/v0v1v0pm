<div class="container">

<table style="width: 100%;"><tr>
<td>hmm-dists</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Hidden Markov model constructors</h2>

<h3>Description</h3>

<p>These functions are used to specify the distribution of the response
conditionally on the underlying state in a hidden Markov model.  A list of
these function calls, with one component for each state, should be used for
the <code>hmodel</code> argument to <code>msm</code>. The initial values for the
parameters of the distribution should be given as arguments. Note the
initial values should be supplied as literal values - supplying them as
variables is currently not supported.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hmmCat(prob, basecat)

hmmIdent(x)

hmmUnif(lower, upper)

hmmNorm(mean, sd)

hmmLNorm(meanlog, sdlog)

hmmExp(rate)

hmmGamma(shape, rate)

hmmWeibull(shape, scale)

hmmPois(rate)

hmmBinom(size, prob)

hmmBetaBinom(size, meanp, sdp)

hmmNBinom(disp, prob)

hmmBeta(shape1, shape2)

hmmTNorm(mean, sd, lower = -Inf, upper = Inf)

hmmMETNorm(mean, sd, lower, upper, sderr, meanerr = 0)

hmmMEUnif(lower, upper, sderr, meanerr = 0)

hmmT(mean, scale, df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>(<code>hmmCat</code>) Vector of probabilities of observing category
<code>1, 2, ...{}, length(prob)</code> respectively.  Or the probability
governing a binomial or negative binomial distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basecat</code></td>
<td>
<p>(<code>hmmCat</code>) Category which is considered to be the
"baseline", so that during estimation, the probabilities are parameterised
as probabilities relative to this baseline category. By default, the
category with the greatest probability is used as the baseline.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>(<code>hmmIdent</code>) Code in the data which denotes the
exactly-observed state.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>(<code>hmmUnif,hmmTNorm,hmmMEUnif</code>) Lower limit for an Uniform
or truncated Normal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>(<code>hmmUnif,hmmTNorm,hmmMEUnif</code>) Upper limit for an Uniform
or truncated Normal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>(<code>hmmNorm,hmmLNorm,hmmTNorm</code>) Mean defining a Normal, or
truncated Normal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd</code></td>
<td>
<p>(<code>hmmNorm,hmmLNorm,hmmTNorm</code>) Standard deviation defining a
Normal, or truncated Normal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meanlog</code></td>
<td>
<p>(<code>hmmNorm,hmmLNorm,hmmTNorm</code>) Mean on the log scale, for
a log Normal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdlog</code></td>
<td>
<p>(<code>hmmNorm,hmmLNorm,hmmTNorm</code>) Standard deviation on the
log scale, for a log Normal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate</code></td>
<td>
<p>(<code>hmmPois,hmmExp,hmmGamma</code>) Rate of a Poisson, Exponential
or Gamma distribution (see <code>dpois</code>, <code>dexp</code>,
<code>dgamma</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape</code></td>
<td>
<p>(<code>hmmPois,hmmExp,hmmGamma</code>) Shape parameter of a Gamma or
Weibull distribution (see <code>dgamma</code>, <code>dweibull</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>(<code>hmmGamma</code>) Scale parameter of a Gamma distribution (see
<code>dgamma</code>), or unstandardised Student t distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>Order of a Binomial distribution (see <code>dbinom</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meanp</code></td>
<td>
<p>Mean outcome probability in a beta-binomial distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdp</code></td>
<td>
<p>Standard deviation describing the overdispersion of the outcome
probability in a beta-binomial distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>disp</code></td>
<td>
<p>Dispersion parameter of a negative binomial distribution, also
called <code>size</code> or <code>order</code>.  (see <code>dnbinom</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape1, shape2</code></td>
<td>
<p>First and second parameters of a beta distribution (see
<code>dbeta</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sderr</code></td>
<td>
<p>(<code>hmmMETNorm,hmmUnif</code>) Standard deviation of the Normal
measurement error distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meanerr</code></td>
<td>
<p>(<code>hmmMETNorm,hmmUnif</code>) Additional shift in the
measurement error, fixed to 0 by default.  This may be modelled in terms of
covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>Degrees of freedom of the Student t distribution.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>hmmCat</code> represents a categorical response distribution on the set
<code>1, 2, ...{}, length(prob)</code>.  The Markov model with misclassification
is an example of this type of model. The categories in this case are (some
subset of) the underlying states.
</p>
<p>The <code>hmmIdent</code> distribution is used for underlying states which are
observed exactly without error.  For hidden Markov models with multiple
outcomes, (see <code>hmmMV</code>), the outcome in the data which takes the
special <code>hmmIdent</code> value must be the first of the multiple outcomes.
</p>
<p><code>hmmUnif</code>, <code>hmmNorm</code>, <code>hmmLNorm</code>, <code>hmmExp</code>,
<code>hmmGamma</code>, <code>hmmWeibull</code>, <code>hmmPois</code>, <code>hmmBinom</code>,
<code>hmmTNorm</code>, <code>hmmNBinom</code> and <code>hmmBeta</code> represent Uniform,
Normal, log-Normal, exponential, Gamma, Weibull, Poisson, Binomial,
truncated Normal, negative binomial and beta distributions, respectively,
with parameterisations the same as the default parameterisations in the
corresponding base R distribution functions.
</p>
<p><code>hmmT</code> is the Student t distribution with general mean <code class="reqn">\mu</code>,
scale <code class="reqn">\sigma</code> and degrees of freedom <code>df</code>.  The variance is
<code class="reqn">\sigma^2 df/(df + 2)</code>.  Note the t distribution in
base R <code>dt</code> is a standardised one with mean 0 and scale 1.
These allow any positive (integer or non-integer) <code>df</code>.  By default,
all three parameters, including <code>df</code>, are estimated when fitting a
hidden Markov model, but in practice, <code>df</code> might need to be fixed for
identifiability - this can be done using the <code>fixedpars</code> argument to
<code>msm</code>.
</p>
<p>The <code>hmmMETNorm</code> and <code>hmmMEUnif</code> distributions are truncated
Normal and Uniform distributions, but with additional Normal measurement
error on the response. These are generalisations of the distributions
proposed by Satten and Longini (1996) for modelling the progression of CD4
cell counts in monitoring HIV disease.  See <code>medists</code> for
density, distribution, quantile and random generation functions for these
distributions.  See also <code>tnorm</code> for density, distribution,
quantile and random generation functions for the truncated Normal
distribution.
</p>
<p>See the PDF manual ‘<span class="file">msm-manual.pdf</span>’ in the ‘<span class="file">doc</span>’ subdirectory for
algebraic definitions of all these distributions.  New hidden Markov model
response distributions can be added to <span class="pkg">msm</span> by following the
instructions in Section 2.17.1.
</p>
<p>Parameters which can be modelled in terms of covariates, on the scale of a
link function, are as follows.
</p>

<table>
<tr>
<td style="text-align: left;"> PARAMETER NAME </td>
<td style="text-align: left;"> LINK FUNCTION </td>
</tr>
<tr>
<td style="text-align: left;"> <code>mean</code> </td>
<td style="text-align: left;">
identity </td>
</tr>
<tr>
<td style="text-align: left;"> <code>meanlog</code> </td>
<td style="text-align: left;"> identity </td>
</tr>
<tr>
<td style="text-align: left;"> <code>rate</code> </td>
<td style="text-align: left;"> log </td>
</tr>
<tr>
<td style="text-align: left;">
<code>scale</code> </td>
<td style="text-align: left;"> log </td>
</tr>
<tr>
<td style="text-align: left;"> <code>meanerr</code> </td>
<td style="text-align: left;"> identity </td>
</tr>
<tr>
<td style="text-align: left;"> <code>meanp</code> </td>
<td style="text-align: left;">
logit </td>
</tr>
<tr>
<td style="text-align: left;"> <code>prob</code> </td>
<td style="text-align: left;"> logit or multinomial logit </td>
</tr>
</table>
<p>Parameters <code>basecat, lower, upper, size, meanerr</code> are fixed at their
initial values. All other parameters are estimated while fitting the hidden
Markov model, unless the appropriate <code>fixedpars</code> argument is supplied
to <code>msm</code>.
</p>
<p>For categorical response distributions <code>(hmmCat)</code> the outcome
probabilities initialized to zero are fixed at zero, and the probability
corresponding to <code>basecat</code> is fixed to one minus the sum of the
remaining probabilities.  These remaining probabilities are estimated, and
can be modelled in terms of covariates via multinomial logistic regression
(relative to <code>basecat</code>).
</p>


<h3>Value</h3>

<p>Each function returns an object of class <code>hmmdist</code>, which is a
list containing information about the model.  The only component which may
be useful to end users is <code>r</code>, a function of one argument <code>n</code>
which returns a random sample of size <code>n</code> from the given distribution.
</p>


<h3>Author(s)</h3>

<p>C. H. Jackson <a href="mailto:chris.jackson@mrc-bsu.cam.ac.uk">chris.jackson@mrc-bsu.cam.ac.uk</a>
</p>


<h3>References</h3>

<p>Satten, G.A. and Longini, I.M.  Markov chains with measurement
error: estimating the 'true' course of a marker of the progression of human
immunodeficiency virus disease (with discussion) <em>Applied Statistics</em>
45(3): 275-309 (1996).
</p>
<p>Jackson, C.H. and Sharples, L.D. Hidden Markov models for the onset and
progresison of bronchiolitis obliterans syndrome in lung transplant
recipients <em>Statistics in Medicine</em>, 21(1): 113–128 (2002).
</p>
<p>Jackson, C.H., Sharples, L.D., Thompson, S.G. and Duffy, S.W. and Couto, E.
Multi-state Markov models for disease progression with classification error.
<em>The Statistician</em>, 52(2): 193–209 (2003).
</p>


<h3>See Also</h3>

<p><code>msm</code>
</p>


</div>