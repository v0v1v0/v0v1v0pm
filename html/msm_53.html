<div class="container">

<table style="width: 100%;"><tr>
<td>MatrixExp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Matrix exponential</h2>

<h3>Description</h3>

<p>Calculates the exponential of a square matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MatrixExp(mat, t = 1, method = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mat</code></td>
<td>
<p>A square matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>An optional scaling factor for <code>mat</code>.  If a vector is supplied,
then an array of matrices is returned with different scaling factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Under the default of <code>NULL</code>, this simply wraps the
<code>expm</code> function from the <span class="pkg">expm</span> package.  This is
recommended.  Options to <code>expm</code> can be supplied to
<code>MatrixExp</code>, including <code>method</code>.
</p>
<p>Otherwise, for backwards compatibility, the following options, which use
code in the <span class="pkg">msm</span> package, are available: <code>"pade"</code> for a Pade
approximation method, <code>"series"</code> for the power series approximation, or
<code>"analytic"</code> for the analytic formulae for simpler Markov model
intensity matrices (see below).  These options are only used if <code>mat</code>
has repeated eigenvalues, thus the usual eigen-decomposition method cannot
be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments to pass to <code>expm</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See the <code>expm</code> documentation for details of the algorithms
it uses.
</p>
<p>Generally the exponential <code class="reqn">E</code> of a square matrix <code class="reqn">M</code> can often be
calculated as
</p>
<p style="text-align: center;"><code class="reqn">E = U \exp(D) U^{-1}</code>
</p>

<p>where <code class="reqn">D</code> is a diagonal matrix with the eigenvalues of <code class="reqn">M</code> on the
diagonal, <code class="reqn">\exp(D)</code> is a diagonal matrix with the exponentiated
eigenvalues of <code class="reqn">M</code> on the diagonal, and <code class="reqn">U</code> is a matrix whose
columns are the eigenvectors of <code class="reqn">M</code>.
</p>
<p>This method of calculation is used if <code>"pade"</code> or <code>"series"</code> is
supplied but <code class="reqn">M</code> has distinct eigenvalues.  I If <code class="reqn">M</code> has repeated
eigenvalues, then its eigenvector matrix may be non-invertible. In this
case, the matrix exponential is calculated using the Pade approximation
defined by Moler and van Loan (2003), or the less robust power series
approximation,
</p>
<p style="text-align: center;"><code class="reqn">\exp(M) = I + M + M^2/2 + M^3 / 3! + M^4 / 4! + ...</code>
</p>

<p>For a continuous-time homogeneous Markov process with transition intensity
matrix <code class="reqn">Q</code>, the probability of occupying state <code class="reqn">s</code> at time <code class="reqn">u +
t</code> conditional on occupying state <code class="reqn">r</code> at time <code class="reqn">u</code> is given by the
<code class="reqn">(r,s)</code> entry of the matrix <code class="reqn">\exp(tQ)</code>.
</p>
<p>If <code>mat</code> is a valid transition intensity matrix for a continuous-time
Markov model (i.e. diagonal entries non-positive, off-diagonal entries
non-negative, rows sum to zero), then for certain simpler model structures,
there are analytic formulae for the individual entries of the exponential of
<code>mat</code>.  These structures are listed in the PDF manual and the formulae
are coded in the <span class="pkg">msm</span> source file <code>src/analyticp.c</code>.  These
formulae are only used if <code>method="analytic"</code>.  This is more efficient,
but it is not the default in <code>MatrixExp</code> because the code is not robust
to extreme values.  However it is the default when calculating likelihoods
for models fitted by <code>msm</code>.
</p>
<p>The implementation of the Pade approximation used by <code>method="pade"</code>
was taken from JAGS by Martyn Plummer
(<a href="https://mcmc-jags.sourceforge.io">https://mcmc-jags.sourceforge.io</a>).
</p>


<h3>Value</h3>

<p>The exponentiated matrix <code class="reqn">\exp(mat)</code>. Or, if <code>t</code>
is a vector of length 2 or more, an array of exponentiated matrices.
</p>


<h3>References</h3>

<p>Cox, D. R. and Miller, H. D. <em>The theory of stochastic
processes</em>, Chapman and Hall, London (1965)
</p>
<p>Moler, C and van Loan, C (2003).  Nineteen dubious ways to compute the
exponential of a matrix, twenty-five years later.  <em>SIAM Review</em>
<b>45</b>, 3â€“49.
</p>


</div>