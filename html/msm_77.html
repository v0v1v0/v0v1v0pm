<div class="container">

<table style="width: 100%;"><tr>
<td>pnext.msm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Probability of each state being next</h2>

<h3>Description</h3>

<p>Compute a matrix of the probability of each state <code class="reqn">s</code> being the next
state of the process after each state <code class="reqn">r</code>.  Together with the mean
sojourn times in each state (<code>sojourn.msm</code>), these fully define
a continuous-time Markov model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pnext.msm(
  x,
  covariates = "mean",
  ci = c("normal", "bootstrap", "delta", "none"),
  cl = 0.95,
  B = 1000,
  cores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A fitted multi-state model, as returned by <code>msm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariates</code></td>
<td>
<p>The covariate values at which to estimate the intensities.
This can either be:<br></p>
<p>the string <code>"mean"</code>, denoting the means of the covariates in the data
(this is the default),<br></p>
<p>the number <code>0</code>, indicating that all the covariates should be set to
zero,<br></p>
<p>or a list of values, with optional names. For example
</p>
<p><code>list (60, 1)</code>
</p>
<p>where the order of the list follows the order of the covariates originally
given in the model formula, or a named list,
</p>
<p><code>list (age = 60, sex = 1)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>If <code>"normal"</code> (the default) then calculate a confidence
interval by simulating <code>B</code> random vectors from the asymptotic
multivariate normal distribution implied by the maximum likelihood estimates
(and covariance matrix) of the log transition intensities and covariate
effects, then transforming.
</p>
<p>If <code>"bootstrap"</code> then calculate a confidence interval by non-parametric
bootstrap refitting.  This is 1-2 orders of magnitude slower than the
<code>"normal"</code> method, but is expected to be more accurate. See
<code>boot.msm</code> for more details of bootstrapping in <span class="pkg">msm</span>.
</p>
<p>If <code>"delta"</code> then confidence intervals are calculated based on the
delta method SEs of the log rates, but this is not recommended since it may
not respect the constraint that probabilities are less than one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>
<p>Width of the symmetric confidence interval to present.  Defaults
to 0.95.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Number of bootstrap replicates, or number of normal simulations
from the distribution of the MLEs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cores</code></td>
<td>
<p>Number of cores to use for bootstrapping using parallel
processing. See <code>boot.msm</code> for more details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For a continuous-time Markov process in state <code class="reqn">r</code>, the probability that
the next state is <code class="reqn">s</code> is <code class="reqn">-q_{rs} / q_{rr}</code>, where <code class="reqn">q_{rs}</code> is
the transition intensity (<code>qmatrix.msm</code>).
</p>
<p>A continuous-time Markov model is fully specified by these probabilities
together with the mean sojourn times <code class="reqn">-1/q_{rr}</code> in each state <code class="reqn">r</code>.
This gives a more intuitively meaningful description of a model than the
intensity matrix.
</p>
<p>Remember that <span class="pkg">msm</span> deals with continuous-time, not discrete-time
models, so these are <em>not</em> the same as the probability of observing
state <code class="reqn">s</code> at a fixed time in the future.  Those probabilities are given
by <code>pmatrix.msm</code>.
</p>


<h3>Value</h3>

<p>The matrix of probabilities that the next move of a process in state
<code class="reqn">r</code> (rows) is to state <code class="reqn">s</code> (columns).
</p>


<h3>Author(s)</h3>

<p>C. H. Jackson <a href="mailto:chris.jackson@mrc-bsu.cam.ac.uk">chris.jackson@mrc-bsu.cam.ac.uk</a>
</p>


<h3>See Also</h3>

<p><code>qmatrix.msm</code>,<code>pmatrix.msm</code>,<code>qratio.msm</code>
</p>


</div>