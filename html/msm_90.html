<div class="container">

<table style="width: 100%;"><tr>
<td>qmatrix.msm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Transition intensity matrix</h2>

<h3>Description</h3>

<p>Extract the estimated transition intensity matrix, and the corresponding
standard errors, from a fitted multi-state model at a given set of covariate
values.
</p>


<h3>Usage</h3>

<pre><code class="language-R">qmatrix.msm(
  x,
  covariates = "mean",
  sojourn = FALSE,
  ci = c("delta", "normal", "bootstrap", "none"),
  cl = 0.95,
  B = 1000,
  cores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A fitted multi-state model, as returned by <code>msm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariates</code></td>
<td>
<p>The covariate values at which to estimate the intensity
matrix.  This can either be:<br></p>
<p>the string <code>"mean"</code>, denoting the means of the covariates in the data
(this is the default),<br></p>
<p>the number <code>0</code>, indicating that all the covariates should be set to
zero,<br></p>
<p>or a list of values, with optional names. For example
</p>
<p><code>list (60, 1)</code>
</p>
<p>where the order of the list follows the order of the covariates originally
given in the model formula. Or more clearly, a named list,
</p>
<p><code>list (age = 60, sex = 1)</code>
</p>
<p>If some covariates are specified but not others, the missing ones default to
zero.
</p>
<p>With <code>covariates="mean"</code>, for factor / categorical variables, the mean
of the 0/1 dummy variable for each factor level is used, representing an
average over all values in the data, rather than a specific factor level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sojourn</code></td>
<td>
<p>Set to TRUE if the estimated sojourn times and their standard
errors should also be returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>If <code>"delta"</code> (the default) then confidence intervals are
calculated by the delta method, or by simple transformation of the Hessian
in the very simplest cases.  Normality on the log scale is assumed.
</p>
<p>If <code>"normal"</code>, then calculate a confidence interval by simulating
<code>B</code> random vectors from the asymptotic multivariate normal distribution
implied by the maximum likelihood estimates (and covariance matrix) of the
log transition intensities and covariate effects, then transforming.
</p>
<p>If <code>"bootstrap"</code> then calculate a confidence interval by non-parametric
bootstrap refitting.  This is 1-2 orders of magnitude slower than the
<code>"normal"</code> method, but is expected to be more accurate. See
<code>boot.msm</code> for more details of bootstrapping in <span class="pkg">msm</span>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>
<p>Width of the symmetric confidence interval to present.  Defaults
to 0.95.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Number of bootstrap replicates, or number of normal simulations
from the distribution of the MLEs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cores</code></td>
<td>
<p>Number of cores to use for bootstrapping using parallel
processing. See <code>boot.msm</code> for more details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Transition intensities and covariate effects are estimated on the log scale
by <code>msm</code>. A covariance matrix is estimated from the Hessian of
the maximised log-likelihood.
</p>
<p>A more practically meaningful parameterisation of a continuous-time Markov
model with transition intensities <code class="reqn">q_{rs}</code> is in terms of the mean
sojourn times <code class="reqn">-1 / q_{rr}</code> in each state <code class="reqn">r</code> and the probabilities
that the next move of the process when in state <code class="reqn">r</code> is to state <code class="reqn">s</code>,
<code class="reqn">-q_{rs} / q_{rr}</code>.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>Estimated transition intensity matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SE</code></td>
<td>
<p>Corresponding approximate standard errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>Lower confidence limits</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U</code></td>
<td>
<p>Upper confidence limits</p>
</td>
</tr>
</table>
<p>Or if <code>ci="none"</code>, then <code>qmatrix.msm</code> just returns the estimated
transition intensity matrix.
</p>
<p>If <code>sojourn</code> is <code>TRUE</code>, extra components called <code>sojourn</code>,
<code>sojournSE</code>, <code>sojournL</code> and <code>sojournU</code> are included,
containing the estimates, standard errors and confidence limits,
respectively, of the mean sojourn times in each transient state.
</p>
<p>The default print method for objects returned by <code>qmatrix.msm</code>
presents estimates and confidence limits. To present estimates and standard
errors, do something like
</p>
<p><code>qmatrix.msm(x)[c("estimates","SE")]</code>
</p>


<h3>Author(s)</h3>

<p>C. H. Jackson <a href="mailto:chris.jackson@mrc-bsu.cam.ac.uk">chris.jackson@mrc-bsu.cam.ac.uk</a>
</p>


<h3>See Also</h3>

<p><code>pmatrix.msm</code>, <code>sojourn.msm</code>,
<code>deltamethod</code>, <code>ematrix.msm</code>
</p>


</div>