<div class="container">

<table style="width: 100%;"><tr>
<td>LibrarySearch</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Perform the library search within R</h2>

<h3>Description</h3>

<p>Perform library search using a custom implementation of the Identity (EI
Normal) or Similarity (EI Simple) algorithm. Pairwise comparison of two
mass spectra is implemented in C.
</p>


<h3>Usage</h3>

<pre><code class="language-R">LibrarySearch(
  msp_objs_u,
  msp_objs_l,
  algorithm = c("identity_normal", "similarity_simple"),
  n_hits = 100L,
  hitlist_columns = c("formula", "mw", "smiles"),
  mz_min = NULL,
  mz_max = NULL,
  comments = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>msp_objs_u, msp_objs_l</code></td>
<td>
<p>A list of nested lists. Each nested list is a mass spectrum. Each nested
list must contain at least three elements: (1) <code>name</code> (a string) -
compound name (or short description); (2) <code>mz</code> (a numeric/integer
vector) - m/z values of mass spectral peaks; (3) <code>intst</code> (a
numeric/integer vector) - intensities of mass spectral peaks. Letters 'u'
and 'l' stand for unknown and library respectively). Mass spectra should be
pre-processed using the <code>PreprocessMassSpectra</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>algorithm</code></td>
<td>
<p>A string. Library search algorithm. Either the Identity EI Normal
(<code>identity_normal</code>) or Similarity EI Simple (<code>similarity_simple</code>)
algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_hits</code></td>
<td>
<p>An integer value. The maximum number of hits (i.e., candidates) to display.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hitlist_columns</code></td>
<td>
<p>A character vector. Three columns are always present in the returned
hitlist: <code>name</code>, <code>mf</code> (i.e., the match factor), and <code>idx</code>
(i.e., the index of the respective library mass spectrum in the
<code>msp_objs_l</code> list). Some additional columns can be added using the
<code>hitlist_columns</code> argument (e.g., <code>cas_no</code>, <code>formula</code>,
<code>inchikey</code>, etc.). Only scalar values (i.e., an atomic vector of unit
length) are allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mz_min, mz_max</code></td>
<td>
<p>An integer value. Boundaries of the m/z range (all m/z values out of this
range are not taken into account when the match factor is calculated).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comments</code></td>
<td>
<p>Any R object. Some additional information. It is saved as the 'comments'
attribute of the returned list.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Return a list of data frames. Each data frame is a hitlist (i.e., list of
possible candidates). Each hitlist always contains three columns:
<code>name</code>, <code>mf</code> (i.e., the match factor), and <code>idx</code> (i.e., the
index of the respective library mass spectrum in the <code>msp_objs_l</code>
list). Additional columns can be extracted using the <code>hitlist_columns</code>
argument. Library search options are saved as the
<code>library_search_options</code> attribute.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Reading the 'alkanes.msp' file
msp_file &lt;- system.file("extdata", "alkanes.msp", package = "mssearchr")

# Pre-processing
msp_objs_u &lt;- PreprocessMassSpectra(ReadMsp(msp_file)) # unknown mass spectra
msp_objs_l &lt;- PreprocessMassSpectra(massbank_alkanes)  # library mass spectra

# Searching using the Identity algorithm
hitlists &lt;- LibrarySearch(msp_objs_u, msp_objs_l,
                          algorithm = "identity_normal", n_hits = 10L,
                          hitlist_columns = c("formula", "smiles", "db_no"))

# Printing a hitlist for the first compound from the 'alkanes.msp' file
print(hitlists[[1]][1:5, ])

#&gt;        name       mf idx formula        smiles                db_no
#&gt; 1  UNDECANE 950.5551  11  C11H24   CCCCCCCCCCC MSBNK-{...}-JP006877
#&gt; 2  UNDECANE 928.4884  72  C11H24   CCCCCCCCCCC MSBNK-{...}-JP005760
#&gt; 3  DODECANE 905.7546  74  C12H26  CCCCCCCCCCCC MSBNK-{...}-JP006878
#&gt; 4 TRIDECANE 891.7862  41  C13H28 CCCCCCCCCCCCC MSBNK-{...}-JP006879
#&gt; 5  DODECANE 885.6247  42  C12H26  CCCCCCCCCCCC MSBNK-{...}-JP005756

</code></pre>


</div>