<div class="container">

<table style="width: 100%;"><tr>
<td>LibrarySearchUsingNistApi</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Perform the library search using an API from NIST</h2>

<h3>Description</h3>

<p>Perform the library search using an API for the MS Search software (NIST).
The search is performed by calling the <em>nistms$.exe</em> file. The API is
described in the NIST Mass Spectral Search Program manual. Library search
options are set within the MS Search (NIST) software. To perform automatic
library search the following settings should be set: (1) the 'Automatic
Search On' box should be checked; (2) the 'Number of Hits to Print' field
should contain reasonable value of candidates (e.g., 100).
</p>


<h3>Usage</h3>

<pre><code class="language-R">LibrarySearchUsingNistApi(
  msp_objs,
  mssearch_dir = NULL,
  temp_msp_file_dir = NULL,
  overwrite_spec_list = FALSE,
  comments = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>msp_objs</code></td>
<td>
<p>A list of nested lists. Each nested list is a mass spectrum. Each nested
list must contain at least three elements: (1) <code>name</code> (a string) -
compound name (or short description); (2) <code>mz</code> (a numeric/integer
vector) - m/z values of mass spectral peaks; (3) <code>intst</code> (a
numeric/integer vector) - intensities of mass spectral peaks. The number of
mass spectra should be 100 or less.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mssearch_dir</code></td>
<td>
<p>A string. Full path to the <em>MSSEARCH/</em> directory (e.g.
<em>C:/NIST20/MSSEARCH/</em>). This directory must contain the
<em>nistms$.exe</em> file. If <code>NULL</code>, an attempt is made to find the
path automatically using the <em>win.ini</em> file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>temp_msp_file_dir</code></td>
<td>
<p>A string. Path to a directory where a temporary msp-file is created. If
<code>NULL</code>, the temporary file is created in the <em>MSSEARCH/</em>
directory</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overwrite_spec_list</code></td>
<td>
<p>A logical value. If <code>TRUE</code>, all spectra in the 'Spec List' of the MS
Search (NIST) software are overwritten.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comments</code></td>
<td>
<p>Any R object. Some additional information (e.g., library search options,
the list of used libraries, etc.). It is saved as the 'comments' attribute
of the returned list.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function was tested using the MS Search (NIST) software (version 2.4)
and the NIST20 mass spectral database. Only two algorithms have been tested
yet: 'Identity EI Normal' and 'Similarity EI Simple'.
</p>
<p>A few temporary files are created in the <em>MSSEARCH/</em> directory
according to the description provided in the NIST Mass Spectral Search
Program manual.
</p>
<p>Library search options are set within the MS Search (NIST) software. To do
it, perform the following steps.
</p>

<ul>
<li>
<p> Open the MS Search (NIST) software.
</p>
</li>
<li>
<p> Press the 'Library Search Options' button.
</p>
</li>
<li>
<p> Select the required algorithm on the 'Search' tab (e.g., 'Identity,
EI Normal').
</p>
</li>
<li>
<p> Select the required set of libraries on the 'Libraries' tab.
</p>
</li>
<li>
<p> Ensure that the 'Automatic Search On' box is checked ('Automation'
tab).
</p>
</li>
<li>
<p> Set the 'Number of Hits to Print' to reasonable value (e.g., 100)
on the 'Automation' tab.
</p>
</li>
<li>
<p> Change other settings according to the goal (e.g., 'Presearch',
'Limits', 'Constraints', etc.).
</p>
</li>
</ul>
<h3>Value</h3>

<p>Return a list of data frames. Each data frame is a hitlist. The name of
unknown compound and compound in Library Factor (InLib) are saved as the
<code>unknown_name</code> and <code>inlib</code> attributes of the respective data
frame. Data frames contain the following elements:
</p>

<dl>
<dt><code>name</code></dt>
<dd>
<p>A character vector. Compound name.</p>
</dd>
<dt><code>mf</code></dt>
<dd>
<p>An integer vector. Match factor.</p>
</dd>
<dt><code>rmf</code></dt>
<dd>
<p>An integer vector. Reverse match factor.</p>
</dd>
<dt><code>prob</code></dt>
<dd>
<p>A numeric vector. Probability.</p>
</dd>
<dt><code>lib</code></dt>
<dd>
<p>A character vector. Library.</p>
</dd>
<dt><code>cas</code></dt>
<dd>
<p>A character vector. CAS number.</p>
</dd>
<dt><code>formula</code></dt>
<dd>
<p>A character vector. Chemical formula.</p>
</dd>
<dt><code>mw</code></dt>
<dd>
<p>An integer vector. Molecular weight.</p>
</dd>
<dt><code>id</code></dt>
<dd>
<p>An integer vector. ID in the database.</p>
</dd>
<dt><code>ri</code></dt>
<dd>
<p>A numeric vector. Retention index.</p>
</dd>
</dl>
<h3>Examples</h3>

<pre><code class="language-R">## Not run: 

# To run this example, ensure that MS Search (NIST) software is installed.

# Reading the 'alkanes.msp' file
msp_file &lt;- system.file("extdata", "alkanes.msp", package = "mssearchr")
msp_objs &lt;- ReadMsp(msp_file)

# Searching using the MS Search (NIST) API
hitlists &lt;- LibrarySearchUsingNistApi(msp_objs)
print(hitlists[[1]][1:5, ])

#&gt;           name  mf rmf  prob              lib cas formula  mw id ri
#&gt; 1     UNDECANE 951 960 55.70 massbank_alkanes   0  C11H24 156 11  0
#&gt; 2     UNDECANE 928 928 20.34 massbank_alkanes   0  C11H24 156 72  0
#&gt; 3     DODECANE 906 929  8.04 massbank_alkanes   0  C12H26 170 74  0
#&gt; 4    TRIDECANE 892 907  5.03 massbank_alkanes   0  C13H28 184 41  0
#&gt; 5     DODECANE 886 900  3.95 massbank_alkanes   0  C12H26 170 42  0

## End(Not run)

</code></pre>


</div>