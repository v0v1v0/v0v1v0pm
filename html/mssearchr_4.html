<div class="container">

<table style="width: 100%;"><tr>
<td>PreprocessMassSpectra</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pre-process mass spectra</h2>

<h3>Description</h3>

<p>Pre-process mass spectra. Pre-processing includes rounding/binning,
sorting, and normalization.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PreprocessMassSpectra(msp_objs, bin_boundary = 0.649, remove_zeros = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>msp_objs</code></td>
<td>
<p>A list of nested lists. Each nested list is a mass spectrum. Each nested
list must contain at least three elements: (1) the <code>name</code> element
(a string) - compound name (or short description); (2) the <code>mz</code>
element (a numeric/integer vector) - m/z values of mass spectral peaks; (3)
the <code>intst</code> (a numeric/integer vector) - intensities of mass
spectral peaks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bin_boundary</code></td>
<td>
<p>A numeric value. The position of a bin boundary (it can be considered as a
'rounding point'). The <code>bin_boundary</code> argument must be in the
following range: <code>0.01 &lt;= bin_boundary &lt;= 0.99</code>. The default value is
<code>0.649</code>. This value is used in the AMDIS software and it is close to
the optimal rounding rule proposed in our research (Khrisanfov, M.;
Samokhin, A. A General Procedure for Rounding m/z Values in Low‚Äêresolution
Mass Spectra. Rapid Comm Mass Spectrometry 2022, 36 (11), e9294.
https://doi.org/10.1002/rcm.9294).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove_zeros</code></td>
<td>
<p>An integer value. If <code>TRUE</code>, all m/z values with zero intensity are
excluded from mass spectra. It should be taken into account that all
zero-intensity peaks presented in a mass spectrum are considered as 'trace
peaks' in the case of MS Search software. As a result, the presence/absence
of such peaks can influence the value of the match factor.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Pre-processing includes the following steps:
</p>

<ul>
<li>
<p> Calculating a nominal mass spectrum. All floating point m/z values
are rounded to the nearest integer using the value of the
<code>bin_boundary</code> argument. Intensities of peaks with identical m/z
values are summed.
</p>
</li>
<li>
<p> Intensities of mass spectral peaks are normalized to 999 (as it is
done in the MS Search software).
</p>
</li>
<li>
<p> Intensities of mass spectral peaks are rounded to the nearest
integer.
</p>
</li>
<li>
<p> If the <code>remove_zeros</code> argument is <code>TRUE</code>, all
zero-intensity peaks are removed from the mass spectrum.
</p>
</li>
<li>
<p> The <code>preprocessed</code> attribute is added and set to <code>TRUE</code>
for the respective mass spectrum.
</p>
</li>
</ul>
<h3>Value</h3>

<p>A list of nested lists. Each nested list is a mass spectrum. Only the
<code>mz</code> and <code>intst</code> elements of each nested list are
modified during the pre-processing step.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Original mass spectra of chlorine and methane
msp_objs &lt;- list(
  list(name = "Chlorine",
       mz = c(34.96885, 36.96590, 69.93771, 71.93476, 73.93181),
       intst = c(0.83 * c(100, 32), c(100, 63.99, 10.24))),
  list(name = "Methane",
       mz = c(10, 11, 12, 13, 14, 15, 16, 17, 18, 19),
       intst = c(0, 0, 25, 75, 155, 830, 999, 10, 0, 0))
)
matrix(c(msp_objs[[1]]$mz, msp_objs[[1]]$intst), ncol = 2) # Chlorine
matrix(c(msp_objs[[2]]$mz, msp_objs[[2]]$intst), ncol = 2) # Methane

# Pre-processed mass spectra of chlorine and methane
pp_msp_objs &lt;- PreprocessMassSpectra(msp_objs, remove_zeros = TRUE)
matrix(c(pp_msp_objs[[1]]$mz, pp_msp_objs[[1]]$intst), ncol = 2) # Chlorine
matrix(c(pp_msp_objs[[2]]$mz, pp_msp_objs[[2]]$intst), ncol = 2) # Methane

</code></pre>


</div>