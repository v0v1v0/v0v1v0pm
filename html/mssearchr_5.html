<div class="container">

<table style="width: 100%;"><tr>
<td>ReadMsp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Read mass spectra from an msp-file (NIST format)</h2>

<h3>Description</h3>

<p>Read an msp-file containing mass spectra in the NIST format. The complete
description of the format can be found in the NIST Mass Spectral Search
Program manual. A summary is presented below in the "Description of the
NIST format" section.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ReadMsp(input_file)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>input_file</code></td>
<td>
<p>A string. The name of a file.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>Data from an msp-file are read without any modification (e.g., the order of
mass values is not changed, zero-intensity peaks are preserved, etc.).
</p>


<h3>Value</h3>

<p>Return a list of nested lists. Each nested list is a mass spectrum. Almost
all metadata fields (e.g., "Name", "CAS#", "Formula", "MW", etc.) are
represented as strings. All "Synon" fields are merged into a single
character vector. Mass values and intensities are represented as numeric
vectors (<code>mz</code> and <code>intst</code>). Names of fields are slightly
modified:
</p>

<ul>
<li>
<p> names are converted to lowercase;
</p>
</li>
<li>
<p> hash symbols are replaced with <code>_no</code>;
</p>
</li>
<li>
<p> any other special character is replaced with an underscore
character.
</p>
</li>
</ul>
<h3>Description of the NIST format</h3>

<p>The summary was prepared using the NIST Mass Spectral Search Program manual
v.2.4 (2020).
</p>

<ul>
<li>
<p> An msp-file can contain as many spectra as wanted.
</p>
</li>
<li>
<p> Each spectrum must start with the "Name" field. There must be
something in this field.
</p>
</li>
<li>
<p> The "Num Peaks" field is also required. It must contain the number
of mass/intensity pairs.
</p>
</li>
<li>
<p> Some optional fields (e.g. "Comments", "Formula", "MW") can be
between the "Name" and "Num Peaks" fields.
</p>
</li>
<li>
<p> When a spectrum is exported from the NIST library it also
contains the "NIST#" and "DB#" fields. The "NIST#" field is on the same
line as the "CAS#" field and separated by a semicolon.
</p>
</li>
<li>
<p> Each field should be on a separate line (the "NIST#" field is an
exception from this rule)
</p>
</li>
<li>
<p> The mass/intensity list begins on the line following the "Num
Peaks" field. The peaks need not be normalized, and the masses need not
be ordered. The exact spacing and delimiters used for the mass/intensity
pairs are unimportant. The following characters are accepted as
delimiters: '<code>space</code>', '<code>tab</code>', '<code>,</code>', '<code>;</code>',
'<code>:</code>'. Parentheses, square brackets and curly braces  ('<code>(</code>',
'<code>(</code>', '<code>[</code>', '<code>]</code>', '<code>{</code>', and '<code>}</code>') are
also allowed.
</p>
</li>
<li>
<p> The "Name" field can be up to 511 characters.
</p>
</li>
<li>
<p> The "Comments" field can be up to 1023 characters.
</p>
</li>
<li>
<p> The "Formula" field can be up to 23 characters.
</p>
</li>
<li>
<p> The "Synon" field may be repeated.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R"># Reading the 'alkanes.msp' file
msp_file &lt;- system.file("extdata", "alkanes.msp", package = "mssearchr")
msp_objs &lt;- ReadMsp(msp_file)

# Plotting the first mass spectrum from the 'msp_objs' list
par_old &lt;- par(yaxs = "i")
plot(msp_objs[[1]]$mz, msp_objs[[1]]$intst,
     ylim = c(0, 1000), main = msp_objs[[1]]$name,
     type = "h", xlab = "m/z", ylab = "Intensity", bty = "l")
par(par_old)

</code></pre>


</div>