<div class="container">

<table style="width: 100%;"><tr>
<td>eapEst</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>EAP ability estimation (dichotomous and polytomous IRT models)</h2>

<h3>Description</h3>

<p>This command returns the EAP (expected a posteriori) ability estimate for a given response pattern and a given matrix of item parameters, either under the 4PL model or any suitable polytomous IRT model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">eapEst(it, x, model = NULL, D = 1, priorDist = "norm", priorPar = c(0, 1), 
 	lower = -4, upper = 4, nqp = 33)
 </code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>it</code></td>
<td>
<p>numeric: a suitable matrix of item parameters. See <b>Details</b>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numeric: a vector of item responses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>either <code>NULL</code> (default) for dichotomous models, or any suitable acronym for polytomous models. Possible values are <code>"GRM"</code>, <code>"MGRM"</code>, <code>"PCM"</code>, <code>"GPCM"</code>, <code>"RSM"</code> and <code>"NRM"</code>. See <b>Details</b>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>numeric: the metric constant. Default is <code>D=1</code> (for logistic metric); <code>D=1.702</code> yields approximately the normal metric (Haley, 1952). Ignored if <code>model</code> is not <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priorDist</code></td>
<td>
<p>character: specifies the prior distribution. Possible values are <code>"norm"</code> (default), <code>"unif"</code> and <code>"Jeffreys"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priorPar</code></td>
<td>
<p>numeric: vector of two components specifying the prior parameters (default is <code>c(0,1)</code>). Ignored if <code>priorDist="Jeffreys"</code>.
See <b>Details</b>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>numeric: the lower bound for numercal integration (default is -4).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>numeric: the upper bound for numercal integration (default is 4).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nqp</code></td>
<td>
<p>numeric: the number of quadrature points (default is 33).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The EAP (expected a posteriori) ability estimator (Bock and Mislevy, 1982) is obtained by computing the average of the posterior distribution of ability, the latter being set as the prior distribution times the likelihood function. 
</p>
<p>Dichotomous IRT models are considered whenever <code>model</code> is set to <code>NULL</code> (default value). In this case, <code>it</code> must be a matrix with one row per item and four columns, with the values of the discrimination, the difficulty, the pseudo-guessing and the inattention parameters (in this order). These are the parameters of the four-parameter logistic (4PL) model
(Barton and Lord, 1981). 
</p>
<p>Polytomous IRT models are specified by their respective acronym: <code>"GRM"</code> for Graded Response Model, <code>"MGRM"</code> for Modified Graded Response Model, <code>"PCM"</code> for Partical Credit Model, <code>"GPCM"</code> for Generalized Partial Credit Model, <code>"RSM"</code> for Rating Scale Model and <code>"NRM"</code> for Nominal Response Model. The <code>it</code> still holds one row per item, end the number of columns and their content depends on the model. See <code>genPolyMatrix</code> for further information and illustrative examples of suitable polytomous item banks.
</p>
<p>Three prior distributions are available: the normal distribution, the uniform distribution and Jeffreys' prior distribution (Jeffreys, 1939, 1946).
The prior distribution is specified by the argument <code>priorPar</code>, with values <code>"norm"</code>, <code>"unif"</code> and <code>"Jeffreys"</code>, respectively. 
</p>
<p>The argument <code>priorPar</code> determines either the prior mean and standard deviation of the normal prior distribution (if 
<code>priorDist="norm"</code>), or the range for defining the prior uniform distribution (if <code>priorDist="unif"</code>). This argument is ignored if <code>priorDist="Jeffreys"</code>.
</p>
<p>The required integrals are approximated by numerical adaptive quadrature. This is achieved by using the <code>integrate.mstR</code> function. Arguments <code>lower</code>, <code>upper</code> and <code>nqp</code> define respectively the lower and upper bounds for numerical integration, and the number 
of quadrature points. By default, the numerical integration runs with 33 quadrature points on the range [-4; 4], that is, a sequence of values from -4 to 4 by steps of 0.25.
</p>


<h3>Value</h3>

<p>The estimated EAP ability level.
</p>


<h3>Author(s)</h3>

<p>David Magis <br>
Department of Psychology, University of Liege, Belgium <br><a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>


<h3>References</h3>

<p>Barton, M.A., and Lord, F.M. (1981). <em>An upper asymptote for the three-parameter logistic item-response model</em>. Research Bulletin 81-20. Princeton, NJ: Educational Testing Service.
</p>
<p>Bock, R. D., and Mislevy, R. J. (1982). Adaptive EAP estimation of ability in a microcomputer environment. <em>Applied Psychological Measurement, 6</em>, 431-444. doi: 10.1177/014662168200600405
</p>
<p>Haley, D.C. (1952). <em>Estimation of the dosage mortality relationship when the dose is subject to error</em>. Technical report no 15. Palo Alto, CA: Applied Mathematics and Statistics Laboratory, Stanford University. 
</p>
<p>Jeffreys, H. (1939). <em>Theory of probability</em>. Oxford, UK: Oxford University Press.
</p>
<p>Jeffreys, H. (1946). An invariant form for the prior probability in estimation problems. <em>Proceedings of the Royal Society of London. Series A, Mathematical and Physical Sciences, 186</em>, 453-461.
</p>
<p>Magis, D., and Raiche, G. (2012). Random Generation of Response Patterns under Computerized Adaptive Testing with the R 
Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>48 (8)</em>, 1-31. URL <a href="http://www.jstatsoft.org/v48/i08/">http://www.jstatsoft.org/v48/i08/</a>
</p>


<h3>See Also</h3>

<p><code>thetaEst</code>, <code>genPolyMatrix</code>, <code>integrate.mstR</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Dichotomous models ##

 # Generation of an item bank under 3PL with 100 items 
 m.3PL &lt;- genDichoMatrix(100, model = "3PL")
 m.3PL &lt;- as.matrix(m.3PL)

 # Creation of a response pattern (true ability level 0)
 set.seed(1)
 x &lt;- genPattern(0, m.3PL)

 # EAP estimation, standard normal prior distribution
 eapEst(m.3PL, x)

 # EAP estimation, uniform prior distribution upon range [-2,2]
 eapEst(m.3PL, x, priorDist = "unif", priorPar = c(-2, 2))

 # EAP estimation, Jeffreys' prior distribution  
 eapEst(m.3PL, x, priorDist = "Jeffreys")

 # Changing the integration settings
 eapEst(m.3PL, x, nqp = 100)

## Not run: 

## Polytomous models ##

 # Generation of an item bank under GRM with 100 items and at most 4 categories
 m.GRM &lt;- genPolyMatrix(100, 4, "GRM")
 m.GRM &lt;- as.matrix(m.GRM)

 # Creation of a response pattern (true ability level 0)
 set.seed(1)
 x &lt;- genPattern(0, m.GRM, model = "GRM")

 # EAP estimation, standard normal prior distribution
 eapEst(m.GRM, x, model = "GRM")

 # EAP estimation, uniform prior distribution upon range [-2,2]
 eapEst(m.GRM, x, model = "GRM", priorDist = "unif", priorPar = c(-2, 2))

 # EAP estimation, Jeffreys' prior distribution  
 eapEst(m.GRM, x, model = "GRM", priorDist = "Jeffreys")


 # Generation of a item bank under PCM with 20 items and at most 3 categories
 m.PCM &lt;- genPolyMatrix(20, 3, "PCM")
 m.PCM &lt;- as.matrix(m.PCM)

 # Creation of a response pattern (true ability level 0)
 set.seed(1)
 x &lt;- genPattern(0, m.PCM, model = "PCM")

 # EAP estimation, standard normal prior distribution
 eapEst(m.PCM, x, model = "PCM")

 # EAP estimation, uniform prior distribution upon range [-2,2]
 eapEst(m.PCM, x, model = "PCM", priorDist = "unif", priorPar = c(-2, 2))

 # EAP estimation, Jeffreys' prior distribution  
 eapEst(m.PCM, x, model = "PCM", priorDist = "Jeffreys")
 
## End(Not run)
 </code></pre>


</div>