<div class="container">

<table style="width: 100%;"><tr>
<td>Ji</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function <code class="reqn">J(\theta)</code> for weighted likelihood estimation (dichotomous and polytomous IRT models)</h2>

<h3>Description</h3>

<p>This command returns the <code class="reqn">J(\theta)</code> function that is necessary to obtain the weighted likelihood estimation of ability with dichotomous and polytomous IRT models, as well as its asymptotic standard error.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Ji(th, it, model = NULL, D = 1)
 </code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>th</code></td>
<td>
<p>numeric: the ability value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>it</code></td>
<td>
<p>numeric: a suitable matrix of item parameters. See <b>Details</b>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>either <code>NULL</code> (default) for dichotomous models, or any suitable acronym for polytomous models. Possible values are <code>"GRM"</code>, <code>"MGRM"</code>, <code>"PCM"</code>, <code>"GPCM"</code>, <code>"RSM"</code> and <code>"NRM"</code>. See <b>Details</b>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>numeric: the metric constant. Default is <code>D=1</code> (for logistic metric); <code>D=1.702</code> yields approximately the normal metric (Haley, 1952). Ignored if <code>model</code> is not <code>NULL</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code class="reqn">J(\theta)</code> fucntion is defined by (Samejima, 1998):
</p>
<p style="text-align: center;"><code class="reqn">J(\theta)=\sum_{j=1}^n \,\sum_{k=0}^{g_j} \frac{P_{jk}'(\theta)\,P_{jk}''(\theta)}{P_{jk}(\theta)}</code>
</p>

<p>where <code class="reqn">n</code> is the number of items; <code class="reqn">g_j</code> the number of response categories for item <em>j</em> (<code class="reqn">j=1, ..., n</code>); <code class="reqn">P_{jk}(\theta)</code> the response category probabilities and <code class="reqn">P_{jk}'(\theta)</code> and <code class="reqn">P_{jk}''(\theta)</code> the first and second derivatives with respect to <code class="reqn">\theta</code>. In case of dichotomous IRT models, this reduces to (Warm, 1989):
</p>
<p style="text-align: center;"><code class="reqn">J(\theta)=\sum_{j=1}^n \frac{P_j'(\theta)\,P_j''(\theta)}{P_j(\theta)\,Q_j(\theta)}</code>
</p>

<p>with <code class="reqn">Q_j(\theta)=1-P_j(\theta)</code>.
</p>
<p>This function is useful to compute the weighted likelihood estimates of ability with dichotomous and polytomous IRT models as well as their related asymptotic standard errors. 
</p>
<p>Dichotomous IRT models are considered whenever <code>model</code> is set to <code>NULL</code> (default value). In this case, <code>it</code> must be a matrix with one row per item and four columns, with the values of the discrimination, the difficulty, the pseudo-guessing and the inattention parameters (in this order). These are the parameters of the four-parameter logistic (4PL) model
(Barton and Lord, 1981). 
</p>
<p>Polytomous IRT models are specified by their respective acronym: <code>"GRM"</code> for Graded Response Model, <code>"MGRM"</code> for Modified Graded Response Model, <code>"PCM"</code> for Partical Credit Model, <code>"GPCM"</code> for Generalized Partial Credit Model, <code>"RSM"</code> for Rating Scale Model and <code>"NRM"</code> for Nominal Response Model. The <code>it</code> still holds one row per item, end the number of columns and their content depends on the model. See <code>genPolyMatrix</code> for further information and illustrative examples of suitable polytomous item banks.
</p>


<h3>Value</h3>

<p>A list with two arguments:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Ji</code></td>
<td>
<p>the vector with <code class="reqn">J(\theta)</code> values (one value per item).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dJi</code></td>
<td>
<p>the vector with first derivatives of the <code class="reqn">J(\theta)</code> values (one value per item).</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>David Magis <br>
Department of Psychology, University of Liege, Belgium <br><a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>


<h3>References</h3>

<p>Barton, M.A., and Lord, F.M. (1981). <em>An upper asymptote for the three-parameter logistic item-response model</em>. Research Bulletin 81-20. Princeton, NJ: Educational Testing Service.
</p>
<p>Haley, D.C. (1952). <em>Estimation of the dosage mortality relationship when the dose is subject to error</em>. Technical report no 15. Palo Alto, CA: Applied Mathematics and Statistics Laboratory, Stanford University. 
</p>
<p>Magis, D., and Raiche, G. (2012). Random Generation of Response Patterns under Computerized Adaptive Testing with the R Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>48 (8)</em>, 1-31. URL <a href="http://www.jstatsoft.org/v48/i08/">http://www.jstatsoft.org/v48/i08/</a>
</p>
<p>Samejima, F. (1998, April). <em>Expansion of Warm's weighted likelihood estimator of ability for the three-parameter logistic model to generate discrete responses.</em> PPaper presented at the annual meeting of the National Council on Measurement in Education, San Diego, CA.
</p>
<p>Warm, T.A. (1989). Weighted likelihood estimation of ability in item response models. <em>Psychometrika, 54</em>, 427-450. doi: 10.1007/BF02294627
</p>


<h3>See Also</h3>

<p><code>thetaEst</code>, <code>semTheta</code>, <code>genPolyMatrix</code> 
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Dichotomous models ##
 
 # Generation of an item bank under 3PL with 100 items 
 m.3PL &lt;- genDichoMatrix(100, model = "3PL")
 m.3PL &lt;- as.matrix(m.3PL)
 
 # Various J functions and derivatives
 # (various th and D values)
 Ji(th = 0, m.3PL)
 Ji(th = 0, m.3PL, D = 1.702)
 Ji(th = 1, m.3PL)

## Polytomous models ##

 # Generation of an item bank under GRM with 100 items and at most 4 categories
 m.GRM &lt;- genPolyMatrix(100, 4, "GRM")
 m.GRM &lt;- as.matrix(m.GRM)

 # Computation of J function and derivatives for ability level 0
 Ji(0, m.GRM, model = "GRM")

 # Generation of a item bank under PCM with 20 items and at most 3 categories
 m.PCM &lt;- genPolyMatrix(20, 3, "PCM")
 m.PCM &lt;- as.matrix(m.PCM)

 # Computation of J function and derivatives for ability level 1
 Ji(1, m.PCM, model = "PCM")
 </code></pre>


</div>