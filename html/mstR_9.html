<div class="container">

<table style="width: 100%;"><tr>
<td>MKL</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Module Kullback-Leibler (MKL) and posterior module Kullback-Leibler (MKLP)</h2>

<h3>Description</h3>

<p>This command returns the value of the Kullback-Leibler (MKL) or the posterior Kullback-Leibler (MKLP) weighted likelihood for a given target module and an item bank (both under dichotomous and polytomous IRT models).
</p>


<h3>Usage</h3>

<pre><code class="language-R">MKL(itemBank, modules, target.mod, theta = NULL, it.given, x, model = NULL, 
    lower = -4, upper = 4, nqp = 33, type = "MKL", priorDist = "norm", 
    priorPar = c(0, 1), D = 1)
 </code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>itemBank</code></td>
<td>
<p>numeric: a suitable matrix of item parameters. See <b>Details</b>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modules</code></td>
<td>
<p>a binary matrix that specifies the item membership to th emodules. See <b>Details</b>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target.mod</code></td>
<td>
<p>numeric: the module (referred to as its column number in the <code>modules</code> matrix) for which the information must be computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>either the provisional ability level or <code>NULL</code> (default). See <b>Details</b>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>it.given</code></td>
<td>
<p>numeric: a vector of item indicators for all previously administered items.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numeric: a vector of item responses, coded as 0 or 1 only (for dichotomous items) or from 0 to the number of response categories minus one (for polytomous items). The length of <code>x</code> must be equal to the length of <code>it.given</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>either <code>NULL</code> (default) for dichotomous models, or any suitable acronym for polytomous models. Possible values are <code>"GRM"</code>, <code>"MGRM"</code>, <code>"PCM"</code>, <code>"GPCM"</code>, <code>"RSM"</code> and <code>"NRM"</code>. See <b>Details</b>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>numeric: the lower bound for numerical integration (default is -4).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>numeric: the upper bound for numerical integration (default is 4).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nqp</code></td>
<td>
<p>numeric: the number of quadrature points (default is 33).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>character: the type of Kullback-Leibler information to be computed. Possible values are <code>"MKL"</code> (default) and <code>"MKLP"</code>. See <b>Details</b>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priorDist</code></td>
<td>
<p>character: the prior ability distribution. Possible values are <code>"norm"</code> (default) for the normal distribution, and <code>"unif"</code> for the uniform distribution. Ignored if <code>type</code> is not <code>"MPWI"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priorPar</code></td>
<td>
<p>numeric: a vector of two components with the prior parameters. If <code>priorDist</code> is <code>"norm"</code>, then <code>priorPar</code> contains the mean and the standard deviation of the normal distribution. If <code>priorDist</code> is <code>"unif"</code>, then <code>priorPar</code> contains the bounds of the uniform distribution. The default values are 0 and 1 respectively. Ignored if <code>type</code> is not <code>"MPWI"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>numeric: the metric constant. Default is <code>D=1</code> (for logistic metric); <code>D=1.702</code> yields approximately the normal metric (Haley, 1952). Ignored if <code>model</code> is not <code>NULL</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function extends the KL and the KLP methods to select the next item in CAT, to the MST framework. This command serves as a subroutine for the <code>nextModule</code> function.
</p>
<p>Dichotomous IRT models are considered whenever <code>model</code> is set to <code>NULL</code> (default value). In this case, <code>itemBank</code> must be a matrix with one row per item and four columns, with the values of the discrimination, the difficulty, the pseudo-guessing and the inattention parameters (in this order). These are the parameters of the four-parameter logistic (4PL) model (Barton and Lord, 1981). 
</p>
<p>Polytomous IRT models are specified by their respective acronym: <code>"GRM"</code> for Graded Response Model, <code>"MGRM"</code> for Modified Graded Response Model, <code>"PCM"</code> for Partical Credit Model, <code>"GPCM"</code> for Generalized Partial Credit Model, <code>"RSM"</code> for Rating Scale Model and <code>"NRM"</code> for Nominal Response Model. The <code>itemBank</code> still holds one row per item, end the number of columns and their content depends on the model. See <code>genPolyMatrix</code> for further information and illustrative examples of suitable polytomous item banks.
</p>
<p>FROM HERE
</p>
<p>Under polytomous IRT models, let <em>k</em> be the number of administered items, and set <code class="reqn">x_1, ..., x_k</code> as the provisional response pattern (where each response <code class="reqn">x_l</code> takes values in <code class="reqn">\{0, 1, ..., g_l\}</code>). Set <code class="reqn">\hat{\theta}_k</code> as the provisional ability estimate (with the first <em>k</em> responses). Set <code class="reqn">M</code> as the number of items in the target module of interest (not yet administered). Set also <code class="reqn">L(\theta | x_1, ..., x_k) </code> as the likelihood function of the first <code class="reqn">k</code> items and evaluated at <code class="reqn">\theta</code>. Set finally <code class="reqn">P_{jt}(\theta)</code> as the probability of answering response category <em>t</em> to item <em>j</em> of the target module (<code class="reqn">j = 1, ..., M</code>) for a given ability level <code class="reqn">\theta</code>. Then, module Kullack-Leibler (MKL) information is defined as
</p>
<p style="text-align: center;"><code class="reqn">MKL(\theta || \hat{\theta}_k) = \sum_{j=1}^{M} \sum_{t=0}^{g_j} \,P_{jt}(\hat{\theta}_k) \,\log \left( \frac{P_{jt}(\hat{\theta}_k)}{P_{jt}(\theta)}\right).</code>
</p>

<p>In case of dichotomous IRT models, all <code class="reqn">g_l</code> values reduce to 1, so that item responses <code class="reqn">x_l</code> equal either 0 or 1. Set simply <code class="reqn">P_j(\theta)</code> as the probability of answering item <em>j</em> correctly (<code class="reqn">j = 1, ..., M</code>) for a given ability level <code class="reqn">\theta</code>. Then, MKL information reduces to
</p>
<p style="text-align: center;"><code class="reqn">MKL(\theta || \hat{\theta}) = \sum_{j=1}^{M} \left\{P_j(\hat{\theta}) \,\log \left( \frac{P_j(\hat{\theta}_k)}{P_j(\theta)}\right) + [1-P_j(\hat{\theta}_k)] \,\log \left( \frac{1-P_j(\hat{\theta}_k)}{1-P_j(\theta)}\right) \right\}.</code>
</p>

<p>The quantity that is returned by this <code>MKL</code> function is either: the likelihood function weighted by module Kullback-Leibler information (the MKL value):
</p>
<p style="text-align: center;"><code class="reqn">MKL(\hat{\theta}_k) = \int MKL(\theta || \hat{\theta}_k) \, L(\theta | x_1, ..., x_k) \,d\theta</code>
</p>

<p>or the posterior function weighted by module Kullback-Leibler information (the MKLP value):
</p>
<p style="text-align: center;"><code class="reqn">MKLP(\hat{\theta}) = \int MKL(\theta || \hat{\theta}_k) \, \pi(\theta) \,L(\theta | x_1, ..., x_k) \,d\theta</code>
</p>

<p>where <code class="reqn">\pi(\theta)</code> is the prior distribution of the ability level.
</p>
<p>These integrals are approximated by the <code>integrate.mstR</code> function. The range of integration is set up 
by the arguments <code>lower</code>, <code>upper</code> and <code>nqp</code>, giving respectively the lower bound, the upper bound and the number of quadrature points. The default range goes from -4 to 4 with length 33 (that is, by steps of 0.25).
</p>
<p>The argument <code>type</code> defines the type of information to be computed. The default value, <code>"MKL"</code>, computes the MKL value, while the MKLP value is obtained with <code>type="MKLP"</code>. For the latter, the <code>priorDist</code> and <code>priorPar</code> arguments fix the prior ability distribution. 
The normal distribution is set up by <code>priorDist="norm"</code> and then, <code>priorPar</code> contains the mean and the standard deviation of the normal distribution. If <code>priorDist</code> is <code>"unif"</code>, then the uniform distribution is considered, and <code>priorPar</code> fixes the lower and upper bounds of that 
uniform distribution. By default, the standard normal prior distribution is assumed. This argument is ignored whenever <code>method</code> is not <code>"MKLP"</code>.
</p>
<p>The provisional response pattern and the related administered items are provided by the vectors <code>x</code> and <code>it.given</code> respectively. The target module (for which the maximum information is computed) is given by its column number in the <code>modules</code> matrix, through the <code>target.mod</code> argument. 
</p>
<p>The provisioal (ad-interim) ability level can be provided through the <code>theta</code> argument. If not provided or set to <code>NULL</code> (default value), it is then internally computed as the ML estimate of ability for the given response pattern <code>x</code> and the previously administered items <code>it.given</code>.
</p>


<h3>Value</h3>

<p>The required KL (or KLP) weighted module likelihood for the target module.
</p>


<h3>Author(s)</h3>

<p>David Magis <br>
Department of Psychology, University of Liege, Belgium <br><a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>


<h3>References</h3>

<p>Barton, M.A., and Lord, F.M. (1981). <em>An upper asymptote for the three-parameter logistic item-response model</em>.
Research Bulletin 81-20. Princeton, NJ: Educational Testing Service.
</p>
<p>Haley, D.C. (1952). <em>Estimation of the dosage mortality relationship when the dose is subject to error</em>. Technical report no 15. Palo Alto, CA: Applied Mathematics and Statistics Laboratory, Stanford University. 
</p>


<h3>See Also</h3>

<p><code>Ii</code>, <code>nextModule</code>, <code>integrate.mstR</code>, <code>genPolyMatrix</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Dichotomous models ##

 # Generation of an item bank under 2PL, made of 7 successive modules that target
 # different average ability levels and with different lengths
 # (the first generated item parameters hold two modules of 8 items each)
 it &lt;- rbind(genDichoMatrix(16, model = "2PL"),
             genDichoMatrix(6, model = "2PL", bPrior = c("norm", -1, 1)),
             genDichoMatrix(6, model = "2PL", bPrior = c("norm", 1, 1)),
             genDichoMatrix(9, model = "2PL", bPrior = c("norm", -2, 1)),
             genDichoMatrix(9, model = "2PL", bPrior = c("norm", 0, 1)),
             genDichoMatrix(9, model = "2PL", bPrior = c("norm", 2, 1)))
 it &lt;- as.matrix(it)

 # Creation of the 'module' matrix to list item membership in each module
 modules &lt;- matrix(0, 55, 7)
 modules[1:8, 1] &lt;- modules[9:16, 2] &lt;- modules[17:22, 3] &lt;- 1
 modules[23:28, 4] &lt;- modules[29:37, 5] &lt;- modules[38:46, 6] &lt;- 1
 modules[47:55, 7] &lt;- 1

 # Creation of the response pattern for module 1 and true ability level 0
 x &lt;- genPattern(th = 0, it = it[1:8,], seed = 1)

 # MKL for module 3
 MKL(it, modules, target.mod = 3, it.given = 1:8, x = x)

 # Same with pre-estimation of ability by ML (same result)
 th &lt;- thetaEst(it[1:8,], x, method = "ML") 
 MKL(it, modules, target.mod = 3, it.given = 1:8, x = x, theta = th)

 # Same with pre-estimation of ability by EAP (different result)
 th &lt;- thetaEst(it[1:8,], x, method = "EAP") 
 MKL(it, modules, target.mod = 3, it.given = 1:8, x = x, theta = th)

 # MKLP for module 3
 MKL(it, modules, target.mod = 3, it.given = 1:8, x = x, type = "MKLP")

 # MKL for for module 3, different integration range
 MKL(it, modules, target.mod = 3, it.given = 1:8, x = x, lower = -2, upper = 2, nqp = 20)

 # MKLP for module 3, uniform prior distribution on the range [-2,2]
 MKL(it, modules, target.mod = 3, it.given = 1:8, x = x, type = "MKLP", 
     priorDist = "unif", priorPar = c(-2, 2))


## Polytomous models ##

 # Same structure as above but parameters are now generated from PCM with at most
 # 4 categories
 it.pol &lt;- genPolyMatrix(55, model = "PCM", nrCat = 4)
 it.pol &lt;- as.matrix(it)

 # Creation of the response pattern for module 1 and true ability level 0
 x &lt;- genPattern(th = 0, it = it.pol[1:8,], seed = 1)

# MKL for module 3
 MKL(it.pol, modules, target.mod = 3, it.given = 1:8, x = x, model = "PCM")

 # Same with pre-estimation of ability by ML (same result)
 th &lt;- thetaEst(it.pol[1:8,], x, method = "ML", model = "PCM") 
 MKL(it.pol, modules, target.mod = 3, it.given = 1:8, x = x, theta = th, 
     model = "PCM")

 # Same with pre-estimation of ability by EAP (different result)
 th &lt;- thetaEst(it.pol[1:8,], x, method = "EAP", model = "PCM") 
 MKL(it.pol, modules, target.mod = 3, it.given = 1:8, x = x, theta = th, 
     model = "PCM")

 # MKLP for module 3
 MKL(it.pol, modules, target.mod = 3, it.given = 1:8, x = x, type = "MKLP", 
     model = "PCM")

 # MKL for for module 3, different integration range
 MKL(it.pol, modules, target.mod = 3, it.given = 1:8, x = x, lower = -2, 
     upper = 2, nqp = 20, model = "PCM")

 # MKLP for module 3, uniform prior distribution on the range [-2,2]
 MKL(it.pol, modules, target.mod = 3, it.given = 1:8, x = x, type = "MKLP", 
     priorDist = "unif", priorPar = c(-2, 2), model = "PCM")
 </code></pre>


</div>