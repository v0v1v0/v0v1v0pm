<div class="container">

<table style="width: 100%;"><tr>
<td>expand.covs.msdata</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Expand covariates in multi-state dataset in long format</h2>

<h3>Description</h3>

<p>Given a multi-state dataset in long format, and one or more covariates, this
function adds transition-specific covariates, expanding the original
covariate(s), to the dataset. The original dataset with the
transition-specific covariates appended is returned.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'msdata'
expand.covs(data, covs, append = TRUE, longnames = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>An object of class <code>"msdata"</code>, such as output by
<code>msprep</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covs</code></td>
<td>
<p>A character vector containing the names of the covariates in
<code>data</code> to be expanded</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>append</code></td>
<td>
<p>Logical value indicating whether or not the design matrix for
the expanded covariates should be appended to the data (default=<code>TRUE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>longnames</code></td>
<td>
<p>Logical value indicating whether or not the labels are to
be used for the names of the expanded covariates that are categorical
(default=<code>TRUE</code>); in case of <code>FALSE</code> numbers from 1 up to the
number of contrasts are used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to or from other methods. They
are ignored in this function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For a given basic covariate <code>Z</code>, the transition-specific covariate for
transition <code>s</code> is called <code>Z.s</code>. The concept of transition-specific
covariates in the context of multi-state models was introduced by Andersen,
Hansen &amp; Keiding (1991), see also Putter, Fiocco &amp; Geskus (2007). It is only
unambiguously defined for numeric covariates or for explicit codings. Then
it will take the value 0 for all rows in the long format dataframe for which
<code>trans</code> does not equal <code>s</code>. For the rows for which <code>trans</code>
equals <code>s</code>, the original value of <code>Z</code> is copied. In
<code>expand.covs</code>, when a given covariate is a factor, it will be expanded
on the design matrix given by
<code>model.matrix</code>. Missing values in the basic
covariates are allowed and result in missing values in the expanded
covariates.
</p>


<h3>Value</h3>

<p>An object of class 'msdata', containing the design matrix for the
transition- specific covariates, either on its own
(<code>append</code>=<code>FALSE</code>) or appended to the data
(<code>append</code>=<code>TRUE</code>).
</p>


<h3>Author(s)</h3>

<p>Hein Putter <a href="mailto:H.Putter@lumc.nl">H.Putter@lumc.nl</a>
</p>


<h3>References</h3>

<p>Andersen PK, Hansen LS, Keiding N (1991). Non- and
semi-parametric estimation of transition probabilities from censored
observation of a non-homogeneous Markov process. <em>Scandinavian Journal
of Statistics</em> <b>18</b>, 153–167.
</p>
<p>Putter H, Fiocco M, Geskus RB (2007). Tutorial in biostatistics: Competing
risks and multi-state models. <em>Statistics in Medicine</em> <b>26</b>,
2389–2430.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# transition matrix for illness-death model
tmat &lt;- trans.illdeath()
# small data set in wide format
tg &lt;- data.frame(illt=c(1,1,6,6,8,9),ills=c(1,0,1,1,0,1),
        dt=c(5,1,9,7,8,12),ds=c(1,1,1,1,1,1),
        x1=c(1,1,1,2,2,2),x2=c(6:1))
tg$x1 &lt;- factor(tg$x1,labels=c("male","female"))
# data in long format using msprep
tglong &lt;- msprep(time=c(NA,"illt","dt"),
        status=c(NA,"ills","ds"),data=tg,
        keep=c("x1","x2"),trans=tmat)
# expanded covariates
expand.covs(tglong,c("x1","x2"),append=FALSE)
expand.covs(tglong,"x1")
expand.covs(tglong,"x1",longnames=FALSE)

</code></pre>


</div>