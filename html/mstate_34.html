<div class="container">

<table style="width: 100%;"><tr>
<td>msfit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute subject-specific transition hazards with (co-)variances</h2>

<h3>Description</h3>

<p>This function computes subject-specific or overall cumulative transition
hazards for each of the possible transitions in the multi-state model. If
requested, also the variances and covariances of the estimated cumulative
transition hazards are calculated.
</p>


<h3>Usage</h3>

<pre><code class="language-R">msfit(
  object,
  newdata,
  variance = TRUE,
  vartype = c("aalen", "greenwood"),
  trans
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A <code>coxph</code> object describing the
fit of the multi-state model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>A data frame with the same variable names as those that
appear in the <code>coxph</code> formula. Its use is somewhat different from
<code>survfit</code>. See Details.  The argument
<code>newdata</code> may be omitted only if the right hand side of the formula in
the <code>coxph</code> object is <code>~strata(trans)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variance</code></td>
<td>
<p>A logical value indicating whether the (co-)variances of the
subject-specific transition hazards should be computed. Default is
<code>TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vartype</code></td>
<td>
<p>A character string specifying the type of variances to be
computed (so only needed if <code>variance</code>=<code>TRUE</code>).  Possible values
are <code>"aalen"</code> or <code>"greenwood"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trans</code></td>
<td>
<p>Transition matrix describing the states and transitions in the
multi-state model. See <code>trans</code> in <code>msprep</code> for more
detailed information</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The data frame needs to have one row for each transition in the multi-state
model. An additional column <code>strata</code> (numeric) is needed to describe
for each transition to which stratum it belongs. The name has to be
<code>strata</code>, even if in the original <code>coxph</code> call another variable
was used. For details refer to de Wreede, Fiocco &amp; Putter (2010). So far,
the results have been checked only for the <code>"breslow"</code> method of
dealing with ties in <code>coxph</code>, so this is
recommended.
</p>


<h3>Value</h3>

<p>An object of class <code>"msfit"</code>, which is a list containing
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Haz </code></td>
<td>
<p>A data frame with <code>time</code>, <code>Haz</code>, <code>trans</code>,
containing the estimated subject-specific hazards for each of the
transitions in the multi-state model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varHaz </code></td>
<td>
<p>A data frame with
<code>time</code>, <code>Haz</code>, <code>trans1</code>, <code>trans2</code> containing the
variances (<code>trans1</code>=<code>trans2</code>) and covariances
(<code>trans1</code>&lt;<code>trans2</code>) of the estimated hazards. This element is only
returned when <code>variance</code>=<code>TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trans</code></td>
<td>
<p>The transition
matrix used</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Hein Putter <a href="mailto:H.Putter@lumc.nl">H.Putter@lumc.nl</a>
</p>


<h3>References</h3>

<p>Putter H, Fiocco M, Geskus RB (2007). Tutorial in biostatistics:
Competing risks and multi-state models. <em>Statistics in Medicine</em>
<b>26</b>, 2389–2430.
</p>
<p>Therneau TM, Grambsch PM (2000). <em>Modeling Survival Data: Extending the
Cox Model</em>. Springer, New York.
</p>
<p>de Wreede LC, Fiocco M, and Putter H (2010). The mstate package for
estimation and prediction in non- and semi-parametric multi-state and
competing risks models. <em>Computer Methods and Programs in Biomedicine</em>
<b>99</b>, 261–274.
</p>
<p>de Wreede LC, Fiocco M, and Putter H (2011). mstate: An R Package for the
Analysis of Competing Risks and Multi-State Models. <em>Journal of
Statistical Software</em>, Volume 38, Issue 7.
</p>


<h3>See Also</h3>

<p><code>plot.msfit</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# transition matrix for illness-death model
tmat &lt;- trans.illdeath()
# data in wide format, for transition 1 this is dataset E1 of
# Therneau &amp; Grambsch (2000)
tg &lt;- data.frame(illt=c(1,1,6,6,8,9),ills=c(1,0,1,1,0,1),
        dt=c(5,1,9,7,8,12),ds=c(1,1,1,1,1,1),
        x1=c(1,1,1,0,0,0),x2=c(6:1))
# data in long format using msprep
tglong &lt;- msprep(time=c(NA,"illt","dt"),status=c(NA,"ills","ds"),
		data=tg,keep=c("x1","x2"),trans=tmat)
# events
events(tglong)
table(tglong$status,tglong$to,tglong$from)
# expanded covariates
tglong &lt;- expand.covs(tglong,c("x1","x2"))
# Cox model with different covariate
cx &lt;- coxph(Surv(Tstart,Tstop,status)~x1.1+x2.2+strata(trans),
	data=tglong,method="breslow")
summary(cx)
# new data, to check whether results are the same for transition 1 as
# those in appendix E.1 of Therneau &amp; Grambsch (2000)
newdata &lt;- data.frame(trans=1:3,x1.1=c(0,0,0),x2.2=c(0,1,0),strata=1:3)
msfit(cx,newdata,trans=tmat)

</code></pre>


</div>