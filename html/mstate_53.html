<div class="container">

<table style="width: 100%;"><tr>
<td>redrank</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Reduced rank proportional hazards model for competing risks and multi-state
models</h2>

<h3>Description</h3>

<p>This function estimates regression coefficients in reduced rank proportional
hazards models for competing risks and multi-state models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">redrank(
  redrank,
  full = ~1,
  data,
  R,
  strata = NULL,
  Gamma.start,
  method = "breslow",
  eps = 1e-05,
  print.level = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>redrank</code></td>
<td>
<p>Survival formula, starting with either Surv(time,status) ~ or
with Surv(Tstart,Tstop,status) ~, followed by a formula containing
covariates for which a reduced rank estimate is to be found</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>full</code></td>
<td>
<p>Optional, formula specifying that part which needs to be
retained in the model (so not subject to reduced rank)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Object of class 'msdata', as prepared for instance by
<code>msprep</code>, in which to interpret the <code>redrank</code> and,
optionally, the <code>full</code> formulas</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>Numeric, indicating the rank of the solution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strata</code></td>
<td>
<p>Name of covariate to be used inside the
<code>strata</code> part of
<code>coxph</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gamma.start</code></td>
<td>
<p>A matrix of dimension K x R, with K the number of
transitions and R the rank, to be used as starting value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The method for handling ties in
<code>coxph</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>Numeric value determining when the iterative algorithm is
finished (when for two subsequent iterations the difference in
log-likelihood is smaller than <code>eps</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.level</code></td>
<td>
<p>Determines how much output is written to the screen; 0:
no output, 1: iterations, for each iteration solutions of Alpha, Gamma,
log-likelihood, 2: also the Cox regression results</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For details refer to Fiocco, Putter &amp; van Houwelingen (2005, 2008).
</p>


<h3>Value</h3>

<p>A list with elements </p>
<table>
<tr style="vertical-align: top;">
<td><code>Alpha</code></td>
<td>
<p>the Alpha matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gamma</code></td>
<td>
<p>the
Gamma matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Beta</code></td>
<td>
<p>the Beta matrix corresponding to
<code>covariates</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Beta2</code></td>
<td>
<p>the Beta matrix corresponding to
<code>fullcovs</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cox.itr1</code></td>
<td>
<p>the <code>coxph</code>
object resulting from the last call giving <code>Alpha</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alphaX</code></td>
<td>
<p>the
matrix of prognostic scores given by <code>Alpha</code>, n x R, with n number of
subjects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter</code></td>
<td>
<p>the number of iterations needed to reach convergence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>the number of regression parameters estimated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>the
log-likelihood</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Marta Fiocco and Hein Putter <a href="mailto:H.Putter@lumc.nl">H.Putter@lumc.nl</a>
</p>


<h3>References</h3>

<p>Fiocco M, Putter H, van Houwelingen JC (2005). Reduced rank
proportional hazards model for competing risks. <em>Biostatistics</em>
<b>6</b>, 465–478.
</p>
<p>Fiocco M, Putter H, van Houwelingen HC (2008). Reduced-rank proportional
hazards regression and simulation-based prediction for multi-state models.
<em>Statistics in Medicine</em> <b>27</b>, 4340–4358.
</p>
<p>Putter H, Fiocco M, Geskus RB (2007). Tutorial in biostatistics: Competing
risks and multi-state models. <em>Statistics in Medicine</em> <b>26</b>,
2389–2430.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
    # This reproduces the results in Fiocco, Putter &amp; van Houwelingen (2005)
    # Takes a while to run
    data(ebmt2)
    # transition matrix for competing risks
    tmat &lt;- trans.comprisk(6,names=c("Relapse","GvHD","Bacterial","Viral","Fungal","Other"))
    # preparing long dataset
    ebmt2$stat1 &lt;- as.numeric(ebmt2$status==1)
    ebmt2$stat2 &lt;- as.numeric(ebmt2$status==2)
    ebmt2$stat3 &lt;- as.numeric(ebmt2$status==3)
    ebmt2$stat4 &lt;- as.numeric(ebmt2$status==4)
    ebmt2$stat5 &lt;- as.numeric(ebmt2$status==5)
    ebmt2$stat6 &lt;- as.numeric(ebmt2$status==6)
    covs &lt;- c("dissub","match","tcd","year","age")
    ebmtlong &lt;- msprep(time=c(NA,rep("time",6)),
                       stat=c(NA,paste("stat",1:6,sep="")),
                       data=ebmt2,keep=covs,trans=tmat)

    # The reduced rank 2 solution
    rr2 &lt;- redrank(Surv(Tstart,Tstop,status) ~ dissub+match+tcd+year+age,
                   data=ebmtlong, R=2)
    rr3$Alpha; rr3$Gamma; rr3$Beta; rr3$loglik
    # The reduced rank 3 solution
    rr3 &lt;- redrank(Surv(Tstart,Tstop,status) ~ dissub+match+tcd+year+age,
                   data=ebmtlong, R=3)
    rr3$Alpha; rr3$Gamma; rr3$Beta; rr3$loglik
    # The reduced rank 3 solution, with no reduction on age
    rr3 &lt;- redrank(Surv(Tstart,Tstop,status) ~ dissub+match+tcd+year, full=~age,
                   data=ebmtlong, R=3)
    rr3$Alpha; rr3$Gamma; rr3$Beta; rr3$loglik
    # The full rank solution
    fullrank &lt;- redrank(Surv(Tstart,Tstop,status) ~ dissub+match+tcd+year+age,
                        data=ebmtlong, R=6)
    fullrank$Beta; fullrank$loglik

## End(Not run)

</code></pre>


</div>