<div class="container">

<table style="width: 100%;"><tr>
<td>model_protein</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Model single protein.</h2>

<h3>Description</h3>

<p>Model a single protein from an MSThermExperiment object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">model_protein(expt, protein, min_rep_psm = 0, min_smp_psm = 0,
  min_tot_psm = 0, max_inf = 1, min_score, max_score, smooth = 0,
  method = "sum", method.denom = "near", trim = 0, bootstrap = 0,
  min_bs_psms = 8, annot_sep = "|", max_slope = 0, min_r2 = 0,
  min_reps = 0, only_modeled = 0, check_missing = 0,
  missing_cutoff = 0.3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>expt</code></td>
<td>
<p>An MSThermExperiment object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>protein</code></td>
<td>
<p>ID of the protein to model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_rep_psm</code></td>
<td>
<p>Minimum number of spectral matches required for each
replicate to model protein</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_smp_psm</code></td>
<td>
<p>Minimum number of spectral matches required for each
sample to model protein</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_tot_psm</code></td>
<td>
<p>Minimum number of spectral matches required across all
replicates to model protein</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_inf</code></td>
<td>
<p>Maximum co-isolation interference level allowed to include a
spectrum in protein-level quantification</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_score</code></td>
<td>
<p>minimum score allowed to include a
spectrum in protein-level quantification</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_score</code></td>
<td>
<p>maximum score allowed to include a
spectrum in protein-level quantification</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth</code></td>
<td>
<p>(t/F) Perform loess smoothing on the data prior to modeling</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Protein quantification method to use (see Details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method.denom</code></td>
<td>
<p>Method used to calculate denominator of abundance
(see Details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trim</code></td>
<td>
<p>(t/F) Trim all lower data points less than the abundance maximum</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootstrap</code></td>
<td>
<p>(T/F) Perform bootstrap analysis to determine confidence
intervals (slow)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_bs_psms</code></td>
<td>
<p>Minimum number of spectral matches required to perform
bootstrapping</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>annot_sep</code></td>
<td>
<p>Symbol used to separate protein group IDs (used for
retrieval of annotations) (default: '|')</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_slope</code></td>
<td>
<p>Maximum slope to consider model (implies "only_modeled")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_r2</code></td>
<td>
<p>Minimum R2 value to consider model (implies "only_modeled")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_reps</code></td>
<td>
<p>Minimum number of modeled replicates for each sample to
return protein</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>only_modeled</code></td>
<td>
<p>(t/F) Only consider modeled proteins</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check_missing</code></td>
<td>
<p>(t/F) Run simple test to filter out PSMs with missing
quantification channels where values are expected</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missing_cutoff</code></td>
<td>
<p>Minimum fraction relative to surrounding data points
used in the check for missing channels</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Valid quantification methods include:
</p>

<dl>
<dt>"sum"</dt>
<dd>
<p>use the sum of the spectrum values for each channel</p>
</dd>
<dt>"median"</dt>
<dd>
<p>use the median of the spectrum values for each
channel</p>
</dd>
<dt>"ratio.median"</dt>
<dd>
<p>Like "median", but values for each spectrum
are first converted to ratios according to "method.denom"
channel</p>
</dd>
<dt>"ratio.mean"</dt>
<dd>
<p>Like "ratio.median" but using mean of ratios</p>
</dd>
</dl>
<p>Valid denominator methods include:
</p>

<dl>
<dt>"first"</dt>
<dd>
<p>Use the first value (lowest temperature point)
(default)</p>
</dd>
<dt>"max"</dt>
<dd>
<p>Use the maximum value</p>
</dd>
<dt>"top3"</dt>
<dd>
<p>Use the mean of the three highest values</p>
</dd>
<dt>"near"</dt>
<dd>
<p>Use the median of all values greater than 80
the first value</p>
</dd>
</dl>
<h3>Value</h3>

<p>MSThermResult object
</p>


<h3>Examples</h3>

<pre><code class="language-R">control &lt;- system.file("extdata", "demo_project/control.tsv", package="mstherm")
annots  &lt;- system.file("extdata", "demo_project/annots.tsv",  package="mstherm")
expt    &lt;- MSThermExperiment(control, annotations=annots)
expt    &lt;- normalize_to_std(expt, "cRAP_ALBU_BOVIN", plot=FALSE)

model   &lt;- model_protein(expt, "P38707", smooth=TRUE, bootstrap=FALSE)
summary(model)

</code></pre>


</div>