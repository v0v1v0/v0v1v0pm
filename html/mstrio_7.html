<div class="container">

<table style="width: 100%;"><tr>
<td>Report</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract a MicroStrategy report into a R Data.Frame</h2>

<h3>Description</h3>

<p>Access, filter, publish, and extract data from in-memory reports.
Create a Report object to load basic information on a report dataset. Specify subset of report
to be fetched through Report$apply_filters() and Report$clear_filters() . Fetch dataset through
Report$to_dataframe() method.
</p>


<h3>Public fields</h3>

<div class="r6-fields">

<dl>
<dt><code>connection</code></dt>
<dd>
<p>MicroStrategy connection object</p>
</dd>
<dt><code>report_id</code></dt>
<dd>
<p>Identifier of a report.</p>
</dd>
<dt><code>parallel</code></dt>
<dd>
<p>If TRUE, downloads report data asynchronously. FALSE by default.</p>
</dd>
<dt><code>name</code></dt>
<dd>
<p>Report name.</p>
</dd>
<dt><code>attributes</code></dt>
<dd>
<p>Report attributes.</p>
</dd>
<dt><code>metrics</code></dt>
<dd>
<p>Report metrics</p>
</dd>
<dt><code>attr_elements</code></dt>
<dd>
<p>Report attribute elements.</p>
</dd>
<dt><code>selected_attributes</code></dt>
<dd>
<p>Attributes selected for filtering.</p>
</dd>
<dt><code>selected_metrics</code></dt>
<dd>
<p>Metrics selected for filtering.</p>
</dd>
<dt><code>selected_attr_elements</code></dt>
<dd>
<p>Attribute elements selected for filtering.</p>
</dd>
<dt><code>dataframe</code></dt>
<dd>
<p>Dataframe containing data fetched from the Report.</p>
</dd>
<dt><code>cross_tab</code></dt>
<dd>
<p>boolean for filtering cross tabbed reports logic</p>
</dd>
<dt><code>cross_tab_filters</code></dt>
<dd>
<p>view filters for cross tab reports</p>
</dd>
<dt><code>instance_id</code></dt>
<dd>
<p>Identifier of an instance if report instance has been already initialized.</p>
</dd>
</dl>
</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-new"><code>Report$new()</code></a>
</p>
</li>
<li> <p><a href="#method-to_dataframe"><code>Report$to_dataframe()</code></a>
</p>
</li>
<li> <p><a href="#method-apply_filters"><code>Report$apply_filters()</code></a>
</p>
</li>
<li> <p><a href="#method-clear_filters"><code>Report$clear_filters()</code></a>
</p>
</li>
<li> <p><a href="#method-get_attr_elements"><code>Report$get_attr_elements()</code></a>
</p>
</li>
<li> <p><a href="#method-clone"><code>Report$clone()</code></a>
</p>
</li>
</ul>
<hr>
<a id="method-new"></a>



<h4>Method <code>new()</code>
</h4>

<p>Initialize an instance of a report.
</p>


<h5>Usage</h5>

<div class="r"><pre>Report$new(connection, report_id, instance_id = NULL, parallel = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>connection</code></dt>
<dd>
<p>MicroStrategy connection object. See Connection class.</p>
</dd>
<dt><code>report_id</code></dt>
<dd>
<p>Identifier of a pre-existing report containing the required data.</p>
</dd>
<dt><code>instance_id</code></dt>
<dd>
<p>Identifier of an instance if report instance has been already initialized, NULL by default.</p>
</dd>
<dt><code>parallel</code></dt>
<dd>
<p>(bool, optional):  If True, utilize optimal number of threads to increase the download
speed. If False (default), this feature will be disabled.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-to_dataframe"></a>



<h4>Method <code>to_dataframe()</code>
</h4>

<p>Extract contents of a Report into a R Data Frame.
</p>


<h5>Usage</h5>

<div class="r"><pre>Report$to_dataframe(limit = NULL, callback = function(x, y) {
})</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>limit</code></dt>
<dd>
<p>(int, optional): Used to control data extraction behaviour on report with a large number of rows. By
default the limit is calculated automatically. If TRUE, overrides automatic limit.</p>
</dd>
<dt><code>callback</code></dt>
<dd>
<p>used by the GUI to extract the progress information</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>Dataframe with data fetched from the given Report.
</p>


<hr>
<a id="method-apply_filters"></a>



<h4>Method <code>apply_filters()</code>
</h4>

<p>Apply filters on the report data so only the chosen attributes, metrics, and attribute elements are
retrieved from the Intelligence Server.
</p>


<h5>Usage</h5>

<div class="r"><pre>Report$apply_filters(
  attributes = NULL,
  metrics = NULL,
  attr_elements = NULL,
  operator = "In"
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>attributes</code></dt>
<dd>
<p>(list or None, optional): ID numbers of attributes to be included in the filter. If list is
empty, no attributes will be selected and metric data will be aggregated.</p>
</dd>
<dt><code>metrics</code></dt>
<dd>
<p>(list or None, optional): ID numbers of metrics to be included in the filter. If list is empty,
no metrics will be selected.</p>
</dd>
<dt><code>attr_elements</code></dt>
<dd>
<p>(list or None, optional): Attributes' elements to be included in the filter.</p>
</dd>
<dt><code>operator</code></dt>
<dd>
<p>(character, optional): Supported view filter operators are either "In" or "NotIn". This defines
whether data will include ("In") or exclude ("NotIn") the supplied attr_elements values.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-clear_filters"></a>



<h4>Method <code>clear_filters()</code>
</h4>

<p>Clear previously set filters, allowing all attributes, metrics, and attribute elements to be retrieved.
</p>


<h5>Usage</h5>

<div class="r"><pre>Report$clear_filters()</pre></div>


<hr>
<a id="method-get_attr_elements"></a>



<h4>Method <code>get_attr_elements()</code>
</h4>

<p>Load all attribute elements of the Report. Accessible via Report$attr_elements.
Fetching attriubte elements will also allow for validating attriute elements by the filter object.
</p>


<h5>Usage</h5>

<div class="r"><pre>Report$get_attr_elements(limit = 50000, verbose = TRUE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>limit</code></dt>
<dd>
<p>How many rows of data to fetch per request.</p>
</dd>
<dt><code>verbose</code></dt>
<dd>
<p>If TRUE, displays list of attribute elements.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-clone"></a>



<h4>Method <code>clone()</code>
</h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>Report$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt>
<dd>
<p>Whether to make a deep clone.</p>
</dd>
</dl>
</div>




<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Create a connection object.
connection = Connection$new(base_url, username, password, project_name)

# Create a report object.
my_report &lt;- Report$new(connection, report_id)

# See attributes and metrics in the report.
my_report$attributes
my_report$metrics
my_report$attr_elements

# Specify attributes and metrics (columns) to be fetched.
my_report$apply_filters(attributes = my_report$attributes[1:2],
                           metrics = my_report$metrics[1:2])

# See the selection of attributes, metrics and attribute elements.
my_report$selected_attributes
my_report$selected_metrics
my_report$selected_attr_elements

# Clear filtering to load a full dataset.
my_report$clear_filters()

# Fetch data from the Intelligence Server.
my_report$to_dataframe()

# See the dataframe.
my_report$dataframe

## End(Not run)
</code></pre>


</div>