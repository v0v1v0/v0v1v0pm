<div class="container">

<table style="width: 100%;"><tr>
<td>osc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Orthogonal Signal Correction (OSC)
</h2>

<h3>Description</h3>

<p>Data pre-processing by orthogonal signal correction (OSC).
</p>


<h3>Usage</h3>

<pre><code class="language-R">osc(x, ...)

## Default S3 method:
osc(x, y, method="wold",center=TRUE,osc.ncomp=4,pls.ncomp=10,
   tol=1e-3, iter=20,...)

## S3 method for class 'formula'
osc(formula, data = NULL, ..., subset, na.action = na.omit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>

<p>A formula of the form <code>groups ~ x1 + x2 + ...</code>  That is, the
response is the grouping factor and the right hand side specifies
the (non-factor) discriminators.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>Data frame from which variables specified in <code>formula</code> are
preferentially to be taken.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>A matrix or data frame containing the explanatory variables if no formula is
given as the principal argument.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>A factor specifying the class for each observation if no formula principal 
argument is given.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>A method for calculating OSC weights, loadings and scores. The following methods are supported:
</p>

<ul>
<li> <p><code>wold:</code> Original Wold et al approach. 
</p>
</li>
<li> <p><code>sjoblom:</code> Sjoblom et al approach.
</p>
</li>
<li> <p><code>wise:</code> Wise and Gallagher approach. 
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>

<p>A logical value indicating whether the data set should be centred by column-wise.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>osc.ncomp</code></td>
<td>

<p>The number of components to be used in the OSC calculation.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pls.ncomp</code></td>
<td>

<p>The number of components to be used in the PLS calculation.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>

<p>A scalar value of tolerance for OSC computation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>

<p>The number of iteration used in OSC calculation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Arguments passed to or from other methods.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>

<p>An index vector specifying the cases to be used in the training
sample.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>

<p>A function to specify the action to be taken if <code>NA</code>s are found. The 
default action is <code>na.omit</code>, which leads to rejection of cases with 
missing values on any required variable. An alternative is <code>na.fail</code>, 
which causes an error if <code>NA</code> cases are found. 
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>osc</code> containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>A matrix of OSC corrected data set.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R2</code></td>
<td>

<p>R2 statistics. It is calculated as the fraction of variation in X after OSC 
correction for the calibration (training) data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>angle</code></td>
<td>

<p>An angle used for checking if scores <code>t</code> is orthogonal to <code>y</code>. An 
angle close to 90 degree means that orthogonality is achieved in the correction process.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>

<p>A matrix of OSC weights.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>A matrix of OSC loadings.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>

<p>A matrix of OSC scores.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>

<p>The (matched) function call.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>

<p>A logical value indicating whether the data set has been centred by column-wise.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>osc.ncomp</code></td>
<td>

<p>The number of component used in OSC computation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pls.ncomp</code></td>
<td>

<p>The number of component used in PLS computation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>The OSC algorithm used.
</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>This function may be called giving either a formula and
optional data frame, or a matrix and grouping factor as the first
two arguments. 
</p>


<h3>Author(s)</h3>

<p>Wanchang Lin 
</p>


<h3>References</h3>

<p>Wold, S., Antti, H., Lindgren, F., Ohman, J.(1998). Orthogonal signal correction of near infrared
spectra. <em>Chemometrics Intell. Lab. Syst.</em>, 44: 175-185.
</p>
<p>Westerhuis, J. A., de Jong, S., Smilde, A, K. (2001). Direct orthogonal signal correction. 
<em>Chemometrics Intell. Lab. Syst.</em>, 56: 13-25.
</p>
<p>Sjoblom. J., Svensson, O., Josefson, M., Kullberg, H., Wold, S. (1998). An evaluation of
orthogonal signal correction applied to calibration transfer of near infrared
spectra. <em>Chemometrics Intell. Lab. Syst.</em>,44: 229-244.
</p>
<p>Svensson, O., Kourti, T. and MacGregor, J.F. (2002). An investigation of orthogonal 
correction algorithms and their characteristics. <em>Journal of Chemometrics</em>, 16:176-188.
</p>
<p>Wise, B. M. and Gallagher, N.B. <em>http://www.eigenvector.com/MATLAB/OSC.html</em>.
</p>


<h3>See Also</h3>

<p><code>predict.osc</code>, <code>osc_wold</code>, <code>osc_sjoblom</code>,
<code>osc_wise</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(abr1)
cl   &lt;- factor(abr1$fact$class)
dat  &lt;- abr1$pos

## divide data as training and test data
idx &lt;- sample(1:nrow(dat), round((2/3)*nrow(dat)), replace=FALSE) 

## construct train and test data 
train.dat  &lt;- dat[idx,]
train.t    &lt;- cl[idx]
test.dat   &lt;- dat[-idx,]        
test.t     &lt;- cl[-idx] 

## build OSC model based on the training data
res &lt;- osc(train.dat, train.t, method="wise", osc.ncomp=2, pls.ncomp=4)
names(res)
res
summary(res)

## pre-process test data by OSC
test.dat.1 &lt;- predict(res,test.dat)$x

</code></pre>


</div>