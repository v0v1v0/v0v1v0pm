<div class="container">

<table style="width: 100%;"><tr>
<td>pval.util</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
P-values Utilities
</h2>

<h3>Description</h3>

<p>Functions to handle p-values of data set.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  pval.test(x,y, method="oneway.test",...)

  pval.reject(adjp,alpha)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>A data frame or matrix of data set. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>A factor or vector of class.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Hypothesis test such as <code>t.test</code> and <code>wilcox.test</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjp</code></td>
<td>
<p>A matrix-like p-values of simultaneously testing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>A vector of cutoff of p-values or Type I error rate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Arguments to pass.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>pval.test</code> returns a vector of p-values.
</p>
<p><code>pval.reject</code> returns a matrix indicating rejected number according to 
cutoff.
</p>


<h3>Author(s)</h3>

<p>Wanchang Lin 
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(lattice)

## Example for pval.test and pval.reject
## prepare data set
data(abr1)
cls &lt;- factor(abr1$fact$class)
dat &lt;- abr1$pos[,200:500]
dat &lt;- preproc(dat, method="log")

## select class "1" and "2" for feature ranking
ind &lt;- grepl("1|2", cls)
dat &lt;- dat[ind,,drop=FALSE] 
cls &lt;- cls[ind, drop=TRUE]   

## univariate p-values and its adjusted p-values
pval &lt;- sort(pval.test(dat, cls, method="t.test"))

## adjust p-values
pval.ad &lt;- sapply(c("fdr","bonferroni","BY"), function(y){
  p.adjust(pval, method=y)
})
pval.ad &lt;- cbind(raw=pval, pval.ad)
pval.reject(pval.ad,c(0.005, 0.01, 0.05))

## plot the all p-values
tmp &lt;- cbind(pval.ad, idx=1:nrow(pval.ad))
tmp &lt;- data.frame(tmp)

# pval_long &lt;- melt(tmp, id="idx")
pval_long &lt;- data.frame(idx = tmp$idx, stack(tmp, select = -idx))
pval_long &lt;- pval_long[c("idx", "ind", "values")]
names(pval_long) &lt;- c("idx", "variable", "value")

pval.p &lt;- xyplot(value~idx, data=pval_long, groups=variable,
                par.settings = list(superpose.line = list(lty=c(1:7))),
                as.table = TRUE, type="l", 
                par.strip.text = list(cex=0.65), ylim=c(-0.005, 1.0),
                ylab="P-values", xlab="Index of variables",
                main="p-values",
                auto.key = list(lines=TRUE, points = FALSE,space="right"),
                panel = function(x, y,...) {
                  panel.xyplot(x, y, ...)
                  panel.abline(h = 0.05, col = "red",lty =2)
                })
pval.p

</code></pre>


</div>