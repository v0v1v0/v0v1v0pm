<div class="container">

<table style="width: 100%;"><tr>
<td>cor.util</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Correlation Analysis Utilities
</h2>

<h3>Description</h3>

<p>Functions to handle correlation analysis on data set.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cor.cut(mat,cutoff=0.75,abs.f = FALSE,
        use = "pairwise.complete.obs", method = "pearson",...)
  
cor.hcl(mat, cutoff=0.75, use = "pairwise.complete.obs", 
        method = "pearson",fig.f=TRUE, hang=-1,
        horiz = FALSE, main = "Cluster Dendrogram", 
        ylab = ifelse(!horiz, "1 - correlation",""), 
        xlab = ifelse(horiz, "1 - correlation",""),...)
  
cor.heat(mat, use = "pairwise.complete.obs", method = "pearson",
         dend = c("right", "top", "none"),...)
  
corrgram.circle(co, 
                col.regions = colorRampPalette(c("red", "white", "blue")),
                scales = list(x = list(rot = 90)), ...) 

corrgram.ellipse(co,label=FALSE,
                 col.regions = colorRampPalette(c("red", "white", "blue")),
                 scales = list(x = list(rot = 90)), ...) 

cor.heat.gram(mat.1, mat.2, use = "pairwise.complete.obs", 
              method = "pearson", main="Heatmap of correlation", 
              cex=0.75, ...)
              
hm.cols(low = "green", high = "red", n = 123)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mat, mat.1, mat.2</code></td>
<td>

<p>A data frame or matrix. It should be noticed that <code>mat.1</code> and <code>mat.2</code>
must have the same number of row.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>A scalar value of threshold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abs.f</code></td>
<td>

<p>Logical flag indicating whether the absolute values should be used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fig.f</code></td>
<td>

<p>Logical flag indicating whether the dendrogram of correlation matrix should be plotted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hang</code></td>
<td>
<p>The fraction of the plot height by which labels should hang below 
the rest of the plot. A negative value will cause the labels to hang down 
from 0. See <code>plot.hclust</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>horiz</code></td>
<td>
<p>Logical indicating if the dendrogram should be drawn
<em>horizontally</em> or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main, xlab, ylab</code></td>
<td>
<p>Graphical parameters, see <code>plot.default</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dend</code></td>
<td>
<p>Character string indicating whether to draw 'right', 'top' or 
'none' dendrograms</p>
</td>
</tr>
</table>
<p>.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>use</code></td>
<td>
<p>Argument for <code>cor</code>. An optional character string giving a method for computing 
covariances in the presence of missing values.  This must be (an 
abbreviation of) one of the strings <code>"everything"</code>, <code>"all.obs"</code>, 
<code>"complete.obs"</code>,  <code>"na.or.complete"</code>, or <code>"pairwise.complete.obs"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Argument for <code>cor</code>. A character string indicating which correlation coefficient (or 
covariance) is to be computed.  One of  <code>"pearson"</code>, <code>"kendall"</code>, or <code>"spearman"</code>,
can be abbreviated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>co</code></td>
<td>
<p>Correlation matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label</code></td>
<td>
 
<p>A logical value indicating whether the correlation coefficient should be 
plotted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Additional parameters to <span class="pkg">lattice</span>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.regions</code></td>
<td>
<p>Color vector to be used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scales</code></td>
<td>
<p>A list determining how the x- and y-axes (tick marks and labels) 
are drawn. More details, see <code>xyplot</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>A numeric multiplier to control character sizes for axis labels</p>
</td>
</tr>
</table>
<p>.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>low</code></td>
<td>
<p> Colour for low value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>high</code></td>
<td>
<p> Colour for high value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The number of colors (&gt;= 1) to be in the palette</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>cor.cut</code> returns the pairs with correlation coefficient larger than <code>cutoff</code>.
</p>
<p><code>cor.hcl</code> computes hierarchical cluster analysis based on correlation 
coefficient. For other graphical parameters, see <code>plot.dendrogram</code>. 
</p>
<p><code>cor.heat</code> display correlation heatmap using <span class="pkg">lattice</span>.
</p>
<p><code>corrgram.circle</code> and <code>corrgram.ellipse</code> display corrgrams with
circle and ellipse. The functions are modified from codes given in 
Deepayan Sarkar's <code>Lattice: Multivariate Data Visualization with R, 
  13.3.3 Corrgrams as customized level plots, pp:238-241</code>.
</p>
<p><code>cor.heat.gram</code> handles the correlation of two data sets which have the 
same row number. The best application is correlation between MS data 
(metabolites) and meta/clinical data.
</p>
<p><code>hm.cols</code> creates a vector of n contiguous colors for heat map.  
</p>


<h3>Value</h3>

<p><code>cor.cut</code> returns a data frame with three columns, in which the first and second columns
are variable names and their correlation (lager than cutoff) are
given in the third column.
</p>
<p><code>cor.hcl</code> returns a list with components of each cluster group and all correlation
coefficients. 
</p>
<p><code>cor.heat</code> returns an object of class "trellis".
</p>
<p><code>corrgram.circle</code> returns an object of class "trellis".
</p>
<p><code>corrgram.ellipse</code> returns an object of class "trellis".
</p>
<p><code>cor.heat.gram</code> returns a list including the components:
</p>
 
<ul>
<li> <p><code>cor.heat</code>: An object of class  "trellis" for correlation heatmap 
ordered by the hierarchical clustering.
</p>
</li>
<li> <p><code>cor.gram</code>: An object of class  "trellis" for corrgrams with 
circle ordered by the hierarchical clustering.
</p>
</li>
<li> <p><code>cor.short</code>: A matrix of correlation coefficient in short format.
</p>
</li>
<li> <p><code>cor.long</code>: A matrix of correlation coefficient in long format.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Wanchang Lin 
</p>


<h3>References</h3>

<p>Michael Friendly (2002). 
<em>Corrgrams: Exploratory displays for correlation matrices</em>.
The American Statistician, 56, 316–324.
</p>
<p>D.J. Murdoch, E.D. Chow (1996).
<em>A graphical display of large correlation matrices</em>.
The American Statistician, 50, 178–180.
</p>
<p>Deepayan Sarkar (2008).  
<em>Lattice: Multivariate Data Visualization with R</em>. Springer.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(iris)
cor.cut(iris[,1:4],cutoff=0.8, use="pairwise.complete.obs")
cor.hcl(iris[,1:4],cutoff=0.75,fig.f = TRUE)
ph &lt;- cor.heat(iris[,1:4], dend="top")
ph
update(ph, scales = list(x = list(rot = 45)))

## change heatmap color scheme
cor.heat(iris[,1:4], dend="right", xlab="", ylab="",
  col.regions = colorRampPalette(c("green", "black", "red")))

## or use hm.cols
cor.heat(iris[,1:4], dend="right", xlab="", ylab="", col.regions = hm.cols())

## prepare data set
data(abr1)
cls &lt;- factor(abr1$fact$class)
dat &lt;- preproc(abr1$pos[,110:1930], method="log10")  

## feature selection
res &lt;- fs.rf(dat,cls)
## take top 20 features
fs  &lt;- res$fs.order[1:20]
## construct the data set for correlation analysis
mat &lt;- dat[,fs]

cor.cut(mat,cutoff=0.9)
ch &lt;- cor.hcl(mat,cutoff=0.75,fig.f = TRUE, xlab="Peaks")
## plot dendrogram horizontally with coloured labels.
ch &lt;- cor.hcl(mat,cutoff=0.75,fig.f = TRUE, horiz=TRUE,center=TRUE, 
              nodePar = list(lab.cex = 0.6, lab.col = "forest green", pch = NA),
              xlim=c(2,0))

names(ch)
cor.heat(mat,dend="right")
cor.heat(mat,dend="right",col.regions = colorRampPalette(c("yellow", "red")))

## use corrgram with order by the hierarchical clustering
co  &lt;- cor(mat, use="pairwise.complete.obs")
ord &lt;- order.dendrogram(as.dendrogram(hclust(as.dist(1-co)))) 
corrgram.circle(co[ord,ord], main="Corrgrams with circle")
corrgram.ellipse(co[ord,ord], label = TRUE, main = "Corrgrams with circle",
                 col.regions = hm.cols())

## if without ordering
corrgram.circle(co, main="Corrgrams with circle")

## example of cor.heat.gram 
fs.1  &lt;- res$fs.order[21:50]
mat.1 &lt;- dat[,fs.1]

res.cor &lt;- 
  cor.heat.gram(mat, mat.1, main="Heatmap of correlation between mat.1 and mat.2")
names(res.cor)
res.cor$cor.heat
res.cor$cor.gram

</code></pre>


</div>