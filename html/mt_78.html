<div class="container">

<table style="width: 100%;"><tr>
<td>panel.elli</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Panel Function for Plotting Ellipse and outlier </h2>

<h3>Description</h3>

<p><span class="pkg">lattice</span> panel functions for plotting grouped ellipse and outlier
</p>


<h3>Usage</h3>

<pre><code class="language-R">panel.elli(x, y, groups = NULL,conf.level = 0.975, ...)
panel.elli.1(x, y, subscripts, groups=NULL, conf.level = 0.975,
             ep=0, com.grp=NULL, no.grp=NULL, ell.grp=NULL, ...)
panel.outl(x, y, subscripts, groups=NULL, conf.level = 0.975, labs, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>Variables to be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>Confident level for ellipse</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups, subscripts</code></td>
<td>
<p> Internal parameters for Lattice.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labs</code></td>
<td>
<p>Labels for potential outliers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ep</code></td>
<td>
<p> An integer for plotting ellipse. <code>1</code> and <code>2</code> for 
plotting overall and group ellipse, respectively. Otherwise, none. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>com.grp</code></td>
<td>
<p>A list of characters to select which combination of
groups to be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no.grp</code></td>
<td>
<p>A list of characters to select which individual group
not to be plotted. Note it will be overridden by <code>com.grp</code>.
If no <code>com.grp</code> and <code>no.grp</code>, ellipses of each individual
group  will be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ell.grp</code></td>
<td>
<p>Another categorical vector used for plotting ellipse.
If provided, <code>ep</code>,<code>com.grp</code> and <code>no.grp</code> will be
ignored. It should be different from default <code>groups</code>, but has
the same length of <code>groups</code>. For details, see example below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments. See corresponding entry in
<code>xyplot</code> for non-trivial details.  </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>panel.elli</code> is modified from function
<code>panel.ellipse</code> in package <span class="pkg">latticeExtra</span>.
</p>
<p><code>panel.elli.1</code> gives more control on how to plot ellipse for the
current group. It also provides an option to plot ellipse based on
another user-defined groups.
</p>
<p><code>panel.outl</code> plots the labels of data points outside the ellipse.
These data points can be treated as potential outliers.
</p>


<h3>Value</h3>

<p>Retuns objects of class <code>"trellis"</code>.
</p>


<h3>Note</h3>

 <p><code>panel.elli.1</code> can be called by functions <code>grpplot</code>,
<code>pcaplot</code>, <code>mdsplot</code>, <code>pca_plot_wrap</code>,
<code>mds_plot_wrap</code>, <code>pls_plot_wrap</code> and <code>lda_plot_wrap</code> by
passing argument of <code>ep</code>. See examples of these function for
details. </p>


<h3>Author(s)</h3>

<p>Wanchang Lin 
</p>


<h3>See Also</h3>

<p><code>grpplot</code>, <code>pcaplot</code>, <code>mdsplot</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(lattice) 
data(iris)

## =====================================================================
## Examples of calling 'panel.elli' and 'panel.outl'
xyplot(Sepal.Length ~ Petal.Length, data = iris, groups=Species,
        par.settings = list(superpose.symbol = list(pch=c(15:17)),
                            superpose.line = list(lwd=2, lty=1:3)),
        panel = function(x, y, ...) {
            panel.xyplot(x, y, ...)
            panel.elli(x, y, ..., type="l",lwd=2)
            panel.outl(x,y, ...)
        },
        auto.key = list(x = .1, y = .8, corner = c(0, 0)),
        labs=rownames(iris), conf.level=0.9,adj = -0.5)

## Without groups
xyplot(Sepal.Length ~ Petal.Length, data = iris,
        par.settings = list(plot.symbol = list(cex = 1.1, pch=16)),
        panel = function(x, y, ...) {
            panel.xyplot(x, y, ...)
            panel.elli(x, y, ..., type="l", lwd = 2)
            panel.outl(x,y, ...)
        },
        auto.key = list(x = .1, y = .8, corner = c(0, 0)),
        labs=rownames(iris), conf.level=0.9,adj = -0.5)


## With conditioning
xyplot(Sepal.Length ~ Petal.Length|Species, data = iris, 
        par.settings = list(plot.symbol = list(cex = 1.1, pch=16)),
        layout=c(2,2),
        panel = function(x, y, ...) {
            panel.xyplot(x, y, ...)
            panel.elli(x, y, ..., type="l", lwd = 2)
            panel.outl(x,y, ...)
        },
        auto.key = list(x = .6, y = .8, corner = c(0, 0)),
        adj = 0,labs=rownames(iris), conf.level=0.95)

## =====================================================================
## Examples of 'panel.elli.1'
xyplot(Sepal.Length ~ Petal.Length, data = iris, groups=Species,
        ## ---------------------------------------------------
        ## Select what to be plotted.
        ep=2,
        ## com.grp = list(a="setosa",b=c("versicolor", "virginica")),
        ## no.grp = "setosa", ## Not draw ellipse for "setosa"
        ## ---------------------------------------------------
        par.settings = list(superpose.symbol = list(pch=c(15:17)),
                            superpose.line = list(lwd=2, lty=1:3)),
        panel = function(x, y, ...) {
            panel.xyplot(x, y, ...)
            panel.elli.1(x, y, ...)
            panel.outl(x,y, ...)
        },
        auto.key = list(points = TRUE, rectangles = FALSE, space = "right"),
        adj = 0,labs=rownames(iris), conf.level=0.95)

xyplot(Sepal.Length ~ Petal.Length, data = iris, groups=Species,
        ## ---------------------------------------------------
        ## Select what to be plotted.
        ep=2,
        ## com.grp = list(a="setosa",b=c("versicolor", "virginica")),
        no.grp = c("setosa","versicolor"),## Only draw "virginica"
        ## ---------------------------------------------------
        par.settings = list(superpose.symbol = list(pch=c(15:17)),
                            superpose.line = list(lwd=2, lty=1:3)),
        panel = function(x, y, ...) {
            panel.xyplot(x, y, ...)
            panel.elli.1(x, y, ...)
        },
        auto.key = list(x = .1, y = .8, corner = c(0, 0)))

xyplot(Sepal.Length ~ Petal.Length, data = iris, groups=Species,
        ## ---------------------------------------------------
        ## Select what to be plotted.
        ep=2,
        com.grp = list(a="setosa",b=c("versicolor", "virginica")),
        ## no.grp = "setosa", ## Not draw ellipse for "setosa"
        ## ---------------------------------------------------
        par.settings = list(superpose.symbol = list(pch=c(15:17)),
                            superpose.line = list(lwd=2, lty=1:3)),
        panel = function(x, y, ...) {
            panel.xyplot(x, y, ...)
            panel.elli.1(x, y, ...)
        },
        auto.key = list(x = .1, y = .8, corner = c(0, 0)))

  xyplot(Sepal.Length ~ Petal.Length, data = iris, groups=Species, ep=1,
        par.settings = list(superpose.symbol = list(pch=c(15:17)),
                            superpose.line = list(lwd=2, lty=1:3)),
        panel = function(x, y, ...) {
            panel.xyplot(x, y, ...)
            panel.elli.1(x, y, ...)
        },
        auto.key = list(points = TRUE, rectangles = FALSE, space = "right"))

## =====================================================================
## Another data set from package MASS
require(MASS)
data(Cars93)

## Plot ellipse based on original groups: DriveTrain
xyplot(Price~EngineSize, data=Cars93, groups=DriveTrain, ep=2,
        par.settings = list(superpose.symbol = list(pch=c(15:17)),
                            superpose.line = list(lwd=2, lty=1:3)),
        panel = function(x, y, ...) {
            panel.xyplot(x, y, ...)
            panel.elli.1(x, y, ...)
        },
        auto.key = list(points = TRUE, rectangles = FALSE, space = "right"))

## But we want to plot ellipse using AirBags
xyplot(Price~EngineSize, data=Cars93, groups=DriveTrain, 
        ell.grp=Cars93$AirBags,
        par.settings = list(superpose.symbol = list(pch=c(15:17)),
                            superpose.line = list(lwd=2, lty=1:3)),
        panel = function(x, y, ...) {
            panel.xyplot(x, y, ...)
            panel.elli.1(x, y, ...)
        },
        auto.key = list(points = TRUE, rectangles = FALSE, space = "right"))

</code></pre>


</div>