<div class="container">

<table style="width: 100%;"><tr>
<td>mtar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian estimation of a multivariate threshold autoregressive (TAR) model.</h2>

<h3>Description</h3>

<p>This function uses Gibbs sampling to generate a sample from the posterior
distribution of the parameters of a multivariate TAR model when the noise
process follows Gaussian, Student-<code class="reqn">t</code>, Slash, Symmetric Hyperbolic,
Contaminated normal, or Laplace distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mtar(
  formula,
  data,
  subset,
  Intercept = TRUE,
  ars,
  row.names,
  dist = "Gaussian",
  prior = list(),
  n.sim = 500,
  n.burnin = 100,
  n.thin = 1,
  log = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a three-part expression of type <code>Formula</code> describing the TAR model
to be fitted to the data. In the first part, the variables in the
multivariate output series are listed; in the second part, the threshold
series is specified, and in the third part, the variables in the
multivariate exogenous series are specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an (optional) data frame, list or environment (or object coercible by
as.data.frame to a data frame) containing the variables in the model.
If not found in data, the variables are taken from <code>environment(formula)</code>,
typically the environment from which <code>mtar</code> is called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an (optional) vector specifying a subset of observations to be used in the
fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Intercept</code></td>
<td>
<p>an (optional) logical variable. If <code>TRUE</code>, then the model
includes an intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ars</code></td>
<td>
<p>a list composed of three objects, namely: <code>p</code>, <code>q</code> and <code>d</code>,
each of which corresponds to a vector of non-negative integers with as many
elements as there are regimes in the TAR model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row.names</code></td>
<td>
<p>an (optional) vector that allows the user to name the time point to
which each row in the data set corresponds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>an (optional) character string that allows the user to specify the multivariate
distribution to be used to describe the behavior of the noise process. The
available options are: Gaussian ("Gaussian"), Student-<code class="reqn">t</code> ("Student-t"),
Slash ("Slash"), Symmetric Hyperbolic ("Hyperbolic"), Laplace ("Laplace"), and
contaminated normal ("Contaminated normal"). As default, <code>dist</code> is set to
"Gaussian".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>an (optional) list that allows the user to specify the values of the
hyperparameters, that is, allows to specify the values of the parameters
of the prior distributions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.sim</code></td>
<td>
<p>an (optional) positive integer specifying the required number of iterations
for the simulation after the burn-in period. As default, <code>n.sim</code> is set
to 500.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.burnin</code></td>
<td>
<p>an (optional) positive integer specifying the required number of burn-in
iterations for the simulation. As default, <code>n.burnin</code> is set to 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.thin</code></td>
<td>
<p>an (optional) positive integer specifying the required thinning interval
for the simulation. As default, <code>n.thin</code> is set to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>an (optional) logical variable. If <code>TRUE</code>, then the behaviour of the output
series is described using the exponentiated version of <code>dist</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object of class <em>mtar</em> in which the main results of the model fitted to the data are stored, i.e., a
list with components including
</p>

<table>
<tr>
<td style="text-align: left;">
<code>chains</code>   </td>
<td style="text-align: left;"> list with several arrays, which store the values of each model parameter in each iteration of the simulation,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>n.sim</code>    </td>
<td style="text-align: left;"> number of iterations of the simulation after the burn-in period,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>n.burnin</code> </td>
<td style="text-align: left;"> number of burn-in iterations in the simulation,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>n.thin</code>   </td>
<td style="text-align: left;"> thinning interval in the simulation,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>regim</code>    </td>
<td style="text-align: left;"> number of regimes, </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>ars</code>      </td>
<td style="text-align: left;"> list composed of three objects, namely: <code>p</code>, <code>q</code> and <code>d</code>,
                     each of which corresponds to a vector of non-negative integers with as
                     many elements as there are regimes in the TAR model,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>dist</code>     </td>
<td style="text-align: left;"> name of the multivariate distribution used to describe the behavior of
                     the noise process,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>threshold.series</code>  </td>
<td style="text-align: left;"> vector with the values of the threshold series,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>response.series</code>   </td>
<td style="text-align: left;"> matrix with the values of the output series,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>covariable.series</code> </td>
<td style="text-align: left;"> matrix with the values of the exogenous series,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>Intercept</code>    </td>
<td style="text-align: left;"> If <code>TRUE</code>, then the model included an intercept term,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>formula</code>      </td>
<td style="text-align: left;"> the formula,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>call</code>         </td>
<td style="text-align: left;"> the original function call.</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>References</h3>

<p>Nieto, F.H. (2005) Modeling Bivariate Threshold Autoregressive Processes in the Presence of Missing Data.
Communications in Statistics - Theory and Methods, 34, 905-930.
</p>
<p>Romero, L.V. and Calderon, S.A. (2021) Bayesian estimation of a multivariate TAR model when the noise
process follows a Student-t distribution. Communications in Statistics - Theory and Methods, 50, 2508-2530.
</p>
<p>Calderon, S.A. and Nieto, F.H. (2017) Bayesian analysis of multivariate threshold autoregressive models
with missing data. Communications in Statistics - Theory and Methods, 46, 296-318.
</p>


<h3>See Also</h3>

<p>DIC, WAIC
</p>


<h3>Examples</h3>

<pre><code class="language-R">
###### Example 1: Returns of the closing prices of three financial indexes
data(returns)
fit1 &lt;- mtar(~ COLCAP + BOVESPA | SP500, row.names=Date, dist="Slash",
             data=returns, ars=list(p=c(1,1,2)), n.burnin=100, n.sim=3000)
summary(fit1)

###### Example 2: Rainfall and two river flows in Colombia
data(riverflows)
fit2 &lt;- mtar(~ Bedon + LaPlata | Rainfall, row.names=Date, dist="Laplace",
             data=riverflows, ars=list(p=c(5,5,5)), n.burnin=100, n.sim=3000)
summary(fit2)


</code></pre>


</div>