<div class="container">

<table style="width: 100%;"><tr>
<td>simtar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulation of multivariate time series according to a TAR model</h2>

<h3>Description</h3>

<p>This function simulates multivariate time series according to a user-specified TAR model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simtar(
  n,
  k = 2,
  ars = list(p = 1),
  Intercept = TRUE,
  parms,
  delay = 0,
  thresholds = 0,
  t.series,
  ex.series,
  dist = "gaussian",
  extra
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>a positive integer value indicating the length of the desired output series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>a positive integer value indicating the dimension of the desired output series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ars</code></td>
<td>
<p>a list composed of three objects, namely: <code>p</code>, <code>q</code> and <code>d</code>,
each of which corresponds to a vector of <code class="reqn">l</code> non-negative integers, where <code class="reqn">l</code> represents the number of regimes in the TAR model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Intercept</code></td>
<td>
<p>an (optional) logical variable. If <code>TRUE</code>, then the model includes an intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parms</code></td>
<td>
<p>a list with as many sublists as regimes in the user-specified TAR model. Each sublist is composed of two matrices. The first corresponds
to location parameters, while the second corresponds to scale parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delay</code></td>
<td>
<p>an (optional) non-negative integer value indicating the delay in the threshold series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresholds</code></td>
<td>
<p>a vector with <code class="reqn">l-1</code> real values sorted ascendingly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t.series</code></td>
<td>
<p>a matrix with the values of the threshold series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ex.series</code></td>
<td>
<p>a matrix with the values of the multivariate exogenous series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>an (optional) character string which allows the user to specify the multivariate
distribution to be used to describe the behavior of the noise process. The
available options are: Gaussian ("Gaussian"), Student-<code class="reqn">t</code> ("Student-t"),
Slash ("Slash"), Symmetric Hyperbolic ("Hyperbolic"), Laplace ("Laplace"), and
contaminated normal ("Contaminated normal"). As default, <code>dist</code> is set to
"Gaussian".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extra</code></td>
<td>
<p>a value indicating the value of the extra parameter of the noise process distribution, if any.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>data.frame</code> containing the output series, threshold series (if any), and multivariate exogenous series (if any).
</p>


<h3>Examples</h3>

<pre><code class="language-R">###### Simulation of a trivariate TAR model with two regimes
n &lt;- 2000
k &lt;- 3
ars &lt;- list(p=c(1,2))
Z &lt;- as.matrix(arima.sim(n=n+max(ars$p),list(ar=c(0.5))))
Intercept &lt;- TRUE
parms &lt;- list()
for(i in 1:length(ars$p)){
   np &lt;- Intercept + ars$p[i]*k
   parms[[i]] &lt;- list()
   parms[[i]]$location &lt;- c(ifelse(runif(np*k)&lt;=0.5,1,-1)*rbeta(np*k,shape1=4,shape2=16))
   parms[[i]]$location &lt;- matrix(parms[[i]]$location,np,k)
   parms[[i]]$scale &lt;- rgamma(k,shape=1,scale=1)*diag(k)
}
thresholds &lt;- quantile(Z,probs=seq(1,length(ars$p)-1)/length(ars$p))
out1 &lt;- simtar(n=n,k=k,ars=ars,Intercept=Intercept,parms=parms,
               thresholds=thresholds,t.series=Z,dist="Student-t",extra=6)
str(out1)

###### Simulation of a trivariate VAR model
n &lt;- 2000
k &lt;- 3
ars &lt;- list(p=2)
Intercept &lt;- TRUE
parms &lt;- list()
for(i in 1:length(ars$p)){
   np &lt;- Intercept + ars$p[i]*k
   parms[[i]] &lt;- list()
   parms[[i]]$location &lt;- c(ifelse(runif(np*k)&lt;=0.5,1,-1)*rbeta(np*k,shape1=4,shape2=16))
   parms[[i]]$location &lt;- matrix(parms[[i]]$location,np,k)
   parms[[i]]$scale &lt;- rgamma(k,shape=1,scale=1)*diag(k)
}
out2 &lt;- simtar(n=n,k=k,ars=ars,Intercept=Intercept,parms=parms,
               dist="Slash",extra=2)
str(out2)

</code></pre>


</div>