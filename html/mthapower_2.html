<div class="container">

<table style="width: 100%;"><tr>
<td>mthapower</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Power calculations - mtDNA haplogroups</h2>

<h3>Description</h3>

<p>For a given study size, determine the minimum effect size that can be detected with the desired power and significance level, in a study with <code>Nh</code> haplogroups.
Note: I assume that case-control equations are valid for cohorts with a balanced number of cases and controls.
This function may not be generalizable for all studies involving mtDNA haplogroups.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mthapower(n.cases = ncases, p0 = p0, Nh = Nh,
  OR.cas.ctrl = OR.cas.ctrl, sig.level = sig.level)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n.cases</code></td>
<td>
<p>number of cases or controls from the study. It can be either a single value, or a sequence: <code>n.cases &lt;- 300</code>; <code>n.cases &lt;- seq(50,500 by=10)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p0</code></td>
<td>
<p>the frequency of the haplogroup in the control population. It depends on haplogroup baseline frequency.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nh</code></td>
<td>
<p>number of categories for haplogroups. Usually 10 haplogroups plus one category for rare haplogroups: <code>Nh &lt;- 11</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>OR.cas.ctrl</code></td>
<td>
<p>(p1 / (1-p1)) / (p0 / (1-p0)) the OR you want to detect with your data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig.level</code></td>
<td>
<p>the alpha error accepted. Can take 3 possible values: <code>0.05</code>, <code>0.01</code> and <code>0.001</code> (see [Table 2] of Samuels et al).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Calculates power given the number of cases and other parameters. The output is an object of class <code>data.frame</code>, ready to plot.
</p>


<h3>Author(s)</h3>

<p>Author and maintainer: Aurora Baluja. Email: <a href="mailto:mariauror@gmail.com">mariauror@gmail.com</a>
</p>


<h3>References</h3>

<p>1. DC Samuels, AD Carothers, R Horton, PF Chinnery. The Power to Detect Disease Associations with Mitochondrial DNA Haplogroups. AJHG, 2006. 78(4):713-720. <a href="https://www.ncbi.nlm.nih.gov/pmc/PMC1424681">DOI:10.1086/502682</a>.
</p>
<p>2. Source code: <a href="https://github.com/aurora-mareviv/mthapower">github.com/aurora-mareviv/mthapower</a>.
</p>
<p>3. Shiny app: <a href="https://aurora.shinyapps.io/mtDNA_power_calc">aurora.shinyapps.io/mtDNA_power_calc</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Example 1:
pow &lt;- mthapower(n.cases=203, p0=0.443, Nh=13, OR.cas.ctrl=2.33, sig.level=0.05)

# Example 2:
# Create data frames
pow.H150 &lt;- mthapower(n.cases=seq(50,1000,by=50), p0=0.433, Nh=11,
                      OR.cas.ctrl=1.5, sig.level=0.05)
pow.H175 &lt;- mthapower(n.cases=seq(50,1000,by=50), p0=0.433, Nh=11,
                      OR.cas.ctrl=1.75, sig.level=0.05)
pow.H200 &lt;- mthapower(n.cases=seq(50,1000,by=50), p0=0.433, Nh=11,
                      OR.cas.ctrl=2, sig.level=0.05)
pow.H250 &lt;- mthapower(n.cases=seq(50,1000,by=50), p0=0.433, Nh=11,
                      OR.cas.ctrl=2.5, sig.level=0.05)

# Bind the three data frames:
bindata &lt;- rbind(pow.H150,pow.H175,pow.H200,pow.H250)
# Adds column OR to binded data frame:
bindata$OR &lt;- rep(factor(c(1.50,1.75,2,2.5)),
              times = c(nrow(pow.H150),
                        nrow(pow.H175),
                        nrow(pow.H200),
                        nrow(pow.H250)))
# Create plot:
# install.packages("car")
library(car)
scatterplot(power~ncases | OR, regLine=FALSE,
            smooth=FALSE,
            boxplots=FALSE,  by.groups=TRUE,
            data=bindata)

</code></pre>


</div>