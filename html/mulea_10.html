<div class="container">

<table style="width: 100%;"><tr>
<td>plot_graph</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot Graph (Network)</h2>

<h3>Description</h3>

<p>Plots graph representation of enrichment results.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_graph(
  reshaped_results,
  ontology_id_colname = "ontology_id",
  ontology_element_colname = "element_id_in_ontology",
  shared_elements_min_threshold = 0,
  p_value_type_colname = "eFDR",
  p_value_max_threshold = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>reshaped_results</code></td>
<td>
<p>Character, the input <code>data.table</code> containing the
reshaped results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ontology_id_colname</code></td>
<td>
<p>Character, the name of the column in the reshaped
results that contains ontology identifiers or names. Default value is
'ontology_id'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ontology_element_colname</code></td>
<td>
<p>Character, the name of the column in the
reshaped results that contains element identifiers within the ontology.
Default value is 'element_id_in_ontology'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shared_elements_min_threshold</code></td>
<td>
<p>Numeric, threshold specifying the
minimum number of shared elements required between two ontologies to
consider them connected by an edge on the graph. Default value is 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_value_type_colname</code></td>
<td>
<p>Character, the name of the column in the reshaped
results that contains the type of <em>p</em>-values associated with the ontology
elements. Default value is 'eFDR'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_value_max_threshold</code></td>
<td>
<p>Numeric, a threshold value for filtering
rows in the reshaped results based on the
<em>p</em>-values. Rows with <em>p</em>-values greater
than this threshold will be filtered out.
Default value is 0.05.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function generates a graph (network) visualization of the
enriched ontology entries. On the plot each node represents an ontology
entry below a given <em>p</em>-value threshold, and is coloured based on its
significance level. A connection (edge) is drawn between two nodes if they
share at least one common element (gene) belonging to the target set – in
the case of ORA results – or all analysed elements – in the case of GSEA
results.
</p>


<h3>Value</h3>

<p>Returns a graph plot.
</p>


<h3>See Also</h3>

<p><code>reshape_results</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(mulea)

# loading and filtering the example ontology from a GMT file
tf_gmt &lt;- read_gmt(file = system.file(package="mulea", "extdata", 
    "Transcription_factor_RegulonDB_Escherichia_coli_GeneSymbol.gmt"))
tf_gmt_filtered &lt;- filter_ontology(gmt = tf_gmt, min_nr_of_elements = 3, 
    max_nr_of_elements = 400)

# loading the example data
sign_genes &lt;- readLines(system.file(package = "mulea", "extdata", 
    "target_set.txt"))
background_genes &lt;- readLines(system.file(
    package="mulea", "extdata", "background_set.txt"))

# creating the ORA model
ora_model &lt;- ora(gmt = tf_gmt_filtered,
    # the test set variable
    element_names = sign_genes, 
    # the background set variable
    background_element_names = background_genes, 
    # the p-value adjustment method
    p_value_adjustment_method = "eFDR", 
    # the number of permutations
    number_of_permutations = 10000,
    # the number of processor threads to use
    nthreads = 2)
# running the ORA
ora_results &lt;- run_test(ora_model)

# reshaping results for visualisation
ora_reshaped_results &lt;- reshape_results(model = ora_model,
    model_results = ora_results,
    # choosing which column to use for the indication of significance
    p_value_type_colname = "eFDR")

# Plot graph
plot_graph(reshaped_results = ora_reshaped_results,
    # the column containing the names we wish to plot
    ontology_id_colname = "ontology_id",
    # upper threshold for the value indicating the significance
    p_value_max_threshold = 0.05,
    # column that indicates the significance values
    p_value_type_colname = "eFDR")
</code></pre>


</div>