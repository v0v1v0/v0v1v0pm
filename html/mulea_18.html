<div class="container">

<table style="width: 100%;"><tr>
<td>run_test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Run enrichment analysis procedure</h2>

<h3>Description</h3>

<p>This is a generic function that chooses an enrichment analysis procedure
based on the model class and runs the analysis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">run_test(model)

## S4 method for signature 'ora'
run_test(model)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Object of S4 class representing the mulea test.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>The function requires the definition of a model. Models currently
implemented in mulea include Gene Set Enrichment Analysis (GSEA) and
Over-Representation Analysis (ORA). These models must be defined through
their specific functions which are provided in this package.
</p>


<h3>Value</h3>

<p>Results in form of <code>data.frame</code>. Structure of <code>data.frame</code> depends on
object processed by this generic method.
In the case of <code>run_test</code> was used with the model generated
by the <code>ora</code> function the returned
<code>data.frame</code> contains the following columns:
</p>

<ol>
<li>
<p> 'ontology_id': Identifiers of the ontology elements.
</p>
</li>
<li>
<p> 'ontology_name': Names of the ontology elements.
</p>
</li>
<li>
<p> 'nr_common_with_tested_elements': Number of common elements between the
ontology element and the vector defined by the element_names parameter
of the <code>ora</code> function.
</p>
</li>
<li>
<p> 'nr_common_with_background_elements': Number of common elements between
the ontology element and the vector defined by the
background_element_names parameter of the <code>ora</code> function.
</p>
</li>
<li>
<p> 'p_value': The raw <em>p</em>-value of the overrepresentation analysis.
</p>
</li>
<li>
<p> The adjusted <em>p</em>-value.
The column named based on the
p_value_adjustment_method parameter of the
<code>ora</code> function, <em>e.g.</em> 'eFDR'
</p>
</li>
</ol>
<p>In the case of <code>run_test</code> was used with the model
generated by the <code>gsea</code> function the returned
<code>data.frame</code> contains the following columns:
</p>

<ol>
<li>
<p> 'ontology_id': Identifiers of the ontology elements.
</p>
</li>
<li>
<p> 'ontology_name': Names of the ontology elements.
</p>
</li>
<li>
<p> 'nr_common_with_tested_elements': Number of common elements between the
ontology element and the vector defined by the element_names parameter
of the <code>gsea</code> function.
</p>
</li>
<li>
<p> 'p_value': The raw <em>p</em>-value of the gene set enrichment analysis.
</p>
</li>
<li>
<p> 'adjusted_p_value': The adjusted <em>p</em>-value.
</p>
</li>
</ol>
<p>run_test method for ora object. Returns the results of the
overrepresentation analysis.
</p>


<h3>Methods (by class)</h3>


<ul><li> <p><code>run_test(ora)</code>: ora test.
</p>
</li></ul>
<h3>See Also</h3>

<p><code>gsea</code>, <code>ora</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(mulea)

# loading and filtering the example ontology from a GMT file
tf_gmt &lt;- read_gmt(file = system.file( package="mulea", "extdata", 
    "Transcription_factor_RegulonDB_Escherichia_coli_GeneSymbol.gmt"))
tf_gmt_filtered &lt;- filter_ontology(gmt = tf_gmt, min_nr_of_elements = 3, 
    max_nr_of_elements = 400)

# loading the example data
sign_genes &lt;- readLines(system.file(package = "mulea", "extdata", 
    "target_set.txt"))
background_genes &lt;- readLines(system.file(package="mulea", "extdata", "
    background_set.txt"))

# creating the ORA model
ora_model &lt;- ora(gmt = tf_gmt_filtered, 
    # the test set variable
    element_names = sign_genes, 
    # the background set variable
    background_element_names = background_genes, 
    # the p-value adjustment method
    p_value_adjustment_method = "eFDR", 
    # the number of permutations
    number_of_permutations = 10000,
    # the number of processor threads to use
    nthreads = 2)
# running the ORA
ora_results &lt;- run_test(ora_model)

library(mulea)

# loading and filtering the example ontology from a GMT file
tf_gmt &lt;- read_gmt(file = system.file(
        package="mulea", "extdata", 
        "Transcription_factor_RegulonDB_Escherichia_coli_GeneSymbol.gmt"))
tf_gmt_filtered &lt;- filter_ontology(gmt = tf_gmt, min_nr_of_elements = 3, 
        max_nr_of_elements = 400)

# loading the example data
sign_genes &lt;- readLines(system.file(package = "mulea", "extdata", 
        "target_set.txt"))
background_genes &lt;- readLines(system.file(package="mulea", "extdata", 
        "background_set.txt"))

# creating the ORA model
ora_model &lt;- ora(gmt = tf_gmt_filtered, 
        # the test set variable
        element_names = sign_genes, 
        # the background set variable
        background_element_names = background_genes, 
        # the p-value adjustment method
        p_value_adjustment_method = "eFDR", 
        # the number of permutations
        number_of_permutations = 10000,
        # the number of processor threads to use
        nthreads = 2)
# running the ORA
ora_results &lt;- run_test(ora_model)
</code></pre>


</div>