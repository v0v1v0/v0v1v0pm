<div class="container">

<table style="width: 100%;"><tr>
<td>gsea-class</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Gene Set Enrichment Analysis (GSEA)</h2>

<h3>Description</h3>

<p>An S4 class to represent the gsea tests in mulea.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'gsea'
run_test(model)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Object of S4 class representing the mulea test.</p>
</td>
</tr></table>
<h3>Value</h3>

<p>GSEA object. This object represents the result of the
<code>gsea</code> tests.
</p>
<p>run_test method for GSEA object. Returns results of
the enrichment analysis.
</p>


<h3>Methods (by generic)</h3>


<ul><li> <p><code>run_test(gsea)</code>: runs test calculations.
</p>
</li></ul>
<h3>Slots</h3>


<dl>
<dt><code>gmt</code></dt>
<dd>
<p>A <code>data.frame</code> representing the ontology GMT.</p>
</dd>
<dt><code>element_names</code></dt>
<dd>
<p>A vector of elements names
(gene or protein names or identifiers) to include in the analysis.</p>
</dd>
<dt><code>element_scores</code></dt>
<dd>
<p>A vector of numeric values representing a
score (<em>e.g.</em> <em>p</em>-value, <em>z</em>-score, log fold change) for each
'element_name', in the same number and order as element_name.</p>
</dd>
<dt><code>gsea_power</code></dt>
<dd>
<p>A power of weight. Default value is 1.</p>
</dd>
<dt><code>element_score_type</code></dt>
<dd>
<p>Defines the GSEA score type.
</p>

<ul>
<li>
<p> 'pos': Only positive element_scores
</p>
</li>
<li>
<p> 'neg': Only negative element_scores
</p>
</li>
<li>
<p> 'std': standard, containing both positive and negative scores
Default value is 'std'.
</p>
</li>
</ul>
</dd>
<dt><code>number_of_permutations</code></dt>
<dd>
<p>The number of permutations used in
<code>gsea</code> test. Default value is 1000.</p>
</dd>
<dt><code>test</code></dt>
<dd>
<p>character</p>
</dd>
</dl>
<h3>Examples</h3>

<pre><code class="language-R">library(mulea)

# loading and filtering the example ontology from a GMT file
tf_gmt &lt;- read_gmt(file = system.file(
    package="mulea", "extdata",
    "Transcription_factor_RegulonDB_Escherichia_coli_GeneSymbol.gmt"))
tf_gmt_filtered &lt;- filter_ontology(gmt = tf_gmt, min_nr_of_elements = 3, 
    max_nr_of_elements = 400)

# loading the example `data.frame`
scored_gene_tab &lt;- read.delim(file = system.file(package = "mulea", "extdata", 
        "ordered_set.tsv"))

# creating the GSEA model
gsea_model &lt;- gsea(gmt = tf_gmt_filtered,
        # the names of elements to test
        element_names = scored_gene_tab$Gene.symbol,
        # the logFC-s of elements to test
        element_scores = scored_gene_tab$logFC,
        # consider elements having positive logFC values only
        element_score_type = "pos",
        # the number of permutations
        number_of_permutations = 10000)
library(mulea)

# loading and filtering the example ontology from a GMT file
tf_gmt &lt;- read_gmt(file = system.file(package="mulea", "extdata", 
        "Transcription_factor_RegulonDB_Escherichia_coli_GeneSymbol.gmt"))
tf_gmt_filtered &lt;- filter_ontology(gmt = tf_gmt, min_nr_of_elements = 3, 
        max_nr_of_elements = 400)

# loading the example `data.frame`
scored_gene_tab &lt;- read.delim(file = system.file(package = "mulea", "extdata", 
        "ordered_set.tsv"))

# creating the GSEA model
gsea_model &lt;- gsea(gmt = tf_gmt_filtered,
        # the names of elements to test
        element_names = scored_gene_tab$Gene.symbol,
        # the logFC-s of elements to test
        element_scores = scored_gene_tab$logFC,
        # consider elements having positive logFC values only
        element_score_type = "pos",
        # the number of permutations
        number_of_permutations = 10000)

# running the test
gsea_results &lt;- run_test(gsea_model)
</code></pre>


</div>