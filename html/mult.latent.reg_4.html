<div class="container">

<table style="width: 100%;"><tr>
<td>mult.em_1level</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>EM algorithm for multivariate one level model with covariates</h2>

<h3>Description</h3>

<p>This function is used to obtain the Maximum Likelihood Estimates (MLE) using the EM algorithm for one-level multivariate data.
The estimates enable users to conduct clustering, ranking, and simultaneous dimension reduction on the multivariate dataset.
Furthermore, when covariates are included, the function supports the fitting of multivariate response models, expanding its utility for regression analysis.
The details of the model used in this function can be found in Zhang and Einbeck (2024).
</p>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data set object; we denote the dimension to be <code class="reqn">m</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>Covariate(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Number of mixture components, the default is <code>K = 2</code>. Note that when <code>K = 1</code>, <code>z</code> and <code>beta</code> will be 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>steps</code></td>
<td>
<p>Number of iterations, the default is <code>steps = 20</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>Containing parameters involved in the proposed model (<code>p</code>, <code>alpha</code>, <code>z</code>, <code>beta</code>, <code>sigma</code>, <code>gamma</code>) in a list,
the starting values can be obtained through the use of start_em. More details can be found in start_em.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>option</code></td>
<td>
<p>Four options for selecting the starting values for the parameters in the model. The default is option = 1.
More details can be found in start_em.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_fun</code></td>
<td>
<p>There are four types of variance specifications;
<code>var_fun = 1</code>, the same diagonal variance specification to all <code>K</code> components of the mixture;
<code>var_fun = 2</code>, different diagonal variance matrices for different components.
<code>var_fun = 3</code>, the same full (unrestricted) variance for all components.
<code>var_fun = 4</code>, different full (unrestricted) variance matrices for different components.
The default is <code>var_fun = 2</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The estimated parameters in the model <code class="reqn">x_{i} = \alpha + \beta z_k + \Gamma v_i + \varepsilon_i</code> obtained through the EM algorithm at the convergence.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>The estimates for the parameter <code class="reqn">\pi_k</code>, which is a vector of length <code class="reqn">K</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The estimates for the parameter <code class="reqn">\alpha</code>, which is a vector of length <code class="reqn">m</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>The estimates for the parameter <code class="reqn">z_k</code>, which is a vector of length <code class="reqn">K</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>The estimates for the parameter <code class="reqn">\beta</code>, which is a vector of length <code class="reqn">m</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>The estimates for the parameter <code class="reqn">\Gamma</code>, which is a matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>The estimates for the parameter <code class="reqn">\Sigma_k</code>.
When <code>var_fun = 1</code>, <code class="reqn">\Sigma_k</code> is a diagonal matrix and <code class="reqn">\Sigma_k = \Sigma</code>, and we obtain a vector of the diagonal elements;
When <code>var_fun = 2</code>, <code class="reqn">\Sigma_k</code> is a diagonal matrix, and we obtain <code>K</code> vectors of the diagonal elements;
When <code>var_fun = 3</code>, <code class="reqn">\Sigma_k</code> is a full variance-covariance matrix, <code class="reqn">\Sigma_k = \Sigma</code>, and we obtain a matrix <code class="reqn">\Sigma</code>;
When <code>var_fun = 4</code>, <code class="reqn">\Sigma_k</code> is a full variance-covariance matrix, and we obtain <code>K</code> different matrices <code class="reqn">\Sigma_k</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>The posterior probability matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglikelihood</code></td>
<td>
<p>The approximated log-likelihood of the fitted model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>disparity</code></td>
<td>
<p>The disparity (<code>-2logL</code>) of the fitted model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>number_parameters</code></td>
<td>
<p>The number of parameters estimated in the EM algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AIC</code></td>
<td>
<p>The AIC value (<code>-2logL + 2number_parameters</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BIC</code></td>
<td>
<p>The BIC value (<code>-2logL + number_parameters*log(n)</code>), where n is the number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>starting_values</code></td>
<td>
<p>A list of starting values for parameters used in the EM algorithm.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Zhang, Y. and Einbeck, J. (2024). A Versatile Model for Clustered and Highly Correlated Multivariate Data. J Stat Theory Pract 18(5).<a href="https://doi.org/10.1007/s42519-023-00357-0">doi:10.1007/s42519-023-00357-0</a>
</p>


<h3>See Also</h3>

<p><code>mult.reg_1level</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">##example for data without covariates.
data(faithful)
res &lt;- mult.em_1level(faithful,K=2,steps = 10,var_fun = 1)


## Graph showing the estimated one-dimensional space with cluster centers in red and alpha in green.
x &lt;- res$alpha[1]+res$beta[1]*res$z
y &lt;- res$alpha[2]+res$beta[2]*res$z
plot(faithful,col = 8)
points(x=x[1],y=y[1],type = "p",col = "red",pch = 17)
points(x=x[2],y=y[2],type = "p",col = "red",pch = 17)
points(x=res$alpha[1],y=res$alpha[2],type = "p",col = "darkgreen",pch = 4)
slope &lt;- (y[2]-y[1])/(x[2]-x[1])
intercept &lt;- y[1]-slope*x[1]
abline(intercept, slope, col="red")

##Graph showing the originaldata points being assigned to different
 ##clusters according to the Maximum a posterior (MAP) rule.
index &lt;- apply(res$W, 1, which.max)
faithful_grouped &lt;- cbind(faithful,index)
colors &lt;- c("#FDAE61", "#66BD63")
plot(faithful_grouped[,-3], pch = 1, col = colors[factor(index)])


##example for data with covariates.
data(fetal_covid_data)
set.seed(2)
covid_res &lt;- mult.em_1level(fetal_covid_data[,c(1:5)],v=fetal_covid_data$status_bi, K=3, steps = 20,
             var_fun = 2)
coeffs &lt;- covid_res$gamma
##compare with regression coefficients from fitting individual linear models.
summary(lm( UpperFaceMovements ~ status_bi,data=fetal_covid_data))$coefficients[2,1]
summary(lm( Headmovements ~ status_bi,data=fetal_covid_data))$coefficients[2,1]

</code></pre>


</div>