<div class="container">

<table style="width: 100%;"><tr>
<td>mult.reg_2level</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Selecting the best results for multivariate two level model</h2>

<h3>Description</h3>

<p>This wrapper function runs multiple times the function mult.em_2level for fitting Zhang et al.'s (2023) multivariate response models with two-level random effect,
and select the best results with the smallest AIC value.
</p>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data set object; we denote the dimension of a data set to be <code class="reqn">m</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>Covariate(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Number of mixture components, the default is <code>K = 2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>steps</code></td>
<td>
<p>Number of iterations within each <code>num_runs</code>, the default is <code>steps = 20</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_runs</code></td>
<td>
<p>Number of function iteration runs, the default is <code>num_runs = 20</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>Containing parameters involved in the proposed model (<code>p</code>, <code>alpha</code>, <code>z</code>, <code>beta</code>, <code>sigma</code>, <code>gamma</code>) in a list,
the starting values can be obtained through the use of start_em. More details can be found in start_em.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>option</code></td>
<td>
<p>Four options for selecting the starting values for the parameters in the model. The default is <code>option = 1</code>.
More details can be found in start_em.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_fun</code></td>
<td>
<p>There are two types of variance specifications; <code>var_fun = 1</code>, the same diagonal variance specification to all <code>K</code> components of the mixture;
<code>var_fun = 2</code>, different diagonal variance matrices for different components;
The default is <code>var_fun = 2</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The best estimated result (with the smallest AIC value) in the model <code class="reqn">x_{ij} = \alpha + \beta z_k + \Gamma v_{ij} + \varepsilon_{ij} </code> obtained through the EM algorithm (Zhang et al., 2023),
where the upper-level unit is indexed by <code class="reqn">i</code>, and the lower-level unit is indexed by <code class="reqn">j</code>.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>The estimates for the parameter <code class="reqn">\pi_k</code>, which is a vector of length <code class="reqn">K</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The estimates for the parameter <code class="reqn">\alpha</code>, which is a vector of length <code class="reqn">m</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>The estimates for the parameter <code class="reqn">z_k</code>, which is a vector of length <code class="reqn">K</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>The estimates for the parameter <code class="reqn">\beta</code>, which is a vector of length <code class="reqn">m</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>The estimates for the parameter <code class="reqn">\Gamma</code>, which is a matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>The estimates for the parameter <code class="reqn">\Sigma_k</code>.
When <code>var_fun = 1</code>, <code class="reqn">\Sigma_k</code> is a diagonal matrix and <code class="reqn">\Sigma_k = \Sigma</code>, and we obtain a vector of the diagonal elements;
When <code>var_fun = 2</code>, <code class="reqn">\Sigma_k</code> is a diagonal matrix, and we obtain <code>K</code> vectors of the diagonal elements.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>The posterior probability matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglikelihood</code></td>
<td>
<p>The approximated log-likelihood of the fitted model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>disparity</code></td>
<td>
<p>The disparity (<code>-2logL</code>) of the fitted model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>number_parameters</code></td>
<td>
<p>The number of parameters estimated in the EM algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AIC</code></td>
<td>
<p>The AIC value (<code>-2logL + 2number_parameters</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aic_data</code></td>
<td>
<p>All AIC values in each run.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Starting_values</code></td>
<td>
<p>Lists of starting values for parameters used in each <code>num_runs</code>.
It allows reproduction of the best result (obtained from mult.reg_2level) in a single run
using mult.em_2level by setting <code>start</code> equal to the list of starting values
that were used to obtain the best result in mult.reg_2level.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Zhang, Y., Einbeck, J. and Drikvandi, R. (2023). A multilevel multivariate response model for data with latent structures.
In: Proceedings of the 37th International Workshop on Statistical Modelling, pages 343-348.
Link on RG: <a href="https://www.researchgate.net/publication/375641972_A_multilevel_multivariate_response_model_for_data_with_latent_structures">https://www.researchgate.net/publication/375641972_A_multilevel_multivariate_response_model_for_data_with_latent_structures</a>
</p>


<h3>See Also</h3>

<p><code>mult.em_2level</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
##run the mult.em_2level() multiple times and select the best results with the smallest AIC value
set.seed(7)
results &lt;- mult.reg_2level(trading_data, K=4, steps = 10, num_runs = 5,
                           var_fun = 2, option = 1)
## Reproduce the best result: the best result is the 2nd run in the above example.
rep_best_result &lt;- mult.em_2level(trading_data, K=4, steps = 10,
var_fun = 2, option = 1,
start = results$Starting_values[[2]])

</code></pre>


</div>