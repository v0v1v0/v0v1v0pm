<div class="container">

<table style="width: 100%;"><tr>
<td>nomLORgee</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Marginal Models For Correlated Nominal Multinomial Responses</h2>

<h3>Description</h3>

<p>Solving the generalized estimating equations for correlated nominal
multinomial responses assuming a baseline category logit model for the
marginal probabilities.
</p>


<h3>Usage</h3>

<pre><code class="language-R">nomLORgee(formula = formula(data), data = parent.frame(), id = id,
  repeated = NULL, bstart = NULL, LORstr = "time.exch", LORem = "3way",
  LORterm = NULL, add = 0, homogeneous = TRUE,
  control = LORgee_control(), ipfp.ctrl = ipfp.control(), IM = "solve")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula expression as for other regression models for
multinomial responses. An intercept term must be included.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame containing the variables provided in
<code>formula</code>, <code>id</code> and <code>repeated</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>a vector that identifies the clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>repeated</code></td>
<td>
<p>an optional vector that identifies the order of observations
within each cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bstart</code></td>
<td>
<p>a vector that includes an initial estimate for the marginal
regression parameter vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LORstr</code></td>
<td>
<p>a character string that indicates the marginalized local odds
ratios structure. Options include <code>"independence"</code>, <code>"time.exch"</code>,
<code>"RC"</code> or <code>"fixed"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LORem</code></td>
<td>
<p>a character string that indicates if the marginalized local
odds ratios structure is estimated simultaneously (<code>"3way"</code>) or
independently at each level pair of <code>repeated</code> (<code>"2way"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LORterm</code></td>
<td>
<p>a matrix that satisfies the user-defined local odds ratios
structure. It is ignored unless <code>LORstr="fixed"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>a positive constant to be added at each cell of the full
marginalized contingency table in the presence of zero observed counts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>homogeneous</code></td>
<td>
<p>a logical that indicates homogeneous score parameters
when <code>LORstr="time.exch"</code> or <code>"RC"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a vector that specifies the control variables for the GEE
solver.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ipfp.ctrl</code></td>
<td>
<p>a vector that specifies the control variables for the
function <code>ipfp</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IM</code></td>
<td>
<p>a character string that indicates the method used for inverting a
matrix. Options include <code>"solve"</code>, <code>"qr.solve"</code> or
<code>"cholesky"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>data</code> must be provided in case level or equivalently in ‘long’
format. See details about the ‘long’ format in the function reshape.
</p>
<p>A term of the form <code>offset(expression)</code> is allowed in the right hand
side of <code>formula</code>.
</p>
<p>The default set for the response categories is <code class="reqn">\{1,\ldots,J\}</code>, where
<code class="reqn">J&gt;2</code> is the maximum observed response category. If otherwise, the
function recodes the observed response categories onto this set.
</p>
<p>The <code class="reqn">J</code>-th response category is treated as baseline.
</p>
<p>The default set for the <code>id</code> labels is <code class="reqn">\{1,\ldots,N\}</code>, where
<code class="reqn">N</code> is the sample size. If otherwise, the function recodes the given
labels onto this set.
</p>
<p>The argument <code>repeated</code> can be ignored only when <code>data</code> is written
in such a way that the <code class="reqn">t</code>-th observation in each cluster is recorded at
the <code class="reqn">t</code>-th measurement occasion. If this is not the case, then the user
must provide <code>repeated</code>. The suggested set for the levels of
<code>repeated</code> is <code class="reqn">\{1,\ldots,T\}</code>, where <code class="reqn">T</code> is the number of
observed levels. If otherwise, the function recodes the given levels onto
this set.
</p>
<p>The variables <code>id</code> and <code>repeated</code> do not need to be pre-sorted.
Instead the function reshapes <code>data</code> in an ascending order of <code>id</code>
and <code>repeated</code>.
</p>
<p>The fitted marginal baseline category logit model is </p>
<p style="text-align: center;"><code class="reqn">log
\frac{Pr(Y_{it}=j |x_{it})}{Pr(Y_{it}=J |x_{it})}=\beta_{j0} +\beta^{'}_j
x_{it}</code>
</p>
<p> where <code class="reqn">Y_{it}</code> is the <code class="reqn">t</code>-th multinomial response for
cluster <code class="reqn">i</code>, <code class="reqn">x_{it}</code> is the associated covariates vector,
<code class="reqn">\beta_{j0}</code> is the <code class="reqn">j</code>-th response category specific intercept and
<code class="reqn">\beta_{j}</code> is the <code class="reqn">j</code>-th response category specific parameter
vector.
</p>
<p>The formula is easier to read from either the Vignette or the Reference
Manual (both available
<a href="https://CRAN.R-project.org/package=multgee">here</a>).
</p>
<p>The <code>LORterm</code> argument must be an <code class="reqn">L</code> x <code class="reqn">J^2</code> matrix, where
<code class="reqn">L</code> is the number of level pairs of <code>repeated</code>. These are ordered
as <code class="reqn">(1,2), (1,3), ...,(1,T), (2,3),...,(T-1,T)</code> and the rows of
<code>LORterm</code> are supposed to preserve this order. Each row is assumed to
contain the vectorized form of a probability table that satisfies the
desired local odds ratios structure.
</p>


<h3>Value</h3>

<p>Returns an object of the class <code>"LORgee"</code>. This has components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>title for the GEE model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>version</code></td>
<td>
<p>the current version of the GEE solver.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>the marginal link function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>local.odds.ratios</code></td>
<td>
<p>the marginalized local odds ratios structure
variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms</code></td>
<td>
<p>the <code>terms</code> structure describing the marginal model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>the <code>contrasts</code> used for the factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nobs</code></td>
<td>
<p>the number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>the values of the convergence variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>the estimated regression parameter vector of the
marginal model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linear.pred</code></td>
<td>
<p>the estimated linear predictor of the
marginal regression model. The <code class="reqn">j</code>-th column corresponds to the
<code class="reqn">j</code>-th response category.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>the estimated fitted
values of the marginal regression model. The <code class="reqn">j</code>-th column corresponds
to the <code class="reqn">j</code>-th response category.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>the residuals of the marginal regression model based on the
binary responses. The <code class="reqn">j</code>-th column corresponds to the <code class="reqn">j</code>-th
response category.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the multinomial response variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>the <code>id</code> variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.id</code></td>
<td>
<p>the number of clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clusz</code></td>
<td>
<p>the number of observations within each cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust.variance</code></td>
<td>
<p>the estimated sandwich (robust) covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>naive.variance</code></td>
<td>
<p>the estimated model-based (naive) covariance
matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xnames</code></td>
<td>
<p>the regression coefficients' symbolic names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>categories</code></td>
<td>
<p>the number of observed response categories.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>occasions</code></td>
<td>
<p>the levels of the <code>repeated</code> variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LORgee_control</code></td>
<td>
<p>the control values for the GEE solver.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ipfp.control</code></td>
<td>
<p>the control values for the function <code>ipfp</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inverse.method</code></td>
<td>
<p>the method used for inverting matrices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adding.constant</code></td>
<td>
<p>the value used for <code>add</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalue</code></td>
<td>
<p>the p-value based on a Wald test that no covariates are
statistically significant.</p>
</td>
</tr>
</table>
<p>Generic coef, summary, print,
fitted and residuals methods are available. The <code>pvalue
of the Null model</code> corresponds to the hypothesis <code class="reqn">H_0:
\beta_1=...=\beta_{J-1}=0</code> based on the Wald test statistic.
</p>


<h3>Author(s)</h3>

<p>Anestis Touloumis
</p>


<h3>References</h3>

<p>Touloumis, A. (2011) <em>GEE for multinomial responses</em>. PhD
dissertation, University of Florida.
</p>
<p>Touloumis, A., Agresti, A. and Kateri, M. (2013) GEE for multinomial
responses using a local odds ratios parameterization. <em>Biometrics</em>
<b>69</b>, 633–640.
</p>
<p>Touloumis, A. (2015) R Package multgee: A Generalized Estimating Equations
Solver for Multinomial Responses. <em>Journal of Statistical Software</em>
<b>64</b>, 1–14.
</p>


<h3>See Also</h3>

<p>For an ordinal response scale use the function ordLORgee.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## See the interpretation in Touloumis (2011).
data(housing)
fitmod &lt;- nomLORgee(y ~ factor(time) * sec, data = housing, id = id,
                    repeated = time)
summary(fitmod)
</code></pre>


</div>