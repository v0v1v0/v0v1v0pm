<div class="container">

<table style="width: 100%;"><tr>
<td>matrixFDM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Finite Difference Matrix Generator
</h2>

<h3>Description</h3>

<p>Generates a modified coefficient matrix (<b>M</b>-matrix) used in the finite difference method from the option inputs. See Tavella and Randall (2000) for more on the standard formulation of the <b>M</b>-matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">matrixFDM(S, rf, q, vol, rho)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>

<p>list containing the vectors of spatial grid points associated with each underlying. Vector sizes of underlying spatial grid points need not be equal.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rf</code></td>
<td>

<p>scalar; applicable risk-free rate (domestic risk-free rate).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>

<p>vector; holding costs of the option's underlyings (dividends, foreign risk-free rates, etc.).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vol</code></td>
<td>

<p>vector; volatilities of the option's underlyings.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>

<p>matrix; correlation matrix of the option's underlyings.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>matrixFDM</code> first constructs the non-zero diagonals of the <b>M</b>-matrix and stores them as columns.  The <code>bandSparse</code> function from the <span class="pkg">Matrix</span> package then constructs a sparse banded matrix from the columns of the previously contructed matrix. Spatial domain boundaries are calculated first-order inwards with second difference terms dropped, maintaining block tridiagonality.
</p>


<h3>Value</h3>

<p><code>matrixFDM</code> returns a <code>CsparseMatrix</code>-class matrix used for timestepping in the finite difference method.
</p>


<h3>Author(s)</h3>

<p>Michael Eichenberger and Carlo Rosa
</p>


<h3>References</h3>

<p>Tavella, D., Randall, C., 2000. Pricing Financial Instruments: The Finite Difference Method. John Wiley &amp; Sons, Inc., New York.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># finite difference matrix for uniformly-spaced two-asset option
S1 &lt;- list(seq(0, 5, by=1), seq(0, 5, by=1))
rf &lt;- 0.1
q &lt;- c(0.05, 0.04)
vol &lt;- c(0.20, 0.25)
rho &lt;- matrix(c(1,-0.5,-0.5,1), 2, 2)
matrixFDM(S1, rf, q, vol, rho)
</code></pre>


</div>