<div class="container">

<table style="width: 100%;"><tr>
<td>power.multiCA.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Power calculations for the multinomial Cochran-Armitage trend test</h2>

<h3>Description</h3>

<p>Given the probabilities of outcomes, compute the power of the overall multinomial 
Cochran-Armitage trend test or determine the sample size to obtain a target power.
</p>


<h3>Usage</h3>

<pre><code class="language-R">power.multiCA.test(N = NULL, power = NULL, pmatrix = NULL, p.ave = NULL,
  p.start = NULL, p.end = NULL, slopes = NULL, scores = 1:G,
  n.prop = rep(1, G), G = length(p.ave), sig.level = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>integer, the total sample size of the study. If <code>NULL</code> then <code>power</code> needs to be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>target power. If <code>NULL</code> then <code>N</code> needs to be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pmatrix</code></td>
<td>
<p>numeric matrix of hypothesized outcome probabilities in each group,  with #' the outcomes as rows and ordered groups as columns. The columns should add up to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.ave</code></td>
<td>
<p>numeric vector of average probability of each outcome over the groups
weighted by <code>n.prop</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.start, p.end</code></td>
<td>
<p>numeric vectors of the probability of each outcome for the
first / last ordered group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slopes</code></td>
<td>
<p>numeric vector of the hypothesized slope of each outcome when regressed
against the column <code>scores</code> wiht weights <code>n.prop</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p>non-decreasing numeric vector of the same length as the number of ordered groups
giving the trend test scores. Defaults to linearly increasing values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.prop</code></td>
<td>
<p>numeric vector describing relative sample sizes of the ordered groups.
Will be normalized to sum to 1. Defaults to equal sample sizes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>integer, number of ordered groups</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig.level</code></td>
<td>
<p>significance level</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The distribution of the outcomes can be specified in two ways: either the full matrix of 
outcome probabilities <code>pmatrix</code> can be specified, or exactly two of the parameters 
<code>p.ave</code>, <code>slopes</code>, <code>p.start</code>, and <code>p.end</code> must be specified, while
</p>


<h3>Value</h3>

<p>object of class "power.htest"
</p>


<h3>Examples</h3>

<pre><code class="language-R">power.multiCA.test(power=0.8, p.start=c(0.1,0.2,0.3,0.4), p.end=c(0.4, 0.3, 0.2, 0.1), 
                     G=5, n.prop=c(3,2,1,2,3))

## Power of stroke study with 100 subjects per year and observed trends
data(stroke)
strk.mat &lt;- xtabs(Freq ~ Type + Year, data=stroke)
power.multiCA.test(N=900, pmatrix=prop.table(strk.mat, margin=2))
</code></pre>


</div>