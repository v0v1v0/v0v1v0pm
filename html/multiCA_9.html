<div class="container">

<table style="width: 100%;"><tr>
<td>multiCA.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multinomial Cochran-Armitage trend test</h2>

<h3>Description</h3>

<p>The <code>multiCA.test</code> function performs a multinomial generalization of the 
Cochran-Armitage trend test.
</p>


<h3>Usage</h3>

<pre><code class="language-R">multiCA.test(x, ...)

## Default S3 method:
multiCA.test(x, scores = 1:ncol(x), outcomes = 1:nrow(x),
  p.adjust.method = c("none", "closed.set", "Holm-Shaffer", "single-step",
  "Westfall"), ...)

## S3 method for class 'formula'
multiCA.test(formula, data, subset, na.action, weights, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a two-dimensional matrix of event counts with the outcomes as rows and ordered groups as columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p>non-decreaseing numeric vector of the same length as the number of ordered groups. Defaults to linearly increasing values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outcomes</code></td>
<td>
<p>integer or character vector defining the set of outcomes (by row index or row name) over which the trend should be tested. Defaults to all outcomes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.adjust.method</code></td>
<td>
<p>character string defining the correction method for individual outcome p-values. Defaults to "closed.set" when <code>length(outcomes)&lt;=3</code>, and "Holm-Shaffer" otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula of the form <code>outcome ~ group</code> where <code>outcome</code> is a factor representing the cateogrical outcome and <code>group</code> is the grouping variable over which the trend is tested.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional matrix or data frame containing the variables in the formula <code>formula</code>. By default the variables are taken from <code>environment(formula).</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen when the data contain NAs. Defaults to getOption("na.action").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>an integer-valued variable representing the number of times each <code>outcome</code> - <code>group</code> combination was observed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list with two components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>overall</code></td>
<td>
<p>an object of class "htest" with the results of the overall test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>individual</code></td>
<td>
<p>a vector with adjusted p-values for individual outcomes</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Aniko Szabo
</p>


<h3>References</h3>

<p>Szabo, A. (2016) Test for trend with a multinomial outcome.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(stroke)
## using formula interface
multiCA.test(Type ~ Year, weights=Freq, data=stroke)

##using Westfall's multiple testing adjustment
multiCA.test(Type ~ Year, weights=Freq, data=stroke, p.adjust.method="Westfall")

## using matrix interface and testing only the first 3 outcomes
strk.mat &lt;- xtabs(Freq ~ Type + Year, data=stroke)
multiCA.test(strk.mat, outcomes=1:3)

</code></pre>


</div>