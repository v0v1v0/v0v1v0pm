<div class="container">

<table style="width: 100%;"><tr>
<td>ph_test_statistic</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pointwise Hotelling's <code class="reqn">T^2</code>-test statistic</h2>

<h3>Description</h3>

<p>The function <code>ph_test_statistic()</code> calculates the pointwise Hotelling's <code class="reqn">T^2</code>-test statistic.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ph_test_statistic(x, gr_label, h)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>matrix of observations <code class="reqn">n\times j</code> (<code class="reqn">n = n_1 + ... + n_k</code>, <code class="reqn">j</code> is a number of design time points).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gr_label</code></td>
<td>
<p>a vector with group labels; the integer labels (from 1 to a number of groups) should be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>contrast matrix. For Dunnett’s and Tukey’s contrasts, it can be created by
the <code>contr_mat()</code> function from the package <code>GFDmcv</code> (see examples).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For details, see the documentation of the <code>multiFANOVA()</code> function or
the paper Munko et al. (2023).
</p>


<h3>Value</h3>

<p>A vector of values of the pointwise Hotelling's <code class="reqn">T^2</code>-test statistic.
</p>


<h3>References</h3>

<p>Dunnett C. (1955) A multiple comparison procedure for comparing several treatments
with a control. Journal of the American Statistical Association 50, 1096-1121.
</p>
<p>Munko M., Ditzhaus M., Pauly M., Smaga L., Zhang J.T. (2023) General multiple tests for functional data. Preprint https://arxiv.org/abs/2306.15259
</p>
<p>Tukey J.W. (1953) The problem of multiple comparisons. Princeton University.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Some of the examples may run some time.

# Canadian weather data set
# There are three samples of mean temperatures for
# fifteen weather stations in Eastern Canada,
# another fifteen in Western Canada, and
# the remaining five in Northern Canada.
library(fda)
data_set &lt;- t(CanadianWeather$dailyAv[,, "Temperature.C"])
k &lt;- 3
gr_label &lt;- rep(c(1, 2, 3), c(15, 15, 5))
# trajectories of mean temperatures
matplot(t(data_set), type = "l", col = gr_label, lty = 1,
        xlab = "Day", ylab = "Temperature (C)",
        main = "Canadian weather data set")
legend("bottom", legend = c("Eastern Canada", "Western Canada", "Northern Canada"),
       col = 1:3, lty = 1)

# Tukey's contrast matrix
h_tukey &lt;- GFDmcv::contr_mat(k, type = "Tukey")
# testing without parallel computing
res &lt;- multiFANOVA(data_set, gr_label, h_tukey)
summary(res, digits = 3)
# plots for pointwise Hotelling's T^2-test statistics
oldpar &lt;- par(mfrow = c(2, 2), mar = c(2, 2, 2, 0.1))
plot(ph_test_statistic(data_set, gr_label, h_tukey), type = "l",
     ylim = c(0, max(ph_test_statistic(data_set, gr_label, h_tukey))),
     main = "Global hypothesis")
plot(ph_test_statistic(data_set, gr_label, matrix(h_tukey[1, ], 1)), type = "l",
     ylim = c(0, max(ph_test_statistic(data_set, gr_label, h_tukey))),
     main = "Contrast 1")
plot(ph_test_statistic(data_set, gr_label, matrix(h_tukey[2, ], 1)), type = "l",
     ylim = c(0, max(ph_test_statistic(data_set, gr_label, h_tukey))),
     main = "Contrast 2")
plot(ph_test_statistic(data_set, gr_label, matrix(h_tukey[3, ], 1)), type = "l",
     ylim = c(0, max(ph_test_statistic(data_set, gr_label, h_tukey))),
     main = "Contrast 3")
par(oldpar)


</code></pre>


</div>