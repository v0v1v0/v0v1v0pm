<div class="container">

<table style="width: 100%;"><tr>
<td>sopls</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sequential and Orthogonalized PLS (SO-PLS)</h2>

<h3>Description</h3>

<p>Function for computing standard SO-PLS based on the interface of the <code>pls</code> package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sopls(
  formula,
  ncomp,
  max_comps = min(sum(ncomp), 20),
  data,
  subset,
  na.action,
  scale = FALSE,
  validation = c("none", "CV", "LOO"),
  sequential = FALSE,
  segments = 10,
  sel.comp = "opt",
  progress = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>Model formula accepting a single response (block) and predictor block names separated by + signs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncomp</code></td>
<td>
<p>Numeric vector of components per block or scalar of overall maximum components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_comps</code></td>
<td>
<p>Maximum total number of components from all blocks combined (&lt;= sum(ncomp)).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The data set to analyse.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>Expression for subsetting the data before modelling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>How to handle NAs (no action implemented).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>Logical indicating if variables should be scaled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>validation</code></td>
<td>
<p>Optional cross-validation strategy "CV" or "LOO".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sequential</code></td>
<td>
<p>Logical indicating if optimal components are chosen sequentially or globally (default=FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>segments</code></td>
<td>
<p>Optional number of segments or list of segments for cross-validation. (See <code>[pls::cvsegments()]</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sel.comp</code></td>
<td>
<p>Character indicating if sequential optimal number of components should be chosen as minimum RMSECV ('opt', default) or by Chi-square test ('chi').</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>
<p>Logical indicating if a progress bar should be displayed while cross-validating.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to underlying methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>SO-PLS is a method which handles two or more input blocks by sequentially performing
PLS on blocks against a response and orthogonalising the remaining blocks on the extracted components.
Component number optimisation can either be done globally (best combination across blocks) or sequentially
(determine for one block, move to next, etc.).
</p>


<h3>Value</h3>

<p>An <code>sopls, mvr</code> object with scores, loadings, etc.
associated with printing (<code>sopls_results</code>) and plotting methods (<code>sopls_plots</code>).
</p>


<h3>References</h3>

<p>Jørgensen K, Mevik BH, Næs T. Combining designed experiments with several blocks of spectroscopic data. Chemometr Intell Lab Syst. 2007;88(2): 154–166.
</p>


<h3>See Also</h3>

<p>SO-PLS result functions, <code>sopls_results</code>, SO-PLS plotting functions, <code>sopls_plots</code>, SO-PLS Måge plot, <code>maage</code>, and SO-PLS path-modelling, <code>SO_TDI</code>.
Overviews of available methods, <code>multiblock</code>, and methods organised by main structure: <code>basic</code>, <code>unsupervised</code>, <code>asca</code>, <code>supervised</code> and <code>complex</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(potato)
so &lt;- sopls(Sensory ~ Chemical + Compression, data=potato, ncomp=c(10,10), 
            max_comps=10, validation="CV", segments=10)
summary(so)

# Scatter plot matrix with two first components from Chemical block
# and 1 component from the Compression block.
scoreplot(so, comps=list(1:2,1), ncomp=2, block=2)

# Result functions and more plots for SO-PLS 
# are found in ?sopls_results and ?sopls_plots.
</code></pre>


</div>