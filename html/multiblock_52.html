<div class="container">

<table style="width: 100%;"><tr>
<td>sopls_plots</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Scores, loadings and plots for sopls objects</h2>

<h3>Description</h3>

<p>Extraction of <code>scores</code> and <code>loadings</code> and adaptation of <code>scoreplot</code>,
<code>loadingplot</code> and <code>biplot</code> from package <code>pls</code> for <code>sopls</code> objects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'sopls'
loadings(object, ncomp = "all", block = 1, y = FALSE, ...)

## S3 method for class 'sopls'
scores(object, ncomp = "all", block = 1, y = FALSE, ...)

## S3 method for class 'sopls'
scoreplot(
  object,
  comps = 1:2,
  ncomp = NULL,
  block = 1,
  labels,
  identify = FALSE,
  type = "p",
  xlab,
  ylab,
  ...
)

## S3 method for class 'sopls'
loadingplot(
  object,
  comps = 1:2,
  ncomp = NULL,
  block = 1,
  scatter = TRUE,
  labels,
  identify = FALSE,
  type,
  lty,
  lwd = NULL,
  pch,
  cex = NULL,
  col,
  legendpos,
  xlab,
  ylab,
  pretty.xlabels = TRUE,
  xlim,
  ...
)

## S3 method for class 'sopls'
corrplot(
  object,
  comps = 1:2,
  ncomp = NULL,
  block = 1,
  labels = TRUE,
  col = 1:5,
  plotx = TRUE,
  ploty = TRUE,
  ...
)

## S3 method for class 'sopls'
biplot(
  x,
  comps = 1:2,
  ncomp = "all",
  block = 1,
  which = c("x", "y", "scores", "loadings"),
  var.axes = FALSE,
  xlabs,
  ylabs,
  main,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p><code>sopls</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncomp</code></td>
<td>
<p><code>integer</code> vector giving components from all blocks before <code>block</code> (see next argument).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>block</code></td>
<td>
<p><code>integer</code> indicating which block to extract components from.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p><code>logical</code> extract Y loadings/scores instead of X loadings/scores (default = FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments sent to the underlying plot function(s)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comps</code></td>
<td>
<p><code>integer</code> vector giving components, within block, to plot (see Details regarding combination of blocks).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p><code>character</code> indicating if "names" or "numbers" should be plot symbols (optional).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>identify</code></td>
<td>
<p><code>logical</code> for activating <code>identify</code> to interactively identify points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p><code>character</code> for selecting type of plot to make. Defaults to "p" (points) for scatter plots and "l" (lines) for line plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p><code>character</code> text for x labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p><code>character</code> text for y labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scatter</code></td>
<td>
<p><code>logical</code> indicating if a scatterplot of loadings should be made (default = TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>
<p>Vector of line type specifications (see <code>par</code> for details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p><code>numeric</code> vector of line width specifications.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>Vector of point specifications (see <code>points</code> for details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p><code>numeric</code> vector of plot size expansions (see <code>par</code> for details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p><code>integer</code> vector of symbol/line colours (see <code>par</code> for details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legendpos</code></td>
<td>
<p><code>character</code> indicating legend position (if <code>scatter</code> is FALSE), e.g. <code>legendpos = "topright"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pretty.xlabels</code></td>
<td>
<p><code>logical</code> indicating if xlabels should be more nicely plotted (default = TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p><code>numeric</code> vector of length two, with the x limits of the plot (optional).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotx</code></td>
<td>
<p><code>locical</code> or <code>integer</code>/<code>character</code>.  Whether to plot the <code class="reqn">X</code> correlation loadings, optionally which block(s). Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ploty</code></td>
<td>
<p><code>logical</code>.  Whether to plot the <code class="reqn">Y</code> correlation loadings. Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p><code>sopls</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p><code>character</code> for selecting type of biplot ("x" = default, "y", "scores", "loadings").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.axes</code></td>
<td>
<p><code>logical</code> indicating if second axes of a biplot should have arrows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlabs</code></td>
<td>
<p><code>character</code> vector for labelling first set of biplot points (optional).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylabs</code></td>
<td>
<p><code>character</code> vector for labelling second set of biplot points (optional).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p><code>character</code> for setting the main title of a plot.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>comps</code> is supplied as a <code>list</code> for <code>scoreplot</code>, it is assumed that its elements refer to each of the
blocks up to block number <code>block</code>. For instance <code>comps = list(1, 0, 1:2)</code> will select 1 component from the first
block, no components from the second block and the first two components from the last block. This must be
matched by <code>ncomp</code>, specifying how many components were selected before block number <code>block</code>.
</p>


<h3>See Also</h3>

<p>Overviews of available methods, <code>multiblock</code>, and methods organised by main structure: <code>basic</code>, <code>unsupervised</code>, <code>asca</code>, <code>supervised</code> and <code>complex</code>.
Common functions for computation and extraction of results are found in <code>sopls_results</code>.
</p>
<p>#' @return The score and loading functions return scores and loadings, while plot functions have no return (except use of 'identify').
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(potato)
so &lt;- sopls(Sensory ~ Chemical + Compression + NIRraw, data=potato, ncomp=c(5,5,5))

# Loadings
loadings(so, ncomp=c(3), block=2)[, 1:3]

# Scores
scores(so, block=1)[, 1:4]

# Default plot from first block
scoreplot(so)

# Second block with names
scoreplot(so, ncomp=c(3), block=2, labels="names")

# Scatterplot matrix
scoreplot(so, ncomp=c(3,2), block=3, comps=1:3)

# Combination of blocks (see Details)
scoreplot(so, ncomp=c(3,2), block=3, comps=list(1,0,1))

# Default plot from first block
loadingplot(so, scatter=TRUE)

# Second block with names
loadingplot(so, ncomp=c(3), block=2, labels="names", scatter=TRUE)

# Scatterplot matrix
loadingplot(so, ncomp=c(3,2), block=3, comps=1:3, scatter=TRUE)

# Correlation loadings
corrplot(so, block=2, ncomp=1)

# Default plot from first block
biplot(so)
</code></pre>


</div>