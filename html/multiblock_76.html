<div class="container">

<table style="width: 100%;"><tr>
<td>sopls_results</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Result functions for SO-PLS models</h2>

<h3>Description</h3>

<p>Standard result functions for SO-PLS (<code>sopls</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'sopls'
predict(
  object,
  newdata,
  ncomp = object$ncomp,
  type = c("response", "scores"),
  na.action = na.pass,
  ...
)

## S3 method for class 'sopls'
coef(object, ncomp = object$ncomp, intercept = FALSE, ...)

## S3 method for class 'sopls'
print(x, ...)

## S3 method for class 'sopls'
summary(
  object,
  what = c("all", "validation", "training"),
  digits = 4,
  print.gap = 2,
  ...
)

classify(object, ...)

## S3 method for class 'sopls'
classify(object, classes, newdata, ncomp, LQ = "LDA", ...)

## S3 method for class 'sopls'
R2(object, estimate, newdata, ncomp = "all", individual = FALSE, ...)

## S3 method for class 'sopls'
RMSEP(object, estimate, newdata, ncomp = "all", individual = FALSE, ...)

pcp(object, ...)

## S3 method for class 'sopls'
pcp(object, ncomp, ...)

## Default S3 method:
pcp(object, X, ...)

cvanova(pred, ...)

## Default S3 method:
cvanova(pred, true, absRes = TRUE, ...)

## S3 method for class 'sopls'
cvanova(pred, comps, absRes = TRUE, ...)

## S3 method for class 'cvanova'
print(x, ...)

## S3 method for class 'cvanova'
summary(object, ...)

## S3 method for class 'cvanova'
plot(x, ...)

## S3 method for class 'sopls'
residuals(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A <code>sopls</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>Optional new data with the same types of predictor blocks as the ones used for fitting the object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncomp</code></td>
<td>
<p>An <code>integer</code> vector giving the exact components to apply.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A <code>character</code> for <code>predict</code> indicating if responses or scores should be predicted (default = "response", or "scores"), for <code>summary</code> indicating which type of explained variance to compute (default = "train", alternative = "CV").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>Function determining what to do with missing values in <code>newdata</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments. Currently not implemented.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>A <code>logical</code> indicating if coefficients for the intercept should be included (default = FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A <code>sopls</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>what</code></td>
<td>
<p>A <code>character</code> indicating if summary should include all, validation or training.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>The number of digits used for printing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.gap</code></td>
<td>
<p>Gap between columns when printing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>classes</code></td>
<td>
<p>A <code>character</code> vector of class labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LQ</code></td>
<td>
<p>A <code>character</code> indicating if 'max' (maximum score value), 'lda' or 'qda' should be used when classifying.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>A <code>character</code> indicating if 'train', 'CV' or 'test' results should be displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>individual</code></td>
<td>
<p>A <code>logical</code> indicating if results for individual responses should be displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A <code>list</code> of data blocks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred</code></td>
<td>
<p>An object holding the CV-predicted values (<code>sopls</code>, <code>matrix</code> or <code>list</code> of vectors)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>true</code></td>
<td>
<p>A <code>numeric</code> of true response values for CVANOVA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>absRes</code></td>
<td>
<p>A <code>logical</code> indicating if absolute (TRUE) or squared (FALSE) residuals should be computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comps</code></td>
<td>
<p>An <code>integer</code> vector giving the exact components to apply.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The parameter <code>ncomp</code> controls
which components to apply/extract, resulting in the sequence of components leading up to the specific choice, i.e.
<code>ncomp = c(2,2,1)</code> results in the sequence 1,0,0; 2,0,0; 2,1,0; 2,2,0; 2,2,1.
Usage of the functions are shown using generics in the examples below.
Prediction, regression coefficients, object printing and summary are available through:
<code>predict.sopls</code>, <code>coef.sopls</code>, <code>print.sopls</code> and <code>summary.sopls</code>.
Explained variances and RMSEP are available through <code>R2.sopls</code> and <code>RMSEP.sopls</code>.
Principal components of predictions are available through <code>pcp.sopls</code>. Finally, there is work in progress on classifcation
support through <code>classify.sopls</code>.
</p>


<h3>Value</h3>

<p>Returns depend on method used, e.g. <code>predict.sopls</code> returns predicted responses
or scores depending on inputs, <code>coef.sopls</code> return regression coefficients, while print and summary methods return the object invisibly.
</p>


<h3>References</h3>

<p>Jørgensen K, Mevik BH, Næs T. Combining designed experiments with several blocks of spectroscopic data. Chemometr Intell Lab Syst. 2007;88(2): 154–166.
</p>


<h3>See Also</h3>

<p>Overviews of available methods, <code>multiblock</code>, and methods organised by main structure: <code>basic</code>, <code>unsupervised</code>, <code>asca</code>, <code>supervised</code> and <code>complex</code>.
Common functions for plotting are found in <code>sopls_plots</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(potato)
mod &lt;- sopls(Sensory[,1] ~ ., data = potato[c(1:3,9)], ncomp = 5, subset = 1:20)
testset &lt;- potato[-(1:20),]; testset$Sensory &lt;- testset$Sensory[,1,drop=FALSE]
predict(mod, testset, ncomp=c(2,1,2))
dim(coef(mod, ncomp=c(3,0,1))) # &lt;variables x responses x components&gt;
R2(mod, ncomp = c(4,1,2))
print(mod)
summary(mod)

# PCP from sopls object
modMulti &lt;- sopls(Sensory ~ ., data = potato[c(1:3,9)], ncomp = 5, validation = "CV", segment = 5)
(PCP &lt;- pcp(modMulti, c(2,1,2)))
scoreplot(PCP)

# PCP from matrices
preds &lt;- modMulti$validation$Ypred[,,"2,1,2"]
PCP_default &lt;- pcp(preds, potato[1:3])

# CVANOVA
modCV &lt;- sopls(Sensory[,1] ~ ., data = potato[c(1:3,9)], ncomp = 5, validation = "CV", segment = 5)
summary(cva &lt;- cvanova(modCV, "2,1,2"))
plot(cva)

</code></pre>


</div>