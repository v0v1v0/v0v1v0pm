<div class="container">

<table style="width: 100%;"><tr>
<td>SO_TDI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Total, direct, indirect and additional effects in SO-PLS-PM.</h2>

<h3>Description</h3>

<p>SO-PLS-PM is the use of SO-PLS for path-modelling. This particular function
is used to compute effects (explained variances) in sub-paths of the directed acyclic graph.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sopls_pm(
  X,
  Y,
  ncomp,
  max_comps = min(sum(ncomp), 20),
  sel.comp = "opt",
  computeAdditional = FALSE,
  sequential = FALSE,
  B = NULL,
  k = 10,
  type = "consecutive",
  simultaneous = TRUE
)

## S3 method for class 'SO_TDI'
print(x, showComp = TRUE, heading = "SO-PLS path effects", digits = 2, ...)

sopls_pm_multiple(
  X,
  ncomp,
  max_comps = min(sum(ncomp), 20),
  sel.comp = "opt",
  computeAdditional = FALSE,
  sequential = FALSE,
  B = NULL,
  k = 10,
  type = "consecutive"
)

## S3 method for class 'SO_TDI_multiple'
print(x, heading = "SO-PLS path effects", digits = 2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A <code>list</code> of input blocks (of type <code>matrix</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>A <code>matrix</code> of response(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncomp</code></td>
<td>
<p>An <code>integer</code> vector giving the number of components per block or a single integer for common number of components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_comps</code></td>
<td>
<p>Maximum total number of components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sel.comp</code></td>
<td>
<p>A <code>character</code> or <code>integer</code> vector indicating the type ("opt" - minimum error / "chi" - chi-squared reduced) or exact number of components in selections.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>computeAdditional</code></td>
<td>
<p>A <code>logical</code> indicating if additional components should be computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sequential</code></td>
<td>
<p>A <code>logical</code> indicating if sequential component optimization should be applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>An <code>integer</code> giving the number of bootstrap replicates for variation estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>An <code>integer</code> indicating number of cross-validation segments (default = 10).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A <code>character</code> for selecting type of cross-validation segments (default = "consecutive").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simultaneous</code></td>
<td>
<p><code>logical</code> indicating if simultaneous orthogonalisation on intermediate blocks should be performed (default = TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of type <code>SO_TDI</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showComp</code></td>
<td>
<p>A <code>logical</code> indicating if components should be shown in print (default = TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>heading</code></td>
<td>
<p>A <code>character</code> giving the heading of the print.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>An <code>integer</code> for selecting number of digits in print.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Not implemented</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>sopls_pm</code> computes 'total', 'direct', 'indirect' and 'additional' effects for the 'first' versus the
'last' input block by cross-validated explained variances. 'total' is the explained variance when doing
regression of 'first' -&gt; 'last'. 'indirect' is the the same, but controlled for the intermediate blocks.
'direct' is the left-over part of the 'total' explained variance when subtracting the 'indirect'. Finally,
'additional' is the added explained variance of 'last' for each block following 'first'.
</p>
<p><code>sopls_pm_multiple</code> is a wrapper for <code>sopls_pm</code> that repeats the calculation for all pairs of blocks
from 'first' to 'last'. Where <code>sopls_pm</code> has a separate response, Y, signifying the 'last' block,
<code>sopls_pm_multiple</code> has multiple 'last' blocks, depending on sub-path, thus collects the response(s)
from the list of blocks X.
</p>
<p>When sel.comp = "opt", the number of components for all models are optimized using cross-validation
within the ncomp and max_comps supplied. If sel.comp is "chi", an optimization is also performed,
but parsimonious solutions are sought through a chi-square chriterion. When setting sel.comp to a
numeric vector, exact selection of number of components is performed.
</p>
<p>When setting B to a number, e.g. 200, the procedures above are repeated B times using bootstrapping
to estimate standard deviations of the cross-validated explained variances.
</p>


<h3>Value</h3>

<p>An object of type <code>SO_TDI</code> containing total, direct and indirect effects, plus
possibly additional effects and standard deviations (estimated by bootstrapping).
</p>


<h3>References</h3>


<ul>
<li>
<p> Menichelli, E., Almøy, T., Tomic, O., Olsen, N. V., &amp; Næs, T. (2014). SO-PLS as an exploratory tool for path modelling. Food quality and preference, 36, 122-134.
</p>
</li>
<li>
<p> Næs, T., Romano, R., Tomic, O., Måge, I., Smilde, A., &amp; Liland, K. H. (2020). Sequential and orthogonalized PLS (SO-PLS) regression for path analysis: Order of blocks and relations between effects. Journal of Chemometrics, e3243.
</p>
</li>
</ul>
<h3>See Also</h3>

<p>Overviews of available methods, <code>multiblock</code>, and methods organised by main structure: <code>basic</code>, <code>unsupervised</code>, <code>asca</code>, <code>supervised</code> and <code>complex</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Single path for the potato data:
data(potato)
pot.pm &lt;- sopls_pm(potato[1:3], potato[['Sensory']], c(5,5,5), computeAdditional=TRUE)
pot.pm

# Corresponding SO-PLS model:
# so &lt;- sopls(Sensory ~ ., data=potato[c(1,2,3,9)], ncomp=c(5,5,5), validation="CV", segments=10)
# maageSeq(pot.so, compSeq = c(3,2,4))

# All path in the forward direction for the wine data:
data(wine)
pot.pm.multiple &lt;- sopls_pm_multiple(wine, ncomp = c(4,2,9,8))
pot.pm.multiple
</code></pre>


</div>