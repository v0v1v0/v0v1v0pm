<div class="container">

<table style="width: 100%;"><tr>
<td>binom_tsampling</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Samples From Truncated Beta Densities</h2>

<h3>Description</h3>

<p>Based on specified inequality constraints, samples from truncated
prior or posterior beta densities.
</p>


<h3>Usage</h3>

<pre><code class="language-R">binom_tsampling(
  inequalities,
  index = 1,
  niter = 10000,
  prior = FALSE,
  nburnin = niter * 0.05,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>inequalities</code></td>
<td>
<p>list that contains inequality constraints for each independent inequality constrained hypotheses. The list
is created in the <code>generate_restriction_list</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p>numeric. If multiple independent inequality constraints are specified, this index determines for which
inequality constraint samples should be drawn. Must be a single value. Default is 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter</code></td>
<td>
<p>numeric. A single value specifying the number of samples. Default is set to <code class="reqn">10,000</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>logical. If <code>TRUE</code> ignores the data that are encoded in <code>inequalities</code> and thus samples from the
prior distribution. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nburnin</code></td>
<td>
<p>numeric. A single value specifying the number of burn-in samples when drawing from the truncated distribution.
Minimum number of burn-in samples is 10. Default is 5% of the number of samples. Burn-in samples are removed automatically after the sampling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>numeric. Sets the seed for reproducible pseudo-random number generation</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The model assumes that the data in <code>x</code> (i.e., <code class="reqn">x_1, ..., x_K</code>) are the observations of <code class="reqn">K</code> independent
binomial experiments, based on <code class="reqn">n_1, ..., n_K</code> observations. Hence, the underlying likelihood is the product of the
<code class="reqn">k = 1, ..., K</code> individual binomial functions:
</p>
<p style="text-align: center;"><code class="reqn">(x_1, ... x_K) ~ \prod Binomial(N_k, \theta_k)</code>
</p>

<p>Furthermore, the model assigns a beta distribution as prior to each model parameter
(i.e., underlying binomial proportions). That is:
</p>
<p style="text-align: center;"><code class="reqn">\theta_k ~ Beta(\alpha_k, \beta_k)</code>
</p>



<h3>Value</h3>

<p>matrix of dimension <code>niter * nsamples</code> containing samples from truncated beta distributions.
</p>


<h3>Note</h3>

<p>When equality constraints are specified in the restricted hypothesis, this function samples from the conditional
Beta distributions given that the equality constraints hold.
</p>
<p>Only inequality constrained parameters are sampled. Free parameters or parameters that are
exclusively equality constrained will be ignored.
</p>


<h3>References</h3>

<p>Damien P, Walker SG (2001).
“Sampling truncated normal, beta, and gamma densities.”
<em>Journal of Computational and Graphical Statistics</em>, <b>10</b>, 206–215.
</p>


<h3>See Also</h3>

<p><code>generate_restriction_list</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- c(200, 130, 40, 10)
n &lt;- c(200, 200, 200, 200)
a &lt;- c(1, 1, 1, 1)
b &lt;- c(1, 1, 1, 1)
factor_levels &lt;- c('binom1', 'binom2', 'binom3', 'binom4')
Hr &lt;- c('binom1 &gt; binom2 &gt; binom3 &gt; binom4')

# generate restriction list
inequalities &lt;- generate_restriction_list(x=x, n=n, Hr=Hr, a=a, b=b, 
factor_levels=factor_levels)$inequality_constraints

# sample from prior distribution
prior_samples &lt;- binom_tsampling(inequalities, niter = 500, 
prior=TRUE)
# sample from posterior distribution
post_samples &lt;- binom_tsampling(inequalities, niter = 500)
</code></pre>


</div>