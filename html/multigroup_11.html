<div class="container">

<table style="width: 100%;"><tr>
<td>mgPCA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multigroup Principal Component Analysis</h2>

<h3>Description</h3>

<p>Multigroup PCA algorithm (NIPALS for Multigroup PCA)
</p>


<h3>Usage</h3>

<pre><code class="language-R">mgPCA(Data, Group, ncomp = NULL, Scale = FALSE, graph = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Data</code></td>
<td>
<p>a numeric matrix or data frame</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Group</code></td>
<td>
<p>a vector of factors associated with group structure</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncomp</code></td>
<td>
<p>number of components, if NULL number of components is equal to 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Scale</code></td>
<td>
<p>scaling variables, by defalt is FALSE. By default data are centered within groups</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>graph</code></td>
<td>
<p>should loading and component be plotted</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>list with the following results:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Data</code></td>
<td>
<p>     Original data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Con.Data</code></td>
<td>
<p>     Concatenated centered data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>split.Data</code></td>
<td>
<p>     Group centered data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Group</code></td>
<td>
<p>      Group as a factor vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loadings.group</code></td>
<td>
<p>     Loadings associated with each group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>score.group</code></td>
<td>
<p>      Scores associated with each group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loadings.common</code></td>
<td>
<p>      Matrix of common loadings</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>score.Global</code></td>
<td>
<p>     Global scores</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cumper.inertigroup</code></td>
<td>
<p>     Cumulative percentage of group components inertia</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cumper.inertiglobal</code></td>
<td>
<p>      Cumulative percentage of global component inertia</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noncumper.inertiglobal</code></td>
<td>
<p>     Percentage of global component inertia</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>     The specific variances of groups</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exp.var</code></td>
<td>
<p>      Percentages of total variance recovered associated with each dimension </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Similarity.Common.Group.load</code></td>
<td>
<p>Cumulative similarity between group and common loadings</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Similarity.noncum.Common.Group.load</code></td>
<td>
<p> NonCumulative  similarity between group and common loadings</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>A. Eslami, E. M. Qannari, A. Kohler and S. Bougeard (2013). General overview
of methods of analysis of multi-group datasets,
<em>Revue des Nouvelles Technologies de l'Information</em>, 25, 108-123.
</p>
<p>A. Eslami, E. M. Qannari, A. Kohler and S. Bougeard (2013). Analyses
factorielles de donnces structurces en groupes d'individus,
<em>Journal de la Societe Francaise de Statistique</em>, 154(3), 44-57.
</p>


<h3>See Also</h3>

<p><code>BGC</code>, <code>FCPCA</code>, <code>DCCSWA</code>, <code>DSTATIS</code>, <code>DGPA</code>, <code>summarize</code>, <code>TBWvariance</code>, <code>loadingsplot</code>, <code>scoreplot</code>, <code>iris</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">Data = iris[,-5]
Group = iris[,5]
res.mgPCA = mgPCA (Data, Group)
barplot(res.mgPCA$noncumper.inertiglobal)
#----------------
#Similarity index: group loadings are compared to the common structure (first dimension)
Xzero = rep(0, 3)
MIN = min(res.mgPCA$Similarity.noncum.Common.Group.load[[1]][-1, 1])-0.0005
XLAB = paste("Dim1, %",res.mgPCA$noncumper.inertiglobal[1])
plot(Xzero, res.mgPCA$Similarity.noncum.Common.Group.load[[1]][-1, 1], pch=15, ylim=c(MIN, 1), 
main="Similarity between groups and common structure", xlab=XLAB, ylab="", xaxt="n")
abline(v=0)
abline(h=seq(MIN, 1, by=0.05), col="black", lty=3)
XX=res.mgPCA$Similarity.noncum.Common.Group.load[[1]][-1, 1, drop=FALSE]
text(Xzero, XX, labels=rownames(XX), pos=4)
#----------------
# Similarity index: group loadings are compared to the common structure (dimensions 1 and 2)
XX1=res.mgPCA$Similarity.noncum.Common.Group.load[[1]][-1, 1]
XX2=res.mgPCA$Similarity.noncum.Common.Group.load[[2]][-1, 1]
simil &lt;- cbind(XX1, XX2)
YLAB = paste("Dim1, %",res.mgPCA$noncumper.inertiglobal[2])
plot(simil, xlab=XLAB, ylab=YLAB, main="Similarity between groups and common structure", pch=20)
text(simil, labels=rownames(simil), cex=1, font.lab=1, pos=3)
#------------------
loadingsplot(res.mgPCA, axes=c(1,2), INERTIE=res.mgPCA$noncumper.inertiglobal)
scoreplot(res.mgPCA, axes=c(1,2))
</code></pre>


</div>