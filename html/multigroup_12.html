<div class="container">

<table style="width: 100%;"><tr>
<td>mgPLS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multigroup Partial Least Squares Regression</h2>

<h3>Description</h3>

<p>Multigroup PLS regression
</p>


<h3>Usage</h3>

<pre><code class="language-R">mgPLS(
  DataX,
  DataY,
  Group,
  ncomp = NULL,
  Scale = FALSE,
  Gcenter = FALSE,
  Gscale = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>DataX</code></td>
<td>
<p>a numeric matrix or data frame associated with independent dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DataY</code></td>
<td>
<p>a numeric matrix or data frame associated with dependent dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Group</code></td>
<td>
<p>a vector of factors associated with group structure</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncomp</code></td>
<td>
<p>number of components, if NULL number of components is equal to 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Scale</code></td>
<td>
<p>scaling variables, by defalt is FALSE. By default data are centered within groups</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gcenter</code></td>
<td>
<p>global variables centering, by defalt is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gscale</code></td>
<td>
<p>global variables scaling, by defalt is FALSE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>list with the following results:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>DataXm</code></td>
<td>
<p>Group X  data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DataYm</code></td>
<td>
<p>Group Y  data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Concat.X</code></td>
<td>
<p>Concatenated X data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Concat.Y</code></td>
<td>
<p>Concatenated Y data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>Coefficients associated with  X data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients.Y</code></td>
<td>
<p>Coefficients associated with regressing  Y on Global components X</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Components.Global</code></td>
<td>
<p>Conctenated Components for X and Y</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Components.Group</code></td>
<td>
<p>Components associated with groups in X and Y</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loadings.common</code></td>
<td>
<p>Common vector of loadings for X and Y</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loadings.Group</code></td>
<td>
<p>Group vector of loadings for X and Y</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expvar</code></td>
<td>
<p>Explained variance associated with global components X</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cum.expvar.Group</code></td>
<td>
<p>Cumulative explained varaince in groups of X and Y</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Similarity.Common.Group.load</code></td>
<td>
<p>Cumulative similarity between group and common loadings</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Similarity.noncum.Common.Group.load</code></td>
<td>
<p> NonCumulative  similarity between group and common loadings</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>A. Eslami, E. M. Qannari, A. Kohler and S. Bougeard (2013). Multi-group PLS
regressMathematics and Statistics, Springer Proceedings (ed), <em>New Perspectives
in Partial Least Squares and Related Methods</em>, 56, 243-255.
</p>
<p>A. Eslami, E. M. Qannari, A. Kohler and S. Bougeard (2014). Algorithms
for multi-group PLS. <em>Journal of Chemometrics</em>, 28(3), 192-201.
</p>


<h3>See Also</h3>

<p><code>mgPCA</code>, <code>mbmgPCA</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(oliveoil)
DataX = oliveoil[,2:6]
DataY = oliveoil[,7:12]
Group = as.factor(oliveoil[,1])
res.mgPLS = mgPLS (DataX, DataY, Group)
barplot(res.mgPLS$noncumper.inertiglobal)
#----- Regression coefficients 
#res.mgPLS$coefficients[[2]]
#----- Similarity index: group loadings are compared to the common structure (in  X and Y spaces)
XX1= res.mgPLS$Similarity.noncum.Common.Group.load$X[[1]][-1, 1, drop=FALSE]
XX2=res.mgPLS$Similarity.noncum.Common.Group.load$X[[2]][-1, 1, drop=FALSE]
simX &lt;- cbind(XX1, XX2)
YY1=res.mgPLS$Similarity.noncum.Common.Group.load$Y[[1]][-1, 1, drop=FALSE]
YY2=res.mgPLS$Similarity.noncum.Common.Group.load$Y[[2]][-1, 1, drop=FALSE]
simY &lt;- cbind(YY1,YY2)
XLAB = paste("Dim1, %",res.mgPLS$noncumper.inertiglobal[1])
YLAB = paste("Dim1, %",res.mgPLS$noncumper.inertiglobal[2])
plot(simX[, 1], simX[, 2], pch=15, xlim=c(0, 1), ylim=c(0, 1),
                            main="Similarity indices in X space",
                            xlab=XLAB, ylab=YLAB)
abline(h=seq(0, 1, by=0.2), col="black", lty=3)
text(simX[, 1], simX[, 2], labels=rownames(simX), pos=2)
plot(simY[, 1], simY[, 2], pch=15, xlim=c(0, 1), ylim=c(0, 1), 
                             main="Similarity indices in Y space",
                                       xlab=XLAB, ylab=YLAB)
abline(h=seq(0, 1, by=0.2), col="black", lty=3)
text(simY[, 1], simY[, 2], labels=rownames(simY), pos=2)
</code></pre>


</div>