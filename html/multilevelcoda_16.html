<div class="container">

<table style="width: 100%;"><tr>
<td>fitted.brmcoda</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Expected Values of the Posterior Predictive Distribution</h2>

<h3>Description</h3>

<p>Compute posterior draws of the expected value of the posterior predictive
distribution of a <code>brmsfit</code> model in the <code>brmcoda</code> object.
Can be performed for the data used to fit the model (posterior
predictive checks) or for new data. By definition, these predictions have
smaller variance than the posterior predictions performed by the
<code>predict.brmcoda</code> method. This is because only the
uncertainty in the expected value of the posterior predictive distribution is
incorporated in the draws computed by <code>fitted</code> while the
residual error is ignored there. However, the estimated means of both methods
averaged across draws should be very similar.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'brmcoda'
fitted(object, scale = c("linear", "response"), summary = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class <code>brmcoda</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>Specifically for models with compositional responses,
either <code>"response"</code> or <code>"linear"</code>.
If <code>"linear"</code>,
results are returned on the log-ratio scale.
If <code>"response"</code>, results are returned on the compositional scale
of the response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summary</code></td>
<td>
<p>Should summary statistics be returned
instead of the raw values? Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to <code>fitted.brmsfit</code>
that control additional aspects of prediction.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An <code>array</code> of predicted <em>mean</em> response values.
If <code>summary = FALSE</code> the output resembles those of
<code>posterior_epred.brmsfit</code>.
</p>
<p>If <code>summary = TRUE</code> the output depends on the family: For categorical
and ordinal families, the output is an N x E x C array, where N is the
number of observations, E is the number of summary statistics, and C is the
number of categories. For all other families, the output is an N x E
matrix. The number of summary statistics E is equal to <code>2 +
  length(probs)</code>: The <code>Estimate</code> column contains point estimates (either
mean or median depending on argument <code>robust</code>), while the
<code>Est.Error</code> column contains uncertainty estimates (either standard
deviation or median absolute deviation depending on argument
<code>robust</code>). The remaining columns starting with <code>Q</code> contain
quantile estimates as specified via argument <code>probs</code>.
</p>
<p>In multivariate models, an additional dimension is added to the output
which indexes along the different response variables.
</p>


<h3>See Also</h3>

<p><code>fitted.brmsfit</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## fit a model
if(requireNamespace("cmdstanr")){
  ## compute composition and ilr coordinates
  cilr &lt;- complr(data = mcompd, sbp = sbp,
                 parts = c("TST", "WAKE", "MVPA", "LPA", "SB"),
                 idvar = "ID", total = 1440)
  
  ## fit a model
  m1 &lt;- brmcoda(complr = cilr,
                formula = Stress ~ bilr1 + bilr2 + bilr3 + bilr4 +
                  wilr1 + wilr2 + wilr3 + wilr4 + (1 | ID),
                chain = 1, iter = 500,
                backend = "cmdstanr")
  
  ## compute expected predictions
  epred &lt;- fitted(m1)
  head(epred)
  
  ## fit a model with compositional outcome
  m2 &lt;- brmcoda(complr = cilr,
                formula = mvbind(ilr1, ilr2, ilr3, ilr4) ~ Stress + Female + (1 | ID),
                chain = 1, iter = 500,
                backend = "cmdstanr")
  
  ## expected predictions on compositional scale
  epredcomp &lt;- fitted(m2, scale = "response")
  head(epredcomp)
}
</code></pre>


</div>