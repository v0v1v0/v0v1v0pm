<div class="container">

<table style="width: 100%;"><tr>
<td>substitution</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multilevel Compositional Substitution Analysis</h2>

<h3>Description</h3>

<p>Estimate the difference in an outcome
when compositional parts are substituted for specific unit(s).
The <code>substitution</code> output encapsulates
the substitution results for all compositional parts
present in the <code>brmcoda</code> object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">substitution(
  object,
  delta,
  basesub = NULL,
  summary = TRUE,
  ref = c("grandmean", "clustermean"),
  level = c("between", "within", "aggregate"),
  weight = c("equal", "proportional"),
  scale = c("response", "linear"),
  cores = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A fitted <code>brmcoda</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>A integer, numeric value or vector indicating the amount of substituted change between compositional parts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basesub</code></td>
<td>
<p>A <code>data.frame</code> or <code>data.table</code> of the base possible substitution of compositional parts.
This data set can be computed using function <code>basesub</code>.
If <code>NULL</code>, all possible pairwise substitution of compositional parts are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summary</code></td>
<td>
<p>A logical value.
Should the estimate at each level of the reference grid (<code>FALSE</code>)
or their average (<code>TRUE</code>) be returned?
Default is <code>TRUE</code>.
Only applicable for model with covariates in addition to
the isometric log-ratio coordinates (i.e., adjusted model).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref</code></td>
<td>
<p>Either a character value or vector or a dataset.
Can be <code>"grandmean"</code> and/or <code>"clustermean"</code>, or
a <code>data.frame</code> or <code>data.table</code> of user's specified reference grid consisting
of combinations of covariates over which predictions are made.
User's specified reference grid is only possible for simple substitution.
Single level models are default to <code>"grandmean"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>A character string or vector.
Should the estimate of multilevel models focus on the <code>"between"</code> and/or <code>"within"</code> or <code>"aggregate"</code> variance?
Single-level models are default to <code>"aggregate"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>A character value specifying the weight to use in calculation of the reference composition.
If <code>"equal"</code>, give equal weight to units (e.g., individuals).
If <code>"proportional"</code>, weights in proportion to the frequencies of units being averaged
(e.g., observations across individuals).
Default to <code>"equal"</code> for <code>ref = "grandmean"</code> and <code>"proportional"</code> for <code>ref = "clustermean"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>Either <code>"response"</code> or <code>"linear"</code>.
If <code>"response"</code>, results are returned on the scale of the response variable.
If <code>"linear"</code>, results are returned on the scale of the linear predictor term,
that is without applying the inverse link function or other transformations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cores</code></td>
<td>
<p>Number of cores to use when executing the chains in parallel,
we recommend setting the <code>mc.cores</code> option
to be as many processors as the hardware and RAM allow (up to the number of compositional parts).
For non-Windows OS in non-interactive R sessions, forking is used instead of PSOCK clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>currently ignored.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the results of multilevel compositional substitution model.
The first six lists contain the results of the substitution estimation for a compositional part.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Mean</code></td>
<td>
<p> Posterior means.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>CI_low</code> and <code>CI_high</code>
</td>
<td>
<p> 95% credible intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Delta</code></td>
<td>
<p> Amount substituted across compositional parts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>From</code></td>
<td>
<p> Compositional part that is substituted from.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>To</code></td>
<td>
<p> Compositional parts that is substituted to.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Level</code></td>
<td>
<p> Level where changes in composition takes place.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Reference</code></td>
<td>
<p> Either <code>grandmean</code>, <code>clustermean</code>, or <code>users</code>.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">
if(requireNamespace("cmdstanr")){
  cilr &lt;- complr(data = mcompd, sbp = sbp,
                 parts = c("TST", "WAKE", "MVPA", "LPA", "SB"),
                 idvar = "ID", total = 1440)

  # model with compositional predictor at between and between-person levels of variance
  fit1 &lt;- brmcoda(complr = cilr,
                  formula = Stress ~ bilr1 + bilr2 + bilr3 + bilr4 +
                                     wilr1 + wilr2 + wilr3 + wilr4 + (1 | ID),
                  chain = 1, iter = 500, backend = "cmdstanr")
  sub1 &lt;- substitution(object = fit1, delta = 5, level = c("between", "within"))

  # model with compositional predictor at aggregate level of variance
  fit2 &lt;- brmcoda(complr = cilr,
                  formula = Stress ~ ilr1 + ilr2 + ilr3 + ilr4 + (1 | ID),
                  chain = 1, iter = 500, backend = "cmdstanr")
  sub2 &lt;- substitution(object = fit2, delta = 5, level = c("aggregate"))

}
</code></pre>


</div>