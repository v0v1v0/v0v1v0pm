<div class="container">

<table style="width: 100%;"><tr>
<td>boot.modmed.mlm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Boot function for (moderated) mediation with 2-level multilevel models</h2>

<h3>Description</h3>

<p>Boot function for (moderated) mediation with 2-level multilevel models
</p>


<h3>Usage</h3>

<pre><code class="language-R">boot.modmed.mlm(
  data,
  indices,
  L2ID,
  ...,
  type = "all",
  modval1 = NULL,
  modval2 = NULL,
  boot.lvl = c("both", "1", "2")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data frame in long format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indices</code></td>
<td>
<p><code>boot</code> requires the function signature to accept a vector of
index numbers and so this argument is required. If the index numbers are all in order starting at 1,
then the relevant model will be fit to the data without any resampling. If some other vector is supplied,
then resampling is done as described in details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L2ID</code></td>
<td>
<p>Name of column that contains grouping variable in 'data' (e.g., "SubjectID")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments passed to <code>modmed.mlm</code> to define the mediation analysis model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Character that defines what information to extract from the model. Default and options are in <code>extract.modmed.mlm</code>.
As examples, "indirect" will compute the indirect effect, "all" will save all random and fixed effects for possible additional
computations, "indirect.diff" will compute the difference in the indirect effect at two values of a possible moderating variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modval1</code></td>
<td>
<p>(Optional) Numeric. If the model has a moderator, this value will be passed to <code>extract.modmed.mlm</code>
to compute the indirect effect or other effects at that value. See <code>extract.modmed.mlm</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modval2</code></td>
<td>
<p>(Optional). If the model has a moderator, it is possible to compute the difference in the indirect
at two values of the moderator. If given and an appropriate option for such a difference is chosen for <code>type</code>,
this value and that of <code>modval1</code> will be passed to <code>extract.modmed.mlm</code> to compute and save the difference.
This is useful for obtaining a CI for the difference in the indirect effect at two different levels of the moderator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot.lvl</code></td>
<td>
<p>Character that defines at what level resampling should occur. Options are "both", "1", or "2". "both" will sample L2 units
and then L1 units w/in each cluster. This has been noted to result in unequal sample sizes if the original clusters did not have equal sample sizes.
"2" resamples only L2 units and leaves all L1 units intact. "1" will assume that whatever indices are fed from the boot function will
be used. This probably only makes sense if <code>strata</code> is specified.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Implements function to do bootstrapping with the 1-1-1 multilevel mediation analysis models as used in Falk, Vogel,
Hammami &amp; Miočević (in press). For use with boot package. This function aides in implementing case resampling methods
with support for resampling at level 2, level 1, or both (e.g., see Hox and van de Schoot, 2013; van der Leeden, Meijer, &amp; Busing, 2008).
These functions also support moderated mediation. See also <code>modmed.mlm</code>. Note that <code>nlm</code> was used as the optimizer
for some of the examples below as it was found to be faster for the models/simulations studied by Falk et al (in press).
</p>


<h3>Value</h3>

<p>A vector of parameter estimates, depending on the value of <code>type</code> specified as input. Once the model is estimated,
<code>extract.modmed.mlm is used to obtain the parameter estimates.</code>
</p>


<h3>References</h3>

<p>Bauer, D. J., Preacher, K. J., &amp; Gil, K. M. (2006). Conceptualizing and testing random indirect effects and moderated mediation in multilevel models: New procedures and recommendations. Psychological Methods, 11(2), 142–163. <a href="https://doi.org/10.1037/1082-989X.11.2.142">doi:10.1037/1082-989X.11.2.142</a>
</p>
<p>Falk, C. F., Vogel, T., Hammami, S., &amp; Miočević, M. (in press). Multilevel mediation analysis in R: A comparison of bootstrap and Bayesian approaches. Behavior Research Methods. <a href="https://doi.org/10.3758/s13428-023-02079-4">doi:10.3758/s13428-023-02079-4</a>  Preprint: <a href="https://doi.org/10.31234/osf.io/ync34">doi:10.31234/osf.io/ync34</a>
</p>
<p>Hox, J., &amp; van de Schoot, R. (2013). Robust methods for multilevel analysis. In M. A. Scott, J. S. Simonoff &amp; B. D. Marx (Eds.), The SAGE Handbook of Multilevel Modeling (pp. 387-402). SAGE Publications Ltd. <a href="https://doi.org/10.4135/9781446247600.n22">doi:10.4135/9781446247600.n22</a>
</p>
<p>van der Leeden, R., Meijer, E., &amp; Busing, F. M. T. A. (2008). Resampling multilevel models. In J. de Leeuw &amp; E. Meijer (Eds.), Handbook of Multilevel Analysis (pp. 401-433). Springer.
</p>


<h3>Examples</h3>

<pre><code class="language-R">


# Note that for all examples below, R should be increased to something
#  MUCH larger (e.g., 1000). Small values here are used only so that the code
#  runs relatively quickly when tested.

## Mediation for 1-1-1 model
data(BPG06dat)

#Setup parallel processing
# snow appears to work on Windows; something else may be better on Unix/Mac/Linux
library(parallel)
library(boot)
ncpu&lt;-2
RNGkind("L'Ecuyer-CMRG") # set type of random number generation that works in parallel
cl&lt;-makeCluster(ncpu)
clusterSetRNGStream(cl, 9912) # set random number seeds for cluster

# bootstrap all fixed and random effects (type="all")
boot.result&lt;-boot(BPG06dat, statistic=boot.modmed.mlm, R=10,
  L2ID = "id", X = "x", Y = "y", M = "m",
  random.a=TRUE, random.b=TRUE, random.cprime=TRUE,
  type="all",
  control=list(opt="nlm"),
  parallel="snow",ncpus=ncpu,cl=cl)

# Point estimate and 95% CI for indirect effect
extract.boot.modmed.mlm(boot.result, type="indirect", ci.conf=.95)

stopCluster(cl) # shut down cluster

## Moderated mediation

data(simdat)

# Note: use of nlm apparently fails in this moderated mediation model
# default optimizer for lme instead is used

## Bootstrap w/ moderation of a and b paths
set.seed(1234)

boot.result2&lt;-boot(simdat, statistic=boot.modmed.mlm, R=5,
 L2ID = "L2id", X = "X", Y = "Y", M = "M",
   random.a=TRUE, random.b=TRUE, random.cprime=TRUE,
   moderator = "mod", mod.a=TRUE, mod.b=TRUE,
   type="all")

# indirect effect point estimate and 95% CI when moderator = 0
extract.boot.modmed.mlm(boot.result2, type="indirect")
extract.boot.modmed.mlm(boot.result2, type="indirect", modval1=0)

# indirect effect point estimate and 95% CI when moderator = 1
extract.boot.modmed.mlm(boot.result2, type="indirect", modval1=1)

# indirect effect difference point estimate and 95% CI
extract.boot.modmed.mlm(boot.result2, type="indirect.diff",
   modval1=0, modval2=1)

# Example to not fail when using missing values
# See documentation for lme function from the nlme package for other
# options for na.action
dat.miss &lt;- BPG06dat
dat.miss$m[c(1,2,3,4)]&lt;-NA
dat.miss$y[c(5,6,7,8)]&lt;-NA
boot.result&lt;-boot(dat.miss, statistic=boot.modmed.mlm, R=5,
  L2ID = "id", X = "x", Y = "y", M = "m",
  random.a=TRUE, random.b=TRUE, random.cprime=TRUE,
  type="all",
  control=list(opt="nlm"),
  na.action = na.omit)


</code></pre>


</div>