<div class="container">

<table style="width: 100%;"><tr>
<td>relabel_bayes_estimate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Relabel the Bayes Estimate of a Partition</h2>

<h3>Description</h3>

<p>Relabel the Bayes estimate of a partition, for use after using indexing to
reduce the number of record pairs that are potential matches.
</p>


<h3>Usage</h3>

<pre><code class="language-R">relabel_bayes_estimate(reduced_comparison_list, bayes_estimate)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>reduced_comparison_list</code></td>
<td>
<p>The output from a call to
<code>reduce_comparison_data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bayes_estimate</code></td>
<td>
<p>The output from a call to
<code>find_bayes_estimate</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When the function <code>reduce_comparison_data</code> is used to reduce the
number of record pairs that are potential matches, it may be the case that
some records are declared to not be potential matches to any other records.
In this case, the indexing method has made the decision that these records
have no matches, and thus we can remove them from the data set and relabel
the remaining records; see the documentation for <code>labels</code> in
<code>reduce_comparison_data</code> for information on how to go between the
original labeling and the new labeling. The purpose of this function is to
relabel the output of <code>find_bayes_estimate</code> when the function
<code>reduce_comparison_data</code> is used, so that the user doesn't have
to do this relabeling themselves.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code>, with as many rows as
<code>sum(reduced_comparison_list$file_sizes +
reduced_comparison_list$file_sizes_not_included)</code>, i.e. the number of
records originally input to <code>create_comparison_data</code>, before
indexing occurred. This <code>data.frame</code> has two columns,
<code>"original_labels"</code> and <code>"link_id"</code>. Given row <code>i</code> of
<code>records</code> originally input to <code>create_comparison_data</code>,
the linkage id according to <code>bayes_estimate</code> is given by the <code>i</code>th
row of the <code>link_id</code> column. See the documentation for
<code>find_bayes_estimate</code> for information on how to interpret this
linkage id.
</p>


<h3>References</h3>

<p>Serge Aleshin-Guendel &amp; Mauricio Sadinle (2022). Multifile Partitioning for Record Linkage and Duplicate Detection. <em>Journal of the
American Statistical Association</em>. [doi: <a href="https://doi.org/10.1080/01621459.2021.2013242">10.1080/01621459.2021.2013242</a>][<a href="https://arxiv.org/abs/2110.03839">arXiv</a>]
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Example with small duplicate dataset
data(dup_data_small)

# Create the comparison data
comparison_list &lt;- create_comparison_data(dup_data_small$records,
 types = c("bi", "lv", "lv", "lv", "lv", "bi", "bi"),
 breaks = list(NA,  c(0, 0.25, 0.5),  c(0, 0.25, 0.5),
               c(0, 0.25, 0.5), c(0, 0.25, 0.5),  NA, NA),
 file_sizes = dup_data_small$file_sizes,
 duplicates = c(1, 1, 1))

# Reduce the comparison data
# The following line corresponds to only keeping pairs of records for which
# neither gname nor fname disagree at the highest level
pairs_to_keep &lt;- (comparison_list$comparisons[, "gname_DL_3"] != TRUE) &amp;
 (comparison_list$comparisons[, "fname_DL_3"] != TRUE)
reduced_comparison_list &lt;- reduce_comparison_data(comparison_list,
 pairs_to_keep, cc = 1)

# Specify the prior
prior_list &lt;- specify_prior(reduced_comparison_list, mus = NA, nus = NA,
 flat = 0, alphas = rep(1, 7), dup_upper_bound = c(10, 10, 10),
 dup_count_prior_family = c("Poisson", "Poisson", "Poisson"),
 dup_count_prior_pars = list(c(1), c(1), c(1)), n_prior_family = "uniform",
 n_prior_pars = NA)

# Run the Gibbs sampler
{
results &lt;- gibbs_sampler(reduced_comparison_list, prior_list, n_iter = 1000,
 seed = 42)

# Find the full Bayes estimate
full_estimate &lt;- find_bayes_estimate(results$partitions, burn_in = 100,
 L_FNM = 1, L_FM1 = 1, L_FM2 = 2, L_A = Inf, max_cc_size = 50)

# Find the partial Bayes estimate
partial_estimate &lt;- find_bayes_estimate(results$partitions, burn_in = 100,
 L_FNM = 1, L_FM1 = 1, L_FM2 = 2, L_A = 0.1, max_cc_size = 12)

# Relabel the full and partial Bayes estimates
full_estimate_relabel &lt;- relabel_bayes_estimate(reduced_comparison_list,
 full_estimate)

partial_estimate_relabel &lt;- relabel_bayes_estimate(reduced_comparison_list,
 partial_estimate)

# Add columns to the records corresponding to their full and partial
# Bayes estimates
dup_data_small$records &lt;- cbind(dup_data_small$records,
 full_estimate_id = full_estimate_relabel$link_id,
 partial_estimate_id = partial_estimate_relabel$link_id)
}
</code></pre>


</div>