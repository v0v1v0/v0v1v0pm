<div class="container">

<table style="width: 100%;"><tr>
<td>simdataClosedSCR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate spatially-explicit capture-mark-recapture data from a (demographically) closed population with multiple non-invasive marks</h2>

<h3>Description</h3>

<p>This function generates encounter histories from spatially-explicit capture-mark-recapture data consisting of multiple non-invasive marks.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simdataClosedSCR(
  N = 30,
  ntraps = 9,
  noccas = 5,
  pbeta = 0.25,
  tau = 0,
  sigma2_scr = 0.75,
  lambda = 0.75,
  delta_1 = 0.4,
  delta_2 = 0.4,
  alpha = 0.5,
  data.type = "never",
  detection = "half-normal",
  spatialInputs = NULL,
  buffer = 3 * sqrt(sigma2_scr),
  ncells = 1024,
  scalemax = 10,
  plot = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>True population size or abundance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntraps</code></td>
<td>
<p>The number of traps. If <code>trapCoords=NULL</code>, the square root of <code>ntraps</code> must be a whole number in order to create a regular grid of trap coordinates on a square.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noccas</code></td>
<td>
<p>Scaler indicating the number of sampling occasions per trap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pbeta</code></td>
<td>
<p>Complementary loglog-scale intercept term for detection probability (p). Must be a scaler or vector of length <code>noccas</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>Additive complementary loglog-scale behavioral effect term for recapture probability (c).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2_scr</code></td>
<td>
<p>Complementary loglog-scale term for effect of distance in the “half-normal” detection function. Ignored unless <code>detection=``half-normal''</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Complementary loglog-scale term for effect of distance in the “exponential” detection function. Ignored unless <code>detection=``exponential''</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta_1</code></td>
<td>
<p>Conditional probability of type 1 encounter, given detection.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta_2</code></td>
<td>
<p>Conditional probability of type 2 encounter, given detection.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Conditional probability of simultaneous type 1 and type 2 detection, given both types encountered. Only applies when <code>data.type="sometimes"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.type</code></td>
<td>
<p>Specifies the encounter history data type. All data types include non-detections (type 0 encounter), type 1 encounter (e.g., left-side), and type 2 encounters (e.g., right-side). When both type 1 and type 2 encounters occur for the same individual within a sampling occasion, these can either be "non-simultaneous" (type 3 encounter) or "simultaneous" (type 4 encounter). Three data types are currently permitted:
</p>
<p><code>data.type="never"</code> indicates both type 1 and type 2 encounters are never observed for the same individual within a sampling occasion, and observed encounter histories therefore include only type 1 or type 2 encounters (e.g., only left- and right-sided photographs were collected). Observed encounter histories can consist of non-detections (0), type 1 encounters (1), and type 2 encounters (2). See <code>bobcat</code>. Latent encounter histories consist of non-detections (0), type 1 encounters (1), type 2 encounters (2), and type 3 encounters (3).
</p>
<p><code>data.type="sometimes"</code> indicates both type 1 and type 2 encounters are sometimes observed (e.g., both-sided photographs are sometimes obtained, but not necessarily for all individuals). Observed encounter histories can consist of non-detections (0), type 1 encounters (1), type 2 encounters (2), type 3 encounters (3), and type 4 encounters (4). Type 3 encounters can only be observed when an individual has at least one type 4 encounter. Latent encounter histories consist of non-detections (0), type 1 encounters (1), type 2 encounters (2), type 3 encounters (3), and type 4 encounters (4). 
</p>
<p><code>data.type="always"</code> indicates both type 1 and type 2 encounters are always observed, but some encounter histories may still include only type 1 or type 2 encounters. Observed encounter histories can consist of non-detections (0), type 1 encounters (1), type 2 encounters (2), and type 4 encounters (4). Latent encounter histories consist of non-detections (0), type 1 encounters (1), type 2 encounters (2), and type 4 encounters (4).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>detection</code></td>
<td>
<p>Model for detection probability as a function of distance from activity centers. Must be "<code>half-normal</code>" (of the form <code class="reqn">\exp{(-d^2 / (2*\sigma^2))}</code>, where <code class="reqn">d</code> is distance) or "<code>exponential</code>" (of the form <code class="reqn">\exp{(-d / \lambda)}</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spatialInputs</code></td>
<td>
<p>A list of length 3 composed of objects named <code>trapCoords</code>, <code>studyArea</code>, and <code>centers</code>:
</p>
<p><code>trapCoords</code> is a matrix of dimension <code>ntraps</code> x (2 + <code>noccas</code>) indicating the Cartesian coordinates and operating occasions for the traps, where rows correspond to trap, the first column the x-coordinate (“x”), and the second column the y-coordinate (“y”). The last <code>noccas</code> columns indicate whether or not the trap was operating on each of the occasions, where ‘1’ indciates the trap was operating and ‘0’ indicates the trap was not operating.  
</p>
<p><code>studyArea</code> is a 3-column matrix defining the study area and available habitat. Each row corresponds to a grid cell. The first 2 columns (“x” and “y”) indicate the Cartesian x- and y-coordinate for the centroid of each grid cell, and the third column (“avail”) indicates whether the cell is available habitat (=1) or not (=0). All grid cells must have the same resolution. Note that rows should be ordered in raster cell order (raster cell numbers start at 1 in the upper left corner, and increase from left to right, and then from top to bottom).
</p>
<p><code>centers</code> is a <code>N</code>-vector indicating the grid cell (i.e., the row of <code>studyArea</code>) that contains the true (latent) activity centers for each individual in the population. 
</p>
<p>If <code>spatialInputs=NULL</code> (the default), then all traps are assumed to be operating on all occasions, the study area is assumed to be composed of <code>ncells</code> grid cells, grid cells within <code>buffer</code> of the trap array are assumed to be available habitat, and the activity centers are randomly assigned to grid cells of available habitat.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>buffer</code></td>
<td>
<p>A scaler indicating the buffer around the bounding box of <code>trapCoords</code> for defining the study area and available habitat when <code>spatialInputs=NULL</code>.  Default is <code>buffer=3*sqrt(sigma2_scr)</code>. Ignored unless <code>spatialInputs=NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncells</code></td>
<td>
<p>The number of grid cells in the study area when <code>studyArea=NULL</code>. The square root of <code>ncells</code> must be a whole number. Default is <code>ncells=1024</code>. Ignored unless <code>spatialInputs=NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scalemax</code></td>
<td>
<p>Upper bound for grid cell centroid x- and y-coordinates. Default is <code>scalemax=10</code>, which scales the x- and y-coordinates to be between 0 and 10.  Ignored unless <code>spatialInputs=NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Logical indicating whether to plot the simulated trap coordinates, study area, and activity centers using <code>plotSpatialData</code>.  Default is <code>plot=TRUE</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Please be very careful when specifying your own <code>spatialInputs</code>; <code>multimarkClosedSCR</code> and <code>markClosedSCR</code> do little to verify that these make sense during model fitting.
</p>


<h3>Value</h3>

<p>A list containing the following:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Enc.Mat</code></td>
<td>
<p>Matrix containing the observed encounter histories with rows corresponding to individuals and (<code>ntraps</code>*<code>noccas</code>) columns corresponding to traps and sampling occasions.  The first <code>noccas</code> columns correspond to trap 1, the second <code>noccas</code> columns corresopond to trap 2, etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trueEnc.Mat</code></td>
<td>
<p>Matrix containing the true (latent) encounter histories with rows corresponding to individuals and (<code>ntraps</code>*<code>noccas</code>) columns corresponding to traps and sampling occasions.  The first <code>noccas</code> columns correspond to trap 1, the second <code>noccas</code> columns corresopond to trap 2, etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spatialInputs</code></td>
<td>
<p>List of length 2 with objects named <code>trapCoords</code> and <code>studyArea</code>:
</p>
<p><code>trapCoords</code> is a matrix of dimension <code>ntraps</code> x (2 + <code>noccas</code>) indicating the Cartesian coordinates and operating occasions for the traps, where rows correspond to trap, the first column the x-coordinate, and the second column the y-coordinate. The last <code>noccas</code> columns indicate whether or not the trap was operating on each of the occasions, where ‘1’ indciates the trap was operating and ‘0’ indicates the trap was not operating.
</p>
<p><code>studyArea</code> is a 3-column matrix containing the coordinates for the centroids a contiguous grid of cells that define the study area and available habitat. Each row corresponds to a grid cell. The first 2 columns indicate the Cartesian x- and y-coordinate for the centroid of each grid cell, and the third column indicates whether the cell is available habitat (=1) or not (=0). All cells must have the same resolution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centers</code></td>
<td>
<p><code>N</code>-vector indicating the grid cell (i.e., the row of <code>spatialInputs$studyArea</code>) that contains the true (latent) activity centers for each individual in the population.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Brett T. McClintock
</p>


<h3>References</h3>

<p>Bonner, S. J., and Holmberg J. 2013. Mark-recapture with multiple, non-invasive marks. <em>Biometrics</em> 69: 766-775.
</p>
<p>McClintock, B. T., Conn, P. B., Alonso, R. S., and Crooks, K. R. 2013. Integrated modeling of bilateral photo-identification data in mark-recapture analyses. <em>Ecology</em> 94: 1464-1471.
</p>
<p>Royle, J.A., Karanth, K.U., Gopalaswamy, A.M. and Kumar, N.S. 2009. Bayesian inference in camera trapping studies for a class of spatial capture-recapture models.  <em>Ecology</em> 90: 3233-3244.
</p>


<h3>See Also</h3>

<p><code>processdataSCR</code>, <code>multimarkClosedSCR</code>, <code>markClosedSCR</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#simulate data for data.type="sometimes" using defaults
data&lt;-simdataClosedSCR(data.type="sometimes")

</code></pre>


</div>