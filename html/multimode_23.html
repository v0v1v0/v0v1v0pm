<div class="container">

<table style="width: 100%;"><tr>
<td>locmodes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Location of modes and antimodes </h2>

<h3>Description</h3>

<p>Given a certain number of modes, this function provides the estimation of the location of modes and antimodes and their density value.
</p>


<h3>Usage</h3>

<pre><code class="language-R">locmodes(data,mod0=1,lowsup=-Inf,uppsup=Inf,n=2^15,tol=10^(-5),display=F,...)

## S3 method for class 'locmod'
plot(x,addplot=NULL,xlab=NULL,ylab=NULL,addLegend=NULL,posLegend=NULL,...)

## S3 method for class 'locmod'
print(x,digits=getOption("digits"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> Sample in which the critical bandwidth is computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mod0</code></td>
<td>
<p> Number of modes for which the critical bandwidth is calculated. Default <code>mod0=1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lowsup</code></td>
<td>
<p> Lower limit for the random variable support in the computation of the  critical bandwidth. Default is <code>-Inf</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uppsup</code></td>
<td>
<p> Upper limit for the random variable support in the computation of the critical bandwidth. Default is <code>Inf</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p> The number of equally spaced points at which the density is to be estimated. When n &gt; 512, it is rounded up to a power of 2 as in the <code>density</code> function. Default <code>n=2^15</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p> Accuracy requested in the computation of the critical bandwidth. Default value <code>tol=10^(-5)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>display</code></td>
<td>
<p> Logical, if <code>TRUE</code> the kernel density estimation is plotted adding the estimated location of the modes and the antimodes. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> Arguments to be passed to subsequent methods, <code>plot.default</code> for the <code>plot</code> method and <code>formatC</code> for the <code>print</code> method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> An object inheriting from class <code>"locmod"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>addplot</code></td>
<td>
<p> Logical, if <code>TRUE</code> the plot is added to the current one. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p> A title for the x axis. See <code>title</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p> A title for the y axis. See <code>title</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>addLegend</code></td>
<td>
<p> Logical, if <code>TRUE</code> the legend is added in the plot. Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posLegend</code></td>
<td>
<p> The vector of two elements of coordinates to be used to position the legend. It can be specified by keyword as in the function <code>legend</code>. Default is <code>"topright"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p> Number of significant digits to use, see <code>formatC</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given a certain number of modes, <code>mod0</code>, with <code>locmodes</code> the estimation of the location of modes and antimodes, their density value and the corresponding critical bandwidth is provided. To obtain these estimates, the kernel density estimation with gaussian kernel and the critical bandwidth for <code>mod0</code> modes is employed. If the compact support is unknown, the critical bandwidth of Silverman (1981) is computed and if such a support is provided, then the one proposed by Hall and York (2001) is calculated. Note that when the support is unknown the critical bandwidth may create artificial modes in the tails.
</p>
<p>Since a dichotomy method is employed for computing the critical bandwidth, the parameter <code>tol</code> is used to determine a stopping time in such a way that the error committed in the computation of the critical bandwidth is less than <code>tol</code>.
</p>
<p>If <code>display=TRUE</code>, then the kernel density estimation using the critical bandwidth for <code>mod0</code> modes is plotted. Additionally, the estimated location of modes (dashed lines), antimodes (point lines) and support (solid lines) can be also plotted. If <code>addLegend=TRUE</code>, a legend (in the position <code>posLegend</code>) with this information is included.
</p>
<p>The NAs will be automatically removed.
</p>


<h3>Value</h3>

<p>A list with class <code>"locmod"</code> containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>locations</code></td>
<td>
<p> Vector with the estimated locations of modes (odd positions of the vector) and antimodes (even positions). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fvalue</code></td>
<td>
<p> Vector with estimated density values at modes (odd positions of the vector) and antimodes (even positions).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cbw</code></td>
<td>
<p> A list with class <code>"estmod"</code> which contains the critical bandwidth of the sample for <code>mod0</code> modes, see <code>bw.crit</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Jose Ameijeiras-Alonso, Rosa M. Crujeiras and Alberto Rodríguez-Casal</p>


<h3>References</h3>

<p>Ameijeiras-Alonso, J., Crujeiras, R.M. and Rodríguez-Casal, A. (2019). Mode testing, critical bandwidth and excess mass, <em>Test</em>, <b>28</b>, 900–919.
</p>
<p>Ameijeiras-Alonso, J., Crujeiras, R.M. and Rodríguez-Casal, A. (2021). multimode: An R Package for Mode Assessment, <em>Journal of Statistical Software</em>, <b>97</b>, 1–32.
</p>
<p>Hall, P. and York, M. (2001).  On the calibration of Silverman's test for multimodality, <em>Statistica Sinica</em>, <b>11</b>, 515–536.
</p>
<p>Silverman, B. W. (1981). Using kernel density estimates to investigate multimodality, <em>Journal of the Royal Statistical Society. Series B</em>, <b>43</b>, 97–99.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Testing for unimodality
set.seed(2016)
data=rnorm(50)
modetest(data)
#There is no evidence to reject the null hypothesis of unimodality
#Estimated location of the mode and its density value
locmodes(data)
## Not run: 
#Estimated locations of the five modes in the claw of Marron and Wand (1992)
library(nor1mix)
set.seed(2016)
n&lt;-200
data&lt;-nor1mix::rnorMix(n,MW.nm10)
#Adding the plot of the estimated locations
locmodes(data,5,display=T)
#Assuming that the compact support is [-1.5,1.5]
locmodes(data,5,-1.5,1.5,display=T)

## End(Not run)
</code></pre>


</div>