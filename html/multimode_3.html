<div class="container">

<table style="width: 100%;"><tr>
<td>bw.crit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Critical bandwidth </h2>

<h3>Description</h3>

<p>This function computes the critical bandwidth for a specified number of modes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bw.crit(data,mod0=1,lowsup=-Inf,uppsup=Inf,n=2^15,tol=10^(-5),full.result=F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> Sample for computing the critical bandwidth.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mod0</code></td>
<td>
<p> Number of modes for which the critical bandwidth is calculated. Default <code>mod0=1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lowsup</code></td>
<td>
<p> Lower limit for the random variable support in the computation of the  critical bandwidth. Default is <code>-Inf</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uppsup</code></td>
<td>
<p> Upper limit for the random variable support in the computation of the critical bandwidth. Default is <code>Inf</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p> The number of equally spaced points at which the density is estimated. When n &gt; 512, it is rounded up to a power of 2 as in the <code>density</code> function. Default <code>n=2^15</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p> Accuracy requested in the computation of the critical bandwidth. Default value of <code>tol</code> is <code>10^(-5)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>full.result</code></td>
<td>
<p> If this argument is TRUE then it returns the full result list, see below. Default <code>full.result=FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>With <code>bw.crit</code> the critical bandwidth for the number of modes specified in <code>mod0</code> is calculated, e.g., the smallest bandwidth such that the kernel density estimator has at most <code>mod0</code> modes. If the compact support is unknown, the critical bandwidth introduced by Silverman (1981) is computed and if it is provided that one of Hall and York (2001) is calculated.
</p>
<p>Since a dichotomy method is employed for computing the critical bandwidth, the parameter <code>tol</code> is used to determine a stopping time in such a way that the error committed in the computation of the critical bandwidth is less than <code>tol</code>.
</p>
<p>The NAs will be automatically removed.
</p>


<h3>Value</h3>

<p>Depending on <code>full.result</code> either a number, the critical bandwidth of the sample for <code>mod0</code> modes, or an object of class <code>"estmod"</code> which is a <code>list</code> containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>nmodes</code></td>
<td>
<p> The specified hypothesized value of the number of modes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample.size</code></td>
<td>
<p> The number of non-missing observations in the sample used for computing the number of modes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p> Value of the critical bandwidth test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lowsup</code></td>
<td>
<p> Lower limit of the support where the critical bandwidth is computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ippsup</code></td>
<td>
<p> Upper limit of the support where the critical bandwidth is computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fnx</code></td>
<td>
<p> The <code>n</code> coordinates of the points where the density is estimated for computing the critical bandwidth.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fny</code></td>
<td>
<p> The estimated density values.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Jose Ameijeiras-Alonso, Rosa M. Crujeiras and Alberto Rodríguez-Casal</p>


<h3>References</h3>

<p>Hall, P. and York, M. (2001).  On the calibration of Silverman's test for multimodality, <em>Statistica Sinica</em>, <b>11</b>, 515–536.
</p>
<p>Silverman, B. W. (1981). Using kernel density estimates to investigate multimodality, <em>Journal of the Royal Statistical Society. Series B</em>, <b>43</b>, 97–99.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Critical bandwidth of Silverman (1981) for one mode.
set.seed(2016)
data=rnorm(50)
bw.crit(data)
# Critical bandwidth of Hall and York for two modes in the interval (-1.5,1.5).
set.seed(2016)
data=rnorm(50)
bw.crit(data,mod0=2,lowsup=-1.5,uppsup=1.5)
</code></pre>


</div>