<div class="container">

<table style="width: 100%;"><tr>
<td>excessmass</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Excess mass </h2>

<h3>Description</h3>

<p>This function computes the excess mass statistic.
</p>


<h3>Usage</h3>

<pre><code class="language-R">excessmass(data,mod0=1,approximate=FALSE,gridsize=NULL,full.result=F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> Sample for computing the excess mass.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mod0</code></td>
<td>
<p> Number of modes for which the excess mass is calculated. Default <code>mod0=1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>approximate</code></td>
<td>
<p> If this argument is TRUE then the excess mass value is approximated. Default <code>approximate=FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gridsize</code></td>
<td>
<p> When <code>approximate=TRUE</code>, number of endpoints at which the <code class="reqn">C_m(\lambda)</code> sets are estimated (first element) and number of possible values of <code class="reqn">\lambda</code> (second element). Default is <code>gridsize=c(20,20)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>full.result</code></td>
<td>
<p> If this argument is TRUE then it returns the full result list, see below. Default <code>full.result=FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>With <code>excessmass</code>, the excess mass test statistic, introduced by Müller and Sawitzki (1991), for the integer number of modes specified in <code>mod0</code> is computed.
</p>
<p>The excess mass test statistic for k modes is defined as <code class="reqn">\max_{\lambda} \{D_{n,k+1}(\lambda)\}</code>, where <code class="reqn">D_{n,k+1}(\lambda)=(E_{n,k+1}(P_n,\lambda)-E_{n,k}(P_n,\lambda))</code>. The empirical excess mass function for <code class="reqn">k</code> modes is defined as <code class="reqn">E_{n,k}(P_n,\lambda)=\sup_{C_1(\lambda),\ldots,C_k(\lambda)} \{\sum_{m=1}^k P_n (C_m(\lambda)) - \lambda ||C_m(\lambda)|| \}</code>, being the sets <code class="reqn">C_m(\lambda)</code> closed intervals with endpoints the data points.
</p>
<p>When <code>mod0&gt;1</code> and the sample size is <em>large</em>, a two-steps approximation (<code>approximate=TRUE</code>) can be performed in order to improve the computing time efficiency. First, since the possible <code class="reqn">\lambda</code> candidates to maximize <code class="reqn">D_{n,k+1}(\lambda)</code> can be directly obtained from the sets that maximize <code class="reqn">E_{n,k+1}</code> and <code class="reqn">E_{n,k}</code> (see Section SM5 of Supplementary Material in Ameijeiras-Alonso <em>et al.</em>, 2019), the possible values of <code class="reqn">\lambda</code> are computed by looking to the empirical excess mass function in <code>gridsize[1]</code> endpoints candidates for <code class="reqn">C_m(\lambda)</code> and also in the <code class="reqn">\lambda</code> values associated to the empirical excess mass for one mode. Once a <code class="reqn">\lambda</code> maximizing the approximated values of <code class="reqn">D_{n,k+1}(\lambda)</code> is chosen, in order to obtain the approximation of the excess mass test statistic, in its neighborhood, a grid of possible values of <code class="reqn">\lambda</code> is created, being its length equal to <code>gridsize[2]</code>, and the exact value of <code class="reqn">D_{n,k+1}(\lambda)</code> is calculated for these values of <code class="reqn">\lambda</code> (using the algorithm proposed by Müller and Sawitzki, 1991).
</p>
<p>If there are repeated data in the sample or the distance between different pairs of data points shows ties, a data perturbation is applied. This modification is made in order to avoid the discretization of the data which has important effects on the computation of the test statistic. The perturbed sample is obtained by adding a sample from the uniform distribution in minus/plus a half of the minimum of the positive distances between two sample points.
</p>
<p>The NAs will be automatically removed.
</p>


<h3>Value</h3>

<p>Depending on <code>full.result</code> either a number, the excess mass statistic for <code>mod0</code> modes, or an object of class <code>"estmod"</code> which is a <code>list</code> containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>nmodes</code></td>
<td>
<p> The specified hypothesized value of the number of modes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample.size</code></td>
<td>
<p> The number of non-missing observations in the sample used for computing the excess mass.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>excess.mass</code></td>
<td>
<p> Value of the excess mass test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>approximate</code></td>
<td>
<p> A logical value indicating if the excess mass was approximated.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Jose Ameijeiras-Alonso, Rosa M. Crujeiras and Alberto Rodríguez-Casal</p>


<h3>References</h3>

<p>Ameijeiras-Alonso, J., Crujeiras, R.M. and Rodríguez-Casal, A. (2019). Mode testing, critical bandwidth and excess mass, <em>Test</em>, <b>28</b>, 900–919.
</p>
<p>Ameijeiras-Alonso, J., Crujeiras, R.M. and Rodríguez-Casal, A. (2021). multimode: An R Package for Mode Assessment, <em>Journal of Statistical Software</em>, <b>97</b>, 1–32.
</p>
<p>Müller, D. W. and Sawitzki, G. (1991). Excess mass estimates and tests for multimodality, <em>The Annals of Statistics</em>, <b>13</b>, 70–84.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Excess mass statistic for one mode
set.seed(2016)
data=rnorm(50)
excessmass(data)
</code></pre>


</div>