<div class="container">

<table style="width: 100%;"><tr>
<td>gibbs_mala_sampler</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
The core of the Hybrid Gibbs/MALA MCMC sampler for the multinomial logit mixture.
</h2>

<h3>Description</h3>

<p>This function implements Gibbs sampling to update the mixing proportions and latent allocations variables of the mixture model. The coefficients of the logit model are updated according to Metropolis-Hastings type move, based on a Metropolis adjusted Langevin (MALA) proposal. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">gibbs_mala_sampler(y, X, tau = 3e-05, nu2, K, mcmc_iter = 100, 
	alpha_prior = NULL, start_values = "EM", em_iter = 10, 
	thin = 10, verbose = FALSE, checkAR = NULL, 
	probsSave = FALSE, ar_low = 0.4, ar_up = 0.6)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>matrix of counts.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>design matrix (including constant term). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>

<p>the variance of the normal prior distribution of the logit coefficients.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu2</code></td>
<td>

<p>scale of the MALA proposal (positive).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>

<p>number of components of the (overfitting) mixture model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcmc_iter</code></td>
<td>

<p>Number of MCMC iterations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_prior</code></td>
<td>

<p>Parameter of the Dirichlet prior distribution for the mixing proportions.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start_values</code></td>
<td>

<p>Optional list of starting values. Random initialization is used if this is not provided.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>em_iter</code></td>
<td>

<p>Maximum number of iterations if an EM initialization is enabled.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>

<p>optional thinning of the generated MCMC output.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>Boolean.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>checkAR</code></td>
<td>

<p>Number of iterations to adjust the scale of the proposal in MALA mechanism during the initial warm-up phase of the sampler.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probsSave</code></td>
<td>

<p>Optional.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ar_low</code></td>
<td>

<p>Lowest threshold for the acceptance rate of the MALA proposal (optional) .
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ar_up</code></td>
<td>

<p>Highest threshold for the acceptance rate of the MALA proposal (optional). 
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nClusters</code></td>
<td>
<p>sampled values of the number of clusters (non-empty mixture components).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allocations</code></td>
<td>
<p>sampled values of the latent allocation variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLikelihood</code></td>
<td>
<p>Log-likelihood values per MCMC iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mixing_proportions</code></td>
<td>
<p>sampled values of mixing proportions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>sapled values of the coefficients of the multinomial logit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>complete_logLikelihood</code></td>
<td>
<p>Complete log-likelihood values per MCMC iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>class_probs</code></td>
<td>
<p>Classification probabilities per iteration (optional).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AR</code></td>
<td>
<p>Acceptance rate of the MALA proposal.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>This function is used inside the prior tempering scheme, which is the main function. 
</p>


<h3>Author(s)</h3>

<p>Panagiotis Papastamoulis
</p>


<h3>See Also</h3>

<p><code>gibbs_mala_sampler_ppt</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#	Generate synthetic data
	K &lt;- 2
	p &lt;- 2
	D &lt;- 2
	n &lt;- 2
	set.seed(116)
	simData &lt;- simulate_multinomial_data(K = K, p = p, D = D, n = n, size = 20, prob = 0.025)   


	gs &lt;- gibbs_mala_sampler(y = simData$count_data, X = simData$design_matrix, 
		tau = 0.00035, nu2 = 100, K = 2, mcmc_iter = 3, 
		alpha_prior = rep(1,K), start_values = "RANDOM", 
		thin = 1, verbose = FALSE, checkAR = 100)

</code></pre>


</div>