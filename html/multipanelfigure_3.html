<div class="container">

<table style="width: 100%;"><tr>
<td>fill_panel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>fill_panel</h2>

<h3>Description</h3>

<p>A convenience function adding graphical objects to a
<code>gtable</code> constructed by <code>multi_panel_figure</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fill_panel(
  figure,
  panel,
  row = "auto",
  column = "auto",
  label = NULL,
  label_just = c("right", "bottom"),
  panel_clip = c("on", "off", "inherit"),
  scaling = c("none", "stretch", "fit", "shrink"),
  allow_panel_overwriting = FALSE,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>figure</code></td>
<td>
<p>Object of classes <code>multipanelfigure</code>/
<code>gtable</code> as produced by <code>multi_panel_figure</code>
and representing the figure the panel is to be placed in.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>panel</code></td>
<td>
<p>Single <code>character</code> object representing URL or path to a
bitmap image accessible by <code>ImageMagick</code> as used through
<code>magick</code>, a <code>Heatmap</code> or
<code>HeatmapList</code> object, a
<code>ggplot</code> object , a
<code>trellis.object</code>, a <code>gList</code> object or
a <code>grob</code> object to be placed in a multipanel figure. See
'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row</code></td>
<td>
<p><code>numeric</code> object of length 1 or a range, indicating the row
indeces the panel that is to be placed in the figure, or "auto" to
automatically pick the row (see details). May be used to define  panel
spanning (if <code>length(row) &gt; 1</code>; see examples).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>column</code></td>
<td>
<p><code>numeric</code> object of length 1 or a range, indicating the
column indeces of the panel that is to be placed in the figure, or "auto" to
automatically pick the column (see details). May be used to define  panel
spanning (if <code>length(column) &gt; 1</code>; see examples).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label</code></td>
<td>
<p>Single <code>character</code> object defining the panel
label used for automated annotation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label_just</code></td>
<td>
<p>Justification for the label within the interpanel spacing
grob to the top-left of the panel content grob.  Passed to
<code>textGrob</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>panel_clip</code></td>
<td>
<p>Should the display of panel contents be clipped at the
panel borders?  See <code>viewport</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaling</code></td>
<td>
<p>Only used when importing image files. Either "none" to
preserve the dimensions of an image, "stretch" to make it fit the panels,
"fit" to shrink or enlarge it so that it fills one dimension of the panels
while preserving the height to width ratio, or "shrink which does the same
but won't enlarge it.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allow_panel_overwriting</code></td>
<td>
<p>A logical value. If <code>TRUE</code>, overwriting
panels is allowed, with a warning.  Otherwise (the default) it will cause an
error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A logical value. Reduces verbosity if <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments. Used to deal with deprecated arguments
<code>top_panel</code>, <code>bottom_panel</code>, <code>left_panel</code> and <code>right_panel</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Currently supported as panel-representing objects (<code>panel</code>) are
</p>

<ol>
<li>
<p>ComplexHeatmap <code>Heatmap</code> or
<code>HeatmapList</code> objects.
</p>
</li>
<li>
<p>ggplot2 <code>ggplot</code> objects.
</p>
</li>
<li>
<p>grid <code>grob</code>, <code>gList</code>, and
<code>gTree</code> objects.
</p>
</li>
<li>
<p>lattice <code>trellis.object</code>s.
</p>
</li>
<li>
<p>Single <code>character</code> objects representing URLs or paths to
image formats accessible by <code>ImageMagick</code> as used through
<code>magick</code>, which will be read and placed into panels
as requested.</p>
</li>
</ol>
<p>Native resolution is determined from attributes in the file.  If the attributes are
not present, then the DPI is determined by the the
<code>multipanelfigure.defaultdpi</code> global option, or 300 if this has not been
set.
</p>
<p><span class="pkg">lattice</span>-generated <code>trellis.object</code>s are converted
to <code>grob</code>s using <code>grid.grabExpr(print(x))</code>, as are <code>Heatmap</code>
and <code>HeatmapList</code>s from <span class="pkg">ComplexHeatmap</span> - the side effects of
which with respect to plot formatting are not well studied.
</p>
<p>If the <code>row</code> argument is "auto", then the first row with
a free panel is used.
If the <code>column</code> argument is "auto", then the first column in the
row with a free panel is used.
</p>


<h3>Value</h3>

<p>Returns the <code>gtable</code> object fed to it
(<code>figure</code>) with the addition of the <code>panel</code>.
</p>


<h3>Author(s)</h3>

<p>Johannes Graumann, Richard Cotton
</p>


<h3>References</h3>

<p>Graumann, J., and Cotton, R.J. (2018). multipanelfigure: Simple
Assembly of Multiple Plots and Images into a Compound Figure. Journal of
Statistical Software 84. doi: 10.18637/jss.v084.c03
</p>


<h3>See Also</h3>

<p><code>gtable</code>, <code>multi_panel_figure</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> # Not testing - slow grid graphics makes CRAN timing excessive
# Create the figure layout
(figure &lt;- multi_panel_figure(
  width = c(30,40,60),
  height = c(40,60,60,60),
  panel_label_type = "upper-roman"))

# Fill the top-left panel using a grob object directly
a_grob &lt;- grid::linesGrob(arrow = grid::arrow())
figure %&lt;&gt;% fill_panel(a_grob)

# Add a ggplot object directly to the top row, second column.
# The panels are chosen automatically, but you can achieve the same effect
# using column = 2
a_ggplot &lt;- ggplot2::ggplot(mtcars, ggplot2::aes(disp, mpg)) +
  ggplot2::geom_point()
figure %&lt;&gt;% fill_panel(a_ggplot)

# Bitmap images are added by passing the path to their file.
image_files &lt;- system.file("extdata", package = "multipanelfigure") %&gt;%
  dir(full.names = TRUE) %&gt;%
  magrittr::set_names(basename(.))

# Add the JPEG to the top row, third column
figure %&lt;&gt;% fill_panel(image_files["rhino.jpg"], column = 3)

# Add the PNG to the second and third row, first and second column
figure %&lt;&gt;% fill_panel(
  image_files["Rlogo.png"],
  row = 2:3, column = 1:2)

# Add the TIFF to the second row, third column
figure %&lt;&gt;% fill_panel(
  image_files["unicorn.svg"],
  row = 2, column = 3)

# lattice/trellis plot objects are also added directly
Depth &lt;- lattice::equal.count(quakes$depth, number=4, overlap=0.1)
a_lattice_plot &lt;- lattice::xyplot(lat ~ long | Depth, data = quakes)
# Add the lattice plot to the third row, third column
figure %&lt;&gt;% fill_panel(
  a_lattice_plot,
  row = 3, column = 3)

# Incorporate a gList object (such as produced by VennDigram)
if(requireNamespace("VennDiagram"))
{
  a_venn_plot &lt;- VennDiagram::draw.pairwise.venn(50, 30, 20, ind = FALSE)
  # Add the Venn diagram to the fourth row, firstd column
  figure %&lt;&gt;% fill_panel(
    a_venn_plot,
    row = 4, column = 1)
}

# Incorporate a base plot figure
a_base_plot &lt;- capture_base_plot(
 heatmap(
   cor(USJudgeRatings), Rowv = FALSE, symm = TRUE, col = topo.colors(16),
   distfun = function(c) as.dist(1 - c), keep.dendro = TRUE,
   cexRow = 0.5, cexCol = 0.5))
# Add the heatmap to the fourth row, second column
figure %&lt;&gt;% fill_panel(
  a_base_plot,
  row = 4, column = 2)

# Incorporate a ComplexHeatmap figure
require(ComplexHeatmap)
mat = matrix(rnorm(80, 2), 8, 10)
mat = rbind(mat, matrix(rnorm(40, -2), 4, 10))
rownames(mat) = letters[1:12]
colnames(mat) = letters[1:10]
ht = Heatmap(mat)
a_complex_heatmap &lt;- ht + ht + ht
# Add the ComplexHeatmap to the fourth row, third column
(figure %&lt;&gt;% fill_panel(
  a_complex_heatmap,
  row = 4, column = 3))

</code></pre>


</div>