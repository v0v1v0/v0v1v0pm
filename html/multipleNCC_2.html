<div class="container">

<table style="width: 100%;"><tr>
<td>Chenprob</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Sampling probabilities estimated with local averaging.
</h2>

<h3>Description</h3>

<p>Estimates sampling probabilities with local averaging (Chen, 2001). 
The weights included in the Cox-regressions (wpl) and which could be used for
other procedures are inverse sampling probabilities i.e. the inverse of these
probabilities. The probabilties are estimated for all subjects in the cohort.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Chenprob(survtime, samplestat, no.intervals = 10, left.time = 0, 
no.intervals.left = c(3,4))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>survtime</code></td>
<td>

<p>Follow-up time for all cohort subjects
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samplestat</code></td>
<td>

<p>A vector containing sampling and status information: 0 represents non-sampled 
subjects in the cohort, 1: sampled controls, 2,3,... indicate different events. 
Cohort dimension. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no.intervals</code></td>
<td>

<p>Number of intervals for censoring times for Chen-weights with only right 
censoring
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>left.time</code></td>
<td>

<p>Entry time if the survival times are left-truncated. Cohort dimension. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no.intervals.left</code></td>
<td>

<p>Number of intervals for Chen-weights with left-truncation. A vector on the form 
[number of intervals for left truncated time, number of intervals for survival time].
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A vector of cohort dimension of sampling probabilities. 
</p>


<h3>Author(s)</h3>

<p>Nathalie C. Stoer
</p>


<h3>References</h3>

<p>Chen KN (2001) Generalized case-cohort sampling. J Roy Stat Soc Ser B 63(4):791-809 <br>
Stoer NC and Samuelsen SO (2012): Comparison of estimators in nested case-control 
studies with multiple outcomes. Lifetime Data Analysis, 18(3), 261-283.
</p>


<h3>See Also</h3>

<p><code>wpl</code>, <code>coxph</code>, <code>GAMprob</code>, <code>GLMprob</code>, 
<code>KMprob</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">   

data(CVD_Accidents)
attach(CVD_Accidents)
Chenprob(agestop,samplestat,left.time=agestart)
Chenprob(agestop,samplestat,left.time=agestart,no.intervals.left=c(3,4))

function (survtime, samplestat, no.intervals, left.time = 0, no.intervals.left = 0) 
{
    n.cohort = length(survtime)
    status = rep(0, n.cohort)
    status[samplestat &gt; 1] = 1
    samplestat[samplestat &gt; 1] = 1
    ind.no = 1:length(samplestat)
    p = pChen(status, survtime, samplestat, ind.no, n.cohort, 
        no.intervals, left.time, no.intervals.left)
    p[status == 1] = 1
    p
  }
</code></pre>


</div>