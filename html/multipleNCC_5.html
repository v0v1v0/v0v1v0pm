<div class="container">

<table style="width: 100%;"><tr>
<td>GLMprob</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Sampling probabilities estimated with logistic regression.
</h2>

<h3>Description</h3>

<p>Estimates sampling probabilities with logistic regression. 
The weights included in the Cox-regressions (wpl) and which could be used for
other procedures are inverse sampling probabilities i.e. the inverse of these
probabilities. The probabilties are estimated for all subjects in the cohort.
</p>
<p><code>survtime</code>, <code>left.time</code> and continuous matching variables are 
included in the logistic regression as continuous variables while 
categorical matching variables are taken as factors. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">GLMprob(survtime, samplestat, left.time = 0, match.var = 0, match.int = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>survtime</code></td>
<td>

<p>Follow-up time for all cohort subjects
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samplestat</code></td>
<td>

<p>A vector containing sampling and status information: 0 represents non-sampled 
subjects in the cohort, 1: sampled controls, 2,3,... indicate different events. 
Cohort dimension. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>left.time</code></td>
<td>

<p>Entry time if the survival times are left-truncated. Cohort dimension. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>match.var</code></td>
<td>

<p>If the controls are matched to the cases (on other variables than time), 
match.var is the vector of matching variables. Cohort dimension.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>match.int</code></td>
<td>

<p>A vector of length 2*number of matching variables. For caliper matching 
(matched on value pluss/minus epsilon) match.int should consist of 
c(-epsilon,epsilon). For exact matching match.int should consist of c(0,0). 
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A vector of cohort dimension of sampling probabilities. 
</p>


<h3>Author(s)</h3>

<p>Nathalie C. Stoer
</p>


<h3>References</h3>

<p>Stoer NC and Samuelsen SO (2013): Inverse probability weighting in nested case-control
studies with additional matching - a simulation study. Statistics in Medicine, 
32(30), 5328-5339.
</p>


<h3>See Also</h3>

<p><code>wpl</code>, <code>coxph</code>, <code>Chenprob</code>, <code>GAMprob</code>, 
<code>KMprob</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(CVD_Accidents)
attach(CVD_Accidents)
GLMprob(agestop,samplestat,agestart)
GLMprob(agestop,samplestat,agestart,match.var=cbind(sex,bmi),match.int=c(0,0,-2,2))

## The function is currently defined as
function (survtime, samplestat, left.time = 0, match.var = 0, 
    match.int = 0) 
{
    n.cohort = length(survtime)
    status = rep(0, n.cohort)
    status[samplestat &gt; 1] = 1
    samplestat[samplestat &gt; 1] = 1
    pglm = pGLM(status, survtime, samplestat, n.cohort, left.time, 
        match.var, match.int)
    p = rep(1, n.cohort)
    p[status == 0] = pglm
    p
  }
</code></pre>


</div>