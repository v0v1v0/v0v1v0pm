<div class="container">

<table style="width: 100%;"><tr>
<td>KMprob</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Sampling probabilities estimated with a Kaplan-Meier type formula
</h2>

<h3>Description</h3>

<p>Estimates sampling probabilities with a Kaplan-Meier type formula. 
The weights included in the Cox-regressions (wpl) and which could be used for
other procedures are inverse sampling probabilities i.e. the inverse of these
probabilities. The probabilties are estimated for all subjects in the cohort.
</p>


<h3>Usage</h3>

<pre><code class="language-R">KMprob(survtime, samplestat, m, left.time = 0, match.var = 0, match.int = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>survtime</code></td>
<td>

<p>Follow-up time for all cohort subjects
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samplestat</code></td>
<td>

<p>A vector containing sampling and status information: 0 represents non-sampled 
subjects in the cohort, 1: sampled controls, 2,3,... indicate different events. 
Cohort dimension. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>

<p>Number of sampled controls. A scalar if equal number of controls for all case. 
If unequal number of controls per case: A vector of length number of cases. The 
vector must be in the same order as the cases in the samplestat-vector.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>left.time</code></td>
<td>

<p>Entry time if the survival times are left-truncated. Cohort dimension. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>match.var</code></td>
<td>

<p>If the controls are matched to the cases (on other variables than time), 
match.var is the vector of matching variables. Cohort dimension.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>match.int</code></td>
<td>

<p>A vector of length 2*number of matching variables. For caliper matching 
(matched on value pluss/minus epsilon) match.int should consist of 
c(-epsilon,epsilon). For exact matching match.int should consist of c(0,0). 
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A vector of cohort dimension of sampling probabilities. 
</p>


<h3>Author(s)</h3>

<p>Nathalie C. Stoer
</p>


<h3>References</h3>

<p>Samuelsen SO. A pseudolikelihood approach to analysis of nested case-control studies.
Biometrika, 84(2):379-394, 1997. <br>
Stoer NC and Samuelsen SO (2013): Inverse probability weighting in nested case-control
studies with additional matching - a simulation study. Statistics in Medicine, 
32(30), 5328-5339.
</p>


<h3>See Also</h3>

<p><code>wpl</code>, <code>coxph</code>, <code>Chenprob</code>, <code>GLMprob</code>, 
<code>GAMprob</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(CVD_Accidents)
attach(CVD_Accidents)
KMprob(agestop,samplestat,m=1,agestart)
KMprob(agestop,samplestat,m=1,agestart,match.var=cbind(bmi),match.int=c(-2,2))

## The function is currently defined as
function (survtime, samplestat, m,  left.time = 0, match.var = 0, match.int = 0) 
{
    n.cohort = length(survtime)
    status = rep(0, n.cohort)
    status[samplestat &gt; 1] = 1
    o = order(survtime)
    status = status[o]
    survtime = survtime[o]
    if (length(left.time) == n.cohort) {
        left.time = left.time[o]
    }
    if (length(match.var) == n.cohort) {
        match.var = match.var[o]
    }
    if (length(match.var) &gt; n.cohort) {
        match.var = match.var[o, ]
    }
    tilbakestill = (1:n.cohort)[o]
    p = pKM(status, survtime, m, n.cohort, left.time, match.var, 
        match.int)
    p[status &gt; 0] = 1
    p = p[order(tilbakestill)]
    p
  }
</code></pre>


</div>