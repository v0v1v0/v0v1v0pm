<div class="container">

<table style="width: 100%;"><tr>
<td>mgcv_lambda</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Maximum marginal likelihood score
</h2>

<h3>Description</h3>

<p>Computed maximum marginal likelihood score for given penalty parameters using <code>mgcv</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mgcv_lambda(penalties, XXblocks,Y, model=NULL, printscore=TRUE, pairing=NULL, sigmasq = 1,
  opt.sigma=ifelse(model=="linear",TRUE, FALSE))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>penalties</code></td>
<td>

<p>Numeric vector.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>XXblocks</code></td>
<td>

<p>List of <code>nxn</code> matrices. Usually output of <code>createXXblocks</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>

<p>Response vector: numeric, binary, factor or <code>survival</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>Character. Any of <code>c("linear", "logistic", "cox")</code>. Is inferred from
<code>Y</code> when <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>printscore</code></td>
<td>
<p>Boolean. Should the score be printed?
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pairing</code></td>
<td>
<p>Numerical vector of length 3 or <code>NULL</code> when pairs are absent. Represents the indices (in <code>XXblocks</code>) of the two data blocks involved in pairing, plus the index of the paired block.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmasq</code></td>
<td>
<p>Default error variance.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt.sigma</code></td>
<td>
<p>Boolean. Should the error variance be optimized as well? Only relevant for <code>model="linear"</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See <code>gam</code> for details on how the marginal likelihood is computed.
</p>


<h3>Value</h3>

<p>Numeric, marginal likelihood score for given penalties
</p>


<h3>References</h3>

<p>Wood, S. N. (2011), Fast stable restricted maximum likelihood and marginal likelihood
estimation of semiparametric generalized linear models, J. Roy. Statist. Soc., B 73(1), 3-36.
</p>


<h3>See Also</h3>

<p><code>CVscore</code> for cross-validation alternative. A full demo and data are available from:<br><a href="https://drive.google.com/open?id=1NUfeOtN8-KZ8A2HZzveG506nBwgW64e4">https://drive.google.com/open?id=1NUfeOtN8-KZ8A2HZzveG506nBwgW64e4</a>
</p>


</div>