<div class="container">

<table style="width: 100%;"><tr>
<td>gsi</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generalised Sensitivity Indices: GSI</h2>

<h3>Description</h3>

<p>The gsi function implements the calculation of Generalised Sensitivity
Indices. This method allows to compute a synthetic Sensitivity Index for
the dynamic or multivariate models by using factorial designs and the
MANOVA decomposition of inertia. It computes also the Sensitivity
Indices on principal components</p>


<h3>Usage</h3>

<pre><code class="language-R">gsi(formula, model, factors, inertia = 0.95, normalized = TRUE,
    cumul = FALSE, simulonly = FALSE, Name.File = NULL, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>ANOVA formula like <code>"A+B+C+A:B"</code> OR an integer equal to the
maximum interaction order in the sensitivity model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>output data.frame OR the name of the R-function which
calculates the model output. The only argument of this function
must be a vector containing the input factors values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factors</code></td>
<td>
<p>input data.frame (the design) if model is a data.frame
OR a list of factors levels such as :
<code>factor.example &lt;- list(A=c(0,1),B=c(0,1,4))</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inertia</code></td>
<td>
<p>cumulated proportion of inertia (a scalar <code class="reqn">&lt; 1</code>) to be
explained by the selected Principal components OR number of PCs to
be used (e.g 3)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalized</code></td>
<td>
<p>logical value. TRUE (default) computes a normalized
Principal Component analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cumul</code></td>
<td>
<p>logical value. If TRUE the PCA will be done on the cumulative outputs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simulonly</code></td>
<td>
<p>logical value.  If TRUE the program stops after
calculating the design and the model outputs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Name.File</code></td>
<td>
<p>optional name of a R script file containing the
R-function that calculates the simulation model. e.g  <code>"exc.ssc"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>possible fixed parameters of the model function</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If factors is a list of factors, the gsi function generates a complete
factorial design. If it is a data.frame, gsi expects that each column is
associated with an input factor.
</p>


<h3>Value</h3>

<p>gsi returns a list of class "gsi", containing all the input arguments detailed before, plus
the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a data.frame containing the experimental design (input samples)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>a data.frame containing the output matrix (response)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>a data.frame containing the principal components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>a data.frame whose columns contain the basis eigenvectors (the variable loadings)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>the variances of the principal components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inertia</code></td>
<td>
<p>vector of inertia percentages per PCs and global criterion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor</code></td>
<td>
<p>a data.frame of correlation between PCs and outputs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SI</code></td>
<td>
<p>a data.frame containing  the Sensitivity Indices (SI) on PCs
and the Generalised SI (GSI)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mSI</code></td>
<td>
<p>a data.frame of first order SI on PCs and first order GSI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tSI</code></td>
<td>
<p>a data.frame containing the total SI on PCs and the total GSI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iSI</code></td>
<td>
<p>a data.frame of interaction SI on PCs and interaction GSI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred</code></td>
<td>
<p>a data.frame containing the output predicted by the
metamodel arising from the PCA and anova decompositions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>a data.frame containing the residuals between actual
and predicted outputs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rsquare</code></td>
<td>
<p>vector of dynamic coefficient of determination</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Att</code></td>
<td>
<p>0-1 matrix of association between input factors and
factorial terms in the anovas</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>logical value, see the arguments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalized</code></td>
<td>
<p>logical value, see the arguments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cumul</code></td>
<td>
<p>logical value, see the arguments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call.info</code></td>
<td>
<p>a list containing informations on the process (reduction, analysis, fct, call)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inputdesign</code></td>
<td>
<p>either the input data.frame or the sensitivity object used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outputs</code></td>
<td>
<p>a list of results on each output variable</p>
</td>
</tr>
</table>
<p>...
</p>


<h3>Note</h3>

<p>This function can now be replaced by a call to the <code>multisensi</code> function. It is kept for compatibility with Version 1 of the <span class="pkg">multisensi</span> package.</p>


<h3>References</h3>

<p>M. Lamboni, D. Makowski and H. Monod, 2009. Multivariate
global sensitivity analysis for dynamic
crop models. Field Crops Research, volume 113.  pp. 312-320
</p>
<p>M. Lamboni, D. Makowski and H. Monod, 2009. Multivariate sensitivity analysis to measure global
contribution of input factors in dynamic models. Submitted
to Reliability Engineering  and System Safety.
</p>


<h3>See Also</h3>

<p><code>dynsi</code>, <code>multisensi</code></p>


<h3>Examples</h3>

<pre><code class="language-R"># Test case : the Winter Wheat Dynamic Models (WWDM)
#  input factors design
 data(biomasseX)
# input climate variable
 data(Climat)
# output variables (precalculated to speed up the example)
 data(biomasseY)
#
 GSI &lt;- gsi(2, biomasseY, biomasseX, inertia=3, normalized=TRUE, cumul=FALSE,
            climdata=Climat)
 summary(GSI)
 print(GSI)
 plot(x=GSI, beside=FALSE)
 #plot(GSI, nb.plot=4)         # the 'nb.plot' most influent factors
                               # are represented in the plots
 #plot(GSI,nb.comp=2, xmax=1)  # nb.comp = number of principal components
 #plot(GSI,nb.comp=3, graph=1) # graph=1 for first figure; 2 for 2nd one
                               # and 3 for 3rd one; or 1:3 etc.
 #graph.bar(GSI,col=1, beside=F)  # sensitivity bar plot on the first PC
 #graph.bar(GSI,col=2, xmax=1)    #
  </code></pre>


</div>