<div class="container">

<table style="width: 100%;"><tr>
<td>cdm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>computes a doubly centered distance matrix</h2>

<h3>Description</h3>

<p>computes the doubly centered distance matrix
</p>


<h3>Usage</h3>

<pre><code class="language-R">cdm(
  x,
  normalize = TRUE,
  psi = NULL,
  p = NULL,
  isotropic = FALSE,
  external.dm.fun = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>matrix, each row of the matrix is treated as one sample</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalize</code></td>
<td>
<p>logical, indicates if the matrix should be normalized</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi</code></td>
<td>
<p>if it is <code>NULL</code>, the euclidean distance will be used. In the case of <code>isotropic = TRUE</code>: a real valued negative definite function of one variable (accepting vectors as arguments; returning a vector of the same length). In the case of <code>isotropic = FALSE</code>: a real valued function of two variables (or vectors) to compute the distance of two samples based on a continuous negative definite function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>numeric, if it is a value between 1 and 2 then the Minkowski distance with parameter p is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>isotropic</code></td>
<td>
<p>logical, indicates if psi of the Euclidean distance matrix should be computed, i.e., if an isotropic distance should be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>external.dm.fun</code></td>
<td>
<p>here one can supply an external function, which computes the distance matrix given <code>x</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The doubly centered distance matrices are required for the computation of (total / m-) multivariance.
</p>
<p>If <code>normalize = TRUE</code> then the value of multivariance is comparable and meaningful. It can be compared to the <code>rejection.level</code> or its p-value <code>multivariance.pvalue</code> can be computed.
</p>
<p>More details: If <code>normalize = TRUE</code> the matrix is scaled such that the multivariance based on it, times the sample size, has in the limit - in the case of independence - the distribution of an L^2 norm of a Gaussian process with known expectation.
</p>
<p>As default the Euclidean distance is used. The parameters <code>psi</code>, <code>p</code>, <code>isotropic</code> and <code>external.dm.fun</code> can be used to select a different distance. In particular, <code>external.dm.fun</code> can be used to provide any function which calculates a distance matrix for the rows of a given matrix.
</p>


<h3>References</h3>

<p>For the theoretic background see the references given on the main help page of this package: multivariance-package.
</p>


<h3>Examples</h3>

<pre><code class="language-R">x = coins(100)
cdm(x) # fast euclidean distances
cdm(x,psi = function(x,y) sqrt(sum((x-y)^2))) # this is identical to the previous (but slower)

# the function cdm does the following three lines in a faster way
N = nrow(x)
C = diag(N) - matrix(1/N,nrow = N,ncol = N)
A = - C %*% as.matrix(stats::dist(x,method="euclidean")) %*% C #'
all(abs(A- cdm(x,normalize = FALSE)) &lt; 10^(-12))

</code></pre>


</div>