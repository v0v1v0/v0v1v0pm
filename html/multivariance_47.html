<div class="container">

<table style="width: 100%;"><tr>
<td>multivariance</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>distance multivariance</h2>

<h3>Description</h3>

<p>Computes the distance multivariance, either for given data or a given list of doubly centered distance matrices.
</p>


<h3>Usage</h3>

<pre><code class="language-R">multivariance(
  x,
  vec = NA,
  Nscale = TRUE,
  correlation = FALSE,
  squared = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>either a data matrix or a list of doubly centered distance matrices</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vec</code></td>
<td>
<p>if x is a matrix, then this indicates which columns are treated together as one sample; if x is a list, these are the indexes for which the multivariance is calculated. The default is all columns and all indexes, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nscale</code></td>
<td>
<p>if <code>TRUE</code> the multivariance is scaled up by the sample size (and thus it is exactly as required for the test of independence)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlation</code></td>
<td>
<p>depreciated, please use the function <code>multicorrelation</code> instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>squared</code></td>
<td>
<p>if <code>FALSE</code> it returns the actual multivariance, otherwise the squared multivariance (less computation)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>these are passed to <code>cdms</code> (which is only invoked if <code>x</code> is a matrix)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>x</code> is a matrix and <code>vec</code> is not given, then each column is treated as a separate sample. Otherwise <code>vec</code> has to have as many elements as <code>x</code> has columns and values starting from 1 up to the number of 'variables', e.g. if <code>x</code> is an <code>N</code> by 5 matrix and <code>vec = c(1,2,1,3,1)</code> then the multivariance of the 1-dimensional variables represented by column 2 and 4 and the 3-dimensional variable represented by the columns 1,3,5 is computed.
</p>
<p>As default it computes the normalized Nscaled squared multivariance, for a multivariance without normalization the argument <code>normalize = FALSE</code> has to be passed to <code>cdms</code>.
</p>
<p><code>correlation = TRUE</code> yields values between 0 and 1. These can be interpreted similarly to classical correlations, see also <code>multicorrelation</code>.
</p>
<p>As a rough guide to interpret the value of distance multivariance note:
</p>

<ul>
<li>
<p> If the random variables are not (n-1)-independent, large values indicate dependence, but small values are meaningless. Thus in this case use <code>total.multivariance</code>.
</p>
</li>
<li>
<p> If the random variables are (n-1)-independent and <code>Nscale = TRUE</code>, values close to 1 and smaller indicate independence, larger values indicate dependence. In fact, in the case of independence the test statistic is a Gaussian quadratic form with expectation 1 and samples of it can be generated by <code>resample.multivariance</code>.
</p>
</li>
<li>
<p> If the random variables are (n-1)-independent and <code>Nscale = FALSE</code>, small values (close to 0) indicate independence, larger values indicate dependence.
</p>
</li>
</ul>
<p>Finally note, that due to numerical (in)precision the value of multivariance might become negative. In these cases it is set to 0. A warning is issued, if the value is negative and further than the usual (used by <code>all.equal</code>) tolerance away from 0.
</p>


<h3>References</h3>

<p>For the theoretic background see the references given on the main help page of this package: multivariance-package.
</p>


<h3>Examples</h3>

<pre><code class="language-R">multivariance(matrix(rnorm(100*3),ncol = 3)) #independent sample
multivariance(coins(100)) #dependent sample which is 2-independent

x = matrix(rnorm(100*2),ncol = 2)
x = cbind(x,x[,2])
multivariance(x) #dependent sample which is not 2-independent (thus small values are meaningless!)
multivariance(x[,1:2]) #these are independent
multivariance(x[,2:3]) #these are dependent

multivariance(x[,2:3],correlation = TRUE)

</code></pre>


</div>