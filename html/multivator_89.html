<div class="container">

<table style="width: 100%;"><tr>
<td>betahat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Various intermediate expressions needed by the multivariate emulator
</h2>

<h3>Description</h3>

<p>Various intermediate expressions needed by the multivariate emulator
</p>


<h3>Usage</h3>

<pre><code class="language-R">regressor(x,LoF)
beta_hat(expt,hp,LoF, ...)
betahat_mult(H, Sigmainv, d)
betahat_mult_Sigma(H, Sigma, d)
cstar(x1, x2=x1 , expt, hp,  LoF = NULL, Sigmainv=NULL, ...)
eq2.36(H, Sigmainv, d, log=TRUE)
eq2.36_Sigma(H, Sigma, d)
var.matrix(x1,x2=x1,hp, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x,x1,x2</code></td>
<td>

<p>Objects of class <code>mdm</code>: multivariate design matrix
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>

<p>Matrix of regressors (create this with <code>regressor()</code>)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>

<p>Vector of observations, possibly not all of the same
dimensions (eg some elements might
be Kelvin, others millimeters of rain per year)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expt</code></td>
<td>
<p>Object of class <code>experiment</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>The variance matrix of <code>d</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>Boolean, with <code>TRUE</code> meaning to return the logarithm
of the answer</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigmainv</code></td>
<td>

<p>The inverse of the variance matrix of <code>d</code>, with
default <code>NULL</code> meaning to calculate it directly using
<code>var.matrix()</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LoF</code></td>
<td>

<p>A list of functions with default <code>NULL</code> meaning to use
<code>default_LoF()</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hp</code></td>
<td>
<p>Object of class <code>mhp</code>: multivariate hyperparameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Extra arguments which are
passed (via <code>var.matrix()</code>) to <code>corr.matrix()</code> of the
emulator package</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Function <code>regressor()</code> creates a (sort of) direct sum of
regressor matrices for an overall regressor matrix.  It returns a
matrix whose rows are the regressor functions for each row in the
<code>df</code> argument.  Each type of observation has its own
‘slot’ of columns, the others being filled with zeros.
</p>
<p>The emulator package <em>should</em> have used this method (rather than
messing about with <code>regressor.basis()</code> and
<code>regressor.multi()</code>).
</p>
<p>To get the regression coefficients, the user should use function
<code>beta_hat()</code>, which is the user-friendly version.  It is a
wrapper for function <code>betahat_mult_Sigma()</code>.
</p>
<p>The equation for <code>var.matrix()</code> is
</p>
\[
    c^*\left(x,x'\right)=
    c\left(x,x'\right) - t(x)^TA^{-1}t(x') + \left\lbrace h(x)^T - t(x)^TA^{-1}H\right\rbrace
    \left(H^TA^{-1}H\right)^{-1}\left\lbrace h(x')^T -
    t(x')^TA^{-1}H\right\rbrace ^T
  \]


<h3>Author(s)</h3>

<p>Robin K. S. Hankin
</p>


<h3>See Also</h3>

<p><code>multem</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
data(mtoys)

H &lt;- regressor(toy_mm, toy_LoF)
Sigma &lt;- var.matrix(toy_mm, hp=toy_mhp)
Sigmainv &lt;- solve(Sigma)


jj &lt;- toy_mm_maker(34,35,36)
expt  &lt;- experiment(jj,obs_maker(jj,toy_mhp,toy_LoF,toy_beta))

x1 &lt;- jj[c(20,40,100),]
xold(x1) &lt;- 0.2

x2 &lt;- jj[c(11,21:24,40:42),]
xold(x2) &lt;- xold(x2)+0.1

#primary function of package:
multem(x=x1, expt, hp=toy_mhp, LoF=toy_LoF)

# conditional covariance matrix:
cstar(x1,x2, expt, hp=toy_mhp, LoF=toy_LoF)
 
</code></pre>


</div>