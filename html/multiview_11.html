<div class="container">

<table style="width: 100%;"><tr>
<td>elnet.fit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Solve weighted least squares (WLS) problem for a single lambda value</h2>

<h3>Description</h3>

<p>Solves the weighted least squares (WLS) problem for a single lambda value. Internal
function that users should not call directly.
</p>


<h3>Usage</h3>

<pre><code class="language-R">elnet.fit(
  x,
  y,
  weights,
  lambda,
  alpha = 1,
  intercept = TRUE,
  thresh = 1e-07,
  maxit = 1e+05,
  penalty.factor = rep(1, nvars),
  exclude = c(),
  lower.limits = -Inf,
  upper.limits = Inf,
  warm = NULL,
  from.glmnet.fit = FALSE,
  save.fit = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Input matrix, of dimension <code>nobs x nvars</code>; each row is an
observation vector. If it is a sparse matrix, it is assumed to be unstandardized.
It should have attributes <code>xm</code> and <code>xs</code>, where <code>xm(j)</code> and
<code>xs(j)</code> are the centering and scaling factors for variable j respsectively.
If it is not a sparse matrix, it is assumed that any standardization needed
has already been done.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Quantitative response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Observation weights. <code>elnet.fit</code> does NOT standardize
these weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>A single value for the <code>lambda</code> hyperparameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The elasticnet mixing parameter, with <code class="reqn">0 \le \alpha \le 1</code>.
The penalty is defined as </p>
<p style="text-align: center;"><code class="reqn">(1-\alpha)/2||\beta||_2^2+\alpha||\beta||_1.</code>
</p>

<p><code>alpha=1</code> is the lasso penalty, and <code>alpha=0</code> the ridge penalty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>Should intercept be fitted (default=TRUE) or set to zero (FALSE)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh</code></td>
<td>
<p>Convergence threshold for coordinate descent. Each inner
coordinate-descent loop continues until the maximum change in the objective
after any coefficient update is less than thresh times the null deviance.
Default value is <code>1e-7</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>Maximum number of passes over the data; default is <code>10^5</code>.
(If a warm start object is provided, the number of passes the warm start object
performed is included.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty.factor</code></td>
<td>
<p>Separate penalty factors can be applied to each
coefficient. This is a number that multiplies <code>lambda</code> to allow differential
shrinkage. Can be 0 for some variables, which implies no shrinkage, and that
variable is always included in the model. Default is 1 for all variables (and
implicitly infinity for variables listed in exclude). Note: the penalty
factors are internally rescaled to sum to <code>nvars</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude</code></td>
<td>
<p>Indices of variables to be excluded from the model. Default is
none. Equivalent to an infinite penalty factor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.limits</code></td>
<td>
<p>Vector of lower limits for each coefficient; default
<code>-Inf</code>. Each of these must be non-positive. Can be presented as a single
value (which will then be replicated), else a vector of length <code>nvars</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper.limits</code></td>
<td>
<p>Vector of upper limits for each coefficient; default
<code>Inf</code>. See <code>lower.limits</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warm</code></td>
<td>
<p>Either a <code>glmnetfit</code> object or a list (with names <code>beta</code>
and <code>a0</code> containing coefficients and intercept respectively) which can
be used as a warm start. Default is <code>NULL</code>, indicating no warm start.
For internal use only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>from.glmnet.fit</code></td>
<td>
<p>Was <code>elnet.fit()</code> called from <code>glmnet.fit()</code>?
Default is FALSE.This has implications for computation of the penalty factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save.fit</code></td>
<td>
<p>Return the warm start object? Default is FALSE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>WARNING: Users should not call <code>elnet.fit</code> directly. Higher-level functions
in this package call <code>elnet.fit</code> as a subroutine. If a warm start object
is provided, some of the other arguments in the function may be overriden.
</p>
<p><code>elnet.fit</code> is essentially a wrapper around a C++ subroutine which
minimizes
</p>
<p style="text-align: center;"><code class="reqn">1/2 \sum w_i (y_i - X_i^T \beta)^2 + \sum \lambda \gamma_j
[(1-\alpha)/2 \beta^2+\alpha|\beta|],</code>
</p>

<p>over <code class="reqn">\beta</code>, where <code class="reqn">\gamma_j</code> is the relative penalty factor on the
jth variable. If <code>intercept = TRUE</code>, then the term in the first sum is
<code class="reqn">w_i (y_i - \beta_0 - X_i^T \beta)^2</code>, and we are minimizing over both
<code class="reqn">\beta_0</code> and <code class="reqn">\beta</code>.
</p>
<p>None of the inputs are standardized except for <code>penalty.factor</code>, which
is standardized so that they sum up to <code>nvars</code>.
</p>


<h3>Value</h3>

<p>An object with class "glmnetfit" and "glmnet". The list returned has
the same keys as that of a <code>glmnet</code> object, except that it might have an
additional <code>warm_fit</code> key.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>a0</code></td>
<td>
<p>Intercept value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>A <code>nvars x 1</code> matrix of coefficients, stored in sparse matrix
format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>The number of nonzero coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dim</code></td>
<td>
<p>Dimension of coefficient matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Lambda value used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dev.ratio</code></td>
<td>
<p>The fraction of (null) deviance explained. The deviance
calculations incorporate weights if present in the model. The deviance is
defined to be 2*(loglike_sat - loglike), where loglike_sat is the log-likelihood
for the saturated model (a model with a free parameter per observation).
Hence dev.ratio=1-dev/nulldev.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nulldev</code></td>
<td>
<p>Null deviance (per observation). This is defined to be
2*(loglike_sat -loglike(Null)). The null model refers to the intercept model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npasses</code></td>
<td>
<p>Total passes over the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jerr</code></td>
<td>
<p>Error flag, for warnings and errors (largely for internal
debugging).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>Always FALSE, since offsets do not appear in the WLS problem.
Included for compability with glmnet output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The call that produced this object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nobs</code></td>
<td>
<p>Number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warm_fit</code></td>
<td>
<p>If <code>save.fit=TRUE</code>, output of C++ routine, used for
warm starts. For internal use only.</p>
</td>
</tr>
</table>
</div>