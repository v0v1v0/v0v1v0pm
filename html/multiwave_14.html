<div class="container">

<table style="width: 100%;"><tr>
<td>mww_wav</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
multivariate wavelet Whittle estimation for data as wavelet coefficients
</h2>

<h3>Description</h3>

<p>Computes the multivariate wavelet Whittle estimation of the long-memory parameter  vector <code>d</code> and the long-run covariance matrix for the already wavelet decomposed data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mww_wav(xwav, index, psih, grid_K, LU = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xwav</code></td>
<td>

<p>wavelet coefficients matrix (with scales in rows and variables in columns).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>

<p>vector containing the largest index of each
band, i.e. for <code class="reqn">j&gt;1</code> the wavelet coefficients of scale <code class="reqn">j</code> are <code class="reqn">\code{dwt}(k)</code> for <code class="reqn">k \in [\code{indmaxband}(j-1)+1,\code{indmaxband}(j)]</code> and for  <code class="reqn">j=1</code>,  <code class="reqn">\code{dwt}(k)</code> for <code class="reqn">k \in [1,\code{indmaxband}(1)]</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psih</code></td>
<td>
<p>the Fourier transform of the wavelet mother at values <code>grid_K</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid_K</code></td>
<td>
<p>the grid for the approximation of the integral in K.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LU</code></td>
<td>

<p>bivariate vector (optional) containing 
<code>L</code>, the lowest resolution in wavelet decomposition
<code>U</code>, the maximal resolution in wavelet decomposition. (Default values are set to <code>L</code>=1, and <code>U=Jmax</code>.)
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>L</code> is fixing the lower limit of wavelet scales. <code>L</code> can be increased to avoid finest frequencies that can be corrupted by the presence of high frequency phenomena.
</p>
<p><code>U</code> is fixing the upper limit of wavelet scales. <code>U</code> can be decreased when highest frequencies have to be discarded. 
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>estimation of the vector of long-memory parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov</code></td>
<td>
<p>estimation of the long-run covariance matrix.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>S. Achard and I. Gannaz
</p>


<h3>References</h3>

<p>S. Achard, I. Gannaz (2016)
Multivariate wavelet Whittle estimation in long-range dependence. <em>Journal of Time Series Analysis</em>, Vol 37, N. 4, pages 476-512.  <code>http://arxiv.org/abs/1412.0391</code>.
</p>
<p>S. Achard, I Gannaz (2019)
Wavelet-Based and Fourier-Based Multivariate Whittle Estimation: multiwave. <em>Journal of Statistical Software</em>, Vol 89, N. 6, pages 1-31. 
</p>


<h3>See Also</h3>

<p><code>mww_eval</code>, <code>mww_cov_eval</code>,<code>mww</code>,<code>mww_wav_eval</code>,<code>mww_wav_cov_eval</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">### Simulation of ARFIMA(0,d,0)
rho &lt;- 0.4
cov &lt;- matrix(c(1,rho,rho,1),2,2)
d &lt;- c(0.4,0.2)
J &lt;- 9
N &lt;- 2^J

resp &lt;- fivarma(N, d, cov_matrix=cov)
x &lt;- resp$x
long_run_cov &lt;- resp$long_run_cov

## wavelet coefficients definition
res_filter &lt;- scaling_filter('Daubechies',8);
filter &lt;- res_filter$h

LU &lt;- c(2,11)

### wavelet decomposition

if(is.matrix(x)){
     N &lt;- dim(x)[1]
     k &lt;- dim(x)[2]
}else{
     N &lt;- length(x)
     k &lt;- 1
}
x &lt;- as.matrix(x,dim=c(N,k))

     ## Wavelet decomposition
     xwav &lt;- matrix(0,N,k)
     for(j in 1:k){
          xx &lt;- x[,j]
             
          resw &lt;- DWTexact(xx,filter)
          xwav_temp &lt;- resw$dwt
          index &lt;- resw$indmaxband
          Jmax &lt;- resw$Jmax
          xwav[1:index[Jmax],j] &lt;- xwav_temp;
     }
     ## we free some memory
     new_xwav &lt;- matrix(0,min(index[Jmax],N),k)
     if(index[Jmax]&lt;N){
          new_xwav[(1:(index[Jmax])),] &lt;- xwav[(1:(index[Jmax])),]
     }
     xwav &lt;- new_xwav
     index &lt;- c(0,index)

##### Compute the wavelet functions 
res_psi &lt;- psi_hat_exact(filter,10)
psih &lt;- res_psi$psih
grid &lt;- res_psi$grid

res_mww &lt;- mww_wav(xwav,index, psih, grid,LU)


</code></pre>


</div>