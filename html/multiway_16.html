<div class="container">

<table style="width: 100%;"><tr>
<td>fnnls</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fast Non-Negative Least Squares
</h2>

<h3>Description</h3>

<p>Finds the vector <code>b</code> minimizing 
</p>

<table><tr>
<td style="text-align: center;">
 <code>sum( (y - X %*% b)^2 )</code>
 </td>
</tr></table>
<p>subject to <code>b[j] &gt;= 0</code> for all <code>j</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fnnls(XtX, Xty, ntol = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>XtX</code></td>
<td>

<p>Crossproduct matrix <code>crossprod(X)</code> of dimension p-by-p.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xty</code></td>
<td>

<p>Crossproduct vector <code>crossprod(X,y)</code> of length p-by-1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntol</code></td>
<td>

<p>Tolerance for non-negativity.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The vector <code>b</code> such that <code>b[j] &gt;= 0</code> for all <code>j</code>.
</p>


<h3>Note</h3>

<p>Default non-negativity tolerance: <code>ntol=10*(.Machine$double.eps)*max(colSums(abs(XtX)))*p</code>.
</p>


<h3>Author(s)</h3>

<p>Nathaniel E. Helwig &lt;helwig@umn.edu&gt;
</p>


<h3>References</h3>

<p>Bro, R., &amp; De Jong, S. (1997). A fast non-negativity-constrained least squares algorithm. <em>Journal of Chemometrics, 11</em>, 393-401.
</p>


<h3>Examples</h3>

<pre><code class="language-R">##########   EXAMPLE 1   ##########
X &lt;- matrix(1:100,50,2)
y &lt;- matrix(101:150,50,1)
beta &lt;- solve(crossprod(X))%*%crossprod(X,y)
beta
beta &lt;- fnnls(crossprod(X),crossprod(X,y))
beta


##########   EXAMPLE 2   ##########
X &lt;- cbind(-(1:50),51:100)
y &lt;- matrix(101:150,50,1)
beta &lt;- solve(crossprod(X))%*%crossprod(X,y)
beta
beta &lt;- fnnls(crossprod(X),crossprod(X,y))
beta


##########   EXAMPLE 3   ##########
X &lt;- matrix(rnorm(400),100,4)
btrue &lt;- c(1,2,0,7)
y &lt;- X%*%btrue + rnorm(100)
fnnls(crossprod(X),crossprod(X,y))


##########   EXAMPLE 4   ##########
X &lt;- matrix(rnorm(2000),100,20)
btrue &lt;- runif(20)
y &lt;- X%*%btrue + rnorm(100)
beta &lt;- fnnls(crossprod(X),crossprod(X,y))
crossprod(btrue-beta)/20

</code></pre>


</div>