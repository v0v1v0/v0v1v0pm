<div class="container">

<table style="width: 100%;"><tr>
<td>corcondia</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Core Consistency Diagnostic
</h2>

<h3>Description</h3>

<p>Calculates Bro and Kiers's core consistency diagnostic (CORCONDIA) for a fit <code>parafac</code>  or <code>parafac2</code> model. For Parafac2, the diagnostic is calculated after transforming the data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">corcondia(X, object, divisor = c("nfac","core"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>Three-way data array with <code>dim=c(I,J,K)</code> or four-way data array with <code>dim=c(I,J,K,L)</code>. Can also input a list of two-way or three-way arrays (for Parafac2).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>Object of class "parafac" (output from <code>parafac</code>) or class "parafac2" (output from <code>parafac2</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>divisor</code></td>
<td>

<p>Divide by number of factors (default) or core sum of squares.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The core consistency diagnostic is defined as
</p>

<table><tr>
<td style="text-align: center;">
<code> 100 * ( 1 - sum( (G-S)^2 ) / divisor ) </code>
</td>
</tr></table>
<p>where <code>G</code> is the least squares estimate of the Tucker core array, <code>S</code> is a super-diagonal core array, and <code>divisor</code> is the sum of squares of either <code>S</code> ("nfac") or <code>G</code> ("core"). A value of 100 indiciates a perfect multilinear structure, and smaller values indicate greater violations of multilinear structure.
</p>


<h3>Value</h3>

<p>Returns CORCONDIA value.
</p>


<h3>Author(s)</h3>

<p>Nathaniel E. Helwig &lt;helwig@umn.edu&gt;
</p>


<h3>References</h3>

<p>Bro, R., &amp; Kiers, H.A.L. (2003). A new efficient method for determining the number of components in PARAFAC models. <em>Journal of Chemometrics, 17</em>, 274-286.
</p>


<h3>Examples</h3>

<pre><code class="language-R">##########   EXAMPLE   ##########

# create random data array with Parafac structure
set.seed(3)
mydim &lt;- c(50,20,5)
nf &lt;- 2
Amat &lt;- matrix(rnorm(mydim[1]*nf),mydim[1],nf)
Bmat &lt;- matrix(runif(mydim[2]*nf),mydim[2],nf)
Cmat &lt;- matrix(runif(mydim[3]*nf),mydim[3],nf)
Xmat &lt;- array(tcrossprod(Amat,krprod(Cmat,Bmat)),dim=mydim)
Emat &lt;- array(rnorm(prod(mydim)),dim=mydim)
Emat &lt;- nscale(Emat, 0, ssnew = sumsq(Xmat))   # SNR=1
X &lt;- Xmat + Emat

# fit Parafac model (1-4 factors)
pfac1 &lt;- parafac(X,nfac=1,nstart=1)
pfac2 &lt;- parafac(X,nfac=2,nstart=1)
pfac3 &lt;- parafac(X,nfac=3,nstart=1)
pfac4 &lt;- parafac(X,nfac=4,nstart=1)

# check corcondia
corcondia(X, pfac1)
corcondia(X, pfac2)
corcondia(X, pfac3)
corcondia(X, pfac4)

</code></pre>


</div>