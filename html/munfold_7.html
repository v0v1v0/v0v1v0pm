<div class="container">

<table style="width: 100%;"><tr>
<td>unfold</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Metric Unfolding</h2>

<h3>Description</h3>

<p><code>unfold</code> computes a metric unfolding solution
based on a rectangular matrix, that is, reconstructs
two sets of points from the distances between points
of the first set and the points of the second set.
</p>
<p><code>uapply</code> applies a function
the two point sets that are reconstructed by <code>unfold</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">unfold(x,...)

## S3 method for class 'matrix'
unfold(x, ndims=NULL, squared=FALSE, tol=1e-7,
          method=c("Schoenemann", "CG"), ...)

## S3 method for class 'formula'
unfold(x,data=parent.frame(), ...)

## S3 method for class 'unfolding'
biplot(x, dimen=c(1,2), type=attr(x,"biplot_type"),
  xlim, ylim, tpos=c(4,2), tposdim=1,
  asp=1, lty=c(1,2), lwd=c(1,1), pch=c(1,3), cex=c(1,1),
  col=c("black","black"), contour.col="black", contour.lty=1,
  xlab=paste("Dimension ",dimen[1]),
  ylab=paste("Dimension ",dimen[2]),
  ...)

## S3 method for class 'unfolding'
plot(x, y=NULL ,dimen=1, discrete=attr(x,"plot_discrete"),
  use.rownames=discrete, xlab=paste("Dimension ",dimen), ...)

uapply(x,FUN)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>for <code>unfold.matrix</code>: a rectangular matrix that contains distances
or squared distances (if argument <code>squared</code> is <code>TRUE</code>).
For <code>unfold.formula</code>: a formula which specifies the variables
that form the columns of the matrix of distances.
For <code>biplot.unfolding</code> and <code>plot.unfolding</code>: an object that contains an unfolding solution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame or an environment that contains variables specified in
the formula given as first argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndims</code></td>
<td>
<p>an optional integer value that specifies the
dimensionality of the solution. If <code>NULL</code> the
dimensionality is selected automatically based
on a singular value decomposition of the matrix
of squared distances.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>squared</code></td>
<td>
<p>a logical value; does the matrix <code>D</code> contain squared distances?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>a tolerance value for the convergence of the
conjugate gradients method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a method for the iterative computation
of the unfolding solution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a dummy argument for compatibility with default methods, ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dimen</code></td>
<td>
<p>for <code>biplot</code>: a two-element integer vector,
for <code>plot</code>: a single integer value, that specifies
the dimension(s) of the unfolding solution to be plotted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>a character vector of length less then or equal to 2.
Determines how each of the two point sets of the unfolding
solutions are represented in the biplot.
Valid choices are
</p>

<ul>
<li>
<p><code>"points"</code>the respective set of points are plotted
as points in the biplot.
</p>
</li>
<li>
<p><code>"lines"</code>the points of the respective set
are connected by lines.
</p>
</li>
<li>
<p><code>"both"</code>the points of the respective set
are plotted as points and connected by lines.
</p>
</li>
<li>
<p><code>"text"</code>the points of the respective set
are represented by the corresponding row names
and, if argument <code>tpos</code> is present,
by points.

</p>
</li>
<li>
<p><code>"density"</code>contour lines are drawn of
two-dimensional kernel density estimate for the
respective set of points.
This biplot type
uses the function <code>kde2d</code>
of library <code>MASS</code>.

</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tpos</code></td>
<td>
<p>a two-element integer vector; specifies
the position of text labels relative
to the points. For the meaning of these integer values
see <code>text</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tposdim</code></td>
<td>
<p>an integer value; specifies which how elements of <code>tpos</code>
are used. Labels of points with negative positions along coordinate axis
<code>dimen[tposdim]</code> are positioned according to <code>tpos[1]</code>,
labels of other points are positioned according to <code>tpos[1]</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab, xlim, ylim, asp, lty, lwd, pch, cex, col</code></td>
<td>
<p>arguments passed to base graphics functions</p>
</td>
</tr>
</table>
<p>.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>contour.col, contour.lty</code></td>
<td>
<p>colour and line type for contour lines,
see <code>contour</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>discrete</code></td>
<td>
<p>a logical vector of lenght 2;
if <code>TRUE</code>, the respective set of points are represented
by spikes in theplot, otherwise the set is represented
by a graph of a kernel density estimate.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.rownames</code></td>
<td>
<p>logical; should row names used for annotation?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to <code>optim</code> in
case of <code>unfold</code> or <code>points</code>
in case of the plotting methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN</code></td>
<td>
<p>a function applied to the two sets of points that result
from the unfolding.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>unfold</code> first computes an unfolding solution according to
Schoenemanns metric unfolding algorithm that uses only
linear algebra operations. This preliminary solution is
then refined by minimizing the stress using a conjugate-gradients
method.
</p>
<p><code>uapply</code> applies a given function to the two sets of points
recovered by an unfolding solution. It applies the function
to the components <code>A</code> and <code>B</code> of an object
of class <code>"unfolding"</code>.
</p>


<h3>Value</h3>

<p><code>unfold</code> returns an object of class <code>"unfolding"</code>
with components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>a numeric matrix representing
the first set of points. Each row contains the coordinate
of one point of the first set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>a numeric matrix representing
the second set of points. Each row contains the coordinate
of one point of the second set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted</code></td>
<td>
<p>a numeric matrix that contains the
fitted squared distances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stress</code></td>
<td>
<p>A stress value, denotes the "badness of fit".</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">r &lt;- seq(from=0,to=2*pi,length=24)
a1 &lt;- cos(r)*4 + 0.00001*rnorm(r)
a2 &lt;- sin(r)*4 + 0.00001*rnorm(r)
b1 &lt;- c(.5,-.5,-.5,.5)*3 + 5
b2 &lt;- c(.5,.5,-.5,-.5)*3 + 1

D1 &lt;- outer(b1,a1,"-")
D2 &lt;- outer(b2,a2,"-")

Dsq &lt;- D1^2+D2^2


Dsq.uf&lt;-unfold(sqrt(Dsq),squared=FALSE)

oldpar &lt;- par(mfrow=c(1,2))
A &lt;- cbind(a1,a2)
B &lt;- cbind(b1,b2)

ltype &lt;- c(rep(1,NROW(A)),rep(2,NROW(A)))

orig &lt;- rbind(A,B)
unfolded &lt;- rbind(Dsq.uf$A,Dsq.uf$B)

xlim &lt;- ylim &lt;- range(orig)#*1.5

plot(A,type="b",pch=1,
    xlim=xlim,ylim=ylim,
    xlab="Dimension 1",ylab="Dimension 2",main=expression("Original data"),asp=1)
lines(B,type="b",pch=3,lty=2)
abline(h=0,v=0,lty=3)

biplot(Dsq.uf,type="b",
    xlim=xlim,ylim=ylim,
    main=expression(paste(italic(unfold)," solution")),asp=1)


par(oldpar)

</code></pre>


</div>