<div class="container">

<table style="width: 100%;"><tr>
<td>VandY</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Convert Munsell Value V to Luminance Factor Y, and back again</h2>

<h3>Description</h3>

<p>Convert non-linear Munsell Value V to linear Luminance Factor Y, and back again
</p>


<h3>Usage</h3>

<pre><code class="language-R">YfromV( V, which='ASTM' )
VfromY( Y, which='ASTM' )</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>a numeric vector with elements in the interval [0,10]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>a numeric vector with elements in the interval [0,100]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p> one of the strings in the first column of this table
</p>

<table>
<tr>
<td style="text-align: left;">
              </td>
<td style="text-align: left;">    reference </td>
</tr>
<tr>
<td style="text-align: left;">
<code>'ASTM'</code> </td>
<td style="text-align: left;">    ASTM D-1535 (2008) </td>
</tr>
<tr>
<td style="text-align: left;">
<code>'OSA'</code> </td>
<td style="text-align: left;">     Newhall, et. al. (1943) </td>
</tr>
<tr>
<td style="text-align: left;">
<code>'MgO'</code> </td>
<td style="text-align: left;">     Newhall, et. al. (1943) </td>
</tr>
<tr>
<td style="text-align: left;">
<code>'Munsell'</code> </td>
<td style="text-align: left;"> Munsell, et. al. (1933)</td>
</tr>
<tr>
<td style="text-align: left;">
<code>'Priest'</code> </td>
<td style="text-align: left;"> Priest, et. al. (1920)</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>Partial matching is enabled, and it is case insensitive.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>'Priest'</code> is the earliest (1920) transfer function in this package.
It is implemented as:
</p>
<p style="text-align: center;"><code class="reqn">V = sqrt(Y)  ~~~~~~and~~~~~~   Y = V^2 </code>
</p>

<p>One readily checks that when V=10, Y=100, and vice-versa.
This transfer function has been implemented in colorimeters,
using analog electric circuits.
It is used in Hunter Lab - the precursor of CIE Lab.
</p>
<p><code>'Munsell'</code> is the next (1933) transfer function,
and was proposed by Munsell's son (Alexander Ector Orr Munsell) and co-workers.   
It is implemented as:
</p>
<p style="text-align: center;"><code class="reqn">V = sqrt( 1.474*Y - 0.00474*Y^2 )</code>
</p>

<p style="text-align: center;"><code class="reqn">Y = 50 * ( (1474 - sqrt(1474^2 - 4*4740*V^2)) / 474 )</code>
</p>

<p>One readily checks that when V=10, Y=100, and vice-versa.
The luminance factor Y is <em>absolute</em>,
AKA <em>relative to the perfect reflecting diffuser</em>.
</p>
<p><code>'Priest'</code> and <code>'Munsell'</code> are included in this package
for historical interest only.
</p>
<p>The remaining three define Y as a quintic polynomial in V.
</p>
<p>The next one historically - <code>'MgO'</code> -  is implemented as:
</p>
<p style="text-align: center;"><code class="reqn"> Y = (((((8404*V - 210090)*V  + 2395100)*V  - 2311100)*V + 10000000)*V ) / 10000000</code>
</p>

<p>One readily checks that when V=10, Y=102.568.
This Y is larger than 100, because the authors decided to make Y relative
to a clean surface of MgO, instead of the perfect reflecting diffuser.
In their words:
</p>

<ul><li>
<p> It should be noted that the
reflectances indicated are not absolute but relative to magnesium oxide;
whereas the maximum at value 10/ was formerly 100 percent, it is now 102.57.
Use of this relation facilitates results and
also avoids the somewhat dubious conversion to
absolute scale, by permitting Y determinations
with a MgO standard to be converted directly to Munsell value.
</p>
</li></ul>
<p>Nowadays, the perfect reflecting diffuser is preferred over MgO.
For users who would like to modify this quintic as little as possible,
with the perfect reflecting diffuser in mind
(going back to <code>'MUNSELL'</code>),
I offer <code>'OSA'</code>, which is given by this quintic of my own design
</p>
<p style="text-align: center;"><code class="reqn">Y = (((((8404*V - 210090)*V  + 2395100)*V  - 2311100)*V + 10000000)*V ) / 10256800</code>
</p>

<p>ASTM had a similar modification in mind,
but did it a little differently by scaling each coefficient.
<code>'ASTM'</code> is given by this quintic:
</p>
<p style="text-align: center;"><code class="reqn">Y = ( ((((81939*V - 2048400)*V  + 23352000)*V - 22533000)*V + 119140000)*V  ) / 1.e8 </code>
</p>

<p>One readily checks that when V=10, Y=100 exactly (for both <code>'OSA'</code> and <code>'ASTM'</code>).
</p>
<p>The inverses - from Y to V - of all 3 quintics are implemented as 
3 <code>splinefun()</code>s at a large number (about 300) of points.
These inverses are both fast and accurate.
The round-trip Y    →   V    →   Y is accurate to 7 digits after the decimal.
The round-trip V    →   Y    →   V is accurate to 8 digits after the decimal.
</p>


<h3>Value</h3>

<p>a numeric vector the same length as the input
</p>


<h3>Note</h3>

<p>The quintic functions <code>'ASTM'</code> and <code>'OSA'</code> are very close.
They agree at the endpoints 0 and 10 exactly, and the largest difference is near
V=6.767 where they differ by about 0.0007.
</p>


<h3>Author(s)</h3>

<p>Glenn Davis</p>


<h3>References</h3>

<p>Priest, I. G. Gibson, K. S. and McNicholas, H. J.
<b>An Examination of the Munsell Color System.
I. Spectral and and Total Reflection and the Munsell Scale of Value</b>.
Technologic Papers of the Bureau of Standards, No. 167.
pp. 1-33.
Washington D.C.
1920.
</p>
<p>Munsell, A. E. O.,
L. L. Sloan,
and I. H. Godlove.
<b>Neutral Value Scales. I. Munsell Neutral Value Scale</b>.
Journal of the Optical Society of America.
Vol. 23. Issue 11. pp. 394-411.
November 1933.
</p>
<p>Newhall, Sidney M.,
Dorothy Nickerson,
Deane B. Judd.
<b>Final Report of the O.S.A. Subcommitte on the Spacing of the Munsell Colors</b>.
Journal of the Optical Society of America.
Vol. 33.  No. 7.  pp. 385-418.
July 1943.
</p>
<p>ASTM D 1535-08.
Standard Practice for Specifying Color by the Munsell System.
2008
</p>


<h3>See Also</h3>

<p><code>MunsellToxyY()</code>,
<code>xyYtoMunsell()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">VfromY( c(0,50,100) )
##  [1]  0.00000  7.53772 10.00000
</code></pre>


</div>