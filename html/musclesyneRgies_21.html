<div class="container">

<table style="width: 100%;"><tr>
<td>synsNMF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Non-negative matrix factorisation</h2>

<h3>Description</h3>

<p>Non-negative matrix factorisation
</p>


<h3>Usage</h3>

<pre><code class="language-R">synsNMF(
  V,
  R2_target = 0.01,
  runs = 5,
  max_iter = 1000,
  last_iter = 20,
  MSE_min = 1e-04,
  fixed_syns = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>EMG data frame to be reconstructed, usually filtered and time-normalised</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R2_target</code></td>
<td>
<p>Threshold to stop iterations for a certain factorisation rank</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>runs</code></td>
<td>
<p>Number of repetitions for each rank to avoid local minima</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_iter</code></td>
<td>
<p>Maximum number of iterations allowed for each rank</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>last_iter</code></td>
<td>
<p>How many of the last iterations should be checked before stopping?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MSE_min</code></td>
<td>
<p>Threshold on the mean squared error to choose the factorisation rank or
minimum number of synergies</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed_syns</code></td>
<td>
<p>To impose the factorisation rank or number of synergies</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The first column of <code>V</code> must always contain time information.
</p>


<h3>Value</h3>

<p>Object of class <code>musclesyneRgies</code> with elements:<br></p>

<ul>
<li> <p><code>syns</code> factorisation rank or minimum number of synergies<br></p>
</li>
<li> <p><code>M</code> motor modules (time-invariant coefficients)<br></p>
</li>
<li> <p><code>P</code> motor primitives (time-dependent coefficients)<br></p>
</li>
<li> <p><code>V</code> original data<br></p>
</li>
<li> <p><code>Vr</code> reconstructed data<br></p>
</li>
<li> <p><code>iterations</code> number of iterations to convergence<br></p>
</li>
<li> <p><code>R2</code> quality of reconstruction (coefficient of determination)
</p>
</li>
<li> <p><code>rank_type</code> was the rank <code>fixed</code> or <code>variable</code>?<br></p>
</li>
<li> <p><code>classification</code> classification type (e.g., <code>none</code>, <code>k-means</code>, <code>NMF</code>, etc.)
</p>
</li>
</ul>
<h3>References</h3>

<p>Lee, D. D. &amp; Seung, H. S.
Learning the parts of objects by non-negative matrix factorization.
Nature 401, 788-91 (1999).<br></p>
<p>Santuz, A., Ekizos, A., Janshen, L., Baltzopoulos, V. &amp; Arampatzis, A.
On the Methodological Implications of Extracting Muscle Synergies from Human Locomotion.
Int. J. Neural Syst. 27, 1750007 (2017).<br></p>
<p>FÃ©votte, C., Idier, J.
Algorithms for Nonnegative Matrix Factorization with the Beta-Divergence
Neural Computation 23, 9 (2011).
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Note that for bigger data sets one might want to run computation in parallel
# Load some data
data(FILT_EMG)
# Extract synergies (careful, rank is imposed here!)
SYNS &lt;- lapply(FILT_EMG, synsNMF, fixed_syns = 4)
</code></pre>


</div>