<div class="container">

<table style="width: 100%;"><tr>
<td>msTrans_abs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multiscale quantile mapping bias correction</h2>

<h3>Description</h3>

<p>Applies standard quantile mapping at custom time scales.
</p>


<h3>Usage</h3>

<pre><code class="language-R">msTrans_abs(dta, agg_by = month, wet_int_thr = 0.1, maxiter = 10,
  tol = 1e-04, qstep = 0.001, period = c("G1", "Y1", "M3", "M1", "D1"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dta</code></td>
<td>
<p>List with components <code>FROM</code> (simulated data for the control period), <code>TO</code> (observed data) and <code>NEWDATA</code> (data to be corrected). Each component is a <code>data.table</code> with columns <code>DTM</code> (date) and the climate variables (typically <code>PR</code> - precipitation and <code>TAS</code> - temperature)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>agg_by</code></td>
<td>
<p>Function for specification of the period (season, month) to be additionaly included in output, see Details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wet_int_thr</code></td>
<td>
<p>Numeric value specifying the minimum depth to be considered wet</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>Maximum number of iterations, see Details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Stoping criterion of the iteration cycle, see Details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qstep</code></td>
<td>
<p>A numeric value between 0 and 1. The quantile mapping is fitted only for the quantiles defined by quantile(0,1,probs=seq(0,1,by=qstep). Passed to <code>doQmapQUANT</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>period</code></td>
<td>
<p>Specification of the aggregation lengths the correction is applied at with 'D' - day(s), 'M' - month(s), 'Y' - year(s) and 'G1' - the overall mean</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The procedure utilizes standard quantile mapping from the <code>qmap</code>-package, but at multiple time scales. Since correction at particular temporal scale influences values at other aggregations, the procedure is applied iterativelly until the maximum number of iterations (<code>maxiter</code>) is reached or the difference between succesive iteration step is smaller than <code>tol</code>. Differences between corrected and uncorrected variable at longer time scales are used to modify daily values after each iteration step (see e.g. Mehrorta and Sharma, 2016; Pegram et al. 2009). To make further assessment of the decomposed objects easier, indicator of period within the year (e.g. quarter or month) as specified by <code>agg_by</code> argument is included in the output.
</p>


<h3>Value</h3>

<p>data.table with corrected data
</p>


<h3>References</h3>

<p>Hanel, M., Kozin, R., 2016. Bias and projected changes in climate model simulations at multiple time scales: consequences for hydrological impact assessment. Environmental Modelling and Software, submitted.
</p>
<p>Mehrotra, R., Sharma, A., 2016. A multivariate quantile-matching bias correction approach with auto-and cross-dependence across multiple time scales: Implications for downscaling. Journal of Climate 29, 3519-3539.
</p>
<p>Pegram, G.G., et al., 2009. A nested multisite daily rainfall stochastic generation model. Journal of Hydrology 371, 142-153.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("basin_PT")
scen = basin_PT$sim_scen
ctrl = basin_PT$sim_ctrl
obs = basin_PT$obs_ctrl
dta = list(TO = obs, FROM = ctrl, NEWDATA = scen)
## Not run: 
msTrans_abs(dta,  maxiter = 10, period = 'D1')

## End(Not run)
</code></pre>


</div>