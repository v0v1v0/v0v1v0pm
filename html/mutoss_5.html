<div class="container">

<table style="width: 100%;"><tr>
<td>aorc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Step-up-down test based on the asymptotically optimal rejection curve.</h2>

<h3>Description</h3>

<p>Performs a step-up-down test on pValues. The critical values are based 
on the asymptotically optimal rejection curve. To have finite FDR control,
an automatic adjustment of the critical values is done (see
details for more).</p>


<h3>Usage</h3>

<pre><code class="language-R">aorc(pValues, alpha, startIDX_SUD=length(pValues), betaAdjustment,
    silent=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pValues</code></td>
<td>
<p>pValues to be used. They are assumed to be stochastically independent.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The level at which the FDR shall be controlled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startIDX_SUD</code></td>
<td>
<p>The index at which critical value the 
step-up-down test starts. Default is length(pValues) and thus the function
aorc() by default behaves like an step-up test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betaAdjustment</code></td>
<td>
<p>A numeric value to adjust the asymptotically optimal
rejection curve for the finite sample case. If betaAdjustment is not
set an algorithm will calculate it, but this can be time-consuming.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>If true any output on the console will be suppressed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The graph of the function f(t) = t / (t * (1 - alpha) + alpha) is called the asymptotically
optimal rejection curve. Denote by finv(t) the inverse of f(t). Using the 
critical values finv(i/n) for i = 1, ..., n yields asymptotic FDR control.
To ensure finite control it is possible to adjust f(t) by a factor. The
function calculateBetaAdjustment() calculates a beta such that (1 + beta / n) * f(t)
can be used to control the FDR for a given finite sample size. If the 
parameter betaAdjustment is not provided, calculateBetaAdjustment() will be called automatically.</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>adjPValues</code></td>
<td>
<p>A numeric vector containing the adjusted pValues</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rejected</code></td>
<td>
<p>A logical vector indicating which hypotheses are rejected</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criticalValues</code></td>
<td>
<p>A numeric vector containing critical values used in the step-up-down test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>errorControl</code></td>
<td>
<p>A Mutoss S4 class of type <code>errorControl</code>, containing the type of error (FDR)
controlled by the function and the level <code>alpha</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>MarselScheer</p>


<h3>References</h3>

<p>Finner, H., Dickhaus, T. &amp; Roters, M. (2009).
On the false discovery rate and an asymptotically optimal rejection curve.
The Annals of Statistics 37, 596-618.</p>


<h3>Examples</h3>

<pre><code class="language-R">  
## Not run:  # Takes more than 6 seconds therefor CRAN should not check it:
r &lt;- c(runif(10), runif(10, 0, 0.01))
result &lt;- aorc(r, 0.05)
result &lt;- aorc(r, 0.05, startIDX_SUD = 1)  ## step-down
result &lt;- aorc(r, 0.05, startIDX_SUD = length(r))  ## step-up
## End(Not run)
</code></pre>


</div>