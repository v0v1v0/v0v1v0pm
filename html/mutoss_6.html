<div class="container">

<table style="width: 100%;"><tr>
<td>augmentation</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Wrapper function to the augmentation methods of the multtest package.</h2>

<h3>Description</h3>

<p>Wrapper function to the augmentation methods of the multtest package.</p>


<h3>Usage</h3>

<pre><code class="language-R">augmentation(adjPValues, newErrorControl, newK, newQ, silent=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>adjPValues</code></td>
<td>
<p>a vector of p-values that are *already* adjusted for FWER</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newErrorControl</code></td>
<td>
<p>new error control type to adjust for. One of ("gFWER", "FDX", "FDR")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newK</code></td>
<td>
<p>k-parameter if newErrorControl is "gFWER"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newQ</code></td>
<td>
<p>q-parameter if newErrorControl is "FDX"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>if true any output on the console will be suppressed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The augmentation method turns a vector of p-values which are already adjusted for FWER control
into p-values that are adjusted for gFWER, FDX or FDR. The underlying idea (for gFWER and FDX) 
is that the set of hypotheses rejected at a given level alpha under FWER can be "augmented"
by rejecting some additional hypotheses while still ensuring (strong) control of the desired weaker type I criterion.
For FDR, it uses the fact that FDX control for q=alpha=1-sqrt(1-beta) entails FDR control at level beta.
</p>
<p>Use of these augmentation methods is recommended only in the situation where FWER-controlled p-values are
directly available from the data (using some specific method). When only marginal p-values are available,
it is generally prerefable to use other adjustment methods directly aimed at the intended criterion
(as opposed to first adjust for FWER, then augment)
</p>
<p>Note: in the multtest package, two methods ("restricted" and "conservative") are available for FDR augmentation. 
Here the 'restricted' method is forced for FDR augmentation since it is in fact always valid and better than 
"conservative" (M. van der Laan, personal communication) with respect to power.</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>adjPValues</code></td>
<td>
<p>A numeric vector containing the new adjusted pValues</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rejected</code></td>
<td>
<p>A logical vector indicating which hypotheses are rejected. Currently always NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>errorControl</code></td>
<td>
<p>A Mutoss S4 class of type <code>errorControl</code>, containing the type of error controlled by the function.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>KornRohm, GillesBlanchard</p>


<h3>References</h3>

<p>Dudoit, S. and van der Laan, M.J. (2008)
Multiple Testing Procedures with Applications to Genomics, Springer. (chapter 6)</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run:  TODO NH (MS) EXAMPLE PROBLEM
p &lt;- c(runif(50), runif(50, 0, 0.01))
fwer_adj &lt;- bonferroni(p)    # adjust for FWER using Bonferroni correction
fdx_adj  &lt;- augmentation(fwer_adj$adjPValues , "FDX", q=0.1, silent = TRUE) #augment to FDX (q=0.1)

## End(Not run)</code></pre>


</div>