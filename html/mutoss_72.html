<div class="container">

<table style="width: 100%;"><tr>
<td>simulation</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulation studies</h2>

<h3>Description</h3>

<p>This function generates data according to a specified function and parameters
and then applies specified procedures to the generated data. The generated data is stored
in $data and the results are stored in $results. In order to recognize which
results and generated data belong together every result contains an element
$data.set.number. The data generating function must return a list which contains a list
$procInput. Every element in $procInput will be used as an input parameter
for the procedures provided by listOfProcedures.</p>


<h3>Usage</h3>

<pre><code class="language-R">simulation(replications, DataGen, listOfProcedures, discardProcInput=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>replications</code></td>
<td>
<p>The number of replications. This means how many simulation runs will be performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DataGen</code></td>
<td>
<p>A list that contains the function and parameters for generating data 
which will be analyzed be the procedures in listOfProcedures. It must contain the elements
$funName (character) $fun (function)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>listOfProcedures</code></td>
<td>
<p>A list of lists which contains the procedures with their  parameters
for the simulation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>discardProcInput</code></td>
<td>
<p>A list of lists which contains the procedures with their  parameters</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with 2 elements. $data contains the objects generated by DataGen. $results
contains the objects generated by the procedures augmented by the data set number and
the parameter constellation.</p>


<h3>Author(s)</h3>

<p>MarselScheer</p>


<h3>Examples</h3>

<pre><code class="language-R"># this function generates pValues 
myGen &lt;- function(n, n0) {
  list(procInput=list(pValues = c(runif(n-n0, 0, 0.01), runif(n0))), 
  groundTruth = c(rep(FALSE, times=n-n0), rep(TRUE, times=n0)))
}

sim &lt;- simulation(replications = 10, list(funName="myGen", fun=myGen, n=200, n0=c(50,100)), 
list(list(funName="BH", 
  fun=function(pValues, alpha) BH(pValues, alpha, silent=TRUE), alpha=c(0.25, 0.5)),
list(funName="holm", fun=holm, alpha=c(0.25, 0.5),silent=TRUE)))

# the following happend:
# Call myGen(200,50) and append result to sim$data
# Apply bonferroni and holm each with alpha 0.25 and 0.5 to this data set
# Append the results to sim$restults
# Repeat this 10 times.
# Call myGen(200, 100) and append restult to sim$data
# Apply bonferroni and holm each with alpha 0.25 and 0.5 to this data set
# Append the results to sim$restults
# Repeat this 10 times.

length(sim$data)
length(sim$results)

# we now reproduce the 6th item in results
print(sim$results[[6]]$data.set.number)
print(sim$results[[6]]$parameters)

all(BH(sim$data[[2]]$procInput$pValues, 0.5, silent=TRUE)$adjPValues == sim$results[[6]]$adjPValues)

#
# Just calculating some statistics and making some plots
NumberOfType1Error &lt;- function(data, result) sum(data$groundTruth * result$rejected)
result.all &lt;- gatherStatistics(sim, list(NumOfType1Err = NumberOfType1Error))
result &lt;- gatherStatistics(sim, list(NumOfType1Err = NumberOfType1Error), 
  list(median=median, mean=mean, sd=sd))
print(result)
require(lattice)
histogram(~NumOfType1Err | method*alpha, data = result.all$statisticDF)
barchart(NumOfType1Err.median + NumOfType1Err.mean ~ method | alpha, data = result$statisticDF)</code></pre>


</div>