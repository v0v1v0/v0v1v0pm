<div class="container">

<table style="width: 100%;"><tr>
<td>hull_sample</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sample Points Along a Convex Hull</h2>

<h3>Description</h3>

<p>To define a proper estimable region with multivariate exposure we construct 
a convex hull of the data in order to maintain the positivity identifying assumption.
We also provide options to create trimmed versions of the convex hull to further
restrict to high density regions in multidimensional space.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hull_sample(
  X,
  num_grid_pts = 500,
  grid_type = "regular",
  trim_hull = FALSE,
  trim_quantile = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>numeric matrix of n by m dimensions. Each row corresponds to a point in m-dimensional space.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_grid_pts</code></td>
<td>
<p>integer scalar denoting the number of parameters to 
search for over the convex hull. Default is 500.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid_type</code></td>
<td>
<p>character value indicating the type of grid to sample from
the convex hull from <code>spsample</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trim_hull</code></td>
<td>
<p>logical indicator of whether to restrict convex hull. Default is FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trim_quantile</code></td>
<td>
<p>numeric scalar between \[0.5, 1\] representing the 
quantile value to trim the convex hull. Only used if trim_hull is set to TRUE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Assume that <code class="reqn">X</code> is an <code class="reqn">n\times m</code> matrix representing the multivariate
exposure of interest. We can define the convex hull of these observations as
<strong>H</strong>. There are two distinct processes for defining <strong>H</strong> depending
on whether <code class="reqn">m=2</code> or <code class="reqn">m&gt;2</code>.
</p>
<p>If <code class="reqn">m=2</code>, we use the <code>chull</code> function to define the 
vertices of the convex hull. The algorithm implemented is described in Eddy (1977).
</p>
<p>If <code class="reqn">m&gt;2</code>, we use the <code>convhulln</code> function. This algorithm 
for obtaining the convex hull in m-dimensional space uses Qhull described in
Barber et al. (1996). Currently this function returns
only the vertex set <code>hpts_vs</code> without the grid sample points. There are
options to visualize the convex hull when <code class="reqn">m=3</code> using triangular facets,
but there are no implementable solutions to sample along convex hulls in higher
dimensions.
</p>
<p>To restrict the convex hull to higher density regions of the exposure we can 
apply trimming. To apply trimming set <code>trim_hull=TRUE</code> and specify 
<code>trim_quantile=q</code> where <code>q</code> must be in \[0.5, 1\]. Along each
exposure dimension we then calculate the upper and lower bounds using the 
<code>quantile</code> function, i.e., <code>quantile(q)</code> and 
<code>quantile(1-q)</code>. Any observations that have a value above or below these
sample quantiles is excluded. The remaining observations that fall completely 
within the sample quantiles across all dimensions are used to estimate the 
convex hull. We return <code>X</code> that represents the observations used. 
If <code>trim_hull=FALSE</code>, then <code>X</code> is unchanged. However, if trimming
is applied then <code>X</code> contains only the remaining observations after trimming.
</p>


<h3>Value</h3>


<ul>
<li> <p><code>hpts_vs</code>: vertices of the convex hull in m-dimensional space
</p>
</li>
<li> <p><code>grid_pts</code>: values of grid points sampled over the corresponding convex hull
</p>
</li>
<li> <p><code>X</code>: data used to generate convex hull which may be trimmed
</p>
</li>
</ul>
<h3>References</h3>

<p>Barber CB, Dobkin DP, Huhdanpaa H (1996).
“The quickhull algorithm for convex hulls.”
<em>ACM Transactions on Mathematical Software (TOMS)</em>, <b>22</b>(4), 469-483.<br><br> Eddy WF (1977).
“A new convex hull algorithm for planar sets.”
<em>ACM Transactions on Mathematical Software (TOMS)</em>, <b>3</b>(4), 398-403.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#generating exposure with m=3
D &lt;- matrix(unlist(lapply(seq_len(3), function(m) rnorm(100))), nrow=100)

#first using only the first two variables we can return hpts_vs and grid_pts
D_hull &lt;- hull_sample(D[, 1:2])

#when m&gt;2 we only return hpts_vs and grid_pts is NULL
D_hull_large &lt;- hull_sample(D)
is.null(D_hull_large$grid_pts)

#we can also apply trimming to the convex hull and return this reduced matrix
D_hull_trim &lt;- hull_sample(D[, 1:2], trim_hull=TRUE, trim_quantile=0.95)
dim(D_hull$X)
dim(D_hull_trim$X)

#alternatively, we can also define the number of points to sample from for grid_pts
small_grid &lt;- hull_sample(D[, 1:2], num_grid_pts=100)
length(D_hull$grid_pts)
length(small_grid$grid_pts)

</code></pre>


</div>