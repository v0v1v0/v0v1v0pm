<div class="container">

<table style="width: 100%;"><tr>
<td>rmvLSW</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sample a Multivariate Locally Stationary Wavelet Process</h2>

<h3>Description</h3>

<p>Sample a multivariate locally stationary wavelet process.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rmvLSW(Transfer = NULL, Spectrum = NULL, noiseFN = rnorm, ...)  

## S3 method for class 'mvLSW'
simulate(object, nsim = 1, seed = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Transfer</code></td>
<td>
<p>A <code>mvLSW</code> object containing the set of 
transfer function matrices of the process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Spectrum, object</code></td>
<td>
<p>A <code>mvLSW</code> object containing the 
multivariate evolutionary wavelet spectrum of the process. 
This argument is only used if <code>Transfer</code> is not supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noiseFN</code></td>
<td>
<p>The function for sampling the innovations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>Number of mvLSW time series to draw. Only 
<code>nsim = 1</code> is accepted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Seed for the random number generator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Optional arguments to be passed to the function for
sampling the innovation process.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Samples a single multivariate locally stationary wavelet time 
series for the given set of transfer function matrices. These 
are assumed to be lower-triangular (including diagonal) matrices.
If the mvEWS is supplied instead, then 
this is pre-processed by <code>Spectrum2Transfer()</code> to obtain 
the transfer function matrices.
</p>
<p>The <code>Transfer</code> and <code>Spectrum</code> are both <code>mvLSW</code> 
objects and therefore contain information about defining the 
wavelet function.
</p>
<p>The innovation process is assumed to be second order stationary 
with expectation zero, orthogonal and unit variance. The first argument 
of <code>noiseFN</code> must be <code>n</code> and define the number of samples 
to generate. The function must also return a numerical vector 
of length <code>n</code>.
</p>
<p>The <code>simulate</code> command implements <code>rmvLSW</code> under default 
arguments unless specified via <code>...</code>.
</p>


<h3>Value</h3>

<p>A <code>ts</code> matrix object of a multivariate locally stationary 
time series. The columns of the matrix correspond to different 
channels and the rows identify the time axis.
</p>


<h3>References</h3>

<p>Taylor, S.A.C., Park, T.A. and Eckley, I. (2019) Multivariate 
locally stationary wavelet analysis with the mvLSW R package.
<em>Journal of statistical software</em> <strong>90</strong>(11) pp. 1â€“16,
doi: 10.18637/jss.v090.i11.
</p>
<p>Park, T., Eckley, I. and Ombao, H.C. (2014) Estimating 
time-evolving partial coherence between signals via multivariate 
locally stationary wavelet processes. <em>Signal Processing, 
IEEE Transactions on</em> <strong>62</strong>(20) pp. 5240-5250.
</p>


<h3>See Also</h3>

<p><code>mvLSW</code>, <code>Spectrum2Transfer</code>, 
<code>rnorm</code>, <code>AvBasis</code>, <code>ts</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Define evolutionary wavelet spectrum, structure only on level 2
Spec &lt;- array(0, dim = c(3, 3, 8, 256))
Spec[1, 1, 2, ] &lt;- 10
Spec[2, 2, 2, ] &lt;- c(rep(5, 64), rep(0.6, 64), rep(5, 128))
Spec[3, 3, 2, ] &lt;- c(rep(2, 128), rep(8, 128))
Spec[2, 1, 2, ] &lt;- Spec[1, 2, 2, ] &lt;- punif(1:256, 65, 192)
Spec[3, 1, 2, ] &lt;- Spec[1, 3, 2, ] &lt;- c(rep(-1, 128), rep(5, 128))
Spec[3, 2, 2, ] &lt;- Spec[2, 3, 2, ] &lt;- -0.5

## Define Haar wavelet function and create mvLSW object
EWS &lt;- as.mvLSW(x = Spec, filter.number = 1, family = "DaubExPhase",
  min.eig.val = NA)
plot(EWS, style = 2, info = 2)

## Sample with Gaussian innovations
set.seed(10)
X &lt;- rmvLSW(Spectrum = EWS)
plot(X)

## Alternatively:
X1 &lt;- simulate(object = EWS)
plot(X1)

## Define smoother wavelet function and create mvLSW object
EWS2 &lt;- as.mvLSW(x = Spec, filter.number = 10, family = "DaubExPhase")

## Sample with logistic innovations
set.seed(10)
X2 &lt;- rmvLSW(Spectrum = EWS2, noiseFN = rlogis, scale = sqrt(3)/pi)
plot(X2)
</code></pre>


</div>