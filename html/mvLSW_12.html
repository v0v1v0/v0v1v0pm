<div class="container">

<table style="width: 100%;"><tr>
<td>Spectrum2Transfer</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Convert Between mvEWS and Transfer Function Matrices</h2>

<h3>Description</h3>

<p>Convert between multivariate evolutionary wavelet spectrum 
and the set of transfer function matrices.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  Spectrum2Transfer(object, S2V = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A <code>mvLSW</code> object containing either the mvEWS 
or matrix transfer function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S2V</code></td>
<td>
<p>Logical, if <code>TRUE</code> (default) then <code>object</code> 
is the mvEWS and the set of transfer function matrices are to 
be derived. If <code>FALSE</code> the <code>object</code> is the set of 
transfer function matrices and the converse transformation is 
derived.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If the mvEWS is supplied, then the set of transfer function matrices 
are derived by the Choleski factorization of a real symmetric 
semi-positive definite square matrix. In the cases where the matrix 
is semi-definite, then the Choleski factorization is applied to the 
submatrix that is positive definite and the remaining lower triangular 
elements are populated such that the resulting matrix is a valid 
factorization.
</p>
<p>Conversely, if the set of transfer function matrices are supplied, 
then the EWS are derived by squaring the matrices.
</p>


<h3>Value</h3>

<p>A <code>mvLSW</code> object containing either the mvEWS or set of transfer 
function matrices depending on the specified transformation 
direction.
</p>


<h3>References</h3>

<p>Taylor, S.A.C., Park, T.A. and Eckley, I. (2019) Multivariate 
locally stationary wavelet analysis with the mvLSW R package.
<em>Journal of statistical software</em> <strong>90</strong>(11) pp. 1â€“16,
doi: 10.18637/jss.v090.i11.
</p>
<p>Park, T., Eckley, I. and Ombao, H.C. (2014) Estimating 
time-evolving partial coherence between signals via multivariate 
locally stationary wavelet processes. <em>Signal Processing, 
IEEE Transactions on</em> <strong>62</strong>(20) pp. 5240-5250.
</p>


<h3>See Also</h3>

<p><code>chol</code>, <code>as.mvLSW</code>, <code>mvEWS</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Define evolutionary wavelet spectrum, structure only on level 2
Spec &lt;- array(0, dim=c(3, 3, 8, 256)) ## Ensure all are positive def.
Spec[1, 1, 2, ] &lt;- 10
Spec[2, 2, 2, ] &lt;- c(rep(5, 64), rep(0.6, 64), rep(5, 128))
Spec[3, 3, 2, ] &lt;- c(rep(2, 128), rep(8, 128))
Spec[2, 1, 2, ] &lt;- Spec[1, 2, 2, ] &lt;- punif(1:256, 65, 192)
Spec[3, 1, 2, ] &lt;- Spec[1, 3, 2, ] &lt;- c(rep(-1, 128), rep(5, 128))
Spec[3, 2, 2, ] &lt;- Spec[2, 3, 2, ] &lt;- -0.5

## Define EWS as mvLSW object
EWS &lt;- as.mvLSW(x = Spec, filter.number = 1, family = "DaubExPhase",
  min.eig.val = NA)
plot(EWS, style = 2, info = 2)

## EWS to Transfer function matrices
Transfer &lt;- Spectrum2Transfer(object = EWS, S2V = TRUE)

## Transfer function matrices to EWS
EWS2 &lt;- Spectrum2Transfer(object = Transfer, S2V = FALSE)
plot(EWS2, style = 2, info = 2)
</code></pre>


</div>