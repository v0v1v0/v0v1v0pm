<div class="container">

<table style="width: 100%;"><tr>
<td>varEWS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Asymptotic Variance of the mvEWS Estimate</h2>

<h3>Description</h3>

<p>Calculates the asymptotic variance of a multivariate 
evolutionary wavelet spectrum estimate.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  varEWS(object, ACWIP = NULL, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A <code>mvLSW</code> object containing the multivariate 
evolutionary wavelet spectrum. Matrices must be positive definite, 
i.e. information item <code>min.eig.val</code> must be greater than zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ACWIP</code></td>
<td>
<p>4D array containing the wavelet autocorrelation
inner product functions. Set to <code>NULL</code> by default and 
therefore evaluated within the command based on the 
information supplied by <code>object</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical. Controls the printing of messages whist 
the computations progress. Set as <code>FALSE</code> as default.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>varEWS</code> commands evaluate the asymptotic variance of a 
multivariate evolutionary wavelet spectrum (mvEWS) estimate. Note, 
the variance is only applicable when the mvEWS is smoothed 
consistently across all levels with list item <code>smooth.type="all"</code>.
This can be written in terms of the smoothed 
periodogram relating to the bias correction of the mvEWS estimate, 
where <code class="reqn">A_{j,k}</code> is the inner product matrix of the wavelet 
autocorrelation function:
</p>
<p style="text-align: center;"><code class="reqn">Var( \hat{S}^{(p,q)}_{j,k} ) 
    = \sum_{l_1,l_2=1}^{J} (A^{-1})_{j,l_1} (A^{-1})_{j,l_2} 
	Cov( \tilde{I}^{(p,q)}_{l_1,k}, \tilde{I}^{(p,q)}_{l_1,k})</code>
</p>

<p>The covariance between elements of the smoothed periodogram can also 
be expressed in terms of the raw wavelet periodogram:
</p>
<p style="text-align: center;"><code class="reqn">Cov( \tilde{I}^{(p,q)}_{l_1,k}, \tilde{I}^{(p,q)}_{l_1,k}) 
    = \sum_{m_1,m_2} W_{m_1} W_{m_2} Cov( I^{(p,q)}_{l_1,m_1}, 
	  I^{(p,q)}_{l_2,m_2} )</code>
</p>

<p>The weights <code class="reqn">W_i</code>, for integer i, define the smoothing kernel function 
that is evaluated by the <code>kernel</code> command. Note that <code class="reqn">W_i = W_{-i}</code>
and <code class="reqn">\sum_i W_i = 1</code>.
</p>
<p>The final step is to derive the covariance of the raw periodogram. This has 
a long derivation, which can be concisely calculated by:
</p>
<p style="text-align: center;"><code class="reqn">Cov( I^{(p,q)}_{j,k}, I^{(p,q)}_{l,m} ) 
    = E(p,j,k,q,l,m)^2 + E(p,j,k,p,l,m)E(q,j,k,q,l,m)</code>
</p>

<p>where	
</p>
<p style="text-align: center;"><code class="reqn">E(p,j,k,q,l,m) = \sum_{h=1}^{J} A^{k-m}_{j,l,h} S^{(p,q)}_h((k+m)/2T) </code>
</p>

<p>Here, <code class="reqn">A^{\lambda}_{j,l,h}</code> defines the autocorrelation 
wavelet inner product function and <code class="reqn">S^{(p,q)}_{j}(k/T)</code> 
is the true spectrum of the process between channels p &amp; q, 
level j and location k. The true spectrum is not always available 
and so this may be substituted with the smoothed and bias corrected 
mvEWS estimate. For practical purposes, if k+m is odd then the 
average between the available spectrum values at neighbouring 
locations are substituted.
</p>
<p>For efficiency purpose, if the <code>varEWS</code> command is going to 
be called multiple times then it is highly recommended that the 
autocorrelation wavelet inner product should be evaluated beforehand 
by <code>AutoCorrIP</code> and supplied via the <code>ACWIP</code> argument.
</p>


<h3>Value</h3>

<p>Invisibly returns a <code>mvLSW</code> object containing the asymptotic variance 
of the multivariate evolutionary wavelet spectrum.
</p>


<h3>References</h3>

<p>Taylor, S.A.C., Park, T.A. and Eckley, I. (2019) Multivariate 
locally stationary wavelet analysis with the mvLSW R package.
<em>Journal of statistical software</em> <strong>90</strong>(11) pp. 1â€“16,
doi: 10.18637/jss.v090.i11.
</p>




<p>Park, T. (2014) Wavelet Methods for Multivariate Nonstationary 
Time Series, PhD thesis, Lancaster University, pp. 91-111.
</p>


<h3>See Also</h3>

<p><code>ipndacw</code>, <code>AutoCorrIP</code>, 
<code>as.mvLSW</code>, <code>mvEWS</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Define evolutionary wavelet spectrum, structure only on level 2
Spec &lt;- array(0, dim=c(3, 3, 8, 256))
Spec[1, 1, 2, ] &lt;- 10
Spec[2, 2, 2, ] &lt;- c(rep(5, 64), rep(0.6, 64), rep(5, 128))
Spec[3, 3, 2, ] &lt;- c(rep(2, 128), rep(8, 128))
Spec[2, 1, 2, ] &lt;- Spec[1, 2, 2, ] &lt;- punif(1:256, 65, 192)
Spec[3, 1, 2, ] &lt;- Spec[1, 3, 2, ] &lt;- c(rep(-1, 128), rep(5, 128))
Spec[3, 2, 2, ] &lt;- Spec[2, 3, 2, ] &lt;- -0.5
EWS &lt;- as.mvLSW(x = Spec, filter.number = 1, family = "DaubExPhase",
  min.eig.val = NA)

## Sample time series and estimate the EWS.
set.seed(10)
X &lt;- rmvLSW(Spectrum = EWS)
EWS_X &lt;- mvEWS(X, kernel.name = "daniell", kernel.param = 20)

## Evaluate asymptotic spectral variance 
SpecVar &lt;- varEWS(EWS_X)

## Plot Estimate &amp; 95% confidence interval
CI &lt;- ApxCI(object = EWS_X, var = SpecVar, alpha = 0.05)
plot(x = EWS_X, style = 2, info = 2, Interval = CI)
</code></pre>


</div>