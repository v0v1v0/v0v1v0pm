<div class="container">

<table style="width: 100%;"><tr>
<td>AutoCorrIP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Wavelet Autocorrelation Inner Product Functions</h2>

<h3>Description</h3>

<p>Inner product of cross-level wavelet autocorrelation functions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  AutoCorrIP(J, filter.number = 1, family = "DaubExPhase",
    crop = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>J</code></td>
<td>
<p>Number of levels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter.number</code></td>
<td>
<p>Number of vanishing moments of the wavelet function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>Wavelet family, either <code>"DaubExPhase"</code> 
or <code>"DaubLeAsymm"</code>. The Haar wavelet is defined as default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crop</code></td>
<td>
<p>Logical, should the output of <code>AutoCorrIP</code> be 
cropped such that the first dimension of the returned array relate 
to the offset range -<code class="reqn">2^J</code>:<code class="reqn">2^J</code>.This is set at <code>TRUE</code> 
by default.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Let <code class="reqn">\psi(x)</code> denote the mother wavelet and the wavelet 
defined for level j as <code class="reqn">\psi_{j,k}(x) = 2^{j/2}\psi(2^{j}x-k)</code>.
The wavelet autocorrelation function between levels j &amp; l 
is therefore:
</p>
<p style="text-align: center;"><code class="reqn">\Psi_{j,l}(\tau) = \sum_\tau \psi_{j,k}(0)\psi_{l,k-\tau}(0)</code>
</p>

<p>Here, integer <code class="reqn">\tau</code> defines the offset of the latter 
wavelet function relative to the first.
</p>
<p>The inner product of this wavelet autocorrelation function is 
defined as follows for level indices j, l &amp; h and offset <code class="reqn">\lambda</code>:
</p>
<p style="text-align: center;"><code class="reqn">A^{\lambda}_{j,l,h} = \sum_{\tau} \Psi_{j,l}(\lambda - \tau) \Psi_{h,h}(\tau)</code>
</p>



<h3>Value</h3>

<p>A 4D array (invisibly returned) of order 
LxJxJxJ where L depends on the specified wavelet function. 
If <code>crop=TRUE</code> then L=<code class="reqn">2^{J+1}</code>+1. The first dimension 
defines the offset <code class="reqn">\lambda</code>, whilst the second to 
fourth dimensions identify the levels indexed by j, l &amp; h 
respectively.
</p>


<h3>References</h3>

<p>Taylor, S.A.C., Park, T.A. and Eckley, I. (2019) Multivariate 
locally stationary wavelet analysis with the mvLSW R package.
<em>Journal of statistical software</em> <strong>90</strong>(11) pp. 1â€“16,
doi: 10.18637/jss.v090.i11. 
</p>
<p>Fryzlewicz, P. and Nason, G. (2006) HaarFisz estimation of 
evolutionary wavelet spectra. <em>Journal of the Royal 
Statistical Society. Series B</em>, <strong>68</strong>(4) pp. 611-634.
</p>


<h3>See Also</h3>

<p><code>ipndacw</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Plot Haar autocorrelation wavelet functions inner product
AInnProd &lt;- AutoCorrIP(J = 8, filter.number = 1, family = "DaubExPhase")
## Not run: 
MaxOffset &lt;- 2^8
for(h in 6:8){
  x11()
  par(mfrow = c(3, 3))
  for(l in 6:8){
    for(j in 6:8){
      plot(-MaxOffset:MaxOffset, AInnProd[, j, l, h], type = "l", 
        xlab = "lambda", ylab = "Autocorr Inner Prod", 
        main = paste("j :", j, "- l :", l, "- h :", h))
    }
  }
}

## End(Not run)

## Special case relating to ipndacw function from wavethresh package
Amat &lt;- matrix(NA, ncol = 8, nrow = 8)
for(j in 1:8) Amat[, j] &lt;- AInnProd[2^8 + 1, j, j, ]
round(Amat, 5)
round(ipndacw(J = -8, filter.number = 1, family = "DaubExPhase"), 5)
</code></pre>


</div>