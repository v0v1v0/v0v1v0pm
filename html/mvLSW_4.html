<div class="container">

<table style="width: 100%;"><tr>
<td>coherence</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Local Wavelet Coherence and Partial Coherence</h2>

<h3>Description</h3>

<p>Wavelet coherence and partial coherence of an evolutionary 
wavelet spectrum.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  coherence(object, partial = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>Multivariate evolutionary wavelet spectrum as a
<code>mvLSW</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>partial</code></td>
<td>
<p>Logical, should the partial coherence be 
calculated. Set as <code>FALSE</code> by default.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given the evolutionary wavelet spectrum of a multivariate locally 
stationary time series, denoted by the matrix sequence <code class="reqn">S_{j,k}</code>, 
then the coherence matrix for level j and location k is:
</p>
<p style="text-align: center;"><code class="reqn">R_{j,k} = D_{j,k} S_{j,k} D_{j,k}</code>
</p>

<p>where <code class="reqn">D_{j,k} = diag\{ (S^{(p,p)}_{j,k})^{-0.5} : p=1,\ldots,P \}</code>.
This measures the linear cross-dependence between different 
channels at a particular level. 
</p>
<p>Notate the inverse spectrum matrix as <code class="reqn">G_{j,k} = S^{-1}_{j,k}</code>, 
then the partial coherence matrix for level j and location k is 
derived as follows:
</p>
<p style="text-align: center;"><code class="reqn">\Gamma_{j,k} = -H_{j,k} G_{j,k} H_{j,k}</code>
</p>

<p>where <code class="reqn">H_{j,k} = diag\{ (G^{(p,p)}_{j,k})^{-0.5} : p=1,\ldots,P \}</code>.
This measures the coherence between channels after removing the 
linear effects if all other channels and so enable the distinction 
between direct and indirect linear dependency between channels.
</p>
<p>For valid calculations of (partial) coherence, values within [-1,1], 
it is important that the spectral matrices are positive definite.
</p>


<h3>Value</h3>

<p>An object of class <code>mvLSW</code>, invisibly.
</p>


<h3>References</h3>

<p>Taylor, S.A.C., Park, T.A. and Eckley, I. (2019) Multivariate 
locally stationary wavelet analysis with the mvLSW R package.
<em>Journal of statistical software</em> <strong>90</strong>(11) pp. 1â€“16,
doi: 10.18637/jss.v090.i11.
</p>
<p>Park, T., Eckley, I. and Ombao, H.C. (2014) Estimating 
time-evolving partial coherence between signals via multivariate 
locally stationary wavelet processes. <em>Signal Processing, 
IEEE Transactions on</em> <strong>62</strong>(20) pp. 5240-5250.
</p>


<h3>See Also</h3>

<p><code>as.mvLSW</code>, <code>mvEWS</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Sample tri-variate time series
##  Series 2 &amp; 3 are dependent indirectly via Series 1
set.seed(100)
X &lt;- matrix(rnorm(3 * 2^8), ncol = 3)
X[1:192, 2] &lt;- X[1:192, 2] + 0.95 * X[1:192, 1]
X[65:256, 3] &lt;- X[65:256, 3] - 0.95 * X[65:256, 1]
X &lt;- as.ts(X)

## Evolutionary Wavelet Spectrum
EWS &lt;- mvEWS(X, filter.number = 4, kernel.name = "daniell", 
  kernel.param = 20)

## Coherence
RHO &lt;- coherence(EWS, partial = FALSE)
plot(RHO, style = 2, info = 1, ylab = "Coherence", diag = FALSE)

## Partial Coherence
PRHO &lt;- coherence(EWS, partial = TRUE)
plot(PRHO, style = 2, info = 1, ylab = "P. Coh.", diag = FALSE) 
#series 2&amp;3 are closer to 0
</code></pre>


</div>