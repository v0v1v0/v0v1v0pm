<div class="container">

<table style="width: 100%;"><tr>
<td>smooth_per</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function to smooth the raw wavelet periodogram using the default <code>mvLSW</code> routine.</h2>

<h3>Description</h3>

<p>This function smooths the raw wavelet periodogram, similar to the <code>mvEWS</code> function in the <span class="pkg">mvLSW</span> package, except acting on the raw periodogram directly.  See
<code>mvEWS</code> for more details.  Note: this function is not really intended to be used separately, but internally within the <code>spec_estimation</code> function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">smooth_per(RawPer, type = "all", kernel.name="daniell", optimize = FALSE, kernel.param =
                 NULL, smooth.Jset = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>RawPer</code></td>
<td>
<p>Raw wavelet periodogram that is to be smoothed, can be either a 4D array or a <code>mvLSW</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Determines the type of smoothing to be performed, if <code>"all"</code> then the same smoothing kernel is applied to all levels, if <code>"by.level"</code> then a different smoothing kernel is applied to each level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel.name</code></td>
<td>
<p>Name of the smoothing kernel to be applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimize</code></td>
<td>
<p>Should the smoothing be optimized. If <code>FALSE</code> then smoothing is carried out with <code>kernel.name</code> and <code>kernel.param</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel.param</code></td>
<td>
<p>Value of the smoothing kernel parameter to be applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth.Jset</code></td>
<td>
<p>Vector indicating which levels should be used in the calculation of the optimal kernel parameter. By default all levels are used.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a <code>mvLSW</code> object containing the smoothed EWS of a multivariate locally stationary time series.
</p>


<h3>Author(s)</h3>

<p>Rebecca Wilson
</p>


<h3>References</h3>

<p>Taylor, S.A.C., Park, T.A. and Eckley, I. (2019) Multivariate locally stationary wavelet analysis with the mvLSW R package.
_Journal of Statistical Software_ *90*(11) pp. 1-16, doi:10.18637/jss.v090.i11.<br><br></p>
<p>Park, T., Eckley, I. and Ombao, H.C. (2014) Estimating time-evolving partial coherence between signals via multivariate
locally stationary wavelet processes. _IEEE Transactions on Signal Processing_ *62*(20) pp. 5240-5250.
</p>


<h3>See Also</h3>

<p><code>mvEWS</code>, <code>spec_estimation</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Sample bivariate locally stationary time series

set.seed(1)
X &lt;- matrix(rnorm(2 * 2^8), ncol = 2)
X[1:2^7, 2] &lt;- 3 * (X[1:2^7, 2] + 0.95 * X[1:2^7, 1])
X[-(1:2^7), 2] &lt;- X[-(1:2^7), 2] - 0.95 * X[-(1:2^7), 1]
X[-(1:2^7), 1] &lt;- X[-(1:2^7), 1] * 4
X &lt;- as.ts(X)

# form periodogram
tmp = apply(X, 2, function(x){haarWT(x)$D})
D = array(t(tmp), dim = c(2, 2^8, 8))

#sqrv &lt;- function(d) return( d %*% t(d) )

#RawPer = array(apply(D, c(2, 3), sqrv), dim = c(2, 2, 2^8, 8))
RawPer = array(apply(D, c(2, 3), tcrossprod), dim = c(2, 2, 2^8, 8))
RawPer = aperm(RawPer, c(1, 2, 4, 3))

# now smooth

smoothper = smooth_per(RawPer)

</code></pre>


</div>