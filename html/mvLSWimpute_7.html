<div class="container">

<table style="width: 100%;"><tr>
<td>mv_impute</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function to apply the mvLSWimpute method and impute missing values in a multivariate locally stationary time series</h2>

<h3>Description</h3>

<p>This function applies the mvLSWimpute method to impute missing values in a multivariate locally stationary time series. The imputation can be based on forecasts only or use information from both a forecasting and backcasting step.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mv_impute(data, p = 2, type = "forward", index = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Input multivariate time series, matrix of dimension TxP where P is the number of channels and T is the length of the series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>The number of terms to include in the clipped predictor when carrying out one step ahead forecasting/backcasting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>The type of imputation to carry out, either <code>"forward"</code> or <code>"forward-backward"</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p>The set of time indices containing missing values, this is <code>NULL</code> by default and will be determined from the input series.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list containing the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>ImputedData</code></td>
<td>
<p>Matrix containing the imputed time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missing.index</code></td>
<td>
<p>Vector containing the set of time indices that have missing values.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>As with other time series imputation methods, <code>mv_impute</code> requires some data values at the start of the series.  In this case, we need 5 time points.
</p>


<h3>Author(s)</h3>

<p>Rebecca Wilson
</p>


<h3>References</h3>

<p>Wilson, R. E., Eckley, I. A., Nunes, M. A. and Park, T. (2021) A wavelet-based approach	for imputation in nonstationary multivariate time series.
_Statistics and Computing_ *31* Article 18, doi:10.1007/s11222-021-09998-2.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
X &lt;- matrix(rnorm(2 * 2^8), ncol = 2)
X[1:2^7, 2] &lt;- 3 * (X[1:2^7, 2] + 0.95 * X[1:2^7, 1])
X[-(1:2^7), 2] &lt;- X[-(1:2^7), 2] - 0.95 * X[-(1:2^7), 1]
X[-(1:2^7), 1] &lt;- X[-(1:2^7), 1] * 4
X &lt;- as.ts(X)

# create some fake missing data, taking care not to have missingness hear the start of the series
missing.index = sort(sample(10:2^8, 30))

X[missing.index, ] &lt;- NA

newdata = mv_impute(X)

</code></pre>


</div>