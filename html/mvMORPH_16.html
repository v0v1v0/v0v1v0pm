<div class="container">

<table style="width: 100%;"><tr>
<td>mvEB</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Multivariate Early Burst model of continuous traits evolution

</h2>

<h3>Description</h3>

<p>This function fits to a multivariate dataset of continuous traits a multivariate Early Burst (EB) or ACDC models of evolution.

</p>


<h3>Usage</h3>

<pre><code class="language-R">mvEB(tree, data, error = NULL, param = list(up = 0), method = 
	c("rpf", "sparse", "inverse", "pseudoinverse", "pic"), scale.height =
	 FALSE, optimization = c("Nelder-Mead", "L-BFGS-B", "subplex"), 
	 control = list(maxit = 20000), precalc = NULL, diagnostic = TRUE, 
	 echo = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>

<p>Phylogenetic tree (phylo object).

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>Matrix or data frame with species in rows and continuous traits in columns (preferentially with names and in the same order than in the tree). NA values are allowed with the "rpf", "inverse", and "pseudoinverse" methods.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error</code></td>
<td>

<p>Matrix or data frame with species in rows and continuous trait sampling variance (squared standard errors) in columns.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>

<p>List of arguments to be passed to the function. See details.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>Choose between "rpf", "sparse", "inverse", "pseudoinverse", or "pic" for computing the log-likelihood during the fitting process. See details.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.height</code></td>
<td>

<p>Whether the tree should be scaled to unit length or not.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimization</code></td>
<td>

<p>Methods used by the optimization routines (see ?optim and ?subplex for details). The "fixed" method returns the log-likelihood function only.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>

<p>Max. bound for the number of iteration of the optimizer; other options can be fixed in the list (see ?optim or ?subplex for details).

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>precalc</code></td>
<td>

<p>Optional. Precalculation of fixed parameters. See ?mvmorph.Precalc for details.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diagnostic</code></td>
<td>

<p>Whether the diagnostics of convergence should be returned or not.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>echo</code></td>
<td>

<p>Whether the results must be returned or not.

</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Early Burst model (Harmon et al. 2010) is a special case of the ACDC model of Blomberg et al. (2003). Using an upper bound larger than zero transform the EB model to the accelerating rates of character evolution of Blomberg et al. (2003).
</p>
<p>The "method" argument allows the user to try different algorithms for computing the log-likelihood. The "rpf" and "sparse" methods use fast GLS algorithms based on factorization for avoiding the computation of the inverse of the variance-covariance matrix and its determinant for the log-likelihood estimation. The "inverse" approach uses the "stable" standard explicit computation of the inverse and determinant of the matrix and is therefore slower. The "pseudoinverse" method uses a generalized inverse that is safer for matrix near singularity but highly time consuming. The "pic" method uses a very fast algorithm based on independent contrasts. See ?mvLL for more details on these computational methods.
</p>
<p>The "param" list can be used to set the lower (low) and upper (up, default value is 0 - i.e., Early Burst model) bounds for the estimation of the exponential rate (beta). The default lower bound for decelerating rates (as assumed in Early Burst) is fixed as log(min.rate) / T, where T is the depth of the tree and min.rate is the minimum rate that could be assumed for the model (following Slater and Pennell, 2014; log(10^-5)/T). Bounds may need to be adjusted by the user for specific cases.
</p>
<p>Starting values for "sigma" and "beta" could also be provided through the "param" list.

</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>LogLik </code></td>
<td>
<p>The log-likelihood of the optimal model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AIC </code></td>
<td>
<p>Akaike Information Criterion for the optimal model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AICc </code></td>
<td>
<p>Sample size-corrected AIC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta </code></td>
<td>
<p>Estimated ancestral states.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta </code></td>
<td>
<p>Exponent rate (of decay or increase).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma </code></td>
<td>
<p>Evolutionary rate matrix for each selective regimes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence </code></td>
<td>
<p>Convergence status of the optimizing function; "0" indicates convergence (see ?optim for details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hess.values </code></td>
<td>
<p>Reliability of the likelihood estimates calculated through the eigen-decomposition of the hessian matrix. "0" means that a reliable estimate has been reached. (see ?mvOU for details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param </code></td>
<td>
<p>List of model fit parameters (optimization, method, model, number of parameters...).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>llik </code></td>
<td>
<p>The log-likelihood function evaluated in the model fit "$llik(par, root.mle=TRUE)".</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The derivative-free "Nelder-Mead" optimization method is used as default setting instead of "L-BFGS-B".

</p>


<h3>Author(s)</h3>

<p>Julien Clavel

</p>


<h3>References</h3>

<p>Blomberg S.P., Garland T.J., Ives A.R. 2003. Testing for phylogenetic signal in comparative data: behavioral traits are more labile. Evolution. 57:717-745.
</p>
<p>Clavel J., Escarguel G., Merceron G. 2015. mvMORPH: an R package for fitting multivariate evolutionary models to morphometric data. Methods Ecol. Evol. 6(11):1311-1319.
</p>
<p>Harmon L.J., Losos J.B., Davies J.T., Gillespie R.G., Gittleman J.L., Jennings B.W., Kozak K.H., McPeek M.A., Moreno-Roark F., Near T.J., Purvis A., Ricklefs R.E., Schluter D., Schulte II J.A., Seehausen O., Sidlauskas B.L., Torres-Carvajal O., Weir J.T., Mooers A.O. 2010. Early bursts of body size and shape evolution are rare in comparative data. Evolution. 64:2385-2396.
</p>
<p>Slater G.J., Pennell M. 2014. Robust regression and posterior predictive simulation increase power to detect early bursts of trait evolution. Syst. Biol. 63: 293-308.

</p>


<h3>See Also</h3>

<p><code>mvMORPH</code>
<code>mvgls</code>
<code>mvOU</code>
<code>mvBM</code>
<code>mvSHIFT</code>
<code>mvOUTS</code>
<code>mvRWTS</code>
<code>mvSIM</code>
<code>optim</code>
</p>



<h3>Examples</h3>

<pre><code class="language-R"># Simulated dataset
set.seed(14)
# Generating a random tree
tree&lt;-pbtree(n=50, scale=10)

# Simulate the traits
sigma&lt;-matrix(c(0.1,0.05,0.05,0.1),2)
theta&lt;-c(0,0)
beta&lt;- -0.34 # 5 phylogenetic half-life ( log(2)/ (10/5) )
data&lt;-mvSIM(tree, param=list(sigma=sigma, beta=beta, ntraits=2, theta=theta,
            names_traits=c("head.size","mouth.size")), model="EB", nsim=1)

## Fitting the models
mvEB(tree, data)
mvEB(tree, data, method="pic")
mvEB(tree, data, method="pic", param=list(low=log(10^-5)/10)) # avoid internal estimation

# ACDC
# Note that the AC model is not differentiable from an OU model on ultrametric trees.
beta&lt;- 0.34
data&lt;-mvSIM(tree, param=list(sigma=sigma, beta=beta, ntraits=2, theta=theta,
            names_traits=c("head.size","mouth.size")), model="EB", nsim=1)

fit&lt;-mvEB(tree, data, method="pic", param=list(up=2, low=-2))

logLik(fit)
AIC(fit)
summary(fit)

</code></pre>


</div>