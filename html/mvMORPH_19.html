<div class="container">

<table style="width: 100%;"><tr>
<td>mvgls.pca</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Principal Component Analysis (PCA) based on GLS (or OLS) estimate of the traits variance-covariance matrix (possibly regularized)
</h2>

<h3>Description</h3>

<p>Performs a principal component analysis (PCA) on a regularized variance-covariance matrix obtained using the <code>mvgls</code> or the <code>mvols</code> function. With "evolutionary" models in <code>mvgls</code>, this performs the so-called phylogenetic PCA.</p>


<h3>Usage</h3>

<pre><code class="language-R">
mvgls.pca(object, plot=TRUE, ...)
  
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>A model fit obtained by the <code>mvgls</code> or <code>mvols</code> function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>

<p>Plot of the PC's axes. Default is TRUE (see details).'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Options to be passed through. (e.g., <code>axes=c(1,2)</code>, <code>col</code>, <code>pch</code>, <code>cex</code>, <code>mode="cov"</code> or <code>"corr"</code>, etc.)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>mvgls.pca</code> allows computing a principal component analysis based on a GLS (or OLS) estimate of the covariance matrix (see <code>mvgls</code> and <code>mvols</code>). The phylogenetic PCA (following Revell 2009) is a special case obtained from the (possibly regularized) evolutionary variance-covariance matrix (see also the <code>phyl.pca_pl</code> function in RPANDA). In the high-dimensional case the contribution of the firsts PC axes tend to be overestimated with traditional maximum likelihood approaches. Penalized/regularized model fit reduce this bias and allow incorporating various residuals structures (see Clavel et al. 2019).
Plotting options, the number of axes to display (<code>axes=c(1,2)</code> is the default), and whether the covariance (<code>mode="cov"</code>) or correlation (<code>mode="corr"</code>) should be used can be specified through the ellipsis "<code>...</code>" argument.
</p>


<h3>Value</h3>

<p>a list with the following components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p>the PC scores</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>values</code></td>
<td>
<p>the eigenvalues of the variance-covariance matrix estimated by mvgls or mvols</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vectors</code></td>
<td>
<p>the eigenvectors of the variance-covariance matrix estimated by mvgls or mvols</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank</code></td>
<td>
<p>the rank of the estimated variance-covariance matrix</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Contrary to conventional PCA (for instance using <code>mvols</code> with "LL" method), the principal axes of the gls PCA are not orthogonal, they represent the main axes of independent (according to a given phylogenetic or time-series model) evolutionary changes.</p>


<h3>Author(s)</h3>

<p>J. Clavel</p>


<h3>References</h3>

<p>Clavel, J., Aristide, L., Morlon, H., 2019. A Penalized Likelihood framework for high-dimensional phylogenetic comparative methods and an application to new-world monkeys brain evolution. Systematic Biology 68(1): 93-116.
</p>
<p>Revell, L.J., 2009. Size-correction and principal components for intraspecific comparative studies. Evolution, 63:3258-3268.
</p>


<h3>See Also</h3>

<p><code>mvgls</code>,
<code>mvols</code>,
<code>GIC</code>,
<code>EIC</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
set.seed(1)
n &lt;- 32 # number of species
p &lt;- 30 # number of traits

tree &lt;- pbtree(n=n) # phylogenetic tree
R &lt;- crossprod(matrix(runif(p*p),p))  # a random symmetric matrix (covariance)

# simulate a dataset
Y &lt;- mvSIM(tree, model="BM1", nsim=1, param=list(sigma=R))

# The conventional phylogenetic PCA
phylo_pca &lt;- mvgls(Y~1, tree=tree, model="BM", method="LL")
mvgls.pca(phylo_pca, plot=TRUE) 




# fit a multivariate Pagel lambda model with Penalized likelihood
fit &lt;- mvgls(Y~1, tree=tree, model="lambda", method="LOO", penalty="RidgeAlt")

# Perform a regularized phylogenetic PCA using the model fit (Pagel lambda model)
pca_results &lt;- mvgls.pca(fit, plot=TRUE) 

# retrieve the scores
head(pca_results$scores)

</code></pre>


</div>