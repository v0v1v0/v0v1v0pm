<div class="container">

<table style="width: 100%;"><tr>
<td>ancestral</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Estimation of traits ancestral states.
</h2>

<h3>Description</h3>

<p>Reconstruct the ancestral states at each node of a phylogenetic tree from models fit obtained using the <code>mvgls</code> function. For models of the class <code>mvXX</code> this is a wrapper to the function <code>estim</code></p>


<h3>Usage</h3>

<pre><code class="language-R">
ancestral(object, ...)
  
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>A model fit object obtained by the <code>mvgls</code> function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Further options to be passed through. For instance, if a regression model is used, values for the predictor(s) at each node of the tree should be given in a matrix to the <code>newdata</code> argument. If a model of the type <code>mvXX</code> is used, the argument <code>tree</code> and <code>data</code> should be provided like in <code>estim</code> function.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>ancestral</code> is an S3 method that reconstruct the ancestral states at each nodes of a phylogenetic tree from the models fit obtained by the <code>mvgls</code> function (Clavel et al. 2019). Ancestral states are estimated using generalized least squares (GLS; Martins &amp; Hansen 1997, Cunningham et al. 1998 ). Note that when a regression model (rather than an intercept only model of the form Y~1) is provided, an argument "newdata" with a matrix of regressor values for each node should be provided (similar to what is done in the "predict" function). 
</p>


<h3>Value</h3>

<p>a matrix of reconstructed ancestral states for each node (note that the numerotation of the ancestral states starts at "N+1" [for the root], where N is the number of species in the tree)
</p>


<h3>Note</h3>

<p>The function is similar to the one used with <code>fit_t_pl</code> from the RPANDA package (Clavel et al. 2019).</p>


<h3>Author(s)</h3>

<p>J. Clavel</p>


<h3>References</h3>

<p>Clavel, J., Aristide, L., Morlon, H., 2019. A Penalized Likelihood framework for high-dimensional phylogenetic comparative methods and an application to new-world monkeys brain evolution. Syst. Biol. 68: 93-116.
</p>
<p>Cunningham C.W., Omland K.E., Oakley T.H. 1998. Reconstructing ancestral character states: a critical reappraisal. Trends Ecol. Evol. 13:361-366.
</p>
<p>Martins E.P., Hansen T.F. 1997. Phylogenies and the comparative method: a general approach to incorporating phylogenetic information into the analysis of interspecific data. Am. Nat. 149:646-667.
</p>


<h3>See Also</h3>

<p><code>mvgls</code>, 
<code>estim</code>,
<code>predict.mvgls</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

set.seed(1)
n &lt;- 32 # number of species
p &lt;- 5 # number of traits

tree &lt;- pbtree(n=n, scale=1) # phylogenetic tree
R &lt;- crossprod(matrix(runif(p*p), ncol=p)) # a random covariance matrix
# simulate a BM dataset
Y &lt;- mvSIM(tree, model="BM1", nsim=1, param=list(sigma=R, theta=rep(0,p))) 
data=list(Y=Y)

fit &lt;- mvgls(Y~1, data=data, tree, model="BM", method="LL")

# Perform the ancestral states reconstruction
anc &lt;- ancestral(fit)

# retrieve the ancestral states
head(anc)


</code></pre>


</div>