<div class="container">

<table style="width: 100%;"><tr>
<td>dfaShape</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Projection of 2D and 3D shapes (from geometric morphometric datasets) on Discriminant axes
</h2>

<h3>Description</h3>

<p>The function extracts the shape changes along discriminant axes computed by a DFA (<code>mvgls.dfa</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">
dfaShape(object, reference, axis=1, ndim=3, spp=NULL, scaling=1, plot=FALSE, ...)  

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>A discriminant analysis obtained by the <code>mvgls.dfa</code> function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reference</code></td>
<td>

<p>The reference shape used to compare the deformations. Usually the mean shape.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis</code></td>
<td>

<p>The discriminant axis on which morphological changes are projected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndim</code></td>
<td>

<p>The number of dimensions of the GMM data set (2 for 2D and 3 for 3D).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spp</code></td>
<td>

<p>Names of the species (should match names in the dataset) shape to project onto the PC axis. If null, the two extreme shapes along <code>axis</code> are reported.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaling</code></td>
<td>

<p>An arbitrary factor used to multiply the effects (for better visualization)  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>

<p>Should the projected landmarks be plotted?  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Further options.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function will project the shape changes along discriminant axes obtained from a DFA by <code>mvgls.dfa</code>.  This can be used to display morphological changes (for 2D and 3D geometric morphometric data) that best separate individuals from distinct groups.
</p>


<h3>Value</h3>

<p>a list with 2D or 3D coordinates for the shape projected on the selected PC axis.
</p>


<h3>Author(s)</h3>

<p>J. Clavel</p>


<h3>References</h3>

<p>Claude, J., 2008. Morphometrics with R. Springer Science.
</p>
<p>Clavel, J., Aristide, L., Morlon, H., 2019. A Penalized Likelihood framework for high-dimensional phylogenetic comparative methods and an application to new-world monkeys brain evolution. Systematic Biology 68(1): 93-116.
</p>


<h3>See Also</h3>

<p><code>mvgls</code>,
<code>mvols</code>,
<code>mvgls.dfa</code>
<code>pcaShape</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(phyllostomid)

# Fit a linear model by PL
fit &lt;- mvgls(mandible[,-1]~grp1, data=phyllostomid, phyllostomid$tree, model="lambda", method="PL") 

# Discriminant analysis
da &lt;- mvgls.dfa(fit)

# Project the mandible shape extremes on the first discriminant axe
proj_shape &lt;- dfaShape(da, reference=coef(fit), axis=1, ndim=2, plot=TRUE)

polygon(proj_shape$min)
polygon(proj_shape$max, border="red")


</code></pre>


</div>