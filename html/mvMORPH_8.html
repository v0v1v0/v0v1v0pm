<div class="container">

<table style="width: 100%;"><tr>
<td>estim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Ancestral states reconstructions and missing value imputation with phylogenetic/time-series models

</h2>

<h3>Description</h3>

<p>This function imputes the missing cases (NA values) according to a given phylogenetic model (object of class "mvmorph"); it can also do ancestral state reconstruction.

</p>


<h3>Usage</h3>

<pre><code class="language-R">estim(tree, data, object, error=NULL, asr=FALSE)
</code></pre>


<h3>Arguments</h3>

 
<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>

<p>Phylogenetic tree (an object of class "phylo" or "simmap") or a time-series.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>Matrix or data frame with species in rows and continuous traits with missing cases (NA values) in columns (preferentially with names and in the same order than in the tree).

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>A fitted object from an mvMORPH model (class "mvmorph").

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error</code></td>
<td>

<p>Matrix or data frame with species in rows and continuous traits sampling variance (squared standard errors) in columns.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asr</code></td>
<td>

<p>If asr=TRUE, the ancestral states are estimated instead of the missing cases.

</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Missing observations for species in a phylogenetic tree are estimated according to a given evolutionary model (and parameters). Multivariate models are useful to recover the variance and covariance structure of the dataset to be imputed.
</p>
<p>When <em>asr=TRUE</em>, the estimates, their variances and standard errors are those of the ancestral states at each node of the tree (this option is not available for the time-series). Note that if there are missing cases, they are first imputed before estimating the ancestral states.
</p>
<p>Estimation of missing cases and ancestral states is performed using GLS (Generalized Least Squares) solution (See Cunningham et al. 1998).

</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>estimates</code></td>
<td>
<p>The imputed dataset </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var      </code></td>
<td>
<p>Variance of the estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se       </code></td>
<td>
<p>Standard error of the estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NA_index </code></td>
<td>
<p>Position of the missing cases in the dataset</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Julien Clavel

</p>


<h3>References</h3>

<p>Clavel J., Merceron G., Escarguel G. 2014. Missing Data Estimation in Morphometrics: How Much is Too Much? Syst. Biol. 63:203-218.
</p>
<p>Cunningham C.W., Omland K.E., Oakley T.H. 1998. Reconstructing ancestral character states: a critical reappraisal. Trends Ecol. Evol. 13:361-366.

</p>


<h3>See Also</h3>

<p><code>mvMORPH</code>
<code>mvOU</code>
<code>mvEB</code>
<code>mvBM</code>
<code>mvSHIFT</code>
</p>



<h3>Examples</h3>

<pre><code class="language-R">
## Simulated dataset
set.seed(14)
# Generating a random tree
tree&lt;-pbtree(n=50)

# Setting the regime states of tip species
sta&lt;-as.vector(c(rep("Forest",20),rep("Savannah",30))); names(sta)&lt;-tree$tip.label

# Making the simmap tree with mapped states
tree&lt;-make.simmap(tree,sta , model="ER", nsim=1)
col&lt;-c("blue","orange"); names(col)&lt;-c("Forest","Savannah")

# Plot of the phylogeny for illustration
plotSimmap(tree,col,fsize=0.6,node.numbers=FALSE,lwd=3, pts=FALSE)

# Simulate two correlated traits evolving along the phylogeny
traits&lt;-mvSIM(tree,nsim=1, model="BMM", param=list(sigma=list(matrix(c(2,1,1,1.5),2,2),
         matrix(c(4,1,1,4),2,2)), names_traits=c("head.size","mouth.size")))

# Introduce some missing cases (NA values)
data&lt;-traits
data[8,2]&lt;-NA
data[25,1]&lt;-NA

# Fit of model 1
fit&lt;-mvBM(tree,data,model="BMM")

# Estimate the missing cases
imp&lt;-estim(tree, data, fit)

# Check the imputed data
imp$estim[1:10,]

## We want the ancestral states values at each nodes:
nodelabels() # To see where the nodes are situated

imp2&lt;-estim(tree, data, fit, asr=TRUE)

# Check the 10 firsts ancestral states
imp2$estim[1:10,]
</code></pre>


</div>