<div class="container">

<table style="width: 100%;"><tr>
<td>mvtNormQuasiMonteCarlo</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multivariate normal distribution function</h2>

<h3>Description</h3>

<p>Estimate the multivariate distribution function with quasi-Monte Carlo method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mvtNormQuasiMonteCarlo(p, upperBound, cov, genVec, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Number of samples used for quasi-Monte Carlo estimation. Must be a prime number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upperBound</code></td>
<td>
<p>Vector of probabilities, i.e., the upper bound of the integral.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov</code></td>
<td>
<p>Covariance matrix of the multivariate normal distribution. Must be positive semi-definite.
WARNING: for performance in high-dimensions, no check is performed on the matrix. It is the user responsibility to ensure
that the matrix is positive semi-definite.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genVec</code></td>
<td>
<p>Generating vector for the quasi-Monte Carlo procedure. Can be computed using <code>genVecQMC</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to Cpp routine.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function uses a quasi-Monte Carlo procedure based on randomly shifted
lattice rules to estimate the distribution function a multivariate normal distribution
as described in Genz and Bretz (2009) on page 50.
</p>


<h3>Value</h3>

<p>A named vector with components estimate <code>estimate</code> of the distribution function 
along <code>error</code>, 3 times the empirical Monte Carlo standard error over the <code>nrep</code> replications.
</p>


<h3>References</h3>

<p>Genz, A. and Bretz, F. (2009). Computations of Multivariate Normal and t Probabilities, volume 105. Springer: Dordrecht.
</p>
<p>Genz, A. (2013). QSILATMVNV <a href="http://www.math.wsu.edu/faculty/genz/software/software.html">http://www.math.wsu.edu/faculty/genz/software/software.html</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#Define locations
loc &lt;- expand.grid(1:4, 1:4)
ref &lt;- sample.int(16, 1)

#Compute variogram matrix
variogramMatrix &lt;- ((sqrt((outer(loc[,1],loc[,1],"-"))^2 +
(outer(loc[,2],loc[,2],"-"))^2)) / 2)^(1.5)

#Define an upper boud
upperBound &lt;- variogramMatrix[-ref,ref]

#Compute covariance matrix
cov &lt;-  (variogramMatrix[-ref,ref]%*%t(matrix(1, (nrow(loc) - 1), 1)) +
t(variogramMatrix[ref,-ref]%*%t(matrix(1, (nrow(loc) - 1), 1))) -
variogramMatrix[-ref,-ref])

#Compute generating vector
p &lt;- 499
latticeRule &lt;- genVecQMC(p, (nrow(loc) - 1))

#Estimate the multivariate distribution function
mvtNormQuasiMonteCarlo(latticeRule$primeP, upperBound, cov, latticeRule$genVec)
</code></pre>


</div>