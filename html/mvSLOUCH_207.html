<div class="container">

<table style="width: 100%;"><tr>
<td>fitch.mvsl</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Unordered Fitch parsimony reconstruction of discrete character states</h2>

<h3>Description</h3>

<p>Implements an unordered Fitch parsimony reconstruction of discrete niche variables 
for use in the OU models where optima are modeled on discrete, categorical niche encodings. 
Allows for delayed and accelerated transformations to deal with ambiguities. 
Function was originally the <code>fitch()</code> function from the <span class="pkg">slouch</span> package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitch.mvsl(phyltree, niche, deltran = FALSE, acctran = FALSE, root = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phyltree</code></td>
<td>
<p>The phylogenetic tree in <span class="pkg">ape</span> (<code>phylo</code>).
For a phylogeny in <code>phylo</code> format the "standard" <span class="pkg">ape</span> node indexing is assumed: 
for a tree with <code class="reqn">n</code> tips, the tips should have indices <code>1:n</code> and the 
root index <code>n+1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niche</code></td>
<td>
<p>The specific niche variable in the <span class="pkg">slouch</span> data.frame to be 
reconstructed, entered as data.frame<code>$</code>niche . The order of the niche's regimes
has to correspond to the order of the tip nodes in <code>phyltree</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deltran</code></td>
<td>
<p>Implements a delayed transformation algorithm in order to 
deal with ambiguous nodes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acctran</code></td>
<td>
<p>Implements an accelerated transformation algorithm to deal 
with ambiguous nodes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>root</code></td>
<td>
<p>An optional argument allowing the user to define a character 
state for the root (useful if the root node is ambiguously reconstructed)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>fitch.mvsl</code> function is meant to be interactive, where the user acts on the advice 
given in the returned messages whilst attempting to reconstruct ancestral states. 
If the root node is ambiguous after an initial reconstruction (a message will be printed to 
the screen if this is the case), this needs to be set by the user using the <code>root = "state"</code> 
argument in the function call. Any remaining ambiguous nodes can then be dealt with by specifying 
<code>deltran</code> or <code>acctran ="TRUE"</code> in the function call 
</p>


<h3>Value</h3>

<p>The <code>fitch.mvsl</code> function returns a list with two or three elements. The first, 
<code>$branch_regimes</code> is a vector of reconstructed character states. Each entry of
the vector corresponds to the respective edge in the <code>$edge</code> field in the provided tree.
Notice that entries correspond to edges and not to nodes. If you require correspondence
with nodes, then you can treat the given edge entry as the value for the node ending the edge.
Actually, this is what the algorithm in the function estimates. 
The second field of the output object, <code>$root_regime</code>s is the regime at the root of the tree.
If the provided tree was a raw <code>phylo</code> object, then the function will also return 
an enhanced version of it (field <code>$phyltree</code>). This is the tree that results from calling
<span class="pkg">mvSLOUCH</span><code>::phyltree_paths(phyltree)</code> on the originally provided tree. This
enhanced version is returns as calculating it is costly and the user might want to re-use
it in some downstream analysis with <span class="pkg">mvSLOUCH</span>. All <span class="pkg">mvSLOUCH</span> user-level functions
first enhance the provided phylogeny by <span class="pkg">mvSLOUCH</span><code>::phyltree_paths()</code>, but they
first check if it is not already enhanced. 
</p>


<h3>Author(s)</h3>

<p>Jason Pienaar <a href="mailto:jasonpienaar@gmail.com">jasonpienaar@gmail.com</a></p>


<h3>References</h3>

 
<p>Fitch, M.W. (1971) Defining the course of Evolution: Minimum change for a specific tree topology. 
<em>Systematic Zoology</em> <b>20</b>:406–416.
</p>
<p>Swofford, D. L. and W.P. Maddison (1987) Reconstructing ancestral character states under 
Wagner parsimony. <em>Mathematical Biosciences</em> <b>87</b>: 199–229. 
</p>


<h3>See Also</h3>

<p><code>slouch::fitch</code>, <code>slouch::slouchtree.plot</code>, <code>slouch::model.fit</code>, 
<code>slouch::ouch2slouch</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">RNGversion(min(as.character(getRversion()),"3.6.1"))
set.seed(12345, kind = "Mersenne-Twister", normal.kind = "Inversion")
phyltree&lt;-ape::rtree(5)

regimes&lt;-c("A","B","B","C","C")
regimesFitch&lt;-fitch.mvsl(phyltree,regimes,root=1,deltran=TRUE)
RNGversion(as.character(getRversion()))
</code></pre>


</div>