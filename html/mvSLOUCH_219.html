<div class="container">

<table style="width: 100%;"><tr>
<td>simulBMProcPhylTree</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simulate data on a phylogeny under a (multivariate) Brownian motion model
</h2>

<h3>Description</h3>

<p>Simulate data on a phylogeny under a (multivariate) Brownian motion model
</p>


<h3>Usage</h3>

<pre><code class="language-R">simulBMProcPhylTree(phyltree, X0, Sigma, dropInternal = TRUE, M.error=NULL, 
fullTrajectory=FALSE, jumpsetup=NULL, keep_tree = FALSE, step=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phyltree</code></td>
<td>

<p>The phylogeny in <code>phylo</code> format. The tree can be obtained from e.g. a 
<code>nexus</code> file by the <code>read.nexus()</code> function from the <span class="pkg">ape</span> package. 
The "standard" <span class="pkg">ape</span> node indexing is assumed: for a tree with <code class="reqn">n</code> tips, 
the tips should have indices <code>1:n</code> and the root index <code>n+1</code>.
The <code>root.edge</code> field is ignored.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X0</code></td>
<td>
<p>The ancestral, root state.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>The diffusion matrix of the Brownian motion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dropInternal</code></td>
<td>
<p>Logical whether the simulated values at the internal nodes should be 
dropped.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M.error</code></td>
<td>

<p>An optional measurement error covariance structure. The measurement errors between species are assumed 
independent. The program tries to recognize the structure of the passed matrix and accepts the following 
possibilities :
</p>

<ul>
<li>
<p>a single number that is a common measurement error for all tips and species,
</p>
</li>
<li>
<p>a m element vector with each value corresponding to a variable, measurement errors are independent
between variables and each species is assumed to have the same measurement errors,
</p>
</li>
<li>
<p>a m x m ((number of variables) x (number of variables)) matrix, all species will
have the same measurement error,
</p>
</li>
<li>
<p>a list of length n (number of species), each list element is the covariance structure 
for the appropriate (numbering according to tree) species, either a single number 
(each variable has same variance), vector (of length m for each variable), or m x m matrix, 
the order of the list has to correspond to the order of the nodes in the <code>phyltree</code> object,
</p>
</li>
<li>
<p>NULL no measurement error.
</p>
</li>
</ul>
<p>From version <code>2.0.0</code> of <span class="pkg">mvSLOUCH</span> it is impossible to pass a single joint measurement error matrix 
for all the species and traits. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fullTrajectory</code></td>
<td>
<p>Should the full realization of the process or only node and tip values 
be returned</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jumpsetup</code></td>
<td>
<p>Either <code>NULL</code> or list describing the jump at speciation. In the second 
case:
</p>

<dl>
<dt><code>jumptype</code></dt>
<dd>
<p>In what way does the jump take place. Possible values are <br><code>"ForBoth"</code> the jump occurs at speciation and is common to both daughter lineages,
<code>"RandomLineage"</code> the jump occurs just after speciation affecting exactly one
daughter lineage, both descending branches have the same chance of being affected,
<code>"JumpWithProb"</code> the jump occurs with probability <code>jumpprob</code>
just after speciation independently on each daughter lineage independently.
</p>
</dd>
<dt><code>jumpprob</code></dt>
<dd>
<p>A value in <code class="reqn">[0,1]</code> indicating the probability of a 
jump taking place, only matters if <code>jumptype</code> is <code>"JumpWithProb"</code> 
or <code>"JumpWithProb"</code>.</p>
</dd>
<dt><code>jumpdistrib</code></dt>
<dd>
<p>The distribution of the jump, currently only can take
value <code>"Normal"</code>.</p>
</dd>
<dt><code>vMean</code></dt>
<dd>
<p>The expected value of the jump, a vector of appropriate
length if the trait is multivariate.</p>
</dd>
<dt><code>mCov</code></dt>
<dd>
<p>The variance of the jump, a matrix of appropriate
dimensions if the trait is multivariate.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep_tree</code></td>
<td>
<p>Logical whether the used tree should be saved inside the output object.
Useful for any future reference, but as the tree is enhanced for <span class="pkg">mvSLOUCH</span>'s needs
the resulting output object may be very large (it the number of tips is large).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step</code></td>
<td>
<p>The step size of the simulation.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If <code>fullTrajectory</code> is <code>FALSE</code> then 
returns a matrix with each row corresponding to a tree node and each column to a trait. 
Otherwise returns a more complex object describing the full realization of the process on the tree.
If <code>dropInternal</code> is <code>TRUE</code>, then the entries for the internal nodes are changed to 
<code>NA</code>s. The ordering of the rows corresponds to the order of the nodes (their indices) in 
the <code>phylo</code> object. Hence, the first <code>n</code> rows will be the tip rows 
(by common <code>phylo</code> convention).
</p>


<h3>Author(s)</h3>

<p>Krzysztof Bartoszek</p>


<h3>References</h3>

<p>Bartoszek, K. (2014) 
Quantifying the effects of anagenetic and cladogenetic evolution. 
Mathematical Biosciences 254:42-57.
</p>
<p>Bartoszek, K. (2016) 
A Central Limit Theorem for punctuated equilibrium.
arXiv:1602.05189.
</p>
<p>Bartoszek, K. and Pienaar, J. and Mostad. P. and Andersson, S. and Hansen, T. F. (2012)
A phylogenetic comparative method for studying  multivariate adaptation.
Journal of Theoretical Biology 314:204-215.
</p>
<p>Butler, M.A. and A.A. King (2004) 
Phylogenetic comparative analysis: a modeling approach for adaptive evolution.  
American Naturalist 164:683-695.
</p>
<p>Felsenstein, J. (1985) 
Phylogenies and the comparative method.
American Naturalist 125:1-15.
</p>
<p>Hansen, T.F. and Bartoszek, K. (2012)
Interpreting the evolutionary regression: the interplay between observational and biological 
errors in phylogenetic comparative studies.
Systematic Biology 61(3):413-425.
</p>
<p>Pienaar et al (in prep) An overview of comparative methods for
testing adaptation to external environments.
</p>


<h3>See Also</h3>

<p><code>BrownianMotionModel</code>, <code>SummarizeBM</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">RNGversion(min(as.character(getRversion()),"3.6.1"))
set.seed(12345, kind = "Mersenne-Twister", normal.kind = "Inversion")
### We will first simulate a small phylogenetic tree using functions from ape.
### For simulating the tree one could also use alternative functions, e.g. sim.bd.taxa 
### from the TreeSim package
phyltree&lt;-ape::rtree(5)

## The line below is not necessary but advisable for speed
phyltree&lt;-phyltree_paths(phyltree)

### Define Brownian motion parameters to be able to simulate data 
### under the Brownian motion model.
BMparameters&lt;-list(vX0=matrix(0,nrow=3,ncol=1),
Sxx=rbind(c(1,0,0),c(0.2,1,0),c(0.3,0.25,1)))

### Now simulate the data.
jumpobj&lt;-list(jumptype="RandomLineage",jumpprob=0.5,jumpdistrib="Normal",
vMean=rep(0,3),mCov=diag(1,3,3))
BMdata&lt;-simulBMProcPhylTree(phyltree,X0=BMparameters$vX0,Sigma=BMparameters$Sxx,
jumpsetup=jumpobj)
RNGversion(as.character(getRversion()))

</code></pre>


</div>