<div class="container">

<table style="width: 100%;"><tr>
<td>mvabund-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Statistical methods for analysing multivariate abundance data </h2>

<h3>Description</h3>

<p>This package provides tools for a model-based approach to the analysis of multivariate abundance data in ecology (Warton 2011), where 'abundance' should be interpreted loosely - as well as counts you could have presence/absence, ordinal or biomass (via <code>manyany</code>), etc.
</p>
<p>There are graphical methods for exploring the properties of data and the community-environment association, flexible regression methods for estimating and making robust inferences about the community-environment association, 'fourth corner models' to explain environmental response as a function of traits, and diagnostic plots to check the appropriateness of a fitted model (Wang et. al 2012).
</p>
<p>There is an emphasis on design-based inferences about these models, e.g. bootstrapping rows of residuals via <code>anova</code> calls, or cross-validation across rows, to make multivariate inferences that are robust to failure of assumptions about correlation. Another emphasis is on presenting diagnostic tools to check assumptions, especially via residual plotting.
</p>


<h3>Details</h3>

<p>The key functions available in this package are the following.
</p>
<p><b>For graphical display of the data:</b>
</p>

<dl>
<dt><code>plot.mvabund</code></dt>
<dd>
<p> draw a range of plots for Multivariate Abundance Data </p>
</dd>
<dt><code>boxplot.mvabund</code></dt>
<dd>
<p> draw a range of plots of Model Formulae for Multivariate Abundance Data </p>
</dd>
<dt><code>meanvar.plot</code></dt>
<dd>
<p> draw mean-variance plots for Multivariate Abundance Data </p>
</dd>
</dl>
<p><b>For estimating and displaying Linear Models:</b>
</p>

<dl>
<dt><code>manylm</code></dt>
<dd>
<p>Fitting Linear Models for Multivariate Abundance Data</p>
</dd>
<dt><code>summary.manylm</code></dt>
<dd>
<p>summarizie Multivariate Linear Model Fits for Abundance Data</p>
</dd>
<dt><code>anova.manylm</code></dt>
<dd>
<p>obtain ANOVA for Multivariate Linear Model Fits for Abundance Data</p>
</dd>
<dt><code>plot.manylm</code></dt>
<dd>
<p>plot diagnostics for a <code>manylm</code> Object</p>
</dd>
</dl>
<p><b>For estimating and displaying Generalized Linear Models:</b>
</p>

<dl>
<dt><code>manyglm</code></dt>
<dd>
<p>fit Generalized Linear Models for Multivariate Abundance Data</p>
</dd>
<dt><code>summary.manyglm</code></dt>
<dd>
<p>summarize Multivariate Generalized Linear Model Fits for Abundance Data</p>
</dd>
<dt><code>anova.manyglm</code></dt>
<dd>
<p>obtain Analysis of Deviance for Multivariate Generalized Linear Model Fits for Abundance Data</p>
</dd>
<dt><code>plot.manyglm</code></dt>
<dd>
<p>plot diagnostics for a <code>manyglm</code> Object</p>
</dd>
</dl>
<p>Other generic functions like <code>residuals</code>, <code>predict</code>, <code>AIC</code> can be applied to <code>manyglm</code> objects.
</p>
<p><b>For estimating and displaying 'fourth corner models'</b> with species traits as well as environmental predictors:
</p>

<dl>
<dt><code>traitglm</code></dt>
<dd>
<p>predict abundance using a GLM as a function of traits as well as environmental variables</p>
</dd>
<dt><code>anova.traitglm</code></dt>
<dd>
<p>obtain Analysis of Deviance for a fourth corner model of abundance</p>
</dd>
</dl>
<p>Other generic functions like <code>plot</code>, <code>residuals</code>, <code>predict</code>, <code>AIC</code> can be applied to <code>traitglm</code> objects. Note <code>traitglm</code> can work slowly, as it fits a single big model to vectorised data (then wants to resample it when you call <code>anova.traitglm</code>). 
</p>
<p><b>For fitting more flexible models:</b>
</p>

<dl>
<dt><code>manyany</code></dt>
<dd>
<p>simultaneously fit univariate models to each response variable from 'any' input function</p>
</dd>
<dt><code>anova.manyany</code></dt>
<dd>
<p>simultaneously test for a community-level effect, comparing two or more <code>manyany</code> objects</p>
</dd>
<dt><code>glm1path</code></dt>
<dd>
<p>fit a path of Generalised Linear Models with L1 ('LASSO') penalties</p>
</dd>
<dt><code>cv.glm1path</code></dt>
<dd>
<p>choose the value of the L1 penalty in a <code>glm1path</code> fit by cross-validation</p>
</dd>
</dl>
<p>Other generic functions like <code>residuals</code>, <code>predict</code>, <code>AIC</code> can be applied to <code>manyany</code> and <code>glm1path</code> objects. These functions also can be on the slow side, especially if all rare species are included.
</p>
<p><b>For providing a data structure:</b>
</p>

<dl>
<dt><code>mvabund</code></dt>
<dd>
<p>create a mvabund object</p>
</dd>
<dt><code>mvformula</code></dt>
<dd>
<p>create Model Formulae for Multivariate Abundance Data</p>
</dd>
</dl>
<p><b>Example datasets:</b>
</p>

<dl>
<dt><code>Tasmania</code></dt>
<dd>
<p> meiobenthic community data from Tasmania. Used to demonstrate test for interaction. </p>
</dd>
<dt><code>solberg</code></dt>
<dd>
<p> solberg species counts with a 3-level treatment factor. </p>
</dd>
<dt><code>spider</code></dt>
<dd>
<p> hunting spiders counts from different sites.</p>
</dd>
<dt><code>tikus</code></dt>
<dd>
<p> solberg nematode counts from Tikus island.</p>
</dd>
<dt><code>antTraits</code></dt>
<dd>
<p> ant counts from Eucalypt forests, with trait measurements.</p>
</dd>
</dl>
<p>For more details, see the documentation for any of the individual functions listed above.
</p>


<h3>Author(s)</h3>

<p>David Warton <a href="mailto:David.Warton@unsw.edu.au">David.Warton@unsw.edu.au</a>, Yi Wang and Ulrike Naumann.</p>


<h3>References</h3>

<p>Brown AM, Warton DI, Andrew NR, Binns M, Cassis G and Gibb H (2014) The fourth corner solution - using species traits to better understand how species traits interact with their environment, <em>Methods in Ecology and Evolution</em> 5, 344-352.
</p>
<p>Warton D.I. (2008a). Raw data graphing: an informative but under-utilized tool for the analysis of multivariate abundances. <em>Austral Ecology</em> 33, 290-300.
</p>
<p>Warton D.I. (2008b). Penalized normal likelihood and ridge regularization of correlation and covariance matrices. <em>Journal of the American Statistical Association</em> 103, 340-349.
</p>
<p>Warton D.I. (2011). Regularized sandwich estimators for analysis of high dimensional data using generalized estimating equations. <em>Biometrics</em>, 67, 116-123.
</p>
<p>Warton DI, Shipley B &amp; Hastie T (2015) CATS regression - a model-based approach to studying trait-based community assembly, <em>Methods in Ecology and Evolution</em> 6, 389-398.
</p>
<p>Warton D. I., Wright S., and Wang, Y. (2012). Distance-based multivariate analyses confound location and dispersion effects. <em>Methods in Ecology and Evolution</em>, 3, 89-101.
</p>
<p>Wang Y., Neuman U., Wright S. and Warton D. I. (2012). mvabund: an R package
for model-based analysis of multivariate abundance data. <em>Methods in Ecology and Evolution</em>, 3, 471-473. 
</p>


<h3>See Also</h3>

 
<p><code>plot.mvabund</code>, <code>meanvar.plot</code>,
<code>manyany</code>, <code>manylm</code>, <code>manyglm</code>, <code>traitglm</code>, <code>summary.manylm</code>, <code>anova.manyany</code>, <code>anova.manylm</code>, <code>anova.traitglm</code>, <code>anova.manyglm</code>, <code>plot.manylm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">require(graphics)

## Load the spider dataset:
data(spider)

## Create the mvabund object spiddat:
spiddat &lt;- mvabund(spider$abund)
X &lt;- as.matrix(spider$x)

## Draw a plot of the spider data:
plot(spiddat, col="gray1", n.vars=8, transformation="sqrt", 
xlab=c("Hunting Spider"), ylab="Spider Species", scale.lab="s",
t.lab="t", shift=TRUE, fg= "lightblue", col.main="red", main="Spiders") 


## A mean-variance plot, data organised by year, 
## for 1981 and 1983 only, as in Figure 7a of Warton (2008a):
data(tikus)
tikusdat &lt;- mvabund(tikus$abund)
year &lt;- tikus$x[,1]
is81or83 &lt;- year==81 | year==83
meanvar.plot(tikusdat~year,legend=TRUE, subset=is81or83, col=c(1,10)) 	

## Create a formula for multivariate abundance data:
foo &lt;- mvformula( spiddat~X )

## Create a List of Univariate Formulas:
fooUni &lt;- formulaUnimva(spiddat~X)
fooUniInt &lt;- formulaUnimva(spiddat~X, intercept=TRUE)

## Find the three variables that best explain the response:
best.r.sq( foo, n.xvars= 3)

## Fit a multivariate linear model:
foo &lt;- mvformula( spiddat~X )
lm.spider &lt;- manylm(foo)

## Plot Diagnostics for a multivariate linear model:
plot(lm.spider,which=1:2,col.main="red",cex=3,overlay=FALSE)

## Obtain a summary of test statistics using residual resampling:
summary(lm.spider, nBoot=500)

## Calculate a ANOVA Table:
anova(lm.spider, nBoot=500)

</code></pre>


</div>