<div class="container">

<table style="width: 100%;"><tr>
<td>manylm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting Linear Models for Multivariate Abundance Data</h2>

<h3>Description</h3>

<p><code>manylm</code> is used to fit multivariate linear models
to high-dimensional data, such as multivariate abundance data in ecology.
</p>
<p>This is the base model-fitting function - see <code>plot.manylm</code> for 
assumption checking, and <code>anova.manylm</code> or <code>summary.manylm</code> 
for significance testing.
</p>


<h3>Usage</h3>

<pre><code class="language-R">manylm(
   formula, data=NULL,  subset=NULL, weights=NULL, 
   na.action=options("na.action"),  method="qr", model=FALSE, 
   x=TRUE, y=TRUE, qr=TRUE, singular.ok=TRUE, contrasts=NULL, 
   offset, test="LR" , cor.type= "I", shrink.param=NULL, 
   tol=1.0e-5, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>

<p>an object of class <code>"formula"</code> (or one that
can be coerced to that class): a symbolic description of the
model to be fitted. The details of model specification are given
under Details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame, list or environment (or object
coercible by <code>as.data.frame</code> to a data frame) containing
the variables in the model.  If not found in <code>data</code>, the
variables are taken from <code>environment(formula)</code>,
typically the environment from which <code>manylm</code> is called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a subset of observations
to be used in the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>an optional vector of weights to be used in the fitting
process.  Should be <code>NULL</code> or a numeric vector.
If non-null, weighted least squares is used with weights
<code>weights</code> (that is, minimizing <code>sum(weights*e^2)</code>); otherwise
ordinary least squares is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen
when the data contain <code>NA</code>s.  The default is set by
the <code>na.action</code> setting of <code>options</code>, and is
<code>na.fail</code> if that is unset.  The ‘factory-fresh’
default is <code>na.omit</code>.  Another possible value is
<code>NULL</code>, no action.  Value <code>na.exclude</code> can be useful.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the method to be used; for fitting, currently only
<code>method = "qr"</code> is supported; <code>method = "model.frame"</code> returns
the model frame (the same as with <code>model = TRUE</code>, see below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model, x, y, qr</code></td>
<td>
<p>logicals.  If <code>TRUE</code> the corresponding
components of the fit (the model frame, the model matrix, the
response, the QR decomposition) are returned. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>singular.ok</code></td>
<td>
<p>logical. If <code>FALSE</code> (the default in S but
not in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>) a singular fit is an error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>an optional list. See the <code>contrasts.arg</code>
of <code>model.matrix.default</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>this can be used to specify an <em>a priori</em>
known component to be included in the linear predictor
during fitting.  This should be <code>NULL</code> or a numeric vector of
length either one or equal to the number of cases.
One or more <code>offset</code> terms can be included in the
formula instead or as well, and if both are specified their sum is
used.  See <code>model.offset</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>choice of test statistic. Can be one of "LR" (default) = likelihood ratio statistic "F" = Lawley-Hotelling trace statistic <code>NULL</code> = no test
This parameter is merely stored in <code>manylm</code>, and will be used as the default value of <code>test</code> in subsequent functions for inference.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor.type</code></td>
<td>
<p>structure imposed on the estimated correlation matrix under the fitted model. Can be "I"(default), "shrink", or "R". See anova.manylm for details of its usage. This parameter will be used as the default value of <code>cor.type</code> in subsequent functions for inference.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shrink.param</code></td>
<td>
<p>shrinkage parameter to be used if <code>cor.type="shrink"</code>. This parameter will be used as the default value of <code>shrink.param</code> in subsequent functions for inference.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>the tolerance used in estimations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to be passed to the low level regression fitting functions (see below).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Models for <code>manylm</code> are specified symbolically. For details on this 
compare the details section of <code>lm</code> and <code>formula</code>. If the formula 
includes an <code>offset</code>, this is evaluated and subtracted from the 
response.   <br>
See <code>model.matrix</code> for some further details. The terms in
the formula will be re-ordered so that main effects come first,
followed by the interactions, all second-order, all third-order and so
on: to avoid this pass a <code>terms</code> object as the formula (see
<code>aov</code> and <code>demo(glm.vr)</code> for an example). <br>
A formula has an implied intercept term.  To remove this use either
<code>y ~ x - 1</code> or <code>y ~ 0 + x</code>.  See <code>formula</code> for
more details of allowed formulae. <br><code>manylm</code> calls the lower level function <code>manylm.fit</code> 
or <code>manylm.wfit</code> for the actual numerical computations. 
For programming only, you may consider doing likewise. <br>
All of <code>weights</code>, <code>subset</code> and <code>offset</code> are evaluated
in the same way as variables in <code>formula</code>, that is first in
<code>data</code> and then in the environment of <code>formula</code>.<br>
For details on arguments related to hypothesis testing (such as <code>cor.type</code>
and <code>resample</code>) see <code>summary.manylm</code> or
<code>anova.manylm</code>.
</p>


<h3>Value</h3>

<p><code>manylm</code> returns an object of <code>c("manylm", "mlm", "lm")</code> for multivariate
formula response and of of class <code>c("lm")</code> for univariate response.
</p>
<p>A <code>manylm</code> object is a list containing at least the following components:

</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>a named matrix of coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>the residuals matrix, that is response minus fitted values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>the matrix of the fitted mean values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank</code></td>
<td>
<p>the numeric rank of the fitted linear model.</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>(only for weighted fits) the specified weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df.residual</code></td>
<td>
<p>the residual degrees of freedom.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hat.X</code></td>
<td>
<p>the hat matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>txX</code></td>
<td>
<p>the matrix <code>(t(x)%*%x)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>the <code>test</code> argument supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor.type</code></td>
<td>
<p>the <code>cor.type</code> argument supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resample</code></td>
<td>
<p>the <code>resample</code> argument supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nBoot</code></td>
<td>
<p>the <code>nBoot</code> argument supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms</code></td>
<td>
<p>the <code>terms</code> object used.</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>xlevels</code></td>
<td>
<p>(only where relevant) a record of the levels of the
factors used in fitting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>if requested (the default), the model frame used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>the offset used (missing if none were used).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>if requested, the response matrix used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>if requested, the model matrix used.</p>
</td>
</tr>
</table>
<p>In addition, non-null fits will have components <code>assign</code> and 
(unless not requested) <code>qr</code> relating to the linear
fit, for use by extractor functions such as <code>summary.manylm</code>.
</p>


<h3>Author(s)</h3>

<p>Yi Wang, Ulrike Naumann and David Warton &lt;David.Warton@unsw.edu.au&gt;.
</p>


<h3>See Also</h3>

<p><code>anova.manylm</code>, <code>summary.manylm</code>, <code>plot.manylm</code></p>


<h3>Examples</h3>

<pre><code class="language-R">data(spider)
spiddat &lt;- log(spider$abund+1)
lm.spider &lt;- manylm(spiddat~.,data=spider$x)
lm.spider

#Then use the plot function for diagnostic plots, and use anova or summary to
#evaluate significance of different model terms.
</code></pre>


</div>