<div class="container">

<table style="width: 100%;"><tr>
<td>predict.manylm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Model Predictions for Multivariate Linear Models</h2>

<h3>Description</h3>

<p><code>predict.manylm</code> is a function for predictions from the
result of the model fitting function <code>manylm</code>.  </p>


<h3>Usage</h3>

<pre><code class="language-R">
## S3 method for class 'manylm'
predict(object, newdata=NULL, se.fit = FALSE, 
    type = c("response", "terms"), terms = NULL, na.action = na.pass, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>object of class inheriting from <code>manylm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>an optional data frame in which to look for variables with which
to predict. If omitted, the fitted values are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.fit</code></td>
<td>
<p>a switch indicating if standard errors are required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of prediction (response or model term), Possible values:
"response", "terms".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms</code></td>
<td>
<p>if type="terms", which terms (default is all terms).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>function determining what should be done with missing values in
newdata. The default is to predict <code>NA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

 <p><code>predict.manylm</code> produces predicted values, obtained by evaluating
the regression function in the frame <code>newdata</code> (which defaults to
<code>model.frame(object)</code>.  If the logical <code>se.fit</code> is
<code>TRUE</code>, standard errors of the predictions are calculated.  If
the numeric argument <code>scale</code> is set (with optional <code>df</code>), it
is used as the residual standard deviation in the computation of the
standard errors, otherwise this is extracted from the model fit.
Setting <code>intervals</code> specifies computation of confidence or
prediction (tolerance) intervals at the specified <code>level</code>, sometimes 
referred to as narrow vs. wide intervals.
</p>
<p>If the fit is rank-deficient, some of the columns of the design matrix
will have been dropped.  Prediction from such a fit only makes sense
if <code>newdata</code> is contained in the same subspace as the original
data.  That cannot be checked accurately, so a warning is issued.
</p>
<p>If <code>newdata</code> is omitted the predictions are based on the data
used for the fit.  In that case how cases with missing values in the
original fit is determined by the <code>na.action</code> argument of that
fit.  If <code>na.action = na.omit</code> omitted cases will not appear in
the residuals, whereas if <code>na.action = na.exclude</code> they will
appear (in predictions, standard errors or interval limits),
with residual value <code>NA</code>.  See also <code>napredict</code>.
</p>
<p>The prediction intervals are for a single observation at each case in
<code>newdata</code> (or by default, the data used for the fit) with error
variance(s) <code>pred.var</code>. This can be a multiple of <code>res.var</code>,
the estimated
value of <code class="reqn">\sigma^2</code>: the default is to assume that future
observations have the same error variance as those
used for fitting. If <code>weights</code> is supplied, the inverse of this
is used as a scale factor. For a weighted fit, if the prediction
is for the original data frame, <code>weights</code> defaults to the weights
used for the  model fit, with a warning since it might not be the
intended result. If the fit was weighted and newdata is given, the
default is to assume constant prediction variance, with a warning.
</p>


<h3>Value</h3>

<p><code>predict.manylm</code> produces a matrix of predictions or if <code>interval</code>
is set an array of predictions and bounds, where the first dimension has the names:
<code>fit</code>, <code>lwr</code>, and <code>upr</code>.
If <code>se.fit</code> is <code>TRUE</code>, a list with the following components is returned:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>vector or matrix as above</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.fit</code></td>
<td>
<p>a matrix with the standard errors of the predicted means</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residual.scale</code></td>
<td>
<p>vector or matrix as a vector of residual standard deviations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>numeric, the degrees of freedom for residual</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Variables are first looked for in <code>newdata</code> and then searched for
in the usual way (which will include the environment of the formula
used in the fit).  A warning will be given if the
variables found are not of the same length as those in <code>newdata</code>
if it was supplied.
</p>
<p>Offsets specified by <code>offset</code> in the fit by <code>lm</code>
will not be included in predictions, whereas those specified by an
offset term in the formula will be.
</p>
<p>Notice that prediction variances and prediction intervals always refer
to <em>future</em> observations, possibly corresponding to the same
predictors as used for the fit. The variance of the <em>residuals</em>
will be smaller.
</p>
<p>Strictly speaking, the formula used for prediction limits assumes that
the degrees of freedom for the fit are the same as those for the
residual variance.  This may not be the case if <code>res.var</code> is
not obtained from the fit. 
</p>


<h3>Author(s)</h3>

<p>Ulrike Naumann, Yi Wang and David Warton &lt;David.Warton@unsw.edu.au&gt;.</p>


<h3>See Also</h3>

<p><code>manylm</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(spider)
spiddat &lt;- mvabund(spider$abund[1:20, ])
dat = spider$x[1:20,]
manylm.fit &lt;- manylm(spiddat~soil.dry+bare.sand, data=dat)
predict(manylm.fit)
predict(manylm.fit, se.fit = TRUE)

new &lt;- spider$x[21:28,]
predict(manylm.fit, new, se.fit = TRUE)

</code></pre>


</div>