<div class="container">

<table style="width: 100%;"><tr>
<td>ridgeParamEst</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Estimation of the ridge parameter
</h2>

<h3>Description</h3>

<p>Maximum likelihood estimation of the ridge parameter by cross-validation
</p>


<h3>Usage</h3>

<pre><code class="language-R">ridgeParamEst(dat, X, weights = rep(1,times=nRows), refs, 
	tol=1.0e-010, only.ridge=FALSE,  doPlot=FALSE,
	col="blue",type="l", ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>the data matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>the design matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>weights on the cases of the design matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>refs</code></td>
<td>

<p>a vector specifying validation group membership. Default is to
construct <code>refs</code> using a method that is a function of the sample size <code>N</code>: 
if <code>N&lt;=20</code>, leave-one-out is used <code>refs=1:N</code>, if <code>N&lt;=40</code>, 
10-fold Cross Validation is used where group membership is chosen randomly 
but with equal size groups, otherwise 5-fold CV with random group memberships.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>the sensitivity in calculations near zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>only.ridge</code></td>
<td>
<p>logical, whether only the ridge Parameters should be passed back or 
additionally the Cross Validation penalised likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>doPlot</code></td>
<td>
<p>logical, whether a plot of -2logL vs a candidate for the ridge parameter should be drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>color of Plot symbols.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of Plot symbols.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further plot arguments.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function estimates the ridge parameter when applying ridge regularization to a sample correlation matrix of residuals. The ridge parameter is estimated to maximize the normal likelihood as estimated via cross validation (Warton 2008). 
</p>


<h3>Value</h3>

<p>A list with the following component:
</p>
<table><tr style="vertical-align: top;">
<td><code>ridgeParameter</code></td>
<td>

<p>the estimated ridge parameter
</p>
</td>
</tr></table>
<p>If <code>only.ridge=FALSE</code> the returned list additionally contains the element:
</p>
<table><tr style="vertical-align: top;">
<td><code>minLL</code></td>
<td>

<p>the minimum of the negative log-likelihood</p>
</td>
</tr></table>
<p>.
</p>


<h3>Author(s)</h3>

<p>David Warton &lt;David.Warton@unsw.edu.au&gt; and Ulrike Naumann.
</p>


<h3>References</h3>

<p>Warton D.I. (2008). Penalized normal likelihood and ridge regularization of
correlation and covariance matrices. <em>Journal of the American
Statistical Association</em> 103, 340-349.
</p>


<h3>See Also</h3>

<p><code>manylm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(spider)
spiddat &lt;- mvabund(spider$abund)
X &lt;- as.matrix(spider$x)

ridgeParamEst(dat = spiddat, X = model.matrix(spiddat~X))
</code></pre>


</div>