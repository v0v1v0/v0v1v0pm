<div class="container">

<table style="width: 100%;"><tr>
<td>mvb.sys.parent</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Functions to Access the Function Call Stack</h2>

<h3>Description</h3>

<p>These functions are "do what I mean, not what I say" equivalents of the corresponding system functions. The system functions can behave strangely when called in strange ways (primarily inside <code>eval</code> calls). The <code>mvb</code> equivalents behave in a more predictable fashion.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mvb.sys.parent(n=1)
mvb.sys.nframe()
mvb.parent.frame(n=1)
mvb.eval.parent( expr, n=1)
mvb.match.call(definition = sys.function(mvb.sys.parent()),
    call = sys.call(mvb.sys.parent()),  expand.dots = TRUE, envir= mvb.parent.frame( 2))
mvb.nargs()
mvb.sys.call(which = 0)
mvb.sys.function(n)
</code></pre>


<h3>Arguments</h3>

<p>All as per the corresponding system functions, from whole helpfiles the following is taken:
</p>
<table>
<tr style="vertical-align: top;">
<td><code> which</code></td>
<td>
<p>the frame number if non-negative, the number of generations to go back if negative. (See the Details section.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> n</code></td>
<td>
<p>the number of frame generations to go back.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> definition</code></td>
<td>
<p>a function, by default the function from which <code>match.call</code> is called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> call</code></td>
<td>
<p>an unevaluated call to the function specified by <code>definition</code>, as generated by <code>call</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> expr</code></td>
<td>
<p>an expression to evaluate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> expand.dots</code></td>
<td>
<p>logical. Should arguments matching <code>...</code> in the call be included or left as a <code>...</code> argument?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> envir</code></td>
<td>
<p>an environment from which the ... in call are retrieved, if any (as per <code>base::match.call</code>)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Sometimes <code>eval</code> is used to execute statements in another frame. If such statements include calls to the system versions of these routines, the results will probably not be what you want. In technical terms: the same environment will actually appear several times on the call stack (returned by <code>sys.frame()</code>) but with a different calling history each time. The <code>mvb.</code> equivalents look through <code>sys.frames()</code> for the first frame whose environment is identical to the environment they were called from, and base all conclusions on that first frame. To see how in detail, look at the most fundamental function: <code>mvb.sys.parent</code>.
</p>
<p><code>mvbutils</code> pre 2.7 used to include <code>mvb.sys.on.exit</code> as well (to return whatever the <code>on.exit</code> code would be), but I think this was by mistake; the code was actually specific to my <code>debug</code> package (which already has its own substitute), and so I've moved it out of <code>mvbutils</code>.
</p>


<h3>Value</h3>

<p>See the helpfiles for the system functions.
</p>


<h3>Author(s)</h3>

<p>Mark Bravington</p>


<h3>See Also</h3>

<p><code>sys.parent</code>, <code>sys.nframe</code>, <code>parent.frame</code>, <code>eval.parent</code>, <code>match.call</code>, <code>nargs</code>, <code>sys.call</code>, <code>sys.function</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">ff.no.eval &lt;- function() sys.nframe()
ff.no.eval() # 1
ff.system &lt;- function() eval( quote( sys.nframe()), envir=sys.frame( sys.nframe()))
ff.system() # expect 1 as per ff.no.eval, get 3
ff.mvb &lt;- function() eval( quote( mvb.sys.nframe()), envir=sys.frame( sys.nframe()))
ff.mvb() # 1
ff.no.eval &lt;- function(...) sys.call()
ff.no.eval( 27, b=4) # ff.no.eval( 27, b=4)
ff.system &lt;- function(...) eval( quote( sys.call()), envir=sys.frame( sys.nframe()))
ff.system( 27, b=4) # eval( expr, envir, enclos) !!!
ff.mvb &lt;- function(...) eval( quote( mvb.sys.call()), envir=sys.frame( sys.nframe()))
ff.mvb( 27, b=4) # ff.mvb( 27, b=4)
</code></pre>


</div>