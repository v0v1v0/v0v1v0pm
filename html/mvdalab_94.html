<div class="container">

<table style="width: 100%;"><tr>
<td>wrtpls.fit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Weight Randomization Test PLS</h2>

<h3>Description</h3>

<p>Weight Randomization Test algorithm for PLS1</p>


<h3>Usage</h3>

<pre><code class="language-R">wrtpls.fit(X, Y, ncomp, perms, alpha, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p> a matrix of observations. <code>NAs</code> and <code>Infs</code> are not allowed. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p> a vector. <code>NAs</code> and <code>Infs</code> are not allowed. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncomp</code></td>
<td>
<p> the number of components to include in the model (see below). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p> the significance level for <code>wrtpls</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perms</code></td>
<td>
<p> the number of permutations to run for <code>wrtpls</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> additional arguments.  Currently ignored. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function should not be called directly, but through <code>plsFit</code> with the argument <code>method="wrtpls"</code>. It implements the Bidiag2 scores algorithm with a permutation test for selecting the statistically significant components.
</p>


<h3>Value</h3>

<p>An object of class <code>mvdareg</code> is returned. The object contains all components returned by the underlying fit function. In addition, it contains the following:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>loadings</code></td>
<td>
<p> X loadings </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p> weights </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D2</code></td>
<td>
<p> bidiag2 matrix </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iD2</code></td>
<td>
<p> inverse of bidiag2 matrix </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ymean</code></td>
<td>
<p> mean of reponse variable </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xmeans</code></td>
<td>
<p> mean of predictor variables </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p> regression coefficients </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.loadings</code></td>
<td>
<p> y-loadings </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p> X scores </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p> orthogonal weights </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p> scaled response values </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Yactual</code></td>
<td>
<p> actual response values </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted</code></td>
<td>
<p> fitted values </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p> residuals </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xdata</code></td>
<td>
<p> X matrix </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iPreds</code></td>
<td>
<p> predicted values </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.loadings2</code></td>
<td>
<p> scaled y-loadings </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wrtpls</code></td>
<td>
<p> permutations effected </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wrtpls.out.Sig</code></td>
<td>
<p> Significant LVs </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wrtpls.crit</code></td>
<td>
<p> weight critical values </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>actual.normwobs</code></td>
<td>
<p> normed weights </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.time</code></td>
<td>
<p> model fitting time </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>val.method</code></td>
<td>
<p> validation method </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncomp</code></td>
<td>
<p> number of latent variables </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perms</code></td>
<td>
<p> number of permutations performed </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p> permutation alpha value </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p> PLS algorithm </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p> scaling used </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaled</code></td>
<td>
<p> was scaling performed </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p> model call </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms</code></td>
<td>
<p> model terms </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mm</code></td>
<td>
<p> model matrix </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p> fitted model </p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Nelson Lee Afanador (<a href="mailto:nelson.afanador@mvdalab.com">nelson.afanador@mvdalab.com</a>), Thanh Tran (<a href="mailto:thanh.tran@mvdalab.com">thanh.tran@mvdalab.com</a>)</p>


<h3>References</h3>

<p>Indahl, Ulf G., (2014) The geometry of PLS1 explained properly: 10 key notes on mathematical properties of and some alternative algorithmic approaches to PLS1 modeling. Journal of Chemometrics, 28, 168:180.
</p>
<p>Manne R., Analysis of two partial-least-squares algorithms for multi-variate calibration. Chemom. Intell. Lab. Syst. 1987; 2: 187:197.
</p>
<p>Thanh Tran, Ewa Szymanska, Jan Gerretzen, Lutgarde Buydens, Nelson Lee Afanador, Lionel Blanchet, Weight Randomization Test for the Selection of the Number of Components in PLS Models. Chemom. Intell. Lab. Syst., accepted for publication - Jan 2017.
</p>


<h3>See Also</h3>

<p><code>plsFit</code></p>


</div>