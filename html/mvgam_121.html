<div class="container">

<table style="width: 100%;"><tr>
<td>posterior_predict.mvgam</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Draws from the Posterior Predictive Distribution</h2>

<h3>Description</h3>

<p>Compute posterior draws of the posterior predictive distribution. Can be
performed for the data used to fit the model (posterior predictive checks) or
for new data. By definition, these draws have higher variance than draws
of the expected value of the posterior predictive distribution computed by
<code>posterior_epred.mvgam</code>. This is because the residual error
is incorporated in <code>posterior_predict</code>. However, the estimated means of
both methods averaged across draws should be very similar.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'mvgam'
posterior_predict(
  object,
  newdata,
  data_test,
  ndraws = NULL,
  process_error = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p><code>list</code> object returned from <code>mvgam</code>. See <code>mvgam()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>Optional <code>dataframe</code> or <code>list</code> of test data containing the
variables included in the linear predictor of <code>formula</code>. If not supplied,
predictions are generated for the original observations used for the model fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data_test</code></td>
<td>
<p>Deprecated. Still works in place of <code>newdata</code> but users are recommended to use
<code>newdata</code> instead for more seamless integration into <code>R</code> workflows</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndraws</code></td>
<td>
<p>Positive <code>integer</code> indicating how many posterior draws should be used.
If <code>NULL</code> (the default) all draws are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>process_error</code></td>
<td>
<p>Logical. If <code>TRUE</code> and <code>newdata</code> is supplied,
expected uncertainty in the process model is accounted for by using draws
from any latent trend SD parameters. If <code>FALSE</code>, uncertainty in the latent
trend component is ignored when calculating predictions. If no <code>newdata</code> is
supplied, draws from the fitted model's posterior predictive distribution will be used
(which will always include uncertainty in any latent trend components)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Ignored</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note that for all types of predictions for models that did not include
a <code>trend_formula</code>, uncertainty in the dynamic trend
component can be ignored by setting <code>process_error = FALSE</code>. However,
if a <code>trend_formula</code> was supplied in the model, predictions for this component cannot be
ignored. If <code>process_error = TRUE</code>, trend predictions will ignore autocorrelation
coefficients or GP length scale coefficients, ultimately assuming the process is stationary.
This method is similar to the types of posterior predictions returned from <code>brms</code> models
when using autocorrelated error predictions for newdata.
This function is therefore more suited to posterior simulation from the GAM components
of a <code>mvgam</code> model, while the forecasting functions
<code>plot_mvgam_fc</code> and <code>forecast.mvgam</code> are better suited to generate h-step ahead forecasts
that respect the temporal dynamics of estimated latent trends.
</p>


<h3>Value</h3>

<p>A <code>matrix</code> of dimension <code>n_samples x new_obs</code>,
where <code>n_samples</code> is the number of posterior samples from the fitted object
and <code>n_obs</code> is the number of observations in <code>newdata</code>
</p>


<h3>See Also</h3>

<p><code>hindcast.mvgam</code> <code>posterior_linpred.mvgam</code> <code>posterior_epred.mvgam</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Simulate some data and fit a model
simdat &lt;- sim_mvgam(n_series = 1, trend_model = 'AR1')
mod &lt;- mvgam(y ~ s(season, bs = 'cc'),
            trend_model = 'AR1',
            data = simdat$data_train)

# Compute posterior predictions
predictions &lt;- posterior_predict(mod)
str(predictions)

## End(Not run)
</code></pre>


</div>