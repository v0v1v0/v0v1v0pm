<div class="container">

<table style="width: 100%;"><tr>
<td>predict.mvgam</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Predict from the GAM component of an mvgam model</h2>

<h3>Description</h3>

<p>Predict from the GAM component of an mvgam model
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'mvgam'
predict(
  object,
  newdata,
  data_test,
  type = "link",
  process_error = TRUE,
  summary = TRUE,
  robust = FALSE,
  probs = c(0.025, 0.975),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p><code>list</code> object returned from <code>mvgam</code>. See <code>mvgam()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>Optional <code>dataframe</code> or <code>list</code> of test data containing the
variables included in the linear predictor of <code>formula</code>. If not supplied,
predictions are generated for the original observations used for the model fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data_test</code></td>
<td>
<p>Deprecated. Still works in place of <code>newdata</code> but users are recommended to use
<code>newdata</code> instead for more seamless integration into <code>R</code> workflows</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>When this has the value <code>link</code> (default) the linear predictor is
calculated on the link scale.
If <code>expected</code> is used, predictions reflect the expectation of the response (the mean)
but ignore uncertainty in the observation process. When <code>response</code> is used,
the predictions take uncertainty in the observation process into account to return
predictions on the outcome scale. When <code>variance</code> is used, the variance of the response
with respect to the mean (mean-variance relationship) is returned.
When <code>type = "terms"</code>, each component of the linear predictor is
returned separately in the form of a <code>list</code> (possibly with standard
errors, if <code>summary = TRUE</code>): this includes parametric model components,
followed by each smooth component, but excludes any offset and any intercept.
Two special cases are also allowed:
type <code>latent_N</code> will return the estimated latent abundances from an
N-mixture distribution, while type <code>detection</code> will return the estimated
detection probability from an N-mixture distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>process_error</code></td>
<td>
<p>Logical. If <code>TRUE</code> and a dynamic trend model was fit,
expected uncertainty in the process model is accounted for by using draws
from the latent trend SD parameters. If <code>FALSE</code>, uncertainty in the latent trend
component is ignored when calculating predictions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summary</code></td>
<td>
<p>Should summary statistics be returned
instead of the raw values? Default is <code>TRUE</code>..</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>
<p>If <code>FALSE</code> (the default) the mean is used as
the measure of central tendency and the standard deviation as
the measure of variability. If <code>TRUE</code>, the median and the
median absolute deviation (MAD) are applied instead.
Only used if <code>summary</code> is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>
<p>The percentiles to be computed by the <code>quantile</code>
function. Only used if <code>summary</code> is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Ignored</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note that for all types of predictions for models that did not include
a <code>trend_formula</code>, uncertainty in the dynamic trend
component can be ignored by setting <code>process_error = FALSE</code>. However,
if a <code>trend_formula</code> was supplied in the model, predictions for this component cannot be
ignored. If <code>process_error = TRUE</code>, trend predictions will ignore autocorrelation
coefficients or GP length scale coefficients, ultimately assuming the process is stationary.
This method is similar to the types of posterior predictions returned from <code>brms</code> models
when using autocorrelated error predictions for newdata.
This function is therefore more suited to posterior simulation from the GAM components
of a <code>mvgam</code> model, while the forecasting functions
<code>plot_mvgam_fc</code> and <code>forecast.mvgam</code> are better suited to generate h-step ahead forecasts
that respect the temporal dynamics of estimated latent trends.
</p>


<h3>Value</h3>

<p>Predicted values on the appropriate scale.
If <code>summary = FALSE</code> and <code>type != "terms"</code>,
the output is a matrix of dimension <code style="white-space: pre;">⁠n_draw x n_observations⁠</code>
containing predicted values for each posterior draw in <code>object</code>.
</p>
<p>If <code>summary = TRUE</code> and <code>type != "terms"</code>, the output is an <code>n_observations</code> x <code>E</code>
matrix. The number of summary statistics <code>E</code> is equal to <code>2 +
  length(probs)</code>: The <code>Estimate</code> column contains point estimates (either
mean or median depending on argument <code>robust</code>), while the
<code>Est.Error</code> column contains uncertainty estimates (either standard
deviation or median absolute deviation depending on argument
<code>robust</code>). The remaining columns starting with <code>Q</code> contain
quantile estimates as specified via argument <code>probs</code>.
</p>
<p>If <code>type = "terms"</code> and <code>summary = FALSE</code>, the output is a named <code>list</code>
containing a separate slot for each effect, with the effects returned as
matrices of dimension <code style="white-space: pre;">⁠n_draw x 1⁠</code>. If <code>summary = TRUE</code>, the output resembles that
from <code>predict.gam</code> when using the call
<code>predict.gam(object, type = "terms", se.fit = TRUE)</code>, where mean contributions
from each effect are returned in <code>matrix</code> form while standard errors (representing
the interval: <code>(max(probs) - min(probs)) / 2</code>) are returned in a separate <code>matrix</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Simulate 4 time series with hierarchical seasonality
# and independent AR1 dynamic processes
set.seed(111)
simdat &lt;- sim_mvgam(seasonality = 'hierarchical',
                   trend_model = 'AR1',
                   family = gaussian())

# Fit a model with shared seasonality
mod1 &lt;- mvgam(y ~ s(season, bs = 'cc', k = 6),
             data = simdat$data_train,
             family = gaussian(),
             trend_model = AR(),
             noncentred = TRUE,
             chains = 2)

# Generate predictions against observed data
preds &lt;- predict(mod1, summary = TRUE)
head(preds)

# Generate predictions against test data
preds &lt;- predict(mod1, newdata = simdat$data_test, summary = TRUE)
head(preds)

</code></pre>


</div>