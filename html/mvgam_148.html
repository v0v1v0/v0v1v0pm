<div class="container">

<table style="width: 100%;"><tr>
<td>sim_mvgam</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate a set of time series for mvgam modelling</h2>

<h3>Description</h3>

<p>This function simulates sets of time series data for fitting a multivariate GAM that includes
shared seasonality and dependence on state-space latent dynamic factors. Random dependencies among series, i.e.
correlations in their long-term trends, are included in the form of correlated loadings on the latent dynamic factors
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim_mvgam(
  T = 100,
  n_series = 3,
  seasonality = "shared",
  use_lv = FALSE,
  n_lv = 0,
  trend_model = "RW",
  drift = FALSE,
  prop_trend = 0.2,
  trend_rel,
  freq = 12,
  family = poisson(),
  phi,
  shape,
  sigma,
  nu,
  mu,
  prop_missing = 0,
  prop_train = 0.85
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>T</code></td>
<td>
<p><code>integer</code>. Number of observations (timepoints)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_series</code></td>
<td>
<p><code>integer</code>. Number of discrete time series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seasonality</code></td>
<td>
<p><code>character</code>. Either <code>shared</code>, meaning that all series share the exact same seasonal pattern,
or <code>hierarchical</code>, meaning that there is a global seasonality but each series' pattern can deviate slightly</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_lv</code></td>
<td>
<p><code>logical</code>. If <code>TRUE</code>, use dynamic factors to estimate series'
latent trends in a reduced dimension format. If <code>FALSE</code>, estimate independent latent trends for each series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_lv</code></td>
<td>
<p><code>integer</code>. Number of latent dynamic factors for generating the series' trends.
Defaults to <code>0</code>, meaning that dynamics are estimated independently for each series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trend_model</code></td>
<td>
<p><code>character</code> specifying the time series dynamics for the latent trend. Options are:
</p>

<ul>
<li> <p><code>None</code> (no latent trend component; i.e. the GAM component is all that contributes to the linear predictor,
and the observation process is the only source of error; similarly to what is estimated by <code>gam</code>)
</p>
</li>
<li> <p><code>RW</code> (random walk with possible drift)
</p>
</li>
<li> <p><code>AR1</code> (with possible drift)
</p>
</li>
<li> <p><code>AR2</code> (with possible drift)
</p>
</li>
<li> <p><code>AR3</code> (with possible drift)
</p>
</li>
<li> <p><code>VAR1</code> (contemporaneously uncorrelated VAR1)
</p>
</li>
<li> <p><code>VAR1cor</code> (contemporaneously correlated VAR1)
</p>
</li>
<li> <p><code>GP</code> (Gaussian Process with squared exponential kernel)</p>
</li>
</ul>
<p> See mvgam_trends for more details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drift</code></td>
<td>
<p><code>logical</code>, simulate a drift term for each trend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prop_trend</code></td>
<td>
<p><code>numeric</code>. Relative importance of the trend for each series. Should be between <code>0</code> and <code>1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trend_rel</code></td>
<td>
<p>Deprecated. Use <code>prop_trend</code> instead</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freq</code></td>
<td>
<p><code>integer</code>. The seasonal frequency of the series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p><code>family</code> specifying the exponential observation family for the series. Currently supported
families are: <code>nb()</code>, <code>poisson()</code>, <code>bernoulli()</code>, <code>tweedie()</code>, <code>gaussian()</code>,
<code>betar()</code>, <code>lognormal()</code>, <code>student()</code> and <code>Gamma()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p><code>vector</code> of dispersion parameters for the series
(i.e. <code>size</code> for <code>nb()</code> or
<code>phi</code> for <code>betar()</code>). If <code>length(phi) &lt; n_series</code>,
the first element of <code>phi</code> will
be replicated <code>n_series</code> times.
Defaults to <code>5</code> for <code>nb()</code> and <code>tweedie()</code>; <code>10</code> for
<code>betar()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape</code></td>
<td>
<p><code>vector</code> of shape parameters for the series
(i.e. <code>shape</code> for <code>gamma()</code>)
If <code>length(shape) &lt; n_series</code>, the first element of <code>shape</code> will
be replicated <code>n_series</code> times. Defaults to <code>10</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p><code>vector</code> of scale parameters for the series
(i.e. <code>sd</code> for <code>gaussian()</code> or <code>student()</code>,
<code>log(sd)</code> for <code>lognormal()</code>). If <code>length(sigma) &lt; n_series</code>, the first element of <code>sigma</code> will
be replicated <code>n_series</code> times. Defaults to <code>0.5</code> for <code>gaussian()</code> and
<code>student()</code>; <code>0.2</code> for <code>lognormal()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p><code>vector</code> of degrees of freedom parameters for the
series (i.e. <code>nu</code> for <code>student()</code>)
If <code>length(nu) &lt; n_series</code>, the first element of <code>nu</code> will
be replicated <code>n_series</code> times. Defaults to <code>3</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p><code>vector</code> of location parameters for the series. If <code>length(mu) &lt; n_series</code>, the first element of <code>mu</code> will
be replicated <code>n_series</code> times. Defaults to small random values between <code>-0.5</code> and <code>0.5</code> on the link scale</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prop_missing</code></td>
<td>
<p><code>numeric</code> stating proportion of observations that are missing. Should be between
<code>0</code> and <code>0.8</code>, inclusive</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prop_train</code></td>
<td>
<p><code>numeric</code> stating the proportion of data to use for training. Should be between <code>0.2</code> and <code>1</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>list</code> object containing outputs needed for <code>mvgam</code>, including 'data_train' and 'data_test',
as well as some additional information about the simulated seasonality and trend dependencies
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Simulate series with observations bounded at 0 and 1 (Beta responses)
sim_data &lt;- sim_mvgam(family = betar(), trend_model = RW(), prop_trend = 0.6)
plot_mvgam_series(data = sim_data$data_train, series = 'all')

# Now simulate series with overdispersed discrete observations
sim_data &lt;- sim_mvgam(family = nb(), trend_model = RW(), prop_trend = 0.6, phi = 10)
plot_mvgam_series(data = sim_data$data_train, series = 'all')
</code></pre>


</div>