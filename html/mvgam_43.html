<div class="container">

<table style="width: 100%;"><tr>
<td>fitted.mvgam</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Expected Values of the Posterior Predictive Distribution</h2>

<h3>Description</h3>

<p>This method extracts posterior estimates of the fitted values
(i.e. the actual predictions, included estimates for any trend states,
that were obtained when fitting the model). It also includes an option
for obtaining summaries of the computed draws.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'mvgam'
fitted(
  object,
  process_error = TRUE,
  scale = c("response", "linear"),
  summary = TRUE,
  robust = FALSE,
  probs = c(0.025, 0.975),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class <code>mvgam</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>process_error</code></td>
<td>
<p>Logical. If <code>TRUE</code> and a dynamic trend model was fit,
expected uncertainty in the process model is accounted for by using draws
from the latent trend SD parameters. If <code>FALSE</code>, uncertainty in the latent trend
component is ignored when calculating predictions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>Either <code>"response"</code> or <code>"linear"</code>.
If <code>"response"</code>, results are returned on the scale
of the response variable. If <code>"linear"</code>,
results are returned on the scale of the linear predictor term,
that is without applying the inverse link function or
other transformations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summary</code></td>
<td>
<p>Should summary statistics be returned
instead of the raw values? Default is <code>TRUE</code>..</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>
<p>If <code>FALSE</code> (the default) the mean is used as
the measure of central tendency and the standard deviation as
the measure of variability. If <code>TRUE</code>, the median and the
median absolute deviation (MAD) are applied instead.
Only used if <code>summary</code> is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>
<p>The percentiles to be computed by the <code>quantile</code>
function. Only used if <code>summary</code> is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to <code>prepare_predictions</code>
that control several aspects of data validation and prediction.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This method gives the actual fitted values from the model (i.e. what you
will see if you generate hindcasts from the fitted model using <code>hindcast.mvgam</code>
with <code>type = 'expected'</code>). These
predictions can be overly precise if a flexible dynamic trend component was included
in the model. This is in contrast to the set of predict functions (i.e.
<code>posterior_epred.mvgam</code> or <code>predict.mvgam</code>), which will assume
any dynamic trend component has reached stationarity when returning hypothetical predictions
</p>


<h3>Value</h3>

<p>An <code>array</code> of predicted <em>mean</em> response values.
If <code>summary = FALSE</code> the output resembles those of
<code>posterior_epred.mvgam</code> and <code>predict.mvgam</code>.
</p>
<p>If <code>summary = TRUE</code> the output is an <code>n_observations</code> x <code>E</code>
matrix. The number of summary statistics <code>E</code> is equal to <code>2 +
  length(probs)</code>: The <code>Estimate</code> column contains point estimates (either
mean or median depending on argument <code>robust</code>), while the
<code>Est.Error</code> column contains uncertainty estimates (either standard
deviation or median absolute deviation depending on argument
<code>robust</code>). The remaining columns starting with <code>Q</code> contain
quantile estimates as specified via argument <code>probs</code>.
</p>


<h3>See Also</h3>

<p><code>hindcast.mvgam</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Simulate some data and fit a model
simdat &lt;- sim_mvgam(n_series = 1, trend_model = 'AR1')
mod &lt;- mvgam(y ~ s(season, bs = 'cc'),
            trend_model = 'AR1',
            data = simdat$data_train,
            chains = 2,
            burnin = 300,
            samples = 300)

# Extract fitted values (posterior expectations)
expectations &lt;- fitted(mod)
str(expectations)

## End(Not run)
</code></pre>


</div>