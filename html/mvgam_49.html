<div class="container">

<table style="width: 100%;"><tr>
<td>mvgam_marginaleffects</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Helper functions for mvgam marginaleffects calculations</h2>

<h3>Description</h3>

<p>Helper functions for mvgam marginaleffects calculations
</p>
<p>Functions needed for working with marginaleffects
</p>
<p>Functions needed for getting data / objects with insight
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'mvgam'
get_coef(model, trend_effects = FALSE, ...)

## S3 method for class 'mvgam'
set_coef(model, coefs, trend_effects = FALSE, ...)

## S3 method for class 'mvgam'
get_vcov(model, vcov = NULL, ...)

## S3 method for class 'mvgam'
get_predict(model, newdata, type = "response", process_error = FALSE, ...)

## S3 method for class 'mvgam'
get_data(x, source = "environment", verbose = TRUE, ...)

## S3 method for class 'mvgam_prefit'
get_data(x, source = "environment", verbose = TRUE, ...)

## S3 method for class 'mvgam'
find_predictors(
  x,
  effects = c("fixed", "random", "all"),
  component = c("all", "conditional", "zi", "zero_inflated", "dispersion", "instruments",
    "correlation", "smooth_terms"),
  flatten = FALSE,
  verbose = TRUE,
  ...
)

## S3 method for class 'mvgam_prefit'
find_predictors(
  x,
  effects = c("fixed", "random", "all"),
  component = c("all", "conditional", "zi", "zero_inflated", "dispersion", "instruments",
    "correlation", "smooth_terms"),
  flatten = FALSE,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Model object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trend_effects</code></td>
<td>
<p><code>logical</code>, extract from the process model component
(only applicable if a <code>trend_formula</code> was specified in the model)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments are passed to the <code>predict()</code> method
supplied by the modeling package.These arguments are particularly useful
for mixed-effects or bayesian models (see the online vignettes on the
<code>marginaleffects</code> website). Available arguments can vary from model to
model, depending on the range of supported arguments by each modeling
package. See the "Model-Specific Arguments" section of the
<code>?slopes</code> documentation for a non-exhaustive list of available
arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefs</code></td>
<td>
<p>vector of coefficients to insert in the model object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov</code></td>
<td>
<p>Type of uncertainty estimates to report (e.g., for robust standard errors). Acceptable values:
</p>

<ul>
<li>
<p> FALSE: Do not compute standard errors. This can speed up computation considerably.
</p>
</li>
<li>
<p> TRUE: Unit-level standard errors using the default <code>vcov(model)</code> variance-covariance matrix.
</p>
</li>
<li>
<p> String which indicates the kind of uncertainty estimates to return.
</p>

<ul>
<li>
<p> Heteroskedasticity-consistent: <code>"HC"</code>, <code>"HC0"</code>, <code>"HC1"</code>, <code>"HC2"</code>, <code>"HC3"</code>, <code>"HC4"</code>, <code>"HC4m"</code>, <code>"HC5"</code>. See <code>?sandwich::vcovHC</code>
</p>
</li>
<li>
<p> Heteroskedasticity and autocorrelation consistent: <code>"HAC"</code>
</p>
</li>
<li>
<p> Mixed-Models degrees of freedom: "satterthwaite", "kenward-roger"
</p>
</li>
<li>
<p> Other: <code>"NeweyWest"</code>, <code>"KernHAC"</code>, <code>"OPG"</code>. See the <code>sandwich</code> package documentation.
</p>
</li>
</ul>
</li>
<li>
<p> One-sided formula which indicates the name of cluster variables (e.g., <code>~unit_id</code>). This formula is passed to the <code>cluster</code> argument of the <code>sandwich::vcovCL</code> function.
</p>
</li>
<li>
<p> Square covariance matrix
</p>
</li>
<li>
<p> Function which returns a covariance matrix (e.g., <code>stats::vcov(model)</code>)
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>Grid of predictor values at which we evaluate the slopes.
</p>

<ul>
<li>
<p> Warning: Please avoid modifying your dataset between fitting the model and calling a <code>marginaleffects</code> function. This can sometimes lead to unexpected results.
</p>
</li>
<li> <p><code>NULL</code> (default): Unit-level slopes for each observed value in the dataset (empirical distribution). The dataset is retrieved using <code>insight::get_data()</code>, which tries to extract data from the environment. This may produce unexpected results if the original data frame has been altered since fitting the model.
</p>
</li>
<li> <p><code>datagrid()</code> call to specify a custom grid of regressors. For example:
</p>

<ul>
<li> <p><code>newdata = datagrid(cyl = c(4, 6))</code>: <code>cyl</code> variable equal to 4 and 6 and other regressors fixed at their means or modes.
</p>
</li>
<li>
<p> See the Examples section and the <code>datagrid()</code> documentation.
</p>
</li>
</ul>
</li>
<li> <p><code>subset()</code> call with a single argument to select a subset of the dataset used to fit the model, ex: <code>newdata = subset(treatment == 1)</code>
</p>
</li>
<li> <p><code>dplyr::filter()</code> call with a single argument to select a subset of the dataset used to fit the model, ex: <code>newdata = filter(treatment == 1)</code>
</p>
</li>
<li>
<p> string:
</p>

<ul>
<li>
<p> "mean": Marginal Effects at the Mean. Slopes when each predictor is held at its mean or mode.
</p>
</li>
<li>
<p> "median": Marginal Effects at the Median. Slopes when each predictor is held at its median or mode.
</p>
</li>
<li>
<p> "marginalmeans": Marginal Effects at Marginal Means. See Details section below.
</p>
</li>
<li>
<p> "tukey": Marginal Effects at Tukey's 5 numbers.
</p>
</li>
<li>
<p> "grid": Marginal Effects on a grid of representative numbers (Tukey's 5 numbers and unique values of categorical predictors).
</p>
</li>
</ul>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>string indicates the type (scale) of the predictions used to
compute contrasts or slopes. This can differ based on the model
type, but will typically be a string such as: "response", "link", "probs",
or "zero". When an unsupported string is entered, the model-specific list of
acceptable values is returned in an error message. When <code>type</code> is <code>NULL</code>, the
first entry in the error message is used by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>process_error</code></td>
<td>
<p><code>logical</code>. If <code>TRUE</code>, uncertainty in the latent
process (or trend) model is incorporated in predictions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A fitted model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>source</code></td>
<td>
<p>String, indicating from where data should be recovered. If
<code>source = "environment"</code> (default), data is recovered from the environment
(e.g. if the data is in the workspace). This option is usually the fastest
way of getting data and ensures that the original variables used for model
fitting are returned. Note that always the <em>current</em> data is recovered from
the environment. Hence, if the data was modified <em>after</em> model fitting
(e.g., variables were recoded or rows filtered), the returned data may no
longer equal the model data. If <code>source = "frame"</code> (or <code>"mf"</code>), the data
is taken from the model frame. Any transformed variables are back-transformed,
if possible. This option returns the data even if it is not available in
the environment, however, in certain edge cases back-transforming to the
original data may fail. If <code>source = "environment"</code> fails to recover the
data, it tries to extract the data from the model frame; if
<code>source = "frame"</code> and data cannot be extracted from the model frame, data
will be recovered from the environment. Both ways only returns observations
that have no missing data in the variables used for model fitting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Toggle messages and warnings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effects</code></td>
<td>
<p>Should model data for fixed effects (<code>"fixed"</code>), random
effects (<code>"random"</code>) or both (<code>"all"</code>) be returned? Only applies to mixed
or gee models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>component</code></td>
<td>
<p>Should all predictor variables, predictor variables for the
conditional model, the zero-inflated part of the model, the dispersion
term or the instrumental variables be returned? Applies to models
with zero-inflated and/or dispersion formula, or to models with instrumental
variable (so called fixed-effects regressions). May be abbreviated. Note that the
<em>conditional</em> component is also called <em>count</em> or <em>mean</em>
component, depending on the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flatten</code></td>
<td>
<p>Logical, if <code>TRUE</code>, the values are returned
as character vector, not as list. Duplicated values are removed.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Objects suitable for internal 'marginaleffects' functions to proceed.
See <code>marginaleffects::get_coef()</code>, <code>marginaleffects::set_coef()</code>,
<code>marginaleffects::get_vcov()</code>, <code>marginaleffects::get_predict()</code>,
<code>insight::get_data()</code> and <code>insight::find_predictors()</code> for details
</p>


<h3>Author(s)</h3>

<p>Nicholas J Clark
</p>


</div>