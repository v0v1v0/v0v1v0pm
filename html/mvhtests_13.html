<div class="container">

<table style="width: 100%;"><tr>
<td>Multivariate analysis of variance (James test)</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Multivariate analysis of variance (James test)
</h2>

<h3>Description</h3>

<p>Multivariate analysis of variance without assuming equality of the covariance matrices.
</p>


<h3>Usage</h3>

<pre><code class="language-R">maovjames(x, ina, a = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>A matrix containing Euclidean data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ina</code></td>
<td>

<p>A numerical or factor variable indicating the groups of the data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>

<p>The significance level, set to 0.005 by default.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>James (1954) also proposed an alternative to MANOVA  when the covariance matrices are not assumed equal. The test statistic for <code class="reqn">k</code> samples is
</p>
<p style="text-align: center;"><code class="reqn">
J=\sum_{i=1}^k\left(\bar{{\bf x}}_i-\bar{{\bf X}}\right)^T{\bf W}_i\left(\bar{{\bf x}}_i-\bar{{\bf X}}\right),
</code>
</p>

<p>where <code class="reqn">\bar{{\bf x}}_i</code> and <code class="reqn">n_i</code> are the sample mean vector and sample size of the <code class="reqn">i</code>-th sample respectively and <code class="reqn">{\bf W}_i=\left(\frac{{\bf S}_i}{n_i}\right)^{-1}</code>, where <code class="reqn">{\bf S}_i</code> is the covariance matrix of the <code class="reqn">i</code>-sample mean vector and <code class="reqn">\bar{{\bf X}}</code> is the estimate of the common mean <code class="reqn">\bar{{\bf X}}=\left(\sum_{i=1}^k{\bf W}_i\right)^{-1}\sum_{i=1}^k{\bf W}_i\bar{{\bf x}}_i</code>.
</p>
<p>Normally one would compare the test statistic with a <code class="reqn">\chi^2_{r,1-\alpha}</code>, where <code class="reqn">r=p\left(k-1\right)</code> are the degrees of freedom with <code class="reqn">k</code> denoting the number of groups and <code class="reqn">p</code> the dimensionality of the data. There are <code class="reqn">r</code> constraints (how many univariate means must be equal, so that the null hypothesis, that all the mean vectors are equal, holds true), that is where these degrees of freedom come from. James (1954) compared the test statistic with a corrected <code class="reqn">\chi^2</code> distribution instead. Let
<code class="reqn">A</code> and <code class="reqn">B</code> be
<code class="reqn">A= 1+\frac{1}{2r}\sum_{i=1}^k\frac{\left[\text{tr}\left({\bf I}_p-{\bf W}^{-1}{\bf W}_i\right)\right]^2}{n_i-1}</code> and <code class="reqn">B= \frac{1}{r\left(r+2\right)}\sum_{i=1}^k\left\lbrace\frac{\text{tr}\left[\left({\bf I}_p-{\bf W}^{-1}{\bf W}_i\right)^2\right]}{n_i-1}+\frac{\left[\text{tr}\left({\bf I}_p-{\bf W}^{-1}{\bf W}_i\right)\right]^2}{2\left(n_i-1\right)}\right\rbrace</code>.
</p>
<p>The corrected quantile of the <code class="reqn">\chi^2</code> distribution is given as before by
<code class="reqn">2h\left(\alpha\right)=\chi^2\left(A+B\chi^2\right)</code>.
</p>


<h3>Value</h3>

<p>A vector with the next 4 elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>

<p>The test statistic.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correction</code></td>
<td>

<p>The value of the correction factor.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corr.critical</code></td>
<td>

<p>The corrected critical value of the chi-square distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p-value</code></td>
<td>

<p>The p-value of the corrected test statistic.
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Michail Tsagris.
</p>
<p>R implementation and documentation: Michail Tsagris <a href="mailto:mtsagris@uoc.gr">mtsagris@uoc.gr</a>.
</p>


<h3>References</h3>

<p>James G.S. (1954). Tests of Linear Hypotheses in Univariate and Multivariate Analysis
when the Ratios of the Population Variances are Unknown. Biometrika, 41(1/2): 19â€“43.
</p>


<h3>See Also</h3>

<p><code> maov, hotel2T2, james
</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">maov( as.matrix(iris[,1:4]), iris[,5] )
maovjames( as.matrix(iris[,1:4]), iris[,5] )
</code></pre>


</div>