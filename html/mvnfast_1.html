<div class="container">

<table style="width: 100%;"><tr>
<td>dmixn</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fast density computation for mixture of multivariate normal distributions.</h2>

<h3>Description</h3>

<p>Fast density computation for mixture of multivariate normal distributions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dmixn(X, mu, sigma, w, log = FALSE, ncores = 1, isChol = FALSE, A = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>matrix n by d where each row is a d dimensional random vector. Alternatively <code>X</code> can be a d-dimensional vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>an (m x d) matrix, where m is the number of mixture components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>as list of m covariance matrices (d x d) on for each mixture component. 
Alternatively it can be a list of m cholesky decomposition of the covariance. 
In that case <code>isChol</code> should be set to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>vector of length m, containing the weights of the mixture components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>boolean set to true the logarithm of the pdf is required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>Number of cores used. The parallelization will take place only if OpenMP is supported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>isChol</code></td>
<td>
<p>boolean set to true is <code>sigma</code> is the cholesky decomposition of the covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>an (optional) numeric matrix of dimension (m x d), which will be used to store the evaluations of each mixture
density over each mixture component. It is useful when m and n are large and one wants to call <code>dmixt()</code> 
several times, without reallocating memory for the whole matrix each time. NB1: <code>A</code> will be modified, 
not copied! NB2: the element of <code>A</code> must be of class "numeric".</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>NB: at the moment the parallelization does not work properly on Solaris OS when <code>ncores&gt;1</code>. Hence, <code>dmixt()</code> checks if the OS 
is Solaris and, if this the case, it imposes <code>ncores==1</code>.
</p>


<h3>Value</h3>

<p>A vector of length n where the i-the entry contains the pdf of the i-th random vector (i.e. the i-th row of <code>X</code>).
</p>


<h3>Author(s)</h3>

<p>Matteo Fasiolo &lt;matteo.fasiolo@gmail.com&gt;.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#### 1) Example use
# Set up mixture density
mu &lt;- matrix(c(1, 2, 10, 20), 2, 2, byrow = TRUE)
sigma &lt;- list(diag(c(1, 10)), matrix(c(1, -0.9, -0.9, 1), 2, 2))
w &lt;- c(0.1, 0.9)

# Simulate
X &lt;- rmixn(1e4, mu, sigma, w)

# Evaluate density
ds &lt;- dmixn(X, mu, sigma, w = w)
head(ds)

##### 2) More complicated example
# Define mixture
set.seed(5135)
N &lt;- 10000
d &lt;- 2
w &lt;- rep(1, 2) / 2
mu &lt;- matrix(c(0, 0, 2, 3), 2, 2, byrow = TRUE) 
sigma &lt;- list(matrix(c(1, 0, 0, 2), 2, 2), matrix(c(1, -0.9, -0.9, 1), 2, 2)) 

# Simulate random variables
X &lt;- rmixn(N, mu, sigma, w = w, retInd = TRUE)

# Plot mixture density
np &lt;- 100
xvals &lt;- seq(min(X[ , 1]), max(X[ , 1]), length.out = np)
yvals &lt;- seq(min(X[ , 2]), max(X[ , 2]), length.out = np)
theGrid &lt;- expand.grid(xvals, yvals) 
theGrid &lt;- as.matrix(theGrid)
dens &lt;- dmixn(theGrid, mu, sigma, w = w)
plot(X, pch = '.', col = attr(X, "index")+1)
contour(x = xvals, y = yvals, z = matrix(dens, np, np),
        levels = c(0.002, 0.01, 0.02, 0.04, 0.08, 0.15 ), add = TRUE, lwd = 2)

</code></pre>


</div>