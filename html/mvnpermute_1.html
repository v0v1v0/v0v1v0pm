<div class="container">

<table style="width: 100%;"><tr>
<td>mvnpermute</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate Permutation-based Multivariate Normal Data</h2>

<h3>Description</h3>

<p>Simulate new multivariate normal data sets with a specified covariance
matrix by permutation. Permutations are done on a linear transformation
of residuals that is guaranteed to be exchangeable when the original data
are multivariate normally distributed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mvnpermute(y, X, S, nr, seed)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Vector of multivariate normal data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Matrix or data frame of covariate values (including the intercept
term if desired). Number of rows must equal the length of <code>y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>Known or estimated covariance matrix of <code>y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nr</code></td>
<td>
<p>Number of data sets to generate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Optional random number seed for sampling the <code>nr</code> permutations.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function takes multivariate normal data with known covariates
and covariance matrix and generates "permutations" of this data that
maintain the mean and covariance of the original data. The
permutations are generated by finding the residuals of the data and
mapping the residuals to an orthonormal space, then simulating
random permutations within this orthonormal space. The permutations
are then mapped back to the original space, and the expected values
(given the covariates, and their estimated effect sizes) are added
back in. The resulting "permuted" data can now be used exactly like
the original data; for example, you could estimate the null
distribution of some test statistic while maintaining the (known)
covariance of the data.
</p>


<h3>Value</h3>

<p>A matrix with number of rows equal to <code>length(y)</code> and <code>nr</code> columns.
</p>


<h3>References</h3>

<p>Abney M (2015) "Permutation testing in the presence of polygenic
variation." Genetic Epidemiology, in press.
</p>
<p>Abney M, Ober C, McPeek MS (2002). "Quantitative trait homozygosity
and association mapping and empirical genome-wide significance in
large complex pedigrees: Fasting serum insulin levels in the
Hutterites." American Journal of Human Genetics 70: 920â€“934.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(98765)
N &lt;- 100
r.mat &lt;- matrix(rexp(N^2), ncol=N)
cv.mat &lt;- crossprod(r.mat) # a positive definite covariance matrix
x.mat &lt;- rep(1, N)
r.mean &lt;- 3
r1 &lt;- rnorm(N) # independent random noise
r.data &lt;- x.mat * r.mean + drop( t(chol(cv.mat)) %*% r1 ) # correlated random noise
r.perm &lt;- mvnpermute( r.data, x.mat, cv.mat, nr=1000, seed=1234)
est.cvm &lt;- cov(t(r.perm))
plot(cv.mat, est.cvm); abline(0,1)
</code></pre>


</div>