<div class="container">

<table style="width: 100%;"><tr>
<td>locoutNeighbor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Diagnostic plot for identifying local outliers with varying size of neighborhood</h2>

<h3>Description</h3>

<p>Computes global and pairwise Mahalanobis distances for visualizing global and
local multivariate outliers. The size of the neighborhood (number of neighbors) is
varying, but the fraction of neighbors is fixed. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">locoutNeighbor(dat, X, Y, propneighb = 0.1, variant = c("dist", "knn"), usemax = 1/3, 
   npoints = 50, chisqqu = 0.975, indices = NULL, xlab = NULL, ylab = NULL, 
   colall = gray(0.7), colsel = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>multivariate data set (without coordinates)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>X coordinates of the data points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Y coordinates of the data points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>propneighb</code></td>
<td>
<p>proportion of neighbors to be included in tolerance ellipse</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variant</code></td>
<td>
<p>either search for neighbors according to the Eucl.Distance, or according to kNN</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>usemax</code></td>
<td>
<p>for either variant: give fraction of points (max Dist) that is used for the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npoints</code></td>
<td>
<p>computation is done at most at npoints points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chisqqu</code></td>
<td>
<p>quantile of the chisquare distribution for splitting the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indices</code></td>
<td>
<p>if this is not NULL, these should be indices of observations to be highlighted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>x-axis label for plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>y-axis label for plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colall</code></td>
<td>
<p>color for lines if indices is NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colsel</code></td>
<td>
<p>color for lines if indices are selected</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters for plotting</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For this diagnostic tool, the number of neighbors is varied up to a fraction of usemax observations.
Then propneighb (called beta) is fixed, and for each observation we compute the degree of
isolation from a fraction of 1-beta of its neighbors. Neighborhood can be defined either
via the Euclidean distance or by k-Nearest-Neighbors. For computational reasons, all computations
are done at most for npoints points. The critical value for outliers is the quantile chisqqu
of the chisquare distribution.
One can also provide indices of observations (for indices). Then the corresponding lines in
the plots will be highlighted.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>indices.reg</code></td>
<td>
<p>indices of the (selected) observations being regular observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indices.out</code></td>
<td>
<p>indices of the (selected) observations being golbal outliers</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Peter Filzmoser &lt;<a href="mailto:P.Filzmoser@tuwien.ac.at">P.Filzmoser@tuwien.ac.at</a>&gt;
<a href="http://cstat.tuwien.ac.at/filz/">http://cstat.tuwien.ac.at/filz/</a></p>


<h3>References</h3>

<p>P. Filzmoser, A. Ruiz-Gazen, and C. Thomas-Agnan: Identification of local multivariate
outliers. Submitted for publication, 2012.
</p>


<h3>See Also</h3>

 <p><code>locoutPercent</code>, <code>locoutSort</code> </p>


<h3>Examples</h3>

<pre><code class="language-R"># use data from illustrative example in paper:
data(X)
data(Y)
data(dat)
res &lt;- locoutNeighbor(dat,X,Y,variant="knn",usemax=1,chisqqu=0.975,indices=c(1,11,24,36),
              propneighb=0.1,npoints=100)
</code></pre>


</div>