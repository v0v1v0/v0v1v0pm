<div class="container">

<table style="width: 100%;"><tr>
<td>plot.mvoutlierCoDa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plots for interpreting multivatiate outliers of CoDa</h2>

<h3>Description</h3>

<p>Plots the computed information by <code>mvoutlier.CoDa</code> for supporting the interpretation
of multivariate outliers in case of compositional data.</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'mvoutlierCoDa'
plot(x, ..., which = c("biplot", "map", "uni", "parallel"), 
   choice = 1:2, coord = NULL, map = NULL, onlyout = TRUE, bw = FALSE, symb = TRUE, 
   symbtxt = FALSE, col = NULL, pch = NULL, obj.cex = NULL, transp = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>resulting object from function <code>mvoutlier.CoDa</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further plotting arguments </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>type of plot that should be made </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>choice</code></td>
<td>
<p>select the pair of PCs used for the biplot </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coord</code></td>
<td>
<p>coordinates for the presentation in a map </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>map</code></td>
<td>
<p>coordinates for the background map; see details below </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>onlyout</code></td>
<td>
<p>if TRUE only the outliers are shown in the plot </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p>if TRUE symbold will be in grey scale rather than in color </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>symb</code></td>
<td>
<p>if TRUE special symbols are used according to outlyingness </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>symbtxt</code></td>
<td>
<p>if TRUE text labels are used for plotting </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>define colors to be used for outliers and non-outliers </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>define plotting symbols to be used for outliers and non-outliers </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obj.cex</code></td>
<td>
<p>define symbol size for outliers and non-outliers  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transp</code></td>
<td>
<p>define transparancy for parallel coordinate plot </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>mvoutlier.CoDa</code> prepares the information needed for this plot function:
In a first step, the raw compositional data set in transformed by the isometric logratio
(ilr) transformation to the usual Euclidean space. Then adaptive outlier detection is
perfomed: Starting from a quantile 1-alpha of the chisquare distribution, one looks for the
supremum of the differences between the chisquare distribution and the empirical distribution
of the squared Mahalanobis distances. The latter are derived from the MCD estimator using
the proportion quan of the data. The supremum is the outlier cutoff, and certain colors
and symbols for the outliers are computed: The colors should reflect the magnitude of the
median element concentration of the observations, which is done by computing for each observation
along the single ilr variables the distances to the medians. The mediab of all distances
determines the color (or grey scale): a high value, resulting in a red (or dark) symbol,
means that most univariate parts have higher values than the average, and a low value (blue
or light symbol) refers to an observation with mainly low values. The symbols are according
to the cut-points from the quantiles 0.25, 0.5, 0.75, and the outlier cutoff of the
squared Mahalanobis distances. This plot function then allows to visualize the information.
</p>
<p>The optional background map for the representation of the outliers in a map can be
included using the argument <code>map</code>. This should consist of one or more polygons
representing the geographical x- and y-coordinates of the background map. Of course,
this map should be represented in the same coordinate system as the coordinates for
the sample locations provided by <code>coord</code>. The structure of <code>map</code> is as follows:
It should consist of 2 columns, one for the x-, one for the y-coordinates. If a polygon
ends, a row with 2 entries NA should follow. At the end two NA rows are needed.
See also examples below.
</p>


<h3>Value</h3>

<p>A plot is drawn.
</p>


<h3>Author(s)</h3>

<p>Peter Filzmoser &lt;<a href="mailto:P.Filzmoser@tuwien.ac.at">P.Filzmoser@tuwien.ac.at</a>&gt;
<a href="http://cstat.tuwien.ac.at/filz/">http://cstat.tuwien.ac.at/filz/</a></p>


<h3>References</h3>

<p>P. Filzmoser, K. Hron, and C. Reimann.
Interpretation of multivariate outliers for compositional data.
Submitted to Computers and Geosciences.
</p>


<h3>See Also</h3>

 <p><code>mvoutlier.CoDa</code>, <code>arw</code>, <code>map.plot</code>, <code>uni.plot</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">data(humus)
el=c("As","Cd","Co","Cu","Mg","Pb","Zn")
dsel &lt;- humus[,el]
data(kola.background) # contains different information (coast, borders, etc.)
coo &lt;- rbind(kola.background$coast,kola.background$boundary,kola.background$borders)
XY &lt;- humus[,c("XCOO","YCOO")]
set.seed(123)
res &lt;- mvoutlier.CoDa(dsel)

par(ask=TRUE)
### Parallel coordinate plot:
## show for all obvervations (transp is only useful when generating e.g. a pdf):
# plot(res,onlyout=FALSE,bw=TRUE,which="parallel",symb=FALSE,symbtxt=FALSE,transp=0.3)
## show only outliers with special colors and labels in the margins:
plot(res,onlyout=TRUE,bw=FALSE,which="parallel",symb=TRUE,symbtxt=TRUE,transp=0.3)

### Biplot:
## show all data points, outliers are in different color and have different symbol:
# plot(res,onlyout=FALSE,which="biplot",bw=FALSE,symb=FALSE,symbtxt=FALSE)
## show only the outliers with special symbols and colors:
plot(res,onlyout=TRUE,which="biplot",bw=FALSE,symb=TRUE,symbtxt=TRUE)

### Map:
## show all data points, outliers are in different color and have different symbol:
# plot(res,coord=XY,map=coo,onlyout=FALSE,which="map",bw=FALSE,symb=FALSE,symbtxt=FALSE)
## show only the outliers with special symbols and colors:
plot(res,coord=XY,map=coo,onlyout=TRUE,which="map",bw=FALSE,symb=TRUE,symbtxt=TRUE)

### Univariate scatterplot:
## show all data points, outliers are in different color and have different symbol:
# plot(res,onlyout=FALSE,which="uni",symb=FALSE,symbtxt=FALSE)
## show only the outliers with special symbols and colors:
plot(res,onlyout=TRUE,which="uni",symb=TRUE,symbtxt=TRUE)
</code></pre>


</div>