<div class="container">

<table style="width: 100%;"><tr>
<td>series</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Decomposition of multivariate polynomials by powers</h2>

<h3>Description</h3>

<p>Power series of multivariate polynomials, in
various forms</p>


<h3>Usage</h3>

<pre><code class="language-R">trunc(S,n)
truncall(S,n)
trunc1(S,...)
series(S,v,showsymb=TRUE)
## S3 method for class 'series'
print(x,...)
onevarpow(S,...)
taylor(S,vx,va,debug=FALSE)
mvp_taylor_onevar(allnames,allpowers,coefficients, v, n)
mvp_taylor_allvars(allnames,allpowers,coefficients, n)
mvp_taylor_onepower_onevar(allnames, allpowers, coefficients, v, n)
mvp_to_series(allnames, allpowers, coefficients, v)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>Object of class <code>mvp</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Non-negative integer specifying highest order to be retained</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>Variable to take Taylor series with respect to.   If missing,
total power of each term is used (except for <code>series()</code> where
it is mandatory)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x,...</code></td>
<td>
<p>Object of class <code>series</code> and further arguments,
passed to the print method; in <code>trunc1()</code> a list of variables
to truncate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showsymb</code></td>
<td>
<p>In function <code>series()</code>, Boolean, with default
<code>TRUE</code> meaning to substitute variables like <code>x_m_foo</code> with
<code>(x-foo)</code> for readability reasons; see the vignette for a
discussion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vx,va,debug</code></td>
<td>
<p>In function <code>taylor()</code>, names of variables to
take series with respect to; and a Boolean with default <code>FALSE</code>
meaning to return the mvp and <code>TRUE</code> meaning to return
the string that is passed to <code>eval()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allnames,allpowers,coefficients</code></td>
<td>
<p>Components of <code>mvp</code>
objects</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Function <code>onevarpow()</code> returns just the terms in which the
symbols corresponding to the named arguments have powers equal to the
arguments' powers.  Thus:
</p>
<pre>
 onevarpow(as.mvp("x*y*z + 3*x*y^2 + 7*x*y^2*z^6 + x*y^3"),x=1,y=2)
mvp object algebraically equal to
3  +  7 z^6
</pre>
<p>Above, we see that only the terms with <code>x^1*y^2</code> have been
extracted, corresponding to arguments <code>x=1,y=2</code>.
</p>
<p>Function <code>series()</code> returns a power series expansion of powers of
variable <code>v</code>.  The value returned is a list of three elements
named <code>mvp</code>, <code>varpower</code>, and <code>variablename</code>.  The first
element is a list of <code>mvp</code> objects and the second is an integer
vector of powers of variable <code>v</code> (element <code>variablename</code> is
a character string holding the variable name, argument <code>v</code>).
</p>
<p>Function <code>trunc(S,n)</code> returns the terms of <code>S</code> with the sum
of the powers of the variables <code class="reqn">\leq n</code>.  Alternatively, it
discards all terms with total power <code class="reqn">&gt;n</code>.
</p>
<p>Function <code>trunc1()</code> is similar to <code>trunc()</code>.  It takes a
<code>mvp</code> object and an arbitrary number of named arguments, with
names corresponding to variables and their values corresponding to the
highest power in that variable to be retained.  Thus
<code>trunc1(S,x=2,y=4)</code> will discard any term with variable <code>x</code>
raised to the power 3 or above, and also any term with variable
<code>y</code> raised to the power 5 or above.  The highest power of
<code>x</code> will be 2 and the highest power of <code>y</code> will be 4.
</p>
<p>Function <code>truncall(S,n)</code> discards any term of <code>S</code> with any
variable raised to a power greater than <code>n</code>.  
</p>
<p>Function <code>series()</code> returns an object of class <code>series</code>; the
print method for <code>series</code> objects is sensitive to the value of
<code>getOption("mvp_mult_symbol")</code>; set this to <code>"*"</code> to get
<code>mpoly</code>-compatible output.
</p>
<p>Function <code>taylor()</code> is a convenience wrapper for <code>series()</code>.
</p>
<p>Functions <code>mvp_taylor_onevar()</code>, <code>mvp_taylor_allvars()</code> and
<code>mvp_to_series()</code> are low-level helper functions that are not
intended for the user.
</p>


<h3>Author(s)</h3>

<p>Robin K. S. Hankin</p>


<h3>See Also</h3>

<p><code>deriv</code></p>


<h3>Examples</h3>

<pre><code class="language-R">trunc(as.mvp("1+x")^6,2)

trunc(as.mvp("1+x+y")^3,2)      # discards all terms with total power&gt;2
trunc1(as.mvp("1+x+y")^3,x=2)   # terms like y^3 are treated as constants

trunc(as.mvp("1+x+y^2")^3,3)    # discards x^2y^2 term (total power=4&gt;3)
truncall(as.mvp("1+x+y^2")^3,3) # retains  x^2y^2 term (all vars to power 2)

onevarpow(as.mvp("1+x+x*y^2  + z*y^2*x"),x=1,y=2)

(p2 &lt;- rmvp(10))
series(p2,"a")

# Works well with pipes:

f &lt;- function(n){as.mvp(sub('n',n,'1+x^n*y'))}
Reduce(`*`,lapply(1:6,f)) %&gt;% series('y')
Reduce(`*`,lapply(1:6,f)) %&gt;% series('x')


(p &lt;- horner("x+y",1:4))
onevarpow(p,x=2)   # coefficient of x^2
onevarpow(p,x=3)   # coefficient of x^3


p %&gt;% trunc(2)
p %&gt;% trunc1(x=2)
(p %&gt;% subs(x="x+dx") -p) %&gt;% trunc1(dx=2)

# Nice example of Horner's method:
(p &lt;- as.mvp("x + y + 3*x*y"))
trunc(horner(p,1:5)*(1-p)^2,4)  # should be 1


## Third order taylor expansion of f(x)=sin(x+y) for x=1.1, about x=1:
(sinxpy &lt;- horner("x+y",c(0,1,0,-1/6,0,+1/120,0,-1/5040,0,1/362880)))  # sin(x+y)
dx &lt;- as.mvp("dx")
t3 &lt;- sinxpy  + aderiv(sinxpy,x=1)*dx + aderiv(sinxpy,x=2)*dx^2/2 + aderiv(sinxpy,x=3)*dx^3/6
t3 %&lt;&gt;% subs(x=1,dx=0.1)  # t3 = Taylor expansion of sin(y+1.1)
t3 %&gt;% subs(y=0.3)  - sin(1.4)  # numeric; should be small
</code></pre>


</div>