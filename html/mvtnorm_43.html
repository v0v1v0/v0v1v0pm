<div class="container">

<table style="width: 100%;"><tr>
<td>pmvt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Multivariate t Distribution </h2>

<h3>Description</h3>

<p>Computes the the distribution function of the multivariate t distribution
for arbitrary limits, degrees of freedom and correlation matrices
based on algorithms by Genz and Bretz.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pmvt(lower=-Inf, upper=Inf, delta=rep(0, length(lower)),
     df=1, corr=NULL, sigma=NULL, algorithm = GenzBretz(),
     type = c("Kshirsagar", "shifted"), keepAttr=TRUE, seed = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p> the vector of lower limits of length n.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p> the vector of upper limits of length n.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p> the vector of noncentrality parameters of length n, for
<code>type = "shifted"</code> delta specifies the mode.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p> degree of freedom as integer. Normal probabilities are computed for <code>df=0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corr</code></td>
<td>
<p> the correlation matrix of dimension n.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p> the scale matrix of dimension n. Either <code>corr</code> or
<code>sigma</code> can be specified. If <code>sigma</code> is given, the
problem is standardized internally. If <code>corr</code> is given,
it is assumed that appropriate standardization was performed
by the user. If neither <code>corr</code> nor
<code>sigma</code> is given, the identity matrix is used
for <code>sigma</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>algorithm</code></td>
<td>
<p> an object of class <code>GenzBretz</code> or
<code>TVPACK</code> defining the hyper parameters of this algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p> type of the noncentral multivariate t distribution
to be computed. The choice <code>type = "Kshirsagar"</code> corresponds
to formula (1.4) in Genz and Bretz (2009) (see also
Chapter 5.1 in Kotz and Nadarajah (2004)). This is the
noncentral t-distribution needed for calculating
the power of multiple contrast tests under a normality
assumption. <code>type = "shifted"</code> corresponds to the
formula right before formula (1.4) in Genz and Bretz (2009)
(see also formula (1.1) in Kotz and Nadarajah (2004)). It
is a location shifted version of the central
t-distribution. This noncentral multivariate t distribution appears for
example as the Bayesian posterior distribution
for the regression coefficients in a linear regression.
In the central case both types coincide.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keepAttr</code></td>
<td>
<p><code>logical</code> indicating if
<code>attributes</code> such as <code>error</code> and <code>msg</code> should be
attached to the return value.  The default, <code>TRUE</code> is back compatible.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>an object specifying if and how the random number generator
should be initialized, see <code>simulate</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters (currently given to <code>GenzBretz</code> for
backward compatibility issues). </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function involves the computation of central and noncentral
multivariate t-probabilities with arbitrary correlation matrices.
It involves both the computation of singular and nonsingular
probabilities.  The methodology (for default <code>algorithm =
  GenzBretz()</code>) is based on randomized quasi Monte Carlo methods and
described in Genz and Bretz (1999, 2002).
<br>
Because of the randomization, the result for this algorithm (slightly)
depends on <code>.Random.seed</code>.
</p>
<p>For 2- and 3-dimensional problems one can also use the <code>TVPACK</code> routines
described by Genz (2004), which only handles semi-infinite integration
regions (and for <code>type = "Kshirsagar"</code> only central problems).
</p>
<p>For <code>type = "Kshirsagar"</code> and a given correlation matrix
<code>corr</code>, for short <code class="reqn">A</code>, say, (which has to be positive
semi-definite) and degrees of freedom <code class="reqn">\nu</code> the following values are
numerically evaluated
</p>

<p style="text-align: center;"><code class="reqn">I = 2^{1-\nu/2} / \Gamma(\nu/2) \int_0^\infty s^{\nu-1} \exp(-s^2/2) \Phi(s \cdot lower/\sqrt{\nu} - \delta,
  s \cdot upper/\sqrt{\nu} - \delta) \, ds </code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\Phi(a,b) = (det(A)(2\pi)^m)^{-1/2} \int_a^b \exp(-x^\prime Ax/2) \, dx</code>
</p>

<p>is the multivariate normal distribution and <code class="reqn">m</code> is the number of rows of
<code class="reqn">A</code>.
</p>
<p>For <code>type = "shifted"</code>, a positive definite symmetric matrix
<code class="reqn">S</code> (which might be the correlation or the scale matrix),
mode (vector) <code class="reqn">\delta</code> and degrees of freedom <code class="reqn">\nu</code> the
following integral is evaluated:
</p>
<p style="text-align: center;"><code class="reqn">c\int_{lower_1}^{upper_1}...\int_{lower_m}^{upper_m}
  (1+(x-\delta)'S^{-1}(x-\delta)/\nu)^{-(\nu+m)/2}\, dx_1 ... dx_m,
</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">c = \Gamma((\nu+m)/2)/((\pi \nu)^{m/2}\Gamma(\nu/2)|S|^{1/2}),</code>
</p>

<p>and <code class="reqn">m</code> is the number of rows of <code class="reqn">S</code>.
</p>
<p>Note that both <code>-Inf</code> and <code>+Inf</code> may be specified in
the lower and upper integral limits in order to compute one-sided
probabilities.
</p>
<p>Univariate problems are passed to <code>pt</code>.
If <code>df = 0</code>, normal probabilities are returned.
</p>


<h3>Value</h3>

<p>The evaluated distribution function is returned, if <code>keepAttr</code> is true, with attributes
</p>
<table>
<tr style="vertical-align: top;">
<td><code>error</code></td>
<td>
<p>estimated absolute error and</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>msg</code></td>
<td>
<p>status message (a <code>character</code> string).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>algorithm</code></td>
<td>
<p>a <code>character</code> string with <code>class(algorithm)</code>.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Genz, A. and Bretz, F. (1999), Numerical computation of multivariate
t-probabilities with application to power calculation of multiple
contrasts. <em>Journal of Statistical Computation and Simulation</em>,
<b>63</b>, 361–378.
</p>
<p>Genz, A. and Bretz, F. (2002), Methods for the computation of multivariate
t-probabilities. <em>Journal of Computational and Graphical Statistics</em>,
<b>11</b>, 950–971.
</p>
<p>Genz, A. (2004), Numerical computation of rectangular bivariate and
trivariate normal and t-probabilities, <em>Statistics and
Computing</em>, <b>14</b>, 251–260.
</p>
<p>Genz, A. and Bretz, F. (2009), <em>Computation of Multivariate Normal and
t Probabilities</em>. Lecture Notes in Statistics, Vol. 195. Springer-Verlag,
Heidelberg.
</p>
<p>S. Kotz and S. Nadarajah (2004), <em>Multivariate t Distributions and
Their Applications</em>. Cambridge University Press. Cambridge.
</p>
<p>Edwards D. and Berry, Jack J. (1987), The efficiency of simulation-based
multiple comparisons. <em>Biometrics</em>, <b>43</b>, 913–928.
</p>


<h3>See Also</h3>

<p><code>qmvt</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
n &lt;- 5
lower &lt;- -1
upper &lt;- 3
df &lt;- 4
corr &lt;- diag(5)
corr[lower.tri(corr)] &lt;- 0.5
delta &lt;- rep(0, 5)
prob &lt;- pmvt(lower=lower, upper=upper, delta=delta, df=df, corr=corr)
print(prob)

pmvt(lower=-Inf, upper=3, df = 3, sigma = 1) == pt(3, 3)

# Example from R News paper (original by Edwards and Berry, 1987)

n &lt;- c(26, 24, 20, 33, 32)
V &lt;- diag(1/n)
df &lt;- 130
C &lt;- c(1,1,1,0,0,-1,0,0,1,0,0,-1,0,0,1,0,0,0,-1,-1,0,0,-1,0,0)
C &lt;- matrix(C, ncol=5)
### scale matrix
cv &lt;- C %*% tcrossprod(V, C)
### correlation matrix
cr &lt;- cov2cor(cv)
delta &lt;- rep(0,5)

myfct &lt;- function(q, alpha) {
  lower &lt;- rep(-q, ncol(cv))
  upper &lt;- rep(q, ncol(cv))
  pmvt(lower=lower, upper=upper, delta=delta, df=df,
       corr=cr, abseps=0.0001) - alpha
}

### uniroot for this simple problem
round(uniroot(myfct, lower=1, upper=5, alpha=0.95)$root, 3)

# compare pmvt and pmvnorm for large df:

a &lt;- pmvnorm(lower=-Inf, upper=1, mean=rep(0, 5), corr=diag(5))
b &lt;- pmvt(lower=-Inf, upper=1, delta=rep(0, 5), df=300,
          corr=diag(5))
a
b

stopifnot(round(a, 2) == round(b, 2))

# correlation and scale matrix

a &lt;- pmvt(lower=-Inf, upper=2, delta=rep(0,5), df=3,
          sigma = diag(5)*2)
b &lt;- pmvt(lower=-Inf, upper=2/sqrt(2), delta=rep(0,5),
          df=3, corr=diag(5))
attributes(a) &lt;- NULL
attributes(b) &lt;- NULL
a
b
stopifnot(all.equal(round(a,3) , round(b, 3)))

a &lt;- pmvt(0, 1,df=10)
attributes(a) &lt;- NULL
b &lt;- pt(1, df=10) - pt(0, df=10)
stopifnot(all.equal(round(a,10) , round(b, 10)))

</code></pre>


</div>