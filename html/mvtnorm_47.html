<div class="container">

<table style="width: 100%;"><tr>
<td>Mvt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The Multivariate t Distribution</h2>

<h3>Description</h3>

<p>These functions provide information about the multivariate <code class="reqn">t</code>
distribution with non-centrality parameter (or mode) <code>delta</code>,
scale matrix <code>sigma</code> and degrees of freedom <code>df</code>.
<code>dmvt</code> gives the density and <code>rmvt</code>
generates random deviates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rmvt(n, sigma = diag(2), df = 1, delta = rep(0, nrow(sigma)),
     type = c("shifted", "Kshirsagar"), ...)
dmvt(x, delta = rep(0, p), sigma = diag(p), df = 1, log = TRUE,
     type = "shifted", checkSymmetry = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector or matrix of quantiles. If <code>x</code> is a matrix, each
row is taken to be a quantile.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>the vector of noncentrality parameters of length n, for
<code>type = "shifted"</code> delta specifies the mode.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>scale matrix, defaults to
<code>diag(ncol(x))</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>degrees of freedom. <code>df = 0</code> or <code>df = Inf</code>
corresponds to the multivariate normal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p><code>logical</code> indicating whether densities <code class="reqn">d</code>
are given as <code class="reqn">\log(d)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of the noncentral multivariate <code class="reqn">t</code> distribution.
<code>type = "Kshirsagar"</code> corresponds
to formula (1.4) in Genz and Bretz (2009) (see also
Chapter 5.1 in Kotz and Nadarajah (2004)). This is the
noncentral t-distribution  needed for calculating
the power of multiple contrast tests under a normality
assumption. <code>type = "shifted"</code> corresponds to the
formula right before formula (1.4) in Genz and Bretz (2009)
(see also formula (1.1) in Kotz and Nadarajah (2004)). It
is a location shifted version of the central t-distribution.
This noncentral multivariate <code class="reqn">t</code> distribution appears for
example as the Bayesian posterior distribution
for the regression coefficients in a linear regression.
In the central case both types coincide.
Note that the defaults differ from the default
in <code>pmvt()</code> (for reasons of backward
compatibility).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>checkSymmetry</code></td>
<td>
<p>logical; if <code>FALSE</code>, skip checking whether the
covariance matrix is symmetric or not. This will speed up the
computation but may cause unexpected outputs when ill-behaved
<code>sigma</code> is provided. The default value is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to <code>rmvnorm()</code>,
for example <code>method</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code class="reqn">\bm{X}</code> denotes a random vector following a <code class="reqn">t</code> distribution
with location vector <code class="reqn">\bm{0}</code> and scale matrix
<code class="reqn">\Sigma</code> (written <code class="reqn">X\sim t_\nu(\bm{0},\Sigma)</code>), the scale matrix (the argument
<code>sigma</code>) is not equal to the covariance matrix <code class="reqn">Cov(\bm{X})</code>
of <code class="reqn">\bm{X}</code>. If the degrees of freedom <code class="reqn">\nu</code> (the
argument <code>df</code>) is larger than 2, then
<code class="reqn">Cov(\bm{X})=\Sigma\nu/(\nu-2)</code>. Furthermore,
in this case the correlation matrix <code class="reqn">Cor(\bm{X})</code> equals
the correlation matrix corresponding to the scale matrix
<code class="reqn">\Sigma</code> (which can be computed with
<code>cov2cor()</code>). Note that the scale matrix is sometimes
referred to as “dispersion matrix”;
see McNeil, Frey, Embrechts (2005, p. 74).
</p>
<p>For <code>type = "shifted"</code> the density
</p>
<p style="text-align: center;"><code class="reqn">c(1+(x-\delta)'S^{-1}(x-\delta)/\nu)^{-(\nu+m)/2}</code>
</p>

<p>is implemented, where
</p>
<p style="text-align: center;"><code class="reqn">c = \Gamma((\nu+m)/2)/((\pi \nu)^{m/2}\Gamma(\nu/2)|S|^{1/2}),</code>
</p>

<p><code class="reqn">S</code> is a positive definite symmetric matrix (the matrix
<code>sigma</code> above), <code class="reqn">\delta</code> is the
non-centrality vector and <code class="reqn">\nu</code> are the degrees of freedom.
</p>
<p><code>df=0</code> historically leads to the multivariate normal
distribution. From a mathematical point of view, rather
<code>df=Inf</code> corresponds to the multivariate normal
distribution. This is (now) also allowed for <code>rmvt()</code> and
<code>dmvt()</code>.
</p>
<p>Note that <code>dmvt()</code> has default <code>log = TRUE</code>, whereas
<code>dmvnorm()</code> has default <code>log = FALSE</code>.
</p>


<h3>References</h3>

<p>McNeil, A. J., Frey, R., and Embrechts, P. (2005).
<em>Quantitative Risk Management: Concepts, Techniques, Tools</em>.
Princeton University Press.
</p>


<h3>See Also</h3>

<p><code>pmvt()</code> and <code>qmvt()</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## basic evaluation
dmvt(x = c(0,0), sigma = diag(2))

## check behavior for df=0 and df=Inf
x &lt;- c(1.23, 4.56)
mu &lt;- 1:2
Sigma &lt;- diag(2)
x0 &lt;- dmvt(x, delta = mu, sigma = Sigma, df = 0) # default log = TRUE!
x8 &lt;- dmvt(x, delta = mu, sigma = Sigma, df = Inf) # default log = TRUE!
xn &lt;- dmvnorm(x, mean = mu, sigma = Sigma, log = TRUE)
stopifnot(identical(x0, x8), identical(x0, xn))

## X ~ t_3(0, diag(2))
x &lt;- rmvt(100, sigma = diag(2), df = 3) # t_3(0, diag(2)) sample
plot(x)

## X ~ t_3(mu, Sigma)
n &lt;- 1000
mu &lt;- 1:2
Sigma &lt;- matrix(c(4, 2, 2, 3), ncol=2)
set.seed(271)
x &lt;- rep(mu, each=n) + rmvt(n, sigma=Sigma, df=3)
plot(x)

## Note that the call rmvt(n, mean=mu, sigma=Sigma, df=3) does *not*
## give a valid sample from t_3(mu, Sigma)! [and thus throws an error]
try(rmvt(n, mean=mu, sigma=Sigma, df=3))

## df=Inf correctly samples from a multivariate normal distribution
set.seed(271)
x &lt;- rep(mu, each=n) + rmvt(n, sigma=Sigma, df=Inf)
set.seed(271)
x. &lt;- rmvnorm(n, mean=mu, sigma=Sigma)
stopifnot(identical(x, x.))
</code></pre>


</div>