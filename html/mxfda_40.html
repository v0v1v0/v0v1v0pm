<div class="container">

<table style="width: 100%;"><tr>
<td>run_fcm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Run Function Cox Models</h2>

<h3>Description</h3>

<p>Fit a functional Cox regression model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">run_fcm(
  mxFDAobject,
  model_name,
  formula,
  event = "event",
  metric = "uni k",
  r = "r",
  value = "fundiff",
  afcm = FALSE,
  smooth = FALSE,
  filter_cols = NULL,
  ...,
  knots = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mxFDAobject</code></td>
<td>
<p>Dataframe of spatial summary functions from multiplex imaging data, in long format. Can be estimated using the function <code>extract_summary_functions</code> or provided separately.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model_name</code></td>
<td>
<p>character string to give the fit model in the functional cox slot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>Formula to be fed to mgcv in the form of survival_time ~ x1 + x2. Does not contain functional predictor. Character valued. Data must contain censoring variable called "event".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>event</code></td>
<td>
<p>character string for the column in Metadata that contains 1/0 for the survival event</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>
<p>name of calculated spatial metric to use</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>Character string, the name of the variable that identifies the function domain (usually a radius for spatial summary functions). Default is "r".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>Character string, the name of the variable that identifies the spatial summary function values. Default is "fundiff".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>afcm</code></td>
<td>
<p>If TRUE, runs additive functional Cox model. If FALSE, runs linear functional cox model. Defaults to linear functional cox model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth</code></td>
<td>
<p>Option to smooth data using FPCA. Defaults to FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter_cols</code></td>
<td>
<p>a named vector of factors to filter summary functions to in <code>c(Derived_Column = "Level_to_Filter")</code> format</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Optional other arguments to be passed to <code>fpca.face</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p>Number of knots for defining spline basis.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt="[Stable]"></a>
</p>


<h3>Value</h3>

<p>A <code>list</code> which is a linear or additive functional Cox model fit. See <code>mgcv::gam</code> for more details.
</p>


<h3>Author(s)</h3>

<p>Julia Wrobel <a href="mailto:julia.wrobel@emory.edu">julia.wrobel@emory.edu</a>
</p>
<p>Alex Soupir <a href="mailto:alex.soupir@moffitt.org">alex.soupir@moffitt.org</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#load ovarian mxFDA object
data('ovarian_FDA')

#run the lfcm model
ovarian_FDA = run_fcm(ovarian_FDA, model_name = "fit_lfcm",
                      formula = survival_time ~ age, event = "event",
                      metric = "uni g", r = "r", value = "fundiff",
                      afcm = FALSE)

</code></pre>


</div>