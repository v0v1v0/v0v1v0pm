<div class="container">

<table style="width: 100%;"><tr>
<td>run_fpca</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>run_fpca</h2>

<h3>Description</h3>

<p>This is a wrapper for the function <code>fpca.face</code> from the <code>refund</code> package. EXPAND
</p>


<h3>Usage</h3>

<pre><code class="language-R">run_fpca(
  mxFDAobject,
  metric = "uni k",
  r = "r",
  value = "fundiff",
  knots = NULL,
  analysis_vars = NULL,
  lightweight = FALSE,
  filter_cols = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mxFDAobject</code></td>
<td>
<p>object of class <code>mxFDA</code> created by <code>make_mxfda</code> with metrics derived with <code>extract_summary_functions</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>
<p>name of calculated spatial metric to use</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>Character string, the name of the variable that identifies the function domain (usually a radius for spatial summary functions). Default is "r".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>Character string, the name of the variable that identifies the spatial summary function values. Default is "fundiff".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p>Number of knots for defining spline basis.Defaults to the number of measurements per function divided by 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>analysis_vars</code></td>
<td>
<p>Optional list of variables to be retained for downstream analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lightweight</code></td>
<td>
<p>Default is FALSE. If TRUE, removes Y and Yhat from returned FPCA object. A good option to select for large datasets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter_cols</code></td>
<td>
<p>a named vector of factors to filter summary functions to in <code>c(Derived_Column = "Level_to_Filter")</code> format</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Optional other arguments to be passed to <code>fpca.face</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt="[Stable]"></a>
</p>
<p>The <code>filter_cols</code> parameter is useful when the summary function was input by the user using <code>add_summary_function()</code> and the multiple marks were assessed; a column called "Markers" with tumor infiltrating lymphocytes as well as cytotoxic T cells. This parameter allows for filtering down to include only one or the other.
</p>


<h3>Value</h3>

<p>A <code>mxFDA</code> object with the <code>functional_pca</code> slot filled for the respective spatial summary function containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mxfundata</code></td>
<td>
<p>The original dataframe of spatial summary functions, with scores from FPCA appended for downstream modeling</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fpc_object</code></td>
<td>
<p>A list of class "fpca" with elements described in the documentation for  <code>refund::fpca.face</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Julia Wrobel <a href="mailto:julia.wrobel@emory.edu">julia.wrobel@emory.edu</a>
</p>
<p>Alex Soupir <a href="mailto:alex.soupir@moffitt.org">alex.soupir@moffitt.org</a>
</p>


<h3>References</h3>

<p>Xiao, L., Ruppert, D., Zipunnikov, V., and Crainiceanu, C. (2016).
Fast covariance estimation for high-dimensional functional data.
<em>Statistics and Computing</em>, 26, 409-421.
DOI: 10.1007/s11222-014-9485-x.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#load ovarian mxFDA object
data('ovarian_FDA')

#run the FPCA
ovarian_FDA = run_fpca(ovarian_FDA, metric = "uni g", r = "r", value = "fundiff",
                       lightweight = TRUE,
                       pve = .99)

</code></pre>


</div>