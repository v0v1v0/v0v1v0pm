<div class="container">

<table style="width: 100%;"><tr>
<td>run_mfpca</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>run_fpca</h2>

<h3>Description</h3>

<p>This is a wrapper for the function <code>mfpca.face</code> from the <code>refund</code> package. EXPAND
</p>


<h3>Usage</h3>

<pre><code class="language-R">run_mfpca(
  mxFDAobject,
  metric = "uni k",
  r = "r",
  value = "fundiff",
  knots = NULL,
  lightweight = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mxFDAobject</code></td>
<td>
<p>object of class <code>mxFDA</code> created by <code>make_mxfda()</code> with metrics derived with <code>extract_summary_functions()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>
<p>name of calculated spatial metric to use</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>Character string, the name of the variable that identifies the function domain (usually a radius for spatial summary functions). Default is "r".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>Character string, the name of the variable that identifies the spatial summary function values. Default is "fundiff".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p>Number of knots for defining spline basis.Defaults to the number of measurements per function divided by 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lightweight</code></td>
<td>
<p>Default is FALSE. If TRUE, removes Y and Yhat from returned mFPCA object. A good option to select for large datasets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Optional other arguments to be passed to <code>mfpca.face</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt="[Stable]"></a>
</p>


<h3>Value</h3>

<p>A <code>mxFDA</code> object  with the <code>functional_mpca</code> slot for the respective spatial summary function containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mxfundata</code></td>
<td>
<p>The original dataframe of spatial summary functions, with scores from FPCA appended for downstream modeling</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fpc_object</code></td>
<td>
<p>A list of class "fpca" with elements described in the documentation for  <code>refund::fpca.face</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>unknown <a href="mailto:first.last@domain.extension">first.last@domain.extension</a>
</p>
<p>Julia Wrobel <a href="mailto:julia.wrobel@emory.edu">julia.wrobel@emory.edu</a>
</p>
<p>Alex Soupir <a href="mailto:alex.soupir@moffitt.org">alex.soupir@moffitt.org</a>
</p>


<h3>References</h3>

<p>Xiao, L., Ruppert, D., Zipunnikov, V., and Crainiceanu, C. (2016).
Fast covariance estimation for high-dimensional functional data.
<em>Statistics and Computing</em>, 26, 409-421.
DOI: 10.1007/s11222-014-9485-x.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#load data
data(lung_FDA)

#run mixed fpca
lung_FDA = run_mfpca(lung_FDA, metric = 'uni g')

</code></pre>


</div>