<div class="container">

<table style="width: 100%;"><tr>
<td>run_sofr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Run Scalar on Function Regression</h2>

<h3>Description</h3>

<p>Fit a scalar-on-function regression model. Uses refund::pfr under the hood for computations, and stores results in the mxfda object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">run_sofr(
  mxFDAobject,
  model_name,
  formula,
  family = "gaussian",
  metric = "uni k",
  r = "r",
  value = "fundiff",
  smooth = FALSE,
  filter_cols = NULL,
  ...,
  knots = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mxFDAobject</code></td>
<td>
<p>Dataframe of spatial summary functions from multiplex imaging data, in long format. Can be estimated using the function <code>extract_summary_functions</code> or provided separately.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model_name</code></td>
<td>
<p>character string to give the fit model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>Formula to be fed to mgcv in the form of outcome ~ x1 + x2. Does not contain functional predictor. Character valued.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>Exponential family distribution to be passed to <code>mgcv::gam</code>. Defaults to "gaussian". Select "binomial" for binary outcome.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>
<p>Name of calculated spatial metric to use</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>Character string, the name of the variable that identifies the function domain (usually a radius for spatial summary functions). Default is "r".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>Character string, the name of the variable that identifies the spatial summary function values. Default is "fundiff".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth</code></td>
<td>
<p>Option to smooth data using FPCA. Defaults to FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter_cols</code></td>
<td>
<p>a named vector of factors to filter summary functions to in <code>c(Derived_Column = "Level_to_Filter")</code> format</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Optional other arguments to be passed to <code>fpca.face</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p>Number of knots for defining spline basis.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt="[Stable]"></a>
</p>


<h3>Value</h3>

<p>A <code>list</code> which is a linear or additive functional Cox model fit. See <code>mgcv::gam</code> for more details.
</p>


<h3>Author(s)</h3>

<p>Julia Wrobel <a href="mailto:julia.wrobel@emory.edu">julia.wrobel@emory.edu</a>
</p>
<p>Alex Soupir <a href="mailto:alex.soupir@moffitt.org">alex.soupir@moffitt.org</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#load ovarian mxFDA object
data('ovarian_FDA')

# run scalar on function regression model with a continuous outcome (age)
ovarian_FDA = run_sofr(ovarian_FDA,
                       model_name = "fit_sofr",
                       formula = age~stage,
                       metric = "uni g", r = "r", value = "fundiff")

# run scalar on function regression model with a binary outcome (stage)
# also known as functional logistic regression
ovarian_FDA = run_sofr(ovarian_FDA,
                       model_name = "fit_sofr",
                       formula = stage~age,
                       family = "binomial",
                       metric = "uni g", r = "r", value = "fundiff")

</code></pre>


</div>