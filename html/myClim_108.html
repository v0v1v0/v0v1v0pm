<div class="container">

<table style="width: 100%;"><tr>
<td>mc_states_insert</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Insert new sensor states (tags)</h2>

<h3>Description</h3>

<p>This function inserts new states (tags) into the selected part of the sensor
time-series. For more information about the structure of states (tags),
see myClim-package. <code>mc_states_insert()</code> does not affect
existing rows in the states (tags) table but only inserts new rows even if
the new ones are identical with existing (resulting in duplicated states).
</p>


<h3>Usage</h3>

<pre><code class="language-R">mc_states_insert(data, states_table)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>cleaned myClim object see myClim-package</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>states_table</code></td>
<td>
<p>Output of <code>mc_info_states()</code> can be used as template for input data.frame.
data.frame with columns:
</p>

<ul>
<li>
<p> locality_id - the name of locality (in some cases identical to logger id, see mc_read_files)
</p>
</li>
<li>
<p> logger_index - index of logger in myClim object at the locality. See mc_info_logger.
</p>
</li>
<li>
<p> sensor_name - sensor name either original (e.g., TMS_T1, T_C), or calculated/renamed (e.g., "TMS_T1_max", "my_sensor01")
</p>
</li>
<li>
<p> tag - category of state (e.g., "conflict", "error", "source", "quality")
</p>
</li>
<li>
<p> start - start datetime
</p>
</li>
<li>
<p> end - end datetime
</p>
</li>
<li>
<p> value - value of tag (e.g., "out of soil", "c:/users/John/tmsData/data_911235678.csv")
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Details</h3>

<p>As a template for inserting states (tags), it is recommended to use
the output of <code>mc_info_states()</code>, which will return the table with all necessary
columns correctly named. The <code>sensor_name</code> and <code>value</code> columns are optional and do not
need to be filled in.
</p>
<p>When <code>locality_id</code> is provided but <code>sensor_name</code> is NA in the states (tags) table,
states are inserted for all sensors within the locality.
</p>
<p>The states (tags) are associated with the sensor time-series, specifically to
the defined part of the time-series identified by start and end date times. A
single time series can contain multiple states (tags) of identical or different types, and these
states (tags) can overlap. Start and end date times are adjusted to fit within
the range of logger/locality datetime and are rounded according to the logger's step. For instance,
if a user attempts to insert a tag beyond the sensor time-series range, <code>mc_states_insert</code>
will adjust the start and end times to fit the available measurements. If a user defines a start time as
'2020-01-01 10:23:00' on a logger with a 15-minute step, it will be rounded to '2020-01-01 10:30:00'.
</p>


<h3>Value</h3>

<p>myClim object in the same format as input, with inserted sensor states
</p>


<h3>Examples</h3>

<pre><code class="language-R">states &lt;- data.frame(locality_id="A1E05", logger_index=1, sensor_name="Thermo_T", tag="error",
                     start=lubridate::ymd_hm("2020-10-28 9:00"),
                     end=lubridate::ymd_hm("2020-10-28 9:30"))
data &lt;- mc_states_insert(mc_data_example_clean, states)
</code></pre>


</div>