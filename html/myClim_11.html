<div class="container">

<table style="width: 100%;"><tr>
<td>mc_calc_vwc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Conversion of raw TMS soil moisture values to volumetric water content (VWC)</h2>

<h3>Description</h3>

<p>This function creates a new virtual sensor on the locality within the myClim data object.
Function converts the raw TMS soil moisture (scaled TDT signal)
to volumetric water content (VWC).
</p>


<h3>Usage</h3>

<pre><code class="language-R">mc_calc_vwc(
  data,
  moist_sensor = mc_const_SENSOR_TMS_moist,
  temp_sensor = mc_const_SENSOR_TMS_T1,
  output_sensor = "VWC_moisture",
  soiltype = "universal",
  localities = NULL,
  ref_t = mc_const_CALIB_MOIST_REF_T,
  acor_t = mc_const_CALIB_MOIST_ACOR_T,
  wcor_t = mc_const_CALIB_MOIST_WCOR_T,
  frozen2NA = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>cleaned myClim object see myClim-package</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>moist_sensor</code></td>
<td>
<p>name of soil moisture sensor to be converted from TMS
moisture values to volumetric water content (default "TMS_moist") see <code>names(mc_data_sensors)</code>.
Soil moisture sensor must be in moisture_raw physical units see <code>names(mc_data_physical)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>temp_sensor</code></td>
<td>
<p>name of soil temperature sensor (default "TMS_T1")
see <code>names(mc_data_sensors)</code>. Temperature sensor must be in T_C physical units.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output_sensor</code></td>
<td>
<p>name of new virtual sensor with VWC values (default "VWC_moisture")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>soiltype</code></td>
<td>
<p>Either character corresponding to one of <code>soiltype</code> from mc_data_vwc_parameters
(default <code>"universal"</code>), or a list with parameters <code>a</code>, <code>b</code> and <code>c</code> provided
by the user as a <code>list(a=Value_1, b=Value_2, c=Value_3)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>localities</code></td>
<td>
<p>list of locality_ids used for calculation; if NULL then all localities are used (default NULL)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref_t</code></td>
<td>
<p>(default 24)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acor_t</code></td>
<td>
<p>(default 1.91132689118083) correction parameter for temperature drift
in the air, see <code>mc_calib_moisture()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wcor_t</code></td>
<td>
<p>(default 0.64108) correction parameter for temperature drift
in the water, see <code>mc_calib_moisture()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frozen2NA</code></td>
<td>
<p>if TRUE then VWC values are set to NA when the soil temperature is below 0 °C (default TRUE)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is suitable for TOMST TMS loggers measuring soil moisture in raw TMS units.
The raw TMS units represents inverted and numerically rescaled (1-4095) electromagnetic signal from the moisture sensor working
on Time Domain Transmission principle (Wild et al. 2019). For TMS4 logger, the typical raw TMS moisture values range from cca
115 units in dry air to cca 3635 units in distilled water - see mc_calib_moisture.
</p>
<p>Raw TMS moisture values can be converted to the soil volumetric water content with calibration curves. The function provides
several experimentally derived calibration curves which were developped at reference temperature. To account for the difference
between reference and actual temperature, the function uses actual soil temperature values measured by TMS_T1 soil temperature
sensor.
</p>
<p>The default calibration curve is "universal", which was designed for mineral soils (see Kopecký et al. 2021).
Specific calibration curves were developed for several soil types (see Wild et al. 2019) and the user can choose one of these
or can define its own calibration - see mc_data_vwc_parameters
</p>
<p>Currently available calibration curves are: sand, loamy sand A,
loamy sand B, sandy loam A, sandy loam B, loam, silt loam, peat, water,
universal, sand TMS1, loamy sand TMS1, silt loam TMS1.
For details see mc_data_vwc_parameters.
</p>
<p>It is also possible to define a new calibarion function with custom parameters <code>a</code>, <code>b</code> and <code>c</code>. These can be
derived e.g. from TOMST TMS Calibr utility after entering custom ratio of clay, silt, sand.
</p>
<p><strong>Warning:</strong> TOMST TMS Calibr utility was developed for TMS3 series of TMS loggers, which have
different range of raw soil moisture values than TMS4 series.
</p>
<p>The function by default replace the moisture records in frozen soils with NA (param <em>frozen2NA</em>),
because the TMS soil moisture sensor was not designed to measure in frozen soils and the returned values are thus not comparable
with values from non-frozen soil.
</p>


<h3>Value</h3>

<p>myClim object same as input but with added virtual VWC moisture sensor
</p>


<h3>References</h3>

<p>Wild, J., Kopecký, M., Macek, M., Šanda, M., Jankovec, J., Haase, T. (2019) Climate at ecologically relevant scales:
A new temperature and soil moisture logger for long-term microclimate measurement. Agriculture and Forest Meteorology 268, 40-47.
https://doi.org/10.1016/j.agrformet.2018.12.018
</p>
<p>Kopecký, M., Macek, M., Wild, J. (2021) Topographic Wetness Index calculation guidelines based on measured soil
moisture and plant species composition. Science of the Total Environment 757, 143785. https://doi.org/10.1016/j.scitotenv.2020.143785
</p>


<h3>See Also</h3>

<p>mc_data_vwc_parameters
</p>


<h3>Examples</h3>

<pre><code class="language-R">data1 &lt;- mc_calc_vwc(mc_data_example_agg, soiltype="sand", localities="A2E32")
data2 &lt;- mc_calc_vwc(mc_data_example_agg, localities="A2E32",
                     soiltype=list(a=-3.00e-09, b=0.000161192, c=-0.109956505))
</code></pre>


</div>