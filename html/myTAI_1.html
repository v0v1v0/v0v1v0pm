<div class="container">

<table style="width: 100%;"><tr>
<td>age.apply</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Age Category Specific apply Function</h2>

<h3>Description</h3>

<p>This function performs the split-apply-combine methodology on Phylostrata or Divergence Strata stored within the input ExpressionSet.
</p>
<p>This function is very useful to perform any phylostratum or divergence-stratum specific analysis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">age.apply(ExpressionSet, FUN, ..., as.list = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ExpressionSet</code></td>
<td>
<p>a standard PhyloExpressionSet or DivergenceExpressionSet object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN</code></td>
<td>
<p>a function to be performed on the corresponding expression matrix of each phylostratum or divergence-stratum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments of FUN.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as.list</code></td>
<td>
<p>a boolean value specifying whether the output format shall be a matrix or a list object.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function uses the <code>split</code> function to subset the expression matrix into
phylostratum specific sub-matrices. Internally using <code>lapply</code>, any function can
be performed to the sub-matrices. The return value of this function is a numeric matrix storing
the return values by <code>FUN</code> for each phylostratum and each developmental stage s. 
Note that the input <code>FUN</code> must be an function that can be applied to a matrix (e.g., <code>colMeans</code> or <code>RE</code>). 
In case you use an an anymous function you coud use <code>function(x) apply(x , 2 , var)</code> as an example to compute the variance of each phylostratum and each
developmental stage s.
</p>


<h3>Value</h3>

<p>Either a numeric matrix storing the return values of the applied function for each age class
or a numeric list storing the return values of the applied function for each age class in a list.
</p>


<h3>Author(s)</h3>

<p>Hajk-Georg Drost
</p>


<h3>See Also</h3>

<p><code>split</code>, <code>tapply</code>, <code>lapply</code>, <code>RE</code>, <code>REMatrix</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> 
 # source the example dataset
 data(PhyloExpressionSetExample)
 
# Example 1
# get the relative expression profiles for each phylostratum
age.apply(PhyloExpressionSetExample, RE)

# this is analogous to 
REMatrix(PhyloExpressionSetExample)
# Example 2
# compute the mean expression profiles for each phylostratum
age.apply(PhyloExpressionSetExample, colMeans)

# Example 3
# compute the variance profiles for each phylostratum
age.apply(PhyloExpressionSetExample, function(x) apply(x , 2 , var))

# Example 4
# compute the range for each phylostratum
# Note: in this case, the range() function returns 2 values for each phylostratum
# and each developmental stage, hence one should use the argument 'as.list = TRUE'
# to make sure that the results are returned properly 
age.apply(PhyloExpressionSetExample, function(x) apply(x , 2 , range), as.list = TRUE)

</code></pre>


</div>