<div class="container">

<table style="width: 100%;"><tr>
<td>EnrichmentTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Phylostratum or Divergence Stratum Enrichment of a given Gene Set based on Fisher's Test</h2>

<h3>Description</h3>

<p>This function computes the significance of enriched (over or underrepresented) Phylostrata or Divergence Strata within an input <code>test.set</code> based on the <code>fisher.test</code>. Please concult <code>PlotEnrichment</code> for details.
</p>


<h3>Usage</h3>

<pre><code class="language-R">EnrichmentTest(
  ExpressionSet,
  test.set,
  use.only.map = FALSE,
  measure = "log-foldchange",
  complete.bg = TRUE,
  epsilon = 1e-05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ExpressionSet</code></td>
<td>
<p>a standard PhyloExpressionSet or DivergenceExpressionSet object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test.set</code></td>
<td>
<p>a character vector storing the gene ids for which PS/DS enrichment analyses should be performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.only.map</code></td>
<td>
<p>a logical value indicating whether instead of a standard <code>ExpressionSet</code> only a <code>Phylostratigraphic Map</code> or <code>Divergene Map</code> is passed to this function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>measure</code></td>
<td>
<p>a character string specifying the measure that should be used to quantify over and under representation of PS/DS. Measures can either be <code>measure = "foldchange"</code> (odds) or <code>measure = "log-foldchange"</code> (log-odds).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>complete.bg</code></td>
<td>
<p>a logical value indicating whether the entire background set of the input ExpressionSet should be considered when performing Fisher's exact test (<code>complete.bg = TRUE</code>) or whether genes that are stored in test.set should be excluded from the background set before performing Fisher's exact test (<code>complete.bg = FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>a small value to shift values by epsilon to avoid log(0) computations.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Hajk-Georg Drost
</p>


<h3>See Also</h3>

<p><code>PlotEnrichment</code>, <code>fisher.test</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(PhyloExpressionSetExample)

set.seed(123)
test_set &lt;- sample(PhyloExpressionSetExample[ , 2],1000)

E.Result &lt;- EnrichmentTest(ExpressionSet = PhyloExpressionSetExample,
                           test.set      = test_set ,
                           measure       = "log-foldchange")
                           
# get the log-fold change table
E.Result$enrichment.matrix

# get P-values for the enrichment significance for each Phylostratum
E.Result$p.values

</code></pre>


</div>