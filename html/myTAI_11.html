<div class="container">

<table style="width: 100%;"><tr>
<td>Expressed</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Filter for Expressed Genes</h2>

<h3>Description</h3>

<p>This function takes an ExpressionSet object and removes genes from the gene expression matrix that
have an expression level below, above, or below AND above a defined <code>cut.off</code> value. Hence, this function allows to remove
genes that have been defined as <em>not expressed</em> or <em>outliers</em> and returns an <code>ExpressionSet</code> retaining only expressed genes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Expressed(
  ExpressionSet,
  cut.off,
  method = "const",
  comparison = "below",
  n = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ExpressionSet</code></td>
<td>
<p>a standard PhyloExpressionSet or DivergenceExpressionSet object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cut.off</code></td>
<td>
<p>a numeric value specifying the expression cut-off to define genes as <em>not expressed</em> (<code>comparison = "below"</code>) , <em>outliers</em> (<code>comparison = "above"</code>), or both (<code>comparison = "both"</code>). See <code>comparison</code> for details. In case <code>comparison = "both"</code>, the <code>cut.off</code> argument must be a two dimensional vector defining the lower <code>cut.off</code> value at the first position and the upper <code>cut.off</code> value at the second position.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a method defining how to treat gene expression values in multiple stages. The corresponding method that is chosen allows to control the stage-wise fulfillment of the threshold criteria. Options are <code>"const"</code>, <code>"min-set"</code>, and <code>"n-set"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comparison</code></td>
<td>
<p>a character string specifying whether genes having expression levels
below, above, or below AND above (both) the <code>cut.off</code> value should be excluded from the dataset.
In case <code>comparison = "both"</code> is chosen, the <code>cut.off</code> argument must be a two dimensional vector defining the lower <code>cut.off</code> value at the first position and the upper <code>cut.off</code> value
at the second position.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>a numeric value for <code>method = "n-set"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This filter function allows users to remove genes from the <code>ExpressionSet</code> object that undercut or exceed a certain expression level <code>cut.off</code>.
</p>
<p>Following extraction criteria are implemented in this function: 
</p>

<ul>
<li> <p><code>const</code>: all genes that have at least one stage that undercuts or exceeds the expression <code>cut.off</code> will be excluded from the <code>ExpressionSet</code>. Hence, for a 7 stage <code>ExpressionSet</code> genes passing the expression level <code>cut.off</code> in 6 stages will be retained in the <code>ExpressionSet</code>.
</p>
</li>
<li> <p><code>min-set</code>: genes passing the expression level <code>cut.off</code> in <code>ceiling(n/2)</code> stages will be retained in the <code>ExpressionSet</code>, where <em>n</em> is the number of stages in the <code>ExpressionSet</code>.
</p>
</li>
<li> <p><code>n-set</code>: genes passing the expression level <code>cut.off</code> in <code>n</code> stages will be retained in the <code>ExpressionSet</code>. Here, the argument <code>n</code> needs to be specified.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Hajk-Georg Drost
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(PhyloExpressionSetExample)

# remove genes that have an expression level below 8000 
# in at least one developmental stage
FilterConst &lt;- Expressed(ExpressionSet = PhyloExpressionSetExample, 
                         cut.off       = 8000, 
                         method        = "const",
                         comparison    = "below")
                              
dim(FilterConst) # check number of retained genes

# remove genes that have an expression level below 8000 
# in at least 3 developmental stages 
# (in this case: ceiling(7/2) = 4 stages fulfilling the cut-off criteria)
FilterMinSet &lt;- Expressed(ExpressionSet = PhyloExpressionSetExample, 
                          cut.off       = 8000, 
                          method        = "min-set",
                          comparison    = "below")
                               
dim(FilterMinSet) # check number of retained genes

# remove genes that have an expression level below 8000 
# in at least 5 developmental stages (in this case: n = 2 stages fulfilling the criteria)
FilterNSet &lt;- Expressed(ExpressionSet = PhyloExpressionSetExample, 
                        cut.off       = 8000, 
                        method        = "n-set",
                        comparison    = "below",
                        n             = 2)
                               
dim(FilterMinSet) # check number of retained genes



# remove expression levels that exceed the cut.off criteria
FilterMinSet &lt;- Expressed(ExpressionSet = PhyloExpressionSetExample, 
                          cut.off       = 12000, 
                          method        = "min-set",
                          comparison    = "above")
                               
dim(FilterMinSet) # check number of retained genes


# remove expression levels that undercut AND exceed the cut.off criteria
FilterMinSet &lt;- Expressed(ExpressionSet = PhyloExpressionSetExample, 
                          cut.off       = c(8000,12000), 
                          method        = "min-set",
                          comparison    = "both")
                               
dim(FilterMinSet) # check number of retained genes


</code></pre>


</div>