<div class="container">

<table style="width: 100%;"><tr>
<td>PlotCategoryExpr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot the Expression Levels of each Age or Divergence Category as Boxplot, Violinplot, or Dotplot</h2>

<h3>Description</h3>

<p>This function visualizes the expression level distribution of each phylostratum during each time point or experiment
as boxplot, dot plot, or violin plot enabling users to quantify the age (PS) or divergence (DS) category specific contribution to the
corresponding transcriptome.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PlotCategoryExpr(
  ExpressionSet,
  legendName,
  test.stat = TRUE,
  type = "category-centered",
  distr.type = "boxplot",
  log.expr = FALSE,
  gene.set = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ExpressionSet</code></td>
<td>
<p>a standard PhyloExpressionSet or DivergenceExpressionSet object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legendName</code></td>
<td>
<p>a character string specifying whether "PS" or "DS" are used to compute relative expression profiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test.stat</code></td>
<td>
<p>a logical value indicating whether a Benjamini-Hochberg adjusted <code>kruskal.test</code> should be applied to determine
significant differences in age or divergence category specific expression.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of age or divergence category comparison. Specifications can be <code>type = "category-centered"</code> or <code>type = "stage-centered"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distr.type</code></td>
<td>
<p>format of visualizing age or divergence category specific expression distributions. Either <code>distr.type = "boxplot"</code>, <code>distr.type = "dotplot"</code>, or
<code>distr.type = "violin"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.expr</code></td>
<td>
<p>a logical value specifying whether or not expression levels should internally be log2-transformed before visualization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gene.set</code></td>
<td>
<p>a character vector storing the gene ids for which gene expression levels shall be visualized.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This way of visualizing the gene expression distribution of each age (PS) or divergence (DS) category during
all developmental stages or experiments allows users to detect specific age or divergence categories contributing significant
levels of gene expression to the underlying biological process (transcriptome).
</p>
<p>This quantification allows users to conclude that genes originating in specific PS or DS contribute significantly more to the overall transcriptome
than other genes originating from different PS or DS categories. More specialized analyses such as <code>PlotMeans</code>, <code>PlotRE</code>,
<code>PlotBarRE</code>, etc. will then allow to study the exact mean expression patterns of these age or divergence categories.
</p>
<p>The statistical quantification of differences between expression levels of different age or divergence categories
is done by performing a <code>kruskal.test</code> with Benjamini &amp; Hochberg p-value adjustment for multiple comparisons.
</p>

<ul>
<li> <p><code>type = "category-centered"</code> Here, the <code>kruskal.test</code> quantifies the differences of gene expression between all combinations of age or divergence categories for each stage or experiment separately. Here, a significant p-value quantifies that there is at least one pairwise comparison for which age or divergence categories significantly differ in their gene expression distribution. This type of analysis allows users to detect stages or experiments that show high diviation between age or divergence category contributions to the overall transcriptome or no significant deviations of age or divergence categories, suggesting equal age or divergence category contributions to the overall transcriptome.   
</p>
</li>
<li> <p><code>type = "stage-centered"</code> Here, the <code>kruskal.test</code> quantifies the differences of gene expression between all stages or experiments for each age or divergence category separately. Hence, the test quantifies whether or not the gene expression distribution of a single age or divergence category significantly changes throughout development or experiments. This type of analysis allows users to detect specific age or divergence categories that significantly change their expression levels throughout development or experiments.
</p>
</li>
</ul>
<p>Argument Specifications:
</p>
<p>Argument: type
</p>

<ul>
<li> <p><code>type = "category-centered"</code> This specification allows users to compare the differences between all age or
divergence categories during the same stage or experiment.
</p>
</li>
<li> <p><code>type = "stage-centered"</code> This specification allows users to compare the differences between all age or
divergence categories between stages or experiments.
</p>
</li>
</ul>
<p>Argument: distr.type
</p>

<ul>
<li> <p><code>distr.type = "boxplot"</code> This specification allows users to visualize the expression distribution of all PS or DS as boxplot.
</p>
</li>
<li> <p><code>distr.type = "violin"</code> This specification allows users to visualize the expression distribution of all PS or DS as violin plot.
</p>
</li>
<li> <p><code>distr.type = "dotplot"</code> This specification allows users to visualize the expression distribution of all PS or DS as dot plot.
</p>
</li>
</ul>
<p>Finally, users can specify a <code>gene.set</code> (a subset of genes included in the input <code>ExpressioSet</code>)
for which expression levels should be visualized as boxplot, dotplot, or violinplot.
</p>


<h3>Value</h3>

<p>A boxplot, violin plot, or dot plot visualizing the gene expression levels of
different PS or DS categories.
</p>
<p>Furthermore, the statistical test results returned from the <code>kruskal.test</code> are printed
to the console.
</p>
<p>(1) '*'   = P-Value &lt;= 0.05 
</p>
<p>(2) '**'  = P-Value &lt;= 0.005  
</p>
<p>(3) '***' = P-Value &lt;= 0.0005  
</p>
<p>(4) 'n.s.' = not significant = P-Value &gt; 0.05
</p>


<h3>Author(s)</h3>

<p>Hajk-Georg Drost
</p>


<h3>See Also</h3>

<p><code>PlotMeans</code>, <code>PlotRE</code>, <code>PlotBarRE</code>, <code>age.apply</code>,
<code>pTAI</code>, <code>pTDI</code>, <code>pStrata</code>, <code>pMatrix</code>, <code>TAI</code>, <code>TDI</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(PhyloExpressionSetExample)
data(DivergenceExpressionSetExample)

## Not run: 

# category-centered visualization of PS specific expression level distributions (log-scale)
PlotCategoryExpr(ExpressionSet = PhyloExpressionSetExample,
                     legendName    = "PS",
                     test.stat     = TRUE,
                     type          = "category-centered",
                     distr.type    = "boxplot",
                     log.expr      = TRUE)
                     

# stage-centered visualization of PS specific expression level distributions (log-scale)
PlotCategoryExpr(ExpressionSet = PhyloExpressionSetExample,
                     legendName    = "PS",
                     test.stat     = TRUE,
                     distr.type    = "boxplot",
                     type          = "stage-centered",
                     log.expr      = TRUE)

                     
                                                               
# category-centered visualization of PS specific expression level distributions (log-scale)
# as violoin plot
PlotCategoryExpr(ExpressionSet = PhyloExpressionSetExample,
                     legendName    = "PS",
                     test.stat     = TRUE,
                     distr.type    = "violin",
                     type          = "stage-centered",
                     log.expr      = TRUE)




# analogous for DivergenceExpressionSets
PlotCategoryExpr(ExpressionSet = DivergenceExpressionSetExample,
                     legendName    = "DS",
                     test.stat     = TRUE,
                     type          = "category-centered",
                     distr.type    = "boxplot",
                     log.expr      = TRUE)


# visualize the expression levels of 500 example genes
set.seed(234)
example.gene.set &lt;- PhyloExpressionSetExample[sample(1:25260,500) , 2]

PlotCategoryExpr(ExpressionSet = PhyloExpressionSetExample,
                 legendName    = "PS",
                 test.stat     = TRUE,
                 type          = "category-centered",
                 distr.type    = "boxplot",
                 log.expr      = TRUE,
                 gene.set      = example.gene.set)
                 

## End(Not run)
</code></pre>


</div>