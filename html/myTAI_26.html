<div class="container">

<table style="width: 100%;"><tr>
<td>PlotEnrichment</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot the Phylostratum or Divergence Stratum Enrichment of a given Gene Set</h2>

<h3>Description</h3>

<p>This function computes and visualizes the significance of enriched (over or underrepresented) Phylostrata or Divergence Strata within an input <code>test.set</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PlotEnrichment(
  ExpressionSet,
  test.set,
  use.only.map = FALSE,
  measure = "log-foldchange",
  complete.bg = TRUE,
  legendName = "",
  over.col = "steelblue",
  under.col = "midnightblue",
  epsilon = 1e-05,
  cex.legend = 1,
  cex.asterisk = 1,
  plot.bars = TRUE,
  p.adjust.method = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ExpressionSet</code></td>
<td>
<p>a standard PhyloExpressionSet or DivergenceExpressionSet object (in case <code>only.map = FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test.set</code></td>
<td>
<p>a character vector storing the gene ids for which PS/DS enrichment analyses should be performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.only.map</code></td>
<td>
<p>a logical value indicating whether instead of a standard <code>ExpressionSet</code> only a <code>Phylostratigraphic Map</code> or <code>Divergene Map</code> is passed to this function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>measure</code></td>
<td>
<p>a character string specifying the measure that should be used to quantify over and under representation of PS/DS. Measures can either be <code>measure = "foldchange"</code> (odds) or <code>measure = "log-foldchange"</code> (log-odds).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>complete.bg</code></td>
<td>
<p>a logical value indicating whether the entire background set
of the input <code>ExpressionSet</code> should be considered when performing Fisher's exact
test (<code>complete.bg = TRUE</code>) or whether genes that are stored in <code>test.set</code>
should be excluded from the background set before performing Fisher's exact test
(<code>complete.bg = FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legendName</code></td>
<td>
<p>a character string specifying whether "PS" or "DS" are used to compute relative expression profiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>over.col</code></td>
<td>
<p>color of the overrepresentation bars.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>under.col</code></td>
<td>
<p>color of the underrepresentation bars.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>a small value to shift values by epsilon to avoid log(0) computations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.legend</code></td>
<td>
<p>the <code>cex</code> value for the legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.asterisk</code></td>
<td>
<p>the <code>cex</code> value for the asterisk.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.bars</code></td>
<td>
<p>a logical value specifying whether or not bars should be visualized or whether only <code>p.values</code> and <code>enrichment.matrix</code> should be returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.adjust.method</code></td>
<td>
<p>correction method to adjust p-values for multiple comparisons (see <code>p.adjust</code> for possible methods). E.g., <code>p.adjust.method = "BH"</code> (Benjamini &amp; Hochberg (1995)) or <code>p.adjust.method = "bonferroni"</code> (Bonferroni correction).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>default graphics parameters.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This <em>Phylostratum</em> or <em>Divergence Stratum</em> enrichment analysis is motivated 
by Sestak and Domazet-Loso (2015) who perform <em>Phylostratum</em> or <em>Divergence Stratum</em> enrichment analyses to correlate organ evolution with the origin of organ specific genes. 
</p>
<p>In detail this function takes the <em>Phylostratum</em> or <em>Divergence Stratum</em> distribution of all genes stored in the input <code>ExpressionSet</code> as background set and
the <em>Phylostratum</em> or <em>Divergence Stratum</em> distribution of the <code>test.set</code> and performes a <code>fisher.test</code> for each <em>Phylostratum</em> or <em>Divergence Stratum</em> to quantify the statistical significance of over- or underrepresentated <em>Phylostrata</em> or <em>Divergence Strata</em> within the set of selected <code>test.set</code> genes. 
</p>
<p>To visualize the odds or log-odds of over or underrepresented genes within the <code>test.set</code> the following procedure is performed:
</p>

<ul>
<li>
<p> N_ij denotes the number of genes in group j and deriving from PS i, with <em>i = 1, .. , n</em> and where <em>j = 1</em> denotes the background set and <em>j = 2</em> denotes the <code>test.set</code>
</p>
</li>
<li>
<p> N_i. denotes the total number of genes within PS i
</p>
</li>
<li>
<p> N_.j denotes the total number of genes within group j
</p>
</li>
<li>
<p> N_.. is the total number of genes within all groups j and all PS i
</p>
</li>
<li>
<p> f_ij = N_ij / N_.. and g_ij = f_ij / f_.j denote relative frequencies between groups
</p>
</li>
<li>
<p> f_i. denotes the between group sum of f_ij
</p>
</li>
</ul>
<p>The result is the fold-change value (odds) denoted as C = g_i2 / f_i. which is visualized above and below zero. 
</p>
<p>In case a large number of Phylostrata or Divergence Strata is included in the input 
<code>ExpressionSet</code>, p-values returned by <code>PlotEnrichment</code> should be adjusted for
multiple comparisons which can be done by specifying the <code>p.adjust.method</code> argument.
</p>


<h3>Author(s)</h3>

<p>Hajk-Georg Drost
</p>


<h3>References</h3>

<p>Sestak and Domazet-Loso (2015). Phylostratigraphic Profiles in Zebrafish Uncover Chordate Origins of the Vertebrate Brain. Mol. Biol. Evol. 32(2): 299-312.
</p>


<h3>See Also</h3>

<p><code>EnrichmentTest</code>, <code>fisher.test</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(PhyloExpressionSetExample)

set.seed(123)
test_set &lt;- sample(PhyloExpressionSetExample[ , 2],10000)

## Examples with complete.bg = TRUE
## Hence: the entire background set of the input ExpressionSet is considered 
## when performing Fisher's exact test 

# measure: log-foldchange
PlotEnrichment(ExpressionSet = PhyloExpressionSetExample,
               test.set      = test_set , 
               legendName    = "PS", 
               measure       = "log-foldchange")
               
               
# measure: foldchange
PlotEnrichment(ExpressionSet = PhyloExpressionSetExample,
               test.set      = test_set , 
               legendName    = "PS", 
               measure       = "foldchange")
   
               
## Examples with complete.bg = FALSE
## Hence: the test.set genes are excluded from the background set before
## Fisher's exact test is performed
     
                                       
# measure: log-foldchange
PlotEnrichment(ExpressionSet = PhyloExpressionSetExample,
               test.set      = test_set ,
                complete.bg  = FALSE,
               legendName    = "PS", 
               measure       = "log-foldchange")
               
               
# measure: foldchange
PlotEnrichment(ExpressionSet = PhyloExpressionSetExample,
               test.set      = test_set , 
               complete.bg   = FALSE,
               legendName    = "PS", 
               measure       = "foldchange")     
               
</code></pre>


</div>