<div class="container">

<table style="width: 100%;"><tr>
<td>bootMatrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute a Permutation Matrix for Test Statistics</h2>

<h3>Description</h3>

<p>This function computes the TAI for a row permutated PhyloExpressionSet or DivergenceExpressionSet.
</p>
<p>One can specify the number of permutations which corresponds to the number of <code>TAI</code> or <code>TDI</code> profiles
that are being returned as data matrix. The function then returns a <code>TAI</code> or <code>TDI</code> matrix holding
the <code>TAI</code> or <code>TDI</code> profiles of the permutated PhyloExpressionSets or DivergenceExpressionSets. This procedure
can be used for building test statistics based on the <code>TAI</code> or <code>TDI</code> profiles.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bootMatrix(ExpressionSet, permutations = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ExpressionSet</code></td>
<td>
<p>a standard PhyloExpressionSet or DivergenceExpressionSet object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>permutations</code></td>
<td>
<p>a numeric value specifying the number of permutations to be performed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The sampled <code>TAI</code> or <code>TDI</code> matrix samples the phylostratum or divergence-stratum vector of
a given PhyloExpressionSet or DivergenceExpressionSet and computes the corresponding <code>TAI</code> or <code>TDI</code> profiles
of the randomly assigned phylostrata or divergence-strata. This sampling is then performed N times, yielding N randomly sampled <code>TAI</code> or <code>TDI</code> profiles.
This random <code>TAI</code> or <code>TDI</code> profile matrix can then be used to perform statistical tests 
(such as the <code>FlatLineTest</code>, <code>ReductiveHourglassTest</code>, or <code>EarlyConservationTest</code>) based on the significance of <code>TAI</code> or <code>TDI</code> patterns.
</p>


<h3>Value</h3>

<p>a numeric matrix representing N randomly permuted <code>TAI</code> or <code>TDI</code> profiles.
</p>


<h3>Author(s)</h3>

<p>Hajk-Georg Drost
</p>


<h3>References</h3>

<p>Quint M et al. (2012). <em>A transcriptomic hourglass in plant embryogenesis</em>. Nature (490):  98-101.
</p>
<p>Drost HG et al. (2015) Mol Biol Evol. 32 (5): 1221-1231 doi:10.1093/molbev/msv012
</p>


<h3>See Also</h3>

<p><code>FlatLineTest</code>, <code>ReductiveHourglassTest</code>, <code>EarlyConservationTest</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# read standard phylotranscriptomics data
data(PhyloExpressionSetExample)
data(DivergenceExpressionSetExample)

# example PhyloExpressionSet using 100 permutations
randomTAI.Matrix &lt;- bootMatrix(PhyloExpressionSetExample, permutations = 100)

# example DivergenceExpressionSet using 100 permutations
randomTDI.Matrix &lt;- bootMatrix(DivergenceExpressionSetExample, permutations = 100)


</code></pre>


</div>