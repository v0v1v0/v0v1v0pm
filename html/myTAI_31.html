<div class="container">

<table style="width: 100%;"><tr>
<td>PlotPattern</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot the Transcriptome Age Index or Transcriptome Divergence Index</h2>

<h3>Description</h3>

<p>Function to plot the TAI or TDI of a given PhyloExpressionSet or DivergenceExpressionSet object.
This function plot the <code>TAI</code> or <code>TDI</code> of a given PhyloExpressionSet or DivergenceExpressionSet object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PlotPattern(
  ExpressionSet,
  TestStatistic = "FlatLineTest",
  modules = NULL,
  permutations = 1000,
  lillie.test = FALSE,
  digits.ylab = 4,
  p.value = TRUE,
  shaded.area = FALSE,
  y.ticks = 4,
  custom.perm.matrix = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ExpressionSet</code></td>
<td>
<p>a standard PhyloExpressionSet or DivergenceExpressionSet object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TestStatistic</code></td>
<td>
<p>a string defining the type of test statistics to be used to quantify the statistical significance the present phylotranscriptomics pattern.
Possible values can be: <code>TestStatistic</code> = <code>"FlatLineTest"</code> : Statistical test for the deviation from a flat line.
<code>TestStatistic</code> = <code>"ReductiveHourglassTest"</code> : Statistical test for the existence of a hourglass shape (high-low-high pattern).
<code>TestStatistic</code> = <code>"EarlyConservationTest"</code> : Statistical test for the existence of a earlyconservation pattern (low-high-high pattern).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modules</code></td>
<td>
<p>a list storing three elements for the <code>ReductiveHourglassTest</code> or <code>EarlyConservationTest</code>: early, mid, and late. 
Each element expects a numeric vector specifying the developmental stages 
or experiments that correspond to each module. For example, 
<code>module</code> = <code>list(early = 1:2, mid = 3:5, late = 6:7)</code> devides a dataset storing seven developmental stages into 3 modules.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>permutations</code></td>
<td>
<p>a numeric value specifying the number of permutations to be performed for the <code>FlatLineTest</code>, <code>EarlyConservationTest</code> or <code>ReductiveHourglassTest</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lillie.test</code></td>
<td>
<p>a boolean value specifying whether the Lilliefors Kolmogorov-Smirnov Test shall be performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits.ylab</code></td>
<td>
<p>a numeric value specifying the number of digits shown for the TAI or TDI values on the y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>a boolean value specifying whether the p-value of the test statistic shall be printed within the plot area.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shaded.area</code></td>
<td>
<p>a boolean value specifying whether a shaded area shall 
be drawn for the developmental stages defined to be the presumptive phylotypic period.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.ticks</code></td>
<td>
<p>a numeric value specifying the number of ticks to be drawn on the y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>custom.perm.matrix</code></td>
<td>
<p>a custom <code>bootMatrix</code> (permutation matrix) to perform the underlying test statistic visualized by <code>PlotPattern</code>. Default is <code>custom.perm.matrix = NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>default plot parameters.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function computes a permutation test quantifying the statistical significance of the prensent phylotranscriptomics pattern. 
The user can choose between the <code>FlatLineTest</code>, <code>ReductiveHourglassTest</code>, or <code>EarlyConservationTest</code>. 
The <code>FlatLineTest</code> tests for any significant deviation from a flat line. 
Each period or stage that significantly deviates from a flat line, might be governed by stronger selective pressure (in terms of natural selection) compared to other stages or periods of development.
The <code>ReductiveHourglassTest</code> specificly tests for the statistical significance of a molecular hourglass pattern (high-low-high pattern) with prior biological knowlegde.
The corresponding p-value that is printed within the plot (by default) specifies the statistical significance of the chosen test statistic.
</p>
<p>The <code>EarlyConservationTest</code> specificly tests for the statistical significance of a low-high-high pattern (monotonically increasing function)
with prior biological knowlegde.
The corresponding p-value that is printed within the plot (by default) specifies the statistical significance of the chosen test statistic.
</p>
<p>The x-axis denotes the developmental series (time course / experiments / ontogeny) of the input ExpressionSet and the y-axis 
denotes the corresponding mean transcriptome age value (<code>TAI</code> or <code>TDI</code>) of the given ExpressionSet. 
</p>
<p>Furthermore, the grey lines above and below the actual phylotranscriptomics pattern denotes the standard deviations of <code>TAI</code> or <code>TDI</code> 
values that have been estimated from the <code>bootMatrix</code>.
A low mean transcriptome age value denotes an evolutionary older transcriptome being active during the corresponding periods, 
whereas a high mean transcriptome age value denotes an evolutionary younger transcriptome being active during the corresponding periods.
For mean transcriptome divergence, a low mean transcriptome divergence value denotes a more conserved transcriptome 
being active (between two species), whereas a high mean transcriptome divergence value denotes a more divergent transcriptome 
being active (between two species) - in terms of protein-sequence substitution rates.
</p>
<p>This function is useful to fastly plot the <code>TAI</code> or <code>TDI</code> 
profile of a given PhyloExpressionSet or DivergenceExpressionSet object and 
the statistical significance of the corresponding pattern.
Internally the function calls several graphics functions, 
such as <code>plot</code>, <code>axis</code>, and <code>legend</code>. 
For the ellipsis argument <code>...</code> all graphics specific arguments can be defined. 
Internally the function specific arguments for e.g. <code>plot</code>, <code>axis</code>, 
and <code>legend</code> will be detected and are passed to the corresponding function.
</p>
<p>Hence, when calling the function <code>PlotPattern</code>, one can specify arguments 
for <code>plot</code> and <code>axis</code> and <code>legend</code> 
as <code>...</code>. 
</p>
<p>In case prior biological knowledge is present for a specific period of development,
the <code>shaded.area</code> argument can be set to <code>TRUE</code> and the function will use
the values stored in the <code>mid</code> argument to draw a shaded area within the corresponding period of development.
</p>


<h3>Value</h3>

<p>a plot visualizing the phylotranscriptomic pattern of a given PhyloExpressionSet or DivergenceExpressionSet object.
</p>
<p>The corresponding <em>p-value</em> of the test statistic is named as follows:
</p>
<p><code>p_flt</code> = p-value of the corresponding <code>FlatLineTest</code>
</p>
<p><code>p_rht</code> = p-value of the corresponding <code>ReductiveHourglassTest</code>
</p>
<p><code>p_ect</code> = p-value of the corresponding <code>EarlyConservationTest</code>
</p>


<h3>Author(s)</h3>

<p>Hajk-Georg Drost
</p>


<h3>References</h3>

<p>Domazet-Loso T and Tautz D. (2010). <em>A phylogenetically based transcriptome age index mirrors ontogenetic divergence patterns</em>. Nature (468): 815-818.
</p>
<p>Quint M et al. (2012). <em>A transcriptomic hourglass in plant embryogenesis</em>. Nature (490): 98-101.
</p>
<p>Drost HG et al. (2015) Mol Biol Evol. 32 (5): 1221-1231 doi:10.1093/molbev/msv012.
</p>


<h3>See Also</h3>

<p><code>TAI</code>, <code>TDI</code>, <code>FlatLineTest</code>,
<code>ReductiveHourglassTest</code>, <code>EarlyConservationTest</code>,
<code>PlotSignature</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# load PhyloExpressionSet
data(PhyloExpressionSetExample)

# only visualize the TAI profile without any test statistics...
# this is equavalent to performing: plot(TAI(PhyloExpressionSetExample), type = "l", lwd = 6)
PlotPattern(ExpressionSet = PhyloExpressionSetExample,
            TestStatistic = NULL,
            type          = "l",
            xlab          = "Ontogeny",
            ylab          = "TAI",
            lwd           = 9)

# the simplest example of plotting the TAI profile of a given PhyloExpressionSet:
# In this case (default) the FlatLineTest will be performed to quantify
# the statistical significance of the present TAI pattern and will be drawn as 'p = ... '
# in the plot

PlotPattern(ExpressionSet = PhyloExpressionSetExample, 
            TestStatistic = "FlatLineTest",
            permutations  = 100, 
            type          = "l", 
            xlab          = "Ontogeny", 
            ylab          = "TAI", 
            lwd           = 9)

# an example performing the ReductiveHourglassTest and printing the p-value
# and shaded area of the presumptive phylotypic period into the plot
# Here the 'p = ...' denotes the p-value that is returned by the ReductiveHourglassTest

PlotPattern(
            ExpressionSet = PhyloExpressionSetExample,
            TestStatistic = "ReductiveHourglassTest",
            modules       = list(early = 1:2,mid = 3:5,late = 6:7), 
            permutations  = 100, 
            p.value       = TRUE, 
            shaded.area   = TRUE, 
            xlab          = "Ontogeny", 
            ylab          = "TAI", 
            type          = "l", 
            lwd           = 9)

# testing for early conservation model 
PlotPattern( ExpressionSet = PhyloExpressionSetExample,
             TestStatistic = "EarlyConservationTest",
            modules        = list(early = 1:2,mid = 3:5,late = 6:7), 
            permutations   = 100,
            p.value        = TRUE, 
            shaded.area    = TRUE, 
            xlab           = "Ontogeny", 
            ylab           = "TAI", 
            type           = "l", 
            lwd            = 9)
            

# use your own permutation matrix
custom_perm_matrix &lt;- bootMatrix(PhyloExpressionSetExample,100)

PlotPattern(ExpressionSet      = PhyloExpressionSetExample, 
            TestStatistic      = "FlatLineTest",
            custom.perm.matrix = custom_perm_matrix, 
            type               = "l", 
            xlab               = "Ontogeny", 
            ylab               = "TAI", 
            lwd                = 9)


</code></pre>


</div>