<div class="container">

<table style="width: 100%;"><tr>
<td>PlotSignature</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot evolutionary signatures across transcriptomes</h2>

<h3>Description</h3>

<p>Main function to visualize transcriptome indices.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PlotSignature(
  ExpressionSet,
  measure = "TAI",
  TestStatistic = "FlatLineTest",
  modules = NULL,
  permutations = 1000,
  lillie.test = FALSE,
  p.value = TRUE,
  shaded.area = FALSE,
  custom.perm.matrix = NULL,
  xlab = "Ontogeny",
  ylab = "Transcriptome Index",
  main = "",
  lwd = 4,
  alpha = 0.1,
  y.ticks = 10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ExpressionSet</code></td>
<td>
<p>a standard PhyloExpressionSet, DivergenceExpressionSet or PolymorphismsExpressionSet object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>measure</code></td>
<td>
<p>type of transcriptome index that shall be computed. E.g. 
</p>

<ul>
<li> <p><code>measure = "TAI"</code> (Transcriptome Age Index)
</p>
</li>
<li> <p><code>measure = "TDI"</code> (Transcriptome Divergence Index)
</p>
</li>
<li> <p><code>measure = "TPI"</code> (Transcriptome Polymorphism Index)
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TestStatistic</code></td>
<td>
<p>a string defining the type of test statistics to be used to quantify the statistical significance the present phylotranscriptomics pattern.
Possible values can be: 
</p>

<ul>
<li> <p><code>TestStatistic</code> = <code>"FlatLineTest"</code> : Statistical test for the deviation from a flat line
</p>
</li>
<li> <p><code>TestStatistic</code> = <code>"ReductiveHourglassTest"</code> : Statistical test for the existence of a hourglass shape (high-low-high pattern)
</p>
</li>
<li> <p><code>TestStatistic</code> = <code>"EarlyConservationTest"</code> : Statistical test for the existence of a earlyconservation pattern (low-high-high pattern)
</p>
</li>
<li> <p><code>TestStatistic</code> = <code>"ReverseHourglassTest"</code> : Statistical test for the existence of a reverse hourglass pattern (low-high-low pattern)
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modules</code></td>
<td>
<p>a list storing three elements for the <code>ReductiveHourglassTest</code>, <code>EarlyConservationTest</code>, or <code>ReverseHourglassTest</code>: early, mid, and late. 
Each element expects a numeric vector specifying the developmental stages 
or experiments that correspond to each module. For example:
</p>

<ul><li> <p><code>module</code> = <code>list(early = 1:2, mid = 3:5, late = 6:7)</code> devides a dataset storing seven developmental stages into 3 modules.
</p>
</li></ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>permutations</code></td>
<td>
<p>a numeric value specifying the number of permutations to be performed for the <code>FlatLineTest</code>, <code>EarlyConservationTest</code>, <code>ReductiveHourglassTest</code> or <code>ReverseHourglassTest</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lillie.test</code></td>
<td>
<p>a boolean value specifying whether the Lilliefors Kolmogorov-Smirnov Test shall be performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>a boolean value specifying whether the p-value of the test statistic shall be printed within the plot area.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shaded.area</code></td>
<td>
<p>a boolean value specifying whether a shaded area shall 
be drawn for the developmental stages defined to be the presumptive phylotypic period.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>custom.perm.matrix</code></td>
<td>
<p>a custom <code>bootMatrix</code> (permutation matrix) to perform the underlying test statistic visualized by <code>PlotSignature</code>. Default is <code>custom.perm.matrix = NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>label of x-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>label of y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>figure title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>line width.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>transparency of the shaded area (between [0,1]). Default is <code>alpha = 0.1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.ticks</code></td>
<td>
<p>number of ticks on the y-axis. Default is <code>ticks = 10</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function substitutes the functionality of the <code>PlotPattern</code> function
and is based on ggplot2 insead of base R graphics.
</p>
<p>The following transcriptome indices can be computed and visualized with this function:
</p>

<ul>
<li>
<p> Transcriptome Age Index (<code>TAI</code>)
</p>
</li>
<li>
<p> Transcriptome Divergence Index (<code>TDI</code>)
</p>
</li>
<li>
<p> Transcriptome Polymorphism Index (<code>TPI</code>)
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Hajk-Georg Drost
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(PhyloExpressionSetExample)

# plot TAI pattern and perform flat line test
PlotSignature(PhyloExpressionSetExample, 
              measure       = "TAI", 
              permutations  = 100,
              TestStatistic = "FlatLineTest",
              ylab = "Transcriptome Age Index")
              
</code></pre>


</div>