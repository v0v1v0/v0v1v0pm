<div class="container">

<table style="width: 100%;"><tr>
<td>pMatrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute Partial TAI or TDI Values</h2>

<h3>Description</h3>

<p>This function computes the partial <code>TAI</code> or <code>TDI</code> 
values for each single gene in a PhyloExpressionSet or DivergenceExpressionSet object.
</p>
<p>In detail, each gene gets a <em>TAI contribution profile</em> or <em>TDI contribution profile</em>. 
</p>
<p style="text-align: center;"><code class="reqn">TAI_is = f_is * ps_i</code>
</p>

<p>or
</p>
<p style="text-align: center;"><code class="reqn">TDI_is = f_is * ps_i</code>
</p>

<p>where TAI_is or TDI_is is the partial TAI or TDI value of gene i, 
<code class="reqn">f_is = e_is / \sum e_is</code> and <code class="reqn">ps_i</code> is the phylostratum or divergence-stratum of gene i.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pMatrix(ExpressionSet)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>ExpressionSet</code></td>
<td>
<p>a standard PhyloExpressionSet or DivergenceExpressionSet object.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>The partial TAI or TDI matrix can be used to perform different cluster analyses
and also gives an overall impression of the contribution of each gene to the global <code>TAI</code> or <code>TDI</code> pattern.
</p>


<h3>Value</h3>

<p>a numeric matrix storing the partial TAI or TDI values for each gene in the 
corresponding PhyloExpressionSet or DivergenceExpressionSet.
</p>


<h3>Author(s)</h3>

<p>Hajk-Georg Drost
</p>


<h3>References</h3>

<p>Domazet-Loso T and Tautz D. 2010. "A phylogenetically based transcriptome age index mirrors ontogenetic divergence patterns". Nature (468): 815-818.
</p>


<h3>Examples</h3>

<pre><code class="language-R">

# read standard phylotranscriptomics data
data(PhyloExpressionSetExample)
data(DivergenceExpressionSetExample)

# example PhyloExpressionSet
PTM_ps &lt;- pMatrix(PhyloExpressionSetExample)

# example DivergenceExpressionSet
PTM_ds &lt;- pMatrix(DivergenceExpressionSetExample)

# boxplot of the pMatrix
boxplot(pMatrix(PhyloExpressionSetExample),outline = FALSE)

# boxplot of the pMatrix using log2 transformed expression levels
boxplot(pMatrix(tf(PhyloExpressionSetExample,log2)))
 

</code></pre>


</div>