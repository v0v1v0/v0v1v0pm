<div class="container">

<table style="width: 100%;"><tr>
<td>rhScore</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute the Hourglass Score for the Reductive Hourglass Test</h2>

<h3>Description</h3>

<p>This function reduces the destruction of an hourglass shaped pattern to a single score value.
</p>
<p>Based on a given <code>TAI</code> or <code>TDI</code> pattern the given vector is being
divided into three developmental modules: early, mid, and late. The corrisponding <code>TAI</code> or <code>TDI</code>
values in each developmental module are accumulated using the <em>scoringMethod</em> argument ("max-min" or "mean-mean").
</p>
<p>In more detail:
</p>
<p>(1) for a given <code>TAI</code> or <code>TDI</code> vector <em>tai_profile</em> or <em>tdi_profile</em>, we classify each value of <em>tai_profile</em> or <em>tdi_profile</em> into its corresponding developmental module early, mid, or late.
</p>
<p>(2) accumulate the <em>tai_profile</em> or <em>tdi_profile</em> values in each developmental module using the arithmetic mean (<code>mean</code>) in case scoringMethod = "mean-mean", or accumulate the <em>tai_profile</em> or <em>tdi_profile</em> values in each developmental module using <code>max</code> for the early and late module and <code>min</code> for the mid module in case scoringMethod = "max-min".
</p>
<p>(3) then reduce the three values for each developmental module by computing the difference between: early - mid, and late - mid.
</p>
<p>(4) the two difference values are referred to as a_early and a_late. 
</p>
<p>Each developmental module now has an accumulated representation value which is being reduced to one value using the
<em>method</em> argument ("max", "min", or "mean"). 
</p>
<p>Given the two accumulated values for each hourglass module: a_early and a_late,
we reduce the two given values by:
</p>

<ul>
<li> <p><em>"max"</em>: <code class="reqn">S = max{a_early,a_late}</code>
</p>
</li>
<li> <p><em>"min"</em>: <code class="reqn">S = min{a_early,a_late}</code>
</p>
</li>
<li> <p><em>"mean"</em>: <code class="reqn">S = mean{a_early,a_late}</code>
</p>
</li>
</ul>
<p>All together this results in a global score <em>S</em>.
This global score <em>S</em> is being returned by this function <code>rhScore</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rhScore(age_vals, early, mid, late, method, scoringMethod)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>age_vals</code></td>
<td>
<p>a numeric vector containing <code>TAI</code> or <code>TDI</code> values for each developmental stage s.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>early</code></td>
<td>
<p>a numeric vector including the numeric stage values that correspond to the early phase of development.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mid</code></td>
<td>
<p>a numeric vector including the numeric stage values that correspond to the middle phase of development.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>late</code></td>
<td>
<p>a numeric vector including the numeric stage values that correspond to the late phase of development.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>to determine the two value reduction value, resulting in the global score S: "max", or "min", or "mean".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scoringMethod</code></td>
<td>
<p>method to determine the module accumulation value: "max-min" or "mean-mean".</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The gpScore is a heuristic score enabling to  construct a test statistic to determine  
the significance of a present (phylotranscriptomic) hourglass pattern.
</p>


<h3>Value</h3>

<p>a numeric value representing the hourglass destruction score.
</p>


<h3>Author(s)</h3>

<p>Hajk-Georg Drost
</p>


<h3>References</h3>

<p>Drost HG et al. (2015) Mol Biol Evol. 32 (5): 1221-1231 doi:10.1093/molbev/msv012
</p>


<h3>See Also</h3>

<p><code>ReductiveHourglassTest</code>, <code>TAI</code>, <code>TDI</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
 # read standard phylotranscriptomics data
 data(PhyloExpressionSetExample)
 data(DivergenceExpressionSetExample)

 # example PhyloExpressionSet:

 # compute the TAI profile
 TAIs &lt;- TAI(PhyloExpressionSetExample)

 # compute the global hourglass destruction score 
 # for the TAIs profile using reduction method: mean(mean-mean)
 rh_score &lt;- rhScore(age_vals = TAIs,early = 1:2,mid = 3:5,late = 6:7,
                     method = "mean",scoringMethod = "mean-mean")


 # example DivergenceExpressionSet:

 # compute the TDI profile
 TDIs &lt;- TDI(DivergenceExpressionSetExample)

 # compute the global hourglass destruction score for the TDIs profile 
 # using reduction method: mean(mean-mean)
 rh_score &lt;- rhScore(age_vals = TDIs,early = 1:2,mid = 3:5,late = 6:7,
                     method = "mean",scoringMethod = "mean-mean")
 
 
</code></pre>


</div>