<div class="container">

<table style="width: 100%;"><tr>
<td>ecScore</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute the Hourglass Score for the EarlyConservationTest</h2>

<h3>Description</h3>

<p>This function computes the EarlyConservationTest score for a given <code>TAI</code>
or <code>TDI</code> pattern.
</p>
<p>The reductive early conservation test is a permutation test based on the following test statistic. 
</p>
<p>- A set of developmental stages is partitioned into three modules - early, mid, and late - based on prior biological knowledge.
</p>
<p>- The mean <code>TAI</code> or <code>TDI</code> value for each of the three modules T_early, T_mid, and T_late are computed. 
</p>
<p>- The two differences D1 = T_mid - T_early and D2 = T_late - T_early are calculated.
</p>
<p>- The minimum D_min of D1 and D2 is computed as final test statistic of the reductive hourglass test.
</p>
<p>This function <em>ecScore</em> computes the <em>D_min</em> value for a given <code>TAI</code> or <code>TDI</code>
stored in the <code>age_vals</code> argument.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ecScore(age_vals, early, mid, late)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>age_vals</code></td>
<td>
<p>a numeric vector containing <code>TAI</code> or <code>TDI</code> values for each developmental stage s.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>early</code></td>
<td>
<p>a numeric vector storing the numeric stage values that correspond to the early phase of development.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mid</code></td>
<td>
<p>a numeric vector storing the numeric stage values that correspond to the middle phase of development.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>late</code></td>
<td>
<p>a numeric vector storing the numeric stage values that correspond to the late phase of development.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a numeric value representing the early conservation score.
</p>


<h3>Author(s)</h3>

<p>Hajk-Georg Drost
</p>


<h3>See Also</h3>

<p><code>EarlyConservationTest</code>, <code>TAI</code>, <code>TDI</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
 # read standard phylotranscriptomics data
 data(PhyloExpressionSetExample)
 data(DivergenceExpressionSetExample)

 # Example PhyloExpressionSet:

 # compute the TAI profile
 TAIs &lt;- TAI(PhyloExpressionSetExample)

 # compute the early conservation score for the TAI profile
 ec_score &lt;- ecScore(age_vals = TAIs,early = 1:2,mid = 3:5,late = 6:7)


 # Example DivergenceExpressionSet:

 # compute the TDI profile
 TDIs &lt;- TDI(DivergenceExpressionSetExample)

 # compute the early conservation score for the TDI profile
 ec_score &lt;- ecScore(age_vals = TDIs,early = 1:2,mid = 3:5,late = 6:7)
 
 # compute ecScore() vector from bootMatrix()
 apply(bootMatrix(PhyloExpressionSetExample,10),1,ecScore,early = 1:2,mid = 3:5,late = 6:7)
 
 
</code></pre>


</div>